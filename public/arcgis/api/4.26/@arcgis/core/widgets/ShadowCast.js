/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{substitute as t}from"../intl.js";import i from"../core/Handles.js";import{g as o,d as s,i as n,a as r,r as a,u as l}from"../chunks/maybe.js";import{watch as c,syncAndInitial as d}from"../core/reactiveUtils.js";import{c as h}from"../chunks/timeUtils.js";import{property as p}from"../core/accessorSupport/decorators/property.js";import"../chunks/ensureType.js";import"../chunks/typedArrayUtil.js";import{subclass as u}from"../core/accessorSupport/decorators/subclass.js";import m from"./Slider.js";import v,{l as _}from"./Widget.js";import g,{D as b,S as k,a as C}from"./ShadowCast/ShadowCastViewModel.js";import y from"../core/Accessor.js";import{g as f}from"../chunks/uuid.js";import{a as w,g as j}from"../chunks/locale.js";import{c as S}from"../chunks/datetime.js";import{c as P}from"../chunks/widgetUtils.js";import{t as T}from"../chunks/jsxFactory.js";import M from"../Color.js";import{c as V}from"../chunks/asyncUtils.js";import{m as z}from"../chunks/handleUtils.js";import{throwIfAborted as D}from"../core/promiseUtils.js";import{P as O}from"../chunks/Popover.js";import{m as I}from"../chunks/messageBundle.js";import{p as E}from"../chunks/mathUtils.js";import{a as x,f as $}from"../chunks/number.js";import{g as L,f as F}from"../chunks/timeWidgetUtils.js";import R from"./support/DatePicker.js";import{H as A}from"../chunks/Heading.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../core/lang.js";import"../chunks/string.js";import"../chunks/messages.js";import"../core/Error.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/jsonMap.js";import"../chunks/watch.js";import"../chunks/ArrayPool.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/tracking.js";import"../chunks/metadata.js";import"../core/Collection.js";import"../core/Evented.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../core/accessorSupport/decorators/cast.js";import"./Slider/SliderViewModel.js";import"../chunks/domUtils.js";import"../core/Promise.js";import"../chunks/projector.js";import"../chunks/dom.js";import"../chunks/index.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/screenUtils.js";import"../chunks/vec3.js";import"../chunks/common.js";import"../chunks/earthUtils.js";import"../chunks/unitUtils.js";import"../chunks/Ellipsoid.js";import"../geometry/Point.js";import"../chunks/reader.js";import"../chunks/writer.js";import"../geometry/Geometry.js";import"../core/JSONSupport.js";import"../geometry/SpatialReference.js";import"../geometry/support/webMercatorUtils.js";import"../chunks/ShadowCastVisualizeTechniqueConfiguration.js";import"../chunks/mat4.js";import"../chunks/mat4f64.js";import"../chunks/vec2.js";import"../chunks/vec2f64.js";import"../chunks/ViewingMode.js";import"../chunks/mathUtils2.js";import"../chunks/ShaderTechniqueConfiguration.js";import"../chunks/interfaces2.js";import"../chunks/collectionUtils.js";import"../chunks/throttle.js";import"../chunks/traversalUtils.js";import"../chunks/colorUtils.js";import"../chunks/vec4.js";import"./support/DatePickerViewModel.js";import"./support/DateTimeElementViewModel.js";import"../chunks/accessibleHandler.js";const U="esri-shadow-cast",H={base:U,esriWidget:"esri-widget--panel esri-widget",esriWidgetDisabled:"esri-widget--disabled",widgetIcon:"esri-icon-measure-building-height-shadow",timeRange:`${U}__time-range`,timeRangeIndicator:`${U}__time-range__indicator`,timeRangePrimaryTick:"primary-tick",timeRangePrimaryTickLabel:"primary-tick-label",timeRangeSecondaryTick:"secondary-tick",timeRangeAMPMLabel:"primary-tick__ampm",datePickerContainer:`${U}__date-picker-container`,visualization:`${U}__visualization`,visualizationSelect:`${U}__visualization__select`,visualizationConfigHidden:`${U}__visualization__config--hidden`},W=`${U}__tz-picker`,B={base:W,select:`${W}__select`,selectFocused:`${W}__select--focused`,hiddenSelect:`${W}__hidden-select`},N=`${U}__label`,q=`${U}__threshold-config`,G={base:q,valueLabel:`${q}__value-label`},K=`${U}__duration-config`,J={base:K,radioGroup:`${K}__radio-group`},Z={base:`${U}__discrete-config`},Q=`${U}__tooltip`,X={base:Q,content:`${Q}__content`};let Y=class extends y{constructor(){super(...arguments),this.timeRangeSlider=!0,this.timezone=!0,this.datePicker=!0,this.visualizationOptions=!0,this.colorPicker=!0,this.tooltip=!0}};e([p()],Y.prototype,"timeRangeSlider",void 0),e([p()],Y.prototype,"timezone",void 0),e([p()],Y.prototype,"datePicker",void 0),e([p()],Y.prototype,"visualizationOptions",void 0),e([p()],Y.prototype,"colorPicker",void 0),e([p()],Y.prototype,"tooltip",void 0),Y=e([u("esri.widgets.ShadowCast.ShadowCastVisibleElements")],Y);const ee=Y;function te(e,t="milliseconds",i={}){const o={locale:"bs"===w()?"hr":j(),numberingSystem:"latn"};let s;return s=e?S.fromMillis(h(e,t,"milliseconds"),o).rescale():S.fromObject({seconds:0},o),s.toHuman({listStyle:"narrow",unitDisplay:"long",...i})}function ie(e,t){const{for:i,label:o,tabIndex:s,...n}=e;return T("div",{class:P(N,n?.class),key:i,...n},T("calcite-label",{for:i,scale:"s",tabIndex:s},o),t)}const oe="esri-color-picker",se={base:oe,backgroundPattern:`${oe}__bg-pattern`,toggleButton:`${oe}__toggle-button`,popover:`${oe}__popover`,opacitySliderContainer:`${oe}__opacity-slider-container`,opacitySlider:`${oe}__opacity-slider`,calciteColorPicker:`${oe}__calcite-color-picker`};var ne;!function(e){e.ColorPickerFocus="hex-input-poll-timeout",e.ButtonFocusTimeout="button-focus-timeout"}(ne||(ne={}));let re=class extends v{constructor(e,t){super(e,t),this.value=new M,this.alphaEnabled=!0,this._handles=new i,this._containerElement=null,this._popover=null,this._popoverElement=null,this._buttonElement=null,this._colorPickerCreated=!1}initialize(){this.addHandles(c((()=>({container:this._containerElement,value:this.value})),(({container:e,value:t})=>{o(e,(e=>{e.style.setProperty("--esri-color-picker-value",t.toCss(!0))}))}),d))}loadDependencies(){return _({button:()=>import("../chunks/calcite-button.js"),"color-picker":()=>import("../chunks/calcite-color-picker.js"),label:()=>import("../chunks/calcite-label.js"),slider:()=>import("../chunks/calcite-slider.js")})}destroy(){this._destroyPopover(),this._handles=s(this._handles),this._buttonElement=null}render(){const e=this._messages,t=n(this._popover)&&this._popover.open?e.close:e.open;return T("div",{class:this.classes(se.base,this.class),bind:this,afterCreate:this._onContainerAfterCreate},T("div",{class:se.backgroundPattern}),T("calcite-button",{appearance:"transparent",label:t,class:se.toggleButton,kind:"neutral",id:this.id,scale:"s",tabIndex:-1,title:t,bind:this,onclick:this._togglePopover,afterCreate:this._onButtonAfterCreate}))}_onContainerAfterCreate(e){this._containerElement=e}_onButtonAfterCreate(e){this._destroyPopover(),this._buttonElement=e,this._popover=new O({owner:this,anchorElement:e,placement:"bottom-start",renderContentFunction:this._renderPopoverContent})}_destroyPopover(){this._handles.remove(ne.ColorPickerFocus),this._popover=s(this._popover),this._popoverElement=null}_renderPopoverContent(){const e=this.value,t=this._messages;return T("div",{class:se.popover,tabIndex:-1,bind:this,afterCreate:this._onPopoverAfterCreate,onfocusout:this._onPopoverFocusOut,onkeydown:this._onPopoverKeyDown},T("calcite-color-picker",{class:se.calciteColorPicker,hideSaved:!0,hideChannels:!0,scale:"m",value:this._colorPickerCreated?e.toCss():null,bind:this,onCalciteColorPickerInput:this._onColorInput,afterCreate:this._onColorPickerAfterCreate,afterRemoved:()=>this._colorPickerCreated=!1}),this.alphaEnabled&&T("section",{class:se.opacitySliderContainer},T("calcite-label",{scale:"s"},t.opacity,T("calcite-slider",{class:se.opacitySlider,labelHandles:!0,min:0,max:1,step:.01,value:e.a,bind:this,onCalciteSliderInput:this._onOpacityChange}))))}_onColorInput(e){const t=e.target.value,i="string"==typeof t?new M(t):new M;i.a=this.value.a,this._onChange(i)}_onOpacityChange(e){const t=e.target,i=this.value.clone();i.a=t.value,this._onChange(i)}_onChange(e){this.value=e,n(this.onChange)&&this.onChange(e)}_onColorPickerAfterCreate(e){this._handles.remove(ne.ColorPickerFocus);const t=V((async t=>{await(e.componentOnReady?.()),D(t),this._colorPickerCreated=!0,await new Promise((e=>requestAnimationFrame(e))),D(t),e.setFocus()}));this._handles.add(z((()=>{t.abort(),this._colorPickerCreated=!1})),ne.ColorPickerFocus)}_togglePopover(e){n(this._popover)&&this._popover.open?this._closePopover():this._openPopover()}_openPopover(){o(this._popover,(e=>e.open=!0))}_closePopover(){this._handles.remove(ne.ColorPickerFocus),o(this._popover,(e=>e.open=!1)),this._setFocusOnButton()}_setFocusOnButton(){this._handles.remove(ne.ButtonFocusTimeout),this._handles.add(function(e,t){const i=setTimeout(e,void 0);return z((()=>clearTimeout(i)))}((()=>{o(this._buttonElement,(e=>e.setFocus()))})),ne.ButtonFocusTimeout)}_onPopoverAfterCreate(e){this._popoverElement=e}_onPopoverFocusOut(e){const t=this._popoverElement;if(r(t))return;const i=e.relatedTarget;if(i&&i instanceof Node){if(t.contains(i))return;if(i===this._buttonElement||this._isAssociatedLabel(i))return}this._closePopover()}_isAssociatedLabel(e){const t=this.id,i=e.tagName?.toLowerCase();return"calcite-label"===i&&e.for===t||"label"===i&&e.htmlFor===t}_onPopoverKeyDown(e){"Escape"!==e.key&&"Enter"!==e.key||(e.stopPropagation(),this._closePopover())}};function ae(e){return T(ie,{for:e.id,label:e.label,tabIndex:-1},T(re,{id:e.id,value:e.value,onChange:e.onChange}))}e([p()],re.prototype,"class",void 0),e([p()],re.prototype,"value",void 0),e([p()],re.prototype,"alphaEnabled",void 0),e([p()],re.prototype,"onChange",void 0),e([p()],re.prototype,"_containerElement",void 0),e([p()],re.prototype,"_popover",void 0),e([p()],re.prototype,"_popoverElement",void 0),e([p()],re.prototype,"_buttonElement",void 0),e([p(),I("esri/widgets/support/t9n/ColorPicker")],re.prototype,"_messages",void 0),e([p()],re.prototype,"_colorPickerCreated",void 0),re=e([u("esri.widgets.support.ColorPicker")],re);let le=class extends v{constructor(e){super(e),this.colorPickerVisible=!0,this._selectId=`select-${f()}`,this._colorPickerId=`color-picker-${f()}`,this._onColorChange=e=>{this.options.color=e}}loadDependencies(){return _({label:()=>import("../chunks/calcite-label.js"),option:()=>import("../chunks/calcite-option.js"),select:()=>import("../chunks/calcite-select.js")})}render(){const e=this._messages.discrete,t=e.intervalLabel,{color:i,interval:o,intervalOptions:s}=this.options;return T("div",{class:Z.base},T(ie,{for:this._selectId,label:t},T("calcite-select",{id:this._selectId,label:t,bind:this,onCalciteSelectChange:this._onIntervalChange},s.toArray().map((e=>T("calcite-option",{key:e,selected:e===o,value:String(e)},te(e)))))),this.colorPickerVisible&&T(ae,{id:this._colorPickerId,label:e.colorLabel,value:i,onChange:this._onColorChange}))}_onIntervalChange(e){const t=e.target,i=parseInt(t.selectedOption?.value,10);Number.isFinite(i)&&(this.options.interval=i)}};e([p()],le.prototype,"options",void 0),e([p()],le.prototype,"colorPickerVisible",void 0),e([p(),I("esri/widgets/ShadowCast/t9n/ShadowCast")],le.prototype,"_messages",void 0),le=e([u("esri.widgets.ShadowCast.components.DiscreteConfigurator")],le);let ce=class extends v{constructor(e){super(e),this.colorPickerVisible=!0,this._modeSelectorId=`mode-selector-${f()}`,this._colorPickerId=`color-picker-${f()}`,this._onColorChange=e=>{this.options.color=e},this._setContinuous=()=>{this.options.mode=b.Continuous},this._setHourly=()=>{this.options.mode=b.Hourly}}loadDependencies(){return _({button:()=>import("../chunks/calcite-button.js"),label:()=>import("../chunks/calcite-label.js")})}render(){const e=this._messages.duration,{color:t,mode:i}=this.options;return T("div",{class:J.base},T(ie,{for:this._modeSelectorId,label:e.modeLabel},T("div",{class:J.radioGroup},T(de,{active:i===b.Continuous,label:e.continuousLabel,onclick:this._setContinuous}),T(de,{active:i===b.Hourly,label:e.hourlyLabel,onclick:this._setHourly}))),this.colorPickerVisible&&T(ae,{id:this._colorPickerId,label:e.colorLabel,value:t,onChange:this._onColorChange}))}};function de({active:e,label:t,...i}){return T("calcite-button",{alignment:"center",appearance:e?"solid":"outline",scale:"s",width:"half",...i},t)}e([p()],ce.prototype,"options",void 0),e([p()],ce.prototype,"colorPickerVisible",void 0),e([p(),I("esri/widgets/ShadowCast/t9n/ShadowCast")],ce.prototype,"_messages",void 0),ce=e([u("esri.widgets.ShadowCast.components.DurationConfigurator")],ce);const he=h(1,"minutes","milliseconds"),pe=h(15,"minutes","milliseconds");let ue=class extends v{constructor(e,t){super(e,t),this.accumulatedShadowTime=null,this._messages=null}render(){const e=this._formattedContent;return T("div",{class:X.base},e&&T("div",{class:X.content},e))}get _formattedContent(){const e=this._messages,i=this.accumulatedShadowTime;if(r(e)||r(i))return null;const o=E(i,i<pe?he:pe);return t(e.timeInShadow,{duration:te(o)})}};e([p()],ue.prototype,"accumulatedShadowTime",void 0),e([p()],ue.prototype,"view",void 0),e([p(),I("esri/widgets/ShadowCast/t9n/ShadowCast")],ue.prototype,"_messages",void 0),e([p({readOnly:!0})],ue.prototype,"_formattedContent",null),ue=e([u("esri.widgets.ShadowCast.components.ShadowTooltipContent")],ue);let me=class extends y{constructor(e){super(e),this._updateHandle=null,this._contentContainer=this._createContainer()}initialize(){this.container.appendChild(this._contentContainer),this._contentWidget=new ue({},this._contentContainer),this._updateHandle=c((()=>{const e=this._contentContainer,{screenPoint:t,accumulatedShadowTime:i}=this.viewModel.tooltip;return{contentContainer:e,screenPoint:t,accumulatedShadowTime:i}}),(e=>this._update(e)),d)}destroy(){this._updateHandle=a(this._updateHandle),this._contentWidget=s(this._contentWidget),this.container.contains(this._contentContainer)&&this.container.removeChild(this._contentContainer)}get testData(){return{displayedValue:"none"===this._contentContainer.style.display?null:this._contentWidget.container?.innerText}}_update({contentContainer:e,screenPoint:t,accumulatedShadowTime:i}){const{style:o}=e;r(t)?o.display="none":(o.display="block",o.transform=`translate(${t.x}px, ${t.y}px)`,this._contentWidget.accumulatedShadowTime=i)}_createContainer(){const e=document.createElement("div"),{style:t}=e;return t.position="absolute",t.top="0",t.left="0",e}};e([p()],me.prototype,"viewModel",void 0),e([p()],me.prototype,"container",void 0),e([p()],me.prototype,"_contentContainer",void 0),e([p()],me.prototype,"_contentWidget",void 0),me=e([u("esri.widgets.ShadowCast.components.ShadowTooltip")],me);let ve=class extends v{constructor(e){super(e),this.colorPickerVisible=!0,this._valueSliderId=`value-slider-${f()}`,this._colorPickerId=`color-picker-${f()}`,this._valueSlider=new m({visibleElements:{labels:!1,rangeLabels:!1},steps:h(30,"minutes","milliseconds"),labelFormatFunction:(e,t)=>{const i=h(e,"milliseconds","hours");return"tick"===t?x(i,{maximumFractionDigits:0}):""}}),this._onColorChange=e=>{this.options.color=e}}initialize(){const e=({value:e})=>{this.options.value=e};this.addHandles([c((()=>{const{value:e,minValue:t,maxValue:i}=this.options;return{value:e,minValue:t,maxValue:i}}),(({value:e,minValue:t,maxValue:i})=>{const o=this._valueSlider;o.min=t,o.max=i,o.values=[e];const s=i-t,n=Math.floor(h(s,"milliseconds","hours"));o.tickConfigs=[{mode:"count",values:2*n+1,labelsVisible:!1},{mode:"count",values:n+1,labelsVisible:!0}]}),d),this._valueSlider.on("thumb-change",e),this._valueSlider.on("thumb-drag",e)])}loadDependencies(){return _({label:()=>import("../chunks/calcite-label.js")})}destroy(){this._valueSlider=s(this._valueSlider)}render(){const e=this._messages.threshold,{color:t}=this.options;return T("div",{class:G.base},T(ie,{class:G.valueLabel,for:this._valueSliderId,label:e.valueLabel},this._valueSlider.render()),this.colorPickerVisible&&T(ae,{id:this._colorPickerId,label:e.colorLabel,value:t,onChange:this._onColorChange}))}get testData(){return{valueSlider:this._valueSlider}}};e([p()],ve.prototype,"options",void 0),e([p()],ve.prototype,"colorPickerVisible",void 0),e([p()],ve.prototype,"testData",null),e([p()],ve.prototype,"_valueSlider",void 0),e([p(),I("esri/widgets/ShadowCast/t9n/ShadowCast")],ve.prototype,"_messages",void 0),ve=e([u("esri.widgets.ShadowCast.components.ThresholdConfigurator")],ve);let _e=class extends v{constructor(e,t){super(e,t),this._focused=!1}loadDependencies(){return _({icon:()=>import("../chunks/calcite-icon.js")})}render(){const e=this._gmtOffsets,t=this._timezoneMessages;if(r(e)||r(t))return T("div",{class:B.base});const i=this.value,o=this._selectedItemText;return T("div",{class:B.base},T("select",{key:"hidden-select",class:B.hiddenSelect,"aria-label":t.chooseTimezone,title:t.chooseTimezone,value:String(i),bind:this,onfocus:this._onFocus,onblur:this._onBlur,onchange:this._onDropdownSelectChange},e.map((({utcOffset:e,shortWithUTC:t,long:i})=>T("option",{value:String(e)},t," - ",i)))),T("div",{key:"visible-select",class:this.classes({[B.select]:!0,[B.selectFocused]:this._focused})},o,T("calcite-icon",{icon:"chevron-down",scale:"s"})))}get _gmtOffsets(){return o(this._timezoneMessages,L)}get _selectedItem(){const e=this.value,t=this._gmtOffsets;return r(e)||r(t)?null:t.find((t=>t.utcOffset===e))}get _selectedItemText(){const e=this._selectedItem;return n(e)?e.short:""}_onDropdownSelectChange(e){const t=e.target,i=parseInt(t?.value,10);Number.isFinite(i)&&n(this.onChange)&&this.onChange(i)}_onFocus(){this._focused=!0}_onBlur(){this._focused=!1}};var ge;e([p()],_e.prototype,"value",void 0),e([p()],_e.prototype,"onChange",void 0),e([p(),I("esri/widgets/support/t9n/timezone")],_e.prototype,"_timezoneMessages",void 0),e([p()],_e.prototype,"_focused",void 0),e([p({readOnly:!0})],_e.prototype,"_gmtOffsets",null),e([p({readOnly:!0})],_e.prototype,"_selectedItem",null),e([p({readOnly:!0})],_e.prototype,"_selectedItemText",null),_e=e([u("esri.widgets.ShadowCast.components.TimezonePicker")],_e),function(e){e.Slider="slider"}(ge||(ge={}));const be={hour:"2-digit",minute:"2-digit",timeZone:"UTC"},ke=/(.*)\s(.*)/,Ce={labelFormatFunction:F,min:0,max:1439,steps:15,rangeLabelInputsEnabled:!1,visibleElements:{labels:!1,rangeLabels:!1},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:(e,t,i)=>{t.classList.add(H.timeRangePrimaryTick),i.classList.add(H.timeRangePrimaryTickLabel);const o=i.innerText.match(ke);o&&(i.innerHTML=`${o[1]}<br><div class="${H.timeRangeAMPMLabel}">${o[2]}</div>`)}},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:(e,t)=>{t.classList.add(H.timeRangeSecondaryTick)}}]};let ye=class extends v{constructor(e,t){super(e,t),this.viewModel=null,this.headingLevel=4,this.iconClass=H.widgetIcon,this.visibleElements=new ee,this._handles=new i,this._defaultViewModel=null,this._timeSlider=new m({...Ce,container:document.createElement("div")}),this._tooltip=null,this._onTimezoneChange=e=>{this.viewModel.utcOffset=e},this._onDateChange=e=>{this.viewModel.date=e},e?.viewModel||(this._defaultViewModel=new g({view:e?.view}),this.viewModel=this._defaultViewModel)}initialize(){this._handles.add([c((()=>({viewModel:this.viewModel,slider:this._timeSlider})),(e=>this._connectTimeSlider(e)),d),c((()=>({container:o(this.view,(e=>e.surface)),viewModel:this.viewModel,tooltipVisible:this.visibleElements.tooltip})),(({container:e,viewModel:t,tooltipVisible:i})=>{this._tooltip=s(this._tooltip),!r(e)&&i&&(this._tooltip=new me({viewModel:t,container:e}))}),d),c((()=>({viewModel:this.viewModel,visible:this.visible})),(({viewModel:e,visible:t})=>e.setRunning(t)),d)])}destroy(){this._handles=s(this._handles),this._timeSlider=s(this._timeSlider),n(this._defaultViewModel)&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}loadDependencies(){return _({select:()=>import("../chunks/calcite-select.js"),option:()=>import("../chunks/calcite-option.js")})}render(){const{visibleElements:e,viewModel:t}=this,i=t.state===k.Disabled;return T("div",{key:this,class:this.classes(H.base,H.esriWidget,{[H.esriWidgetDisabled]:i})},this._renderTimeRangeSection(),e.visualizationOptions&&this._renderVisualizationOptionsSection())}get view(){return this.viewModel?.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get testData(){return{tooltip:this._tooltip}}_connectTimeSlider({viewModel:e,slider:t}){if(this._handles.remove(ge.Slider),r(t))return;const i=e=>h(e,"milliseconds","minutes"),o=e=>h(e,"minutes","milliseconds"),s=({index:t,value:i})=>{0===t?e.startTimeOfDay=o(i):e.endTimeOfDay=o(i)};this._handles.add([c((()=>[e.startTimeOfDay,e.endTimeOfDay]),(e=>{t.values=e.map(i)}),d),t.on("thumb-change",s),t.on("thumb-drag",s),t.on("segment-drag",(()=>{[e.startTimeOfDay,e.endTimeOfDay]=t.values.map(o)}))],ge.Slider)}_renderTimeRangeSection(){const{visibleElements:e}=this;return e.timeRangeSlider||e.datePicker?T("section",{key:"time-range",class:H.timeRange},T(A,{level:this.headingLevel},this.messages.timeLabel),e.timeRangeSlider&&this._renderTimeRange(),e.datePicker&&this._renderDatePicker()):null}_renderTimeRange(){const{messages:e,viewModel:i,visibleElements:o}=this,{startTimeOfDay:s,endTimeOfDay:n}=i,[r,a]=[s,n].map((e=>$(new Date(e),be)));return[T("div",{key:"time-range-indicator",class:H.timeRangeIndicator},t(e.timeRange,{start:r,end:a}),o.timezone&&T(_e,{value:i.utcOffset,onChange:this._onTimezoneChange})),T("div",{key:"time-slider-container",bind:this,afterCreate:this._timeSliderContainerAfterCreate,afterRemoved:this._timeSliderContainerAfterRemoved})]}_timeSliderContainerAfterCreate(e){const t=l(this._timeSlider)?.container;t&&e.appendChild(t)}_timeSliderContainerAfterRemoved(e){const t=l(this._timeSlider)?.container;t&&e.removeChild(t)}_renderDatePicker(){return T("div",{key:"date-picker",class:H.datePickerContainer},T(R,{value:this.viewModel.date,onChange:this._onDateChange}))}_renderVisualizationOptionsSection(){const{headingLevel:e,messages:t,viewModel:i,visibleElements:o}=this,s=o.colorPicker,n=e=>this.classes(i.visualizationType===e?null:H.visualizationConfigHidden);return T("section",{key:"visualization",class:H.visualization},T(A,{level:e},t.visualizationLabel),this._renderVisualizationSelect(),T("div",{key:"threshold-configurator",class:n(C.Threshold)},T(ve,{options:i.thresholdOptions,colorPickerVisible:s})),T("div",{key:"duration-configurator",class:n(C.Duration)},T(ce,{options:i.durationOptions,colorPickerVisible:s})),T("div",{key:"discrete-configurator",class:n(C.Discrete)},T(le,{options:i.discreteOptions,colorPickerVisible:s})))}_renderVisualizationSelect(){const e=this.messages,t=this.viewModel.visualizationType;return T("calcite-select",{class:H.visualizationSelect,key:"visualization-select",label:e.visualizationLabel,bind:this,onCalciteSelectChange:this._onVisualizationTypeChange},[{type:C.Threshold,label:e.threshold.label},{type:C.Duration,label:e.duration.label},{type:C.Discrete,label:e.discrete.label}].map((({type:e,label:i})=>T("calcite-option",{value:e,selected:e===t},i))))}_onVisualizationTypeChange(e){const t=e.target,i=t.selectedOption?.value;this.viewModel.visualizationType=i??C.Threshold}};e([p()],ye.prototype,"viewModel",void 0),e([p()],ye.prototype,"view",null),e([p()],ye.prototype,"headingLevel",void 0),e([p()],ye.prototype,"iconClass",void 0),e([p()],ye.prototype,"label",null),e([p({type:ee,nonNullable:!0})],ye.prototype,"visibleElements",void 0),e([p(),I("esri/widgets/ShadowCast/t9n/ShadowCast")],ye.prototype,"messages",void 0),e([p()],ye.prototype,"_defaultViewModel",void 0),e([p()],ye.prototype,"_timeSlider",void 0),e([p()],ye.prototype,"_tooltip",void 0),ye=e([u("esri.widgets.ShadowCast")],ye);const fe=ye;export{fe as default};
