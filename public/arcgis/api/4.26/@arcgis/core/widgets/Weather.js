/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{i as s}from"../chunks/maybe.js";import{m as t}from"../chunks/memoize.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import"../chunks/ensureType.js";import"../chunks/typedArrayUtil.js";import{subclass as r}from"../core/accessorSupport/decorators/subclass.js";import{b as i}from"../chunks/weather.js";import n,{l as a}from"./Widget.js";import{H as l}from"../chunks/Heading.js";import{c}from"../chunks/widgetUtils.js";import{m as d}from"../chunks/messageBundle.js";import{t as p,a as h}from"../chunks/jsxFactory.js";import u,{W as m,a as g}from"./Weather/WeatherViewModel.js";import v from"../core/Accessor.js";import"../chunks/Logger.js";import"../config.js";import"../chunks/object.js";import"../core/lang.js";import"../chunks/string.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/metadata.js";import"../core/Error.js";import"../chunks/tracking.js";import"../views/3d/environment/CloudyWeather.js";import"../core/JSONSupport.js";import"../core/Handles.js";import"../chunks/ArrayPool.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../core/promiseUtils.js";import"../chunks/enumeration.js";import"../chunks/jsonMap.js";import"../views/3d/environment/FoggyWeather.js";import"../views/3d/environment/RainyWeather.js";import"../views/3d/environment/SnowyWeather.js";import"../views/3d/environment/SunnyWeather.js";import"../intl.js";import"../chunks/number.js";import"../chunks/locale.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Promise.js";import"../core/reactiveUtils.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/dom.js";import"../chunks/index.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/common.js";import"../chunks/vec4.js";const b="esri-weather",y={base:b,esriWidget:"esri-widget",esriWidgetDisabled:"esri-widget--disabled",widgetIcon:"esri-icon-partly-cloudy",content:`${b}__content`,hasError:`${b}__content--has-error`,selector:`${b}__selector`,options:`${b}__options`,error:`${b}__error`,warning:`${b}__warning`},j={base:`${b}__labeled-slider`};let w=class extends n{constructor(e){super(e),this._onChange=e=>{const s=e.target.value;this.onChange(s)}}render(){const{label:e}=this;return p("div",{class:j.base},p("calcite-label",{scale:"s"},e,p("calcite-slider",{"aria-label":e,disabled:this.disabled,max:1,min:0,step:.01,value:this.value,onCalciteSliderInput:this._onChange,onCalciteSliderChange:this._onChange})))}loadDependencies(){return a({label:()=>import("../chunks/calcite-label.js"),slider:()=>import("../chunks/calcite-slider.js")})}};e([o()],w.prototype,"value",void 0),e([o()],w.prototype,"onChange",void 0),e([o()],w.prototype,"disabled",void 0),w=e([r("esri.widgets.Weather.LabeledSlider")],w);let k=class extends v{constructor(){super(...arguments),this.header=!0}};e([o({type:Boolean,nonNullable:!0})],k.prototype,"header",void 0),k=e([r("esri.widgets.Weather.VisibleElements")],k);const C=k,_={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let f=class extends n{constructor(e){super(e),this.viewModel=new u,this.headingLevel=4,this.visibleElements=new C,this.iconClass=y.widgetIcon,this._renderWeatherTypeButton=e=>{const s=this.viewModel,t=this.messages[e].label,o=s.state===m.Disabled,r=!o&&s.current.type===e;return p("calcite-button",{appearance:r?"solid":"outline","aria-checked":r?"true":"false",kind:r?"brand":"neutral",disabled:o,iconStart:_[e],key:`${e}-type-button`,label:t,scale:"l",title:t,onclick:()=>{r||s.setWeatherByType(e)}})},this._memoizedCallbacks=t((e=>({onCloudCoverChange:s=>{"cloudCover"in e&&(e.cloudCover=s)},onPrecipitationChange:s=>{"precipitation"in e&&(e.precipitation=s)},onFogStrengthChange:s=>{"fogStrength"in e&&(e.fogStrength=s)},onSnowCoverChange:e=>{this.viewModel.setSnowCoverEnabled(e.target.checked)}})))}render(){const e=this.viewModel.state===m.Disabled;return p("div",{class:this.classes(y.base,y.esriWidget,e&&y.esriWidgetDisabled),role:"region","aria-label":this.messages.widgetLabelAccessible},this._renderContent())}loadDependencies(){return a({button:()=>import("../chunks/calcite-button.js"),checkbox:()=>import("../chunks/calcite-checkbox.js"),icon:()=>import("../chunks/calcite-icon.js"),label:()=>import("../chunks/calcite-label.js")})}get view(){return this.viewModel?.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get _errorMessage(){const e=this.messages.error;switch(this.viewModel.error){case g.LocalScene:return e.localScene;case g.NoAtmosphere:return e.noAtmosphere;case g.UnsupportedView:return e.unsupported;default:return null}}get _warningMessage(){return this.viewModel.error===g.NotVisible&&s(this.view)&&"3d"===this.view?.type&&this.view.environment.atmosphereEnabled?this.messages.error.notVisible:null}_renderContent(){const e=this.messages,t=this._warningMessage,o=this.viewModel.state===m.Error;return p(h,null,this.visibleElements.header&&p(l,{level:this.headingLevel},e.widgetLabel),o&&p("div",{key:"error",class:y.error},this._errorMessage),p("div",{key:"content",class:c({[y.content]:!0,[y.hasError]:o})},p("div",{class:y.selector,role:"radiogroup","aria-label":e.weatherType},i.map(this._renderWeatherTypeButton)),p("div",{class:y.options},this._renderOptions()),s(t)&&this._renderWarning(t)))}_renderOptions(){const{viewModel:e,messages:s}=this,t=e.state===m.Disabled,o=e.current,r=this._memoizedCallbacks(o);switch(o.type){case"sunny":return p(w,{key:"sunny-cover",disabled:t,label:s.sunny.cloudCover,value:o.cloudCover,onChange:r.onCloudCoverChange});case"cloudy":return p(w,{key:"cloudy-cover",disabled:t,label:s.cloudy.cloudCover,value:o.cloudCover,onChange:r.onCloudCoverChange});case"rainy":return p(h,null,p(w,{key:"rainy-cover",disabled:t,label:s.rainy.cloudCover,value:o.cloudCover,onChange:r.onCloudCoverChange}),p(w,{key:"rainy-precipitation",disabled:t,label:s.rainy.precipitation,value:o.precipitation,onChange:r.onPrecipitationChange}));case"snowy":return p(h,null,p(w,{key:"snowy-cloud-cover",disabled:t,label:s.snowy.cloudCover,value:o.cloudCover,onChange:r.onCloudCoverChange}),p(w,{key:"snowy-precipitation",disabled:t,label:s.snowy.precipitation,value:o.precipitation,onChange:r.onPrecipitationChange}),p("calcite-label",{key:"snow-cover",scale:"s",layout:"inline",title:s.snowy.snowCoverTooltip},p("calcite-checkbox",{checked:"enabled"===o.snowCover,disabled:t,onCalciteCheckboxChange:r.onSnowCoverChange}),s.snowy.snowCover));case"foggy":return p(w,{key:"foggy-cover",disabled:t,label:s.foggy.fogStrength,value:o.fogStrength,onChange:r.onFogStrengthChange})}}_renderWarning(e){return p("div",{key:"warning",class:y.warning},p("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)}};e([o()],f.prototype,"viewModel",void 0),e([o()],f.prototype,"view",null),e([o()],f.prototype,"headingLevel",void 0),e([o({type:C,nonNullable:!0})],f.prototype,"visibleElements",void 0),e([o()],f.prototype,"iconClass",void 0),e([o()],f.prototype,"label",null),e([o(),d("esri/widgets/Weather/t9n/Weather")],f.prototype,"messages",void 0),e([o()],f.prototype,"_errorMessage",null),e([o()],f.prototype,"_warningMessage",null),f=e([r("esri.widgets.Weather")],f);const S=f;export{S as default};
