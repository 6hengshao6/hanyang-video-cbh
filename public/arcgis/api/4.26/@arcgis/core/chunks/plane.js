/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{i as n}from"./maybe.js";import{g as r,b as s,a as o,m as c,h as e,c as a,d as i,s as u,j as f,n as I}from"./vec3.js";import"./typedArrayUtil.js";import"./Logger.js";import{p as N}from"./vector.js";import{s as m,a as g}from"./ray.js";import{t as M}from"./mathUtils2.js";function p(t=Q){return[t[0],t[1],t[2],t[3]]}function E(t=Q[0],n=Q[1],r=Q[2],s=Q[3]){return j(t,n,r,s,g.get())}function h(t,n){return j(n[0],n[1],n[2],n[3],t)}function j(t,n,r,s,o=p()){return o[0]=t,o[1]=n,o[2]=r,o[3]=s,o}function A(t,n,r){return a(r,t),r[3]=n,r}function F(t,n,r){const s=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],o=Math.abs(s-1)>1e-5&&s>1e-12?1/Math.sqrt(s):1;return r[0]=n[0]*o,r[1]=n[1]*o,r[2]=n[2]*o,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function T(t,n,r,s=p()){const o=r[0]-n[0],c=r[1]-n[1],e=r[2]-n[2],a=t[0]-n[0],i=t[1]-n[1],u=t[2]-n[2],f=c*u-e*i,I=e*a-o*u,N=o*i-c*a,m=f*f+I*I+N*N,g=Math.abs(m-1)>1e-5&&m>1e-12?1/Math.sqrt(m):1;return s[0]=f*g,s[1]=I*g,s[2]=N*g,s[3]=-(s[0]*t[0]+s[1]*t[1]+s[2]*t[2]),s}function _(t,n,r,o,e){const a=t.length/3;if(a<3)return!1;u(l,t[3*r],t[3*r+1],t[3*r+2]);let i=o,N=!1;for(;i<a-1&&!N;){const n=3*i;u(b,t[n],t[n+1],t[n+2]),i++,N=!f(l,b)}if(!N)return!1;for(i=Math.max(i,e),N=!1;i<a&&!N;){const n=3*i;u(d,t[n],t[n+1],t[n+2]),i++,s(v,l,b),I(v,v),s(L,b,d),I(L,L),N=!f(l,d)&&!f(b,d)&&Math.abs(c(v,L))<y}return N?(T(l,b,d,n),!0):(0!==r||1!==o||2!==e)&&_(t,n,0,1,2)}const y=.99619469809,l=i(),b=i(),d=i(),v=i(),L=i();function X(t,n,r){return n!==t&&h(t,n),t[3]=-c(t,r),t}function C(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function P(t,n,r,s){return e(d,n,t),F(r,d,s)}function q(t,n,r,o){return J(t,n,s(m.get(),r,n),S,o)}function O(t,r,s){return!!n(r)&&J(t,r.origin,r.direction,V,s)}function U(t,n,r){return J(t,n.origin,n.vector,R.NONE,r)}function x(t,n,r){return J(t,n.origin,n.vector,R.CLAMP,r)}function k(t,n){return H(t,n)>=0}function w(t,n){const r=c(t,n.ray.direction),s=-H(t,n.ray.origin);if(s<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return s>0;if((s<0||r<0)&&!(s<0&&r<0))return!0;const o=s/r;return r>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function z(t,n){const r=c(t,n.ray.direction),s=-H(t,n.ray.origin);if(r>-1e-6&&r<1e-6)return s>0;const o=s/r;return r>0?o<n.c1&&(n.c1=o):o>n.c0&&(n.c0=o),n.c0<=n.c1}function B(t,n,c){const e=r(m.get(),t,-t[3]),a=G(t,s(m.get(),n,e),m.get());return o(c,a,e),c}function D(t,n,r,o){const c=t,e=m.get(),a=m.get();M(c,e,a);const i=s(m.get(),r,n),f=N(e,i),I=N(a,i),g=N(c,i);return u(o,f,I,g)}function G(t,n,o){const e=r(m.get(),t,c(t,n));return s(o,n,e),o}function H(t,n){return c(t,n)+t[3]}function J(n,s,e,a,i){const u=c(n,e);if(0===u)return!1;let f=-(c(n,s)+n[3])/u;return a&R.CLAMP&&(f=t(f,0,1)),!(!(a&R.INFINITE_MIN)&&f<0||!(a&R.INFINITE_MAX)&&f>1||(o(i,s,r(i,e,f)),0))}function K(t){return t}const Q=[0,0,1,0];var R;!function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"}(R||(R={}));const S=R.INFINITE_MIN|R.INFINITE_MAX,V=R.INFINITE_MAX;export{h as a,q as b,p as c,T as d,z as e,F as f,w as g,O as h,k as i,P as j,X as k,j as l,U as m,K as n,x as o,D as p,B as q,A as r,H as s,C as t,G as u,_ as v,E as w};
