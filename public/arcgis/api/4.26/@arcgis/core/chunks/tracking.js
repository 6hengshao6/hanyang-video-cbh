/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import"./typedArrayUtil.js";import{L as t}from"./Logger.js";import{a as e,g as n}from"./utils.js";var r;!function(t){t[t.Dirty=1]="Dirty",t[t.Overriden=2]="Overriden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"}(r||(r={}));const i={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},c=[];let o=i;function a(t){o.onObservableAccessed(t)}let s=!1,l=!1;function u(t,e,n){if(s)return f(t,e,n);p(t);const r=e.call(n);return d(),r}function g(t,e){return u(i,t,e)}function f(e,n,r){const i=s;s=!0,p(e);let c=null;try{c=n.call(r)}catch(e){l&&t.getLogger("esri.core.accessorSupport.tracking").error(e)}return d(),s=i,c}function p(t){o=t,c.push(t)}function d(){const t=c.length;if(t>1){const e=c.pop();o=c[t-2],e.onTrackingEnd()}else if(1===t){const t=c.pop();o=i,t.onTrackingEnd()}else o=i}function y(t,e){const n=e.observerObject;if(n.flags&r.DepTrackingInitialized)return;const i=l;l=!1,n.flags&r.AutoTracked?f(e,e.metadata.get,t):b(t,e),l=i}const k=[];function b(t,n){const i=n.observerObject;i.flags&r.ExplicitlyTracking||(i.flags|=r.ExplicitlyTracking,f(n,(()=>{const r=n.metadata.dependsOn||k;for(const n of r)if("string"!=typeof n||n.includes(".")){const r=e(n);for(let e=0,n=t;e<r.length&&null!=n&&"object"==typeof n;++e)n=T(n,r[e],e!==r.length-1)}else T(t,n,!1)})),i.flags&=~r.ExplicitlyTracking)}function T(t,e,r){const i="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(i,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.getItemAt(e)}const c=n(t),o=c?.properties.get(i);return o&&(a(o.observerObject),y(t,o)),r?t[i]:void 0}export{r as F,b as a,g as b,y as i,u as r,a as t};
