/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{a as t}from"./maybe.js";import{n as e}from"./unitUtils.js";import{validateFieldValue as n,validationErrorToString as i,isNumericField as s,isStringField as r,sanitizeNullFieldValue as o}from"../layers/support/fieldUtils.js";class l{constructor(){this.code=null,this.description=null}}class a{constructor(t){this.error=new l,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=t}}function u(t){return new a(t)}class c{constructor(t){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t}}function f(t){return new c(t)}const d=new Set;function m(t,e,s,r=!1,o){d.clear();for(const l in s){const a=t.get(l);if(!a)continue;const c=s[l],f=h(a,c);if(f!==c&&o&&o.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:a,originalValue:c,sanitizedValue:f}}),d.add(a.name),a&&(r||a.editable)){const t=n(a,f);if(t)return u(i(t,a,f));e[a.name]=f}}for(const e of t?.requiredFields??[])if(!d.has(e.name))return u(`missing required field "${e.name}"`);return null}function h(t,e){let n=e;return"string"==typeof e&&s(t)?n=parseFloat(e):null!=e&&r(t)&&"string"!=typeof e&&(n=String(e)),o(n)}let p;function g(n,i){if(!n||!e(i))return n;if("rings"in n||"paths"in n){if(t(p))throw new TypeError("geometry engine not loaded");return p.simplify(i,n)}return n}async function y(n,i){!e(n)||"esriGeometryPolygon"!==i&&"esriGeometryPolyline"!==i||await async function(){return t(p)&&(p=await import("./geometryEngineJSON.js").then((t=>t.g))),p}()}export{u as a,f as c,y as l,m,g as s};
