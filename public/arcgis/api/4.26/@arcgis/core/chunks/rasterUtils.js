/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{a as e}from"./maybe.js";import{Z as t}from"./vec2f64.js";import{C as a}from"./context-util.js";import{a as n,T as s,P as i,S as r,c as o,b as u,r as f}from"./enums3.js";import{T as m}from"./Texture.js";function c(e,t,f="nearest",c=!1){const l=!(c&&"u8"===t.pixelType),_=l?n.FLOAT:n.UNSIGNED_BYTE,p=null==t.pixels||0===t.pixels.length?null:l?t.getAsRGBAFloat():t.getAsRGBA(),g=e.capabilities.textureFloat?.textureFloatLinear,T={width:t.width,height:t.height,target:s.TEXTURE_2D,pixelFormat:i.RGBA,internalFormat:e.type===a.WEBGL2&&l?r.RGBA32F:i.RGBA,samplingMode:!g||"bilinear"!==f&&"cubic"!==f?o.NEAREST:o.LINEAR,dataType:_,wrapMode:u.CLAMP_TO_EDGE,flipped:!1};return new m(e,T,p)}function l(e,t){const{spacing:f,offsets:c,coefficients:l,size:[_,p]}=t,g=f[0]>1,T={width:g?4*_:_,height:p,target:s.TEXTURE_2D,pixelFormat:i.RGBA,internalFormat:e.type===a.WEBGL2?r.RGBA32F:i.RGBA,dataType:n.FLOAT,samplingMode:o.NEAREST,wrapMode:u.CLAMP_TO_EDGE,flipped:!1},E=new Float32Array(g?_*p*16:2*c.length);if(g&&null!=l)for(let e=0,t=0;e<l.length;e++)E[t++]=l[e],e%3==2&&(E[t++]=1);else for(let e=0;e<p;e++)for(let t=0;t<_;t++){const a=4*(e*_+t),n=2*(t*p+e);E[a]=c[n],E[a+1]=c[n+1],E[a+3]=-1===c[n]?0:1}return new m(e,T,E)}function _(e,t){const a={width:t.length/4,height:1,target:s.TEXTURE_2D,pixelFormat:i.RGBA,internalFormat:i.RGBA,dataType:n.UNSIGNED_BYTE,samplingMode:o.NEAREST,wrapMode:u.CLAMP_TO_EDGE,flipped:!1};return new m(e,a,t)}function p(e,a,n,s=1,i=!0){return{u_flipY:i,u_applyTransform:!!e,u_opacity:s,u_transformSpacing:e?e.spacing:t,u_transformGridSize:e?e.size:t,u_targetImageSize:a,u_srcImageSize:n}}function g(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function T(e,t){return{u_scale:e,u_offset:t}}function E(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function A(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function h(t,a){const n=t.gl,s=a.glName,i=new Map;if(e(s))return i;const r=n.getProgramParameter(s,n.ACTIVE_UNIFORMS);let o;for(let e=0;e<r;e++)o=n.getActiveUniform(s,e),o&&i.set(o.name,{location:n.getUniformLocation(s,o.name),info:o});return i}function O(e,t,a){Object.keys(a).forEach((n=>{const s=t.get(n)||t.get(n+"[0]");s&&function(e,t,a,n){if(null===n||null==a)return!1;const{info:s}=n;switch(s.type){case f.FLOAT:s.size>1?e.setUniform1fv(t,a):e.setUniform1f(t,a);break;case f.FLOAT_VEC2:e.setUniform2fv(t,a);break;case f.FLOAT_VEC3:e.setUniform3fv(t,a);break;case f.FLOAT_VEC4:e.setUniform4fv(t,a);break;case f.FLOAT_MAT3:e.setUniformMatrix3fv(t,a);break;case f.FLOAT_MAT4:e.setUniformMatrix4fv(t,a);break;case f.INT:s.size>1?e.setUniform1iv(t,a):e.setUniform1i(t,a);break;case f.BOOL:e.setUniform1i(t,a?1:0);break;case f.INT_VEC2:case f.BOOL_VEC2:e.setUniform2iv(t,a);break;case f.INT_VEC3:case f.BOOL_VEC3:e.setUniform3iv(t,a);break;case f.INT_VEC4:case f.BOOL_VEC4:e.setUniform4iv(t,a)}}(e,n,a[n],s)}))}function d(e,t,a,n){a.length===n.length&&(n.some((e=>null==e))||a.some((e=>null==e))||a.forEach(((a,s)=>{t.setUniform1i(a,s),e.bindTexture(n[s],s)})))}export{g as a,E as b,l as c,A as d,c as e,_ as f,p as g,O as h,h as i,T as j,d as s};
