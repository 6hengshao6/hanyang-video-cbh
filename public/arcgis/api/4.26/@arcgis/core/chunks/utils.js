/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{h as r}from"./handleUtils.js";import{clone as t}from"../core/lang.js";import{b as n}from"./maybe.js";function a(r){return r?r.__accessor__?r.__accessor__:r.propertyInvalidated?r:null:null}function e(r,t){return null!=r&&r.metadatas&&null!=r.metadatas[t]}function s(r,t,n){return i(r,t,n?{policy:n,path:""}:null)}function i(r,a,e){return a?Object.keys(a).reduce(((r,s)=>{let o=null,u="merge";if(e&&(o=e.path?`${e.path}.${s}`:s,u=e.policy(o)),"replace"===u)return r[s]=a[s],r;if("replace-arrays"===u&&Array.isArray(r[s]))return r[s]=a[s],r;if(void 0===r[s])return r[s]=t(a[s]),r;let l=r[s],c=a[s];if(l===c)return r;if(Array.isArray(c)||Array.isArray(r))l=l?Array.isArray(l)?r[s]=l.concat():r[s]=[l]:r[s]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach((r=>{l.includes(r)||l.push(r)})));else if(c&&"object"==typeof c)if(e){const t=e.path;e.path=n(o),r[s]=i(l,c,e),e.path=t}else r[s]=i(l,c,null);else r.hasOwnProperty(s)&&!a.hasOwnProperty(s)||(r[s]=c);return r}),r||{}):r}function o(r){return Array.isArray(r)?r:r.split(".")}function u(r){return r.includes(",")?r.split(",").map((r=>r.trim())):[r.trim()]}function l(t,n,a,e){const s=function(r){if(Array.isArray(r)){const t=[];for(const n of r)t.push(...u(n));return t}return u(r)}(n);if(1!==s.length){const n=s.map((r=>e(t,r,a)));return r(n)}return e(t,s[0],a)}function c(r){let t=!1;return()=>{t||(t=!0,r())}}export{o as a,a as g,e as i,s as m,c as o,l as p};
