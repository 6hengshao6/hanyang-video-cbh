/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
import{_ as r}from"./tslib.es6.js";import t from"../core/Accessor.js";import{a as o,i as e,f as s,r as n}from"./maybe.js";import{onAbort as a,eachAlways as i,throwIfAbortError as l}from"../core/promiseUtils.js";import{property as u}from"../core/accessorSupport/decorators/property.js";import{subclass as c}from"../core/accessorSupport/decorators/subclass.js";function p(r,t,o){return i(r.map(((r,e)=>t.apply(o,[r,e]))))}async function h(r,t,o){return(await i(r.map(((r,e)=>t.apply(o,[r,e]))))).map((r=>r.value))}function m(r){return{ok:!0,value:r}}function f(r){return{ok:!1,error:r}}async function _(r){if(o(r))return{ok:!1,error:new Error("no promise provided")};try{return m(await r)}catch(r){return f(r)}}async function b(r){try{return m(await r)}catch(r){return l(r),f(r)}}function y(r){if(!0===r.ok)return r.value;throw r.error}function d(r,t){return new v(r,t)}let v=class extends t{get value(){return function(r){return e(r)&&!0===r.ok?r.value:null}(this._result)}get error(){return function(r){return e(r)&&!1===r.ok?r.error:null}(this._result)}get finished(){return e(this._result)}constructor(r,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=s(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:o}=this._abortController;this.promise=r(o),this.promise.then((r=>{this._result=m(r),this._cleanup()}),(r=>{this._result=f(r),this._cleanup()})),this._abortHandle=a(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=n(this._abortHandle),this._abortController=null}};r([u()],v.prototype,"value",null),r([u()],v.prototype,"error",null),r([u()],v.prototype,"finished",null),r([u()],v.prototype,"promise",void 0),r([u()],v.prototype,"_result",void 0),v=r([c("esri.core.asyncUtils.ReactiveTask")],v);export{b as a,y as b,d as c,p as f,h as m,_ as r};
