/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.27/esri/copyright.txt for details.
*/
const t=9999999e31,e=2e-7,n={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function s(t){return n[t]??[-34028234663852886e22,34028234663852886e22]}function a(n,a,u){if(n.depthCount&&n.depthCount>1)return;const{pixels:i,statistics:l,pixelType:o}=n,r=i[0].length,f=n.bandMasks??[],c=n.mask??new Uint8Array(r).fill(255),b="f32"===o||"f64"===o,m=s(o);let h=!1;for(let n=0;n<i.length;n++){const s="number"==typeof a?a:a[n];if(null==s)continue;const p=l?.[n].minValue??m[0],N=l?.[n].maxValue??m[1];if(p>s+Number.EPSILON||N<s-Number.EPSILON)continue;const M=f[n]||new Uint8Array(r).fill(255),d=i[n],A=u?.customFloatTolerance;if(b&&0!==A){let n=A;n||(n=Math.abs(s)>=t?e*Math.abs(s):"f32"===o?2**-23:Number.EPSILON);for(let t=0;t<d.length;t++)M[t]&&Math.abs(d[t]-s)<n&&(d[t]=0,M[t]=0,c[t]=0,h=!0)}else for(let t=0;t<d.length;t++)M[t]&&d[t]===s&&(d[t]=0,M[t]=0,c[t]=0,h=!0);f[n]=M}h&&(n.bandMasks=f,n.mask=c),h&&"updateStatistics"in n&&n.updateStatistics()}export{a as c,s as g};
