"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[7528,2058,3173],{30831:(e,t,s)=>{s.d(t,{I:()=>n});var r=s(91700);class n{constructor(e,t){this._storage=new r.M,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t){this._storage.put(e,t,1,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}}},85674:(e,t,s)=>{s.d(t,{O:()=>n,a:()=>i,b:()=>a,h:()=>o});var r=s(71252);class n{constructor(e=[],t=[],s=!1){this.lengths=e??[],this.coords=t??[],this.hasIndeterminateRingOrder=s}static fromRect(e){const[t,s,r,i]=e,o=r-t,a=i-s;return new n([5],[t,s,o,0,0,a,-o,0,0,-a])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((e,t)=>e+t))}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let s=0;s<this.lengths.length;s++){const r=this.lengths[s];for(let s=0;s<r;s++)e(this.coords[2*(s+t)],this.coords[2*(s+t)+1]);t+=r}}clone(e){return e?(e.set(this.coords),new n(this.lengths.slice(),e,this.hasIndeterminateRingOrder)):new n(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}class i{constructor(e=null,t={},s,r){this.geometry=e,this.attributes=t,this.centroid=s,this.objectId=r,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const e=new i(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}function o(e){return!((0,r.a)(e.geometry)||!e.geometry.coords||!e.geometry.coords.length)}class a extends i{}},9006:(e,t,s)=>{s.d(t,{O:()=>r});class r{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new r;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},77849:(e,t,s)=>{s.d(t,{Q:()=>N,S:()=>E,a:()=>T,b:()=>v,g:()=>F,h:()=>M,v:()=>_});var r=s(71252),n=s(44567),i=s(98380),o=s(71435),a=s(53785),l=s(60991),u=s(30831),c=s(72274),h=s(90529),d=s(24251);function f(e,t,s){return{objectId:e,target:t,distance:s,type:"vertex"}}function m(e,t,s,r,n,i=!1){return{objectId:e,target:t,distance:s,type:"edge",start:r,end:n,draped:i}}var g=s(4978),p=s(14249),y=s(60217);const x=new class{constructor(e,t){this._cache=new u.I(e),this._invalidCache=new u.I(t)}get(e,t){const s=`${t.uid}:${e}`,r=this._cache.get(s);if(r)return r;if(void 0!==this._invalidCache.get(s))return null;try{const r=c.WhereClause.create(e,t);return this._cache.put(s,r),r}catch{return this._invalidCache.put(s,null),null}}}(50,500),w="feature-store:unsupported-query",b=" as ",I=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function T(e,t){if(!t)return!0;const s=x.get(t,e);if(!s)throw new l.Z(w,"invalid SQL expression",{where:t});if(!s.isStandardized)throw new l.Z(w,"where clause is not standard",{where:t});return _(e,s.fieldNames,"where clause contains missing fields"),!0}function v(e,t,s){if(!t)return!0;const r=x.get(t,e);if(!r)throw new l.Z(w,"invalid SQL expression",{having:t});if(!r.isAggregate)throw new l.Z(w,"having does not contain a valid aggregate function",{having:t});const n=r.fieldNames;if(_(e,n,"having contains missing fields"),!r.getExpressions().every((t=>{const{aggregateType:r,field:n}=t,i=e.get(n)?.name;return s.some((t=>{const{onStatisticField:s,statisticType:n}=t,o=e.get(s)?.name;return o===i&&n.toLowerCase().trim()===r}))})))throw new l.Z(w,"expressions in having should also exist in outStatistics",{having:t});return!0}function F(e,t){return e?x.get(e,t):null}function _(e,t,s,r=!0){const n=[];for(const s of t)if("*"!==s&&!e.has(s))if(r){const t=S(s);try{const s=F(t,e);if(!s)throw new l.Z(w,"invalid SQL expression",{where:t});if(!s.isStandardized)throw new l.Z(w,"expression is not standard",{clause:s});_(e,s.fieldNames,"expression contains missing fields")}catch(e){const t=e&&e.details;if(t&&(t.clause||t.where))throw e;t&&t.missingFields?n.push(...t.missingFields):n.push(s)}}else n.push(s);if(n.length)throw new l.Z(w,s,{missingFields:n})}function S(e){return e.split(b)[0]}function M(e,t){const s=t.get(e);return!!s&&!I.has(s.type)}class q{constructor(e,t,s){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues??!1,this.fieldsIndex=s,this.featureAdapter=t;const r=e.outFields;if(r&&!r.includes("*")){this.outFields=r;let e=0;for(const t of r){const r=S(t),n=this.fieldsIndex.get(r),i=n?null:F(r,s),o=n?n.name:t.split(b)[1]||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:o,clause:i})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach((e=>this.getAttributes(e))),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,s){const r=s?s.name:t;let n=null;return this._fieldDataCache.has(r)?n=this._fieldDataCache.get(r)?.clause:s||(n=F(t,this.fieldsIndex),this._fieldDataCache.set(r,{alias:r,clause:n})),s?this.featureAdapter.getAttribute(e,r):n?.calculateValue(e,this.featureAdapter)}getDataValue(e,t){const s=t.normalizationType,r=t.normalizationTotal;let n=t.field&&this.getFieldValue(e,t.field,this.fieldsIndex.get(t.field));if(t.field2&&(n=`${(0,h.p)(n)}${t.fieldDelimiter}${(0,h.p)(this.getFieldValue(e,t.field2,this.fieldsIndex.get(t.field2)))}`,t.field3&&(n=`${n}${t.fieldDelimiter}${(0,h.p)(this.getFieldValue(e,t.field3,this.fieldsIndex.get(t.field3)))}`)),s&&Number.isFinite(n)){const i="field"===s&&t.normalizationField?this.getFieldValue(e,t.normalizationField,this.fieldsIndex.get(t.normalizationField)):null;n=(0,h.g)(n,s,i,r)}return n}getExpressionValue(e,t,s,r){const n={attributes:this.featureAdapter.getAttributes(e),layer:{fields:this.fieldsIndex.fields}},i=r.createExecContext(n,s);return r.executeFunction(t,i)}getExpressionValues(e,t,s,r){const n={fields:this.fieldsIndex.fields};return e.map((e=>{const i={attributes:this.featureAdapter.getAttributes(e),layer:n},o=r.createExecContext(i,s);return r.executeFunction(t,o)}))}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:F(t,this.fieldsIndex)}),this._fieldDataCache.get(t)?.clause?.testFeature(e,this.featureAdapter)??!1}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:F(t,this.fieldsIndex)}),this._fieldDataCache.get(t)?.clause?.testSet(e,this.featureAdapter)??!1}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const s={};for(const r of t){const{alias:t,clause:n}=this._fieldDataCache.get(r);s[t]=n?n.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return s}_processAttributesForDistinctValues(e){if((0,r.a)(e)||!this.returnDistinctValues)return e;const t=this.outFields,s=[];if(t)for(const r of t){const{alias:t}=this._fieldDataCache.get(r);s.push(e[t])}else for(const t in e)s.push(e[t]);const n=`${(t||["*"]).join(",")}=${s.join(",")}`;let i=this._returnDistinctMap.get(n)||0;return this._returnDistinctMap.set(n,++i),i>1?null:e}}class N{constructor(e,t,s){this.items=e,this.query=t,this.geometryType=s.geometryType,this.hasM=s.hasM,this.hasZ=s.hasZ,this.fieldsIndex=s.fieldsIndex,this.objectIdField=s.objectIdField,this.spatialReference=s.spatialReference,this.featureAdapter=s.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new q(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:s,outStatistics:r}=this.query,n=t?.length;if(!n)return 1;const i=new Map,o=new Map,a=new Set;for(const n of r){const{statisticType:r}=n,l="exceedslimit"!==r?n.onStatisticField:void 0;if(!o.has(l)){const s=[];for(const r of t){const t=this._getAttributeValues(e,r,i);s.push(t)}o.set(l,this._calculateUniqueValues(s,e.returnDistinctValues))}const u=o.get(l);for(const t in u){const{data:r,items:n}=u[t],i=r.join(",");s&&!e.validateItems(n,s)||a.add(i)}}return a.size}async createQueryResponse(){let e;if(e=this.query.outStatistics?this.query.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query),this.query.returnQueryGeometry){const t=this.query.geometry;(0,a.n)(this.query.outSR)&&!(0,a.f)(t.spatialReference,this.query.outSR)?e.queryGeometry=(0,g.c)({spatialReference:this.query.outSR,...(0,d.p)(t,t.spatialReference,this.query.outSR)}):e.queryGeometry=(0,g.c)({spatialReference:this.query.outSR,...t})}return e}createSnappingResponse(e,t){const s=this.featureAdapter,n=P(this.hasZ,this.hasM),{point:i,mode:o}=e,a="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,u={candidates:[]},c="esriGeometryPolygon"===this.geometryType,h=this._getPointCreator(o,this.spatialReference,t),d=new O(null,0),g=new O(null,0),p={x:0,y:0,z:0};for(const t of this.items){const o=s.getGeometry(t);if((0,r.a)(o))continue;const{coords:y,lengths:x}=o;if(d.coords=y,g.coords=y,e.types&E.EDGE){let e=0;for(let r=0;r<x.length;r++){const o=x[r];for(let r=0;r<o;r++,e+=n){const c=d;if(c.coordsIndex=e,r!==o-1){const r=g;r.coordsIndex=e+n;const o=p;R(p,i,c,r);const d=(i.x-o.x)/a,f=(i.y-o.y)/l,y=d*d+f*f;y<=1&&u.candidates.push(m(s.getObjectId(t),h(o),Math.sqrt(y),h(c),h(r)))}}}}if(e.types&E.VERTEX){const e=c?y.length-n:y.length;for(let r=0;r<e;r+=n){const e=d;e.coordsIndex=r;const n=(i.x-e.x)/a,o=(i.y-e.y)/l,c=n*n+o*o;c<=1&&u.candidates.push(f(s.getObjectId(t),h(e),Math.sqrt(c)))}}}return u.candidates.sort(((e,t)=>e.distance-t.distance)),u}_getPointCreator(e,t,s){const n=(0,r.i)(s)&&!(0,a.f)(t,s)?e=>(0,d.p)(e,t,s):e=>e,{hasZ:i}=this;return"3d"===e?i?({x:e,y:t,z:s})=>n({x:e,y:t,z:s}):({x:e,y:t})=>n({x:e,y:t,z:0}):({x:e,y:t})=>n({x:e,y:t})}async createSummaryStatisticsResponse(e){const{field:t,valueExpression:s,normalizationField:r,normalizationType:n,normalizationTotal:i,minValue:o,maxValue:a,scale:l}=e,u=this.fieldsIndex.isDateField(t),c=await this._getDataValues({field:t,valueExpression:s,normalizationField:r,normalizationType:n,normalizationTotal:i,scale:l}),d=(0,h.i)({normalizationType:n,normalizationField:r,minValue:o,maxValue:a}),f=this.fieldsIndex.get(t),m={value:.5,fieldType:f?.type},g=(0,p.qN)(f)?(0,h.c)({values:c,supportsNullCount:d,percentileParams:m}):(0,h.a)({values:c,minValue:o,maxValue:a,useSampleStdDev:!n,supportsNullCount:d,percentileParams:m});return(0,h.b)(g,u)}async createUniqueValuesResponse(e){const{field:t,valueExpression:s,domains:r,returnAllCodedValues:n,scale:i}=e,o=await this._getDataValues({field:t,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,valueExpression:s,scale:i}),a=(0,h.d)(o);return(0,h.e)(a,r,n,e.fieldDelimiter)}async createClassBreaksResponse(e){const{field:t,valueExpression:s,normalizationField:r,normalizationType:n,normalizationTotal:i,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:u,numClasses:c,scale:d}=e,f=await this._getDataValues({field:t,valueExpression:s,normalizationField:r,normalizationType:n,normalizationTotal:i,scale:d}),m=(0,h.f)(f,{field:t,normalizationField:r,normalizationType:n,normalizationTotal:i,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:u,numClasses:c});return(0,h.r)(m,o)}async createHistogramResponse(e){const{field:t,valueExpression:s,normalizationField:r,normalizationType:n,normalizationTotal:i,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:u,numBins:c,scale:d}=e,f=await this._getDataValues({field:t,valueExpression:s,normalizationField:r,normalizationType:n,normalizationTotal:i,scale:d});return(0,h.h)(f,{field:t,normalizationField:r,normalizationType:n,normalizationTotal:i,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:u,numBins:c})}_sortFeatures(e,t,s){if(e.length>1&&t&&t.length)for(const r of t.reverse()){const t=r.split(" "),n=t[0],i=this.fieldsIndex.get(n),o=!!t[1]&&"desc"===t[1].toLowerCase(),a=(0,h.j)(i?.type,o);e.sort(((e,t)=>{const r=s(e,n,i),o=s(t,n,i);return a(r,o)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:s,hasM:r,hasZ:n,objectIdField:i,spatialReference:a}=this,{outFields:l,outSR:u,quantizationParameters:c,resultRecordCount:h,resultOffset:d,returnZ:f,returnM:m}=e,p=null!=h&&t.length>(d||0)+h,y=l&&(l.includes("*")?[...this.fieldsIndex.fields]:l.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:p,features:this._createFeatures(e,t),fields:y,geometryType:s,hasM:r&&m,hasZ:n&&f,objectIdFieldName:i,spatialReference:(0,g.c)(u||a),transform:c&&(0,o.t)(c)||null}}_createFeatures(e,t){const s=new q(e,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:n}=this,{orderByFields:i,quantizationParameters:a,returnGeometry:l,returnCentroid:u,maxAllowableOffset:c,resultOffset:h,resultRecordCount:d,returnZ:f=!1,returnM:m=!1}=e,p=n&&f,y=r&&m;let x=[],w=0;const b=[...t];if(this._sortFeatures(b,i,((e,t,r)=>s.getFieldValue(e,t,r))),l||u){const e=(0,o.t)(a)??void 0;if(l&&!u)for(const t of b)x[w++]={attributes:s.getAttributes(t),geometry:(0,g.g)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),c,e,p,y)};else if(!l&&u)for(const t of b)x[w++]={attributes:s.getAttributes(t),centroid:(0,g.t)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of b)x[w++]={attributes:s.getAttributes(t),centroid:(0,g.t)(this,this.featureAdapter.getCentroid(t,this),e),geometry:(0,g.g)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),c,e,p,y)}}else for(const e of b){const t=s.getAttributes(e);t&&(x[w++]={attributes:t})}const I=h||0;if(null!=d){const e=I+d;x=x.slice(I,Math.min(x.length,e))}return x}_createExceedsLimitQueryResponse(e){let t=!1,s=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;for(const t of e.outStatistics??[])if("exceedslimit"===t.statisticType){s=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,n=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,i=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>s;else if(this.items.length>n)t=!0;else{const e=P(this.hasZ,this.hasM),s=this.featureAdapter;t=this.items.reduce(((e,t)=>{const n=s.getGeometry(t);return e+((0,r.i)(n)&&n.coords.length||0)}),0)/e>i}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}async _createStatisticsQueryResponse(e){const t={attributes:{}},s=[],r=new Map,n=new Map,i=new Map,o=new Map,a=new q(e,this.featureAdapter,this.fieldsIndex),l=e.outStatistics,{groupByFieldsForStatistics:u,having:c,orderByFields:h}=e,d=u&&u.length,f=!!d,m=f?u[0]:null,g=f&&!this.fieldsIndex.get(m);for(const e of l??[]){const{outStatisticFieldName:l,statisticType:h}=e,p=e,y="exceedslimit"!==h?e.onStatisticField:void 0,x="percentile_disc"===h||"percentile_cont"===h,w="EnvelopeAggregate"===h||"CentroidAggregate"===h||"ConvexHullAggregate"===h,b=f&&1===d&&(y===m||g)&&"count"===h;if(f){if(!i.has(y)){const e=[];for(const t of u){const s=this._getAttributeValues(a,t,r);e.push(s)}i.set(y,this._calculateUniqueValues(e,!w&&a.returnDistinctValues))}const e=i.get(y);for(const t in e){const{count:s,data:n,items:i,itemPositions:h}=e[t],d=n.join(",");if(!c||a.validateItems(i,c)){const e=o.get(d)||{attributes:{}};if(w){e.aggregateGeometries||(e.aggregateGeometries={});const{aggregateGeometries:t,outStatisticFieldName:s}=await this._getAggregateGeometry(p,i);e.aggregateGeometries[s]=t}else{let t=null;if(b)t=s;else{const e=this._getAttributeValues(a,y,r),s=h.map((t=>e[t]));t=x&&"statisticParameters"in p?this._getPercentileValue(p,s):this._getStatisticValue(p,s,null,a.returnDistinctValues)}e.attributes[l]=t}let t=0;u.forEach(((s,r)=>e.attributes[this.fieldsIndex.get(s)?s:"EXPR_"+ ++t]=n[r])),o.set(d,e)}}}else if(w){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:s}=await this._getAggregateGeometry(p,this.items);t.aggregateGeometries[s]=e}else{const e=this._getAttributeValues(a,y,r);t.attributes[l]=x&&"statisticParameters"in p?this._getPercentileValue(p,e):this._getStatisticValue(p,e,n,a.returnDistinctValues)}s.push({name:l,alias:l,type:"esriFieldTypeDouble"})}const p=f?Array.from(o.values()):[t];return this._sortFeatures(p,h,((e,t)=>e.attributes[t])),{fields:s,features:p}}async _getAggregateGeometry(e,t){const r=await Promise.all([s.e(3361),s.e(3981)]).then(s.bind(s,43981)).then((e=>e.g)),{statisticType:o,outStatisticFieldName:a}=e,{featureAdapter:l,spatialReference:u,geometryType:c,hasZ:h,hasM:d}=this,f=t.map((e=>(0,g.g)(c,h,d,l.getGeometry(e)))),m=r.convexHull(u,f,!0)[0],p={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===o){const e=m?(0,i.g)(m):(0,i.d)(r.union(u,f));p.aggregateGeometries={...e,spatialReference:u},p.outStatisticFieldName=a||"extent"}else if("CentroidAggregate"===o){const e=m?(0,n.p)(m):(0,n.e)((0,i.d)(r.union(u,f)));p.aggregateGeometries={x:e[0],y:e[1],spatialReference:u},p.outStatisticFieldName=a||"centroid"}else"ConvexHullAggregate"===o&&(p.aggregateGeometries=m,p.outStatisticFieldName=a||"convexHull");return p}_getStatisticValue(e,t,s,r){const{onStatisticField:n,statisticType:i}=e;let o=null;return o=s?.has(n)?s.get(n):(0,p.qN)(this.fieldsIndex.get(n))?(0,h.c)({values:t,returnDistinct:r}):(0,h.a)({values:r?[...new Set(t)]:t,minValue:null,maxValue:null,useSampleStdDev:!0}),s&&s.set(n,o),o["var"===i?"variance":i]}_getPercentileValue(e,t){const{onStatisticField:s,statisticParameters:r,statisticType:n}=e,{value:i,orderBy:o}=r,a=this.fieldsIndex.get(s);return(0,h.k)(t,{value:i,orderBy:o,fieldType:a?.type,isDiscrete:"percentile_disc"===n})}_getAttributeValues(e,t,s){if(s.has(t))return s.get(t);const r=this.fieldsIndex.get(t),n=this.items.map((s=>e.getFieldValue(s,t,r)));return s.set(t,n),n}_getAttributeDataValues(e,t){return this.items.map((s=>e.getDataValue(s,{field:t.field,field2:t.field2,field3:t.field3,fieldDelimiter:t.fieldDelimiter,normalizationField:t.normalizationField,normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})))}async _getAttributeExpressionValues(e,t,s){const{arcadeUtils:r}=await(0,y.l)(),n=r.createFunction(t),i=s&&r.getViewInfo(s);return e.getExpressionValues(this.items,n,i,r)}_calculateUniqueValues(e,t){const s={},r=this.items,n=r.length;for(let i=0;i<n;i++){const n=r[i],o=[];for(const t of e)o.push(t[i]);const a=o.join(",");null==s[a]?s[a]={count:1,data:o,items:[n],itemPositions:[i]}:(t||s[a].count++,s[a].items.push(n),s[a].itemPositions.push(i))}return s}async _getDataValues(e){const t=new q(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:s,field:r,normalizationField:n,normalizationType:i,normalizationTotal:o,scale:a}=e,l=s?{viewingMode:"map",scale:a,spatialReference:this.query.outSR||this.spatialReference}:null;return s?this._getAttributeExpressionValues(t,s,l):this._getAttributeDataValues(t,{field:r,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,normalizationField:n,normalizationType:i,normalizationTotal:o})}}function R(e,t,s,r){const n=r.x-s.x,i=r.y-s.y,o=n*n+i*i,a=(t.x-s.x)*n+(t.y-s.y)*i,l=Math.min(1,Math.max(0,a/o));e.x=s.x+n*l,e.y=s.y+i*l}function P(e,t){return e?t?4:3:t?3:2}var E,C;(C=E||(E={}))[C.NONE=0]="NONE",C[C.EDGE=1]="EDGE",C[C.VERTEX=2]="VERTEX";class O{constructor(e,t){this.coords=e,this.coordsIndex=t}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}},89914:(e,t,s)=>{s.d(t,{S:()=>n});var r=s(21972);class n extends r.c{notify(){const e=this._observers;if(e&&e.length>0){const t=e.slice();for(const e of t)e.onInvalidated(),e.onCommitted()}}}},53326:(e,t,s)=>{s.d(t,{D:()=>c,N:()=>w,a:()=>p,b:()=>l,c:()=>i,d:()=>x,e:()=>u,f:()=>o,g:()=>g,h:()=>h,i:()=>y,j:()=>d,k:()=>m,s:()=>f,t:()=>a});var r=s(71252),n=s(21801);function i(e=b){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function o(e,t,s,r,n,o,a=i()){return a[0]=e,a[1]=t,a[2]=s,a[3]=r,a[4]=n,a[5]=o,a}function a(e,t){const s=isFinite(e[2])||isFinite(e[5]);return new n.Z(s?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function l(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function u(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function c(e,t=[0,0,0]){return t[0]=function(e){return e[0]>=e[3]?0:e[3]-e[0]}(e),t[1]=function(e){return e[1]>=e[4]?0:e[4]-e[1]}(e),t[2]=function(e){return e[2]>=e[5]?0:e[5]-e[2]}(e),t}function h(e,t,s=e){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s!==e&&(s[3]=e[3],s[4]=e[4],s[5]=e[5]),s}function d(e,t,s=e){return s[3]=t[0],s[4]=t[1],s[5]=t[2],s!==e&&(s[0]=e[0],s[1]=e[1],s[2]=e[2]),e}function f(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function m(e){return e?f(e,w):i(w)}function g(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function p(e,t,s,r,n){return e[0]=t,e[1]=s,e[2]=Number.NEGATIVE_INFINITY,e[3]=r,e[4]=n,e[5]=Number.POSITIVE_INFINITY,e}function y(e){return 6===e.length}function x(e,t,s){if((0,r.a)(e)||(0,r.a)(t))return e===t;if(!y(e)||!y(t))return!1;if(s){for(let r=0;r<e.length;r++)if(!s(e[r],t[r]))return!1}else for(let s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0}s(92482);const w=[1/0,1/0,1/0,-1/0,-1/0,-1/0],b=[0,0,0,0,0,0];i()},73173:(e,t,s)=>{s.d(t,{g:()=>l});var r=s(31450),n=(s(82058),s(60991)),i=s(92143),o=s(32101);const a=i.L.getLogger("esri.assets");function l(e){if(!r.Z.assetsPath)throw a.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new n.Z("assets:path-not-set","config.assetsPath is not set");return(0,o.v_)(r.Z.assetsPath,e)}},40267:(e,t,s)=>{s.d(t,{A:()=>oe,a:()=>J,b:()=>T,c:()=>U,d:()=>D,e:()=>z,f:()=>C,g:()=>te,h:()=>Z,i:()=>$,j:()=>B,l:()=>Q,m:()=>H,n:()=>L,o:()=>j,p:()=>k,q:()=>W,r:()=>re,s:()=>X,t:()=>w,u:()=>se,v:()=>b,w:()=>E,x:()=>ie});var r=s(60991),n=s(92143),i=s(71252),o=s(53326),a=s(92482),l=s(32422),u=s(85674),c=s(9006);function h(e,t){return e?t?4:3:t?3:2}const d=n.L.getLogger("esri.layers.graphics.featureConversionUtils"),f={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},m=(e,t,s,r,n,i)=>{e[s]=n,e[s+1]=i},g=(e,t,s,r,n,i)=>{e[s]=n,e[s+1]=i,e[s+2]=t[r+2]},p=(e,t,s,r,n,i)=>{e[s]=n,e[s+1]=i,e[s+2]=t[r+3]},y=(e,t,s,r,n,i)=>{e[s]=n,e[s+1]=i,e[s+2]=t[r+2],e[s+3]=t[r+3]};function x(e,t,s,r){if(e){if(s)return t&&r?y:g;if(t&&r)return p}else if(t&&r)return g;return m}function w({scale:e,translate:t},s){return Math.round((s-t[0])/e[0])}function b({scale:e,translate:t},s){return Math.round((t[1]-s)/e[1])}function I({scale:e,translate:t},s,r){return s*e[r]+t[r]}function T(e,t,s){return e?t?s?N(e):_(e):s?M(e):v(e):null}function v(e){const t=e.coords;return{x:t[0],y:t[1]}}function F(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function _(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function S(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function M(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function q(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function N(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function R(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function P(e,t){return e&&t?R:e?S:t?q:F}function E(e,t,s=P(null!=t.z,null!=t.m)){return s(e,t)}function C(e,t,s){if((0,i.a)(e))return null;const r=h(t,s),n=[];for(let t=0;t<e.coords.length;t+=r){const s=[];for(let n=0;n<r;n++)s.push(e.coords[t+n]);n.push(s)}return t?s?{points:n,hasZ:t,hasM:s}:{points:n,hasZ:t}:s?{points:n,hasM:s}:{points:n}}function O(e,t,s=h(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const r=e.coords;let n=0;for(const e of t.points)for(let t=0;t<s;t++)r[n++]=e[t];return e}function D(e,t,s){if(!e)return null;const r=h(t,s),{coords:n,lengths:i}=e,o=[];let a=0;for(const e of i){const t=[];for(let s=0;s<e;s++){const e=[];for(let t=0;t<r;t++)e.push(n[a++]);t.push(e)}o.push(t)}return t?s?{paths:o,hasZ:t,hasM:s}:{paths:o,hasZ:t}:s?{paths:o,hasM:s}:{paths:o}}function V(e,t,s=h(t.hasZ,t.hasM)){const{lengths:r,coords:n}=e;let i=0;for(const e of t.paths){for(const t of e)for(let e=0;e<s;e++)n[i++]=t[e];r.push(e.length)}return e}function z(e,t,s){if(!e)return null;const r=h(t,s),{coords:n,lengths:i}=e,o=[];let a=0;for(const e of i){const t=[];for(let s=0;s<e;s++){const e=[];for(let t=0;t<r;t++)e.push(n[a++]);t.push(e)}o.push(t)}return t?s?{rings:o,hasZ:t,hasM:s}:{rings:o,hasZ:t}:s?{rings:o,hasM:s}:{rings:o}}function Z(e,t,s=t.hasZ,r=t.hasM){return function(e,t,s,r){const n=h(s,r),{lengths:i,coords:o}=e;let a=0;ae(e);for(const e of t){for(const t of e)for(let e=0;e<n;e++)o[a++]=t[e];i.push(e.length)}}(e,t.rings,s,r),e}const A=[],G=[];function k(e,t,s,r,n){A[0]=e;const[i]=L(G,A,t,s,r,n);return le(A),le(G),i}function L(e,t,s,n,o,a){if(le(e),!s){for(const s of t){const t=a?s.attributes[a]:void 0;e.push(new u.a(null,s.attributes,null,t))}return e}switch(s){case"esriGeometryPoint":return function(e,t,s,r,n){const o=P(s,r);for(const{geometry:s,attributes:r}of t){const t=(0,i.i)(s)?o(new u.O,s):null;e.push(new u.a(t,r,null,n?r[n]:void 0))}return e}(e,t,n,o,a);case"esriGeometryMultipoint":return function(e,t,s,r,n){const o=h(s,r);for(const{geometry:s,attributes:r}of t){const t=(0,i.i)(s)?O(new u.O,s,o):null;e.push(new u.a(t,r,null,n?r[n]:void 0))}return e}(e,t,n,o,a);case"esriGeometryPolyline":return function(e,t,s,r,n){const o=h(s,r);for(const{geometry:s,attributes:r}of t){const t=(0,i.i)(s)?V(new u.O,s,o):null;e.push(new u.a(t,r,null,n?r[n]:void 0))}return e}(e,t,n,o,a);case"esriGeometryPolygon":return function(e,t,s,r,n){for(const{geometry:o,centroid:a,attributes:l}of t){const t=(0,i.i)(o)?Z(new u.O,o,s,r):null,c=n?l[n]:void 0;(0,i.i)(a)?e.push(new u.a(t,l,F(new u.O,a),c)):e.push(new u.a(t,l,null,c))}return e}(e,t,n,o,a);default:d.error("convertToFeatureSet:unknown-geometry",new r.Z(`Unable to parse unknown geometry type '${s}'`)),le(e)}return e}function j(e,t,s,r){G[0]=e,Y(A,G,t,s,r);const n=A[0];return le(A),le(G),n}function U(e,t,s){if((0,i.a)(e))return null;const n=new u.O;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==s&&(s=e.hasM),(0,l.wp)(e)?P(null!=t?t:null!=e.z,null!=s?s:null!=e.m)(n,e):(0,l.oU)(e)?Z(n,e,t,s):(0,l.l9)(e)?V(n,e,h(t,s)):(0,l.aW)(e)?O(n,e,h(t,s)):void d.error("convertFromGeometry:unknown-geometry",new r.Z(`Unable to parse unknown geometry type '${e}'`))}function $(e,t,s,n){const o=e&&("coords"in e?e:e.geometry);if((0,i.a)(o))return null;switch(t){case"esriGeometryPoint":{let e=v;return s&&n?e=N:s?e=_:n&&(e=M),e(o)}case"esriGeometryMultipoint":return C(o,s,n);case"esriGeometryPolyline":return D(o,s,n);case"esriGeometryPolygon":return z(o,s,n);default:return d.error("convertToGeometry:unknown-geometry",new r.Z(`Unable to parse unknown geometry type '${t}'`)),null}}function Y(e,t,s,n,o){if(le(e),(0,i.a)(s))return function(e,t){for(const s of t)e.push({attributes:s.attributes});return e}(e,t);switch(s){case"esriGeometryPoint":return function(e,t,s,r){let n=v;s&&r?n=N:s?n=_:r&&(n=M);for(const s of t){const{geometry:t,attributes:r}=s,o=(0,i.i)(t)?n(t):null;e.push({attributes:r,geometry:o})}return e}(e,t,n,o);case"esriGeometryMultipoint":return function(e,t,s,r){for(const{geometry:n,attributes:o}of t)e.push({attributes:o,geometry:(0,i.i)(n)?C(n,s,r):null});return e}(e,t,n,o);case"esriGeometryPolyline":return function(e,t,s,r){for(const{geometry:n,attributes:o}of t)e.push({attributes:o,geometry:(0,i.i)(n)?D(n,s,r):null});return e}(e,t,n,o);case"esriGeometryPolygon":return function(e,t,s,r){for(const{geometry:n,attributes:o,centroid:a}of t){const t=(0,i.i)(n)?z(n,s,r):null;if((0,i.i)(a)){const s=v(a);e.push({attributes:o,centroid:s,geometry:t})}else e.push({attributes:o,geometry:t})}return e}(e,t,n,o);default:d.error("convertToFeatureSet:unknown-geometry",new r.Z(`Unable to parse unknown geometry type '${s}'`))}return e}function B(e){const{objectIdFieldName:t,spatialReference:s,transform:r,fields:n,hasM:i,hasZ:o,features:a,geometryType:l,exceededTransferLimit:u,uniqueIdField:c,queryGeometry:h,queryGeometryType:d}=e,f={features:Y([],a,l,o,i),fields:n,geometryType:l,objectIdFieldName:t,spatialReference:s,uniqueIdField:c,queryGeometry:$(h,d,!1,!1)};return r&&(f.transform=r),u&&(f.exceededTransferLimit=u),i&&(f.hasM=i),o&&(f.hasZ=o),f}function H(e,t){const s=new c.O,{hasM:n,hasZ:i,features:o,objectIdFieldName:a,spatialReference:l,geometryType:u,exceededTransferLimit:h,transform:f,fields:m}=e;return m&&(s.fields=m),s.geometryType=u??null,s.objectIdFieldName=a??t??null,s.spatialReference=l??null,s.objectIdFieldName?(o&&L(s.features,o,u,i,n,s.objectIdFieldName),h&&(s.exceededTransferLimit=h),n&&(s.hasM=n),i&&(s.hasZ=i),f&&(s.transform=f),s):(d.error(new r.Z("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),s)}function Q(e){const{transform:t,features:s,hasM:r,hasZ:n}=e;if(!t)return e;for(const e of s)(0,i.i)(e.geometry)&&se(e.geometry,e.geometry,r,n,t),(0,i.i)(e.centroid)&&se(e.centroid,e.centroid,r,n,t);return e.transform=null,e}function X(e,t){const{geometryType:s,features:r,hasM:n,hasZ:i}=t;if(!e)return t;for(let t=0;t<r.length;t++){const o=r[t],a=o.weakClone();a.geometry=new u.O,W(a.geometry,o.geometry,n,i,s,e),o.centroid&&(a.centroid=new u.O,W(a.centroid,o.centroid,n,i,"esriGeometryPoint",e)),r[t]=a}return t.transform=e,t}function W(e,t,s,r,n,o,a=s,l=r){if(ae(e),(0,i.a)(t)||!t.coords.length)return null;const u=f[n],{coords:c,lengths:d}=t,m=h(s,r),g=h(s&&a,r&&l),p=x(s,r,a,l);if(!d.length)return p(e.coords,c,0,0,w(o,c[0]),b(o,c[1])),ae(e,m,0),e;let y,I,T,v,F=0,_=0,S=_;for(const t of d){if(t<u)continue;let s=0;_=S,T=y=w(o,c[F]),v=I=b(o,c[F+1]),p(e.coords,c,_,F,T,v),s++,F+=m,_+=g;for(let r=1;r<t;r++,F+=m)T=w(o,c[F]),v=b(o,c[F+1]),T===y&&v===I||(p(e.coords,c,_,F,T-y,v-I),_+=g,s++,y=T,I=v);s>=u&&(e.lengths.push(s),S=_)}return le(e.coords,S),e.coords.length?e:null}function J(e,t,s,r,n,i,o=s,a=r){if(ae(e),!t||!t.coords.length)return null;const l=f[n],{coords:u,lengths:c}=t,d=h(s,r),m=h(s&&o,r&&a),g=x(s,r,o,a);if(!c.length)return g(e.coords,u,0,0,u[0],u[1]),ae(e,d,0),e;let p=0;const y=i*i;for(const t of c){if(t<l){p+=t*d;continue}const s=e.coords.length/m,r=p,n=p+(t-1)*d;g(e.coords,u,e.coords.length,r,u[r],u[r+1]),ee(e.coords,u,d,y,g,r,n),g(e.coords,u,e.coords.length,n,u[n],u[n+1]);const i=e.coords.length/m-s;i>=l?e.lengths.push(i):le(e.coords,s*m),p+=t*d}return e.coords.length?e:null}function K(e,t,s,r){const n=e[t],i=e[t+1],o=e[s],a=e[s+1],l=e[r],u=e[r+1];let c=o,h=a,d=l-c,f=u-h;if(0!==d||0!==f){const e=((n-c)*d+(i-h)*f)/(d*d+f*f);e>1?(c=l,h=u):e>0&&(c+=d*e,h+=f*e)}return d=n-c,f=i-h,d*d+f*f}function ee(e,t,s,r,n,i,o){let a,l=r,u=0;for(let e=i+s;e<o;e+=s)a=K(t,e,i,o),a>l&&(u=e,l=a);l>r&&(u-i>s&&ee(e,t,s,r,n,i,u),n(e,t,e.length,u,t[u],t[u+1]),o-u>s&&ee(e,t,s,r,n,u,o))}function te(e,t,s,r){if((0,i.a)(t)||!t.coords||!t.coords.length)return null;const n=h(s,r);let l=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=n){const s=e[t],r=e[t+1];l=Math.min(l,s),c=Math.max(c,s),u=Math.min(u,r),d=Math.max(d,r)}}return(0,o.i)(e)?(0,o.a)(e,l,u,c,d):(0,a.f)(l,u,c,d,e),e}function se(e,t,s,r,n){const{coords:o,lengths:a}=t,l=h(s,r);if(!o.length)return e!==t&&ae(e),e;(0,i.l)(n);const{originPosition:u,scale:c,translate:d}=n,f=ue;f.originPosition=u;const m=f.scale;m[0]=c[0]??1,m[1]=-(c[1]??1),m[2]=c[2]??1,m[3]=c[3]??1;const g=f.translate;if(g[0]=d[0]??0,g[1]=d[1]??0,g[2]=d[2]??0,g[3]=d[3]??0,!a.length){for(let t=0;t<l;++t)e.coords[t]=I(f,o[t],t);return e!==t&&ae(e,l,0),e}let p=0;for(let t=0;t<a.length;t++){const s=a[t];e.lengths[t]=s;for(let t=0;t<l;++t)e.coords[p+t]=I(f,o[p+t],t);let r=e.coords[p],n=e.coords[p+1];p+=l;for(let t=1;t<s;t++,p+=l){r+=o[p]*m[0],n+=o[p+1]*m[1],e.coords[p]=r,e.coords[p+1]=n;for(let t=2;t<l;++t)e.coords[p+t]=I(f,o[p+t],t)}}return e!==t&&ae(e,o.length,a.length),e}function re(e,t,s,r,n,i){if(ae(e),e.lengths.push(...t.lengths),s===n&&r===i)for(let s=0;s<t.coords.length;s++)e.coords.push(t.coords[s]);else{const o=h(s,r),a=x(s,r,n,i),l=t.coords;for(let t=0;t<l.length;t+=o)a(e.coords,l,e.coords.length,t,l[t],l[t+1])}return e}function ne(e,t,s,r){let n=0,i=e[r*t],o=e[r*(t+1)];for(let a=1;a<s;a++){const s=i+e[r*(t+a)],l=o+e[r*(t+a)+1],u=(s-i)*(l+o);i=s,o=l,n+=u}return.5*n}function ie(e,t){const{coords:s,lengths:r}=e;let n=0,i=0;for(let e=0;e<r.length;e++){const o=r[e];i+=ne(s,n,o,t),n+=o}return Math.abs(i)}function oe(e,t){if((0,i.a)(e))return null;const s=e.clone(),r=e.coords,n=e.lengths;let o=0;for(let e=0;e<n.length;e++){const i=n[e];let a=r[t*o],l=r[t*o+1];for(let e=1;e<i;e++){const n=a+r[t*(o+e)],i=l+r[t*(o+e)+1];s.coords[t*(o+e)]=n,s.coords[t*(o+e)+1]=i,a=n,l=i}o+=i}return s}function ae(e,t=0,s=0){le(e.lengths,s),le(e.coords,t)}function le(e,t=0){e.length!==t&&(e.length=t)}const ue={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]}},77314:(e,t,s)=>{s.d(t,{j:()=>r});const r={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,s){const r=new n(e.getPointX(t),e.getPointY(t),s),i=e.hasZ(t),o=e.hasM(t);return i&&(r.z=e.getPointZ(t)),o&&(r.m=e.getPointM(t)),r},exportPolygon:function(e,t,s){return new i(e.exportPaths(t),s,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,s){return new o(e.exportPaths(t),s,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,s){return new a(e.exportPoints(t),s,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,s){const r=e.hasZ(t),n=e.hasM(t),i=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),s);if(r){const s=e.getZExtent(t);i.zmin=s.vmin,i.zmax=s.vmax}if(n){const s=e.getMExtent(t);i.mmin=s.vmin,i.mmax=s.vmax}return i}};class n{constructor(e,t,s){this.x=e,this.y=t,this.spatialReference=s,this.z=void 0,this.m=void 0}}class i{constructor(e,t,s,r){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),r&&(this.hasM=r)}}class o{constructor(e,t,s,r){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),r&&(this.hasM=r)}}class a{constructor(e,t,s,r){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),r&&(this.hasM=r)}}class l{constructor(e,t,s,r,n){this.xmin=e,this.ymin=t,this.xmax=s,this.ymax=r,this.spatialReference=n,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},24251:(e,t,s)=>{s.d(t,{a:()=>y,c:()=>d,p:()=>g});var r=s(71252),n=s(1623),i=s(77314),o=s(53785),a=s(35132);const l=[0,0];function u(e,t){if(!t)return null;if("x"in t){const s={x:0,y:0};return[s.x,s.y]=e(t.x,t.y,l),null!=t.z&&(s.z=t.z),null!=t.m&&(s.m=t.m),s}if("xmin"in t){const s={xmin:0,ymin:0,xmax:0,ymax:0};return[s.xmin,s.ymin]=e(t.xmin,t.ymin,l),[s.xmax,s.ymax]=e(t.xmax,t.ymax,l),t.hasZ&&(s.zmin=t.zmin,s.zmax=t.zmax,s.hasZ=!0),t.hasM&&(s.mmin=t.mmin,s.mmax=t.mmax,s.hasM=!0),s}return"rings"in t?{rings:c(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:c(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:h(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function c(e,t){const s=[];for(const r of e)s.push(h(r,t));return s}function h(e,t){const s=[];for(const r of e){const e=t(r[0],r[1],[0,0]);s.push(e),r.length>2&&e.push(r[2]),r.length>3&&e.push(r[3])}return s}async function d(e,t){if(!e||!t)return;const s=Array.isArray(e)?e.map((e=>(0,r.i)(e.geometry)?e.geometry.spatialReference:null)).filter(r.i):[e];await(0,n.iQ)(s.map((e=>({source:e,dest:t}))))}const f=u.bind(null,a.hG),m=u.bind(null,a.R6);function g(e,t,s,r){if(!e)return e;if(s||(s=t,t=e.spatialReference),!(0,o.n)(t)||!(0,o.n)(s)||(0,o.f)(t,s))return e;if((0,a.Q8)(t,s)){const t=(0,o.b)(s)?f(e):m(e);return t.spatialReference=s,t}return(0,n.oj)(i.j,[e],t,s,null,r)[0]}const p=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,s){if(!e||!e.length||!t||!s||(0,o.f)(t,s))return e;const r={geometries:e,inSpatialReference:t,outSpatialReference:s,resolve:null};return this._jobs.push(r),new Promise((e=>{r.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:s,outSpatialReference:r,resolve:l}=e;(0,a.Q8)(s,r)?(0,o.b)(r)?l(t.map(f)):l(t.map(m)):l((0,n.oj)(i.j,t,s,r,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function y(e,t,s){return p.push(e,t,s)}},4978:(e,t,s)=>{s.d(t,{Q:()=>m,a:()=>T,c:()=>F,g:()=>b,n:()=>I,t:()=>w});var r=s(57251),n=s(71252),i=s(53785),o=s(1623),a=s(98380),l=s(32422),u=s(95533),c=s(40267),h=s(85674),d=s(24251);const f=new r.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),m=Object.freeze({}),g=new h.O,p=new h.O,y=new h.O,x={esriGeometryPoint:c.b,esriGeometryPolyline:c.d,esriGeometryPolygon:c.e,esriGeometryMultipoint:c.f};function w(e,t,s,r=e.hasZ,i=e.hasM){if((0,n.a)(t))return null;const o=e.hasZ&&r,a=e.hasM&&i;if(s){const n=(0,c.q)(y,t,e.hasZ,e.hasM,"esriGeometryPoint",s,r,i);return(0,c.b)(n,o,a)}return(0,c.b)(t,o,a)}function b(e,t,s,r,i,o,a=t,l=s){const u=t&&a,h=s&&l,d=(0,n.i)(r)?"coords"in r?r:r.geometry:null;if((0,n.a)(d))return null;if(i){let r=(0,c.a)(p,d,t,s,e,i,a,l);return o&&(r=(0,c.q)(y,r,u,h,e,o)),x[e]?.(r,u,h)??null}if(o){const r=(0,c.q)(y,d,t,s,e,o,a,l);return x[e]?.(r,u,h)??null}return(0,c.r)(g,d,t,s,a,l),x[e]?.(g,u,h)??null}async function I(e,t,s){const{outFields:r,orderByFields:n,groupByFieldsForStatistics:i,outStatistics:o}=e;if(r)for(let e=0;e<r.length;e++)r[e]=r[e].trim();if(n)for(let e=0;e<n.length;e++)n[e]=n[e].trim();if(i)for(let e=0;e<i.length;e++)i[e]=i[e].trim();if(o)for(let e=0;e<o.length;e++)o[e].onStatisticField&&(o[e].onStatisticField=o[e].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),T(e,t,s)}async function T(e,t,r){if(!e)return null;let{where:o}=e;if(e.where=o=o&&o.trim(),(!o||/^1 *= *1$/.test(o)||t&&t===o)&&(e.where=null),!e.geometry)return e;let c=await async function(e){const{distance:t,units:r}=e,n=e.geometry;if(null==t||"vertexAttributes"in n)return n;const o=n.spatialReference,a=r?f.fromJSON(r):(0,i.e)(o),l=o&&((0,i.c)(o)||(0,i.b)(o))?n:await(0,d.c)(o,i.W).then((()=>(0,d.p)(n,i.W)));return(await async function(){return(await Promise.all([s.e(3361),s.e(3981)]).then(s.bind(s,43981)).then((e=>e.g))).geodesicBuffer}())(l.spatialReference,l,t,a)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;c=(0,a.d)(c),c.spatialReference=t}if(c){await(0,d.c)(c.spatialReference,r),c=function(e,t){const s=e.spatialReference;return v(e,t)&&(0,l.YX)(e)?{spatialReference:s,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}(c,r);const t=(await(0,u.aX)((0,l.im)(c)))[0];if((0,n.a)(t))throw m;const s="quantizationParameters"in e&&e.quantizationParameters?.tolerance||"maxAllowableOffset"in e&&e.maxAllowableOffset||0,i=s&&v(c,r)?{densificationStep:8*s}:void 0,o=t.toJSON(),a=await(0,d.p)(o,o.spatialReference,r,i);if(!a)throw m;a.spatialReference=r,e.geometry=a}return e}function v(e,t){if(!e)return!1;const s=e.spatialReference;return((0,l.YX)(e)||(0,l.oU)(e)||(0,l.l9)(e))&&!(0,i.f)(s,t)&&!(0,o.Up)(s,t)}function F(e){return e&&_ in e?JSON.parse(JSON.stringify(e,S)):e}const _="_geVersion",S=(e,t)=>e!==_?t:void 0},82058:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g,l:()=>f,r:()=>E,s:()=>d});var r=s(31450),n=s(88762),i=s(60991),o=s(48578),a=s(76506),l=s(71252),u=s(50406),c=s(32101);s(71552),s(92143),s(40642);const h=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function d(e){const t=(0,c.P$)(e,!0);return!!t&&t.endsWith(".arcgis.com")&&!h.includes(t)&&!e.endsWith("/sharing/rest/generateToken")}function f(e,t,s=!1,r){return new Promise(((n,i)=>{if((0,u.Hc)(r))return void i(m());let a=()=>{d(),i(new Error(`Unable to load ${t}`))},c=()=>{const t=e;d(),n(t)},h=()=>{if(!e)return;const t=e;d(),t.src="",i(m())};const d=()=>{(0,o.h)("esri-image-decode")||(e.removeEventListener("error",a),e.removeEventListener("load",c)),a=null,c=null,e=null,(0,l.i)(r)&&r.removeEventListener("abort",h),h=null,s&&URL.revokeObjectURL(t)};(0,l.i)(r)&&r.addEventListener("abort",h),(0,o.h)("esri-image-decode")?e.decode().then(c,a):(e.addEventListener("error",a),e.addEventListener("load",c))}))}function m(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}async function g(e,t){const a=(0,c.HK)(e),h=(0,c.jc)(e);h||a||(e=(0,c.Fv)(e));const f={url:e,requestOptions:{...(0,l.u)(t)}};let m=(0,c.oh)(e);if(m){const e=await async function(e,t){if(null!=e.responseData)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let s,r;try{r=await e.before(t)}catch(e){s=_("request:interceptor",e,t)}if((r instanceof Error||r instanceof i.Z)&&(s=_("request:interceptor",r,t)),s)throw e.error&&e.error(s),s;return r}}(m,f);if(null!=e)return{data:e,getHeader:T,httpStatus:200,requestOptions:f.requestOptions,url:f.url};m.after||m.error||(m=null)}if(e=f.url,"image"===(t=f.requestOptions).responseType){if((0,o.h)("host-webworker")||(0,o.h)("host-node"))throw _("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),f)}else if(a)throw _("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+t.responseType),f);if("head"===t.method){if(t.body)throw _("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),f);if(a||h)throw _("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),f)}if(await async function(){(0,o.h)("host-webworker")?p||(p=await s.e(9768).then(s.bind(s,89768))):g._abortableFetch||(g._abortableFetch=globalThis.fetch.bind(globalThis))}(),p)return p.execute(e,t);const w=new AbortController;(0,u.fu)(t,(()=>w.abort()));const b={controller:w,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:m,params:f,redoRequest:!1,useIdentity:y.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},I=await async function(e){let t,s;await async function(e){const t=e.params.url,s=e.params.requestOptions,i=e.controller.signal,o=s.body;let a=null,l=null;if(x&&"HTMLFormElement"in globalThis&&(o instanceof FormData?a=o:o instanceof HTMLFormElement&&(a=new FormData(o))),"string"==typeof o&&(l=o),e.fetchOptions={cache:s.cacheBust&&!g._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:s.headers||{},method:"head"===s.method?"HEAD":"GET",mode:"cors",priority:y.priority,redirect:"follow",signal:i},(a||l)&&(e.fetchOptions.body=a||l),"anonymous"===s.authMode&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(t)||s.query?.token||a?.get("token")),!e.hasToken&&r.Z.apiKey&&d(t)&&(s.query||(s.query={}),s.query.token=r.Z.apiKey,e.hasToken=!0),e.useIdentity&&!e.hasToken&&!e.credentialToken&&!M(t)&&!(0,u.Hc)(i)){let r;"immediate"===s.authMode?(await S(),r=await n.id.getCredential(t,{signal:i}),e.credential=r):"no-prompt"===s.authMode?(await S(),r=await n.id.getCredential(t,{prompt:!1,signal:i}).catch((()=>{})),e.credential=r):n.id&&(r=n.id.findCredential(t)),r&&(e.credentialToken=r.token,e.useSSL=!!r.ssl)}}(e);try{do{[t,s]=await q(e)}while(!await R(e,t,s))}catch(s){const r=_("request:server",s,e.params,t);throw r.details.ssl=e.useSSL,e.interceptor&&e.interceptor.error&&e.interceptor.error(r),r}const i=e.params.url;if(s&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(i)){if(!e.hasToken&&!e.credentialToken&&s.user?.username&&!(0,c.kl)(i)){const e=(0,c.P$)(i,!0);e&&y.trustedServers.push(e)}Array.isArray(s.authorizedCrossOriginNoCorsDomains)&&function(e){r.Z.request.crossOriginNoCorsDomains||(r.Z.request.crossOriginNoCorsDomains={});const t=r.Z.request.crossOriginNoCorsDomains;for(let s of e)s=s.toLowerCase(),/^https?:\/\//.test(s)?t[(0,c.P$)(s)??""]=0:(t[(0,c.P$)("http://"+s)??""]=0,t[(0,c.P$)("https://"+s)??""]=0)}(s.authorizedCrossOriginNoCorsDomains)}const o=e.credential;if(o&&n.id){const e=n.id.findServerInfo(o.server);let t=e&&e.owningSystemUrl;if(t){t=t.replace(/\/?$/,"/sharing");const e=n.id.findCredential(t,o.userId);e&&-1===n.id._getIdenticalSvcIdx(t,e)&&e.resources.unshift(t)}}return{data:s,getHeader:t?e=>t?.headers.get(e):T,httpStatus:t?.status??200,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}(b);return m?.after?.(I),I}let p;const y=r.Z.request,x="FormData"in globalThis,w=[499,498,403,401],b=["COM_0056","COM_0057","SB_0008"],I=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],T=()=>null,v=Symbol();function F(e){const t=(0,c.P$)(e);return!t||t.endsWith(".arcgis.com")||g._corsServers.includes(t)||(0,c.kl)(t)}function _(e,t,s,r){let n="Error";const o={url:s.url,requestOptions:s.requestOptions,getHeader:T,ssl:!1};if(t instanceof i.Z)return t.details?(t.details=(0,a.d9)(t.details),t.details.url=s.url,t.details.requestOptions=s.requestOptions):t.details=o,t;if(t){const e=r&&(e=>r.headers.get(e)),s=r&&r.status,i=t.message;i&&(n=i),e&&(o.getHeader=e),o.httpStatus=(null!=t.httpCode?t.httpCode:t.code)||s||0,o.subCode=t.subcode,o.messageCode=t.messageCode,"string"==typeof t.details?o.messages=[t.details]:o.messages=t.details,o.raw=v in t?t[v]:t}return(0,u.D_)(t)?(0,u.zE)():new i.Z(e,n,o)}async function S(){n.id||await Promise.all([s.e(6676),s.e(7803)]).then(s.bind(s,67803))}function M(e){return I.some((t=>t.test(e)))}async function q(e){let t=e.params.url;const s=e.params.requestOptions,i=e.fetchOptions??{},a=(0,c.jc)(t)||(0,c.HK)(t),l=s.responseType||"json",h=a?0:null!=s.timeout?s.timeout:y.timeout;let d=!1;if(!a){e.useSSL&&(t=(0,c.hO)(t)),s.cacheBust&&"default"===i.cache&&(t=(0,c.ZN)(t,"request.preventCache",Date.now()));let a={...s.query};e.credentialToken&&(a.token=e.credentialToken);let l=(0,c.B7)(a);(0,o.h)("esri-url-encodes-apostrophe")&&(l=l.replace(/'/g,"%27"));const u=t.length+1+l.length;let h;d="delete"===s.method||"post"===s.method||"put"===s.method||!!s.body||u>y.maxUrlLength;const f=s.useProxy||!!(0,c.ed)(t);if(f){const e=(0,c.b7)(t);h=e.path,!d&&h.length+1+u>y.maxUrlLength&&(d=!0),e.query&&(a={...e.query,...a})}if("HEAD"===i.method&&(d||f)){if(d){if(u>y.maxUrlLength)throw _("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params);throw _("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params)}if(f)throw _("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(d?(i.method="delete"===s.method?"DELETE":"put"===s.method?"PUT":"POST",s.body?t=(0,c.fl)(t,a):(i.body=(0,c.B7)(a),i.headers||(i.headers={}),i.headers["Content-Type"]="application/x-www-form-urlencoded")):t=(0,c.fl)(t,a),f&&(e.useProxy=!0,t=`${h}?${t}`),a.token&&x&&i.body instanceof FormData&&!(0,c.i)(t)&&i.body.set("token",a.token),s.hasOwnProperty("withCredentials"))e.withCredentials=s.withCredentials;else if(!(0,c.D6)(t,(0,c.TI)()))if((0,c.kl)(t))e.withCredentials=!0;else if(n.id){const s=n.id.findServerInfo(t);s&&s.webTierAuth&&(e.withCredentials=!0)}e.withCredentials&&(i.credentials="include",function(e){const t=r.Z.request.crossOriginNoCorsDomains;if(t){let s=(0,c.P$)(e);if(s)return s=s.toLowerCase(),!(0,c.D6)(s,(0,c.TI)())&&t[s]<Date.now()-36e5}return!1}(t)&&await async function(e){const t=r.Z.request.crossOriginNoCorsDomains,s=(0,c.P$)(e);t&&s&&(t[s.toLowerCase()]=Date.now());const n=(0,c.mN)(e);e=n.path,"json"===n.query?.f&&(e+="?f=json");try{await fetch(e,{mode:"no-cors",credentials:"include"})}catch{}}(d?(0,c.fl)(t,a):t))}let f,m,p=0,w=!1;h>0&&(p=setTimeout((()=>{w=!0,e.controller.abort()}),h));try{if("native-request-init"===s.responseType)m=i,m.url=t;else if("image"!==s.responseType||"default"!==i.cache||"GET"!==i.method||d||function(e){if(e)for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0;return!1}(s.headers)||!a&&!e.useProxy&&y.proxyUrl&&!F(t)){if(f=await g._abortableFetch(t,i),e.useProxy||function(e){const t=(0,c.P$)(e);t&&!g._corsServers.includes(t)&&g._corsServers.push(t)}(t),"native"===s.responseType)m=f;else if("HEAD"!==i.method)if(f.ok){switch(l){case"array-buffer":m=await f.arrayBuffer();break;case"blob":case"image":m=await f.blob();break;default:m=await f.text()}if(p&&(clearTimeout(p),p=0),"json"===l||"xml"===l||"document"===l)if(m)switch(l){case"json":m=JSON.parse(m);break;case"xml":m=N(m,"application/xml");break;case"document":m=N(m,"text/html")}else m=null;if(m){if("array-buffer"===l||"blob"===l){const e=f.headers.get("Content-Type");if(e&&/application\/json|text\/plain/i.test(e)&&m["blob"===l?"size":"byteLength"]<=750)try{const e=await new Response(m).json();e.error&&(m=e)}catch{}}"image"===l&&m instanceof Blob&&(m=await P(URL.createObjectURL(m),e,!0))}}else m=await f.text()}else m=await P(t,e)}catch(r){if("AbortError"===r.name){if(w)throw new Error("Timeout exceeded");throw(0,u.zE)("Request canceled")}if(!(!f&&r instanceof TypeError&&y.proxyUrl)||s.body||"delete"===s.method||"head"===s.method||"post"===s.method||"put"===s.method||e.useProxy||F(t))throw r;e.redoRequest=!0,(0,c.tD)({proxyUrl:y.proxyUrl,urlPrefix:(0,c.P$)(t)??""})}finally{p&&clearTimeout(p)}return[f,m]}function N(e,t){let s;try{s=(new DOMParser).parseFromString(e,t)}catch{}if(!s||s.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return s}async function R(e,t,s){if(e.redoRequest)return e.redoRequest=!1,!1;const r=e.params.requestOptions;if(!t||"native"===r.responseType||"native-request-init"===r.responseType)return!0;let i,o;if(!t.ok)throw i=new Error(`Unable to load ${t.url} status: ${t.status}`),i[v]=s,i;s&&(s.error?i=s.error:"error"===s.status&&Array.isArray(s.messages)&&(i={...s},i[v]=s,i.details=s.messages));let a,l=null;i&&(o=Number(i.code),l=i.hasOwnProperty("subcode")?Number(i.subcode):null,a=i.messageCode,a=a&&a.toUpperCase());const u=r.authMode;if(403===o&&(4===l||i.message&&i.message.toLowerCase().includes("ssl")&&!i.message.toLowerCase().includes("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&("no-prompt"!==u||498===o)&&void 0!==o&&w.includes(o)&&!M(e.params.url)&&(403!==o||a&&!b.includes(a)&&(null==l||2===l&&e.credentialToken))){await S();try{const t=await n.id.getCredential(e.params.url,{error:_("request:server",i,e.params),prompt:"no-prompt"!==u,signal:e.controller.signal,token:e.credentialToken});return e.credential=t,e.credentialToken=t.token,e.useSSL=e.useSSL||t.ssl,!1}catch(t){if("no-prompt"===u)return e.credential=void 0,e.credentialToken=void 0,!1;i=t}}if(i)throw i;return!0}function P(e,t,s=!1){const r=t.controller.signal,n=new Image;return t.withCredentials?n.crossOrigin="use-credentials":n.crossOrigin="anonymous",n.alt="",n.fetchPriority=y.priority,n.src=e,f(n,e,s,r)}g._abortableFetch=null,g._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];const E=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}))}}]);