"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[1272,5777],{91700:(t,e,n)=>{n.d(e,{M:()=>a,a:()=>c});var i,s,r=n(71252),o=n(6906);(s=i||(i={}))[s.ALL=0]="ALL",s[s.SOME=1]="SOME";class c{constructor(t,e,n){this._namespace=t,this._storage=e,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",n&&(this._storage.registerRemoveFunc(this._namespace,n),this._removeFunc=!0)}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}put(t,e,n,i=0){this._storage.put(this._namespace+t,e,n,i)}get(t){const e=this._storage.get(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}pop(t){const e=this._storage.pop(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}updateSize(t,e,n){this._storage.updateSize(this._namespace+t,e,n)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class a{constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new o.P,this._users=new o.P}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get size(){return this._size}get sizeMB(){return this._size/1024/1024}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimit()}put(t,e,n,s){const r=this._db.get(t);if(r&&(this._size-=r.size,this._db.delete(t),r.entry!==e&&this._notifyRemove(t,r.entry,i.ALL)),n>this._maxSize)return void this._notifyRemove(t,e,i.ALL);if(void 0===e)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return void console.warn("Refusing to cache entry with invalid size "+n);const o=1+Math.max(s,-3)- -3;this._db.set(t,{entry:e,size:n,lifetime:o,lives:o}),this._size+=n,this._checkSizeLimit()}updateSize(t,e,n){const s=this._db.get(t);if(s&&s.entry===e){for(this._size-=s.size;n>this._maxSize;){const s=this._notifyRemove(t,e,i.SOME);if(!((0,r.i)(s)&&s>0))return void this._db.delete(t);n=s}s.size=n,this._size+=n,this._checkSizeLimit()}}pop(t){const e=this._db.get(t);if(e)return this._size-=e.size,this._db.delete(t),++this._hit,e.entry;++this._miss}get(t){const e=this._db.get(t);if(void 0!==e)return this._db.delete(t),e.lives=e.lifetime,this._db.set(t,e),++this._hit,e.entry;++this._miss}getStats(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},n=new Array;this._db.forEach(((t,i)=>{const s=t.lifetime;n[s]=(n[s]||0)+t.size,this._users.forAll((n=>{const s=n.namespace;if(i.startsWith(s)){const n=e[s]||0;e[s]=n+t.size}}))}));const i={};this._users.forAll((t=>{const n=t.namespace;if(!isNaN(t.hitRate)&&t.hitRate>0){const s=e[n]||0;e[n]=s,i[n]=Math.round(100*t.hitRate)+"%"}else i[n]="0%"}));const s=Object.keys(e);s.sort(((t,n)=>e[n]-e[t])),s.forEach((n=>t[n]=Math.round(e[n]/2**20)+"MB / "+i[n]));for(let e=n.length-1;e>=0;--e){const i=n[e];i&&(t["Priority "+(e+-3-1)]=Math.round(i/this.size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){this._db.forEach(((e,n)=>{n.startsWith(t)&&(this._size-=e.size,this._db.delete(n),this._notifyRemove(n,e.entry,i.ALL))}))}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,i.ALL))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,n){let i;return this._removeFuncs.some((s=>{if(t.startsWith(s[0])){const t=s[1](e,n);return"number"==typeof t&&(i=t),!0}return!1})),i}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[t,e]of this._db){if(this._db.delete(t),e.lives<=1){this._size-=e.size;const n=this._notifyRemove(t,e.entry,i.SOME);(0,r.i)(n)&&n>0&&(this._size+=n,e.lives=e.lifetime,e.size=n,this._db.set(t,e))}else--e.lives,this._db.set(t,e);if(this._size<=.9*this.maxSize)return}}}},61272:(t,e,n)=>{n.r(e),n.d(e,{default:()=>$});var i,s,r,o,c=n(29768),a=n(71252),h=n(50406),u=(n(92143),n(91306),n(48578),n(60991),n(17533)),l=n(72836),f=n(94446),d=n(60939),_=n(77849),m=n(91055),g=n(6906),p=n(2420),T=(n(65775),n(7200),n(68681));function O(t){return t?{ray:(0,p.c)(t.ray),c0:t.c0,c1:t.c1}:{ray:(0,p.c)(),c0:0,c1:Number.MAX_VALUE}}function b(t,e){for(let n=0;n<r.NUM;n++){const i=t[n];if(i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]>=e[3])return!1}return!0}n(55633),new p.O((()=>O())),function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t[t.BOTTOM=2]="BOTTOM",t[t.TOP=3]="TOP",t[t.NEAR=4]="NEAR",t[t.FAR=5]="FAR"}(i||(i={})),function(t){t[t.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",t[t.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",t[t.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",t[t.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",t[t.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",t[t.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",t[t.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",t[t.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(s||(s={})),s.FAR_BOTTOM_RIGHT,s.NEAR_BOTTOM_RIGHT,s.NEAR_BOTTOM_LEFT,s.FAR_BOTTOM_LEFT,s.NEAR_BOTTOM_LEFT,s.NEAR_BOTTOM_RIGHT,s.NEAR_TOP_RIGHT,s.NEAR_TOP_LEFT,s.FAR_BOTTOM_RIGHT,s.FAR_BOTTOM_LEFT,s.FAR_TOP_LEFT,s.FAR_TOP_RIGHT,s.NEAR_BOTTOM_RIGHT,s.FAR_BOTTOM_RIGHT,s.FAR_TOP_RIGHT,s.NEAR_TOP_RIGHT,s.FAR_BOTTOM_LEFT,s.NEAR_BOTTOM_LEFT,s.NEAR_TOP_LEFT,s.FAR_TOP_LEFT,s.FAR_TOP_LEFT,s.NEAR_TOP_LEFT,s.NEAR_TOP_RIGHT,s.FAR_TOP_RIGHT,function(t){t[t.NUM=6]="NUM"}(r||(r={})),function(t){t[t.NUM=8]="NUM"}(o||(o={})),(0,T.f)(-1,-1,-1,1),(0,T.f)(1,-1,-1,1),(0,T.f)(1,1,-1,1),(0,T.f)(-1,1,-1,1),(0,T.f)(-1,-1,1,1),(0,T.f)(1,-1,1,1),(0,T.f)(1,1,1,1),(0,T.f)(-1,1,1,1),new p.O(O),(0,l.d)(),(0,l.d)(),(0,l.d)(),(0,l.d)(),(0,l.d)(),(0,l.d)(),(0,l.d)(),(0,l.d)();var A,N,S=n(8498);class y{get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}constructor(t,e){this.objectToBoundingSphere=t,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new E,this._objectCount=0,e&&(void 0!==e.maximumObjectsPerNode&&(this._maximumObjectsPerNode=e.maximumObjectsPerNode),void 0!==e.maximumDepth&&(this._maximumDepth=e.maximumDepth))}destroy(){this._degenerateObjects.clear(),E.clearPool(),L[0]=null,C.prune(),W.prune()}add(t,e=t.length){this._objectCount+=e,this._grow(t,e);const n=E.acquire();for(let i=0;i<e;i++){const e=t[i];this._isDegenerate(e)?this._degenerateObjects.add(e):(n.init(this._root),this._add(e,n))}E.release(n)}remove(t,e=null){this._objectCount-=t.length;const n=E.acquire();for(const i of t){const t=(0,a.i)(e)?e:(0,d.b)(this.objectToBoundingSphere(i),G);x(t[3])?(n.init(this._root),this._remove(i,t,n)):this._degenerateObjects.delete(i)}E.release(n),this._shrink()}update(t,e){if(!x(e[3])&&this._isDegenerate(t))return;const n=function(t){return L[0]=t,L}(t);this.remove(n,e),this.add(n)}forEachAlongRay(t,e,n){const i=(0,p.w)(t,e);this._forEachNode(this._root,(t=>{if(!this._intersectsNode(i,t))return!1;const e=t.node;return e.terminals.forAll((t=>{this._intersectsObject(i,t)&&n(t)})),null!==e.residents&&e.residents.forAll((t=>{this._intersectsObject(i,t)&&n(t)})),!0}))}forEachAlongRayWithVerticalOffset(t,e,n,i){const s=(0,p.w)(t,e);this._forEachNode(this._root,(t=>{if(!this._intersectsNodeWithOffset(s,t,i))return!1;const e=t.node;return e.terminals.forAll((t=>{this._intersectsObjectWithOffset(s,t,i)&&n(t)})),null!==e.residents&&e.residents.forAll((t=>{this._intersectsObjectWithOffset(s,t,i)&&n(t)})),!0}))}forEach(t){this._forEachNode(this._root,(e=>{const n=e.node;return n.terminals.forAll(t),null!==n.residents&&n.residents.forAll(t),!0})),this._degenerateObjects.forEach(t)}forEachDegenerateObject(t){this._degenerateObjects.forEach(t)}findClosest(t,e,n,i=(()=>!0),s=1/0){let r=1/0,o=1/0,c=null;const a=w(t,e),h=a=>{if(--s,!i(a))return;const h=this.objectToBoundingSphere(a);if(!b(n,h))return;const u=v(t,e,(0,d.d)(h)),l=u-h[3],f=u+h[3];l<r&&(r=l,o=f,c=a)};return this._forEachNodeDepthOrdered(this._root,(i=>{if(s<=0||!b(n,i.bounds))return!1;if((0,l.g)(V,a,i.halfSize),(0,l.a)(V,V,i.bounds),v(t,e,V)>o)return!1;const r=i.node;return r.terminals.forAll((t=>h(t))),null!==r.residents&&r.residents.forAll((t=>h(t))),!0}),t,e),c}forEachInDepthRange(t,e,n,i,s,r,o){let c=-1/0,a=1/0;const h={setRange:t=>{n===y.DepthOrder.FRONT_TO_BACK?(c=Math.max(c,t.near),a=Math.min(a,t.far)):(c=Math.max(c,-t.far),a=Math.min(a,-t.near))}};h.setRange(i);const u=v(e,n,t),f=w(e,n),_=w(e,-n),m=t=>{if(!o(t))return;const i=this.objectToBoundingSphere(t),l=(0,d.d)(i),f=v(e,n,l)-u,_=f-i[3],m=f+i[3];_>a||m<c||!b(r,i)||s(t,h)};this._forEachNodeDepthOrdered(this._root,(t=>{if(!b(r,t.bounds))return!1;if((0,l.g)(V,f,t.halfSize),(0,l.a)(V,V,t.bounds),v(e,n,V)-u>a)return!1;if((0,l.g)(V,_,t.halfSize),(0,l.a)(V,V,t.bounds),v(e,n,V)-u<c)return!1;const i=t.node;return i.terminals.forAll((t=>m(t))),null!==i.residents&&i.residents.forAll((t=>m(t))),!0}),e,n)}forEachNode(t){this._forEachNode(this._root,(e=>t(e.node,e.bounds,e.halfSize,e.depth)))}forEachNeighbor(t,e){const n=(0,d.g)(e),i=(0,d.d)(e),s=e=>{const s=this.objectToBoundingSphere(e),r=(0,d.g)(s),o=n+r;return!((0,l.H)((0,d.d)(s),i)-o*o<=0)||t(e)};let r=!0;const o=t=>{r&&(r=s(t))};this._forEachNode(this._root,(t=>{const e=(0,d.g)(t.bounds),s=n+e;if((0,l.H)((0,d.d)(t.bounds),i)-s*s>0)return!1;const c=t.node;return c.terminals.forAll(o),r&&null!==c.residents&&c.residents.forAll(o),r})),r&&this.forEachDegenerateObject(o)}_intersectsNode(t,e){return M(e.bounds,2*-e.halfSize,D),M(e.bounds,2*e.halfSize,j),(0,S.r)(t.origin,t.direction,D,j)}_intersectsNodeWithOffset(t,e,n){return M(e.bounds,2*-e.halfSize,D),M(e.bounds,2*e.halfSize,j),n.applyToMinMax(D,j),(0,S.r)(t.origin,t.direction,D,j)}_intersectsObject(t,e){const n=this.objectToBoundingSphere(e);return!(n[3]>0)||(0,d.i)(n,t)}_intersectsObjectWithOffset(t,e,n){const i=this.objectToBoundingSphere(e);return!(i[3]>0)||(0,d.i)(n.applyToBoundingSphere(i),t)}_forEachNode(t,e){let n=E.acquire().init(t);const i=[n];for(;0!==i.length;){if(n=i.pop(),e(n)&&!n.isLeaf())for(let t=0;t<n.node.children.length;t++)n.node.children[t]&&i.push(E.acquire().init(n).advance(t));E.release(n)}}_forEachNodeDepthOrdered(t,e,n,i=y.DepthOrder.FRONT_TO_BACK){let s=E.acquire().init(t);const r=[s];for(function(t,e,n){if(!W.length)for(let t=0;t<8;++t)W.push({index:0,distance:0});for(let n=0;n<8;++n){const i=P[n];W.data[n].index=n,W.data[n].distance=v(t,e,i)}W.sort(((t,e)=>t.distance-e.distance));for(let t=0;t<8;++t)n[t]=W.data[t].index}(n,i,X);0!==r.length;){if(s=r.pop(),e(s)&&!s.isLeaf())for(let t=7;t>=0;--t){const e=X[t];s.node.children[e]&&r.push(E.acquire().init(s).advance(e))}E.release(s)}}_remove(t,e,n){C.clear();const i=n.advanceTo(e,((t,e)=>{C.push(t.node),C.push(e)}))?n.node.terminals:n.node.residents;if(i.removeUnordered(t),0===i.length)for(let t=C.length-2;t>=0;t-=2){const e=C.data[t],n=C.data[t+1];if(!this._purge(e,n))break}}_nodeIsEmpty(t){if(0!==t.terminals.length)return!1;if(null!==t.residents)return 0===t.residents.length;for(let e=0;e<t.children.length;e++)if(t.children[e])return!1;return!0}_purge(t,e){return e>=0&&(t.children[e]=null),!!this._nodeIsEmpty(t)&&(null===t.residents&&(t.residents=new g.P({shrink:!0})),!0)}_add(t,e){e.advanceTo(this.objectToBoundingSphere(t))?e.node.terminals.push(t):(e.node.residents.push(t),e.node.residents.length>this._maximumObjectsPerNode&&e.depth<this._maximumDepth&&this._split(e))}_split(t){const e=t.node.residents;t.node.residents=null;for(let n=0;n<e.length;n++){const i=E.acquire().init(t);this._add(e.getItemAt(n),i),E.release(i)}}_grow(t,e){if(0!==e&&(I(t,e,(t=>this.objectToBoundingSphere(t)),H),x(H[3])&&!this._fitsInsideTree(H)))if(this._nodeIsEmpty(this._root.node))(0,d.b)(H,this._root.bounds),this._root.halfSize=1.25*this._root.bounds[3],this._root.updateBoundsRadiusFromHalfSize();else{const t=this._rootBoundsForRootAsSubNode(H);this._placingRootViolatesMaxDepth(t)?this._rebuildTree(H,t):this._growRootAsSubNode(t),E.release(t)}}_rebuildTree(t,e){(0,l.c)(k,e.bounds),k[3]=e.halfSize,I([t,k],2,(t=>t),U);const n=E.acquire().init(this._root);this._root.initFrom(null,U,U[3]),this._root.increaseHalfSize(1.25),this._forEachNode(n,(t=>(this.add(t.node.terminals.data,t.node.terminals.length),null!==t.node.residents&&this.add(t.node.residents.data,t.node.residents.length),!0))),E.release(n)}_placingRootViolatesMaxDepth(t){const e=Math.log(t.halfSize/this._root.halfSize)*Math.LOG2E;let n=0;return this._forEachNode(this._root,(t=>(n=Math.max(n,t.depth),n+e<=this._maximumDepth))),n+e>this._maximumDepth}_rootBoundsForRootAsSubNode(t){const e=t[3],n=t;let i=-1/0;const s=this._root.bounds,r=this._root.halfSize;for(let t=0;t<3;t++){const o=s[t]-r-(n[t]-e),c=n[t]+e-(s[t]+r),a=Math.max(0,Math.ceil(o/(2*r))),h=Math.max(0,Math.ceil(c/(2*r)))+1,u=2**Math.ceil(Math.log(a+h)*Math.LOG2E);i=Math.max(i,u),q[t].min=a,q[t].max=h}for(let t=0;t<3;t++){let e=q[t].min,n=q[t].max;const o=(i-(e+n))/2;e+=Math.ceil(o),n+=Math.floor(o);const c=s[t]-r-e*r*2;B[t]=c+(n+e)*r}const o=i*r;return B[3]=o*z,E.acquire().initFrom(null,B,o,0)}_growRootAsSubNode(t){const e=this._root.node;(0,l.c)(H,this._root.bounds),H[3]=this._root.halfSize,this._root.init(t),t.advanceTo(H,null,!0),t.node.children=e.children,t.node.residents=e.residents,t.node.terminals=e.terminals}_shrink(){for(;;){const t=this._findShrinkIndex();if(-1===t)break;this._root.advance(t),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let t=null;const e=this._root.node.children;let n=0,i=0;for(;i<e.length&&null==t;)n=i++,t=e[n];for(;i<e.length;)if(e[i++])return-1;return n}_isDegenerate(t){return!x(this.objectToBoundingSphere(t)[3])}_fitsInsideTree(t){const e=this._root.bounds,n=this._root.halfSize;return t[3]<=n&&t[0]>=e[0]-n&&t[0]<=e[0]+n&&t[1]>=e[1]-n&&t[1]<=e[1]+n&&t[2]>=e[2]-n&&t[2]<=e[2]+n}toJSON(){const{maximumDepth:t,maximumObjectsPerNode:e,_objectCount:n}=this,i=this._nodeToJSON(this._root.node);return{maximumDepth:t,maximumObjectsPerNode:e,objectCount:n,root:{bounds:this._root.bounds,halfSize:this._root.halfSize,depth:this._root.depth,node:i}}}_nodeToJSON(t){const e=t.children.map((t=>t?this._nodeToJSON(t):null)),n=t.residents?.map((t=>this.objectToBoundingSphere(t))),i=t.terminals?.map((t=>this.objectToBoundingSphere(t)));return{children:e,residents:n,terminals:i}}static fromJSON(t){const e=new y((t=>t),{maximumDepth:t.maximumDepth,maximumObjectsPerNode:t.maximumObjectsPerNode});return e._objectCount=t.objectCount,e._root.initFrom(t.root.node,t.root.bounds,t.root.halfSize,t.root.depth),e}}class E{constructor(){this.bounds=(0,d.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}init(t){return this.initFrom(t.node,t.bounds,t.halfSize,t.depth)}initFrom(t,e,n,i=this.depth){return this.node=(0,a.i)(t)?t:E.createEmptyNode(),(0,a.i)(e)&&(0,d.b)(e,this.bounds),this.halfSize=n,this.depth=i,this}increaseHalfSize(t){this.halfSize*=t,this.updateBoundsRadiusFromHalfSize()}updateBoundsRadiusFromHalfSize(){this.bounds[3]=this.halfSize*z}advance(t){let e=this.node.children[t];e||(e=E.createEmptyNode(),this.node.children[t]=e),this.node=e,this.halfSize/=2,this.depth++;const n=P[t];return this.bounds[0]+=n[0]*this.halfSize,this.bounds[1]+=n[1]*this.halfSize,this.bounds[2]+=n[2]*this.halfSize,this.updateBoundsRadiusFromHalfSize(),this}advanceTo(t,e,n=!1){for(;;){if(this.isTerminalFor(t))return e&&e(this,-1),!0;if(this.isLeaf()){if(!n)return e&&e(this,-1),!1;this.node.residents=null}const i=this._childIndex(t);e&&e(this,i),this.advance(i)}}isLeaf(){return null!=this.node.residents}isTerminalFor(t){return t[3]>this.halfSize/2}_childIndex(t){const e=this.bounds;return(e[0]<t[0]?1:0)+(e[1]<t[1]?2:0)+(e[2]<t[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new g.P({shrink:!0}),residents:new g.P({shrink:!0})}}static acquire(){return E._pool.acquire()}static release(t){E._pool.release(t)}static clearPool(){E._pool.prune()}}function R(t,e){t[0]=Math.max(t[0],e[0]+e[3]),t[1]=Math.max(t[1],e[1]+e[3]),t[2]=Math.max(t[2],e[2]+e[3])}function M(t,e,n){n[0]=t[0]+e,n[1]=t[1]+e,n[2]=t[2]+e}function I(t,e,n,i){if(1===e){const e=n(t[0]);(0,d.b)(e,i)}else{D[0]=1/0,D[1]=1/0,D[2]=1/0,j[0]=-1/0,j[1]=-1/0,j[2]=-1/0;for(let i=0;i<e;i++){const e=n(t[i]);x(e[3])&&(r=e,(s=D)[0]=Math.min(s[0],r[0]-r[3]),s[1]=Math.min(s[1],r[1]-r[3]),s[2]=Math.min(s[2],r[2]-r[3]),R(j,e))}(0,l.A)(i,D,j,.5),i[3]=Math.max(j[0]-D[0],j[1]-D[1],j[2]-D[2])/2}var s,r}function w(t,e){let n,i=1/0;for(let s=0;s<8;++s){const r=v(t,e,F[s]);r<i&&(i=r,n=F[s])}return n}function v(t,e,n){return e*(t[0]*n[0]+t[1]*n[1]+t[2]*n[2])}function x(t){return!isNaN(t)&&t!==-1/0&&t!==1/0&&t>0}E._pool=new m.O(E),A=y||(y={}),(N=A.DepthOrder||(A.DepthOrder={}))[N.FRONT_TO_BACK=1]="FRONT_TO_BACK",N[N.BACK_TO_FRONT=-1]="BACK_TO_FRONT";const P=[(0,l.f)(-1,-1,-1),(0,l.f)(1,-1,-1),(0,l.f)(-1,1,-1),(0,l.f)(1,1,-1),(0,l.f)(-1,-1,1),(0,l.f)(1,-1,1),(0,l.f)(-1,1,1),(0,l.f)(1,1,1)],F=[(0,l.f)(-1,-1,-1),(0,l.f)(-1,-1,1),(0,l.f)(-1,1,-1),(0,l.f)(-1,1,1),(0,l.f)(1,-1,-1),(0,l.f)(1,-1,1),(0,l.f)(1,1,-1),(0,l.f)(1,1,1)],z=Math.sqrt(3),L=[null],B=(0,d.c)(),V=(0,l.d)(),D=(0,l.d)(),j=(0,l.d)(),C=new g.P,G=(0,d.c)(),H=(0,d.c)(),k=(0,d.c)(),U=(0,d.c)(),q=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],W=new g.P,X=[0,0,0,0,0,0,0,0],Z=y;var J=n(73402);function K(t,e,n){const i=(0,d.c)(),s=(0,d.d)(i);return(0,l.w)(s,s,t,.5),(0,l.w)(s,s,e,.5),i[3]=(0,l.D)(s,t),(0,l.a)(s,s,n),i}n(76506),n(71552),n(31450),n(40642),n(86656),n(66396),n(6540),n(29794),n(82426),n(79764),n(32191),n(40961),n(44567),n(34250),n(60474),n(2906),n(21801),n(73796),n(12047),n(21972),n(19657),n(97714),n(60947),n(53785),n(57251),n(89623),n(91597),n(86787),n(35132),n(98380),n(92482),n(71435),n(32422),n(84069),n(92896),n(30831),n(91700),n(72274),n(27874),n(36097),n(5777),n(90529),n(66774),n(59465),n(24251),n(1623),n(89914),n(12381),n(73173),n(82058),n(88762),n(32101),n(92624),n(92847),n(77314),n(4978),n(95533),n(94751),n(95307),n(74569),n(22781),n(94216),n(81731),n(40267),n(53326),n(14249),n(60217),n(99045),n(8358),n(92457),n(15215),n(40167),n(47880),n(99520),n(67095),n(51006);let Y=class{constructor(){this._idToComponent=new Map,this._components=new Z((t=>t.bounds)),this._edges=new Z((t=>t.bounds)),this._tmpLineSegment=(0,f.c)(),this._tmpP1=(0,l.d)(),this._tmpP2=(0,l.d)(),this._tmpP3=(0,l.d)(),this.remoteClient=null}async fetchCandidates(t,e){await Promise.resolve(),(0,h.k_)(e),await this._ensureEdgeLocations(t,e);const n=[];return this._edges.forEachNeighbor((e=>(this._addCandidates(t,e,n),n.length<1e3)),t.bounds),{result:{candidates:n}}}async _ensureEdgeLocations(t,e){const n=[];if(this._components.forEachNeighbor((t=>{if((0,a.a)(t.info)){const{id:e,uid:i}=t;n.push({id:e,uid:i})}return!0}),t.bounds),!n.length)return;const i={components:n},s=await this.remoteClient.invoke("fetchAllEdgeLocations",i,(0,a.e)(e,{}));for(const t of s.components)this._setFetchEdgeLocations(t)}async add(t){const e=new Q(t.id,t.bounds);return this._idToComponent.set(e.id,e),this._components.add([e]),{result:{}}}async remove(t){const e=this._idToComponent.get(t.id);if(e){const t=[];this._edges.forEachNeighbor((n=>(n.component===e&&t.push(n),!0)),e.bounds),this._edges.remove(t),this._components.remove([e]),this._idToComponent.delete(e.id)}return{result:{}}}_setFetchEdgeLocations(t){const e=this._idToComponent.get(t.id);if((0,a.a)(e)||t.uid!==e.uid)return;const n=J.e.createView(t.locations),i=new Array(n.count),s=(0,l.d)(),r=(0,l.d)();for(let o=0;o<n.count;o++){n.position0.getVec(o,s),n.position1.getVec(o,r);const c=K(s,r,t.origin),a=new tt(e,o,c);i[o]=a}this._edges.add(i);const{objectIds:o,origin:c}=t;e.info={locations:n,objectIds:o,origin:c}}_addCandidates(t,e,n){const{info:i}=e.component,{origin:s,objectIds:r}=i,o=i.locations,c=o.position0.getVec(e.index,this._tmpP1),a=o.position1.getVec(e.index,this._tmpP2);(0,l.a)(c,c,s),(0,l.a)(a,a,s);const h=r[o.componentIndex.get(e.index)];this._addEdgeCandidate(t,h,c,a,n),this._addVertexCandidate(t,h,c,n),this._addVertexCandidate(t,h,a,n)}_addEdgeCandidate(t,e,n,i,s){if(!(t.types&_.S.EDGE))return;const r=(0,d.d)(t.bounds),o=(0,f.f)(n,i,this._tmpLineSegment),c=(0,f.i)(o,r,this._tmpP3);(0,d.m)(t.bounds,c)&&s.push({type:"edge",objectId:e,target:(0,l.k)(c),distance:(0,l.D)(r,c),start:(0,l.k)(n),end:(0,l.k)(i)})}_addVertexCandidate(t,e,n,i){if(!(t.types&_.S.VERTEX))return;const s=(0,d.d)(t.bounds);(0,d.m)(t.bounds,n)&&i.push({type:"vertex",objectId:e,target:(0,l.k)(n),distance:(0,l.D)(s,n)})}};Y=(0,c._)([(0,u.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],Y);const $=Y;class Q{constructor(t,e){this.id=t,this.bounds=e,this.info=null,this.uid=++Q.uid}}Q.uid=0;class tt{constructor(t,e,n){this.component=t,this.index=e,this.bounds=n}}},8498:(t,e,n)=>{n.d(e,{a:()=>s,r:()=>r}),n(32191),n(7200),(0,n(68681).c)();class i{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function s(t,e){if(!t){e=e||"Assertion";const t=new Error(e).stack;throw new i(`${e} at ${t}`)}}function r(t,e,n,i){let s,r=(n[0]-t[0])/e[0],o=(i[0]-t[0])/e[0];r>o&&(s=r,r=o,o=s);let c=(n[1]-t[1])/e[1],a=(i[1]-t[1])/e[1];if(c>a&&(s=c,c=a,a=s),r>a||c>o)return!1;c>r&&(r=c),a<o&&(o=a);let h=(n[2]-t[2])/e[2],u=(i[2]-t[2])/e[2];return h>u&&(s=h,h=u,u=s),!(r>u||h>o||(u<o&&(o=u),o<0))}},5777:(t,e,n)=>{n.d(e,{c:()=>i});var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{}},79764:(t,e,n)=>{function i(t){return 32+t.length}function s(t){if(!t)return 0;let e=a;for(const n in t)if(t.hasOwnProperty(n)){const s=t[n];switch(typeof s){case"string":e+=i(s);break;case"number":e+=16;break;case"boolean":e+=4}}return e}function r(t){if(!t)return 0;if(Array.isArray(t))return function(t){const e=t.length;if(0===e||"number"==typeof t[0])return 32+8*e;let n=h;for(let i=0;i<e;i++)n+=o(t[i]);return n}(t);let e=a;for(const n in t)t.hasOwnProperty(n)&&(e+=o(t[n]));return e}function o(t){switch(typeof t){case"object":return r(t);case"string":return i(t);case"number":return 16;case"boolean":return 4;default:return 8}}function c(t,e){return h+t.length*e}n.d(e,{B:()=>u,a:()=>r,b:()=>c,e:()=>s});const a=32,h=32;var u;!function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"}(u||(u={}))},8358:(t,e,n)=>{n.d(e,{d:()=>r});var i=n(82426),s=n(92457);function r(t,e,n){const r=Array.isArray(t),u=r?t.length/e:t.byteLength/(4*e),l=r?t:new Uint32Array(t,0,u*e),f=n?.minReduction??0,d=n?.originalIndices||null,_=d?d.length:0,m=n?.componentOffsets||null;let g=0;if(m)for(let t=0;t<m.length-1;t++){const e=m[t+1]-m[t];e>g&&(g=e)}else g=u;const p=Math.floor(1.1*g)+1;(null==h||h.length<2*p)&&(h=new Uint32Array((0,i.n)(2*p)));for(let t=0;t<2*p;t++)h[t]=0;let T=0;const O=!!m&&!!d,b=O?_:u;let A=(0,s.n)(u);const N=new Uint32Array(_),S=1.96;let y=0!==f?Math.ceil(4*S*S/(f*f)*f*(1-f)):b,E=1,R=m?m[1]:b;for(let t=0;t<b;t++){if(t===y){const e=1-T/t;if(e+S*Math.sqrt(e*(1-e)/t)<f)return null;y*=2}if(t===R){for(let t=0;t<2*p;t++)h[t]=0;if(d)for(let t=m[E-1];t<m[E];t++)N[t]=A[d[t]];R=m[++E]}const n=O?d[t]:t,i=n*e,s=a(l,i,e);let r=s%p,c=T;for(;0!==h[2*r+1];){if(h[2*r]===s){const t=h[2*r+1]-1;if(o(l,i,t*e,e)){c=A[t];break}}r++,r>=p&&(r-=p)}c===T&&(h[2*r]=s,h[2*r+1]=n+1,T++),A[n]=c}if(0!==f&&1-T/u<f)return null;if(O){for(let t=m[E-1];t<N.length;t++)N[t]=A[d[t]];A=(0,s.c)(N)}const M=r?new Array(T):new Uint32Array(T*e);T=0;for(let t=0;t<b;t++)A[t]===T&&(c(l,(O?d[t]:t)*e,M,T*e,e),T++);if(d&&!O){const t=new Uint32Array(_);for(let e=0;e<t.length;e++)t[e]=A[d[e]];A=(0,s.c)(t)}return{buffer:Array.isArray(M)?M:M.buffer,indices:A,uniqueCount:T}}function o(t,e,n,i){for(let s=0;s<i;s++)if(t[e+s]!==t[n+s])return!1;return!0}function c(t,e,n,i,s){for(let r=0;r<s;r++)n[i+r]=t[e+r]}function a(t,e,n){let i=0;for(let s=0;s<n;s++)i=t[e+s]+i|0,i=i+(i<<11)+(i>>>2)|0;return i>>>0}let h=null},73402:(t,e,n)=>{n.d(e,{E:()=>u,c:()=>D,d:()=>j,e:()=>U,f:()=>x,h:()=>k});var i=n(8358),s=n(15215),r=n(99520),o=n(67095),c=n(48578),a=n(72836),h=n(82426);const u=(0,s.n)().vec3f(r.V.POSITION).u16(r.V.COMPONENTINDEX).u16(r.V.U16PADDING),l=(0,s.n)().vec2u8(r.V.SIDENESS),f=((0,o.g)(l),(0,s.n)().vec3f(r.V.POSITION0).vec3f(r.V.POSITION1).u16(r.V.COMPONENTINDEX).u8(r.V.VARIANTOFFSET,{glNormalized:!0}).u8(r.V.VARIANTSTROKE).u8(r.V.VARIANTEXTENSION,{glNormalized:!0}).u8(r.V.U8PADDING,{glPadding:!0}).u16(r.V.U16PADDING,{glPadding:!0})),d=f.clone().vec3f(r.V.NORMAL),_=f.clone().vec3f(r.V.NORMALA).vec3f(r.V.NORMALB);function m(t,e,n){const i=e/3,s=new Uint32Array(n+1),r=new Uint32Array(n+1),o=(t,e)=>{t<e?s[t+1]++:r[e+1]++};for(let e=0;e<i;e++){const n=t[3*e],i=t[3*e+1],s=t[3*e+2];o(n,i),o(i,s),o(s,n)}let c=0,a=0;for(let t=0;t<n;t++){const e=s[t+1],n=r[t+1];s[t+1]=c,r[t+1]=a,c+=e,a+=n}const h=new Uint32Array(6*i),u=s[n],l=(t,e,n)=>{if(t<e){const i=s[t+1]++;h[2*i]=e,h[2*i+1]=n}else{const i=r[e+1]++;h[2*u+2*i]=t,h[2*u+2*i+1]=n}};for(let e=0;e<i;e++){const n=t[3*e],i=t[3*e+1],s=t[3*e+2];l(n,i,e),l(i,s,e),l(s,n,e)}const f=(t,e)=>{const n=2*t,i=e-t;for(let t=1;t<i;t++){const e=h[n+2*t],i=h[n+2*t+1];let s=t-1;for(;s>=0&&h[n+2*s]>e;s--)h[n+2*s+2]=h[n+2*s],h[n+2*s+3]=h[n+2*s+1];h[n+2*s+2]=e,h[n+2*s+3]=i}};for(let t=0;t<n;t++)f(s[t],s[t+1]),f(u+r[t],u+r[t+1]);const d=new Int32Array(3*i),_=(e,n)=>e===t[3*n]?0:e===t[3*n+1]?1:e===t[3*n+2]?2:-1,m=(t,e)=>{const n=_(t,e);d[3*e+n]=-1},g=(t,e,n,i)=>{const s=_(t,e);d[3*e+s]=i;const r=_(n,i);d[3*i+r]=e};for(let t=0;t<n;t++){let e=s[t];const n=s[t+1];let i=r[t];const o=r[t+1];for(;e<n&&i<o;){const n=h[2*e],s=h[2*u+2*i];n===s?(g(t,h[2*e+1],s,h[2*u+2*i+1]),e++,i++):n<s?(m(t,h[2*e+1]),e++):(m(s,h[2*u+2*i+1]),i++)}for(;e<n;)m(t,h[2*e+1]),e++;for(;i<o;)m(h[2*u+2*i],h[2*u+2*i+1]),i++}return d}new Map([[r.V.POSITION0,0],[r.V.POSITION1,1],[r.V.COMPONENTINDEX,2],[r.V.VARIANTOFFSET,3],[r.V.VARIANTSTROKE,4],[r.V.VARIANTEXTENSION,5],[r.V.NORMAL,6],[r.V.NORMALA,6],[r.V.NORMALB,7],[r.V.SIDENESS,8]]);class g{updateSettings(t){this.settings=t,this._edgeHashFunction=t.reducedPrecision?A:b}write(t,e,n){const i=this._edgeHashFunction(n);M.seed=i;const s=M.getIntRange(0,255),r=M.getIntRange(0,this.settings.variants-1),o=M.getFloat(),c=255*(.5*function(t,e){const n=t<0?-1:1;return Math.abs(t)**1.2*n}(-(1-Math.min(o/.7,1))+Math.max(0,o-.7)/(1-.7))+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,s),t.variantStroke.set(e,r),t.variantExtension.set(e,c)}trim(t,e){return t.slice(0,e)}}const p=new Float32Array(6),T=new Uint32Array(p.buffer),O=new Uint32Array(1);function b(t){const e=p;e[0]=t.position0[0],e[1]=t.position0[1],e[2]=t.position0[2],e[3]=t.position1[0],e[4]=t.position1[1],e[5]=t.position1[2],O[0]=5381;for(let t=0;t<T.length;t++)O[0]=31*O[0]+T[t];return O[0]}function A(t){const e=p;e[0]=S(t.position0[0]),e[1]=S(t.position0[1]),e[2]=S(t.position0[2]),e[3]=S(t.position1[0]),e[4]=S(t.position1[1]),e[5]=S(t.position1[2]),O[0]=5381;for(let t=0;t<T.length;t++)O[0]=31*O[0]+T[t];return O[0]}const N=1e4;function S(t){return Math.round(t*N)/N}class y{constructor(){this._commonWriter=new g}updateSettings(t){this._commonWriter.updateSettings(t)}allocate(t){return d.createBuffer(t)}write(t,e,n){this._commonWriter.write(t,e,n),(0,a.a)(R,n.faceNormal0,n.faceNormal1),(0,a.n)(R,R),t.normal.setVec(e,R)}trim(t,e){return this._commonWriter.trim(t,e)}}y.Layout=d,y.glLayout=(0,o.g)(d,1);class E{constructor(){this._commonWriter=new g}updateSettings(t){this._commonWriter.updateSettings(t)}allocate(t){return _.createBuffer(t)}write(t,e,n){this._commonWriter.write(t,e,n),t.normalA.setVec(e,n.faceNormal0),t.normalB.setVec(e,n.faceNormal1)}trim(t,e){return this._commonWriter.trim(t,e)}}E.Layout=_,E.glLayout=(0,o.g)(_,1);const R=(0,a.d)(),M=new c.R,I=-1;var w,v;function x(t,e,n,i=V){const s=t.vertices.position,r=t.vertices.componentIndex,o=(0,h.d)(i.anglePlanar),u=(0,h.d)(i.angleSignificantEdge),l=Math.cos(u),f=Math.cos(o),d=L.edge,_=d.position0,m=d.position1,g=d.faceNormal0,p=d.faceNormal1,T=function(t){const e=t.faces.length/3,n=t.vertices.position,i=t.faces,s=B.v0,r=B.v1,o=B.v2,c=new Float32Array(3*e);for(let t=0;t<e;t++){const e=i[3*t],h=i[3*t+1],u=i[3*t+2];n.getVec(e,s),n.getVec(h,r),n.getVec(u,o),(0,a.b)(r,r,s),(0,a.b)(o,o,s),(0,a.h)(s,r,o),(0,a.n)(s,s),c[3*t]=s[0],c[3*t+1]=s[1],c[3*t+2]=s[2]}return c}(t),O=function(t){const e=t.faces.length/3,n=t.faces,i=t.neighbors;let s=0;for(let t=0;t<e;t++){const e=i[3*t],r=i[3*t+1],o=i[3*t+2],c=n[3*t],a=n[3*t+1],h=n[3*t+2];s+=e===I||c<a?1:0,s+=r===I||a<h?1:0,s+=o===I||h<c?1:0}const r=new Int32Array(4*s);let o=0;for(let t=0;t<e;t++){const e=i[3*t],s=i[3*t+1],c=i[3*t+2],a=n[3*t],h=n[3*t+1],u=n[3*t+2];(e===I||a<h)&&(r[o++]=a,r[o++]=h,r[o++]=t,r[o++]=e),(s===I||h<u)&&(r[o++]=h,r[o++]=u,r[o++]=t,r[o++]=s),(c===I||u<a)&&(r[o++]=u,r[o++]=a,r[o++]=t,r[o++]=c)}return r}(t),b=O.length/4,A=e.allocate(b);let N=0;const S=b,y=n.allocate(S);let E=0,R=0,M=0;const w=(0,c.E)(0,b),v=new Float32Array(b);v.forEach(((t,e,n)=>{s.getVec(O[4*e],_),s.getVec(O[4*e+1],m),n[e]=(0,a.D)(_,m)})),w.sort(((t,e)=>v[e]-v[t]));const x=new Array,D=new Array;for(let t=0;t<b;t++){const i=w[t],c=v[i],h=O[4*i],u=O[4*i+1],b=O[4*i+2],S=O[4*i+3],L=S===I;if(s.getVec(h,_),s.getVec(u,m),L)(0,a.s)(g,T[3*b],T[3*b+1],T[3*b+2]),(0,a.c)(p,g),d.componentIndex=r.get(h),d.cosAngle=(0,a.m)(g,p);else{if((0,a.s)(g,T[3*b],T[3*b+1],T[3*b+2]),(0,a.s)(p,T[3*S],T[3*S+1],T[3*S+2]),d.componentIndex=r.get(h),d.cosAngle=(0,a.m)(g,p),F(d,f))continue;d.cosAngle<-.9999&&(0,a.c)(p,g)}R+=c,M++,L||P(d,l)?(e.write(A,N++,d),x.push(c)):z(d,o)&&(n.write(y,E++,d),D.push(c))}const j=new Float32Array(x.reverse()),C=new Float32Array(D.reverse());return{regular:{instancesData:e.trim(A,N),lodInfo:{lengths:j}},silhouette:{instancesData:n.trim(y,E),lodInfo:{lengths:C}},averageEdgeLength:R/M}}function P(t,e){return t.cosAngle<e}function F(t,e){return t.cosAngle>e}function z(t,e){const n=(0,h.b)(t.cosAngle),i=L.fwd,s=L.ortho;return(0,a.G)(i,t.position1,t.position0),n*((0,a.m)((0,a.h)(s,t.faceNormal0,t.faceNormal1),i)>0?-1:1)>e}(v=w||(w={}))[v.SOLID=0]="SOLID",v[v.SKETCH=1]="SKETCH";const L={edge:{position0:(0,a.d)(),position1:(0,a.d)(),faceNormal0:(0,a.d)(),faceNormal1:(0,a.d)(),componentIndex:0,cosAngle:0},ortho:(0,a.d)(),fwd:(0,a.d)()},B={v0:(0,a.d)(),v1:(0,a.d)(),v2:(0,a.d)()},V={anglePlanar:4,angleSignificantEdge:35};function D(t){const e=j(t.data,t.skipDeduplicate,t.indices,t.indicesLength);return G.updateSettings(t.writerSettings),H.updateSettings(t.writerSettings),x(e,G,H)}function j(t,e,n,s){if(e){const e=m(n,s,t.count);return new C(n,s,e,t)}const r=(0,i.d)(t.buffer,t.stride/4,{originalIndices:n,originalIndicesLength:s}),o=m(r.indices,s,r.uniqueCount);return{faces:r.indices,facesLength:r.indices.length,neighbors:o,vertices:u.createView(r.buffer)}}class C{constructor(t,e,n,i){this.faces=t,this.facesLength=e,this.neighbors=n,this.vertices=i}}const G=new y,H=new E,k=(0,s.n)().vec3f(r.V.POSITION0).vec3f(r.V.POSITION1),U=(0,s.n)().vec3f(r.V.POSITION0).vec3f(r.V.POSITION1).u16(r.V.COMPONENTINDEX).u16(r.V.U16PADDING,{glPadding:!0})},67095:(t,e,n)=>{n.d(e,{g:()=>r});var i=n(51006),s=n(59696);function r(t,e=0){const n=t.stride;return t.fieldNames.filter((e=>{const n=t.fields.get(e).optional;return!(n&&n.glPadding)})).map((i=>{const r=t.fields.get(i),c=r.constructor.ElementCount,a=function(t){const e=o[t];if(e)return e;throw new Error("BufferType not supported in WebGL")}(r.constructor.ElementType),h=r.offset,u=!(!r.optional||!r.optional.glNormalized);return new s.V(i,c,a,h,n,u,e)}))}const o={u8:i.D.UNSIGNED_BYTE,u16:i.D.UNSIGNED_SHORT,u32:i.D.UNSIGNED_INT,i8:i.D.BYTE,i16:i.D.SHORT,i32:i.D.INT,f32:i.D.FLOAT}},94446:(t,e,n)=>{n.d(e,{c:()=>o,f:()=>c,i:()=>a});var i=n(82426),s=n(2420),r=n(72836);function o(t){return t?{origin:(0,r.k)(t.origin),vector:(0,r.k)(t.vector)}:{origin:(0,r.d)(),vector:(0,r.d)()}}function c(t,e,n=o()){return(0,r.c)(n.origin,t),(0,r.b)(n.vector,e,t),n}function a(t,e,n){return function(t,e,n,o,c){const{vector:a,origin:h}=t,u=(0,r.b)(s.s.get(),e,h),l=(0,r.m)(a,u)/(0,r.I)(a);return(0,r.g)(c,a,(0,i.c)(l,0,1)),(0,r.a)(c,c,t.origin)}(t,e,0,0,n)}(0,r.d)(),(0,r.d)(),new s.O((()=>o()))},16912:(t,e,n)=>{function i(){return[1,0,0,0,1,0,0,0,1]}function s(t,e,n,i,s,r,o,c,a){return[t,e,n,i,s,r,o,c,a]}function r(t,e){return new Float64Array(t,e,9)}n.d(e,{a:()=>r,c:()=>i,f:()=>s})},57532:(t,e,n)=>{function i(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function r(t,e){return new Float64Array(t,e,16)}n.d(e,{I:()=>o,a:()=>r,b:()=>s,c:()=>i});const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},99045:(t,e,n)=>{n(82426);var i=n(72836);(0,i.d)(),(0,i.d)(),(0,i.d)(),(0,i.d)(),(0,i.d)()},94751:(t,e,n)=>{n.d(e,{c:()=>o,g:()=>h,o:()=>c,u:()=>a});var i=n(92896),s=n(60947),r=n(32422);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new i.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:s.Z.WebMercator}),minus180Line:new i.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:s.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new i.Z({paths:[[[180,-180],[180,180]]],spatialReference:s.Z.WGS84}),minus180Line:new i.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:s.Z.WGS84})}};function c(t,e){return Math.ceil((t-e)/(2*e))}function a(t,e){const n=h(t);for(const t of n)for(const n of t)n[0]+=e;return t}function h(t){return(0,r.oU)(t)?t.rings:t.paths}},55633:(t,e,n)=>{n(82426);var i,s,r=n(72836);n(48578),n(92143),n(40961),n(2420),n(99045),(0,r.d)(),(0,r.d)(),(0,r.d)(),(0,r.d)(),(0,r.d)(),(s=i||(i={}))[s.NONE=0]="NONE",s[s.CLAMP=1]="CLAMP",s[s.INFINITE_MIN=4]="INFINITE_MIN",s[s.INFINITE_MAX=8]="INFINITE_MAX",i.INFINITE_MIN,i.INFINITE_MAX,i.INFINITE_MAX},45087:(t,e,n)=>{function i(){return[0,0,0,1]}function s(t){return[t[0],t[1],t[2],t[3]]}function r(t,e){return new Float64Array(t,e,4)}n.d(e,{I:()=>o,a:()=>r,b:()=>s,c:()=>i});const o=[0,0,0,1]},2420:(t,e,n)=>{n.d(e,{O:()=>l,c:()=>p,d:()=>g,e:()=>b,s:()=>m,w:()=>O}),n(48578);var i=n(30773),s=n(72836),r=n(79764),o=n(16912),c=n(57532),a=n(45087),h=n(32191),u=n(68681);class l{constructor(t){this._allocator=t,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,i.n)((()=>this._reset())),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const t=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*f);this._items.length=Math.min(t,this._items.length),this._itemsPtr=0}_grow(){for(let t=0;t<Math.max(8,Math.min(this._items.length,f));t++)this._items.push(this._allocator())}}const f=1024;class d{constructor(t,e,n){this._itemByteSize=t,this._itemCreate=e,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(n/this._itemByteSize)}get(){0===this._itemsPtr&&(0,i.n)((()=>this._reset()));const t=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=t;){const t=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let e=0;e<this._itemsPerBuffer;++e)this._items.push(this._itemCreate(t,e*this._itemByteSize));this._buffers.push(t)}return this._items[this._itemsPtr++]}_reset(){const t=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>t;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(t=_){return new d(16,h.c,t)}static createVec3f64(t=_){return new d(24,s.r,t)}static createVec4f64(t=_){return new d(32,u.b,t)}static createMat3f64(t=_){return new d(72,o.a,t)}static createMat4f64(t=_){return new d(128,c.a,t)}static createQuatf64(t=_){return new d(32,a.a,t)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}}const _=4*r.B.KILOBYTES,m=(d.createVec2f64(),d.createVec3f64());d.createVec4f64(),d.createMat3f64();const g=d.createMat4f64();function p(t){return t?T((0,s.k)(t.origin),(0,s.k)(t.direction)):T((0,s.d)(),(0,s.d)())}function T(t,e){return{origin:t,direction:e}}function O(t,e){const n=A.get();return n.origin=t,n.direction=e,n}function b(t,e,n){const i=(0,s.m)(t.direction,(0,s.b)(n,e,t.origin));return(0,s.a)(n,t.origin,(0,s.g)(n,t.direction,i)),n}d.createQuatf64();const A=new l((()=>p()))},95307:(t,e,n)=>{n.d(e,{c:()=>a,s:()=>h}),n(74569);var i=n(82058),s=n(32422),r=n(94216),o=n(32101),c=n(81731);async function a(t,e,n,o){const c=(0,r.p)(t),a=e[0].spatialReference,h={...o,query:{...c.query,f:"json",sr:JSON.stringify(a),target:JSON.stringify({geometryType:(0,s.Ji)(e[0]),geometries:e}),cutter:JSON.stringify(n)}},u=await(0,i.default)(c.path+"/cut",h),{cutIndexes:l,geometries:f=[]}=u.data;return{cutIndexes:l,geometries:f.map((t=>{const e=(0,s.im)(t);return e.spatialReference=a,e}))}}async function h(t,e,n){const r="string"==typeof t?(0,o.mN)(t):t,a=e[0].spatialReference,h=(0,s.Ji)(e[0]),u={...n,query:{...r.query,f:"json",sr:a.wkid??JSON.stringify(a),geometries:JSON.stringify((0,c.e)(e))}},{data:l}=await(0,i.default)(r.path+"/simplify",u);return(0,c.d)(l.geometries,h,a)}},60939:(t,e,n)=>{n.d(e,{b:()=>d,c:()=>f,d:()=>m,g:()=>_,i:()=>T,m:()=>E}),n(48578);var i=n(92143),s=n(82426),r=n(71252),o=n(65775),c=n(72836),a=n(7200),h=n(68681),u=n(40961),l=n(2420);function f(){return(0,h.c)()}function d(t,e=f()){return(0,a.c)(e,t)}function _(t){return t[3]}function m(t){return t}function g(t,e,n){if((0,r.a)(e))return!1;const{origin:i,direction:s}=e,o=p;o[0]=i[0]-t[0],o[1]=i[1]-t[1],o[2]=i[2]-t[2];const c=s[0]*s[0]+s[1]*s[1]+s[2]*s[2];if(0===c)return!1;const a=2*(s[0]*o[0]+s[1]*o[1]+s[2]*o[2]),h=a*a-4*c*(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]-t[3]*t[3]);if(h<0)return!1;const u=Math.sqrt(h);let l=(-a-u)/(2*c);const f=(-a+u)/(2*c);return(l<0||f<l&&f>0)&&(l=f),!(l<0||(n&&(n[0]=i[0]+s[0]*l,n[1]=i[1]+s[1]*l,n[2]=i[2]+s[2]*l),0))}const p=(0,c.d)();function T(t,e){return g(t,e,null)}function O(t,e,n){const i=l.s.get(),s=l.d.get();(0,c.h)(i,e.origin,e.direction);const r=_(t);(0,c.h)(n,i,e.origin),(0,c.g)(n,n,1/(0,c.l)(n)*r);const a=A(t,e.origin),h=(0,u.a)(e.origin,n);return(0,o.a)(s,h+a,i),(0,c.e)(n,n,s),n}function b(t,e,n){const i=(0,c.b)(l.s.get(),e,t),s=(0,c.g)(l.s.get(),i,t[3]/(0,c.l)(i));return(0,c.a)(n,s,t)}function A(t,e){const n=(0,c.b)(l.s.get(),e,t),i=(0,c.l)(n),r=_(t),o=r+Math.abs(r-i);return(0,s.b)(r/o)}const N=(0,c.d)();function S(t,e,n,i){const r=(0,c.b)(N,e,t);switch(n){case u.A.X:{const t=(0,s.g)(r,N)[2];return(0,c.s)(i,-Math.sin(t),Math.cos(t),0)}case u.A.Y:{const t=(0,s.g)(r,N),e=t[1],n=t[2],o=Math.sin(e);return(0,c.s)(i,-o*Math.cos(n),-o*Math.sin(n),Math.cos(e))}case u.A.Z:return(0,c.n)(i,r);default:return}}function y(t,e){const n=(0,c.b)(R,e,t);return(0,c.l)(n)-t[3]}function E(t,e){const n=(0,c.H)(t,e),i=_(t);return n<=i*i}const R=(0,c.d)(),M=f();Object.freeze(Object.defineProperty({__proto__:null,altitudeAt:y,angleToSilhouette:A,axisAt:S,clear:function(t){t[0]=t[1]=t[2]=t[3]=0},closestPoint:function(t,e,n){return g(t,e,n)?n:((0,l.e)(e,t,n),b(t,n,n))},closestPointOnSilhouette:O,containsPoint:E,copy:d,create:f,distanceToSilhouette:function(t,e){const n=(0,c.b)(l.s.get(),e,t),i=(0,c.I)(n),s=t[3]*t[3];return Math.sqrt(Math.abs(i-s))},elevate:function(t,e,n){return t!==n&&(0,c.c)(n,t),n[3]=t[3]+e,n},fromCenterAndRadius:function(t,e){return(0,h.f)(t[0],t[1],t[2],e)},fromRadius:function(t,e){return t[0]=t[1]=t[2]=0,t[3]=e,t},fromValues:function(t,e,n,i){return(0,h.f)(t,e,n,i)},getCenter:m,getRadius:_,intersectRay:g,intersectRayClosestSilhouette:function(t,e,n){if(g(t,e,n))return n;const i=O(t,e,l.s.get());return(0,c.a)(n,e.origin,(0,c.g)(l.s.get(),e.direction,(0,c.D)(e.origin,i)/(0,c.l)(e.direction))),n},intersectsRay:T,projectPoint:b,setAltitudeAt:function(t,e,n,i){const s=y(t,e),r=S(t,e,u.A.Z,R),o=(0,c.g)(R,r,n-s);return(0,c.a)(i,e,o)},setExtent:function(t,e,n){return i.L.getLogger("esri.geometry.support.sphere").error("sphere.setExtent is not yet supported"),t===n?n:d(t,n)},tmpSphere:M,wrap:function(t){return t}},Symbol.toStringTag,{value:"Module"}))},94216:(t,e,n)=>{n.d(e,{a:()=>r,e:()=>c,p:()=>o}),n(31450),n(88762);var i=n(76506),s=n(32101);function r(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function o(t){return"string"==typeof t?(0,s.mN)(t):(0,i.d9)(t)}function c(t,e,n){const i={};for(const s in t){if("declaredClass"===s)continue;const r=t[s];if(null!=r&&"function"!=typeof r)if(Array.isArray(r)){i[s]=[];for(let t=0;t<r.length;t++)i[s][t]=c(r[t])}else if("object"==typeof r)if(r.toJSON){const t=r.toJSON(n&&n[s]);i[s]=e?t:JSON.stringify(t)}else i[s]=e?r:JSON.stringify(r);else i[s]=r}return i}n(82058)},81731:(t,e,n)=>{n.d(e,{d:()=>r,e:()=>s});var i=n(32422);function s(t){return{geometryType:(0,i.Ji)(t[0]),geometries:t.map((t=>t.toJSON()))}}function r(t,e,n){const s=(0,i.q9)(e);return t.map((t=>{const e=s.fromJSON(t);return e.spatialReference=n,e}))}},32191:(t,e,n)=>{function i(){return[0,0]}function s(t,e){return[t,e]}function r(t,e){return new Float64Array(t,e,2)}n.d(e,{a:()=>i,c:()=>r,f:()=>s}),s(1,1),s(1,0)},68681:(t,e,n)=>{function i(){return[0,0,0,0]}function s(t,e,n,i){return[t,e,n,i]}function r(t,e){return new Float64Array(t,e,4)}n.d(e,{b:()=>r,c:()=>i,f:()=>s}),s(1,1,1,1)},40961:(t,e,n)=>{n.d(e,{A:()=>i,a:()=>c});var i,s,r=n(82426),o=n(72836);function c(t,e){const n=(0,o.m)(t,e)/((0,o.l)(t)*(0,o.l)(e));return-(0,r.b)(n)}(s=i||(i={}))[s.X=0]="X",s[s.Y=1]="Y",s[s.Z=2]="Z",(0,o.d)(),(0,o.d)()},95533:(t,e,n)=>{n.d(e,{aX:()=>g});var i=n(31450),s=n(60991),r=n(92143),o=n(71252),c=n(44567),a=n(92896),h=n(94751),u=n(53785),l=n(35132),f=n(95307);n(48578),n(71552),n(76506),n(40642),n(34250),n(91306),n(60474),n(66396),n(86656),n(17533),n(6540),n(2906),n(21801),n(73796),n(12047),n(21972),n(91055),n(19657),n(6906),n(50406),n(97714),n(60947),n(57251),n(89623),n(91597),n(86787),n(98380),n(92482),n(82426),n(72836),n(29794),n(7200),n(32422),n(84069),n(74569),n(22781),n(82058),n(88762),n(32101),n(94216),n(81731);const d=r.L.getLogger("esri.geometry.support.normalizeUtils");function _(t,e,n){if(e){const e=function(t,e){if(!(t instanceof a.Z||t instanceof c.Z)){const t="straightLineDensify: the input geometry is neither polyline nor polygon";throw d.error(t),new s.Z(t)}const n=(0,h.g)(t),i=[];for(const t of n){const n=[];i.push(n),n.push([t[0][0],t[0][1]]);for(let i=0;i<t.length-1;i++){const s=t[i][0],r=t[i][1],o=t[i+1][0],c=t[i+1][1],a=Math.sqrt((o-s)*(o-s)+(c-r)*(c-r)),h=(c-r)/a,u=(o-s)/a,l=a/e;if(l>1){for(let t=1;t<=l-1;t++){const i=t*e,o=u*i+s,c=h*i+r;n.push([o,c])}const t=(a+Math.floor(l-1)*e)/2,i=u*t+s,o=h*t+r;n.push([i,o])}n.push([o,c])}}return function(t){return"polygon"===t.type}(t)?new c.Z({rings:i,spatialReference:t.spatialReference}):new a.Z({paths:i,spatialReference:t.spatialReference})}(t,1e6);t=(0,l.Sx)(e,!0)}return n&&(t=(0,h.u)(t,n)),t}function m(t,e,n){if(Array.isArray(t)){const i=t[0];if(i>e){const n=(0,h.o)(i,e);t[0]=i+n*(-2*e)}else if(i<n){const e=(0,h.o)(i,n);t[0]=i+e*(-2*n)}}else{const i=t.x;if(i>e){const n=(0,h.o)(i,e);t=t.clone().offset(n*(-2*e),0)}else if(i<n){const e=(0,h.o)(i,n);t=t.clone().offset(e*(-2*n),0)}}return t}async function g(t,e,n){if(!Array.isArray(t))return g([t],e);e&&"string"!=typeof e&&d.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const s="string"==typeof e?e:e?.url??i.Z.geometryServiceUrl;let r,p,T,O,b,A,N,S,y=0;const E=[],R=[];for(const e of t)if((0,o.a)(e))R.push(e);else if(r||(r=e.spatialReference,p=(0,u.h)(r),T=r.isWebMercator,A=T?102100:4326,O=h.c[A].maxX,b=h.c[A].minX,N=h.c[A].plus180Line,S=h.c[A].minus180Line),p)if("mesh"===e.type)R.push(e);else if("point"===e.type)R.push(m(e.clone(),O,b));else if("multipoint"===e.type){const t=e.clone();t.points=t.points.map((t=>m(t,O,b))),R.push(t)}else if("extent"===e.type){const t=e.clone()._normalize(!1,!1,p);R.push(t.rings?new c.Z(t):t)}else if(e.extent){const t=e.extent,n=(0,h.o)(t.xmin,b)*(2*O);let i=0===n?e.clone():(0,h.u)(e.clone(),n);t.offset(n,0),t.intersects(N)&&t.xmax!==O?(y=t.xmax>y?t.xmax:y,i=_(i,T),E.push(i),R.push("cut")):t.intersects(S)&&t.xmin!==b?(y=t.xmax*(2*O)>y?t.xmax*(2*O):y,i=_(i,T,360),E.push(i),R.push("cut")):R.push(i)}else R.push(e.clone());else R.push(e);let M=(0,h.o)(y,O),I=-90;const w=M,v=new a.Z;for(;M>0;){const t=360*M-180;v.addPath([[t,I],[t,-1*I]]),I*=-1,M--}if(E.length>0&&w>0){const e=function(t,e){let n=-1;for(let i=0;i<e.cutIndexes.length;i++){const s=e.cutIndexes[i],r=e.geometries[i],o=(0,h.g)(r);for(let t=0;t<o.length;t++){const e=o[t];e.some((n=>{if(n[0]<180)return!0;{let n=0;for(let t=0;t<e.length;t++){const i=e[t][0];n=i>n?i:n}n=Number(n.toFixed(9));const i=-360*(0,h.o)(n,180);for(let n=0;n<e.length;n++){const e=r.getPoint(t,n);r.setPoint(t,n,e.clone().offset(i,0))}return!0}}))}if(s===n){if("polygon"===t[0].type)for(const e of(0,h.g)(r))t[s]=t[s].addRing(e);else if("polyline"===t[0].type)for(const e of(0,h.g)(r))t[s]=t[s].addPath(e)}else n=s,t[s]=r}return t}(E,await(0,f.c)(s,E,v,n)),i=[],r=[];for(let n=0;n<R.length;n++){const s=R[n];if("cut"!==s)r.push(s);else{const s=e.shift(),c=t[n];(0,o.i)(c)&&"polygon"===c.type&&c.rings&&c.rings.length>1&&s.rings.length>=c.rings.length?(i.push(s),r.push("simplify")):r.push(T?(0,l.$)(s):s)}}if(!i.length)return r;const c=await(0,f.s)(s,i,n),a=[];for(let t=0;t<r.length;t++){const e=r[t];"simplify"!==e?a.push(e):a.push(T?(0,l.$)(c.shift()):c.shift())}return a}const x=[];for(let t=0;t<R.length;t++){const e=R[t];if("cut"!==e)x.push(e);else{const t=E.shift();x.push(!0===T?(0,l.$)(t):t)}}return x}}}]);