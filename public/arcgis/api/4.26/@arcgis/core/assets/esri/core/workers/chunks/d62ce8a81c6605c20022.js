"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[5126],{62610:(t,e,r)=>{r.d(e,{A:()=>o});class o{constructor(t,e,r=!1,o=e){this.data=t,this.size=e,this.exclusive=r,this.stride=o}}},34558:(t,e,r)=>{r.d(e,{F:()=>p});var o=r(88762),n=r(82058),s=r(71252),i=r(50406),a=r(9506),u=r(49900),l=r(56420);class p{constructor(t,e,r,o){this._parsedUrl=t,this._portalItem=e,this._apiKey=r,this.signal=o,this._rootDocument=null;const n=this._parsedUrl?.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);n&&(this._urlParts={root:n[1],layerId:parseInt(n[2],10)})}async fetch(){if(!this._urlParts)return null;const t=this._portalItem??await this._portalItemFromServiceItemId();if((0,s.a)(t))return this._loadFromUrl();const e=await this._findAndLoadRelatedPortalItem(t);return(0,s.a)(e)?null:this._loadFeatureLayerFromPortalItem(e)}async fetchPortalItem(){if(!this._urlParts)return null;const t=this._portalItem??await this._portalItemFromServiceItemId();return(0,s.a)(t)?null:this._findAndLoadRelatedPortalItem(t)}async _fetchRootDocument(){if((0,s.i)(this._rootDocument))return this._rootDocument;if((0,s.a)(this._urlParts))return this._rootDocument={},{};const t={query:{f:"json",token:this._apiKey},responseType:"json",signal:this.signal},e=`${this._urlParts.root}/SceneServer`;try{const r=await(0,n.default)(e,t);this._rootDocument=r.data}catch{this._rootDocument={}}return this._rootDocument}async _fetchServiceOwningPortalUrl(){const t=this._parsedUrl?.path,e=t?o.id?.findServerInfo(t):null;if(e?.owningSystemUrl)return e.owningSystemUrl;const r=t?t.replace(/(.*\/rest)\/.*/i,"$1")+"/info":null;try{const t=(await(0,n.default)(r,{query:{f:"json"},responseType:"json",signal:this.signal})).data.owningSystemUrl;if(t)return t}catch(t){(0,i.r9)(t)}return null}async _findAndLoadRelatedPortalItem(t){try{return(await t.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:this.signal})).find((t=>"Feature Service"===t.type))||null}catch(t){return(0,i.r9)(t),null}}async _loadFeatureLayerFromPortalItem(t){await t.load({signal:this.signal});const e=await this._findMatchingAssociatedSublayerUrl(t.url??"");return new a.default({url:e,portalItem:t}).load({signal:this.signal})}async _loadFromUrl(){const t=await this._findMatchingAssociatedSublayerUrl(`${this._urlParts?.root}/FeatureServer`);return new a.default({url:t}).load({signal:this.signal})}async _findMatchingAssociatedSublayerUrl(t){const e=t.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1"),r={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:this.signal},o=this._urlParts?.layerId,s=this._fetchRootDocument(),i=(0,n.default)(e,r),[a,u]=await Promise.all([i,s]),l=u&&u.layers,p=a.data&&a.data.layers;if(!Array.isArray(p))throw new Error("expected layers array");if(Array.isArray(l)){for(let t=0;t<Math.min(l.length,p.length);t++)if(l[t].id===o)return`${e}/${p[t].id}`}else if(null!=o&&o<p.length)return`${e}/${p[o].id}`;throw new Error("could not find matching associated sublayer")}async _portalItemFromServiceItemId(){const t=(await this._fetchRootDocument()).serviceItemId;if(!t)return null;const e=new l.default({id:t,apiKey:this._apiKey}),r=await this._fetchServiceOwningPortalUrl();(0,s.i)(r)&&(e.portal=new u.Z({url:r}));try{return e.load({signal:this.signal})}catch(t){return(0,i.r9)(t),null}}}},2298:(t,e,r)=>{r.d(e,{a:()=>_,c:()=>C,d:()=>c,r:()=>I});var o=r(60991),n=r(76506),s=r(92143),i=r(99520);const a=!0,u={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16};function l(t,e,r){return{identifier:String.fromCharCode.apply(null,new Uint8Array(t,r+u.identifierOffset,u.identifierLength)),version:e.getUint16(r+u.versionOffset,a),checksum:e.getUint32(r+u.checksumOffset,a)}}const p={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};function c(t){const e=new DataView(t,0);let r=0;const{identifier:n,version:s}=l(t,e,r);if(r+=u.byteCount,"LEPCC     "!==n)throw new o.Z("lepcc-decode-error","Bad identifier");if(s>1)throw new o.Z("lepcc-decode-error","Unknown version");const i=function(t,e){return{sizeLo:t.getUint32(e+p.sizeLo,a),sizeHi:t.getUint32(e+p.sizeHi,a),minX:t.getFloat64(e+p.minX,a),minY:t.getFloat64(e+p.minY,a),minZ:t.getFloat64(e+p.minZ,a),maxX:t.getFloat64(e+p.maxX,a),maxY:t.getFloat64(e+p.maxY,a),maxZ:t.getFloat64(e+p.maxZ,a),errorX:t.getFloat64(e+p.errorX,a),errorY:t.getFloat64(e+p.errorY,a),errorZ:t.getFloat64(e+p.errorZ,a),count:t.getUint32(e+p.count,a),reserved:t.getUint32(e+p.reserved,a)}}(e,r);if(r+=p.byteCount,i.sizeHi*2**32+i.sizeLo!==t.byteLength)throw new o.Z("lepcc-decode-error","Bad size");const c=new Float64Array(3*i.count),h=[],y=[],f=[],m=[];if(r=d(t,r,h),r=d(t,r,y),r=d(t,r,f),r=d(t,r,m),r!==t.byteLength)throw new o.Z("lepcc-decode-error","Bad length");let g=0,w=0;for(let t=0;t<h.length;t++){w+=h[t];let e=0;for(let r=0;r<y[t];r++){e+=f[g];const t=m[g];c[3*g]=Math.min(i.maxX,i.minX+2*i.errorX*e),c[3*g+1]=Math.min(i.maxY,i.minY+2*i.errorY*w),c[3*g+2]=Math.min(i.maxZ,i.minZ+2*i.errorZ*t),g++}}return{errorX:i.errorX,errorY:i.errorY,errorZ:i.errorZ,result:c}}function d(t,e,r){const o=[];e=h(t,e,o);const n=[];for(let s=0;s<o.length;s++){n.length=0,e=h(t,e,n);for(let t=0;t<n.length;t++)r.push(n[t]+o[s])}return e}function h(t,e,r){const n=new DataView(t,e),s=n.getUint8(0),i=31&s,u=!!(32&s),l=(192&s)>>6;let p=0;if(0===l)p=n.getUint32(1,a),e+=5;else if(1===l)p=n.getUint16(1,a),e+=3;else{if(2!==l)throw new o.Z("lepcc-decode-error","Bad count type");p=n.getUint8(1),e+=2}if(u)throw new o.Z("lepcc-decode-error","LUT not implemented");const c=Math.ceil(p*i/8),d=new Uint8Array(t,e,c);let h=0,y=0,f=0;const m=-1>>>32-i;for(let t=0;t<p;t++){for(;y<i;)h|=d[f]<<y,y+=8,f+=1;r[t]=h&m,h>>>=i,y-=i,y+i>32&&(h|=d[f-1]>>8-y)}return e+f}const y={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16},f={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16},m=s.L.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");function g(t,e,r){let n="",s=0;for(;s<r;){const i=t[e+s];if(i<128)n+=String.fromCharCode(i),s++;else if(i>=192&&i<224){if(s+1>=r)throw new o.Z("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");const a=(31&i)<<6|63&t[e+s+1];n+=String.fromCharCode(a),s+=2}else if(i>=224&&i<240){if(s+2>=r)throw new o.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const a=(15&i)<<12|(63&t[e+s+1])<<6|63&t[e+s+2];n+=String.fromCharCode(a),s+=3}else{if(!(i>=240&&i<248))throw new o.Z("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");{if(s+3>=r)throw new o.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const a=(7&i)<<18|(63&t[e+s+1])<<12|(63&t[e+s+2])<<6|63&t[e+s+3];if(a>=65536){const t=55296+(a-65536>>10),e=56320+(1023&a);n+=String.fromCharCode(t,e)}else n+=String.fromCharCode(a);s+=4}}}return n}function w(t,e){const r={byteOffset:0,byteCount:0,fields:Object.create(null)};let o=0;for(let n=0;n<e.length;n++){const s=e[n],i=s.valueType||s.type,a=A[i];r.fields[s.property]=a(t,o),o+=T[i].BYTES_PER_ELEMENT}return r.byteCount=o,r}function b(t,e,r){const n=[];let s,i,a=0;for(i=0;i<t;i+=1){if(s=e[i],s>0){if(n.push(g(r,a,s-1)),0!==r[a+s-1])throw new o.Z("string-array-error","Invalid string array: missing null termination.")}else n.push(null);a+=s}return n}function _(t,e){return new(0,T[e.valueType])(t,e.byteOffset,e.count*e.valuesPerElement)}function S(t,e,r){if(e!==t&&m.error(`Invalid ${r} buffer size\n expected: ${t}, actual: ${e})`),e<t)throw new o.Z("buffer-too-small","Binary buffer is too small",{expectedSize:t,actualSize:e})}function C(t,e){const r=w(t,e&&e.header);let o=r.byteCount;const n={isDraco:!1,header:r,byteOffset:r.byteCount,byteCount:0,vertexAttributes:{}},s=r.fields,i=null!=s.vertexCount?s.vertexCount:s.count;for(const t of e.ordering){if(!e.vertexAttributes[t])continue;const r={...e.vertexAttributes[t],byteOffset:o,count:i},s=v[t]||"_"+t;n.vertexAttributes[s]=r,o+=F(r.valueType)*r.valuesPerElement*i}const a=s.faceCount;if(e.faces&&a){n.faces={};for(const t of e.ordering){if(!e.faces[t])continue;const r={...e.faces[t],byteOffset:o,count:a};n.faces[t]=r,o+=F(r.valueType)*r.valuesPerElement*a}}const u=s.featureCount;if(e.featureAttributes&&e.featureAttributeOrder&&u){n.featureAttributes={};for(const t of e.featureAttributeOrder){if(!e.featureAttributes[t])continue;const r={...e.featureAttributes[t],byteOffset:o,count:u};n.featureAttributes[t]=r,o+=("UInt64"===r.valueType?8:F(r.valueType))*r.valuesPerElement*u}}return S(o,t.byteLength,"geometry"),n.byteCount=o-n.byteOffset,n}const v={position:i.V.POSITION,normal:i.V.NORMAL,color:i.V.COLOR,uv0:i.V.UV0,region:i.V.UVREGION};function I(t,e,r){if("lepcc-rgb"===t.encoding)return function(t){const e=new DataView(t,0);let r=0;const{identifier:n,version:s}=l(t,e,r);if(r+=u.byteCount,"ClusterRGB"!==n)throw new o.Z("lepcc-decode-error","Bad identifier");if(s>1)throw new o.Z("lepcc-decode-error","Unknown version");const i=function(t,e){return{sizeLo:t.getUint32(e+y.sizeLo,a),sizeHi:t.getUint32(e+y.sizeHi,a),count:t.getUint32(e+y.count,a),colorMapCount:t.getUint16(e+y.colorMapCount,a),lookupMethod:t.getUint8(e+y.lookupMethod),compressionMethod:t.getUint8(e+y.compressionMethod)}}(e,r);if(r+=y.byteCount,i.sizeHi*2**32+i.sizeLo!==t.byteLength)throw new o.Z("lepcc-decode-error","Bad size");if((2===i.lookupMethod||1===i.lookupMethod)&&0===i.compressionMethod){if(3*i.colorMapCount+i.count+r!==t.byteLength||i.colorMapCount>256)throw new o.Z("lepcc-decode-error","Bad count");const e=new Uint8Array(t,r,3*i.colorMapCount),n=new Uint8Array(t,r+3*i.colorMapCount,i.count),s=new Uint8Array(3*i.count);for(let t=0;t<i.count;t++){const r=n[t];s[3*t]=e[3*r],s[3*t+1]=e[3*r+1],s[3*t+2]=e[3*r+2]}return s}if(0===i.lookupMethod&&0===i.compressionMethod){if(3*i.count+r!==t.byteLength||0!==i.colorMapCount)throw new o.Z("lepcc-decode-error","Bad count");return new Uint8Array(t,r).slice()}if(i.lookupMethod<=2&&1===i.compressionMethod){if(r+3!==t.byteLength||1!==i.colorMapCount)throw new o.Z("lepcc-decode-error","Bad count");const n=e.getUint8(r),s=e.getUint8(r+1),a=e.getUint8(r+2),u=new Uint8Array(3*i.count);for(let t=0;t<i.count;t++)u[3*t]=n,u[3*t+1]=s,u[3*t+2]=a;return u}throw new o.Z("lepcc-decode-error","Bad method "+i.lookupMethod+","+i.compressionMethod)}(e);if("lepcc-intensity"===t.encoding)return function(t){const e=new DataView(t,0);let r=0;const{identifier:n,version:s}=l(t,e,r);if(r+=u.byteCount,"Intensity "!==n)throw new o.Z("lepcc-decode-error","Bad identifier");if(s>1)throw new o.Z("lepcc-decode-error","Unknown version");const i=function(t,e){return{sizeLo:t.getUint32(e+f.sizeLo,a),sizeHi:t.getUint32(e+f.sizeHi,a),count:t.getUint32(e+f.count,a),scaleFactor:t.getUint16(e+f.scaleFactor,a),bitsPerPoint:t.getUint8(e+f.bitsPerPoint),reserved:t.getUint8(e+f.reserved)}}(e,r);if(r+=f.byteCount,i.sizeHi*2**32+i.sizeLo!==t.byteLength)throw new o.Z("lepcc-decode-error","Bad size");const p=new Uint16Array(i.count);if(8===i.bitsPerPoint){if(i.count+r!==t.byteLength)throw new o.Z("lepcc-decode-error","Bad size");const e=new Uint8Array(t,r,i.count);for(let t=0;t<i.count;t++)p[t]=e[t]*i.scaleFactor}else if(16===i.bitsPerPoint){if(2*i.count+r!==t.byteLength)throw new o.Z("lepcc-decode-error","Bad size");const e=new Uint16Array(t,r,i.count);for(let t=0;t<i.count;t++)p[t]=e[t]*i.scaleFactor}else{const e=[];if(h(t,r,e)!==t.byteLength)throw new o.Z("lepcc-decode-error","Bad size");for(let t=0;t<i.count;t++)p[t]=e[t]*i.scaleFactor}return p}(e);if(null!=t.encoding&&""!==t.encoding)throw new o.Z("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");t["attributeByteCounts "]&&!t.attributeByteCounts&&(m.warn("Warning: Trailing space in 'attributeByteCounts '."),t.attributeByteCounts=t["attributeByteCounts "]),"ObjectIds"===t.ordering[0]&&t.hasOwnProperty("objectIds")&&(m.warn("Warning: Case error in objectIds"),t.ordering[0]="objectIds");const s=function(t,e,r){const s=null!=e.header?w(t,e.header):{byteOffset:0,byteCount:0,fields:{count:r}},i={header:s,byteOffset:s.byteCount,byteCount:0,entries:Object.create(null)};let a=s.byteCount;for(let t=0;t<e.ordering.length;t++){const r=e.ordering[t],u=(0,n.d9)(e[r]);if(u.count=s.fields.count??0,"String"===u.valueType){if(u.byteOffset=a,u.byteCount=s.fields[r+"ByteCount"],"UTF-8"!==u.encoding)throw new o.Z("unsupported-encoding","Unsupported String encoding.",{encoding:u.encoding});if(u.timeEncoding&&"ECMA_ISO8601"!==u.timeEncoding)throw new o.Z("unsupported-time-encoding","Unsupported time encoding.",{timeEncoding:u.timeEncoding})}else{if(!E(u.valueType))throw new o.Z("unsupported-value-type","Unsupported binary valueType",{valueType:u.valueType});{const t=F(u.valueType);a+=a%t!=0?t-a%t:0,u.byteOffset=a,u.byteCount=t*u.valuesPerElement*u.count}}a+=u.byteCount??0,i.entries[r]=u}return i.byteCount=a-i.byteOffset,i}(e,t,r);S(s.byteOffset+s.byteCount,e.byteLength,"attribute");const i=s.entries.attributeValues||s.entries.objectIds;if(i){if("String"===i.valueType){const t=s.entries.attributeByteCounts,r=_(e,t),o=function(t,e){return new Uint8Array(t,e.byteOffset,e.byteCount)}(e,i);return i.timeEncoding?function(t,e,r){return b(t,e,r).map((t=>{const e=t?Date.parse(t):null;return e&&!Number.isNaN(e)?e:null}))}(t.count,r,o):b(t.count,r,o)}return _(e,i)}throw new o.Z("bad-attribute-storage-info","Bad attributeStorageInfo specification.")}const T={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},A={Float32:(t,e)=>new DataView(t,0).getFloat32(e,!0),Float64:(t,e)=>new DataView(t,0).getFloat64(e,!0),UInt8:(t,e)=>new DataView(t,0).getUint8(e),Int8:(t,e)=>new DataView(t,0).getInt8(e),UInt16:(t,e)=>new DataView(t,0).getUint16(e,!0),Int16:(t,e)=>new DataView(t,0).getInt16(e,!0),UInt32:(t,e)=>new DataView(t,0).getUint32(e,!0),Int32:(t,e)=>new DataView(t,0).getInt32(e,!0)};function E(t){return T.hasOwnProperty(t)}function F(t){return E(t)?T[t].BYTES_PER_ELEMENT:0}},69003:(t,e,r)=>{r.d(e,{I:()=>u,a:()=>c,b:()=>h,c:()=>g});var o=r(29768),n=r(12047),s=r(34250),i=(r(91306),r(48578),r(59465)),a=r(17533);let u=class extends n.wq{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};(0,o._)([(0,s.Cb)({type:Number})],u.prototype,"nodesPerPage",void 0),(0,o._)([(0,s.Cb)({type:Number})],u.prototype,"rootIndex",void 0),(0,o._)([(0,s.Cb)({type:String})],u.prototype,"lodSelectionMetricType",void 0),u=(0,o._)([(0,a.j)("esri.layer.support.I3SNodePageDefinition")],u);let l=class extends n.wq{constructor(){super(...arguments),this.factor=1}};(0,o._)([(0,s.Cb)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],l.prototype,"id",void 0),(0,o._)([(0,s.Cb)({type:Number})],l.prototype,"factor",void 0),l=(0,o._)([(0,a.j)("esri.layer.support.I3SMaterialTexture")],l);let p=class extends n.wq{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};(0,o._)([(0,s.Cb)({type:[Number]})],p.prototype,"baseColorFactor",void 0),(0,o._)([(0,s.Cb)({type:l})],p.prototype,"baseColorTexture",void 0),(0,o._)([(0,s.Cb)({type:l})],p.prototype,"metallicRoughnessTexture",void 0),(0,o._)([(0,s.Cb)({type:Number})],p.prototype,"metallicFactor",void 0),(0,o._)([(0,s.Cb)({type:Number})],p.prototype,"roughnessFactor",void 0),p=(0,o._)([(0,a.j)("esri.layer.support.I3SMaterialPBRMetallicRoughness")],p);let c=class extends n.wq{constructor(){super(...arguments),this.alphaMode="opaque",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace="none",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};(0,o._)([(0,i.e)({opaque:"opaque",mask:"mask",blend:"blend"})],c.prototype,"alphaMode",void 0),(0,o._)([(0,s.Cb)({type:Number})],c.prototype,"alphaCutoff",void 0),(0,o._)([(0,s.Cb)({type:Boolean})],c.prototype,"doubleSided",void 0),(0,o._)([(0,i.e)({none:"none",back:"back",front:"front"})],c.prototype,"cullFace",void 0),(0,o._)([(0,s.Cb)({type:l})],c.prototype,"normalTexture",void 0),(0,o._)([(0,s.Cb)({type:l})],c.prototype,"occlusionTexture",void 0),(0,o._)([(0,s.Cb)({type:l})],c.prototype,"emissiveTexture",void 0),(0,o._)([(0,s.Cb)({type:[Number]})],c.prototype,"emissiveFactor",void 0),(0,o._)([(0,s.Cb)({type:p})],c.prototype,"pbrMetallicRoughness",void 0),c=(0,o._)([(0,a.j)("esri.layer.support.I3SMaterialDefinition")],c);let d=class extends n.wq{};(0,o._)([(0,s.Cb)({type:String,json:{read:{source:["name","index"],reader:(t,e)=>null!=t?t:`${e.index}`}}})],d.prototype,"name",void 0),(0,o._)([(0,i.e)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],d.prototype,"format",void 0),d=(0,o._)([(0,a.j)("esri.layer.support.I3STextureFormat")],d);let h=class extends n.wq{constructor(){super(...arguments),this.atlas=!1}};(0,o._)([(0,s.Cb)({type:[d]})],h.prototype,"formats",void 0),(0,o._)([(0,s.Cb)({type:Boolean})],h.prototype,"atlas",void 0),h=(0,o._)([(0,a.j)("esri.layer.support.I3STextureSetDefinition")],h);let y=class extends n.wq{};(0,o._)([(0,i.e)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],y.prototype,"type",void 0),(0,o._)([(0,s.Cb)({type:Number})],y.prototype,"component",void 0),y=(0,o._)([(0,a.j)("esri.layer.support.I3SGeometryAttribute")],y);let f=class extends n.wq{};(0,o._)([(0,i.e)({draco:"draco"})],f.prototype,"encoding",void 0),(0,o._)([(0,s.Cb)({type:[String]})],f.prototype,"attributes",void 0),f=(0,o._)([(0,a.j)("esri.layer.support.I3SGeometryCompressedAttributes")],f);let m=class extends n.wq{constructor(){super(...arguments),this.offset=0}};(0,o._)([(0,s.Cb)({type:Number})],m.prototype,"offset",void 0),(0,o._)([(0,s.Cb)({type:y})],m.prototype,"position",void 0),(0,o._)([(0,s.Cb)({type:y})],m.prototype,"normal",void 0),(0,o._)([(0,s.Cb)({type:y})],m.prototype,"uv0",void 0),(0,o._)([(0,s.Cb)({type:y})],m.prototype,"color",void 0),(0,o._)([(0,s.Cb)({type:y})],m.prototype,"uvRegion",void 0),(0,o._)([(0,s.Cb)({type:y})],m.prototype,"featureId",void 0),(0,o._)([(0,s.Cb)({type:y})],m.prototype,"faceRange",void 0),(0,o._)([(0,s.Cb)({type:f})],m.prototype,"compressedAttributes",void 0),m=(0,o._)([(0,a.j)("esri.layer.support.I3SGeometryBuffer")],m);let g=class extends n.wq{};(0,o._)([(0,i.e)({triangle:"triangle"})],g.prototype,"topology",void 0),(0,o._)([(0,s.Cb)()],g.prototype,"geometryBuffers",void 0),g=(0,o._)([(0,a.j)("esri.layer.support.I3SGeometryDefinition")],g)},63994:(t,e,r)=>{r.d(e,{q:()=>g});var o,n,s=r(82058),i=r(48578),a=(r(60991),r(50406)),u=(r(26923),r(16912)),l=(r(65775),r(57532)),p=(r(35861),r(99)),c=r(72836),d=(r(53785),r(1623),r(60947),r(57257),r(92482)),h=(r(31292),r(2298)),y=r(28904),f=(r(75854),r(35634)),m=r(62610);function g(t,e,r,o,n){const i=[];for(const o of e)if(o&&n.includes(o.name)){const e=`${t}/nodes/${r}/attributes/${o.key}/0`;i.push({url:e,storageInfo:o})}return(0,a.as)(i.map((t=>(0,s.default)(t.url,{responseType:"array-buffer"}).then((e=>(0,h.r)(t.storageInfo,e.data)))))).then((t=>{const e=[];for(const r of o){const o={};for(let e=0;e<t.length;e++){const n=t[e].value;null!=n&&(o[i[e].storageInfo.name]=_(n,r))}e.push(o)}return e}))}(0,d.c)(),(n=o||(o={}))[n.OUTSIDE=0]="OUTSIDE",n[n.INTERSECTS_CENTER_OUTSIDE=1]="INTERSECTS_CENTER_OUTSIDE",n[n.INTERSECTS_CENTER_INSIDE=2]="INTERSECTS_CENTER_INSIDE",n[n.INSIDE=3]="INSIDE";const w=-32768,b=-(2**31);function _(t,e){if(!t)return null;const r=t[e];return(0,i.c)(t)?r===w?null:r:(0,i.e)(t)?r===b?null:r:r!=r?null:r}(0,y.c)({color:[0,0,0,0],opacity:0});const S=new Array(24);new m.A(S,3,!0),(0,c.d)(),(0,c.d)(),(0,u.c)(),(0,l.c)(),(0,p.c)(),(0,d.c)(),(0,d.c)(),(0,f.c)(),(0,c.d)(),new Array(72),(0,l.c)()},99520:(t,e,r)=>{var o;r.d(e,{V:()=>o}),function(t){t.POSITION="position",t.NORMAL="normal",t.NORMALCOMPRESSED="normalCompressed",t.UV0="uv0",t.AUXPOS1="auxpos1",t.AUXPOS2="auxpos2",t.COLOR="color",t.SYMBOLCOLOR="symbolColor",t.SIZE="size",t.TANGENT="tangent",t.OFFSET="offset",t.SUBDIVISIONFACTOR="subdivisionFactor",t.COLORFEATUREATTRIBUTE="colorFeatureAttribute",t.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",t.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",t.DISTANCETOSTART="distanceToStart",t.UVMAPSPACE="uvMapSpace",t.BOUNDINGRECT="boundingRect",t.UVREGION="uvRegion",t.PROFILERIGHT="profileRight",t.PROFILEUP="profileUp",t.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",t.FEATUREVALUE="featureValue",t.MODELORIGINHI="modelOriginHi",t.MODELORIGINLO="modelOriginLo",t.MODEL="model",t.MODELNORMAL="modelNormal",t.INSTANCECOLOR="instanceColor",t.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",t.LOCALTRANSFORM="localTransform",t.GLOBALTRANSFORM="globalTransform",t.BOUNDINGSPHERE="boundingSphere",t.MODELORIGIN="modelOrigin",t.MODELSCALEFACTORS="modelScaleFactors",t.FEATUREATTRIBUTE="featureAttribute",t.STATE="state",t.LODLEVEL="lodLevel",t.POSITION0="position0",t.POSITION1="position1",t.NORMALA="normalA",t.NORMALB="normalB",t.COMPONENTINDEX="componentIndex",t.VARIANTOFFSET="variantOffset",t.VARIANTSTROKE="variantStroke",t.VARIANTEXTENSION="variantExtension",t.U8PADDING="u8padding",t.U16PADDING="u16padding",t.SIDENESS="sideness",t.START="start",t.END="end",t.UP="up",t.EXTRUDE="extrude",t.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",t.OBJECTANDLAYERIDCOLOR_INSTANCED="objectAndLayerIdColor_instanced"}(o||(o={}))},3808:(t,e,r)=>{var o;r.d(e,{V:()=>o}),function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"}(o||(o={}))},23771:(t,e,r)=>{r.d(e,{W:()=>c});var o=r(29768),n=r(21972),s=r(82933),i=r(71252),a=r(58085),u=r(6906),l=r(34250),p=r(17533);let c=class extends n.Z{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._handles=new s.Z,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll(),this._handles.destroy()}add(t,e,r={}){return this._installWatch(t,e,r,a.YP)}addWhen(t,e,r={}){return this._installWatch(t,e,r,a.gx)}addOnCollectionChange(t,e,{initial:r=!1,final:o=!1}={}){const n=++this._handleId;return this._handles.add([(0,a.on)(t,"after-changes",this._createSyncUpdatingCallback(),a.Z_),(0,a.on)(t,"change",e,{onListenerAdd:r?t=>e({added:t.toArray(),removed:[]}):void 0,onListenerRemove:o?t=>e({added:[],removed:t.toArray()}):void 0})],n),{remove:()=>this._handles.remove(n)}}addPromise(t){if((0,i.a)(t))return t;const e=++this._handleId;this._handles.add({remove:()=>{this._pendingPromises.delete(t)&&(0!==this._pendingPromises.size||this._handles.has(d)||this._set("updating",!1))}},e),this._pendingPromises.add(t),this._set("updating",!0);const r=()=>this._handles.remove(e);return t.then(r,r),t}removeAll(){this._pendingPromises.clear(),this._handles.removeAll(),this._set("updating",!1)}_installWatch(t,e,r={},o){const n=++this._handleId;r.sync||this._installSyncUpdatingWatch(t,n);const s=o(t,e,r);return this._handles.add(s,n),{remove:()=>this._handles.remove(n)}}_installSyncUpdatingWatch(t,e){const r=this._createSyncUpdatingCallback(),o=(0,a.YP)(t,r,{sync:!0,equals:()=>!1});return this._handles.add(o,e),o}_createSyncUpdatingCallback(){return()=>{this._handles.remove(d),++this._scheduleHandleId;const t=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this._handles.add((0,u.Os)((()=>{t===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this._handles.remove(d))})),d)}}};(0,o._)([(0,l.Cb)({readOnly:!0})],c.prototype,"updating",void 0),c=(0,o._)([(0,p.j)("esri.core.support.WatchUpdatingTracking")],c);const d=-42},79764:(t,e,r)=>{function o(t){return 32+t.length}function n(t){if(!t)return 0;let e=u;for(const r in t)if(t.hasOwnProperty(r)){const n=t[r];switch(typeof n){case"string":e+=o(n);break;case"number":e+=16;break;case"boolean":e+=4}}return e}function s(t){if(!t)return 0;if(Array.isArray(t))return function(t){const e=t.length;if(0===e||"number"==typeof t[0])return 32+8*e;let r=l;for(let o=0;o<e;o++)r+=i(t[o]);return r}(t);let e=u;for(const r in t)t.hasOwnProperty(r)&&(e+=i(t[r]));return e}function i(t){switch(typeof t){case"object":return s(t);case"string":return o(t);case"number":return 16;case"boolean":return 4;default:return 8}}function a(t,e){return l+t.length*e}r.d(e,{B:()=>p,a:()=>s,b:()=>a,e:()=>n});const u=32,l=32;var p;!function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"}(p||(p={}))},45272:(t,e,r)=>{r.d(e,{z:()=>o});const o={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsResize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}},6941:(t,e,r)=>{r.d(e,{a:()=>s,b:()=>i,c:()=>a,d:()=>n,e:()=>u,f:()=>l,g:()=>p});const o=[252,146,31,255],n={type:"esriSMS",style:"esriSMSCircle",size:6,color:o,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},s={type:"esriSLS",style:"esriSLSSolid",width:.75,color:o},i={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},a={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},l={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},p={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},28904:(t,e,r)=>{r.d(e,{c:()=>i}),r(48027),r(48578);var o,n,s=r(68681);function i(t){return{...a,...t,type:"solid"}}(n=o||(o={}))[n.INVISIBLE=0]="INVISIBLE",n[n.TRANSPARENT=1]="TRANSPARENT",n[n.OPAQUE=2]="OPAQUE";const a={color:(0,s.f)(0,0,0,.2),size:1,extensionLength:0,opacity:1,objectTransparency:o.OPAQUE,hasSlicePlane:!1};(0,s.f)(0,0,0,.2),o.OPAQUE},26923:(t,e,r)=>{r.d(e,{b:()=>a,c:()=>u,f:()=>n,i:()=>c,m:()=>l,n:()=>p,s:()=>s,t:()=>i});var o=r(29794);function n(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function s(t,e,r,o,n,s,i,a,u,l){return t[0]=e,t[1]=r,t[2]=o,t[3]=n,t[4]=s,t[5]=i,t[6]=a,t[7]=u,t[8]=l,t}function i(t,e){if(t===e){const r=e[1],o=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=o,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function a(t,e){const r=e[0],o=e[1],n=e[2],s=e[3],i=e[4],a=e[5],u=e[6],l=e[7],p=e[8],c=p*i-a*l,d=-p*s+a*u,h=l*s-i*u;let y=r*c+o*d+n*h;return y?(y=1/y,t[0]=c*y,t[1]=(-p*o+n*l)*y,t[2]=(a*o-n*i)*y,t[3]=d*y,t[4]=(p*r-n*u)*y,t[5]=(-a*r+n*s)*y,t[6]=h*y,t[7]=(-l*r+o*u)*y,t[8]=(i*r-o*s)*y,t):null}function u(t,e){const r=e[0],o=e[1],n=e[2],s=e[3],i=e[4],a=e[5],u=e[6],l=e[7],p=e[8];return t[0]=i*p-a*l,t[1]=n*l-o*p,t[2]=o*a-n*i,t[3]=a*u-s*p,t[4]=r*p-n*u,t[5]=n*s-r*a,t[6]=s*l-i*u,t[7]=o*u-r*l,t[8]=r*i-o*s,t}function l(t,e,r){const o=e[0],n=e[1],s=e[2],i=e[3],a=e[4],u=e[5],l=e[6],p=e[7],c=e[8],d=r[0],h=r[1],y=r[2],f=r[3],m=r[4],g=r[5],w=r[6],b=r[7],_=r[8];return t[0]=d*o+h*i+y*l,t[1]=d*n+h*a+y*p,t[2]=d*s+h*u+y*c,t[3]=f*o+m*i+g*l,t[4]=f*n+m*a+g*p,t[5]=f*s+m*u+g*c,t[6]=w*o+b*i+_*l,t[7]=w*n+b*a+_*p,t[8]=w*s+b*u+_*c,t}function p(t,e){const r=e[0],o=e[1],n=e[2],s=e[3],i=e[4],a=e[5],u=e[6],l=e[7],p=e[8],c=e[9],d=e[10],h=e[11],y=e[12],f=e[13],m=e[14],g=e[15],w=r*a-o*i,b=r*u-n*i,_=r*l-s*i,S=o*u-n*a,C=o*l-s*a,v=n*l-s*u,I=p*f-c*y,T=p*m-d*y,A=p*g-h*y,E=c*m-d*f,F=c*g-h*f,R=d*g-h*m;let O=w*R-b*F+_*E+S*A-C*T+v*I;return O?(O=1/O,t[0]=(a*R-u*F+l*E)*O,t[1]=(u*A-i*R-l*T)*O,t[2]=(i*F-a*A+l*I)*O,t[3]=(n*F-o*R-s*E)*O,t[4]=(r*R-n*A+s*T)*O,t[5]=(o*A-r*F-s*I)*O,t[6]=(f*v-m*C+g*S)*O,t[7]=(m*_-y*v-g*b)*O,t[8]=(y*C-f*_+g*w)*O,t):null}function c(t){const e=(0,o.g)(),r=t[0],n=t[1],s=t[2],i=t[3],a=t[4],u=t[5],l=t[6],p=t[7],c=t[8];return Math.abs(1-(r*r+i*i+l*l))<=e&&Math.abs(1-(n*n+a*a+p*p))<=e&&Math.abs(1-(s*s+u*u+c*c))<=e}},16912:(t,e,r)=>{function o(){return[1,0,0,0,1,0,0,0,1]}function n(t,e,r,o,n,s,i,a,u){return[t,e,r,o,n,s,i,a,u]}function s(t,e){return new Float64Array(t,e,9)}r.d(e,{a:()=>s,c:()=>o,f:()=>n})},57532:(t,e,r)=>{function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function n(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function s(t,e){return new Float64Array(t,e,16)}r.d(e,{I:()=>i,a:()=>s,b:()=>n,c:()=>o});const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},99045:(t,e,r)=>{r(82426);var o=r(72836);(0,o.d)(),(0,o.d)(),(0,o.d)(),(0,o.d)(),(0,o.d)()},35634:(t,e,r)=>{r.d(e,{c:()=>u}),r(26923);var o=r(16912),n=(r(35861),r(99)),s=r(45087),i=r(72836),a=r(56697);function u(t=[0,0,0],e=[-1,-1,-1],r=(0,s.c)()){return{center:(0,i.k)(t),halfSize:(0,a.c)(e),quaternion:(0,n.a)(r)}}r(53326),r(55633),r(3808),(0,s.c)(),(0,i.d)(),(0,i.d)(),(0,o.c)(),(()=>{const t=new Int8Array(162);let e=0;const r=r=>{for(let o=0;o<r.length;o++)t[e+o]=r[o];e+=6};r([6,2,3,1,5,4]),r([0,2,3,1,5,4]),r([0,2,3,7,5,4]),r([0,1,3,2,6,4]),r([0,1,3,2,0,0]),r([0,1,5,7,3,2]),r([0,1,3,7,6,4]),r([0,1,3,7,6,2]),r([0,1,5,7,6,2]),r([0,1,5,4,6,2]),r([0,1,5,4,0,0]),r([0,1,3,7,5,4]),r([0,2,6,4,0,0]),r([0,0,0,0,0,0]),r([1,3,7,5,0,0]),r([2,3,7,6,4,0]),r([2,3,7,6,0,0]),r([2,3,1,5,7,6]),r([0,1,5,7,6,2]),r([0,1,5,7,6,4]),r([0,1,3,7,6,4]),r([4,5,7,6,2,0]),r([4,5,7,6,0,0]),r([4,5,1,3,7,6]),r([0,2,3,7,5,4]),r([6,2,3,7,5,4]),r([6,2,3,1,5,4])})(),(0,i.d)(),(0,i.d)(),(0,i.d)(),(0,s.c)()},55633:(t,e,r)=>{r(82426);var o,n,s=r(72836);r(48578),r(92143),r(40961),r(2420),r(99045),(0,s.d)(),(0,s.d)(),(0,s.d)(),(0,s.d)(),(0,s.d)(),(n=o||(o={}))[n.NONE=0]="NONE",n[n.CLAMP=1]="CLAMP",n[n.INFINITE_MIN=4]="INFINITE_MIN",n[n.INFINITE_MAX=8]="INFINITE_MAX",o.INFINITE_MIN,o.INFINITE_MAX,o.INFINITE_MAX},37025:(t,e,r)=>{r.d(e,{a:()=>i,g:()=>s});var o=r(71252),n=r(14249);async function s(t,e=t.popupTemplate){if((0,o.a)(e))return[];const r=await e.getRequiredFields(t.fieldsIndex),{lastEditInfoEnabled:s}=e,{objectIdField:i,typeIdField:a,globalIdField:u,relationships:l}=t;if(r.includes("*"))return["*"];const p=s?await(0,n.CH)(t):[],c=(0,n.Q0)(t.fieldsIndex,[...r,...p]);return a&&c.push(a),c&&i&&t.fieldsIndex?.has(i)&&!c.includes(i)&&c.push(i),c&&u&&t.fieldsIndex?.has(u)&&!c.includes(u)&&c.push(u),l&&l.forEach((e=>{const{keyField:r}=e;c&&r&&t.fieldsIndex?.has(r)&&!c.includes(r)&&c.push(r)})),c}function i(t,e){return t.popupTemplate?t.popupTemplate:(0,o.i)(e)&&e.defaultPopupTemplateEnabled&&(0,o.i)(t.defaultPopupTemplate)?t.defaultPopupTemplate:null}},35861:(t,e,r)=>{r.d(e,{a:()=>u,e:()=>p,f:()=>l,g:()=>i,m:()=>a,s:()=>s});var o=r(72836),n=r(29794);function s(t,e,r){r*=.5;const o=Math.sin(r);return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=Math.cos(r),t}function i(t,e){const r=2*Math.acos(e[3]),o=Math.sin(r/2);return o>(0,n.g)()?(t[0]=e[0]/o,t[1]=e[1]/o,t[2]=e[2]/o):(t[0]=1,t[1]=0,t[2]=0),r}function a(t,e,r){const o=e[0],n=e[1],s=e[2],i=e[3],a=r[0],u=r[1],l=r[2],p=r[3];return t[0]=o*p+i*a+n*l-s*u,t[1]=n*p+i*u+s*a-o*l,t[2]=s*p+i*l+o*u-n*a,t[3]=i*p-o*a-n*u-s*l,t}function u(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function l(t,e,r,o){const n=.5*Math.PI/180;e*=n,r*=n,o*=n;const s=Math.sin(e),i=Math.cos(e),a=Math.sin(r),u=Math.cos(r),l=Math.sin(o),p=Math.cos(o);return t[0]=s*u*p-i*a*l,t[1]=i*a*p+s*u*l,t[2]=i*u*l-s*a*p,t[3]=i*u*p+s*a*l,t}const p=r(7200).e;(0,o.d)(),(0,o.f)(1,0,0),(0,o.f)(0,1,0)},99:(t,e,r)=>{function o(){const t=new Float32Array(4);return t[3]=1,t}function n(t){const e=new Float32Array(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}r.d(e,{a:()=>n,c:()=>o})},45087:(t,e,r)=>{function o(){return[0,0,0,1]}function n(t){return[t[0],t[1],t[2],t[3]]}function s(t,e){return new Float64Array(t,e,4)}r.d(e,{I:()=>i,a:()=>s,b:()=>n,c:()=>o});const i=[0,0,0,1]},55823:(t,e,r)=>{r.d(e,{a:()=>s});var o=r(71252),n=r(92847);function s(t,e,r){if(!r||!r.features||!r.hasZ)return;const s=(0,n.g)(r.geometryType,e,t.outSpatialReference);if(!(0,o.a)(s))for(const t of r.features)s(t.geometry)}},2420:(t,e,r)=>{r.d(e,{O:()=>c,c:()=>g,d:()=>m,e:()=>_,s:()=>f,w:()=>b}),r(48578);var o=r(30773),n=r(72836),s=r(79764),i=r(16912),a=r(57532),u=r(45087),l=r(32191),p=r(68681);class c{constructor(t){this._allocator=t,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,o.n)((()=>this._reset())),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const t=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*d);this._items.length=Math.min(t,this._items.length),this._itemsPtr=0}_grow(){for(let t=0;t<Math.max(8,Math.min(this._items.length,d));t++)this._items.push(this._allocator())}}const d=1024;class h{constructor(t,e,r){this._itemByteSize=t,this._itemCreate=e,this._buffers=new Array,this._items=new Array,this._itemsPtr=0,this._itemsPerBuffer=Math.ceil(r/this._itemByteSize)}get(){0===this._itemsPtr&&(0,o.n)((()=>this._reset()));const t=Math.floor(this._itemsPtr/this._itemsPerBuffer);for(;this._buffers.length<=t;){const t=new ArrayBuffer(this._itemsPerBuffer*this._itemByteSize);for(let e=0;e<this._itemsPerBuffer;++e)this._items.push(this._itemCreate(t,e*this._itemByteSize));this._buffers.push(t)}return this._items[this._itemsPtr++]}_reset(){const t=2*(Math.floor(this._itemsPtr/this._itemsPerBuffer)+1);for(;this._buffers.length>t;)this._buffers.pop(),this._items.length=this._buffers.length*this._itemsPerBuffer;this._itemsPtr=0}static createVec2f64(t=y){return new h(16,l.c,t)}static createVec3f64(t=y){return new h(24,n.r,t)}static createVec4f64(t=y){return new h(32,p.b,t)}static createMat3f64(t=y){return new h(72,i.a,t)}static createMat4f64(t=y){return new h(128,a.a,t)}static createQuatf64(t=y){return new h(32,u.a,t)}get test(){return{size:this._buffers.length*this._itemsPerBuffer*this._itemByteSize}}}const y=4*s.B.KILOBYTES,f=(h.createVec2f64(),h.createVec3f64());h.createVec4f64(),h.createMat3f64();const m=h.createMat4f64();function g(t){return t?w((0,n.k)(t.origin),(0,n.k)(t.direction)):w((0,n.d)(),(0,n.d)())}function w(t,e){return{origin:t,direction:e}}function b(t,e){const r=S.get();return r.origin=t,r.direction=e,r}function _(t,e,r){const o=(0,n.m)(t.direction,(0,n.b)(r,e,t.origin));return(0,n.a)(r,t.origin,(0,n.g)(r,t.direction,o)),r}h.createQuatf64();const S=new c((()=>g()))},62748:(t,e,r)=>{r.d(e,{g:()=>c});var o=r(48578),n=r(71252),s=r(21132);const i={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function a(t,e,r){return!!(t&&t.hasOwnProperty(e)?t[e]:r)}function u(t,e,r){return t&&t.hasOwnProperty(e)?t[e]:r}function l(t){const e=t?.supportedSpatialAggregationStatistics?.map((t=>t.toLowerCase()));return{envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function p(t,e){const r=t?.supportedOperationsWithCacheHint?.map((t=>t.toLowerCase()));return!!r?.includes(e.toLowerCase())}function c(t,e){return{analytics:d(t),attachment:h(t),data:y(t),metadata:f(t),operations:m(t.capabilities,t,e),query:g(t,e),queryRelated:w(t),queryTopFeatures:b(t),editing:_(t)}}function d(t){return{supportsCacheHint:p(t.advancedQueryCapabilities,"queryAnalytics")}}function h(t){const e=t.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:p(t.advancedQueryCapabilities,"queryAttachments"),supportsResize:a(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach((t=>{const e=i[t.name];e&&(r[e]=!!t.isEnabled)})),r}function y(t){return{isVersioned:a(t,"isDataVersioned",!1),supportsAttachment:a(t,"hasAttachments",!1),supportsM:a(t,"hasM",!1),supportsZ:a(t,"hasZ",!1)}}function f(t){return{supportsAdvancedFieldProperties:a(t,"supportsFieldDescriptionProperty",!1)}}function m(t,e,r){const o=t?t.toLowerCase().split(",").map((t=>t.trim())):[],i=r?(0,s.p)(r):null,u=o.includes((0,n.i)(i)&&"MapServer"===i.serverType?"data":"query"),l=o.includes("editing")&&!e.datesInUnknownTimezone;let p=l&&o.includes("create"),c=l&&o.includes("delete"),d=l&&o.includes("update");const h=o.includes("changetracking"),y=e.advancedQueryCapabilities;return l&&!(p||c||d)&&(p=c=d=!0),{supportsCalculate:a(e,"supportsCalculate",!1),supportsTruncate:a(e,"supportsTruncate",!1),supportsValidateSql:a(e,"supportsValidateSql",!1),supportsAdd:p,supportsDelete:c,supportsEditing:l,supportsChangeTracking:h,supportsQuery:u,supportsQueryAnalytics:a(y,"supportsQueryAnalytic",!1),supportsQueryAttachments:a(y,"supportsQueryAttachments",!1),supportsQueryTopFeatures:a(y,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:a(e,"supportsAttachmentsResizing",!1),supportsSync:o.includes("sync"),supportsUpdate:d,supportsExceedsLimitStatistics:a(e,"supportsExceedsLimitStatistics",!1)}}function g(t,e){const r=t.advancedQueryCapabilities,n=t.ownershipBasedAccessControlForFeatures,i=t.archivingInfo,c=t.currentVersion,d=e?.includes("MapServer"),h=!d||c>=(0,o.h)("mapserver-pbf-version-support"),y=(0,s.i)(e),f=new Set((t.supportedQueryFormats??"").split(",").map((t=>t.toLowerCase().trim())));return{supportsStatistics:a(r,"supportsStatistics",t.supportsStatistics),supportsPercentileStatistics:a(r,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:a(r,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:l(r),supportsCentroid:a(r,"supportsReturningGeometryCentroid",!1),supportsDistance:a(r,"supportsQueryWithDistance",!1),supportsDistinct:a(r,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:a(r,"supportsReturningQueryExtent",!1),supportsGeometryProperties:a(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:a(r,"supportsHavingClause",!1),supportsOrderBy:a(r,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:a(r,"supportsPagination",!1),supportsQuantization:a(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:a(t,"supportsQuantizationEditMode",!1),supportsQueryGeometry:a(t,"supportsReturningQueryGeometry",!1),supportsResultType:a(r,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:a(r,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:a(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:a(t,"useStandardizedQueries",!1),supportsTopFeaturesQuery:a(r,"supportsTopFeaturesQuery",!1),supportsQueryByOthers:a(n,"allowOthersToQuery",!0),supportsHistoricMoment:a(i,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:h&&f.has("pbf"),supportsDisjointSpatialRelationship:a(r,"supportsDisjointSpatialRel",!1),supportsCacheHint:a(r,"supportsQueryWithCacheHint",!1)||p(r,"query"),supportsDefaultSpatialReference:a(r,"supportsDefaultSR",!1),supportsCompactGeometry:y,supportsFullTextSearch:a(r,"supportsFullTextSearch",!1),maxRecordCountFactor:u(t,"maxRecordCountFactor",void 0),maxRecordCount:u(t,"maxRecordCount",void 0),standardMaxRecordCount:u(t,"standardMaxRecordCount",void 0),tileMaxRecordCount:u(t,"tileMaxRecordCount",void 0)}}function w(t){const e=t.advancedQueryCapabilities,r=a(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:a(e,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:p(e,"queryRelated")}}function b(t){return{supportsCacheHint:p(t.advancedQueryCapabilities,"queryTopFilter")}}function _(t){const e=t.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:a(t,"allowGeometryUpdates",!0),supportsGlobalId:a(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:a(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:a(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:a(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:a(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:a(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:a(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:a(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:a(e,"allowOthersToUpdate",!0)}}},52228:(t,e,r)=>{var o,n;function s(t){return t&&"esri.renderers.visualVariables.SizeVariable"===t.declaredClass}function i(t){return null!=t&&!isNaN(t)&&isFinite(t)}function a(t){return t.valueExpression?o.Expression:t.field&&"string"==typeof t.field?o.Field:o.Unknown}function u(t,e){const r=e||a(t),s=t.valueUnit||"unknown";return r===o.Unknown?n.Constant:t.stops?n.Stops:null!=t.minSize&&null!=t.maxSize&&null!=t.minDataValue&&null!=t.maxDataValue?n.ClampedLinear:"unknown"===s?null!=t.minSize&&null!=t.minDataValue?t.minSize&&t.minDataValue?n.Proportional:n.Additive:n.Identity:n.RealWorldSize}r.d(e,{I:()=>o,T:()=>n,a:()=>u,b:()=>i,g:()=>a,i:()=>s}),function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"}(o||(o={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(n||(n={}))},57257:(t,e,r)=>{r.d(e,{g:()=>u});var o=r(53785),n=r(60947);const s=new n.Z(o.S),i=new n.Z(o.r),a=new n.Z(o.s);function u(t){return t&&((0,o.t)(t)||(0,o.f)(t,i))?i:t&&((0,o.v)(t)||(0,o.f)(t,a))?a:s}new n.Z(o.p)},75854:(t,e,r)=>{var o,n;r.d(e,{C:()=>o}),r(82426),(n=o||(o={}))[n.Multiply=1]="Multiply",n[n.Ignore=2]="Ignore",n[n.Replace=3]="Replace",n[n.Tint=4]="Tint"},32191:(t,e,r)=>{function o(){return[0,0]}function n(t,e){return[t,e]}function s(t,e){return new Float64Array(t,e,2)}r.d(e,{a:()=>o,c:()=>s,f:()=>n}),n(1,1),n(1,0)},56697:(t,e,r)=>{function o(){return new Float32Array(3)}function n(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(t,e,r){const o=new Float32Array(3);return o[0]=t,o[1]=e,o[2]=r,o}r.d(e,{b:()=>o,c:()=>n,f:()=>s}),s(1,1,1),s(1,0,0),s(0,1,0),s(0,0,1)},40961:(t,e,r)=>{r.d(e,{A:()=>o,a:()=>a});var o,n,s=r(82426),i=r(72836);function a(t,e){const r=(0,i.m)(t,e)/((0,i.l)(t)*(0,i.l)(e));return-(0,s.b)(r)}(n=o||(o={}))[n.X=0]="X",n[n.Y=1]="Y",n[n.Z=2]="Z",(0,i.d)(),(0,i.d)()},95873:(t,e,r)=>{r.d(e,{p:()=>l,r:()=>p});var o=r(29768),n=r(21972),s=r(82933),i=r(34250),a=r(17533),u=r(23771);r(60474),r(66396),r(76506),r(48578),r(86656),r(92143),r(31450),r(71552),r(40642),r(91055),r(6540),r(19657),r(6906),r(50406),r(60991),r(91306),r(58085);const l=t=>{let e=class extends t{constructor(){super(...arguments),this._handles=new s.Z,this._updatingHandles=new u.W}destroy(){this.destroyed||(this._handles.destroy(),this._updatingHandles.destroy())}get handles(){return this._handles}get updatingHandles(){return this._updatingHandles}};return(0,o._)([(0,i.Cb)({readOnly:!0})],e.prototype,"handles",null),(0,o._)([(0,i.Cb)({readOnly:!0})],e.prototype,"updatingHandles",null),e=(0,o._)([(0,a.j)("esri.core.HandleOwner")],e),e};let p=class extends(l(n.Z)){};p=(0,o._)([(0,a.j)("esri.core.HandleOwner")],p)},52991:(t,e,r)=>{r.d(e,{E:()=>n,_:()=>s});var o=r(71252);async function n(t,e){const{WhereClause:o}=await r.e(2274).then(r.bind(r,72274)).then((t=>t.W));return o.create(t,e)}function s(t,e){return(0,o.i)(t)?(0,o.i)(e)?`(${t}) AND (${e})`:t:e}},46495:(t,e,r)=>{r.d(e,{Z:()=>c});var o=r(29768),n=r(66122),s=r(57251),i=r(12047),a=r(34250),u=(r(91306),r(48578),r(17533));r(21972),r(60474),r(66396),r(76506),r(86656),r(92143),r(31450),r(71552),r(40642),r(91055),r(6540),r(19657),r(6906),r(50406),r(60991);const l=new s.J({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let p=class extends((0,n.J)(i.wq)){constructor(t){super(t),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};(0,o._)([(0,a.Cb)({json:{write:!0}})],p.prototype,"name",void 0),(0,o._)([(0,a.Cb)({json:{write:!0}})],p.prototype,"description",void 0),(0,o._)([(0,a.Cb)({json:{read:l.read,write:l.write}})],p.prototype,"drawingTool",void 0),(0,o._)([(0,a.Cb)({json:{write:!0}})],p.prototype,"prototype",void 0),(0,o._)([(0,a.Cb)({json:{write:!0}})],p.prototype,"thumbnail",void 0),p=(0,o._)([(0,u.j)("esri.layers.support.FeatureTemplate")],p);const c=p},78303:(t,e,r)=>{r.d(e,{Z:()=>h});var o=r(29768),n=r(66122),s=r(12047),i=r(34250),a=(r(91306),r(48578),r(97714)),u=r(17533),l=r(2906),p=r(9801),c=r(46495);r(21972),r(60474),r(66396),r(76506),r(86656),r(92143),r(31450),r(71552),r(40642),r(91055),r(6540),r(19657),r(6906),r(50406),r(60991),r(53523),r(59465),r(57251),r(42911),r(46826),r(45433);let d=class extends((0,n.J)(s.wq)){constructor(t){super(t),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(t){const e={};for(const r of Object.keys(t))e[r]=(0,p.f)(t[r]);return e}writeDomains(t,e){const r={};for(const e of Object.keys(t))t[e]&&(r[e]=t[e]?.toJSON());e.domains=r}};(0,o._)([(0,i.Cb)({json:{write:!0}})],d.prototype,"id",void 0),(0,o._)([(0,i.Cb)({json:{write:!0}})],d.prototype,"name",void 0),(0,o._)([(0,i.Cb)({json:{write:!0}})],d.prototype,"domains",void 0),(0,o._)([(0,a.r)("domains")],d.prototype,"readDomains",null),(0,o._)([(0,l.w)("domains")],d.prototype,"writeDomains",null),(0,o._)([(0,i.Cb)({type:[c.Z],json:{write:!0}})],d.prototype,"templates",void 0),d=(0,o._)([(0,u.j)("esri.layers.support.FeatureType")],d);const h=d},2180:(t,e,r)=>{r.d(e,{Z:()=>p});var o,n=r(29768),s=r(15324),i=r(12047),a=r(34250),u=(r(91306),r(48578),r(17533));r(91055),r(75067),r(21972),r(60474),r(66396),r(76506),r(86656),r(92143),r(31450),r(71552),r(40642),r(6540),r(19657),r(6906),r(50406),r(60991),r(89914);let l=o=class extends i.wq{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new s.Z}clone(){return new o({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};(0,n._)([(0,a.Cb)({type:String,json:{write:!0}})],l.prototype,"floorField",void 0),(0,n._)([(0,a.Cb)({json:{read:!1,write:!1}})],l.prototype,"viewAllMode",void 0),(0,n._)([(0,a.Cb)({json:{read:!1,write:!1}})],l.prototype,"viewAllLevelIds",void 0),l=o=(0,n._)([(0,u.j)("esri.layers.support.LayerFloorInfo")],l);const p=l},34446:(t,e,r)=>{r.d(e,{Z:()=>d});var o,n=r(29768),s=r(12047),i=r(76506),a=r(34250),u=r(91306),l=r(17533),p=r(2906);r(21972),r(60474),r(66396),r(86656),r(48578),r(92143),r(31450),r(71552),r(40642),r(91055),r(6540),r(19657),r(6906),r(50406),r(60991);let c=o=class extends s.wq{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new o((0,i.d9)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};(0,n._)([(0,a.Cb)({type:[String],json:{write:!0}})],c.prototype,"attachmentTypes",void 0),(0,n._)([(0,a.Cb)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],c.prototype,"attachmentsWhere",void 0),(0,n._)([(0,a.Cb)({type:Boolean,json:{write:!0}})],c.prototype,"cacheHint",void 0),(0,n._)([(0,a.Cb)({type:[String],json:{write:!0}})],c.prototype,"keywords",void 0),(0,n._)([(0,a.Cb)({type:[Number],json:{write:!0}})],c.prototype,"globalIds",void 0),(0,n._)([(0,a.Cb)({json:{write:!0}})],c.prototype,"name",void 0),(0,n._)([(0,a.Cb)({type:Number,json:{read:{source:"resultRecordCount"}}})],c.prototype,"num",void 0),(0,n._)([(0,a.Cb)({type:[Number],json:{write:!0}})],c.prototype,"objectIds",void 0),(0,n._)([(0,a.Cb)({type:Boolean,json:{default:!1,write:!0}})],c.prototype,"returnMetadata",void 0),(0,n._)([(0,a.Cb)({type:[Number],json:{write:!0}})],c.prototype,"size",void 0),(0,n._)([(0,a.Cb)({type:Number,json:{read:{source:"resultOffset"}}})],c.prototype,"start",void 0),(0,n._)([(0,p.w)("start"),(0,p.w)("num")],c.prototype,"writeStart",null),(0,n._)([(0,a.Cb)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],c.prototype,"where",void 0),c=o=(0,n._)([(0,l.j)("esri.rest.support.AttachmentQuery")],c),c.from=(0,u.e)(c);const d=c},87258:(t,e,r)=>{r.d(e,{Z:()=>_});var o,n=r(29768),s=r(74569),i=r(23761),a=r(57251),u=r(12047),l=r(76506),p=r(71252),c=r(34250),d=(r(91306),r(97714)),h=r(17533),y=r(2906),f=r(60947),m=r(32422),g=r(97546);r(21801),r(40642),r(71552),r(48578),r(73796),r(91597),r(92143),r(31450),r(86787),r(86656),r(66396),r(53785),r(89623),r(35132),r(84069),r(44567),r(98380),r(92482),r(82426),r(72836),r(29794),r(7200),r(92896),r(22781),r(86748),r(66122),r(21972),r(60474),r(91055),r(6540),r(19657),r(6906),r(50406),r(60991),r(15324),r(75067),r(89914),r(14249),r(60217),r(29107),r(30574),r(2157),r(25977),r(58076),r(98242),r(7471),r(54414),r(59465),r(1648),r(8925),r(33921),r(3482),r(45154),r(16769),r(93603),r(15438),r(593),r(85699),r(55531),r(96055),r(47776),r(18033),r(6331),r(62048),r(56890),r(30493),r(4292),r(75626),r(72652),r(29641),r(70821),r(3296),r(34229),r(37029),r(96467),r(63571),r(30776),r(48027),r(54174),r(63130),r(25696),r(98402),r(42775),r(95834),r(34394),r(57150),r(76726),r(20444),r(76393),r(78548),r(2497),r(49906),r(46527),r(11799),r(48649),r(59877),r(9960),r(30823),r(53326),r(5853),r(39141),r(32101),r(38742),r(52461),r(48243),r(34635),r(10401),r(49900),r(88762),r(82058),r(81184),r(33101),r(67477),r(78533),r(74653),r(91091),r(58943),r(70737),r(36834),r(8487),r(17817),r(90814),r(15459),r(97189),r(61847),r(28212),r(16955),r(22401),r(48699),r(77894),r(55187),r(8586),r(44509),r(69814),r(11305),r(62259),r(44790),r(5909),r(60669),r(48208),r(51589),r(9801),r(53523),r(42911),r(46826),r(45433),r(54732);const w=new a.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let b=o=class extends u.wq{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){const r=f.Z.fromJSON(e.spatialReference),o=[];for(let e=0;e<t.length;e++){const n=t[e],s=i.Z.fromJSON(n),a=n.geometry&&n.geometry.spatialReference;(0,p.i)(s.geometry)&&!a&&(s.geometry.spatialReference=r);const u=n.aggregateGeometries,l=s.aggregateGeometries;if(u&&(0,p.i)(l))for(const t in l){const e=l[t],o=u[t],n=o?.spatialReference;(0,p.i)(e)&&!n&&(e.spatialReference=r)}o.push(s)}return o}writeGeometryType(t,e,r,o){if(t)return void w.write(t,e,r,o);const{features:n}=this;if(n)for(const t of n)if(t&&(0,p.i)(t.geometry))return void w.write(t.geometry.type,e,r,o)}readQueryGeometry(t,e){if(!t)return null;const r=!!t.spatialReference,o=(0,m.im)(t);return o&&!r&&e.spatialReference&&(o.spatialReference=f.Z.fromJSON(e.spatialReference)),o}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:r}=this;if(r)for(const t of r)if(t&&(0,p.i)(t.geometry)&&t.geometry.spatialReference)return void(e.spatialReference=t.geometry.spatialReference.toJSON())}clone(){return new o(this.cloneProperties())}cloneProperties(){return(0,l.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let r=0;r<e.features.length;r++){const o=e.features[r];if(o.geometry){const e=t&&t[r];o.geometry=e&&e.toJSON()||o.geometry}}return e}quantize(t){const{scale:[e,r],translate:[o,n]}=t,s=this.features,i=this._getQuantizationFunction(this.geometryType,(t=>Math.round((t-o)/e)),(t=>Math.round((n-t)/r)));for(let t=0,e=s.length;t<e;t++)i?.((0,p.u)(s[t].geometry))||(s.splice(t,1),t--,e--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:r}=this;if(!r)return this;const{translate:[o,n],scale:[s,i]}=r,a=this._getHydrationFunction(t,(t=>t*s+o),(t=>n-t*i));for(const{geometry:t}of e)(0,p.i)(t)&&a&&a(t);return this.transform=null,this}_quantizePoints(t,e,r){let o,n;const s=[];for(let i=0,a=t.length;i<a;i++){const a=t[i];if(i>0){const t=e(a[0]),i=r(a[1]);t===o&&i===n||(s.push([t-o,i-n]),o=t,n=i)}else o=e(a[0]),n=r(a[1]),s.push([o,n])}return s.length>0?s:null}_getQuantizationFunction(t,e,r){return"point"===t?t=>(t.x=e(t.x),t.y=r(t.y),t):"polyline"===t||"polygon"===t?t=>{const o=(0,m.oU)(t)?t.rings:t.paths,n=[];for(let t=0,s=o.length;t<s;t++){const s=o[t],i=this._quantizePoints(s,e,r);i&&n.push(i)}return n.length>0?((0,m.oU)(t)?t.rings=n:t.paths=n,t):null}:"multipoint"===t?t=>{const o=this._quantizePoints(t.points,e,r);return o&&o.length>0?(t.points=o,t):null}:"extent"===t?t=>t:null}_getHydrationFunction(t,e,r){return"point"===t?t=>{t.x=e(t.x),t.y=r(t.y)}:"polyline"===t||"polygon"===t?t=>{const o=(0,m.oU)(t)?t.rings:t.paths;let n,s;for(let t=0,i=o.length;t<i;t++){const i=o[t];for(let t=0,o=i.length;t<o;t++){const o=i[t];t>0?(n+=o[0],s+=o[1]):(n=o[0],s=o[1]),o[0]=e(n),o[1]=r(s)}}}:"extent"===t?t=>{t.xmin=e(t.xmin),t.ymin=r(t.ymin),t.xmax=e(t.xmax),t.ymax=r(t.ymax)}:"multipoint"===t?t=>{const o=t.points;let n,s;for(let t=0,i=o.length;t<i;t++){const i=o[t];t>0?(n+=i[0],s+=i[1]):(n=i[0],s=i[1]),i[0]=e(n),i[1]=r(s)}}:null}};(0,n._)([(0,c.Cb)({type:String,json:{write:!0}})],b.prototype,"displayFieldName",void 0),(0,n._)([(0,c.Cb)({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],b.prototype,"exceededTransferLimit",void 0),(0,n._)([(0,c.Cb)({type:[i.Z],json:{write:!0}})],b.prototype,"features",void 0),(0,n._)([(0,d.r)("features")],b.prototype,"readFeatures",null),(0,n._)([(0,c.Cb)({type:[g.Z],json:{write:!0}})],b.prototype,"fields",void 0),(0,n._)([(0,c.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:w.read}}})],b.prototype,"geometryType",void 0),(0,n._)([(0,y.w)("geometryType")],b.prototype,"writeGeometryType",null),(0,n._)([(0,c.Cb)({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],b.prototype,"hasM",void 0),(0,n._)([(0,c.Cb)({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],b.prototype,"hasZ",void 0),(0,n._)([(0,c.Cb)({types:s.qM,json:{write:!0}})],b.prototype,"queryGeometry",void 0),(0,n._)([(0,d.r)("queryGeometry")],b.prototype,"readQueryGeometry",null),(0,n._)([(0,c.Cb)({type:f.Z,json:{write:!0}})],b.prototype,"spatialReference",void 0),(0,n._)([(0,y.w)("spatialReference")],b.prototype,"writeSpatialReference",null),(0,n._)([(0,c.Cb)({json:{write:!0}})],b.prototype,"transform",void 0),b=o=(0,n._)([(0,h.j)("esri.rest.support.FeatureSet")],b),b.prototype.toJSON.isDefaultToJSON=!0;const _=b}}]);