// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Analysis ./LineOfSightAnalysisObserver ./LineOfSightAnalysisTarget ../core/Collection ../core/collectionUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../geometry/projection ../geometry/support/aaBoundingBox ../support/elevationInfoUtils".split(" "),function(m,e,c,u,v,w,q,b,r,f,E,F,G,x,
y,n,z){const p=w.ofType(v);c=function(g){function h(a){a=A.call(this,a);a.type="line-of-sight";a.observer=null;a.extent=null;return a}m._inherits(h,g);var A=m._createSuper(h);g=h.prototype;g.initialize=function(){this.addHandles(r.watch(()=>this._computeExtent(),a=>{(b.isNone(a)||b.isNone(a.pending))&&this._set("extent",b.isSome(a)?a.extent:null)},r.syncAndInitial))};g.waitComputeExtent=async function(){const a=this._computeExtent();return b.isSome(a)?b.unwrap(a.pending):Promise.resolve()};g._computeExtent=
function(){var a=this.spatialReference;if(b.isNone(this.observer)||b.isNone(this.observer.position)||b.isNone(a))return null;const t=k=>"absolute-height"===z.getGeometryEffectiveElevationMode(k.position,k.elevationInfo);var d=this.observer.position;d=n.fromValues(d.x,d.y,d.z,d.x,d.y,d.z);for(const k of this.targets)if(b.isSome(k.position)){const l=y.projectOrLoad(k.position,a);if(b.isSome(l.pending))return{pending:l.pending,extent:null};if(b.isSome(l.geometry)){const {x:B,y:C,z:D}=l.geometry;n.expandWithVec3(d,
[B,C,D])}}a=n.toExtent(d,a);t(this.observer)&&this.targets.every(t)||(a.zmin=void 0,a.zmax=void 0);return{pending:null,extent:a}};g.clear=function(){this.observer=null;this.targets.removeAll()};m._createClass(h,[{key:"targets",get:function(){return this._get("targets")||new p},set:function(a){this._set("targets",q.referenceSetter(a,this.targets,p))}},{key:"spatialReference",get:function(){return b.isSome(this.observer)&&b.isSome(this.observer.position)?this.observer.position.spatialReference:null}},
{key:"requiredPropertiesForEditing",get:function(){return[b.applySome(this.observer,a=>a.position)]}}]);return h}(c);e.__decorate([f.property({type:["line-of-sight"]})],c.prototype,"type",void 0);e.__decorate([f.property({type:u,json:{read:!0,write:!0}})],c.prototype,"observer",void 0);e.__decorate([f.property({cast:q.castForReferenceSetter,type:p,nonNullable:!0,json:{read:!0,write:!0}})],c.prototype,"targets",null);e.__decorate([f.property({value:null,readOnly:!0})],c.prototype,"extent",void 0);
e.__decorate([f.property({readOnly:!0})],c.prototype,"spatialReference",null);e.__decorate([f.property({readOnly:!0})],c.prototype,"requiredPropertiesForEditing",null);return c=e.__decorate([x.subclass("esri.analysis.LineOfSightAnalysis")],c)});