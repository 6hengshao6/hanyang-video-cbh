// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/handleUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../3d/webgl-engine/lib/edgeRendering/EdgeWorkerHandle ./sceneLayerSource/SceneLayerSnappingSourceWorkerHandle".split(" "),
function(c,l,g,p,m,h,q,k,x,y,z,r,t,u){function n(b){return d=>b.immediate.schedule(d)}c.I3SSnappingSource=function(b){function d(a){a=v.call(this,a);a.availability=1;a._abortController=new AbortController;return a}l._inherits(d,b);var v=l._createSuper(d);b=d.prototype;b.destroy=function(){this._tracker=h.removeMaybe(this._tracker);this._abortController=h.abortMaybe(this._abortController)};b.initialize=function(){var {view:a}=this;a=a.resourceController;this._edgeWorker=new t.EdgeWorkerHandle(n(a));
this._workerHandle=new u.SceneLayerSnappingSourceWorkerHandle({renderCoordsHelper:this.view.renderCoordsHelper,schedule:n(a),fetchEdgeLocations:async(f,e)=>{if(h.isNone(this._tracker))throw Error("tracker-not-initialized");return this._tracker.fetchEdgeLocations(f,this._edgeWorker,e)}});this.updatingHandles.addPromise(this._setupLayerView());this.handles.add([m.destroyHandle(this._workerHandle),m.destroyHandle(this._edgeWorker)])};b.fetchCandidates=async function(a,f){return this._workerHandle.fetchCandidates(a,
f)};b.refresh=function(){};b._setupLayerView=async function(){if(!this.destroyed){var a=h.applySome(this._abortController,e=>e.signal),f=await this.getLayerView();h.isNone(f)||q.isAborted(a)||(this._tracker=f.trackSnappingSources({add:(e,w)=>{this.updatingHandles.addPromise(this._workerHandle.add({id:e,bounds:w},a))},remove:e=>{this.updatingHandles.addPromise(this._workerHandle.remove({id:e},a))}}))}};l._createClass(d,[{key:"updating",get:function(){return this.updatingHandles.updating}}]);return d}(p.HandleOwner);
g.__decorate([k.property({constructOnly:!0})],c.I3SSnappingSource.prototype,"getLayerView",void 0);g.__decorate([k.property({constructOnly:!0})],c.I3SSnappingSource.prototype,"view",void 0);g.__decorate([k.property({readOnly:!0})],c.I3SSnappingSource.prototype,"updating",null);g.__decorate([k.property({readOnly:!0})],c.I3SSnappingSource.prototype,"availability",void 0);c.I3SSnappingSource=g.__decorate([r.subclass("esri.views.interactive.snapping.featureSources.I3SSnappingSource")],c.I3SSnappingSource);
Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});