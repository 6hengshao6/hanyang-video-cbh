// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../support/Scheduler".split(" "),function(d,n,k,u,e,v,m,y,z,A,w,r){d.SnappingOperation=function(f){function l(b){var a=x.call(this,b);a.constrainResult=c=>c;a._snapPoints=
null;a._frameTask=null;a._abortController=null;a._stagedPoint=null;a._snap=v.debounce(async(c,g,h,p)=>{const q=a._frameTask;if(!e.isNone(q)){var t=await q.schedule(()=>g.snap({...c,context:h,signal:p}),p);t.valid&&await q.schedule(()=>{a.stagedPoint=t.apply();c!==a._snapPoints&&e.isSome(a._snapPoints)&&(a.stagedPoint=g.update({...a._snapPoints,context:h}))},p)}});return a}n._inherits(l,f);var x=n._createSuper(l);f=l.prototype;f.initialize=function(){const b="3d"===this.view.type?this.view?.resourceController?.scheduler:
null;this._frameTask=e.isSome(b)?b.registerTask(r.TaskPriority.SNAPPING):r.ImmediateTask};f.destroy=function(){this._abortController=e.abortMaybe(this._abortController);this._frameTask=e.removeMaybe(this._frameTask)};f.update=function(b,a,c){this._snapPoints=b;const {point:g,scenePoint:h}=b;return this.stagedPoint=b=a.update({point:g,scenePoint:h,context:c})};f.snap=async function(b,a,c){const {point:g,scenePoint:h}=b;this.stagedPoint=a.update({point:g,scenePoint:h,context:c});this._snapPoints=b;
e.isNone(this._abortController)&&(this._abortController=new AbortController);return this._snap(b,a,c,this._abortController.signal)};f.resnap=async function(b,a){e.isNone(this._snapPoints)||await this.snap(this._snapPoints,b,a)};f.abort=function(){this._abortController=e.abortMaybe(this._abortController);this._snapPoints=null};n._createClass(l,[{key:"stagedPoint",get:function(){return this._stagedPoint},set:function(b){this._stagedPoint=this.constrainResult(b)}}]);return l}(u);k.__decorate([m.property({constructOnly:!0})],
d.SnappingOperation.prototype,"view",void 0);k.__decorate([m.property()],d.SnappingOperation.prototype,"stagedPoint",null);k.__decorate([m.property()],d.SnappingOperation.prototype,"constrainResult",void 0);k.__decorate([m.property()],d.SnappingOperation.prototype,"_stagedPoint",void 0);d.SnappingOperation=k.__decorate([w.subclass("esri.views.interactive.snapping.SnappingOperation")],d.SnappingOperation);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});