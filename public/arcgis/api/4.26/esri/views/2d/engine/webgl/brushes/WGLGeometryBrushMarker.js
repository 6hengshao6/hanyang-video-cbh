// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(r,t,u,z,A,B,C,b){const D={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:b.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:b.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:b.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",
count:2,type:b.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:b.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:b.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:b.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:b.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:b.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};return function(f){function k(){return E.apply(this,
arguments)}r._inherits(k,f);var E=r._createSuper(k);f=k.prototype;f.dispose=function(){};f.getGeometryType=function(){return u.WGLGeometryType.MARKER};f.supportsSymbology=function(d){return d!==u.WGLSymbologyType.HEATMAP&&d!==u.WGLSymbologyType.PIE_CHART};f.drawGeometry=function(d,l,e,a){const {context:g,painter:m,rendererInfo:n,state:v,passOptions:w,requestRender:x,allowDelayedRender:F}=d;var c=B.MarkerMaterialKey.load(e.materialKey),p=C.getTechniqueFromMaterialKey(c.data);const q=t.isSome(w)&&"hittest"===
w.type,{shader:G,vertexLayout:H,hittestAttributes:I}=t.unwrapOr(p.programSpec,D);p=b.PrimitiveType.TRIANGLES;var h=z.createProgramDescriptor(c.data,H);q&&(h=this._getTriangleDesc(e.materialKey,h,I),p=b.PrimitiveType.POINTS);const {attributes:y,bufferLayouts:J}=h;a=m.materialManager.getMaterialProgram(d,c,G,y,a);F&&t.isSome(x)&&!a.compiled?x():(g.useProgram(a),c.textureBinding&&m.textureManager.bindTextures(g,a,c,!0),this._setSharedUniforms(a,d,l),a.setUniformMatrix3fv("u_displayMat3",c.vvRotation?
v.displayViewMat3:v.displayMat3),this._setSizeVVUniforms(c,a,n,l),this._setColorAndOpacityVVUniforms(c,a,n),this._setRotationVVUniforms(c,a,n),c=e.target.getVAO(g,J,y,q),h=e.indexCount,e=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT,q&&(h/=3,e/=3),g.bindVAO(c),this._drawMarkers(d,l,a,p,h,e,q),g.bindVAO(null))};f._drawMarkers=function(d,l,e,a,g,m,n){d.context.drawElements(a,g,b.DataType.UNSIGNED_INT,m)};return r._createClass(k)}(A)});