// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(t,m,n,A,B,C,D,b){return function(f){function p(){return E.apply(this,arguments)}t._inherits(p,f);var E=t._createSuper(p);f=p.prototype;f.dispose=function(){};f.getGeometryType=function(){return n.WGLGeometryType.FILL};f.supportsSymbology=function(d){return d!==n.WGLSymbologyType.DOT_DENSITY};
f.drawGeometry=function(d,g,e,a){const {context:l,painter:q,rendererInfo:w,requiredLevel:F,passOptions:x,requestRender:y,allowDelayedRender:G}=d;var c=C.FillMaterialKey.load(e.materialKey),h=D.getTechniqueFromMaterialKey(c.data);const u=m.isSome(x)&&"hittest"===x.type;var k=q.materialManager,r=m.unwrapOr;h=h.programSpec;const v={geometry:[{location:0,name:"a_pos",count:2,type:b.DataType.SHORT},{location:1,name:"a_id",count:3,type:b.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:b.DataType.UNSIGNED_BYTE},
{location:3,name:"a_color",count:4,type:b.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:b.DataType.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:b.DataType.SHORT},{location:6,name:"a_aux3",count:4,type:b.DataType.UNSIGNED_BYTE},{location:7,name:"a_zoomRange",count:2,type:b.DataType.UNSIGNED_SHORT}]};switch(c.symbologyType){case n.WGLSymbologyType.SIMPLE:case n.WGLSymbologyType.OUTLINE_FILL_SIMPLE:v.geometry.splice(7,1),v.geometry.splice(4,1)}const {shader:H,
vertexLayout:I,hittestAttributes:J}=r.call(m,h,{shader:"materials/fill",vertexLayout:v});r=b.PrimitiveType.TRIANGLES;h=A.createProgramDescriptor(c.data,I);u&&(h=this._getTriangleDesc(e.materialKey,h,J),r=b.PrimitiveType.POINTS);const {attributes:z,bufferLayouts:K}=h;a=k.getMaterialProgram(d,c,H,z,a);G&&m.isSome(y)&&!a.compiled?y():(l.useProgram(a),this._setSharedUniforms(a,d,g),a.setUniform2f("u_tileOffset",512*g.key.col,512*g.key.row),c.textureBinding&&(q.textureManager.bindTextures(l,a,c),a.setUniform1f("u_zoomFactor",
1/2**(F-g.key.level))),k=1/d.pixelRatio,a.setUniform1f("u_blur",k),a.setUniform1f("u_antialiasing",k),this._setSizeVVUniforms(c,a,w,g),this._setColorAndOpacityVVUniforms(c,a,w),c=e.target.getVAO(l,K,z,u),k=e.indexCount,e=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT,u&&(k/=3,e/=3),l.bindVAO(c),this._drawFills(d,g,a,r,k,e))};f._drawFills=function(d,g,e,a,l,q){d.context.drawElements(a,l,b.DataType.UNSIGNED_INT,q)};return t._createClass(p)}(B)});