// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),function(r,n,t,y,z,A,p,h){p=function(k){function l(){var a=B.apply(this,arguments);a._programOptions={id:!1};return a}n._inherits(l,k);var B=n._createSuper(l);k=l.prototype;k.dispose=function(){};k.drawMany=function(a,d){const {context:e,displayLevel:q,requiredLevel:C,state:u,drawPhase:D,painter:E,spriteMosaic:F,
styleLayerUID:m,requestRender:v,allowDelayedRender:G}=a;if(d.some(b=>b.layerData.get(m)?.circleIndexCount??!1)){a=a.styleLayer;var w=a.circleMaterial,c=E.vectorTilesMaterialManager,g=a.getPaintValue("circle-translate",q),H=a.getPaintValue("circle-translate-anchor",q),f=D===z.WGLDrawPhase.HITTEST,x=this._programOptions;x.id=f;c=c.getMaterialProgram(e,w,x);if(G&&t.isSome(v)&&!c.compiled)v();else{e.useProgram(c);c.setUniformMatrix3fv("u_displayMat3",H===y.TranslateAnchor.VIEWPORT?u.displayMat3:u.displayViewMat3);
c.setUniform2fv("u_circleTranslation",g);c.setUniform1f("u_depth",a.z);c.setUniform1f("u_antialiasingWidth",1.2);g=-1;f&&(f=A.u32to4Xu8(m+1),c.setUniform4fv("u_id",f));for(const b of d)b.layerData.has(m)&&(b.key.level!==g&&(g=b.key.level,w.setDataUniforms(c,q,a,g,F)),d=b.layerData.get(m),d.circleIndexCount&&(d.prepareForRendering(e),f=d.circleVertexArrayObject,t.isNone(f)||(e.bindVAO(f),c.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs),C!==b.key.level?e.setStencilFunction(h.CompareFunction.EQUAL,
b.stencilRef,255):e.setStencilFunction(h.CompareFunction.GREATER,255,255),e.drawElements(h.PrimitiveType.TRIANGLES,d.circleIndexCount,h.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*d.circleIndexStart),b.triangleCount+=d.circleIndexCount/3)))}}};return n._createClass(l)}(p);r.WGLBrushVTLCircle=p;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});