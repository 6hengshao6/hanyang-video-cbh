// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry/support/aaBoundingRect ../../viewpointUtils ./BrushRasterBitmap ./RasterTile ../webgl/enums ../webgl/TileContainer".split(" "),function(m,d,p,q,r,t,n,k){k=function(h){function f(){var a=u.apply(this,arguments);a.isCustomTilingScheme=!1;return a}d._inherits(f,h);var u=d._createSuper(f);h=f.prototype;h.createTile=function(a){const b=this._getTileBounds(a),[c,g]=this._tileInfoView.tileInfo.size,e=this._tileInfoView.getTileResolution(a.level);
return new t.RasterTile(a,e,b[0],b[3],c,g)};h.prepareRenderPasses=function(a){const b=a.registerRenderPass({name:"imagery (tile)",brushes:[r],target:()=>this.children.map(c=>c.bitmap),drawPhase:n.WGLDrawPhase.MAP});return[...d._get(d._getPrototypeOf(f.prototype),"prepareRenderPasses",this).call(this,a),b]};h.doRender=function(a){if(this.visible&&a.drawPhase===n.WGLDrawPhase.MAP){var {rasterFunctionChain:b}=this;if(b){var [c,g]=this._tileInfoView.tileInfo.size;a.renderPass="raster";a.rasterFunction=
{name:"Reproject",parameters:{targetImageSize:[c,g],requireBilinear:b.hasSurfaceFunction},pixelType:"f32",id:0,isNoopProcess:!1};d._get(d._getPrototypeOf(f.prototype),"doRender",this).call(this,a);if(b?.functions.length){const {functions:e,hasBranches:v}=b;for(b=0;b<e.length;b++){const l=e[b];"Constant"!==l.name&&"Identity"!==l.name&&(a.renderPass="raster",a.rasterFunction=l,a.hasBranches=v,d._get(d._getPrototypeOf(f.prototype),"doRender",this).call(this,a))}}a.rasterFunction=null;a.renderPass="bitmap"}else a.renderPass=
"raster-bitmap";d._get(d._getPrototypeOf(f.prototype),"doRender",this).call(this,a)}};h._getTileBounds=function(a){const b=this._tileInfoView.getTileBounds(p.create(),a);if(this.isCustomTilingScheme&&a.world){var {tileInfo:c}=this._tileInfoView,g=q.getWorldWidth(c.spatialReference);if(g){var e=c.lodAt(a.level);if(!e)return b;({resolution:e}=e);c=(g=g/e%c.size[0])?(c.size[0]-g)*e:0;b[0]-=c*a.world;b[2]-=c*a.world}}return b};return d._createClass(f)}(k);m.RasterTileContainer=k;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})});