// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(q,l,r,t,m,u,n){n=function(e){function k(){var a=v.apply(this,arguments);a.defines=[];a._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",0]])};return a}l._inherits(k,e);var v=l._createSuper(k);e=k.prototype;e.dispose=function(){this._quad&&this._quad.dispose()};e.bind=function(){};e.unbind=
function(){};e.draw=function(a,d){if(d?.size){var {context:c,renderingOptions:b}=a;this._quad||(this._quad=new u(c,[0,0,1,0,0,1,1,1]));var h=c.getBoundFramebufferObject(),{x:p,y:f,width:w,height:x}=c.getViewport();d.bindTextures(c);var g=d.getBlock(m.ATTRIBUTE_DATA_ANIMATION);if(!t.isNone(g)){var y=g.getFBO(c);g=g.getFBO(c,1);c.setViewport(0,0,d.size,d.size);this._computeDelta(a,g,b.labelsAnimationTime);this._updateAnimationState(a,g,y);c.bindFramebuffer(h);c.setViewport(p,f,w,x)}}};e._computeDelta=
function(a,d,c){const {context:b,painter:h,displayLevel:p}=a,f=h.materialManager.getProgram(this._desc,["delta"]);b.bindFramebuffer(d);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);b.useProgram(f);d=r("featurelayer-animation-enabled")?c:1;f.setUniform1i("u_maskTexture",m.TEXTURE_BINDING_ATTRIBUTE_DATA_0);f.setUniform1i("u_sourceTexture",m.TEXTURE_BINDING_ATTRIBUTE_DATA_1);f.setUniform1f("u_timeDelta",a.deltaTime);f.setUniform1f("u_animationTime",d);f.setUniform1f("u_zoomLevel",Math.round(10*
p));this._quad.draw()};e._updateAnimationState=function(a,d,c){const {context:b,painter:h}=a;a=h.materialManager.getProgram(this._desc,["update"]);b.bindTexture(d.colorTexture,1);b.useProgram(a);a.setUniform1i("u_sourceTexture",1);b.bindFramebuffer(c);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);this._quad.draw()};return l._createClass(k)}(n.Effect);q.AnimationEffect=n;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})});