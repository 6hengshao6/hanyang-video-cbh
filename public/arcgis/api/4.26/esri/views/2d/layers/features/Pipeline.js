// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/HandleOwner":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./Handles ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass ./support/WatchUpdatingTracking".split(" "),function(q,n,G,F,z,y,D,x){const k=g=>{g=function(b){function a(){var e=h.apply(this,arguments);e._handles=new z;e._updatingHandles=new x.WatchUpdatingTracking;return e}n._inherits(a,b);var h=n._createSuper(a);a.prototype.destroy=function(){this.destroyed||
(this._handles.destroy(),this._updatingHandles.destroy())};n._createClass(a,[{key:"handles",get:function(){return this._handles}},{key:"updatingHandles",get:function(){return this._updatingHandles}}]);return a}(g);G.__decorate([y.property({readOnly:!0})],g.prototype,"handles",null);G.__decorate([y.property({readOnly:!0})],g.prototype,"updatingHandles",null);return g=G.__decorate([D.subclass("esri.core.HandleOwner")],g)};q.HandleOwner=function(g){function b(){return a.apply(this,arguments)}n._inherits(b,
g);var a=n._createSuper(b);return n._createClass(b)}(k(F));q.HandleOwner=G.__decorate([D.subclass("esri.core.HandleOwner")],q.HandleOwner);q.HandleOwnerMixin=k;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/support/WatchUpdatingTracking":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../Accessor ../Handles ../maybe ../reactiveUtils ../scheduling ../accessorSupport/decorators/property ../accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k,g){q.WatchUpdatingTracking=function(b){function a(){var e=h.apply(this,arguments);e.updating=!1;e._handleId=0;e._handles=new z;e._scheduleHandleId=0;e._pendingPromises=new Set;return e}n._inherits(a,b);var h=n._createSuper(a);b=a.prototype;b.destroy=function(){this.removeAll();this._handles.destroy()};b.add=function(e,f,c={}){return this._installWatch(e,f,c,D.watch)};b.addWhen=function(e,f,c={}){return this._installWatch(e,f,c,D.when)};b.addOnCollectionChange=function(e,
f,{initial:c=!1,final:d=!1}={}){const p=++this._handleId;this._handles.add([D.on(e,"after-changes",this._createSyncUpdatingCallback(),D.sync),D.on(e,"change",f,{onListenerAdd:c?v=>f({added:v.toArray(),removed:[]}):void 0,onListenerRemove:d?v=>f({added:[],removed:v.toArray()}):void 0})],p);return{remove:()=>this._handles.remove(p)}};b.addPromise=function(e){if(y.isNone(e))return e;const f=++this._handleId;this._handles.add({remove:()=>{this._pendingPromises.delete(e)&&(0!==this._pendingPromises.size||
this._handles.has(-42)||this._set("updating",!1))}},f);this._pendingPromises.add(e);this._set("updating",!0);const c=()=>this._handles.remove(f);e.then(c,c);return e};b.removeAll=function(){this._pendingPromises.clear();this._handles.removeAll();this._set("updating",!1)};b._installWatch=function(e,f,c={},d){const p=++this._handleId;c.sync||this._installSyncUpdatingWatch(e,p);e=d(e,f,c);this._handles.add(e,p);return{remove:()=>this._handles.remove(p)}};b._installSyncUpdatingWatch=function(e,f){const c=
this._createSyncUpdatingCallback();e=D.watch(e,c,{sync:!0,equals:()=>!1});this._handles.add(e,f);return e};b._createSyncUpdatingCallback=function(){return()=>{this._handles.remove(-42);++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0);this._handles.add(x.schedule(()=>{e===this._scheduleHandleId&&(this._set("updating",0<this._pendingPromises.size),this._handles.remove(-42))}),-42)}};return n._createClass(a)}(F);G.__decorate([k.property({readOnly:!0})],
q.WatchUpdatingTracking.prototype,"updating",void 0);q.WatchUpdatingTracking=G.__decorate([g.subclass("esri.core.support.WatchUpdatingTracking")],q.WatchUpdatingTracking);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/reactiveUtils":function(){define("exports ./events ./handleUtils ./maybe ./promiseUtils ./accessorSupport/watch ./accessorSupport/trackingUtils".split(" "),function(q,n,G,F,z,y,D){function x(h,e,f={}){return k(h,e,f,b)}function k(h,e,f={},c){let d=null;const p=
f.once?(v,l)=>{c(v)&&(F.removeMaybe(d),e(v,l))}:(v,l)=>{c(v)&&e(v,l)};d=y.watchTracked(h,p,f.sync,f.equals);f.initial&&(h=h(),p(h,h));return d}function g(h,e,f){if(z.isAborted(f))return Promise.reject(z.createAbortError());const c=h();if(e?.(c))return Promise.resolve(c);let d=null;return new Promise((p,v)=>{d=G.handlesGroup([z.onAbort(f,()=>{d=F.removeMaybe(d);v(z.createAbortError())}),k(h,l=>{d=F.removeMaybe(d);p(l)},{sync:!1,once:!0},e??b)])})}function b(h){return!0}function a(h){return!!h}q.autorun=
D.autorun;q.initial={initial:!0};q.on=function(h,e,f,c={}){function d(){v&&l&&(l.remove(),c.onListenerRemove?.(v),l=v=null)}function p(A){c.once&&c.once&&F.removeMaybe(u);f(A)}let v=null,l=null,u=null;const r=x(h,(A,w)=>{d();n.isEventTarget(A)&&(v=A,l=n.on(A,e,p),c.onListenerAdd?.(A))},{sync:c.sync,initial:!0});return u=G.makeHandle(()=>{r.remove();d()})};q.once=function(h,e){return g(h,null,e)};q.pausable=function(h,e,f={}){let c=!1;const d=x(h,(p,v)=>{c||e(p,v)},f);return{remove(){d.remove()},pause(){c=
!0},resume(){c=!1}}};q.sync={sync:!0};q.syncAndInitial={sync:!0,initial:!0};q.watch=x;q.when=function(h,e,f={}){return k(h,e,f,a)};q.whenOnce=function(h,e){return g(h,a,e)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l){var u;G=new G.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});F=u=function(r){function A(m){m=w.call(this,m);m.dpi=96;m.format=null;m.origin=null;m.minScale=0;m.maxScale=0;m.size=null;m.spatialReference=null;return m}q._inherits(A,r);var w=q._createSuper(A);A.create=
function(m={}){const {resolutionFactor:t=1,scales:B,size:J=256,spatialReference:C=f.WebMercator,numLODs:K=24}=m;if(!d.isValid(C)){m=[];if(B)for(var E=0;E<B.length;E++){var I=B[E];m.push(new v({level:E,scale:I,resolution:I}))}else for(E=5E-4,I=K-1;0<=I;I--)m.unshift(new v({level:I,scale:E,resolution:E})),E*=2;return new u({dpi:96,lods:m,origin:new e(0,0,C),size:[J,J],spatialReference:C})}E=d.getInfo(C);m=m.origin?new e({x:m.origin.x,y:m.origin.y,spatialReference:C}):E?new e({x:E.origin[0],y:E.origin[1],
spatialReference:C}):new e({x:0,y:0,spatialReference:C});E=1/(39.37*y.getMetersPerUnitForSR(C)*96);I=[];if(B)for(var H=0;H<B.length;H++){var N=B[H];I.push(new v({level:H,scale:N,resolution:N*E}))}else{var U=d.isGeographic(C)?512/J*5.916575275917094E8:256/J*5.91657527591555E8;H=Math.ceil(K/t);I.push(new v({level:0,scale:U,resolution:U*E}));for(N=1;N<H;N++)U/=2**t,I.push(new v({level:N,scale:U,resolution:U*E}))}return new u({dpi:96,lods:I,origin:m,size:[J,J],spatialReference:C})};r=A.prototype;r.readOrigin=
function(m,t){return e.fromJSON({spatialReference:t.spatialReference,...m})};r.readSize=function(m,t){return[t.cols,t.rows]};r.writeSize=function(m,t){t.cols=m[0];t.rows=m[1]};r.zoomToScale=function(m){const t=this.scales;if(0>=m)return t[0];if(m>=t.length-1)return t[t.length-1];const B=Math.floor(m);return t[B]/(t[B]/t[B+1])**(m-B)};r.scaleToZoom=function(m){const t=this.scales,B=t.length-1;let J=0;for(;J<B;J++){const C=t[J],K=t[J+1];if(C<=m)break;if(K===m)return J+1;if(C>m&&K<m)return J+Math.log(C/
m)/Math.log(C/K)}return J};r.snapScale=function(m,t=.95){m=this.scaleToZoom(m);return m%Math.floor(m)>=t?this.zoomToScale(Math.ceil(m)):this.zoomToScale(Math.floor(m))};r.tileAt=function(m,t,B,J){var C=this.lodAt(m);if(!C)return null;let K;if("number"===typeof t)K=t,t=B;else{if(d.equals(t.spatialReference,this.spatialReference))K=t.x,t=t.y;else{J=p.project(t,this.spatialReference);if(z.isNone(J))return null;K=J.x;t=J.y}J=B}B=C.resolution*this.size[0];C=C.resolution*this.size[1];J||(J=new l.TileKey(null,
0,0,0,c.create()));J.level=m;J.row=Math.floor((this.origin.y-t)/C+.001);J.col=Math.floor((K-this.origin.x)/B+.001);this.updateTileInfo(J);return J};r.updateTileInfo=function(m,t=u.ExtrapolateOptions.NONE){var B=this.lodAt(m.level);B||t!==u.ExtrapolateOptions.POWER_OF_TWO||(t=this.lods[this.lods.length-1],t.level<m.level&&(B=t));if(B){var J=m.level-B.level;t=B.resolution*this.size[0]/2**J;B=B.resolution*this.size[1]/2**J;m.id=`${m.level}/${m.row}/${m.col}`;m.extent||(m.extent=c.create());m.extent[0]=
this.origin.x+m.col*t;m.extent[1]=this.origin.y-(m.row+1)*B;m.extent[2]=m.extent[0]+t;m.extent[3]=m.extent[1]+B}};r.upsampleTile=function(m){const t=this._upsampleLevels[m.level];if(!t||-1===t.parentLevel)return!1;m.level=t.parentLevel;m.row=Math.floor(m.row/t.factor+.001);m.col=Math.floor(m.col/t.factor+.001);this.updateTileInfo(m);return!0};r.getTileBounds=function(m,t){var B=this.lodAt(t.level);if(null==B)return null;var {resolution:J}=B;B=J*this.size[0];J*=this.size[1];m[0]=this.origin.x+t.col*
B;m[1]=this.origin.y-(t.row+1)*J;m[2]=m[0]+B;m[3]=m[1]+J;return m};r.lodAt=function(m){return this._levelToLOD?.[m]??null};r.clone=function(){return u.fromJSON(this.write({}))};r.getOrCreateCompatible=function(m,t){if(256===this.size[0]&&256===this.size[1])return 256===m?this:null;const B=[],J=this.lods.length;for(let C=0;C<J;C++){const K=this.lods[C];B.push(new v({level:K.level,scale:K.scale,resolution:K.resolution*t}))}return new u({size:[m,m],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,
origin:this.origin,spatialReference:this.spatialReference,lods:B})};r._initializeUpsampleLevels=function(){const m=this.lods;this._upsampleLevels=[];let t=null;for(let B=0;B<m.length;B++){const J=m[B];this._upsampleLevels[J.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/J.resolution:0};t=J}};q._createClass(A,[{key:"isWrappable",get:function(){const {spatialReference:m,origin:t}=this;if(m&&t){const B=d.getInfo(m);return m.isWrappable&&!!B&&Math.abs(B.origin[0]-t.x)<=B.dx}return!1}},{key:"lods",
set:function(m){let t=0,B=0;const J=[],C=this._levelToLOD={};m&&(t=-Infinity,B=Infinity,m.forEach(K=>{J.push(K.scale);t=K.scale>t?K.scale:t;B=K.scale<B?K.scale:B;C[K.level]=K}));this._set("scales",J);this._set("minScale",t);this._set("maxScale",B);this._set("lods",m);this._initializeUpsampleLevels()}}]);return A}(F.JSONSupport);n.__decorate([D.property({type:Number,json:{write:!0}})],F.prototype,"compressionQuality",void 0);n.__decorate([D.property({type:Number,json:{write:!0}})],F.prototype,"dpi",
void 0);n.__decorate([D.property({type:String,json:{read:G.read,write:G.write,origins:{"web-scene":{read:!1,write:!1}}}})],F.prototype,"format",void 0);n.__decorate([D.property({readOnly:!0})],F.prototype,"isWrappable",null);n.__decorate([D.property({type:e,json:{write:!0}})],F.prototype,"origin",void 0);n.__decorate([b.reader("origin")],F.prototype,"readOrigin",null);n.__decorate([D.property({type:[v],value:null,json:{write:!0}})],F.prototype,"lods",null);n.__decorate([D.property({readOnly:!0})],
F.prototype,"minScale",void 0);n.__decorate([D.property({readOnly:!0})],F.prototype,"maxScale",void 0);n.__decorate([D.property({readOnly:!0})],F.prototype,"scales",void 0);n.__decorate([D.property({cast:r=>Array.isArray(r)?r:"number"===typeof r?[r,r]:[256,256]})],F.prototype,"size",void 0);n.__decorate([b.reader("size",["rows","cols"])],F.prototype,"readSize",null);n.__decorate([h.writer("size",{cols:{type:x.Integer},rows:{type:x.Integer}})],F.prototype,"writeSize",null);n.__decorate([D.property({type:f,
json:{write:!0}})],F.prototype,"spatialReference",void 0);F=u=n.__decorate([a.subclass("esri.layers.support.TileInfo")],F);(function(r){r=r.ExtrapolateOptions||(r.ExtrapolateOptions={});r[r.NONE=0]="NONE";r[r.POWER_OF_TWO=1]="POWER_OF_TWO"})(F||(F={}));return F})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x){var k;G=k=function(g){function b(h){h=a.call(this,h);h.cols=null;h.level=0;h.levelValue=null;h.origin=null;h.resolution=0;h.rows=null;h.scale=0;return h}q._inherits(b,g);var a=q._createSuper(b);b.prototype.clone=function(){return new k({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return q._createClass(b)}(G.JSONSupport);n.__decorate([F.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},
"portal-item":{read:!1,write:!1}}}})],G.prototype,"cols",void 0);n.__decorate([F.property({type:z.Integer,json:{write:!0}})],G.prototype,"level",void 0);n.__decorate([F.property({type:String,json:{write:!0}})],G.prototype,"levelValue",void 0);n.__decorate([F.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],G.prototype,"origin",void 0);n.__decorate([F.property({type:Number,json:{write:!0}})],G.prototype,"resolution",void 0);n.__decorate([F.property({json:{write:!0,
origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],G.prototype,"rows",void 0);n.__decorate([F.property({type:Number,json:{write:!0}})],G.prototype,"scale",void 0);return G=k=n.__decorate([x.subclass("esri.layers.support.LOD")],G)})},"esri/layers/support/TileKey":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(q,n){n=n._createClass(function(G,F,z,y,D){this.id=G;this.level=F;this.row=z;this.col=y;this.extent=D});q.TileKey=n;Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/processors":function(){define(["require","exports"],function(q,n){const G=F=>Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));n.loadProcessorModule=function(F){return"heatmap"===F?new Promise((z,y)=>q(["./processors/HeatmapProcessor"],D=>z(G(D)),y)):new Promise((z,y)=>q(["./processors/SymbolProcessor"],D=>z(G(D)),y))};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/layers/features/controllers/FeatureController2D":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/decorators/subclass ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../FeatureStore2D ../sources/createSource ../support/AttributeStore ../support/BinStore ../support/ClusterStore ../support/ComputedAttributeStorage ../support/FeatureSetReaderJSON ../support/UpdateToken ../../../../support/QueueProcessor".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r,A){function w(t){if(!y.isAbortError(t)&&"worker:port-closed"!==t.name)throw t;}function m(t){return"feature"===t.type&&"snapshot"===t.mode}G=function(t){function B(){var C=J.apply(this,arguments);C._storage=new l.ComputedAttributeStorage;C._markedIdsBufId=C._storage.createBitset();C._lastCleanup=performance.now();C._cleanupNeeded=!1;C._invalidated=!1;C._tileToResolver=new Map;C._didEdit=!1;C._updateVersion=1;C.tileStore=null;C.config=null;C.processor=
null;C.remoteClient=null;C.service=null;return C}q._inherits(B,t);var J=q._createSuper(B);t=B.prototype;t.initialize=function(){this._initStores();this._initSource();this._updateQueue=new A.QueueProcessor({concurrency:"stream"===this._source.type?1:4,process:(C,K)=>this._onTileMessage(C,{signal:K})});this.addHandles([this.tileStore.on("update",this.onTileUpdate.bind(this)),D.when(()=>!this.updating,()=>this.onIdle())])};t._initSource=function(){this._source=c.createSource(this.service,this.spatialReference,
this.tileStore.tileScheme,(C,K)=>{this._invalidated=!0;return this._patchTile(C,K)},()=>this._updateQueue&&50>this._updateQueue.length,this.featureStore);this._proxyEvents()};t._proxyEvents=function(){if("stream"===this._source.type){const C=this._source.events,K=this._source;this.addHandles([D.watch(()=>K.connectionStatus,E=>this.remoteClient.invoke("setProperty",{propertyName:"connectionStatus",value:E}).catch(w),{initial:!0}),D.watch(()=>K.errorString,E=>this.remoteClient.invoke("setProperty",
{propertyName:"errorString",value:E}).catch(w),{initial:!0}),C.on("data-received",E=>this.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:E.attributes,centroid:E.centroid,geometry:E.geometry}}).catch(w)),C.on("message-received",E=>this.remoteClient.invoke("emitEvent",{name:"message-received",event:E}).catch(w)),C.on("updateRate",E=>this.remoteClient.invoke("emitEvent",{name:"update-rate",event:{...E}}).catch(w))])}};t._initAttributeStore=function(C){this.attributeStore||(this.attributeStore=
new d({type:"remote",initialize:(K,E)=>y.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",K,{signal:E}).catch(w)),update:(K,E)=>y.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",K,{signal:E}).catch(w)),render:K=>y.ignoreAbortErrors(this.remoteClient.invoke("tileRenderer.featuresView.requestRender",void 0,{signal:K}).catch(w))},C))};t._initStores=function(){this.featureStore=new f.FeatureStore2D({geometryInfo:{geometryType:this.service.geometryType,
hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields},this._storage,"snapshot"===this.service.type?"snapshot":"on-demand")};t._initQueryEngine=function(C){const K=this;this.featureQueryEngine?.destroy();this.featureQueryEngine=new h.QueryEngine({definitionExpression:C.schema.source.definitionExpression??void 0,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),
cacheSpatialQueries:!0,featureStore:this.featureStore,aggregateAdapter:{getFeatureObjectIds(E){return z.isNone(K.aggregateStore)?[]:K.aggregateStore.getFeatureDisplayIdsForAggregate(E).map(I=>K.getObjectId(I))}},timeInfo:this.service.timeInfo})};t._initAggregateQueryEngine=function(C,K){this.aggregateQueryEngine?.destroy();z.isNone(C)||(K=K.targets.aggregate.params.fields.slice(),this.aggregateQueryEngine=new h.QueryEngine({definitionExpression:void 0,fields:K,geometryType:C.geometryInfo.geometryType,
objectIdField:C.objectIdField,hasM:C.geometryInfo.hasM,hasZ:C.geometryInfo.hasZ,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!1,featureStore:C,aggregateAdapter:{getFeatureObjectIds(E){return[]}}}))};t.destroy=function(){this._updateQueue.destroy();this._source.destroy();this.featureQueryEngine?.destroy();this.aggregateQueryEngine?.destroy();this.attributeStore?.destroy();for(const C of this.tileStore.tiles)this._source.unsubscribe(C);clearInterval(this._checkUpdating)};t.isUpdating=
function(){const C=this._source.updatingHandles.updating,K=!this.attributeStore||this.attributeStore.updatingHandles.updating,E=C||K||this.updatingHandles.updating;F("esri-2d-log-updating")&&console.log(`Updating FeatureController2D: ${E}\n  -> updatingSource ${C}\n  -> updatingAttributeStore ${K}\n  -> updatingHandles ${this.updatingHandles.updating} (queue: ${this._updateQueue.length})\n`);return E};t.updateCustomParameters=function(C){"stream"===this._source.type&&this._source.updateCustomParameters(C)};
t.enableEvent=function(C){this._source.enableEvent(C.name,C.value)};t.pause=function(){this._updateQueue.pause();this._updateQueue.clear()};t.resume=function(){this._updateQueue.resume()};t.pauseStream=function(){"stream"===this._source.type&&this._source.pauseStream()};t.resumeStream=function(){"stream"===this._source.type&&this._source.resumeStream()};t.sendMessageToSocket=function(C){"stream"===this._source.type&&this._source.sendMessageToSocket(C)};t.sendMessageToClient=function(C){"stream"===
this._source.type&&this._source.sendMessageToClient(C)};t._initAggregateStore=function(C){C=C.schema.targets?.aggregate?.type;if(z.applySome(this.config,K=>K.schema.targets?.aggregate?.type)!==C&&(z.isSome(this.aggregateStore)&&(this.removeHandles("valueRangesChanged"),this.aggregateStore.destroy(),this.aggregateStore=null),C)){switch(C){case "cluster":this.aggregateStore=new v.ClusterStore({geometryInfo:{geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,
fields:this.service.fields},this.spatialReference,this._storage,this.service);this.addHandles(this.aggregateStore.events.on("valueRangesChanged",K=>{this.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:K.valueRanges}}).catch(w)}),"valueRangesChanged");break;case "bin":this.aggregateStore=new p.BinStore({geometryInfo:{geometryType:"esriGeometryPolygon",hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields},this.spatialReference,
this._storage,this.service)}this.aggregateStore.onTileUpdate({added:this.tileStore.tiles,removed:[]})}};t.update=async function(C,K){this._updateVersion++;F("esri-2d-update-debug")&&console.debug(`FeatureController2D::update: Token version ${this._updateVersion}`);this._initQueryEngine(K);this._initAttributeStore(K);this.pause();await Promise.all([this._source.update(C,K.schema.source),this.featureStore.updateSchema(C,K.schema.targets.feature),this.attributeStore.update(C,K),this.attributeStore.updateFilters(C,
K,this)]);this._initAggregateStore(K);z.isSome(this.aggregateStore)&&await this.aggregateStore.updateSchema(C,K.schema.targets.aggregate);this._initAggregateQueryEngine(this.aggregateStore,K.schema);F("esri-2d-update-debug")&&C.describe();this._set("config",K)};t.applyUpdate=async function(C){C.version=this._updateVersion;F("esri-2d-update-debug")&&console.debug(`FeatureController2D::applyUpdate: Token version ${C.version}`);C.mesh&&this.clearTiles();this._updateQueue.resume();await this._source.applyUpdate(C);
F("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Waiting for source update to finish");this.notifyChange("updating");await D.whenOnce(()=>!this.updating);F("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Source update finsihed");z.isSome(this.aggregateStore)&&(await y.after(10),F("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Waiting for aggregate idle call"),await D.whenOnce(()=>!this.updating),F("esri-2d-update-debug")&&
console.debug("FeatureController2D::applyUpdate Aggregate idle called"));F("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Update finished")};t.onEdits=async function({edits:C}){F("esri-2d-update-debug")&&console.debug("Applying Edit:",C);this._didEdit=!0;try{const K=C.removed.map(I=>I.objectId&&-1!==I.objectId?I.objectId:this._lookupObjectIdByGlobalId(I.globalId)),E=C.addOrModified.map(({objectId:I})=>I);this.featureStore.invalidate();await this._source.edit(E,K);this.clearTiles();
this.notifyChange("updating");z.isSome(this.aggregateStore)&&this.aggregateStore.clear();await this._source.resend();await D.whenOnce(()=>!this.updating)}catch(K){}};t.refresh=async function(C){if(!C.dataChanged)return C=r.UpdateToken.empty(),C.storage.filters=!0,this.applyUpdate(C);this.featureStore.invalidate();this.clearTiles();this._source.refresh(this._updateVersion,C);this._cleanupNeeded=!0;this.notifyChange("updating");await D.whenOnce(()=>!this.updating)};t.clearTiles=function(){for(const C of this.tileStore.tiles)this.processor.onTileClear(C)};
t.onTileUpdate=function(C){if(z.isSome(this.aggregateStore))this.aggregateStore.onTileUpdate(C);for(const K of C.added)this._source.subscribe(K,this._updateVersion),this._level=K.level;for(const K of C.removed)this._source.unsubscribe(K),this._cleanupNeeded=!0,this._tileToResolver.has(K.id)&&(this._tileToResolver.get(K.id).resolve(),this._tileToResolver.delete(K.id));this.notifyChange("updating")};t.onIdle=async function(){this._invalidated&&(this._invalidated=!1,(z.isSome(this.aggregateStore)||"heatmap"===
this.processor.type)&&await this._repushCurrentLevelTiles());this._markAndSweep()};t.querySummaryStatistics=async function({query:C,params:K}){return this.featureQueryEngine.executeQueryForSummaryStatistics(C,K)};t.queryAggregateSummaryStatistics=async function({query:C,params:K}){return this.aggregateQueryEngine.executeQueryForSummaryStatistics(C,K)};t.queryUniqueValues=async function({query:C,params:K}){return this.featureQueryEngine.executeQueryForUniqueValues(C,K)};t.queryAggregateUniqueValues=
async function({query:C,params:K}){return this.aggregateQueryEngine.executeQueryForUniqueValues(C,K)};t.queryClassBreaks=async function({query:C,params:K}){return this.featureQueryEngine.executeQueryForClassBreaks(C,K)};t.queryAggregateClassBreaks=async function({query:C,params:K}){return this.aggregateQueryEngine.executeQueryForClassBreaks(C,K)};t.queryHistogram=async function({query:C,params:K}){return this.featureQueryEngine.executeQueryForHistogram(C,K)};t.queryAggregateHistogram=async function({query:C,
params:K}){return this.aggregateQueryEngine.executeQueryForHistogram(C,K)};t.queryExtent=function(C){return this.featureQueryEngine.executeQueryForExtent(C)};t.queryAggregates=function(C){return this.aggregateQueryEngine.executeQuery(C)};t.queryAggregateCount=function(C){return this.aggregateQueryEngine.executeQueryForCount(C)};t.queryAggregateIds=function(C){return this.aggregateQueryEngine.executeQueryForIds(C)};t.queryFeatures=function(C){return this.featureQueryEngine.executeQuery(C)};t.queryVisibleFeatures=
async function(C){C=await this.featureQueryEngine.executeQuery(C);const K=C.objectIdFieldName;C.features=C.features.filter(E=>{E=this.getDisplayId(E.attributes[K]);return z.applySome(E,I=>this.attributeStore.isVisible(I))});return C};t.queryFeatureCount=function(C){return this.featureQueryEngine.executeQueryForCount(C)};t.queryLatestObservations=function(C){return this.featureQueryEngine.executeQueryForLatestObservations(C)};t.queryObjectIds=function(C){return this.featureQueryEngine.executeQueryForIds(C)};
t.queryStatistics=async function(){return this.featureStore.storeStatistics};t.getObjectId=function(C){return this.featureStore.lookupObjectId(C,this._storage)};t.getDisplayId=function(C){if(z.isSome(this.aggregateStore)){const K=this.aggregateStore.getDisplayId(C);return z.isNone(K)?(C=this.featureStore.lookupDisplayId(C),this.aggregateStore.getDisplayIdForReferenceId(C)):K}return this.featureStore.lookupDisplayId(C)};t.getFeatures=function(C){const K=[],E=[];for(const I of C)C=z.isSome(this.aggregateStore)?
this.getAggregate(I):null,z.isSome(C)?z.isSome(C.attributes.referenceId)?(C=this.getFeature(C.attributes.referenceId),z.isSome(C)&&K.push(C)):E.push(C):(C=this.getFeature(I),z.isSome(C)&&K.push(C));return{features:K,aggregates:E}};t.getFeature=function(C){C=this.featureStore.lookupFeatureByDisplayId(C,this._storage);if(z.isNone(C))return null;var K=C.readHydratedGeometry();K=a.convertToGeometry(K,C.geometryType,C.hasZ,C.hasM);return{attributes:C.readAttributes(),geometry:K}};t.getAggregate=function(C){return z.isNone(this.aggregateStore)?
null:this.aggregateStore.getAggregate(C)};t.getAggregates=function(){return z.isNone(this.aggregateStore)?[]:this.aggregateStore.getAggregates()};t.setHighlight=async function(C){const K=z.filterNones(C.map(E=>this.getDisplayId(E)));return this.attributeStore.setHighlight(C,K)};t._lookupObjectIdByGlobalId=function(C){const K=this.service.globalIdField;if(z.isNone(K))throw Error("Expected globalIdField to be defined");let E=null;this.featureStore.forEach(I=>{C===I.readAttribute(K)&&(E=I.getObjectId())});
if(z.isNone(E))throw Error(`Expected to find a feature with globalId ${C}`);return E};t._repushCurrentLevelTiles=async function(){var C=this.tileStore.tiles.filter(K=>K.level===this._level);C.map(async K=>this._patchTile({type:"append",id:K.key.id,clear:!0,addOrUpdate:null,end:!1}));C=C.map(async K=>this._patchTile({type:"append",id:K.key.id,addOrUpdate:u.FeatureSetReaderJSON.fromOptimizedFeatures([],this.service),remove:[],end:!0,isRepush:!0,status:r.UpdateToken.empty()}));await Promise.all(C)};
t._maybeForceCleanup=function(){5E3<performance.now()-this._lastCleanup&&this._markAndSweep()};t._patchTile=function(C,K){C=this._updateQueue.push(C,K).catch(E=>{});return this.updatingHandles.addPromise(C)};t._onTileMessage=async function(C,K){y.throwIfAborted(K);if(F("esri-2d-update-debug")){var E=z.applySome(C.addOrUpdate,N=>N.hasFeatures);console.debug(C.id,`FeatureController:onTileMessage: [clear:${C.clear}, end:${C.end}, features: ${E}]`)}if(E=this.tileStore.get(C.id)){if(C.clear)return this.processor.onTileClear(E);
var I=C.status;this._cleanupNeeded=!0;var H=[];for(const N of C.remove??[]){const U=this.featureStore.lookupDisplayId(N);U&&H.push(U)}C.remove=H;try{if(z.isNone(C.addOrUpdate))this.processor.onTileMessage(E,{...C,addOrUpdate:null},z.isSome(this.aggregateStore),K).catch(y.throwIfNotAbortError);else{C.addOrUpdate.setArcadeSpatialReference(this.spatialReference);this.featureStore.hasInstance(C.addOrUpdate.instance)&&I.targets.feature||(I.targets.feature=!0,this.featureStore.onTileData(E,C));I.storage.data&&
I.storage.filters||(I.storage.data=!0,I.storage.filters=!0,this.attributeStore.onTileData(E,C),"stream"===this._source.type||this._didEdit?(await this.attributeStore.sendUpdates(),y.throwIfAborted(K)):this.attributeStore.sendUpdates());if(z.isSome(this.aggregateStore)&&!I.targets.aggregate){I.targets.aggregate=!0;const N=m(this._source)&&this._source.loading,U=!m(this._source)||N||C.end;this.aggregateStore.onTileData(E,C,this._storage,this.attributeStore,U);if(!U)return;I.mesh||(this.attributeStore.onTileData(E,
C),await this.attributeStore.sendUpdates())}if(!I.mesh){I.mesh=!0;const N=z.isSome(this.aggregateStore)&&"cluster"===this.aggregateStore.type;await this.processor.onTileMessage(E,C,N,K);y.throwIfAborted(K)}this._maybeForceCleanup()}}catch(N){y.throwIfNotAbortError(N)}}};t._mark=function(C,K,E){const I=this._storage.getInstanceId(C);C&&(K.add((4294901760&I)>>>16),E.set(C))};t._markAndSweep=function(){this._lastCleanup=performance.now();if(!("feature"===this._source.type&&"snapshot"===this._source.mode||
"stream"!==this._source.type&&!this._cleanupNeeded)){this._cleanupNeeded=!1;var C=this._storage.getBitset(this._markedIdsBufId),K=new Set;C.clear();for(const I of this.tileStore.tiles)for(const H of this._source.readers(I.id)){const N=H.getCursor();for(;N.next();){var E=N.getDisplayId();E||(E=N.getObjectId(),E=this.featureStore.lookupDisplayId(E));this._mark(E,K,C)}}"symbol"===this.processor.type&&this.processor.forEachBufferId(I=>{this._mark(I,K,C)});this._updateQueue.forEach(I=>{for(const H of I.remove??
[])I=this.featureStore.lookupDisplayId(H),this._mark(I,K,C)});z.isSome(this.aggregateStore)&&(this.aggregateStore.sweepFeatures(C,this.featureStore),"sweepAggregates"in this.aggregateStore&&this.aggregateStore.sweepAggregates(this._storage,this.attributeStore,this._level));this.featureStore.sweepFeatures(C,this._storage,this.attributeStore);this.featureStore.sweepFeatureSets(K)}};q._createClass(B,[{key:"fieldsIndex",get:function(){return new e(this.service.fields)}},{key:"spatialReference",get:function(){return this.tileStore.tileScheme.spatialReference}},
{key:"updating",get:function(){return this.isUpdating()}}]);return B}(G.HandleOwner);n.__decorate([x.property({constructOnly:!0})],G.prototype,"tileStore",void 0);n.__decorate([x.property()],G.prototype,"config",void 0);n.__decorate([x.property({readOnly:!0})],G.prototype,"fieldsIndex",null);n.__decorate([x.property()],G.prototype,"processor",void 0);n.__decorate([x.property({constructOnly:!0})],G.prototype,"remoteClient",void 0);n.__decorate([x.property({constructOnly:!0})],G.prototype,"service",
void 0);n.__decorate([x.property()],G.prototype,"spatialReference",null);n.__decorate([x.property()],G.prototype,"updating",null);return G=n.__decorate([b.subclass("esri.views.2d.layers.features.controllers.FeatureController2D")],G)})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),
function(q,n,G,F,z,y,D,x,k,g){function b(W,da){return W?da?4:3:da?3:2}function a(W,da,ha,ma){if(W){if(ha)return da&&ma?Q:oa;if(da&&ma)return M}else if(da&&ma)return oa;return ia}function h({scale:W,translate:da},ha){return Math.round((ha-da[0])/W[0])}function e({scale:W,translate:da},ha){return Math.round((da[1]-ha)/W[1])}function f({scale:W,translate:da},ha,ma){return ha*W[ma]+da[ma]}function c(W){W=W.coords;return{x:W[0],y:W[1]}}function d(W,da){W.coords[0]=da.x;W.coords[1]=da.y;return W}function p(W){W=
W.coords;return{x:W[0],y:W[1],z:W[2]}}function v(W,da){W.coords[0]=da.x;W.coords[1]=da.y;W.coords[2]=da.z;return W}function l(W){W=W.coords;return{x:W[0],y:W[1],m:W[2]}}function u(W,da){W.coords[0]=da.x;W.coords[1]=da.y;W.coords[2]=da.m;return W}function r(W){W=W.coords;return{x:W[0],y:W[1],z:W[2],m:W[3]}}function A(W,da){W.coords[0]=da.x;W.coords[1]=da.y;W.coords[2]=da.z;W.coords[3]=da.m;return W}function w(W,da){return W&&da?A:W?v:da?u:d}function m(W,da,ha,ma,qa){ha=w(ha,ma);for(const {geometry:wa,
attributes:ya}of da)da=F.isSome(wa)?ha(new g,wa):null,W.push(new x.OptimizedFeature(da,ya,null,qa?ya[qa]:void 0));return W}function t(W,da,ha,ma){for(const {geometry:qa,attributes:wa}of da)W.push({attributes:wa,geometry:F.isSome(qa)?B(qa,ha,ma):null});return W}function B(W,da,ha){if(F.isNone(W))return null;const ma=b(da,ha),qa=[];for(let wa=0;wa<W.coords.length;wa+=ma){const ya=[];for(let Ea=0;Ea<ma;Ea++)ya.push(W.coords[wa+Ea]);qa.push(ya)}return da?ha?{points:qa,hasZ:da,hasM:ha}:{points:qa,hasZ:da}:
ha?{points:qa,hasM:ha}:{points:qa}}function J(W,da,ha,ma,qa){ha=b(ha,ma);for(const {geometry:wa,attributes:ya}of da)da=F.isSome(wa)?C(new g,wa,ha):null,W.push(new x.OptimizedFeature(da,ya,null,qa?ya[qa]:void 0));return W}function C(W,da,ha=b(da.hasZ,da.hasM)){W.lengths[0]=da.points.length;const ma=W.coords;let qa=0;for(const wa of da.points)for(da=0;da<ha;da++)ma[qa++]=wa[da];return W}function K(W,da,ha){if(!W)return null;const ma=b(da,ha),{coords:qa,lengths:wa}=W;W=[];let ya=0;for(const Ea of wa){const Da=
[];for(let Ia=0;Ia<Ea;Ia++){const Ja=[];for(let La=0;La<ma;La++)Ja.push(qa[ya++]);Da.push(Ja)}W.push(Da)}return da?ha?{paths:W,hasZ:da,hasM:ha}:{paths:W,hasZ:da}:ha?{paths:W,hasM:ha}:{paths:W}}function E(W,da,ha,ma,qa){ha=b(ha,ma);for(const {geometry:wa,attributes:ya}of da)da=F.isSome(wa)?I(new g,wa,ha):null,W.push(new x.OptimizedFeature(da,ya,null,qa?ya[qa]:void 0));return W}function I(W,da,ha=b(da.hasZ,da.hasM)){const {lengths:ma,coords:qa}=W;let wa=0;for(const ya of da.paths){for(const Ea of ya)for(da=
0;da<ha;da++)qa[wa++]=Ea[da];ma.push(ya.length)}return W}function H(W,da,ha){if(!W)return null;const ma=b(da,ha),{coords:qa,lengths:wa}=W;W=[];let ya=0;for(const Ea of wa){const Da=[];for(let Ia=0;Ia<Ea;Ia++){const Ja=[];for(let La=0;La<ma;La++)Ja.push(qa[ya++]);Da.push(Ja)}W.push(Da)}return da?ha?{rings:W,hasZ:da,hasM:ha}:{rings:W,hasZ:da}:ha?{rings:W,hasM:ha}:{rings:W}}function N(W,da,ha,ma,qa){for(const {geometry:wa,centroid:ya,attributes:Ea}of da){da=F.isSome(wa)?U(new g,wa,ha,ma):null;const Da=
qa?Ea[qa]:void 0;F.isSome(ya)?W.push(new x.OptimizedFeature(da,Ea,d(new g,ya),Da)):W.push(new x.OptimizedFeature(da,Ea,null,Da))}return W}function U(W,da,ha=da.hasZ,ma=da.hasM){ba(W,da.rings,ha,ma);return W}function ba(W,da,ha,ma){ha=b(ha,ma);const {lengths:qa,coords:wa}=W;ma=0;ra(W);for(const ya of da){for(const Ea of ya)for(da=0;da<ha;da++)wa[ma++]=Ea[da];qa.push(ya.length)}return W}function la(W,da,ha,ma,qa,wa){Y(W);if(!ha){for(const ya of da)W.push(new x.OptimizedFeature(null,ya.attributes,null,
wa?ya.attributes[wa]:void 0));return W}switch(ha){case "esriGeometryPoint":return m(W,da,ma,qa,wa);case "esriGeometryMultipoint":return J(W,da,ma,qa,wa);case "esriGeometryPolyline":return E(W,da,ma,qa,wa);case "esriGeometryPolygon":return N(W,da,ma,qa,wa);default:ua.error("convertToFeatureSet:unknown-geometry",new n(`Unable to parse unknown geometry type '${ha}'`)),Y(W)}return W}function aa(W,da,ha,ma){W=W&&("coords"in W?W:W.geometry);if(F.isNone(W))return null;switch(da){case "esriGeometryPoint":return da=
c,ha&&ma?da=r:ha?da=p:ma&&(da=l),da(W);case "esriGeometryMultipoint":return B(W,ha,ma);case "esriGeometryPolyline":return K(W,ha,ma);case "esriGeometryPolygon":return H(W,ha,ma);default:return ua.error("convertToGeometry:unknown-geometry",new n(`Unable to parse unknown geometry type '${da}'`)),null}}function ka(W,da,ha,ma,qa){Y(W);if(F.isNone(ha)){for(const ya of da)W.push({attributes:ya.attributes});return W}switch(ha){case "esriGeometryPoint":ha=c;ma&&qa?ha=r:ma?ha=p:qa&&(ha=l);for(var wa of da){const {geometry:ya,
attributes:Ea}=wa;ma=F.isSome(ya)?ha(ya):null;W.push({attributes:Ea,geometry:ma})}break;case "esriGeometryMultipoint":return t(W,da,ma,qa);case "esriGeometryPolyline":for(const {geometry:ya,attributes:Ea}of da)W.push({attributes:Ea,geometry:F.isSome(ya)?K(ya,ma,qa):null});break;case "esriGeometryPolygon":for(const {geometry:ya,attributes:Ea,centroid:Da}of da)wa=F.isSome(ya)?H(ya,ma,qa):null,F.isSome(Da)?(da=c(Da),W.push({attributes:Ea,centroid:da,geometry:wa})):W.push({attributes:Ea,geometry:wa});
break;default:ua.error("convertToFeatureSet:unknown-geometry",new n(`Unable to parse unknown geometry type '${ha}'`))}return W}function V(W,da,ha,ma,qa,wa,ya=ha,Ea=ma){ra(W);if(F.isNone(da)||!da.coords.length)return null;qa=ca[qa];const {coords:Da,lengths:Ia}=da;da=b(ha,ma);const Ja=b(ha&&ya,ma&&Ea);ha=a(ha,ma,ya,Ea);if(!Ia.length)return ha(W.coords,Da,0,0,h(wa,Da[0]),e(wa,Da[1])),ra(W,da,0),W;let La,Ra=0,Pa,Sa=0;for(const Ta of Ia){if(Ta<qa)continue;let Qa=0;Pa=Sa;Ea=ma=h(wa,Da[Ra]);La=ya=e(wa,Da[Ra+
1]);ha(W.coords,Da,Pa,Ra,Ea,La);Qa++;Ra+=da;Pa+=Ja;for(let Ya=1;Ya<Ta;Ya++,Ra+=da)if(Ea=h(wa,Da[Ra]),La=e(wa,Da[Ra+1]),Ea!==ma||La!==ya)ha(W.coords,Da,Pa,Ra,Ea-ma,La-ya),Pa+=Ja,Qa++,ma=Ea,ya=La;Qa>=qa&&(W.lengths.push(Qa),Sa=Pa)}Y(W.coords,Sa);return W.coords.length?W:null}function P(W,da,ha,ma,qa,wa,ya){let Ea=ma,Da=0;for(let Ja=wa+ha;Ja<ya;Ja+=ha){var Ia=da[Ja];const La=da[Ja+1],Ra=da[ya],Pa=da[ya+1];let Sa=da[wa],Ta=da[wa+1],Qa=Ra-Sa,Ya=Pa-Ta;if(0!==Qa||0!==Ya){const Za=((Ia-Sa)*Qa+(La-Ta)*Ya)/
(Qa*Qa+Ya*Ya);1<Za?(Sa=Ra,Ta=Pa):0<Za&&(Sa+=Qa*Za,Ta+=Ya*Za)}Qa=Ia-Sa;Ya=La-Ta;Ia=Qa*Qa+Ya*Ya;Ia>Ea&&(Da=Ja,Ea=Ia)}Ea>ma&&(Da-wa>ha&&P(W,da,ha,ma,qa,wa,Da),qa(W,da,W.length,Da,da[Da],da[Da+1]),ya-Da>ha&&P(W,da,ha,ma,qa,Da,ya))}function S(W,da,ha,ma,qa){const {coords:wa,lengths:ya}=da;ha=b(ha,ma);if(!wa.length)return W!==da&&ra(W),W;F.assertIsSome(qa);const {originPosition:Ea,scale:Da,translate:Ia}=qa;qa=za;qa.originPosition=Ea;ma=qa.scale;ma[0]=Da[0]??1;ma[1]=-(Da[1]??1);ma[2]=Da[2]??1;ma[3]=Da[3]??
1;var Ja=qa.translate;Ja[0]=Ia[0]??0;Ja[1]=Ia[1]??0;Ja[2]=Ia[2]??0;Ja[3]=Ia[3]??0;if(!ya.length){for(ma=0;ma<ha;++ma)W.coords[ma]=f(qa,wa[ma],ma);W!==da&&ra(W,ha,0);return W}Ja=0;for(let Ra=0;Ra<ya.length;Ra++){const Pa=ya[Ra];W.lengths[Ra]=Pa;for(var La=0;La<ha;++La)W.coords[Ja+La]=f(qa,wa[Ja+La],La);La=W.coords[Ja];let Sa=W.coords[Ja+1];Ja+=ha;for(let Ta=1;Ta<Pa;Ta++,Ja+=ha){La+=wa[Ja]*ma[0];Sa+=wa[Ja+1]*ma[1];W.coords[Ja]=La;W.coords[Ja+1]=Sa;for(let Qa=2;Qa<ha;++Qa)W.coords[Ja+Qa]=f(qa,wa[Ja+
Qa],Qa)}}W!==da&&ra(W,wa.length,ya.length);return W}function X(W,da,ha,ma){let qa=0,wa=W[ma*da],ya=W[ma*(da+1)];for(let Ea=1;Ea<ha;Ea++){const Da=wa+W[ma*(da+Ea)],Ia=ya+W[ma*(da+Ea)+1],Ja=(Da-wa)*(Ia+ya);wa=Da;ya=Ia;qa+=Ja}return.5*qa}function ra(W,da=0,ha=0){Y(W.lengths,ha);Y(W.coords,da)}function Y(W,da=0){W.length!==da&&(W.length=da)}const ua=G.getLogger("esri.layers.graphics.featureConversionUtils"),ca={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},
ia=(W,da,ha,ma,qa,wa)=>{W[ha]=qa;W[ha+1]=wa},oa=(W,da,ha,ma,qa,wa)=>{W[ha]=qa;W[ha+1]=wa;W[ha+2]=da[ma+2]},M=(W,da,ha,ma,qa,wa)=>{W[ha]=qa;W[ha+1]=wa;W[ha+2]=da[ma+3]},Q=(W,da,ha,ma,qa,wa)=>{W[ha]=qa;W[ha+1]=wa;W[ha+2]=da[ma+2];W[ha+3]=da[ma+3]},fa=[],na=[],za={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};q.convertFromFeature=function(W,da,ha,ma,qa){fa[0]=W;[W]=la(na,fa,da,ha,ma,qa);Y(fa);Y(na);return W};q.convertFromFeatureSet=function(W,da){const ha=new k,{hasM:ma,hasZ:qa,features:wa,
objectIdFieldName:ya,spatialReference:Ea,geometryType:Da,exceededTransferLimit:Ia,transform:Ja,fields:La}=W;La&&(ha.fields=La);ha.geometryType=Da??null;ha.objectIdFieldName=ya??da??null;ha.spatialReference=Ea??null;if(!ha.objectIdFieldName)return ua.error(new n("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),ha;wa&&la(ha.features,wa,Da,qa,ma,ha.objectIdFieldName);Ia&&(ha.exceededTransferLimit=Ia);ma&&(ha.hasM=ma);qa&&(ha.hasZ=qa);Ja&&(ha.transform=Ja);return ha};q.convertFromFeatures=
la;q.convertFromGeometry=function(W,da,ha){if(F.isNone(W))return null;const ma=new g;"hasZ"in W&&null==da&&(da=W.hasZ);"hasM"in W&&null==ha&&(ha=W.hasM);if(D.isPoint(W))return w(null!=da?da:null!=W.z,null!=ha?ha:null!=W.m)(ma,W);if(D.isPolygon(W))return U(ma,W,da,ha);if(D.isPolyline(W))return I(ma,W,b(da,ha));if(D.isMultipoint(W))return C(ma,W,b(da,ha));ua.error("convertFromGeometry:unknown-geometry",new n(`Unable to parse unknown geometry type '${W}'`))};q.convertFromGraphics=function(W,da,ha,ma,
qa,wa){const ya=W.length;switch(ha){case "esriGeometryPoint":m(W,da,ma,qa,wa);break;case "esriGeometryMultipoint":J(W,da,ma,qa,wa);break;case "esriGeometryPolyline":E(W,da,ma,qa,wa);break;case "esriGeometryPolygon":N(W,da,ma,qa,wa);break;default:ua.error("convertToFeatureSet:unknown-geometry",new n(`Unable to parse unknown geometry type '${ha}'`))}for(ma=0;ma<da.length;ma++)W[ma+ya].geometryType=ha,W[ma+ya].insertAfter=da[ma].insertAfter,W[ma+ya].groupId=da[ma].groupId;return W};q.convertFromMultipoint=
C;q.convertFromMultipointFeatures=J;q.convertFromNestedArray=ba;q.convertFromPoint=function(W,da,ha=w(null!=da.z,null!=da.m)){return ha(W,da)};q.convertFromPointFeatures=m;q.convertFromPolygon=U;q.convertFromPolyline=I;q.convertFromPolylineFeatures=E;q.convertToFeature=function(W,da,ha,ma){na[0]=W;ka(fa,na,da,ha,ma);W=fa[0];Y(fa);Y(na);return W};q.convertToFeatureSet=function(W){const {objectIdFieldName:da,spatialReference:ha,transform:ma,fields:qa,hasM:wa,hasZ:ya,features:Ea,geometryType:Da,exceededTransferLimit:Ia,
uniqueIdField:Ja,queryGeometry:La,queryGeometryType:Ra}=W;W=ka([],Ea,Da,ya,wa);const Pa=aa(La,Ra,!1,!1);W={features:W,fields:qa,geometryType:Da,objectIdFieldName:da,spatialReference:ha,uniqueIdField:Ja,queryGeometry:Pa};ma&&(W.transform=ma);Ia&&(W.exceededTransferLimit=Ia);wa&&(W.hasM=wa);ya&&(W.hasZ=ya);return W};q.convertToFeatures=ka;q.convertToGeometry=aa;q.convertToMultipoint=B;q.convertToMultipointFeatures=t;q.convertToPoint=function(W,da,ha){return W?da?ha?r(W):p(W):ha?l(W):c(W):null};q.convertToPolygon=
H;q.convertToPolyline=K;q.deltaDecodeGeometry=function(W,da){if(F.isNone(W))return null;const ha=W.clone(),ma=W.coords;W=W.lengths;let qa=0;for(let Ea=0;Ea<W.length;Ea++){const Da=W[Ea];var wa=ma[da*qa],ya=ma[da*qa+1];for(let Ia=1;Ia<Da;Ia++)wa+=ma[da*(qa+Ia)],ya+=ma[da*(qa+Ia)+1],ha.coords[da*(qa+Ia)]=wa,ha.coords[da*(qa+Ia)+1]=ya;qa+=Da}return ha};q.deltaEncodeGeometry=function(W,da){const ha=W.clone(),ma=W.coords;W=W.lengths;let qa=0;for(let ya=0;ya<W.length;ya++){const Ea=W[ya];let Da=ma[da*qa];
var wa=ma[da*qa+1];for(let Ia=1;Ia<Ea;Ia++){const Ja=ma[da*(qa+Ia)],La=ma[da*(qa+Ia)+1];wa=La-wa;ha.coords[da*(qa+Ia)]=Ja-Da;ha.coords[da*(qa+Ia)+1]=wa;Da=Ja;wa=La}qa+=Ea}return ha};q.generalizeOptimizedGeometry=function(W,da,ha,ma,qa,wa,ya=ha,Ea=ma){ra(W);if(!da||!da.coords.length)return null;qa=ca[qa];const {coords:Da,lengths:Ia}=da;da=b(ha,ma);const Ja=b(ha&&ya,ma&&Ea);ha=a(ha,ma,ya,Ea);if(!Ia.length)return ha(W.coords,Da,0,0,Da[0],Da[1]),ra(W,da,0),W;ma=0;wa*=wa;for(const La of Ia){if(La<qa){ma+=
La*da;continue}ya=W.coords.length/Ja;Ea=ma;const Ra=ma+(La-1)*da;ha(W.coords,Da,W.coords.length,Ea,Da[Ea],Da[Ea+1]);P(W.coords,Da,da,wa,ha,Ea,Ra);ha(W.coords,Da,W.coords.length,Ra,Da[Ra],Da[Ra+1]);Ea=W.coords.length/Ja-ya;Ea>=qa?W.lengths.push(Ea):Y(W.coords,ya*Ja);ma+=La*da}return W.coords.length?W:null};q.getBoundsOptimizedGeometry=function(W,da,ha,ma){if(F.isNone(da)||!da.coords||!da.coords.length)return null;ha=b(ha,ma);let qa=ma=Number.POSITIVE_INFINITY,wa=Number.NEGATIVE_INFINITY,ya=Number.NEGATIVE_INFINITY;
if(da&&da.coords){da=da.coords;for(let Ea=0;Ea<da.length;Ea+=ha){const Da=da[Ea],Ia=da[Ea+1];ma=Math.min(ma,Da);wa=Math.max(wa,Da);qa=Math.min(qa,Ia);ya=Math.max(ya,Ia)}}z.is(W)?z.fromRectValues(W,ma,qa,wa,ya):y.fromValues(ma,qa,wa,ya,W);return W};q.getQuantizedArea=function(W,da){const {coords:ha,lengths:ma}=W;let qa=W=0;for(let wa=0;wa<ma.length;wa++){const ya=ma[wa];qa+=X(ha,W,ya,da);W+=ya}return Math.abs(qa)};q.getQuantizedBoundsOptimizedGeometry=function(W,da,ha,ma){ha=b(ha,ma);const {lengths:qa,
coords:wa}=da;ma=da=Number.POSITIVE_INFINITY;let ya=Number.NEGATIVE_INFINITY,Ea=Number.NEGATIVE_INFINITY,Da=0;for(const Ia of qa){let Ja=wa[Da],La=wa[Da+1];da=Math.min(Ja,da);ma=Math.min(La,ma);ya=Math.max(Ja,ya);Ea=Math.max(La,Ea);Da+=ha;for(let Ra=1;Ra<Ia;Ra++,Da+=ha){const Pa=wa[Da],Sa=wa[Da+1];Ja+=Pa;La+=Sa;0>Pa&&(da=Math.min(da,Ja));0<Pa&&(ya=Math.max(ya,Ja));0>Sa?ma=Math.min(ma,La):0<Sa&&(Ea=Math.max(Ea,La))}}W[0]=da;W[1]=ma;W[2]=ya;W[3]=Ea;return W};q.getSignedQuantizedRingArea=X;q.quantizeOptimizedFeatureSet=
function(W,da){const {geometryType:ha,features:ma,hasM:qa,hasZ:wa}=da;if(!W)return da;for(let ya=0;ya<ma.length;ya++){const Ea=ma[ya],Da=Ea.weakClone();Da.geometry=new g;V(Da.geometry,Ea.geometry,qa,wa,ha,W);Ea.centroid&&(Da.centroid=new g,V(Da.centroid,Ea.centroid,qa,wa,"esriGeometryPoint",W));ma[ya]=Da}da.transform=W;return da};q.quantizeOptimizedGeometry=V;q.quantizeX=h;q.quantizeY=e;q.removeCollinearVectices=function(W,da,ha,ma,qa){if(!da||!da.coords||!da.coords.length)return null;ha=ca[ha];const {coords:wa,
lengths:ya}=da;da=a(ma,qa,ma,qa);ma=b(ma,qa);let Ea=qa=0,Da=0,Ia=0;for(const Ra of ya){Ea=Ia;da(W.coords,wa,Ea,qa,wa[qa],wa[qa+1]);qa+=ma;var Ja=wa[qa];let Pa=wa[qa+1],Sa=Ja,Ta=Pa;var La=Pa/Ja;Ea+=ma;da(W.coords,wa,Ea,qa,Sa,Ta);qa+=ma;for(let Qa=2;Qa<Ra;Qa++){Ja=wa[qa];Pa=wa[qa+1];const Ya=Pa/Ja,Za=La===Ya||!isFinite(La)&&!isFinite(Ya);La=Za&&isFinite(Ya)?0<=La&&0<=Ya||0>=La&&0>=Ya:0<=Ta&&0<=Pa||0>=Ta&&0>=Pa;Za&&La?(Sa+=Ja,Ta+=Pa):(Sa=Ja,Ta=Pa,Ea+=ma);da(W.coords,wa,Ea,qa,Sa,Ta);qa+=ma;La=Ya}Ea+=
ma;Ja=(Ea-Ia)/ma;Ja>=ha&&(W.lengths[Da]=Ja,Ia=Ea,Da++)}W.coords.length>Ia&&(W.coords.length=Ia);W.lengths.length>Da&&(W.lengths.length=Da);return W.coords.length&&W.lengths.length?W:null};q.removeZMValues=function(W,da,ha,ma,qa,wa){ra(W);W.lengths.push(...da.lengths);if(ha===qa&&ma===wa)for(var ya=0;ya<da.coords.length;ya++)W.coords.push(da.coords[ya]);else for(ya=b(ha,ma),ha=a(ha,ma,qa,wa),da=da.coords,ma=0;ma<da.length;ma+=ya)ha(W.coords,da,W.coords.length,ma,da[ma],da[ma+1]);return W};q.unquantizeOptimizedFeatureSet=
function(W){const {transform:da,features:ha,hasM:ma,hasZ:qa}=W;if(!da)return W;for(const wa of ha)F.isSome(wa.geometry)&&S(wa.geometry,wa.geometry,ma,qa,da),F.isSome(wa.centroid)&&S(wa.centroid,wa.centroid,ma,qa,da);W.transform=null;return W};q.unquantizeOptimizedGeometry=S;q.unquantizeValue=f;q.unquantizeX=function(W,da){return f(W,da,0)};q.unquantizeY=function(W,da){return f(W,-da,1)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports",
"../../core/maybe","../Extent","./aaBoundingRect"],function(q,n,G,F){function z(c=e){return[c[0],c[1],c[2],c[3],c[4],c[5]]}function y(c,d,p,v,l,u,r=z()){r[0]=c;r[1]=d;r[2]=p;r[3]=v;r[4]=l;r[5]=u;return r}function D(c){return c[0]>=c[3]?0:c[3]-c[0]}function x(c){return c[1]>=c[4]?0:c[4]-c[1]}function k(c){return c[2]>=c[5]?0:c[5]-c[2]}function g(c,d){return Math.max(d[0],c[0])<=Math.min(d[3],c[3])&&Math.max(d[1],c[1])<=Math.min(d[4],c[4])&&Math.max(d[2],c[2])<=Math.min(d[5],c[5])}function b(c,d){c[0]=
d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];return c}function a(c){return 6===c.length}const h=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],e=[0,0,0,0,0,0],f=z();q.NEGATIVE_INFINITY=h;q.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];q.ZERO=e;q.allFinite=function(c){for(let d=0;6>d;d++)if(!isFinite(c[d]))return!1;return!0};q.center=function(c,d=[0,0,0]){d[0]=c[0]+D(c)/2;d[1]=c[1]+x(c)/2;d[2]=c[2]+k(c)/2;return d};q.contains=function(c,d){return d[0]>=
c[0]&&d[1]>=c[1]&&d[2]>=c[2]&&d[3]<=c[3]&&d[4]<=c[4]&&d[5]<=c[5]};q.containsPoint=function(c,d){return d[0]>=c[0]&&d[1]>=c[1]&&d[2]>=c[2]&&d[0]<=c[3]&&d[1]<=c[4]&&d[2]<=c[5]};q.containsPointWithMargin=function(c,d,p){return d[0]>=c[0]-p&&d[1]>=c[1]-p&&d[2]>=c[2]-p&&d[0]<=c[3]+p&&d[1]<=c[4]+p&&d[2]<=c[5]+p};q.create=z;q.depth=x;q.diameter=function(c){const d=D(c),p=k(c);c=x(c);return Math.sqrt(d*d+p*p+c*c)};q.empty=function(c){return c?b(c,h):z(h)};q.equals=function(c,d,p){if(n.isNone(c)||n.isNone(d))return c===
d;if(!a(c)||!a(d))return!1;if(p)for(let v=0;v<c.length;v++){if(!p(c[v],d[v]))return!1}else for(p=0;p<c.length;p++)if(c[p]!==d[p])return!1;return!0};q.expandWithAABB=function(c,d){c[0]=Math.min(c[0],d[0]);c[1]=Math.min(c[1],d[1]);c[2]=Math.min(c[2],d[2]);c[3]=Math.max(c[3],d[3]);c[4]=Math.max(c[4],d[4]);c[5]=Math.max(c[5],d[5])};q.expandWithBuffer=function(c,d,p=0,v=d.length/3){let l=c[0],u=c[1],r=c[2],A=c[3],w=c[4],m=c[5];for(let t=0;t<v;t++)l=Math.min(l,d[p+3*t]),u=Math.min(u,d[p+3*t+1]),r=Math.min(r,
d[p+3*t+2]),A=Math.max(A,d[p+3*t]),w=Math.max(w,d[p+3*t+1]),m=Math.max(m,d[p+3*t+2]);c[0]=l;c[1]=u;c[2]=r;c[3]=A;c[4]=w;c[5]=m};q.expandWithNestedArray=function(c,d,p){const v=d.length;let l=c[0],u=c[1],r=c[2],A=c[3],w=c[4],m=c[5];if(p)for(p=0;p<v;p++){var t=d[p];l=Math.min(l,t[0]);u=Math.min(u,t[1]);r=Math.min(r,t[2]);A=Math.max(A,t[0]);w=Math.max(w,t[1]);m=Math.max(m,t[2])}else for(p=0;p<v;p++)t=d[p],l=Math.min(l,t[0]),u=Math.min(u,t[1]),A=Math.max(A,t[0]),w=Math.max(w,t[1]);c[0]=l;c[1]=u;c[2]=
r;c[3]=A;c[4]=w;c[5]=m};q.expandWithOffset=function(c,d,p,v){c[0]=Math.min(c[0],c[0]+d);c[3]=Math.max(c[3],c[3]+d);c[1]=Math.min(c[1],c[1]+p);c[4]=Math.max(c[4],c[4]+p);c[2]=Math.min(c[2],c[2]+v);c[5]=Math.max(c[5],c[5]+v)};q.expandWithRect=function(c,d){c[0]=Math.min(c[0],d[0]);c[1]=Math.min(c[1],d[1]);c[3]=Math.max(c[3],d[2]);c[4]=Math.max(c[4],d[3])};q.expandWithVec3=function(c,d){c[0]=Math.min(c[0],d[0]);c[1]=Math.min(c[1],d[1]);c[2]=Math.min(c[2],d[2]);c[3]=Math.max(c[3],d[0]);c[4]=Math.max(c[4],
d[1]);c[5]=Math.max(c[5],d[2])};q.fromExtent=function(c,d=z()){d[0]=c.xmin;d[1]=c.ymin;d[2]=c.hasZ?c.zmin:-Infinity;d[3]=c.xmax;d[4]=c.ymax;d[5]=c.hasZ?c.zmax:Infinity;return d};q.fromMinMax=function(c,d,p=z()){p[0]=c[0];p[1]=c[1];p[2]=c[2];p[3]=d[0];p[4]=d[1];p[5]=d[2];return p};q.fromRect=function(c,d){c[0]=d[0];c[1]=d[1];c[2]=Number.NEGATIVE_INFINITY;c[3]=d[2];c[4]=d[3];c[5]=Number.POSITIVE_INFINITY;return c};q.fromRectValues=function(c,d,p,v,l){c[0]=d;c[1]=p;c[2]=Number.NEGATIVE_INFINITY;c[3]=
v;c[4]=l;c[5]=Number.POSITIVE_INFINITY;return c};q.fromValues=y;q.getMax=function(c,d){d[0]=c[3];d[1]=c[4];d[2]=c[5];return d};q.getMin=function(c,d){d[0]=c[0];d[1]=c[1];d[2]=c[2];return d};q.height=k;q.intersects=g;q.intersectsClippingArea=function(c,d){return n.isNone(d)?!0:g(c,d)};q.is=a;q.isPoint=function(c){return 0===D(c)&&0===x(c)&&0===k(c)};q.maximumDimension=function(c){return Math.max(D(c),k(c),x(c))};q.offset=function(c,d,p,v,l=c){l[0]=c[0]+d;l[1]=c[1]+p;l[2]=c[2]+v;l[3]=c[3]+d;l[4]=c[4]+
p;l[5]=c[5]+v;return l};q.scale=function(c,d,p=c){const v=c[0]+D(c)/2,l=c[1]+x(c)/2,u=c[2]+k(c)/2;p[0]=v+(c[0]-v)*d;p[1]=l+(c[1]-l)*d;p[2]=u+(c[2]-u)*d;p[3]=v+(c[3]-v)*d;p[4]=l+(c[4]-l)*d;p[5]=u+(c[5]-u)*d;return p};q.set=b;q.setMax=function(c,d,p=c){p[3]=d[0];p[4]=d[1];p[5]=d[2];p!==c&&(p[0]=c[0],p[1]=c[1],p[2]=c[2]);return c};q.setMin=function(c,d,p=c){p[0]=d[0];p[1]=d[1];p[2]=d[2];p!==c&&(p[3]=c[3],p[4]=c[4],p[5]=c[5]);return p};q.size=function(c,d=[0,0,0]){d[0]=D(c);d[1]=x(c);d[2]=k(c);return d};
q.toExtent=function(c,d){return isFinite(c[2])||isFinite(c[5])?new G({xmin:c[0],xmax:c[3],ymin:c[1],ymax:c[4],zmin:c[2],zmax:c[5],spatialReference:d}):new G({xmin:c[0],xmax:c[3],ymin:c[1],ymax:c[4],spatialReference:d})};q.toRect=function(c,d){d||(d=F.create());d[0]=c[0];d[1]=c[1];d[2]=c[3];d[3]=c[4];return d};q.width=D;q.wrap=function(c,d,p,v,l,u){return y(c,d,p,v,l,u,f)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","../../core/maybe"],function(q,n,G){let F=function(){function y(D=null,x={},k,g){this.geometry=D;this.attributes=x;this.centroid=k;this.objectId=g;this.geohashY=this.geohashX=this.displayId=0}y.prototype.weakClone=function(){const D=new y(this.geometry,this.attributes,this.centroid,this.objectId);D.displayId=this.displayId;D.geohashX=this.geohashX;D.geohashY=this.geohashY;return D};return n._createClass(y)}(),z=function(y){function D(){return x.apply(this,
arguments)}n._inherits(D,y);var x=n._createSuper(D);return n._createClass(D)}(F);q.OptimizedFeature=F;q.OptimizedFeatureWithGeometry=z;q.hasGeometry=function(y){return!(G.isNone(y.geometry)||!y.geometry.coords||!y.geometry.coords.length)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function n(){this.spatialReference=this.geometryType=this.geometryProperties=
this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}n.prototype.weakClone=function(){const G=new n;G.objectIdFieldName=this.objectIdFieldName;G.globalIdFieldName=this.globalIdFieldName;G.geohashFieldName=this.geohashFieldName;G.geometryProperties=this.geometryProperties;G.geometryType=this.geometryType;G.spatialReference=
this.spatialReference;G.hasZ=this.hasZ;G.hasM=this.hasM;G.features=this.features;G.fields=this.fields;G.transform=this.transform;G.exceededTransferLimit=this.exceededTransferLimit;G.uniqueIdField=this.uniqueIdField;G.queryGeometry=this.queryGeometry;G.queryGeometryType=this.queryGeometryType;return G};return q._createClass(n)}()})},"esri/layers/graphics/OptimizedGeometry":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function n(F=[],z=[],y=!1){this.lengths=
F??[];this.coords=z??[];this.hasIndeterminateRingOrder=y}n.fromRect=function(F){const [z,y,D,x]=F;F=D-z;const k=x-y;return new n([5],[z,y,F,0,0,k,-F,0,0,-k])};var G=n.prototype;G.forEachVertex=function(F){let z=0;this.lengths.length||F(this.coords[0],this.coords[1]);for(let y=0;y<this.lengths.length;y++){const D=this.lengths[y];for(let x=0;x<D;x++)F(this.coords[2*(x+z)],this.coords[2*(x+z)+1]);z+=D}};G.clone=function(F){return F?(F.set(this.coords),new n(this.lengths.slice(),F,this.hasIndeterminateRingOrder)):
new n(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)};q._createClass(n,[{key:"isPoint",get:function(){return 0===this.lengths.length}},{key:"maxLength",get:function(){return Math.max(...this.lengths)}},{key:"size",get:function(){return this.lengths.reduce((F,z)=>F+z)}}]);return n}()})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/arrayUtils ../../../core/Error ../../../core/lang ../../../core/maybe ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../../support/arcadeOnDemand ../../../views/support/Scheduler".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r,A,w,m,t){function B(I){return null!=I&&I.every(H=>"exceedslimit"!==H.statisticType)}let J=n._createClass(function(I,H=null,N,U,ba){this.attributes=I;this.geometry=N;this.centroid=U;this.filterFlags=ba;this.groupId=-1;this.displayId=H});const C=new D.MemCacheStorage(2E6);let K=0,E=function(){function I(N){this._changeHandle=this._geometryQueryCache=null;this.capabilities={query:v.queryCapabilities};this.geometryType=N.geometryType;this.hasM=!!N.hasM;
this.hasZ=!!N.hasZ;this.objectIdField=N.objectIdField;this.spatialReference=N.spatialReference;this.definitionExpression=N.definitionExpression;this.featureStore=N.featureStore;this.aggregateAdapter=N.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache());this.timeInfo=N.timeInfo;N.cacheSpatialQueries&&(this._geometryQueryCache=new D.MemCache(K++ +"$$",C));this.fieldsIndex=new w(N.fields);N.scheduler&&N.priority&&(this._frameTask=N.scheduler.registerTask(N.priority))}
var H=I.prototype;H.destroy=function(){this._frameTask=y.removeMaybe(this._frameTask);this.clearCache();y.destroyMaybe(this._geometryQueryCache);this._changeHandle=y.removeMaybe(this._changeHandle);y.destroyMaybe(this.fieldsIndex)};H.clearCache=function(){this._geometryQueryCache?.clear();this._timeExtentPromise=this._allFeaturesPromise=null};H.executeQuery=async function(N,U){try{return(await this._executeQuery(N,{},U)).createQueryResponse()}catch(ba){if(ba!==A.QUERY_ENGINE_EMPTY_RESULT)throw ba;
return(new l.QueryEngineResult([],N,this)).createQueryResponse()}};H.executeQueryForCount=async function(N={},U){try{return(await this._executeQuery(N,{returnGeometry:!1,returnCentroid:!1,outSR:null},U)).createQueryResponseForCount()}catch(ba){if(ba!==A.QUERY_ENGINE_EMPTY_RESULT)throw ba;return 0}};H.executeQueryForExtent=async function(N,U){const ba=N.outSR;try{const la=await this._executeQuery(N,{returnGeometry:!0,returnCentroid:!1,outSR:null},U),aa=la.size;if(!aa)return{count:0,extent:null};const ka=
await this._getBounds(la.items,la.spatialReference,ba||this.spatialReference);return{count:aa,extent:ka}}catch(la){if(la===A.QUERY_ENGINE_EMPTY_RESULT)return{count:0,extent:null};throw la;}};H.executeQueryForIds=async function(N,U){return this.executeQueryForIdSet(N,U).then(ba=>Array.from(ba))};H.executeQueryForIdSet=async function(N,U){try{const ba=await this._executeQuery(N,{returnGeometry:!0,returnCentroid:!1,outSR:null},U),la=ba.items,aa=new Set;await this._reschedule(()=>{for(const ka of la)aa.add(ba.featureAdapter.getObjectId(ka))},
U);return aa}catch(ba){if(ba===A.QUERY_ENGINE_EMPTY_RESULT)return new Set;throw ba;}};H.executeQueryForSnapping=async function(N,U){const {point:ba,distance:la,types:aa}=N;if(aa===l.SnappingTypes.NONE)return{candidates:[]};const ka=await this._reschedule(()=>this._checkQuerySupport(N.query),U),V=!f.equals(ba.spatialReference,this.spatialReference);V&&await p.checkProjectionSupport(ba.spatialReference,this.spatialReference);var P="number"===typeof la?la:la.x,S="number"===typeof la?la:la.y;P={xmin:ba.x-
P,xmax:ba.x+P,ymin:ba.y-S,ymax:ba.y+S,spatialReference:ba.spatialReference};P=V?p.project(P,this.spatialReference):P;if(!P)return{candidates:[]};S=(await e.normalizeCentralMeridian(h.fromJSON(ba),null,{signal:U}))[0];const X=(await e.normalizeCentralMeridian(h.fromJSON(P),null,{signal:U}))[0];if(y.isNone(S)||y.isNone(X))return{candidates:[]};const ra=new l.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(X.toJSON())),U),ka,this);await this._reschedule(()=>this._executeObjectIdsQuery(ra),
U);await this._reschedule(()=>this._executeTimeQuery(ra),U);await this._reschedule(()=>this._executeAttributesQuery(ra),U);U=S.toJSON();U=V?p.project(U,this.spatialReference):U;return ra.createSnappingResponse({...N,point:U,distance:V?Math.max(P.xmax-P.xmin,P.ymax-P.ymin)/2:la},ba.spatialReference)};H.executeQueryForLatestObservations=async function(N,U){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new F("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:N,
timeInfo:this.timeInfo});try{const ba=await this._executeQuery(N,{},U);await this._reschedule(()=>this._filterLatest(ba),U);return ba.createQueryResponse()}catch(ba){if(ba!==A.QUERY_ENGINE_EMPTY_RESULT)throw ba;return(new l.QueryEngineResult([],N,this)).createQueryResponse()}};H.executeQueryForSummaryStatistics=async function(N={},U,ba){const {field:la,normalizationField:aa,valueExpression:ka}=U;return(await this._getQueryEngineResultForStats(N,{field:la,normalizationField:aa,valueExpression:ka},
ba)).createSummaryStatisticsResponse(U)};H.executeQueryForUniqueValues=async function(N={},U,ba){const {field:la,field2:aa,field3:ka,valueExpression:V}=U;return(await this._getQueryEngineResultForStats(N,{field:la,field2:aa,field3:ka,valueExpression:V},ba)).createUniqueValuesResponse(U)};H.executeQueryForClassBreaks=async function(N={},U,ba){const {field:la,normalizationField:aa,valueExpression:ka}=U;return(await this._getQueryEngineResultForStats(N,{field:la,normalizationField:aa,valueExpression:ka},
ba)).createClassBreaksResponse(U)};H.executeQueryForHistogram=async function(N={},U,ba){const {field:la,normalizationField:aa,valueExpression:ka}=U;return(await this._getQueryEngineResultForStats(N,{field:la,normalizationField:aa,valueExpression:ka},ba)).createHistogramResponse(U)};H.fetchRecomputedExtents=async function(N){const [U,ba]=await Promise.all(["getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getBounds(await this._getAllFeatures(),
this.spatialReference,this.spatialReference),y.isSome(this._timeExtentPromise)?this._timeExtentPromise:this._timeExtentPromise=r.getTimeExtent(this.timeInfo,this.featureStore)]);x.throwIfAborted(N);return{fullExtent:U,timeExtent:ba}};H._getBounds=async function(N,U,ba){const la=g.set(g.create(),g.NEGATIVE_INFINITY);await this.featureStore.forEachBounds(N,aa=>g.expandWithAABB(la,aa));N={xmin:la[0],ymin:la[1],xmax:la[3],ymax:la[4],spatialReference:A.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&
isFinite(la[2])&&isFinite(la[5])&&(N.zmin=la[2],N.zmax=la[5]);U=p.project(N,U,ba);U.spatialReference=A.cleanFromGeometryEngine(ba);0===U.xmax-U.xmin&&(ba=k.getMetersPerUnitForSR(U.spatialReference),U.xmin-=ba,U.xmax+=ba);0===U.ymax-U.ymin&&(ba=k.getMetersPerUnitForSR(U.spatialReference),U.ymin-=ba,U.ymax+=ba);this.hasZ&&null!=U.zmin&&null!=U.zmax&&0===U.zmax-U.zmin&&(ba=k.getMetersPerUnitForSR(U.spatialReference),U.zmin-=ba,U.zmax+=ba);return U};H._schedule=async function(N,U){return y.isSome(this._frameTask)?
this._frameTask.schedule(N,U):N(t.noBudget)};H._reschedule=async function(N,U){return y.isSome(this._frameTask)?this._frameTask.reschedule(N,U):N(t.noBudget)};H._getAllFeaturesQueryEngineResult=async function(N){return new l.QueryEngineResult(await this._getAllFeatures(),N,this)};H._getAllFeatures=async function(){if(y.isNone(this._allFeaturesPromise)){const ba=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(la=>ba.push(la))})().then(()=>ba)}const N=this._allFeaturesPromise,
U=await N;return N===this._allFeaturesPromise?U.slice():this._getAllFeatures()};H._executeQuery=async function(N,U,ba){N=z.clone(N);N=await this._schedule(()=>A.normalizeQuery(N,this.definitionExpression,this.spatialReference),ba);N=await this._reschedule(()=>this._checkQuerySupport(N),ba);N={...N,...U};const la=await this._reschedule(()=>this._executeSceneFilterQuery(N,ba),ba),aa=await this._reschedule(()=>this._executeGeometryQuery(N,la,ba),ba);await this._reschedule(()=>this._executeAggregateIdsQuery(aa),
ba);await this._reschedule(()=>this._executeObjectIdsQuery(aa),ba);await this._reschedule(()=>this._executeTimeQuery(aa),ba);await this._reschedule(()=>this._executeAttributesQuery(aa),ba);return aa};H._executeSceneFilterQuery=async function(N,U){if(y.isNone(N.sceneFilter))return null;const {outSR:ba,returnGeometry:la,returnCentroid:aa}=N;var ka=this.featureStore.featureSpatialReference,V=N.sceneFilter.geometry;const P=y.isNone(ka)||f.equals(ka,V.spatialReference)?V:p.project(V,ka);if(!P)return null;
ka=la||aa;ka=f.isValid(ba)&&!f.equals(this.spatialReference,ba)&&ka?async Y=>this._project(Y,ba):Y=>Y;const S=this.featureAdapter;V=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(P)),U);if("disjoint"===N.sceneFilter.spatialRelationship){if(!V.length)return null;const Y=new Set;for(var X of V)Y.add(S.getObjectId(X));const ua=await this._reschedule(()=>this._getAllFeatures(),U);X=await this._reschedule(async()=>{const ca=await u.getSpatialQueryOperator("esriSpatialRelDisjoint",
P,this.geometryType,this.hasZ,this.hasM),ia=await this._runSpatialFilter(ua,oa=>!Y.has(S.getObjectId(oa))||ca(S.getGeometry(oa)),U);return new l.QueryEngineResult(ia,N,this)},U);return ka(X)}if(!V.length)return new l.QueryEngineResult([],N,this);if(this._canExecuteSinglePass(P,N))return ka(new l.QueryEngineResult(V,N,this));const ra=await u.getSpatialQueryOperator("esriSpatialRelContains",P,this.geometryType,this.hasZ,this.hasM);X=await this._runSpatialFilter(V,Y=>ra(S.getGeometry(Y)),U);return ka(new l.QueryEngineResult(X,
N,this))};H._executeGeometryQuery=async function(N,U,ba){if(y.isSome(U)&&0===U.items.length)return U;N=y.isSome(U)?U.query:N;const {geometry:la,outSR:aa,spatialRel:ka,returnGeometry:V,returnCentroid:P}=N;var S=this.featureStore.featureSpatialReference;const X=!la||y.isNone(S)||f.equals(S,la.spatialReference)?la:p.project(la,S),ra=V||P,Y=f.isValid(aa)&&!f.equals(this.spatialReference,aa),ua=this._geometryQueryCache&&y.isNone(U)?Y&&ra?JSON.stringify({originalFilterGeometry:la,spatialRelationship:ka,
outSpatialReference:aa}):JSON.stringify({originalFilterGeometry:la,spatialRelationship:ka}):null;S=ua?this._geometryQueryCache.get(ua):null;if(y.isSome(S))return new l.QueryEngineResult(S,N,this);S=async Q=>{Y&&ra&&await this._project(Q,aa);ua&&this._geometryQueryCache.put(ua,Q.items,Q.items.length+1);return Q};if(!X)return S(y.isSome(U)?U:await this._getAllFeaturesQueryEngineResult(N));const ca=this.featureAdapter;let ia=await this._reschedule(()=>this._searchFeatures(this._getQueryBBoxes(la)),ba);
if("esriSpatialRelDisjoint"===ka){if(!ia.length)return S(y.isSome(U)?U:await this._getAllFeaturesQueryEngineResult(N));const Q=new Set;for(var oa of ia)Q.add(ca.getObjectId(oa));const fa=y.isSome(U)?U.items:await this._reschedule(()=>this._getAllFeatures(),ba);oa=await this._reschedule(async()=>{const na=await u.getSpatialQueryOperator(ka,X,this.geometryType,this.hasZ,this.hasM),za=await this._runSpatialFilter(fa,W=>!Q.has(ca.getObjectId(W))||na(ca.getGeometry(W)),ba);return new l.QueryEngineResult(za,
N,this)},ba);return S(oa)}if(y.isSome(U)){const Q=new G.PositionHint;ia=ia.filter(fa=>0<=G.indexOf(U.items,fa,U.items.length,Q))}if(!ia.length)return S=new l.QueryEngineResult([],N,this),ua&&this._geometryQueryCache.put(ua,S.items,1),S;if(this._canExecuteSinglePass(X,N))return S(new l.QueryEngineResult(ia,N,this));const M=await u.getSpatialQueryOperator(ka,X,this.geometryType,this.hasZ,this.hasM);oa=await this._runSpatialFilter(ia,Q=>M(ca.getGeometry(Q)),ba);return S(new l.QueryEngineResult(oa,N,
this))};H._executeAggregateIdsQuery=function(N){if(0!==N.items.length&&N.query.aggregateIds&&N.query.aggregateIds.length&&!y.isNone(this.aggregateAdapter)){var U=new Set;for(const la of N.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(la).forEach(aa=>U.add(aa));var ba=this.featureAdapter.getObjectId;N.items=N.items.filter(la=>U.has(ba(la)))}};H._executeObjectIdsQuery=function(N){if(0!==N.items.length&&N.query.objectIds&&N.query.objectIds.length){var U=new Set(N.query.objectIds),ba=this.featureAdapter.getObjectId;
N.items=N.items.filter(la=>U.has(ba(la)))}};H._executeTimeQuery=function(N){if(0!==N.items.length){var U=r.getTimeOperator(this.timeInfo,N.query.timeExtent,this.featureAdapter);y.isNone(U)||(N.items=N.items.filter(U))}};H._executeAttributesQuery=function(N){if(0!==N.items.length){var U=d.getWhereClause(N.query.where,this.fieldsIndex);if(U){if(!U.isStandardized)throw new TypeError("Where clause is not standardized");N.items=N.items.filter(ba=>U.testFeature(ba,this.featureAdapter))}}};H._runSpatialFilter=
async function(N,U,ba){if(!U)return N;if(y.isNone(this._frameTask))return N.filter(V=>U(V));let la=0;const aa=[],ka=async V=>{for(;la<N.length;){const P=N[la++];U(P)&&(aa.push(P),V.madeProgress());V.done&&await this._reschedule(S=>ka(S),ba)}};return this._reschedule(V=>ka(V),ba).then(()=>aa)};H._filterLatest=function(N){const {trackIdField:U,startTimeField:ba,endTimeField:la}=this.timeInfo,aa=la||ba,ka=new Map,V=this.featureAdapter.getAttribute;for(const P of N.items){const S=V(P,U),X=V(P,aa),ra=
ka.get(S);(!ra||X>V(ra,aa))&&ka.set(S,P)}N.items=Array.from(ka.values())};H._canExecuteSinglePass=function(N,U){({spatialRel:U}=U);return u.canQueryWithRBush(N)&&("esriSpatialRelEnvelopeIntersects"===U||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===U||"esriSpatialRelContains"===U||"esriSpatialRelWithin"===U))};H._project=async function(N,U){if(!U||f.equals(this.spatialReference,U))return N;const ba=this.featureAdapter;U=await p.projectMany(N.items.map(la=>A.getGeometry(this.geometryType,
this.hasZ,this.hasM,ba.getGeometry(la))),this.spatialReference,U);N.items=U.map((la,aa)=>ba.cloneWithGeometry(N.items[aa],c.convertFromGeometry(la,this.hasZ,this.hasM)));return N};H._getQueryBBoxes=function(N){if(u.canQueryWithRBush(N)){if(h.isExtent(N))return[b.fromValues(N.xmin,N.ymin,N.xmax,N.ymax)];if(h.isPolygon(N))return N.rings.map(U=>b.fromValues(Math.min(U[0][0],U[2][0]),Math.min(U[0][1],U[2][1]),Math.max(U[0][0],U[2][0]),Math.max(U[0][1],U[2][1])))}return[a.getBoundsXY(b.create(),N)]};H._searchFeatures=
async function(N){const U=new Set;await Promise.all(N.map(ba=>this.featureStore.forEachInBounds(ba,la=>U.add(la))));N=Array.from(U.values());U.clear();return N};H._checkStatisticsSupport=async function(N,U){if(0>(N.distance??0)||null!=N.geometryPrecision||N.multipatchOption||N.pixelSize||N.relationParam||N.text||N.outStatistics||N.groupByFieldsForStatistics||N.having||N.orderByFields)throw new F("feature-store:unsupported-query","Unsupported query options",{query:N});this._checkAttributesQuerySupport(N);
return Promise.all([this._checkStatisticsParamsSupport(U),u.checkSpatialQuerySupport(N,this.geometryType,this.spatialReference),p.checkProjectionSupport(this.spatialReference,N.outSR)]).then(()=>N)};H._checkStatisticsParamsSupport=async function(N){var U=[];N.valueExpression&&({arcadeUtils:U}=await m.loadArcade(),U=U.extractFieldNames(N.valueExpression));N.field&&U.push(N.field);N.field2&&U.push(N.field2);N.field3&&U.push(N.field3);N.normalizationField&&U.push(N.normalizationField);if(!U.length)throw new F("feature-store:unsupported-query",
"params should have at least a field or valueExpression",{params:N});d.validateFields(this.fieldsIndex,U,"params contains missing fields")};H._checkQuerySupport=async function(N){if(0>(N.distance??0)||null!=N.geometryPrecision||N.multipatchOption||N.pixelSize||N.relationParam||N.text)throw new F("feature-store:unsupported-query","Unsupported query options",{query:N});this._checkAttributesQuerySupport(N);this._checkStatisticsQuerySupport(N);return Promise.all([u.checkSpatialQuerySupport(N,this.geometryType,
this.spatialReference),p.checkProjectionSupport(this.spatialReference,N.outSR)]).then(()=>N)};H._checkAttributesQuerySupport=function(N){const {outFields:U,orderByFields:ba,returnDistinctValues:la,outStatistics:aa}=N,ka=aa?aa.map(V=>V.outStatisticFieldName&&V.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(ba&&0<ba.length){const V=ba.map(P=>{const S=P.toLowerCase();return S.includes(" asc")?S.split(" asc")[0]:S.includes(" desc")?S.split(" desc")[0]:P}).filter(P=>!ka.includes(P));d.validateFields(this.fieldsIndex,
V,"orderByFields contains missing fields")}if(U&&0<U.length)d.validateFields(this.fieldsIndex,U,"outFields contains missing fields");else if(la)throw new F("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:N});d.validateWhere(this.fieldsIndex,N.where)};H._checkStatisticsQuerySupport=function(N){const {outStatistics:U,groupByFieldsForStatistics:ba,having:la}=N;var aa=ba&&ba.length,ka=U&&U.length;if(la){if(!aa||!ka)throw new F("feature-store:unsupported-query",
"outStatistics and groupByFieldsForStatistics should be specified with having",{query:N});d.validateHaving(this.fieldsIndex,la,U)}if(ka&&B(U)){ka=U.map(V=>V.onStatisticField).filter(Boolean);d.validateFields(this.fieldsIndex,ka,"onStatisticFields contains missing fields");aa&&d.validateFields(this.fieldsIndex,ba,"groupByFieldsForStatistics contains missing fields");for(const V of U){const {onStatisticField:P,statisticType:S}=V;if(("percentile_disc"===S||"percentile_cont"===S)&&"statisticParameters"in
V){if({statisticParameters:aa}=V,!aa)throw new F("feature-store:unsupported-query","statisticParamters should be set for percentile type",{definition:V,query:N});}else if("count"!==S&&P&&d.hasInvalidFieldType(P,this.fieldsIndex))throw new F("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:V,query:N});}}};H._getQueryEngineResultForStats=async function(N,U,ba){N=z.clone(N);try{N=await this._schedule(()=>A.normalizeQuery(N,this.definitionExpression,this.spatialReference),
ba);N=await this._reschedule(()=>this._checkStatisticsSupport(N,U),ba);const la=await this._reschedule(()=>this._executeSceneFilterQuery(N,ba),ba),aa=await this._reschedule(()=>this._executeGeometryQuery(N,la,ba),ba);await this._reschedule(()=>this._executeAggregateIdsQuery(aa),ba);await this._reschedule(()=>this._executeObjectIdsQuery(aa),ba);await this._reschedule(()=>this._executeTimeQuery(aa),ba);await this._reschedule(()=>this._executeAttributesQuery(aa),ba);return aa}catch(la){if(la!==A.QUERY_ENGINE_EMPTY_RESULT)throw la;
return new l.QueryEngineResult([],N,this)}};n._createClass(I,[{key:"featureAdapter",get:function(){return this.featureStore.featureAdapter}}]);return I}();q.Feature=J;q.QueryEngine=E;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./maybe","./PooledArray"],function(q,n,G,F){q.RemoveMode=void 0;(function(D){D[D.ALL=0]="ALL";D[D.SOME=1]="SOME"})(q.RemoveMode||(q.RemoveMode={}));let z=function(){function D(k,
g,b){this._namespace=k;this._storage=g;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";b&&(this._storage.registerRemoveFunc(this._namespace,b),this._removeFunc=!0)}var x=D.prototype;x.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this);this._storage=null};x.resetHitRate=function(){this._hit=this._miss=0};x.put=function(k,g,b,a=0){this._storage.put(this._namespace+
k,g,b,a)};x.get=function(k){k=this._storage.get(this._namespace+k);void 0===k?++this._miss:++this._hit;return k};x.pop=function(k){k=this._storage.pop(this._namespace+k);void 0===k?++this._miss:++this._hit;return k};x.updateSize=function(k,g,b){this._storage.updateSize(this._namespace+k,g,b)};x.clear=function(){this._storage.clear(this._namespace)};x.clearAll=function(){this._storage.clearAll()};x.getStats=function(){return this._storage.getStats()};x.resetStats=function(){this._storage.resetStats()};
n._createClass(D,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}}]);return D}(),y=function(){function D(k=10485760){this._maxSize=k;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new F;this._users=new F}var x=D.prototype;x.destroy=function(){this.clearAll();this._removeFuncs.clear();
this._users.clear();this._db=null};x.register=function(k){this._users.push(k)};x.deregister=function(k){this._users.removeUnordered(k)};x.registerRemoveFunc=function(k,g){this._removeFuncs.push([k,g])};x.deregisterRemoveFunc=function(k){this._removeFuncs.filterInPlace(g=>g[0]!==k)};x.put=function(k,g,b,a){const h=this._db.get(k);h&&(this._size-=h.size,this._db.delete(k),h.entry!==g&&this._notifyRemove(k,h.entry,q.RemoveMode.ALL));b>this._maxSize?this._notifyRemove(k,g,q.RemoveMode.ALL):void 0===g?
console.warn("Refusing to cache undefined entry "):!b||0>b?console.warn("Refusing to cache entry with invalid size "+b):(a=1+Math.max(a,-3)- -3,this._db.set(k,{entry:g,size:b,lifetime:a,lives:a}),this._size+=b,this._checkSizeLimit())};x.updateSize=function(k,g,b){const a=this._db.get(k);if(a&&a.entry===g){for(this._size-=a.size;b>this._maxSize;)if(b=this._notifyRemove(k,g,q.RemoveMode.SOME),!(G.isSome(b)&&0<b)){this._db.delete(k);return}a.size=b;this._size+=b;this._checkSizeLimit()}};x.pop=function(k){const g=
this._db.get(k);if(g)return this._size-=g.size,this._db.delete(k),++this._hit,g.entry;++this._miss};x.get=function(k){const g=this._db.get(k);if(void 0===g)++this._miss;else return this._db.delete(k),g.lives=g.lifetime,this._db.set(k,g),++this._hit,g.entry};x.getStats=function(){const k={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},g={},b=[];this._db.forEach((e,f)=>{const c=e.lifetime;
b[c]=(b[c]||0)+e.size;this._users.forAll(d=>{d=d.namespace;f.startsWith(d)&&(g[d]=(g[d]||0)+e.size)})});const a={};this._users.forAll(e=>{const f=e.namespace;!isNaN(e.hitRate)&&0<e.hitRate?(g[f]=g[f]||0,a[f]=Math.round(100*e.hitRate)+"%"):a[f]="0%"});var h=Object.keys(g);h.sort((e,f)=>g[f]-g[e]);h.forEach(e=>k[e]=Math.round(g[e]/2**20)+"MB / "+a[e]);for(h=b.length-1;0<=h;--h){const e=b[h];e&&(k["Priority "+(h+-3-1)]=Math.round(e/this.size*100)+"%")}return k};x.resetStats=function(){this._hit=this._miss=
0;this._users.forAll(k=>k.resetHitRate())};x.clear=function(k){this._db.forEach((g,b)=>{b.startsWith(k)&&(this._size-=g.size,this._db.delete(b),this._notifyRemove(b,g.entry,q.RemoveMode.ALL))})};x.clearAll=function(){this._db.forEach((k,g)=>this._notifyRemove(g,k.entry,q.RemoveMode.ALL));this._size=0;this._db.clear()};x._getHitRate=function(){return this._hit/(this._hit+this._miss)};x._notifyRemove=function(k,g,b){let a;this._removeFuncs.some(h=>k.startsWith(h[0])?(h=h[1](g,b),"number"===typeof h&&
(a=h),!0):!1);return a};x._checkSizeLimit=function(){if(!(this._size<=this._maxSize))for(const [k,g]of this._db){this._db.delete(k);if(1>=g.lives){this._size-=g.size;const b=this._notifyRemove(k,g.entry,q.RemoveMode.SOME);G.isSome(b)&&0<b&&(this._size+=b,g.lives=g.lifetime,g.size=b,this._db.set(k,g))}else--g.lives,this._db.set(k,g);if(this._size<=.9*this.maxSize)break}};n._createClass(D,[{key:"size",get:function(){return this._size}},{key:"sizeMB",get:function(){return this._size/1024/1024}},{key:"maxSize",
get:function(){return this._maxSize},set:function(k){this._maxSize=Math.max(k,0);this._checkSizeLimit()}}]);return D}();q.MIN_PRIORITY=-3;q.MemCache=z;q.MemCacheStorage=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../../core/maybe ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){function h(l){const u=[];let r=0,A=0;for(let w=0;w<l.length;w++){const m=l[w];let t=null;for(let B=0;B<m.length;B++)t=m[B],u.push(t),0===B?A=r=t[0]:(r=Math.min(r,t[0]),A=Math.max(A,t[0]));t&&u.push([(r+A)/2,0])}return u}function e(l,u){if(!(l instanceof D||l instanceof y))throw v.error("straightLineDensify: the input geometry is neither polyline nor polygon"),new G("straightLineDensify: the input geometry is neither polyline nor polygon");var r=x.getGeometryParts(l);
const A=[];for(const m of r){r=[];A.push(r);r.push([m[0][0],m[0][1]]);for(let t=0;t<m.length-1;t++){const B=m[t][0],J=m[t][1],C=m[t+1][0],K=m[t+1][1];var w=Math.sqrt((C-B)*(C-B)+(K-J)*(K-J));const E=(K-J)/w,I=(C-B)/w,H=w/u;if(1<H){for(let N=1;N<=H-1;N++){const U=N*u;r.push([I*U+B,E*U+J])}w=(w+Math.floor(H-1)*u)/2;r.push([I*w+B,E*w+J])}r.push([C,K])}}return"polygon"===l.type?new y({rings:A,spatialReference:l.spatialReference}):new D({paths:A,spatialReference:l.spatialReference})}function f(l,u,r){u&&
(l=e(l,1E6),l=g.webMercatorToGeographic(l,!0));r&&(l=x.updatePolyGeometry(l,r));return l}function c(l,u,r){if(Array.isArray(l)){var A=l[0];A>u?(r=x.offsetMagnitude(A,u),l[0]=A+-2*r*u):A<r&&(u=x.offsetMagnitude(A,r),l[0]=A+-2*u*r)}else A=l.x,A>u?(r=x.offsetMagnitude(A,u),l=l.clone().offset(-2*r*u,0)):A<r&&(u=x.offsetMagnitude(A,r),l=l.clone().offset(-2*u*r,0));return l}function d(l,u){let r=-1;for(let A=0;A<u.cutIndexes.length;A++){const w=u.cutIndexes[A],m=u.geometries[A],t=x.getGeometryParts(m);
for(let B=0;B<t.length;B++){const J=t[B];J.some(C=>{if(180>C[0])return!0;C=0;for(var K=0;K<J.length;K++){var E=J[K][0];C=E>C?E:C}C=Number(C.toFixed(9));C=-360*x.offsetMagnitude(C,180);for(K=0;K<J.length;K++)E=m.getPoint(B,K),m.setPoint(B,K,E.clone().offset(C,0));return!0})}if(w===r)if("polygon"===l[0].type)for(const B of x.getGeometryParts(m))l[w]=l[w].addRing(B);else{if("polyline"===l[0].type)for(const B of x.getGeometryParts(m))l[w]=l[w].addPath(B)}else r=w,l[w]=m}return l}async function p(l,u,
r){if(!Array.isArray(l))return p([l],u);u&&"string"!==typeof u&&v.warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");var A="string"===typeof u?u:u?.url??n.geometryServiceUrl;let w,m,t;let B=0;var J=[];u=[];for(var C of l)if(z.isNone(C))u.push(C);else{if(!K){var K=C.spatialReference;var E=k.getInfo(K);var I=(w=K.isWebMercator)?102100:4326;m=x.cutParams[I].maxX;t=x.cutParams[I].minX;var H=x.cutParams[I].plus180Line;I=x.cutParams[I].minus180Line}if(E)if("mesh"===
C.type)u.push(C);else if("point"===C.type)u.push(c(C.clone(),m,t));else if("multipoint"===C.type){var N=C.clone();N.points=N.points.map(U=>c(U,m,t));u.push(N)}else if("extent"===C.type)N=C.clone()._normalize(!1,!1,E),u.push(N.rings?new y(N):N);else if(C.extent){N=C.extent;const U=2*x.offsetMagnitude(N.xmin,t)*m;let ba=0===U?C.clone():x.updatePolyGeometry(C.clone(),U);N.offset(U,0);N.intersects(H)&&N.xmax!==m?(B=N.xmax>B?N.xmax:B,ba=f(ba,w),J.push(ba),u.push("cut")):N.intersects(I)&&N.xmin!==t?(B=
2*N.xmax*m>B?2*N.xmax*m:B,ba=f(ba,w,360),J.push(ba),u.push("cut")):u.push(ba)}else u.push(C.clone());else u.push(C)}K=x.offsetMagnitude(B,m);E=-90;H=K;for(C=new D;0<K;)I=-180+360*K,C.addPath([[I,E],[I,-1*E]]),E*=-1,K--;if(0<J.length&&0<H){K=await b.cut(A,J,C,r);K=d(J,K);E=[];J=[];for(H=0;H<u.length;H++)C=u[H],"cut"!==C?J.push(C):(C=K.shift(),I=l[H],z.isSome(I)&&"polygon"===I.type&&I.rings&&1<I.rings.length&&C.rings.length>=I.rings.length?(E.push(C),J.push("simplify")):J.push(w?g.geographicToWebMercator(C):
C));if(!E.length)return J;u=await a.simplify(A,E,r);l=[];for(r=0;r<J.length;r++)A=J[r],"simplify"!==A?l.push(A):l.push(w?g.geographicToWebMercator(u.shift()):u.shift());return l}l=[];for(r=0;r<u.length;r++)A=u[r],"cut"!==A?l.push(A):(A=J.shift(),l.push(!0===w?g.geographicToWebMercator(A):A));return l}const v=F.getLogger("esri.geometry.support.normalizeUtils");q.getDenormalizedExtent=function(l){if(!l)return null;const u=l.extent;if(!u)return null;var r=l.spatialReference&&k.getInfo(l.spatialReference);
if(!r)return u;const [A,w]=r.valid;({width:r}=u);let {xmin:m,xmax:t}=u;[m,t]=[t,m];if("extent"===l.type||0===r||r<=w||r>2*w||m<A||t>w)return u;let B;switch(l.type){case "polygon":if(1<l.rings.length)B=h(l.rings);else return u;break;case "polyline":if(1<l.paths.length)B=h(l.paths);else return u;break;case "multipoint":B=l.points}l=u.clone();for(let J=0;J<B.length;J++){let C=B[J][0];0>C?(C+=w,t=Math.max(C,t)):(C-=w,m=Math.min(C,m))}l.xmin=m;l.xmax=t;return l.width<r?(l.xmin-=w,l.xmax-=w,l):u};q.normalizeCentralMeridian=
p;q.normalizeMapX=function(l,u){if(u=k.getInfo(u)){const [r,A]=u.valid;u=A-r;if(l<r)for(;l<r;)l+=u;if(l>A)for(;l>A;)l-=u}return l};q.straightLineDensify=e;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports","../Polyline","../SpatialReference","./jsonUtils"],function(q,n,G,F){function z(y){return F.isPolygon(y)?y.rings:y.paths}n={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new n({paths:[[[2.0037508342788905E7,
-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:G.WebMercator}),minus180Line:new n({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:G.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new n({paths:[[[180,-180],[180,180]]],spatialReference:G.WGS84}),minus180Line:new n({paths:[[[-180,-180],[-180,180]]],spatialReference:G.WGS84})}};q.cutParams=n;q.getGeometryParts=z;q.offsetMagnitude=function(y,
D){return Math.ceil((y-D)/(2*D))};q.updatePolyGeometry=function(y,D){const x=z(y);for(const k of x)for(const g of k)g[0]+=D;return y};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/cut":function(){define(["exports","../../geometry","../../request","../../geometry/support/jsonUtils","../utils"],function(q,n,G,F,z){q.cut=async function(y,D,x,k){y=z.parseUrl(y);const g=D[0].spatialReference;D={...k,query:{...y.query,f:"json",sr:JSON.stringify(g),target:JSON.stringify({geometryType:F.getJsonType(D[0]),
geometries:D}),cutter:JSON.stringify(x)}};D=await G(y.path+"/cut",D);const {cutIndexes:b,geometries:a=[]}=D.data;return{cutIndexes:b,geometries:a.map(h=>{h=F.fromJSON(h);h.spatialReference=g;return h})}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),function(q,n,G,F,z,y){function D(x,k,g){const b={};for(const h in x)if("declaredClass"!==h){var a=x[h];
if(null!=a&&"function"!==typeof a)if(Array.isArray(a)){b[h]=[];for(let e=0;e<a.length;e++)b[h][e]=D(a[e])}else"object"===typeof a?a.toJSON?(a=a.toJSON(g&&g[h]),b[h]=k?a:JSON.stringify(a)):b[h]=k?a:JSON.stringify(a):b[h]=a}return b}q.asValidOptions=function(x,k){return k?{...k,query:{...(x??{}),...k.query}}:{query:x}};q.encode=D;q.getToken=function(x,k){return x?y.supportsApiKey(x)&&(k||n.apiKey)?k||n.apiKey:G.id?.findCredential(x)?.token:null};q.parseUrl=function(x){return"string"===typeof x?z.urlToObject(x):
F.clone(x)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/simplify":function(){define(["exports","../../request","../../core/urlUtils","../../geometry/support/jsonUtils","./utils"],function(q,n,G,F,z){q.simplify=async function(y,D,x){const k="string"===typeof y?G.urlToObject(y):y;y=D[0].spatialReference;const g=F.getJsonType(D[0]);D={...x,query:{...k.query,f:"json",sr:y.wkid??JSON.stringify(y),geometries:JSON.stringify(z.encodeGeometries(D))}};({data:D}=
await n(k.path+"/simplify",D));return z.decodeGeometries(D.geometries,g,y)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(q,n){q.decodeGeometries=function(G,F,z){const y=n.getGeometryType(F);return G.map(D=>{D=y.fromJSON(D);D.spatialReference=z;return D})};q.encodeGeometries=function(G){return{geometryType:n.getJsonType(G[0]),geometries:G.map(F=>F.toJSON())}};Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],function(q,n,G){function F(k,g){return k?D.get(k,g):null}function z(k,g,b,a=!0){const h=[];for(const e of g)if("*"!==e&&!k.has(e))if(a){g=y(e);try{const f=F(g,k);if(!f)throw new n("feature-store:unsupported-query","invalid SQL expression",{where:g});if(!f.isStandardized)throw new n("feature-store:unsupported-query","expression is not standard",
{clause:f});z(k,f.fieldNames,"expression contains missing fields")}catch(f){if((g=f&&f.details)&&(g.clause||g.where))throw f;g&&g.missingFields?h.push(...g.missingFields):h.push(e)}}else h.push(e);if(h.length)throw new n("feature-store:unsupported-query",b,{missingFields:h});}function y(k){return k.split(" as ")[0]}const D=new G.WhereClauseCache(50,500),x=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));
q.getAliasFromFieldName=function(k){return k.split(" as ")[1]};q.getExpressionFromFieldName=y;q.getWhereClause=F;q.hasInvalidFieldType=function(k,g){return(k=g.get(k))?!x.has(k.type):!1};q.validateFields=z;q.validateHaving=function(k,g,b){if(!g)return!0;const a=D.get(g,k);if(!a)throw new n("feature-store:unsupported-query","invalid SQL expression",{having:g});if(!a.isAggregate)throw new n("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:g});z(k,a.fieldNames,
"having contains missing fields");if(!a.getExpressions().every(h=>{const {aggregateType:e,field:f}=h,c=k.get(f)?.name;return b.some(d=>{const {onStatisticField:p,statisticType:v}=d;return k.get(p)?.name===c&&v.toLowerCase().trim()===e})}))throw new n("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:g});return!0};q.validateWhere=function(k,g){if(!g)return!0;const b=D.get(g,k);if(!b)throw new n("feature-store:unsupported-query","invalid SQL expression",
{where:g});if(!b.isStandardized)throw new n("feature-store:unsupported-query","where clause is not standard",{where:g});z(k,b.fieldNames,"where clause contains missing fields");return!0};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../ItemCache","./WhereClause"],function(q,n,G,F){let z=function(){function y(D,x){this._cache=new G(D);this._invalidCache=new G(x)}y.prototype.get=
function(D,x){const k=`${x.uid}:${D}`,g=this._cache.get(k);if(g)return g;if(void 0!==this._invalidCache.get(k))return null;try{const b=F.WhereClause.create(D,x);this._cache.put(k,b);return b}catch{return this._invalidCache.put(k,null),null}};return n._createClass(y)}();q.WhereClauseCache=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(q,n){return function(){function G(z,y){this._storage=
new n.MemCacheStorage;this._storage.maxSize=z;y&&this._storage.registerRemoveFunc("",y)}var F=G.prototype;F.put=function(z,y){this._storage.put(z,y,1,1)};F.pop=function(z){return this._storage.pop(z)};F.get=function(z){return this._storage.get(z)};F.clear=function(){this._storage.clearAll()};F.destroy=function(){this._storage.destroy()};return q._createClass(G)}()})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(q,n,G,F,z,y){function D(E,I){E+="";return E.length>=I?E:Array(I-E.length+1).join("0")+E}function x(E,I,H="0",N="0",U="0",ba="0",la="",aa="0",ka="0"){return"+"===la||"-"===la?(E=`${D(parseInt(E,10),4)}-${D(parseInt(I,10),2)}-${D(parseInt(H,10),2)}`,I="",10>parseFloat(ba)&&(I="0"),N=`${D(parseInt(N,10),2)}:${D(parseInt(U,10),2)}:${I+parseFloat(ba).toString()}`,la=`${la}${D(parseInt(aa,10),2)}:${D(parseInt(ka,10),2)}`,new Date(E+"T"+N+la)):new Date(parseInt(E,10),parseInt(I,10)-1,parseInt(H,
10),parseInt(N,10),parseInt(U,10),parseFloat(ba))}function k(E){let I=r.exec(E);if(null!==I){const [,H,N,U,ba,la,aa]=I;return x(H,N,U,ba,la,aa)}I=A.exec(E);if(null!==I){const [,H,N,U,ba,la,aa,ka,V,P]=I;return x(H,N,U,ba,la,aa,ka,V,P)}I=w.exec(E);if(null!==I){const [,H,N,U,ba,la,aa,ka,V]=I;return x(H,N,U,ba,la,"0",aa,ka,V)}I=m.exec(E);if(null!==I){const [,H,N,U,ba,la]=I;return x(H,N,U,ba,la)}I=u.exec(E);if(null!==I){const [,H,N,U]=I;return x(H,N,U)}throw Error("SQL Invalid Timestamp");}function g(E){const I=
u.exec(E);if(null===I)try{return k(E)}catch{throw Error("SQL Invalid Date");}const [,H,N,U]=I;return new Date(parseInt(H,10),parseInt(N,10)-1,parseInt(U,10))}function b(E){return Array.isArray(E)?E:[E]}function a(E){return null!==E?!0!==E:null}function h(E,I){return null!=E&&null!=I?!0===E&&!0===I:!1===E||!1===I?!1:null}function e(E,I){return null!=E&&null!=I?!0===E||!0===I:!0===E||!0===I?!0:null}function f(E,I){if(null==E)return null;let H=!1;for(const N of I)if(null==N)H=null;else if(E===N){H=!0;
break}return H}function c(E,I,H){if(null==E)return null;let N="",U=C.Normal;for(let ba=0;ba<I.length;ba++){const la=I.charAt(ba);switch(U){case C.Normal:la===H?U=C.Escaped:N="-[]/{}()*+?.\\^$|".includes(la)?N+("\\"+la):"%"===la?N+".*":"_"===la?N+".":N+la;break;case C.Escaped:N="-[]/{}()*+?.\\^$|".includes(la)?N+("\\"+la):N+la,U=C.Normal}}return(new RegExp("^"+N+"$","m")).test(E)}function d(E){return E instanceof Date?E.valueOf():E}function p(E,I,H){if(null==I||null==H)return null;I=d(I);H=d(H);switch(E){case "\x3c\x3e":return I!==
H;case "\x3d":return I===H;case "\x3e":return I>H;case "\x3c":return I<H;case "\x3e\x3d":return I>=H;case "\x3c\x3d":return I<=H}}function v(E,I,H){if("||"===E)return z.evaluateFunction("concat",[I,H]);if(I instanceof z.SqlInterval)if(H instanceof Date)switch(E){case "+":return new Date(I.valueInMilliseconds()+H.getTime());case "-":return I.valueInMilliseconds()-H.getTime();case "*":return I.valueInMilliseconds()*H.getTime();case "/":return I.valueInMilliseconds()/H.getTime()}else if(H instanceof
z.SqlInterval)switch(E){case "+":return z.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()+H.valueInMilliseconds());case "-":return z.SqlInterval.createFromMilliseconds(I.valueInMilliseconds()-H.valueInMilliseconds());case "*":return I.valueInMilliseconds()*H.valueInMilliseconds();case "/":return I.valueInMilliseconds()/H.valueInMilliseconds()}else I=I.valueInMilliseconds();else if(H instanceof z.SqlInterval)if(I instanceof Date)switch(E){case "+":return new Date(H.valueInMilliseconds()+
I.getTime());case "-":return new Date(I.getTime()-H.valueInMilliseconds());case "*":return I.getTime()*H.valueInMilliseconds();case "/":return I.getTime()/H.valueInMilliseconds()}else H=H.valueInMilliseconds();else if(I instanceof Date&&"number"===typeof H)switch(H*=864E5,I=I.getTime(),E){case "+":return new Date(I+H);case "-":return new Date(I-H);case "*":return new Date(I*H);case "/":return new Date(I/H)}else if(H instanceof Date&&"number"===typeof I)switch(I*=864E5,H=H.getTime(),E){case "+":return new Date(I+
H);case "-":return new Date(I-H);case "*":return new Date(I*H);case "/":return new Date(I/H)}switch(E){case "+":return I+H;case "-":return I-H;case "*":return I*H;case "/":return I/H}}function l(E,I,H,N){E=N.getAttribute(E,I);return null!=E&&1===H[I]?new Date(E):E}const u=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,A=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,
m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,t=new Set(["current_timestamp","current_date","current_time"]);let B=function(){function E(){}E.makeBool=function(I){return!0===I};E.featureValue=function(I,H,N,U){return l(I,H,N,U)};E.equalsNull=function(I){return null===I};E.applyLike=function(I,H,N){return c(I,H,N)};E.ensureArray=function(I){return b(I)};E.applyIn=function(I,H){return f(I,H)};E.currentDate=function(){const I=new Date;I.setHours(0,0,0,0);return I};E.makeSqlInterval=function(I,
H,N){return z.SqlInterval.createFromValueAndQualifer(I,H,N)};E.convertInterval=function(I){return I instanceof z.SqlInterval?I.valueInMilliseconds():I};E.currentTimestamp=function(){return new Date};E.compare=function(I,H,N){return p(I,H,N)};E.calculate=function(I,H,N){return v(I,H,N)};E.makeComparable=function(I){return d(I)};E.evaluateFunction=function(I,H){return z.evaluateFunction(I,H)};E.lookup=function(I,H){I=H[I];return void 0===I?null:I};E.between=function(I,H){return null==I||null==H[0]||
null==H[1]?null:I>=H[0]&&I<=H[1]};E.notbetween=function(I,H){return null==I||null==H[0]||null==H[1]?null:I<H[0]||I>H[1]};E.ternaryNot=function(I){return a(I)};E.ternaryAnd=function(I,H){return h(I,H)};E.ternaryOr=function(I,H){return e(I,H)};return n._createClass(E)}(),J=function(){function E(H,N){this.fieldsIndex=N;this._datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=y.WhereGrammar.parse(H);const {isStandardized:U,isAggregate:ba,referencedFieldNames:la}=this._extractExpressionInfo(N);
this._referencedFieldNames=la;this.isStandardized=U;this.isAggregate=ba}E.create=function(H,N){return new E(H,N)};var I=E.prototype;I.testSet=function(H,N=K){const U={};for(const ba of this.fieldNames)U[ba]=H.map(la=>N.getAttribute(la,ba));return!!this._evaluateNode(this.parseTree,{attributes:U},K)};I.calculateValue=function(H,N=K){H=this._evaluateNode(this.parseTree,H,N);return H instanceof z.SqlInterval?H.valueInMilliseconds()/864E5:H};I.calculateValueCompiled=function(H,N=K){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(H,
this.parameters,N,this._datefields);if(G("esri-csp-restrictions"))return this.calculateValue(H,N);this._compileMe();return this.parseTree._compiledVersion(H,this.parameters,N,this._datefields)};I.testFeature=function(H,N=K){return!!this._evaluateNode(this.parseTree,H,N)};I.testFeatureCompiled=function(H,N=K){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(H,this.parameters,N,this._datefields);if(G("esri-csp-restrictions"))return this.testFeature(H,N);this._compileMe();
return!!this.parseTree._compiledVersion(H,this.parameters,N,this._datefields)};I.getFunctions=function(){const H=new Set;this._visitAll(this.parseTree,N=>{"function"===N.type&&H.add(N.name.toLowerCase())});return Array.from(H)};I.getExpressions=function(){const H=new Map;this._visitAll(this.parseTree,N=>{if("function"===N.type){const U=N.name.toLowerCase();N=N.args.value[0];if("column-reference"===N.type){N=N.column;const ba=`${U}-${N}`;H.has(ba)||H.set(ba,{aggregateType:U,field:N})}}});return[...H.values()]};
I.getVariables=function(){const H=new Set;this._visitAll(this.parseTree,N=>{"parameter"===N.type&&H.add(N.value.toLowerCase())});return Array.from(H)};I._compileMe=function(){const H="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",H)).bind(B)};I._extractExpressionInfo=function(H){const N=[],U=new Set;let ba=!0,la=!0;this._visitAll(this.parseTree,aa=>{switch(aa.type){case "column-reference":const ka=
H?.get(aa.column);let V,P;ka?V=P=ka.name??"":(P=aa.column,V=P.toLowerCase());ka&&ka.name&&("date"===ka.type||"esriFieldTypeDate"===ka.type)&&(this._datefields[ka.name]=1);U.has(V)||(U.add(V),N.push(P));aa.column=P;break;case "function":const {name:S,args:X}=aa;aa=X.value.length;ba&&(ba=z.isStandardized(S,aa));la&&(la=F.isAggregate(S,aa))}});return{referencedFieldNames:Array.from(N),isStandardized:ba,isAggregate:la}};I._visitAll=function(H,N){if(null!=H)switch(N(H),H.type){case "when-clause":this._visitAll(H.operand,
N);this._visitAll(H.value,N);break;case "case-expression":for(const U of H.clauses)this._visitAll(U,N);"simple"===H.format&&this._visitAll(H.operand,N);null!==H.else&&this._visitAll(H.else,N);break;case "expression-list":for(const U of H.value)this._visitAll(U,N);break;case "unary-expression":this._visitAll(H.expr,N);break;case "binary-expression":this._visitAll(H.left,N);this._visitAll(H.right,N);break;case "function":this._visitAll(H.args,N)}};I.evaluateNodeToJavaScript=function(H){switch(H.type){case "interval":return"this.makeSqlInterval("+
this.evaluateNodeToJavaScript(H.value)+", "+JSON.stringify(H.qualifier)+","+JSON.stringify(H.op)+")";case "case-expression":var N="";if("simple"===H.format){var U="this.makeComparable("+this.evaluateNodeToJavaScript(H.operand)+")";N="( ";for(let ba=0;ba<H.clauses.length;ba++)N+=" ("+U+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(H.clauses[ba].operand)+")) ? ("+this.evaluateNodeToJavaScript(H.clauses[ba].value)+") : "}else for(N="( ",U=0;U<H.clauses.length;U++)N+=" this.makeBool("+
this.evaluateNodeToJavaScript(H.clauses[U].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(H.clauses[U].value)+") : ";N=null!==H.else?N+this.evaluateNodeToJavaScript(H.else):N+"null";return N+" )";case "parameter":return"this.lookup("+JSON.stringify(H.value.toLowerCase())+",lookups)";case "expression-list":N="[";for(U of H.value)"["!==N&&(N+=","),N+=this.evaluateNodeToJavaScript(U);return N+"]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(H.expr)+")";
case "binary-expression":switch(H.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+" )";case "IS":if("null"!==H.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(H.left)+")";case "ISNOT":if("null"!==H.right.type)throw Error("Unsupported RHS for IS");
return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(H.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(H.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(H.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(H.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(H.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+")";case "NOTBETWEEN":return"this.notbetween("+
this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+","+JSON.stringify(H.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+","+JSON.stringify(H.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+
JSON.stringify(H.operator)+","+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+")";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(H.operator)+","+this.evaluateNodeToJavaScript(H.left)+","+this.evaluateNodeToJavaScript(H.right)+")"}throw Error("Not Supported Operator "+H.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(H.value);case "date":return"(new Date("+g(H.value).getTime().toString()+
"))";case "timestamp":return"(new Date("+k(H.value).getTime().toString()+"))";case "current-time":return"date"===H.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(H.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(H.name)+","+this.evaluateNodeToJavaScript(H.args)+")"}throw Error("Unsupported sql syntax "+H.type);};I._evaluateNode=function(H,N,U){switch(H.type){case "interval":return N=
this._evaluateNode(H.value,N,U),z.SqlInterval.createFromValueAndQualifer(N,H.qualifier,H.op);case "case-expression":if("simple"===H.format){var ba=d(this._evaluateNode(H.operand,N,U));for(var la=0;la<H.clauses.length;la++)if(ba===d(this._evaluateNode(H.clauses[la].operand,N,U)))return this._evaluateNode(H.clauses[la].value,N,U)}else for(ba=0;ba<H.clauses.length;ba++)if(!0===this._evaluateNode(H.clauses[ba].operand,N,U))return this._evaluateNode(H.clauses[ba].value,N,U);return null!==H.else?this._evaluateNode(H.else,
N,U):null;case "parameter":return this.parameters[H.value.toLowerCase()];case "expression-list":ba=[];for(la of H.value)ba.push(this._evaluateNode(la,N,U));return ba;case "unary-expression":return a(this._evaluateNode(H.expr,N,U));case "binary-expression":switch(H.operator){case "AND":return h(this._evaluateNode(H.left,N,U),this._evaluateNode(H.right,N,U));case "OR":return e(this._evaluateNode(H.left,N,U),this._evaluateNode(H.right,N,U));case "IS":if("null"!==H.right.type)throw Error("Unsupported RHS for IS");
return null===this._evaluateNode(H.left,N,U);case "ISNOT":if("null"!==H.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(H.left,N,U);case "IN":return ba=b(this._evaluateNode(H.right,N,U)),f(this._evaluateNode(H.left,N,U),ba);case "NOT IN":return ba=b(this._evaluateNode(H.right,N,U)),a(f(this._evaluateNode(H.left,N,U),ba));case "BETWEEN":return ba=this._evaluateNode(H.left,N,U),H=this._evaluateNode(H.right,N,U),null==ba||null==H[0]||null==H[1]?null:ba>=d(H[0])&&ba<=
d(H[1]);case "NOTBETWEEN":return ba=this._evaluateNode(H.left,N,U),H=this._evaluateNode(H.right,N,U),null==ba||null==H[0]||null==H[1]?null:ba<d(H[0])||ba>d(H[1]);case "LIKE":return c(this._evaluateNode(H.left,N,U),this._evaluateNode(H.right,N,U),H.escape);case "NOT LIKE":return a(c(this._evaluateNode(H.left,N,U),this._evaluateNode(H.right,N,U),H.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return p(H.operator,this._evaluateNode(H.left,N,U),this._evaluateNode(H.right,
N,U));case "-":case "+":case "*":case "/":case "||":return v(H.operator,this._evaluateNode(H.left,N,U),this._evaluateNode(H.right,N,U))}case "null":case "boolean":case "string":case "number":return H.value;case "date":return g(H.value);case "timestamp":return k(H.value);case "current-time":return N=new Date,"date"===H.mode&&N.setHours(0,0,0,0),N;case "column-reference":return l(N,H.column,this._datefields,U);case "data-type":return H.value;case "function":return N=this._evaluateNode(H.args,N,U),this.isAggregate?
F.aggregateFunction(H.name,N):z.evaluateFunction(H.name,N)}throw Error("Unsupported sql syntax "+H.type);};n._createClass(E,[{key:"fieldNames",get:function(){return this._referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,H=>{"current-time"===H.type?this._hasDateFunctions=!0:"function"===H.type&&(this._hasDateFunctions=this._hasDateFunctions||t.has(H.name.toLowerCase()))});
return this._hasDateFunctions}}]);return E}();var C;(function(E){E[E.Normal=0]="Normal";E[E.Escaped=1]="Escaped"})(C||(C={}));const K={getAttribute(E,I){return(E&&"object"===typeof E.attributes?E.attributes:E)[I]}};q.WhereClause=J;q.defaultAttributeAdapter=K;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(q){function n(z){let y=0;for(let D=0;D<z.length;D++)y+=z[D];return y/z.length}function G(z){const y=n(z),
D=z.length;let x=0;for(const k of z)x+=(k-y)**2;return 1<D?x/(D-1):0}const F={min:{minParams:1,maxParams:1,evaluate:z=>null==z[0]?null:Math.min.apply(Math,z[0])},max:{minParams:1,maxParams:1,evaluate:z=>null==z[0]?null:Math.max.apply(Math,z[0])},avg:{minParams:1,maxParams:1,evaluate:z=>null==z[0]?null:n(z[0])},sum:{minParams:1,maxParams:1,evaluate:z=>{if(null==z[0])z=null;else{z=z[0];let y=0;for(let D=0;D<z.length;D++)y+=z[D];z=y}return z}},stddev:{minParams:1,maxParams:1,evaluate:z=>null==z[0]?null:
Math.sqrt(G(z[0]))},count:{minParams:1,maxParams:1,evaluate:z=>null==z[0]?null:z[0].length},var:{minParams:1,maxParams:1,evaluate:z=>null==z[0]?null:G(z[0])}};q.aggregateFunction=function(z,y){const D=F[z.toLowerCase()];if(null==D)throw Error("Function Not Recognised");if(y.length<D.minParams||y.length>D.maxParams)throw Error(`Invalid Parameter count for call to ${z.toUpperCase()}`);return D.evaluate(y)};q.isAggregate=function(z,y){z=F[z.toLowerCase()];return null!=z&&y>=z.minParams&&y<=z.maxParams};
Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../arcade/featureset/support/errorsupport","../string","../../chunks/datetime"],function(q,n,G,F,z){function y(g){g=new Date(g.getTime());g.setHours(0,0,0,0);return g}function D(g,b){if(g instanceof Date)return b?y(g):g;if("string"===typeof g||g instanceof String)if(g=z.DateTime.fromSQL(g),g.isValid)return b?y(g.toJSDate()):
g.toJSDate();throw new G.SqlError(G.SqlErrorCodes.CannotCastValue);}let x=function(){function g(){this.op="+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}g._fixDefaults=function(b){if(null!==b.precision||null!==b.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};g._parseSecondsComponent=function(b,a){a.includes(".")?(a=a.split("."),b.second=parseFloat(a[0]),b.millis=parseInt(a[1],10)):b.second=parseFloat(a)};g.createFromMilliseconds=
function(b){const a=new g;a.second=b/1E3;return a};g.createFromValueAndQualifer=function(b,a,h){let e=null;const f=new g;f.op="-"===h?"-":"+";if("interval-period"===a.type){g._fixDefaults(a);h=RegExp("^[0-9]{1,}$");if("year"===a.period||"month"===a.period)throw Error("Year-Month Intervals not supported");if("second"===a.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(b))g._parseSecondsComponent(f,b);else throw Error("Illegal Interval");else if(h.test(b))f[a.period]=parseFloat(b);else throw Error("Illegal Interval");
}else{g._fixDefaults(a.start);g._fixDefaults(a.end);if("year"===a.start.period||"month"===a.start.period)throw Error("Year-Month Intervals not supported");if("year"===a.end.period||"month"===a.end.period)throw Error("Year-Month Intervals not supported");switch(a.start.period){case "day":switch(a.end.period){case "hour":e=RegExp("^[0-9]{1,} [0-9]{1,}$");if(e.test(b))f[a.start.period]=parseFloat(b.split(" ")[0]),f[a.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;
case "minute":e=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(e.test(b))f[a.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),f.hour=parseFloat(b[0]),f.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":e=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(e.test(b))f[a.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),f.hour=parseFloat(b[0]),f.minute=parseFloat(b[1]),g._parseSecondsComponent(f,b[2]);
else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(a.end.period){case "minute":e=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(e.test(b))f.hour=parseFloat(b.split(":")[0]),f.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":e=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(e.test(b))b=b.split(":"),f.hour=parseFloat(b[0]),f.minute=parseFloat(b[1]),g._parseSecondsComponent(f,b[2]);else throw Error("Illegal Interval");
break;default:throw Error("Invalid Interval.");}break;case "minute":switch(a.end.period){case "second":e=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(e.test(b))b=b.split(":"),f.minute=parseFloat(b[0]),g._parseSecondsComponent(f,b[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return f};g.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+
36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return n._createClass(g)}();const k={extract:{minParams:2,maxParams:2,evaluate:([g,b])=>{if(null==b)return null;if(b instanceof Date)switch(g.toUpperCase()){case "SECOND":return b.getSeconds();case "MINUTE":return b.getMinutes();case "HOUR":return b.getHours();case "DAY":return b.getDate();case "MONTH":return b.getMonth()+1;case "YEAR":return b.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,
maxParams:3,evaluate:g=>{if(2===g.length){const [b,a]=g;return null==b||null==a?null:b.toString().substring(a-1)}if(3===g.length){const [b,a,h]=g;return null==b||null==a||null==h?null:0>=h?"":b.toString().substring(a-1,a+h-1)}}},position:{minParams:2,maxParams:2,evaluate:([g,b])=>null==g||null==b?null:b.indexOf(g)+1},trim:{minParams:2,maxParams:3,evaluate:g=>{var b=3===g.length,a=b?g[1]:" ";b=b?g[2]:g[1];if(null==a||null==b)return null;a=`(${F.escapeRegExpString(a)})`;switch(g[0]){case "BOTH":return b.replace(new RegExp(`^${a}*|${a}*$`,
"g"),"");case "LEADING":return b.replace(new RegExp(`^${a}*`,"g"),"");case "TRAILING":return b.replace(new RegExp(`${a}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.abs(g[0])},ceiling:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.ceil(g[0])},floor:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.floor(g[0])},log:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.log(g[0])},log10:{minParams:1,
maxParams:1,evaluate:g=>null==g[0]?null:Math.log(g[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.sin(g[0])},cos:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.cos(g[0])},tan:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.tan(g[0])},asin:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.asin(g[0])},acos:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.acos(g[0])},atan:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.atan(g[0])},
sign:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:0<g[0]?1:0>g[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:g=>null==g[0]||null==g[1]?null:g[0]**g[1]},mod:{minParams:2,maxParams:2,evaluate:g=>null==g[0]||null==g[1]?null:g[0]%g[1]},round:{minParams:1,maxParams:2,evaluate:g=>{const b=g[0];g=2===g.length?10**g[1]:1;return null==b?null:Math.round(b*g)/g}},truncate:{minParams:1,maxParams:2,evaluate:g=>null==g[0]?null:1===g.length?parseInt(g[0].toFixed(0),10):parseFloat(g[0].toFixed(g[1]))},
char_length:{minParams:1,maxParams:1,evaluate:g=>"string"===typeof g[0]||g[0]instanceof String?g[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:g=>{let b="";for(let a=0;a<g.length;a++){if(null==g[a])return null;b+=g[a].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:g[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:g[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:g=>{for(const b of g)if(null!==
b)return b;return null}},cosh:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.cosh(g[0])},sinh:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.sinh(g[0])},tanh:{minParams:1,maxParams:1,evaluate:g=>null==g[0]?null:Math.tanh(g[0])},nullif:{minParams:2,maxParams:2,evaluate:g=>{const b=g[0];g=g[1];return(b instanceof Date?b.valueOf():b)===(g instanceof Date?g.valueOf():g)?null:b}},cast:{minParams:2,maxParams:2,evaluate:g=>{var b=g[0];g=g[1];if(null===b)return null;switch(g.type){case "integer":b=
parseInt(b,10);if(isNaN(b))throw new G.SqlError(G.SqlErrorCodes.CannotCastValue);return b;case "smallint":b=parseInt(b,10);if(isNaN(b))throw new G.SqlError(G.SqlErrorCodes.CannotCastValue);if(32767<b||-32767>b)throw new G.SqlError(G.SqlErrorCodes.CannotCastValue);return b;case "float":case "real":b=parseFloat(b);if(isNaN(b))throw new G.SqlError(G.SqlErrorCodes.CannotCastValue);return b;case "date":return D(b,!0);case "timestamp":return D(b,!1);case "varchar":b=b.toString();if(b.length>g.size)throw new G.SqlError(G.SqlErrorCodes.CannotCastValue);
return b;default:throw new G.SqlError(G.SqlErrorCodes.InvalidDataType);}}}};q.SqlInterval=x;q.evaluateFunction=function(g,b){const a=k[g.toLowerCase()];if(null==a)throw Error("Function Not Recognised");if(b.length<a.minParams||b.length>a.maxParams)throw Error(`Invalid Parameter count for call to ${g.toUpperCase()}`);return a.evaluate(b)};q.isStandardized=function(g,b){g=k[g.toLowerCase()];return null!=g&&b>=g.minParams&&b<=g.maxParams};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},
"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../executionError"],function(q,n,G){q.SqlErrorCodes=void 0;(function(x){x.InvalidFunctionParameters="InvalidFunctionParameters";x.UnsupportedSqlFunction="UnsupportedSqlFunction";x.UnsupportedOperator="UnsupportedOperator";x.UnsupportedSyntax="UnsupportedSyntax";x.UnsupportedIsRhs="UnsupportedIsRhs";x.UnsupportedIsLhs="UnsupportedIsLhs";x.InvalidDataType="InvalidDataType";x.CannotCastValue=
"CannotCastValue";x.MissingStatisticParameters="MissingStatisticParameters"})(q.SqlErrorCodes||(q.SqlErrorCodes={}));const F={[q.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[q.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[q.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[q.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[q.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",
[q.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[q.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[q.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[q.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};let z=function(x){function k(b,a){b=g.call(this,G.doSubstitutions(F[b],a));b.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(b),
k);return b}n._inherits(k,x);var g=n._createSuper(k);return n._createClass(k)}(n._wrapNativeSuper(Error));q.FeatureSetErrorCodes=void 0;(function(x){x.NeverReach="NeverReach";x.NotImplemented="NotImplemented";x.Cancelled="Cancelled";x.InvalidStatResponse="InvalidStatResponse";x.InvalidRequest="InvalidRequest";x.RequestFailed="RequestFailed";x.MissingFeatures="MissingFeatures";x.AggregationFieldNotFound="AggregationFieldNotFound";x.DataElementsNotFound="DataElementsNotFound"})(q.FeatureSetErrorCodes||
(q.FeatureSetErrorCodes={}));const y={[q.FeatureSetErrorCodes.Cancelled]:"Cancelled",[q.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[q.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[q.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[q.FeatureSetErrorCodes.MissingFeatures]:"Missing features",[q.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[q.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",
[q.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[q.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};let D=function(x){function k(b,a){b=g.call(this,G.doSubstitutions(y[b],a));b.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(b),k);return b}n._inherits(k,x);var g=n._createSuper(k);return n._createClass(k)}(n._wrapNativeSuper(Error));q.FeatureSetError=D;q.FeatureSetErrorMessages=y;
q.SqlError=z;q.SqlErrorMessages=F;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/executionError":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],function(q,n){function G(h){return h&&h.loc?`Line : ${h.loc.start?.line}, ${h.loc.start?.column}: `:""}function F(h,e){try{if(!e)return h;for(const f in e){let c=e[f];c||(c="");h=h.replace("{"+f+"}",e[f])}}catch(f){}return h}q.ExecutionErrorCodes=void 0;(function(h){h.AsyncNotEnabled="AsyncNotEnabled";h.ModulesNotSupported=
"ModulesNotSupported";h.CircularModules="CircularModules";h.NeverReach="NeverReach";h.UnsupportedHashType="UnsupportedHashType";h.InvalidParameter="InvalidParameter";h.UnexpectedToken="UnexpectedToken";h.Unrecognised="Unrecognised";h.UnrecognisedType="UnrecognisedType";h.MaximumCallDepth="MaximumCallDepth";h.BooleanConditionRequired="BooleanConditionRequired";h.TypeNotAllowedInFeature="TypeNotAllowedInFeature";h.KeyMustBeString="KeyMustBeString";h.WrongNumberOfParameters="WrongNumberOfParameters";
h.CallNonFunction="CallNonFunction";h.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral";h.NoFunctionInDictionary="NoFunctionInDictionary";h.NoFunctionInArray="NoFunctionInArray";h.AssignModuleFunction="AssignModuleFunction";h.LogicExpressionOrAnd="LogicExpressionOrAnd";h.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean";h.FuncionNotFound="FunctionNotFound";h.InvalidMemberAccessKey="InvalidMemberAccessKey";h.UnsupportedUnaryOperator="UnsupportUnaryOperator";h.InvalidIdentifier="InvalidIdentifier";
h.MemberOfNull="MemberOfNull";h.UnsupportedOperator="UnsupportedOperator";h.Cancelled="Cancelled";h.ModuleAccessorMustBeString="ModuleAccessorMustBeString";h.ModuleExportNotFound="ModuleExportNotFound";h.Immutable="Immutable";h.OutOfBounds="OutOfBounds";h.IllegalResult="IllegalResult";h.FieldNotFound="FieldNotFound";h.PortalRequired="PortalRequired";h.LogicError="LogicError";h.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber";h.KeyAccessorMustBeString="KeyAccessorMustBeString";h.WrongSpatialReference=
"WrongSpatialReference"})(q.ExecutionErrorCodes||(q.ExecutionErrorCodes={}));const z={[q.ExecutionErrorCodes.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[q.ExecutionErrorCodes.LogicError]:"Logic error - {reason}",[q.ExecutionErrorCodes.NeverReach]:"Encountered unreachable logic",[q.ExecutionErrorCodes.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[q.ExecutionErrorCodes.ModuleAccessorMustBeString]:"Module accessor must be a string",[q.ExecutionErrorCodes.ModuleExportNotFound]:"Module has no export with provided identifier",
[q.ExecutionErrorCodes.ModulesNotSupported]:"Current profile does not support modules",[q.ExecutionErrorCodes.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[q.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[q.ExecutionErrorCodes.FieldNotFound]:"Key not found - {key}",[q.ExecutionErrorCodes.CircularModules]:"Circular module dependencies are not allowed",[q.ExecutionErrorCodes.Cancelled]:"Execution cancelled",[q.ExecutionErrorCodes.UnsupportedHashType]:"Type not supported in hash function",
[q.ExecutionErrorCodes.IllegalResult]:"Value is not a supported return type",[q.ExecutionErrorCodes.PortalRequired]:"Portal is required",[q.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[q.ExecutionErrorCodes.WrongNumberOfParameters]:"Call with wrong number of parameters",[q.ExecutionErrorCodes.Unrecognised]:"Unrecognised code structure",[q.ExecutionErrorCodes.UnrecognisedType]:"Unrecognised type",[q.ExecutionErrorCodes.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",
[q.ExecutionErrorCodes.BooleanConditionRequired]:"Conditions must use booleans",[q.ExecutionErrorCodes.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[q.ExecutionErrorCodes.NoFunctionInArray]:"Arrays cannot contain functions.",[q.ExecutionErrorCodes.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[q.ExecutionErrorCodes.KeyAccessorMustBeString]:"Accessor must be a string",[q.ExecutionErrorCodes.KeyMustBeString]:"Object keys must be a string",[q.ExecutionErrorCodes.Immutable]:"Object is immutable",
[q.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[q.ExecutionErrorCodes.UnexpectedToken]:"Unexpected token",[q.ExecutionErrorCodes.MemberOfNull]:"Cannot access property of null object",[q.ExecutionErrorCodes.MaximumCallDepth]:"Exceeded maximum function depth",[q.ExecutionErrorCodes.OutOfBounds]:"Out of bounds",[q.ExecutionErrorCodes.InvalidIdentifier]:"Identifier not recognised",[q.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[q.ExecutionErrorCodes.CallNonFunction]:"Expression is not a function",
[q.ExecutionErrorCodes.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[q.ExecutionErrorCodes.AssignModuleFunction]:"Cannot assign function to module variable",[q.ExecutionErrorCodes.UnsupportedUnaryOperator]:"Unsupported unary operator",[q.ExecutionErrorCodes.UnsupportedOperator]:"Unsupported operator",[q.ExecutionErrorCodes.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[q.ExecutionErrorCodes.LogicExpressionOrAnd]:"Logical expression can only be combined with || or \x26\x26"};
let y=function(h){function e(...c){return f.call(this,...c)}n._inherits(e,h);var f=n._createSuper(e);return n._createClass(e)}(n._wrapNativeSuper(Error)),D=function(h){function e(c,d){c=f.call(this,G(d)+c.message,{cause:c});c.loc=null;Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(c),e);d&&d.loc&&(c.loc=d.loc);return c}n._inherits(e,h);var f=n._createSuper(e);return n._createClass(e)}(y),x=function(h){function e(c,d,p,v){c=f.call(this,"Execution error - "+G(p)+F(z[d],v));
c.loc=null;c.declaredRootClass="esri.arcade.arcadeexecutionerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(c),e);p&&p.loc&&(c.loc=p.loc);return c}n._inherits(e,h);var f=n._createSuper(e);return n._createClass(e)}(n._wrapNativeSuper(Error)),k=function(h){function e(c,d,p,v){c=f.call(this,"Compilation error - "+G(p)+F(z[d],v));c.loc=null;c.declaredRootClass="esri.arcade.arcadecompilationerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(c),
e);p&&p.loc&&(c.loc=p.loc);return c}n._inherits(e,h);var f=n._createSuper(e);return n._createClass(e)}(n._wrapNativeSuper(Error)),g=function(h){function e(){var c=f.call(this,"Uncompilable code structures");c.declaredRootClass="esri.arcade.arcadeuncompilableerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(c),e);return c}n._inherits(e,h);var f=n._createSuper(e);return n._createClass(e)}(n._wrapNativeSuper(Error));q.ModuleErrorCodes=void 0;(function(h){h.UnrecognisedUri=
"UnrecognisedUri";h.UnsupportedUriProtocol="UnsupportedUriProtocol"})(q.ModuleErrorCodes||(q.ModuleErrorCodes={}));const b={[q.ModuleErrorCodes.UnrecognisedUri]:"Unrecognised uri - {uri}",[q.ModuleErrorCodes.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let a=function(h){function e(c,d){c=f.call(this,F(b[c],d));c.declaredRootClass="esri.arcade.arcademoduleerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(c),e);return c}n._inherits(e,h);var f=n._createSuper(e);
return n._createClass(e)}(n._wrapNativeSuper(Error));q.ArcadeCompilationError=k;q.ArcadeExecutionError=x;q.ArcadeUncompilableError=g;q.ErrorWithCause=y;q.ExecutionErrorMessages=z;q.LocatableArcadeExecutionError=D;q.ModuleError=a;q.ModuleErrorMessages=b;q.doSubstitutions=F;q.ensureArcadeExecutionError=function(h,e,f){return"esri.arcade.arcadeexecutionerror"===f.declaredRootClass||"esri.arcade.arcadecompilationerror"===f.declaredRootClass?null===f.loc&&e&&e.loc?new D(f,{cause:f}):f:e&&e.loc?new D(f,
{cause:f}):f};q.parsingValidationMessage=function(h,e,f){return"Parsing error - "+G(h)+F(z[e],f)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/datetime":function(){define(["exports"],function(q){function n(L,T={}){const ja=JSON.stringify([L,T]);let va=qc[ja];va||(va=new Intl.ListFormat(L,T),qc[ja]=va);return va}function G(L,T={}){const ja=JSON.stringify([L,T]);let va=od[ja];va||(va=new Intl.DateTimeFormat(L,T),od[ja]=va);return va}function F(L,T={}){const ja=JSON.stringify([L,
T]);let va=Rb[ja];va||(va=new Intl.NumberFormat(L,T),Rb[ja]=va);return va}function z(L,T={}){const {base:ja,...va}=T,Aa=JSON.stringify([L,va]);let Fa=Yb[Aa];Fa||(Fa=new Intl.RelativeTimeFormat(L,T),Yb[Aa]=Fa);return Fa}function y(L){const T=[];for(let ja=1;12>=ja;ja++){const va=$a.utc(2016,ja,1);T.push(L(va))}return T}function D(L){const T=[];for(let ja=1;7>=ja;ja++){const va=$a.utc(2016,11,13+ja);T.push(L(va))}return T}function x(L,T,ja,va,Aa){L=L.listingMode(ja);return"error"===L?null:"en"===L?
va(T):Aa(T)}function k(L,T){if(g(L)||null===L)return T;if(L instanceof Zb)return L;if("string"===typeof L){const ja=L.toLowerCase();return"default"===ja?T:"local"===ja||"system"===ja?ad.instance:"utc"===ja||"gmt"===ja?Ib.utcInstance:Ib.parseSpecifier(ja)||Vb.create(L)}return b(L)?Ib.instance(L):"object"===typeof L&&L.offset&&"number"===typeof L.offset?L:new bd(L)}function g(L){return"undefined"===typeof L}function b(L){return"number"===typeof L}function a(L){return"number"===typeof L&&0===L%1}function h(){try{return"undefined"!==
typeof Intl&&!!Intl.RelativeTimeFormat}catch(L){return!1}}function e(L,T,ja){if(0!==L.length)return L.reduce((va,Aa)=>{Aa=[T(Aa),Aa];return va?ja(va[0],Aa[0])===va[0]?va:Aa:Aa},null)[1]}function f(L,T){return T.reduce((ja,va)=>{ja[va]=L[va];return ja},{})}function c(L,T){return Object.prototype.hasOwnProperty.call(L,T)}function d(L,T,ja){return a(L)&&L>=T&&L<=ja}function p(L,T=2){return 0>L?"-"+(""+-L).padStart(T,"0"):(""+L).padStart(T,"0")}function v(L){if(!g(L)&&null!==L&&""!==L)return parseInt(L,
10)}function l(L){if(!g(L)&&null!==L&&""!==L)return parseFloat(L)}function u(L){if(!g(L)&&null!==L&&""!==L)return L=1E3*parseFloat("0."+L),Math.floor(L)}function r(L,T,ja=!1){T=10**T;return(ja?Math.trunc:Math.round)(L*T)/T}function A(L){return 0===L%4&&(0!==L%100||0===L%400)}function w(L,T){var ja=T-1;ja=ja-12*Math.floor(ja/12)+1;return 2===ja?A(L+(T-ja)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][ja-1]}function m(L){let T=Date.UTC(L.year,L.month-1,L.day,L.hour,L.minute,L.second,L.millisecond);
100>L.year&&0<=L.year&&(T=new Date(T),T.setUTCFullYear(L.year,L.month-1,L.day));return+T}function t(L){var T=L-1;T=(T+Math.floor(T/4)-Math.floor(T/100)+Math.floor(T/400))%7;return 4===(L+Math.floor(L/4)-Math.floor(L/100)+Math.floor(L/400))%7||3===T?53:52}function B(L){return 99<L?L:L>yb.twoDigitCutoffYear?1900+L:2E3+L}function J(L,T,ja,va=null){L=new Date(L);const Aa={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};va&&(Aa.timeZone=va);return(T=(new Intl.DateTimeFormat(ja,
{timeZoneName:T,...Aa})).formatToParts(L).find(Fa=>"timezonename"===Fa.type.toLowerCase()))?T.value:null}function C(L,T){L=parseInt(L,10);Number.isNaN(L)&&(L=0);T=parseInt(T,10)||0;T=0>L||Object.is(L,-0)?-T:T;return 60*L+T}function K(L){const T=Number(L);if("boolean"===typeof L||""===L||Number.isNaN(T))throw new Na(`Invalid unit value ${L}`);return T}function E(L,T){const ja={};for(const va in L)if(c(L,va)){const Aa=L[va];void 0!==Aa&&null!==Aa&&(ja[T(va)]=K(Aa))}return ja}function I(L,T){const ja=
Math.trunc(Math.abs(L/60)),va=Math.trunc(Math.abs(L%60));L=0<=L?"+":"-";switch(T){case "short":return`${L}${p(ja,2)}:${p(va,2)}`;case "narrow":return`${L}${ja}${0<va?`:${va}`:""}`;case "techie":return`${L}${p(ja,2)}${p(va,2)}`;default:throw new RangeError(`Value format ${T} is out of range for property format`);}}function H(L){return f(L,["hour","minute","second","millisecond"])}function N(L){switch(L){case "narrow":return[...le];case "short":return[...pd];case "long":return[...Ld];case "numeric":return"1 2 3 4 5 6 7 8 9 10 11 12".split(" ");
case "2-digit":return"01 02 03 04 05 06 07 08 09 10 11 12".split(" ");default:return null}}function U(L){switch(L){case "narrow":return[...kc];case "short":return[...gc];case "long":return[...rc];case "numeric":return"1234567".split("");default:return null}}function ba(L){switch(L){case "narrow":return[...me];case "short":return[...Md];case "long":return[...Nd];default:return null}}function la(L,T,ja="always",va=!1){const Aa={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],
weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]};var Fa=-1===["hours","minutes","seconds"].indexOf(L);if("auto"===ja&&Fa)switch(ja="days"===L,T){case 1:return ja?"tomorrow":`next ${Aa[L][0]}`;case -1:return ja?"yesterday":`last ${Aa[L][0]}`;case 0:return ja?"today":`this ${Aa[L][0]}`}ja=Object.is(T,-0)||0>T;T=Math.abs(T);Fa=1===T;const Ma=Aa[L];L=va?Fa?Ma[1]:Ma[2]||Ma[1]:Fa?Aa[L][0]:L;return ja?`${T} ${L} ago`:`in ${T} ${L}`}
function aa(L,T){let ja="";for(const va of L)ja=va.literal?ja+va.val:ja+T(va.val);return ja}function ka(...L){L=L.reduce((T,ja)=>T+ja.source,"");return RegExp(`^${L}$`)}function V(...L){return T=>L.reduce(([ja,va,Aa],Fa)=>{const [Ma,Ua,Xa]=Fa(T,Aa);return[{...ja,...Ma},Ua||va,Xa]},[{},null,1]).slice(0,2)}function P(L,...T){if(null==L)return[null,null];for(const [ja,va]of T)if(T=ja.exec(L))return va(T);return[null,null]}function S(...L){return(T,ja)=>{const va={};let Aa;for(Aa=0;Aa<L.length;Aa++)va[L[Aa]]=
v(T[ja+Aa]);return[va,null,ja+Aa]}}function X(L,T,ja){L=L[T];return g(L)?ja:v(L)}function ra(L,T){return[{hours:X(L,T,0),minutes:X(L,T+1,0),seconds:X(L,T+2,0),milliseconds:u(L[T+3])},null,T+4]}function Y(L,T){const ja=!L[T]&&!L[T+1];L=C(L[T+1],L[T+2]);return[{},ja?null:Ib.instance(L),T+3]}function ua(L,T){return[{},L[T]?Vb.create(L[T]):null,T+1]}function ca(L){const [T,ja,va,Aa,Fa,Ma,Ua,Xa,hb]=L,R="-"===T[0];L=Xa&&"-"===Xa[0];const ib=(db,Kb=!1)=>void 0!==db&&(Kb||db&&R)?-db:db;return[{years:ib(l(ja)),
months:ib(l(va)),weeks:ib(l(Aa)),days:ib(l(Fa)),hours:ib(l(Ma)),minutes:ib(l(Ua)),seconds:ib(l(Xa),"-0"===Xa),milliseconds:ib(u(hb),L)}]}function ia(L,T,ja,va,Aa,Fa,Ma){T={year:2===T.length?B(v(T)):v(T),month:pd.indexOf(ja)+1,day:v(va),hour:v(Aa),minute:v(Fa)};Ma&&(T.second=v(Ma));L&&(T.weekday=3<L.length?rc.indexOf(L)+1:gc.indexOf(L)+1);return T}function oa(L){const [,T,ja,va,Aa,Fa,Ma,Ua,Xa,hb,R,ib]=L;L=ia(T,Aa,va,ja,Fa,Ma,Ua);let db;db=Xa?Od[Xa]:hb?0:C(R,ib);return[L,new Ib(db)]}function M(L){const [,
T,ja,va,Aa,Fa,Ma,Ua]=L;return[ia(T,Aa,va,ja,Fa,Ma,Ua),Ib.utcInstance]}function Q(L){const [,T,ja,va,Aa,Fa,Ma,Ua]=L;return[ia(T,Ua,ja,va,Aa,Fa,Ma),Ib.utcInstance]}function fa(L,T,ja=!1){L={values:ja?T.values:{...L.values,...(T.values||{})},loc:L.loc.clone(T.loc),conversionAccuracy:T.conversionAccuracy||L.conversionAccuracy,matrix:T.matrix||L.matrix};return new kb(L)}function na(L,T,ja,va,Aa){L=L[Aa][ja];var Fa=T[ja]/L;Fa=Math.sign(Fa)!==Math.sign(va[Aa])&&0!==va[Aa]&&1>=Math.abs(Fa)?0>Fa?Math.floor(Fa):
Math.ceil(Fa):Math.trunc(Fa);va[Aa]+=Fa;T[ja]-=Fa*L}function za(L,T){qd.reduce((ja,va)=>{if(g(T[va]))return ja;ja&&na(L,T,ja,T,va);return va},null)}function W(L,T){L=T.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()-L.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf();return Math.floor(kb.fromMillis(L).as("days"))}function da(L,T,ja){const va=[["years",(Xa,hb)=>hb.year-Xa.year],["quarters",(Xa,hb)=>hb.quarter-Xa.quarter+4*(hb.year-Xa.year)],["months",(Xa,hb)=>hb.month-Xa.month+12*(hb.year-
Xa.year)],["weeks",(Xa,hb)=>{Xa=W(Xa,hb);return(Xa-Xa%7)/7}],["days",W]],Aa={},Fa=L;let Ma,Ua;for(const [Xa,hb]of va)0<=ja.indexOf(Xa)&&(Ma=Xa,Aa[Xa]=hb(L,T),Ua=Fa.plus(Aa),Ua>T?(Aa[Xa]--,L=Fa.plus(Aa)):L=Ua);return[L,Aa,Ua,Ma]}function ha(L,T,ja,va){let [Aa,Fa,Ma,Ua]=da(L,T,ja);L=T-Aa;ja=ja.filter(Xa=>0<=["hours","minutes","seconds","milliseconds"].indexOf(Xa));0===ja.length&&(Ma<T&&(Ma=Aa.plus({[Ua]:1})),Ma!==Aa&&(Fa[Ua]=(Fa[Ua]||0)+L/(Ma-Aa)));T=kb.fromObject(Fa,va);return 0<ja.length?kb.fromMillis(L,
va).shiftTo(...ja).plus(T):T}function ma({numberingSystem:L},T=""){return new RegExp(`${rd[L||"latn"]}${T}`)}function qa(L,T=ja=>ja){return{regex:L,deser:([ja])=>{{let va=parseInt(ja,10);if(isNaN(va)){va="";for(let Aa=0;Aa<ja.length;Aa++){const Fa=ja.charCodeAt(Aa);if(-1!==ja[Aa].search(rd.hanidec))va+=lc.indexOf(ja[Aa]);else for(const Ma in cd){const [Ua,Xa]=cd[Ma];Fa>=Ua&&Fa<=Xa&&(va+=Fa-Ua)}}ja=parseInt(va,10)}else ja=va}return T(ja)}}}function wa(L){return L.replace(/\./g,"\\.?").replace(hc,Ec)}
function ya(L,T){return null===L?null:{regex:RegExp(L.map(wa).join("|")),deser:([ja])=>L.findIndex(va=>ja.replace(/\./g,"").replace(hc," ").toLowerCase()===va.replace(/\./g,"").replace(hc," ").toLowerCase())+T}}function Ea(L,T){return{regex:L,deser:([,ja,va])=>C(ja,va),groups:T}}function Da(L){return{regex:L,deser:([T])=>T}}function Ia(L,T){const ja=ma(T),va=ma(T,"{2}"),Aa=ma(T,"{3}"),Fa=ma(T,"{4}"),Ma=ma(T,"{6}"),Ua=ma(T,"{1,2}"),Xa=ma(T,"{1,3}"),hb=ma(T,"{1,6}"),R=ma(T,"{1,9}"),ib=ma(T,"{2,4}"),
db=ma(T,"{4,6}"),Kb=sc=>({regex:RegExp(sc.val.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$\x26")),deser:([Z])=>Z,literal:!0}),Ga=(sc=>{if(L.literal)return Kb(sc);switch(sc.val){case "G":return ya(T.eras("short",!1),0);case "GG":return ya(T.eras("long",!1),0);case "y":return qa(hb);case "yy":return qa(ib,B);case "yyyy":return qa(Fa);case "yyyyy":return qa(db);case "yyyyyy":return qa(Ma);case "M":return qa(Ua);case "MM":return qa(va);case "MMM":return ya(T.months("short",!0,!1),1);case "MMMM":return ya(T.months("long",
!0,!1),1);case "L":return qa(Ua);case "LL":return qa(va);case "LLL":return ya(T.months("short",!1,!1),1);case "LLLL":return ya(T.months("long",!1,!1),1);case "d":return qa(Ua);case "dd":return qa(va);case "o":return qa(Xa);case "ooo":return qa(Aa);case "HH":return qa(va);case "H":return qa(Ua);case "hh":return qa(va);case "h":return qa(Ua);case "mm":return qa(va);case "m":return qa(Ua);case "q":return qa(Ua);case "qq":return qa(va);case "s":return qa(Ua);case "ss":return qa(va);case "S":return qa(Xa);
case "SSS":return qa(Aa);case "u":return Da(R);case "uu":return Da(Ua);case "uuu":return qa(ja);case "a":return ya(T.meridiems(),0);case "kkkk":return qa(Fa);case "kk":return qa(ib,B);case "W":return qa(Ua);case "WW":return qa(va);case "E":case "c":return qa(ja);case "EEE":return ya(T.weekdays("short",!1,!1),1);case "EEEE":return ya(T.weekdays("long",!1,!1),1);case "ccc":return ya(T.weekdays("short",!0,!1),1);case "cccc":return ya(T.weekdays("long",!0,!1),1);case "Z":case "ZZ":return Ea(new RegExp(`([+-]${Ua.source})(?::(${va.source}))?`),
2);case "ZZZ":return Ea(new RegExp(`([+-]${Ua.source})(${va.source})?`),2);case "z":return Da(/[a-z_+-/]{1,256}?/i);case " ":return Da(/[^\S\n\r]/);default:return Kb(sc)}})(L)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};Ga.token=L;return Ga}function Ja(L){return[`^${L.map(T=>T.regex).reduce((T,ja)=>`${T}(${ja.source})`,"")}$`,L]}function La(L,T,ja){if(L=L.match(T)){T={};let va=1;for(const Aa in ja)if(c(ja,Aa)){const Fa=ja[Aa],Ma=Fa.groups?Fa.groups+1:1;!Fa.literal&&Fa.token&&
(T[Fa.token.val[0]]=Fa.deser(L.slice(va,va+Ma)));va+=Ma}return[L,T]}return[L,{}]}function Ra(L){const T=Aa=>{switch(Aa){case "S":return"millisecond";case "s":return"second";case "m":return"minute";case "h":case "H":return"hour";case "d":return"day";case "o":return"ordinal";case "L":case "M":return"month";case "y":return"year";case "E":case "c":return"weekday";case "W":return"weekNumber";case "k":return"weekYear";case "q":return"quarter";default:return null}};let ja=null,va;g(L.z)||(ja=Vb.create(L.z));
g(L.Z)||(ja||(ja=new Ib(L.Z)),va=L.Z);g(L.q)||(L.M=3*(L.q-1)+1);g(L.h)||(12>L.h&&1===L.a?L.h+=12:12===L.h&&0===L.a&&(L.h=0));0===L.G&&L.y&&(L.y=-L.y);g(L.u)||(L.S=u(L.u));return[Object.keys(L).reduce((Aa,Fa)=>{const Ma=T(Fa);Ma&&(Aa[Ma]=L[Fa]);return Aa},{}),ja,va]}function Pa(L,T){return Array.prototype.concat(...L.map(ja=>{if(!ja.literal){var va=Db.macroTokenToFormatOpts(ja.val);va=Ta(va,T);ja=null==va||va.includes(void 0)?ja:va}return ja}))}function Sa(L,T,ja){ja=Pa(Db.parseFormat(ja),L);var va=
ja.map(db=>Ia(db,L));const Aa=va.find(db=>db.invalidReason);if(Aa)return{input:T,tokens:ja,invalidReason:Aa.invalidReason};const [Fa,Ma]=Ja(va);va=RegExp(Fa,"i");const [Ua,Xa]=La(T,va,Ma),[hb,R,ib]=Xa?Ra(Xa):[null,null,void 0];if(c(Xa,"a")&&c(Xa,"H"))throw new sa("Can't include meridiem when specifying 24-hour format");return{input:T,tokens:ja,regex:va,rawMatches:Ua,matches:Xa,result:hb,zone:R,specificOffset:ib}}function Ta(L,T){if(!L)return null;T=Db.create(T,L);var ja=T.formatDateTimeParts;dd||
(dd=$a.fromMillis(1555555555555));return ja.call(T,dd).map(va=>{{const {type:Fa,value:Ma}=va;if("literal"===Fa)va=/^\s+$/.test(Ma),va={literal:!va,val:va?" ":Ma};else{va=L[Fa];var Aa=sd[Fa];"object"===typeof Aa&&(Aa=Aa[va]);va=Aa?{literal:!1,val:Aa}:void 0}}return va})}function Qa(L,T){return new Fb("unit out of range",`you specified ${T} (of type ${typeof T}) as a ${L}, which is invalid`)}function Ya(L,T,ja){T=new Date(Date.UTC(L,T-1,ja));100>L&&0<=L&&T.setUTCFullYear(T.getUTCFullYear()-1900);L=
T.getUTCDay();return 0===L?7:L}function Za(L,T){L=A(L)?td:ud;const ja=L.findIndex(va=>va<T);return{month:ja+1,day:T-L[ja]}}function Ha(L){const {year:T,month:ja,day:va}=L;var Aa=va+(A(T)?td:ud)[ja-1];const Fa=Ya(T,ja,va);Aa=Math.floor((Aa-Fa+10)/7);let Ma;1>Aa?(Ma=T-1,Aa=t(Ma)):Aa>t(T)?(Ma=T+1,Aa=1):Ma=T;return{weekYear:Ma,weekNumber:Aa,weekday:Fa,...H(L)}}function gb(L){const {weekYear:T,weekNumber:ja,weekday:va}=L;var Aa=Ya(T,1,4),Fa=A(T)?366:365;Aa=7*ja+va-Aa-3;1>Aa?(Fa=T-1,Aa+=A(Fa)?366:365):
Aa>Fa?(Fa=T+1,Aa-=A(T)?366:365):Fa=T;const {month:Ma,day:Ua}=Za(Fa,Aa);return{year:Fa,month:Ma,day:Ua,...H(L)}}function lb(L){const {year:T,month:ja,day:va}=L;var Aa=va+(A(T)?td:ud)[ja-1];return{year:T,ordinal:Aa,...H(L)}}function cb(L){const {year:T,ordinal:ja}=L,{month:va,day:Aa}=Za(T,ja);return{year:T,month:va,day:Aa,...H(L)}}function O(L){const T=a(L.year),ja=d(L.month,1,12),va=d(L.day,1,w(L.year,L.month));return T?ja?va?!1:Qa("day",L.day):Qa("month",L.month):Qa("year",L.year)}function fb(L){const {hour:T,
minute:ja,second:va,millisecond:Aa}=L;L=d(T,0,23)||24===T&&0===ja&&0===va&&0===Aa;const Fa=d(ja,0,59),Ma=d(va,0,59),Ua=d(Aa,0,999);return L?Fa?Ma?Ua?!1:Qa("millisecond",Aa):Qa("second",va):Qa("minute",ja):Qa("hour",T)}function sb(L){return new Fb("unsupported zone",`the zone "${L.name}" is not supported`)}function Jb(L){null===L.weekData&&(L.weekData=Ha(L.c));return L.weekData}function mb(L,T){L={ts:L.ts,zone:L.zone,c:L.c,o:L.o,loc:L.loc,invalid:L.invalid};return new $a({...L,...T,old:L})}function Ba(L,
T,ja){let va=L-6E4*T;const Aa=ja.offset(va);if(T===Aa)return[va,T];va-=6E4*(Aa-T);T=ja.offset(va);return Aa===T?[va,Aa]:[L-6E4*Math.min(Aa,T),Math.max(Aa,T)]}function mc(L,T){L=new Date(L+6E4*T);return{year:L.getUTCFullYear(),month:L.getUTCMonth()+1,day:L.getUTCDate(),hour:L.getUTCHours(),minute:L.getUTCMinutes(),second:L.getUTCSeconds(),millisecond:L.getUTCMilliseconds()}}function Sb(L,T,ja){return Ba(m(L),T,ja)}function Gb(L,T){const ja=L.o;var va=L.c.year+Math.trunc(T.years);const Aa=L.c.month+
Math.trunc(T.months)+3*Math.trunc(T.quarters);va={...L.c,year:va,month:Aa,day:Math.min(L.c.day,w(va,Aa))+Math.trunc(T.days)+7*Math.trunc(T.weeks)};T=kb.fromObject({years:T.years-Math.trunc(T.years),quarters:T.quarters-Math.trunc(T.quarters),months:T.months-Math.trunc(T.months),weeks:T.weeks-Math.trunc(T.weeks),days:T.days-Math.trunc(T.days),hours:T.hours,minutes:T.minutes,seconds:T.seconds,milliseconds:T.milliseconds}).as("milliseconds");va=m(va);let [Fa,Ma]=Ba(va,ja,L.zone);0!==T&&(Fa+=T,Ma=L.zone.offset(Fa));
return{ts:Fa,o:Ma}}function Pb(L,T,ja,va,Aa,Fa){const {setZone:Ma,zone:Ua}=ja;return L&&0!==Object.keys(L).length||T?(L=$a.fromObject(L,{...ja,zone:T||Ua,specificOffset:Fa}),Ma?L:L.setZone(Ua)):$a.invalid(new Fb("unparsable",`the input "${Aa}" can't be parsed as ${va}`))}function ic(L,T,ja=!0){return L.isValid?Db.create(qb.create("en-US"),{allowZ:ja,forceSimple:!0}).formatDateTimeFromString(L,T):null}function $b(L,T){const ja=9999<L.c.year||0>L.c.year;let va="";ja&&0<=L.c.year&&(va+="+");va+=p(L.c.year,
ja?6:4);T?(va=va+"-"+p(L.c.month),va=va+"-"+p(L.c.day)):(va+=p(L.c.month),va+=p(L.c.day));return va}function tc(L,T,ja,va,Aa,Fa){let Ma=p(L.c.hour);T?(Ma=Ma+":"+p(L.c.minute),0===L.c.second&&ja||(Ma+=":")):Ma+=p(L.c.minute);0===L.c.second&&ja||(Ma+=p(L.c.second),0===L.c.millisecond&&va||(Ma=Ma+"."+p(L.c.millisecond,3)));Aa&&(L.isOffsetFixed&&0===L.offset&&!Fa?Ma+="Z":0>L.o?(Ma=Ma+"-"+p(Math.trunc(-L.o/60)),Ma=Ma+":"+p(Math.trunc(-L.o%60))):(Ma=Ma+"+"+p(Math.trunc(L.o/60)),Ma=Ma+":"+p(Math.trunc(L.o%
60))));Fa&&(Ma+="["+L.zone.ianaName+"]");return Ma}function Hb(L){const T={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[L.toLowerCase()];
if(!T)throw new Ca(L);return T}function Lb(L,T){const ja=k(T.zone,yb.defaultZone);T=qb.fromObject(T);const va=yb.now();var Aa;if(g(L.year))L=va;else{for(const Fa of vd)g(L[Fa])&&(L[Fa]=Nc[Fa]);if(Aa=O(L)||fb(L))return $a.invalid(Aa);Aa=ja.offset(va);[L,Aa]=Sb(L,Aa,ja)}return new $a({ts:L,zone:ja,loc:T,o:Aa})}function pb(L,T,ja){const va=g(ja.round)?!0:ja.round,Aa=(Ma,Ua)=>{Ma=r(Ma,va||ja.calendary?0:2,!0);return T.loc.clone(ja).relFormatter(ja).format(Ma,Ua)},Fa=Ma=>ja.calendary?T.hasSame(L,Ma)?0:
T.startOf(Ma).diff(L.startOf(Ma),Ma).get(Ma):T.diff(L,Ma).get(Ma);if(ja.unit)return Aa(Fa(ja.unit),ja.unit);for(const Ma of ja.units){const Ua=Fa(Ma);if(1<=Math.abs(Ua))return Aa(Ua,Ma)}return Aa(L>T?-0:0,ja.units[ja.units.length-1])}function ob(L){let T={};0<L.length&&"object"===typeof L[L.length-1]?(T=L[L.length-1],L=Array.from(L).slice(0,L.length-1)):L=Array.from(L);return[T,L]}function Eb(L){if($a.isDateTime(L))return L;if(L&&L.valueOf&&b(L.valueOf()))return $a.fromJSDate(L);if(L&&"object"===
typeof L)return $a.fromObject(L);throw new Na(`Unknown datetime argument: ${L}, of type ${typeof L}`);}class ab extends Error{}class Tb extends ab{constructor(L){super(`Invalid DateTime: ${L.toMessage()}`)}}class pa extends ab{constructor(L){super(`Invalid Interval: ${L.toMessage()}`)}}class xa extends ab{constructor(L){super(`Invalid Duration: ${L.toMessage()}`)}}class sa extends ab{}class Ca extends ab{constructor(L){super(`Invalid unit ${L}`)}}class Na extends ab{}class Oa extends ab{constructor(){super("Zone is an abstract class")}}
const Wa={year:"numeric",month:"numeric",day:"numeric"},bb={year:"numeric",month:"short",day:"numeric"},ub={year:"numeric",month:"short",day:"numeric",weekday:"short"},tb={year:"numeric",month:"long",day:"numeric"},rb={year:"numeric",month:"long",day:"numeric",weekday:"long"},vb={hour:"numeric",minute:"numeric"},Mb={hour:"numeric",minute:"numeric",second:"numeric"},nc={hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},Wb={hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"long"},
wd={hour:"numeric",minute:"numeric",hourCycle:"h23"},uc={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23"},xd={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23",timeZoneName:"short"},vc={hour:"numeric",minute:"numeric",second:"numeric",hourCycle:"h23",timeZoneName:"long"},Fc={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"},ed={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},Gc={year:"numeric",
month:"short",day:"numeric",hour:"numeric",minute:"numeric"},yd={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},Oc={year:"numeric",month:"short",day:"numeric",weekday:"short",hour:"numeric",minute:"numeric"},Pd={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",timeZoneName:"short"},fd={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},Pc={year:"numeric",month:"long",
day:"numeric",weekday:"long",hour:"numeric",minute:"numeric",timeZoneName:"long"},Qc={year:"numeric",month:"long",day:"numeric",weekday:"long",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"long"};class Zb{get type(){throw new Oa;}get name(){throw new Oa;}get ianaName(){return this.name}get isUniversal(){throw new Oa;}offsetName(L,T){throw new Oa;}formatOffset(L,T){throw new Oa;}offset(L){throw new Oa;}equals(L){throw new Oa;}get isValid(){throw new Oa;}}let Rc=null;class ad extends Zb{static get instance(){null===
Rc&&(Rc=new ad);return Rc}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(L,{format:T,locale:ja}){return J(L,T,ja)}formatOffset(L,T){return I(this.offset(L),T)}offset(L){return-(new Date(L)).getTimezoneOffset()}equals(L){return"system"===L.type}get isValid(){return!0}}let wc={};const xc={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};let yc={};class Vb extends Zb{static create(L){yc[L]||(yc[L]=new Vb(L));return yc[L]}static resetCache(){yc=
{};wc={}}static isValidSpecifier(L){return this.isValidZone(L)}static isValidZone(L){if(!L)return!1;try{return(new Intl.DateTimeFormat("en-US",{timeZone:L})).format(),!0}catch(T){return!1}}constructor(L){super();this.zoneName=L;this.valid=Vb.isValidZone(L)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(L,{format:T,locale:ja}){return J(L,T,ja,this.name)}formatOffset(L,T){return I(this.offset(L),T)}offset(L){L=new Date(L);if(isNaN(L))return NaN;var T=this.name;
wc[T]||(wc[T]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:T,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}));T=wc[T];if(T.formatToParts){T=T.formatToParts(L);var ja=[];for(let R=0;R<T.length;R++){const {type:ib,value:db}=T[R],Kb=xc[ib];"era"===ib?ja[Kb]=db:g(Kb)||(ja[Kb]=parseInt(db,10))}T=ja}else{T=T.format(L).replace(/\u200E/g,"");T=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(T);const [,R,ib,db,Kb,Ga,sc,Z]=T;T=[db,R,
ib,Kb,Ga,sc,Z]}let [va,Aa,Fa,Ma,Ua,Xa,hb]=T;"BC"===Ma&&(va=-Math.abs(va)+1);T=m({year:va,month:Aa,day:Fa,hour:24===Ua?0:Ua,minute:Xa,second:hb,millisecond:0});L=+L;ja=L%1E3;return(T-(L-(0<=ja?ja:1E3+ja)))/6E4}equals(L){return"iana"===L.type&&L.name===this.name}get isValid(){return this.valid}}let qc={},od={},Rb={},Yb={},Hc=null;class zd{constructor(L,T,ja){this.padTo=ja.padTo||0;this.floor=ja.floor||!1;const {padTo:va,floor:Aa,...Fa}=ja;if(!T||0<Object.keys(Fa).length)T={useGrouping:!1,...ja},0<ja.padTo&&
(T.minimumIntegerDigits=ja.padTo),this.inf=F(L,T)}format(L){if(this.inf)return this.inf.format(this.floor?Math.floor(L):L);L=this.floor?Math.floor(L):r(L,3);return p(L,this.padTo)}}class gd{constructor(L,T,ja){this.opts=ja;ja=this.originalZone=void 0;this.opts.timeZone?this.dt=L:"fixed"===L.zone.type?(ja=L.offset/60*-1,ja=0<=ja?`Etc/GMT+${ja}`:`Etc/GMT${ja}`,0!==L.offset&&Vb.create(ja).valid?this.dt=L:(ja="UTC",this.dt=0===L.offset?L:L.setZone("UTC").plus({minutes:L.offset}),this.originalZone=L.zone)):
"system"===L.zone.type?this.dt=L:"iana"===L.zone.type?(this.dt=L,ja=L.zone.name):(ja="UTC",this.dt=L.setZone("UTC").plus({minutes:L.offset}),this.originalZone=L.zone);L={...this.opts};L.timeZone=L.timeZone||ja;this.dtf=G(T,L)}format(){return this.originalZone?this.formatToParts().map(({value:L})=>L).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const L=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?L.map(T=>{if("timeZoneName"===T.type){const ja=this.originalZone.offsetName(this.dt.ts,
{locale:this.dt.locale,format:this.opts.timeZoneName});return{...T,value:ja}}return T}):L}resolvedOptions(){return this.dtf.resolvedOptions()}}class ne{constructor(L,T,ja){this.opts={style:"long",...ja};!T&&h()&&(this.rtf=z(L,ja))}format(L,T){return this.rtf?this.rtf.format(L,T):la(T,L,this.opts.numeric,"long"!==this.opts.style)}formatToParts(L,T){return this.rtf?this.rtf.formatToParts(L,T):[]}}class qb{static fromOpts(L){return qb.create(L.locale,L.numberingSystem,L.outputCalendar,L.defaultToEN)}static create(L,
T,ja,va=!1){L=L||yb.defaultLocale;var Aa;(Aa=L)||(va?va="en-US":(Hc||(Hc=(new Intl.DateTimeFormat).resolvedOptions().locale),va=Hc),Aa=va);return new qb(Aa,T||yb.defaultNumberingSystem,ja||yb.defaultOutputCalendar,L)}static resetCache(){Hc=null;od={};Rb={};Yb={}}static fromObject({locale:L,numberingSystem:T,outputCalendar:ja}={}){return qb.create(L,T,ja)}constructor(L,T,ja,va){var Aa=L.indexOf("-x-");-1!==Aa&&(L=L.substring(0,Aa));Aa=L.indexOf("-u-");if(-1===Aa)var Fa=[L];else{try{Fa=G(L).resolvedOptions();
var Ma=L}catch(db){Ma=L.substring(0,Aa),Fa=G(Ma).resolvedOptions()}const {numberingSystem:R,calendar:ib}=Fa;Fa=[Ma,R,ib]}const [Ua,Xa,hb]=Fa;this.locale=Ua;this.numberingSystem=T||Xa||null;this.outputCalendar=ja||hb||null;T=this.locale;ja=this.numberingSystem;if((Fa=this.outputCalendar)||ja)T.includes("-u-")||(T+="-u"),Fa&&(T+=`-ca-${Fa}`),ja&&(T+=`-nu-${ja}`);this.intl=T;this.weekdaysCache={format:{},standalone:{}};this.monthsCache={format:{},standalone:{}};this.meridiemCache=null;this.eraCache=
{};this.specifiedLocale=va;this.fastNumbersCached=null}get fastNumbers(){if(null==this.fastNumbersCached){var L=this.numberingSystem&&"latn"!==this.numberingSystem?!1:"latn"===this.numberingSystem||!this.locale||this.locale.startsWith("en")||"latn"===(new Intl.DateTimeFormat(this.intl)).resolvedOptions().numberingSystem;this.fastNumbersCached=L}return this.fastNumbersCached}listingMode(){const L=this.isEnglish(),T=(null===this.numberingSystem||"latn"===this.numberingSystem)&&(null===this.outputCalendar||
"gregory"===this.outputCalendar);return L&&T?"en":"intl"}clone(L){return L&&0!==Object.getOwnPropertyNames(L).length?qb.create(L.locale||this.specifiedLocale,L.numberingSystem||this.numberingSystem,L.outputCalendar||this.outputCalendar,L.defaultToEN||!1):this}redefaultToEN(L={}){return this.clone({...L,defaultToEN:!0})}redefaultToSystem(L={}){return this.clone({...L,defaultToEN:!1})}months(L,T=!1,ja=!0){return x(this,L,ja,N,()=>{const va=T?{month:L,day:"numeric"}:{month:L},Aa=T?"format":"standalone";
this.monthsCache[Aa][L]||(this.monthsCache[Aa][L]=y(Fa=>this.extract(Fa,va,"month")));return this.monthsCache[Aa][L]})}weekdays(L,T=!1,ja=!0){return x(this,L,ja,U,()=>{const va=T?{weekday:L,year:"numeric",month:"long",day:"numeric"}:{weekday:L},Aa=T?"format":"standalone";this.weekdaysCache[Aa][L]||(this.weekdaysCache[Aa][L]=D(Fa=>this.extract(Fa,va,"weekday")));return this.weekdaysCache[Aa][L]})}meridiems(L=!0){return x(this,void 0,L,()=>ac,()=>{if(!this.meridiemCache){const T={hour:"numeric",hourCycle:"h12"};
this.meridiemCache=[$a.utc(2016,11,13,9),$a.utc(2016,11,13,19)].map(ja=>this.extract(ja,T,"dayperiod"))}return this.meridiemCache})}eras(L,T=!0){return x(this,L,T,ba,()=>{const ja={era:L};this.eraCache[L]||(this.eraCache[L]=[$a.utc(-40,1,1),$a.utc(2017,1,1)].map(va=>this.extract(va,ja,"era")));return this.eraCache[L]})}extract(L,T,ja){return(L=this.dtFormatter(L,T).formatToParts().find(va=>va.type.toLowerCase()===ja))?L.value:null}numberFormatter(L={}){return new zd(this.intl,L.forceSimple||this.fastNumbers,
L)}dtFormatter(L,T={}){return new gd(L,this.intl,T)}relFormatter(L={}){return new ne(this.intl,this.isEnglish(),L)}listFormatter(L={}){return n(this.intl,L)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||(new Intl.DateTimeFormat(this.intl)).resolvedOptions().locale.startsWith("en-us")}equals(L){return this.locale===L.locale&&this.numberingSystem===L.numberingSystem&&this.outputCalendar===L.outputCalendar}}let Ic=null;class Ib extends Zb{static get utcInstance(){null===
Ic&&(Ic=new Ib(0));return Ic}static instance(L){return 0===L?Ib.utcInstance:new Ib(L)}static parseSpecifier(L){return L&&(L=L.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i))?new Ib(C(L[1],L[2])):null}constructor(L){super();this.fixed=L}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${I(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${I(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(L,T){return I(this.fixed,T)}get isUniversal(){return!0}offset(){return this.fixed}equals(L){return"fixed"===
L.type&&L.fixed===this.fixed}get isValid(){return!0}}class bd extends Zb{constructor(L){super();this.zoneName=L}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}let Ad=()=>Date.now(),oc="system",Sc=null,hd=null,bc=null,id=60,zc;class yb{static get now(){return Ad}static set now(L){Ad=L}static set defaultZone(L){oc=L}static get defaultZone(){return k(oc,
ad.instance)}static get defaultLocale(){return Sc}static set defaultLocale(L){Sc=L}static get defaultNumberingSystem(){return hd}static set defaultNumberingSystem(L){hd=L}static get defaultOutputCalendar(){return bc}static set defaultOutputCalendar(L){bc=L}static get twoDigitCutoffYear(){return id}static set twoDigitCutoffYear(L){id=L%100}static get throwOnInvalid(){return zc}static set throwOnInvalid(L){zc=L}static resetCaches(){qb.resetCache();Vb.resetCache()}}const Ld="January February March April May June July August September October November December".split(" "),
pd="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),le="JFMAMJJASOND".split(""),rc="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),gc="Mon Tue Wed Thu Fri Sat Sun".split(" "),kc="MTWTFSS".split(""),ac=["AM","PM"],Nd=["Before Christ","Anno Domini"],Md=["BC","AD"],me=["B","A"],Bd={D:Wa,DD:bb,DDD:tb,DDDD:rb,t:vb,tt:Mb,ttt:nc,tttt:Wb,T:wd,TT:uc,TTT:xd,TTTT:vc,f:Fc,ff:Gc,fff:Pd,ffff:Pc,F:ed,FF:yd,FFF:fd,FFFF:Qc};class Db{static create(L,T={}){return new Db(L,T)}static parseFormat(L){let T=
null,ja="",va=!1;const Aa=[];for(let Fa=0;Fa<L.length;Fa++){const Ma=L.charAt(Fa);"'"===Ma?(0<ja.length&&Aa.push({literal:va||/^\s+$/.test(ja),val:ja}),T=null,ja="",va=!va):va?ja+=Ma:Ma===T?ja+=Ma:(0<ja.length&&Aa.push({literal:/^\s+$/.test(ja),val:ja}),T=ja=Ma)}0<ja.length&&Aa.push({literal:va||/^\s+$/.test(ja),val:ja});return Aa}static macroTokenToFormatOpts(L){return Bd[L]}constructor(L,T){this.opts=T;this.loc=L;this.systemLoc=null}formatWithSystemDefault(L,T){null===this.systemLoc&&(this.systemLoc=
this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(L,{...this.opts,...T}).format()}formatDateTime(L,T={}){return this.loc.dtFormatter(L,{...this.opts,...T}).format()}formatDateTimeParts(L,T={}){return this.loc.dtFormatter(L,{...this.opts,...T}).formatToParts()}formatInterval(L,T={}){return this.loc.dtFormatter(L.start,{...this.opts,...T}).dtf.formatRange(L.start.toJSDate(),L.end.toJSDate())}resolvedOptions(L,T={}){return this.loc.dtFormatter(L,{...this.opts,...T}).resolvedOptions()}num(L,
T=0){if(this.opts.forceSimple)return p(L,T);const ja={...this.opts};0<T&&(ja.padTo=T);return this.loc.numberFormatter(ja).format(L)}formatDateTimeFromString(L,T){const ja="en"===this.loc.listingMode(),va=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,Aa=(R,ib)=>this.loc.extract(L,R,ib),Fa=R=>L.isOffsetFixed&&0===L.offset&&R.allowZ?"Z":L.isValid?L.zone.formatOffset(L.ts,R.format):"",Ma=(R,ib)=>ja?N(R)[L.month-1]:Aa(ib?{month:R}:{month:R,day:"numeric"},"month"),Ua=(R,ib)=>ja?U(R)[L.weekday-
1]:Aa(ib?{weekday:R}:{weekday:R,month:"long",day:"numeric"},"weekday"),Xa=R=>{const ib=Db.macroTokenToFormatOpts(R);return ib?this.formatWithSystemDefault(L,ib):R},hb=R=>ja?ba(R)[0>L.year?0:1]:Aa({era:R},"era");return aa(Db.parseFormat(T),R=>{switch(R){case "S":return this.num(L.millisecond);case "u":case "SSS":return this.num(L.millisecond,3);case "s":return this.num(L.second);case "ss":return this.num(L.second,2);case "uu":return this.num(Math.floor(L.millisecond/10),2);case "uuu":return this.num(Math.floor(L.millisecond/
100));case "m":return this.num(L.minute);case "mm":return this.num(L.minute,2);case "h":return this.num(0===L.hour%12?12:L.hour%12);case "hh":return this.num(0===L.hour%12?12:L.hour%12,2);case "H":return this.num(L.hour);case "HH":return this.num(L.hour,2);case "Z":return Fa({format:"narrow",allowZ:this.opts.allowZ});case "ZZ":return Fa({format:"short",allowZ:this.opts.allowZ});case "ZZZ":return Fa({format:"techie",allowZ:this.opts.allowZ});case "ZZZZ":return L.zone.offsetName(L.ts,{format:"short",
locale:this.loc.locale});case "ZZZZZ":return L.zone.offsetName(L.ts,{format:"long",locale:this.loc.locale});case "z":return L.zoneName;case "a":return ja?ac[12>L.hour?0:1]:Aa({hour:"numeric",hourCycle:"h12"},"dayperiod");case "d":return va?Aa({day:"numeric"},"day"):this.num(L.day);case "dd":return va?Aa({day:"2-digit"},"day"):this.num(L.day,2);case "c":return this.num(L.weekday);case "ccc":return Ua("short",!0);case "cccc":return Ua("long",!0);case "ccccc":return Ua("narrow",!0);case "E":return this.num(L.weekday);
case "EEE":return Ua("short",!1);case "EEEE":return Ua("long",!1);case "EEEEE":return Ua("narrow",!1);case "L":return va?Aa({month:"numeric",day:"numeric"},"month"):this.num(L.month);case "LL":return va?Aa({month:"2-digit",day:"numeric"},"month"):this.num(L.month,2);case "LLL":return Ma("short",!0);case "LLLL":return Ma("long",!0);case "LLLLL":return Ma("narrow",!0);case "M":return va?Aa({month:"numeric"},"month"):this.num(L.month);case "MM":return va?Aa({month:"2-digit"},"month"):this.num(L.month,
2);case "MMM":return Ma("short",!1);case "MMMM":return Ma("long",!1);case "MMMMM":return Ma("narrow",!1);case "y":return va?Aa({year:"numeric"},"year"):this.num(L.year);case "yy":return va?Aa({year:"2-digit"},"year"):this.num(L.year.toString().slice(-2),2);case "yyyy":return va?Aa({year:"numeric"},"year"):this.num(L.year,4);case "yyyyyy":return va?Aa({year:"numeric"},"year"):this.num(L.year,6);case "G":return hb("short");case "GG":return hb("long");case "GGGGG":return hb("narrow");case "kk":return this.num(L.weekYear.toString().slice(-2),
2);case "kkkk":return this.num(L.weekYear,4);case "W":return this.num(L.weekNumber);case "WW":return this.num(L.weekNumber,2);case "o":return this.num(L.ordinal);case "ooo":return this.num(L.ordinal,3);case "q":return this.num(L.quarter);case "qq":return this.num(L.quarter,2);case "X":return this.num(Math.floor(L.ts/1E3));case "x":return this.num(L.ts);default:return Xa(R)}})}formatDurationFromString(L,T){const ja=Aa=>{switch(Aa[0]){case "S":return"millisecond";case "s":return"second";case "m":return"minute";
case "h":return"hour";case "d":return"day";case "w":return"week";case "M":return"month";case "y":return"year";default:return null}};T=Db.parseFormat(T);const va=T.reduce((Aa,{literal:Fa,val:Ma})=>Fa?Aa:Aa.concat(Ma),[]);L=L.shiftTo(...va.map(ja).filter(Aa=>Aa));return aa(T,(Aa=>Fa=>{const Ma=ja(Fa);return Ma?this.num(Aa.get(Ma),Fa.length):Fa})(L))}}class Fb{constructor(L,T){this.reason=L;this.explanation=T}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const Qb=
/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/,Ub=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Jc=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,Cd=RegExp(`${Jc.source}${`(?:${Ub.source}?(?:\\[(${Qb.source})\\])?)?`}`),Ac=RegExp(`(?:T${Cd.source})?`),oe=S("weekYear","weekNumber","weekDay"),Qd=S("year","ordinal"),Dd=RegExp(`${Jc.source} ?(?:${Ub.source}|(${Qb.source}))?`),Ed=RegExp(`(?: ${Dd.source})?`),Fd=RegExp(`^T?${Jc.source}$`),pe=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/,
Od={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480},qe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/,Rd=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Sd=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,
Tc=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/,jd=ka(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Ac),Bc=ka(/(\d{4})-?W(\d\d)(?:-?(\d))?/,Ac),Td=ka(/(\d{4})-?(\d{3})/,Ac),Ud=ka(Cd),Gd=V(function(L,T){return[{year:X(L,T),month:X(L,T+1,1),day:X(L,T+2,1)},null,T+3]},ra,Y,ua),kd=V(oe,ra,Y,ua),Vd=V(Qd,ra,Y,ua),Hd=V(ra,Y,ua),jc=V(ra),Kc=ka(/(\d{4})-(\d\d)-(\d\d)/,Ed),Uc=ka(Dd),ld=V(ra,Y,ua),md={weeks:{days:7,hours:168,minutes:10080,
seconds:604800,milliseconds:6048E5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864E5},hours:{minutes:60,seconds:3600,milliseconds:36E5},minutes:{seconds:60,milliseconds:6E4},seconds:{milliseconds:1E3}},Id={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536E3,milliseconds:31536E6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624E5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592E3,milliseconds:2592E6},
...md},Vc={years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:31556952,milliseconds:31556952E3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:7889238,milliseconds:7889238E3},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746E3},...md},pc="years quarters months weeks days hours minutes seconds milliseconds".split(" "),qd=pc.slice(0).reverse();class kb{constructor(L){const T=
"longterm"===L.conversionAccuracy||!1;let ja=T?Vc:Id;L.matrix&&(ja=L.matrix);this.values=L.values;this.loc=L.loc||qb.create();this.conversionAccuracy=T?"longterm":"casual";this.invalid=L.invalid||null;this.matrix=ja;this.isLuxonDuration=!0}static fromMillis(L,T){return kb.fromObject({milliseconds:L},T)}static fromObject(L,T={}){if(null==L||"object"!==typeof L)throw new Na(`Duration.fromObject: argument expected to be an object, got ${null===L?"null":typeof L}`);return new kb({values:E(L,kb.normalizeUnit),
loc:qb.fromObject(T),conversionAccuracy:T.conversionAccuracy,matrix:T.matrix})}static fromDurationLike(L){if(b(L))return kb.fromMillis(L);if(kb.isDuration(L))return L;if("object"===typeof L)return kb.fromObject(L);throw new Na(`Unknown duration argument ${L} of type ${typeof L}`);}static fromISO(L,T){const [ja]=P(L,[pe,ca]);return ja?kb.fromObject(ja,T):kb.invalid("unparsable",`the input "${L}" can't be parsed as ISO 8601`)}static fromISOTime(L,T){const [ja]=P(L,[Fd,jc]);return ja?kb.fromObject(ja,
T):kb.invalid("unparsable",`the input "${L}" can't be parsed as ISO 8601`)}static invalid(L,T=null){if(!L)throw new Na("need to specify a reason the Duration is invalid");L=L instanceof Fb?L:new Fb(L,T);if(yb.throwOnInvalid)throw new xa(L);return new kb({invalid:L})}static normalizeUnit(L){const T={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",
second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[L?L.toLowerCase():L];if(!T)throw new Ca(L);return T}static isDuration(L){return L&&L.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(L,T={}){T={...T,floor:!1!==T.round&&!1!==T.floor};return this.isValid?Db.create(this.loc,T).formatDurationFromString(this,L):"Invalid Duration"}toHuman(L={}){const T=pc.map(ja=>
{const va=this.values[ja];return g(va)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...L,unit:ja.slice(0,-1)}).format(va)}).filter(ja=>ja);return this.loc.listFormatter({type:"conjunction",style:L.listStyle||"narrow",...L}).format(T)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let L="P";0!==this.years&&(L+=this.years+"Y");if(0!==this.months||0!==this.quarters)L+=this.months+3*this.quarters+"M";0!==this.weeks&&(L+=this.weeks+"W");0!==this.days&&
(L+=this.days+"D");if(0!==this.hours||0!==this.minutes||0!==this.seconds||0!==this.milliseconds)L+="T";0!==this.hours&&(L+=this.hours+"H");0!==this.minutes&&(L+=this.minutes+"M");if(0!==this.seconds||0!==this.milliseconds)L+=r(this.seconds+this.milliseconds/1E3,3)+"S";"P"===L&&(L+="T0S");return L}toISOTime(L={}){if(!this.isValid)return null;var T=this.toMillis();if(0>T||864E5<=T)return null;L={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...L};T=this.shiftTo("hours",
"minutes","seconds","milliseconds");let ja="basic"===L.format?"hhmm":"hh:mm";L.suppressSeconds&&0===T.seconds&&0===T.milliseconds||(ja+="basic"===L.format?"ss":":ss",L.suppressMilliseconds&&0===T.milliseconds||(ja+=".SSS"));T=T.toFormat(ja);L.includePrefix&&(T="T"+T);return T}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(L){if(!this.isValid)return this;L=kb.fromDurationLike(L);const T={};for(const ja of pc)if(c(L.values,
ja)||c(this.values,ja))T[ja]=L.get(ja)+this.get(ja);return fa(this,{values:T},!0)}minus(L){if(!this.isValid)return this;L=kb.fromDurationLike(L);return this.plus(L.negate())}mapUnits(L){if(!this.isValid)return this;const T={};for(const ja of Object.keys(this.values))T[ja]=K(L(this.values[ja],ja));return fa(this,{values:T},!0)}get(L){return this[kb.normalizeUnit(L)]}set(L){if(!this.isValid)return this;L={...this.values,...E(L,kb.normalizeUnit)};return fa(this,{values:L})}reconfigure({locale:L,numberingSystem:T,
conversionAccuracy:ja,matrix:va}={}){L={loc:this.loc.clone({locale:L,numberingSystem:T}),matrix:va,conversionAccuracy:ja};return fa(this,L)}as(L){return this.isValid?this.shiftTo(L).get(L):NaN}normalize(){if(!this.isValid)return this;const L=this.toObject();za(this.matrix,L);return fa(this,{values:L},!0)}rescale(){if(!this.isValid)return this;var L=this.normalize().shiftToAll().toObject();const T={};for(const [ja,va]of Object.entries(L))0!==va&&(T[ja]=va);return fa(this,{values:T},!0)}shiftTo(...L){if(!this.isValid||
0===L.length)return this;L=L.map(Fa=>kb.normalizeUnit(Fa));const T={},ja={},va=this.toObject();let Aa;for(const Fa of pc)if(0<=L.indexOf(Fa)){Aa=Fa;let Ma=0;for(const Xa in ja)Ma+=this.matrix[Xa][Fa]*ja[Xa],ja[Xa]=0;b(va[Fa])&&(Ma+=va[Fa]);const Ua=Math.trunc(Ma);T[Fa]=Ua;ja[Fa]=(1E3*Ma-1E3*Ua)/1E3;for(const Xa in va)pc.indexOf(Xa)>pc.indexOf(Fa)&&na(this.matrix,va,Xa,T,Fa)}else b(va[Fa])&&(ja[Fa]=va[Fa]);for(const Fa in ja)0!==ja[Fa]&&(T[Aa]+=Fa===Aa?ja[Fa]:ja[Fa]/this.matrix[Aa][Fa]);return fa(this,
{values:T},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const L={};for(const T of Object.keys(this.values))L[T]=0===this.values[T]?0:-this.values[T];return fa(this,{values:L},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?
this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:
null}equals(L){if(!this.isValid||!L.isValid||!this.loc.equals(L.loc))return!1;for(const va of pc){var T=this.values[va];var ja=L.values[va];T=void 0===T||0===T?void 0===ja||0===ja:T===ja;if(!T)return!1}return!0}}class zb{constructor(L){this.s=L.start;this.e=L.end;this.invalid=L.invalid||null;this.isLuxonInterval=!0}static invalid(L,T=null){if(!L)throw new Na("need to specify a reason the Interval is invalid");L=L instanceof Fb?L:new Fb(L,T);if(yb.throwOnInvalid)throw new pa(L);return new zb({invalid:L})}static fromDateTimes(L,
T){L=Eb(L);T=Eb(T);var ja=L&&L.isValid?T&&T.isValid?T<L?zb.invalid("end before start",`The end of an interval must be after its start, but you had start=${L.toISO()} and end=${T.toISO()}`):null:zb.invalid("missing or invalid end"):zb.invalid("missing or invalid start");return null==ja?new zb({start:L,end:T}):ja}static after(L,T){T=kb.fromDurationLike(T);L=Eb(L);return zb.fromDateTimes(L,L.plus(T))}static before(L,T){T=kb.fromDurationLike(T);L=Eb(L);return zb.fromDateTimes(L.minus(T),L)}static fromISO(L,
T){const [ja,va]=(L||"").split("/",2);if(ja&&va){let Ma;try{var Aa=$a.fromISO(ja,T);Ma=Aa.isValid}catch(Xa){Ma=!1}let Ua;try{var Fa=$a.fromISO(va,T);Ua=Fa.isValid}catch(Xa){Ua=!1}if(Ma&&Ua)return zb.fromDateTimes(Aa,Fa);if(Ma){if(Fa=kb.fromISO(va,T),Fa.isValid)return zb.after(Aa,Fa)}else if(Ua&&(Aa=kb.fromISO(ja,T),Aa.isValid))return zb.before(Fa,Aa)}return zb.invalid("unparsable",`the input "${L}" can't be parsed as ISO 8601`)}static isInterval(L){return L&&L.isLuxonInterval||!1}get start(){return this.isValid?
this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(L="milliseconds"){return this.isValid?this.toDuration(...[L]).get(L):NaN}count(L="milliseconds"){if(!this.isValid)return NaN;const T=this.start.startOf(L),ja=this.end.startOf(L);return Math.floor(ja.diff(T,L).get(L))+(ja.valueOf()!==this.end.valueOf())}hasSame(L){return this.isValid?
this.isEmpty()||this.e.minus(1).hasSame(this.s,L):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(L){return this.isValid?this.s>L:!1}isBefore(L){return this.isValid?this.e<=L:!1}contains(L){return this.isValid?this.s<=L&&this.e>L:!1}set({start:L,end:T}={}){return this.isValid?zb.fromDateTimes(L||this.s,T||this.e):this}splitAt(...L){if(!this.isValid)return[];L=L.map(Eb).filter(Fa=>this.contains(Fa)).sort();const T=[];let {s:ja}=this,va=0;for(;ja<this.e;){var Aa=L[va]||this.e;Aa=+Aa>
+this.e?this.e:Aa;T.push(zb.fromDateTimes(ja,Aa));ja=Aa;va+=1}return T}splitBy(L){L=kb.fromDurationLike(L);if(!this.isValid||!L.isValid||0===L.as("milliseconds"))return[];let {s:T}=this,ja=1;const va=[];for(;T<this.e;){var Aa=this.start.plus(L.mapUnits(Fa=>Fa*ja));Aa=+Aa>+this.e?this.e:Aa;va.push(zb.fromDateTimes(T,Aa));T=Aa;ja+=1}return va}divideEqually(L){return this.isValid?this.splitBy(this.length()/L).slice(0,L):[]}overlaps(L){return this.e>L.s&&this.s<L.e}abutsStart(L){return this.isValid?+this.e===
+L.s:!1}abutsEnd(L){return this.isValid?+L.e===+this.s:!1}engulfs(L){return this.isValid?this.s<=L.s&&this.e>=L.e:!1}equals(L){return this.isValid&&L.isValid?this.s.equals(L.s)&&this.e.equals(L.e):!1}intersection(L){if(!this.isValid)return this;const T=this.s>L.s?this.s:L.s;L=this.e<L.e?this.e:L.e;return T>=L?null:zb.fromDateTimes(T,L)}union(L){return this.isValid?zb.fromDateTimes(this.s<L.s?this.s:L.s,this.e>L.e?this.e:L.e):this}static merge(L){const [T,ja]=L.sort((va,Aa)=>va.s-Aa.s).reduce(([va,
Aa],Fa)=>Aa?Aa.overlaps(Fa)||Aa.abutsStart(Fa)?[va,Aa.union(Fa)]:[va.concat([Aa]),Fa]:[va,Fa],[[],null]);ja&&T.push(ja);return T}static xor(L){let T=null,ja=0;const va=[];L=L.map(Aa=>[{time:Aa.s,type:"s"},{time:Aa.e,type:"e"}]);L=Array.prototype.concat(...L).sort((Aa,Fa)=>Aa.time-Fa.time);for(const Aa of L)ja+="s"===Aa.type?1:-1,1===ja?T=Aa.time:(T&&+T!==+Aa.time&&va.push(zb.fromDateTimes(T,Aa.time)),T=null);return zb.merge(va)}difference(...L){return zb.xor([this].concat(L)).map(T=>this.intersection(T)).filter(T=>
T&&!T.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:"Invalid Interval"}toLocaleString(L=Wa,T={}){return this.isValid?Db.create(this.s.loc.clone(T),L).formatInterval(this):"Invalid Interval"}toISO(L){return this.isValid?`${this.s.toISO(L)}/${this.e.toISO(L)}`:"Invalid Interval"}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:"Invalid Interval"}toISOTime(L){return this.isValid?`${this.s.toISOTime(L)}/${this.e.toISOTime(L)}`:"Invalid Interval"}toFormat(L,
{separator:T=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(L)}${T}${this.e.toFormat(L)}`:"Invalid Interval"}toDuration(L,T){return this.isValid?this.e.diff(this.s,L,T):kb.invalid(this.invalidReason)}mapEndpoints(L){return zb.fromDateTimes(L(this.s),L(this.e))}}class Wc{static hasDST(L=yb.defaultZone){const T=$a.now().setZone(L).set({month:12});return!L.isUniversal&&T.offset!==T.set({month:6}).offset}static isValidIANAZone(L){return Vb.isValidZone(L)}static normalizeZone(L){return k(L,yb.defaultZone)}static months(L=
"long",{locale:T=null,numberingSystem:ja=null,locObj:va=null,outputCalendar:Aa="gregory"}={}){return(va||qb.create(T,ja,Aa)).months(L)}static monthsFormat(L="long",{locale:T=null,numberingSystem:ja=null,locObj:va=null,outputCalendar:Aa="gregory"}={}){return(va||qb.create(T,ja,Aa)).months(L,!0)}static weekdays(L="long",{locale:T=null,numberingSystem:ja=null,locObj:va=null}={}){return(va||qb.create(T,ja,null)).weekdays(L)}static weekdaysFormat(L="long",{locale:T=null,numberingSystem:ja=null,locObj:va=
null}={}){return(va||qb.create(T,ja,null)).weekdays(L,!0)}static meridiems({locale:L=null}={}){return qb.create(L).meridiems()}static eras(L="short",{locale:T=null}={}){return qb.create(T,null,"gregory").eras(L)}static features(){return{relative:h()}}}const rd={arab:"[\u0660-\u0669]",arabext:"[\u06f0-\u06f9]",bali:"[\u1b50-\u1b59]",beng:"[\u09e6-\u09ef]",deva:"[\u0966-\u096f]",fullwide:"[\uff10-\uff19]",gujr:"[\u0ae6-\u0aef]",hanidec:"[\u3007|\u4e00|\u4e8c|\u4e09|\u56db|\u4e94|\u516d|\u4e03|\u516b|\u4e5d]",
khmr:"[\u17e0-\u17e9]",knda:"[\u0ce6-\u0cef]",laoo:"[\u0ed0-\u0ed9]",limb:"[\u1946-\u194f]",mlym:"[\u0d66-\u0d6f]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0b66-\u0b6f]",tamldec:"[\u0be6-\u0bef]",telu:"[\u0c66-\u0c6f]",thai:"[\u0e50-\u0e59]",tibt:"[\u0f20-\u0f29]",latn:"\\d"},cd={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,
3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},lc=rd.hanidec.replace(/[\[|\]]/g,"").split(""),Ec=`[ ${String.fromCharCode(160)}]`,hc=new RegExp(Ec,"g"),sd={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s",
"2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let dd=null;const ud=[0,31,59,90,120,151,181,212,243,273,304,334],td=[0,31,60,91,121,152,182,213,244,274,305,335],Nc={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Jd={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},re={ordinal:1,hour:0,minute:0,second:0,millisecond:0},vd="year month day hour minute second millisecond".split(" "),eb="weekYear weekNumber weekday hour minute second millisecond".split(" "),Ab="year ordinal hour minute second millisecond".split(" ");
class $a{constructor(L){const T=L.zone||yb.defaultZone;let ja=L.invalid||(Number.isNaN(L.ts)?new Fb("invalid input"):null)||(T.isValid?null:sb(T));this.ts=g(L.ts)?yb.now():L.ts;let va=null;var Aa=null;ja||(L.old&&L.old.ts===this.ts&&L.old.zone.equals(T)?[va,Aa]=[L.old.c,L.old.o]:(Aa=T.offset(this.ts),va=mc(this.ts,Aa),va=(ja=Number.isNaN(va.year)?new Fb("invalid input"):null)?null:va,Aa=ja?null:Aa));this._zone=T;this.loc=L.loc||qb.create();this.invalid=ja;this.weekData=null;this.c=va;this.o=Aa;this.isLuxonDateTime=
!0}static now(){return new $a({})}static local(){const [L,T]=ob(arguments),[ja,va,Aa,Fa,Ma,Ua,Xa]=T;return Lb({year:ja,month:va,day:Aa,hour:Fa,minute:Ma,second:Ua,millisecond:Xa},L)}static utc(){const [L,T]=ob(arguments),[ja,va,Aa,Fa,Ma,Ua,Xa]=T;L.zone=Ib.utcInstance;return Lb({year:ja,month:va,day:Aa,hour:Fa,minute:Ma,second:Ua,millisecond:Xa},L)}static fromJSDate(L,T={}){L="[object Date]"===Object.prototype.toString.call(L)?L.valueOf():NaN;if(Number.isNaN(L))return $a.invalid("invalid input");const ja=
k(T.zone,yb.defaultZone);return ja.isValid?new $a({ts:L,zone:ja,loc:qb.fromObject(T)}):$a.invalid(sb(ja))}static fromMillis(L,T={}){if(b(L))return-864E13>L||864E13<L?$a.invalid("Timestamp out of range"):new $a({ts:L,zone:k(T.zone,yb.defaultZone),loc:qb.fromObject(T)});throw new Na(`fromMillis requires a numerical input, but received a ${typeof L} with value ${L}`);}static fromSeconds(L,T={}){if(b(L))return new $a({ts:1E3*L,zone:k(T.zone,yb.defaultZone),loc:qb.fromObject(T)});throw new Na("fromSeconds requires a numerical input");
}static fromObject(L,T={}){L=L||{};var ja=k(T.zone,yb.defaultZone);if(!ja.isValid)return $a.invalid(sb(ja));var va=yb.now();const Aa=g(T.specificOffset)?ja.offset(va):T.specificOffset,Fa=E(L,Hb);var Ma=!g(Fa.ordinal),Ua=!g(Fa.year),Xa=!g(Fa.month)||!g(Fa.day);Ua=Ua||Xa;var hb=Fa.weekYear||Fa.weekNumber;T=qb.fromObject(T);if((Ua||Ma)&&hb)throw new sa("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(Xa&&Ma)throw new sa("Can't mix ordinal dates with month/day");Xa=hb||Fa.weekday&&
!Ua;let R=mc(va,Aa);Xa?(va=eb,hb=Jd,R=Ha(R)):Ma?(va=Ab,hb=re,R=lb(R)):(va=vd,hb=Nc);let ib=!1;for(var db of va)g(Fa[db])?Fa[db]=ib?hb[db]:R[db]:ib=!0;Xa?(db=a(Fa.weekYear),va=d(Fa.weekNumber,1,t(Fa.weekYear)),hb=d(Fa.weekday,1,7),db=db?va?hb?!1:Qa("weekday",Fa.weekday):Qa("week",Fa.week):Qa("weekYear",Fa.weekYear)):Ma?(db=a(Fa.year),va=d(Fa.ordinal,1,A(Fa.year)?366:365),db=db?va?!1:Qa("ordinal",Fa.ordinal):Qa("year",Fa.year)):db=O(Fa);if(db=db||fb(Fa))return $a.invalid(db);Ma=Xa?gb(Fa):Ma?cb(Fa):
Fa;const [Kb,Ga]=Sb(Ma,Aa,ja);ja=new $a({ts:Kb,zone:ja,o:Ga,loc:T});return Fa.weekday&&Ua&&L.weekday!==ja.weekday?$a.invalid("mismatched weekday",`you can't specify both a weekday of ${Fa.weekday} and a date of ${ja.toISO()}`):ja}static fromISO(L,T={}){const [ja,va]=P(L,[jd,Gd],[Bc,kd],[Td,Vd],[Ud,Hd]);return Pb(ja,va,T,"ISO 8601",L)}static fromRFC2822(L,T={}){const [ja,va]=P(L.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim(),[qe,oa]);return Pb(ja,va,T,"RFC 2822",L)}static fromHTTP(L,
T={}){const [ja,va]=P(L,[Rd,M],[Sd,M],[Tc,Q]);return Pb(ja,va,T,"HTTP",T)}static fromFormat(L,T,ja={}){if(g(L)||g(T))throw new Na("fromFormat requires an input string and a format");const {locale:va=null,numberingSystem:Aa=null}=ja,Fa=qb.fromOpts({locale:va,numberingSystem:Aa,defaultToEN:!0}),{result:Ma,zone:Ua,specificOffset:Xa,invalidReason:hb}=Sa(Fa,L,T),[R,ib,db,Kb]=[Ma,Ua,Xa,hb];return Kb?$a.invalid(Kb):Pb(R,ib,ja,`format ${T}`,L,db)}static fromString(L,T,ja={}){return $a.fromFormat(L,T,ja)}static fromSQL(L,
T={}){const [ja,va]=P(L,[Kc,Gd],[Uc,ld]);return Pb(ja,va,T,"SQL",L)}static invalid(L,T=null){if(!L)throw new Na("need to specify a reason the DateTime is invalid");L=L instanceof Fb?L:new Fb(L,T);if(yb.throwOnInvalid)throw new Tb(L);return new $a({invalid:L})}static isDateTime(L){return L&&L.isLuxonDateTime||!1}static parseFormatForOpts(L,T={}){return(L=Ta(L,qb.fromObject(T)))?L.map(ja=>ja?ja.val:null).join(""):null}static expandFormat(L,T={}){return Pa(Db.parseFormat(L),qb.fromObject(T)).map(ja=>
ja.val).join("")}get(L){return this[L]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?
this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?Jb(this).weekYear:NaN}get weekNumber(){return this.isValid?Jb(this).weekNumber:NaN}get weekday(){return this.isValid?
Jb(this).weekday:NaN}get ordinal(){return this.isValid?lb(this.c).ordinal:NaN}get monthShort(){return this.isValid?Wc.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Wc.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Wc.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Wc.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?
this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return A(this.year)}get daysInMonth(){return w(this.year,this.month)}get daysInYear(){return this.isValid?
A(this.year)?366:365:NaN}get weeksInWeekYear(){return this.isValid?t(this.weekYear):NaN}resolvedLocaleOptions(L={}){const {locale:T,numberingSystem:ja,calendar:va}=Db.create(this.loc.clone(L),L).resolvedOptions(this);return{locale:T,numberingSystem:ja,outputCalendar:va}}toUTC(L=0,T={}){return this.setZone(Ib.instance(L),T)}toLocal(){return this.setZone(yb.defaultZone)}setZone(L,{keepLocalTime:T=!1,keepCalendarTime:ja=!1}={}){L=k(L,yb.defaultZone);if(L.equals(this.zone))return this;if(L.isValid){let va=
this.ts;if(T||ja)T=L.offset(this.ts),ja=this.toObject(),[va]=Sb(ja,T,L);return mb(this,{ts:va,zone:L})}return $a.invalid(sb(L))}reconfigure({locale:L,numberingSystem:T,outputCalendar:ja}={}){L=this.loc.clone({locale:L,numberingSystem:T,outputCalendar:ja});return mb(this,{loc:L})}setLocale(L){return this.reconfigure({locale:L})}set(L){if(!this.isValid)return this;L=E(L,Hb);var T=!g(L.weekYear)||!g(L.weekNumber)||!g(L.weekday);const ja=!g(L.ordinal),va=!g(L.year),Aa=!g(L.month)||!g(L.day),Fa=L.weekYear||
L.weekNumber;if((va||Aa||ja)&&Fa)throw new sa("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(Aa&&ja)throw new sa("Can't mix ordinal dates with month/day");T?T=gb({...Ha(this.c),...L}):g(L.ordinal)?(T={...this.toObject(),...L},g(L.day)&&(T.day=Math.min(w(T.year,T.month),T.day))):T=cb({...lb(this.c),...L});const [Ma,Ua]=Sb(T,this.o,this.zone);return mb(this,{ts:Ma,o:Ua})}plus(L){if(!this.isValid)return this;L=kb.fromDurationLike(L);return mb(this,Gb(this,L))}minus(L){if(!this.isValid)return this;
L=kb.fromDurationLike(L).negate();return mb(this,Gb(this,L))}startOf(L){if(!this.isValid)return this;const T={};L=kb.normalizeUnit(L);switch(L){case "years":T.month=1;case "quarters":case "months":T.day=1;case "weeks":case "days":T.hour=0;case "hours":T.minute=0;case "minutes":T.second=0;case "seconds":T.millisecond=0}"weeks"===L&&(T.weekday=1);"quarters"===L&&(T.month=3*(Math.ceil(this.month/3)-1)+1);return this.set(T)}endOf(L){return this.isValid?this.plus({[L]:1}).startOf(L).minus(1):this}toFormat(L,
T={}){return this.isValid?Db.create(this.loc.redefaultToEN(T)).formatDateTimeFromString(this,L):"Invalid DateTime"}toLocaleString(L=Wa,T={}){return this.isValid?Db.create(this.loc.clone(T),L).formatDateTime(this):"Invalid DateTime"}toLocaleParts(L={}){return this.isValid?Db.create(this.loc.clone(L),L).formatDateTimeParts(this):[]}toISO({format:L="extended",suppressSeconds:T=!1,suppressMilliseconds:ja=!1,includeOffset:va=!0,extendedZone:Aa=!1}={}){if(!this.isValid)return null;L="extended"===L;let Fa=
$b(this,L);return Fa=Fa+"T"+tc(this,L,T,ja,va,Aa)}toISODate({format:L="extended"}={}){return this.isValid?$b(this,"extended"===L):null}toISOWeekDate(){return ic(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:L=!1,suppressSeconds:T=!1,includeOffset:ja=!0,includePrefix:va=!1,extendedZone:Aa=!1,format:Fa="extended"}={}){return this.isValid?(va?"T":"")+tc(this,"extended"===Fa,T,L,ja,Aa):null}toRFC2822(){return ic(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return ic(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?
$b(this,!0):null}toSQLTime({includeOffset:L=!0,includeZone:T=!1,includeOffsetSpace:ja=!0}={}){let va="HH:mm:ss.SSS";if(T||L)ja&&(va+=" "),T?va+="z":L&&(va+="ZZ");return ic(this,va,!0)}toSQL(L={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(L)}`:null}toString(){return this.isValid?this.toISO():"Invalid DateTime"}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1E3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/
1E3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(L={}){if(!this.isValid)return{};const T={...this.c};L.includeConfig&&(T.outputCalendar=this.outputCalendar,T.numberingSystem=this.loc.numberingSystem,T.locale=this.loc.locale);return T}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(L,T="milliseconds",ja={}){if(!this.isValid||!L.isValid)return kb.invalid("created by diffing an invalid DateTime");ja={locale:this.locale,numberingSystem:this.numberingSystem,...ja};
const va=(Array.isArray(T)?T:[T]).map(kb.normalizeUnit);T=L.valueOf()>this.valueOf();L=ha(T?this:L,T?L:this,va,ja);return T?L.negate():L}diffNow(L="milliseconds",T={}){return this.diff($a.now(),L,T)}until(L){return this.isValid?zb.fromDateTimes(this,L):this}hasSame(L,T){if(!this.isValid)return!1;const ja=L.valueOf();L=this.setZone(L.zone,{keepLocalTime:!0});return L.startOf(T)<=ja&&ja<=L.endOf(T)}equals(L){return this.isValid&&L.isValid&&this.valueOf()===L.valueOf()&&this.zone.equals(L.zone)&&this.loc.equals(L.loc)}toRelative(L=
{}){if(!this.isValid)return null;const T=L.base||$a.fromObject({},{zone:this.zone}),ja=L.padding?this<T?-L.padding:L.padding:0;let va="years months days hours minutes seconds".split(" "),Aa=L.unit;Array.isArray(L.unit)&&(va=L.unit,Aa=void 0);return pb(T,this.plus(ja),{...L,numeric:"always",units:va,unit:Aa})}toRelativeCalendar(L={}){return this.isValid?pb(L.base||$a.fromObject({},{zone:this.zone}),this,{...L,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...L){if(!L.every($a.isDateTime))throw new Na("min requires all arguments be DateTimes");
return e(L,T=>T.valueOf(),Math.min)}static max(...L){if(!L.every($a.isDateTime))throw new Na("max requires all arguments be DateTimes");return e(L,T=>T.valueOf(),Math.max)}static fromFormatExplain(L,T,ja={}){const {locale:va=null,numberingSystem:Aa=null}=ja;ja=qb.fromOpts({locale:va,numberingSystem:Aa,defaultToEN:!0});return Sa(ja,L,T)}static fromStringExplain(L,T,ja={}){return $a.fromFormatExplain(L,T,ja)}static get DATE_SHORT(){return Wa}static get DATE_MED(){return bb}static get DATE_MED_WITH_WEEKDAY(){return ub}static get DATE_FULL(){return tb}static get DATE_HUGE(){return rb}static get TIME_SIMPLE(){return vb}static get TIME_WITH_SECONDS(){return Mb}static get TIME_WITH_SHORT_OFFSET(){return nc}static get TIME_WITH_LONG_OFFSET(){return Wb}static get TIME_24_SIMPLE(){return wd}static get TIME_24_WITH_SECONDS(){return uc}static get TIME_24_WITH_SHORT_OFFSET(){return xd}static get TIME_24_WITH_LONG_OFFSET(){return vc}static get DATETIME_SHORT(){return Fc}static get DATETIME_SHORT_WITH_SECONDS(){return ed}static get DATETIME_MED(){return Gc}static get DATETIME_MED_WITH_SECONDS(){return yd}static get DATETIME_MED_WITH_WEEKDAY(){return Oc}static get DATETIME_FULL(){return Pd}static get DATETIME_FULL_WITH_SECONDS(){return fd}static get DATETIME_HUGE(){return Pc}static get DATETIME_HUGE_WITH_SECONDS(){return Qc}}
q.DateTime=$a;q.Duration=kb;q.FixedOffsetZone=Ib;q.IANAZone=Vb;q.Info=Wc;q.Interval=zb;q.SystemZone=ad;q.Zone=Zb})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/_commonjsHelpers"],function(q,n,G){var F={};(function(y){(function(D,x){y.exports&&(y.exports=x())})(G.commonjsGlobal,function(){function D(k,g,b,a){k=Error.call(this,k);Object.setPrototypeOf&&Object.setPrototypeOf(k,D.prototype);k.expected=g;k.found=b;k.location=a;k.name=
"SyntaxError";return k}function x(k,g,b){b=b||" ";if(k.length>g)return k;g-=k.length;b+=b.repeat(g);return k+b.slice(0,g)}(function(k,g){function b(){this.constructor=k}b.prototype=g.prototype;k.prototype=new b})(D,Error);D.prototype.format=function(k){var g="Error: "+this.message;if(this.location){var b=null,a;for(a=0;a<k.length;a++)if(k[a].source===this.location.source){b=k[a].text.split(/\r\n|\n|\r/g);break}k=this.location.start;a=this.location.source&&"function"===typeof this.location.source.offset?
this.location.source.offset(k):k;var h=this.location.source+":"+a.line+":"+a.column;if(b){var e=this.location.end,f=x("",a.line.toString().length," ");b=b[k.line-1];e=(k.line===e.line?e.column:b.length+1)-k.column||1;g+="\n --\x3e "+h+"\n"+f+" |\n"+a.line+" | "+b+"\n"+f+" | "+x("",k.column-1," ")+x("",e,"^")}else g+="\n at "+h}return g};D.buildMessage=function(k,g){function b(c){return c.charCodeAt(0).toString(16).toUpperCase()}function a(c){return c.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,
"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+b(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+b(d)})}function h(c){return c.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+b(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+b(d)})}function e(c){return f[c.type](c)}
var f={literal:function(c){return'"'+a(c.text)+'"'},class:function(c){var d=c.parts.map(function(p){return Array.isArray(p)?h(p[0])+"-"+h(p[1]):h(p)});return"["+(c.inverted?"^":"")+d.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(c){return c.description}};return"Expected "+function(c){c=c.map(e);var d,p;c.sort();if(0<c.length){for(p=d=1;d<c.length;d++)c[d-1]!==c[d]&&(c[p]=c[d],p++);c.length=p}switch(c.length){case 1:return c[0];case 2:return c[0]+
" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(k)+" but "+(g?'"'+a(g)+'"':"end of input")+" found."};return{SyntaxError:D,parse:function(k,g){function b(Z,ea){return{type:"literal",text:Z,ignoreCase:ea}}function a(Z,ea,ta){return{type:"class",parts:Z,inverted:ea,ignoreCase:ta}}function h(Z){var ea=ib[Z],ta;if(!ea){for(ta=Z-1;!ib[ta];)ta--;ea=ib[ta];for(ea={line:ea.line,column:ea.column};ta<Z;)10===k.charCodeAt(ta)?(ea.line++,ea.column=1):ea.column++,ta++;ib[Z]=ea}return ea}
function e(Z,ea,ta){var Ka=h(Z),Va=h(ea);Z={source:fb,start:{offset:Z,line:Ka.line,column:Ka.column},end:{offset:ea,line:Va.line,column:Va.column}};ta&&fb&&"function"===typeof fb.offset&&(Z.start=fb.offset(Z.start),Z.end=fb.offset(Z.end));return Z}function f(Z){R<db||(R>db&&(db=R,Kb=[]),Kb.push(Z))}function c(){var Z=R;Ha();var ea=p();ea!==O?(Ha(),Z=ea):(R=Z,Z=O);return Z}function d(){var Z=R;var ea=p();if(ea!==O){Z=[];var ta=R;var Ka=Ha();var Va=Qa();if(Va!==O){var jb=Ha();var nb=p();nb!==O?ta=Ka=
[Ka,Va,jb,nb]:(R=ta,ta=O)}else R=ta,ta=O;for(;ta!==O;)Z.push(ta),ta=R,Ka=Ha(),Va=Qa(),Va!==O?(jb=Ha(),nb=p(),nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)):(R=ta,ta=O);ta={type:"expression-list"};ea=[ea];for(Ka=0;Ka<Z.length;Ka++)ea.push(Z[Ka][3]);ta.value=ea;Z=ta}else R=Z,Z=O;return Z}function p(){var Z=R;var ea=v();if(ea!==O){Z=[];var ta=R;var Ka=Ha();var Va=za();if(Va!==O){var jb=Ha();var nb=v();nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)}else R=ta,ta=O;for(;ta!==O;)Z.push(ta),ta=R,Ka=Ha(),Va=za(),Va!==O?
(jb=Ha(),nb=v(),nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)):(R=ta,ta=O);Z=cb(ea,Z)}else R=Z,Z=O;return Z}function v(){var Z=R;var ea=l();if(ea!==O){Z=[];var ta=R;var Ka=Ha();var Va=na();if(Va!==O){var jb=Ha();var nb=l();nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)}else R=ta,ta=O;for(;ta!==O;)Z.push(ta),ta=R,Ka=Ha(),Va=na(),Va!==O?(jb=Ha(),nb=l(),nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)):(R=ta,ta=O);Z=cb(ea,Z)}else R=Z,Z=O;return Z}function l(){var Z=R;var ea=fa();if(ea===O){ea=R;if(33===k.charCodeAt(R)){var ta=
mb;R++}else ta=O,0===Ga&&f(le);if(ta!==O){var Ka=R;Ga++;if(61===k.charCodeAt(R)){var Va=Ba;R++}else Va=O,0===Ga&&f(rc);Ga--;Va===O?Ka=void 0:(R=Ka,Ka=O);Ka!==O?ea=ta=[ta,Ka]:(R=ea,ea=O)}else R=ea,ea=O}ea!==O?(ta=Ha(),Ka=l(),Ka!==O?Z={type:"unary-expression",operator:"NOT",expr:Ka}:(R=Z,Z=O)):(R=Z,Z=O);if(Z===O){ea=R;Z=w();if(Z!==O){Ha();ea=[];ta=R;Ka=Ha();Va=u();if(Va!==O){var jb=Ha();var nb=w();nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)}else R=ta,ta=O;if(ta!==O)for(;ta!==O;)ea.push(ta),ta=R,Ka=Ha(),
Va=u(),Va!==O?(jb=Ha(),nb=w(),nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)):(R=ta,ta=O);else ea=O;ea!==O&&(ea={type:"arithmetic",tail:ea});ea===O&&(ea=R,ta=A(),ta!==O?(Ha(),Ka=Ya(),Ka!==O?(Ha(),Ka=d(),Ka!==O?(Ha(),Va=Za(),Va!==O?ea={op:ta,right:Ka}:(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O),ea===O&&(ea=R,ta=A(),ta!==O?(Ha(),Ka=Ya(),Ka!==O?(Ha(),Ka=Za(),Ka!==O?ea={op:ta,right:{type:"expression-list",value:[]}}:(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O),ea===O&&(ea=R,ta=A(),ta!==O?(Ha(),Ka=H(),Ka!==O?
ea={op:ta,right:Ka}:(R=ea,ea=O)):(R=ea,ea=O))),ea===O&&(ea=R,Va=fa(),Va!==O?(Ha(),ta=W(),ta!==O?(Ha(),Ka=w(),Ka!==O?(Ha(),jb=na(),jb!==O?(Ha(),Va=w(),Va!==O?ea={op:"NOT"+ta,right:{type:"expression-list",value:[Ka,Va]}}:(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O),ea===O&&(ea=R,Va=W(),Va!==O?(Ha(),ta=w(),ta!==O?(Ha(),Ka=na(),Ka!==O?(Ha(),jb=w(),jb!==O?ea={op:Va,right:{type:"expression-list",value:[ta,jb]}}:(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O)),ea===O&&(ea=R,ta=M(),
ta!==O?(Ha(),Ka=fa(),Ka!==O?(Ha(),Ka=w(),Ka!==O?ea={op:ta+"NOT",right:Ka}:(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O),ea===O&&(ea=R,ta=M(),ta!==O?(Ha(),Ka=w(),Ka!==O?ea={op:ta,right:Ka}:(R=ea,ea=O)):(R=ea,ea=O)),ea===O&&(ea=R,ta=r(),ta!==O?(Ha(),Ka=ka(),Ka!==O?(Ha(),Va=R,k.substr(R,6).toLowerCase()===ub?(jb=k.substr(R,6),R+=6):(jb=O,0===Ga&&f(Gd)),jb!==O?(jb=R,Ga++,nb=E(),Ga--,nb===O?jb=void 0:(R=jb,jb=O),jb!==O?Va="ESCAPE":(R=Va,Va=O)):(R=Va,Va=O),Va!==O?(Ha(),Va=V(),Va!==O?ea={op:ta,right:Ka,escape:Va.value}:
(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O)):(R=ea,ea=O),ea===O&&(ea=R,ta=r(),ta!==O?(Ha(),Ka=ka(),Ka!==O?ea={op:ta,right:Ka,escape:""}:(R=ea,ea=O)):(R=ea,ea=O))))));ea===O&&(ea=null);""==ea||void 0==ea||null==ea?ea=Z:(ta=null,ea=ta="arithmetic"==ea.type?cb(Z,ea.tail):lb(ea.op,Z,ea.right,ea.escape))}else R=ea,ea=O;Z=ea}return Z}function u(){if(k.substr(R,2)===mc){var Z=mc;R+=2}else Z=O,0===Ga&&f(gc);Z===O&&(62===k.charCodeAt(R)?(Z=Sb,R++):(Z=O,0===Ga&&f(kc)),Z===O&&(k.substr(R,2)===Gb?(Z=Gb,R+=2):(Z=O,
0===Ga&&f(ac)),Z===O&&(k.substr(R,2)===Pb?(Z=Pb,R+=2):(Z=O,0===Ga&&f(Nd)),Z===O&&(60===k.charCodeAt(R)?(Z=ic,R++):(Z=O,0===Ga&&f(Md)),Z===O&&(61===k.charCodeAt(R)?(Z=Ba,R++):(Z=O,0===Ga&&f(rc)),Z===O&&(k.substr(R,2)===$b?(Z=$b,R+=2):(Z=O,0===Ga&&f(me))))))));return Z}function r(){var Z=Z=R;var ea=fa();if(ea!==O){var ta=Ha();var Ka=Q();Ka!==O?Z=ea=[ea,ta,Ka]:(R=Z,Z=O)}else R=Z,Z=O;Z!==O&&(Z=Z[0]+" "+Z[2]);Z===O&&(Z=Q());return Z}function A(){var Z=Z=R;var ea=fa();if(ea!==O){var ta=Ha();var Ka=oa();
Ka!==O?Z=ea=[ea,ta,Ka]:(R=Z,Z=O)}else R=Z,Z=O;Z!==O&&(Z=Z[0]+" "+Z[2]);Z===O&&(Z=oa());return Z}function w(){var Z=R;var ea=t();if(ea!==O){Z=[];var ta=R;var Ka=Ha();var Va=m();if(Va!==O){var jb=Ha();var nb=t();nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)}else R=ta,ta=O;for(;ta!==O;)Z.push(ta),ta=R,Ka=Ha(),Va=m(),Va!==O?(jb=Ha(),nb=t(),nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)):(R=ta,ta=O);Z=cb(ea,Z)}else R=Z,Z=O;return Z}function m(){if(43===k.charCodeAt(R)){var Z=tc;R++}else Z=O,0===Ga&&f(Bd);Z===O&&(45===
k.charCodeAt(R)?(Z=Hb,R++):(Z=O,0===Ga&&f(Db)),Z===O&&(k.substr(R,2)===Lb?(Z=Lb,R+=2):(Z=O,0===Ga&&f(Fb))));return Z}function t(){var Z=R;var ea=J();if(ea!==O){Z=[];var ta=R;var Ka=Ha();var Va=B();if(Va!==O){var jb=Ha();var nb=J();nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)}else R=ta,ta=O;for(;ta!==O;)Z.push(ta),ta=R,Ka=Ha(),Va=B(),Va!==O?(jb=Ha(),nb=J(),nb!==O?ta=Ka=[Ka,Va,jb,nb]:(R=ta,ta=O)):(R=ta,ta=O);Z=cb(ea,Z)}else R=Z,Z=O;return Z}function B(){if(42===k.charCodeAt(R)){var Z=pb;R++}else Z=O,0===
Ga&&f(Qb);Z===O&&(47===k.charCodeAt(R)?(Z=ob,R++):(Z=O,0===Ga&&f(Ub)));return Z}function J(){var Z=V();if(Z===O){var ea=R;var ta=R;var Ka=ra();if(Ka!==O){var Va=Y();if(Va!==O){var jb=ua();jb!==O?ta=parseFloat(Ka+Va+jb):(R=ta,ta=O)}else R=ta,ta=O}else R=ta,ta=O;ta===O&&(ta=R,Ka=ra(),Ka!==O?(Va=Y(),Va!==O?ta=parseFloat(Ka+Va):(R=ta,ta=O)):(R=ta,ta=O),ta===O&&(ta=R,Ka=ra(),Ka!==O?(Va=ua(),Va!==O?ta=parseFloat(Ka+Va):(R=ta,ta=O)):(R=ta,ta=O),ta===O&&(ta=R,Ka=ra(),Ka!==O&&(Ka=parseFloat(Ka)),ta=Ka)));
var nb=ta;if(nb!==O){var Ce=R;Ga++;var Lf=K();Ga--;Lf===O?Ce=void 0:(R=Ce,Ce=O);Ce!==O?ea={type:"number",value:nb}:(R=ea,ea=O)}else R=ea,ea=O;Z=ea;if(Z===O){var se=R;var Wd=R;if(k.substr(R,4).toLowerCase()===Ca){var De=k.substr(R,4);R+=4}else De=O,0===Ga&&f(Tc);if(De!==O){var te=R;Ga++;var Mf=E();Ga--;Mf===O?te=void 0:(R=te,te=O);te!==O?Wd=De=[De,te]:(R=Wd,Wd=O)}else R=Wd,Wd=O;var Kd=Wd;Kd!==O&&(Kd={type:"boolean",value:!0});se=Kd;if(se===O){se=R;var Xd=R;if(k.substr(R,5).toLowerCase()===Na){var Ee=
k.substr(R,5);R+=5}else Ee=O,0===Ga&&f(jd);if(Ee!==O){var ue=R;Ga++;var Nf=E();Ga--;Nf===O?ue=void 0:(R=ue,ue=O);ue!==O?Xd=Ee=[Ee,ue]:(R=Xd,Xd=O)}else R=Xd,Xd=O;Kd=Xd;Kd!==O&&(Kd={type:"boolean",value:!1});se=Kd}Z=se;if(Z===O){var Yd=R;if(k.substr(R,4).toLowerCase()===sa){var Fe=k.substr(R,4);R+=4}else Fe=O,0===Ga&&f(Sd);if(Fe!==O){var ve=R;Ga++;var Of=E();Ga--;Of===O?ve=void 0:(R=ve,ve=O);ve!==O?Yd=Fe=[Fe,ve]:(R=Yd,Yd=O)}else R=Yd,Yd=O;var Ze=Yd;Ze!==O&&(Ze={type:"null",value:null});Z=Ze;if(Z===
O){var Zd=R;if(qa()!==O){Ha();var lf=ka();lf!==O?Zd={type:"date",value:lf.value}:(R=Zd,Zd=O)}else R=Zd,Zd=O;Z=Zd;if(Z===O){var $d=R;if(ma()!==O){Ha();var mf=ka();mf!==O?$d={type:"timestamp",value:mf.value}:(R=$d,$d=O)}else R=$d,$d=O;Z=$d;if(Z===O){var Nb=R;var $e=wa();if($e!==O){Ha();if(45===k.charCodeAt(R)){var Xc=Hb;R++}else Xc=O,0===Ga&&f(Db);Xc===O&&(43===k.charCodeAt(R)?(Xc=tc,R++):(Xc=O,0===Ga&&f(Bd)));if(Xc!==O){Ha();var we=ka();if(we!==O){Ha();var nf=U();nf!==O?Nb={type:"interval",value:we,
qualifier:nf,op:Xc}:(R=Nb,Nb=O)}else R=Nb,Nb=O}else R=Nb,Nb=O}else R=Nb,Nb=O;Nb===O&&(Nb=R,$e=wa(),$e!==O?(Ha(),Xc=ka(),Xc!==O?(Ha(),we=U(),we!==O?Nb={type:"interval",value:Xc,qualifier:we,op:""}:(R=Nb,Nb=O)):(R=Nb,Nb=O)):(R=Nb,Nb=O));Z=Nb}}}}}}var wb=Z;if(wb===O){var cc=R;var ae=R;if(k.substr(R,7).toLowerCase()===uc){var of=k.substr(R,7);R+=7}else of=O,0===Ga&&f(md);if(of!==O){var Ge=R;Ga++;var Pf=E();Ga--;Pf===O?Ge=void 0:(R=Ge,Ge=O);Ge!==O?ae="EXTRACT":(R=ae,ae=O)}else R=ae,ae=O;if(ae!==O){Ha();
var Qf=Ya();if(Qf!==O){Ha();var Cc=ya();Cc===O&&(Cc=Ea(),Cc===O&&(Cc=Da(),Cc===O&&(Cc=Ia(),Cc===O&&(Cc=Ja(),Cc===O&&(Cc=La())))));var pf=Cc;if(pf!==O){Ha();var Rf=da();if(Rf!==O){Ha();var qf=p();if(qf!==O){Ha();var Sf=Za();Sf!==O?cc={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:pf},qf]}}:(R=cc,cc=O)}else R=cc,cc=O}else R=cc,cc=O}else R=cc,cc=O}else R=cc,cc=O}else R=cc,cc=O;wb=cc;if(wb===O){var dc=R;var be=R;if(k.substr(R,9).toLowerCase()===wd){var rf=k.substr(R,
9);R+=9}else rf=O,0===Ga&&f(ld);if(rf!==O){var He=R;Ga++;var Tf=E();Ga--;Tf===O?He=void 0:(R=He,He=O);He!==O?be="SUBSTRING":(R=be,be=O)}else R=be,be=O;if(be!==O){Ha();var Uf=Ya();if(Uf!==O){Ha();var af=p();if(af!==O){Ha();var Vf=da();if(Vf!==O){Ha();var bf=p();if(bf!==O){Ha();var Yc=R;var ce=R;if(k.substr(R,3).toLowerCase()===Wb){var sf=k.substr(R,3);R+=3}else sf=O,0===Ga&&f(Uc);if(sf!==O){var Ie=R;Ga++;var Wf=E();Ga--;Wf===O?Ie=void 0:(R=Ie,Ie=O);Ie!==O?ce="FOR":(R=ce,ce=O)}else R=ce,ce=O;var xe=
ce;if(xe!==O){var Xf=Ha();var tf=p();if(tf!==O){var Yf=Ha();Yc=xe=[xe,Xf,tf,Yf]}else R=Yc,Yc=O}else R=Yc,Yc=O;Yc===O&&(Yc=null);xe=Za();xe!==O?dc={type:"function",name:"substring",args:{type:"expression-list",value:Yc?[af,bf,Yc[2]]:[af,bf]}}:(R=dc,dc=O)}else R=dc,dc=O}else R=dc,dc=O}else R=dc,dc=O}else R=dc,dc=O}else R=dc,dc=O;wb=dc;if(wb===O){var Bb=R;var cf=ha();if(cf!==O){Ha();var df=Ya();if(df!==O){Ha();var Zc=N();Zc===O&&(Zc=null);Ha();var ye=p();if(ye!==O){Ha();var ef=da();if(ef!==O){Ha();var uf=
p();if(uf!==O){Ha();var Zf=Za();Zf!==O?Bb={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Zc?"BOTH":Zc},ye,uf]}}:(R=Bb,Bb=O)}else R=Bb,Bb=O}else R=Bb,Bb=O}else R=Bb,Bb=O}else R=Bb,Bb=O}else R=Bb,Bb=O;Bb===O&&(Bb=R,cf=ha(),cf!==O?(Ha(),df=Ya(),df!==O?(Ha(),Zc=N(),Zc===O&&(Zc=null),Ha(),ye=p(),ye!==O?(Ha(),ef=Za(),ef!==O?Bb={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Zc?"BOTH":Zc},ye]}}:(R=Bb,Bb=O)):(R=Bb,Bb=
O)):(R=Bb,Bb=O)):(R=Bb,Bb=O));wb=Bb;if(wb===O){var ec=R;var de=R;if(k.substr(R,8).toLowerCase()===vc){var vf=k.substr(R,8);R+=8}else vf=O,0===Ga&&f(Vc);if(vf!==O){var Je=R;Ga++;var $f=E();Ga--;$f===O?Je=void 0:(R=Je,Je=O);Je!==O?de="POSITION":(R=de,de=O)}else R=de,de=O;if(de!==O){Ha();var ag=Ya();if(ag!==O){Ha();var wf=p();if(wf!==O){Ha();var bg=oa();if(bg!==O){Ha();var xf=p();if(xf!==O){Ha();var cg=Za();cg!==O?ec={type:"function",name:"position",args:{type:"expression-list",value:[wf,xf]}}:(R=ec,
ec=O)}else R=ec,ec=O}else R=ec,ec=O}else R=ec,ec=O}else R=ec,ec=O}else R=ec,ec=O;wb=ec;if(wb===O){var fc=R;var ee=R;if(k.substr(R,4).toLowerCase()===Pd){var yf=k.substr(R,4);R+=4}else yf=O,0===Ga&&f(rd);if(yf!==O){var Ke=R;Ga++;var dg=E();Ga--;dg===O?Ke=void 0:(R=Ke,Ke=O);Ke!==O?ee="CAST":(R=ee,ee=O)}else R=ee,ee=O;if(ee!==O){Ha();var eg=Ya();if(eg!==O){Ha();var zf=p();if(zf!==O){Ha();var fe=R;if(k.substr(R,2).toLowerCase()===fd){var Af=k.substr(R,2);R+=2}else Af=O,0===Ga&&f(cd);if(Af!==O){var Le=
R;Ga++;var fg=E();Ga--;fg===O?Le=void 0:(R=Le,Le=O);Le!==O?fe="AS":(R=fe,fe=O)}else R=fe,fe=O;var gg=fe;if(gg!==O){Ha();var xb=R;var ge=R;if(k.substr(R,7).toLowerCase()===Pc){var Bf=k.substr(R,7);R+=7}else Bf=O,0===Ga&&f(lc);if(Bf!==O){var Me=R;Ga++;var hg=E();Ga--;hg===O?Me=void 0:(R=Me,Me=O);Me!==O?ge="INTEGER":(R=ge,ge=O)}else R=ge,ge=O;var Cb=ge;Cb!==O&&(Cb={type:"data-type",value:{type:"integer"}});xb=Cb;if(xb===O){xb=R;var he=R;if(k.substr(R,8).toLowerCase()===Qc){var Cf=k.substr(R,8);R+=8}else Cf=
O,0===Ga&&f(Ec);if(Cf!==O){var Ne=R;Ga++;var ig=E();Ga--;ig===O?Ne=void 0:(R=Ne,Ne=O);Ne!==O?he="SMALLINT":(R=he,he=O)}else R=he,he=O;Cb=he;Cb!==O&&(Cb={type:"data-type",value:{type:"smallint"}});xb=Cb;if(xb===O){xb=R;var ie=R;if(k.substr(R,5).toLowerCase()===Zb){var Df=k.substr(R,5);R+=5}else Df=O,0===Ga&&f(hc);if(Df!==O){var Oe=R;Ga++;var jg=E();Ga--;jg===O?Oe=void 0:(R=Oe,Oe=O);Oe!==O?ie="FLOAT":(R=ie,ie=O)}else R=ie,ie=O;Cb=ie;Cb!==O&&(Cb={type:"data-type",value:{type:"float"}});xb=Cb;if(xb===
O){xb=R;var je=R;if(k.substr(R,4).toLowerCase()===Rc){var Ef=k.substr(R,4);R+=4}else Ef=O,0===Ga&&f(sd);if(Ef!==O){var Pe=R;Ga++;var kg=E();Ga--;kg===O?Pe=void 0:(R=Pe,Pe=O);Pe!==O?je="REAL":(R=je,je=O)}else R=je,je=O;Cb=je;Cb!==O&&(Cb={type:"data-type",value:{type:"real"}});xb=Cb;if(xb===O&&(xb=R,Cb=qa(),Cb!==O&&(Cb={type:"data-type",value:{type:"date"}}),xb=Cb,xb===O&&(xb=R,Cb=ma(),Cb!==O&&(Cb={type:"data-type",value:{type:"timestamp"}}),xb=Cb,xb===O))){xb=R;var ke=R;if(k.substr(R,7).toLowerCase()===
ad){var Ff=k.substr(R,7);R+=7}else Ff=O,0===Ga&&f(dd);if(Ff!==O){var Qe=R;Ga++;var lg=E();Ga--;lg===O?Qe=void 0:(R=Qe,Qe=O);Qe!==O?ke="VARCHAR":(R=ke,ke=O)}else R=ke,ke=O;Cb=ke;if(Cb!==O){Ha();var mg=Ya();if(mg!==O){Ha();var Gf=ca();if(Gf!==O){Ha();var ng=Za();ng!==O?xb={type:"data-type",value:{type:"varchar",size:parseInt(Gf)}}:(R=xb,xb=O)}else R=xb,xb=O}else R=xb,xb=O}else R=xb,xb=O}}}}var Hf=xb;if(Hf!==O){Ha();var og=Za();og!==O?fc={type:"function",name:"cast",args:{type:"expression-list",value:[zf,
Hf]}}:(R=fc,fc=O)}else R=fc,fc=O}else R=fc,fc=O}else R=fc,fc=O}else R=fc,fc=O}else R=fc,fc=O;wb=fc;if(wb===O){var nd=R;var Re;var Dc=R;Dc=Re=C();if(Dc===O)if(Dc=R,96===k.charCodeAt(R)?(Re=Ad,R++):(Re=O,0===Ga&&f(Xa)),Re!==O){var Se=[];if(pd.test(k.charAt(R))){var $c=k.charAt(R);R++}else $c=O,0===Ga&&f(hb);if($c!==O)for(;$c!==O;)Se.push($c),pd.test(k.charAt(R))?($c=k.charAt(R),R++):($c=O,0===Ga&&f(hb));else Se=O;Se!==O?(96===k.charCodeAt(R)?($c=Ad,R++):($c=O,0===Ga&&f(Xa)),$c!==O?Dc=Se.join(""):(R=
Dc,Dc=O)):(R=Dc,Dc=O)}else R=Dc,Dc=O;var If=Dc;if(If!==O){Ha();var pg=Ya();if(pg!==O){Ha();var Te=d();Te===O&&(Te=null);Ha();var qg=Za();qg!==O?nd={type:"function",name:If,args:Te?Te:{type:"expression-list",value:[]}}:(R=nd,nd=O)}else R=nd,nd=O}else R=nd,nd=O;wb=nd;if(wb===O){var Lc;var Ob=R;var ff=Ra();if(ff!==O){Ha();var ze=p();if(ze!==O){Ha();var Ae=[];for(Lc=S();Lc!==O;)Ae.push(Lc),Lc=S();Lc=Ha();var Ue=Pa();Ue!==O?Ob={type:"case-expression",format:"simple",operand:ze,clauses:Ae,else:null}:(R=
Ob,Ob=O)}else R=Ob,Ob=O}else R=Ob,Ob=O;if(Ob===O)if(Ob=R,ff=Ra(),ff!==O)if(Ha(),ze=p(),ze!==O){Ha();Ae=[];for(Lc=S();Lc!==O;)Ae.push(Lc),Lc=S();Lc=Ha();Ue=X();if(Ue!==O){Ha();var rg=Pa();rg!==O?Ob={type:"case-expression",format:"simple",operand:ze,clauses:Ae,else:Ue.value}:(R=Ob,Ob=O)}else R=Ob,Ob=O}else R=Ob,Ob=O;else R=Ob,Ob=O;var gf=Ob;if(gf===O){var Mc;var Xb=R;var hf=Ra();if(hf!==O){Ha();var Be=[];for(Mc=P();Mc!==O;)Be.push(Mc),Mc=P();Mc=Ha();var Ve=Pa();Ve!==O?Xb={type:"case-expression",format:"searched",
clauses:Be,else:null}:(R=Xb,Xb=O)}else R=Xb,Xb=O;if(Xb===O)if(Xb=R,hf=Ra(),hf!==O){Ha();Be=[];for(Mc=P();Mc!==O;)Be.push(Mc),Mc=P();Mc=Ha();Ve=X();if(Ve!==O){Ha();var sg=Pa();sg!==O?Xb={type:"case-expression",format:"searched",clauses:Be,else:Ve.value}:(R=Xb,Xb=O)}else R=Xb,Xb=O}else R=Xb,Xb=O;gf=Xb}wb=gf;if(wb===O){var We;var Xe=R;var Jf=K();if(Jf!==O){var Kf=[];for(We=I();We!==O;)Kf.push(We),We=I();Xe=Jf+Kf.join("")}else R=Xe,Xe=O;var Ye=Xe;if(Ye!==O){var jf=Ye;Ye=/^CURRENT_DATE$/i.test(jf)?{type:"current-time",
mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(jf)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:jf}}wb=Ye;if(wb===O&&(wb=H(),wb===O)){wb=R;var tg=Ya();if(tg!==O){Ha();var kf=p();if(kf!==O){Ha();var ug=Za();ug!==O?(kf.paren=!0,wb=kf):(R=wb,wb=O)}else R=wb,wb=O}else R=wb,wb=O}}}}}}}}}return wb}function C(){var Z;var ea=R;var ta=K();if(ta!==O){ea=[];for(Z=E();Z!==O;)ea.push(Z),Z=E();ea=ta+ea.join("")}else R=ea,ea=O;return ea}function K(){if(oc.test(k.charAt(R))){var Z=k.charAt(R);
R++}else Z=O,0===Ga&&f(Jc);return Z}function E(){if(Sc.test(k.charAt(R))){var Z=k.charAt(R);R++}else Z=O,0===Ga&&f(Cd);return Z}function I(){if(hd.test(k.charAt(R))){var Z=k.charAt(R);R++}else Z=O,0===Ga&&f(Ac);return Z}function H(){var Z=R;if(64===k.charCodeAt(R)){var ea=Eb;R++}else ea=O,0===Ga&&f(oe);if(ea!==O){var ta=C();ta!==O?Z=ea=[ea,ta]:(R=Z,Z=O)}else R=Z,Z=O;Z!==O&&(Z={type:"parameter",value:Z[1]});return Z}function N(){var Z=R;if(k.substr(R,7).toLowerCase()===Gc){var ea=k.substr(R,7);R+=
7}else ea=O,0===Ga&&f(kb);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="LEADING":(R=Z,Z=O)}else R=Z,Z=O;Z===O&&(Z=R,k.substr(R,8).toLowerCase()===yd?(ea=k.substr(R,8),R+=8):(ea=O,0===Ga&&f(zb)),ea!==O?(ea=R,Ga++,ta=E(),Ga--,ta===O?ea=void 0:(R=ea,ea=O),ea!==O?Z="TRAILING":(R=Z,Z=O)):(R=Z,Z=O),Z===O&&(Z=R,k.substr(R,4).toLowerCase()===Oc?(ea=k.substr(R,4),R+=4):(ea=O,0===Ga&&f(Wc)),ea!==O?(ea=R,Ga++,ta=E(),Ga--,ta===O?ea=void 0:(R=ea,ea=O),ea!==O?Z="BOTH":(R=Z,Z=O)):(R=
Z,Z=O)));return Z}function U(){var Z=R;var ea=R;var ta=ba();if(ta!==O){Ha();var Ka=Ya();if(Ka!==O)if(Ha(),Ka=aa(),Ka!==O){Ha();var Va=Za();Va!==O?ea={type:"interval-period",period:ta.value,precision:Ka,secondary:null}:(R=ea,ea=O)}else R=ea,ea=O;else R=ea,ea=O}else R=ea,ea=O;ea===O&&(ea=R,ta=ba(),ta!==O&&(ta={type:"interval-period",period:ta.value,precision:null,secondary:null}),ea=ta);if(ea!==O)if(Ha(),ta=R,k.substr(R,2).toLowerCase()===wc?(Ka=k.substr(R,2),R+=2):(Ka=O,0===Ga&&f(ud)),Ka!==O?(Ka=R,
Ga++,Va=E(),Ga--,Va===O?Ka=void 0:(R=Ka,Ka=O),Ka!==O?ta="TO":(R=ta,ta=O)):(R=ta,ta=O),ta!==O){Ha();ta=R;Ka=ba();Ka!==O&&(Ka={type:"interval-period",period:Ka.value,precision:null,secondary:null});ta=Ka;if(ta===O){ta=R;Ka=La();if(Ka!==O)if(Ha(),Ka=Ya(),Ka!==O)if(Ha(),Ka=aa(),Ka!==O)if(Ha(),Va=Qa(),Va!==O)if(Ha(),Va=la(),Va!==O){Ha();var jb=Za();jb!==O?ta={type:"interval-period",period:"second",precision:Ka,secondary:Va}:(R=ta,ta=O)}else R=ta,ta=O;else R=ta,ta=O;else R=ta,ta=O;else R=ta,ta=O;else R=
ta,ta=O;ta===O&&(ta=R,Ka=La(),Ka!==O?(Ha(),Ka=Ya(),Ka!==O?(Ha(),Ka=aa(),Ka!==O?(Ha(),Va=Za(),Va!==O?ta={type:"interval-period",period:"second",precision:Ka,secondary:null}:(R=ta,ta=O)):(R=ta,ta=O)):(R=ta,ta=O)):(R=ta,ta=O),ta===O&&(ta=R,Ka=La(),Ka!==O&&(Ka={type:"interval-period",period:"second",precision:null,secondary:null}),ta=Ka))}ta!==O?Z={type:"interval-qualifier",start:ea,end:ta}:(R=Z,Z=O)}else R=Z,Z=O;else R=Z,Z=O;Z===O&&(Z=R,ta=ba(),ta!==O?(Ha(),ea=Ya(),ea!==O?(Ha(),ea=la(),ea!==O?(Ha(),
Ka=Za(),Ka!==O?Z={type:"interval-period",period:ta.value,precision:ea,secondary:null}:(R=Z,Z=O)):(R=Z,Z=O)):(R=Z,Z=O)):(R=Z,Z=O),Z===O&&(Z=R,ta=ba(),ta!==O&&(ta={type:"interval-period",period:ta.value,precision:null,secondary:null}),Z=ta,Z===O&&(Z=R,ta=La(),ta!==O?(Ha(),ea=Ya(),ea!==O?(Ha(),ea=aa(),ea!==O?(Ha(),Ka=Qa(),Ka!==O?(Ha(),ta=la(),ta!==O?(Ha(),Ka=Za(),Ka!==O?Z={type:"interval-period",period:"second",precision:ea,secondary:ta}:(R=Z,Z=O)):(R=Z,Z=O)):(R=Z,Z=O)):(R=Z,Z=O)):(R=Z,Z=O)):(R=Z,Z=
O),Z===O&&(Z=R,ta=La(),ta!==O?(Ha(),ea=Ya(),ea!==O?(Ha(),ea=la(),ea!==O?(Ha(),Ka=Za(),Ka!==O?Z={type:"interval-period",period:"second",precision:ea,secondary:null}:(R=Z,Z=O)):(R=Z,Z=O)):(R=Z,Z=O)):(R=Z,Z=O),Z===O&&(Z=R,ta=La(),ta!==O&&(ta={type:"interval-period",period:"second",precision:null,secondary:null}),Z=ta)))));return Z}function ba(){var Z=R;Z=Da();Z!==O&&(Z={type:"string",value:"day"});Z===O&&(Z=R,Z=Ia(),Z!==O&&(Z={type:"string",value:"hour"}),Z===O&&(Z=R,Z=Ja(),Z!==O&&(Z={type:"string",
value:"minute"}),Z===O&&(Z=R,Z=Ea(),Z!==O&&(Z={type:"string",value:"month"}),Z===O&&(Z=R,Z=ya(),Z!==O&&(Z={type:"string",value:"year"})))));return Z}function la(){var Z=ca();Z!==O&&(Z=parseFloat(Z));return Z}function aa(){var Z=ca();Z!==O&&(Z=parseFloat(Z));return Z}function ka(){var Z=V();Z===O&&(Z=H());return Z}function V(){var Z=R;if(39===k.charCodeAt(R)){var ea=ab;R++}else ea=O,0===Ga&&f(Qd);ea===O&&(k.substr(R,2)===Tb?(ea=Tb,R+=2):(ea=O,0===Ga&&f(Dd)));if(ea!==O){ea=[];var ta=R;k.substr(R,2)===
pa?(ta=pa,R+=2):(ta=O,0===Ga&&f(Ed));ta!==O&&(ta="'");ta===O&&(bc.test(k.charAt(R))?(ta=k.charAt(R),R++):(ta=O,0===Ga&&f(Fd)));for(;ta!==O;)ea.push(ta),ta=R,k.substr(R,2)===pa?(ta=pa,R+=2):(ta=O,0===Ga&&f(Ed)),ta!==O&&(ta="'"),ta===O&&(bc.test(k.charAt(R))?(ta=k.charAt(R),R++):(ta=O,0===Ga&&f(Fd)));39===k.charCodeAt(R)?(ta=ab,R++):(ta=O,0===Ga&&f(Qd));ta!==O?Z={type:"string",value:ea.join("")}:(R=Z,Z=O)}else R=Z,Z=O;return Z}function P(){var Z=R;if(Sa()!==O){Ha();var ea=p();if(ea!==O){Ha();var ta=
Ta();ta!==O?(Ha(),ta=p(),ta!==O?Z={type:"when-clause",operand:ea,value:ta}:(R=Z,Z=O)):(R=Z,Z=O)}else R=Z,Z=O}else R=Z,Z=O;return Z}function S(){var Z=R;if(Sa()!==O){Ha();var ea=p();if(ea!==O){Ha();var ta=Ta();ta!==O?(Ha(),ta=p(),ta!==O?Z={type:"when-clause",operand:ea,value:ta}:(R=Z,Z=O)):(R=Z,Z=O)}else R=Z,Z=O}else R=Z,Z=O;return Z}function X(){var Z=R;var ea=R;if(k.substr(R,4).toLowerCase()===qb){var ta=k.substr(R,4);R+=4}else ta=O,0===Ga&&f(va);if(ta!==O){ta=R;Ga++;var Ka=E();Ga--;Ka===O?ta=void 0:
(R=ta,ta=O);ta!==O?ea="ELSE":(R=ea,ea=O)}else R=ea,ea=O;ea!==O?(Ha(),ea=p(),ea!==O?Z={type:"else-clause",value:ea}:(R=Z,Z=O)):(R=Z,Z=O);return Z}function ra(){var Z=ca();if(Z===O){Z=R;if(45===k.charCodeAt(R)){var ea=Hb;R++}else ea=O,0===Ga&&f(Db);ea===O&&(43===k.charCodeAt(R)?(ea=tc,R++):(ea=O,0===Ga&&f(Bd)));if(ea!==O){var ta=ca();ta!==O?Z=ea[0]+ta:(R=Z,Z=O)}else R=Z,Z=O}return Z}function Y(){var Z=R;if(46===k.charCodeAt(R)){var ea=xa;R++}else ea=O,0===Ga&&f(pe);ea!==O?(Z=ca(),Z===O&&(Z=null),Z=
"."+(null!=Z?Z:"")):(R=Z,Z=O);return Z}function ua(){var Z;var ea=Z=R;if(zc.test(k.charAt(R))){var ta=k.charAt(R);R++}else ta=O,0===Ga&&f(qe);ta!==O?(yb.test(k.charAt(R))?(ea=k.charAt(R),R++):(ea=O,0===Ga&&f(Rd)),ea===O&&(ea=null),ea="e"+(null===ea?"":ea)):(R=ea,ea=O);ea!==O?(ta=ca(),ta!==O?Z=ea+ta:(R=Z,Z=O)):(R=Z,Z=O);return Z}function ca(){var Z=[];var ea=ia();if(ea!==O)for(;ea!==O;)Z.push(ea),ea=ia();else Z=O;Z!==O&&(Z=Z.join(""));return Z}function ia(){if(id.test(k.charAt(R))){var Z=k.charAt(R);
R++}else Z=O,0===Ga&&f(Od);return Z}function oa(){var Z=R;if(k.substr(R,2).toLowerCase()===Oa){var ea=k.substr(R,2);R+=2}else ea=O,0===Ga&&f(Bc);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="IN":(R=Z,Z=O)}else R=Z,Z=O;return Z}function M(){var Z=R;if(k.substr(R,2).toLowerCase()===Wa){var ea=k.substr(R,2);R+=2}else ea=O,0===Ga&&f(Td);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="IS":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Q(){var Z=R;if(k.substr(R,
4).toLowerCase()===bb){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f(Ud);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="LIKE":(R=Z,Z=O)}else R=Z,Z=O;return Z}function fa(){var Z=R;if(k.substr(R,3).toLowerCase()===tb){var ea=k.substr(R,3);R+=3}else ea=O,0===Ga&&f(kd);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="NOT":(R=Z,Z=O)}else R=Z,Z=O;return Z}function na(){var Z=R;if(k.substr(R,3).toLowerCase()===rb){var ea=k.substr(R,3);R+=3}else ea=
O,0===Ga&&f(Vd);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="AND":(R=Z,Z=O)}else R=Z,Z=O;return Z}function za(){var Z=R;if(k.substr(R,2).toLowerCase()===vb){var ea=k.substr(R,2);R+=2}else ea=O,0===Ga&&f(Hd);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="OR":(R=Z,Z=O)}else R=Z,Z=O;return Z}function W(){var Z=R;if(k.substr(R,7).toLowerCase()===Mb){var ea=k.substr(R,7);R+=7}else ea=O,0===Ga&&f(jc);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?
ea=void 0:(R=ea,ea=O);ea!==O?Z="BETWEEN":(R=Z,Z=O)}else R=Z,Z=O;return Z}function da(){var Z=R;if(k.substr(R,4).toLowerCase()===nc){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f(Kc);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="FROM":(R=Z,Z=O)}else R=Z,Z=O;return Z}function ha(){var Z=R;if(k.substr(R,4).toLowerCase()===xd){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f(Id);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="TRIM":(R=Z,Z=O)}else R=
Z,Z=O;return Z}function ma(){var Z=R;if(k.substr(R,9).toLowerCase()===Fc){var ea=k.substr(R,9);R+=9}else ea=O,0===Ga&&f(pc);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="TIMESTAMP":(R=Z,Z=O)}else R=Z,Z=O;return Z}function qa(){var Z=R;if(k.substr(R,4).toLowerCase()===ed){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f(qd);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="DATE":(R=Z,Z=O)}else R=Z,Z=O;return Z}function wa(){var Z=R;if(k.substr(R,
8).toLowerCase()===xc){var ea=k.substr(R,8);R+=8}else ea=O,0===Ga&&f(td);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="INTERVAL":(R=Z,Z=O)}else R=Z,Z=O;return Z}function ya(){var Z=R;if(k.substr(R,4).toLowerCase()===yc){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f(Nc);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="YEAR":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Ea(){var Z=R;if(k.substr(R,5).toLowerCase()===Vb){var ea=k.substr(R,5);R+=5}else ea=
O,0===Ga&&f(Jd);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="MONTH":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Da(){var Z=R;if(k.substr(R,3).toLowerCase()===qc){var ea=k.substr(R,3);R+=3}else ea=O,0===Ga&&f(re);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="DAY":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Ia(){var Z=R;if(k.substr(R,4).toLowerCase()===od){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f(vd);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===
O?ea=void 0:(R=ea,ea=O);ea!==O?Z="HOUR":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Ja(){var Z=R;if(k.substr(R,6).toLowerCase()===Rb){var ea=k.substr(R,6);R+=6}else ea=O,0===Ga&&f(eb);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="MINUTE":(R=Z,Z=O)}else R=Z,Z=O;return Z}function La(){var Z=R;if(k.substr(R,6).toLowerCase()===Yb){var ea=k.substr(R,6);R+=6}else ea=O,0===Ga&&f(Ab);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="SECOND":(R=Z,Z=O)}else R=
Z,Z=O;return Z}function Ra(){var Z=R;if(k.substr(R,4).toLowerCase()===Hc){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f($a);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="CASE":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Pa(){var Z=R;if(k.substr(R,3).toLowerCase()===zd){var ea=k.substr(R,3);R+=3}else ea=O,0===Ga&&f(L);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="END":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Sa(){var Z=R;if(k.substr(R,4).toLowerCase()===
gd){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f(T);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="WHEN":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Ta(){var Z=R;if(k.substr(R,4).toLowerCase()===ne){var ea=k.substr(R,4);R+=4}else ea=O,0===Ga&&f(ja);if(ea!==O){ea=R;Ga++;var ta=E();Ga--;ta===O?ea=void 0:(R=ea,ea=O);ea!==O?Z="THEN":(R=Z,Z=O)}else R=Z,Z=O;return Z}function Qa(){if(44===k.charCodeAt(R)){var Z=Ic;R++}else Z=O,0===Ga&&f(Aa);return Z}function Ya(){if(40===k.charCodeAt(R)){var Z=
Ib;R++}else Z=O,0===Ga&&f(Fa);return Z}function Za(){if(41===k.charCodeAt(R)){var Z=bd;R++}else Z=O,0===Ga&&f(Ma);return Z}function Ha(){var Z;var ea=[];for(Z=gb();Z!==O;)ea.push(Z),Z=gb();return ea}function gb(){if(Ld.test(k.charAt(R))){var Z=k.charAt(R);R++}else Z=O,0===Ga&&f(Ua);return Z}function lb(Z,ea,ta,Ka){Z={type:"binary-expression",operator:Z,left:ea,right:ta};void 0!==Ka&&(Z.escape=Ka);return Z}function cb(Z,ea){for(var ta=0;ta<ea.length;ta++)Z=lb(ea[ta][1],Z,ea[ta][3]);return Z}g=void 0!==
g?g:{};var O={},fb=g.grammarSource,sb={start:c},Jb=c,mb="!",Ba="\x3d",mc="\x3e\x3d",Sb="\x3e",Gb="\x3c\x3d",Pb="\x3c\x3e",ic="\x3c",$b="!\x3d",tc="+",Hb="-",Lb="||",pb="*",ob="/",Eb="@",ab="'",Tb="N'",pa="''",xa=".",sa="null",Ca="true",Na="false",Oa="in",Wa="is",bb="like",ub="escape",tb="not",rb="and",vb="or",Mb="between",nc="from",Wb="for",wd="substring",uc="extract",xd="trim",vc="position",Fc="timestamp",ed="date",Gc="leading",yd="trailing",Oc="both",Pd="cast",fd="as",Pc="integer",Qc="smallint",
Zb="float",Rc="real",ad="varchar",wc="to",xc="interval",yc="year",Vb="month",qc="day",od="hour",Rb="minute",Yb="second",Hc="case",zd="end",gd="when",ne="then",qb="else",Ic=",",Ib="(",bd=")",Ad="`",oc=/^[A-Za-z_\x80-\uFFFF]/,Sc=/^[A-Za-z0-9_]/,hd=/^[A-Za-z0-9_.\x80-\uFFFF]/,bc=/^[^']/,id=/^[0-9]/,zc=/^[eE]/,yb=/^[+\-]/,Ld=/^[ \t\n\r]/,pd=/^[^`]/,le=b("!",!1),rc=b("\x3d",!1),gc=b("\x3e\x3d",!1),kc=b("\x3e",!1),ac=b("\x3c\x3d",!1),Nd=b("\x3c\x3e",!1),Md=b("\x3c",!1),me=b("!\x3d",!1),Bd=b("+",!1),Db=
b("-",!1),Fb=b("||",!1),Qb=b("*",!1),Ub=b("/",!1),Jc=a([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Cd=a([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ac=a([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),oe=b("@",!1),Qd=b("'",!1),Dd=b("N'",!1),Ed=b("''",!1),Fd=a(["'"],!0,!1),pe=b(".",!1),Od=a([["0","9"]],!1,!1),qe=a(["e","E"],!1,!1),Rd=a(["+","-"],!1,!1),Sd=b("NULL",!0),Tc=b("TRUE",!0),jd=b("FALSE",!0),Bc=b("IN",!0),Td=b("IS",!0),Ud=b("LIKE",!0),Gd=b("ESCAPE",!0),kd=b("NOT",
!0),Vd=b("AND",!0),Hd=b("OR",!0),jc=b("BETWEEN",!0),Kc=b("FROM",!0),Uc=b("FOR",!0),ld=b("SUBSTRING",!0),md=b("EXTRACT",!0),Id=b("TRIM",!0),Vc=b("POSITION",!0),pc=b("TIMESTAMP",!0),qd=b("DATE",!0),kb=b("LEADING",!0),zb=b("TRAILING",!0),Wc=b("BOTH",!0),rd=b("CAST",!0),cd=b("AS",!0),lc=b("INTEGER",!0),Ec=b("SMALLINT",!0),hc=b("FLOAT",!0),sd=b("REAL",!0),dd=b("VARCHAR",!0),ud=b("TO",!0),td=b("INTERVAL",!0),Nc=b("YEAR",!0),Jd=b("MONTH",!0),re=b("DAY",!0),vd=b("HOUR",!0),eb=b("MINUTE",!0),Ab=b("SECOND",
!0),$a=b("CASE",!0),L=b("END",!0),T=b("WHEN",!0),ja=b("THEN",!0),va=b("ELSE",!0),Aa=b(",",!1),Fa=b("(",!1),Ma=b(")",!1),Ua=a([" ","\t","\n","\r"],!1,!1),Xa=b("`",!1),hb=a(["`"],!0,!1),R=0,ib=[{line:1,column:1}],db=0,Kb=[],Ga=0;if("startRule"in g){if(!(g.startRule in sb))throw Error("Can't start parsing from rule \""+g.startRule+'".');Jb=sb[g.startRule]}var sc=Jb();if(sc!==O&&R===k.length)return sc;sc!==O&&R<k.length&&f({type:"end"});throw function(Z,ea,ta){return new D(D.buildMessage(Z,ea),Z,ea,ta)}(Kb,
db<k.length?k.charAt(db):null,db<k.length?e(db,db+1):e(db,db));}}})})({get exports(){return F},set exports(y){F=y}});let z=function(){function y(){}y.parse=function(D){return F.parse(D)};return n._createClass(y)}();q.WhereGrammar=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(q){q.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==
typeof self?self:{};q.getDefaultExportFromCjs=function(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n["default"]:n}})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(q,n,G,F,z,y,D){function x(f,c){if(!c)return null;
if("x"in c){var d={x:0,y:0};[d.x,d.y]=f(c.x,c.y,b);null!=c.z&&(d.z=c.z);null!=c.m&&(d.m=c.m);return d}return"xmin"in c?(d={xmin:0,ymin:0,xmax:0,ymax:0},[d.xmin,d.ymin]=f(c.xmin,c.ymin,b),[d.xmax,d.ymax]=f(c.xmax,c.ymax,b),c.hasZ&&(d.zmin=c.zmin,d.zmax=c.zmax,d.hasZ=!0),c.hasM&&(d.mmin=c.mmin,d.mmax=c.mmax,d.hasM=!0),d):"rings"in c?{rings:k(c.rings,f),hasM:c.hasM,hasZ:c.hasZ}:"paths"in c?{paths:k(c.paths,f),hasM:c.hasM,hasZ:c.hasZ}:"points"in c?{points:g(c.points,f),hasM:c.hasM,hasZ:c.hasZ}:null}function k(f,
c){const d=[];for(const p of f)d.push(g(p,c));return d}function g(f,c){const d=[];for(const p of f)f=c(p[0],p[1],[0,0]),d.push(f),2<p.length&&f.push(p[2]),3<p.length&&f.push(p[3]);return d}const b=[0,0],a=x.bind(null,D.lngLatToXY),h=x.bind(null,D.xyToLngLat),e=new (function(){function f(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var c=f.prototype;c.push=async function(d,p,v){if(!(d&&d.length&&p&&v)||y.equals(p,v))return d;const l={geometries:d,inSpatialReference:p,outSpatialReference:v,
resolve:null};this._jobs.push(l);return new Promise(u=>{l.resolve=u;null===this._timer&&(this._timer=setTimeout(this._process,10))})};c._process=function(){this._timer=null;const d=this._jobs.shift();if(d){var {geometries:p,inSpatialReference:v,outSpatialReference:l,resolve:u}=d;D.canProject(v,l)?y.isWebMercator(l)?u(p.map(a)):u(p.map(h)):u(F.projectMany(z.jsonAdapter,p,v,l,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return n._createClass(f)}());q.checkProjectionSupport=
async function(f,c){f&&c&&(f=Array.isArray(f)?f.map(d=>G.isSome(d.geometry)?d.geometry.spatialReference:null).filter(G.isSome):[f],await F.initializeProjection(f.map(d=>({source:d,dest:c}))))};q.project=function(f,c,d,p){if(!f)return f;d||(d=c,c=f.spatialReference);return y.isValid(c)&&y.isValid(d)&&!y.equals(c,d)?D.canProject(c,d)?(f=y.isWebMercator(d)?a(f):h(f),f.spatialReference=d,f):F.projectMany(z.jsonAdapter,[f],c,d,null,p)[0]:f};q.projectMany=function(f,c,d){return e.push(f,c,d)};Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../core/Error ../core/mathUtils ../core/maybe ../core/promiseUtils ../core/unitUtils ../core/accessorSupport/tracking ../core/accessorSupport/tracking/SimpleObservable ../chunks/mat4 ../chunks/vec3 ../chunks/vec3f64 ./ellipsoidUtils ./Extent ./Multipoint ../chunks/pe ./Point ./Polygon ./Polyline ./support/aaBoundingRect ./support/Ellipsoid ./support/geodesicConstants ./support/GeographicTransformation ./support/spatialReferenceUtils ./support/SupportedGCSWkids ./support/zscale".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r,A,w,m,t,B){function J(){return!!cb&&d.isLoaded()}function C(pa){y.isNone(fb)&&(fb=Promise.all([d.load(),(new Promise((xa,sa)=>q(["../chunks/geometryEngineBase"],xa,sa))).then(xa=>xa.geometryEngineBase),new Promise((xa,sa)=>q(["./geometryAdapters/hydrated"],xa,sa))]));return fb.then(([,xa,{hydratedAdapter:sa}])=>{D.throwIfAborted(pa);O=sa;cb=xa.default;cb._enableProjection(d.pe);Jb.notify()})}function K(pa,xa,sa=null,Ca=null){return Array.isArray(pa)?
0===pa.length?[]:E(O,pa,pa[0].spatialReference,xa,sa,Ca):E(O,[pa],pa.spatialReference,xa,sa,Ca)[0]}function E(pa,xa,sa,Ca,Na=null,Oa=null){if(y.isNone(sa)||y.isNone(Ca))return xa;if(U(sa,Ca,Na))return xa.map(Wa=>y.unwrap(ba(Wa,sa,Ca)));if(y.isNone(Na)){const Wa=w.cacheKey(sa,Ca);void 0!==sb[Wa]?Na=sb[Wa]:(Na=H(sa,Ca,void 0),y.isNone(Na)&&(Na=new w),sb[Wa]=Na)}if(y.isNone(cb)||y.isNone(pa))throw new mb;return y.isSome(Oa)?cb._project(pa,xa,sa,Ca,Na,Oa):cb._project(pa,xa,sa,Ca,Na)}function I(pa,xa){if(!J())for(const sa of pa)if(y.isSome(sa)&&
!m.equals(sa.spatialReference,xa)&&m.isValid(sa.spatialReference)&&m.isValid(xa)&&!U(sa.spatialReference,xa))return k.trackAccess(Jb),{pending:C(),geometries:null};return{pending:null,geometries:pa.map(sa=>y.isNone(sa)?null:m.equals(sa.spatialReference,xa)?sa:m.isValid(sa.spatialReference)&&m.isValid(xa)?N(sa,xa):null)}}function H(pa,xa,sa=null){if(y.isNone(pa)||y.isNone(xa))return null;if(y.isNone(cb)||y.isNone(O))throw new mb;pa=cb._getTransformation(O,pa,xa,sa,sa?.spatialReference);return null!==
pa?w.fromGE(pa):null}function N(pa,xa){try{const sa=K(pa,xa);if(null==sa)return null;"xmin"in pa&&"xmin"in sa&&(sa.zmin=pa.zmin,sa.zmax=pa.zmax);const Ca=B.getGeometryZScaler(sa.type,pa.spatialReference,xa);y.isSome(Ca)&&Ca(sa);return sa}catch(sa){if(!(sa instanceof mb))throw sa;return null}}function U(pa,xa,sa){return sa?!1:m.equals(pa,xa)?!0:m.isValid(pa)&&m.isValid(xa)&&!!Ha(pa,xa,$b)}function ba(pa,xa,sa){return pa?"x"in pa?la(pa,xa,new p,sa,0):"xmin"in pa?P(pa,xa,new f,sa,0):"rings"in pa?V(pa,
xa,new v,sa,0):"paths"in pa?ka(pa,xa,new l,sa,0):"points"in pa?aa(pa,xa,new c,sa,0):null:null}function la(pa,xa,sa,Ca,Na){ab[0]=pa.x;ab[1]=pa.y;const Oa=pa.z;ab[2]=void 0!==Oa?Oa:Na;if(!Y(ab,xa,0,ab,Ca,0,1))return null;sa.x=ab[0];sa.y=ab[1];sa.spatialReference=Ca;void 0===Oa?(sa.z=void 0,sa.hasZ=!1):(sa.z=ab[2],sa.hasZ=!0);void 0===pa.m?(sa.m=void 0,sa.hasM=!1):(sa.m=pa.m,sa.hasM=!0);return sa}function aa(pa,xa,sa,Ca,Na){const {points:Oa,hasZ:Wa,hasM:bb}=pa;pa=[];const ub=Oa.length,tb=[];for(var rb of Oa)tb.push(rb[0],
rb[1],Wa?rb[2]:Na);if(!Y(tb,xa,0,tb,Ca,0,ub))return null;for(xa=0;xa<ub;++xa){Na=3*xa;rb=tb[Na];const vb=tb[Na+1];Wa&&bb?pa.push([rb,vb,tb[Na+2],Oa[xa][3]]):Wa?pa.push([rb,vb,tb[Na+2]]):bb?pa.push([rb,vb,Oa[xa][2]]):pa.push([rb,vb])}sa.points=pa;sa.spatialReference=Ca;sa.hasZ=Wa;sa.hasM=bb;return sa}function ka(pa,xa,sa,Ca,Na){const {paths:Oa,hasZ:Wa,hasM:bb}=pa;pa=[];if(!ua(Oa,Wa??!1,bb??!1,xa,pa,Ca,Na))return null;sa.paths=pa;sa.spatialReference=Ca;sa.hasZ=Wa;sa.hasM=bb;return sa}function V(pa,
xa,sa,Ca,Na){const {rings:Oa,hasZ:Wa,hasM:bb}=pa;pa=[];if(!ua(Oa,Wa??!1,bb??!1,xa,pa,Ca,Na))return null;sa.rings=pa;sa.spatialReference=Ca;sa.hasZ=Wa;sa.hasM=bb;return sa}function P(pa,xa,sa,Ca,Na){const {xmin:Oa,ymin:Wa,xmax:bb,ymax:ub,hasZ:tb,hasM:rb}=pa;if(!S(Oa,Wa,tb?pa.zmin:Na,xa,ab,Ca))return null;sa.xmin=ab[0];sa.ymin=ab[1];tb&&(sa.zmin=ab[2]);if(!S(bb,ub,tb?pa.zmax:Na,xa,ab,Ca))return null;sa.xmax=ab[0];sa.ymax=ab[1];tb&&(sa.zmax=ab[2]);rb&&(sa.mmin=pa.mmin,sa.mmax=pa.mmax);sa.spatialReference=
Ca;return sa}function S(pa,xa,sa,Ca,Na,Oa){pb[0]=pa;pb[1]=xa;pb[2]=sa;return Y(pb,Ca,0,Na,Oa,0,1)}function X(pa,xa,sa,Ca){if(y.isNone(xa)||y.isNone(Ca)||2>pa.length)return!1;2===pa.length&&(pb[0]=pa[0],pb[1]=pa[1],pb[2]=0,pa=pb);return Y(pa,xa,0,sa,Ca,0,1)}function ra(pa,xa,sa){if(y.isNone(xa))return!1;xa=M(xa,Pb);xa=Gb[xa][Ba.WGS84_COMPARABLE_LON_LAT];if(y.isNone(xa))return!1;xa(pa,0,pb,0);sa!==pb&&(sa[0]=pb[0],sa[1]=pb[1],2<sa.length&&(sa[2]=pb[2]));return!0}function Y(pa,xa,sa,Ca,Na,Oa,Wa=1){xa=
Ha(xa,Na,$b);if(y.isNone(xa))return!1;if(xa===Q){if(pa===Ca&&sa===Oa)return!0;Wa=sa+3*Wa;for(let bb=sa,ub=Oa;bb<Wa;bb++,ub++)Ca[ub]=pa[bb];return!0}Wa=sa+3*Wa;for(let bb=sa,ub=Oa;bb<Wa;bb+=3,ub+=3)xa(pa,bb,Ca,ub);return!0}function ua(pa,xa,sa,Ca,Na,Oa,Wa=0){const bb=[];for(const ub of pa)for(const tb of ub)bb.push(tb[0],tb[1],xa?tb[2]:Wa);if(!Y(bb,Ca,0,bb,Oa,0,bb.length/3))return!1;Ca=0;Na.length=0;for(const ub of pa){pa=[];for(const tb of ub)xa&&sa?pa.push([bb[Ca++],bb[Ca++],bb[Ca++],tb[3]]):xa?
pa.push([bb[Ca++],bb[Ca++],bb[Ca++]]):(sa?pa.push([bb[Ca++],bb[Ca++],tb[2]]):pa.push([bb[Ca++],bb[Ca++]]),Ca++);Na.push(pa)}return!0}function ca(pa,xa,sa,Ca){xa=Ca+xa;if(xa<Ca/2||sa>xa)return Number.MAX_VALUE;pa=Math.abs(Hb*pa)+Math.asin(sa/xa);return pa>=Math.PI/2?Number.MAX_VALUE:sa/Math.cos(pa)}function ia(pa,xa,sa){const Ca=Math.sin(pa);pa=Math.cos(pa);const Na=Math.sin(xa);xa=Math.cos(xa);sa[0]=-Ca;sa[4]=-Na*pa;sa[8]=xa*pa;sa[12]=0;sa[1]=pa;sa[5]=-Na*Ca;sa[9]=xa*Ca;sa[13]=0;sa[2]=0;sa[6]=xa;
sa[10]=Na;sa[14]=0;sa[3]=0;sa[7]=0;sa[11]=0;sa[15]=1;return sa}function oa(pa,xa,sa){ia(pa,xa,sa);b.transpose(sa,sa);return sa}function M(pa,xa){if(!pa)return Ba.UNKNOWN;if(xa.spatialReference===pa)return xa.spatialReferenceId;xa.spatialReference=pa;"metersPerUnit"in xa&&(xa.metersPerUnit=x.getMetersPerUnitForSR(pa,1));return pa.wkt===e.SphericalECEFSpatialReferenceLike.wkt?xa.spatialReferenceId=Ba.SPHERICAL_ECEF:m.isWGS84(pa)?xa.spatialReferenceId=Ba.WGS84:m.isWebMercator(pa)?xa.spatialReferenceId=
Ba.WEB_MERCATOR:m.isPlateCarree(pa)?xa.spatialReferenceId=Ba.PLATE_CARREE:pa.wkt===e.WGS84ECEFSpatialReferenceLike.wkt?xa.spatialReferenceId=Ba.WGS84_ECEF:pa.wkid===t.SupportedGCSWkids.CGCS2000?xa.spatialReferenceId=Ba.CGCS2000:pa.wkt===e.SphericalPCPFMarsLike.wkt?xa.spatialReferenceId=Ba.SPHERICAL_MARS_PCPF:pa.wkt===e.SphericalPCPFMoonLike.wkt?xa.spatialReferenceId=Ba.SPHERICAL_MOON_PCPF:m.isMars(pa)?xa.spatialReferenceId=Ba.GCSMARS2000:m.isMoon(pa)?xa.spatialReferenceId=Ba.GCSMOON2000:xa.spatialReferenceId=
Ba.UNKNOWN}function Q(pa,xa,sa,Ca){pa!==sa&&(sa[Ca++]=pa[xa++],sa[Ca++]=pa[xa++],sa[Ca]=pa[xa])}function fa(pa,xa,sa,Ca){sa[Ca++]=Lb*(pa[xa++]/r.earth.radius);sa[Ca++]=Lb*(Math.PI/2-2*Math.atan(Math.exp(-pa[xa++]/r.earth.radius)));sa[Ca]=pa[xa]}function na(pa,xa,sa,Ca){fa(pa,xa,sa,Ca);Da(sa,Ca,sa,Ca)}function za(pa,xa,sa,Ca){fa(pa,xa,sa,Ca);Ta(sa,Ca,sa,Ca)}function W(pa,xa,sa,Ca,Na){var Oa=.4999999*Math.PI;Oa=z.clamp(Hb*pa[xa+1],-Oa,Oa);Oa=Math.sin(Oa);sa[Ca++]=Hb*pa[xa]*Na.radius;sa[Ca++]=Na.halfSemiMajorAxis*
Math.log((1+Oa)/(1-Oa));sa[Ca]=pa[xa+2]}function da(pa,xa,sa,Ca){W(pa,xa,sa,Ca,r.earth)}function ha(pa,xa,sa,Ca){sa[Ca]=pa[xa]*mc;sa[Ca+1]=pa[xa+1]*mc;sa[Ca+2]=pa[xa+2]}function ma(pa,xa,sa,Ca){sa[Ca]=pa[xa]*Sb;sa[Ca+1]=pa[xa+1]*Sb;sa[Ca+2]=pa[xa+2]}function qa(pa,xa,sa,Ca){fa(pa,xa,sa,Ca);ha(sa,Ca,sa,Ca)}function wa(pa,xa,sa,Ca,Na){Na+=pa[xa+2];const Oa=Hb*pa[xa+1];pa=Hb*pa[xa];xa=Math.cos(Oa);sa[Ca++]=Math.cos(pa)*xa*Na;sa[Ca++]=Math.sin(pa)*xa*Na;sa[Ca]=Math.sin(Oa)*Na}function ya(pa,xa,sa,Ca){wa(pa,
xa,sa,Ca,r.moon.radius)}function Ea(pa,xa,sa,Ca){wa(pa,xa,sa,Ca,r.mars.radius)}function Da(pa,xa,sa,Ca){wa(pa,xa,sa,Ca,r.earth.radius)}function Ia(pa,xa,sa,Ca,Na){var Oa=pa[xa];const Wa=pa[xa+1];xa=pa[xa+2];pa=Math.sqrt(Oa*Oa+Wa*Wa+xa*xa);xa=z.asinClamped(xa/(0===pa?1:pa));Oa=Math.atan2(Wa,Oa);sa[Ca++]=Lb*Oa;sa[Ca++]=Lb*xa;sa[Ca]=pa-Na}function Ja(pa,xa,sa,Ca){Ia(pa,xa,sa,Ca,r.moon.radius)}function La(pa,xa,sa,Ca){Ia(pa,xa,sa,Ca,r.mars.radius)}function Ra(pa,xa,sa,Ca){Ia(pa,xa,sa,Ca,r.earth.radius)}
function Pa(pa,xa,sa,Ca){Ra(pa,xa,sa,Ca);da(sa,Ca,sa,Ca)}function Sa(pa,xa,sa,Ca){Ra(pa,xa,sa,Ca);Ta(sa,Ca,sa,Ca)}function Ta(pa,xa,sa,Ca){var Na=r.earth;const Oa=Hb*pa[xa];var Wa=Hb*pa[xa+1];pa=pa[xa+2];xa=Math.sin(Wa);Wa=Math.cos(Wa);const bb=Na.radius/Math.sqrt(1-Na.eccentricitySquared*xa*xa);sa[Ca++]=(bb+pa)*Wa*Math.cos(Oa);sa[Ca++]=(bb+pa)*Wa*Math.sin(Oa);sa[Ca++]=(bb*(1-Na.eccentricitySquared)+pa)*xa}function Qa(pa,xa,sa,Ca){var Na=A.earthEllipsoidConstants,Oa=pa[xa],Wa=pa[xa+1];pa=pa[xa+2];
let bb;xa=Math.abs(pa);var ub=Oa*Oa+Wa*Wa;var tb=Math.sqrt(ub);var rb=ub+pa*pa;var vb=Math.sqrt(rb);Oa=Math.atan2(Wa,Oa);var Mb=pa*pa/rb;rb=ub/rb;Wa=Na.a2/vb;ub=Na.a3-Na.a4/vb;.3<rb?(Mb=xa/vb*(1+rb*(Na.a1+Wa+Mb*ub)/vb),vb=Math.asin(Mb),Wa=Mb*Mb,rb=Math.sqrt(1-Wa)):(rb=tb/vb*(1-Mb*(Na.a5-Wa-rb*ub)/vb),vb=Math.acos(rb),Wa=1-rb*rb,Mb=Math.sqrt(Wa));bb=1-r.earth.eccentricitySquared*Wa;Wa=r.earth.radius/Math.sqrt(bb);Na=Na.a6*Wa;Wa=tb-Wa*rb;ub=xa-Na*Mb;xa=rb*Wa+Mb*ub;tb=rb*ub-Mb*Wa;Na=tb/(Na/bb+xa);vb+=
Na;0>pa&&(vb=-vb);sa[Ca++]=Lb*Oa;sa[Ca++]=Lb*vb;sa[Ca]=xa+tb*Na/2}function Ya(pa,xa,sa,Ca){Qa(pa,xa,sa,Ca);Da(sa,Ca,sa,Ca)}function Za(pa,xa,sa,Ca){Qa(pa,xa,sa,Ca);da(sa,Ca,sa,Ca)}function Ha(pa,xa,sa=lb()){return y.isNone(pa)||y.isNone(xa)?null:gb(pa,xa,sa).projector}function gb(pa,xa,sa){if(y.isNone(pa)||y.isNone(xa)||sa.source.spatialReference===pa&&sa.dest.spatialReference===xa)return sa;const Ca=M(pa,sa.source),Na=M(xa,sa.dest);Ca===Ba.UNKNOWN&&Na===Ba.UNKNOWN?m.equals(pa,xa)?sa.projector=Q:
sa.projector=null:sa.projector=Gb[Ca][Na];return sa}function lb(){return{source:{spatialReference:null,spatialReferenceId:Ba.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:Ba.UNKNOWN,metersPerUnit:1},projector:Q}}let cb=null,O=null,fb=null,sb={};const Jb=new g.SimpleObservable;let mb=function(pa){function xa(){return sa.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")}G._inherits(xa,pa);var sa=G._createSuper(xa);return G._createClass(xa)}(F);
var Ba;(function(pa){pa[pa.UNKNOWN=0]="UNKNOWN";pa[pa.SPHERICAL_ECEF=1]="SPHERICAL_ECEF";pa[pa.WGS84=2]="WGS84";pa[pa.WEB_MERCATOR=3]="WEB_MERCATOR";pa[pa.WGS84_ECEF=4]="WGS84_ECEF";pa[pa.CGCS2000=5]="CGCS2000";pa[pa.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT";pa[pa.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF";pa[pa.GCSMARS2000=8]="GCSMARS2000";pa[pa.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF";pa[pa.GCSMOON2000=10]="GCSMOON2000";pa[pa.LON_LAT=11]="LON_LAT";pa[pa.PLATE_CARREE=12]="PLATE_CARREE"})(Ba||
(Ba={}));const mc=r.earth.radius*Math.PI/180,Sb=180/(r.earth.radius*Math.PI),Gb={[Ba.WGS84]:{[Ba.CGCS2000]:null,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:Q,[Ba.WGS84_COMPARABLE_LON_LAT]:Q,[Ba.SPHERICAL_ECEF]:Da,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:da,[Ba.PLATE_CARREE]:ha,[Ba.WGS84]:Q,[Ba.WGS84_ECEF]:Ta},[Ba.CGCS2000]:{[Ba.CGCS2000]:Q,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:Q,[Ba.WGS84_COMPARABLE_LON_LAT]:Q,
[Ba.SPHERICAL_ECEF]:Da,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:null,[Ba.PLATE_CARREE]:ha,[Ba.WGS84]:null,[Ba.WGS84_ECEF]:Ta},[Ba.GCSMARS2000]:{[Ba.CGCS2000]:null,[Ba.GCSMARS2000]:Q,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:Q,[Ba.WGS84_COMPARABLE_LON_LAT]:null,[Ba.SPHERICAL_ECEF]:null,[Ba.SPHERICAL_MARS_PCPF]:Ea,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:null,[Ba.PLATE_CARREE]:null,[Ba.WGS84]:null,[Ba.WGS84_ECEF]:null},[Ba.GCSMOON2000]:{[Ba.CGCS2000]:null,
[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:Q,[Ba.LON_LAT]:Q,[Ba.WGS84_COMPARABLE_LON_LAT]:null,[Ba.SPHERICAL_ECEF]:null,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:ya,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:null,[Ba.PLATE_CARREE]:null,[Ba.WGS84]:null,[Ba.WGS84_ECEF]:null},[Ba.WEB_MERCATOR]:{[Ba.CGCS2000]:null,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:fa,[Ba.WGS84_COMPARABLE_LON_LAT]:fa,[Ba.SPHERICAL_ECEF]:na,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,
[Ba.WEB_MERCATOR]:Q,[Ba.PLATE_CARREE]:qa,[Ba.WGS84]:fa,[Ba.WGS84_ECEF]:za},[Ba.WGS84_ECEF]:{[Ba.CGCS2000]:Qa,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:Qa,[Ba.WGS84_COMPARABLE_LON_LAT]:Qa,[Ba.SPHERICAL_ECEF]:Ya,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:Za,[Ba.PLATE_CARREE]:function(pa,xa,sa,Ca){Qa(pa,xa,sa,Ca);ha(sa,Ca,sa,Ca)},[Ba.WGS84]:Qa,[Ba.WGS84_ECEF]:Q},[Ba.SPHERICAL_ECEF]:{[Ba.CGCS2000]:Ra,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:null,
[Ba.LON_LAT]:Ra,[Ba.WGS84_COMPARABLE_LON_LAT]:Ra,[Ba.SPHERICAL_ECEF]:Q,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:Pa,[Ba.PLATE_CARREE]:function(pa,xa,sa,Ca){Ra(pa,xa,sa,Ca);ha(sa,Ca,sa,Ca)},[Ba.WGS84]:Ra,[Ba.WGS84_ECEF]:Sa},[Ba.SPHERICAL_MARS_PCPF]:{[Ba.CGCS2000]:null,[Ba.GCSMARS2000]:La,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:La,[Ba.WGS84_COMPARABLE_LON_LAT]:null,[Ba.SPHERICAL_ECEF]:null,[Ba.SPHERICAL_MARS_PCPF]:Q,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,
[Ba.WEB_MERCATOR]:null,[Ba.PLATE_CARREE]:null,[Ba.WGS84]:null,[Ba.WGS84_ECEF]:null},[Ba.SPHERICAL_MOON_PCPF]:{[Ba.CGCS2000]:null,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:Ja,[Ba.LON_LAT]:Ja,[Ba.WGS84_COMPARABLE_LON_LAT]:null,[Ba.SPHERICAL_ECEF]:null,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:Q,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:null,[Ba.PLATE_CARREE]:null,[Ba.WGS84]:null,[Ba.WGS84_ECEF]:null},[Ba.UNKNOWN]:{[Ba.CGCS2000]:null,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:null,
[Ba.WGS84_COMPARABLE_LON_LAT]:null,[Ba.SPHERICAL_ECEF]:null,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:Q,[Ba.WEB_MERCATOR]:null,[Ba.PLATE_CARREE]:null,[Ba.WGS84]:null,[Ba.WGS84_ECEF]:null},[Ba.LON_LAT]:{[Ba.CGCS2000]:Q,[Ba.GCSMARS2000]:Q,[Ba.GCSMOON2000]:Q,[Ba.LON_LAT]:Q,[Ba.WGS84_COMPARABLE_LON_LAT]:Q,[Ba.SPHERICAL_ECEF]:Da,[Ba.SPHERICAL_MARS_PCPF]:Ea,[Ba.SPHERICAL_MOON_PCPF]:ya,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:da,[Ba.PLATE_CARREE]:ha,[Ba.WGS84]:Q,[Ba.WGS84_ECEF]:Ta},
[Ba.WGS84_COMPARABLE_LON_LAT]:{[Ba.CGCS2000]:null,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:Q,[Ba.WGS84_COMPARABLE_LON_LAT]:Q,[Ba.SPHERICAL_ECEF]:Da,[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:null,[Ba.PLATE_CARREE]:ha,[Ba.WGS84]:Q,[Ba.WGS84_ECEF]:Ta},[Ba.PLATE_CARREE]:{[Ba.CGCS2000]:ma,[Ba.GCSMARS2000]:null,[Ba.GCSMOON2000]:null,[Ba.LON_LAT]:ma,[Ba.WGS84_COMPARABLE_LON_LAT]:ma,[Ba.SPHERICAL_ECEF]:function(pa,xa,sa,Ca){ma(pa,xa,sa,
Ca);Da(sa,Ca,sa,Ca)},[Ba.SPHERICAL_MARS_PCPF]:null,[Ba.SPHERICAL_MOON_PCPF]:null,[Ba.UNKNOWN]:null,[Ba.WEB_MERCATOR]:function(pa,xa,sa,Ca){ma(pa,xa,sa,Ca);da(sa,Ca,sa,Ca)},[Ba.PLATE_CARREE]:Q,[Ba.WGS84]:ma,[Ba.WGS84_ECEF]:function(pa,xa,sa,Ca){ma(pa,xa,sa,Ca);Ta(sa,Ca,sa,Ca)}}},Pb={spatialReference:null,spatialReferenceId:Ba.UNKNOWN},ic={spatialReference:null,spatialReferenceId:Ba.UNKNOWN},$b=lb(),tc=lb(),Hb=z.deg2rad(1),Lb=z.rad2deg(1),pb=h.create(),ob=h.create(),Eb=h.create(),ab=h.create(),Tb=h.create();
n.canProjectToWGS84ComparableLonLat=function(pa){if(y.isNone(pa))return!1;pa=M(pa,Pb);return!!Gb[pa][Ba.WGS84_COMPARABLE_LON_LAT]};n.canProjectWithoutEngine=U;n.computeENUToSphericalPCPFLocalRotation=ia;n.computeSphericalPCPFToENULocalRotation=oa;n.computeTranslationToOriginAndRotation=function(pa,xa,sa,Ca){if(y.isNone(pa)||y.isNone(Ca))return!1;var Na=M(pa,Pb),Oa=M(Ca,ic);if(Na===Oa&&Oa!==Ba.SPHERICAL_ECEF&&Oa!==Ba.SPHERICAL_MARS_PCPF&&Oa!==Ba.SPHERICAL_MOON_PCPF&&(Na!==Ba.UNKNOWN||m.equals(pa,Ca)))return b.fromTranslation(sa,
xa),!0;if(Oa===Ba.SPHERICAL_ECEF||Oa===Ba.SPHERICAL_MARS_PCPF||Oa===Ba.SPHERICAL_MOON_PCPF){Na=Gb[Na][Ba.LON_LAT];Oa=Gb[Ba.LON_LAT][Oa];if(y.isNone(Na)||y.isNone(Oa))return!1;Na(xa,0,ob,0);Oa(ob,0,Eb,0);ia(Hb*ob[0],Hb*ob[1],sa);sa[12]=Eb[0];sa[13]=Eb[1];sa[14]=Eb[2];return!0}if((Oa===Ba.WEB_MERCATOR||Oa===Ba.PLATE_CARREE)&&(Na===Ba.WGS84||Na===Ba.CGCS2000&&Oa===Ba.PLATE_CARREE||Na===Ba.SPHERICAL_ECEF||Na===Ba.WEB_MERCATOR)){pa=Gb[Na][Ba.LON_LAT];Oa=Gb[Ba.LON_LAT][Oa];if(y.isNone(pa)||y.isNone(Oa))return!1;
pa(xa,0,ob,0);Oa(ob,0,Eb,0);Na===Ba.SPHERICAL_ECEF?oa(Hb*ob[0],Hb*ob[1],sa):b.identity(sa);sa[12]=Eb[0];sa[13]=Eb[1];sa[14]=Eb[2];return!0}return!1};n.getProjectorName=function(pa,xa){switch(Ha(pa,xa,$b)){case Q:return"copy3";case Da:return"wgs84ToSphericalECEF";case da:return"wgs84ToWebMercator";case ha:return"wgs84ToPlateCarree";case Ta:return"wgs84ToWGS84ECEF";case fa:return"webMercatorToWGS84";case na:return"webMercatorToSphericalECEF";case za:return"webMercatorToWGS84ECEF";case qa:return"webMercatorToPlateCarree";
case Qa:return"wgs84ECEFToWGS84";case Ya:return"wgs84ECEFToSphericalECEF";case Za:return"wgs84ECEFToWebMercator";case Ra:return"sphericalECEFToWGS84";case Pa:return"sphericalECEFToWebMercator";case La:return"sphericalMarsPCPFToMars2000";case Ja:return"sphericalMoonPCPFToMoon2000";case Sa:return"sphericalECEFToWGS84ECEF";case Ea:return"mars2000ToSphericalPCPF";case ya:return"moon2000ToSphericalPCPF";default:return null}};n.getTransformation=H;n.getTransformations=function(pa,xa,sa=null){if(y.isNone(cb)||
y.isNone(O))throw new mb;pa=cb._getTransformationBySuitability(O,pa,xa,sa,sa?.spatialReference);if(null!==pa){xa=[];for(const Ca of pa)xa.push(w.fromGE(Ca));return xa}return[]};n.initializeProjection=async function(pa,xa,sa,Ca){if(J())return D.waitTick(Ca);if(Array.isArray(pa))for(const {source:Na,dest:Oa,geographicTransformation:Wa}of pa){if(!U(Na,Oa,Wa))return C(Ca)}else if(!U(pa,xa,sa))return C(Ca);return D.waitTick(Ca)};n.isLoaded=J;n.load=C;n.localLinearScaleFactors=function(pa,xa,sa,Ca){if(y.isNone(xa)||
y.isNone(Ca))return!1;const Na=M(xa,Pb);var Oa=M(Ca,ic);if(Na===Oa&&Na!==Ba.UNKNOWN||m.equals(xa,Ca))return sa[0]=1,sa[1]=1,sa[2]=1,!0;if(Na===Ba.SPHERICAL_ECEF){xa=a.length(pa);pa=xa/Math.sqrt(pa[0]*pa[0]+pa[1]*pa[1]);xa/=r.earth.radius;if(Oa===Ba.WEB_MERCATOR)return sa[0]=pa*xa,sa[1]=pa*xa,sa[2]=1,!0;if(Oa===Ba.WGS84||Oa===Ba.CGCS2000)return Oa=Sb,sa[0]=Oa*pa*xa,sa[1]=Oa*xa,sa[2]=1,!0}else if(Na===Ba.PLATE_CARREE){if(Oa===Ba.WGS84||Oa===Ba.CGCS2000)return sa[0]=Sb,sa[1]=Sb,sa[2]=1,!0;if(Oa===Ba.WEB_MERCATOR)return Oa=
pa[1]/r.earth.radius,sa[0]=1,sa[1]=1/Math.cos(Oa),sa[2]=1,!0}return!1};n.lonLatToSphericalPCPF=function(pa,xa,sa,Ca){const Na=Math.cos(sa);pa[0]=Math.cos(xa)*Na*Ca;pa[1]=Math.sin(xa)*Na*Ca;pa[2]=Math.sin(sa)*Ca};n.lonLatToWebMercatorComparable=W;n.project=K;n.projectBoundingRect=function(pa,xa,sa,Ca){if(null==pa)return!1;if(m.equals(xa,Ca))return u.copy(sa,pa),!0;pb[0]=pa[0];pb[1]=pa[1];pb[2]=0;if(!Y(pb,xa,0,pb,Ca,0,1))return!1;sa[0]=pb[0];sa[1]=pb[1];pb[0]=pa[2];pb[1]=pa[3];pb[2]=0;if(!Y(pb,xa,0,
pb,Ca,0,1))return!1;sa[2]=pb[0];sa[3]=pb[1];return!0};n.projectBoundingSphere=function(pa,xa,sa,Ca){if(y.isNone(xa)||y.isNone(Ca))return!1;xa=gb(xa,Ca,tc);if(xa.projector===Q)return sa[0]=pa[0],sa[1]=pa[1],sa[2]=pa[2],sa[3]=pa[3],!0;if(y.isNone(xa.projector))return!1;const {source:Na,dest:Oa}=xa;if(Oa.spatialReferenceId===Ba.WEB_MERCATOR){xa=Gb[Na.spatialReferenceId][Ba.WGS84];if(y.isNone(xa))return!1;xa(pa,0,ob,0);da(ob,0,sa,0);sa[3]=ca(ob[1],pa[2],pa[3],r.earth.radius);return!0}if(Na.spatialReferenceId!==
Ba.WGS84&&Na.spatialReferenceId!==Ba.CGCS2000||Oa.spatialReferenceId!==Ba.PLATE_CARREE)xa.projector(pa,0,sa,0),sa[3]=pa[3]*(Na.metersPerUnit??1)/(Oa.metersPerUnit??1);else{Ca=Gb[Ba.SPHERICAL_ECEF][Ba.PLATE_CARREE];let Wa=pa[3];y.isSome(Gb[Na.spatialReferenceId][Ba.SPHERICAL_ECEF])&&y.isSome(Ca)&&(Wa=ca(pa[1],pa[2],pa[3],r.earth.radius));xa.projector(pa,0,sa,0);sa[3]=Wa}return!0};n.projectBuffer=Y;n.projectDirection=function(pa,xa,sa,Ca,Na){a.copy(ab,pa);a.add(Tb,pa,xa);X(ab,sa,ab,Na);X(Tb,sa,Tb,Na);
a.subtract(Ca,Tb,ab);a.normalize(Ca,Ca)};n.projectExtent=function(pa,xa,sa=xa.spatialReference,Ca=0){return y.isSome(pa.spatialReference)&&y.isSome(sa)&&y.isSome(P(pa,pa.spatialReference,xa,sa,Ca))};n.projectMany=E;n.projectMultipoint=function(pa,xa,sa=xa.spatialReference,Ca=0){return y.isSome(pa.spatialReference)&&y.isSome(sa)&&y.isSome(aa(pa,pa.spatialReference,xa,sa,Ca))};n.projectOrLoad=function(pa,xa){pa=I([pa],xa);return y.isSome(pa.pending)?{pending:pa.pending,geometry:null}:y.isSome(pa.geometries)?
{pending:null,geometry:pa.geometries[0]}:{pending:null,geometry:null}};n.projectOrLoadMany=I;n.projectPoint=function(pa,xa,sa=xa.spatialReference,Ca=0){return y.isSome(sa)&&y.isSome(pa.spatialReference)&&y.isSome(la(pa,pa.spatialReference,xa,sa,Ca))};n.projectPointToVector=function(pa,xa,sa,Ca=0){ab[0]=pa.x;ab[1]=pa.y;const Na=pa.z;ab[2]=void 0!==Na?Na:Ca;return Y(ab,pa.spatialReference,0,xa,sa,0,1)};n.projectPointToWGS84ComparableLonLat=function(pa,xa){ab[0]=pa.x;ab[1]=pa.y;const sa=pa.z;ab[2]=void 0!==
sa?sa:0;return ra(ab,pa.spatialReference,xa)};n.projectPolygon=function(pa,xa,sa=xa.spatialReference,Ca=0){return y.isSome(pa.spatialReference)&&y.isSome(sa)&&y.isSome(V(pa,pa.spatialReference,xa,sa,Ca))};n.projectPolygonToWGS84ComparableLonLat=function({hasZ:pa,spatialReference:xa,rings:sa},Ca,Na=0){xa=M(xa,Pb);xa=Gb[xa][Ba.WGS84_COMPARABLE_LON_LAT];if(y.isNone(xa))return!1;pa=pa?Oa=>Oa:Oa=>a.set(ab,Oa[0],Oa[1],Na);for(const Oa of sa){sa=[];for(const Wa of Oa){const bb=[0,0,Na];xa(pa(Wa),0,bb,0);
sa.push(bb)}Ca.push(sa)}return!0};n.projectPolyline=function(pa,xa,sa=xa.spatialReference,Ca=0){return y.isSome(pa.spatialReference)&&y.isSome(sa)&&y.isSome(ka(pa,pa.spatialReference,xa,sa,Ca))};n.projectPolylineToWGS84ComparableLonLat=function({hasZ:pa,spatialReference:xa,paths:sa},Ca,Na=0){xa=M(xa,Pb);xa=Gb[xa][Ba.WGS84_COMPARABLE_LON_LAT];if(y.isNone(xa))return!1;pa=pa?Oa=>Oa:Oa=>a.set(ab,Oa[0],Oa[1],Na);for(const Oa of sa){sa=[];for(const Wa of Oa){const bb=[0,0,Na];xa(pa(Wa),0,bb,0);sa.push(bb)}Ca.push(sa)}return!0};
n.projectVectorToDehydratedPoint=function(pa,xa,sa){return Y(pa,xa,0,ab,sa.spatialReference,0,1)?(sa.x=ab[0],sa.y=ab[1],sa.z=ab[2],sa):null};n.projectVectorToPoint=function(pa,xa,sa){if(y.isNone(xa)||y.isNone(sa))return null;const Ca=new p({spatialReference:sa});return Y(pa,xa,0,ab,sa,0,1)?(Ca.x=ab[0],Ca.y=ab[1],Ca.z=ab[2],Ca):null};n.projectVectorToVector=X;n.projectVectorToWGS84ComparableLonLat=function(pa,xa,sa){return ra(pa,xa,sa)};n.projectWithoutEngine=ba;n.projectXYZToVector=S;n.sphericalPCPFtoLonLatElevation=
Ia;n.test={get loadPromise(){return fb}};n.tryProjectWithZConversion=N;n.unload=function(){fb=O=cb=null;sb={}};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/core/accessorSupport/tracking/SimpleObservable":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../ObservableBase"],function(q,n,G){G=function(F){function z(){return y.apply(this,arguments)}n._inherits(z,F);var y=n._createSuper(z);z.prototype.notify=function(){var D=this._observers;if(D&&0<D.length){D=
D.slice();for(const x of D)x.onInvalidated(),x.onCommitted()}};return n._createClass(z)}(G.ObservableBase);q.SimpleObservable=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat4":function(){define(["exports","./vec3f64","./common"],function(q,n,G){function F(M,Q){M[0]=Q[0];M[1]=Q[1];M[2]=Q[2];M[3]=Q[3];M[4]=Q[4];M[5]=Q[5];M[6]=Q[6];M[7]=Q[7];M[8]=Q[8];M[9]=Q[9];M[10]=Q[10];M[11]=Q[11];M[12]=Q[12];M[13]=Q[13];M[14]=Q[14];M[15]=Q[15];return M}function z(M,Q,fa,na,za,
W,da,ha,ma,qa,wa,ya,Ea,Da,Ia,Ja,La){M[0]=Q;M[1]=fa;M[2]=na;M[3]=za;M[4]=W;M[5]=da;M[6]=ha;M[7]=ma;M[8]=qa;M[9]=wa;M[10]=ya;M[11]=Ea;M[12]=Da;M[13]=Ia;M[14]=Ja;M[15]=La;return M}function y(M){M[0]=1;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=1;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=1;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function D(M,Q){if(M===Q){const fa=Q[1],na=Q[2],za=Q[3],W=Q[6],da=Q[7],ha=Q[11];M[1]=Q[4];M[2]=Q[8];M[3]=Q[12];M[4]=fa;M[6]=Q[9];M[7]=Q[13];M[8]=na;M[9]=W;M[11]=Q[14];M[12]=za;M[13]=da;
M[14]=ha}else M[0]=Q[0],M[1]=Q[4],M[2]=Q[8],M[3]=Q[12],M[4]=Q[1],M[5]=Q[5],M[6]=Q[9],M[7]=Q[13],M[8]=Q[2],M[9]=Q[6],M[10]=Q[10],M[11]=Q[14],M[12]=Q[3],M[13]=Q[7],M[14]=Q[11],M[15]=Q[15];return M}function x(M,Q){k(M,Q)||y(M);return M}function k(M,Q){const fa=Q[0],na=Q[1],za=Q[2],W=Q[3],da=Q[4],ha=Q[5],ma=Q[6],qa=Q[7],wa=Q[8],ya=Q[9],Ea=Q[10],Da=Q[11],Ia=Q[12],Ja=Q[13],La=Q[14];Q=Q[15];const Ra=fa*ha-na*da,Pa=fa*ma-za*da,Sa=fa*qa-W*da,Ta=na*ma-za*ha,Qa=na*qa-W*ha,Ya=za*qa-W*ma,Za=wa*Ja-ya*Ia,Ha=wa*
La-Ea*Ia,gb=wa*Q-Da*Ia,lb=ya*La-Ea*Ja,cb=ya*Q-Da*Ja,O=Ea*Q-Da*La;let fb=Ra*O-Pa*cb+Sa*lb+Ta*gb-Qa*Ha+Ya*Za;if(!fb)return null;fb=1/fb;M[0]=(ha*O-ma*cb+qa*lb)*fb;M[1]=(za*cb-na*O-W*lb)*fb;M[2]=(Ja*Ya-La*Qa+Q*Ta)*fb;M[3]=(Ea*Qa-ya*Ya-Da*Ta)*fb;M[4]=(ma*gb-da*O-qa*Ha)*fb;M[5]=(fa*O-za*gb+W*Ha)*fb;M[6]=(La*Sa-Ia*Ya-Q*Pa)*fb;M[7]=(wa*Ya-Ea*Sa+Da*Pa)*fb;M[8]=(da*cb-ha*gb+qa*Za)*fb;M[9]=(na*gb-fa*cb-W*Za)*fb;M[10]=(Ia*Qa-Ja*Sa+Q*Ra)*fb;M[11]=(ya*Sa-wa*Qa-Da*Ra)*fb;M[12]=(ha*Ha-da*lb-ma*Za)*fb;M[13]=(fa*
lb-na*Ha+za*Za)*fb;M[14]=(Ja*Pa-Ia*Ta-La*Ra)*fb;M[15]=(wa*Ta-ya*Pa+Ea*Ra)*fb;return M}function g(M,Q){const fa=Q[0],na=Q[1],za=Q[2],W=Q[3],da=Q[4],ha=Q[5],ma=Q[6],qa=Q[7],wa=Q[8],ya=Q[9],Ea=Q[10],Da=Q[11],Ia=Q[12],Ja=Q[13],La=Q[14];Q=Q[15];M[0]=ha*(Ea*Q-Da*La)-ya*(ma*Q-qa*La)+Ja*(ma*Da-qa*Ea);M[1]=-(na*(Ea*Q-Da*La)-ya*(za*Q-W*La)+Ja*(za*Da-W*Ea));M[2]=na*(ma*Q-qa*La)-ha*(za*Q-W*La)+Ja*(za*qa-W*ma);M[3]=-(na*(ma*Da-qa*Ea)-ha*(za*Da-W*Ea)+ya*(za*qa-W*ma));M[4]=-(da*(Ea*Q-Da*La)-wa*(ma*Q-qa*La)+Ia*(ma*
Da-qa*Ea));M[5]=fa*(Ea*Q-Da*La)-wa*(za*Q-W*La)+Ia*(za*Da-W*Ea);M[6]=-(fa*(ma*Q-qa*La)-da*(za*Q-W*La)+Ia*(za*qa-W*ma));M[7]=fa*(ma*Da-qa*Ea)-da*(za*Da-W*Ea)+wa*(za*qa-W*ma);M[8]=da*(ya*Q-Da*Ja)-wa*(ha*Q-qa*Ja)+Ia*(ha*Da-qa*ya);M[9]=-(fa*(ya*Q-Da*Ja)-wa*(na*Q-W*Ja)+Ia*(na*Da-W*ya));M[10]=fa*(ha*Q-qa*Ja)-da*(na*Q-W*Ja)+Ia*(na*qa-W*ha);M[11]=-(fa*(ha*Da-qa*ya)-da*(na*Da-W*ya)+wa*(na*qa-W*ha));M[12]=-(da*(ya*La-Ea*Ja)-wa*(ha*La-ma*Ja)+Ia*(ha*Ea-ma*ya));M[13]=fa*(ya*La-Ea*Ja)-wa*(na*La-za*Ja)+Ia*(na*Ea-
za*ya);M[14]=-(fa*(ha*La-ma*Ja)-da*(na*La-za*Ja)+Ia*(na*ma-za*ha));M[15]=fa*(ha*Ea-ma*ya)-da*(na*Ea-za*ya)+wa*(na*ma-za*ha);return M}function b(M){const Q=M[0],fa=M[1],na=M[2],za=M[3],W=M[4],da=M[5],ha=M[6],ma=M[7],qa=M[8],wa=M[9],ya=M[10],Ea=M[11],Da=M[12],Ia=M[13],Ja=M[14];M=M[15];return(Q*da-fa*W)*(ya*M-Ea*Ja)-(Q*ha-na*W)*(wa*M-Ea*Ia)+(Q*ma-za*W)*(wa*Ja-ya*Ia)+(fa*ha-na*da)*(qa*M-Ea*Da)-(fa*ma-za*da)*(qa*Ja-ya*Da)+(na*ma-za*ha)*(qa*Ia-wa*Da)}function a(M,Q,fa){const na=Q[0],za=Q[1],W=Q[2],da=Q[3],
ha=Q[4],ma=Q[5],qa=Q[6],wa=Q[7],ya=Q[8],Ea=Q[9],Da=Q[10],Ia=Q[11],Ja=Q[12],La=Q[13],Ra=Q[14];Q=Q[15];let Pa=fa[0],Sa=fa[1],Ta=fa[2],Qa=fa[3];M[0]=Pa*na+Sa*ha+Ta*ya+Qa*Ja;M[1]=Pa*za+Sa*ma+Ta*Ea+Qa*La;M[2]=Pa*W+Sa*qa+Ta*Da+Qa*Ra;M[3]=Pa*da+Sa*wa+Ta*Ia+Qa*Q;Pa=fa[4];Sa=fa[5];Ta=fa[6];Qa=fa[7];M[4]=Pa*na+Sa*ha+Ta*ya+Qa*Ja;M[5]=Pa*za+Sa*ma+Ta*Ea+Qa*La;M[6]=Pa*W+Sa*qa+Ta*Da+Qa*Ra;M[7]=Pa*da+Sa*wa+Ta*Ia+Qa*Q;Pa=fa[8];Sa=fa[9];Ta=fa[10];Qa=fa[11];M[8]=Pa*na+Sa*ha+Ta*ya+Qa*Ja;M[9]=Pa*za+Sa*ma+Ta*Ea+Qa*La;
M[10]=Pa*W+Sa*qa+Ta*Da+Qa*Ra;M[11]=Pa*da+Sa*wa+Ta*Ia+Qa*Q;Pa=fa[12];Sa=fa[13];Ta=fa[14];Qa=fa[15];M[12]=Pa*na+Sa*ha+Ta*ya+Qa*Ja;M[13]=Pa*za+Sa*ma+Ta*Ea+Qa*La;M[14]=Pa*W+Sa*qa+Ta*Da+Qa*Ra;M[15]=Pa*da+Sa*wa+Ta*Ia+Qa*Q;return M}function h(M,Q,fa){const na=fa[0],za=fa[1];fa=fa[2];if(Q===M)M[12]=Q[0]*na+Q[4]*za+Q[8]*fa+Q[12],M[13]=Q[1]*na+Q[5]*za+Q[9]*fa+Q[13],M[14]=Q[2]*na+Q[6]*za+Q[10]*fa+Q[14],M[15]=Q[3]*na+Q[7]*za+Q[11]*fa+Q[15];else{const W=Q[0],da=Q[1],ha=Q[2],ma=Q[3],qa=Q[4],wa=Q[5],ya=Q[6],Ea=
Q[7],Da=Q[8],Ia=Q[9],Ja=Q[10],La=Q[11];M[0]=W;M[1]=da;M[2]=ha;M[3]=ma;M[4]=qa;M[5]=wa;M[6]=ya;M[7]=Ea;M[8]=Da;M[9]=Ia;M[10]=Ja;M[11]=La;M[12]=W*na+qa*za+Da*fa+Q[12];M[13]=da*na+wa*za+Ia*fa+Q[13];M[14]=ha*na+ya*za+Ja*fa+Q[14];M[15]=ma*na+Ea*za+La*fa+Q[15]}return M}function e(M,Q,fa){const na=fa[0],za=fa[1];fa=fa[2];M[0]=Q[0]*na;M[1]=Q[1]*na;M[2]=Q[2]*na;M[3]=Q[3]*na;M[4]=Q[4]*za;M[5]=Q[5]*za;M[6]=Q[6]*za;M[7]=Q[7]*za;M[8]=Q[8]*fa;M[9]=Q[9]*fa;M[10]=Q[10]*fa;M[11]=Q[11]*fa;M[12]=Q[12];M[13]=Q[13];M[14]=
Q[14];M[15]=Q[15];return M}function f(M,Q,fa,na){let za=na[0],W=na[1];na=na[2];let da=Math.sqrt(za*za+W*W+na*na);var ha=void 0,ma=void 0;let qa=void 0,wa=void 0,ya=void 0,Ea=void 0,Da=void 0,Ia=void 0,Ja=void 0,La=void 0,Ra=void 0,Pa=void 0,Sa=void 0,Ta=void 0,Qa=void 0,Ya=void 0,Za=void 0,Ha=void 0,gb=void 0,lb=void 0,cb=void 0,O=void 0;ma=ha=void 0;if(da<G.getEpsilon())return null;da=1/da;za*=da;W*=da;na*=da;ha=Math.sin(fa);ma=Math.cos(fa);qa=1-ma;wa=Q[0];ya=Q[1];Ea=Q[2];Da=Q[3];Ia=Q[4];Ja=Q[5];
La=Q[6];Ra=Q[7];Pa=Q[8];Sa=Q[9];Ta=Q[10];Qa=Q[11];Ya=za*za*qa+ma;Za=W*za*qa+na*ha;Ha=na*za*qa-W*ha;gb=za*W*qa-na*ha;lb=W*W*qa+ma;cb=na*W*qa+za*ha;O=za*na*qa+W*ha;ha=W*na*qa-za*ha;ma=na*na*qa+ma;M[0]=wa*Ya+Ia*Za+Pa*Ha;M[1]=ya*Ya+Ja*Za+Sa*Ha;M[2]=Ea*Ya+La*Za+Ta*Ha;M[3]=Da*Ya+Ra*Za+Qa*Ha;M[4]=wa*gb+Ia*lb+Pa*cb;M[5]=ya*gb+Ja*lb+Sa*cb;M[6]=Ea*gb+La*lb+Ta*cb;M[7]=Da*gb+Ra*lb+Qa*cb;M[8]=wa*O+Ia*ha+Pa*ma;M[9]=ya*O+Ja*ha+Sa*ma;M[10]=Ea*O+La*ha+Ta*ma;M[11]=Da*O+Ra*ha+Qa*ma;Q!==M&&(M[12]=Q[12],M[13]=Q[13],M[14]=
Q[14],M[15]=Q[15]);return M}function c(M,Q,fa){const na=Math.sin(fa);fa=Math.cos(fa);const za=Q[4],W=Q[5],da=Q[6],ha=Q[7],ma=Q[8],qa=Q[9],wa=Q[10],ya=Q[11];Q!==M&&(M[0]=Q[0],M[1]=Q[1],M[2]=Q[2],M[3]=Q[3],M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15]);M[4]=za*fa+ma*na;M[5]=W*fa+qa*na;M[6]=da*fa+wa*na;M[7]=ha*fa+ya*na;M[8]=ma*fa-za*na;M[9]=qa*fa-W*na;M[10]=wa*fa-da*na;M[11]=ya*fa-ha*na;return M}function d(M,Q,fa){const na=Math.sin(fa);fa=Math.cos(fa);const za=Q[0],W=Q[1],da=Q[2],ha=Q[3],ma=Q[8],qa=
Q[9],wa=Q[10],ya=Q[11];Q!==M&&(M[4]=Q[4],M[5]=Q[5],M[6]=Q[6],M[7]=Q[7],M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15]);M[0]=za*fa-ma*na;M[1]=W*fa-qa*na;M[2]=da*fa-wa*na;M[3]=ha*fa-ya*na;M[8]=za*na+ma*fa;M[9]=W*na+qa*fa;M[10]=da*na+wa*fa;M[11]=ha*na+ya*fa;return M}function p(M,Q,fa){const na=Math.sin(fa);fa=Math.cos(fa);const za=Q[0],W=Q[1],da=Q[2],ha=Q[3],ma=Q[4],qa=Q[5],wa=Q[6],ya=Q[7];Q!==M&&(M[8]=Q[8],M[9]=Q[9],M[10]=Q[10],M[11]=Q[11],M[12]=Q[12],M[13]=Q[13],M[14]=Q[14],M[15]=Q[15]);M[0]=za*fa+
ma*na;M[1]=W*fa+qa*na;M[2]=da*fa+wa*na;M[3]=ha*fa+ya*na;M[4]=ma*fa-za*na;M[5]=qa*fa-W*na;M[6]=wa*fa-da*na;M[7]=ya*fa-ha*na;return M}function v(M,Q){M[0]=1;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=1;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=1;M[11]=0;M[12]=Q[0];M[13]=Q[1];M[14]=Q[2];M[15]=1;return M}function l(M,Q){M[0]=Q[0];M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=Q[1];M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=Q[2];M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function u(M,Q,fa){if(0===Q)return y(M);let na=fa[0],za=fa[1];fa=
fa[2];let W=Math.sqrt(na*na+za*za+fa*fa),da=void 0,ha=void 0,ma=void 0;if(W<G.getEpsilon())return null;W=1/W;na*=W;za*=W;fa*=W;da=Math.sin(Q);ha=Math.cos(Q);ma=1-ha;M[0]=na*na*ma+ha;M[1]=za*na*ma+fa*da;M[2]=fa*na*ma-za*da;M[3]=0;M[4]=na*za*ma-fa*da;M[5]=za*za*ma+ha;M[6]=fa*za*ma+na*da;M[7]=0;M[8]=na*fa*ma+za*da;M[9]=za*fa*ma-na*da;M[10]=fa*fa*ma+ha;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function r(M,Q){const fa=Math.sin(Q);Q=Math.cos(Q);M[0]=1;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=Q;M[6]=fa;
M[7]=0;M[8]=0;M[9]=-fa;M[10]=Q;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function A(M,Q){const fa=Math.sin(Q);Q=Math.cos(Q);M[0]=Q;M[1]=0;M[2]=-fa;M[3]=0;M[4]=0;M[5]=1;M[6]=0;M[7]=0;M[8]=fa;M[9]=0;M[10]=Q;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function w(M,Q){const fa=Math.sin(Q);Q=Math.cos(Q);M[0]=Q;M[1]=fa;M[2]=0;M[3]=0;M[4]=-fa;M[5]=Q;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=1;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function m(M,Q,fa){var na=Q[0],za=Q[1],W=Q[2],da=Q[3],ha=na+
na,ma=za+za;const qa=W+W;Q=na*ha;const wa=na*ma;na*=qa;const ya=za*ma;za*=qa;W*=qa;ha*=da;ma*=da;da*=qa;M[0]=1-(ya+W);M[1]=wa+da;M[2]=na-ma;M[3]=0;M[4]=wa-da;M[5]=1-(Q+W);M[6]=za+ha;M[7]=0;M[8]=na+ma;M[9]=za-ha;M[10]=1-(Q+ya);M[11]=0;M[12]=fa[0];M[13]=fa[1];M[14]=fa[2];M[15]=1;return M}function t(M,Q){const fa=oa,na=-Q[0],za=-Q[1],W=-Q[2],da=Q[3],ha=Q[4],ma=Q[5],qa=Q[6],wa=Q[7],ya=na*na+za*za+W*W+da*da;0<ya?(fa[0]=2*(ha*da+wa*na+ma*W-qa*za)/ya,fa[1]=2*(ma*da+wa*za+qa*na-ha*W)/ya,fa[2]=2*(qa*da+wa*
W+ha*za-ma*na)/ya):(fa[0]=2*(ha*da+wa*na+ma*W-qa*za),fa[1]=2*(ma*da+wa*za+qa*na-ha*W),fa[2]=2*(qa*da+wa*W+ha*za-ma*na));m(M,Q,fa);return M}function B(M,Q){M[0]=Q[12];M[1]=Q[13];M[2]=Q[14];return M}function J(M,Q){const fa=Q[0],na=Q[1],za=Q[2],W=Q[4],da=Q[5],ha=Q[6],ma=Q[8],qa=Q[9];Q=Q[10];M[0]=Math.sqrt(fa*fa+na*na+za*za);M[1]=Math.sqrt(W*W+da*da+ha*ha);M[2]=Math.sqrt(ma*ma+qa*qa+Q*Q);return M}function C(M,Q){const fa=Q[0]+Q[5]+Q[10];let na=0;0<fa?(na=2*Math.sqrt(fa+1),M[3]=.25*na,M[0]=(Q[6]-Q[9])/
na,M[1]=(Q[8]-Q[2])/na,M[2]=(Q[1]-Q[4])/na):Q[0]>Q[5]&&Q[0]>Q[10]?(na=2*Math.sqrt(1+Q[0]-Q[5]-Q[10]),M[3]=(Q[6]-Q[9])/na,M[0]=.25*na,M[1]=(Q[1]+Q[4])/na,M[2]=(Q[8]+Q[2])/na):Q[5]>Q[10]?(na=2*Math.sqrt(1+Q[5]-Q[0]-Q[10]),M[3]=(Q[8]-Q[2])/na,M[0]=(Q[1]+Q[4])/na,M[1]=.25*na,M[2]=(Q[6]+Q[9])/na):(na=2*Math.sqrt(1+Q[10]-Q[0]-Q[5]),M[3]=(Q[1]-Q[4])/na,M[0]=(Q[8]+Q[2])/na,M[1]=(Q[6]+Q[9])/na,M[2]=.25*na);return M}function K(M,Q,fa,na){var za=Q[0],W=Q[1],da=Q[2],ha=Q[3],ma=za+za,qa=W+W,wa=da+da;Q=za*ma;const ya=
za*qa;za*=wa;const Ea=W*qa;W*=wa;da*=wa;ma*=ha;qa*=ha;ha*=wa;wa=na[0];const Da=na[1];na=na[2];M[0]=(1-(Ea+da))*wa;M[1]=(ya+ha)*wa;M[2]=(za-qa)*wa;M[3]=0;M[4]=(ya-ha)*Da;M[5]=(1-(Q+da))*Da;M[6]=(W+ma)*Da;M[7]=0;M[8]=(za+qa)*na;M[9]=(W-ma)*na;M[10]=(1-(Q+Ea))*na;M[11]=0;M[12]=fa[0];M[13]=fa[1];M[14]=fa[2];M[15]=1;return M}function E(M,Q,fa,na,za){var W=Q[0],da=Q[1],ha=Q[2],ma=Q[3],qa=W+W,wa=da+da,ya=ha+ha;Q=W*qa;var Ea=W*wa,Da=W*ya;W=da*wa;da*=ya;var Ia=ha*ya;ha=ma*qa;wa*=ma;const Ja=ma*ya;var La=na[0],
Ra=na[1];ya=na[2];na=za[0];ma=za[1];za=za[2];qa=(1-(W+Ia))*La;const Pa=(Ea+Ja)*La;La*=Da-wa;Ea=(Ea-Ja)*Ra;Ia=(1-(Q+Ia))*Ra;Ra*=da+ha;Da=(Da+wa)*ya;da=(da-ha)*ya;Q=(1-(Q+W))*ya;M[0]=qa;M[1]=Pa;M[2]=La;M[3]=0;M[4]=Ea;M[5]=Ia;M[6]=Ra;M[7]=0;M[8]=Da;M[9]=da;M[10]=Q;M[11]=0;M[12]=fa[0]+na-(qa*na+Ea*ma+Da*za);M[13]=fa[1]+ma-(Pa*na+Ia*ma+da*za);M[14]=fa[2]+za-(La*na+Ra*ma+Q*za);M[15]=1;return M}function I(M,Q){var fa=Q[0],na=Q[1],za=Q[2];Q=Q[3];var W=fa+fa,da=na+na;const ha=za+za;fa*=W;const ma=na*W;na*=
da;const qa=za*W,wa=za*da;za*=ha;W*=Q;da*=Q;Q*=ha;M[0]=1-na-za;M[1]=ma+Q;M[2]=qa-da;M[3]=0;M[4]=ma-Q;M[5]=1-fa-za;M[6]=wa+W;M[7]=0;M[8]=qa+da;M[9]=wa-W;M[10]=1-fa-na;M[11]=0;M[12]=0;M[13]=0;M[14]=0;M[15]=1;return M}function H(M,Q,fa,na,za,W,da){const ha=1/(fa-Q),ma=1/(za-na),qa=1/(W-da);M[0]=2*W*ha;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=2*W*ma;M[6]=0;M[7]=0;M[8]=(fa+Q)*ha;M[9]=(za+na)*ma;M[10]=(da+W)*qa;M[11]=-1;M[12]=0;M[13]=0;M[14]=da*W*2*qa;M[15]=0;return M}function N(M,Q,fa,na,za){Q=1/Math.tan(Q/2);
let W=void 0;M[0]=Q/fa;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=Q;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[11]=-1;M[12]=0;M[13]=0;M[15]=0;null!=za&&Infinity!==za?(W=1/(na-za),M[10]=(za+na)*W,M[14]=2*za*na*W):(M[10]=-1,M[14]=-2*na);return M}function U(M,Q,fa,na){const za=Math.tan(Q.upDegrees*Math.PI/180),W=Math.tan(Q.downDegrees*Math.PI/180),da=Math.tan(Q.leftDegrees*Math.PI/180);Q=Math.tan(Q.rightDegrees*Math.PI/180);const ha=2/(da+Q),ma=2/(za+W);M[0]=ha;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=ma;M[6]=0;M[7]=0;M[8]=-((da-
Q)*ha*.5);M[9]=(za-W)*ma*.5;M[10]=na/(fa-na);M[11]=-1;M[12]=0;M[13]=0;M[14]=na*fa/(fa-na);M[15]=0;return M}function ba(M,Q,fa,na,za,W,da){const ha=1/(Q-fa),ma=1/(na-za),qa=1/(W-da);M[0]=-2*ha;M[1]=0;M[2]=0;M[3]=0;M[4]=0;M[5]=-2*ma;M[6]=0;M[7]=0;M[8]=0;M[9]=0;M[10]=2*qa;M[11]=0;M[12]=(Q+fa)*ha;M[13]=(za+na)*ma;M[14]=(da+W)*qa;M[15]=1;return M}function la(M,Q,fa,na){var za=void 0;let W=void 0;var da=void 0,ha=void 0;let ma=void 0,qa=void 0;var wa=void 0,ya=void 0;let Ea=void 0,Da=void 0;const Ia=Q[0],
Ja=Q[1];Q=Q[2];da=na[0];ha=na[1];na=na[2];wa=fa[0];ya=fa[1];fa=fa[2];za=G.getEpsilon();if(Math.abs(Ia-wa)<za&&Math.abs(Ja-ya)<za&&Math.abs(Q-fa)<za)return y(M);wa=Ia-wa;ya=Ja-ya;Ea=Q-fa;Da=1/Math.sqrt(wa*wa+ya*ya+Ea*Ea);wa*=Da;ya*=Da;Ea*=Da;za=ha*Ea-na*ya;W=na*wa-da*Ea;da=da*ya-ha*wa;(Da=Math.sqrt(za*za+W*W+da*da))?(Da=1/Da,za*=Da,W*=Da,da*=Da):da=W=za=0;ha=ya*da-Ea*W;ma=Ea*za-wa*da;qa=wa*W-ya*za;(Da=Math.sqrt(ha*ha+ma*ma+qa*qa))?(Da=1/Da,ha*=Da,ma*=Da,qa*=Da):qa=ma=ha=0;M[0]=za;M[1]=ha;M[2]=wa;M[3]=
0;M[4]=W;M[5]=ma;M[6]=ya;M[7]=0;M[8]=da;M[9]=qa;M[10]=Ea;M[11]=0;M[12]=-(za*Ia+W*Ja+da*Q);M[13]=-(ha*Ia+ma*Ja+qa*Q);M[14]=-(wa*Ia+ya*Ja+Ea*Q);M[15]=1;return M}function aa(M,Q,fa,na){const za=Q[0],W=Q[1];Q=Q[2];var da=na[0];const ha=na[1];var ma=na[2];na=za-fa[0];let qa=W-fa[1];fa=Q-fa[2];let wa=na*na+qa*qa+fa*fa;0<wa&&(wa=1/Math.sqrt(wa),na*=wa,qa*=wa,fa*=wa);let ya=ha*fa-ma*qa;ma=ma*na-da*fa;da=da*qa-ha*na;wa=ya*ya+ma*ma+da*da;0<wa&&(wa=1/Math.sqrt(wa),ya*=wa,ma*=wa,da*=wa);M[0]=ya;M[1]=ma;M[2]=
da;M[3]=0;M[4]=qa*da-fa*ma;M[5]=fa*ya-na*da;M[6]=na*ma-qa*ya;M[7]=0;M[8]=na;M[9]=qa;M[10]=fa;M[11]=0;M[12]=za;M[13]=W;M[14]=Q;M[15]=1;return M}function ka(M){return"mat4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+", "+M[4]+", "+M[5]+", "+M[6]+", "+M[7]+", "+M[8]+", "+M[9]+", "+M[10]+", "+M[11]+", "+M[12]+", "+M[13]+", "+M[14]+", "+M[15]+")"}function V(M){return Math.sqrt(M[0]**2+M[1]**2+M[2]**2+M[3]**2+M[4]**2+M[5]**2+M[6]**2+M[7]**2+M[8]**2+M[9]**2+M[10]**2+M[11]**2+M[12]**2+M[13]**2+M[14]**2+M[15]**2)}
function P(M,Q,fa){M[0]=Q[0]+fa[0];M[1]=Q[1]+fa[1];M[2]=Q[2]+fa[2];M[3]=Q[3]+fa[3];M[4]=Q[4]+fa[4];M[5]=Q[5]+fa[5];M[6]=Q[6]+fa[6];M[7]=Q[7]+fa[7];M[8]=Q[8]+fa[8];M[9]=Q[9]+fa[9];M[10]=Q[10]+fa[10];M[11]=Q[11]+fa[11];M[12]=Q[12]+fa[12];M[13]=Q[13]+fa[13];M[14]=Q[14]+fa[14];M[15]=Q[15]+fa[15];return M}function S(M,Q,fa){M[0]=Q[0]-fa[0];M[1]=Q[1]-fa[1];M[2]=Q[2]-fa[2];M[3]=Q[3]-fa[3];M[4]=Q[4]-fa[4];M[5]=Q[5]-fa[5];M[6]=Q[6]-fa[6];M[7]=Q[7]-fa[7];M[8]=Q[8]-fa[8];M[9]=Q[9]-fa[9];M[10]=Q[10]-fa[10];M[11]=
Q[11]-fa[11];M[12]=Q[12]-fa[12];M[13]=Q[13]-fa[13];M[14]=Q[14]-fa[14];M[15]=Q[15]-fa[15];return M}function X(M,Q,fa){M[0]=Q[0]*fa;M[1]=Q[1]*fa;M[2]=Q[2]*fa;M[3]=Q[3]*fa;M[4]=Q[4]*fa;M[5]=Q[5]*fa;M[6]=Q[6]*fa;M[7]=Q[7]*fa;M[8]=Q[8]*fa;M[9]=Q[9]*fa;M[10]=Q[10]*fa;M[11]=Q[11]*fa;M[12]=Q[12]*fa;M[13]=Q[13]*fa;M[14]=Q[14]*fa;M[15]=Q[15]*fa;return M}function ra(M,Q,fa,na){M[0]=Q[0]+fa[0]*na;M[1]=Q[1]+fa[1]*na;M[2]=Q[2]+fa[2]*na;M[3]=Q[3]+fa[3]*na;M[4]=Q[4]+fa[4]*na;M[5]=Q[5]+fa[5]*na;M[6]=Q[6]+fa[6]*na;
M[7]=Q[7]+fa[7]*na;M[8]=Q[8]+fa[8]*na;M[9]=Q[9]+fa[9]*na;M[10]=Q[10]+fa[10]*na;M[11]=Q[11]+fa[11]*na;M[12]=Q[12]+fa[12]*na;M[13]=Q[13]+fa[13]*na;M[14]=Q[14]+fa[14]*na;M[15]=Q[15]+fa[15]*na;return M}function Y(M,Q){return M[0]===Q[0]&&M[1]===Q[1]&&M[2]===Q[2]&&M[3]===Q[3]&&M[4]===Q[4]&&M[5]===Q[5]&&M[6]===Q[6]&&M[7]===Q[7]&&M[8]===Q[8]&&M[9]===Q[9]&&M[10]===Q[10]&&M[11]===Q[11]&&M[12]===Q[12]&&M[13]===Q[13]&&M[14]===Q[14]&&M[15]===Q[15]}function ua(M,Q){if(M===Q)return!0;const fa=M[0],na=M[1],za=M[2],
W=M[3],da=M[4],ha=M[5],ma=M[6],qa=M[7],wa=M[8],ya=M[9],Ea=M[10],Da=M[11],Ia=M[12],Ja=M[13],La=M[14];M=M[15];const Ra=Q[0],Pa=Q[1],Sa=Q[2],Ta=Q[3],Qa=Q[4],Ya=Q[5],Za=Q[6],Ha=Q[7],gb=Q[8],lb=Q[9],cb=Q[10],O=Q[11],fb=Q[12],sb=Q[13],Jb=Q[14];Q=Q[15];const mb=G.getEpsilon();return Math.abs(fa-Ra)<=mb*Math.max(1,Math.abs(fa),Math.abs(Ra))&&Math.abs(na-Pa)<=mb*Math.max(1,Math.abs(na),Math.abs(Pa))&&Math.abs(za-Sa)<=mb*Math.max(1,Math.abs(za),Math.abs(Sa))&&Math.abs(W-Ta)<=mb*Math.max(1,Math.abs(W),Math.abs(Ta))&&
Math.abs(da-Qa)<=mb*Math.max(1,Math.abs(da),Math.abs(Qa))&&Math.abs(ha-Ya)<=mb*Math.max(1,Math.abs(ha),Math.abs(Ya))&&Math.abs(ma-Za)<=mb*Math.max(1,Math.abs(ma),Math.abs(Za))&&Math.abs(qa-Ha)<=mb*Math.max(1,Math.abs(qa),Math.abs(Ha))&&Math.abs(wa-gb)<=mb*Math.max(1,Math.abs(wa),Math.abs(gb))&&Math.abs(ya-lb)<=mb*Math.max(1,Math.abs(ya),Math.abs(lb))&&Math.abs(Ea-cb)<=mb*Math.max(1,Math.abs(Ea),Math.abs(cb))&&Math.abs(Da-O)<=mb*Math.max(1,Math.abs(Da),Math.abs(O))&&Math.abs(Ia-fb)<=mb*Math.max(1,
Math.abs(Ia),Math.abs(fb))&&Math.abs(Ja-sb)<=mb*Math.max(1,Math.abs(Ja),Math.abs(sb))&&Math.abs(La-Jb)<=mb*Math.max(1,Math.abs(La),Math.abs(Jb))&&Math.abs(M-Q)<=mb*Math.max(1,Math.abs(M),Math.abs(Q))}function ca(M){const Q=G.getEpsilon(),fa=M[0],na=M[1],za=M[2],W=M[4],da=M[5],ha=M[6],ma=M[8],qa=M[9];M=M[10];return Math.abs(1-(fa*fa+W*W+ma*ma))<=Q&&Math.abs(1-(na*na+da*da+qa*qa))<=Q&&Math.abs(1-(za*za+ha*ha+M*M))<=Q}function ia(M){return 1===M[0]&&0===M[1]&&0===M[2]&&0===M[4]&&1===M[5]&&0===M[6]&&
0===M[8]&&0===M[9]&&1===M[10]}const oa=n.create();n=Object.freeze(Object.defineProperty({__proto__:null,add:P,adjoint:g,copy:F,determinant:b,equals:ua,exactEquals:Y,frob:V,fromQuat:I,fromQuat2:t,fromRotation:u,fromRotationTranslation:m,fromRotationTranslationScale:K,fromRotationTranslationScaleOrigin:E,fromScaling:l,fromTranslation:v,fromXRotation:r,fromYRotation:A,fromZRotation:w,frustum:H,getRotation:C,getScaling:J,getTranslation:B,hasIdentityRotation:ia,identity:y,invert:k,invertOrIdentity:x,isOrthoNormal:ca,
lookAt:la,mul:a,multiply:a,multiplyScalar:X,multiplyScalarAndAdd:ra,ortho:ba,perspective:N,perspectiveFromFieldOfView:U,rotate:f,rotateX:c,rotateY:d,rotateZ:p,scale:e,set:z,str:ka,sub:S,subtract:S,targetTo:aa,translate:h,transpose:D},Symbol.toStringTag,{value:"Module"}));q.add=P;q.adjoint=g;q.copy=F;q.determinant=b;q.equals=ua;q.exactEquals=Y;q.frob=V;q.fromQuat=I;q.fromQuat2=t;q.fromRotation=u;q.fromRotationTranslation=m;q.fromRotationTranslationScale=K;q.fromRotationTranslationScaleOrigin=E;q.fromScaling=
l;q.fromTranslation=v;q.fromXRotation=r;q.fromYRotation=A;q.fromZRotation=w;q.frustum=H;q.getRotation=C;q.getScaling=J;q.getTranslation=B;q.hasIdentityRotation=ia;q.identity=y;q.invert=k;q.invertOrIdentity=x;q.isOrthoNormal=ca;q.lookAt=la;q.mat4=n;q.mul=a;q.multiply=a;q.multiplyScalar=X;q.multiplyScalarAndAdd=ra;q.ortho=ba;q.perspective=N;q.perspectiveFromFieldOfView=U;q.rotate=f;q.rotateX=c;q.rotateY=d;q.rotateZ=p;q.scale=e;q.set=z;q.str=ka;q.sub=S;q.subtract=S;q.targetTo=aa;q.translate=h;q.transpose=
D})},"esri/chunks/pe":function(){define(["require","exports","./_rollupPluginBabelHelpers","../assets","../core/has"],function(q,n,G,F,z){function y(){return!!n._pe}function D(){return!!z("esri-wasm")}function x(){return e?e:e=(new Promise((c,d)=>q(["./pe-wasm"],c,d))).then(c=>c.peWasm).then(({default:c})=>c({locateFile:d=>F.getAssetUrl(`esri/geometry/support/${d}`)})).then(c=>{k(c)})}function k(c){function d(l,u,r){l[u]=r(l[u])}n._pe=c;n.PeDefs.init();n.PeGTlistExtended.init();n.PeNotationMgrs.init();
n.PeNotationUtm.init();n.PePCSInfo.init();n.PeGCSExtent=function(l){function u(){return r.apply(this,arguments)}G._inherits(u,l);var r=G._createSuper(u);u.prototype.destroy=function(){n._pe.destroy(this)};return G._createClass(u)}(n._pe.PeGCSExtent);c=[n._pe.PeDatum,n._pe.PeGeogcs,n._pe.PeGeogtran,n._pe.PeObject,n._pe.PeParameter,n._pe.PePrimem,n._pe.PeProjcs,n._pe.PeSpheroid,n._pe.PeUnit];for(var p of c)d(p.prototype,"getName",l=>function(){return l.call(this,Array(n.PeDefs.PE_NAME_MAX))});for(const l of[n._pe.PeGeogtran,
n._pe.PeProjcs])d(l.prototype,"getParameters",u=>function(){const r=Array(n.PeDefs.PE_PARM_MAX);let A=u.call(this);for(let w=0;w<r.length;w++){const m=n._pe.getValue(A,"*");r[w]=m?n._pe.wrapPointer(m,n._pe.PeParameter):null;A+=Int32Array.BYTES_PER_ELEMENT}return r});d(n._pe.PeHorizon.prototype,"getCoord",l=>function(){const u=this.getSize();if(!u)return null;const r=[],A=l.call(this);h(r,u,A);return r});d(n._pe.PeGTlistExtendedEntry.prototype,"getEntries",l=>{const u=n._pe._pe_getPeGTlistExtendedGTsSize();
return function(){let r=null;var A=l.call(this);if(!n._pe.compare(A,n._pe.NULL)){r=[A];const w=this.getSteps();if(1<w){A=n._pe.getPointer(A);for(let m=1;m<w;m++)r.push(n._pe.wrapPointer(A+u*m,n._pe.PeGTlistExtendedGTs))}}return r}});const v=n._pe._pe_getPeHorizonSize();p=l=>function(){let u=this._cache;u||(this._cache=u=new Map);if(u.has(l))return u.get(l);let r=null;var A=l.call(this);if(!n._pe.compare(A,n._pe.NULL)){r=[A];const w=A.getNump();if(1<w){A=n._pe.getPointer(A);for(let m=1;m<w;m++)r.push(n._pe.wrapPointer(A+
v*m,n._pe.PeHorizon))}}u.set(l,r);return r};d(n._pe.PeProjcs.prototype,"horizonGcsGenerate",p);d(n._pe.PeProjcs.prototype,"horizonPcsGenerate",p);n._pe.PeObject.prototype.toString=function(l=n.PeDefs.PE_STR_OPTS_NONE){n._pe.ensureCache.prepare();const u=n._pe.getPointer(this),r=n._pe.ensureInt8(Array(n.PeDefs.PE_BUFFER_MAX));return n._pe.UTF8ToString(n._pe._pe_object_to_string_ext(u,l,r))}}function g(c){if(c){var d=n._pe.getClass(c);d&&(d=n._pe.getCache(d))&&(c=n._pe.getPointer(c))&&delete d[c]}}
function b(c,d){const p=[];d=Array(d);for(let v=0;v<c;v++)p.push(n._pe.ensureInt8(d));return p}function a(c){let d;Array.isArray(c[0])?(d=[],c.forEach(p=>{d.push(p[0],p[1])})):d=c;return d}function h(c,d,p,v=!1){if(v)for(v=0;v<2*d;v++)c[v]=n._pe.getValue(p+v*Float64Array.BYTES_PER_ELEMENT,"double");else{v=0===c.length;for(let l=0;l<d;l++)v&&(c[l]=Array(2)),c[l][0]=n._pe.getValue(p,"double"),c[l][1]=n._pe.getValue(p+Float64Array.BYTES_PER_ELEMENT,"double"),p+=2*Float64Array.BYTES_PER_ELEMENT}}let e;
n._pe=null;n.PeCSTransformations=void 0;(function(c){function d(l,u,r){n._pe.ensureCache.prepare();var A=a(r);const w=r===A;A=n._pe.ensureFloat64(A);(l=n._pe._pe_geog_to_proj(n._pe.getPointer(l),u,A))&&h(r,u,A,w);return l}function p(l,u,r){return v(l,u,r,0)}function v(l,u,r,A){n._pe.ensureCache.prepare();var w=a(r);const m=r===w;w=n._pe.ensureFloat64(w);(l=n._pe._pe_proj_to_geog_center(n._pe.getPointer(l),u,w,A))&&h(r,u,w,m);return l}c.geogToProj=d;c.projGeog=function(l,u,r,A){switch(A){case n.PeDefs.PE_TRANSFORM_P_TO_G:return p(l,
u,r);case n.PeDefs.PE_TRANSFORM_G_TO_P:return d(l,u,r)}return 0};c.projToGeog=p;c.projToGeogCenter=v})(n.PeCSTransformations||(n.PeCSTransformations={}));n.PeDefs=void 0;(function(c){c.init=function(){c.PE_BUFFER_MAX=n._pe.PeDefs.prototype.PE_BUFFER_MAX;c.PE_NAME_MAX=n._pe.PeDefs.prototype.PE_NAME_MAX;c.PE_MGRS_MAX=n._pe.PeDefs.prototype.PE_MGRS_MAX;c.PE_USNG_MAX=n._pe.PeDefs.prototype.PE_USNG_MAX;c.PE_DD_MAX=n._pe.PeDefs.prototype.PE_DD_MAX;c.PE_DDM_MAX=n._pe.PeDefs.prototype.PE_DDM_MAX;c.PE_DMS_MAX=
n._pe.PeDefs.prototype.PE_DMS_MAX;c.PE_UTM_MAX=n._pe.PeDefs.prototype.PE_UTM_MAX;c.PE_PARM_MAX=n._pe.PeDefs.prototype.PE_PARM_MAX;c.PE_TYPE_NONE=n._pe.PeDefs.prototype.PE_TYPE_NONE;c.PE_TYPE_GEOGCS=n._pe.PeDefs.prototype.PE_TYPE_GEOGCS;c.PE_TYPE_PROJCS=n._pe.PeDefs.prototype.PE_TYPE_PROJCS;c.PE_TYPE_GEOGTRAN=n._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;c.PE_TYPE_COORDSYS=n._pe.PeDefs.prototype.PE_TYPE_COORDSYS;c.PE_TYPE_UNIT=n._pe.PeDefs.prototype.PE_TYPE_UNIT;c.PE_TYPE_LINUNIT=n._pe.PeDefs.prototype.PE_TYPE_LINUNIT;
c.PE_STR_OPTS_NONE=n._pe.PeDefs.prototype.PE_STR_OPTS_NONE;c.PE_STR_AUTH_NONE=n._pe.PeDefs.prototype.PE_STR_AUTH_NONE;c.PE_STR_AUTH_TOP=n._pe.PeDefs.prototype.PE_STR_AUTH_TOP;c.PE_STR_NAME_CANON=n._pe.PeDefs.prototype.PE_STR_NAME_CANON;c.PE_PARM_X0=n._pe.PeDefs.prototype.PE_PARM_X0;c.PE_PARM_ND=n._pe.PeDefs.prototype.PE_PARM_ND;c.PE_TRANSFORM_1_TO_2=n._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;c.PE_TRANSFORM_2_TO_1=n._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;c.PE_TRANSFORM_P_TO_G=n._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;
c.PE_TRANSFORM_G_TO_P=n._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;c.PE_HORIZON_RECT=n._pe.PeDefs.prototype.PE_HORIZON_RECT;c.PE_HORIZON_POLY=n._pe.PeDefs.prototype.PE_HORIZON_POLY;c.PE_HORIZON_LINE=n._pe.PeDefs.prototype.PE_HORIZON_LINE;c.PE_HORIZON_DELTA=n._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(n.PeDefs||(n.PeDefs={}));n.PeFactory=void 0;(function(c){function d(u,r){let A=null,w=p[u];w||(w={},p[u]=w);w.hasOwnProperty(String(r))?A=w[r]:(u=n._pe.PeFactory.prototype.factoryByType(u,r),n._pe.compare(u,
n._pe.NULL)||(A=u,w[r]=A));return A=l(A)}const p={},v={},l=u=>{if(u){const r=u.getType();switch(r){case n.PeDefs.PE_TYPE_GEOGCS:u=n._pe.castObject(u,n._pe.PeGeogcs);break;case n.PeDefs.PE_TYPE_PROJCS:u=n._pe.castObject(u,n._pe.PeProjcs);break;case n.PeDefs.PE_TYPE_GEOGTRAN:u=n._pe.castObject(u,n._pe.PeGeogtran);break;default:r&n.PeDefs.PE_TYPE_UNIT&&(u=n._pe.castObject(u,n._pe.PeUnit))}}return u};c.initialize=function(){n._pe.PeFactory.prototype.initialize(null)};c.coordsys=function(u){return d(n.PeDefs.PE_TYPE_COORDSYS,
u)};c.factoryByType=d;c.fromString=function(u,r){let A=null,w=v[u];w||(w={},v[u]=w);w.hasOwnProperty(r)?A=w[r]:(u=n._pe.PeFactory.prototype.fromString(u,r),n._pe.compare(u,n._pe.NULL)||(A=u,w[r]=A));return A=l(A)};c.geogcs=function(u){return d(n.PeDefs.PE_TYPE_GEOGCS,u)};c.geogtran=function(u){return d(n.PeDefs.PE_TYPE_GEOGTRAN,u)};c.getCode=function(u){return n._pe.PeFactory.prototype.getCode(u)};c.projcs=function(u){return d(n.PeDefs.PE_TYPE_PROJCS,u)};c.unit=function(u){return d(n.PeDefs.PE_TYPE_UNIT,
u)}})(n.PeFactory||(n.PeFactory={}));n.PeGCSExtent=null;n.PeGTlistExtended=void 0;(function(c){let d;c.init=function(){c.PE_GTLIST_OPTS_COMMON=n._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;d=n._pe._pe_getPeGTlistExtendedEntrySize()};c.getGTlist=function(p,v,l,u,r,A){let w=null;const m=new n._pe.PeInteger(A);try{const t=n._pe.PeGTlistExtended.prototype.getGTlist(p,v,l,u,r,m);if(A=m.val)if(w=[t],1<A){const B=n._pe.getPointer(t);for(p=1;p<A;p++)w.push(n._pe.wrapPointer(B+d*p,n._pe.PeGTlistExtendedEntry))}}finally{n._pe.destroy(m)}return w}})(n.PeGTlistExtended||
(n.PeGTlistExtended={}));n.PeGTlistExtendedEntry=void 0;(function(c){c.destroy=function(d){if(d&&d.length){for(const p of d)g(p),p.getEntries().forEach(v=>{g(v);v=v.getGeogtran();g(v);v.getParameters().forEach(g);[v.getGeogcs1(),v.getGeogcs2()].forEach(l=>{g(l);const u=l.getDatum();g(u);g(u.getSpheroid());g(l.getPrimem());g(l.getUnit())})});n._pe.PeGTlistExtendedEntry.prototype.Delete(d[0])}}})(n.PeGTlistExtendedEntry||(n.PeGTlistExtendedEntry={}));n.PeGTTransformations=void 0;(function(c){c.geogToGeog=
function(d,p,v,l,u){n._pe.ensureCache.prepare();var r=a(v);const A=v===r;r=n._pe.ensureFloat64(r);let w=0;l&&(w=n._pe.ensureFloat64(l));(d=n._pe._pe_geog_to_geog(n._pe.getPointer(d),p,r,w,u))&&h(v,p,r,A);return d}})(n.PeGTTransformations||(n.PeGTTransformations={}));n.PeNotationDms=void 0;(function(c){const d=(v,l,u,r,A,w)=>{n._pe.ensureCache.prepare();switch(v){case "dd":var m=n._pe._pe_geog_to_dd;var t=n.PeDefs.PE_DD_MAX;break;case "ddm":m=n._pe._pe_geog_to_ddm;t=n.PeDefs.PE_DDM_MAX;break;case "dms":m=
n._pe._pe_geog_to_dms,t=n.PeDefs.PE_DMS_MAX}v=0;l&&(v=n._pe.getPointer(l));l=a(r);l=n._pe.ensureFloat64(l);t=b(u,t);r=n._pe.ensureInt32(t);if(A=m(v,u,l,A,r))for(m=0;m<u;m++)w[m]=n._pe.UTF8ToString(t[m]);return A},p=(v,l,u,r,A)=>{n._pe.ensureCache.prepare();switch(v){case "dd":var w=n._pe._pe_dd_to_geog;break;case "ddm":w=n._pe._pe_ddm_to_geog;break;case "dms":w=n._pe._pe_dms_to_geog}v=0;l&&(v=n._pe.getPointer(l));l=r.map(m=>n._pe.ensureString(m));r=n._pe.ensureInt32(l);l=n._pe.ensureFloat64(Array(2*
u));(w=w(v,u,r,l))&&h(A,u,l);return w};c.geogToDms=function(v,l,u,r,A){return d("dms",v,l,u,r,A)};c.dmsToGeog=function(v,l,u,r){return p("dms",v,l,u,r)};c.geogToDdm=function(v,l,u,r,A){return d("ddm",v,l,u,r,A)};c.ddmToGeog=function(v,l,u,r){return p("ddm",v,l,u,r)};c.geogToDd=function(v,l,u,r,A){return d("dd",v,l,u,r,A)};c.ddToGeog=function(v,l,u,r){return p("dd",v,l,u,r)}})(n.PeNotationDms||(n.PeNotationDms={}));n.PeNotationMgrs=void 0;(function(c){c.init=function(){c.PE_MGRS_STYLE_NEW=n._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;
c.PE_MGRS_STYLE_OLD=n._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;c.PE_MGRS_STYLE_AUTO=n._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;c.PE_MGRS_180_ZONE_1_PLUS=n._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;c.PE_MGRS_ADD_SPACES=n._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};c.geogToMgrsExtended=function(d,p,v,l,u,r,A){n._pe.ensureCache.prepare();let w=0;d&&(w=n._pe.getPointer(d));d=a(v);v=n._pe.ensureFloat64(d);d=b(p,n.PeDefs.PE_MGRS_MAX);const m=n._pe.ensureInt32(d);if(l=n._pe._pe_geog_to_mgrs_extended(w,
p,v,l,u,r,m))for(u=0;u<p;u++)A[u]=n._pe.UTF8ToString(d[u]);return l};c.mgrsToGeogExtended=function(d,p,v,l,u){n._pe.ensureCache.prepare();let r=0;d&&(r=n._pe.getPointer(d));d=v.map(A=>n._pe.ensureString(A));v=n._pe.ensureInt32(d);d=n._pe.ensureFloat64(Array(2*p));(l=n._pe._pe_mgrs_to_geog_extended(r,p,v,l,d))&&h(u,p,d);return l}})(n.PeNotationMgrs||(n.PeNotationMgrs={}));n.PeNotationUsng=void 0;(function(c){c.geogToUsng=function(d,p,v,l,u,r,A){n._pe.ensureCache.prepare();let w=0;d&&(w=n._pe.getPointer(d));
d=a(v);v=n._pe.ensureFloat64(d);d=b(p,n.PeDefs.PE_MGRS_MAX);const m=n._pe.ensureInt32(d);if(l=n._pe._pe_geog_to_usng(w,p,v,l,u,r,m))for(u=0;u<p;u++)A[u]=n._pe.UTF8ToString(d[u]);return l};c.usngToGeog=function(d,p,v,l){n._pe.ensureCache.prepare();var u=0;d&&(u=n._pe.getPointer(d));d=v.map(r=>n._pe.ensureString(r));v=n._pe.ensureInt32(d);d=n._pe.ensureFloat64(Array(2*p));(u=n._pe._pe_usng_to_geog(u,p,v,d))&&h(l,p,d);return u}})(n.PeNotationUsng||(n.PeNotationUsng={}));n.PeNotationUtm=void 0;(function(c){c.init=
function(){c.PE_UTM_OPTS_NONE=n._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;c.PE_UTM_OPTS_ADD_SPACES=n._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;c.PE_UTM_OPTS_NS=n._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};c.geogToUtm=function(d,p,v,l,u){n._pe.ensureCache.prepare();var r=0;d&&(r=n._pe.getPointer(d));d=a(v);v=n._pe.ensureFloat64(d);d=b(p,n.PeDefs.PE_UTM_MAX);const A=n._pe.ensureInt32(d);if(l=n._pe._pe_geog_to_utm(r,p,v,l,A))for(r=0;r<p;r++)u[r]=n._pe.UTF8ToString(d[r]);return l};c.utmToGeog=
function(d,p,v,l,u){n._pe.ensureCache.prepare();let r=0;d&&(r=n._pe.getPointer(d));d=v.map(A=>n._pe.ensureString(A));v=n._pe.ensureInt32(d);d=n._pe.ensureFloat64(Array(2*p));(l=n._pe._pe_utm_to_geog(r,p,v,l,d))&&h(u,p,d);return l}})(n.PeNotationUtm||(n.PeNotationUtm={}));n.PePCSInfo=void 0;(function(c){const d=new Map;c.init=function(){c.PE_PCSINFO_OPTION_NONE=n._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;c.PE_PCSINFO_OPTION_DOMAIN=n._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;c.PE_POLE_OUTSIDE_BOUNDARY=
n._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;c.PE_POLE_POINT=n._pe.PePCSInfo.prototype.PE_POLE_POINT};c.generate=function(p,v=c.PE_PCSINFO_OPTION_DOMAIN){let l=null,u=null;d.has(p)&&(u=d.get(p),u[v]&&(l=u[v]));l||(l=n._pe.PePCSInfo.prototype.generate(p,v),u||(u=[],d.set(p,u)),u[v]=l);return l}})(n.PePCSInfo||(n.PePCSInfo={}));n.PeVersion=void 0;(function(c){c.versionString=function(){return n._pe.PeVersion.prototype.version_string()}})(n.PeVersion||(n.PeVersion={}));const f=Object.freeze(Object.defineProperty({__proto__:null,
get PeCSTransformations(){return n.PeCSTransformations},get PeDefs(){return n.PeDefs},get PeFactory(){return n.PeFactory},get PeGCSExtent(){return n.PeGCSExtent},get PeGTTransformations(){return n.PeGTTransformations},get PeGTlistExtended(){return n.PeGTlistExtended},get PeGTlistExtendedEntry(){return n.PeGTlistExtendedEntry},get PeNotationDms(){return n.PeNotationDms},get PeNotationMgrs(){return n.PeNotationMgrs},get PeNotationUsng(){return n.PeNotationUsng},get PeNotationUtm(){return n.PeNotationUtm},
get PePCSInfo(){return n.PePCSInfo},get PeVersion(){return n.PeVersion},_init:k,get _pe(){return n._pe},isLoaded:y,isSupported:D,load:x},Symbol.toStringTag,{value:"Module"}));n._init=k;n.isLoaded=y;n.isSupported=D;n.load=x;n.pe=f})},"esri/geometry/support/geodesicConstants":function(){define(["exports","./Ellipsoid"],function(q,n){const G=Math.PI/180;var F=n.earth.radius;const z=n.earth.eccentricitySquared;F={a1:F*z,a2:F*z*F*z,a3:F*z*z/2,a4:F*z*F*z*2.5,a5:F*z+F*z*z/2,a6:1-z};n={4267:{a:6378206.4,
f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:n.earth.radius,f:n.earth.flattening},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:n.moon.radius,f:n.moon.flattening},104904:{a:3393400,f:.005207166853303471},104905:{a:n.mars.radius,f:n.mars.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,
f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,
f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},
104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:n.mars.radius,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};q.WKT_SPHEROID_REGEX=/SPHEROID\[([^\]]+)]/i;q.earthEllipsoidConstants=F;q.spheroids=n;q.toRadians=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/GeographicTransformation":function(){define(["../../chunks/_rollupPluginBabelHelpers",
"./GeographicTransformationStep"],function(q,n){return function(){function G(z){this.steps=[];this._cachedProjection={};this._chain="";this._gtlistentry=null;if(z&&z.steps)for(const y of z.steps)y instanceof n?this.steps.push(y):this.steps.push(new n({wkid:y.wkid,wkt:y.wkt,isInverse:y.isInverse}))}G.cacheKey=function(z,y){return[void 0!==z.wkid&&null!==z.wkid?z.wkid.toString():"-1",void 0!==z.wkt&&null!==z.wkt?z.wkt.toString():"",void 0!==y.wkid&&null!==y.wkid?y.wkid.toString():"-1",void 0!==y.wkt&&
null!==y.wkt?y.wkt.toString():""].join()};G.fromGE=function(z){const y=new G;let D="";for(const x of z.steps)z=n.fromGE(x),y.steps.push(z),D+=z.uid.toString()+",";y._cachedProjection={};y._gtlistentry=null;y._chain=D;return y};var F=G.prototype;F.getInverse=function(){const z=new G;z.steps=[];for(let y=this.steps.length-1;0<=y;y--)z.steps.push(this.steps[y].getInverse());return z};F.getGTListEntry=function(){let z="";for(const y of this.steps)z+=y.uid.toString()+",";z!==this._chain&&(this._gtlistentry=
null,this._cachedProjection={},this._chain=z);return this._gtlistentry};F.assignCachedGe=function(z,y,D){this._cachedProjection[G.cacheKey(z,y)]=D};F.getCachedGeTransformation=function(z,y){let D="";for(const x of this.steps)D+=x.uid.toString()+",";D!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=D);z=this._cachedProjection[G.cacheKey(z,y)];return void 0===z?null:z};return q._createClass(G)}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["../../chunks/_rollupPluginBabelHelpers"],
function(q){let n=0;return function(){function G(F){this.uid=n++;F?(this._wkt=null!=F.wkt?F.wkt:null,this._wkid=null!=F.wkid?F.wkid:-1,this._isInverse=null!=F.isInverse?!0===F.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}G.fromGE=function(F){const z=new G;z._wkt=F.wkt;z._wkid=F.wkid;z._isInverse=F.isInverse;return z};G.prototype.getInverse=function(){const F=new G;F._wkt=this.wkt;F._wkid=this._wkid;F._isInverse=!this.isInverse;return F};q._createClass(G,[{key:"wkt",get:function(){return this._wkt},
set:function(F){this._wkt=F;this.uid=n++}},{key:"wkid",get:function(){return this._wkid},set:function(F){this._wkid=F;this.uid=n++}},{key:"isInverse",get:function(){return this._isInverse},set:function(F){this._isInverse=F;this.uid=n++}}]);return G}()})},"esri/geometry/support/zscale":function(){define(["exports","../../core/maybe","../../core/unitUtils","./spatialReferenceUtils"],function(q,n,G,F){q.getGeometryZScaler=function(z,y,D){if(n.isNone(y)||n.isNone(D)||D.vcsWkid||F.equals(y,D))return null;
y=G.getMetersPerVerticalUnitForSR(y);D=G.getMetersPerVerticalUnitForSR(D);const x=y/D;if(1===x)return null;switch(z){case "point":case "esriGeometryPoint":return k=>{k&&null!=k.z&&(k.z*=x)};case "polyline":case "esriGeometryPolyline":return k=>{if(k)for(const g of k.paths)for(const b of g)2<b.length&&(b[2]*=x)};case "polygon":case "esriGeometryPolygon":return k=>{if(k)for(const g of k.rings)for(const b of g)2<b.length&&(b[2]*=x)};case "multipoint":case "esriGeometryMultipoint":return k=>{if(k)for(const g of k.points)2<
g.length&&(g[2]*=x)};case "extent":case "esriGeometryExtent":return k=>{k&&null!=k.zmin&&null!=k.zmax&&(k.zmin*=x,k.zmax*=x)};default:return null}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(q,n){let G=n._createClass(function(x,k,g){this.x=x;this.y=k;this.spatialReference=g;this.m=this.z=void 0}),F=n._createClass(function(x,k,g,b){this.rings=x;this.spatialReference=
k;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);b&&(this.hasM=b)}),z=n._createClass(function(x,k,g,b){this.paths=x;this.spatialReference=k;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);b&&(this.hasM=b)}),y=n._createClass(function(x,k,g,b){this.points=x;this.spatialReference=k;this.hasM=this.hasZ=void 0;g&&(this.hasZ=g);b&&(this.hasM=b)}),D=n._createClass(function(x,k,g,b,a){this.xmin=x;this.ymin=k;this.xmax=g;this.ymax=b;this.spatialReference=a;this.mmax=this.mmin=this.zmax=this.zmin=void 0});q.jsonAdapter=
{convertToGEGeometry:function(x,k){return null==k?null:x.convertJSONToGeometry(k)},exportPoint:function(x,k,g){g=new G(x.getPointX(k),x.getPointY(k),g);const b=x.hasZ(k),a=x.hasM(k);b&&(g.z=x.getPointZ(k));a&&(g.m=x.getPointM(k));return g},exportPolygon:function(x,k,g){return new F(x.exportPaths(k),g,x.hasZ(k),x.hasM(k))},exportPolyline:function(x,k,g){return new z(x.exportPaths(k),g,x.hasZ(k),x.hasM(k))},exportMultipoint:function(x,k,g){return new y(x.exportPoints(k),g,x.hasZ(k),x.hasM(k))},exportExtent:function(x,
k,g){var b=x.hasZ(k);const a=x.hasM(k);g=new D(x.getXMin(k),x.getYMin(k),x.getXMax(k),x.getYMax(k),g);b&&(b=x.getZExtent(k),g.zmin=b.vmin,g.zmax=b.vmax);a&&(x=x.getMExtent(k),g.mmin=x.vmin,g.mmax=x.vmax);return g}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(q){q.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,
centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,
supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./SnappingCandidate ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f){function c(l,u,r,A){const w=A.x-r.x;A=A.y-r.y;u=Math.min(1,Math.max(0,((u.x-r.x)*w+(u.y-r.y)*A)/(w*w+A*A)));l.x=r.x+w*u;l.y=r.y+A*u}function d(l,u){return l?u?4:3:u?3:2}let p=function(){function l(r,A,w){this.items=r;this.query=A;this.geometryType=w.geometryType;this.hasM=w.hasM;this.hasZ=w.hasZ;this.fieldsIndex=w.fieldsIndex;this.objectIdField=w.objectIdField;this.spatialReference=w.spatialReference;this.featureAdapter=w.featureAdapter}var u=l.prototype;u.createQueryResponseForCount=
function(){const r=new k(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return r.countDistinctValues(this.items);const {groupByFieldsForStatistics:A,having:w,outStatistics:m}=this.query;if(!A?.length)return 1;const t=new Map,B=new Map,J=new Set;for(const E of m){var {statisticType:C}=E;C="exceedslimit"!==C?E.onStatisticField:void 0;if(!B.has(C)){var K=[];for(const I of A){const H=this._getAttributeValues(r,I,t);K.push(H)}B.set(C,this._calculateUniqueValues(K,r.returnDistinctValues))}C=
B.get(C);for(const I in C){const {data:H,items:N}=C[I];K=H.join(",");w&&!r.validateItems(N,w)||J.add(K)}}return J.size};u.createQueryResponse=async function(){let r;r=this.query.outStatistics?this.query.outStatistics.some(A=>"exceedslimit"===A.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const A=this.query.geometry;x.isValid(this.query.outSR)&&!x.equals(A.spatialReference,
this.query.outSR)?r.queryGeometry=a.cleanFromGeometryEngine({spatialReference:this.query.outSR,...g.project(A,A.spatialReference,this.query.outSR)}):r.queryGeometry=a.cleanFromGeometryEngine({spatialReference:this.query.outSR,...A})}return r};u.createSnappingResponse=function(r,A){const w=this.featureAdapter,m=d(this.hasZ,this.hasM),{point:t,mode:B}=r,J="number"===typeof r.distance?r.distance:r.distance.x,C="number"===typeof r.distance?r.distance:r.distance.y,K={candidates:[]},E="esriGeometryPolygon"===
this.geometryType;A=this._getPointCreator(B,this.spatialReference,A);const I=new v(null,0),H=new v(null,0),N={x:0,y:0,z:0};for(const P of this.items){var U=w.getGeometry(P);if(F.isNone(U))continue;const {coords:S,lengths:X}=U;I.coords=S;H.coords=S;if(r.types&n.SnappingTypes.EDGE){U=0;for(var ba=0;ba<X.length;ba++){var la=X[ba];for(var aa=0;aa<la;aa++,U+=m){var ka=I;ka.coordsIndex=U;if(aa!==la-1){const ra=H;ra.coordsIndex=U+m;const Y=N;c(N,t,ka,ra);var V=(t.x-Y.x)/J;const ua=(t.y-Y.y)/C;V=V*V+ua*ua;
1>=V&&K.candidates.push(b.makeEdgeCandidate(w.getObjectId(P),A(Y),Math.sqrt(V),A(ka),A(ra)))}}}}if(r.types&n.SnappingTypes.VERTEX)for(U=E?S.length-m:S.length,ba=0;ba<U;ba+=m)la=I,la.coordsIndex=ba,aa=(t.x-la.x)/J,ka=(t.y-la.y)/C,aa=aa*aa+ka*ka,1>=aa&&K.candidates.push(b.makeVertexCandidate(w.getObjectId(P),A(la),Math.sqrt(aa)))}K.candidates.sort((P,S)=>P.distance-S.distance);return K};u._getPointCreator=function(r,A,w){const m=F.isSome(w)&&!x.equals(A,w)?B=>g.project(B,A,w):B=>B,{hasZ:t}=this;return"3d"===
r?t?({x:B,y:J,z:C})=>m({x:B,y:J,z:C}):({x:B,y:J})=>m({x:B,y:J,z:0}):({x:B,y:J})=>m({x:B,y:J})};u.createSummaryStatisticsResponse=async function(r){const {field:A,valueExpression:w,normalizationField:m,normalizationType:t,normalizationTotal:B,minValue:J,maxValue:C,scale:K}=r;r=this.fieldsIndex.isDateField(A);var E=await this._getDataValues({field:A,valueExpression:w,normalizationField:m,normalizationType:t,normalizationTotal:B,scale:K});const I=e.isNullCountSupported({normalizationType:t,normalizationField:m,
minValue:J,maxValue:C}),H=this.fieldsIndex.get(A),N={value:.5,fieldType:H?.type};E=h.isStringField(H)?e.calculateStringStatistics({values:E,supportsNullCount:I,percentileParams:N}):e.calculateStatistics({values:E,minValue:J,maxValue:C,useSampleStdDev:!t,supportsNullCount:I,percentileParams:N});return e.processSummaryStatisticsResult(E,r)};u.createUniqueValuesResponse=async function(r){const {field:A,valueExpression:w,domains:m,returnAllCodedValues:t,scale:B}=r;var J=await this._getDataValues({field:A,
field2:r.field2,field3:r.field3,fieldDelimiter:r.fieldDelimiter,valueExpression:w,scale:B});J=e.calculateUniqueValuesCount(J);return e.createUVResult(J,m,t,r.fieldDelimiter)};u.createClassBreaksResponse=async function(r){const {field:A,valueExpression:w,normalizationField:m,normalizationType:t,normalizationTotal:B,classificationMethod:J,standardDeviationInterval:C,minValue:K,maxValue:E,numClasses:I,scale:H}=r;r=await this._getDataValues({field:A,valueExpression:w,normalizationField:m,normalizationType:t,
normalizationTotal:B,scale:H});r=e.calculateClassBreaks(r,{field:A,normalizationField:m,normalizationType:t,normalizationTotal:B,classificationMethod:J,standardDeviationInterval:C,minValue:K,maxValue:E,numClasses:I});return e.resolveCBResult(r,J)};u.createHistogramResponse=async function(r){const {field:A,valueExpression:w,normalizationField:m,normalizationType:t,normalizationTotal:B,classificationMethod:J,standardDeviationInterval:C,minValue:K,maxValue:E,numBins:I,scale:H}=r;r=await this._getDataValues({field:A,
valueExpression:w,normalizationField:m,normalizationType:t,normalizationTotal:B,scale:H});return e.calculateHistogram(r,{field:A,normalizationField:m,normalizationType:t,normalizationTotal:B,classificationMethod:J,standardDeviationInterval:C,minValue:K,maxValue:E,numBins:I})};u._sortFeatures=function(r,A,w){if(1<r.length&&A&&A.length)for(const m of A.reverse()){A=m.split(" ");const t=A[0],B=this.fieldsIndex.get(t);A=A[1]?"desc"===A[1].toLowerCase():!1;const J=e.getAttributeComparator(B?.type,A);r.sort((C,
K)=>{C=w(C,t,B);K=w(K,t,B);return J(C,K)})}};u._createFeatureQueryResponse=function(r){const A=this.items,{geometryType:w,hasM:m,hasZ:t,objectIdField:B,spatialReference:J}=this,{outFields:C,outSR:K,quantizationParameters:E,resultRecordCount:I,resultOffset:H,returnZ:N,returnM:U}=r,ba=null!=I?A.length>(H||0)+I:!1,la=C&&(C.includes("*")?[...this.fieldsIndex.fields]:C.map(aa=>this.fieldsIndex.get(aa)));return{exceededTransferLimit:ba,features:this._createFeatures(r,A),fields:la,geometryType:w,hasM:m&&
U,hasZ:t&&N,objectIdFieldName:B,spatialReference:a.cleanFromGeometryEngine(K||J),transform:E&&D.toQuantizationTransform(E)||null}};u._createFeatures=function(r,A){const w=new k(r,this.featureAdapter,this.fieldsIndex),{hasM:m,hasZ:t}=this,{orderByFields:B,quantizationParameters:J,returnGeometry:C,returnCentroid:K,maxAllowableOffset:E,resultOffset:I,resultRecordCount:H,returnZ:N=!1,returnM:U=!1}=r,ba=t&&N,la=m&&U;r=[];var aa=0;A=[...A];this._sortFeatures(A,B,(P,S,X)=>w.getFieldValue(P,S,X));if(C||K){var ka=
D.toQuantizationTransform(J)??void 0;if(C&&!K)for(var V of A)r[aa++]={attributes:w.getAttributes(V),geometry:a.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(V),E,ka,ba,la)};else if(!C&&K)for(const P of A)r[aa++]={attributes:w.getAttributes(P),centroid:a.transformCentroid(this,this.featureAdapter.getCentroid(P,this),ka)};else for(const P of A)r[aa++]={attributes:w.getAttributes(P),centroid:a.transformCentroid(this,this.featureAdapter.getCentroid(P,this),ka),geometry:a.getGeometry(this.geometryType,
this.hasZ,this.hasM,this.featureAdapter.getGeometry(P),E,ka,ba,la)}}else for(ka of A)(V=w.getAttributes(ka))&&(r[aa++]={attributes:V});aa=I||0;null!=H&&(r=r.slice(aa,Math.min(r.length,aa+H)));return r};u._createExceedsLimitQueryResponse=function(r){var A=!1;let w=Number.POSITIVE_INFINITY,m=Number.POSITIVE_INFINITY;A=Number.POSITIVE_INFINITY;for(const t of r.outStatistics??[])if("exceedslimit"===t.statisticType){w=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY;m=null!=t.maxRecordCount?
t.maxRecordCount:Number.POSITIVE_INFINITY;A=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)A=this.items.length>w;else if(this.items.length>m)A=!0;else{r=d(this.hasZ,this.hasM);const t=this.featureAdapter;A=this.items.reduce((B,J)=>{J=t.getGeometry(J);return B+(F.isSome(J)&&J.coords.length||0)},0)/r>A}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],
features:[{attributes:{exceedslimit:Number(A)}}]}};u._createStatisticsQueryResponse=async function(r){var A={attributes:{}};const w=[],m=new Map,t=new Map,B=new Map,J=new Map,C=new k(r,this.featureAdapter,this.fieldsIndex);var K=r.outStatistics;const {groupByFieldsForStatistics:E,having:I,orderByFields:H}=r;r=E&&E.length;const N=!!r,U=N?E[0]:null,ba=N&&!this.fieldsIndex.get(U);for(const P of K??[]){const {outStatisticFieldName:S,statisticType:X}=P;K=P;var la="exceedslimit"!==X?P.onStatisticField:
void 0;const ra="percentile_disc"===X||"percentile_cont"===X,Y="EnvelopeAggregate"===X||"CentroidAggregate"===X||"ConvexHullAggregate"===X,ua=N&&1===r&&(la===U||ba)&&"count"===X;if(N){if(!B.has(la)){var aa=[];for(const ca of E){var ka=this._getAttributeValues(C,ca,m);aa.push(ka)}B.set(la,this._calculateUniqueValues(aa,Y?!1:C.returnDistinctValues))}aa=B.get(la);for(const ca in aa){const {count:ia,data:oa,items:M,itemPositions:Q}=aa[ca];ka=oa.join(",");if(!I||C.validateItems(M,I)){const fa=J.get(ka)||
{attributes:{}};if(Y){fa.aggregateGeometries||(fa.aggregateGeometries={});const {aggregateGeometries:za,outStatisticFieldName:W}=await this._getAggregateGeometry(K,M);fa.aggregateGeometries[W]=za}else{var V=null;if(ua)V=ia;else{const za=this._getAttributeValues(C,la,m);V=Q.map(W=>za[W]);V=ra&&"statisticParameters"in K?this._getPercentileValue(K,V):this._getStatisticValue(K,V,null,C.returnDistinctValues)}fa.attributes[S]=V}let na=0;E.forEach((za,W)=>fa.attributes[this.fieldsIndex.get(za)?za:`EXPR_${++na}`]=
oa[W]);J.set(ka,fa)}}}else if(Y){A.aggregateGeometries||(A.aggregateGeometries={});const {aggregateGeometries:ca,outStatisticFieldName:ia}=await this._getAggregateGeometry(K,this.items);A.aggregateGeometries[ia]=ca}else la=this._getAttributeValues(C,la,m),A.attributes[S]=ra&&"statisticParameters"in K?this._getPercentileValue(K,la):this._getStatisticValue(K,la,t,C.returnDistinctValues);w.push({name:S,alias:S,type:"esriFieldTypeDouble"})}A=N?Array.from(J.values()):[A];this._sortFeatures(A,H,(P,S)=>
P.attributes[S]);return{fields:w,features:A}};u._getAggregateGeometry=async function(r,A){var w=await new Promise((H,N)=>q(["../../../geometry/geometryEngineJSON"],H,N));const {statisticType:m,outStatisticFieldName:t}=r,{featureAdapter:B,spatialReference:J,geometryType:C,hasZ:K,hasM:E}=this;A=A.map(H=>a.getGeometry(C,K,E,B.getGeometry(H)));const I=w.convexHull(J,A,!0)[0];r={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===m?(w=I?y.getPolygonExtent(I):y.getGeometryExtent(w.union(J,
A)),r.aggregateGeometries={...w,spatialReference:J},r.outStatisticFieldName=t||"extent"):"CentroidAggregate"===m?(w=I?z.polygonCentroid(I):z.extentCentroid(y.getGeometryExtent(w.union(J,A))),r.aggregateGeometries={x:w[0],y:w[1],spatialReference:J},r.outStatisticFieldName=t||"centroid"):"ConvexHullAggregate"===m&&(r.aggregateGeometries=I,r.outStatisticFieldName=t||"convexHull");return r};u._getStatisticValue=function(r,A,w,m){const {onStatisticField:t,statisticType:B}=r;r=null;r=w?.has(t)?w.get(t):
h.isStringField(this.fieldsIndex.get(t))?e.calculateStringStatistics({values:A,returnDistinct:m}):e.calculateStatistics({values:m?[...(new Set(A))]:A,minValue:null,maxValue:null,useSampleStdDev:!0});w&&w.set(t,r);return r["var"===B?"variance":B]};u._getPercentileValue=function(r,A){const {onStatisticField:w,statisticParameters:m,statisticType:t}=r,{value:B,orderBy:J}=m;r=this.fieldsIndex.get(w);return e.calculatePercentile(A,{value:B,orderBy:J,fieldType:r?.type,isDiscrete:"percentile_disc"===t})};
u._getAttributeValues=function(r,A,w){if(w.has(A))return w.get(A);const m=this.fieldsIndex.get(A),t=this.items.map(B=>r.getFieldValue(B,A,m));w.set(A,t);return t};u._getAttributeDataValues=function(r,A){return this.items.map(w=>r.getDataValue(w,{field:A.field,field2:A.field2,field3:A.field3,fieldDelimiter:A.fieldDelimiter,normalizationField:A.normalizationField,normalizationType:A.normalizationType,normalizationTotal:A.normalizationTotal}))};u._getAttributeExpressionValues=async function(r,A,w){const {arcadeUtils:m}=
await f.loadArcade();A=m.createFunction(A);w=w&&m.getViewInfo(w);return r.getExpressionValues(this.items,A,w,m)};u._calculateUniqueValues=function(r,A){const w={},m=this.items,t=m.length;for(let B=0;B<t;B++){const J=m[B],C=[];for(const E of r)C.push(E[B]);const K=C.join(",");null==w[K]?w[K]={count:1,data:C,items:[J],itemPositions:[B]}:(A||w[K].count++,w[K].items.push(J),w[K].itemPositions.push(B))}return w};u._getDataValues=async function(r){const A=new k(this.query,this.featureAdapter,this.fieldsIndex),
{valueExpression:w,field:m,normalizationField:t,normalizationType:B,normalizationTotal:J,scale:C}=r,K=w?{viewingMode:"map",scale:C,spatialReference:this.query.outSR||this.spatialReference}:null;return w?this._getAttributeExpressionValues(A,w,K):this._getAttributeDataValues(A,{field:m,field2:r.field2,field3:r.field3,fieldDelimiter:r.fieldDelimiter,normalizationField:t,normalizationType:B,normalizationTotal:J})};G._createClass(l,[{key:"size",get:function(){return this.items.length}}]);return l}();n.SnappingTypes=
void 0;(function(l){l[l.NONE=0]="NONE";l[l.EDGE=1]="EDGE";l[l.VERTEX=2]="VERTEX"})(n.SnappingTypes||(n.SnappingTypes={}));let v=function(){function l(u,r){this.coords=u;this.coordsIndex=r}G._createClass(l,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]);return l}();n.QueryEngineResult=p;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports",
"../../core/maybe","./jsonUtils"],function(q,n,G){function F({scale:B,translate:J},C){return Math.round((C-J[0])/B[0])}function z({scale:B,translate:J},C){return Math.round((J[1]-C)/B[1])}function y(B,J,C){const K=[];let E,I,H,N;for(let U=0;U<C.length;U++){const ba=C[U];if(0<U){if(H=F(B,ba[0]),N=z(B,ba[1]),H!==E||N!==I)K.push(J(ba,H-E,N-I)),E=H,I=N}else E=F(B,ba[0]),I=z(B,ba[1]),K.push(J(ba,E,I))}return 0<K.length?K:null}function D(B,J,C,K){return y(B,C?K?t:m:K?m:w,J)}function x(B,J,C,K){const E=
[];C=C?K?t:m:K?m:w;for(K=0;K<J.length;K++){const I=y(B,C,J[K]);I&&3<=I.length&&E.push(I)}return E.length?E:null}function k(B,J,C,K){const E=[];C=C?K?t:m:K?m:w;for(K=0;K<J.length;K++){const I=y(B,C,J[K]);I&&2<=I.length&&E.push(I)}return E.length?E:null}function g({scale:B,translate:J},C){return C*B[0]+J[0]}function b({scale:B,translate:J},C){return J[1]-C*B[1]}function a(B,J,C){const K=Array(C.length);if(!C.length)return K;const [E,I]=B.scale;let H=g(B,C[0][0]);B=b(B,C[0][1]);K[0]=J(C[0],H,B);for(let N=
1;N<C.length;N++){const U=C[N];H+=U[0]*E;B-=U[1]*I;K[N]=J(U,H,B)}return K}function h(B,J,C){const K=Array(C.length);for(let E=0;E<C.length;E++)K[E]=a(B,J,C[E]);return K}function e(B,J,C,K){return a(B,C?K?t:m:K?m:w,J)}function f(B,J,C,K){return h(B,C?K?t:m:K?m:w,J)}function c(B,J,C,K){return h(B,C?K?t:m:K?m:w,J)}function d(B,J,C){let [K,E]=C[0],I=Math.min(K,J[0]),H=Math.min(E,J[1]),N=Math.max(K,J[2]);J=Math.max(E,J[3]);for(let U=1;U<C.length;U++){const [ba,la]=C[U];K+=ba;E+=la;0>ba&&(I=Math.min(I,
K));0<ba&&(N=Math.max(N,K));0>la?H=Math.min(H,E):0<la&&(J=Math.max(J,E))}B[0]=I;B[1]=H;B[2]=N;B[3]=J;return B}function p(B,J){if(!J.length)return null;B[0]=B[1]=Number.POSITIVE_INFINITY;B[2]=B[3]=Number.NEGATIVE_INFINITY;for(let C=0;C<J.length;C++)d(B,B,J[C]);return B}function v(B,J,C,K,E){J.xmin=F(B,C.xmin);J.ymin=z(B,C.ymin);J.xmax=F(B,C.xmax);J.ymax=z(B,C.ymax);J!==C&&(K&&(J.zmin=C.zmin,J.zmax=C.zmax),E&&(J.mmin=C.mmin,J.mmax=C.mmax));return J}function l(B,J,C,K,E){J.points=D(B,C.points,K,E)??
[];return J}function u(B,J,C,K,E){J.x=F(B,C.x);J.y=z(B,C.y);J!==C&&(K&&(J.z=C.z),E&&(J.m=C.m));return J}function r(B,J,C,K,E){B=x(B,C.rings,K,E);if(!B)return null;J.rings=B;return J}function A(B,J,C,K,E){B=k(B,C.paths,K,E);if(!B)return null;J.paths=B;return J}const w=(B,J,C)=>[J,C],m=(B,J,C)=>[J,C,B[2]],t=(B,J,C)=>[J,C,B[2],B[3]];q.equals=function(B,J){if(B===J||null==B&&null==J)return!0;if(null==B||null==J)return!1;let C,K,E,I;B&&"upperLeft"===B.originPosition?(C=B.translate[0],K=B.translate[1],
B=B.scale[0]):(C=n.isSome(B.extent)?B.extent.xmin:0,K=n.isSome(B.extent)?B.extent.ymax:0,B=B.tolerance);J&&"upperLeft"===J.originPosition?(E=J.translate[0],I=J.translate[1],J=J.scale[0]):(E=n.isSome(J.extent)?J.extent.xmin:0,I=n.isSome(J.extent)?J.extent.ymax:0,J=J.tolerance);return C===E&&K===I&&B===J};q.getQuantizedBoundsCoordsArray=d;q.getQuantizedBoundsCoordsArrayArray=p;q.getQuantizedBoundsPaths=function(B){return p([0,0,0,0],B)};q.getQuantizedBoundsPoints=function(B){const J=[Number.POSITIVE_INFINITY,
Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return d(J,J,B)};q.getQuantizedBoundsRings=function(B){return p([0,0,0,0],B)};q.quantizeBounds=function(B,J,C){J[0]=F(B,C[0]);J[3]=z(B,C[1]);J[2]=F(B,C[2]);J[1]=z(B,C[3]);return J};q.quantizeExtent=v;q.quantizeGeometry=function(B,J){return B&&J?G.isPoint(J)?u(B,{},J,!1,!1):G.isPolyline(J)?A(B,{},J,!1,!1):G.isPolygon(J)?r(B,{},J,!1,!1):G.isMultipoint(J)?l(B,{},J,!1,!1):G.isExtent(J)?v(B,{},J,!1,!1):null:null};q.quantizeMultipoint=
l;q.quantizePaths=k;q.quantizePoint=u;q.quantizePoints=D;q.quantizePolygon=r;q.quantizePolyline=A;q.quantizeRings=x;q.quantizeX=F;q.quantizeY=z;q.toQuantizationTransform=function(B){return B?{originPosition:"upper-left"===B.originPosition?"upperLeft":"lower-left"===B.originPosition?"lowerLeft":B.originPosition,scale:B.tolerance?[B.tolerance,B.tolerance]:[1,1],translate:n.isSome(B.extent)?[B.extent.xmin,B.extent.ymax]:[0,0]}:null};q.unquantizeBounds=function(B,J,C){return C?(J[0]=g(B,C[0]),J[1]=b(B,
C[3]),J[2]=g(B,C[2]),J[3]=b(B,C[1]),J):[g(B,J[0]),b(B,J[3]),g(B,J[2]),b(B,J[1])]};q.unquantizeCoordsArray=a;q.unquantizeCoordsArrayArray=h;q.unquantizeExtent=function(B,J,C,K,E){J.xmin=g(B,C.xmin);J.ymin=b(B,C.ymin);J.xmax=g(B,C.xmax);J.ymax=b(B,C.ymax);J!==C&&(K&&(J.zmin=C.zmin,J.zmax=C.zmax),E&&(J.mmin=C.mmin,J.mmax=C.mmax));return J};q.unquantizeMultipoint=function(B,J,C,K,E){n.isSome(C)&&(J.points=e(B,C.points,K,E));return J};q.unquantizePaths=f;q.unquantizePoint=function(B,J,C,K,E){if(n.isNone(C))return J;
J.x=g(B,C.x);J.y=b(B,C.y);J!==C&&(K&&(J.z=C.z),E&&(J.m=C.m));return J};q.unquantizePoints=e;q.unquantizePolygon=function(B,J,C,K,E){n.isSome(C)&&(J.rings=c(B,C.rings,K,E));return J};q.unquantizePolyline=function(B,J,C,K,E){n.isSome(C)&&(J.paths=f(B,C.paths,K,E));return J};q.unquantizeRings=c;q.unquantizeX=g;q.unquantizeY=b;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe",
"./attributeSupport","../../../statistics/utils"],function(q,n,G,F){return function(){function z(D,x,k){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=D.returnDistinctValues??!1;this.fieldsIndex=k;this.featureAdapter=x;if((x=D.outFields)&&!x.includes("*")){this.outFields=x;D=0;for(const b of x){var g=G.getExpressionFromFieldName(b);g=(x=this.fieldsIndex.get(g))?null:G.getWhereClause(g,k);x=x?x.name:G.getAliasFromFieldName(b)||`FIELD_EXP_${D++}`;this._fieldDataCache.set(b,
{alias:x,clause:g})}}}var y=z.prototype;y.countDistinctValues=function(D){if(!this.returnDistinctValues)return D.length;D.forEach(x=>this.getAttributes(x));return this._returnDistinctMap.size};y.getAttributes=function(D){D=this._processAttributesForOutFields(D);return this._processAttributesForDistinctValues(D)};y.getFieldValue=function(D,x,k){const g=k?k.name:x;let b=null;this._fieldDataCache.has(g)?b=this._fieldDataCache.get(g)?.clause:k||(b=G.getWhereClause(x,this.fieldsIndex),this._fieldDataCache.set(g,
{alias:g,clause:b}));return k?this.featureAdapter.getAttribute(D,g):b?.calculateValue(D,this.featureAdapter)};y.getDataValue=function(D,x){const k=x.normalizationType,g=x.normalizationTotal;let b=x.field&&this.getFieldValue(D,x.field,this.fieldsIndex.get(x.field));x.field2&&(b=`${F.processNullValue(b)}${x.fieldDelimiter}${F.processNullValue(this.getFieldValue(D,x.field2,this.fieldsIndex.get(x.field2)))}`,x.field3&&(b=`${b}${x.fieldDelimiter}${F.processNullValue(this.getFieldValue(D,x.field3,this.fieldsIndex.get(x.field3)))}`));
k&&Number.isFinite(b)&&(D="field"===k&&x.normalizationField?this.getFieldValue(D,x.normalizationField,this.fieldsIndex.get(x.normalizationField)):null,b=F.getNormalizedValue(b,k,D,g));return b};y.getExpressionValue=function(D,x,k,g){D={attributes:this.featureAdapter.getAttributes(D),layer:{fields:this.fieldsIndex.fields}};k=g.createExecContext(D,k);return g.executeFunction(x,k)};y.getExpressionValues=function(D,x,k,g){const b={fields:this.fieldsIndex.fields};return D.map(a=>{a={attributes:this.featureAdapter.getAttributes(a),
layer:b};a=g.createExecContext(a,k);return g.executeFunction(x,a)})};y.validateItem=function(D,x){this._fieldDataCache.has(x)||this._fieldDataCache.set(x,{alias:x,clause:G.getWhereClause(x,this.fieldsIndex)});return this._fieldDataCache.get(x)?.clause?.testFeature(D,this.featureAdapter)??!1};y.validateItems=function(D,x){this._fieldDataCache.has(x)||this._fieldDataCache.set(x,{alias:x,clause:G.getWhereClause(x,this.fieldsIndex)});return this._fieldDataCache.get(x)?.clause?.testSet(D,this.featureAdapter)??
!1};y._processAttributesForOutFields=function(D){const x=this.outFields;if(!x||!x.length)return this.featureAdapter.getAttributes(D);const k={};for(const g of x){const {alias:b,clause:a}=this._fieldDataCache.get(g);k[b]=a?a.calculateValue(D,this.featureAdapter):this.featureAdapter.getAttribute(D,b)}return k};y._processAttributesForDistinctValues=function(D){if(n.isNone(D)||!this.returnDistinctValues)return D;var x=this.outFields,k=[];if(x)for(const b of x){var {alias:g}=this._fieldDataCache.get(b);
k.push(D[g])}else for(g in D)k.push(D[g]);x=`${(x||["*"]).join(",")}=${k.join(",")}`;k=this._returnDistinctMap.get(x)||0;this._returnDistinctMap.set(x,++k);return 1<k?null:D};return q._createClass(z)}()})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(q,n,G){function F(A){return null==A||"string"===typeof A&&!A?"\x3cNull\x3e":A}function z(A){const w=null!=A.minValue||null!=A.maxValue,m=!!A.sqlExpression&&
A.supportsSQLExpression;return!(null!=A.normalizationField||null!=A.normalizationType)&&!w&&!m}function y(A){const {values:w,useSampleStdDev:m,supportsNullCount:t}=A;var B=Number.POSITIVE_INFINITY;let J=Number.NEGATIVE_INFINITY,C=null,K=null;var E=null;let I=null,H=0;const N=null==A.minValue?-Infinity:A.minValue,U=null==A.maxValue?Infinity:A.maxValue;for(const ba of w)Number.isFinite(ba)?ba>=N&&ba<=U&&(C=null===C?ba:C+ba,B=Math.min(B,ba),J=Math.max(J,ba),H++):"string"===typeof ba&&H++;if(H&&null!=
C){K=C/H;E=0;for(const ba of w)Number.isFinite(ba)&&ba>=N&&ba<=U&&(E+=(ba-K)**2);I=m?1<H?E/(H-1):0:0<H?E/H:0;E=Math.sqrt(I)}else J=B=null;B={avg:K,count:H,max:J,min:B,stddev:E,sum:C,variance:I};t&&(B.nullcount=w.length-H);A.percentileParams&&(B.median=D(w,A.percentileParams));return B}function D(A,w){const {fieldType:m,value:t,orderBy:B,isDiscrete:J}=w,C=x(m,"desc"===B);A=[...A].filter(H=>null!=H).sort((H,N)=>C(H,N));if(0===A.length)return null;if(0>=t)return A[0];if(1<=t)return A[A.length-1];var K=
(A.length-1)*t,E=Math.floor(K);w=E+1;K%=1;E=A[E];const I=A[w];return w>=A.length||J||"string"===typeof E||"string"===typeof I?E:E*(1-K)+I*K}function x(A,w){const m=w?1:-1,t=b(w),B=g(w);if(!A||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...u].includes(A))return(J,C)=>"number"===typeof J&&"number"===typeof C?t(J,C):"string"===typeof J&&"string"===typeof C?B(J,C):m;if("esriFieldTypeDate"===A)return(J,C)=>{J=(new Date(J)).getTime();C=(new Date(C)).getTime();
return isNaN(J)||isNaN(C)?m:t(J,C)};if(u.has(A))return(J,C)=>t(J,C);if("esriFieldTypeString"===A)return(J,C)=>B(J,C);if("esriFieldTypeGUID"===A||"esriFieldTypeGlobalID"===A){const J=g(w);return(C,K)=>J(a(C),a(K))}return w?(J,C)=>1:(J,C)=>-1}function k(A,w,m){if(m){if(null==A)return null==w?0:1;if(null==w)return-1}else{if(null==A)return null==w?0:-1;if(null==w)return 1}return null}function g(A){return A?(w,m)=>{const t=k(w,m,!0);if(null!=t)return t;w=w.toUpperCase();m=m.toUpperCase();return w>m?-1:
w<m?1:0}:(w,m)=>{const t=k(w,m,!1);if(null!=t)return t;w=w.toUpperCase();m=m.toUpperCase();return w<m?-1:w>m?1:0}}function b(A){return A?(w,m)=>{const t=k(w,m,!0);return null!=t?t:m-w}:(w,m)=>{const t=k(w,m,!1);return null!=t?t:w-m}}function a(A){return A.substr(24,12)+A.substr(19,4)+A.substr(16,2)+A.substr(14,2)+A.substr(11,2)+A.substr(9,2)+A.substr(6,2)+A.substr(4,2)+A.substr(2,2)+A.substr(0,2)}function h(A){return"coded-value"!==A?.type?[]:A.codedValues.map(w=>w.code)}function e(A,w){const m=c({field:w.field,
normalizationType:w.normalizationType,normalizationField:w.normalizationField,classificationMethod:w.classificationMethod,standardDeviationInterval:w.standardDeviationInterval,breakCount:w.numClasses||5});A=f(A,w.minValue,w.maxValue);return G.createGenerateRendererClassBreaks({definition:m,values:A,normalizationTotal:w.normalizationTotal})}function f(A,w,m){const t=null==w?-Infinity:w,B=null==m?Infinity:m;return A.filter(J=>Number.isFinite(J)&&J>=t&&J<=B)}function c(A){const {breakCount:w,field:m,
normalizationField:t,normalizationType:B}=A,J=A.classificationMethod||"equal-interval";return new n({breakCount:w,classificationField:m,classificationMethod:J,normalizationField:"field"===B?t:void 0,normalizationType:B,standardDeviationInterval:"standard-deviation"===J?A.standardDeviationInterval||1:void 0})}function d(A,w){const {field:m,classificationMethod:t,standardDeviationInterval:B,normalizationType:J,normalizationField:C,normalizationTotal:K,minValue:E,maxValue:I}=w,H=w.numBins||10;let N=
w=null,U=null;t&&"equal-interval"!==t||J?({classBreaks:A}=e(A,{field:m,normalizationType:J,normalizationField:C,normalizationTotal:K,classificationMethod:t,standardDeviationInterval:B,minValue:E,maxValue:I,numClasses:H}),w=A[0].minValue,N=A[A.length-1].maxValue,U=A.map(ba=>[ba.minValue,ba.maxValue])):(null!=E&&null!=I?(w=E,N=I):(A=y({values:A,minValue:E,maxValue:I,useSampleStdDev:!J,supportsNullCount:z({normalizationType:J,normalizationField:C,minValue:E,maxValue:I})}),w=A.min??null,N=A.max??null),
U=v(w??0,N??0,H));return{min:w,max:N,intervals:U}}function p(A,w){let m=-1;for(let t=A.length-1;0<=t;t--)if(w>=A[t][0]){m=t;break}return m}function v(A,w,m){const t=(w-A)/m,B=[];let J;for(let C=1;C<=m;C++)J=A+t,J=Number(J.toFixed(16)),B.push([A,C===m?w:J]),A=J;return B}const l=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,u=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),r="min max avg stddev count sum variance nullcount median".split(" ");q.calculateClassBreaks=
e;q.calculateHistogram=function(A,w){var m=d(A,w);const t=m.intervals,B=m.min??0;m=m.max??0;const J=t.map((C,K)=>({minValue:t[K][0],maxValue:t[K][1],count:0}));for(const C of A)null!=C&&C>=B&&C<=m&&(A=p(t,C),-1<A&&J[A].count++);return{bins:J,minValue:B,maxValue:m,normalizationTotal:w.normalizationTotal}};q.calculatePercentile=D;q.calculateStatistics=y;q.calculateStringStatistics=function(A){const w=A.returnDistinct?[...(new Set(A.values))]:A.values,m=w.filter(B=>null!=B).length,t={count:m};A.supportsNullCount&&
(t.nullcount=w.length-m);A.percentileParams&&(t.median=D(w,A.percentileParams));return t};q.calculateUniqueValuesCount=function(A){const w={};for(let m of A){if(null==m||"string"===typeof m&&""===m.trim())m=null;null==w[m]?w[m]={count:1,data:m}:w[m].count++}return{count:w}};q.createClassBreaksDefinition=c;q.createUVResult=function(A,w,m,t){A=A.count;const B=[];if(m&&w){m=[];var J=h(w[0]);for(const C of J)if(w[1]){J=h(w[1]);for(const K of J)if(w[2]){J=h(w[2]);for(const E of J)m.push(`${F(C)}${t}${F(K)}${t}${F(E)}`)}else m.push(`${F(C)}${t}${F(K)}`)}else m.push(C);
for(const C of m)A.hasOwnProperty(C)||(A[C]={data:C,count:0})}for(const C in A)w=A[C],B.push({value:w.data,count:w.count,label:w.label});return{uniqueValueInfos:B}};q.getAttributeComparator=x;q.getEqualIntervalBins=v;q.getNormalizedValue=function(A,w,m,t){let B=null;switch(w){case "log":0!==A&&(B=Math.log(A)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(t)&&0!==t&&(B=A/t*100);break;case "field":Number.isFinite(m)&&0!==m&&(B=A/m);break;case "natural-log":0<A&&(B=Math.log(A));break;case "square-root":0<
A&&(B=A**.5)}return B};q.isNullCountSupported=z;q.processNullValue=F;q.processSummaryStatisticsResult=function(A,w){let m;for(m in A)r.includes(m)&&(Number.isFinite(A[m])||(A[m]=null));if(!w)return A;["avg","stddev","variance"].forEach(t=>{null!=A[t]&&(A[t]=Math.ceil(A[t]))});return A};q.resolveCBResult=function(A,w){let m=A.classBreaks;const t=m[0].minValue,B=m[m.length-1].maxValue,J="standard-deviation"===w;m=m.map(C=>{const K=C.label;C={minValue:C.minValue,maxValue:C.maxValue,label:K};if(J&&K){const E=
K.match(l)?.map(I=>+I.trim())??[];2===E.length?(C.minStdDev=E[0],C.maxStdDev=E[1],0>E[0]&&0<E[1]&&(C.hasAvg=!0)):1===E.length&&(K.includes("\x3c")?(C.minStdDev=null,C.maxStdDev=E[0]):K.includes("\x3e")&&(C.minStdDev=E[0],C.maxStdDev=null))}return C});return{minValue:t,maxValue:B,classBreakInfos:m,normalizationTotal:A.normalizationTotal}};q.statisticTypes=r;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k,g){y=new G.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});G=new G.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});F=function(b){function a(e){e=h.call(this,e);e.type="class-breaks-definition";e.breakCount=
null;e.classificationField=null;e.classificationMethod=null;e.normalizationField=null;e.normalizationType=null;return e}q._inherits(a,b);var h=q._createSuper(a);q._createClass(a,[{key:"standardDeviationInterval",set:function(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}},{key:"definedInterval",set:function(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}}]);return a}(F.JSONSupport);n.__decorate([k.enumeration({classBreaksDef:"class-breaks-definition"})],
F.prototype,"type",void 0);n.__decorate([z.property({json:{write:!0}})],F.prototype,"breakCount",void 0);n.__decorate([z.property({json:{write:!0}})],F.prototype,"classificationField",void 0);n.__decorate([z.property({type:String,json:{read:y.read,write:y.write}})],F.prototype,"classificationMethod",void 0);n.__decorate([z.property({json:{write:!0}})],F.prototype,"normalizationField",void 0);n.__decorate([z.property({json:{read:G.read,write:G.write}})],F.prototype,"normalizationType",void 0);n.__decorate([z.property({value:null,
json:{write:!0}})],F.prototype,"standardDeviationInterval",null);n.__decorate([z.property({value:null,json:{write:!0}})],F.prototype,"definedInterval",null);return F=n.__decorate([g.subclass("esri.rest.support.ClassBreaksDefinition")],F)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(q,n,G){q.enumeration=function(F,z={}){F=F instanceof n.JSONMap?F:new n.JSONMap(F,z);F={type:z?.ignoreUnknown??!0?F.apiValues:String,json:{type:F.jsonValues,
read:z?.readOnly?!1:{reader:F.read},write:{writer:F.write}}};void 0!==z?.readOnly&&(F.readOnly=!!z.readOnly);void 0!==z?.default&&(F.json.default=z.default);void 0!==z?.name&&(F.json.name=z.name);void 0!==z?.nonNullable&&(F.nonNullable=z.nonNullable);return G.property(F)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(q,n){function G(h){var e=h.definition;const {classificationMethod:f,
normalizationType:c,definedInterval:d}=e;e=e.breakCount??1;const p=[];var v=h.values;if(0===v.length)return[];v=v.sort((m,t)=>m-t);var l=v[0],u=v[v.length-1];if("equal-interval"===f)if(v.length>=e){v=(u-l)/e;h=l;for(var r=1;r<e;r++){var A=Number((l+r*v).toFixed(6));p.push({minValue:h,maxValue:A,label:F(h,A,c)});h=A}p.push({minValue:h,maxValue:u,label:F(h,u,c)})}else v.forEach(m=>{p.push({minValue:m,maxValue:m,label:F(m,m,c)})});else if("natural-breaks"===f){v=z(v);h=y(v.uniqueValues,h.valueFrequency||
v.valueFrequency,e);for(r=1;r<e;r++)v.uniqueValues.length>r&&(A=Number(v.uniqueValues[h[r]].toFixed(6)),p.push({minValue:l,maxValue:A,label:F(l,A,c)}),l=A);p.push({minValue:l,maxValue:u,label:F(l,u,c)})}else if("quantile"===f)if(v.length>=e&&l!==u){h=Math.ceil(v.length/e);r=0;for(A=1;A<e;A++){var w=h+r-1;w>v.length&&(w=v.length-1);0>w&&(w=0);p.push({minValue:l,maxValue:v[w],label:F(l,v[w],c)});l=v[w];r+=h;h=Math.ceil((v.length-r)/(e-A))}p.push({minValue:l,maxValue:u,label:F(l,u,c)})}else for(e=-1,
u=0;u<v.length;u++)l=v[u],l!==e&&(e=l,p.push({minValue:e,maxValue:l,label:F(e,l,c)}),e=l);else if("standard-deviation"===f)if(h=k(v),r=g(v,h),0===r)p.push({minValue:v[0],maxValue:v[0],label:F(v[0],v[0],c)});else{v=x(l,u,e,h,r)*r;r=0;for(A=e;1<=A;A--)w=Number((h-(A-.5)*v).toFixed(6)),p.push({minValue:l,maxValue:w,label:F(l,w,c)}),l=w,r++;A=Number((h+.5*v).toFixed(6));p.push({minValue:l,maxValue:A,label:F(l,A,c)});l=A;r++;for(w=1;w<=e;w++)A=r===2*e?u:Number((h+(w+.5)*v).toFixed(6)),p.push({minValue:l,
maxValue:A,label:F(l,A,c)}),l=A,r++}else if("defined-interval"===f){if(!d)return p;e=v[0];u=v[v.length-1];v=Math.ceil((u-e)/d);l=e;for(h=1;h<v;h++)r=Number((e+h*d).toFixed(6)),p.push({minValue:l,maxValue:r,label:F(l,r,c)}),l=r;p.push({minValue:l,maxValue:u,label:F(l,u,c)})}return p}function F(h,e,f){let c=null;return c=h===e?f&&"percent-of-total"===f?h+"%":h.toString():f&&"percent-of-total"===f?h+"% - "+e+"%":h+" - "+e}function z(h){const e=[],f=[];let c=Number.MIN_VALUE,d=1,p=-1;for(let v=0;v<h.length;v++){const l=
h[v];l===c?(d++,f[p]=d):null!==l&&(e.push(l),c=l,d=1,f.push(d),p++)}return{uniqueValues:e,valueFrequency:f}}function y(h,e,f){var c=h.length;const d=[];f>c&&(f=c);for(var p=0;p<f;p++)d.push(Math.round(p*c/f-1));d.push(c-1);p=D(d,h,e,f);c=p.mean;p=p.sdcm;var v=f,l=0,u=0;let r=0,A=0,w=!0;for(let t=0;2>t&&w;t++){0===t&&(w=!1);for(var m=0;m<v-1;m++)for(;d[m+1]+1!==d[m+2];)if(d[m+1]+=1,l=b(m,d,h,e),r=l.sbMean,l=l.sbSdcm,u=b(m+1,d,h,e),A=u.sbMean,u=u.sbSdcm,l+u<p[m]+p[m+1])p[m]=l,p[m+1]=u,c[m]=r,c[m+1]=
A,w=!0;else{--d[m+1];break}for(m=v-1;0<m;m--)for(;d[m]!==d[m-1]+1;)if(--d[m],l=b(m-1,d,h,e),r=l.sbMean,l=l.sbSdcm,u=b(m,d,h,e),A=u.sbMean,u=u.sbSdcm,l+u<p[m-1]+p[m])p[m-1]=l,p[m]=u,c[m-1]=r,c[m]=A,w=!0;else{d[m]+=1;break}}w&&(p=D(d,h,e,f));return d}function D(h,e,f,c){let d=[];var p=[],v=[];let l=0;const u=[],r=[];for(var A=0;A<c;A++){var w=b(A,h,e,f);u.push(w.sbMean);r.push(w.sbSdcm);l+=r[A]}w=l;for(A=!0;A||l<w;){A=!1;d=[];for(p=0;p<c;p++)d.push(h[p]);for(v=0;v<c;v++)for(w=h[v]+1;w<=h[v+1];w++)if(p=
e[w],0<v&&w!==h[v+1]&&Math.abs(p-u[v])>Math.abs(p-u[v-1]))h[v]=w;else if(v<c-1&&h[v]!==w-1&&Math.abs(p-u[v])>Math.abs(p-u[v+1])){h[v+1]=w-1;break}w=l;l=0;p=[];v=[];for(let m=0;m<c;m++){p.push(u[m]);v.push(r[m]);const t=b(m,h,e,f);u[m]=t.sbMean;r[m]=t.sbSdcm;l+=r[m]}}if(l>w){for(e=0;e<c;e++)h[e]=d[e],u[e]=p[e],r[e]=v[e];l=w}return{mean:u,sdcm:r}}function x(h,e,f,c,d){h=Math.max(c-h,e-c)/d/f;return 1<=h?1:.5<=h?.5:.25}function k(h){let e=0;for(let f=0;f<h.length;f++)e+=h[f];return e/=h.length}function g(h,
e){let f=0;for(let c=0;c<h.length;c++){const d=h[c];f+=(d-e)*(d-e)}f/=h.length;return Math.sqrt(f)}function b(h,e,f,c){var d=0,p=0;for(var v=e[h]+1;v<=e[h+1];v++){const l=c[v];d+=f[v]*l;p+=l}0>=p&&a.warn("Exception in Natural Breaks calculation");d/=p;p=0;for(v=e[h]+1;v<=e[h+1];v++)p+=c[v]*(f[v]-d)**2;return{sbMean:d,sbSdcm:p}}const a=n.getLogger("esri.rest.support.generateRendererUtils");q.createGenerateRendererClassBreaks=function(h){const {normalizationTotal:e}=h;return{classBreaks:G(h),normalizationTotal:e}};
q.createGenerateRendererUniqueValues=function(h){h=z(h);const e=[],f=h.uniqueValues.length;for(let c=0;c<f;c++){const d=h.uniqueValues[c];e.push({value:d,count:h.valueFrequency[c],label:d.toString()})}return{uniqueValues:e}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(q){q.makeEdgeCandidate=function(n,G,F,z,y,D=!1){return{objectId:n,target:G,distance:F,type:"edge",start:z,end:y,draped:D}};q.makeVertexCandidate=
function(n,G,F){return{objectId:n,target:G,distance:F,type:"vertex"}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h){async function e(m,t,B){if(!m)return null;var {where:J}=m;m.where=J=J&&J.trim();if(!J||/^1 *= *1$/.test(J)||t&&t===J)m.where=null;if(!m.geometry)return m;t=await c(m);m.distance=0;m.units=null;"esriSpatialRelEnvelopeIntersects"===m.spatialRel&&({spatialReference:J}=m.geometry,t=D.getGeometryExtent(t),t.spatialReference=J);if(t){await h.checkProjectionSupport(t.spatialReference,B);J=t.spatialReference;t=f(t,B)&&x.isExtent(t)?{spatialReference:J,rings:[[[t.xmin,t.ymin],
[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:t;J=(await k.normalizeCentralMeridian(x.fromJSON(t)))[0];if(F.isNone(J))throw v;const C="quantizationParameters"in m&&m.quantizationParameters?.tolerance||"maxAllowableOffset"in m&&m.maxAllowableOffset||0;t=C&&f(t,B)?{densificationStep:8*C}:void 0;J=J.toJSON();t=await h.project(J,J.spatialReference,B,t);if(!t)throw v;t.spatialReference=B;m.geometry=t}return m}function f(m,t){if(!m)return!1;const B=m.spatialReference;return(x.isExtent(m)||
x.isPolygon(m)||x.isPolyline(m))&&!g.equals(B,t)&&!y.canProjectWithoutEngine(B,t)}async function c(m){const {distance:t,units:B}=m,J=m.geometry;if(null==t||"vertexAttributes"in J)return J;var C=J.spatialReference;m=B?p.fromJSON(B):z.getUnitString(C);C=C&&(g.isGeographic(C)||g.isWebMercator(C))?J:await h.checkProjectionSupport(C,g.WGS84).then(()=>h.project(J,g.WGS84));return(await d())(C.spatialReference,C,t,m)}async function d(){return(await new Promise((m,t)=>q(["../../../geometry/geometryEngineJSON"],
m,t))).geodesicBuffer}const p=new G.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),v=Object.freeze({}),l=new a,u=new a,r=new a,A={esriGeometryPoint:b.convertToPoint,esriGeometryPolyline:b.convertToPolyline,esriGeometryPolygon:b.convertToPolygon,esriGeometryMultipoint:b.convertToMultipoint},w=(m,t)=>"_geVersion"!==m?t:void 0;n.QUERY_ENGINE_EMPTY_RESULT=
v;n.cleanFromGeometryEngine=function(m){return m&&"_geVersion"in m?JSON.parse(JSON.stringify(m,w)):m};n.getGeometry=function(m,t,B,J,C,K,E=t,I=B){const H=t&&E,N=B&&I;J=F.isSome(J)?"coords"in J?J:J.geometry:null;if(F.isNone(J))return null;if(C)return t=b.generalizeOptimizedGeometry(u,J,t,B,m,C,E,I),K&&(t=b.quantizeOptimizedGeometry(r,t,H,N,m,K)),A[m]?.(t,H,N)??null;if(K)return K=b.quantizeOptimizedGeometry(r,J,t,B,m,K,E,I),A[m]?.(K,H,N)??null;b.removeZMValues(l,J,t,B,E,I);return A[m]?.(l,H,N)??null};
n.normalizeQuery=async function(m,t,B){const {outFields:J,orderByFields:C,groupByFieldsForStatistics:K,outStatistics:E}=m;if(J)for(var I=0;I<J.length;I++)J[I]=J[I].trim();if(C)for(I=0;I<C.length;I++)C[I]=C[I].trim();if(K)for(I=0;I<K.length;I++)K[I]=K[I].trim();if(E)for(I=0;I<E.length;I++)E[I].onStatisticField&&(E[I].onStatisticField=E[I].onStatisticField.trim());m.geometry&&!m.outSR&&(m.outSR=m.geometry.spatialReference);return e(m,t,B)};n.normalizeQueryLike=e;n.transformCentroid=function(m,t,B,J=
m.hasZ,C=m.hasM){if(F.isNone(t))return null;const K=m.hasZ&&J,E=m.hasM&&C;return B?(m=b.quantizeOptimizedGeometry(r,t,m.hasZ,m.hasM,"esriGeometryPoint",B,J,C),b.convertToPoint(m,K,E)):b.convertToPoint(t,K,E)};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldUtils":function(){define("require exports ../../core/Error ../../core/maybe ../../core/object ./domainUtils ../../support/arcadeOnDemand".split(" "),function(q,n,G,F,z,y,D){function x(ca,ia,oa){if(ca)for(const M of ca)(ca=
(ca=z.getDeepValue(M,ia))&&"function"!==typeof ca&&oa.get(ca))&&z.setDeepValue(M,ca.name,ia)}function k(ca,ia){if(!ca||!ia)return[];ka.clear();g(ka,ca,ia);return Array.from(ka).sort()}function g(ca,ia,oa){if(oa)if(ia?.fields?.length)if(oa.includes("*"))for(const {name:M}of ia.fields)ca.add(M);else for(const M of oa)b(ca,ia,M);else if(oa.includes("*"))ca.clear(),ca.add("*");else for(const M of oa)null!=M&&ca.add(M)}function b(ca,ia,oa){"string"===typeof oa&&(ia?(ia=ia.get(oa))&&ca.add(ia.name):ca.add(oa))}
async function a(ca,ia,oa){if(oa){var {arcadeUtils:M}=await D.loadArcade();oa=M.extractFieldNames(oa,ia?.fields?.map(Q=>Q.name));for(const Q of oa)b(ca,ia,Q)}}async function h(ca,ia,oa){if(oa&&"1\x3d1"!==oa){const M=(await new Promise((Q,fa)=>q(["../../core/sql/WhereClause"],Q,fa))).WhereClause.create(oa,ia);if(!M.isStandardized)throw new G("fieldUtils:collectFilterFields","Where clause is not standardized",{where:oa});g(ca,ia,M.fieldNames)}}function e(ca,ia){for(const oa of ca)if(oa&&oa.valueType&&
oa.valueType===ia)return oa.name;return null}async function f(ca,ia){if(ia){var oa=ia.elevationInfo?.featureExpressionInfo;if(oa)return oa.collectRequiredFields(ca,ia.fieldsIndex)}}async function c(ca,ia,oa){const M=[];oa?.expressionInfos&&M.push(...oa.expressionInfos.map(Q=>a(ca,ia.fieldsIndex,Q.expression)));oa=oa?.content;if(Array.isArray(oa))for(const Q of oa)"expression"===Q.type&&Q.expressionInfo&&M.push(a(ca,ia.fieldsIndex,Q.expressionInfo.expression));await Promise.all(M)}async function d(ca,
ia,oa){ia&&oa&&(oa.valueExpression?await a(ca,ia.fieldsIndex,oa.valueExpression):oa.field&&b(ca,ia.fieldsIndex,oa.field))}async function p(ca,ia){const {labelingInfo:oa,fieldsIndex:M}=ia;oa&&oa.length&&await Promise.all(oa.map(Q=>v(ca,M,Q)))}async function v(ca,ia,oa){if(oa){var M=oa.getLabelExpression();oa=oa.where;"arcade"===M.type?await a(ca,ia,M.expression):(M=M.expression.match(/{[^}]*}/g))&&M.forEach(Q=>{b(ca,ia,Q.slice(1,-1))});await h(ca,ia,oa)}}function l(ca){return"number"===typeof ca&&
!isNaN(ca)&&isFinite(ca)}function u(ca){return null===ca||l(ca)}function r(ca){return null===ca||V(ca)}function A(ca){return null!=ca&&"string"===typeof ca}function w(ca){return null===ca||A(ca)}function m(){return!0}function t(ca,ia){let oa;switch(ca.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":oa=ca.nullable?r:V;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":oa=
ca.nullable?u:l;break;case "string":case "esriFieldTypeString":oa=ca.nullable?w:A;break;default:oa=m}return 1===arguments.length?oa:oa(ia)}function B(ca){return null!=ca&&S.has(ca.type)}function J(ca,ia){return null==ca||ca.nullable&&null===ia?null:B(ca)&&!C(ca.type,Number(ia))?n.NumericRangeValidationError.OUT_OF_RANGE:t(ca,ia)?ca.domain?y.validateDomainValue(ca.domain,ia):null:n.TypeValidationError.INVALID_TYPE}function C(ca,ia){ca="string"===typeof ca?K(ca):ca;if(!ca)return!1;const oa=ca.min,M=
ca.max;return ca.isInteger?V(ia)&&ia>=oa&&ia<=M:ia>=oa&&ia<=M}function K(ca){switch(ca){case "esriFieldTypeSmallInteger":case "small-integer":return X;case "esriFieldTypeInteger":case "integer":return ra;case "esriFieldTypeSingle":case "single":return Y;case "esriFieldTypeDouble":case "double":return ua}}function E(ca,ia,oa){if(!ia||!ia.attributes||!ca){if(F.isSome(oa))for(var M of ca??[])oa.add(M);return!0}ia=ia.attributes;M=!1;for(const Q of ca)if(!(Q in ia))if(M=!0,F.isSome(oa))oa.add(Q);else break;
return M}const I=/^([0-9])/,H=/[^a-z0-9_\u0080-\uffff]/gi,N=/_{2,}/g,U=/^_/,ba=/_$/,la="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),aa=["field","normalizationField"],ka=new Set,V=(()=>"isInteger"in Number?Number.isInteger:ca=>"number"===typeof ca&&isFinite(ca)&&Math.floor(ca)===ca)(),P=["integer","small-integer","single","double"],S=new Set([...P,"esriFieldTypeInteger",
"esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);n.NumericRangeValidationError=void 0;(n.NumericRangeValidationError||(n.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";n.TypeValidationError=void 0;(n.TypeValidationError||(n.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";const X={min:-32768,max:32767,isInteger:!0},ra={min:-2147483648,max:2147483647,isInteger:!0},Y={min:-3.4E38,max:1.2E38,isInteger:!1},
ua={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};n.collectArcadeFieldNames=a;n.collectElevationFields=f;n.collectFeatureReductionFields=async function(ca,ia,oa){if(ia&&oa&&"fields"in oa){var M=[];M.push(c(ca,ia,oa.popupTemplate));oa.fields&&M.push(...oa.fields.map(async Q=>{Q.onStatisticExpression?a(ca,ia.fieldsIndex,Q.onStatisticExpression.expression):ca.add(Q.onStatisticField)}));await Promise.all(M)}};n.collectField=b;n.collectFields=g;n.collectFilterFields=async function(ca,ia,oa){ia&&
(ia.timeInfo&&F.isSome(oa)&&oa.timeExtent&&g(ca,ia.fieldsIndex,[ia.timeInfo.startField,ia.timeInfo.endField]),ia.floorInfo&&g(ca,ia.fieldsIndex,[ia.floorInfo.floorField]),F.isSome(oa)&&F.isSome(oa.where)&&await h(ca,ia.fieldsIndex,oa.where))};n.collectLabelingFields=p;n.collectOrderByInfos=async function(ca,ia,oa){ia&&oa&&await Promise.all(oa.map(M=>d(ca,ia,M)))};n.collectPopupTemplateFields=c;n.doubleRange=ua;n.featureHasFields=function(ca,ia){return!E(ca,ia,null)};n.fixFields=k;n.fixRendererFields=
function(ca,ia){if(null!=ca&&null!=ia)for(const oa of Array.isArray(ca)?ca:[ca])if(x(la,oa,ia),"visualVariables"in oa&&oa.visualVariables)for(const M of oa.visualVariables)x(aa,M,ia)};n.fixTimeInfoFields=function(ca,ia){if(null!=ca&&ia?.fields?.length)if("startField"in ca){var oa=ia.get(ca.startField);ia=ia.get(ca.endField);ca.startField=oa?.name??null;ca.endField=ia?.name??null}else oa=ia.get(ca.startTimeField),ia=ia.get(ca.endTimeField),ca.startTimeField=oa?.name??null,ca.endTimeField=ia?.name??
null};n.getDisplayFieldName=function({displayField:ca,fields:ia}){if(ca)return ca;if(!ia||!ia.length)return null;if(!(ca=e(ia,"name-or-title")||e(ia,"unique-identifier")||e(ia,"type-or-category")))a:{for(const oa of ia)if(oa&&oa.name&&(ia=oa.name.toLowerCase(),ia.includes("name")||ia.includes("title"))){ca=oa.name;break a}ca=null}return ca};n.getElevationFields=async function(ca){if(!ca)return[];const ia=new Set;await f(ia,ca);return Array.from(ia).sort()};n.getExpressionFields=async function(ca,
ia){const oa=new Set;for(const M of ia)await a(oa,ca.fieldsIndex,M);return Array.from(oa).sort()};n.getFeatureEditFields=function(ca){if(!ca)return[];const ia="editFieldsInfo"in ca&&ca.editFieldsInfo;return ia?k(ca.fieldsIndex,[ia&&ia.creatorField,ia&&ia.creationDateField,ia&&ia.editorField,ia&&ia.editDateField]):[]};n.getFeatureGeometryFields=function(ca){if(!ca)return[];const ia=ca.geometryFieldsInfo;return ia?k(ca.fieldsIndex,[ia.shapeAreaField,ia.shapeLengthField]):[]};n.getFieldDefaultValue=
function(ca){const ia=ca.defaultValue;if(void 0!==ia&&t(ca,ia))return ia;if(ca.nullable)return null};n.getFieldRange=function(ca){const ia=y.getDomainRange(ca.domain);if(ia)return ia;if(B(ca))return K(ca.type)};n.getLabelingFields=async function(ca){if(!ca)return[];const ia=new Set;await p(ia,ca);return Array.from(ia).sort()};n.getNumericTypeForValue=function(ca){if(!l(ca))return null;if(V(ca)){if(ca>=X.min&&ca<=X.max)return"esriFieldTypeSmallInteger";if(ca>=ra.min&&ca<=ra.max)return"esriFieldTypeInteger"}return ca>=
Y.min&&ca<=Y.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};n.getTimeFields=async function(ca){if(!ca)return[];const ia="timeInfo"in ca&&ca.timeInfo;return ia?k(ca.fieldsIndex,[ca.trackIdField,ia.startField,ia.endField]):[]};n.integerRange=ra;n.isDateField=function(ca){return null!=ca&&("date"===ca.type||"esriFieldTypeDate"===ca.type)};n.isNumberInRange=C;n.isNumericField=B;n.isRasterPixelValueField=function(ca){return ca?["raster.itempixelvalue","raster.servicepixelvalue"].some(ia=>ca.toLowerCase().startsWith(ia)):
!1};n.isStringField=function(ca){return null!=ca&&("string"===ca.type||"esriFieldTypeString"===ca.type)};n.isValidFieldValue=function(ca,ia){return null===J(ca,ia)};n.isValueMatchingFieldType=t;n.normalizeFieldName=function(ca){return null==ca?null:ca.trim().replace(H,"_").replace(N,"_").replace(U,"").replace(ba,"").replace(I,"F$1")||null};n.numericTypes=P;n.packFields=function(ca,ia,oa=1){if(!ia||!ca)return[];if(ia.includes("*"))return["*"];ia=k(ca,ia);return ia.length/ca.fields.length>=oa?["*"]:
ia};n.populateMissingFields=E;n.rendererFields=la;n.sanitizeNullFieldValue=function(ca){return null==ca||"number"===typeof ca&&isNaN(ca)?null:ca};n.singleRange=Y;n.smallIntegerRange=X;n.unpackFieldNames=function(ca,ia){return F.isNone(ia)||F.isNone(ca)?[]:ia.includes("*")?(ca.fields??[]).map(oa=>oa.name):ia};n.validateFieldValue=J;n.validationErrorToString=function(ca,ia,oa){switch(ca){case y.DomainValidationError.INVALID_CODED_VALUE:return`Value ${oa} is not in the coded domain - field: ${ia.name}, domain: ${JSON.stringify(ia.domain)}`;
case y.DomainValidationError.VALUE_OUT_OF_RANGE:return`Value ${oa} is out of the range of valid values - field: ${ia.name}, domain: ${JSON.stringify(ia.domain)}`;case n.TypeValidationError.INVALID_TYPE:return`Value ${oa} is not a valid value for the field type - field: ${ia.name}, type: ${ia.type}, nullable: ${ia.nullable}`;case n.NumericRangeValidationError.OUT_OF_RANGE:const {min:M,max:Q}=K(ia.type);return`Value ${oa} is out of range for the number type - field: ${ia.name}, type: ${ia.type}, value range is ${M} to ${Q}`}};
n.visualVariableFields=aa;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/domainUtils":function(){define(["exports"],function(q){q.DomainValidationError=void 0;(function(n){n.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";n.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(q.DomainValidationError||(q.DomainValidationError={}));q.getDomainRange=function(n){if(n&&"range"===n.type)return{min:"range"in n?n.range[0]:n.minValue,max:"range"in
n?n.range[1]:n.maxValue}};q.validateDomainValue=function(n,G){switch(n.type){case "range":const F="range"in n?n.range[0]:n.minValue;n="range"in n?n.range[1]:n.maxValue;if(null!=F&&+G<F||null!=n&&+G>n)return q.DomainValidationError.VALUE_OUT_OF_RANGE;break;case "coded-value":if(null==n.codedValues||n.codedValues.every(z=>null==z||z.code!==G))return q.DomainValidationError.INVALID_CODED_VALUE;break;case "codedValue":if(null==n.codedValues||n.codedValues.every(z=>null==z||z.code!==G))return q.DomainValidationError.INVALID_CODED_VALUE}return null};
Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/support/arcadeOnDemand":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/Error ../core/Logger ../core/maybe ../geometry/SpatialReference".split(" "),function(q,n,G,F,z,y,D,x){function k(){b||(b=(async()=>{const h=await new Promise((e,f)=>q(["./arcadeUtils"],e,f));return{arcade:h.arcade,arcadeUtils:h,Dictionary:h.Dictionary,Feature:h.arcadeFeature}})());return b}const g=y.getLogger("esri.support.arcadeOnDemand");
let b;F=(h,e,f)=>a.create(h,e,f,null,["$feature","$view"]);let a=function(){function h(f,c,d,p,v,l,u){this.script=f;this.evaluate=p;this.fields=Array.isArray(l)?l:l.fields;this._syntaxTree=d;this._arcade=c;this._arcadeFeature=v;this._spatialReference=u;this._referencesGeometry=c.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}h.create=async function(f,c,d,p,v,l){const {arcade:u,Feature:r,Dictionary:A}=await k(),w=x.fromJSON(c);
let m;try{m=u.parseScript(f,l)}catch(E){return g.error(new z("arcade-bad-expression","Failed to parse arcade script",{script:f,error:E})),null}v=v.reduce((E,I)=>({...E,[I]:null}),{});let t=null;D.isSome(p)&&(t=new A(p),t.immutable=!0,v.$config=null);l=(p=u.scriptUsesGeometryEngine(m))&&u.enableGeometrySupport();const B=u.scriptUsesFeatureSet(m)&&u.enableFeatureSetSupport(),J=(c=u.scriptIsAsync(m))&&u.enableAsyncSupport();v={vars:v,spatialReference:w,useAsync:!!J};await Promise.all([l,B,J]);l=new Set;
await u.loadDependentModules(l,m,null,c,p);const C=new A;C.immutable=!1;C.setField("scale",0);const K=u.compileScript(m,v);return new h(f,u,m,E=>{"$view"in E&&E.$view&&(C.setField("scale","object"===typeof E.$view?E.$view.scale:void 0),E.$view=C);t&&(E.$config=t);return K({vars:E,spatialReference:w})},new r,d,w)};var e=h.prototype;e.repurposeFeature=function(f){f.geometry&&!f.geometry.spatialReference&&(f.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(f.geometry,
f.attributes,{fields:this.fields});return this._arcadeFeature};e.referencesGeometry=function(){return this._referencesGeometry};e.referencesScale=function(){return this._referencesScale};return G._createClass(h)}();n.ArcadeExpression=a;n.createDictionaryExpression=(h,e,f,c)=>a.create(h,e,f,c,["$feature","$view"]);n.createLabelExpression=(h,e,f)=>a.create(h,e,f,null,["$feature"]);n.createRendererExpression=F;n.createVVExpression=F;n.loadArcade=k;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),function(q,n,G,F,z,y,D,x,k,g,b,a){function h(){return new Promise((p,v)=>q(["../../../geometry/geometryEngineJSON"],p,v))}const e={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var f={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},c={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},d={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};n.canQueryWithRBush=function(p){if(y.isExtent(p))return!0;if(y.isPolygon(p)){for(const v of p.rings)if(5!==v.length||v[0][0]!==v[1][0]||v[0][0]!==v[4][0]||v[2][0]!==v[3][0]||v[0][1]!==v[3][1]||v[0][1]!==
v[4][1]||v[1][1]!==v[2][1])return!1;return!0}return!1};n.checkSpatialQuerySupport=async function(p,v,l){const {spatialRel:u,geometry:r}=p;if(r){if(null==u||!0!==f[u])throw new G("feature-store:unsupported-query","Unsupported query spatial relationship",{query:p});if(D.isValid(r.spatialReference)&&D.isValid(l)){if(null==r||!0!==c[y.getJsonType(r)])throw new G("feature-store:unsupported-query","Unsupported query geometry type",{query:p});if(null==v||!0!==d[v])throw new G("feature-store:unsupported-query",
"Unsupported layer geometry type",{query:p});if(p.outSR)return b.checkProjectionSupport(p.geometry&&p.geometry.spatialReference,p.outSR)}}};n.getSpatialQueryOperator=function(p,v,l,u,r){if(y.isPolygon(v)&&"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===p||"esriSpatialRelContains"===p)){const A=k.convertFromPolygon(new g,v,!1,!1);return Promise.resolve(w=>x.polygonContainsPoint(A,!1,!1,w))}if(y.isPolygon(v)&&"esriGeometryMultipoint"===l){const A=k.convertFromPolygon(new g,v,!1,!1);if("esriSpatialRelContains"===
p)return Promise.resolve(w=>x.polygonContainsMultipoint(A,!1,!1,w,u,r))}if(y.isExtent(v)&&"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===p||"esriSpatialRelContains"===p))return Promise.resolve(A=>F.extentContainsPoint(v,a.getGeometry(l,u,r,A)));if(y.isExtent(v)&&"esriGeometryMultipoint"===l&&"esriSpatialRelContains"===p)return Promise.resolve(A=>F.extentContainsMultipoint(v,a.getGeometry(l,u,r,A)));if(y.isExtent(v)&&"esriSpatialRelIntersects"===p){const A=z.getExtentIntersector(l);return Promise.resolve(w=>
A(v,a.getGeometry(l,u,r,w)))}return h().then(A=>{const w=A[e[p]].bind(null,v.spatialReference,v);return m=>w(a.getGeometry(l,u,r,m))})};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(q,n){q.extentIntersectsExtent=n.extentIntersectsExtent;q.extentIntersectsMultipoint=n.extentIntersectsMultipoint;q.extentIntersectsPoint=n.extentIntersectsPoint;q.extentIntersectsPolygon=n.extentIntersectsPolygon;
q.extentIntersectsPolyline=n.extentIntersectsPolyline;q.extentIntersectsRings=n.extentIntersectsRings;q.getFeatureExtentIntersector=n.getFeatureExtentIntersector;q.isSelfIntersecting=n.isSelfIntersecting;q.segmentIntersects=n.segmentIntersects;q.getExtentIntersector=function(G){return"mesh"===G?n.extentIntersectsExtent:n.getFeatureExtentIntersector(G)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(q){function n(G,
F,z,y,D){if(!G)return!1;F=F?z?4:3:z?3:2;const {coords:x,lengths:k}=G;z=!1;G=0;for(const b of k){var g=G;for(let a=G,h=G+b*F;a<h;a+=F){g=a+F;g===h&&(g=G);const e=x[a],f=x[a+1],c=x[g];g=x[g+1];(f<D&&g>=D||g<D&&f>=D)&&e+(D-f)/(g-f)*(c-e)<y&&(z=!z)}G+=b*F}return z}q.polygonContainsCoords=n;q.polygonContainsMultipoint=function(G,F,z,y,D,x){D=D?x?4:3:x?3:2;const {coords:k,lengths:g}=y;if(!g)return!1;for(let b=0,a=0;b<g.length;b++,a+=D)if(!n(G,F,z,k[a],k[a+1]))return!1;return!0};q.polygonContainsPoint=function(G,
F,z,y){return n(G,F,z,y.coords[0],y.coords[1])};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(q){function n(z,y,D,x,k){if(null!=x&&null!=k)return g=>{const b=z.getAttribute(g,y);g=z.getAttribute(g,D);return(null==b||b<=k)&&(null==g||g>=x)};if(null!=x)return g=>{g=z.getAttribute(g,D);return null==g||g>=x};if(null!=k)return g=>{g=z.getAttribute(g,y);return null==g||g<=k}}function G(z,y,D,x){if(null!=D&&
null!=x&&D===x)return k=>z.getAttribute(k,y)===D;if(null!=D&&null!=x)return k=>{k=z.getAttribute(k,y);return k>=D&&k<=x};if(null!=D)return k=>z.getAttribute(k,y)>=D;if(null!=x)return k=>z.getAttribute(k,y)<=x}function F(){return()=>!1}q.getTimeExtent=async function(z,y){if(!z)return null;const D=y.featureAdapter,{startTimeField:x,endTimeField:k}=z;let g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;if(x&&k)await y.forEach(a=>{const h=D.getAttribute(a,x);a=D.getAttribute(a,k);null==h||isNaN(h)||
(g=Math.min(g,h));null==a||isNaN(a)||(b=Math.max(b,a))});else{const a=x||k;await y.forEach(h=>{h=D.getAttribute(h,a);null==h||isNaN(h)||(g=Math.min(g,h),b=Math.max(b,h))})}return{start:g,end:b}};q.getTimeOperator=function(z,y,D){if(!y||!z)return null;const {startTimeField:x,endTimeField:k}=z;if(!x&&!k)return null;const {start:g,end:b}=y;return null===g&&null===b?null:void 0===g&&void 0===b?F():x&&k?n(D,x,k,g,b):G(D,x||k,g,b)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define(["../../chunks/_rollupPluginBabelHelpers",
"./fieldUtils"],function(q,n){function G(z){return"oid"===z.type||"esriFieldTypeOID"===z.type}function F(z){return"global-id"===z.type||"esriFieldTypeGlobalID"===z.type}return function(){function z(D=[]){this.fields=[];this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this.dateFields=[];this.numericFields=[];this._requiredFields=null;if(D){this.fields=D;var x=[];for(const k of D){D=k?.name;const g=n.normalizeFieldName(k?.name)?.toLowerCase()??
"";if(D&&g){const b=D.trim().toLowerCase();this._fieldsMap.set(D,k);this._fieldsMap.set(b,k);this._normalizedFieldsMap.set(g,k);x.push(b);"date"===k.type||"esriFieldTypeDate"===k.type?(this.dateFields.push(k),this._dateFieldsSet.add(k)):n.isNumericField(k)&&(this._numericFieldsSet.add(k),this.numericFields.push(k));G(k)||F(k)||(k.editable=null==k.editable||!!k.editable,k.nullable=null==k.nullable||!!k.nullable)}}x.sort();this.uid=x.join(",")}}var y=z.prototype;y.destroy=function(){this._fieldsMap.clear()};
y.has=function(D){return null!=this.get(D)};y.get=function(D){if(D){var x=this._fieldsMap.get(D);if(x)return x;(x=this._fieldsMap.get(D.trim().toLowerCase())??this._normalizedFieldsMap.get(n.normalizeFieldName(D)?.toLowerCase()??""))&&this._fieldsMap.set(D,x);return x}};y.isDateField=function(D){return this._dateFieldsSet.has(this.get(D))};y.isNumericField=function(D){return this._numericFieldsSet.has(this.get(D))};y.normalizeFieldName=function(D){if(D=this.get(D))return D.name??void 0};q._createClass(z,
[{key:"requiredFields",get:function(){if(!this._requiredFields){this._requiredFields=[];for(const D of this.fields)G(D)||F(D)||D.nullable||void 0!==n.getFieldDefaultValue(D)||this._requiredFields.push(D)}return this._requiredFields}}]);return z}()})},"esri/views/support/Scheduler":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/time ../../core/accessorSupport/tracking/ObservableValue ../../layers/support/PromiseQueue ./debugFlags ./RenderState".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f){function c(t){return d.has(t)?d.get(t):"number"===typeof t?t:1}q.Task=void 0;(function(t){t[t.YIELD=1]="YIELD"})(q.Task||(q.Task={}));q.TaskPriority=void 0;(function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate";t.RESOURCE_CONTROLLER="schedule";t.SLIDE="slide";t.STREAM_DATA_LOADER="stream loader";t.ELEVATION_QUERY="elevation query";t.TERRAIN_SURFACE="terrain";t.SURFACE_GEOMETRY_UPDATES="surface geometry updates";t.LOD_RENDERER="LoD renderer";t.GRAPHICS_CORE=
"Graphics3D";t.I3S_CONTROLLER="I3S";t.POINT_CLOUD_LAYER="point cloud";t.FEATURE_TILE_FETCHER="feature fetcher";t.OVERLAY="overlay";t.STAGE="stage";t.GRAPHICS_DECONFLICTOR="graphics deconflictor";t.FILTER_VISIBILITY="Graphics3D filter visibility";t.SCALE_VISIBILITY="Graphics3D scale visibility";t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";t.POINT_OF_INTEREST_FREQUENT="POI frequent";t.POINT_OF_INTEREST_INFREQUENT="POI infrequent";t.LABELER="labeler";t.FEATURE_QUERY_ENGINE="feature query";t.FEATURE_TILE_TREE=
"feature tile tree";t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";t.ELEVATION_ALIGNMENT="elevation alignment";t.TEXT_TEXTURE_ATLAS="text texture atlas";t.TEXTURE_UNLOAD="texture unload";t.LINE_OF_SIGHT_TOOL="line of sight tool";t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";t.ELEVATION_PROFILE="elevation profile";t.SNAPPING="snapping";t.SHADOW_ACCUMULATOR="shadow accumulator";t.CLOUDS_GENERATOR="clouds generator";t[t.TEST_PRIO=1]="TEST_PRIO"})(q.TaskPriority||(q.TaskPriority=
{}));const d=new Map([[q.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[q.TaskPriority.RESOURCE_CONTROLLER,4],[q.TaskPriority.SLIDE,0],[q.TaskPriority.STREAM_DATA_LOADER,0],[q.TaskPriority.ELEVATION_QUERY,0],[q.TaskPriority.TERRAIN_SURFACE,1],[q.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[q.TaskPriority.LOD_RENDERER,2],[q.TaskPriority.GRAPHICS_CORE,2],[q.TaskPriority.I3S_CONTROLLER,2],[q.TaskPriority.POINT_CLOUD_LAYER,2],[q.TaskPriority.FEATURE_TILE_FETCHER,2],[q.TaskPriority.OVERLAY,4],[q.TaskPriority.STAGE,
4],[q.TaskPriority.GRAPHICS_DECONFLICTOR,4],[q.TaskPriority.FILTER_VISIBILITY,4],[q.TaskPriority.SCALE_VISIBILITY,4],[q.TaskPriority.FRUSTUM_VISIBILITY,4],[q.TaskPriority.CLOUDS_GENERATOR,4],[q.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[q.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[q.TaskPriority.LABELER,8],[q.TaskPriority.FEATURE_QUERY_ENGINE,8],[q.TaskPriority.FEATURE_TILE_TREE,16],[q.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[q.TaskPriority.ELEVATION_ALIGNMENT,12],[q.TaskPriority.TEXT_TEXTURE_ATLAS,
12],[q.TaskPriority.TEXTURE_UNLOAD,12],[q.TaskPriority.LINE_OF_SIGHT_TOOL,16],[q.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[q.TaskPriority.SNAPPING,0],[q.TaskPriority.SHADOW_ACCUMULATOR,30]]),p=b.Milliseconds(6.5),v=b.Milliseconds(1),l=b.Milliseconds(30),u=b.Milliseconds(1E3/30),r=b.Milliseconds(100);var A;(function(t){let B=function(){function K(){this._updating=new a.ObservableValue(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new D("total"),tasks:new Map};this._frameTaskTimes=
new Map;this._budget=new C;this._state=f.RenderState.INTERACTING;this._tasks=new x;this._runQueue=new x;this._load=0;this._idleStateCallbacks=new x;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=g.watch(()=>e.SCHEDULER_LOG_SLOW_TASKS,H=>this._debug=H,g.initial);for(const H of Object.keys(q.TaskPriority))this.performanceInfo.tasks.set(q.TaskPriority[H],new D(q.TaskPriority[H]));const I=this;this._test={FRAME_SAFETY_BUDGET:p,INTERACTING_BUDGET:u,IDLE_BUDGET:r,get availableBudget(){return I._budget.budget},
usedBudget:0,getBudget:()=>I._budget,setBudget:H=>I._budget=H,updateTask:H=>this._updateTask(H),getState:H=>this._getState(H),getRuntime:H=>this._getRuntime(H),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}var E=K.prototype;E._updatingChanged=function(){this._updating.set(this._tasks.some(I=>I.needsUpdate))};E.destroy=function(){this._tasks.toArray().forEach(I=>I.remove());this._tasks.clear();y.removeMaybe(this._debugHandle);this._microTaskQueued=
!1;this._updatingChanged()};E.taskRunningChanged=function(I){this._updatingChanged();I&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))};E.registerTask=function(I,H){const N=c(I);H=new J(this,I,H,N);this._tasks.push(H);this._updatingChanged();this.performanceInfo.tasks.has(I)||this.performanceInfo.tasks.set(I,new D(I));return H};E.registerIdleStateCallbacks=
function(I,H){const N={idleBegin:I,idleEnd:H};this._idleStateCallbacks.push(N);this.state===f.RenderState.IDLE&&this._idleUpdatesStartFired&&N.idleBegin();const U=this;return{remove:()=>this._removeIdleStateCallbacks(N),set idleBegin(ba){U._idleUpdatesStartFired&&(N.idleEnd(),U._state===f.RenderState.IDLE&&ba());N.idleBegin=ba},set idleEnd(ba){N.idleEnd=ba}}};E.updateBudget=function(I){this._test.usedBudget=0;++this._frameNumber;let H=p,N=I.frameDuration,U=v;switch(this.state){case f.RenderState.IDLE:H=
b.Milliseconds(0);N=b.Milliseconds(Math.max(r,I.frameDuration));U=l;break;case f.RenderState.INTERACTING:N=b.Milliseconds(Math.max(u,I.frameDuration))}N=b.Milliseconds(N-I.elapsedFrameTime-H);if(this.state!==f.RenderState.IDLE&&N<v&&!this._forceTask)return this._forceTask=!0,!1;N=b.Milliseconds(Math.max(N,U));this._budget.reset(N,this.state);this._updateLoad();return this._schedule()};E.frame=function(){this._microTaskQueued=this._forceTask=!1;switch(this.state){case f.RenderState.IDLE:this._idleUpdatesStartFired||
(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(I=>I.idleBegin()));this._runIdle();break;case f.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed};E.stopFrame=function(){this._budget.reset(b.Milliseconds(0),this._state);this._budget.madeProgress()};E._removeIdleStateCallbacks=function(I){this._idleUpdatesStartFired&&I.idleEnd();this._idleStateCallbacks.removeUnordered(I)};E.removeTask=function(I){this._tasks.removeUnordered(I);
this._runQueue.removeUnordered(I);this._updatingChanged()};E._updateTask=function(I){this._tasks.forAll(H=>{H.name===I&&H.setPriority(I)})};E._getState=function(I){if(this._runQueue.some(N=>N.name===I))return q.TaskState.SCHEDULED;let H=q.TaskState.IDLE;this._tasks.forAll(N=>{N.name===I&&N.needsUpdate&&(1>=N.schedulePriority?H=q.TaskState.READY:H!==q.TaskState.READY&&(H=q.TaskState.WAITING))});return H};E._getRuntime=function(I){let H=0;this._tasks.forAll(N=>{N.name===I&&(H+=N.runtime)});return H};
E._resetRuntimes=function(){this._tasks.forAll(I=>I.runtime=0)};E._getRunning=function(){const I=new Map;this._tasks.forAll(N=>{N.needsUpdate&&I.set(N.name,(I.get(N.name)||0)+1)});if(0===I.size)return null;let H="";I.forEach((N,U)=>{H=1<N?H+` ${N}x ${U}`:H+` ${U}`});return H};E._runIdle=function(){this._run()};E._runInteracting=function(){this._run()};E._runAnimating=function(){this._run()};E._updateLoad=function(){const I=this._tasks.reduce((H,N)=>N.needsUpdate?++H:H,0);this._load=.9*this._load+
I*(1-.9)};E._schedule=function(){this._runQueue.filterInPlace(I=>{if(I.needsUpdate)return!0;I.schedulePriority=I.basePriority;return!1});for(this._tasks.forAll(I=>{0===I.basePriority&&I.needsUpdate&&!this._runQueue.includes(I)&&I.blockFrame!==this._frameNumber&&this._runQueue.unshift(I)});0===this._runQueue.length;){let I=!1;this._tasks.forAll(H=>{if(H.needsUpdate&&0!==H.schedulePriority&&0!==H.basePriority&&H.blockFrame!==this._frameNumber)switch(I=!0,H.schedulePriority){case 1:H.schedulePriority=
0;this._runQueue.push(H);break;default:--H.schedulePriority}});if(!I)return this._updatingChanged(),!1}this._updatingChanged();return!0};E._run=function(){const I=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var H=this._budget.now();const N=this._runQueue.pop();this._budget.resetProgress();try{N.task.runTask(this._budget)===q.Task.YIELD&&(N.blockFrame=this._frameNumber)}catch(U){z.getLogger("esri.views.support.Scheduler").error(`Exception in task "${N.name}"`,U)}!this._budget.hasProgressed&&
N.blockFrame!==this._frameNumber&&N.needsUpdate&&(N.blockFrame=this._frameNumber);N.schedulePriority=N.basePriority;H=this._budget.now()-H;N.runtime+=H;this._frameTaskTimes.set(N.priority,this._frameTaskTimes.get(N.priority)+H);this._debug&&H>2*this._budget.budget&&console.log("Task",N.name,"used",H,"of max",this._budget.budget,"ms");if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-I);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-
I)};E._startFrameTaskTimes=function(){for(const I of Object.keys(q.TaskPriority))this._frameTaskTimes.set(q.TaskPriority[I],0)};E._recordFrameTaskTimes=function(I){this._frameTaskTimes.forEach((H,N)=>this.performanceInfo.tasks.get(N).record(H));this.performanceInfo.total.record(I)};n._createClass(K,[{key:"updating",get:function(){return this._updating.get()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return this._state},set:function(I){this._state!==I&&(this._state=
I,this.state!==f.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(H=>H.idleEnd())))}},{key:"test",get:function(){return this._test}}]);return K}();t.Scheduler=B;let J=function(){function K(I,H,N,U){this._scheduler=I;this.name=H;this._basePriority=U;this.runtime=this.blockFrame=0;this._queue=new h.PromiseQueue;this._handles=new G;this.schedulePriority=this._basePriority;this._task=new a.ObservableValue(y.isSome(N)?N:this._queue);this._handles.add(g.when(()=>
this.task.running,ba=>I.taskRunningChanged(ba)))}var E=K.prototype;E.remove=function(){this.processQueue(w);this._scheduler.removeTask(this);this.schedule=m.schedule;this.reschedule=m.reschedule;this._handles.destroy()};E.setPriority=function(I){this.name=I;I=c(I);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=I;this._basePriority=I};E.schedule=function(I,H,N){return this._queue.push(I,H,N)};E.reschedule=function(I,H,N){return this._queue.unshift(I,H,N)};E.processQueue=
function(I){this._queue.runTask(I)};n._createClass(K,[{key:"task",get:function(){return this._task.get()}},{key:"updating",get:function(){return this._queue.running}},{key:"basePriority",get:function(){return this._basePriority}},{key:"priority",get:function(){return this.name},set:function(I){this.setPriority(I)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}}]);return K}(),C=function(){function K(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=
0;this._state=f.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}var E=K.prototype;E.run=function(I){if(this.done)return!1;!0===I()&&this.madeProgress();return!0};E.madeProgress=function(){this._progressed=!0;return this._done=this.elapsed>=this._budget&&this._enabled};E.reset=function(I,H){this._begin=this.now();this._budget=I;this._state=H;this.resetProgress()};E.now=function(){return performance.now()};E.resetProgress=function(){this._done=this._progressed=!1};n._createClass(K,
[{key:"done",get:function(){return this._done}},{key:"budget",get:function(){return this._budget}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(I){this._enabled=I}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return performance.now()-this._begin}},{key:"hasProgressed",get:function(){return this._progressed}}]);return K}();t.Budget=C})(A||(A={}));q.TaskState=void 0;
(function(t){t.SCHEDULED="s";t.READY="r";t.WAITING="w";t.IDLE="i"})(q.TaskState||(q.TaskState={}));const w=(()=>{const t=new A.Budget;t.enabled=!1;return t})(),m=new (function(){function t(){}var B=t.prototype;B.remove=function(){};B.processQueue=function(){};B.schedule=function(J,C,K){try{if(k.isAborted(C)){const E=k.createAbortError();return K?Promise.resolve(K(E)):Promise.reject(E)}return k.when(J(w))}catch(E){return Promise.reject(E)}};B.reschedule=function(J,C,K){return this.schedule(J,C,K)};
return n._createClass(t)}());q.ImmediateTask=m;q.getTaskPriority=c;q.newScheduler=function(){return new A.Scheduler};q.noBudget=w;q.taskPriorities=d;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/accessorSupport/tracking/ObservableValue":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../tracking","./SimpleObservable"],function(q,n,G,F){let z=function(){function y(x){this._observable=new F.SimpleObservable;this._value=x}var D=y.prototype;D.get=
function(){G.trackAccess(this._observable);return this._value};D.set=function(x){x!==this._value&&(this._value=x,this._observable.notify())};return n._createClass(y)}();q.ObservableValue=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/promiseUtils","../../core/accessorSupport/tracking/ObservableValue"],function(q,n,G,F){let z=function(){function D(){this._tasks=[];
this._running=new F.ObservableValue(!1)}var x=D.prototype;x.destroy=function(){this.cancelAll()};x.runTask=function(k){for(;!k.done&&this._process(k);)k.madeProgress()};x.push=function(k,g,b){this._running.set(!0);return new Promise((a,h)=>this._tasks.push(new y(a,h,k,g,b)))};x.unshift=function(k,g,b){this._running.set(!0);return new Promise((a,h)=>this._tasks.unshift(new y(a,h,k,g,b)))};x._process=function(k){if(0===this._tasks.length)return!1;const g=this._tasks.shift();try{const b=G.isAborted(g.signal);
if(b&&!g.abortCallback)g.reject(G.createAbortError());else{const a=b?g.abortCallback?.(G.createAbortError()):g.callback(k);G.isPromiseLike(a)?a.then(g.resolve,g.reject):g.resolve(a)}}catch(b){g.reject(b)}this._running.set(0<this._tasks.length);return!0};x.cancelAll=function(){const k=G.createAbortError();for(const g of this._tasks)if(g.abortCallback){const b=g.abortCallback(k);g.resolve(b)}else g.reject(k);this._tasks.length=0;this._running.set(!1)};n._createClass(D,[{key:"length",get:function(){return this._tasks.length}},
{key:"running",get:function(){return this._running.get()}}]);return D}(),y=n._createClass(function(D,x,k,g,b){this.resolve=D;this.reject=x;this.callback=k;this.signal=g;this.abortCallback=b});q.PromiseQueue=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x){G=function(k){function g(){var a=b.apply(this,arguments);a.SCHEDULER_LOG_SLOW_TASKS=!1;a.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1;return a}q._inherits(g,k);var b=q._createSuper(g);return q._createClass(g)}(G);n.__decorate([F.property()],G.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);n.__decorate([F.property()],G.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);G=n.__decorate([x.subclass("esri.views.support.DebugFlags")],G);return new G})},
"esri/views/support/RenderState":function(){define(["exports"],function(q){q.RenderState=void 0;var n=q.RenderState||(q.RenderState={});n[n.ANIMATING=0]="ANIMATING";n[n.INTERACTING=1]="INTERACTING";n[n.IDLE=2]="IDLE";Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/FeatureStore2D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../../chunks/rbush ../../../../geometry/support/aaBoundingBox ./Store2D ./support/FeatureSetReaderPBFIndirect".split(" "),
function(q,n,G,F,z,y,D,x,k,g){const b=x.create(),a={getObjectId(h){return h.getObjectId()},getAttributes(h){return h.readAttributes()},getAttribute(h,e){return h.readAttribute(e)},cloneWithGeometry(h,e){return h},getGeometry(h){return h.readHydratedGeometry()},getCentroid(h,e){return h.readCentroid()}};z=function(h){function e(c,d,p){var v=f.call(this,c,d);v.featureAdapter=a;v.events=new F;v._featureSetsByInstance=new Map;v._objectIdToDisplayId=new Map;v._spatialIndexInvalid=!0;v._indexSearchCache=
new G(50);v._index=D.rbush(9,l=>({minX:v._storage.getXMin(l),minY:v._storage.getYMin(l),maxX:v._storage.getXMax(l),maxY:v._storage.getYMax(l)}));v.mode=p;return v}n._inherits(e,h);var f=n._createSuper(e);h=e.prototype;h.hasInstance=function(c){return this._featureSetsByInstance.has(c)};h.onTileData=function(c,d){if(y.isNone(d.addOrUpdate))return d;d.addOrUpdate.attachStorage(this._storage);if("snapshot"===this.mode){for(var p=d.addOrUpdate.getCursor();p.next();){const v=p.getDisplayId();this.setComputedAttributes(this._storage,
p,v,c.scale)}return d}this._featureSetsByInstance.set(d.addOrUpdate.instance,d.addOrUpdate);for(p=d.addOrUpdate.getCursor();p.next();)this._insertFeature(p,c.scale);this._spatialIndexInvalid=!0;this.events.emit("changed");return d};h.search=function(c){this._rebuildIndex();const d=c.id;var p=this._indexSearchCache.find(u=>u.tileId===d);if(y.isSome(p))return p.readers;p=new Map;c=this._searchIndex(c.bounds);const v=[];for(const u of c){var l=this._storage.getInstanceId(u);c=(4294901760&l)>>>16;l&=
65535;p.has(c)||p.set(c,[]);p.get(c).push(l)}p.forEach((u,r)=>{r=this._featureSetsByInstance.get(r);v.push(g.FeatureSetReaderIndirect.from(r,u))});this._indexSearchCache.enqueue({tileId:d,readers:v});return v};h.insert=function(c){const d=c.getCursor(),p=this._storage;for(;d.next();){var v=d.getIndex();v|=d.instance<<16;const l=d.getObjectId(),u=this._objectIdToDisplayId.get(l)??this._storage.createDisplayId();d.setDisplayId(u);p.setInstanceId(u,v);this._objectIdToDisplayId.set(l,u)}this._featureSetsByInstance.set(c.instance,
c);this._spatialIndexInvalid=!0};h.remove=function(c){const d=this._objectIdToDisplayId.get(c);if(d){var p=this._storage.getInstanceId(d),v=65535&p;p=(4294901760&p)>>>16;var l=this._featureSetsByInstance.get(p);this._objectIdToDisplayId.delete(c);this._storage.releaseDisplayId(d);l.removeAtIndex(v);l.isEmpty&&this._featureSetsByInstance.delete(p);this._spatialIndexInvalid=!0}};h.forEach=function(c){this._objectIdToDisplayId.forEach(d=>{d=this._storage.getInstanceId(d);d=this._lookupFeature(d);c(d)})};
h.forEachUnsafe=function(c){this._objectIdToDisplayId.forEach(d=>{var p=this._storage.getInstanceId(d);d=65535&p;p=this._getFeatureSet((4294901760&p)>>>16);p.setIndex(d);c(p)})};h.forEachInBounds=function(c,d){c=this._searchIndex(c);for(const p of c)c=this.lookupFeatureByDisplayId(p,this._storage),d(y.unwrap(c))};h.forEachBounds=function(c,d){this._rebuildIndex();for(const p of c)p.readGeometry()&&(c=p.getDisplayId(),x.fromRectValues(b,this._storage.getXMin(c),this._storage.getYMin(c),this._storage.getXMax(c),
this._storage.getYMax(c)),d(b))};h.sweepFeatures=function(c,d,p){this._spatialIndexInvalid=!0;this._objectIdToDisplayId.forEach((v,l)=>{c.has(v)||(d.releaseDisplayId(v),p&&p.unsetAttributeData(v),this._objectIdToDisplayId.delete(l))});this.events.emit("changed")};h.sweepFeatureSets=function(c){this._spatialIndexInvalid=!0;this._featureSetsByInstance.forEach((d,p)=>{c.has(p)||this._featureSetsByInstance.delete(p)})};h.lookupObjectId=function(c,d){c=this.lookupFeatureByDisplayId(c,d);return y.isNone(c)?
null:c.getObjectId()};h.lookupDisplayId=function(c){return this._objectIdToDisplayId.get(c)};h.lookupFeatureByDisplayId=function(c,d){c=d.getInstanceId(c);return this._lookupFeature(c)};h.lookupByDisplayIdUnsafe=function(c){var d=this._storage.getInstanceId(c);c=65535&d;d=this._getFeatureSet((4294901760&d)>>>16);if(!d)return null;d.setIndex(c);return d};h._insertFeature=function(c,d){const p=this._storage,v=c.getObjectId();var l=c.getIndex();l|=c.instance<<16;p.getInstanceId(c.getDisplayId());let u=
this._objectIdToDisplayId.get(v);u||(u=p.createDisplayId(),this._objectIdToDisplayId.set(v,u),this._spatialIndexInvalid=!0);c.setDisplayId(u);p.setInstanceId(u,l);this.setComputedAttributes(p,c,u,d)};h._searchIndex=function(c){this._rebuildIndex();return this._index.search({minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]})};h._rebuildIndex=function(){if(this._spatialIndexInvalid){var c=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach(d=>{for(d=d.getCursor();d.next();){const p=d.getDisplayId();
this._storage.setBounds(p,d)&&c.push(p)}}):this._objectIdToDisplayId.forEach(d=>{const p=this._storage.getInstanceId(d);this._storage.setBounds(d,this._lookupFeature(p))&&c.push(d)});this._index.clear();this._index.load(c);this._indexSearchCache.clear();this._spatialIndexInvalid=!1}};h._lookupFeature=function(c){var d=this._getFeatureSet((4294901760&c)>>>16);if(d)return d=d.getCursor(),d.setIndex(65535&c),d};h._getFeatureSet=function(c){return this._featureSetsByInstance.get(c)};n._createClass(e,
[{key:"storeStatistics",get:function(){let c=0,d=0,p=0;this.forEach(v=>{if(v=v.readGeometry())d+=v.isPoint?1:v.lengths.reduce((l,u)=>l+u,0),p+=v.isPoint?1:v.lengths.length,c+=1});return{featureCount:c,vertexCount:d,ringCount:p}}}]);return e}(k.Store2D);q.FeatureStore2D=z;q.featureAdapter=a;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(q,n){return function(){function G(z){this._start=
this.size=0;this.maxSize=z;this._buffer=Array(z)}var F=G.prototype;F.enqueue=function(z){if(this.size===this.maxSize){const y=this._buffer[this._start];this._buffer[this._start]=z;this._start=(this._start+1)%this.maxSize;return y}this._buffer[(this._start+this.size++)%this.maxSize]=z;return null};F.dequeue=function(){if(0===this.size)return null;const z=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return z};F.peek=function(){return 0===
this.size?null:this._buffer[this._start]};F.find=function(z){if(0===this.size)return null;for(const y of this._buffer)if(n.isSome(y)&&z(y))return y;return null};F.clear=function(z){let y=this.dequeue();for(;n.isSome(y);)z&&z(y),y=this.dequeue()};q._createClass(G,[{key:"entries",get:function(){return this._buffer}}]);return G}()})},"esri/core/Evented":function(){define(["../chunks/_rollupPluginBabelHelpers","../chunks/tslib.es6","./Accessor","./handleUtils","./accessorSupport/decorators/subclass"],
function(q,n,G,F,z){let y=function(){function D(){this._emitter=new D.EventEmitter(this)}var x=D.prototype;x.emit=function(k,g){return this._emitter.emit(k,g)};x.on=function(k,g){return this._emitter.on(k,g)};x.once=function(k,g){return this._emitter.once(k,g)};x.hasEventListener=function(k){return this._emitter.hasEventListener(k)};return q._createClass(D)}();(function(D){let x=function(){function g(a=null){this._target=a;this._listenersMap=null}var b=g.prototype;b.clear=function(){this._listenersMap&&
this._listenersMap.clear();this._listenersMap=null};b.emit=function(a,h){a=this._listenersMap&&this._listenersMap.get(a);if(!a)return!1;const e=this._target||this;[...a].forEach(f=>{f.call(e,h)});return 0<a.length};b.on=function(a,h){if(Array.isArray(a)){var e=a.map(f=>this.on(f,h));return F.handlesGroup(e)}if(a.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);e=this._listenersMap.get(a)||
[];e.push(h);this._listenersMap.set(a,e);return{remove:()=>{const f=this._listenersMap&&this._listenersMap.get(a)||[],c=f.indexOf(h);0<=c&&f.splice(c,1)}}};b.once=function(a,h){const e=this.on(a,f=>{e.remove();h.call(null,f)});return e};b.hasEventListener=function(a){a=this._listenersMap&&this._listenersMap.get(a);return null!=a&&0<a.length};return q._createClass(g)}();D.EventEmitter=x;D.EventedMixin=g=>{g=function(b){function a(){var e=h.apply(this,arguments);e._emitter=new x;return e}q._inherits(a,
b);var h=q._createSuper(a);b=a.prototype;b.destroy=function(){this._emitter.clear()};b.emit=function(e,f){return this._emitter.emit(e,f)};b.on=function(e,f){return this._emitter.on(e,f)};b.once=function(e,f){return this._emitter.once(e,f)};b.hasEventListener=function(e){return this._emitter.hasEventListener(e)};return q._createClass(a)}(g);return g=n.__decorate([z.subclass("esri.core.Evented")],g)};let k=function(g){function b(){var h=a.apply(this,arguments);h._emitter=new y.EventEmitter(q._assertThisInitialized(h));
return h}q._inherits(b,g);var a=q._createSuper(b);g=b.prototype;g.destroy=function(){this._emitter.clear()};g.emit=function(h,e){return this._emitter.emit(h,e)};g.on=function(h,e){return this._emitter.on(h,e)};g.once=function(h,e){return this._emitter.once(h,e)};g.hasEventListener=function(h){return this._emitter.hasEventListener(h)};return q._createClass(b)}(G);k=n.__decorate([z.subclass("esri.core.Evented")],k);D.EventedAccessor=k})(y||(y={}));return y})},"esri/chunks/rbush":function(){define(["exports",
"./quickselect"],function(q,n){function G(f,c){if(!(this instanceof G))return new G(f,c);this._maxEntries=Math.max(4,f||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function F(f,c){z(f,0,f.children.length,c,f)}function z(f,c,d,p,v){v||(v=h(null));v.minX=Infinity;v.minY=Infinity;v.maxX=-Infinity;v.maxY=-Infinity;for(var l;c<d;c++)l=f.children[c],y(v,f.leaf?p(l):l);return v}function y(f,c){f.minX=Math.min(f.minX,
c.minX);f.minY=Math.min(f.minY,c.minY);f.maxX=Math.max(f.maxX,c.maxX);f.maxY=Math.max(f.maxY,c.maxY);return f}function D(f,c){return f.minX-c.minX}function x(f,c){return f.minY-c.minY}function k(f){return(f.maxX-f.minX)*(f.maxY-f.minY)}function g(f){return f.maxX-f.minX+(f.maxY-f.minY)}function b(f,c){return f.minX<=c.minX&&f.minY<=c.minY&&c.maxX<=f.maxX&&c.maxY<=f.maxY}function a(f,c){return c.minX<=f.maxX&&c.minY<=f.maxY&&c.maxX>=f.minX&&c.maxY>=f.minY}function h(f){return{children:f,height:1,leaf:!0,
minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function e(f,c,d,p,v){for(var l=[c,d],u;l.length;)d=l.pop(),c=l.pop(),d-c<=p||(u=c+Math.ceil((d-c)/p/2)*p,n.quickselect(f,u,c,d,v),l.push(c,u,u,d))}G.prototype={all:function(){return this._all(this.data,[])},search:function(f){var c=this.data,d=[],p=this.toBBox;if(!a(f,c))return d;for(var v=[],l,u,r,A;c;){l=0;for(u=c.children.length;l<u;l++)r=c.children[l],A=c.leaf?p(r):r,a(f,A)&&(c.leaf?d.push(r):b(f,A)?this._all(r,d):v.push(r));c=v.pop()}return d},
collides:function(f){var c=this.data,d=this.toBBox;if(!a(f,c))return!1;for(var p=[],v,l,u,r;c;){v=0;for(l=c.children.length;v<l;v++)if(u=c.children[v],r=c.leaf?d(u):u,a(f,r)){if(c.leaf||b(f,r))return!0;p.push(u)}c=p.pop()}return!1},load:function(f){if(!f||!f.length)return this;if(f.length<this._minEntries){for(var c=0,d=f.length;c<d;c++)this.insert(f[c]);return this}f=this._build(f.slice(),0,f.length-1,0);this.data.children.length?this.data.height===f.height?this._splitRoot(this.data,f):(this.data.height<
f.height&&(c=this.data,this.data=f,f=c),this._insert(f,this.data.height-f.height-1,!0)):this.data=f;return this},insert:function(f){f&&this._insert(f,this.data.height-1);return this},clear:function(){this.data=h([]);return this},remove:function(f,c){if(!f)return this;for(var d=this.data,p=this.toBBox(f),v=[],l=[],u,r,A,w;d||v.length;){d||(d=v.pop(),r=v[v.length-1],u=l.pop(),w=!0);if(d.leaf){a:{A=f;var m=d.children,t=c;if(t){for(var B=0;B<m.length;B++)if(t(A,m[B])){A=B;break a}A=-1}else A=m.indexOf(A)}if(-1!==
A){d.children.splice(A,1);v.push(d);this._condense(v);break}}w||d.leaf||!b(d,p)?r?(u++,d=r.children[u],w=!1):d=null:(v.push(d),l.push(u),u=0,r=d,d=d.children[0])}return this},toBBox:function(f){return f},compareMinX:D,compareMinY:x,toJSON:function(){return this.data},fromJSON:function(f){this.data=f;return this},_all:function(f,c){for(var d=[];f;)f.leaf?c.push.apply(c,f.children):d.push.apply(d,f.children),f=d.pop();return c},_build:function(f,c,d,p){var v=d-c+1,l=this._maxEntries;if(v<=l){var u=
h(f.slice(c,d+1));F(u,this.toBBox);return u}p||(p=Math.ceil(Math.log(v)/Math.log(l)),l=Math.ceil(v/Math.pow(l,p-1)));u=h([]);u.leaf=!1;u.height=p;v=Math.ceil(v/l);l=v*Math.ceil(Math.sqrt(l));var r;for(e(f,c,d,l,this.compareMinX);c<=d;c+=l){var A=Math.min(c+l-1,d);e(f,c,A,v,this.compareMinY);for(r=c;r<=A;r+=v){var w=Math.min(r+v-1,A);u.children.push(this._build(f,r,w,p-1))}}F(u,this.toBBox);return u},_chooseSubtree:function(f,c,d,p){for(var v,l,u,r,A,w,m,t;;){p.push(c);if(c.leaf||p.length-1===d)break;
m=t=Infinity;v=0;for(l=c.children.length;v<l;v++)u=c.children[v],A=k(u),w=(Math.max(u.maxX,f.maxX)-Math.min(u.minX,f.minX))*(Math.max(u.maxY,f.maxY)-Math.min(u.minY,f.minY))-A,w<t?(t=w,m=A<m?A:m,r=u):w===t&&A<m&&(m=A,r=u);c=r||c.children[0]}return c},_insert:function(f,c,d){var p=this.toBBox;d=d?f:p(f);p=[];var v=this._chooseSubtree(d,this.data,c,p);v.children.push(f);for(y(v,d);0<=c;)if(p[c].children.length>this._maxEntries)this._split(p,c),c--;else break;this._adjustParentBBoxes(d,p,c)},_split:function(f,
c){var d=f[c],p=d.children.length,v=this._minEntries;this._chooseSplitAxis(d,v,p);p=this._chooseSplitIndex(d,v,p);p=h(d.children.splice(p,d.children.length-p));p.height=d.height;p.leaf=d.leaf;F(d,this.toBBox);F(p,this.toBBox);c?f[c-1].children.push(p):this._splitRoot(d,p)},_splitRoot:function(f,c){this.data=h([f,c]);this.data.height=f.height+1;this.data.leaf=!1;F(this.data,this.toBBox)},_chooseSplitIndex:function(f,c,d){var p,v;var l=v=Infinity;for(p=c;p<=d-c;p++){var u=z(f,0,p,this.toBBox);var r=
z(f,p,d,this.toBBox);var A=Math.max(0,Math.min(u.maxX,r.maxX)-Math.max(u.minX,r.minX))*Math.max(0,Math.min(u.maxY,r.maxY)-Math.max(u.minY,r.minY));u=k(u)+k(r);if(A<l){l=A;var w=p;v=u<v?u:v}else A===l&&u<v&&(v=u,w=p)}return w},_chooseSplitAxis:function(f,c,d){var p=f.leaf?this.compareMinX:D,v=f.leaf?this.compareMinY:x,l=this._allDistMargin(f,c,d,p);c=this._allDistMargin(f,c,d,v);l<c&&f.children.sort(p)},_allDistMargin:function(f,c,d,p){f.children.sort(p);p=this.toBBox;var v=z(f,0,c,p),l=z(f,d-c,d,
p),u=g(v)+g(l),r;for(r=c;r<d-c;r++){var A=f.children[r];y(v,f.leaf?p(A):A);u+=g(v)}for(r=d-c-1;r>=c;r--)A=f.children[r],y(l,f.leaf?p(A):A),u+=g(l);return u},_adjustParentBBoxes:function(f,c,d){for(;0<=d;d--)y(c[d],f)},_condense:function(f){for(var c=f.length-1,d;0<=c;c--)0===f[c].children.length?0<c?(d=f[c-1].children,d.splice(d.indexOf(f[c]),1)):this.clear():F(f[c],this.toBBox)},_initFormat:function(f){var c=["return a"," - b",";"];this.compareMinX=new Function("a","b",c.join(f[0]));this.compareMinY=
new Function("a","b",c.join(f[1]));this.toBBox=new Function("a","return {minX: a"+f[0]+", minY: a"+f[1]+", maxX: a"+f[2]+", maxY: a"+f[3]+"};")}};q.rbush=G})},"esri/chunks/quickselect":function(){define(["exports"],function(q){var n={};(function(G){(function(F){F=F();void 0!==F&&(G.exports=F)})(function(){function F(D,x,k,g,b){for(;g>k;){if(600<g-k){var a=g-k+1,h=x-k+1,e=Math.log(a),f=.5*Math.exp(2*e/3);e=.5*Math.sqrt(e*f*(a-f)/a)*(0>h-a/2?-1:1);F(D,x,Math.max(k,Math.floor(x-h*f/a+e)),Math.min(g,
Math.floor(x+(a-h)*f/a+e)),b)}a=D[x];h=k;f=g;z(D,k,x);for(0<b(D[g],a)&&z(D,k,g);h<f;){z(D,h,f);h++;for(f--;0>b(D[h],a);)h++;for(;0<b(D[f],a);)f--}0===b(D[k],a)?z(D,k,f):(f++,z(D,f,g));f<=x&&(k=f+1);x<=f&&(g=f-1)}}function z(D,x,k){var g=D[x];D[x]=D[k];D[k]=g}function y(D,x){return D<x?-1:D>x?1:0}return function(D,x,k,g,b){F(D,x,k||0,g||D.length-1,b||y)}})})({get exports(){return n},set exports(G){n=G}});q.quickselect=n})},"esri/views/2d/layers/features/Store2D":function(){define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/accessorSupport/diffUtils ../../../../support/arcadeOnDemand ../../arcade/callExpressionWithCursor".split(" "),
function(q,n,G,F,z,y,D,x){const k=new Promise((b,a)=>q(["../../../../layers/support/labelFormatUtils"],b,a));let g=function(){function b(h,e){this._canCacheExpressionValue=!1;this._sourceInfo=h;this._storage=e;this._bitsets={computed:e.getBitset(e.createBitset())}}var a=b.prototype;a.invalidate=function(){this._bitsets.computed.clear()};a.updateSchema=async function(h,e){var f=y.diff(this._schema,e);if((this._schema=e)&&!z.isNone(f)&&y.hasDiff(f,"attributes")){F("esri-2d-update-debug")&&console.debug("Applying Update - Store:",
f);this._bitsets.computed.clear();h.targets[e.name]=!0;h=e.attributes;e=[];f=[];for(const c in h){const d=h[c];switch(d.type){case "expression":e.push(this._createArcadeComputedField(d));break;case "label-expression":e.push(this._createLabelArcadeComputedField(d));break;case "statistic":f.push(d)}}this._computedFields=await Promise.all(e);this._canCacheExpressionValue=!this._computedFields.some(c=>"expression"===c.type&&z.isSome(c.expression)&&c.expression.referencesScale());this._statisticFields=
f}};a.setComputedAttributes=function(h,e,f,c){var d=this._bitsets.computed;if(!this._canCacheExpressionValue||!d.has(f)){d.set(f);for(const p of this._computedFields)switch(d=this._evaluateField(e,p,c),p.resultType){case "numeric":h.setComputedNumericAtIndex(f,p.fieldIndex,d);break;case "string":h.setComputedStringAtIndex(f,p.fieldIndex,d)}}};a._createArcadeComputedField=async function(h){return{...h,expression:await D.createRendererExpression(h.valueExpression,this._sourceInfo.spatialReference,this._sourceInfo.fieldsIndex)}};
a._createLabelArcadeComputedField=async function(h){var e=this._sourceInfo.spatialReference;const f=this._sourceInfo.fieldsIndex,{createLabelFunction:c}=await k;e=await c(h.label,f,e);return{...h,builder:e}};a._evaluateField=function(h,e,f){switch(e.type){case "label-expression":return h=h.readArcadeFeature(),e.builder.evaluate(h)||"";case "expression":return{expression:e}=e,x(e,h,{$view:{scale:f}})}};G._createClass(b,[{key:"storage",get:function(){return this._storage}}]);return b}();n.Store2D=g;
Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/core/accessorSupport/diffUtils":function(){define(["exports","../Accessor","../Collection","../maybe","./utils"],function(q,n,G,F,z){function y(e){return e instanceof G?Object.keys(e.items):e instanceof n?z.getProperties(e).keys():e?Object.keys(e):[]}function D(e,f){return e instanceof G?e.items[f]:e[f]}function x(e,f){return Array.isArray(e)&&Array.isArray(f)?e.length!==f.length:!1}function k(e){return e?e.declaredClass:null}function g(e,
f){const c=e.diff;if(c&&"function"===typeof c)return c(e,f);const d=y(e),p=y(f);if(0!==d.length||0!==p.length){if(!d.length||!p.length||x(e,f))return{type:"complete",oldValue:e,newValue:f};var v=p.filter(r=>!d.includes(r)),l=d.filter(r=>!p.includes(r));l=d.filter(r=>p.includes(r)&&D(e,r)!==D(f,r)).concat(v,l).sort();if((v=k(e))&&h.includes(v)&&l.length)return{type:"complete",oldValue:e,newValue:f};var u;v=e instanceof n&&f instanceof n;for(const r of l){l=D(e,r);const A=D(f,r);if((v||"function"!==
typeof l&&"function"!==typeof A)&&l!==A&&(null!=l||null!=A)){if(c&&c[r]&&"function"===typeof c[r])l=c[r](l,A);else if(l instanceof Date&&A instanceof Date){if(l.getTime()===A.getTime())continue;l={type:"complete",oldValue:l,newValue:A}}else l="object"===typeof l&&"object"===typeof A&&k(l)===k(A)?g(l,A):{type:"complete",oldValue:l,newValue:A};F.isSome(l)&&(F.isSome(u)?u.diff[r]=l:u={type:"partial",diff:{[r]:l}})}}return u}}function b(e,f){if(F.isNone(e))return!1;f=f.split(".");for(const c of f){if("complete"===
e.type)break;if("partial"===e.type){if(e=e.diff[c],!e)return!1}else return!1}return!0}function a(e){if(F.isNone(e))return!0;switch(e.type){case "complete":return!1;case "collection":for(const f of e.added)if(!a(f))return!1;for(const f of e.removed)if(!a(f))return!1;for(const f of e.changed)if(!a(f))return!1;return!0;case "partial":for(const f in e.diff)if(!a(e.diff[f]))return!1;return!0}}const h=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];
q.diff=function(e,f){if(!("function"===typeof e||"function"===typeof f||F.isNone(e)&&F.isNone(f)))return F.isNone(e)||F.isNone(f)||"object"===typeof e&&"object"===typeof f&&k(e)!==k(f)?{type:"complete",oldValue:e,newValue:f}:g(e,f)};q.hasDiff=b;q.hasDiffAny=function(e,f){for(const c of f)if(b(e,c))return!0;return!1};q.isEmpty=a;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/Collection":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./ArrayPool ./Evented ./lang ./maybe ./ObjectPool ./ObservableChangesType ./scheduling ./accessorSupport/ensureType ./accessorSupport/tracking ./accessorSupport/decorators/property ./accessorSupport/decorators/shared ./accessorSupport/decorators/subclass ./accessorSupport/tracking/SimpleObservable".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f){function c(C){return C?C instanceof J?C.toArray():C.length?Array.prototype.slice.apply(C):[]:[]}function d(C){if(C&&C.length)return C[0]}function p(C,K,E,I){K&&K.forEach((H,N,U)=>{C.push(H);p(C,E.call(I,H,N,U),E,I)})}var v;let l=function(){function C(){this.target=null;this.defaultPrevented=this.cancellable=!1;this.type=this.item=void 0}var K=C.prototype;K.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};K.reset=function(E){this.defaultPrevented=
!1;this.item=E};return q._createClass(C)}();const u=new D(l,void 0,C=>{C.item=null;C.target=null;C.defaultPrevented=!1;C.cancellable=!1}),r=()=>{},A=new Set,w=new Set,m=new Set,t=new Map;let B=0,J=v=function(C,K){function E(H){H=I.call(this,H);H._chgListeners=[];H._notifications=null;H._timer=null;H._observable=new f.SimpleObservable;H.length=0;H._items=[];Object.defineProperty(q._assertThisInitialized(H),"uid",{value:B++});return H}q._inherits(E,C);var I=q._createSuper(E);E.isCollection=function(H){return null!=
H&&H instanceof v};C=E.prototype;C.normalizeCtorArgs=function(H){return H?Array.isArray(H)||H instanceof v?{items:H}:H:{}};C.destroy=function(){this._removeAllRaw()};C[K]=function*(){yield*this.items};C.hasEventListener=function(H){return"change"===H?0<this._chgListeners.length:this._emitter.hasEventListener(H)};C.on=function(H,N){if("change"===H){const U=this._chgListeners,ba={removed:!1,callback:N};U.push(ba);this._notifications&&this._notifications.push({listeners:U.slice(),items:this._items.slice(),
changes:[]});return{remove(){this.remove=r;ba.removed=!0;U.splice(U.indexOf(ba),1)}}}return this._emitter.on(H,N)};C.once=function(H,N){const U=this.on(H,N);return{remove(){U.remove()}}};C.add=function(H,N){b.trackAccess(this._observable);if(this._emitBeforeChanges(x.ObservableChangesType.ADD))return this;N=this.getNextIndex(N??null);this._splice(N,0,[H]);this._emitAfterChanges(x.ObservableChangesType.ADD);return this};C.addMany=function(H,N=this._items.length){b.trackAccess(this._observable);if(!H||
!H.length||this._emitBeforeChanges(x.ObservableChangesType.ADD))return this;N=this.getNextIndex(N);this._splice(N,0,c(H));this._emitAfterChanges(x.ObservableChangesType.ADD);return this};C.at=function(H){b.trackAccess(this._observable);H=Math.trunc(H)||0;0>H&&(H+=this.length);if(!(0>H||H>=this.length))return this._items[H]};C.removeAll=function(){b.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(x.ObservableChangesType.REMOVE))return[];const H=this._removeAllRaw();this._emitAfterChanges(x.ObservableChangesType.REMOVE);
return H};C._removeAllRaw=function(){return 0===this.length?[]:this._splice(0,this.length)||[]};C.clone=function(){b.trackAccess(this._observable);return this._createNewInstance({items:this._items.map(z.clone)})};C.concat=function(...H){b.trackAccess(this._observable);H=H.map(c);return this._createNewInstance({items:this._items.concat(...H)})};C.drain=function(H,N){b.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(x.ObservableChangesType.REMOVE)){var U=y.assumeNonNull(this._splice(0,
this.length)),ba=U.length;for(let la=0;la<ba;la++)H.call(N,U[la],la,U);this._emitAfterChanges(x.ObservableChangesType.REMOVE)}};C.every=function(H,N){b.trackAccess(this._observable);return this._items.every(H,N)};C.filter=function(H,N){b.trackAccess(this._observable);let U;U=2===arguments.length?this._items.filter(H,N):this._items.filter(H);return this._createNewInstance({items:U})};C.find=function(H,N){b.trackAccess(this._observable);return this._items.find(H,N)};C.findIndex=function(H,N){b.trackAccess(this._observable);
return this._items.findIndex(H,N)};C.flatten=function(H,N){b.trackAccess(this._observable);const U=[];p(U,this,H,N);return new v(U)};C.forEach=function(H,N){b.trackAccess(this._observable);return this._items.forEach(H,N)};C.getItemAt=function(H){b.trackAccess(this._observable);return this._items[H]};C.getNextIndex=function(H){b.trackAccess(this._observable);const N=this.length;H=null==H?N:H;0>H?H=0:H>N&&(H=N);return H};C.includes=function(H,N=0){b.trackAccess(this._observable);return this._items.includes(H,
N)};C.indexOf=function(H,N=0){b.trackAccess(this._observable);return this._items.indexOf(H,N)};C.join=function(H=","){b.trackAccess(this._observable);return this._items.join(H)};C.lastIndexOf=function(H,N=this.length-1){b.trackAccess(this._observable);return this._items.lastIndexOf(H,N)};C.map=function(H,N){b.trackAccess(this._observable);H=this._items.map(H,N);return new v({items:H})};C.reorder=function(H,N=this.length-1){b.trackAccess(this._observable);const U=this.indexOf(H);if(-1!==U){0>N?N=0:
N>=this.length&&(N=this.length-1);if(U!==N){if(this._emitBeforeChanges(x.ObservableChangesType.MOVE))return H;this._splice(U,1);this._splice(N,0,[H]);this._emitAfterChanges(x.ObservableChangesType.MOVE)}return H}};C.pop=function(){b.trackAccess(this._observable);if(this.length&&!this._emitBeforeChanges(x.ObservableChangesType.REMOVE)){var H=d(this._splice(this.length-1,1));this._emitAfterChanges(x.ObservableChangesType.REMOVE);return H}};C.push=function(...H){b.trackAccess(this._observable);if(this._emitBeforeChanges(x.ObservableChangesType.ADD))return this.length;
this._splice(this.length,0,H);this._emitAfterChanges(x.ObservableChangesType.ADD);return this.length};C.reduce=function(H,N){b.trackAccess(this._observable);const U=this._items;return 2===arguments.length?U.reduce(H,N):U.reduce(H)};C.reduceRight=function(H,N){b.trackAccess(this._observable);const U=this._items;return 2===arguments.length?U.reduceRight(H,N):U.reduceRight(H)};C.remove=function(H){b.trackAccess(this._observable);return this.removeAt(this.indexOf(H))};C.removeAt=function(H){b.trackAccess(this._observable);
if(!(0>H||H>=this.length||this._emitBeforeChanges(x.ObservableChangesType.REMOVE)))return H=d(this._splice(H,1)),this._emitAfterChanges(x.ObservableChangesType.REMOVE),H};C.removeMany=function(H){b.trackAccess(this._observable);if(!H||!H.length||this._emitBeforeChanges(x.ObservableChangesType.REMOVE))return[];H=H instanceof v?H.toArray():H;const N=this._items,U=[],ba=H.length;for(let V=0;V<ba;V++){var la=N.indexOf(H[V]);if(-1<la){var aa=V+1,ka=la+1;const P=Math.min(H.length-aa,N.length-ka);let S=
0;for(;S<P&&H[aa+S]===N[ka+S];)S++;aa=1+S;(la=this._splice(la,aa))&&0<la.length&&U.push.apply(U,la);V+=aa-1}}this._emitAfterChanges(x.ObservableChangesType.REMOVE);return U};C.reverse=function(){b.trackAccess(this._observable);if(this._emitBeforeChanges(x.ObservableChangesType.MOVE))return this;const H=this._splice(0,this.length);H&&(H.reverse(),this._splice(0,0,H));this._emitAfterChanges(x.ObservableChangesType.MOVE);return this};C.shift=function(){b.trackAccess(this._observable);if(this.length&&
!this._emitBeforeChanges(x.ObservableChangesType.REMOVE)){var H=d(this._splice(0,1));this._emitAfterChanges(x.ObservableChangesType.REMOVE);return H}};C.slice=function(H=0,N=this.length){b.trackAccess(this._observable);return this._createNewInstance({items:this._items.slice(H,N)})};C.some=function(H,N){b.trackAccess(this._observable);return this._items.some(H,N)};C.sort=function(H){b.trackAccess(this._observable);if(!this.length||this._emitBeforeChanges(x.ObservableChangesType.MOVE))return this;const N=
y.assumeNonNull(this._splice(0,this.length));arguments.length?N.sort(H):N.sort();this._splice(0,0,N);this._emitAfterChanges(x.ObservableChangesType.MOVE);return this};C.splice=function(H,N,...U){b.trackAccess(this._observable);const ba=(N?x.ObservableChangesType.REMOVE:0)|(U.length?x.ObservableChangesType.ADD:0);if(this._emitBeforeChanges(ba))return[];H=this._splice(H,N,U)||[];this._emitAfterChanges(ba);return H};C.toArray=function(){b.trackAccess(this._observable);return this._items.slice()};C.toJSON=
function(){b.trackAccess(this._observable);return this.toArray()};C.toLocaleString=function(){b.trackAccess(this._observable);return this._items.toLocaleString()};C.toString=function(){b.trackAccess(this._observable);return this._items.toString()};C.unshift=function(...H){b.trackAccess(this._observable);if(!H.length||this._emitBeforeChanges(x.ObservableChangesType.ADD))return this.length;this._splice(0,0,H);this._emitAfterChanges(x.ObservableChangesType.ADD);return this.length};C._createNewInstance=
function(H){return new this.constructor(H)};C._splice=function(H,N,U){const ba=this._items;var la=this.itemType;let aa=void 0;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=k.schedule(()=>this._dispatchChange()));if(N){aa=ba.splice(H,N);if(this.hasEventListener("before-remove")){var ka=u.acquire();ka.target=this;ka.cancellable=!0;for(let S=0,X=aa.length;S<
X;S++)N=aa[S],ka.reset(N),this.emit("before-remove",ka),ka.defaultPrevented&&(aa.splice(S,1),ba.splice(H,0,N),H+=1,--S,--X);u.release(ka)}this.length=this._items.length;if(this.hasEventListener("after-remove")){N=u.acquire();N.target=this;N.cancellable=!1;ka=aa.length;for(let S=0;S<ka;S++)N.reset(aa[S]),this.emit("after-remove",N);u.release(N)}}if(U&&U.length){if(la){N=[];for(var V of U)U=la.ensureType(V),null==U&&null!=V||N.push(U);U=N}la=this.hasEventListener("before-add");V=this.hasEventListener("after-add");
N=H===this.length;if(la||V){var P=u.acquire();P.target=this;P.cancellable=!0;ka=u.acquire();ka.target=this;ka.cancellable=!1;for(const S of U)la?(P.reset(S),this.emit("before-add",P),P.defaultPrevented||(N?ba.push(S):ba.splice(H++,0,S),this._set("length",ba.length),V&&(ka.reset(S),this.emit("after-add",ka)))):(N?ba.push(S):ba.splice(H++,0,S),this._set("length",ba.length),ka.reset(S),this.emit("after-add",ka));u.release(ka);u.release(P)}else{if(N)for(P of U)ba.push(P);else ba.splice(H,0,...U);this._set("length",
ba.length)}}(U&&U.length||aa&&aa.length)&&this._notifyChangeEvent(U,aa);return aa};C._emitBeforeChanges=function(H){let N=!1;if(this.hasEventListener("before-changes")){const U=u.acquire();U.target=this;U.cancellable=!0;U.type=H;this.emit("before-changes",U);N=U.defaultPrevented;u.release(U)}return N};C._emitAfterChanges=function(H){if(this.hasEventListener("after-changes")){const N=u.acquire();N.target=this;N.cancellable=!1;N.type=H;this.emit("after-changes",N);u.release(N)}this._observable.notify()};
C._notifyChangeEvent=function(H,N){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:H,removed:N})};C._dispatchChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var H=this._notifications;this._notifications=null;for(const N of H){H=N.changes;A.clear();w.clear();m.clear();for(const {added:V,removed:P}of H){if(V)if(0===m.size&&0===w.size)for(const S of V)A.add(S);else for(const S of V)w.has(S)?
(m.add(S),w.delete(S)):m.has(S)||A.add(S);if(P)if(0===m.size&&0===A.size)for(const S of P)w.add(S);else for(const S of P)A.has(S)?A.delete(S):(m.delete(S),w.add(S))}const U=G.acquire();A.forEach(V=>{U.push(V)});const ba=G.acquire();w.forEach(V=>{ba.push(V)});const la=this._items,aa=N.items,ka=G.acquire();m.forEach(V=>{aa.indexOf(V)!==la.indexOf(V)&&ka.push(V)});if(N.listeners&&(U.length||ba.length||ka.length)){H={target:this,added:U,removed:ba,moved:ka};const V=N.listeners.length;for(let P=0;P<V;P++){const S=
N.listeners[P];S.removed||S.callback.call(this,H)}}G.release(U);G.release(ba);G.release(ka)}A.clear();w.clear();m.clear()}};q._createClass(E,[{key:"items",get:function(){b.trackAccess(this._observable);return this._items},set:function(H){this._emitBeforeChanges(x.ObservableChangesType.ADD)||(this._splice(0,this.length,c(H)),this._emitAfterChanges(x.ObservableChangesType.ADD))}}]);return E}(F.EventedAccessor,Symbol.iterator);J.ofType=C=>{if(!C)return v;if(t.has(C))return t.get(C);let K=null;if("function"===
typeof C)K=C.prototype.declaredClass;else if(C.base)K=C.base.prototype.declaredClass;else for(var E in C.typeMap){const I=C.typeMap[E].prototype.declaredClass;K=K?K+` | ${I}`:I}E=function(I){function H(){return N.apply(this,arguments)}q._inherits(H,I);var N=q._createSuper(H);return q._createClass(H)}(v);n.__decorate([h.shared({Type:C,ensureType:"function"===typeof C?g.ensureType(C):g.ensureOneOfType(C)})],E.prototype,"itemType",void 0);E=n.__decorate([e.subclass(`esri.core.Collection<${K}>`)],E);
t.set(C,E);return E};n.__decorate([a.property()],J.prototype,"length",void 0);n.__decorate([a.property()],J.prototype,"items",null);return J=v=n.__decorate([e.subclass("esri.core.Collection")],J)})},"esri/core/ObservableChangesType":function(){define(["exports"],function(q){q.ObservableChangesType=void 0;var n=q.ObservableChangesType||(q.ObservableChangesType={});n[n.ADD=1]="ADD";n[n.REMOVE=2]="REMOVE";n[n.MOVE=4]="MOVE";Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/accessorSupport/decorators/shared":function(){define(["exports"],
function(q){q.shared=function(n){return(G,F)=>{G[F]=n}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/arcade/callExpressionWithCursor":function(){define(["../../../core/Logger","../../../core/maybe"],function(q,n){return function(G,F,z){if(n.isNone(G))return null;F=F.readArcadeFeature();try{return G.evaluate({...z,$feature:F})}catch(y){return q.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",y),null}}})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFIndirect":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","./FeatureSetReader"],function(q,n,G){let F=function(z){function y(x,k){var g=D.call(this,G.FeatureSetReader.createInstance(),x.fullSchema());g._currentIndex=-1;g._reader=x;g._indices=k;return g}n._inherits(y,z);var D=n._createSuper(y);y.from=function(x,k){return new y(x.copy(),k)};z=y.prototype;z.getSize=function(){return this._indices.length};z.getCursor=function(){return this.copy()};z.copy=function(){const x=new y(this._reader.copy(),this._indices);
x._currentIndex=this._currentIndex;return x};z.next=function(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length};z._nextIndex=function(){return++this._currentIndex<this._indices.length?(this._reader.setIndex(this._indices[this._currentIndex]),!0):!1};z.setArcadeSpatialReference=function(x){this._reader.setArcadeSpatialReference(x)};z.attachStorage=function(x){this._reader.attachStorage(x)};z.getStorage=function(){return this._reader.getStorage()};
z.getComputedNumeric=function(x){return this._reader.getComputedNumericAtIndex(0)};z.setComputedNumeric=function(x,k){return this._reader.setComputedNumericAtIndex(k,0)};z.getComputedString=function(x){return this._reader.getComputedStringAtIndex(0)};z.setComputedString=function(x,k){return this._reader.setComputedStringAtIndex(0,k)};z.getComputedNumericAtIndex=function(x){return this._reader.getComputedNumericAtIndex(x)};z.setComputedNumericAtIndex=function(x,k){this._reader.setComputedNumericAtIndex(x,
k)};z.getComputedStringAtIndex=function(x){return this._reader.getComputedStringAtIndex(x)};z.setComputedStringAtIndex=function(x,k){return this._reader.setComputedStringAtIndex(x,k)};z.transform=function(x,k,g,b){const a=this.copy();a._reader=this._reader.transform(x,k,g,b);return a};z.readAttribute=function(x,k=!1){return this._reader.readAttribute(x,k)};z.readAttributes=function(){return this._reader.readAttributes()};z.joinAttributes=function(x){return this._reader.joinAttributes(x)};z.readArcadeFeature=
function(){return this._reader.readArcadeFeature()};z.geometry=function(){return this._reader.geometry()};z.field=function(x){return this.readAttribute(x,!0)};z.hasField=function(x){return this._reader.hasField(x)};z.setField=function(x,k){return this._reader.setField(x,k)};z.keys=function(){return this._reader.keys()};z.castToText=function(x=!1){return this._reader.castToText(x)};z.getQuantizationTransform=function(){return this._reader.getQuantizationTransform()};z.getFieldNames=function(){return this._reader.getFieldNames()};
z.getAttributeHash=function(){return this._reader.getAttributeHash()};z.getObjectId=function(){return this._reader.getObjectId()};z.getDisplayId=function(){return this._reader.getDisplayId()};z.setDisplayId=function(x){return this._reader.setDisplayId(x)};z.getGroupId=function(){return this._reader.getGroupId()};z.setGroupId=function(x){return this._reader.setGroupId(x)};z.getXHydrated=function(){return this._reader.getXHydrated()};z.getYHydrated=function(){return this._reader.getYHydrated()};z.getX=
function(){return this._reader.getX()};z.getY=function(){return this._reader.getY()};z.setIndex=function(x){return this._reader.setIndex(x)};z.getIndex=function(){return this._reader.getIndex()};z.readLegacyFeature=function(){return this._reader.readLegacyFeature()};z.readOptimizedFeature=function(){return this._reader.readOptimizedFeature()};z.readLegacyPointGeometry=function(){return this._reader.readLegacyPointGeometry()};z.readLegacyGeometry=function(){return this._reader.readLegacyGeometry()};
z.readLegacyCentroid=function(){return this._reader.readLegacyCentroid()};z.readGeometryArea=function(){return this._reader.readGeometryArea()};z.readUnquantizedGeometry=function(){return this._reader.readUnquantizedGeometry()};z.readHydratedGeometry=function(){return this._reader.readHydratedGeometry()};z.readGeometry=function(){return this._reader.readGeometry()};z.readCentroid=function(){return this._reader.readCentroid()};z._readAttribute=function(x,k){throw Error("Error: Should not be called. Underlying _reader should be used instead");
};z._readAttributes=function(){throw Error("Error: Should not be called. Underlying _reader should be used instead");};n._createClass(y,[{key:"hasNext",get:function(){return this._currentIndex+1<this._indices.length}},{key:"geometryType",get:function(){return this._reader.geometryType}},{key:"hasFeatures",get:function(){return this._reader.hasFeatures}},{key:"exceededTransferLimit",get:function(){return this._reader.exceededTransferLimit}},{key:"hasZ",get:function(){return this._reader.hasZ}},{key:"hasM",
get:function(){return this._reader.hasM}}]);return y}(G.FeatureSetReader);q.FeatureSetReaderIndirect=F;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../arcade/ArcadeDate ../../../../../arcade/arcadeTimeUtils ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){let h=0;G=y("featurelayer-simplify-thresholds")??[.5,.5,.5,.5];const e=G[0],f=G[1],c=G[2],d=G[3];G=y("featurelayer-simplify-payload-size-factors")??[1,2,4];const p=G[0],v=G[1],l=G[2],u=y("featurelayer-simplify-mobile-factor")??2,r=y("esri-mobile");y=function(){function A(m,t){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=
null;this._level=0;this.contextTimeReference=this._datetimeMetadata=null;this.instance=m;this._layerSchema=t}A.createInstance=function(){h++;return h=65535<h?0:h};var w=A.prototype;w.getAreaSimplificationThreshold=function(m,t){let B=1;const J=r?u:1;4E6<t?B=l*J:1E6<t?B=v*J:5E5<t?B=p*J:1E5<t&&(B=J);t=0;4E3<m?t=d*B:2E3<m?t=c*B:100<m?t=f:15<m&&(t=e);m=8;4>this._level?m=1:5>this._level?m=2:6>this._level&&(m=4);return t*m};w.createQuantizedExtrudedQuad=function(m,t){return new g([5],[m-1,t,1,-1,1,1,-1,
1,-1,-1])};w.setArcadeSpatialReference=function(m){this._arcadeSpatialReference=m};w.attachStorage=function(m){this._storage=m};w.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};w.getStorage=function(){return this._storage};w.getComputedNumeric=function(m){return this.getComputedNumericAtIndex(0)};w.setComputedNumeric=function(m,t){return this.setComputedNumericAtIndex(t,0)};w.getComputedString=function(m){return this.getComputedStringAtIndex(0)};w.setComputedString=
function(m,t){return this.setComputedStringAtIndex(0,t)};w.getComputedNumericAtIndex=function(m){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),m)};w.setComputedNumericAtIndex=function(m,t){this._storage.setComputedNumericAtIndex(this.getDisplayId(),m,t)};w.getComputedStringAtIndex=function(m){return this._storage.getComputedStringAtIndex(this.getDisplayId(),m)};w.setComputedStringAtIndex=function(m,t){return this._storage.setComputedStringAtIndex(this.getDisplayId(),m,t)};w.transform=
function(m,t,B,J){const C=this.copy();C._tx+=m;C._ty+=t;C._sx*=B;C._sy*=J;return C};w.readAttribute=function(m,t=!1){var B=this._readAttribute(m,t);if(void 0!==B)return B;for(const J of this._joined)if(J.setIndex(this.getIndex()),B=J._readAttribute(m,t),void 0!==B)return B};w.readAttributes=function(){const m=this._readAttributes();for(const t of this._joined){t.setIndex(this.getIndex());const B=t._readAttributes();for(const J of Object.keys(B))m[J]=B[J]}return m};w.joinAttributes=function(m){this._joined.push(m)};
w.readArcadeFeature=function(){return this};w.geometry=function(){var m=this.readHydratedGeometry();m=k.convertToGeometry(m,this.geometryType,this.hasZ,this.hasM);if(m=a.fromJSON(m))m.spatialReference=this._arcadeSpatialReference;return m};w.autocastArcadeDate=function(m,t){return t&&t instanceof Date?this.isUnknownDateTimeField(m)?F.ArcadeDate.unknownDateJSToArcadeDate(t):F.ArcadeDate.dateJSAndZoneToArcadeDate(t,this.contextTimeReference?.timeZone??"system"):t};w.isUnknownDateTimeField=function(m){return"unknown"===
this.dateTimeReferenceFieldIndex?.fieldTimeZone(m)};w.fieldSourceTimeZone=function(m){return this.dateTimeReferenceFieldIndex?.fieldTimeZone(m)??""};w.field=function(m){if(this.hasField(m))return this.autocastArcadeDate(m,this.readAttribute(m,!0));for(var t of this._joined)if(t.setIndex(this.getIndex()),t.hasField(m))return t=t._readAttribute(m,!0),this.autocastArcadeDate(m,t);throw Error(`Field ${m} does not exist`);};w.setField=function(m,t){throw Error("Unable to update feature attribute values, feature is readonly");
};w.keys=function(){return this.getFieldNames()};w.castToText=function(m=!1){if(!m)return JSON.stringify(this.readLegacyFeature());m=this.readLegacyFeature();if(!m)return JSON.stringify(null);m={geometry:m.geometry,attributes:{...(m.attributes??{})}};for(const t in m.attributes){const B=m.attributes[t];B instanceof Date&&(m.attributes[t]=B.getTime())}return JSON.stringify(m)};w.gdbVersion=function(){return null};w.fullSchema=function(){return this._layerSchema};w.castAsJson=function(m=null){return{attributes:this._readAttributes(),
geometry:!0===m?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}};w.castAsJsonAsync=function(m,t=null){return Promise.resolve(this.castAsJson(t))};w.removeIds=function(m){if(D.isNone(this._objectIdToIndex)){var t=new Map;const B=this.getCursor();for(;B.next();){const J=D.unwrapOrThrow(B.getObjectId());t.set(J,B.getIndex())}this._objectIdToIndex=t}t=this._objectIdToIndex;for(const B of m)t.has(B)&&this.removeAtIndex(t.get(B))};w.removeAtIndex=function(m){D.isNone(this._deleted)&&
(this._deleted=b.StaticBitSet.create(this.getSize()));this._deleted.set(m)};w.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};w.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};w.features=function*(){const m=this.getCursor();for(;m.next();)yield m.readOptimizedFeature()};w._getExists=function(){return D.isNone(this._deleted)||!this._deleted.has(this.getIndex())};w._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;
const m=this.readUnquantizedGeometry();if(!m||m.hasIndeterminateRingOrder)return null;const t=D.unwrapOr(this.getQuantizationTransform(),null);return x.getCentroidOptimizedGeometry(new g,m,this.hasM,this.hasZ,t)};w.copyInto=function(m){m.seen=this.seen;m._storage=this._storage;m._arcadeSpatialReference=this._arcadeSpatialReference;m._joined=this._joined;m._tx=this._tx;m._ty=this._ty;m._sx=this._sx;m._sy=this._sy;m._deleted=this._deleted;m._objectIdToIndex=this._objectIdToIndex};n._createClass(A,[{key:"isEmpty",
get:function(){return D.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(m){this._level=m}},{key:"dateTimeReferenceFieldIndex",get:function(){return this._datetimeMetadata?this._datetimeMetadata:this._datetimeMetadata=z.DateTimeReferenceFieldIndex.create(this._layerSchema.fields,this._layerSchema)}},{key:"layerPreferredTimeZone",get:function(){return this.dateTimeReferenceFieldIndex?.layerPreferredTimeZone??""}}]);return A}();q.FeatureSetReader=y;Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./executionError","../chunks/datetime"],function(q,n,G,F){function z(g){if(g instanceof F.Zone)return g;if("system"===g.toLowerCase())return"system";if("utc"===g.toLowerCase())return"utc";if("unknown"===g.toLowerCase())return y.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(g)){const b=F.FixedOffsetZone.parseSpecifier("UTC"+(g.startsWith("+")||g.startsWith("-")?
"":"+")+g);if(b)return b}g=F.IANAZone.create(g);if(!g.isValid)throw new x(q.ArcadeDateErrorCodes.TimeZoneNotRecognised);return g}let y=n._createClass(function(){});y.instance=new F.IANAZone("Etc/UTC");q.ArcadeDateErrorCodes=void 0;(q.ArcadeDateErrorCodes||(q.ArcadeDateErrorCodes={})).TimeZoneNotRecognised="TimeZoneNotRecognised";const D={[q.ArcadeDateErrorCodes.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};let x=function(g){function b(h,e){h=a.call(this,G.doSubstitutions(D[h],
e));h.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(n._assertThisInitialized(h),b);return h}n._inherits(b,g);var a=n._createSuper(b);return n._createClass(b)}(n._wrapNativeSuper(Error)),k=function(){function g(a){this._date=a;this.declaredRootClass="esri.arcade.arcadedate"}g.fromParts=function(a=0,h=1,e=1,f=0,c=0,d=0,p=0,v){if(isNaN(a)||isNaN(h)||isNaN(e)||isNaN(f)||isNaN(c)||isNaN(d)||isNaN(p))return null;let l=0;var u=F.DateTime.local(a,h).daysInMonth;
1>e&&(l=e-1,e=1);e>u&&(l=e-u,e=u);u=0;12<h?(u=h-12,h=12):1>h&&(u=h-1,h=1);let r=0;59<c?(r=c-59,c=59):0>c&&(r=c,c=0);let A=0;59<d?(A=d-59,d=59):0>d&&(A=d,d=0);let w=0;999<p?(w=p-999,p=999):0>p&&(w=p,p=0);a=F.DateTime.fromObject({day:e,year:a,month:h,hour:f,minute:c,second:d,millisecond:p},{zone:z(v)});0!==u&&(a=a.plus({months:u}));0!==l&&(a=a.plus({days:l}));0!==r&&(a=a.plus({minutes:r}));0!==A&&(a=a.plus({seconds:A}));0!==w&&(a=a.plus({milliseconds:w}));return new g(a)};g.arcadeDateAndZoneToArcadeDate=
function(a,h){const e=z(h);return a.isUnknownTimeZone||e===y.instance?g.fromParts(a.year,a.monthJS+1,a.day,a.hour,a.minute,a.second,a.millisecond,e):new g(a._date.setZone(h))};g.dateJSToArcadeDate=function(a){return new g(F.DateTime.fromJSDate(a,{zone:"system"}))};g.dateJSAndZoneToArcadeDate=function(a,h="system"){return new g(F.DateTime.fromJSDate(a,{zone:h}))};g.unknownEpochToArcadeDate=function(a){return new g(F.DateTime.fromMillis(a,{zone:y.instance}))};g.unknownDateJSToArcadeDate=function(a){return new g(F.DateTime.fromMillis(a.getTime(),
{zone:y.instance}))};g.epochToArcadeDate=function(a,h="system"){return new g(F.DateTime.fromMillis(a,{zone:h}))};g.dateTimeToArcadeDate=function(a){return new g(a)};var b=g.prototype;b.changeTimeZone=function(a){a=z(a);return g.dateTimeToArcadeDate(this._date.setZone(a))};g.dateTimeAndZoneToArcadeDate=function(a,h){h=z(h);return a.zone===y.instance||h===y.instance?g.fromParts(a.year,a.month,a.day,a.hour,a.minute,a.second,a.millisecond,h):new g(a.setZone(h))};g.nowToArcadeDate=function(a){return new g(F.DateTime.fromJSDate(new Date,
{zone:a}))};g.nowUTCToArcadeDate=function(){return new g(F.DateTime.utc())};b.equals=function(a){return this.isSystem&&a.isSystem?this.toNumber()===a.toNumber():this.isUnknownTimeZone!==a.isUnknownTimeZone?!1:this._date.equals(a._date)};b.stringify=function(){return JSON.stringify(this.toJSDate())};b.plus=function(a){return new g(this._date.plus(a))};b.diff=function(a,h="milliseconds"){return this._date.diff(a._date,h)[h]};b.toISOString=function(a){return a?this._date.toISO({suppressMilliseconds:!0,
includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})};b.toFormat=function(a,h){return this._date.toFormat(a,h)};b.toJSDate=function(){return this._date.toJSDate()};b.toSQLString=function(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"};b.toDateTime=function(){return this._date};b.toNumber=function(){return this._date.toMillis()};b.getTime=function(){return this._date.toMillis()};b.toUTC=function(){return new g(this._date.toUTC())};
b.toLocal=function(){return new g(this._date.toLocal())};b.toString=function(){return this.toISOString(!0)};n._createClass(g,[{key:"isSystem",get:function(){return"system"===this.timeZone||this.timeZone===g.systemTimeZoneCanonicalName}},{key:"isUnknownTimeZone",get:function(){return this._date.zone===y.instance}},{key:"isValid",get:function(){return this._date.isValid}},{key:"hour",get:function(){return this._date.hour}},{key:"second",get:function(){return this._date.second}},{key:"day",get:function(){return this._date.day}},
{key:"dayOfWeekISO",get:function(){return this._date.weekday}},{key:"dayOfWeekJS",get:function(){let a=this._date.weekday;6<a&&(a=0);return a}},{key:"millisecond",get:function(){return this._date.millisecond}},{key:"monthISO",get:function(){return this._date.month}},{key:"weekISO",get:function(){return this._date.weekNumber}},{key:"yearISO",get:function(){return this._date.weekYear}},{key:"monthJS",get:function(){return this._date.month-1}},{key:"year",get:function(){return this._date.year}},{key:"minute",
get:function(){return this._date.minute}},{key:"zone",get:function(){return this._date.zone}},{key:"timeZoneOffset",get:function(){return this.isUnknownTimeZone?0:this._date.offset}},{key:"timeZone",get:function(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const a=this.zone;return"fixed"===a.type?0===a.fixed?"utc":a.formatOffset(0,"short"):a.name}}],[{key:"systemTimeZoneCanonicalName",get:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}}]);return g}();q.ArcadeDate=k;q.ArcadeDateError=x;q.ArcadeDateErrorMessages=D;q.UnknownTimeZone=y;q.createDateTimeZone=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/arcadeTimeUtils":function(){define("exports ../chunks/_rollupPluginBabelHelpers ./ArcadeDate ../layers/support/FieldsIndex ../time/TimeReference ../chunks/datetime ../time/timeReferenceUtils".split(" "),function(q,n,G,F,z,y,D){function x(g){return g?.timeZoneIANA?g?.timeZoneIANA:g?.timeZone?D.convertLegacyTimeZone(g,
""):""}let k=function(){function g(){this.dateTimeReferenceMetaData=null;this._fieldTimeZoneIndex={};this._ianaLayerDateFields=this._ianaEditFields=this._ianaTimeInfo=this._ianaPreferred=this._fieldIndex=null}g.create=function(a,h){const e=new g;e.dateTimeReferenceMetaData=h;e._fieldIndex=a instanceof F?a:new F(a);return e};g.createFromLayer=function(a){if(!a)return null;if(!a.fieldsIndex)return!a.declaredClass&&a.fields?g.create(a.fields,a):null;const h=new g;h._fieldIndex=a.fieldsIndex;h.dateTimeReferenceMetaData=
{timeInfo:a?.timeInfo?.toJSON()??null,editFieldsInfo:a?.editFieldsInfo?.toJSON()??null,dateFieldsTimeReference:a?.dateFieldsTimeReference?.toJSON()??null,preferredTimeReference:a?.preferredTimeReference?.toJSON()??null,datesInUnknownTimezone:!0===a?.datesInUnknownTimezone};return h};var b=g.prototype;b.fieldTimeZone=function(a){a=this._fieldIndex?.get(a);if(!a||"date"!==a.type&&"esriFieldTypeDate"!==a.type)return null;var h=this._fieldTimeZoneIndex[a.name];if(void 0!==h)return h;h=[{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.creationDateField,
timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.editDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.startTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,
isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.endTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone}];for(var e of h)if(e.field===a.name)return e=this.convertToIANA(e.timeReference,e.isunknown),this._fieldTimeZoneIndex[a.name]=e;e=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone);
return this._fieldTimeZoneIndex[a.name]=e};b.convertToIANA=function(a,h){return h?"unknown":x(a)};n._createClass(g,[{key:"layerPreferredTimeZone",get:function(){if(null!==this._ianaPreferred)return this._ianaPreferred;this._ianaPreferred="";return this._ianaPreferred=this.convertToIANA(this.dateTimeReferenceMetaData?.preferredTimeReference,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}},{key:"layerTimeInfoTimeZone",get:function(){if(null!==this._ianaTimeInfo)return this._ianaTimeInfo;
this._ianaTimeInfo="";return this._ianaTimeInfo=this.convertToIANA(this.dateTimeReferenceMetaData?.timeInfo?.timeReference,!1)}},{key:"layerEditFieldsTimeZone",get:function(){if(null!==this._ianaEditFields)return this._ianaEditFields;this._ianaEditFields="";return this._ianaEditFields=this.convertToIANA(this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}},{key:"layerDateFieldsTimeZone",get:function(){if(null!==this._ianaLayerDateFields)return this._ianaLayerDateFields;
this._ianaLayerDateFields="";return this._ianaLayerDateFields=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}}]);return g}();q.DateTimeReferenceFieldIndex=k;q.convertTimeReference=function(g){if(!g)return null;g instanceof z&&(g=x(g.toJSON()));if(g instanceof y.Zone)return g;if("unknown"===g.toLowerCase())return G.UnknownTimeZone.instance;if("system"===g.toLowerCase())return y.SystemZone.instance;if("utc"===g.toLowerCase())return y.FixedOffsetZone.utcInstance;
if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(g)){const b=y.FixedOffsetZone.parseSpecifier("UTC"+(g.startsWith("+")||g.startsWith("-")?"":"+")+g);if(b)return b}g=y.IANAZone.create(g);if(!g.isValid)throw new G.ArcadeDateError(G.ArcadeDateErrorCodes.TimeZoneNotRecognised);return g};q.convertToIANA=x;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/time/TimeReference":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Clonable ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./timeReferenceUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h){G=function(e){function f(d){d=c.call(this,d);d.legacy=null;d.timeZone="system";return d}q._inherits(f,e);var c=q._createSuper(f);e=f.prototype;e.readLegacy=function(d,p){const {timeZone:v,respectsDaylightSaving:l}=p;return{timeZone:v,respectsDaylightSaving:l}};e.readTimeZone=function(d,p){return"timeZoneIANA"in p?p.timeZoneIANA:h.convertLegacyTimeZone(p)};e.writeTimeZone=function(d,p){p.timeZoneIANA=d};e.equals=function(d){return z.isNone(d)||z.isNone(this.timeZone)||
z.isNone(d.timeZone)?!1:this.timeZone===d.timeZone};return q._createClass(f)}(G.ClonableMixin(F.JSONSupport));n.__decorate([y.property()],G.prototype,"legacy",void 0);n.__decorate([g.reader("legacy",["timeZone"])],G.prototype,"readLegacy",null);n.__decorate([y.property({type:String,nonNullable:!0})],G.prototype,"timeZone",void 0);n.__decorate([g.reader("timeZone",["timeZone","timeZoneIANA","respectsDaylightSaving"])],G.prototype,"readTimeZone",null);n.__decorate([a.writer("timeZone")],G.prototype,
"writeTimeZone",null);return G=n.__decorate([b.subclass("esri.time.TimeReference")],G)})},"esri/core/Clonable":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./has ./lang ./Logger ./maybe ./accessorSupport/PropertyOrigin ./accessorSupport/utils ./accessorSupport/decorators/subclass".split(" "),function(q,n,G,F,z,y,D,x,k,g,b){z=a=>{a=function(h){function e(){return f.apply(this,arguments)}n._inherits(e,h);var f=n._createSuper(e);e.prototype.clone=function(){var c=
x.unwrapOrThrow(g.getProperties(this),"unable to clone instance of non-accessor class"),d=c.metadatas;const p=c.store,v={};c=new Map;for(var l in d){var u=d[l];const r=p?.originOf(l),A=u.clonable;if(u.readOnly||!1===A||r!==k.OriginId.USER&&r!==k.OriginId.DEFAULTS&&r!==k.OriginId.WEB_MAP&&r!==k.OriginId.WEB_SCENE)continue;u=this[l];let w=null;w="function"===typeof A?A(u):"reference"===A?u:y.tryClone(u);if(null==u||null!=w)r===k.OriginId.DEFAULTS?c.set(l,w):v[l]=w}d=new (Object.getPrototypeOf(this).constructor)(v);
if(c.size&&(l=g.getProperties(d)?.store))for(const [r,A]of c)l.set(r,A,k.OriginId.DEFAULTS);return d};return n._createClass(e)}(a);return a=G.__decorate([b.subclass("esri.core.Clonable")],a)};q.Clonable=function(a){function h(){return e.apply(this,arguments)}n._inherits(h,a);var e=n._createSuper(h);return n._createClass(h)}(z(F));q.Clonable=G.__decorate([b.subclass("esri.core.Clonable")],q.Clonable);q.ClonableMixin=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/time/timeReferenceUtils":function(){define(["exports",
"./legacyTimeZoneMap","../chunks/datetime"],function(q,n,G){q.convertLegacyTimeZone=function(F,z="system"){if(!F||!n.legacyTimeZoneMap.has(F.timeZone))return z;z=n.legacyTimeZoneMap.get(F.timeZone);if(F.timeZone.startsWith("UTC")||F.respectsDaylightSaving)return z;F=G.DateTime.local().setZone(z);F=Math.min(F.set({month:1,day:1}).offset,F.set({month:5}).offset);F=0===F?"Etc/UTC":`Etc/GMT${G.FixedOffsetZone.instance(-F).formatOffset(0,"narrow")}`;return F};Object.defineProperty(q,Symbol.toStringTag,
{value:"Module"})})},"esri/time/legacyTimeZoneMap":function(){define(["exports"],function(q){const n=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time",
"America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time",
"Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Almaty"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)",
"America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)",
"America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time",
"Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],
["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Chihuahua"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],
["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],
["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time",
"Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time",
"America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05",
"Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],
["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],
["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);q.legacyTimeZoneMap=n;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(q,n){function G(z,y,D,x,k,g,b=1){g=k?g?4:3:g?3:2;let a=D,h=D+g,e=0,f=0,c=D=0,d=0;for(let p=0,v=x-1;p<v;p++,a+=g,h+=g){x=y[a];const l=y[a+1],u=y[a+2],r=y[h],A=y[h+1],w=y[h+2];let m=x*A-r*l;c+=m;e+=(x+r)*m;f+=(l+A)*m;k&&(m=x*w-r*u,D+=(u+w)*
m,d+=m);x<z[0]&&(z[0]=x);x>z[1]&&(z[1]=x);l<z[2]&&(z[2]=l);l>z[3]&&(z[3]=l);k&&(u<z[4]&&(z[4]=u),u>z[5]&&(z[5]=u))}0<c*b&&(c*=-1);0<d*b&&(d*=-1);if(!c)return null;z=[e,f,.5*c];k&&(z[3]=D,z[4]=.5*d);return z}function F(z,y,D,x,k){k=x?k?4:3:k?3:2;let g=y,b=y+k,a=0,h=0,e=0,f=0;for(let v=0,l=D-1;v<l;v++,g+=k,b+=k){var c=z[g];const u=z[g+1],r=z[g+2],A=z[b],w=z[b+1],m=z[b+2];if(x){var d=A-c;var p=w-u;const t=m-r;d=Math.sqrt(d*d+p*p+t*t)}else d=A-c,p=w-u,d=Math.sqrt(d*d+p*p);d&&(a+=d,x?(c=[c+.5*(A-c),u+
.5*(w-u),r+.5*(m-r)],h+=d*c[0],e+=d*c[1],f+=d*c[2]):(c=[c+.5*(A-c),u+.5*(w-u)],h+=d*c[0],e+=d*c[1]))}return 0<a?x?[h/a,e/a,f/a]:[h/a,e/a]:0<D?x?[z[y],z[y+1],z[y+2]]:[z[y],z[y+1]]:null}q.getCentroidOptimizedGeometry=function(z,y,D,x,k){if(n.isNone(y)||!y.lengths.length)return null;const g="upperLeft"===k?.originPosition?-1:1;z.lengths.length&&(z.lengths.length=0);z.coords.length&&(z.coords.length=0);k=z.coords;const b=[],a=D?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:h,coords:e}=y,f=D?x?4:3:x?3:2;let c=0;for(var d of h){const p=G(a,e,c,d,D,x,g);p&&b.push(p);c+=d*f}b.sort((p,v)=>{let l=g*p[2]-g*v[2];0===l&&D&&(l=p[4]-v[4]);return l});b.length&&(d=6*b[0][2],k[0]=b[0][0]/d,k[1]=b[0][1]/d,D&&(d=6*b[0][4],k[2]=0!==d?b[0][3]/d:0),k[0]<a[0]||k[0]>a[1]||k[1]<a[2]||k[1]>a[3]||D&&(k[2]<
a[4]||k[2]>a[5]))&&(k.length=0);if(!k.length)if(y=y.lengths[0]?F(e,0,h[0],D,x):null)k[0]=y[0],k[1]=y[1],D&&2<y.length&&(k[2]=y[2]);else return null;return z};q.lineCentroid=F;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(q,n){let G=function(){function F(y,D){this._mask=0;this._buf=y;this._mask=D}F.fromBuffer=function(y,D){return new F(y,D)};
F.create=function(y,D=4294967295){y=new Uint32Array(Math.ceil(y/32));return new F(y,D)};var z=F.prototype;z._getIndex=function(y){return Math.floor(y/32)};z.has=function(y){y&=this._mask;return!!(this._buf[this._getIndex(y)]&1<<y%32)};z.hasRange=function(y,D){for(;y%32&&y!==D;){if(this.has(y))return!0;y++}for(;D%32&&y!==D;){if(this.has(y))return!0;D--}if(y===D)return!1;for(y/=32;y!==D/32;y++)if(this._buf[y])return!0;return!1};z.set=function(y){y&=this._mask;const D=this._getIndex(y);this._buf[D]|=
1<<y%32};z.setRange=function(y,D){for(;y%32&&y!==D;)this.set(y++);for(;D%32&&y!==D;)this.set(D--);if(y!==D)for(y/=32;y!==D/32;y++)this._buf[y]=4294967295};z.unset=function(y){y&=this._mask;const D=this._getIndex(y);this._buf[D]&=4294967295^1<<y%32};z.resize=function(y){const D=this._buf;y=new Uint32Array(Math.ceil(y/32));y.set(D);this._buf=y};z.or=function(y){for(let D=0;D<this._buf.length;D++)this._buf[D]|=y._buf[D];return this};z.and=function(y){for(let D=0;D<this._buf.length;D++)this._buf[D]&=
y._buf[D];return this};z.xor=function(y){for(let D=0;D<this._buf.length;D++)this._buf[D]^=y._buf[D];return this};z.ior=function(y){for(let D=0;D<this._buf.length;D++)this._buf[D]|=~y._buf[D];return this};z.iand=function(y){for(let D=0;D<this._buf.length;D++)this._buf[D]&=~y._buf[D];return this};z.ixor=function(y){for(let D=0;D<this._buf.length;D++)this._buf[D]^=~y._buf[D];return this};z.any=function(){for(let y=0;y<this._buf.length;y++)if(this._buf[y])return!0;return!1};z.copy=function(y){for(let D=
0;D<this._buf.length;D++)this._buf[D]=y._buf[D];return this};z.clone=function(){return new F(this._buf.slice(),this._mask)};z.clear=function(){for(let y=0;y<this._buf.length;y++)this._buf[y]=0};z.forEachSet=function(y){for(let D=0;D<this._buf.length;D++){let x=this._buf[D],k=32*D;if(x)for(;x;)x&1&&y(k),x>>>=1,k++}};z.countSet=function(){let y=0;this.forEachSet(D=>{y++});return y};return n._createClass(F)}();q.StaticBitSet=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/createSource":function(){define("exports ../../../../../core/maybe ../../../../../layers/support/arcgisLayerUrl ./DrillDownFeatureSource ./PagedFeatureSource ./SnapshotFeatureSource ./StreamSource".split(" "),
function(q,n,G,F,z,y,D){q.createSource=function(x,k,g,b,a,h){a:{switch(x.type){case "snapshot":x={type:"feature",origin:"snapshot",featureCount:n.unwrapOr(x.featureCount,0),serviceInfo:x,onMessage:b,outSR:k,tileInfoView:g,canAcceptRequest:a,store:h};break a;case "stream":x={type:"stream",serviceInfo:x,onMessage:b,outSR:k,canAcceptRequest:a};break a;case "memory":case "on-demand":h=x.source;h=Array.isArray(h)?"local":"path"in h&&G.isHostedAgolService(h.path)?"hosted":"unknown";x={type:"feature",serviceInfo:x,
onMessage:b,outSR:k,origin:h,tileInfoView:g,canAcceptRequest:a};break a}x=void 0}switch(x.type){case "feature":switch(x.origin){case "hosted":case "local":return new z.PagedFeatureSource(x);case "snapshot":return new y.SnapshotFeatureSource(x);default:case "unknown":return new F.DrillDownFeatureSource(x)}case "stream":return new D.StreamSource(x)}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/maybe","../../core/urlUtils",
"../../chunks/persistableUrlUtils"],function(q,n,G,F){function z(h){if(n.isNone(h))return null;h=G.urlToObject(h);h=h.path.match(g)||h.path.match(b);if(!h)return null;const [,e,f,c,d]=h;h=f.indexOf("/");return{title:D(-1!==h?f.slice(h+1):f),serverType:x[c.toLowerCase()],sublayer:null!=d&&""!==d?parseInt(d,10):null,url:{path:e}}}function y(h){return(h=G.urlToObject(h).path.match(a))?{serviceUrl:h[1],sublayerId:Number(h[2])}:null}function D(h){h=h.replace(/\s*[/_]+\s*/g," ");return h[0].toUpperCase()+
h.slice(1)}const x={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},k=Object.values(x),g=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${k.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),b=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${k.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),a=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;q.cleanTitle=D;q.isArcGISUrl=
function(h){return!!g.test(h)};q.isHostedAgolService=function(h){if(!h)return!1;h=h.toLowerCase();const e=h.includes(".arcgis.com/");h=h.includes("//services")||h.includes("//tiles")||h.includes("//features");return e&&h};q.isServerOrServicesAGOLUrl=function(h){if(!h)return!1;h=(new G.Url(G.makeAbsolute(h))).authority?.toLowerCase();return"server.arcgisonline.com"===h||"services.arcgisonline.com"===h};q.isWmsServer=function(h){if(!h)return!1;var e=h.toLowerCase();h=e.includes("/services/");const f=
e.includes("/mapserver/wmsserver"),c=e.includes("/imageserver/wmsserver");e=e.includes("/wmsserver");return h&&(f||c||e)};q.parse=z;q.parseNonStandardSublayerUrl=y;q.sanitizeUrl=function(h,e){return h?G.removeTrailingSlash(G.removeQueryParameters(h,e)):h};q.sanitizeUrlWithLayerId=function(h){let {url:e}=h;if(!e)return{url:e};e=G.removeQueryParameters(e,h.logger);const f=G.urlToObject(e),c=z(f.path);let d=void 0;n.isSome(c)?(null!=c.sublayer&&null==h.layer.layerId&&(d=c.sublayer),e=c.url.path):h.nonStandardUrlAllowed&&
(h=y(f.path),n.isSome(h)&&(e=h.serviceUrl,d=h.sublayerId));return{url:G.removeTrailingSlash(e),layerId:d}};q.serverTypes=k;q.titleFromUrlAndName=function(h,e){const f=[];h&&(h=z(h),n.isSome(h)&&h.title&&f.push(h.title));e&&(e=D(e),f.push(e));if(2===f.length){if(f[0].toLowerCase().includes(f[1].toLowerCase()))return f[0];if(f[1].toLowerCase().includes(f[0].toLowerCase()))return f[1]}return f.join(" - ")};q.writeUrlWithLayerId=function(h,e,f,c,d){F.write(e,c,"url",d);c.url&&null!=h.layerId&&(c.url=
G.join(c.url,f,h.layerId.toString()))};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../core/maybe","../core/urlUtils"],function(q,n,G){function F(f,c){var d=c&&c.url&&c.url.path;f&&d&&(f=G.makeAbsolute(f,d,{preserveProtocolRelative:!0}),c.portalItem&&c.readResourcePaths&&(d=G.makeRelative(f,c.portalItem.itemUrl),null!=d&&h.test(d)&&c.readResourcePaths.push(c.portalItem.resourceFromPath(d).path)));return b(f,c&&c.portal)}
function z(f,c,d=q.MarkKeep.YES){if(null==f)return f;!G.isAbsolute(f)&&c&&c.blockedRelativeUrls&&c.blockedRelativeUrls.push(f);let p=G.makeAbsolute(f);if(c){var v=c.verifyItemRelativeUrls&&c.verifyItemRelativeUrls.rootPath||c.url&&c.url.path;if(v){v=b(v,c.portal);const l=b(p,c.portal);p=G.makeRelative(l,v,v);null!=p&&p!==l&&p!==f&&c.verifyItemRelativeUrls&&c.verifyItemRelativeUrls.writtenUrls.push(p)}}p=g(p,c?.portal);G.isAbsolute(p)&&(p=G.normalize(p));c?.resources&&c?.portalItem&&!G.isAbsolute(p)&&
!G.isDataProtocol(p)&&d===q.MarkKeep.YES&&c.resources.toKeep.push({resource:c.portalItem.resourceFromPath(p),compress:!1});return p}function y(f,c,d){return F(f,d)}function D(f,c,d,p){f=z(f,p);void 0!==f&&(c[d]=f)}function x(f){return(f?.match(a)??null)?.[1]??null}function k(f){f=f?.match(a)??null;if(null==f)return null;f=f[2];const c=f.lastIndexOf("/");if(-1===c){const {path:v,extension:l}=G.splitPathExtension(f);return{prefix:null,filename:v,extension:n.unwrap(l)}}const {path:d,extension:p}=G.splitPathExtension(f.slice(c+
1));return{prefix:f.slice(0,c),filename:d,extension:n.unwrap(p)}}function g(f,c){return c&&!c.isPortal&&c.urlKey&&c.customBaseUrl?G.changeDomain(f,`${c.urlKey}.${c.customBaseUrl}`,c.portalHostname):f}function b(f,c){if(!c||c.isPortal||!c.urlKey||!c.customBaseUrl)return f;const d=`${c.urlKey}.${c.customBaseUrl}`,p=G.getAppUrl();return G.hasSameOrigin(p,`${p.scheme}://${d}`)?G.changeDomain(f,c.portalHostname,d):G.changeDomain(f,d,c.portalHostname)}const a=/\/items\/([^\/]+)\/resources\/(.*)/,h=/^\.\/resources\//;
q.MarkKeep=void 0;(function(f){f[f.YES=0]="YES";f[f.NO=1]="NO"})(q.MarkKeep||(q.MarkKeep={}));const e=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return q.MarkKeep},ensureMainOnlineDomain:g,fromJSON:F,itemIdFromResourceUrl:x,prefixAndFilenameFromResourceUrl:k,read:y,toJSON:z,write:D},Symbol.toStringTag,{value:"Module"}));q.ensureMainOnlineDomain=g;q.fromJSON=F;q.itemIdFromResourceUrl=x;q.persistableUrlUtils=e;q.prefixAndFilenameFromResourceUrl=k;q.read=y;q.toJSON=z;q.write=
D})},"esri/views/2d/layers/features/sources/DrillDownFeatureSource":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/has","../../../../../core/promiseUtils","./BaseFeatureSource"],function(q,n,G,F,z){var y=(G=G("esri-mobile"))?1:4,D=G?1:3;z=function(x){function k(b){return g.call(this,b)}n._inherits(k,x);var g=n._createSuper(k);k.prototype._fetchDataTile=async function(b){const a=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,h=
this._subscriptions.get(b.key.id),e=h.signal,f=b.getQuantizationParameters();let c=0;const d=async(p,v)=>{const l=this._queryInfo,u=this.createTileQuery(p,{maxRecordCountFactor:a?D:void 0,returnExceededLimitFeatures:!1,quantizationParameters:f});c++;try{const A=await this.enqueueQuery({tile:b,query:u,signal:e,depth:v});c--;F.throwIfAborted(e);if(A)if(l!==this._queryInfo)d(p,v);else if(A.exceededTransferLimit&&v<y)for(const w of p.createChildTiles())d(w,v+1);else{var r={id:b.id,addOrUpdate:A,end:0===
c,type:"append"};h.add({query:u,message:r});this._onMessage(r)}}catch(A){F.isAbortError(A)||this._onMessage({id:b.id,addOrUpdate:null,end:!0,type:"append"})}};d(b,0)};return n._createClass(k)}(z.BaseFeatureSource);q.DrillDownFeatureSource=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/BaseFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../request ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../controllers/support/sourceAdapters ./DataTileSource ../../../../support/QueueProcessor".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b){g=function(a){function h(f){var c=e.call(this,f);c.type="feature";c.mode="on-demand";c._adapter=k.createSourceAdapter(f.serviceInfo);c._queue=new b.QueueProcessor({concurrency:8,process:async d=>{x.throwIfAborted(d);if(D.isSome(d.tile)){var p=d.tile.key.id,{signal:v}=d;p=z("esri-tiles-debug")?{tile:p.replace(/\//g,"."),depth:d.depth}:void 0;v=await c._adapter.executeQuery(d.query,{signal:v,query:{...p,...c._schema?.customParameters}});v.level=d.tile.key.level;return v}return c._adapter.executeQuery(d.query,
{...d,query:c._schema?.customParameters})}});c._patchQueue=new b.QueueProcessor({concurrency:8,process:async d=>{x.throwIfAborted(d);if(D.isSome(d.tile)){var p=d.tile.key.id,{signal:v}=d;p=z("esri-tiles-debug")?{tile:p.replace(/\//g,"."),depth:d.depth}:void 0;v=await c._adapter.executeQuery(d.query,{signal:v,query:{...p,...c._schema?.customParameters}});v.level=d.tile.key.level;return v}return c._adapter.executeQuery(d.query,{...d,query:c._schema?.customParameters})}});return c}n._inherits(h,a);var e=
n._createSuper(h);a=h.prototype;a.destroy=function(){n._get(n._getPrototypeOf(h.prototype),"destroy",this).call(this);this._adapter.destroy();this._queue.destroy();this._patchQueue.destroy()};a.enqueueQuery=function(f,c){return this.updatingHandles.addPromise(this._queue.push(f,c))};a.enqueuePatchQuery=function(f,c){return this.updatingHandles.addPromise(this._patchQueue.push(f,c))};a.enableEvent=function(f,c){};a.subscribe=function(f,c){n._get(n._getPrototypeOf(h.prototype),"subscribe",this).call(this,
f,c);this._fetchDataTile(f).catch(d=>{x.isAbortError(d)||y.getLogger("esri.views.2d.layers.features.sources.BaseFeatureSource").error(new F("mapview-query-error","Encountered error when fetching tile",{tile:f,error:d}))})};a.unsubscribe=function(f){n._get(n._getPrototypeOf(h.prototype),"unsubscribe",this).call(this,f)};a.readers=function(f){return this._subscriptions.get(f).readers()};a.query=async function(f,c={}){return this._adapter.executeQuery(f,{...c,query:{...(c.query??{}),...this._schema?.customParameters}})};
a.queryLastEditDate=async function(){const f=this._serviceInfo.source;return(await G(f.path,{query:{...f.query,f:"json"},responseType:"json"})).data.editingInfo.lastEditDate};a.createTileQuery=function(f,c={}){const d=this._serviceInfo.geometryType,p=this.createQuery(c);p.quantizationParameters=c.quantizationParameters??f.getQuantizationParameters();p.resultType="tile";p.geometry=f.extent;if(this._serviceInfo.capabilities.query.supportsQuantization)"esriGeometryPolyline"===d&&(p.maxAllowableOffset=
f.resolution*z("feature-polyline-generalization-factor"));else if("esriGeometryPolyline"===d||"esriGeometryPolygon"===d)p.maxAllowableOffset=f.resolution,"esriGeometryPolyline"===d&&(p.maxAllowableOffset*=z("feature-polyline-generalization-factor"));f=this._serviceInfo.capabilities.query;p.defaultSpatialReferenceEnabled=f.supportsDefaultSpatialReference;p.compactGeometryEnabled=f.supportsCompactGeometry;return p};a._executePatchQuery=async function(f,c,d,p){c=c.clone();c.outFields=[this._serviceInfo.objectIdField,
...d];c.returnCentroid=!1;c.returnGeometry=!1;d=D.isSome(c.start)?c.start/8E3:0;return await this.enqueuePatchQuery({tile:f,query:c,signal:p.signal,depth:d})};a._resend=async function(f,c){const {query:d,message:p}=f,v=D.isSome(d.outFields)?d.outFields:[];f=this._queryInfo.outFields;const l=f.filter(u=>!v.includes(u));if(D.isNone(p.addOrUpdate))this._onMessage({...p,type:"append"});else if(l.length)try{const u=this._subscriptions.get(p.id).tile,r=await this._executePatchQuery(u,d,l,c);x.throwIfAborted(c);
d.outFields=f;p.addOrUpdate.joinAttributes(r);this._onMessage({...p,end:p.end,type:"append"})}catch(u){}else this._onMessage({...p,type:"append"})};a._resendSubscription=async function(f){z("esri-2d-update-debug")&&console.debug(f.tile.id,"Resend Subscription");if(f.empty)return this._onMessage({id:f.tile.id,addOrUpdate:null,end:!1,type:"append"});const c=f.signal;for(const d of f.requests.done)await this._resend(d,{signal:c});if(D.isSome(f.edits))return this._onMessage(f.edits)};a.resend=async function(){const f=
Array.from(this._subscriptions.values());await Promise.all(f.map(c=>this._resendSubscription(c)))};n._createClass(h,[{key:"maxRecordCountFactor",get:function(){const {query:f}=this._serviceInfo.capabilities;return f.supportsMaxRecordCountFactor?4:null}},{key:"maxPageSize",get:function(){var {query:f}=this._serviceInfo.capabilities;f=f.maxRecordCount??8E3;const c=D.unwrapOr(this.maxRecordCountFactor,1);return f*c}},{key:"pageSize",get:function(){return Math.min(8E3,this.maxPageSize)}}]);return h}(g.DataTileSource);
q.BaseFeatureSource=g;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/controllers/support/sourceAdapters":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/workers/Connection ../../../../../../geometry/support/quantizationUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../layers/ogc/ogcFeatureUtils ../../../../../../rest/query/operations/query ../../support/FeatureSetReaderJSON ../../support/FeatureSetReaderPBF".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b){async function a(p){const v=new z;await v.open(p,{});return v}let h=function(){function p(v){this.service=v}p.prototype.destroy=function(){};return n._createClass(p)}(),e=function(p){function v(u){var r=l.call(this,u);r._portsOpen=a(u.source).then(A=>r.client=A);return r}n._inherits(v,p);var l=n._createSuper(v);p=v.prototype;p.destroy=function(){this.client.close();this.client=null};p.executeQuery=async function(u,r){await this._portsOpen;u=await this.client.invoke("queryFeatures",
u.toJSON(),r);return g.FeatureSetReaderJSON.fromFeatureSet(u,this.service)};return n._createClass(v)}(h),f=function(p){function v(){return l.apply(this,arguments)}n._inherits(v,p);var l=n._createSuper(v);v.prototype.executeQuery=async function(u,r){({data:r}=await k.executeQueryPBFBuffer(this.service.source,u,r));return b.FeatureSetReaderPBF.fromBuffer(r,this.service,!u.quantizationParameters)};return n._createClass(v)}(h),c=function(p){function v(){return l.apply(this,arguments)}n._inherits(v,p);
var l=n._createSuper(v);v.prototype.executeQuery=async function(u,r){const {source:A,capabilities:w,spatialReference:m,objectIdField:t,geometryType:B}=this.service;if(F.isSome(u.quantizationParameters)&&!w.query.supportsQuantization){const J=u.clone();u=y.toQuantizationTransform(F.unwrap(J.quantizationParameters));J.quantizationParameters=null;({data:r}=await k.executeQuery(A,J,m,r));r=D.convertFromFeatureSet(r,t);D.quantizeOptimizedFeatureSet(u,r);return g.FeatureSetReaderJSON.fromOptimizedFeatureSet(r,
this.service)}({data:u}=await k.executeQuery(A,u,this.service.spatialReference,r));"esriGeometryPoint"===B&&(u.features=u.features?.filter(J=>F.isSome(J.geometry)?(J=J.geometry,Number.isFinite(J.x)&&Number.isFinite(J.y)):!0));return g.FeatureSetReaderJSON.fromFeatureSet(u,this.service)};return n._createClass(v)}(h),d=function(p){function v(){return l.apply(this,arguments)}n._inherits(v,p);var l=n._createSuper(v);v.prototype.executeQuery=async function(u,r){var {capabilities:A}=this.service;if(u.quantizationParameters&&
!A.query.supportsQuantization){const w=u.clone();A=y.toQuantizationTransform(F.unwrap(w.quantizationParameters));w.quantizationParameters=null;u=await x.queryOptimizedFeatureSet(this.service.source,u,r);D.quantizeOptimizedFeatureSet(A,u);return g.FeatureSetReaderJSON.fromOptimizedFeatureSet(u,this.service)}u=await x.queryOptimizedFeatureSet(this.service.source,u,r);return g.FeatureSetReaderJSON.fromOptimizedFeatureSet(u,this.service)};return n._createClass(v)}(h);q.SourceAdapter=h;q.createSourceAdapter=
function(p){const {capabilities:v}=p;return"ogc-source"===p.source?.type?new d(p):Array.isArray(p.source)?new e(p):v.query.supportsFormatPBF&&G("featurelayer-pbf")?new f(p):new c(p)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/workers/Connection":function(){define("../../chunks/_rollupPluginBabelHelpers ../handleUtils ../Logger ../promiseUtils ../Queue ./RemoteClient".split(" "),function(q,n,G,F,z,y){return function(){function D(){this._inUseClients=[];this._clients=
[];this._clientPromises=[];this._ongoingJobsQueue=new z}var x=D.prototype;x.destroy=function(){this.close()};x.open=function(k,g){return new Promise((b,a)=>{let h=!0;const e=f=>{F.throwIfAborted(g.signal);h&&(h=!1,f())};this._clients.length=k.length;this._clientPromises.length=k.length;this._inUseClients.length=k.length;for(let f=0;f<k.length;++f){const c=k[f];F.isPromiseLike(c)?this._clientPromises[f]=c.then(d=>{this._clients[f]=new y(d,g,()=>this._ongoingJobsQueue.pop()??null);e(b);return this._clients[f]},
()=>{e(a);return null}):(this._clients[f]=new y(c,g,()=>this._ongoingJobsQueue.pop()??null),this._clientPromises[f]=Promise.resolve(this._clients[f]),e(b))}})};x.broadcast=function(k,g,b){const a=Array(this._clientPromises.length);for(let h=0;h<this._clientPromises.length;++h)a[h]=this._clientPromises[h].then(e=>e?.invoke(k,g,b));return a};x.close=function(){let k;for(;k=this._ongoingJobsQueue.pop();)k.deferred.reject(F.createAbortError(`Worker closing, aborting job calling '${k.methodName}'`));for(const g of this._clientPromises)g.then(b=>
b?.close());this._clients.length=0;this._clientPromises.length=0;this._inUseClients.length=0};x.invoke=function(k,g,b){let a;Array.isArray(b)?(G.getLogger("esri.core.workers.Connection").warn("invoke()","The transferList parameter is deprecated, use the options object instead"),a={transferList:b}):a=b;b=F.createDeferred();this._ongoingJobsQueue.push({methodName:k,data:g,invokeOptions:a,deferred:b});for(k=0;k<this._clientPromises.length;k++)(g=this._clients[k])?g.jobAdded():this._clientPromises[k].then(h=>
h?.jobAdded());return b.promise};x.on=function(k,g){return Promise.all(this._clientPromises).then(()=>n.handlesGroup(this._clients.map(b=>b.on(k,g))))};x.openPorts=function(){return new Promise(k=>{const g=Array(this._clientPromises.length);let b=g.length;for(let a=0;a<this._clientPromises.length;++a)this._clientPromises[a].then(h=>{h&&(g[a]=h.openPort());0===--b&&k(g)})})};q._createClass(D,[{key:"closed",get:function(){return!this._clients||!this._clients.length}},{key:"test",get:function(){return{numClients:this._clients.length}}}]);
return D}()})},"esri/core/Queue":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(q,n){return function(){function G(z=y=>y.values().next().value){this._peeker=z;this._items=new Set}var F=G.prototype;F.clear=function(){this._items.clear()};F.last=function(){if(0!==this._items.size){for(var z of this._items);return z}};F.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};F.push=function(z){this.contains(z)||this._items.add(z)};F.contains=function(z){return this._items.has(z)};
F.pop=function(){if(0!==this.length){var z=this.peek();this._items.delete(n.assumeNonNull(z));return z}};F.popLast=function(){if(0!==this.length){var z=this.last();this._items.delete(n.assumeNonNull(z));return z}};F.remove=function(z){this._items.delete(z)};F.filter=function(z){this._items.forEach(y=>{z(y)||this._items.delete(y)});return this};q._createClass(G,[{key:"length",get:function(){return this._items.size}}]);return G}()})},"esri/layers/ogc/ogcFeatureUtils":function(){define("exports ../../geometry ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../graphics/featureConversionUtils ../graphics/OptimizedFeatureSet ../graphics/sources/geojson/geojson ../graphics/sources/support/clientSideDefaults ../support/FieldsIndex ../support/fieldType ../../geometry/SpatialReference".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f){async function c(m,t,B){const {collection:J,layerDefinition:C,maxRecordCount:K,queryParameters:{apiKey:E,customParameters:I},spatialReference:H,supportedCrs:N}=m;({links:m}=J);var U=A(m,"items","application/geo+json")||A(m,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(y.isNone(U))throw new F("ogc-feature-layer:missing-items-page","Missing items url");const {geometry:ba,num:la,start:aa,timeExtent:ka,where:V}=t;if(t.objectIds)throw new F("ogc-feature-layer:query-by-objectids-not-supported",
"Queries with objectids are not supported");m=f.fromJSON(H);t=y.unwrapOr(t.outSpatialReference,m);m=t.isWGS84?null:d(t,N);var P=u(ba,N);const S=v(ka),X=l(V);({data:U}=await G(U.href,{...B,query:{...I,...P,crs:m,datetime:S,query:X,limit:la??(null!=aa&&void 0!==aa?10:K),startindex:aa,token:E},headers:{accept:"application/geo+json"}}));B=!1;U.links&&(B=!!U.links.find(M=>"next"===M.rel));!B&&Number.isInteger(U.numberMatched)&&Number.isInteger(U.numberReturned)&&(B=U.numberReturned<U.numberMatched);const {fields:ra,
geometryType:Y,hasZ:ua,objectIdField:ca}=C;U=b.createOptimizedFeatures(U,{geometryType:Y,hasZ:ua,objectIdField:ca});if(!m&&t.isWebMercator)for(var ia of U)y.isSome(ia.geometry)&&null!=Y&&(P=k.convertToGeometry(ia.geometry,Y,ua,!1),P.spatialReference=f.WGS84,ia.geometry=k.convertFromGeometry(x.project(P,t)));for(var oa of U)oa.objectId=oa.attributes[ca];ia=m||!m&&t.isWebMercator?t.toJSON():D.WGS84;oa=new g;oa.exceededTransferLimit=B;oa.features=U;oa.fields=ra;oa.geometryType=Y;oa.hasZ=ua;oa.objectIdFieldName=
ca;oa.spatialReference=ia;return oa}function d(m,t){const {isWebMercator:B,wkid:J}=m;return J?(m=B?t[3857]??t[102100]??t[102113]??t[900913]:t[m.wkid])?`${"http://www.opengis.net/def/crs/"}${m}`:null:null}function p(m){if(y.isNone(m))return"";const {xmin:t,ymin:B,xmax:J,ymax:C}=m;return`${t},${B},${J},${C}`}function v(m){if(y.isNone(m))return null;const {start:t,end:B}=m;return`${y.isSome(t)?t.toISOString():".."}/${y.isSome(B)?B.toISOString():".."}`}function l(m){return y.isNone(m)||!m||"1\x3d1"===
m?null:m}function u(m,t){if(!y.isSome(m)||"extent"!==m.type)return null;const {spatialReference:B}=m;if(!B||B.isWGS84)return{bbox:p(m)};t=d(B,t);return y.isSome(t)?{bbox:p(m),"bbox-crs":t}:B.isWebMercator?{bbox:p(x.project(m,f.WGS84))}:null}function r(m){m=m.extent?.spatial;if(!m)return null;var t=m.bbox[0],B=4===t.length;m=t[0];const J=t[1],C=B?void 0:t[2],K=B?t[2]:t[3],E=B?t[3]:t[4];t=B?void 0:t[5];B=f.WGS84.toJSON();return{xmin:m,ymin:J,xmax:K,ymax:E,zmin:C,zmax:t,spatialReference:B}}function A(m,
t,B){return m.find(J=>J.rel===t&&J.type===B)||m.find(J=>J.rel===t&&!J.type)}const w=z.getLogger("esri.layers.graphics.sources.ogcfeature");q.crsDefault="http://www.opengis.net/def/crs/OGC/1.3/CRS84";q.crsPrefix="http://www.opengis.net/def/crs/";q.getCollectionDefinition=async function(m,t,B={},J=5){var {links:C}=m;C=A(C,"items","application/geo+json")||A(C,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if(y.isNone(C))throw new F("ogc-feature-layer:missing-items-page","Missing items url");
({data:B}=await G(C.href,{signal:B.signal,query:{limit:J,...B.customParameters,token:B.apiKey},headers:{accept:"application/geo+json"}}));await b.validateGeoJSON(B);const K=b.inferLayerProperties(B,{geometryType:t.geometryType});B=t.fields||K.fields||[];J=null!=t.hasZ?t.hasZ:K.hasZ;C=K.geometryType;const E=t.objectIdField||K.objectIdFieldName||"OBJECTID";t=t.timeInfo;var I=B.find(({name:N})=>N===E);if(I)I.editable=!1,I.nullable=!1;else{if(!K.objectIdFieldType)throw new F("ogc-feature-layer:missing-feature-id",
"Collection geojson require a feature id as a unique identifier");B.unshift({name:E,alias:E,type:"number"===K.objectIdFieldType?"esriFieldTypeOID":"esriFieldTypeString",editable:!1,nullable:!1})}E!==K.objectIdFieldName&&(I=B.find(({name:N})=>N===K.objectIdFieldName))&&(I.type="esriFieldTypeInteger");B===K.fields&&0<K.unknownFields.length&&w.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:K.unknownFields}});
for(var H of B){null==H.name&&(H.name=H.alias);null==H.alias&&(H.alias=H.name);"esriFieldTypeOID"!==H.type&&"esriFieldTypeGlobalID"!==H.type&&(H.editable=null==H.editable||!!H.editable,H.nullable=null==H.nullable||!!H.nullable);if(!H.name)throw new F("ogc-feature-layer:invalid-field-name","field name is missing",{field:H});if(!e.kebabDict.jsonValues.includes(H.type))throw new F("ogc-feature-layer:invalid-field-type",`invalid type for field "${H.name}"`,{field:H});}t&&(H=new h(B),t.startTimeField&&
((I=H.get(t.startTimeField))?(t.startTimeField=I.name,I.type="esriFieldTypeDate"):t.startTimeField=null),t.endTimeField&&((I=H.get(t.endTimeField))?(t.endTimeField=I.name,I.type="esriFieldTypeDate"):t.endTimeField=null),t.trackIdField&&((H=H.get(t.trackIdField))?t.trackIdField=H.name:(t.trackIdField=null,w.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:t}}))),t.startTimeField||t.endTimeField||(w.warn({name:"ogc-feature-layer:invalid-timeInfo",
message:"startTimeField and endTimeField are missing",details:{timeInfo:t}}),t=null));H=C?a.createDrawingInfo(C):null;m=r(m);return{drawingInfo:H,extent:m,geometryType:C,fields:B,hasZ:!!J,objectIdField:E,timeInfo:t}};q.getServerCollections=async function(m,t={}){({links:m}=m);m=A(m,"data","application/json")||A(m,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if(y.isNone(m))throw new F("ogc-feature-layer:missing-collections-page","Missing collections url");const {apiKey:B,customParameters:J,
signal:C}=t;({data:t}=await G(m.href,{signal:C,headers:{accept:"application/json"},query:{...J,token:B}}));return t};q.getServerConformance=async function(m,t={}){({links:m}=m);m=A(m,"conformance","application/json")||A(m,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if(y.isNone(m))throw new F("ogc-feature-layer:missing-conformance-page","Missing conformance url");const {apiKey:B,customParameters:J,signal:C}=t;({data:t}=await G(m.href,{signal:C,headers:{accept:"application/json"},
query:{...J,token:B}}));return t};q.getServerLandingPage=async function(m,t={}){const {apiKey:B,customParameters:J,signal:C}=t;({data:m}=await G(m,{signal:C,headers:{accept:"application/json"},query:{...J,token:B}}));return m};q.getServerOpenApi=async function(m,t={}){m=A(m.links,"service-desc","application/vnd.oai.openapi+json;version\x3d3.0");if(y.isNone(m))return w.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const {apiKey:B,customParameters:J,
signal:C}=t;({data:t}=await G(m.href,{signal:C,headers:{accept:"application/vnd.oai.openapi+json;version\x3d3.0"},query:{...J,token:B}}));return t};q.getSpatialReferenceWkid=function(m){m=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(m)?.groups;if(!m)return null;const {authority:t,code:B}=m;switch(t.toLowerCase()){case "ogc":switch(B.toLowerCase()){case "crs27":return f.GCS_NAD_1927.wkid;case "crs83":return 4269;case "crs84":case "crs84h":return f.WGS84.wkid;
default:return null}case "esri":case "epsg":return m=Number.parseInt(B,10),Number.isNaN(m)?null:m;default:return null}};q.queryFeatureSetJSON=async function(m,t,B){m=await c(m,t,B);return k.convertToFeatureSet(m)};q.queryOptimizedFeatureSet=c;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/geojson/geojson":function(){define(["exports","../../../../core/Error","../../OptimizedFeature","../../OptimizedGeometry","../../../support/fieldUtils"],function(q,
n,G,F,z){function*y(v){switch(v.type){case "Feature":yield v;break;case "FeatureCollection":for(const l of v.features)l&&(yield l)}}function*D(v){if(v)switch(v.type){case "Point":yield v.coordinates;break;case "LineString":case "MultiPoint":yield*v.coordinates;break;case "MultiLineString":case "Polygon":for(const l of v.coordinates)yield*l;break;case "MultiPolygon":for(const l of v.coordinates)for(const u of l)yield*u}}function*x(v,l={}){const {geometryType:u,objectIdField:r}=l;for(const A of v){const {geometry:w,
properties:m,id:t}=A;if(w&&p[w.type]!==u)continue;v=m||{};let B=void 0;r&&(B=v[r],null==t||B||(v[r]=B=t));yield new G.OptimizedFeature(w?a(new F,w,l):null,v,null,B??void 0)}}function k(v){for(const l of v)if(2<l.length)return!0;return!1}function g(v){let l=0;for(let u=0;u<v.length;u++){const r=v[u],A=v[(u+1)%v.length];l+=r[0]*A[1]-A[0]*r[1]}return 0>=l}function b(v){const l=v[0],u=v[v.length-1];l[0]===u[0]&&l[1]===u[1]&&l[2]===u[2]||v.push(l);return v}function a(v,l,u){switch(l.type){case "LineString":return f(v,
l.coordinates,u),v;case "MultiLineString":for(const A of l.coordinates)f(v,A,u);return v;case "MultiPoint":return f(v,l.coordinates,u),v;case "MultiPolygon":for(var r of l.coordinates)for(h(v,r[0],u),l=1;l<r.length;l++)e(v,r[l],u);return v;case "Point":return d(v,l.coordinates,u),v;case "Polygon":r=l.coordinates;h(v,r[0],u);for(l=1;l<r.length;l++)e(v,r[l],u);return v}}function h(v,l,u){l=b(l);g(l)?f(v,l,u):c(v,l,u)}function e(v,l,u){l=b(l);g(l)?c(v,l,u):f(v,l,u)}function f(v,l,u){for(const r of l)d(v,
r,u);v.lengths.push(l.length)}function c(v,l,u){for(let r=l.length-1;0<=r;r--)d(v,l[r],u);v.lengths.push(l.length)}function d(v,l,u){const [r,A,w]=l;v.coords.push(r,A);u.hasZ&&v.coords.push(w||0)}const p={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};q.createOptimizedFeatures=function(v,l){return Array.from(x(y(v),l))};q.getGeometryType=function(v){return p[v]};
q.inferLayerProperties=function(v,l={}){const u=[];var r=new Set;const A=new Set;var w=!1;let m=null,t=!1,B=void 0;({geometryType:l=null}=l);var J=!1;for(const C of y(v)){const {geometry:K,properties:E,id:I}=C;if(K&&(l||(l=p[K.type]),p[K.type]!==l))continue;w||(w=D(K),w=k(w));!t&&(t=null!=I)&&(B=typeof I,E&&(m=Object.keys(E).filter(H=>E[H]===I)));E&&m&&t&&null!=I&&(1<m.length?m=m.filter(H=>E[H]===I):1===m.length&&(m=E[m[0]]===I?m:[]));if(!J&&E){v=!0;for(const H in E){if(r.has(H))continue;J=E[H];if(null==
J){v=!1;A.add(H);continue}a:switch(typeof J){case "string":J="esriFieldTypeString";break a;case "number":J="esriFieldTypeDouble";break a;default:J="unknown"}if("unknown"===J){A.add(H);continue}A.delete(H);r.add(H);const N=z.normalizeFieldName(H);N&&u.push({name:N,alias:H,type:J})}J=v}}if(r=z.normalizeFieldName(1===m?.length&&m[0]||null)??void 0)for(const C of u)if(C.name===r&&z.isNumericField(C)){C.type="esriFieldTypeOID";break}return{fields:u,geometryType:l,hasZ:w,objectIdFieldName:r,objectIdFieldType:B,
unknownFields:Array.from(A)}};q.validateGeoJSON=function(v){if(!v)throw new n("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==v.type&&"FeatureCollection"!==v.type)throw new n("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:v});({crs:v}=v);if(v){var l="string"===typeof v?v:"name"===v.type?v.properties.name:"EPSG"===v.type?v.properties.code:null,u=RegExp(".*(CRS84H?|4326)$","i");if(!l||!u.test(l))throw new n("geojson-layer:unsupported-crs",
"unsupported GeoJSON 'crs' member",{crs:v});}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["exports","../../../../core/has","../../../../core/lang","../../data/QueryEngineCapabilities","../../../../symbols/support/defaultsJSON"],function(q,n,G,F,z){const y=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let D=1;q.createCapabilities=function(x,k){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,
supportsAttachment:!1,supportsM:!1,supportsZ:x},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:k,supportsDelete:k,supportsEditing:k,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:k,supportsExceedsLimitStatistics:!0},query:F.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,
supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:k,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}};q.createDefaultAttributesFunction=function(x,k){if(n("esri-csp-restrictions"))return()=>({[k]:null,...x});try{let g=
`this.${k} = null;`;for(const a in x){const h=y.test(a)?`.${a}`:`["${a}"]`;g+=`this${h} = ${JSON.stringify(x[a])};`}const b=(new Function(`\n      return class AttributesClass$${D++} {\n        constructor() {\n          ${g};\n        }\n      }\n    `))();return()=>new b}catch(g){return()=>({[k]:null,...x})}};q.createDefaultTemplate=function(x={}){return[{name:"New Feature",description:"",prototype:{attributes:G.clone(x)}}]};q.createDrawingInfo=function(x){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===
x||"esriGeometryMultipoint"===x?z.defaultPointSymbolJSON:"esriGeometryPolyline"===x?z.defaultPolylineSymbolJSON:z.defaultPolygonSymbolJSON}}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],function(q){const n=[252,146,31,255],G={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},F={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n};
q.defaultColor=n;q.defaultOutlineColor=[153,153,153,255];q.defaultPointSymbolJSON=G;q.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};q.defaultPolylineSymbolJSON=F;q.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,
yoffset:0,angle:0};q.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};q.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};q.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(q,n){n=new n.JSONMap({esriFieldTypeSmallInteger:"small-integer",
esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});q.kebabDict=n;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/query":function(){define("exports ../../../request ../../../core/maybe ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../operations/urlUtils ./pbfQueryUtils ./queryZScale".split(" "),
function(q,n,G,F,z,y,D,x,k){function g(e,f){if(f&&"extent"===e.type)return`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;if(f&&"point"===e.type)return`${e.x},${e.y}`;e=e.toJSON();delete e.spatialReference;return JSON.stringify(e)}function b(e,f){const c=e.geometry,d=e.toJSON();delete d.compactGeometryEnabled;delete d.defaultSpatialReferenceEnabled;let p,v,l;G.isSome(c)&&(v=c.spatialReference,l=c.spatialReference.wkid||JSON.stringify(c.spatialReference),d.geometryType=z.getJsonType(c),d.geometry=g(c,e.compactGeometryEnabled),
d.inSR=l);d.groupByFieldsForStatistics&&(d.groupByFieldsForStatistics=d.groupByFieldsForStatistics.join(","));d.objectIds&&(d.objectIds=d.objectIds.join(","));d.orderByFields&&(d.orderByFields=d.orderByFields.join(","));!d.outFields||!d.returnDistinctValues&&(f?.returnCountOnly||f?.returnExtentOnly||f?.returnIdsOnly)?delete d.outFields:d.outFields.includes("*")?d.outFields="*":d.outFields=d.outFields.join(",");d.outSR?(d.outSR=d.outSR.wkid||JSON.stringify(d.outSR),p=e.outSpatialReference):c&&(d.returnGeometry||
d.returnCentroid)&&(d.outSR=d.inSR,p=v);d.returnGeometry&&delete d.returnGeometry;d.outStatistics&&(d.outStatistics=JSON.stringify(d.outStatistics));d.fullText&&(d.fullText=JSON.stringify(d.fullText));d.pixelSize&&(d.pixelSize=JSON.stringify(d.pixelSize));d.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&G.isSome(v)&&G.isSome(e.quantizationParameters)&&G.isSome(e.quantizationParameters.extent)&&v.equals(e.quantizationParameters.extent.spatialReference)&&delete d.quantizationParameters.extent.spatialReference,
d.quantizationParameters=JSON.stringify(d.quantizationParameters));d.parameterValues&&(d.parameterValues=JSON.stringify(d.parameterValues));d.rangeValues&&(d.rangeValues=JSON.stringify(d.rangeValues));d.dynamicDataSource&&(d.layer=JSON.stringify({source:d.dynamicDataSource}),delete d.dynamicDataSource);if(d.timeExtent){const {start:u,end:r}=d.timeExtent;if(null!=u||null!=r)d.time=u===r?u:`${null==u?"null":u},${null==r?"null":r}`;delete d.timeExtent}e.defaultSpatialReferenceEnabled&&G.isSome(v)&&G.isSome(p)&&
v.equals(p)&&(d.defaultSR=d.inSR,delete d.inSR,delete d.outSR);return d}function a(e,f,c){return h(e,f,"pbf",c)}function h(e,f,c,d={},p={}){const v="string"===typeof e?F.urlToObject(e):e;e=f.geometry?[f.geometry]:[];d.responseType="pbf"===c?"array-buffer":"json";return y.normalizeCentralMeridian(e,null,d).then(l=>{l=l&&l[0];G.isSome(l)&&(f=f.clone(),f.geometry=l);l=D.mapParameters({...v.query,f:c,...p,...b(f,p)});return n(F.join(v.path,"query"),{...d,query:{...l,...d.query}})})}q.encodeGeometry=g;
q.executeQuery=async function(e,f,c,d){e=G.isSome(f.timeExtent)&&f.timeExtent.isEmpty?{data:{features:[]}}:await h(e,f,"json",d);k.applyFeatureSetZUnitScaling(f,c,e.data);return e};q.executeQueryForCount=function(e,f,c){return G.isSome(f.timeExtent)&&f.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):h(e,f,"json",c,{returnIdsOnly:!0,returnCountOnly:!0})};q.executeQueryForExtent=function(e,f,c){return G.isSome(f.timeExtent)&&f.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):h(e,
f,"json",c,{returnExtentOnly:!0,returnCountOnly:!0}).then(d=>{const p=d.data;if(p.hasOwnProperty("extent"))return d;if(p.features)throw Error("Layer does not support extent calculation.");if(p.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return d})};q.executeQueryForIds=function(e,f,c){return G.isSome(f.timeExtent)&&f.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):h(e,f,"json",c,{returnIdsOnly:!0})};q.executeQueryPBF=async function(e,f,c,d){if(G.isSome(f.timeExtent)&&
f.timeExtent.isEmpty)return{data:c.createFeatureResult()};e=await a(e,f,d);e.data=x.parsePBFFeatureQuery(e.data,c);return e};q.executeQueryPBFBuffer=a;q.queryToQueryStringParameters=b;q.runQuery=h;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/operations/urlUtils":function(){define(["exports"],function(q){function n(G){const F={};for(const z in G){if("declaredClass"===z)continue;const y=G[z];if(null!=y&&"function"!==typeof y)if(Array.isArray(y)){F[z]=[];for(let D=0;D<y.length;D++)F[z][D]=
n(y[D])}else"object"===typeof y?y.toJSON&&(F[z]=JSON.stringify(y)):F[z]=y}return F}q.mapParameters=n;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(q,n){q.parsePBFFeatureQuery=function(G,F){var z=n.parseFeatureQuery(G,F);G=z.queryResult.featureResult;F=z.queryResult.queryGeometry;z=z.queryResult.queryGeometryType;if(G&&G.features&&G.features.length&&G.objectIdFieldName){const y=
G.objectIdFieldName;for(const D of G.features)D.attributes&&(D.objectId=D.attributes[y])}G&&(G.queryGeometry=F,G.queryGeometryType=z);return G};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define("exports ../../../core/Error ../../../core/maybe ../../../core/pbf ../../../layers/graphics/OptimizedGeometry ./pbfOptimizedFeatureSet".split(" "),function(q,n,G,F,z,y){function D(m){return m>=r.length?null:r[m]}function x(m,
t,B){m=m.asUnsafe();for(B=t.createPointGeometry(B);m.next();)switch(m.tag()){case 3:var J=m.getUInt32();J=m.pos()+J;let C=0;for(;m.pos()<J;)t.addCoordinatePoint(B,m.getSInt64(),C++);break;default:m.skip()}return B}function k(m,t,B){m=m.asUnsafe();const J=t.createGeometry(B);for(B=2+(B.hasZ?1:0)+(B.hasM?1:0);m.next();)switch(m.tag()){case 2:var C=m.getUInt32();C=m.pos()+C;for(var K=0;m.pos()<C;)t.addLength(J,m.getUInt32(),K++);break;case 3:C=m.getUInt32();C=m.pos()+C;K=0;for(t.allocateCoordinates(J);m.pos()<
C;)t.addCoordinate(J,m.getSInt64(),K),K++,K===B&&(K=0);break;default:m.skip()}return J}function g(m){m=m.asUnsafe();const t=new z;let B="esriGeometryPoint";for(;m.next();)switch(m.tag()){case 2:var J=m.getUInt32();for(J=m.pos()+J;m.pos()<J;)t.lengths.push(m.getUInt32());break;case 3:J=m.getUInt32();for(J=m.pos()+J;m.pos()<J;)t.coords.push(m.getSInt64());break;case 1:B=y.OPTIMIZED_GEOMETRY_TYPES[m.getEnum()];break;default:m.skip()}return{queryGeometry:t,queryGeometryType:B}}function b(m){for(m=m.asUnsafe();m.next();)switch(m.tag()){case 1:return m.getString();
case 2:return m.getFloat();case 3:return m.getDouble();case 4:return m.getSInt32();case 5:return m.getUInt32();case 6:return m.getInt64();case 7:return m.getUInt64();case 8:return m.getSInt64();case 9:return m.getBool();default:return m.skip(),null}return null}function a(m){m=m.asUnsafe();const t={type:D(0)};for(;m.next();)switch(m.tag()){case 1:t.name=m.getString();break;case 2:t.type=D(m.getEnum());break;case 3:t.alias=m.getString();break;case 4:var B=m.getEnum();B=B>=A.length?null:A[B];t.sqlType=
B;break;case 5:m.skip();break;case 6:t.defaultValue=m.getString();break;default:m.skip()}return t}function h(m){const t={};for(m=m.asUnsafe();m.next();)switch(m.tag()){case 1:t.name=m.getString();break;case 2:t.isSystemMaintained=m.getBool();break;default:m.skip()}return t}function e(m,t,B,J){const C=t.createFeature(B);let K=0;for(;m.next();)switch(m.tag()){case 1:const E=J[K++].name;C.attributes[E]=m.processMessage(b);break;case 2:C.geometry=m.processMessageWithArgs(k,t,B);break;case 4:C.centroid=
m.processMessageWithArgs(x,t,B);break;default:m.skip()}return C}function f(m){const t=[1,1,1,1];for(m=m.asUnsafe();m.next();)switch(m.tag()){case 1:t[0]=m.getDouble();break;case 2:t[1]=m.getDouble();break;case 4:t[2]=m.getDouble();break;case 3:t[3]=m.getDouble();break;default:m.skip()}return t}function c(m){const t=[0,0,0,0];for(m=m.asUnsafe();m.next();)switch(m.tag()){case 1:t[0]=m.getDouble();break;case 2:t[1]=m.getDouble();break;case 4:t[2]=m.getDouble();break;case 3:t[3]=m.getDouble();break;default:m.skip()}return t}
function d(m){const t={originPosition:0>=w.length?null:w[0]};for(m=m.asUnsafe();m.next();)switch(m.tag()){case 1:var B=m.getEnum();t.originPosition=B>=w.length?null:w[B];break;case 2:t.scale=m.processMessage(f);break;case 3:t.translate=m.processMessage(c);break;default:m.skip()}return t}function p(m){const t={};for(m=m.asUnsafe();m.next();)switch(m.tag()){case 1:t.shapeAreaFieldName=m.getString();break;case 2:t.shapeLengthFieldName=m.getString();break;case 3:t.units=m.getString();break;default:m.skip()}return t}
function v(m,t){for(t=t.createSpatialReference();m.next();)switch(m.tag()){case 1:t.wkid=m.getUInt32();break;case 5:t.wkt=m.getString();break;case 2:t.latestWkid=m.getUInt32();break;case 3:t.vcsWkid=m.getUInt32();break;case 4:t.latestVcsWkid=m.getUInt32();break;default:m.skip()}return t}function l(m,t){const B=t.createFeatureResult();m=m.asUnsafe();B.geometryType=0>=t.geometryTypes.length?null:t.geometryTypes[0];let J=!1;for(;m.next();)switch(m.tag()){case 1:B.objectIdFieldName=m.getString();break;
case 3:B.globalIdFieldName=m.getString();break;case 4:B.geohashFieldName=m.getString();break;case 5:B.geometryProperties=m.processMessage(p);break;case 7:var C=m.getEnum();B.geometryType=C>=t.geometryTypes.length?null:t.geometryTypes[C];break;case 8:B.spatialReference=m.processMessageWithArgs(v,t);break;case 10:B.hasZ=m.getBool();break;case 11:B.hasM=m.getBool();break;case 12:B.transform=m.processMessage(d);break;case 9:C=m.getBool();B.exceededTransferLimit=C;break;case 13:t.addField(B,m.processMessage(a));
break;case 15:J||(t.prepareFeatures(B),J=!0);t.addFeature(B,m.processMessageWithArgs(e,t,B,B.fields));break;case 2:B.uniqueIdField=m.processMessage(h);break;default:m.skip()}t.finishFeatureResult(B);return B}function u(m,t){const B={};let J=null;for(;m.next();)switch(m.tag()){case 4:J=m.processMessageWithArgs(g);break;case 1:B.featureResult=m.processMessageWithArgs(l,t);break;default:m.skip()}G.isSome(J)&&B.featureResult&&t.addQueryGeometry(B,J);return B}const r="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),
A="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),w=["upperLeft","lowerLeft"];q.parseFeatureQuery=function(m,t){try{const B=new F(new Uint8Array(m),new DataView(m));
for(m={};B.next();)switch(B.tag()){case 2:m.queryResult=B.processMessageWithArgs(u,t);break;default:B.skip()}return m}catch(B){throw new n("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:B});}};q.parseFieldType=D;q.parseTransform=d;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),
function(q,n,G,F,z,y,D){const x=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];let k=function(){function g(a){this._options=a;this.geometryTypes=x;this._vertexDimension=this._coordinatePtr=0}var b=g.prototype;b.createFeatureResult=function(){return new y};b.prepareFeatures=function(a){this._vertexDimension=2;a.hasZ&&this._vertexDimension++;a.hasM&&this._vertexDimension++};b.finishFeatureResult=function(a){if(a&&a.features&&a.hasZ&&this._options.sourceSpatialReference&&
a.spatialReference&&!F.equals(a.spatialReference,this._options.sourceSpatialReference)&&!a.spatialReference.vcsWkid){var h=G.getMetersPerVerticalUnitForSR(this._options.sourceSpatialReference),e=G.getMetersPerVerticalUnitForSR(a.spatialReference);h/=e;if(1!==h)for(const f of a.features)if(z.hasGeometry(f))for(a=f.geometry.coords,e=2;e<a.length;e+=3)a[e]*=h}};b.addFeature=function(a,h){a.features.push(h)};b.createFeature=function(){return new z.OptimizedFeature};b.createSpatialReference=function(){return{wkid:0}};
b.createGeometry=function(){return new D};b.addField=function(a,h){a.fields.push(h)};b.allocateCoordinates=function(a){a.coords.length=a.lengths.reduce((h,e)=>h+e,0)*this._vertexDimension;this._coordinatePtr=0};b.addCoordinate=function(a,h){a.coords[this._coordinatePtr++]=h};b.addCoordinatePoint=function(a,h){a.coords.push(h)};b.addLength=function(a,h){a.lengths.push(h)};b.addQueryGeometry=function(a,h){a.queryGeometry=h.queryGeometry;a.queryGeometryType=h.queryGeometryType};b.createPointGeometry=
function(){return new D};return n._createClass(g)}();q.OPTIMIZED_GEOMETRY_TYPES=x;q.OptimizedFeatureSetParserContext=k;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../core/maybe","../../../geometry/support/zscale"],function(q,n,G){q.applyFeatureSetZUnitScaling=function(F,z,y){if(y&&y.features&&y.hasZ&&(F=G.getGeometryZScaler(y.geometryType,z,F.outSpatialReference),!n.isNone(F)))for(const D of y.features)F(D.geometry)};
Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),function(q,n,G,F,z,y){function D({coords:k,lengths:g}){let b=0;for(const a of g){for(g=1;g<a;g++)k[2*(b+g)]+=k[2*(b+g)-2],k[2*(b+g)+1]+=k[2*(b+
g)-1];b+=a}}let x=function(k){function g(a,h,e){a=b.call(this,a,e);a._exceededTransferLimit=!1;a._featureIndex=-1;a._dateFields=new Set;a._geometryType=e?.geometryType;a._features=h;return a}n._inherits(g,k);var b=n._createSuper(g);g.fromFeatures=function(a,h){const {objectIdField:e,geometryType:f}=h,c=F.convertFromFeatures([],a,f,!1,!1,e);for(let d=0;d<c.length;d++)c[d].displayId=a[d].displayId;return g.fromOptimizedFeatures(c,h)};g.fromFeatureSet=function(a,h){a=F.convertFromFeatureSet(a,h.objectIdField);
return g.fromOptimizedFeatureSet(a,h)};g.fromOptimizedFeatureSet=function(a,h){const {features:e}=a;h=g.fromOptimizedFeatures(e,h);h._exceededTransferLimit=a.exceededTransferLimit;h._transform=a.transform;for(const f of a.fields)"esriFieldTypeDate"===f.type&&h._dateFields.add(f.name);return h};g.fromOptimizedFeatures=function(a,h,e){const f=y.FeatureSetReader.createInstance();a=new g(f,a,h);a._transform=e;return a};k=g.prototype;k.removeIds=function(a){const h=new Set(a);this._features=this._features.filter(e=>
!(e.objectId&&h.has(e.objectId)))};k.append=function(a){for(const h of a)this._features.push(h)};k.getSize=function(){return this._features.length};k.getCursor=function(){return this.copy()};k.getQuantizationTransform=function(){return this._transform};k.getAttributeHash=function(){let a="";for(const h in this._current.attributes)a+=this._current.attributes[h];return a};k.getIndex=function(){return this._featureIndex};k.setIndex=function(a){this._featureIndex=a};k.getObjectId=function(){return this._current?.objectId};
k.getDisplayId=function(){return this._current.displayId};k.setDisplayId=function(a){this._current.displayId=a};k.getGroupId=function(){return this._current.groupId};k.setGroupId=function(a){this._current.groupId=a};k.copy=function(){const a=new g(this.instance,this._features,this.fullSchema());this.copyInto(a);return a};k.next=function(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};k.readLegacyFeature=function(){return F.convertToFeature(this._current,
this.geometryType,this.hasZ,this.hasM)};k.readOptimizedFeature=function(){return this._current};k.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};k.readLegacyGeometry=function(){const a=this.readGeometry();return F.convertToGeometry(a,this.geometryType,this.hasZ,this.hasM)};k.readLegacyCentroid=function(){const a=this.readCentroid();return G.isNone(a)?null:{x:a.coords[0]*this._sx+this._tx,y:a.coords[1]*this._sy+this._ty}};k.readGeometryArea=function(){return z.hasGeometry(this._current)?
F.getQuantizedArea(this._current.geometry,2):0};k.readUnquantizedGeometry=function(){var a=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!a)return a;a=a.clone();D(a);return a};k.readHydratedGeometry=function(){var a=this._current.geometry;if(G.isNone(a))return null;a=a.clone();G.isSome(this._transform)&&F.unquantizeOptimizedGeometry(a,a,this.hasZ,this.hasM,this._transform);return a};k.getXHydrated=function(){if(!z.hasGeometry(this._current))return 0;const a=this._current.geometry.coords[0],
h=this.getQuantizationTransform();return G.isNone(h)?a:a*h.scale[0]+h.translate[0]};k.getYHydrated=function(){if(!z.hasGeometry(this._current))return 0;const a=this._current.geometry.coords[1],h=this.getQuantizationTransform();return G.isNone(h)?a:h.translate[1]-a*h.scale[1]};k.getX=function(){return z.hasGeometry(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:0};k.getY=function(){return z.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};k.readGeometry=
function(){if(!z.hasGeometry(this._current)){if(G.isSome(this._current.centroid)){const [e,f]=this._current.centroid.coords;return this.createQuantizedExtrudedQuad(e,f)}return null}const a=this._current.geometry.clone();if(a.isPoint)return a.coords[0]=a.coords[0]*this._sx+this._tx,a.coords[1]=a.coords[1]*this._sy+this._ty,a;let h=0;for(const e of a.lengths)a.coords[2*h]=a.coords[2*h]*this._sx+this._tx,a.coords[2*h+1]=a.coords[2*h+1]*this._sy+this._ty,h+=e;return a};k.readCentroid=function(){return z.hasGeometry(this._current)?
this._computeCentroid():this._current.centroid};k.hasField=function(a){return a in this._current.attributes?!0:this.getFieldNames().map(h=>h.toLowerCase()).includes(a.toLowerCase())};k.getFieldNames=function(){return Object.keys(this._current.attributes)};k._readAttribute=function(a,h){var e=this._current.attributes[a];if(void 0!==e)return null!=e&&h&&this._dateFields.has(a)?new Date(e):e;e=this.readAttributes();a=a?.toLocaleLowerCase().trim();for(const f in e)if(f.toLocaleLowerCase().trim()===a)return a=
this._current.attributes[f],null!=a&&h&&this._dateFields.has(f)?new Date(a):a};k.copyInto=function(a){n._get(n._getPrototypeOf(g.prototype),"copyInto",this).call(this,a);a._featureIndex=this._featureIndex;a._transform=this._transform;a._dateFields=this._dateFields};k._readAttributes=function(){return this._current.attributes};n._createClass(g,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",
get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return g}(y.FeatureSetReader);q.FeatureSetReaderJSON=x;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBF":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/pbf ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ./FeatureSetReader ./FeatureSetReaderPBFHeader".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b){function a(d){if(d<=f.small.delta.length)return f.small;if(d<=f.large.delta.length)return f.large;f.large.delta=new Int32Array(Math.round(1.25*d));f.large.decoded=new Int32Array(Math.round(1.25*d));return f.large}function h(d){var p=d.getLength();for(p=d.pos()+p;d.pos()<p&&d.next();)switch(d.tag()){case 1:return d.getString();case 2:return d.getFloat();case 3:return d.getDouble();case 4:return d.getSInt32();case 5:return d.getUInt32();case 6:return d.getInt64();case 7:return d.getUInt64();
case 8:return d.getSInt64();case 9:return d.getBool();default:return d.skip(),null}return null}function e(d,p,v,l){return 0===d*l-v*p&&0<d*v+p*l}const f={small:{delta:new Int32Array(128),decoded:new Int32Array(128)},large:{delta:new Int32Array(128E3),decoded:new Int32Array(128E3)}};let c=function(d){function p(l,u,r,A){l=v.call(this,l,A);l._hasNext=!1;l._isPoints=!1;l._featureIndex=-1;l._featureOffset=0;l._cache={area:0,unquantGeometry:void 0,geometry:void 0,centroid:void 0,legacyFeature:void 0,optFeature:void 0};
l._geometryType=A.geometryType;l._reader=u;l._header=r;l._hasNext=r.hasFeatures;l._isPoints="esriGeometryPoint"===A.geometryType;return l}n._inherits(p,d);var v=n._createSuper(p);p.fromBuffer=function(l,u,r=!1){var A=u.geometryType;a:{try{const t=new y(new Uint8Array(l),new DataView(l));for(;t.next();)switch(t.tag()){case 2:b:{for(var w=t.getMessage();w.next();)switch(w.tag()){case 1:var m=w.getMessage();break b;default:w.skip()}m=null}break a;default:t.skip()}}catch(t){l=new G("query:parsing-pbf",
"Error while parsing FeatureSet PBF payload",{error:t}),F.getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF").error(l)}m=null}l=m;r=b.parseHeader(l,"esriGeometryPoint"===A,r);A=g.FeatureSetReader.createInstance();return new p(A,l,r,u)};d=p.prototype;d.hasField=function(l){return this._header.hasField(l)||this._header.hasField(l.toLowerCase().trim())};d.getFieldNames=function(){return this._header.fields.map(l=>l.fieldName)};d.getSize=function(){return this._size};d.getQuantizationTransform=
function(){return this._header.transform};d.getCursor=function(){return this.copy()};d.getIndex=function(){return this._featureIndex};d.setIndex=function(l){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;this._cache.optFeature=void 0;this._featureIndex=l};d.getAttributeHash=function(){let l="";this._header.fields.forEach(({index:u})=>{l+=this._readAttributeAtIndex(u)+"."});return l};d.getObjectId=function(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)};
d.getDisplayId=function(){return this._header.displayIds[this._featureIndex]};d.setDisplayId=function(l){this._header.displayIds[this._featureIndex]=l};d.getGroupId=function(){return this._header.groupIds[this._featureIndex]};d.setGroupId=function(l){this._header.groupIds[this._featureIndex]=l};d.readLegacyFeature=function(){if(void 0===this._cache.legacyFeature){var l=this.readCentroid();l={attributes:this.readAttributes(),geometry:this._isPoints?this.readLegacyPointGeometry():this.readLegacyGeometry(),
centroid:(l&&{x:l.coords[0],y:l.coords[1]})??null};return this._cache.legacyFeature=l}return this._cache.legacyFeature};d.readOptimizedFeature=function(){if(void 0===this._cache.optFeature){const l=new x.OptimizedFeature(this.readGeometry(),this.readAttributes(),this.readCentroid());l.objectId=this.getObjectId();l.displayId=this.getDisplayId();return this._cache.optFeature=l}return this._cache.optFeature};d.getXHydrated=function(){const l=this._header.centroid[2*this._featureIndex],u=this.getQuantizationTransform();
return z.isNone(u)?l:l*u.scale[0]+u.translate[0]};d.getYHydrated=function(){const l=this._header.centroid[2*this._featureIndex+1],u=this.getQuantizationTransform();return z.isNone(u)?l:u.translate[1]-l*u.scale[1]};d.getX=function(){return this._header.centroid[2*this._featureIndex]*this._sx+this._tx};d.getY=function(){return this._header.centroid[2*this._featureIndex+1]*this._sy+this._ty};d.readLegacyPointGeometry=function(){const l=this.getX(),u=this.getY();return{x:l,y:u}};d.readLegacyGeometry=
function(l){l=this.readGeometry(l);return D.convertToGeometry(l,this.geometryType,!1,!1)};d.readLegacyCentroid=function(){const l=this.readCentroid();if(!l)return null;const [u,r]=l.coords;return{x:u,y:r}};d.readGeometryArea=function(){this._cache.area||this.readGeometry(!0);return this._cache.area};d.readUnquantizedGeometry=function(l=!1){if(void 0===this._cache.unquantGeometry){l=this.readGeometry(l);if(!l)return this._cache.unquantGeometry=void 0,null;var u=a(l.coords.length).decoded;l=l.clone(u);
u=l.coords;let r=0;for(const A of l.lengths){for(let w=1;w<A;w++){const m=2*(r+w),t=2*(r+w-1);u[m]+=u[t];u[m+1]+=u[t+1]}r+=A}return this._cache.unquantGeometry=l}return this._cache.unquantGeometry};d.readHydratedGeometry=function(){if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;var l=this.getXHydrated(),u=this.getYHydrated();return new k([],[l,u])}l=this.readGeometry();if(!l)return null;l=l.clone();u=this.getQuantizationTransform();z.isSome(u)&&D.unquantizeOptimizedGeometry(l,
l,this.hasZ,this.hasM,u);return l};d.readGeometry=function(l=!1){if(void 0===this._cache.geometry){var u=null;if(this._isPoints){if(268435455===this._header.centroid[2*this._featureIndex])return null;l=this.getX();u=this.getY();u=new k([],[l,u])}else{const r=this._header.offsets.geometry[this._featureIndex],A=this._reader;if(0===r){l=this._readServerCentroid();if(!l)return null;const [w,m]=l.coords;return this.createQuantizedExtrudedQuad(w,m)}A.move(r);try{if(u=l?this._parseGeometryForDisplay(A):
this._parseGeometry(A),null===u){const w=this._readServerCentroid();if(!w)return null;const [m,t]=w.coords;return this.createQuantizedExtrudedQuad(m,t)}}catch(w){return console.error("Failed to parse geometry!",w),null}}return this._cache.geometry=u}return this._cache.geometry};d.readCentroid=function(){if(void 0===this._cache.centroid){let l=void 0;(l=this._computeCentroid())||(l=this._readServerCentroid());this._cache.centroid=l??void 0;return l??null}return this._cache.centroid};d.copy=function(){var l=
this._reader.clone();l=new p(this.instance,l,this._header,this.fullSchema());this.copyInto(l);return l};d.next=function(){this._cache.area=0;this._cache.unquantGeometry=void 0;this._cache.geometry=void 0;this._cache.centroid=void 0;this._cache.legacyFeature=void 0;for(this._cache.optFeature=void 0;++this._featureIndex<this._size&&!this._getExists(););return this._featureIndex<this._size};d._readAttribute=function(l,u){l=this._header.hasField(l)?l:l.toLowerCase().trim();var r=this._header.getFieldIndex(l);
if(null!=r)return r=this._readAttributeAtIndex(r),u&&null!=r?this._header.isDateField(l)?new Date(r):r:r};d._readAttributes=function(){const l={};this._header.fields.forEach(({fieldName:u,index:r})=>{l[u]=this._readAttributeAtIndex(r)});return l};d.copyInto=function(l){n._get(n._getPrototypeOf(p.prototype),"copyInto",this).call(this,l);l._featureIndex=this._featureIndex;l._featureOffset=this._featureOffset;l._hasNext=this._hasNext};d._readAttributeAtIndex=function(l){const u=this._reader;u.move(this._header.offsets.attributes[this._featureIndex*
this._header.fieldCount+l]);return h(u)};d._readServerCentroid=function(){const l=this._header.centroid[2*this._featureIndex]+this._tx;return 268435455===l?null:new k([],[l,this._header.centroid[2*this._featureIndex+1]+this._ty])};d._parseGeometry=function(l){l=l.asUnsafe();var u=l.getLength();u=l.pos()+u;const r=[],A=[];for(;l.pos()<u&&l.next();)switch(l.tag()){case 2:var w=l.getUInt32();for(w=l.pos()+w;l.pos()<w;)A.push(l.getUInt32());break;case 3:w=l.getUInt32();w=l.pos()+w;r.push(l.getSInt32()+
this._tx);r.push(l.getSInt32()+this._ty);this.hasZ&&l.getSInt32();for(this.hasM&&l.getSInt32();l.pos()<w;)r.push(l.getSInt32()),r.push(l.getSInt32()),this.hasZ&&l.getSInt32(),this.hasM&&l.getSInt32();break;default:l.skip()}return new k(A,r)};d._parseGeometryForDisplay=function(l){l=l.asUnsafe();var u=l.getLength();const r=l.pos()+u,A=[];u=[];let w=0,m=0;var t=null;let B=0;const J="esriGeometryPolygon"===this.geometryType;for(;l.pos()<r&&l.next();)switch(l.tag()){case 2:t=l.getUInt32();for(t=l.pos()+
t;l.pos()<t;){var C=l.getUInt32();A.push(C);w+=C}t=a(2*w).delta;break;case 3:l.getUInt32();C=2+(this.hasZ?1:0)+(this.hasM?1:0);z.assertIsSome(t);for(var K of A)if(m+C*K>t.length)for(var E=0;E<K;E++)l.getSInt32(),l.getSInt32(),this.hasZ&&l.getSInt32(),this.hasM&&l.getSInt32();else if(J){E=this.getAreaSimplificationThreshold(K,this._header.vertexCount);var I=2,H=1,N=l.getSInt32(),U=l.getSInt32();t[m++]=N;t[m++]=U;this.hasZ&&l.getSInt32();this.hasM&&l.getSInt32();var ba=l.getSInt32(),la=l.getSInt32();
this.hasZ&&l.getSInt32();for(this.hasM&&l.getSInt32();I<K;){var aa=l.getSInt32();let ka=l.getSInt32();this.hasZ&&l.getSInt32();this.hasM&&l.getSInt32();const V=N+ba,P=U+la,S=V+aa,X=P+ka;.5*Math.abs(N*P+V*X+S*U-N*X-V*U-S*P)>=E?(B+=-.5*(V-N)*(P+U),1<H&&e(t[m-2],t[m-1],ba,la)?(t[m-2]+=ba,t[m-1]+=la):(t[m++]=ba,t[m++]=la,H++),N=V,U=P):(aa+=ba,ka+=la);ba=aa;la=ka;I++}3>H?m-=2*H:(B+=-.5*(N+ba-N)*(U+la+U),e(t[m-2],t[m-1],ba,la)?(t[m-2]+=ba,t[m-1]+=la,u.push(H)):(t[m++]=ba,t[m++]=la,u.push(++H)))}else{E=
0;I=l.getSInt32();H=l.getSInt32();this.hasZ&&l.getSInt32();this.hasM&&l.getSInt32();t[m++]=I;t[m++]=H;E+=1;for(N=1;N<K;N++)U=l.getSInt32(),ba=l.getSInt32(),la=I+U,aa=H+ba,B+=-.5*(la-I)*(aa+H),this.hasZ&&l.getSInt32(),this.hasM&&l.getSInt32(),2<N&&e(t[m-2],t[m-1],U,ba)?(t[m-2]+=U,t[m-1]+=ba):(t[m++]=U,t[m++]=ba,E+=1),I=la,H=aa;u.push(E)}break;default:l.skip()}this._cache.area=B;if(!u.length)return null;if(this._tx||this._ty){K=0;z.assertIsSome(t);for(const ka of u)t[2*K]+=this._tx,t[2*K+1]+=this._ty,
K+=ka}return new k(u,t)};n._createClass(p,[{key:"geometryType",get:function(){return this._geometryType}},{key:"_size",get:function(){return this._header.featureCount}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}},{key:"stride",get:function(){return 2+(this.hasZ?1:0)+(this.hasM?1:0)}},{key:"hasFeatures",get:function(){return this._header.hasFeatures}},{key:"hasNext",get:function(){return this._hasNext}},{key:"exceededTransferLimit",get:function(){return this._header.exceededTransferLimit}}]);
return p}(g.FeatureSetReader);q.FeatureSetReaderPBF=c;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReaderPBFHeader":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../../../../../rest/query/operations/pbfFeatureServiceParser"],function(q,n,G,F){let z=function(){function y(){this.fieldMap=new Map;this.fields=[];this.exceededTransferLimit=this.hasFeatures=!1;this.vertexCount=
this.objectIdFieldIndex=this.featureCount=this.fieldCount=0;this.offsets={attributes:[],geometry:[]};this.centroid=[]}var D=y.prototype;D.hasField=function(x){return this.fieldMap.has(x)};D.isDateField=function(x){return(null!=x&&this.fieldMap.get(x)?.isDate)??!1};D.getFieldIndex=function(x){return null!=x?this.fieldMap.get(x)?.index:void 0};return n._createClass(y)}();q.FeatureSetHeader=z;q.parseHeader=function(y,D,x=!1){const k=y.asUnsafe(),g=k.pos(),b=new z;let a=0,h=0,e=null,f=null,c=null,d=!1;
for(;k.next();)switch(k.tag()){case 1:e=k.getString();break;case 3:f=k.getString();break;case 12:c=k.processMessage(F.parseTransform);break;case 9:b.exceededTransferLimit=k.getBool();if(b.exceededTransferLimit){b.offsets.geometry=x?new Float64Array(8E3):new Int32Array(8E3);b.centroid=x?new Float64Array(16E3):new Int32Array(16E3);for(var p=0;p<b.centroid.length;p++)b.centroid[p]=268435455}break;case 13:p=y.asUnsafe();var v=p.getLength();v=p.pos()+v;for(var l={name:"",isDate:!1};p.pos()<v&&p.next();)switch(p.tag()){case 1:l.name=
p.getString();break;case 2:"esriFieldTypeDate"===F.parseFieldType(p.getEnum())&&(l.isDate=!0);break;default:p.skip()}p=l;l=p.name;v=p.name.toLowerCase().trim();l={fieldName:l,index:a++,isDate:p.isDate};b.fields.push(l);b.fieldMap.set(p.name,l);b.fieldMap.set(v,l);break;case 15:p=k.getLength();p=k.pos()+p;b.exceededTransferLimit||(v=b.centroid,b.offsets.geometry.push(0),v.push(268435455),v.push(268435455));!d&&b.exceededTransferLimit&&(d=!0,b.offsets.attributes=x?new Float64Array(8E3*a):new Uint32Array(8E3*
a));for(v=h*a;k.pos()<p&&k.next();)switch(k.tag()){case 1:d?b.offsets.attributes[v++]=k.pos():b.offsets.attributes.push(k.pos());l=k.getLength();k.skipLen(l);break;case 2:if(D)for(l=k.getLength(),l=k.pos()+l;k.pos()<l&&k.next();)switch(k.tag()){case 3:k.getUInt32();var u=k.getSInt64(),r=k.getSInt64();b.centroid[2*h]=u;b.centroid[2*h+1]=r;break;default:k.skip()}else b.offsets.geometry[h]=k.pos(),l=k.getLength(),b.vertexCount+=l,k.skipLen(l);break;case 4:l=k.getLength();for(l=k.pos()+l;k.pos()<l&&k.next();)switch(k.tag()){case 3:k.getUInt32();
u=k.getSInt64();r=k.getSInt64();b.centroid[2*h]=u;b.centroid[2*h+1]=r;break;default:k.skip()}break;default:k.skip()}h++;b.hasFeatures=!0;break;default:k.skip()}y=e||f;if(!y)throw new G("FeatureSet has no objectId or globalId field name");b.featureCount=h;b.fieldCount=a;b.objectIdFieldIndex=b.getFieldIndex(y);b.transform=c;b.displayIds=new Uint32Array(b.featureCount);b.groupIds=new Uint16Array(b.featureCount);k.move(g);return b};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/DataTileSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../TimeExtent ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../core/support/WatchUpdatingTracking ../../../../../rest/support/Query ./DataTileSubscription ../support/UpdateToken".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){function h(f,c){const d=new Set;f&&f.forEach(p=>d.add(p));c&&c.forEach(p=>d.add(p));return d.has("*")?["*"]:Array.from(d)}let e=function(){function f(d){this.updatingHandles=new k.WatchUpdatingTracking;this.events=new F;this._resolver=D.createResolver();this._didEdit=!1;this._subscriptions=new Map;this._outSR=d.outSR;this._serviceInfo=d.serviceInfo;this._onTileUpdateMessage=d.onMessage}var c=f.prototype;c.destroy=function(){for(const d of this._subscriptions.values())d.abort();
this.updatingHandles.destroy()};c._onMessage=async function(d){const p=this._subscriptions.get(d.id);if(p)return d={...d,remove:d.remove??[],status:d.status??a.UpdateToken.empty()},D.ignoreAbortErrors(this._onTileUpdateMessage(d,p.options))};c.update=function(d,p){var v=p.fields.length;p.outFields=h(this._schema?.outFields,p.outFields);p.outFields=p.outFields.length>=.75*v?["*"]:p.outFields;p.outFields.sort();if(v=x.diff(this._schema,p)){z("esri-2d-update-debug")&&console.debug("Applying Update - Source:",
v);var l={returnCentroid:"esriGeometryPolygon"===this._serviceInfo.geometryType,returnGeometry:!0,timeReferenceUnknownClient:"stream"!==this._serviceInfo.type&&this._serviceInfo.timeReferenceUnknownClient,outFields:p.outFields,outSpatialReference:this._outSR,orderByFields:["orderByFields"in this._serviceInfo&&this._serviceInfo.orderByFields?this._serviceInfo.orderByFields:this._serviceInfo.objectIdField+" ASC"],where:p.definitionExpression||"1\x3d1",gdbVersion:p.gdbVersion,historicMoment:p.historicMoment,
timeExtent:p.timeExtent?G.fromJSON(p.timeExtent):null},u=this._schema&&x.hasDiff(v,"outFields");this._schema&&x.hasDiffAny(v,["timeExtent","definitionExpression","gdbVersion","historicMoment","customParameters"])&&(d.why.mesh.push("Layer filter and/or custom parameters changed"),d.why.source.push("Layer filter and/or custom parameters changed"),d.mesh=!0,d.source=!0,d.queryFilter=!0);u&&(d.why.source.push("Layer required fields changed"),d.source=!0);x.diff(l,this._queryInfo)&&(this._queryInfo=l);
this._schema=p;this._resolver.resolve()}};c.whenInitialized=function(){return this._resolver.promise};c.applyUpdate=async function(d){d.queryFilter||d.source&&this._didEdit?(this.refresh(d.version),this._didEdit=!1):(this._subscriptions.forEach(p=>p.applyUpdate(d)),await this.resend())};c.refresh=function(d,p){for(const v of this._tiles())this.unsubscribe(v),this.subscribe(v,d)};c.subscribe=function(d,p){p=new b.DataTileSubscription(d,p);this._subscriptions.set(d.id,p);this.updatingHandles.addPromise(p.done)};
c.unsubscribe=function(d){const p=this.getSubscription(d.id);y.isSome(p)&&p.abort();this._subscriptions.delete(d.id)};c.createQuery=function(d={}){return new g({...this._queryInfo,historicMoment:this._queryInfo.historicMoment?new Date(this._queryInfo.historicMoment):null,...d})};c.getSubscription=function(d){return this._subscriptions.has(d)?this._subscriptions.get(d):null};c.queryLastEditDate=async function(){throw Error("Service does not support query type");};c.query=async function(d,p){throw Error("Service does not support query");
};c._tiles=function*(){const d=Array.from(this._subscriptions.values());for(const p of d)yield p.tile};c.edit=async function(d,p){var v=Array.from(this._subscriptions.values());const l=v.map(({tile:u})=>u);for(const u of v)u.removeIds(p);d.length&&(v=l.map(u=>{const r=this.createTileQuery(u);r.objectIds=d;return{tile:u,query:r}}).map(async({tile:u,query:r})=>({tile:u,result:await this.query(r,{query:{tile:z("esri-tiles-debug")?u.id.replace(/\//g,"."):void 0}}),query:r})),v=(await D.eachAlwaysValues(v)).map(async({tile:u,
result:r})=>{(r.hasFeatures||p.length||d.length)&&(u=this._subscriptions.get(u.key.id))&&u.edit(r,d)}),await D.eachAlways(v));this._didEdit=!0};return n._createClass(f)}();q.DataTileSource=e;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/TimeExtent":function(){define("./chunks/_rollupPluginBabelHelpers ./chunks/tslib.es6 ./core/JSONSupport ./core/maybe ./core/timeUtils ./core/accessorSupport/decorators/property ./core/accessorSupport/ensureType ./core/arrayUtils ./core/has ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){var h;G=h=function(c){function d(v){v=p.call(this,v);v.end=null;v.start=null;return v}q._inherits(d,c);var p=q._createSuper(d);c=d.prototype;c.readEnd=function(v,l){return null!=l.end?new Date(l.end):null};c.writeEnd=function(v,l){l.end=v?v.getTime():null};c.readStart=function(v,l){return null!=l.start?new Date(l.start):null};c.writeStart=function(v,l){l.start=v?v.getTime():null};c.clone=function(){return new h({end:this.end,start:this.start})};c.equals=function(v){if(!v)return!1;
const l=F.isSome(this.start)?this.start.getTime():this.start,u=F.isSome(this.end)?this.end.getTime():this.end,r=F.isSome(v.start)?v.start.getTime():v.start;v=F.isSome(v.end)?v.end.getTime():v.end;return l===r&&u===v};c.expandTo=function(v){if(this.isEmpty||this.isAllTime)return this.clone();const l=F.applySome(this.start,r=>z.truncateDate(r,v)),u=F.applySome(this.end,r=>{const A=z.truncateDate(r,v);return r.getTime()===A.getTime()?A:z.offsetDate(A,1,v)});return new h({start:l,end:u})};c.intersection=
function(v){if(!v)return this.clone();if(this.isEmpty||v.isEmpty)return h.empty;if(this.isAllTime)return v.clone();if(v.isAllTime)return this.clone();var l=F.mapOr(this.start,-Infinity,m=>m.getTime());const u=F.mapOr(this.end,Infinity,m=>m.getTime()),r=F.mapOr(v.start,-Infinity,m=>m.getTime());v=F.mapOr(v.end,Infinity,m=>m.getTime());let A,w;r>=l&&r<=u?A=r:l>=r&&l<=v&&(A=l);u>=r&&u<=v?w=u:v>=l&&v<=u&&(w=v);return null==A||null==w||isNaN(A)||isNaN(w)?h.empty:(l=new h,l.start=-Infinity===A?null:new Date(A),
l.end=Infinity===w?null:new Date(w),l)};c.offset=function(v,l){if(this.isEmpty||this.isAllTime)return this.clone();const u=new h,{start:r,end:A}=this;F.isSome(r)&&(u.start=z.offsetDate(r,v,l));F.isSome(A)&&(u.end=z.offsetDate(A,v,l));return u};c.union=function(v){if(!v||v.isEmpty)return this.clone();if(this.isEmpty)return v.clone();if(this.isAllTime||v.isAllTime)return e.clone();const l=F.isSome(this.start)&&F.isSome(v.start)?new Date(Math.min(this.start.getTime(),v.start.getTime())):null;v=F.isSome(this.end)&&
F.isSome(v.end)?new Date(Math.max(this.end.getTime(),v.end.getTime())):null;return new h({start:l,end:v})};q._createClass(d,[{key:"isAllTime",get:function(){return this.equals(h.allTime)}},{key:"isEmpty",get:function(){return this.equals(h.empty)}}],[{key:"allTime",get:function(){return e}},{key:"empty",get:function(){return f}}]);return d}(G.JSONSupport);n.__decorate([y.property({type:Date,json:{write:{allowNull:!0}}})],G.prototype,"end",void 0);n.__decorate([g.reader("end")],G.prototype,"readEnd",
null);n.__decorate([a.writer("end")],G.prototype,"writeEnd",null);n.__decorate([y.property({readOnly:!0,json:{read:!1}})],G.prototype,"isAllTime",null);n.__decorate([y.property({readOnly:!0,json:{read:!1}})],G.prototype,"isEmpty",null);n.__decorate([y.property({type:Date,json:{write:{allowNull:!0}}})],G.prototype,"start",void 0);n.__decorate([g.reader("start")],G.prototype,"readStart",null);n.__decorate([a.writer("start")],G.prototype,"writeStart",null);G=h=n.__decorate([b.subclass("esri.TimeExtent")],
G);const e=new G,f=new G({start:void 0,end:void 0});return G})},"esri/core/timeUtils":function(){define(["exports","./has"],function(q,n){function G(y,D,x){return 0===y?0:y*F[D]/F[x]}const F={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8},z={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",
setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};q.convertTime=G;q.makeUTCTime=function(y,D,x=
"milliseconds"){D=new Date(G(D,x,"milliseconds"));D.setUTCFullYear(y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate());return D};q.offsetDate=function(y,D,x){y=new Date(y.getTime());if(D&&x){const {getter:g,setter:b,multiplier:a}=z[x];if("months"===x){x=y.getFullYear();var k=y.getMonth()+D;x=new Date(x,k+1,1);x.setDate(0);x=x.getDate();y.getDate()>x&&y.setDate(x)}y[b](y[g]()+D*a)}return y};q.offsetDateUTC=function(y,D,x="milliseconds"){y=y.getTime();D=G(D,x,"milliseconds");return new Date(y+D)};q.resetUTCDate=
function(y,D){y=new Date(y.getTime());y.setUTCFullYear(D.getFullYear(),D.getMonth(),D.getDate());return y};q.timeSinceUTCMidnight=function(y,D="milliseconds"){const x=G(y.getUTCHours(),"hours","milliseconds"),k=G(y.getUTCMinutes(),"minutes","milliseconds"),g=G(y.getUTCSeconds(),"seconds","milliseconds");y=y.getUTCMilliseconds();return G(x+k+g+y,"milliseconds",D)};q.truncateDate=function(y,D){switch(D){case "milliseconds":return new Date(y.getTime());case "seconds":return new Date(y.getFullYear(),
y.getMonth(),y.getDate(),y.getHours(),y.getMinutes(),y.getSeconds());case "minutes":return new Date(y.getFullYear(),y.getMonth(),y.getDate(),y.getHours(),y.getMinutes());case "hours":return new Date(y.getFullYear(),y.getMonth(),y.getDate(),y.getHours());case "days":return new Date(y.getFullYear(),y.getMonth(),y.getDate());case "weeks":return new Date(y.getFullYear(),y.getMonth(),y.getDate()-y.getDay());case "months":return new Date(y.getFullYear(),y.getMonth(),1);case "years":return new Date(y.getFullYear(),
0,1);case "decades":return new Date(y.getFullYear()-y.getFullYear()%10,0,1);case "centuries":return new Date(y.getFullYear()-y.getFullYear()%100,0,1);default:return new Date}};q.truncateLocalTime=function(y){const D=new Date(0);D.setHours(0);D.setMinutes(0);D.setSeconds(0);D.setMilliseconds(0);D.setFullYear(y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate());return D};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/Query":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./FullTextSearch ./QuantizationParameters ./StatisticDefinition ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u){var r;const A=new z.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});z=new z.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});y=r=function(w){function m(B){B=t.call(this,B);B.aggregateIds=null;B.cacheHint=void 0;B.compactGeometryEnabled=!1;B.datumTransformation=null;B.defaultSpatialReferenceEnabled=!1;B.distance=void 0;B.dynamicDataSource=void 0;B.formatOf3DObjects=null;B.fullText=null;B.gdbVersion=null;B.geometry=null;B.geometryPrecision=void 0;B.groupByFieldsForStatistics=null;
B.having=null;B.historicMoment=null;B.maxAllowableOffset=void 0;B.maxRecordCountFactor=1;B.multipatchOption=null;B.num=void 0;B.objectIds=null;B.orderByFields=null;B.outFields=null;B.outSpatialReference=null;B.outStatistics=null;B.parameterValues=null;B.pixelSize=null;B.quantizationParameters=null;B.rangeValues=null;B.relationParameter=null;B.resultType=null;B.returnCentroid=!1;B.returnDistinctValues=!1;B.returnExceededLimitFeatures=!0;B.returnGeometry=!1;B.returnQueryGeometry=!1;B.returnM=void 0;
B.returnZ=void 0;B.sourceSpatialReference=null;B.spatialRelationship="intersects";B.start=void 0;B.sqlFormat=null;B.text=null;B.timeExtent=null;B.timeReferenceUnknownClient=!1;B.units=null;B.where=null;return B}q._inherits(m,w);var t=q._createSuper(m);m.from=function(B){return e.ensureClass(r,B)};w=m.prototype;w.castDatumTransformation=function(B){return"number"===typeof B||"object"===typeof B?B:null};w.writeHistoricMoment=function(B,J){J.historicMoment=B&&B.getTime()};w.writeParameterValues=function(B,
J){if(B){const C={};for(const K in B){const E=B[K];Array.isArray(E)?C[K]=E.map(I=>I instanceof Date?I.getTime():I):C[K]=E instanceof Date?E.getTime():E}J.parameterValues=C}};w.writeStart=function(B,J){J.resultOffset=this.start;J.resultRecordCount=this.num||10;J.where="1\x3d1"};w.writeWhere=function(B,J){J.where=B||"1\x3d1"};w.clone=function(){return new r(D.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,
defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:x.isSome(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,
num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,
returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))};return q._createClass(m)}(y.JSONSupport);
y.MAX_MAX_RECORD_COUNT_FACTOR=5;n.__decorate([k.property({json:{write:!0}})],y.prototype,"aggregateIds",void 0);n.__decorate([k.property({type:Boolean,json:{write:!0}})],y.prototype,"cacheHint",void 0);n.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"compactGeometryEnabled",void 0);n.__decorate([k.property({json:{write:!0}})],y.prototype,"datumTransformation",void 0);n.__decorate([g.cast("datumTransformation")],y.prototype,"castDatumTransformation",null);n.__decorate([k.property({type:Boolean,
json:{default:!1,write:!0}})],y.prototype,"defaultSpatialReferenceEnabled",void 0);n.__decorate([k.property({type:Number,json:{write:{overridePolicy(w){return{enabled:0<w}}}}})],y.prototype,"distance",void 0);n.__decorate([k.property({type:c.DataLayerSource,json:{write:!0}})],y.prototype,"dynamicDataSource",void 0);n.__decorate([k.property({type:String,json:{write:!0}})],y.prototype,"formatOf3DObjects",void 0);n.__decorate([k.property({type:[d],json:{write:{enabled:!0,overridePolicy(){return{enabled:x.isSome(this.fullText)&&
0<this.fullText.length}}}}})],y.prototype,"fullText",void 0);n.__decorate([k.property({type:String,json:{write:!0}})],y.prototype,"gdbVersion",void 0);n.__decorate([k.property({types:G.geometryTypes,json:{read:f.fromJSON,write:!0}})],y.prototype,"geometry",void 0);n.__decorate([k.property({type:Number,json:{write:!0}})],y.prototype,"geometryPrecision",void 0);n.__decorate([k.property({type:[String],json:{write:!0}})],y.prototype,"groupByFieldsForStatistics",void 0);n.__decorate([k.property({type:String,
json:{write:!0}})],y.prototype,"having",void 0);n.__decorate([k.property({type:Date})],y.prototype,"historicMoment",void 0);n.__decorate([h.writer("historicMoment")],y.prototype,"writeHistoricMoment",null);n.__decorate([k.property({type:Number,json:{write:!0}})],y.prototype,"maxAllowableOffset",void 0);n.__decorate([k.property({type:Number,cast(w){return 1>w?1:w>r.MAX_MAX_RECORD_COUNT_FACTOR?r.MAX_MAX_RECORD_COUNT_FACTOR:w},json:{write:{overridePolicy(w){return{enabled:1<w}}}}})],y.prototype,"maxRecordCountFactor",
void 0);n.__decorate([k.property({type:["xyFootprint"],json:{write:!0}})],y.prototype,"multipatchOption",void 0);n.__decorate([k.property({type:Number,json:{read:{source:"resultRecordCount"}}})],y.prototype,"num",void 0);n.__decorate([k.property({json:{write:!0}})],y.prototype,"objectIds",void 0);n.__decorate([k.property({type:[String],json:{write:!0}})],y.prototype,"orderByFields",void 0);n.__decorate([k.property({type:[String],json:{write:!0}})],y.prototype,"outFields",void 0);n.__decorate([k.property({type:l,
json:{name:"outSR",write:!0}})],y.prototype,"outSpatialReference",void 0);n.__decorate([k.property({type:[v],json:{write:{enabled:!0,overridePolicy(){return{enabled:x.isSome(this.outStatistics)&&0<this.outStatistics.length}}}}})],y.prototype,"outStatistics",void 0);n.__decorate([k.property({json:{write:!0}})],y.prototype,"parameterValues",void 0);n.__decorate([h.writer("parameterValues")],y.prototype,"writeParameterValues",null);n.__decorate([k.property({type:u,json:{write:!0}})],y.prototype,"pixelSize",
void 0);n.__decorate([k.property({type:p,json:{write:!0}})],y.prototype,"quantizationParameters",void 0);n.__decorate([k.property({type:[Object],json:{write:!0}})],y.prototype,"rangeValues",void 0);n.__decorate([k.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],y.prototype,"relationParameter",void 0);n.__decorate([k.property({type:String,json:{write:!0}})],y.prototype,"resultType",
void 0);n.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"returnCentroid",void 0);n.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"returnDistinctValues",void 0);n.__decorate([k.property({type:Boolean,json:{default:!0,write:!0}})],y.prototype,"returnExceededLimitFeatures",void 0);n.__decorate([k.property({type:Boolean,json:{write:!0}})],y.prototype,"returnGeometry",void 0);n.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],
y.prototype,"returnQueryGeometry",void 0);n.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"returnM",void 0);n.__decorate([k.property({type:Boolean,json:{write:{overridePolicy(w){return{enabled:w}}}}})],y.prototype,"returnZ",void 0);n.__decorate([k.property({type:l,json:{write:!0}})],y.prototype,"sourceSpatialReference",void 0);n.__decorate([b.enumeration(A,{ignoreUnknown:!1,name:"spatialRel"})],y.prototype,"spatialRelationship",void 0);n.__decorate([k.property({type:Number,
json:{read:{source:"resultOffset"}}})],y.prototype,"start",void 0);n.__decorate([h.writer("start"),h.writer("num")],y.prototype,"writeStart",null);n.__decorate([k.property({type:String,json:{write:!0}})],y.prototype,"sqlFormat",void 0);n.__decorate([k.property({type:String,json:{write:!0}})],y.prototype,"text",void 0);n.__decorate([k.property({type:F,json:{write:!0}})],y.prototype,"timeExtent",void 0);n.__decorate([k.property({type:Boolean,json:{default:!1,write:!0}})],y.prototype,"timeReferenceUnknownClient",
void 0);n.__decorate([b.enumeration(z,{ignoreUnknown:!1}),k.property({json:{write:{overridePolicy(w){return{enabled:!!w&&null!=this.distance&&0<this.distance}}}}})],y.prototype,"units",void 0);n.__decorate([k.property({type:String,json:{write:{overridePolicy(w){return{enabled:null!=w||null!=this.start&&0<this.start}}}}})],y.prototype,"where",void 0);n.__decorate([h.writer("where")],y.prototype,"writeWhere",null);return y=r=n.__decorate([a.subclass("esri.rest.support.Query")],y)})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d){function p(){r||(r=a.createTypeReader({types:v()}));return r}function v(){A||(A={key:"type",base:null,typeMap:{"data-layer":q.DataLayerSource,"map-layer":e.MapLayerSource}});return A}var l,u;F=F.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});q.JoinTableDataSource=l=function(w){function m(B){B=t.call(this,B);B.type="join-table";return B}n._inherits(m,w);var t=n._createSuper(m);w=m.prototype;w.readLeftTableSource=function(B,
J,C){return p()(B,J,C)};w.castLeftTableSource=function(B){return b.ensureOneOfType(v(),B)};w.readRightTableSource=function(B,J,C){return p()(B,J,C)};w.castRightTableSource=function(B){return b.ensureOneOfType(v(),B)};w.clone=function(){const {leftTableKey:B,rightTableKey:J,leftTableSource:C,rightTableSource:K,joinType:E}=this,I={leftTableKey:B,rightTableKey:J,leftTableSource:C?.clone()??void 0,rightTableSource:K?.clone()??void 0,joinType:E};return new l(I)};return n._createClass(m)}(z.JSONSupport);
G.__decorate([x.enumeration({joinTable:"join-table"})],q.JoinTableDataSource.prototype,"type",void 0);G.__decorate([y.property({type:String,json:{write:!0}})],q.JoinTableDataSource.prototype,"leftTableKey",void 0);G.__decorate([y.property({type:String,json:{write:!0}})],q.JoinTableDataSource.prototype,"rightTableKey",void 0);G.__decorate([y.property({json:{write:!0}})],q.JoinTableDataSource.prototype,"leftTableSource",void 0);G.__decorate([k.reader("leftTableSource")],q.JoinTableDataSource.prototype,
"readLeftTableSource",null);G.__decorate([D.cast("leftTableSource")],q.JoinTableDataSource.prototype,"castLeftTableSource",null);G.__decorate([y.property({json:{write:!0}})],q.JoinTableDataSource.prototype,"rightTableSource",void 0);G.__decorate([k.reader("rightTableSource")],q.JoinTableDataSource.prototype,"readRightTableSource",null);G.__decorate([D.cast("rightTableSource")],q.JoinTableDataSource.prototype,"castRightTableSource",null);G.__decorate([x.enumeration(F)],q.JoinTableDataSource.prototype,
"joinType",void 0);q.JoinTableDataSource=l=G.__decorate([g.subclass("esri.layers.support.source.JoinTableDataSource")],q.JoinTableDataSource);let r=null,A=null;D={key:"type",base:null,typeMap:{"join-table":q.JoinTableDataSource,"query-table":f.QueryTableDataSource,raster:c.RasterDataSource,table:d.TableDataSource}};q.DataLayerSource=u=function(w){function m(B){B=t.call(this,B);B.type="data-layer";return B}n._inherits(m,w);var t=n._createSuper(m);m.prototype.clone=function(){const {fields:B,dataSource:J}=
this;return new u({fields:B,dataSource:J})};return n._createClass(m)}(z.JSONSupport);G.__decorate([x.enumeration({dataLayer:"data-layer"})],q.DataLayerSource.prototype,"type",void 0);G.__decorate([y.property({type:[h],json:{write:!0}})],q.DataLayerSource.prototype,"fields",void 0);G.__decorate([y.property({types:D,json:{write:!0}})],q.DataLayerSource.prototype,"dataSource",void 0);q.DataLayerSource=u=G.__decorate([g.subclass("esri.layers.support.source.DataLayerSource")],q.DataLayerSource);q.DataLayerSource.from=
b.ensureType(q.DataLayerSource);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Field":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h){var e;const f=new G.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});G=e=function(c){function d(v){v=p.call(this,v);v.alias=
null;v.defaultValue=void 0;v.description=null;v.domain=null;v.editable=!0;v.length=-1;v.name=null;v.nullable=!0;v.type=null;v.valueType=null;v.visible=!0;return v}q._inherits(d,c);var p=q._createSuper(d);c=d.prototype;c.readDescription=function(v,{description:l}){v=null;try{v=l?JSON.parse(l):null}catch(u){}return v?.value??null};c.readValueType=function(v,{description:l}){v=null;try{v=l?JSON.parse(l):null}catch(u){}return v?f.fromJSON(v.fieldValueType):null};c.clone=function(){return new e({alias:this.alias,
defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})};return q._createClass(d)}(F.JSONSupport);n.__decorate([z.property({type:String,json:{write:!0}})],G.prototype,"alias",void 0);n.__decorate([z.property({type:[String,Number],json:{write:{allowNull:!0}}})],G.prototype,"defaultValue",void 0);n.__decorate([z.property()],
G.prototype,"description",void 0);n.__decorate([g.reader("description")],G.prototype,"readDescription",null);n.__decorate([z.property({types:a.types,json:{read:{reader:a.fromJSON},write:!0}})],G.prototype,"domain",void 0);n.__decorate([z.property({type:Boolean,json:{write:!0}})],G.prototype,"editable",void 0);n.__decorate([z.property({type:y.Integer,json:{write:!0}})],G.prototype,"length",void 0);n.__decorate([z.property({type:String,json:{write:!0}})],G.prototype,"name",void 0);n.__decorate([z.property({type:Boolean,
json:{write:!0}})],G.prototype,"nullable",void 0);n.__decorate([k.enumeration(h.kebabDict)],G.prototype,"type",void 0);n.__decorate([z.property()],G.prototype,"valueType",void 0);n.__decorate([g.reader("valueType",["description"])],G.prototype,"readValueType",null);n.__decorate([z.property({type:Boolean,json:{read:!1}})],G.prototype,"visible",void 0);return G=e=n.__decorate([b.subclass("esri.layers.support.Field")],G)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),
function(q,n,G,F,z,y){n={key:"type",base:F,typeMap:{range:y,"coded-value":G,inherited:z}};q.CodedValueDomain=G;q.DomainBase=F;q.InheritedDomain=z;q.RangeDomain=y;q.fromJSON=function(D){if(!D||!D.type)return null;switch(D.type){case "range":return y.fromJSON(D);case "codedValue":return G.fromJSON(D);case "inherited":return z.fromJSON(D)}return null};q.types=n;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(q,n,G,F,z,y,D,x,k){var g;z=g=function(b){function a(e){e=h.call(this,e);e.codedValues=null;e.type="coded-value";return e}q._inherits(a,b);var h=q._createSuper(a);b=a.prototype;b.getName=function(e){let f=null;if(this.codedValues){const c=String(e);this.codedValues.some(d=>{String(d.code)===c&&(f=d.name);return!!f})}return f};b.clone=function(){return new g({codedValues:G.clone(this.codedValues),name:this.name})};return q._createClass(a)}(k);n.__decorate([F.property({type:[x.CodedValue],json:{write:!0}})],
z.prototype,"codedValues",void 0);n.__decorate([y.enumeration({codedValue:"coded-value"})],z.prototype,"type",void 0);return z=g=n.__decorate([D.subclass("esri.layers.support.CodedValueDomain")],z)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k){var g;q.CodedValue=g=function(b){function a(e){e=h.call(this,e);e.name=null;e.code=null;return e}n._inherits(a,b);var h=n._createSuper(a);a.prototype.clone=function(){return new g({name:this.name,code:this.code})};return n._createClass(a)}(F.JSONSupport);G.__decorate([z.property({type:String,json:{write:!0}})],q.CodedValue.prototype,"name",void 0);G.__decorate([z.property({type:[String,Number],json:{write:!0}})],q.CodedValue.prototype,"code",void 0);q.CodedValue=g=G.__decorate([k.subclass("esri.layers.support.CodedValue")],
q.CodedValue);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(q,n,G,F,z,y,D,x,k,g){G=new G.JSONMap({inherited:"inherited",
codedValue:"coded-value",range:"range"});F=function(b){function a(e){e=h.call(this,e);e.name=null;e.type=null;return e}q._inherits(a,b);var h=q._createSuper(a);return q._createClass(a)}(F.JSONSupport);n.__decorate([z.property({type:String,json:{write:!0}})],F.prototype,"name",void 0);n.__decorate([k.enumeration(G)],F.prototype,"type",void 0);return F=n.__decorate([g.subclass("esri.layers.support.Domain")],F)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(q,n,G,F,z,y,D,x,k,g){var b;G=b=function(a){function h(f){f=e.call(this,f);f.type="inherited";return f}q._inherits(h,a);var e=q._createSuper(h);h.prototype.clone=function(){return new b};return q._createClass(h)}(g);n.__decorate([x.enumeration({inherited:"inherited"})],G.prototype,"type",void 0);return G=b=n.__decorate([k.subclass("esri.layers.support.InheritedDomain")],G)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(q,n,G,F,z,y,D,x,k){var g;F=g=function(b){function a(e){e=h.call(this,e);e.maxValue=null;e.minValue=null;e.type="range";return e}q._inherits(a,b);var h=q._createSuper(a);a.prototype.clone=function(){return new g({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};return q._createClass(a)}(k);n.__decorate([G.property({type:Number,json:{type:[Number],read:{source:"range",reader(b,a){return a.range&&a.range[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&
null==this.minValue}},target:"range",writer(b,a,h){a[h]=[this.minValue||0,b]}}}})],F.prototype,"maxValue",void 0);n.__decorate([G.property({type:Number,json:{type:[Number],read:{source:"range",reader(b,a){return a.range&&a.range[0]}},write:{target:"range",writer(b,a,h){a[h]=[b,this.maxValue||0]}}}})],F.prototype,"minValue",void 0);n.__decorate([D.enumeration({range:"range"})],F.prototype,"type",void 0);return F=g=n.__decorate([x.subclass("esri.layers.support.RangeDomain")],F)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k,g){var b;q.MapLayerSource=b=function(a){function h(f){f=e.call(this,f);f.type="map-layer";return f}n._inherits(h,a);var e=n._createSuper(h);h.prototype.clone=function(){const {mapLayerId:f,gdbVersion:c}=this;return new b({mapLayerId:f,gdbVersion:c})};return n._createClass(h)}(F.JSONSupport);G.__decorate([k.enumeration({mapLayer:"map-layer"})],q.MapLayerSource.prototype,"type",void 0);G.__decorate([z.property({type:y.Integer,json:{write:!0}})],q.MapLayerSource.prototype,
"mapLayerId",void 0);G.__decorate([z.property({type:String,json:{write:!0}})],q.MapLayerSource.prototype,"gdbVersion",void 0);q.MapLayerSource=b=G.__decorate([g.subclass("esri.layers.support.source.MapLayerSource")],q.MapLayerSource);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h){var e;q.QueryTableDataSource=e=function(f){function c(p){p=d.call(this,p);p.type="query-table";return p}n._inherits(c,f);var d=n._createSuper(c);c.prototype.clone=function(){const {workspaceId:p,query:v,oidFields:l,spatialReference:u,geometryType:r}=this,A={workspaceId:p,query:v,oidFields:l,spatialReference:u?.clone()??void 0,geometryType:r};return new e(A)};return n._createClass(c)}(z.JSONSupport);G.__decorate([g.enumeration({queryTable:"query-table"})],q.QueryTableDataSource.prototype,
"type",void 0);G.__decorate([y.property({type:String,json:{write:!0}})],q.QueryTableDataSource.prototype,"workspaceId",void 0);G.__decorate([y.property({type:String,json:{write:!0}})],q.QueryTableDataSource.prototype,"query",void 0);G.__decorate([y.property({type:String,json:{write:!0}})],q.QueryTableDataSource.prototype,"oidFields",void 0);G.__decorate([y.property({type:a,json:{write:!0}})],q.QueryTableDataSource.prototype,"spatialReference",void 0);G.__decorate([g.enumeration(h.featureGeometryTypeKebabDictionary)],
q.QueryTableDataSource.prototype,"geometryType",void 0);q.QueryTableDataSource=e=G.__decorate([b.subclass("esri.layers.support.source.QueryTableDataSource")],q.QueryTableDataSource);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k,g){var b;q.RasterDataSource=b=function(a){function h(f){f=e.call(this,f);f.type="raster";return f}n._inherits(h,a);var e=n._createSuper(h);h.prototype.clone=function(){const {workspaceId:f,dataSourceName:c}=this;return new b({workspaceId:f,dataSourceName:c})};return n._createClass(h)}(F.JSONSupport);G.__decorate([k.enumeration({raster:"raster"})],q.RasterDataSource.prototype,"type",void 0);G.__decorate([z.property({type:String,json:{write:!0}})],q.RasterDataSource.prototype,
"dataSourceName",void 0);G.__decorate([z.property({type:String,json:{write:!0}})],q.RasterDataSource.prototype,"workspaceId",void 0);q.RasterDataSource=b=G.__decorate([g.subclass("esri.layers.support.source.RasterDataSource")],q.RasterDataSource);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k,g){var b;q.TableDataSource=b=function(a){function h(f){f=e.call(this,f);f.type="table";return f}n._inherits(h,a);var e=n._createSuper(h);h.prototype.clone=function(){const {workspaceId:f,gdbVersion:c,dataSourceName:d}=this;return new b({workspaceId:f,gdbVersion:c,dataSourceName:d})};return n._createClass(h)}(F.JSONSupport);G.__decorate([k.enumeration({table:"table"})],q.TableDataSource.prototype,"type",void 0);G.__decorate([z.property({type:String,json:{write:!0}})],q.TableDataSource.prototype,
"workspaceId",void 0);G.__decorate([z.property({type:String,json:{write:!0}})],q.TableDataSource.prototype,"gdbVersion",void 0);G.__decorate([z.property({type:String,json:{write:!0}})],q.TableDataSource.prototype,"dataSourceName",void 0);q.TableDataSource=b=G.__decorate([g.subclass("esri.layers.support.source.TableDataSource")],q.TableDataSource);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/FullTextSearch":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k,g){G=function(b){function a(e){e=h.call(this,e);e.onFields=null;e.operator=null;e.searchTerm=null;e.searchType=null;return e}q._inherits(a,b);var h=q._createSuper(a);return q._createClass(a)}(G.ClonableMixin(F.JSONSupport));n.__decorate([y.property({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:z.isSome(this.onFields)&&0<this.onFields.length}}}}})],G.prototype,"onFields",void 0);n.__decorate([y.property({type:String,json:{write:!0}})],G.prototype,
"operator",void 0);n.__decorate([y.property({type:String,json:{write:!0}})],G.prototype,"searchTerm",void 0);n.__decorate([y.property({type:String,json:{write:!0}})],G.prototype,"searchType",void 0);return G=n.__decorate([g.subclass("esri.rest.support.FullTextSearch")],G)})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),
function(q,n,G,F,z,y,D,x,k,g){var b;G=new F.JSONMap({upperLeft:"upper-left",lowerLeft:"lower-left"});z=b=function(a){function h(f){f=e.call(this,f);f.extent=null;f.mode="view";f.originPosition="upper-left";f.tolerance=1;return f}q._inherits(h,a);var e=q._createSuper(h);h.prototype.clone=function(){return new b(y.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};return q._createClass(h)}(z.JSONSupport);n.__decorate([D.property({type:g,json:{write:{overridePolicy(){return{enabled:"view"===
this.mode}}}}})],z.prototype,"extent",void 0);n.__decorate([D.property({type:["view","edit"],json:{write:!0}})],z.prototype,"mode",void 0);n.__decorate([D.property({type:String,json:{read:G.read,write:G.write}})],z.prototype,"originPosition",void 0);n.__decorate([D.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],z.prototype,"tolerance",void 0);return z=b=n.__decorate([k.subclass("esri.rest.support.QuantizationParameters")],z)})},"esri/rest/support/StatisticDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(q,n,G,F,z,y,D,x,k){var g;G=new G.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});F=g=function(b){function a(e){e=h.call(this,e);e.maxPointCount=void 0;e.maxRecordCount=void 0;e.maxVertexCount=void 0;e.onStatisticField=null;
e.outStatisticFieldName=null;e.statisticType=null;e.statisticParameters=null;return e}q._inherits(a,b);var h=q._createSuper(a);b=a.prototype;b.writeStatisticParameters=function(e,f){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)f.statisticParameters=z.clone(e)};b.clone=function(){return new g({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,
statisticType:this.statisticType,statisticParameters:z.clone(this.statisticParameters)})};return q._createClass(a)}(F.JSONSupport);n.__decorate([y.property({type:Number,json:{write:!0}})],F.prototype,"maxPointCount",void 0);n.__decorate([y.property({type:Number,json:{write:!0}})],F.prototype,"maxRecordCount",void 0);n.__decorate([y.property({type:Number,json:{write:!0}})],F.prototype,"maxVertexCount",void 0);n.__decorate([y.property({type:String,json:{write:!0}})],F.prototype,"onStatisticField",void 0);
n.__decorate([y.property({type:String,json:{write:!0}})],F.prototype,"outStatisticFieldName",void 0);n.__decorate([y.property({type:String,json:{read:{source:"statisticType",reader:G.read},write:{target:"statisticType",writer:G.write}}})],F.prototype,"statisticType",void 0);n.__decorate([y.property({type:Object})],F.prototype,"statisticParameters",void 0);n.__decorate([k.writer("statisticParameters")],F.prototype,"writeStatisticParameters",null);return F=g=n.__decorate([x.subclass("esri.rest.support.StatisticDefinition")],
F)})},"esri/views/2d/layers/features/sources/DataTileSubscription":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/CircularArray ../../../../../core/has ../../../../../core/maybe ../../../../../core/promiseUtils ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),function(q,n,G,F,z,y,D,x){let k=function(){function g(a,h){this.requests={done:[],stream:new G(10)};this._edits=null;this._abortController=new AbortController;this._version=0;
this._resolver=y.createResolver();this.didSend=!1;this.tile=a;this._version=h}var b=g.prototype;b.resolve=function(){this._resolver.resolve()};b.clear=function(){this.requests.done=[]};b.applyUpdate=function(a){this.requests.done.forEach(h=>h.message.status.unset(a));this._version=a.version;z.isSome(this._edits)&&this._edits.status.unset(a)};b.add=function(a){a.message.status=a.message.status??x.UpdateToken.empty();a.message.status.version=this._version;F("esri-2d-update-debug")&&console.debug(this.tile.id,
"DataTileSubscription:add",this._version);a.message.end&&(this.requests.done.forEach(h=>{z.isSome(h.message)&&h.message.end&&(h.message.end=!1)}),this._resolver.resolve());this.requests.done.push(a)};b.edit=function(a,h){const e=a.getQuantizationTransform(),f=a.fullSchema(),c=Array.from(a.features()).filter(z.isSome),d=c.map(p=>p.objectId);h=[...h,...d];this.removeIds(h);this._invalidate();z.isNone(this._edits)?this._edits={type:"append",addOrUpdate:D.FeatureSetReaderJSON.fromOptimizedFeatures(c,
f,z.unwrap(e)),id:this.tile.id,status:x.UpdateToken.empty(),end:!0}:(this.requests.done.forEach(p=>p.message.end=!1),z.unwrap(this._edits.addOrUpdate).append(a.features()))};b.readers=function*(){for(const {message:a}of this.requests.done)z.isSome(a.addOrUpdate)&&(yield a.addOrUpdate);z.isSome(this._edits)&&z.isSome(this._edits.addOrUpdate)&&(yield this._edits.addOrUpdate)};b._invalidate=function(){for(const a of this.requests.done)a.message.status=x.UpdateToken.empty();z.isSome(this._edits)&&(this._edits.status=
x.UpdateToken.empty())};b.removeIds=function(a){this._invalidate();for(const {message:h}of this.requests.done){const e=h.addOrUpdate;z.isSome(e)&&(e.removeIds(a),e.isEmpty&&(F("esri-2d-update-debug")&&console.debug("Removing FeatureSetReader"),h.addOrUpdate=null))}z.isSome(this._edits)&&z.isSome(this._edits.addOrUpdate)&&this._edits.addOrUpdate.removeIds(a);this.requests.done=this.requests.done.filter(h=>h.message.addOrUpdate||h.message.end)};b.abort=function(){this._abortController.abort();this._resolver.reject()};
n._createClass(g,[{key:"signal",get:function(){return this._abortController.signal}},{key:"options",get:function(){return{signal:this._abortController.signal}}},{key:"empty",get:function(){return!this.requests.done.length&&z.isNone(this.edits)}},{key:"edits",get:function(){return this._edits}},{key:"done",get:function(){return this._resolver.promise}}]);return g}();q.DataTileSubscription=k;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/UpdateToken":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers"],function(q,n){let G=function(){function F(){this.version=0;this.source=!1;this.targets={feature:!1,aggregate:!1};this.storage={filters:!1,data:!1};this.queryFilter=this.mesh=!1;this.why={mesh:[],source:[]}}F.create=function(y){const D=new F;for(const x in y){const k=y[x];if("object"===typeof k)for(const g in k)D[x][g]=k[g];D[x]=k}return D};F.empty=function(){return F.create({})};F.all=function(){return F.create({source:!0,targets:{feature:!0,aggregate:!0},
storage:{filters:!0,data:!0},mesh:!0})};var z=F.prototype;z.unset=function(y){this.version=y.version;y.source&&(this.source=!1);y.targets.feature&&(this.targets.feature=!1);y.targets.aggregate&&(this.targets.aggregate=!1);y.storage.filters&&(this.storage.filters=!1);y.storage.data&&(this.storage.data=!1);y.mesh&&(this.mesh=!1);y.queryFilter&&(this.queryFilter=!1)};z.any=function(){return this.source||this.mesh||this.storage.filters||this.storage.data||this.targets.feature||this.targets.aggregate||
this.queryFilter};z.describe=function(){let y=0,D="";if(this.mesh){y+=20;D+="-\x3e (20) Mesh needs update\n";for(const x of this.why.mesh)D+=`    + ${x}\n`}if(this.source){y+=10;D+="-\x3e (10) The source needs update\n";for(const x of this.why.source)D+=`    + ${x}\n`}this.targets.feature&&(y+=5,D+="-\x3e (5) Feature target parameters changed\n");this.storage.filters&&(y+=5,D+="-\x3e (5) Feature filter parameters changed\n");this.targets.aggregate&&(y+=4,D+="-\x3e (4) Aggregate target parameters changed\n");
this.storage.data&&(y+=1,D+="-\x3e (1) Texture storage parameters changed");console.debug(`Applying ${5>y?"Fastest":10>y?"Fast":15>y?"Moderate":20>y?"Slow":"Very Slow"} update of cost ${y}/45 `);console.debug(D)};z.toJSON=function(){return{queryFilter:this.queryFilter,source:this.source,targets:this.targets,storage:this.storage,mesh:this.mesh}};return n._createClass(F)}();q.UpdateToken=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/QueueProcessor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),
function(q,n,G,F,z,y){let D=n._createClass(function(k,g){this.item=k;this.controller=g;this.promise=null}),x=function(){function k(b){this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;b.concurrency&&(this.concurrency=b.concurrency);this._queue=new z(b.peeker);this.process=b.process;const a=b.scheduler;b.priority&&G.isSome(a)&&(this._task=a.registerTask(b.priority,this))}var g=k.prototype;g.destroy=function(){this.clear();
this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};g.abort=function(b){(b=this._controllers.get(b))&&b.abort()};g.clear=function(){this._queue.clear();const b=[];this._controllers.forEach(a=>b.push(a));this._controllers.clear();b.forEach(a=>a.abort());this._processingItems.clear();this._cancelNext()};g.forEach=function(b){this._deferreds.forEach((a,h)=>b(h))};g.get=function(b){return(b=this._deferreds.get(b))?b.promise:void 0};g.isOngoing=
function(b){return this._processingItems.has(b)};g.has=function(b){return this._deferreds.has(b)};g.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};g.push=function(b,a){const h=this.get(b);if(h)return h;const e=new AbortController;let f=null;a&&(f=F.onAbort(a,()=>e.abort()));const c=()=>{d.remove();G.isSome(f)&&f.remove();this._deferreds.delete(b);this._controllers.delete(b);this._queue.remove(b);this._processingItems.delete(b);this._scheduleNext()},d=F.onAbortOrThrow(e.signal,
()=>{const v=this._processingItems.get(b);v&&v.controller.abort();c();p.reject(F.createAbortError())}),p=F.createDeferred();this._deferreds.set(b,p);this._controllers.set(b,e);p.promise.then(c,c);this._queue.push(b);this._scheduleNext();return p.promise};g.last=function(){return this._queue.last()};g.peek=function(){return this._queue.peek()};g.popLast=function(){return this._queue.popLast()};g.reset=function(){const b=[];this._processingItems.forEach(a=>b.push(a));this._processingItems.clear();for(const a of b)this._queue.push(a.item),
a.controller.abort();this._scheduleNext()};g.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};g.takeAll=function(){const b=[];for(;this._queue.length;)b.push(this._queue.pop());this.clear();return b};g.runTask=function(b){for(;!b.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),b.madeProgress()};g._scheduleNext=function(){this._task||this._isPaused||this._schedule||(this._schedule=y.schedule(()=>{this._schedule=null;
this._next()}))};g._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};g._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};g._processResult=function(b,a){this._canProcessFulfillment(b)&&(this._scheduleNext(),this._deferreds.get(b.item).resolve(a))};g._processError=function(b,a){this._canProcessFulfillment(b)&&(this._scheduleNext(),this._deferreds.get(b.item).reject(a))};g._canProcessFulfillment=
function(b){return this._deferreds.get(b.item)&&this._processingItems.get(b.item)===b?!0:!1};g._process=function(b){if(!G.isNone(b)){var a=new AbortController,h=new D(b,a);this._processingItems.set(b,h);try{var e=this.process(b,a.signal)}catch(f){this._processError(h,f)}F.isPromiseLike(e)?(h.promise=e,e.then(f=>this._processResult(h,f),f=>this._processError(h,f))):this._processResult(h,e)}};n._createClass(k,[{key:"length",get:function(){return this._processingItems.size+this._queue.length}},{key:"running",
get:function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency}},{key:"test",get:function(){return{update:b=>this.runTask(b)}}}]);return k}();q.QueueProcessor=x;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/PagedFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ./BaseFeatureSource".split(" "),
function(q,n,G,F,z,y,D){D=function(x){function k(b){return g.call(this,b)}n._inherits(k,x);var g=n._createSuper(k);x=k.prototype;x._fetchDataTile=async function(b){const a=this._subscriptions.get(b.key.id);let h=!1,e=0,f=0;const c=(v,l)=>{f--;y.throwIfAborted(a);const u=b.id,r=v.reader;v=v.query;r.exceededTransferLimit?(l={id:u,addOrUpdate:r,end:h&&0===f,type:"append"},a.add({message:l,query:v}),this._onMessage(l)):(h=!0,l={id:u,addOrUpdate:r,end:0===f,type:"append"},a.add({message:l,query:v}),this._onMessage(l))};
let d=0,p=0;for(;!h&&20>p++;){let v;for(let l=0;l<d+1;l++){const u=e++;f++;v=this._fetchDataTilePage(b,u,a).then(r=>r&&c(r,u)).catch(r=>{h=!0;y.isAbortError(r)||(F.getLogger("esri.views.2d.layers.features.sources.PagedFeatureSource").error(new G("mapview-query-error","Encountered error when fetching tile",{tile:b,error:r})),this._onMessage({id:b.id,addOrUpdate:null,end:h,type:"append"}))})}await v;y.throwIfAborted(a);d=Math.min(d+2,6)}};x._fetchDataTilePage=async function(b,a,h){y.throwIfAborted(h);
const e=this._queryInfo;var f={start:this.pageSize*a,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:b.getQuantizationParameters()};z.isSome(this.maxRecordCountFactor)&&(f.maxRecordCountFactor=this.maxRecordCountFactor);f=this.createTileQuery(b,f);try{const c=await this.enqueueQuery({tile:b,query:f,signal:h.signal,depth:a});y.throwIfAborted(h);return c?e!==this._queryInfo?this._fetchDataTilePage(b,a,h):{reader:c,query:f}:null}catch(c){return y.throwIfNotAbortError(c),null}};
return n._createClass(k)}(D.BaseFeatureSource);q.PagedFeatureSource=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/SnapshotFeatureSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ./BaseFeatureSource ../support/FeatureSetReaderPBFIndirect ../support/UpdateToken".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){function h(f,c,d){var p=f.getXHydrated();f=f.getYHydrated();p=c.getColumnForX(p);p=Math.floor(c.normalizeCol(p));c=Math.floor(c.getRowForY(f));return`${d}/${c}/${p}`}function e(f,c){if(y.isNone(f))return null;c=c.transform;const d=f.getQuantizationTransform();if(y.isNone(d)){const [t,B]=c.scale,[J,C]=c.translate;return f.transform(-J/t,C/B,1/t,1/-B)}const [p,v]=d.scale,[l,u]=d.translate,[r,A]=c.scale,[w,m]=c.translate;return f.transform((l-w)/r,(-u+m)/A,p/r,v/A)}
q.SnapshotFeatureSource=function(f){function c(p){var v=d.call(this,p);v.mode="snapshot";v._loading=!0;v._controller=new AbortController;v._downloadPromise=null;v._didSendEnd=!1;v._queries=[];v._invalidated=!1;v._hasAggregates=!1;v._random=new x(1E3);v._store=p.store;v._markedIdsBufId=v._store.storage.createBitset();return v}n._inherits(c,f);var d=n._createSuper(c);f=c.prototype;f.destroy=function(){n._get(n._getPrototypeOf(c.prototype),"destroy",this).call(this);this._controller.abort()};f.update=
function(p,v){n._get(n._getPrototypeOf(c.prototype),"update",this).call(this,p,v);null==this._featureCount&&(this._featureCount=v.initialFeatureCount);y.isSome(v.changedFeatureCount)&&(this._featureCount=v.changedFeatureCount);this._hasAggregates=!!p.targets?.aggregate};f.resend=async function(p=!1){await this._downloadPromise;this._invalidated||p?(p=y.unwrapOrThrow(this._featureCount,"Expected featureCount to be defined"),this._invalidated=!1,this._subscriptions.forEach(v=>v.clear()),this._downloadPromise=
this._download(p),await this._downloadPromise):(p=this._queries.map(({query:v,reader:l})=>this._sendPatchQuery(v,l)),await Promise.all(p),this._subscriptions.forEach(v=>{v.requests.done.forEach(l=>this._onMessage(l.message))}))};f.refresh=async function(p,v){v&&(this._featureCount=v.featureCount);await this.resend(!0)};f._sendPatchQuery=async function(p,v){const l=y.isSome(p.outFields)?p.outFields:[],u=this._queryInfo.outFields,r=u.filter(m=>!l.includes(m));if(r.length){var A=p.clone(),w=this._signal;
A.returnGeometry=!1;A.returnCentroid=!1;A.outFields=r;p.outFields=u;p=await this.enqueueQuery({query:A,depth:0,signal:w});D.throwIfAborted({signal:w});v.joinAttributes(p)}};f._fetchDataTile=async function(p){if(!this._downloadPromise){var v=y.unwrapOrThrow(this._featureCount,"Expected featureCount to be defined");this._downloadPromise=this._download(v)}var l=this._store.search(p);v=this._subscriptions.get(p.key.id);const u=l.length-1;for(let A=0;A<u;A++){var r=e(l[A],p);r={type:"append",id:p.id,addOrUpdate:r,
end:!1,status:a.UpdateToken.empty()};v.add({query:null,message:r});this._hasAggregates||await D.after(1);this._onMessage(r)}l=e(0<=u?l[u]:null,p);p={type:"append",id:p.id,addOrUpdate:l,end:this._didSendEnd,status:a.UpdateToken.empty()};v.add({query:null,message:p});this._onMessage(p)};f._download=async function(p){try{await this.whenInitialized();const v=this._store.storage.getBitset(this._markedIdsBufId),l=new Set;v.clear();const u=Array.from({length:Math.ceil(p/this.pageSize)},(r,A)=>A).sort((r,
A)=>this._random.getInt()-this._random.getInt()).map(r=>this._downloadPage(r,v,l));await Promise.all(u);this._store.sweepFeatures(v,this._store.storage);this._store.sweepFeatureSets(l)}catch(v){z.getLogger("esri.views.2d.layers.features.sources.SnapshotFeatureSource").error("mapview-snapshot-source","Encountered and error when downloading feature snapshot",v)}this._sendEnd();this._loading=!1};f._downloadPage=async function(p,v,l){var u=this.pageSize;u={start:p*u,num:u,cacheHint:!0};y.isSome(this.maxRecordCountFactor)&&
(u.maxRecordCountFactor=this.maxRecordCountFactor);u=this.createQuery(u);const r=this._signal;p=await this.enqueueQuery({query:u,depth:p,signal:r});D.throwIfAborted({signal:r});this._queries.push({query:u,reader:p});this._store.insert(p);l.add(p.instance);for(l=p.getCursor();l.next();)v.set(l.getDisplayId());this._send(p)};f._send=function(p){if(this._subscriptions.size){var v=null,l=new Map,u=new Set,r=new Map;this._subscriptions.forEach(w=>{var m=w.tile;l.set(m.key.id,null);v=m.tileInfoView;u.add(m.level);
const {row:t,col:B}=m.key;m=`${m.level}/${t}/${B}`;const J=r.get(m)??[];J.push(w);r.set(m,J)});for(const w of u){const m=v.getLODInfoAt(w),t=p.getCursor();for(;t.next();){var A=h(t,m,w);const B=t.getIndex();if(r.has(A))for(const J of r.get(A)){A=J.tile.id;let C=l.get(A);y.isNone(C)&&(C=[],l.set(A,C));C.push(B)}}}l.forEach((w,m)=>{if(y.isSome(w)){const t=this._subscriptions.get(m);w=e(b.FeatureSetReaderIndirect.from(p,w),t.tile);m={type:"append",id:m,addOrUpdate:w,end:!1,status:a.UpdateToken.empty()};
t.add({query:null,message:m});this._onMessage(m)}})}};f._sendEnd=function(){this._subscriptions.forEach(p=>{const v={type:"append",id:p.tile.id,addOrUpdate:null,end:!0,status:a.UpdateToken.empty()};p.add({query:null,message:v});this._onMessage(v)});this._didSendEnd=!0};n._createClass(c,[{key:"loading",get:function(){return this._loading}},{key:"_signal",get:function(){return this._controller.signal}}]);return c}(g.BaseFeatureSource);q.SnapshotFeatureSource=G.__decorate([k.subclass("esri.view.2d.layers.features.sources.SnapshotFeatureSource")],
q.SnapshotFeatureSource);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/StreamSource":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/maybe ../../../../../chunks/rbush ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/StreamFeatureManager ../../../../../layers/graphics/sources/connections/createConnection ./DataTileSource ./StreamConnectionState ../support/FeatureSetReaderJSON ../support/UpdateToken".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e){function f(v,l){const u=v.weakClone();if(z.isSome(v.geometry)){const r=D.quantizeX(l,v.geometry.coords[0]);v=D.quantizeY(l,v.geometry.coords[1]);u.geometry=new x([],[r,v])}return u}function c(v){switch(v){case "esriGeometryPoint":return f;default:return(l,u)=>{const r=l.weakClone(),A=new x;l=D.quantizeOptimizedGeometry(A,l.geometry,!1,!1,v,u,!1,!1);r.geometry=l;return r}}}function d(v){switch(v){case "esriGeometryPoint":return l=>z.isSome(l.geometry)?{minX:l.geometry.coords[0],
minY:l.geometry.coords[1],maxX:l.geometry.coords[0],maxY:l.geometry.coords[1]}:{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};default:return l=>{let u=Infinity,r=Infinity,A=-Infinity,w=-Infinity;z.isSome(l.geometry)&&l.geometry.forEachVertex((m,t)=>{u=Math.min(u,m);r=Math.min(r,t);A=Math.max(A,m);w=Math.max(w,t)});return{minX:u,minY:r,maxX:A,maxY:w}}}}let p=function(){function v(u,r){this.onUpdate=u;this._geometryType=r;this._objectIdToFeature=new Map;this._index=null}var l=v.prototype;
l.add=function(u){this._objectIdToFeature.set(u.objectId,u);this._index=null};l.get=function(u){return this._objectIdToFeature.has(u)?this._objectIdToFeature.get(u):null};l.forEach=function(u){this._objectIdToFeature.forEach(u)};l.search=function(u){if(!this._index){var r=this._features;const A=y.rbush(9,d(this._geometryType));A.load(r);this._index=A}return this._index.search({minX:u.bounds[0],minY:u.bounds[1],maxX:u.bounds[2],maxY:u.bounds[3]})};l.clear=function(){this._index=null;this._objectIdToFeature.clear()};
l.removeById=function(u){const r=this._objectIdToFeature.get(u);return r?(this._objectIdToFeature.delete(u),this._index=null,r):null};l.update=function(u,r){this.onUpdate(u,r)};n._createClass(v,[{key:"_features",get:function(){const u=[];this._objectIdToFeature.forEach(r=>u.push(r));return u}},{key:"size",get:function(){return this._objectIdToFeature.size}}]);return v}();F=function(v){function l(r){var A=u.call(this,r);A.type="stream";A._updateIntervalId=0;A._level=0;A._updateInfo={websocket:0,client:0};
A._inUpdate=!1;var {outSR:w}=r;const {geometryType:m,objectIdField:t,timeInfo:B,purgeOptions:J,source:C,spatialReference:K,serviceFilter:E,maxReconnectionAttempts:I,maxReconnectionInterval:H,updateInterval:N,customParameters:U,enabledEventTypes:ba}=r.serviceInfo,la=new p(A._onUpdate.bind(n._assertThisInitialized(A)),m),aa=new k.StreamFeatureManager(la,t,B,J);w=g.createConnection(C,K,w,m,E,I,H,U??{});A._connectionState=new a.StreamConnectionState({connection:w});A._store=la;A._manager=aa;A._connection=
w;A._quantize=c(m);A._enabledEventTypes=new Set(ba);A._handlesGroup=G.handlesGroup([A._connection.on("data-received",ka=>A._onFeature(ka)),A._connection.on("message-received",ka=>A._onWebSocketMessage(ka))]);A._initUpdateInterval=()=>{let ka=performance.now();A._updateIntervalId=setInterval(()=>{var V=performance.now(),P=V-ka;2500<P&&(ka=V,V=Math.round(A._updateInfo.client/(P/1E3)),P=Math.round(A._updateInfo.websocket/(P/1E3)),A._updateInfo.client=0,A._updateInfo.websocket=0,A.events.emit("updateRate",
{client:V,websocket:P}));r.canAcceptRequest()&&!A._inUpdate&&A._manager.checkForUpdates()},N)};A._initUpdateInterval();return A}n._inherits(l,v);var u=n._createSuper(l);v=l.prototype;v.destroy=function(){n._get(n._getPrototypeOf(l.prototype),"destroy",this).call(this);this._clearUpdateInterval();this._connection.destroy();this._handlesGroup?.remove()};v._fetchDataTile=function(){};v.updateCustomParameters=function(r){this._connection.updateCustomParameters(r)};v.pauseStream=function(){"paused"!==
this._connectionState.connectionStatus&&(this._connectionState.pause(),this._clearUpdateInterval())};v.resumeStream=function(){"paused"===this._connectionState.connectionStatus&&(this._connectionState.resume(),this._initUpdateInterval())};v.sendMessageToSocket=function(r){this._connection.sendMessageToSocket(r)};v.sendMessageToClient=function(r){this._connection.sendMessageToClient(r)};v.enableEvent=function(r,A){A?this._enabledEventTypes.add(r):this._enabledEventTypes.delete(r)};v.subscribe=function(r,
A){n._get(n._getPrototypeOf(l.prototype),"subscribe",this).call(this,r,A);A=this._subscriptions.get(r.id);A.resolve();this._level=r.level;const w=this._getTileFeatures(r);this._onMessage({type:"append",id:r.key.id,addOrUpdate:w,end:!0});A.didSend=!0};v.unsubscribe=function(r){n._get(n._getPrototypeOf(l.prototype),"unsubscribe",this).call(this,r)};v.readers=function*(r){r=this._subscriptions.get(r);({tile:r}=r);yield this._getTileFeatures(r)};v.createTileQuery=function(r){throw Error("Service does not support tile  queries");
};v.resend=async function(){this._subscriptions.forEach(r=>{({tile:r}=r);r={type:"append",id:r.id,addOrUpdate:this._getTileFeatures(r),end:!0};this._onMessage(r)})};v._getTileFeatures=function(r){const A=this._store.search(r).map(w=>this._quantize(w,r.transform));return h.FeatureSetReaderJSON.fromOptimizedFeatures(A,this._serviceInfo,r.transform)};v._onWebSocketMessage=function(r){this._enabledEventTypes.has("message-received")&&this.events.emit("message-received",r);if("type"in r)switch(r.type){case "delete":if(r.objectIds)for(const A of r.objectIds)this._manager.removeById(A);
if(r.trackIds)for(const A of r.trackIds)this._manager.removeByTrackId(A);break;case "clear":this._store.forEach(A=>this._manager.removeById(A.objectId))}};v._onFeature=function(r){this._updateInfo.websocket++;try{this._enabledEventTypes.has("data-received")&&this.events.emit("data-received",r);const A=D.convertFromFeature(r,this._serviceInfo.geometryType,!1,!1,this._serviceInfo.objectIdField);this._manager.add(A)}catch(A){}};v._clearUpdateInterval=function(){clearInterval(this._updateIntervalId);
this._updateIntervalId=0};v._onUpdate=async function(r,A){this._inUpdate=!0;try{z.isSome(r)&&(this._updateInfo.client+=r.length);this._subscriptions.forEach((m,t)=>{m.didSend&&m.tile.level===this._level&&this._onMessage({type:"append",id:t,addOrUpdate:null,clear:!0,end:!1})});const w=[];this._subscriptions.forEach((m,t)=>{if(m.didSend&&m.tile.level===this._level){var B=this._getTileFeatures(m.tile);t={type:"append",id:t,addOrUpdate:B,remove:[],end:!1,status:e.UpdateToken.empty()};m.requests.stream.enqueue(t);
w.push(this._onMessage(t))}});await Promise.all(w);this._subscriptions.forEach((m,t)=>{m.didSend&&m.tile.level===this._level&&this._onMessage({type:"append",id:t,addOrUpdate:null,end:!0})})}catch{}this._inUpdate=!1};n._createClass(l,[{key:"connectionStatus",get:function(){return this._connectionState.connectionStatus}},{key:"errorString",get:function(){return this._connectionState.errorString}}]);return l}(b.DataTileSource);q.StreamSource=F;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/StreamFeatureManager":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/CircularArray","../../../core/mathUtils","../../../core/maybe"],function(q,n,G,F,z){let y=function(){function D(k,g,b,a,h=128){this._trackIdToObservations=new Map;this._idCounter=0;this._lastPurge=performance.now();this._addOrUpdated=new Map;this._removed=[];this._maxAge=0;this._timeInfo=b;this._purgeOptions=a;this.store=k;this.objectIdField=g;this.purgeInterval=
h;this._useGeneratedIds="__esri_stream_id__"===this.objectIdField}var x=D.prototype;x.removeById=function(k){this._removed.push(k)};x.removeByTrackId=function(k){if(k=this._trackIdToObservations.get(k))for(const g of k.entries)this._removed.push(g)};x.add=function(k){if(this._useGeneratedIds){var g=this._nextId();k.attributes[this.objectIdField]=g;k.objectId=g}else k.objectId=k.attributes[this.objectIdField];g=k.objectId;this._addOrUpdated.set(g,k);this._maxAge=Math.max(this._maxAge,k.attributes[this._timeInfo.startTimeField]);
if(this._timeInfo.trackIdField){k=k.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(k)){var b=z.isSome(this._purgeOptions)&&null!=this._purgeOptions.maxObservations?this._purgeOptions.maxObservations:1E3;b=F.clamp(b,0,1E3);this._trackIdToObservations.set(k,new G(b))}g=this._trackIdToObservations.get(k)?.enqueue(g);z.isSome(g)&&(this._addOrUpdated.has(g)?this._addOrUpdated.delete(g):this._removed.push(g))}else z.isNone(this._trackIdLessObservations)&&(this._trackIdLessObservations=
new G(1E5)),this._trackIdLessObservations.enqueue(g)};x.checkForUpdates=function(){const k=this._getToAdd();var g=this._getToRemove();const b=performance.now();b-this._lastPurge>=this.purgeInterval&&(this._purge(b),this._lastPurge=b);const a=[];if(z.isSome(g))for(var h of g){const e=this.store.removeById(h);z.isSome(e)&&a.push(e)}h=[];if(z.isSome(k)){g=new Set(z.unwrapOr(g,[]));for(const e of k)g.has(e.objectId)||(e.attributes.__esri_timestamp__=b,this.store.add(e),h.push(e))}(h.length||a?.length)&&
this.store.update(h,a)};x._getToAdd=function(){if(!this._addOrUpdated.size)return null;const k=Array(this._addOrUpdated.size);let g=0;this._addOrUpdated.forEach(b=>k[g++]=b);this._addOrUpdated.clear();return k};x._getToRemove=function(){const k=this._removed;if(!this._removed.length)return null;this._removed=[];return k};x._nextId=function(){const k=this._idCounter;this._idCounter=(this._idCounter+1)%4294967294+1;return k};x._purge=function(k){const g=this._purgeOptions;z.isSome(g)&&(this._purgeSomeByDisplayCount(g),
this._purgeByAge(g),this._purgeByAgeReceived(k,g),this._purgeTracks())};x._purgeSomeByDisplayCount=function(k){if(k.displayCount){var g=this.store.size;if(g>k.displayCount){if(this._timeInfo.trackIdField)for(const b of this._trackIdToObservations.values())if(g>k.displayCount&&b.size){const a=z.unwrap(b.dequeue());this._removed.push(a);g--}if(z.isSome(this._trackIdLessObservations))for(k=g-k.displayCount;0<k--;)g=this._trackIdLessObservations.dequeue(),z.isSome(g)&&this._removed.push(g)}}};x._purgeByAge=
function(k){const g=this._timeInfo?.startTimeField;if(k.age&&g){var b=this._maxAge-6E4*k.age;this.store.forEach(a=>{a.attributes[g]<b&&this._removed.push(a.objectId)})}};x._purgeByAgeReceived=function(k,g){if(g.ageReceived){var b=k-6E4*g.ageReceived;this.store.forEach(a=>{a.attributes.__esri_timestamp__<b&&this._removed.push(a.objectId)})}};x._purgeTracks=function(){this._trackIdToObservations.forEach((k,g)=>{0===k.size&&this._trackIdToObservations.delete(g)})};return n._createClass(D)}();q.DEFAULT_STREAM_ID_FIELD=
"__esri_stream_id__";q.ESRI_TIMESTAMP="__esri_timestamp__";q.StreamFeatureManager=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/connections/createConnection":function(){define(["exports","./GeoEventConnection","./WebSocketConnection","../../../support/ClientSideConnection"],function(q,n,G,F){q.createConnection=function(z,y,D,x,k,g,b,a){y={source:z,sourceSpatialReference:y,spatialReference:D,geometryType:x,filter:k,maxReconnectionAttempts:g,maxReconnectionInterval:b,
customParameters:a};return z?z.path.startsWith("wss://")||z.path.startsWith("ws://")?new G.WebSocketConnection(y):new n(y):new F.ClientSideConnection(y)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/connections/GeoEventConnection":function(){define("require ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ./WebSocketConnection ../../../../rest/query/operations/query ../../../../rest/support/Query ../../../../geometry/support/jsonUtils ../../../../geometry/SpatialReference".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v){const l={maxQueryDepth:5,maxRecordCountFactor:3};F=function(u){function r(w){w=A.call(this,{...l,...w});w._buddyServicesQuery=null;w._relatedFeatures=null;return w}n._inherits(r,u);var A=n._createSuper(r);u=r.prototype;u._open=async function(){var w=await this._fetchServiceDefinition(this._config.source);w.timeInfo.trackIdField||D.getLogger(this.declaredClass).warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.");
w=this._fetchWebSocketUrl(w.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices());await this._buddyServicesQuery;await this._tryCreateWebSocket(w);const {filter:m,outFields:t}=this._config;this.destroyed||this._setFilter(m,t)};u._onMessage=function(w){if("attributes"in w){let m;try{m=this._enrich(w),x.isSome(this._featureZScaler)&&this._featureZScaler(m.geometry)}catch(t){D.getLogger(this.declaredClass).error(new y("geoevent-connection",
"Failed to parse message",t));return}this.onFeature(m)}else this.onMessage(w)};u._fetchServiceDefinition=async function(w){return this._serviceDefinition=w=(await z(w.path,{query:{f:"json",...this._config.customParameters},responseType:"json"})).data};u._fetchWebSocketUrl=function(w,m){const {urls:t,token:B}=w[0];w=this._inferWebSocketBaseUrl(t);return g.addQueryParameters(`${w}/subscribe`,{outSR:""+m.wkid,token:B})};u._inferWebSocketBaseUrl=function(w){if(1===w.length)return w[0];for(const m of w)if(m.includes("wss"))return m;
D.getLogger(this.declaredClass).error(new y("geoevent-connection","Unable to infer WebSocket url",w));return null};u._setFilter=async function(w,m){const t=this._websocket;if(!(x.isNone(t)||x.isNone(w)&&x.isNone(m))){w=JSON.stringify({filter:this._serializeFilter(w,m)});var B=!1,J=k.createResolver();t.onmessage=C=>{C=JSON.parse(C.data);C.filter&&(C.error&&(D.getLogger(this.declaredClass).error(new y("geoevent-connection","Failed to set service filter",C.error)),this._set("errorString",`Could not set service filter - ${C.error}`),
J.reject(C.error)),this._setWebSocketJSONParseHandler(t),B=!0,J.resolve())};t.send(w);setTimeout(()=>{B||(this.destroyed||this._websocket!==t||D.getLogger(this.declaredClass).error(new y("geoevent-connection","Server timed out when setting filter")),J.reject())},1E4);return J.promise}};u._serializeFilter=function(w,m){const t={};if(x.isNone(w)&&x.isNone(m))return t;if(x.isSome(w)&&w.geometry)try{const B=p.fromJSON(w.geometry);if("extent"!==B.type)throw new y(`Expected extent but found type ${B.type}`);
t.geometry=JSON.stringify(B.shiftCentralMeridian())}catch(B){D.getLogger(this.declaredClass).error(new y("geoevent-connection","Encountered an error when setting connection geometryDefinition",B))}x.isSome(w)&&w.where&&"1 \x3d 1"!==w.where&&"1\x3d1"!==w.where&&(t.where=w.where);x.isSome(m)&&(t.outFields=m.join(","));return t};u._enrich=function(w){if(!this._relatedFeatures)return w;const m=this._relatedFeatures.get(w.attributes[this._serviceDefinition.relatedFeatures.joinField]);if(!m)return D.getLogger(this.declaredClass).warn("geoevent-connection",
"Feature join failed. Is the join field configured correctly?",w),w;const {attributes:t,geometry:B}=m;for(const J in t)w.attributes[J]=t[J];B&&(w.geometry=B);w.geometry||w.centroid||D.getLogger(this.declaredClass).error(new y("geoevent-connection","Found malformed feature - no geometry found",w));return w};u._queryBuddyServices=async function(){try{const {relatedFeatures:w,keepLatestArchive:m}=this._serviceDefinition,t=this._queryRelatedFeatures(w),B=this._queryArchive(m);await t;const J=await B;
if(J)for(const C of J.features)this.onFeature(this._enrich(C))}catch(w){D.getLogger(this.declaredClass).error(new y("geoevent-connection","Encountered an error when querying buddy services",{error:w}))}};u._queryRelatedFeatures=async function(w){w&&(w=await this._queryBuddy(w.featuresUrl),this._addRelatedFeatures(w))};u._queryArchive=async function(w){if(w)return this._queryBuddy(w.featuresUrl)};u._queryBuddy=async function(w){const m=new (await new Promise((I,H)=>q(["../../../FeatureLayer"],N=>I(Object.freeze(Object.defineProperty({__proto__:null,
default:N},Symbol.toStringTag,{value:"Module"}))),H))).default({url:w});var {capabilities:t}=await m.load();const B=t.query.supportsMaxRecordCountFactor,J=t.query.supportsPagination;t=t.query.supportsCentroid;const C=this._config.maxRecordCountFactor;var K=m.capabilities.query.maxRecordCount;K=B?K*C:K;const E=new d;E.outFields=x.unwrapOr(this._config.outFields,["*"]);E.where=x.unwrapOr(x.get(this._config.filter,"where"),"1\x3d1");E.returnGeometry=!0;E.returnExceededLimitFeatures=!0;E.outSpatialReference=
v.fromJSON(this._config.spatialReference);t&&(E.returnCentroid=!0);B&&(E.maxRecordCountFactor=C);if(J)return E.num=K,m.destroy(),this._queryPages(w,E);w=await c.executeQuery(w,E,this._config.sourceSpatialReference);m.destroy();return w.data};u._queryPages=async function(w,m,t=[],B=0){m.start=x.isSome(m.num)?B*m.num:null;const {data:J}=await c.executeQuery(w,m,this._config.sourceSpatialReference);if(J.exceededTransferLimit&&B<(this._config.maxQueryDepth??0))return J.features.forEach(C=>t.push(C)),
this._queryPages(w,m,t,B+1);t.forEach(C=>J.features.push(C));return J};u._addRelatedFeatures=function(w){const m=new Map;w=w.features;const t=this._serviceDefinition.relatedFeatures.joinField;for(const B of w)m.set(B.attributes[t],B);this._relatedFeatures=m};return n._createClass(r)}(f.WebSocketConnection);return F=G.__decorate([e.subclass("esri.layers.graphics.sources.connections.GeoEventConnection")],F)})},"esri/layers/graphics/sources/connections/WebSocketConnection":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/zscale ../../../support/StreamConnection".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f){var c;(function(d){d[d.CONNECTING=0]="CONNECTING";d[d.OPEN=1]="OPEN";d[d.CLOSING=2]="CLOSING";d[d.CLOSED=3]="CLOSED"})(c||(c={}));q.WebSocketConnection=function(d){function p(l){var u=v.call(this);u._outstandingMessages=[];u.errorString=null;const {geometryType:r,spatialReference:A,sourceSpatialReference:w}=l;u._config=l;u._featureZScaler=e.getGeometryZScaler(r,w,A);u._open();return u}n._inherits(p,d);var v=n._createSuper(p);d=p.prototype;d._open=async function(){await this._tryCreateWebSocket();
this.destroyed||await this._handshake()};d.destroy=function(){n._get(n._getPrototypeOf(p.prototype),"destroy",this).call(this);y.isSome(this._websocket)&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close());this._websocket=null};d.sendMessageToSocket=function(l){y.isNone(this._websocket)?this._outstandingMessages.push(l):this._websocket.send(JSON.stringify(l))};d.sendMessageToClient=function(l){this._onMessage(l)};
d.updateCustomParameters=function(l){this._config.customParameters=l;y.isSome(this._websocket)&&this._websocket.close()};d._tryCreateWebSocket=async function(l=this._config.source.path,u=1E3,r=0){try{if(!this.destroyed){var A=x.addQueryParameters(l,this._config.customParameters??{});this._websocket=await this._createWebSocket(A);this.notifyChange("connectionStatus")}}catch(w){if(A=u/1E3,this._config.maxReconnectionAttempts&&r>=this._config.maxReconnectionAttempts)z.getLogger(this.declaredClass).error(new F("websocket-connection",
"Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),this.destroy();else return z.getLogger(this.declaredClass).error(new F("websocket-connection",`Failed to connect. Attempting to reconnect in ${A}s`,w)),await D.after(u),this._tryCreateWebSocket(l,Math.min(1.5*u,1E3*this._config.maxReconnectionInterval),r+1)}};d._setWebSocketJSONParseHandler=function(l){l.onmessage=u=>{try{const r=JSON.parse(u.data);this._onMessage(r)}catch(r){z.getLogger(this.declaredClass).error(new F("websocket-connection",
"Failed to parse message, invalid JSON",{error:r}))}}};d._createWebSocket=function(l){return new Promise((u,r)=>{const A=new WebSocket(l);A.onopen=()=>{A.onopen=null;this.destroyed?(A.onclose=null,A.close()):(A.onclose=w=>this._onClose(w),A.onerror=w=>this._onError(w),this._setWebSocketJSONParseHandler(A),u(A))};A.onclose=w=>{A.onopen=A.onclose=null;r(w)}})};d._handshake=async function(l=1E4){const u=this._websocket;if(!y.isNone(u)){var r=D.createResolver(),A=u.onmessage,{filter:w,outFields:m,spatialReference:t}=
this._config;r.timeout(l);u.onmessage=B=>{let J=null;try{J=JSON.parse(B.data)}catch(C){}J&&"object"===typeof J||(z.getLogger(this.declaredClass).error(new F("websocket-connection","Protocol violation. Handshake failed - malformed message",B.data)),r.reject(),this.destroy());J.spatialReference?.wkid!==t?.wkid&&(z.getLogger(this.declaredClass).error(new F("websocket-connection",`Protocol violation. Handshake failed - expected wkid of ${t.wkid}`,B.data)),r.reject(),this.destroy());"json"!==J.format&&
(z.getLogger(this.declaredClass).error(new F("websocket-connection","Protocol violation. Handshake failed - format is not set",B.data)),r.reject(),this.destroy());w&&J.filter!==w&&z.getLogger(this.declaredClass).error(new F("websocket-connection","Tried to set filter, but server doesn't support it"));m&&J.outFields!==m&&z.getLogger(this.declaredClass).error(new F("websocket-connection","Tried to set outFields, but server doesn't support it"));u.onmessage=A;for(const C of this._outstandingMessages)u.send(JSON.stringify(C));
this._outstandingMessages=[];r.resolve()};u.send(JSON.stringify({filter:w,outFields:m,format:"json",spatialReference:{wkid:t.wkid}}));return r.promise}};d._onMessage=function(l){this.onMessage(l);if("type"in l)switch(l.type){case "features":case "featureResult":for(const u of l.features)y.isSome(this._featureZScaler)&&this._featureZScaler(u.geometry),this.onFeature(u)}};d._onError=function(l){this._set("errorString","Encountered an error over WebSocket connection");z.getLogger(this.declaredClass).error("websocket-connection",
"Encountered an error over WebSocket connection")};d._onClose=function(l){this._websocket=null;this.notifyChange("connectionStatus");1E3!==l.code&&z.getLogger(this.declaredClass).error("websocket-connection",`WebSocket closed unexpectedly with error code ${l.code}`);this.destroyed||this._open()};n._createClass(p,[{key:"connectionStatus",get:function(){if(y.isNone(this._websocket))return"disconnected";switch(this._websocket.readyState){case c.CONNECTING:case c.OPEN:return"connected";case c.CLOSING:case c.CLOSED:return"disconnected"}}}]);
return p}(f);G.__decorate([k.property()],q.WebSocketConnection.prototype,"connectionStatus",null);G.__decorate([k.property()],q.WebSocketConnection.prototype,"errorString",void 0);q.WebSocketConnection=G.__decorate([h.subclass("esri.layers.graphics.sources.connections.WebSocketConnection")],q.WebSocketConnection);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/StreamConnection":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k){F=function(g){function b(){return a.apply(this,arguments)}q._inherits(b,g);var a=q._createSuper(b);g=b.prototype;g.destroy=function(){this.emit("destroy")};g.onFeature=function(h){this.emit("data-received",h)};g.onMessage=function(h){this.emit("message-received",h)};q._createClass(b,[{key:"connectionError",get:function(){return this.errorString?new G("stream-connection",this.errorString):null}}]);return b}(F.EventedAccessor);n.__decorate([z.property({readOnly:!0})],F.prototype,
"connectionError",null);return F=n.__decorate([k.subclass("esri.layers.support.StreamConnection")],F)})},"esri/layers/support/ClientSideConnection":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/support/zscale ./StreamConnection".split(" "),function(q,n,G,F,
z,y,D,x,k,g,b){q.ClientSideConnection=function(a){function h(f){var c=e.call(this);c.connectionStatus="connected";c.errorString=null;const {geometryType:d,spatialReference:p,sourceSpatialReference:v}=f;c._featureZScaler=g.getGeometryZScaler(d,v,p);return c}n._inherits(h,a);var e=n._createSuper(h);a=h.prototype;a.updateCustomParameters=function(f){};a.sendMessageToSocket=function(f){};a.sendMessageToClient=function(f){if("type"in f)switch(f.type){case "features":case "featureResult":for(const c of f.features)F.isSome(this._featureZScaler)&&
this._featureZScaler(c.geometry),this.onFeature(c)}this.onMessage(f)};return n._createClass(h)}(b);G.__decorate([z.property()],q.ClientSideConnection.prototype,"connectionStatus",void 0);G.__decorate([z.property()],q.ClientSideConnection.prototype,"errorString",void 0);q.ClientSideConnection=G.__decorate([k.subclass("esri.layers.support.ClientSideConnection")],q.ClientSideConnection);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/sources/StreamConnectionState":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y){q.StreamConnectionState=function(D){function x(g){g=k.call(this,g);g._isPaused=!1;return g}n._inherits(x,D);var k=n._createSuper(x);D=x.prototype;D.pause=function(){this._isPaused=!0};D.resume=function(){this._isPaused=!1};n._createClass(x,[{key:"connectionStatus",get:function(){return this._isPaused?"paused":this.connection?.connectionStatus}},{key:"errorString",get:function(){return this.connection?.errorString}}]);return x}(F);G.__decorate([z.property()],q.StreamConnectionState.prototype,
"connection",void 0);G.__decorate([z.property()],q.StreamConnectionState.prototype,"_isPaused",void 0);G.__decorate([z.property()],q.StreamConnectionState.prototype,"connectionStatus",null);G.__decorate([z.property()],q.StreamConnectionState.prototype,"errorString",null);q.StreamConnectionState=G.__decorate([y.subclass("esri.views.2d.layers.features.sources.StreamConnectionState")],q.StreamConnectionState);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../core/support/WatchUpdatingTracking ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d){function p(w,m){return t=>m(w(t))}const v=z.getLogger("esri.views.layers.2d.features.support.AttributeStore"),l=f.createDebugLogger(f.DEBUG_ATTR_UPDATES,v);var u=F("esri-shared-array-buffer"),r=F("esri-atomics");let A=function(){function w(t,B,J,C){this.size=0;this.texelSize=4;this.dirtyEnd=this.dirtyStart=0;const {pixelType:K,layout:E,textureOnly:I}=C;this.textureOnly=I||!1;this.pixelType=K;this._ctype=B;this.layout=E;this._resetRange();this._shared=t;
this.size=J;I||(this.data=this._initData(K,J,t,B))}var m=w.prototype;m.unsetComponentAllTexels=function(t,B){const J=D.unwrap(this.data);for(let C=0;C<this.size*this.size;C++)J[C*this.texelSize+t]&=~B;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};m.setComponentAllTexels=function(t,B){const J=D.unwrap(this.data);for(let C=0;C<this.size*this.size;C++)J[C*this.texelSize+t]|=255&B;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};m.setComponent=function(t,B,J){const C=D.unwrap(this.data);
for(const K of J)C[K*this.texelSize+t]|=B,this.dirtyStart=Math.min(this.dirtyStart,K),this.dirtyEnd=Math.max(this.dirtyEnd,K)};m.setComponentTexel=function(t,B,J){D.unwrap(this.data)[J*this.texelSize+t]|=B;this.dirtyStart=Math.min(this.dirtyStart,J);this.dirtyEnd=Math.max(this.dirtyEnd,J)};m.unsetComponentTexel=function(t,B,J){D.unwrap(this.data)[J*this.texelSize+t]&=~B;this.dirtyStart=Math.min(this.dirtyStart,J);this.dirtyEnd=Math.max(this.dirtyEnd,J)};m.getData=function(t,B){t=h.getDisplayIdTexel(t);
return D.unwrap(this.data)[t*this.texelSize+B]};m.setData=function(t,B,J){t=h.getDisplayIdTexel(t);0===(this.layout&1<<B)?v.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):D.isNone(this.data)||(this.data[t*this.texelSize+B]=J,this.dirtyStart=Math.min(this.dirtyStart,t),this.dirtyEnd=Math.max(this.dirtyEnd,t))};m.lock=function(){this.pixelType===d.PixelType.UNSIGNED_BYTE&&this._shared&&r&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};m.unlock=function(){this.pixelType===
d.PixelType.UNSIGNED_BYTE&&this._shared&&r&&"local"!==this._ctype&&Atomics.store(this.data,0,0)};m.expand=function(t){this.size=t;if(!this.textureOnly){t=this._initData(this.pixelType,t,this._shared,this._ctype);const B=D.unwrap(this.data);t.set(B);this.data=t}};m.toMessage=function(){const t=this.dirtyStart,B=this.dirtyEnd;var J=this.texelSize;if(t>B)return null;this._resetRange();const C=!this._shared&&"local"!==this._ctype,K=this.pixelType,E=this.layout,I=D.unwrap(this.data);J=C&&I.slice(t*J,(B+
1)*J)||null;return{start:t,end:B,data:J,pixelType:K,layout:E}};m._initData=function(t,B,J,C){J=J&&"local"!==C?SharedArrayBuffer:ArrayBuffer;t=e.getPixelArrayCtor(t);B=new t(new J(B*B*4*t.BYTES_PER_ELEMENT));for(t=0;t<B.length;t+=4)B[t+1]=255;return B};m._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};n._createClass(w,[{key:"buffer",get:function(){return D.applySome(this.data,t=>t.buffer)}}]);return w}();return function(){function w(t,B){this._client=t;this.config=B;this.updatingHandles=
new g.WatchUpdatingTracking;this._blocks=[];this._filters=Array(a.MAX_FILTERS);this._attributeComputeInfo=null;this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._currUpdate=this._nextUpdate=null;this._idsToHighlight=new Set;t=B.supportsTextureFloat?d.PixelType.FLOAT:d.PixelType.UNSIGNED_BYTE;l(`Creating AttributeStore ${u?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:d.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:d.PixelType.UNSIGNED_BYTE,
layout:15,textureOnly:!0},{pixelType:d.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:t,layout:15},{pixelType:t,layout:15},{pixelType:t,layout:15},{pixelType:t,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var m=w.prototype;m.destroy=function(){this._abortController.abort();this.updatingHandles.destroy()};m.isUpdating=function(){const t=this.updatingHandles.updating||!!this._nextUpdate;F("esri-2d-log-updating")&&console.log(`Updating AttributeStore: ${t}\n  -> updatingHandles ${this.updatingHandles.updating} (currUpdate: ${!!this._currUpdate})\n  -> nextUpdate: ${!!this._nextUpdate}\n`);
return t};m.update=function(t,B){this.config=B;B=B.schema.processors[0].storage;const J=k.diff(this._schema,B);if(t.targets.feature||t.targets.aggregate)t.storage.data=!0;if(J&&(F("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",J),t.storage.data=!0,this._schema=B,this._attributeComputeInfo=null,!D.isNone(B))){switch(B.target){case "feature":this._targetType=h.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=h.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===B.type){this._attributeComputeInfo=
{isSubtype:!0,subtypeField:B.subtypeField,map:new Map};for(const C in B.mapping)if(t=B.mapping[C],D.isSome(t)&&D.isSome(t.vvMapping))for(const K of t.vvMapping)this._bindAttribute(K,parseInt(C,10))}else{this._attributeComputeInfo={isSubtype:!1,map:new Map};if(D.isSome(B.vvMapping))for(const C of B.vvMapping)this._bindAttribute(C);if(D.isSome(B.attributeMapping))for(const C of B.attributeMapping)this._bindAttribute(C)}}};m.onTileData=function(t,B){if(!D.isNone(B.addOrUpdate))for(t=B.addOrUpdate.getCursor();t.next();)B=
t.getDisplayId(),this.setAttributeData(B,t)};m.setHighlight=async function(t,B){const J=this._getBlock(0);B=B.map(C=>h.getDisplayIdTexel(C));J.lock();J.unsetComponentAllTexels(0,1);J.setComponent(0,1,B);J.unlock();this._idsToHighlight.clear();for(const C of t)this._idsToHighlight.add(C);await this.sendUpdates()};m.updateFilters=async function(t,B,J){F("esri-2d-update-debug")&&console.debug("AttributeStore::updateFilters");const {service:C,spatialReference:K}=J;({filters:B}=B);B=B.map((E,I)=>this._updateFilter(E,
I,C,K));B=(await Promise.all(B)).some(E=>E);F("esri-2d-update-debug")&&console.debug("AttributeStore::updateFilters - finsihed");B&&(t.storage.filters=!0,F("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))};m.setData=function(t,B,J,C){const K=h.getDisplayIdTexel(t);this._ensureSizeForTexel(K);this._getBlock(B).setData(t,J,C)};m.getData=function(t,B,J){return this._getBlock(B).getData(t,J)};m.getHighlightFlag=function(t){return this._idsToHighlight.has(t)?
a.HIGHLIGHT_FLAG:0};m.unsetAttributeData=function(t){t=h.getDisplayIdTexel(t);this._getBlock(0).setData(t,0,0)};m.setAttributeData=function(t,B){const J=h.getDisplayIdTexel(t);this._ensureSizeForTexel(J);this._getBlock(0).setData(J,0,this.getFilterFlags(B));if(this._targetType===h.getDisplayIdType(t)){t=this._attributeComputeInfo;var C=this.config.supportsTextureFloat?1:2,K=null;t&&(K=t.isSubtype?t.map.get(B.readAttribute(t.subtypeField)):t.map)&&K.size&&K.forEach((E,I)=>{const H=I*C%4;I=this._getBlock(Math.floor(I*
C/4)+a.ATTRIBUTE_DATA_VV);E=E(B);if(this.config.supportsTextureFloat)I.setData(J,H,E);else if(E===a.NAN_MAGIC_NUMBER)I.setData(J,H,255),I.setData(J,H+1,255);else{E=y.clamp(Math.round(E),-32767,32766)+32768;const N=(E&65280)>>8;I.setData(J,H,E&255);I.setData(J,H+1,N)}})}};m.sendUpdates=function(){F("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate");if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=x.createResolver(),this.updatingHandles.addPromise(this._nextUpdate.promise),
this._nextUpdate.promise;const t={blocks:this._blocks.map(B=>D.isSome(B)?B.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var B=()=>{this._currUpdate=null;if(this._nextUpdate){const J=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>J.resolve())}else F("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued")};F("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");B=this.updatingHandles.addPromise(this._client.update(t,
this._signal).then(B).catch(B));this._client.render(this._signal);return B}).catch(B=>{if(x.isAbortError(B))return this._createResourcesPromise=null,this._createResources();v.error(new G("mapview-attribute-store","Encountered an error during client update",B))})};m._ensureSizeForTexel=function(t){for(;t>=this._size*this._size&&!this._expand(););};m._bindAttribute=function(t,B){function J(){const {normalizationField:N}=t;return N?U=>{const ba=U.readAttribute(N);return ba?U.readAttribute(t.field)/ba:
null}:U=>U.readAttribute(t.field)}function C(){t.normalizationField&&v.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return N=>N.getComputedNumericAtIndex(t.fieldIndex)}let K;if(null!=t.fieldIndex)K=C();else if(t.field)K=J();else return;const {valueRepresentation:E}=t;E&&(K=p(K,N=>c.getVisualVariableSizeValueRepresentationRatio(N,E)));const I=N=>null===N||isNaN(N)||Infinity===N||-Infinity===N?a.NAN_MAGIC_NUMBER:N,H=this._attributeComputeInfo;
if(H.isSubtype){const N=H.map.get(B)??new Map;N.set(t.binding,p(K,I));H.map.set(B,N)}else H.map.set(t.binding,p(K,I))};m._createResources=function(){if(D.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(a.ATTRIBUTE_DATA_ANIMATION);this._getBlock(a.ATTRIBUTE_DATA_GPGPU);l("Initializing AttributeStore");var t={shared:u&&"local"!==this._client.type,size:this._size,blocks:D.mapMany(this._blocks,B=>({textureOnly:B.textureOnly,buffer:B.buffer,pixelType:B.pixelType}))};
this._createResourcesPromise=t=this._client.initialize(t,this._signal).catch(B=>{x.isAbortError(B)?this._createResourcesPromise=null:v.error(new G("mapview-attribute-store","Encountered an error during client initialization",B))});t.then(()=>D.isNone(this._createResourcesPromise)?this._createResources():void 0);return t};m._getBlock=function(t){var B=this._blocks[t];if(D.isSome(B))return B;l(`Initializing AttributeBlock at index ${t}`);B=new A(u,this._client.type,this._size,this._blockDescriptors[t]);
this._blocks[t]=B;this._createResourcesPromise=null;return B};m._expand=function(){if(this._size<this.config.maxTextureSize){const t=this._size<<=1;l("Expanding block size to",t,this._blocks);D.forEachSome(this._blocks,B=>B.expand(t));this._createResourcesPromise=null;this._size=t;return 0}v.error(new G("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};m._updateFilter=async function(t,B,J,C){const K=this._filters[B],E=D.isSome(K)&&K.hash;if(!K&&!t||E===JSON.stringify(t))return!1;
if(D.isNone(t)){if(!K)return!1;t=1<<B+1;J=this._getBlock(0);this._filters[B]=null;J.setComponentAllTexels(0,t);this.sendUpdates();return!0}await (await this._getFilter(B,J)).update(t,C);return!0};m._getFilter=async function(t,B){var J=this._filters[t];if(D.isSome(J))return J;({default:J}=await new Promise((C,K)=>q(["./FeatureFilter"],E=>C(Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}))),K)));B=new J({geometryType:B.geometryType,hasM:!1,hasZ:!1,
timeInfo:B.timeInfo,fieldsIndex:new b(B.fields)});return this._filters[t]=B};m.isVisible=function(t){return!!(this._getBlock(0).getData(t,0)&2)};m.getFilterFlags=function(t){let B=0;var J=h.getDisplayIdFilterMask(t.getDisplayId());for(let K=0;K<this._filters.length;K++){var C=this._filters[K];C=!(J&1<<K)||D.isNone(C)||C.check(t);B|=(C?1:0)<<K}J=0;this._idsToHighlight.size&&(t=t.getObjectId(),J=this.getHighlightFlag(t));return B<<1|J};n._createClass(w,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},
{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return w}()})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],function(q){q.AGGREGATE_VALID_FILTERS_MASK=254;q.DISPLAY_ID_TEXEL_MASK=8388607;q.DISPLAY_ID_TYPE_AGGREGATE=1;q.DISPLAY_ID_TYPE_FEATURE=0;q.DISPLAY_ID_TYPE_MASK=8388608;q.NONAGGREGATE_VALID_FILTERS_MASK=255;q.createDisplayId=function(n,G){return((G?8388608:0)|n)>>>0};q.getDisplayIdFilterMask=
n=>1===(n&8388608)>>>23?254:255;q.getDisplayIdTexel=n=>n&8388607;q.getDisplayIdType=n=>(n&8388608)>>>23;q.isAggregateId=function(n){return 1===(n&8388608)>>>23};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../symbols/cim/enums ./enums ../../../webgl/enums ../../../webgl/VertexElementDescriptor".split(" "),function(q,n,G,F,z,y,D){function x(I){const H={};for(const N of I)H[N.name]=
N.strideInBytes;return H}function k(I){switch(I){case z.WGLGeometryType.MARKER:return r;case z.WGLGeometryType.FILL:return A;case z.WGLGeometryType.LINE:return w;case z.WGLGeometryType.TEXT:return m;case z.WGLGeometryType.LABEL:return t}}function g(I){switch(I%4){case 0:case 2:return 4;case 1:case 3:return 1}}function b(I){switch(I){case y.DataType.BYTE:case y.DataType.UNSIGNED_BYTE:return 1;case y.DataType.SHORT:case y.DataType.UNSIGNED_SHORT:return 2;case y.DataType.FLOAT:case y.DataType.INT:case y.DataType.UNSIGNED_INT:return 4}}
function a(I){const H={};for(const N in I){let U=0;H[N]=I[N].map(ba=>{const la=new D.VertexElementDescriptor(ba.name,ba.count,ba.type,U,0,ba.normalized||!1);U+=ba.count*b(ba.type);return la});H[N]?.forEach(ba=>ba.stride=U)}return H}const h=G.getLogger("esri.views.2d.engine.webgl.Utils"),e=x([{name:"geometry",strideInBytes:36}]),f=x([{name:"geometry",strideInBytes:12}]),c=x([{name:"geometry",strideInBytes:36}]),d=x([{name:"geometry",strideInBytes:24}]),p=x([{name:"geometry",strideInBytes:12}]),v=x([{name:"geometry",
strideInBytes:40}]),l=x([{name:"geometry",strideInBytes:36}]),u=x([{name:"geometry",strideInBytes:36}]),r=["geometry"],A=["geometry"],w=["geometry"],m=["geometry"],t=["geometry"];G={geometry:y.Usage.STATIC_DRAW};const B=new Map,J=I=>null!=I&&I.startsWith("data:image/gif"),C=I=>null!=I&&I.startsWith("data:image/png"),K=I=>{if(!I)return!1;I=I.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(I)&&/[\dz]$/i.test(I)&&4<I.length?!0:!1},E=I=>"fill"===I.type&&"CIMMarkerPlacementInsidePolygon"===
I?.cim?.markerPlacement?.type;q.C_VBO_INFO=G;q.allocateTypedArrayBuffer=function(I,H){switch(H%4){case 0:case 2:return new Uint32Array(Math.floor(I*H/4));case 1:case 3:return new Uint8Array(I*H)}};q.allocateTypedArrayBufferwithData=function(I,H){switch(H%4){case 0:case 2:return new Uint32Array(I);case 1:case 3:return new Uint8Array(I)}};q.charCodes=function(I){const H=[];for(let N=0;N<I.length;N++)H.push(I.charCodeAt(N));return H};q.copyMeshData=function(I,H,N,U,ba,la,aa){for(const P in la){var ka=
la[P].stride,V=g(ka);const S=la[P].data,X=N[P].data;if(null==S||null==X)continue;const ra=ka*ba.vertexCount/V,Y=ka*I/V;ka=ka*ba.vertexFrom/V;for(V=0;V<ra;++V)X[V+Y]=S[V+ka]}if(null!=aa&&null!=U)for(N=ba.indexCount,la=0;la<N;++la)U[la+H]=aa[la+ba.indexFrom]-ba.vertexFrom+I};q.createGeometryData=function(I,H){const N=[];for(let U=0;5>U;++U){const ba=k(U),la={};for(const aa of ba)la[aa]={data:H(U,aa)};N.push({data:I(U),buffers:la})}return N};q.createProgramDescriptor=(I,H)=>{if(!B.has(I)){const ba=a(H);
var N=ba;var U={};for(const la in N){const aa=N[la];U[la]=aa?.length?aa[0].stride:0}N=U;U=new Map;for(const la in H)for(const aa of H[la])U.set(aa.name,aa.location);B.set(I,{strides:N,bufferLayouts:ba,attributes:U})}return B.get(I)};q.forEachGeometryType=function(I){I(z.WGLGeometryType.FILL);I(z.WGLGeometryType.LINE);I(z.WGLGeometryType.MARKER);I(z.WGLGeometryType.TEXT);I(z.WGLGeometryType.LABEL)};q.getBytes=b;q.getCapType=function(I){switch(I){case "butt":return F.CapType.BUTT;case "round":return F.CapType.ROUND;
case "square":return F.CapType.SQUARE;default:return h.error(new n("mapview-invalid-type",`Cap type ${I} is not a valid option. Defaulting to round`)),F.CapType.ROUND}};q.getJoinType=function(I){switch(I){case "miter":return F.JoinType.MITER;case "bevel":return F.JoinType.BEVEL;case "round":return F.JoinType.ROUND;default:return h.error(new n("mapview-invalid-type",`Join type ${I} is not a valid option. Defaulting to round`)),F.JoinType.ROUND}};q.getNamedBuffers=k;q.getPMSResourceSize=function(I){const H=
"width"in I&&I.width||"size"in I&&I.size||0;return"maxVVSize"in I&&I.maxVVSize||H};q.getPixelArrayCtor=function(I){switch(I){case y.PixelType.UNSIGNED_BYTE:return Uint8Array;case y.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case y.PixelType.FLOAT:return Float32Array;default:h.error(new n("webgl-utils",`Unable to handle type ${I}`))}};q.getPixelBytes=function(I){switch(I){case y.PixelType.UNSIGNED_BYTE:return 1;case y.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case y.PixelType.FLOAT:return 4;
default:h.error(new n("webgl-utils",`Unable to handle type ${I}`))}};q.getStrides=function(I,H){switch(I){case z.WGLGeometryType.MARKER:switch(H){case z.WGLSymbologyType.HEATMAP:return f;default:return e}case z.WGLGeometryType.FILL:switch(H){case z.WGLSymbologyType.DOT_DENSITY:return p;case z.WGLSymbologyType.SIMPLE:case z.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return d;default:return c}case z.WGLGeometryType.LINE:return v;case z.WGLGeometryType.TEXT:return l;case z.WGLGeometryType.LABEL:return u}};
q.getUrl=I=>"imageData"in I&&I.imageData&&"contentType"in I&&I.contentType?`data:${I.contentType};base64,${I.imageData}`:"url"in I?I.url:null;q.getVVType=function(I){switch(I){case "opacity":return z.VVType.OPACITY;case "color":return z.VVType.COLOR;case "rotation":return z.VVType.ROTATION;case "size":return z.VVType.SIZE;default:return h.error(`Cannot interpret unknown vv: ${I}`),null}};q.is3D=I=>I.type&&I.type.toLowerCase().includes("3d");q.isDefined=function(I){return null!=I};q.isGIF=I=>"url"in
I&&I.url&&(I.url.includes(".gif")||J(I.url))||"contentType"in I&&"image/gif"===I.contentType||"imageData"in I&&J(I.imageData);q.isGIFDataUri=J;q.isImageResource=I=>"url"in I&&I.url||"imageData"in I&&I.imageData;q.isMarkerPlacementInsidePolygon=E;q.isNumber=function(I){return"number"===typeof I};q.isPNG=I=>"url"in I&&I.url&&(I.url.includes(".png")||C(I.url))||"contentType"in I&&"image/png"===I.contentType||"imageData"in I&&C(I.imageData);q.isPNGDataUri=C;q.isSVGImage=I=>I.includes("data:image/svg+xml");
q.isSVGResource=I=>"path"in I&&K(I.path);q.isSimple=function(I){switch(I.type){case "line":return"CIMSolidStroke"===I.cim.type&&!I.dashTemplate;case "fill":return"CIMSolidFill"===I.cim.type;case "esriSFS":return"esriSFSSolid"===I.style||"esriSFSNull"===I.style;case "esriSLS":return"esriSLSSolid"===I.style||"esriSLSNull"===I.style;default:return!1}};q.isValidSVG=K;q.shouldRepeat=function(I){switch("cim"in I?I.cim.type:I.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return E(I);
default:return!0}};q.strideToPackingFactor=g;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(q){q.WGLGeometryType=void 0;(function(n){n[n.FILL=0]="FILL";n[n.LINE=1]="LINE";n[n.MARKER=2]="MARKER";n[n.TEXT=3]="TEXT";n[n.LABEL=4]="LABEL"})(q.WGLGeometryType||(q.WGLGeometryType={}));q.WGLDrawPhase=void 0;(function(n){n[n.NONE=0]="NONE";n[n.MAP=1]="MAP";n[n.LABEL=2]="LABEL";n[n.LABEL_ALPHA=4]="LABEL_ALPHA";n[n.HITTEST=
8]="HITTEST";n[n.HIGHLIGHT=16]="HIGHLIGHT";n[n.CLIP=32]="CLIP";n[n.DEBUG=64]="DEBUG";n[n.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(q.WGLDrawPhase||(q.WGLDrawPhase={}));q.VVType=void 0;(function(n){n[n.SIZE=0]="SIZE";n[n.COLOR=1]="COLOR";n[n.OPACITY=2]="OPACITY";n[n.ROTATION=3]="ROTATION"})(q.VVType||(q.VVType={}));q.WGLVVFlag=void 0;(function(n){n[n.NONE=0]="NONE";n[n.OPACITY=1]="OPACITY";n[n.COLOR=2]="COLOR";n[n.ROTATION=4]="ROTATION";n[n.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";n[n.SIZE_SCALE_STOPS=
16]="SIZE_SCALE_STOPS";n[n.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";n[n.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(q.WGLVVFlag||(q.WGLVVFlag={}));q.WGLVVTarget=void 0;(function(n){n[n.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";n[n.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";n[n.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";n[n.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(q.WGLVVTarget||(q.WGLVVTarget={}));q.MosaicType=void 0;(function(n){n[n.SPRITE=0]="SPRITE";n[n.GLYPH=1]=
"GLYPH"})(q.MosaicType||(q.MosaicType={}));q.WGLSymbologyType=void 0;(function(n){n[n.DEFAULT=0]="DEFAULT";n[n.SIMPLE=1]="SIMPLE";n[n.DOT_DENSITY=2]="DOT_DENSITY";n[n.OUTLINE_FILL=3]="OUTLINE_FILL";n[n.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE";n[n.HEATMAP=5]="HEATMAP";n[n.PIE_CHART=6]="PIE_CHART"})(q.WGLSymbologyType||(q.WGLSymbologyType={}));Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(q){q.DEBUG_ATTR_UPDATES=
!1;q.createDebugLogger=(n,G)=>n&&((...F)=>G.warn("DEBUG:",...F))||(()=>null);Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),function(q,n,G,F,z,y,D){function x(f){return{value:f.value,
size:G.toPt(f.size)}}function k(f){return(f??[]).map(c=>x(c))}function g(f){return"string"===typeof f||"number"===typeof f?G.toPt(f):{type:"size",expression:f.expression,stops:k(f.stops)}}function b(f){const c={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof f.field)if(f.stops){if(8<f.stops.length)return null;f=f.stops;for(var d=0;8>d;++d){const p=f[Math.min(d,f.length-1)];c.values[d]=p.value;c.opacities[d]=p.opacity}}else return null;else if(f.stops&&0<=f.stops.length)for(f=
f.stops&&0<=f.stops.length?f.stops[0].opacity:0,d=0;8>d;d++)c.values[d]=Infinity,c.opacities[d]=f;else return null;return c}function a(f,c,d){f[4*c]=d.r/255;f[4*c+1]=d.g/255;f[4*c+2]=d.b/255;f[4*c+3]=d.a}function h(f){if(n.isNone(f)||f.normalizationField)return null;const c={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof f.field)if(f.stops){if(8<f.stops.length)return null;c.field=f.field;f=f.stops;for(var d=0;8>d;++d){const p=
f[Math.min(d,f.length-1)];c.values[d]=p.value;a(c.colors,d,p.color)}}else return null;else if(f.stops&&0<=f.stops.length)for(f=f.stops&&0<=f.stops.length&&f.stops[0].color,d=0;8>d;d++)c.values[d]=Infinity,a(c.colors,d,f);else return null;for(f=0;32>f;f+=4)F.premultiplyAlpha(c.colors,f,!0);return c}const e=f=>{const c=[],d=[];f=k(f);const p=f.length;for(let v=0;6>v;v++){const l=f[Math.min(v,p-1)];c.push(l.value);d.push(null==l.size?z.NAN_MAGIC_NUMBER:G.pt2px(l.size))}return{values:new Float32Array(c),
sizes:new Float32Array(d)}};q.convertColorVariable=h;q.convertVisualVariables=function(f){const c=f&&0<f.length?{}:null,d=c?{}:null;if(!c||!d)return{vvFields:c,vvRanges:d};for(const p of f)if(p.field&&(c[p.type]=p.field),"size"===p.type)switch(d.size||(d.size={}),f=p,D.getTypeOfSizeVisualVariable(f)){case y.WGLVVFlag.SIZE_MINMAX_VALUE:d.size.minMaxValue={minDataValue:f.minDataValue,maxDataValue:f.maxDataValue,minSize:g(f.minSize),maxSize:g(f.maxSize)};break;case y.WGLVVFlag.SIZE_SCALE_STOPS:d.size.scaleStops=
{stops:k(f.stops)};break;case y.WGLVVFlag.SIZE_FIELD_STOPS:if(f.levels){const v={};for(const l in f.levels)v[l]=e(f.levels[l]);d.size.fieldStops={type:"level-dependent",levels:v}}else d.size.fieldStops={type:"static",...e(f.stops)};break;case y.WGLVVFlag.SIZE_UNIT_VALUE:d.size.unitValue={unit:f.valueUnit,valueRepresentation:f.valueRepresentation??void 0}}else"color"===p.type?d.color=h(p):"opacity"===p.type?d.opacity=b(p):"rotation"===p.type&&(d.rotation={type:p.rotationType});return{vvFields:c,vvRanges:d}};
q.getVisualVariableSizeValueRepresentationRatio=function(f,c){if(!f||!c)return f;switch(c){case "radius":case "distance":return 2*f;case "area":return Math.sqrt(f)}return f};q.normalizeSizeElement=g;q.normalizeSizeStops=k;q.stopToSizeStop=x;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(q){function n(F){return F?72*F/96:0}const G=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;q.castRenderScreenPointArray=function(F){return F};q.castRenderScreenPointArray3=
function(F){return F};q.castScreenPointArray=function(F){return F};q.createRenderScreenPoint=function(F=0,z=0){return{x:F,y:z}};q.createRenderScreenPointArray=function(F=0,z=0){return[F,z]};q.createRenderScreenPointArray3=function(F=0,z=0,y=0){return[F,z,y]};q.createScreenPoint=function(F=0,z=0){return{x:F,y:z}};q.createScreenPointArray=function(F=0,z=0){return[F,z]};q.pt2px=function(F){return F?F/72*96:0};q.px2pt=n;q.screenPointArrayToObject=function(F,z){return z?(z.x=F[0],z.y=F[1],z):{x:F[0],y:F[1]}};
q.screenPointObjectToArray=function(F,z){return z?(z[0]=F.x,z[1]=F.y,2<z.length&&(z[2]=0),z):[F.x,F.y]};q.toPt=function(F){if("string"===typeof F){var z=F.match(G);if(z){var y=Number(z[1]);z=z[3]&&z[3].toLowerCase();F="-"===F.charAt(0);y="px"===z?n(y):y;return F?-y:y}console.warn("screenUtils.toPt: input not recognized!");return null}return F};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/color":function(){define(["exports","../../../../core/maybe","./number"],
function(q,n,G){q.premultiplyAlpha=function(F,z=0,y=!1){const D=F[z+3];F[z]*=D;F[z+1]*=D;F[z+2]*=D;y||(F[z+3]*=255);return F};q.premultiplyAlphaRGBA=function(F){if(!F)return 0;const {r:z,g:y,b:D,a:x}=F;return G.i8888to32(z*x,y*x,D*x,255*x)};q.premultiplyAlphaRGBAArray=function(F){if(!F)return 0;const [z,y,D,x]=F;return G.i8888to32(x/255*z,x/255*y,x/255*D,x)};q.writeColor=function(F,z,y=0){if(n.isNone(z))F[y]=0,F[y+1]=0,F[y+2]=0,F[y+3]=0;else{var {r:D,g:x,b:k,a:g}=z;F[y]=D*g/255;F[y+1]=x*g/255;F[y+
2]=k*g/255;F[y+3]=g}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(q){function n(z,y,D){return Math.round(Math.max(Math.min(z,D),y))}const G=new Float32Array(1),F=new Uint32Array(G.buffer);q.i16=function(z){return n(z,-32768,32767)};q.i1616to32=function(z,y){return 65535&z|y<<16};q.i32=function(z){return n(z,-2147483648,2147483647)};q.i8=function(z){return n(z,-128,127)};q.i8816to32=function(z,y,D){return z&
255|(y&255)<<8|D<<16};q.i8888to32=function(z,y,D,x){return z&255|(y&255)<<8|(D&255)<<16|x<<24};q.numTo32=function(z){return z|0};q.toFloat32=function(z){F[0]=z;return G[0]};q.toUint32=function(z){G[0]=z;return F[0]};q.u16=function(z){return n(z,0,65535)};q.u32=function(z){return n(z,0,4294967295)};q.u32to4Xu8=function(z){return[z&255,(z&65280)>>>8,(z&16711680)>>>16,(z&4278190080)>>>24]};q.u4u4to8=function(z,y){return 15&z|(15&y)<<4};q.u8=function(z){return n(z,0,255)};Object.defineProperty(q,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger","./enums","./Utils"],function(q,n,G,F,z){q.getTypeOfSizeVisualVariable=function(y){if(z.isNumber(y.minDataValue)&&z.isNumber(y.maxDataValue)&&null!=y.minSize&&null!=y.maxSize)return F.WGLVVFlag.SIZE_MINMAX_VALUE;if((y.expression&&"view.scale"===y.expression||y.valueExpression&&"$view.scale"===y.valueExpression)&&Array.isArray(y.stops))return F.WGLVVFlag.SIZE_SCALE_STOPS;
if((null!=y.field||y.expression&&"view.scale"!==y.expression||y.valueExpression&&"$view.scale"!==y.valueExpression)&&(Array.isArray(y.stops)||"levels"in y&&y.levels))return F.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=y.field||y.expression&&"view.scale"!==y.expression||y.valueExpression&&"$view.scale"!==y.valueExpression)&&null!=y.valueUnit)return F.WGLVVFlag.SIZE_UNIT_VALUE;G.getLogger("esri.views.2d.engine.webgl").error(new n("mapview-bad-type","Found invalid size VisualVariable",y));return F.WGLVVFlag.NONE};
Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/BinStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/aaBoundingBox ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/DisplayId ../FeatureStore2D ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference ../../../../../geometry/Polygon ../../../../../geometry/Extent".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r,A,w){const m=y.getLogger("esri.view.2d.layers.features.support.BinStore"),t=b.create();G=function(B){function J(K,E,I,H){var N=C.call(this,K,I);N.type="bin";N.events=new F;N.objectIdField="aggregateId";N.featureAdapter=v.featureAdapter;N._geohashLevel=5;N._geohashBuf=[];N._serviceInfo=H;N.geometryInfo=K.geometryInfo;N._spatialReference=E;N._projectionSupportCheck=d.checkProjectionSupport(E,r.WGS84);N._bitsets.geohash=I.getBitset(I.createBitset());
N._bitsets.inserted=I.getBitset(I.createBitset());return N}n._inherits(J,B);var C=n._createSuper(J);B=J.prototype;B.destroy=function(){this._tree&&this._tree.destroy()};B.updateSchema=async function(K,E){const I=this._schema;try{await n._get(n._getPrototypeOf(J.prototype),"updateSchema",this).call(this,K,E),await this._projectionSupportCheck}catch(N){}this._fields=this._schema.params.fields;const H=x.diff(I,E);if(!E||D.isNone(H)&&!K.source&&!K.storage.filters)I&&(K.mesh=!0);else{if(x.hasDiff(H,"params.fields")||
x.hasDiff(H,"params")||!this._tree||K.source)this._tree&&this._tree.destroy(),this._tree=new k.GeohashTree(this._statisticFields,this._serviceInfo),this._tree.onRelease=N=>N.displayId&&this._storage.releaseDisplayId(N.displayId),this._geohashLevel=this._schema.params.fixedBinLevel,this._rebuildTree(),z("esri-2d-update-debug")&&m.info("Aggregate mesh needs update due to tree changing");z("esri-2d-update-debug")&&m.info("Aggregate mesh needs update due to tree changing");K.targets[E.name]=!0;K.mesh=
!1}};B.clear=function(){this._rebuildTree()};B.sweepFeatures=function(K,E){this._bitsets.inserted.forEachSet(I=>{K.has(I)||(I=E.lookupByDisplayIdUnsafe(I),this._remove(I))})};B.sweepAggregates=function(K,E,I){};B.onTileData=function(K,E,I,H,N=!0){if(!this._schema||D.isNone(E.addOrUpdate))return E;this.events.emit("changed");var U=this._getTransforms(K,this._spatialReference);const ba=E.addOrUpdate.getCursor();for(;ba.next();)this._update(ba,H);if(E.status.mesh||!N)return E;H=[];this._getBinsForTile(H,
K,U,I);E.addOrUpdate=u.FeatureSetReaderJSON.fromOptimizedFeatures(H,{...this._serviceInfo,geometryType:"esriGeometryPolygon"});E.addOrUpdate.attachStorage(I);E.end=!0;E.isRepush||(E.clear=!0);for(U=E.addOrUpdate.getCursor();U.next();)H=U.getDisplayId(),this._bitsets.computed.unset(H),this.setComputedAttributes(I,U,H,K.scale);return E};B.forEachBin=function(K){this._tree.forEach(K)};B.forEach=function(K){this._tree.forEach(E=>{E.depth===this._geohashLevel&&(E=this._toFeatureJSON(E),E=u.FeatureSetReaderJSON.fromFeatures([E],
{objectIdField:this.objectIdField,globalIdField:null,geometryType:this.geometryInfo.geometryType,fields:this.fields}).getCursor(),E.next(),K(E))})};B.forEachInBounds=function(K,E){};B.forEachBounds=function(K,E){const {hasM:I,hasZ:H}=this.geometryInfo;for(const N of K)K=e.getBoundsOptimizedGeometry(t,N.readGeometry(),H,I),D.isNone(K)||E(K)};B.onTileUpdate=function(K){};B.getAggregate=function(K){const E=p.createDisplayId(K,!0);K=this._tree.findIf(I=>I.displayId===E);return D.applySome(K,I=>this._toFeatureJSON(I))};
B.getAggregates=function(){return this._tree.findAllIf(K=>K.depth===this._geohashLevel).map(this._toFeatureJSON.bind(this))};B.getDisplayId=function(K){const E=this._tree.findIf(I=>I.id===K);return D.applySome(E,I=>I.displayId)};B.getFeatureDisplayIdsForAggregate=function(K){const E=this._tree.findIf(I=>I.id===K);return D.mapOr(E,[],I=>Array.from(I.displayIds))};B.getDisplayIdForReferenceId=function(K){const E=this._tree.findIf(I=>1===I.displayIds.size&&I.displayIds.has(K));return D.applySome(E,I=>
I.displayId)};B._toFeatureJSON=function(K){const E=this._spatialReference;return{displayId:K.displayId,attributes:K.getAttributes(),geometry:e.convertToGeometry(K.getGeometry(E),"esriGeometryPolygon",!1,!1),centroid:null}};B._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};B._remove=function(K){const E=K.getDisplayId(),I=K.getXHydrated(),H=K.getYHydrated(),N=this._geohashBuf[2*E],U=this._geohashBuf[2*E+1];this._bitsets.inserted.has(E)&&
(this._bitsets.inserted.unset(E),this._tree.removeCursor(K,I,H,N,U,this._geohashLevel))};B._update=function(K,E){const I=K.getDisplayId(),H=this._bitsets.inserted;E=E.isVisible(I);var N=H.has(I);E!==N&&(E?(E=K.getXHydrated(),N=K.getYHydrated(),this._setGeohash(I,E,N)&&(this._tree.insertCursor(K,I,E,N,this._geohashBuf[2*I],this._geohashBuf[2*I+1],this._geohashLevel),H.set(I))):this._remove(K))};B._setGeohash=function(K,E,I){if(this._bitsets.geohash.has(K))return!0;const H=this._geohashBuf;if(this._spatialReference.isWebMercator)E=
E/a.earth.radius*57.29577951308232,g.setGeohashBuf(H,K,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-I/a.earth.radius))),E-360*Math.floor((E+180)/360),12);else{I=d.project({x:E,y:I},this._spatialReference,r.WGS84);if(!I)return!1;g.setGeohashBuf(H,K,I.y,I.x,12)}this._bitsets.geohash.set(K);return!0};B._getBinsForTile=function(K,E,I,H){try{var N=this._getGeohashBounds(E);const U=this._tree.getBins(N);for(const ba of U){ba.displayId||(ba.displayId=H.createDisplayId(!0));N=null;const la=ba.getGeometry(this._spatialReference,
I.tile);la||(N=ba.getGeometryCentroid(this._spatialReference,I.tile));const aa=new f.OptimizedFeature(la,ba.getAttributes(),N);aa.objectId=ba.id;aa.displayId=ba.displayId;K.push(aa)}}catch(U){m.error("Unable to get bins for tile",E.key.id)}};B._getGeohash=function(K,E,I){const H={geohashX:0,geohashY:0};g.setGeohashXY(H,E,K,I);return H};B._getGeohashBounds=function(K){const E=this._getGeohashLevel(K.key.level),I=[K.extent.xmin,K.extent.ymin,K.extent.xmax,K.extent.ymax];var H=A.fromExtent(w.fromBounds(I,
this._spatialReference));K=d.project(H,this._spatialReference,r.WGS84,{densificationStep:64*K.resolution});K=e.convertFromPolygon(new c,K,!1,!1);var N=K.coords.filter((ba,la)=>!(la%2)),U=K.coords.filter((ba,la)=>la%2);K=Math.min(...N);H=Math.min(...U);N=Math.max(...N);U=Math.max(...U);K=this._getGeohash(K,H,E);H=this._getGeohash(N,U,E);return{bounds:I,geohashBounds:{xLL:K.geohashX,yLL:K.geohashY,xTR:H.geohashX,yTR:H.geohashY},level:E}};B._getGeohashLevel=function(K){return this._schema.params.fixedBinLevel};
B._getTransforms=function(K,E){const I={originPosition:"upperLeft",scale:[K.resolution,K.resolution],translate:[K.bounds[0],K.bounds[3]]};E=h.getInfo(E);if(!E)return{tile:I,left:null,right:null};const [H,N]=E.valid;return{tile:I,left:{...I,translate:[N,K.bounds[3]]},right:{...I,translate:[H-N+K.bounds[0],K.bounds[3]]}}};n._createClass(J,[{key:"featureSpatialReference",get:function(){return this._spatialReference}},{key:"fields",get:function(){return this._fields}}]);return J}(l.Store2D);q.BinStore=
G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geohash/GeohashTree":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../core/CircularArray ../core/maybe ./geohashUtils ../geometry/SpatialReference ../layers/graphics/featureConversionUtils ../layers/graphics/OptimizedGeometry ../layers/graphics/data/projectionSupport ../views/2d/layers/features/support/FeatureSetReaderJSON".split(" "),function(q,n,G,F,z,y,D,x,k,g){let b=function(){function h(f=[],c,d=8096){this.onRelease=
p=>{};this._nodes=0;this._root=new a(this,0,0,0);this._statisticFields=f;this._pool=d?new G(8096):null;this._serviceInfo=c}var e=h.prototype;e.destroy=function(){this.clear()};e._acquire=function(f,c,d){this._nodes++;let p=null;F.isSome(this._pool)&&(p=this._pool.dequeue());F.isSome(p)?p.realloc(f,c,d):p=new a(this,f,c,d);return p};e._release=function(f){this.onRelease(f);this._nodes--;F.isSome(this._pool)&&this._pool.enqueue(f)};e.dropLevels=function(f){this.forEach(c=>{if(c.depth>=f)for(let d=0;d<
c.children.length;d++){const p=c.children[d];p&&this._release(p)}});this.forEach(c=>{if(c.depth>=f)for(let d=0;d<c.children.length;d++)c.children[d]=null})};e.clear=function(){this.forEach(f=>this._release(f));this._root=new a(this,0,0,0)};e.insert=function(f,c,d=0){const p=g.FeatureSetReaderJSON.fromOptimizedFeatures([f],this._serviceInfo).getCursor();p.next();const v=p.readGeometry();if(v){var [l,u]=v.coords;this.insertCursor(p,f.displayId,l,u,f.geohashX,f.geohashY,c,d)}};e.insertCursor=function(f,
c,d,p,v,l,u,r=0){let A=this._root,w=0,m=0,t=0;for(;null!==A;){A.depth>=r&&(A.count+=1,A.xTotal+=d,A.yTotal+=p,A.xGeohashTotal+=v,A.yGeohashTotal+=l,A.referenceId=c,this._updateStatisticsCursor(f,A,1));if(w>=u){A.add(c);break}var B=Math.ceil((w+1)/2),J=Math.floor((w+1)/2);const K=1-w%2;var C=30-(3*B+2*J);B=30-(2*B+3*J);C=(v&7*K+3*(1-K)<<C)>>C;B=(l&3*K+7*(1-K)<<B)>>B;J=C+B*(8*K+4*(1-K));const E=2*K+3*(1-K);m=m<<3*K+2*(1-K)|C;t=t<<E|B;null==A.children[J]&&(A.children[J]=this._acquire(m,t,w+1));w+=1;
A=A.children[J]}};e.remove=function(f,c){const d=g.FeatureSetReaderJSON.fromOptimizedFeatures([f],this._serviceInfo).getCursor();d.next();const p=d.readGeometry();if(p){var [v,l]=p.coords;this.removeCursor(d,v,l,f.geohashX,f.geohashY,c)}};e.removeCursor=function(f,c,d,p,v,l){let u=this._root,r=0;for(;null!==u;){--u.count;u.xTotal-=c;u.yTotal-=d;u.xGeohashTotal-=p;u.yGeohashTotal-=v;this._updateStatisticsCursor(f,u,-1);if(r>=l){u.remove(f.getDisplayId());break}var A=Math.ceil((r+1)/2);const t=Math.floor((r+
1)/2);var w=1-r%2,m=30-(3*A+2*t);A=30-(2*A+3*t);w=((p&7*w+3*(1-w)<<m)>>m)+((v&3*w+7*(1-w)<<A)>>A)*(8*w+4*(1-w));m=u.children[w];1===m?.count&&(this._release(m),u.children[w]=null);r+=1;u=m}};e.forEach=function(f){let c=this._root;for(;null!==c;){const d=this._linkChildren(c)||c.next;f(c);c=d}};e.find=function(f,c,d){return this._root.find(f,c,d,0,0,0)};e.findIf=function(f){let c=null;this.forEach(d=>{f(d)&&(c=d)});return c};e.findAllIf=function(f){const c=[];this.forEach(d=>{f(d)&&c.push(d)});return c};
e.findSingleOccupancyNode=function(f,c,d,p,v){let l=this._root;for(;null!==l;){var u=l.depth,r=l.xNode,A=l.yNode;const C=1-u%2;var w=l.xGeohashTotal/l.count,m=l.yGeohashTotal/l.count;if(1===l.count&&f<w&&w<=d&&c<m&&m<=p)return l;if(u>=v)l=l.next;else{m=Math.ceil((u+1)/2);u=Math.floor((u+1)/2);w=30-(3*m+2*u);var t=30-(2*m+3*u),B=~((1<<w)-1),J=~((1<<t)-1);r<<=3*C+2*(1-C);A<<=2*C+3*(1-C);u=Math.max(r,(f&B)>>w);m=Math.max(A,(c&J)>>t);w=Math.min(r+8*C+4*(1-C),(d&B)>>w);t=Math.min(A+4*C+8*(1-C),(p&J)>>
t);for(B=J=null;m<=t;m++)for(let K=u;K<=w;K++){const E=l.children[K-r+(m-A)*(8*C+4*(1-C))];E&&(J||(J=E,J.next=l.next),B&&(B.next=E),B=E,E.next=l.next)}l=J||l.next}}return null};e.getRegionDisplayIds=function(f){let c=this._root;const {bounds:d,geohashBounds:p,level:v}=f,[l,u,r,A]=d,w=[];for(;null!==c;){f=c.depth;var m=c.xNode,t=c.yNode;if(f>=v)f=c.xTotal/c.count,m=c.yTotal/c.count,f>=l&&f<=r&&m>=u&&m<=A&&c.displayIds.forEach(H=>w.push(H)),c=c.next;else{var B=Math.ceil((f+1)/2),J=Math.floor((f+1)/
2);f=1-f%2;var C=30-(3*B+2*J),K=30-(2*B+3*J),E=~((1<<C)-1),I=~((1<<K)-1);m<<=3*f+2*(1-f);t<<=2*f+3*(1-f);B=Math.max(m,(p.xLL&E)>>C);J=Math.max(t,(p.yLL&I)>>K);C=Math.min(m+8*f+4*(1-f),(p.xTR&E)>>C);K=Math.min(t+4*f+8*(1-f),(p.yTR&I)>>K);for(E=I=null;J<=K;J++)for(let H=B;H<=C;H++){const N=c.children[H-m+(J-t)*(8*f+4*(1-f))];N&&(I||(I=N,I.next=c.next),E&&(E.next=N),E=N,N.next=c.next)}c=I||c.next}}return w};e.getRegionStatistics=function(f){var c=this._root;let d=0,p=0,v=0;const l={},{bounds:u,geohashBounds:r,
level:A}=f,[w,m,t,B]=u;for(f=0;null!==c;){var J=c.depth,C=c.xNode,K=c.yNode;if(J>=A)J=c.xTotal/c.count,C=c.yTotal/c.count,J>w&&J<=t&&C>m&&C<=B&&(d+=c.count,p+=c.xTotal,v+=c.yTotal,1===c.count&&(f=c.referenceId),this._aggregateStatistics(l,c.statistics)),c=c.next;else{var E=Math.ceil((J+1)/2),I=Math.floor((J+1)/2);J=1-J%2;var H=30-(3*E+2*I),N=30-(2*E+3*I),U=~((1<<H)-1),ba=~((1<<N)-1);C<<=3*J+2*(1-J);K<<=2*J+3*(1-J);E=Math.max(C,(r.xLL&U)>>H);I=Math.max(K,(r.yLL&ba)>>N);H=Math.min(C+8*J+4*(1-J),(r.xTR&
U)>>H);N=Math.min(K+4*J+8*(1-J),(r.yTR&ba)>>N);U=ba=null;for(let la=I;la<=N;la++)for(let aa=E;aa<=H;aa++){const ka=c.children[aa-C+(la-K)*(8*J+4*(1-J))];if(ka)if(la!==I&&la!==N&&aa!==E&&aa!==H){const V=ka.xTotal/ka.count,P=ka.yTotal/ka.count;V>w&&V<=t&&P>m&&P<=B&&(d+=ka.count,p+=ka.xTotal,v+=ka.yTotal,1===ka.count&&(f=ka.referenceId),this._aggregateStatistics(l,ka.statistics))}else ba||(ba=ka,ba.next=c.next),U&&(U.next=ka),U=ka,ka.next=c.next}c=ba||c.next}}c=this.normalizeStatistics(l,d);return{count:d,
attributes:c,xTotal:p,yTotal:v,referenceId:f}};e.getBins=function(f){const c=[],{geohashBounds:d,level:p}=f;for(f=this._root;null!==f;){var v=f.depth,l=f.xNode,u=f.yNode;if(v>=p)c.push(f),f=f.next;else{var r=Math.ceil((v+1)/2),A=Math.floor((v+1)/2);v=1-v%2;var w=30-(3*r+2*A),m=30-(2*r+3*A),t=~((1<<w)-1),B=~((1<<m)-1);l<<=3*v+2*(1-v);u<<=2*v+3*(1-v);r=Math.max(l,(d.xLL&t)>>w);A=Math.max(u,(d.yLL&B)>>m);w=Math.min(l+8*v+4*(1-v),(d.xTR&t)>>w);m=Math.min(u+4*v+8*(1-v),(d.yTR&B)>>m);for(t=B=null;A<=m;A++)for(let J=
r;J<=w;J++){const C=f.children[J-l+(A-u)*(8*v+4*(1-v))];C&&(B||(B=C,B.next=f.next),t&&(t.next=C),t=C,C.next=f.next)}f=B||f.next}}return c};e._linkChildren=function(f){let c=null,d=null;for(let p=0;p<=f.children.length;p++){const v=f.children[p];v&&(c||(c=v,c.next=f.next),d&&(d.next=v),d=v,v.next=f.next)}return c};e._updateStatisticsCursor=function(f,c,d){for(const l of this._statisticFields){const u=l.name,r=l.inField?f.readAttribute(l.inField):f.getComputedNumericAtIndex(l.inFieldIndex);switch(l.statisticType){case "min":if(isNaN(r))break;
if(!c.statistics[u]){c.statistics[u]={value:r};break}c.statistics[u].value=Math.min(c.statistics[u].value,r);break;case "max":if(isNaN(r))break;if(!c.statistics[u]){c.statistics[u]={value:r};break}c.statistics[u].value=Math.max(c.statistics[u].value,r);break;case "sum":case "avg":c.statistics[u]||(c.statistics[u]={value:0,nanCount:0});var p=c.statistics[u].value,v=c.statistics[u].nanCount??0;null==r||isNaN(r)?c.statistics[u].nanCount=v+d:c.statistics[u].value=p+d*r;break;case "avg_angle":c.statistics[u]||
(c.statistics[u]={x:0,y:0,nanCount:0});p=c.statistics[u].x;v=c.statistics[u].y;const A=c.statistics[u].nanCount??0,w=Math.PI/180;null==r||isNaN(r)?c.statistics[u].nanCount=A+d:(c.statistics[u].x=p+d*Math.cos(r*w),c.statistics[u].y=v+d*Math.sin(r*w));break;case "mode":c.statistics[u]||(c.statistics[u]={}),c.statistics[u][r]=(c.statistics[u][r]||0)+d}}};e._aggregateStatistics=function(f,c){for(const d of this._statisticFields){const p=d.name;switch(d.statisticType){case "min":if(!f[p]){f[p]={value:c[p].value};
break}f[p].value=Math.min(f[p].value,c[p].value);break;case "max":if(!f[p]){f[p]={value:c[p].value};break}f[p].value=Math.max(f[p].value,c[p].value);break;case "sum":case "avg":case "avg_angle":case "mode":f[p]||(f[p]={});for(const v in c[p])f[p][v]=(f[p][v]||0)+c[p][v]}}};e.normalizeStatistics=function(f,c){const d={};for(const v of this._statisticFields){const l=v.name;switch(v.statisticType){case "min":case "max":var p=f[l];if(!c||!p)break;d[l]=p.value;break;case "count":if(!c)break;d[l]=c;break;
case "sum":if(!c)break;const {value:u,nanCount:r}=f[l];if(!(c-r))break;d[l]=u;break;case "avg":if(!c)break;const {value:A,nanCount:w}=f[l];if(!(c-w))break;d[l]=A/(c-w);break;case "avg_angle":if(!c)break;const {x:m,y:t,nanCount:B}=f[l];if(!(c-B))break;d[l]=180/Math.PI*Math.atan2(t/(c-B),m/(c-B));break;case "mode":p=f[l];let J=0,C=0,K=null;for(const E in p){const I=p[E];I===J?C+=1:I>J&&(J=I,C=1,K=E)}d[l]="null"===K||1<C?null:K}}return d};n._createClass(h,[{key:"count",get:function(){return this._root.count}},
{key:"size",get:function(){return this._nodes}},{key:"poolSize",get:function(){return F.mapOr(this._pool,0,f=>f.size)}},{key:"depth",get:function(){let f=0;this.forEach(c=>f=Math.max(f,c.depth));return f}}]);return h}(),a=function(){function h(f,c,d,p){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.referenceId=this.displayId=0;this.displayIds=new Set;this.next=null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this._tree=f;this.children=Array(32);for(f=0;f<
this.children.length;f++)this.children[f]=null;this.xNode=c;this.yNode=d;this.depth=p}var e=h.prototype;e.realloc=function(f,c,d){for(let p=0;p<this.children.length;p++)this.children[p]=null;this.xNode=f;this.yNode=c;this.depth=d;this.next=null;this.count=this.yTotal=this.xTotal=this.referenceId=this.displayId=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};this.displayIds.clear();return this};e.add=function(f){this.displayIds.add(f)};e.remove=function(f){this.displayIds.delete(f)};e.getAttributes=
function(){const f=this._tree.normalizeStatistics(this.statistics,this.count);f.referenceId=null;f.aggregateId=this.id;f.aggregateCount=this.count;return f};e.getGeometry=function(f,c){const d=this.getLngLatBounds(),[p,v,l,u]=d;f=k.project({rings:[[[p,v],[p,u],[l,u],[l,v],[p,v]]]},y.WGS84,f);f=D.convertFromPolygon(new x,f,!1,!1);return F.isSome(c)?D.quantizeOptimizedGeometry(new x,f,!1,!1,"esriGeometryPolygon",c,!1,!1):f};e.getGeometryCentroid=function(f,c){const d=this.getLngLatBounds(),[p,v,l,u]=
d;f=k.project({x:(p+l)/2,y:(v+u)/2},y.WGS84,f);f=D.convertFromPoint(new x,f);return F.isSome(c)?D.quantizeOptimizedGeometry(new x,f,!1,!1,"esriGeometryPoint",c,!1,!1):f};e.getLngLatBounds=function(){var f=this.depth;const c=Math.ceil(f/2);f=Math.floor(f/2);return z.decodeGeohashXY({geohashX:this.xNode<<30-(3*c+2*f),geohashY:this.yNode<<30-(2*c+3*f)},this.depth)};e.find=function(f,c,d,p,v,l){if(p>=d)return this;var u=1-p%2;const r=3*u+2*(1-u),A=2*u+3*(1-u),w=30-v-r,m=30-l-A;u=this.children[((f&7*u+
3*(1-u)<<w)>>w)+((c&3*u+7*(1-u)<<m)>>m)*(8*u+4*(1-u))];return null==u?null:u.find(f,c,d,p+1,v+r,l+A)};n._createClass(h,[{key:"id",get:function(){return`${this.xNode}.${this.yNode}`}}]);return h}();q.GeohashNode=a;q.GeohashTree=b;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geohash/geohashUtils":function(){define(["exports"],function(q){function n(b){return 57>=b?b-48:104>=b?b-88:107>=b?b-89:110>=b?b-90:b-91}function G(b,a,h){b[0]=a;b[1]=h;return b}function F(b,a){const h=
(b[0]+b[1])/2,e=!a;b[0]=e*b[0]+a*h;b[1]=e*h+a*b[1]}function z(b,a){a=a>(b[0]+b[1])/2;F(b,a);return a}function y(b,a){return a?1&b|(4&b)>>1|(16&b)>>2:(2&b)>>1|(8&b)>>2}function D(b,a){return a?(2&b)>>1|(8&b)>>2:1&b|(4&b)>>1|(16&b)>>2}function x(b,a,h){var e=!((b.length-1)%2);const f=b.substring(0,b.length-1);var c=n(b.charCodeAt(b.length-1)),d=0,p=0;let v=0;var l=0;e?(d=8,p=4,v=1&c|(4&c)>>1|(16&c)>>2,l=(2&c)>>1|(8&c)>>2):(d=4,p=8,l=1&c|(4&c)>>1|(16&c)>>2,v=(2&c)>>1|(8&c)>>2);a=v+a;c=l+h;h=Math.floor(a/
d);l=Math.floor(c/p);d=a-h*d;p=c-l*p;e="0123456789bcdefghjkmnpqrstuvwxyz"[e?d&1|(p&1)<<1|(d&2)<<1|(p&2)<<2|(d&4)<<2:p&1|(d&1)<<1|(p&2)<<1|(d&2)<<2|(p&4)<<2];return 1<b.length&&(h||l)?x(f,h,l)+e:f+e}const k=new Float64Array(2),g=new Float64Array(2);q.convertGeohash32ToXY=function(b,a){let h=b=0,e=30,f=30;for(let p=0;p<a.length;p++){var c=a.charCodeAt(p),d=n(c);c=0===p%2;const v=y(d,c);d=D(d,c);e-=c?3:2;f-=c?2:3;b|=v<<e;h|=d<<f}return{geohashX:b,geohashY:h}};q.decodeBase32Char=n;q.decodeGeohash=function(b,
a){const h=G(k,-90,90),e=G(g,-180,180);for(let c=0;c<a.length;c++){var f=a.charCodeAt(c);f=n(f);0===c%2?(F(e,!!(16&f)),F(e,!!(4&f)),F(e,!!(1&f)),F(h,!!(8&f)),F(h,!!(2&f))):(F(h,!!(16&f)),F(h,!!(4&f)),F(h,!!(1&f)),F(e,!!(8&f)),F(e,!!(2&f)))}b[0]=(h[0]+h[1])/2;b[1]=(e[0]+e[1])/2;return b};q.decodeGeohashXY=function(b,a){let h=-90,e=90,f=-180,c=180;for(let r=0;r<a;r++){var d=Math.ceil((r+1)/2),p=Math.floor((r+1)/2),v=1-r%2,l=30-(3*d+2*p),u=30-(2*d+3*p);p=3*v+2*(1-v);d=2*v+3*(1-v);l=(7*v+3*(1-v)<<l&b.geohashX)>>
l;v=(3*v+7*(1-v)<<u&b.geohashY)>>u;for(--p;0<=p;p--){u=(f+c)/2;const A=l&1<<p?1:0;f=(1-A)*f+A*u;c=(1-A)*u+A*c}for(--d;0<=d;d--)l=(h+e)/2,p=v&1<<d?1:0,h=(1-p)*h+p*l,e=(1-p)*l+p*e}return[f,h,c,e]};q.encodeBase32Char=function(b){return"0123456789bcdefghjkmnpqrstuvwxyz"[b]};q.encodeGeohash=function(b,a,h){let e="";const f=G(k,-90,90),c=G(g,-180,180);for(let d=0;d<h;d++){let p=0;d%2?(p|=z(f,b)<<4,p|=z(c,a)<<3,p|=z(f,b)<<2,p|=z(c,a)<<1,p|=z(f,b)<<0):(p|=z(c,a)<<4,p|=z(f,b)<<3,p|=z(c,a)<<2,p|=z(f,b)<<1,
p|=z(c,a)<<0);e+="0123456789bcdefghjkmnpqrstuvwxyz"[p]}return e};q.getRelativeGeohash=x;q.setGeohashBuf=function(b,a,h,e,f){f%2&&(f+=1);let c=0,d=0,p=-90,v=90,l=-180,u=180;for(let m=0;m<f/2;m++){for(var r=0;5>r;r++){var A=(l+u)/2,w=e>A?1:0;c|=w<<29-(r+5*m);l=(1-w)*l+w*A;u=(1-w)*A+w*u}for(r=0;5>r;r++)A=(p+v)/2,w=h>A?1:0,d|=w<<29-(r+5*m),p=(1-w)*p+w*A,v=(1-w)*A+w*v}b[2*a]=c;b[2*a+1]=d};q.setGeohashXY=function(b,a,h,e){e%2&&(e+=1);let f=0,c=0,d=-90,p=90,v=-180,l=180;for(let w=0;w<e/2;w++){for(var u=
0;5>u;u++){var r=(v+l)/2,A=h>r?1:0;f|=A<<29-(u+5*w);v=(1-A)*v+A*r;l=(1-A)*r+A*l}for(u=0;5>u;u++)r=(d+p)/2,A=a>r?1:0,c|=A<<29-(u+5*w),d=(1-A)*d+A*r,p=(1-A)*r+A*p}b.geohashX=f;b.geohashY=c};q.unpackXBits=y;q.unpackYBits=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/ClusterStore":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../core/Evented ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/diffUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/aaBoundingBox ../../../../../geometry/support/Ellipsoid ../../../../../geometry/support/spatialReferenceUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/projectionSupport ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../FeatureStore2D ../Store2D ./FeatureSetReaderJSON ../../../../../geometry/SpatialReference ../../../../../geometry/Polygon ../../../../../geometry/Extent".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r,A,w){const m=g.create();let t=function(B){function J(K,E,I,H,N){E=new f([],[E,I]);K=C.call(this,E,H,null,K);K.geohashBoundsInfo=N;return K}n._inherits(J,B);var C=n._createSuper(J);J.create=function(K,E,I,H,N,U,ba,la){E=new J(E,I,H,U,ba);E.displayId=K.createDisplayId(!0);E.referenceId=la;E.tileLevel=N;return E};B=J.prototype;B.update=function(K,E,I,H,N,U){this.geometry.coords[0]=K;this.geometry.coords[1]=E;this.tileLevel=I;this.attributes=H;this.geohashBoundsInfo=
N;this.referenceId=null;this.referenceId=U;return this};B.toJSON=function(){return{attributes:{...this.attributes,aggregateId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null},geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}};n._createClass(J,[{key:"count",get:function(){return this.attributes.cluster_count}}]);return J}(e.OptimizedFeatureWithGeometry);G=function(B){function J(K,E,I,H){var N=C.call(this,K,I);N.type="cluster";N.events=new F;N.objectIdField=
"aggregateId";N.featureAdapter=v.featureAdapter;N._geohashLevel=0;N._tileLevel=0;N._aggregateValueRanges={};N._aggregateValueRangesChanged=!1;N._geohashBuf=[];N._clusters=new Map;N._tiles=new Map;N._serviceInfo=H;N.geometryInfo=K.geometryInfo;N._spatialReference=E;N._projectionSupportCheck=c.checkProjectionSupport(E,r.WGS84);N._bitsets.geohash=I.getBitset(I.createBitset());N._bitsets.inserted=I.getBitset(I.createBitset());return N}n._inherits(J,B);var C=n._createSuper(J);B=J.prototype;B.destroy=function(){this._tree.destroy()};
B.updateSchema=async function(K,E){const I=this._schema;try{await n._get(n._getPrototypeOf(J.prototype),"updateSchema",this).call(this,K,E),await this._projectionSupportCheck}catch(N){}this._fields=this._schema.params.fields;const H=D.diff(I,E);if(!E||y.isNone(H)&&!K.source&&!K.storage.filters)I&&(K.mesh=!0);else{if(D.hasDiff(H,"params.fields")||!this._tree||K.source)this._tree&&this._tree.destroy(),this._tree=new x.GeohashTree(this._statisticFields,this._serviceInfo),this._rebuildTree(),z("esri-2d-update-debug")&&
console.debug("Aggregate mesh needs update due to tree changing");z("esri-2d-update-debug")&&console.debug("Applying Update - ClusterStore:",H);K.targets[E.name]=!0;K.mesh=!1;this._aggregateValueRanges={}}};B.clear=function(){this._rebuildTree()};B.sweepFeatures=function(K,E){this._bitsets.inserted.forEachSet(I=>{K.has(I)||(I=E.lookupByDisplayIdUnsafe(I),this._remove(I))})};B.sweepAggregates=function(K,E,I){this._clusters.forEach((H,N)=>{H&&H.tileLevel!==I&&(K.releaseDisplayId(H.displayId),E.unsetAttributeData(H.displayId),
this._clusters.delete(N))})};B.onTileData=function(K,E,I,H,N=!0){if(!this._schema||y.isNone(E.addOrUpdate))return E;this.events.emit("changed");var U=this._getTransforms(K,this._spatialReference);const ba=E.addOrUpdate.getCursor();for(;ba.next();)this._update(ba,H);if(E.status.mesh||!N)return E;H=[];this._getClustersForTile(H,K,this._schema.params.clusterRadius,I,U);E.addOrUpdate=u.FeatureSetReaderJSON.fromOptimizedFeatures(H,this._serviceInfo);E.addOrUpdate.attachStorage(I);E.clear=!0;E.end=!0;for(U=
E.addOrUpdate.getCursor();U.next();)H=U.getDisplayId(),this._bitsets.computed.unset(H),this.setComputedAttributes(I,U,H,K.scale);this._aggregateValueRangesChanged&&E.end&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1);return E};B.onTileUpdate=function({added:K,removed:E}){K.length&&(this._tileLevel=K=K[0].level,this._setGeohashLevel(K));if(this._schema){var I=this._schema.params.clusterRadius;E.forEach(H=>{this._tiles.delete(H.key.id);
this._markTileClustersForDeletion(H,I)})}};B.getAggregate=function(K){for(const E of this._clusters.values())if((E?.displayId&p.DISPLAY_ID_TEXEL_MASK)===(K&p.DISPLAY_ID_TEXEL_MASK))return E.toJSON();return null};B.getAggregates=function(){const K=[];for(const E of this._clusters.values())E?.tileLevel===this._tileLevel&&K.push(E.toJSON());return K};B.getDisplayId=function(K){return(K=this._clusters.get(K))?K.displayId:null};B.getFeatureDisplayIdsForAggregate=function(K){return(K=this._clusters.get(K))?
this._tree.getRegionDisplayIds(K.geohashBoundsInfo):[]};B.getDisplayIdForReferenceId=function(K){for(const E of this._clusters.values())if(E?.referenceId===K)return E.displayId;return null};B.getAggregateValueRanges=function(){return this._aggregateValueRanges};B.forEach=function(K){this._clusters.forEach(E=>{E&&(E=E.toJSON(),E=u.FeatureSetReaderJSON.fromFeatures([E],{objectIdField:this.objectIdField,globalIdField:null,geometryType:this.geometryInfo.geometryType,fields:this.fields}).getCursor(),E.next(),
K(E))})};B.forEachInBounds=function(K,E){};B.forEachBounds=function(K,E){const {hasM:I,hasZ:H}=this.geometryInfo;for(const N of K)K=h.getBoundsOptimizedGeometry(m,N.readGeometry(),H,I),y.isNone(K)||E(K)};B.size=function(){let K=0;this.forEach(E=>K++);return K};B._rebuildTree=function(){this._bitsets.computed.clear();this._bitsets.inserted.clear();this._tree&&this._tree.clear()};B._remove=function(K){const E=K.getDisplayId(),I=K.getXHydrated(),H=K.getYHydrated(),N=this._geohashBuf[2*E],U=this._geohashBuf[2*
E+1];this._bitsets.inserted.has(E)&&(this._bitsets.inserted.unset(E),this._tree.removeCursor(K,I,H,N,U,this._geohashLevel))};B._update=function(K,E){const I=K.getDisplayId(),H=this._bitsets.inserted;E=E.isVisible(I);var N=H.has(I);E!==N&&(E?(E=K.getXHydrated(),N=K.getYHydrated(),this._setGeohash(I,E,N)&&(this._tree.insertCursor(K,I,E,N,this._geohashBuf[2*I],this._geohashBuf[2*I+1],this._geohashLevel),H.set(I))):this._remove(K))};B._setGeohash=function(K,E,I){if(this._bitsets.geohash.has(K))return!0;
const H=this._geohashBuf;if(this._spatialReference.isWebMercator)E=E/b.earth.radius*57.29577951308232,k.setGeohashBuf(H,K,57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-I/b.earth.radius))),E-360*Math.floor((E+180)/360),12);else{I=c.project({x:E,y:I},this._spatialReference,r.WGS84);if(!I)return!1;k.setGeohashBuf(H,K,I.y,I.x,12)}this._bitsets.geohash.set(K);return!0};B._getClustersForTile=function(K,E,I,H,N,U=!0){var ba=2*I;I=Math.ceil(2**E.key.level*d.TILE_SIZE/ba)+1;var la=Math.ceil(this._schema.params.clusterPixelBuffer/
ba)+0,aa=Math.ceil(d.TILE_SIZE/ba);const {row:ka,col:V}=E.key;var P=Math.floor(V*d.TILE_SIZE/ba)-la;ba=Math.floor(ka*d.TILE_SIZE/ba)-la;const S=P+aa+2*la;la=ba+aa+2*la;for(aa=E.tileInfoView.getLODInfoAt(E.key.level);P<=S;P++)for(let Y=ba;Y<=la;Y++){var X=P;aa.wrap&&(X=0>P?P+I:P%I);const ua=aa.wrap&&0>P,ca=aa.wrap&&P%I!==P;X=this._lookupCluster(H,aa,E.key.level,X,Y,E);if(y.isSome(X)){var ra=y.applySome(N,ia=>ua?ia.left:ca?ia.right:ia.tile);if((!U||!y.isNone(ra))&&X.count&&y.isSome(ra)&&U){const ia=
X.geometry.clone();let oa=X.attributes;ia.coords[0]=h.quantizeX(ra,ia.coords[0]);ia.coords[1]=h.quantizeY(ra,ia.coords[1]);1===X.count&&y.isSome(X.referenceId)&&(oa={...X.attributes,referenceId:X.referenceId});ra=new e.OptimizedFeature(ia,oa);ra.displayId=X.displayId;K.push(ra)}}}};B._getGeohashLevel=function(K){return Math.min(Math.ceil(K/2+2),12)};B._setGeohashLevel=function(K){K=this._getGeohashLevel(K);K=1*(Math.floor(K/1)+1)-1;this._geohashLevel!==K&&(this._geohashLevel=K,this._rebuildTree(),
this._bitsets.geohash.clear())};B._getTransforms=function(K,E){const I={originPosition:"upperLeft",scale:[K.resolution,K.resolution],translate:[K.bounds[0],K.bounds[3]]};E=a.getInfo(E);if(!E)return{tile:I,left:null,right:null};const [H,N]=E.valid;return{tile:I,left:{...I,translate:[N,K.bounds[3]]},right:{...I,translate:[H-N+K.bounds[0],K.bounds[3]]}}};B._getClusterId=function(K,E,I){return(K&15)<<28|(E&16383)<<14|I&16383};B._markForDeletion=function(K,E,I){K=this._getClusterId(K,E,I);this._clusters.delete(K)};
B._getClusterBounds=function(K,E,I){var H=this._schema.params.clusterRadius,N=2*H;E=I%2?E*N:E*N-H;const U=I*N;H=E+N;I=2**K.level*d.TILE_SIZE;K.wrap&&0>E&&(E=0);K.wrap&&H>I&&(H=I);I=U/d.TILE_SIZE;H/=d.TILE_SIZE;N=(U-N)/d.TILE_SIZE;E=K.getXForColumn(E/d.TILE_SIZE);I=K.getYForRow(I);H=K.getXForColumn(H);K=K.getYForRow(N);return[E,I,H,K]};B._getGeohash=function(K,E,I){const H={geohashX:0,geohashY:0};k.setGeohashXY(H,E,K,I);return H};B._getGeohashBounds=function(K,E){const I=this._getGeohashLevel(K.key.level);
if(this._spatialReference.isWebMercator){const [aa,ka,V,P]=E;var H=ka,N=V,U=P,ba=K=E=0,la=0;E=aa/b.earth.radius*57.29577951308232;E-=360*Math.floor((E+180)/360);K=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-H/b.earth.radius)));ba=N/b.earth.radius*57.29577951308232;ba-=360*Math.floor((ba+180)/360);la=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-U/b.earth.radius)));U={geohashX:0,geohashY:0};H={geohashX:0,geohashY:0};k.setGeohashXY(U,K,E,I);k.setGeohashXY(H,la,ba,I);return{bounds:[aa,ka,
V,P],geohashBounds:{xLL:U.geohashX,yLL:U.geohashY,xTR:H.geohashX,yTR:H.geohashY},level:I}}U=A.fromExtent(w.fromBounds(E,this._spatialReference));K=c.project(U,this._spatialReference,r.WGS84,{densificationStep:64*K.resolution});if(!K)return null;K=h.convertFromPolygon(new f,K,!1,!1);ba=K.coords.filter((aa,ka)=>!(ka%2));la=K.coords.filter((aa,ka)=>ka%2);K=Math.min(...ba);U=Math.min(...la);ba=Math.max(...ba);la=Math.max(...la);K=this._getGeohash(K,U,I);U=this._getGeohash(ba,la,I);return{bounds:E,geohashBounds:{xLL:K.geohashX,
yLL:K.geohashY,xTR:U.geohashX,yTR:U.geohashY},level:I}};B._lookupCluster=function(K,E,I,H,N,U){const ba=this._getClusterId(I,H,N),la=this._clusters.get(ba);E=this._getClusterBounds(E,H,N);U=this._getGeohashBounds(U,E);if(y.isNone(U))return null;var aa=this._tree.getRegionStatistics(U);const {count:ka,xTotal:V,yTotal:P,referenceId:S}=aa;H=ka?V/ka:0;N=ka?P/ka:0;if(0===ka)return this._clusters.set(ba,null),null;aa={cluster_count:ka,...aa.attributes};K=y.isSome(la)?la.update(H,N,I,aa,U,S):t.create(K,
ba,H,N,I,aa,U,S);if(0===ka){const [X,ra,Y,ua]=E;K.geometry.coords[0]=(X+Y)/2;K.geometry.coords[1]=(ra+ua)/2}this._clusters.set(ba,K);this._updateAggregateValueRangeForCluster(K,K.tileLevel);return K};B._updateAggregateValueRangeForCluster=function(K,E){const I=this._aggregateValueRanges[E]||{minValue:Infinity,maxValue:0},H=I.minValue,N=I.maxValue;I.minValue=Math.min(H,K.count);I.maxValue=Math.max(N,K.count);this._aggregateValueRanges[E]=I;if(H!==I.minValue||N!==I.maxValue)this._aggregateValueRangesChanged=
!0};B._markTileClustersForDeletion=function(K,E){var I=2*E;E=Math.ceil(d.TILE_SIZE/I);const {row:H,col:N}=K.key,U=Math.floor(N*d.TILE_SIZE/I);I=Math.floor(H*d.TILE_SIZE/I);for(let ba=U;ba<U+E;ba++)for(let la=I;la<I+E;la++)this._markForDeletion(K.key.level,ba,la)};n._createClass(J,[{key:"featureSpatialReference",get:function(){return this._spatialReference}},{key:"fields",get:function(){return this._fields}}]);return J}(l.Store2D);q.ClusterInfo=t;q.ClusterStore=G;Object.defineProperty(q,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(q,n,G,F,z){function y(x,k,g){if(!(x.length>k))for(;x.length<=k;)x.push(g)}let D=function(){function x(){this._numerics=[];this._strings=[];this._idGenerator=new F.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=
[]}var k=x.prototype;k.createBitset=function(){const g=this._bitsets.length;this._bitsets.push(z.StaticBitSet.create(this._allocatedSize,G.DISPLAY_ID_TEXEL_MASK));return g+1};k.getBitset=function(g){return this._bitsets[g-1]};k._expand=function(){this._allocatedSize<<=1;for(const g of this._bitsets)g.resize(this._allocatedSize)};k._ensureNumeric=function(g,b){this._numerics[g]||(this._numerics[g]=[]);y(this._numerics[g],b,0)};k._ensureInstanceId=function(g){y(this._instanceIds,g,0)};k._ensureString=
function(g,b){this._strings[g]||(this._strings[g]=[]);y(this._strings[g],b,null)};k.createDisplayId=function(g=!1){const b=this._idGenerator.createId();b>this._allocatedSize&&this._expand();return G.createDisplayId(b,g)};k.releaseDisplayId=function(g){for(const b of this._bitsets)b.unset(g);return this._idGenerator.releaseId(g&G.DISPLAY_ID_TEXEL_MASK)};k.getComputedNumeric=function(g,b){return this.getComputedNumericAtIndex(g&G.DISPLAY_ID_TEXEL_MASK,0)};k.setComputedNumeric=function(g,b,a){return this.setComputedNumericAtIndex(g&
G.DISPLAY_ID_TEXEL_MASK,a,0)};k.getComputedString=function(g,b){return this.getComputedStringAtIndex(g&G.DISPLAY_ID_TEXEL_MASK,0)};k.setComputedString=function(g,b,a){return this.setComputedStringAtIndex(g&G.DISPLAY_ID_TEXEL_MASK,0,a)};k.getComputedNumericAtIndex=function(g,b){g&=G.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(b,g);return this._numerics[b][g]};k.setComputedNumericAtIndex=function(g,b,a){g&=G.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(b,g);this._numerics[b][g]=a};k.getInstanceId=function(g){g&=
G.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(g);return this._instanceIds[g]};k.setInstanceId=function(g,b){g&=G.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(g);this._instanceIds[g]=b};k.getComputedStringAtIndex=function(g,b){g&=G.DISPLAY_ID_TEXEL_MASK;this._ensureString(b,g);return this._strings[b][g]};k.setComputedStringAtIndex=function(g,b,a){g&=G.DISPLAY_ID_TEXEL_MASK;this._ensureString(b,g);this._strings[b][g]=a};k.getXMin=function(g){return this._bounds[4*(g&G.DISPLAY_ID_TEXEL_MASK)]};k.getYMin=
function(g){return this._bounds[4*(g&G.DISPLAY_ID_TEXEL_MASK)+1]};k.getXMax=function(g){return this._bounds[4*(g&G.DISPLAY_ID_TEXEL_MASK)+2]};k.getYMax=function(g){return this._bounds[4*(g&G.DISPLAY_ID_TEXEL_MASK)+3]};k.setBounds=function(g,b){b=b.readHydratedGeometry();if(!b||!b.coords.length)return!1;let a=Infinity,h=Infinity,e=-Infinity,f=-Infinity;b.forEachVertex((c,d)=>{a=Math.min(a,c);h=Math.min(h,d);e=Math.max(e,c);f=Math.max(f,d)});g&=G.DISPLAY_ID_TEXEL_MASK;y(this._bounds,4*g+4,0);this._bounds[4*
g]=a;this._bounds[4*g+1]=h;this._bounds[4*g+2]=e;this._bounds[4*g+3]=f;return!0};return n._createClass(x)}();q.ComputedAttributeStorage=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../engine/webgl/DisplayId"],function(q,n,G){let F=function(){function z(){this._freeIds=[];this._idCounter=1}var y=z.prototype;y.createId=function(D=!1){return G.createDisplayId(this._getFreeId(),
D)};y.releaseId=function(D){this._freeIds.push(D)};y._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};return n._createClass(z)}();q.DisplayIdGenerator=F;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Evented ../../../../../core/has ../../../../../chunks/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(q,n,G,F,z,y,D){const x={added:[],removed:[]},k=new Set,g=new D(0,0,0,0);return function(b){function a(e){var f=h.call(this);f._tiles=new Map;f._index=F.rbush(9,G("esri-csp-restrictions")?c=>({minX:c.bounds[0],minY:c.bounds[1],maxX:c.bounds[2],maxY:c.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);f.tiles=[];f.tileScheme=e;return f}q._inherits(a,b);var h=q._createSuper(a);b=a.prototype;b.destroy=function(){this.clear()};b.clear=function(){this.tiles.length=0;this._tiles.clear();
this._index.clear()};b.has=function(e){return this._tiles.has(e)};b.get=function(e){return this._tiles.get(e)};b.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})};b.updateTiles=function(e){const f={added:[],removed:[]};for(const c of e.added)if(!this.has(c)){const d=new z.Tile(this.tileScheme,c);this._tiles.set(c,d);this._index.insert(d);f.added.push(d)}for(const c of e.removed)this.has(c)&&(e=this.get(c),this._tiles.delete(c),this._index.remove(e),
f.removed.push(e));this.tiles.length=0;this._tiles.forEach(c=>this.tiles.push(c));(f.added.length||f.removed.length)&&this.emit("update",f)};b.setViewState=function(e){if(e=this.tileScheme.getTileCoverage(e,0)){var {spans:f,lodInfo:c}=e,{level:d}=c;if(0<f.length)for(const {row:v,colFrom:l,colTo:u}of f)for(var p=l;p<=u;p++){const r=g.set(d,v,c.normalizeCol(p),c.getWorldForColumn(p)).id;k.add(r);if(!this.has(r)){const A=new z.Tile(this.tileScheme,r);this._tiles.set(r,A);this._index.insert(A);this.tiles.push(A);
x.added.push(A)}}for(d=this.tiles.length-1;0<=d;d--)p=this.tiles[d],k.has(p.id)||(this._tiles.delete(p.id),this.tiles.splice(d,1),this._index.remove(p),x.removed.push(p));(x.added.length||x.removed.length)&&this.emit("update",x);y.pool.release(e);k.clear();x.added.length=0;x.removed.length=0}};return q._createClass(a)}(n)})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../rest/support/QuantizationParameters ../../../tiling/TileKey".split(" "),
function(q,n,G,F,z,y,D){let x=function(){function k(b,a){this.key=new D(0,0,0,0);this.bounds=z.create();this.objectIds=new Set;this.key.set(a);a=b.getLODInfoAt(this.key);this.tileInfoView=b;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=a.resolution;this.scale=a.scale;this.level=a.level}var g=k.prototype;g.createChildTiles=function(){const b=this.key.getChildKeys(),a=G.acquire();for(let h=0;h<b.length;h++)a[h]=new k(this.tileInfoView,b[h]);return a};g.getQuantizationParameters=
function(){return y.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};n._createClass(k,[{key:"id",get:function(){return this.key.id}},{key:"extent",get:function(){return F.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,
this.resolution],translate:[this.bounds[0],this.bounds[3]]}}}]);return k}();q.Tile=x;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/tiling/TileKey":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(q,n){let G=function(){function F(y,D,x,k){this.set(y,D,x,k)}F.getId=function(y,D,x,k){return"object"===typeof y?`${y.level}/${y.row}/${y.col}/${y.world}`:`${y}/${D}/${x}/${k}`};var z=F.prototype;z.acquire=function(y,D,x,k){this.set(y,
D,x,k)};z.contains=function(y){const D=y.level-this.level;return 0<=D&&this.row===y.row>>D&&this.col===y.col>>D&&this.world===y.world};z.equals=function(y){return this.level===y.level&&this.row===y.row&&this.col===y.col&&this.world===y.world};z.clone=function(){return new F(this)};z.release=function(){this.world=this.col=this.row=this.level=0};z.set=function(y,D,x,k){if(null==y)this.world=this.col=this.row=this.level=0;else if("object"===typeof y)this.level=y.level||0,this.row=y.row||0,this.col=y.col||
0,this.world=y.world||0;else if("string"===typeof y){const [g,b,a,h]=y.split("/");this.level=parseFloat(g);this.row=parseFloat(b);this.col=parseFloat(a);this.world=parseFloat(h)}else this.level=+y,this.row=+D,this.col=+x,this.world=+k||0;return this};z.toString=function(){return`${this.level}/${this.row}/${this.col}/${this.world}`};z.getParentKey=function(){return 0>=this.level?null:new F(this.level-1,this.row>>1,this.col>>1,this.world)};z.getChildKeys=function(){const y=this.level+1,D=this.row<<
1,x=this.col<<1,k=this.world;return[new F(y,D,x,k),new F(y,D,x+1,k),new F(y,D+1,x,k),new F(y,D+1,x+1,k)]};z.compareRowMajor=function(y){return this.row<y.row?-1:this.row>y.row?1:this.col<y.col?-1:this.col>y.col?1:0};q._createClass(F,[{key:"key",get:function(){return this}},{key:"id",get:function(){return this.toString()},set:function(y){this.set(y)}},{key:"hash",get:function(){return(this.world&3)<<30|(this.col&4095)<<22|(this.row&4095)<<8|this.level&63}}]);return F}();G.pool=new n(G,null,null,25,
50);return G})},"esri/views/2d/tiling/TileCoverage":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/ObjectPool"],function(q,n){let G=function(){function F(){this.spans=[]}var z=F.prototype;z.acquire=function(y){this.lodInfo=y};z.release=function(){this.lodInfo=null;this.spans.length=0};z.forEach=function(y,D){const {spans:x,lodInfo:k}=this,{level:g}=k;if(0!==x.length)for(const {row:b,colFrom:a,colTo:h}of x)for(let e=a;e<=h;e++)y.call(D,g,b,k.normalizeCol(e),k.getWorldForColumn(e))};
return q._createClass(F)}();G.pool=new n(G);return G})},"esri/views/2d/tiling/TileInfoView":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(q,n,G,F,z,y){const D=new z("0/0/0/0");let x=function(){function g(a,h,e,f,c,d,p,v){this.x=a;this.ymin=h;this.ymax=e;this.invM=f;this.leftAdjust=c;this.rightAdjust=d;this.leftBound=p;this.rightBound=v}g.create=function(a,h){a[1]>h[1]&&
([a,h]=[h,a]);const [e,f]=a,[c,d]=h;a=c-e;h=d-f;h=0!==h?a/h:0;const p=(Math.ceil(f)-f)*h,v=(Math.floor(f)-f)*h;return new g(e,Math.floor(f),Math.ceil(d),h,0>a?p:v,0>a?v:p,0>a?c:e,0>a?e:c)};var b=g.prototype;b.incrRow=function(){this.x+=this.invM};b.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};b.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return q._createClass(g)}();const k=[[0,0],[0,0],[0,0],[0,0]];return function(){function g(a,
h=null){this.tileInfo=a;this.fullExtent=h;this.scales=[];this._infoByScale={};this._infoByLevel={};const e=a.lods.slice();e.sort((c,d)=>d.scale-c.scale);const f=this._lodInfos=e.map(c=>G.create(a,c,h));e.forEach((c,d)=>{this._infoByLevel[c.level]=f[d];this._infoByScale[c.scale]=f[d];this.scales[d]=c.scale},this);this._wrap=a.isWrappable}var b=g.prototype;b.getLODInfoAt=function(a){return this._infoByLevel["number"===typeof a?a:a.level]};b.getTileBounds=function(a,h,e=!1){D.set(h);return(h=this._infoByLevel[D.level])?
h.getTileBounds(a,D,e):a};b.getTileCoords=function(a,h,e=!1){D.set(h);return(h=this._infoByLevel[D.level])?h.getTileCoords(a,D,e):a};b.getTileCoverage=function(a,h=192,e="closest"){e="closest"===e?this.getClosestInfoForScale(a.scale):this.getSmallestInfoForScale(a.scale);const f=F.pool.acquire(e),c=this._wrap;var d=Infinity;let p=-Infinity;const v=f.spans;k[0][0]=k[0][1]=k[1][1]=k[3][0]=-h;k[1][0]=k[2][0]=a.size[0]+h;k[2][1]=k[3][1]=a.size[1]+h;for(l of k)a.toMap(l,l),l[0]=e.getColumnForX(l[0]),l[1]=
e.getRowForY(l[1]);a=[];var l=3;for(h=0;4>h;h++)k[h][1]===k[l][1]?l=h:(l=x.create(k[h],k[l]),d=Math.min(l.ymin,d),p=Math.max(l.ymax,p),void 0===a[l.ymin]&&(a[l.ymin]=[]),a[l.ymin].push(l),l=h);if(null==d||null==p||100<p-d)return null;for(h=[];d<p;){null!=a[d]&&(h=h.concat(a[d]));l=Infinity;var u=-Infinity;for(var r=h.length-1;0<=r;r--){var A=h[r];l=Math.min(l,A.getLeftCol());u=Math.max(u,A.getRightCol())}l=Math.floor(l);u=Math.floor(u);if(d>=e.first[1]&&d<=e.last[1])if(c)if(e.size[0]<e.worldSize[0])for(r=
Math.floor(u/e.worldSize[0]),A=Math.floor(l/e.worldSize[0]);A<=r;A++)v.push(new y(d,Math.max(e.getFirstColumnForWorld(A),l),Math.min(e.getLastColumnForWorld(A),u)));else v.push(new y(d,l,u));else l>e.last[0]||u<e.first[0]||(l=Math.max(l,e.first[0]),u=Math.min(u,e.last[0]),v.push(new y(d,l,u)));d+=1;for(l=h.length-1;0<=l;l--)u=h[l],u.ymax>=d?u.incrRow():h.splice(l,1)}return f};b.getTileParentId=function(a){D.set(a);a=this._lodInfos.indexOf(this._infoByLevel[D.level])-1;if(0>a)return null;this._getTileIdAtLOD(D,
this._lodInfos[a],D);return D.id};b.getTileResolution=function(a){return(a=this._infoByLevel["object"===typeof a?a.level:a])?a.resolution:-1};b.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1};b.intersects=function(a,h){D.set(h);h=this._infoByLevel[D.level];const e=a.lodInfo;if(e.resolution>h.resolution){this._getTileIdAtLOD(D,e,D);var f=e.denormalizeCol(D.col,D.world);for(var c of a.spans)if(c.row===D.row&&c.colFrom<=f&&c.colTo>=f)return!0}if(e.resolution<h.resolution){const [p,
v,l,u]=a.spans.reduce((r,A)=>{r[0]=Math.min(r[0],A.row);r[1]=Math.max(r[1],A.row);r[2]=Math.min(r[2],A.colFrom);r[3]=Math.max(r[3],A.colTo);return r},[Infinity,-Infinity,Infinity,-Infinity]);f=h.denormalizeCol(D.col,D.world);a=e.getColumnForX(h.getXForColumn(f));c=e.getRowForY(h.getYForRow(D.row));f=e.getColumnForX(h.getXForColumn(f+1))-1;h=e.getRowForY(h.getYForRow(D.row+1))-1;return!(a>u||f<l||c>v||h<p)}const d=e.denormalizeCol(D.col,D.world);return a.spans.some(p=>p.row===D.row&&p.colFrom<=d&&
p.colTo>=d)};b.normalizeBounds=function(a,h,e){a[0]=h[0];a[1]=h[1];a[2]=h[2];a[3]=h[3];this._wrap&&(h=n.getInfo(this.tileInfo.spatialReference),e=-e*(h.valid[1]-h.valid[0]),a[0]+=e,a[2]+=e);return a};b.getSmallestInfoForScale=function(a){const h=this.scales;if(this._infoByScale[a])return this._infoByScale[a];if(a>h[0])return this._infoByScale[h[0]];for(let e=1;e<h.length-1;e++)if(a>h[e]+1E-6)return this._infoByScale[h[e-1]];return this._infoByScale[h[h.length-1]]};b.getClosestInfoForScale=function(a){const h=
this.scales;if(this._infoByScale[a])return this._infoByScale[a];a=h.reduce((e,f)=>Math.abs(f-a)<Math.abs(e-a)?f:e,h[0]);return this._infoByScale[a]};b.scaleToLevel=function(a){const h=this.scales;if(this._infoByScale[a])return this._infoByScale[a].level;for(let e=h.length-1;0<=e;e--)if(a<h[e])return e===h.length-1?this._infoByScale[h[h.length-1]].level:this._infoByScale[h[e]].level+(h[e]-a)/(h[e]-h[e+1]);return this._infoByScale[h[0]].level};b.scaleToZoom=function(a){return this.tileInfo.scaleToZoom(a)};
b._getTileIdAtLOD=function(a,h,e){const f=this._infoByLevel[e.level];a.set(e);if(h.resolution<f.resolution)return null;if(h.resolution===f.resolution)return a;a.level=h.level;a.col=Math.floor(e.col*f.resolution/h.resolution+.01);a.row=Math.floor(e.row*f.resolution/h.resolution+.01);return a};q._createClass(g,[{key:"spatialReference",get:function(){return this.tileInfo.spatialReference}}]);return g}()})},"esri/views/2d/tiling/LODInfo":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"../../../core/maybe","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(q,n,G,F){function z(D,x,k){D[0]=x;D[1]=k;return D}const y=new F("0/0/0/0");return function(){function D(k,g,b,a,h,e,f,c,d,p,v,l){this.level=k;this.resolution=g;this.scale=b;this.origin=a;this.first=h;this.last=e;this.size=f;this.norm=c;this.worldStart=d;this.worldEnd=p;this.worldSize=v;this.wrap=l}D.create=function(k,g,b=null){var a=G.getInfo(k.spatialReference);const h=g.origin||[k.origin.x,k.origin.y],
e=[k.size[0]*g.resolution,k.size[1]*g.resolution],f=[-Infinity,-Infinity],c=[Infinity,Infinity],d=[Infinity,Infinity];n.isSome(b)&&(z(f,Math.max(0,Math.floor((b.xmin-h[0])/e[0])),Math.max(0,Math.floor((h[1]-b.ymax)/e[1]))),z(c,Math.max(0,Math.floor((b.xmax-h[0])/e[0])),Math.max(0,Math.floor((h[1]-b.ymin)/e[1]))),z(d,c[0]-f[0]+1,c[1]-f[1]+1));const {cols:p,rows:v}=g;!b&&p&&v&&(z(f,p[0],v[0]),z(c,p[1],v[1]),z(d,p[1]-p[0]+1,v[1]-v[0]+1));let l;k.isWrappable?(k=[Math.ceil(Math.round((a.valid[1]-a.valid[0])/
g.resolution)/k.size[0]),d[1]],a=[Math.floor((a.origin[0]-h[0])/e[0]),f[1]],b=[k[0]+a[0]-1,c[1]],l=!0):(a=f,b=c,k=d,l=!1);return new D(g.level,g.resolution,g.scale,h,f,c,d,e,a,b,k,l)};var x=D.prototype;x.normalizeCol=function(k){if(!this.wrap)return k;const g=this.worldSize[0];return 0>k?g-1-Math.abs((k+1)%g):k%g};x.denormalizeCol=function(k,g){return this.wrap?this.worldSize[0]*g+k:k};x.getWorldForColumn=function(k){return this.wrap?Math.floor(k/this.worldSize[0]):0};x.getFirstColumnForWorld=function(k){return k*
this.worldSize[0]+this.first[0]};x.getLastColumnForWorld=function(k){return k*this.worldSize[0]+this.first[0]+this.size[0]-1};x.getColumnForX=function(k){return(k-this.origin[0])/this.norm[0]};x.getXForColumn=function(k){return this.origin[0]+k*this.norm[0]};x.getRowForY=function(k){return(this.origin[1]-k)/this.norm[1]};x.getYForRow=function(k){return this.origin[1]-k*this.norm[1]};x.getTileBounds=function(k,g,b=!1){y.set(g);var a=b?y.col:this.denormalizeCol(y.col,y.world),h=y.row;g=this.getXForColumn(a);
b=this.getYForRow(h+1);a=this.getXForColumn(a+1);h=this.getYForRow(h);k[0]=g;k[1]=b;k[2]=a;k[3]=h;return k};x.getTileCoords=function(k,g,b=!1){y.set(g);g=b?y.col:this.denormalizeCol(y.col,y.world);Array.isArray(k)?z(k,this.getXForColumn(g),this.getYForRow(y.row)):(k.x=this.getXForColumn(g),k.y=this.getYForRow(y.row));return k};return q._createClass(D)}()})},"esri/views/2d/tiling/TileSpan":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(q){return q._createClass(function(n,
G,F){this.row=n;this.colFrom=G;this.colTo=F})})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/BidiText ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/accessorSupport/diffUtils ../../../../../geometry/SpatialReference ../../../engine/webgl/DisplayId ../../../engine/webgl/enums ../../../engine/webgl/mesh/MeshData ../../../engine/webgl/mesh/factories/WGLMeshFactory ../../../engine/webgl/mesh/templates/WGLTemplateStore ../../../engine/webgl/util/Matcher ../textUtils ./BaseProcessor ../support/ResourceManagerProxy".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r){function A(m,t){return(!m.minScale||m.minScale>=t)&&(!m.maxScale||m.maxScale<=t)}function w(m){m=m.message;const t={message:{data:{},tileKey:m.tileKey,tileKeyOrigin:m.tileKeyOrigin,version:m.version},transferList:[]};for(const C in m.data){var B=m.data[C];t.message.data[C]=null;if(D.isSome(B)){var J=B.stride;const K=B.indices.slice(0),E=B.vertices.slice(0),I=B.records.slice(0);B=D.applySome(B.metrics,H=>H.slice(0));J={stride:J,indices:K,vertices:E,
records:I,metrics:B};t.transferList.push(K,E,I);t.message.data[C]=J}}return t}F=function(m){function t(){var J=B.apply(this,arguments);J.type="symbol";J._matchers={feature:null,aggregate:null};J._bufferData=new Map;J._bufferIds=new Map;return J}q._inherits(t,m);var B=q._createSuper(t);m=t.prototype;m.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._resourceManagerProxy=new r(this.remoteClient)};m.destroy=function(){this._resourceManagerProxy.destroy()};
m.forEachBufferId=function(J){this._bufferIds.forEach(C=>{C.forEach(J)})};m.update=async function(J,C){C=C.schema.processors[0];if("symbol"===C.type){var K=a.diff(this._schema,C);if(a.hasDiff(K,"mesh")||a.hasDiff(K,"target"))J.mesh=!0,J.why?.mesh.push("Symbology changed"),this._schema=C,this._factory=this._createFactory(C),this._factory.update(C,this.tileStore.tileScheme.tileInfo)}};m.onTileMessage=function(J,C,K,E){x.throwIfAborted(E);return this._onTileData(J,C,K,E)};m.onTileClear=function(J){this._bufferData.delete(J.key.id);
this._bufferIds.delete(J.key.id);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:J.id,data:{clear:!0}})};m.onTileError=function(J,C,K){return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:J.id,error:C},{signal:K.signal})};m.onTileUpdate=function(J){for(const C of J.removed)this._bufferData.has(C.key.id)&&this._bufferData.delete(C.key.id),this._bufferIds.has(C.key.id)&&this._bufferIds.delete(C.key.id);for(const C of J.added)this._bufferData.forEach(K=>{for(const E of K)E.message.tileKey===
C.id&&this._updateTileMesh("append",C,w(E),[],!1,!1,null)})};m._addBufferData=function(J,C){this._bufferData.has(J)||this._bufferData.set(J,[]);this._bufferData.get(J)?.push(w(C))};m._createFactory=function(J){const {geometryType:C,objectIdField:K,fields:E}=this.service,I=h.fromJSON(this.spatialReference),H={geometryType:C,fields:E,spatialReference:I},N=new p.WGLTemplateStore((la,aa)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",la,aa),this.tileStore.tileScheme.tileInfo),{matcher:U,aggregateMatcher:ba}=
J.mesh;this._store=N;this._matchers.feature=v.createMatcher(U,N,H,this._resourceManagerProxy);this._matchers.aggregate=D.applySome(ba,la=>v.createMatcher(la,N,H,this._resourceManagerProxy));return new d.WGLMeshFactory(C,K,N)};m._onTileData=async function(J,C,K,E){x.throwIfAborted(E);const {type:I,addOrUpdate:H,remove:N,clear:U,end:ba}=C;var la=!!this._schema.mesh.sortKey;if(!H)return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:J.id,data:{type:I,addOrUpdate:null,remove:N,clear:U,end:ba,
sort:la}},E);K=this._processFeatures(J,H,K,E,C.status?.version);try{var aa=await K;if(D.isNone(aa))return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:J.id,data:{type:I,addOrUpdate:null,remove:N,clear:U,end:ba,sort:la}},E);la=[];for(const ka of aa){aa=!1;const V=ka.message.bufferIds,P=J.key.id,S=ka.message.tileKey;if(P!==S&&D.isSome(V)){if(!this.tileStore.get(S)){this._addBufferData(P,ka);la.push(ka);continue}let X=this._bufferIds.get(S);X||(X=new Set,this._bufferIds.set(S,X));const ra=
Array.from(V);for(const Y of ra)if(X.has(Y)){aa=!0;break}else X.add(Y)}aa||(this._addBufferData(P,ka),la.push(ka))}await Promise.all(la.map(ka=>{const V=J.key.id===ka.message.tileKey;return this._updateTileMesh(I,J,ka,V?C.remove:[],V&&C.end,!!C.clear,E.signal)}))}catch(ka){this._handleError(J,ka,E)}};m._updateTileMesh=async function(J,C,K,E,I,H,N){const U=K.message.tileKey,ba=!!this._schema.mesh.sortKey;U!==C.key.id&&(I=!1);C=D.applySome(K,la=>la.message);K=D.applySome(K,la=>la.transferList)||[];
J={type:J,addOrUpdate:C,remove:E,clear:H,end:I,sort:ba};N={transferList:D.unwrap(K)||[],signal:N};x.throwIfAborted(N);return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:U,data:J},N)};m._processFeatures=async function(J,C,K,E,I){if(D.isNone(C)||!C.hasFeatures)return null;const H={transform:J.transform,hasZ:!1,hasM:!1},N=this._factory,U={viewingMode:"",scale:J.scale},ba=await this._matchers.feature,la=await this._matchers.aggregate;x.throwIfAborted(E);const aa=this._getLabelInfos(J,
C);await N.analyze(C.getCursor(),this._resourceManagerProxy,ba,la,H,U);x.throwIfAborted(E);return this._writeFeatureSet(J,C,H,aa,N,K,I)};m._writeFeatureSet=function(J,C,K,E,I,H,N){const U=C.getSize(),ba=this._schema.mesh.matcher.symbologyType;H=new c.MeshData(J.key.id,{features:U,records:U,metrics:0},ba,H,ba!==f.WGLSymbologyType.HEATMAP,N);N={viewingMode:"",scale:J.scale};for(C=C.getCursor();C.next();)try{const la=C.getDisplayId(),aa=D.isSome(E)?E.get(la):null;I.writeCursor(H,C,K,N,J.level,aa,this._resourceManagerProxy)}catch(la){}return H.serialize(J.tileInfoView.tileInfo.isWrappable)};
m._handleError=function(J,C,K){return x.isAbortError(C)?Promise.resolve():this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:J.id,error:C.message},{signal:K.signal})};m._getLabelingSchemaForScale=function(J){var C=this._schema.mesh.labels;if(D.isNone(C))return null;if("subtype"===C.type){const K={type:"subtype",classes:{}};let E=!1;for(const I in C.classes){const H=C.classes[I].filter(N=>A(N,J.scale));E=E||!!H.length;K.classes[I]=H}return E?K:null}C=C.classes.filter(K=>A(K,J.scale));return C.length?
{type:"simple",classes:C}:null};m._getLabels=function(J,C){if("subtype"===C.type){const K=D.unwrapOrThrow(this.service.subtypeField,"Expected to find subtype Field");J=J.readAttribute(K);return null==J?[]:C.classes[J]??[]}return C.classes};m._getLabelInfos=function(J,C){J=this._getLabelingSchemaForScale(J);if(D.isNone(J))return null;const K=new Map;for(C=C.getCursor();C.next();){const I=C.getDisplayId(),H=[],N=e.isAggregateId(I),U=N&&1!==C.readAttribute("cluster_count")?"aggregate":"feature";var E=
this._getLabels(C,J);for(const ba of E){if(ba.target!==U)continue;E=C.getStorage();E=N&&"feature"===U?E.getComputedStringAtIndex(C.readAttribute("referenceId"),ba.fieldIndex):E.getComputedStringAtIndex(I,ba.fieldIndex);if(!E)continue;E=G.bidiText(E.toString());const la=E[1];this._store.getMosaicItem(ba.symbol,l.codepoints(E[0])).then(aa=>{H[ba.index]={glyphs:aa.glyphMosaicItems??[],rtl:la,index:ba.index}})}K.set(I,H)}return K};q._createClass(t,[{key:"supportsTileUpdates",get:function(){return!0}}]);
return t}(u);return F=n.__decorate([b.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],F)})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],function(q,n){const G=new n;q.bidiText=function(F){if(null==F)return["",!1];if(!G.hasBidiChar(F))return[F,!1];let z;z="rtl"===G.checkContextual(F)?"IDNNN":"ICNNN";return[G.bidiTransform(F,z,"VLYSN"),!0]};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h){function e(c){switch(c){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function f(c){switch(c){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}G=function(){function c(p,v,l,u,r,A=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=v;this.tileKey=p;this._hasAggregate=u;this._pixelBufferEnabled=r;this._version=A;this._symbologyType=l}var d=c.prototype;d.serialize=function(p){const v=[];v.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((l,u)=>{var r=1<<u;u=e(r);r=f(r);u=h.getPow2NeighborKey(new z(this.tileKey),u,r,p);u=this._serializeTileVertexData(this.tileKey,u.id,l.vertexData);u.message.bufferIds=
l.displayIds;v.push(u)});return v};d._serializeTileVertexData=function(p,v,l){const u=[];l={[g.WGLGeometryType.MARKER]:l.get(g.WGLGeometryType.MARKER)?.serialize(u),[g.WGLGeometryType.FILL]:l.get(g.WGLGeometryType.FILL)?.serialize(u),[g.WGLGeometryType.LINE]:l.get(g.WGLGeometryType.LINE)?.serialize(u),[g.WGLGeometryType.TEXT]:l.get(g.WGLGeometryType.TEXT)?.serialize(u),[g.WGLGeometryType.LABEL]:l.get(g.WGLGeometryType.LABEL)?.serialize(u)};return{message:{tileKeyOrigin:p,tileKey:v,data:l,version:this._version},
transferList:u}};d.featureStart=function(p,v){this._current.insertAfter=p;this._current.sortKey=v};d.featureEnd=function(){};d.recordStart=function(p,v,l,u){this._current.writer=this._getVertexWriter(l);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=u;this._current.id=p;this._current.materialKey=v;this._current.geometryType=l;this._current.isDotDensity=!1;this._current.writer.recordStart()};
d.recordCount=function(){return this._current.writer.recordCount};d.vertexCount=function(){return this._current.writer.vertexCount};d.indexCount=function(){return this._current.writer.indexCount};d.vertexEnsureSize=function(p){this._current.writer.vertexEnsureSize(p)};d.indexEnsureSize=function(p){this._current.writer.indexEnsureSize(p)};d.vertexBounds=function(p,v,l,u){this._current.bufferingEnabled&&this._addOverlap(p,v,l,u)};d.vertexWrite=function(p){this._current.writer.writeVertex(p)};d.vertexWriteF32=
function(p){this._current.writer.writeVertexF32(p)};d.vertexEnd=function(){};d.vertexWriter=function(){return this._current.writer.vertexWriter};d.indexWrite=function(p){this._current.writer.writeIndex(p)};d.indexWriter=function(){return this._current.writer.indexWriter};d.metricWriter=function(){return this._current.writer.metricWriter};d.metricStart=function(p,v,l,u,r,A,w,m){this._current.writer=this._getVertexWriter(g.WGLGeometryType.LABEL);const t=this._current.writer.metricWriter;t.push(k.getDisplayIdTexel(p));
t.push(v);t.push(l);t.push(u);t.push(r);t.push(A);t.push(w);t.push(m);t.push(255);this._current.metricBoxLenPointer=t.push(0)};d.metricEnd=function(){const p=this._current.writer.metricWriter;0===p.getValue(this._current.metricBoxLenPointer)&&p.seek(p.length-10)};d.metricBoxWrite=function(p,v,l,u){const r=this._current.writer.metricWriter;r.incr(this._current.metricBoxLenPointer);r.push(0);r.push(0);r.push(p);r.push(v);r.push(l);r.push(u)};d.recordEnd=function(){var p=this._current.vertStart,v=this._current.writer.vertexCount-
p;if(!v)return!1;this.hasRecords=!0;var l=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,l,this._current.writer.indexCount-l,p,v,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===g.WGLGeometryType.LABEL)return!0;p=this._current.writer;for(v=0;8>v;v++){var u=1<<v;if(this._current.overlaps&u){this._data.neighbors[v]||(this._data.neighbors[v]={vertexData:new Map,
displayIds:new Set});l=this._data.neighbors[v];var r=this._current.geometryType;if(!l.vertexData.has(r)){var A=b.getStrides(r,this._symbologyType).geometry;A=new a.VertexDataWriter(r,A,x.PATCH_PIXEL_BUFFER_ALLOC_SIZE);l.vertexData.set(r,A)}r=l.vertexData.get(this._current.geometryType);A=4096*-e(u);u=4096*-f(u);r?.copyLastFrom(p,A,u);l.displayIds.add(this._current.id)}}return!0};d._addOverlap=function(p,v,l,u){this._current.overlaps|=255^((p<0+l?148:p>=x.TILE_SIZE-l?41:189)|(v<0+u?224:v>=x.TILE_SIZE-
u?7:231))};d._getVertexWriter=function(p){if(!this._data.self.has(p)){const v=this._data.self,l=b.getStrides(p,this._symbologyType).geometry;v.set(p,new a.VertexDataWriter(p,l,this.hint.records))}return this._data.self.get(p)};n._createClass(c,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return c}();q.MeshData=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/tiling/PagedTileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b){function a(d,p){d.length=0;p.forEach(v=>d.push(v));return d}const h=new Set,e=[],f=new Map,c=[0,0];G=function(d){function p(l){l=v.call(this,l);l._keyToItem=new Map;l.concurrency=6;l.strategy="scale-first";l.tileInfoView=null;return l}q._inherits(p,d);var v=q._createSuper(p);d=p.prototype;d.initialize=function(){const {concurrency:l,process:u}=this;this._queue=new b.QueueProcessor({concurrency:l,process:(r,A)=>{r=this._keyToItem.get(r);return u(r,{signal:A})},peeker:r=>
r.values().next().value})};d.destroy=function(){this.clear();this._queue=F.destroyMaybe(this._queue)};d.abort=function(l){this._queue.abort("string"===typeof l?l:l.id)};d.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};d.has=function(l){return"string"===typeof l?this._keyToItem.has(l):this._keyToItem.has(l.id)};d.isOngoing=function(l){l="string"===typeof l?l:l.id;return this.has(l)&&this._queue.isOngoing(l)};d.pause=function(){this._queue.pause()};d.push=
function(l,u){const r=l.key.id+"-"+u;if(this.has(r))return this.get(r);u=this._queue.push(r);const A=()=>{this._keyToItem.delete(r);this.notifyChange("updating")};this._keyToItem.set(r,l);u.then(A,A);this.notifyChange("updating");return u};d.reset=function(){this._queue.reset();this.notifyChange("updating")};d.resume=function(){this._queue.resume()};d._peekByScaleFirst=function(l){if(!this.state)return l.values().next().value;const u=this.tileInfoView;let r=Number.NEGATIVE_INFINITY,A=Number.POSITIVE_INFINITY;
l.forEach(J=>{J=this._keyToItem.get(J);const C=this.tileInfoView.getTileScale(J.key);f.has(C)||(f.set(C,[]),r=Math.max(C,r),A=Math.min(C,A));f.get(C).push(J.key);h.add(C)});let w=this.state.scale;f.has(w)||(a(e,h),e.sort((J,C)=>J-C),w=e.reduce((J,C)=>Math.abs(C-w)<Math.abs(J-w)?C:J,e[0]));w=Math.min(w,r);w=Math.max(w,A);l=f.get(w);const m=u.getClosestInfoForScale(w),t=m.getColumnForX(this.state.center[0]),B=m.getRowForY(this.state.center[1]);l.sort((J,C)=>{const K=m.denormalizeCol(J.col,J.world),
E=m.denormalizeCol(C.col,C.world);return Math.sqrt((t-K)*(t-K)+(B-J.row)*(B-J.row))-Math.sqrt((t-E)*(t-E)+(B-C.row)*(B-C.row))});h.clear();f.clear();return l[0].id};d._peekByCenterFirst=function(l){if(!this.state)return l.values().next().value;const u=this.tileInfoView,r=this.state.center;let A=Number.POSITIVE_INFINITY,w;l.forEach(m=>{m=this._keyToItem.get(m);u.getTileCoords(c,m.key);const t=g.distance(c,r);t<A&&(A=t,w=m.key)});return w.id};q._createClass(p,[{key:"length",get:function(){return this._queue?
this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return p}(G);n.__decorate([z.property({constructOnly:!0})],G.prototype,"concurrency",void 0);n.__decorate([z.property({constructOnly:!0})],G.prototype,"process",void 0);n.__decorate([z.property()],G.prototype,"state",void 0);n.__decorate([z.property({constructOnly:!0})],G.prototype,"strategy",void 0);n.__decorate([z.property({constructOnly:!0})],
G.prototype,"tileInfoView",void 0);n.__decorate([z.property({readOnly:!0})],G.prototype,"updating",null);return G=n.__decorate([k.subclass("esri.views.2d.tiling.PagedTileQueue")],G)})},"esri/chunks/vec2":function(){define(["exports","./common"],function(q,n){function G(aa,ka){aa[0]=ka[0];aa[1]=ka[1];return aa}function F(aa,ka,V){aa[0]=ka;aa[1]=V;return aa}function z(aa,ka,V){aa[0]=ka[0]+V[0];aa[1]=ka[1]+V[1];return aa}function y(aa,ka,V){aa[0]=ka[0]-V[0];aa[1]=ka[1]-V[1];return aa}function D(aa,ka,
V){aa[0]=ka[0]*V[0];aa[1]=ka[1]*V[1];return aa}function x(aa,ka,V){aa[0]=ka[0]/V[0];aa[1]=ka[1]/V[1];return aa}function k(aa,ka){aa[0]=Math.ceil(ka[0]);aa[1]=Math.ceil(ka[1]);return aa}function g(aa,ka){aa[0]=Math.floor(ka[0]);aa[1]=Math.floor(ka[1]);return aa}function b(aa,ka,V){aa[0]=Math.min(ka[0],V[0]);aa[1]=Math.min(ka[1],V[1]);return aa}function a(aa,ka,V){aa[0]=Math.max(ka[0],V[0]);aa[1]=Math.max(ka[1],V[1]);return aa}function h(aa,ka){aa[0]=Math.round(ka[0]);aa[1]=Math.round(ka[1]);return aa}
function e(aa,ka,V){aa[0]=ka[0]*V;aa[1]=ka[1]*V;return aa}function f(aa,ka,V,P){aa[0]=ka[0]+V[0]*P;aa[1]=ka[1]+V[1]*P;return aa}function c(aa,ka){const V=ka[0]-aa[0];aa=ka[1]-aa[1];return Math.sqrt(V*V+aa*aa)}function d(aa,ka){const V=ka[0]-aa[0];aa=ka[1]-aa[1];return V*V+aa*aa}function p(aa){const ka=aa[0];aa=aa[1];return Math.sqrt(ka*ka+aa*aa)}function v(aa){const ka=aa[0];aa=aa[1];return ka*ka+aa*aa}function l(aa,ka){aa[0]=-ka[0];aa[1]=-ka[1];return aa}function u(aa,ka){aa[0]=1/ka[0];aa[1]=1/ka[1];
return aa}function r(aa,ka){var V=ka[0];const P=ka[1];V=V*V+P*P;0<V&&(V=1/Math.sqrt(V),aa[0]=ka[0]*V,aa[1]=ka[1]*V);return aa}function A(aa,ka){return aa[0]*ka[0]+aa[1]*ka[1]}function w(aa,ka,V){ka=ka[0]*V[1]-ka[1]*V[0];aa[0]=aa[1]=0;aa[2]=ka;return aa}function m(aa,ka,V,P){const S=ka[0];ka=ka[1];aa[0]=S+P*(V[0]-S);aa[1]=ka+P*(V[1]-ka);return aa}function t(aa,ka){ka=ka||1;const V=2*n.RANDOM()*Math.PI;aa[0]=Math.cos(V)*ka;aa[1]=Math.sin(V)*ka;return aa}function B(aa,ka,V){const P=ka[0];ka=ka[1];aa[0]=
V[0]*P+V[2]*ka;aa[1]=V[1]*P+V[3]*ka;return aa}function J(aa,ka,V){const P=ka[0];ka=ka[1];aa[0]=V[0]*P+V[2]*ka+V[4];aa[1]=V[1]*P+V[3]*ka+V[5];return aa}function C(aa,ka,V){const P=ka[0];ka=ka[1];aa[0]=V[0]*P+V[3]*ka+V[6];aa[1]=V[1]*P+V[4]*ka+V[7];return aa}function K(aa,ka,V){const P=ka[0];ka=ka[1];aa[0]=V[0]*P+V[4]*ka+V[12];aa[1]=V[1]*P+V[5]*ka+V[13];return aa}function E(aa,ka,V,P){const S=ka[0]-V[0];ka=ka[1]-V[1];const X=Math.sin(P);P=Math.cos(P);aa[0]=S*P-ka*X+V[0];aa[1]=S*X+ka*P+V[1];return aa}
function I(aa,ka){var V=aa[0];aa=aa[1];const P=ka[0];ka=ka[1];let S=V*V+aa*aa;0<S&&(S=1/Math.sqrt(S));let X=P*P+ka*ka;0<X&&(X=1/Math.sqrt(X));V=(V*P+aa*ka)*S*X;return 1<V?0:-1>V?Math.PI:Math.acos(V)}function H(aa){return"vec2("+aa[0]+", "+aa[1]+")"}function N(aa,ka){return aa[0]===ka[0]&&aa[1]===ka[1]}function U(aa,ka){const V=aa[0];aa=aa[1];const P=ka[0];ka=ka[1];const S=n.getEpsilon();return Math.abs(V-P)<=S*Math.max(1,Math.abs(V),Math.abs(P))&&Math.abs(aa-ka)<=S*Math.max(1,Math.abs(aa),Math.abs(ka))}
function ba(aa,ka,V,P,S){let X=ka[0]-V[0];V=ka[1]-V[1];S=(P[0]*X+P[1]*V)*(S-1);X=P[0]*S;V=P[1]*S;aa[0]=ka[0]+X;aa[1]=ka[1]+V;return aa}const la=Object.freeze(Object.defineProperty({__proto__:null,add:z,angle:I,ceil:k,copy:G,cross:w,dist:c,distance:c,div:x,divide:x,dot:A,equals:U,exactEquals:N,floor:g,inverse:u,len:p,length:p,lerp:m,max:a,min:b,mul:D,multiply:D,negate:l,normalize:r,projectAndScale:ba,random:t,rotate:E,round:h,scale:e,scaleAndAdd:f,set:F,sqrDist:d,sqrLen:v,squaredDistance:d,squaredLength:v,
str:H,sub:y,subtract:y,transformMat2:B,transformMat2d:J,transformMat3:C,transformMat4:K},Symbol.toStringTag,{value:"Module"}));q.add=z;q.angle=I;q.ceil=k;q.copy=G;q.cross=w;q.dist=c;q.distance=c;q.div=x;q.divide=x;q.dot=A;q.equals=U;q.exactEquals=N;q.floor=g;q.inverse=u;q.len=p;q.length=p;q.lerp=m;q.max=a;q.min=b;q.mul=D;q.multiply=D;q.negate=l;q.normalize=r;q.projectAndScale=ba;q.random=t;q.rotate=E;q.round=h;q.scale=e;q.scaleAndAdd=f;q.set=F;q.sqrDist=d;q.sqrLen=v;q.squaredDistance=d;q.squaredLength=
v;q.str=H;q.sub=y;q.subtract=y;q.transformMat2=B;q.transformMat2d=J;q.transformMat3=C;q.transformMat4=K;q.vec2=la})},"esri/views/2d/tiling/TileQueue":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../support/QueueProcessor".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b){function a(d,p){d.length=0;p.forEach(v=>d.push(v));return d}const h=new Set,e=[],f=new Map,c=[0,0];G=function(d){function p(l){l=v.call(this,l);l._keyToItem=new Map;l.concurrency=6;l.strategy="scale-first";l.tileInfoView=null;return l}q._inherits(p,d);var v=q._createSuper(p);d=p.prototype;d.initialize=function(){const {concurrency:l,process:u,strategy:r}=this;this._queue=new b.QueueProcessor({concurrency:l,process:(A,w)=>{A=this._keyToItem.get(A);return u(A,{signal:w})},
peeker:"scale-first"===r?A=>this._peekByScaleFirst(A):A=>this._peekByCenterFirst(A)})};d.destroy=function(){this.clear();this._queue=F.destroyMaybe(this._queue)};d.abort=function(l){this._queue.abort("string"===typeof l?l:l.id)};d.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};d.has=function(l){return"string"===typeof l?this._keyToItem.has(l):this._keyToItem.has(l.id)};d.isOngoing=function(l){l="string"===typeof l?l:l.id;return this.has(l)&&this._queue.isOngoing(l)};
d.pause=function(){this._queue.pause()};d.push=function(l){const u=l.key.id;if(this._queue.has(u))return this._queue.get(u);const r=this._queue.push(u),A=()=>{this._keyToItem.delete(u);this.notifyChange("updating")};this._keyToItem.set(u,l);r.then(A,A);this.notifyChange("updating");return r};d.reset=function(){this._queue.reset()};d.resume=function(){this._queue.resume()};d._peekByScaleFirst=function(l){if(!this.state)return l.values().next().value;const u=this.tileInfoView;let r=Number.NEGATIVE_INFINITY,
A=Number.POSITIVE_INFINITY;l.forEach(J=>{J=this._keyToItem.get(J);const C=this.tileInfoView.getTileScale(J.key);f.has(C)||(f.set(C,[]),r=Math.max(C,r),A=Math.min(C,A));f.get(C).push(J.key);h.add(C)});let w=this.state.scale;f.has(w)||(a(e,h),e.sort((J,C)=>J-C),w=e.reduce((J,C)=>Math.abs(C-w)<Math.abs(J-w)?C:J,e[0]));w=Math.min(w,r);w=Math.max(w,A);l=f.get(w);const m=u.getClosestInfoForScale(w),t=m.getColumnForX(this.state.center[0]),B=m.getRowForY(this.state.center[1]);l.sort((J,C)=>{const K=m.denormalizeCol(J.col,
J.world),E=m.denormalizeCol(C.col,C.world);return Math.sqrt((t-K)*(t-K)+(B-J.row)*(B-J.row))-Math.sqrt((t-E)*(t-E)+(B-C.row)*(B-C.row))});h.clear();f.clear();return l[0].id};d._peekByCenterFirst=function(l){if(!this.state)return l.values().next().value;const u=this.tileInfoView,r=this.state.center;let A=Number.POSITIVE_INFINITY,w;l.forEach(m=>{m=this._keyToItem.get(m);u.getTileCoords(c,m.key);const t=g.distance(c,r);t<A&&(A=t,w=m.key)});return w.id};q._createClass(p,[{key:"length",get:function(){return this._queue?
this._queue.length:0}},{key:"onGoingCount",get:function(){return this._keyToItem.size}},{key:"updating",get:function(){return 0<this.length||0<this.onGoingCount}}]);return p}(G);n.__decorate([z.property({constructOnly:!0})],G.prototype,"concurrency",void 0);n.__decorate([z.property({constructOnly:!0})],G.prototype,"process",void 0);n.__decorate([z.property()],G.prototype,"state",void 0);n.__decorate([z.property({constructOnly:!0})],G.prototype,"strategy",void 0);n.__decorate([z.property({constructOnly:!0})],
G.prototype,"tileInfoView",void 0);n.__decorate([z.property({readOnly:!0})],G.prototype,"updating",null);return G=n.__decorate([k.subclass("esri.views.2d.tiling.TileQueue")],G)})},"esri/views/2d/tiling/TileStrategy":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../geometry/support/aaBoundingRect","./TileCache","./TileCoverage","./TileKey"],function(q,n,G,F,z){const y=new z(0,0,0,0),D=new Map,x=[],k=[];return function(){function g(a){this._previousScale=Number.POSITIVE_INFINITY;
this.cachePolicy="keep";this.coveragePolicy="closest";this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this.resampling=null==a.resampling||!!a.resampling;a.cachePolicy&&(this.cachePolicy=a.cachePolicy);a.coveragePolicy&&(this.coveragePolicy=a.coveragePolicy);null!=a.buffer&&(this.buffer=a.buffer);a.cacheSize&&(this._tileCache=new G(a.cacheSize,this.tileInfoView,h=>{this.releaseTile(h)}))}
var b=g.prototype;b.destroy=function(){this.tileIndex.clear()};b.update=function(a){const {resampling:h,tileIndex:e}=this,f=this.tileInfoView.getTileCoverage(a.state,this.buffer,this.coveragePolicy);k.length=0;x.length=0;D.clear();if(f){var {minScale:c,maxScale:d}=this.tileInfoView.tileInfo,{spans:p,lodInfo:v}=f,{level:l}=v,{scale:u,center:r,resolution:A}=a.state,w=!a.stationary&&u>this._previousScale;this._previousScale=u;this.tiles.length=0;if(!h&&(u>c||u<d))return this.tiles.length=0,D.clear(),
e.forEach(C=>{this.releaseTile(C)}),e.clear(),k.length=0,x.length=0,D.clear(),F.pool.release(f),!0;e.forEach(C=>C.visible=!0);var m=a=0;if(0<p.length)for(const {row:C,colFrom:K,colTo:E}of p)for(let I=K;I<=E;I++){a++;const H=y.set(l,C,v.normalizeCol(I),v.getWorldForColumn(I)).id;if(e.has(H)){var t=e.get(H);t.isReady?(D.set(H,t),m++):w||this._addParentTile(H,D)}else{if(this._tileCache&&this._tileCache.has(H)){if(t=this._tileCache.pop(H),this.tileIndex.set(H,t),t.isReady){D.set(H,t);m++;continue}}else t=
this.acquireTile(y),this.tileIndex.set(H,t);w||this._addParentTile(H,D)}}var B=m===a;e.forEach((C,K)=>{y.set(K);if(!D.has(K)){var E=this.tileInfoView.intersects(f,y),I="purge"===this.cachePolicy?y.level!==l:y.level>l;!E||!w&&B?!I&&E||x.push(K):C.isReady?I&&"purge"===this.cachePolicy&&this._hasReadyAncestor(y,l)?x.push(K):k.push(K):I&&x.push(K)}});for(var J of k)(a=e.get(J))&&a.isReady&&D.set(J,a);for(const C of x)J=e.get(C),this._tileCache?this._tileCache.add(J):this.releaseTile(J),e.delete(C);D.forEach(C=>
this.tiles.push(C));e.forEach(C=>{D.has(C.key.id)||(C.visible=!1)});this._tileCache&&this._tileCache.prune(l,r,A);F.pool.release(f);D.clear();return B}};b.clear=function(a=!0){const {tileIndex:h}=this;a&&h.forEach(e=>{this.releaseTile(e)});h.clear()};b.updateCacheSize=function(a){this._tileCache&&(this._tileCache.maxSize=a)};b._addParentTile=function(a,h){let e=null;for(;;){a=this.tileInfoView.getTileParentId(a);if(!a)break;if(this.tileIndex.has(a)){if((e=this.tileIndex.get(a))&&e.isReady){h.has(e.key.id)||
h.set(e.key.id,e);break}}else if(this._tileCache&&this._tileCache.has(a)&&(e=this._tileCache.pop(a),this.tileIndex.set(a,e),e&&e.isReady)){h.has(e.key.id)||h.set(e.key.id,e);break}}};b._hasReadyAncestor=function(a,h){const e=n.create();this.tileInfoView.getTileBounds(e,a,!0);for(const f of this.tileIndex.values())if(f.isReady&&f.key.level>=h&&f.key.level<a.level){const c=n.create();this.tileInfoView.getTileBounds(c,f.key,!0);if(n.contains(c,e))return!0}return!1};return q._createClass(g)}()})},"esri/views/2d/tiling/TileCache":function(){define(["../../../chunks/_rollupPluginBabelHelpers",
"../../../chunks/vec2"],function(q,n){return function(){function G(z,y,D){this.maxSize=z;this._tileInfoView=y;this._removedFunc=D;this._tilePerId=new Map;this._tileKeysPerLevel=[]}var F=G.prototype;F.has=function(z){return this._tilePerId.has(z)};F.get=function(z){return this._tilePerId.get(z)};F.pop=function(z){const y=this._tilePerId.get(z);if(y){var D=this._tileKeysPerLevel[y.key.level];this._tilePerId["delete"](z);for(let x=0;x<D.length;x++)if(D[x].id===z){D.splice(x,1);break}y.visible=!0;return y}};
F.add=function(z){z.visible=!1;const y=z.key,D=y.id;this._tilePerId.has(D)||(this._tilePerId.set(D,z),z=y.level,this._tileKeysPerLevel[z]||(this._tileKeysPerLevel[z]=[]),this._tileKeysPerLevel[z].push(y))};F.prune=function(z,y,D){let x=this._tilePerId.size;if(!(x<=this.maxSize)){for(var k=this._tileKeysPerLevel.length-1;x>this.maxSize&&0<=k;)k!==z&&(x=this._pruneAroundCenterTile(x,y,D,k)),k--;x>this.maxSize&&(x=this._pruneAroundCenterTile(x,y,D,z))}};F._pruneAroundCenterTile=function(z,y,D,x){x=this._tileKeysPerLevel[x];
if(!x||0===x.length)return z;const {size:k,origin:g}=this._tileInfoView.tileInfo,b=D*k[0],a=D*k[1],h=[0,0],e=[0,0];for(x.sort((f,c)=>{h[0]=g.x+b*(f.col+.5);h[1]=g.y-a*(f.row+.5);e[0]=g.x+b*(c.col+.5);e[1]=g.y-a*(c.row+.5);return n.squaredDistance(h,y)-n.squaredDistance(e,y)});0<x.length&&(D=x.pop(),this._removeTile(D.id),z--,z!==this.maxSize););return z};F._removeTile=function(z){const y=this._tilePerId.get(z);this._removedFunc&&y&&this._removedFunc(y);this._tilePerId["delete"](z)};return q._createClass(G)}()})},
"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(q,n,G,F,z){let y=function(){function D(k,g,b){this._start={index:0,vertex:0};b=F.getMeshSizeHint(k,g,b);g/=4;this.geometryType=k;this._records=new z(Int32Array,b.recordBytes);this._indices=new z(Uint32Array,b.indexBytes);this._vertices=new z(Uint32Array,b.vertexBytes);this._metrics=new z(Float32Array,0);this._strideInt=
g}var x=D.prototype;x.serialize=function(k){const g=this._records.buffer(),b=this._indices.buffer(),a=this._vertices.buffer(),h=this._metrics.length?this._metrics.buffer():null,e=4*this._strideInt;k.push(g,b,a);return{stride:e,records:g,indices:b,vertices:a,metrics:h}};x.vertexEnsureSize=function(k){this._vertices.ensureSize(k)};x.indexEnsureSize=function(k){this._indices.ensureSize(k)};x.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};x.recordEnd=
function(k,g,b,a,h,e,f,c){this._records.push(k);this._records.push(g??0);this._records.push(b);this._records.push(a);this._records.push(h);this._records.push(e);this._records.push(f);this._records.writeF32(c)};x.writeIndex=function(k){this._indices.push(k)};x.writeVertex=function(k){this._vertices.push(k)};x.writeVertexF32=function(k){this._vertices.writeF32(k)};x.copyLastFrom=function(k,g,b){var a=k._records.length-G.DISPLAY_RECORD_INT_PER_ELEMENT;const h=k._records.getValue(a),e=k._records.getValue(a+
1),f=k._records.getValue(a+2),c=k._records.getValue(a+4),d=k._records.getValue(a+6);a=k._records.getValue(a+7);const p=this._vertices.length;var v=(k._start.vertex-this._vertices.length)/this._strideInt;const l=this._indices.length,u=this.vertexCount;for(var r=k._start.index;r!==k._indices.length;r++){const A=k._indices.getValue(r);this._indices.push(A-v)}for(v=k._start.vertex;v!==k._vertices.length;v++)r=k._vertices.getValue(v),this._vertices.push(r);for(k=p;k<=this._vertices.length;k+=this._strideInt)this._vertices.i1616Add(k,
g,b);this._records.push(h);this._records.push(e);this._records.push(f);this._records.push(l);this._records.push(c);this._records.push(u);this._records.push(d);this._records.push(a)};n._createClass(D,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/G.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",
get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return D}();q.VertexDataWriter=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(q,n,G){const F=new Map;F.set(G.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});F.set(G.WGLGeometryType.LINE,
{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});F.set(G.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});F.set(G.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});F.set(G.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});q.getMeshSizeHint=function(z,y,D){const {indicesPerRecord:x,multiplier:k,verticesPerRecord:g}=F.get(z);return{recordBytes:D*n.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:k*
x*D*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:k*g*D*y}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function n(F,z){this._pos=0;z=z?this._roundToNearest(z,F.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(z);this._buffer=new F(this._array);this._ctor=F;this._i16View=new Int16Array(this._array)}var G=n.prototype;G._roundToNearest=function(F,
z){F=Math.round(F);return F+(z-F%z)};G._ensureSize=function(F){if(this._pos+F>=this._buffer.length){F=this._roundToNearest(1.25*(this._array.byteLength+F*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);F=new ArrayBuffer(F);const z=new this._ctor(F);z.set(this._buffer,0);this._array=F;this._buffer=z;this._i16View=new Int16Array(this._array)}};G.ensureSize=function(F){this._ensureSize(F)};G.writeF32=function(F){this._ensureSize(1);const z=this._pos;(new Float32Array(this._array,4*this._pos,
1))[0]=F;this._pos++;return z};G.push=function(F){this._ensureSize(1);const z=this._pos;this._buffer[this._pos++]=F;return z};G.writeFixed=function(F){this._buffer[this._pos++]=F};G.setValue=function(F,z){this._buffer[F]=z};G.i1616Add=function(F,z,y){this._i16View[2*F]+=z;this._i16View[2*F+1]+=y};G.getValue=function(F){return this._buffer[F]};G.incr=function(F){if(this._buffer.length<F)throw Error("Increment index overflows the target buffer");this._buffer[F]++};G.decr=function(F){this._buffer[F]--};
G.writeRegion=function(F){this._ensureSize(F.length);const z=this._pos;this._buffer.set(F,this._pos);this._pos+=F.length;return z};G.writeManyFrom=function(F,z,y){for(this._ensureSize(y-z);z!==y;z++)this.writeFixed(F._buffer[z])};G.buffer=function(){const F=this._array.slice(0,4*this._pos);this.destroy();return F};G.toArray=function(){const F=this._array,z=[];for(let y=0;y<F.byteLength/4;y++)z.push(F[y]);return z};G.seek=function(F){this._pos=F};G.destroy=function(){this._buffer=this._array=null};
q._createClass(n,[{key:"length",get:function(){return this._pos}}]);return n}()})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports"],function(q){q.getPow2NeighborKey=function(n,G,F,z){n=n.clone();const y=1<<n.level;G=n.col+G;F=n.row+F;z&&0>G?(n.col=G+y,--n.world):G>=y?(n.col=G-y,n.world+=1):n.col=G;n.row=F;return n};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(q,n,G,F,z,y,D,x,k,g){G=function(){function b(h,e,f){this._loadPromise=y.loadLibtess();this._geometryType=h;this._idField=e;this._templateStore=f}var a=b.prototype;a.update=function(h,e){F.isSome(h.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(h.mesh.labels,e));this._schema=h};a._createLabelTemplates=function(h,e){const f=new Map;if("simple"===h.type){for(var c of h.classes)h=x.fromLabelClass(c,e),f.set(c.index,h);return f}for(const d in h.classes){c=h.classes[d];for(const p of c)c=
x.fromLabelClass(p,e),f.set(p.index,c)}return f};a.analyze=async function(h,e,f,c,d,p,v){if(!z.isAborted(v)){var l;"dictionary"===f?.type&&(l=await f.analyze(this._idField,h.copy(),e,d,p,v));for(e=0;h.next();){var u=null;u=l?l[e++]:F.isSome(c)&&D.isAggregateId(h.getDisplayId())&&1!==h.readAttribute("cluster_count")?c.match(this._idField,h,this._geometryType,d,p):f.match(this._idField,h,this._geometryType,d,p);h.setGroupId(u);if(g.isDynamicId(u)){u=this._templateStore.getDynamicTemplateGroup(u).templates;
for(const r of u)r&&r.analyze&&r.analyze(this._templateStore,h,d,p)}}await this._loadPromise;return this._templateStore.finalize(v)}};a.analyzeGraphics=async function(h,e,f,c,d,p){if(!z.isAborted(p)){h=h.getCursor();for(f&&await f.analyze(this._idField,h.copy(),e,c,d,p);h.next();){e=h.getGroupId();if(null==e||-1===e)e=f?.match(this._idField,h,h.geometryType,c,d),h.setGroupId(e);if(g.isDynamicId(e)){const v=this._templateStore.getDynamicTemplateGroup(e).templates;for(const l of v)l&&l.analyze&&l.analyze(this._templateStore,
h,c,d)}h.setGroupId(e)}await this._loadPromise;return this._templateStore.finalize(p)}};a.writeGraphic=function(h,e,f,c){const d=e.getGroupId(),p=e.getDisplayId(),v=this._templateStore.getTemplateGroup(d);h.featureStart(e.insertAfter,0);if(null!=p){if(g.isDynamicId(d))for(const l of v.templates)l&&l.bindFeature(e,null,null);if(v){for(const l of v.templates)l&&l.write(h,e,f,c);h.featureEnd()}}};a.writeCursor=function(h,e,f,c,d,p,v){const l=e.getGroupId(),u=e.getDisplayId();var r=this._templateStore.getTemplateGroup(l);
const A=r.templates;r=this._getSortKeyValue(e,r);h.featureStart(0,r);if(null!=u&&A){if(g.isDynamicId(l))for(const w of A)w.bindFeature(e,f,c);for(const w of A)w.write(h,e,d,v);F.isSome(p)&&h.hasRecords&&(f=p&&this._findLabelRef(A),this._writeLabels(h,e,p,f,d,v));h.featureEnd()}};a._getSortKeyValue=function(h,e){const f=this._schema.mesh.sortKey;if(F.isNone(f))return 0;let c=0;c=!0===f.byRenderer&&null!=e.sortKey?e.sortKey:null!=f.fieldIndex?h.getComputedNumericAtIndex(f.fieldIndex):null!=f.field?
h.readAttribute(f.field):h.readAttribute(this._idField);c*="asc"===f.order?1:-1;return null==c||isNaN(c)?0:c};a._findLabelRef=function(h){for(const e of h)if(e instanceof k)return e;return null};a._writeLabels=function(h,e,f,c,d,p){for(const v of f)if(F.isSome(v)&&v){const {glyphs:l,rtl:u,index:r}=v;if(f=this._labelTemplates.get(r))f.setZoomLevel(d),f.bindReferenceTemplate(c),f.bindTextInfo(l,u),f.write(h,e,null,p)}};n._createClass(b,[{key:"templates",get:function(){return this._templateStore}}]);
return b}();q.WGLMeshFactory=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d){const p=G.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),v=(u,r="mapview-labeling")=>p.error(new n(r,u)),l=function(u){const r=new Map;return A=>{r.has(A)||r.set(A,u(A));return r.get(A)}}(u=>{let r=0;if(0===u)return Infinity;for(;!(u%2);)r++,u/=2;return r});return function(u){function r(w,m,t,B){var J=A.call(this,w,t.font?.size,t.haloSize||0,t.font?.size,t.color&&b.premultiplyAlphaRGBAArray(t.color)||0,t.haloColor&&b.premultiplyAlphaRGBAArray(t.haloColor)||
0,t.horizontalAlignment,t.verticalAlignment,g.isMapAligned(m.labelPlacement)?k.Alignment.MAP:k.Alignment.SCREEN,t.font?.decoration,!1,t.angle||0,t.xoffset,t.yoffset,t.lineWidth,t.lineHeight,null,null,!1,null,null,t.backgroundColor&&b.premultiplyAlphaRGBAArray(t.backgroundColor),t.borderLineColor&&b.premultiplyAlphaRGBAArray(t.borderLineColor),t.borderLineSize);J._outLineLabelAngle=0;J._refPlacementPadding=0;J._refPlacementDirX=0;J._refPlacementDirY=0;J._refOffsetX=0;J._refOffsetY=0;J._zoomLevel=0;
J.geometryType=h.WGLGeometryType.LABEL;J._allowOverrun=m.allowOverrun??!1;J._repeatLabel=m.repeatLabel??!0;J._labelPosition=m.labelPosition??"curved";var C=!!m.minScale&&B.scaleToZoom(m.minScale)||0;C=F.clamp(C,0,25.5);B=!!m.maxScale&&B.scaleToZoom(m.maxScale)||255;B=F.clamp(B,0,25.5);const [K,E]=g.getAlignmentFromPlacement(m.labelPlacement);J._xAlignD=K;J._yAlignD=E;J._minZoom=C;J._maxZoom=B;J._minBackgroundZoom=C;J._maxBackgroundZoom=B;J._refPlacementPadding=y.pt2px(t.haloSize)+a.TEXT_PLACEMENT_PADDING;
J._repeatLabelDistance=m.repeatLabelDistance?y.pt2px(m.repeatLabelDistance):128;w=f.LabelMaterialKey.load(w);w.sdf=!0;J._materialKey=w.data;return J}q._inherits(r,u);var A=q._createSuper(r);r.fromLabelClass=function(w,m){if("esriServerLinePlacementCenterAlong"===w.labelPlacement){const t=w.symbol;t.xoffset=0;t.yoffset=0;t.angle=0;t.font.decoration="none"}return new r(w.materialKey,w,w.symbol,m)};u=r.prototype;u.setZoomLevel=function(w){this._zoomLevel=w};u.bindReferenceTemplate=function(w){let m=
g.getXDirection(this._xAlignD),t=g.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(z.isNone(w))this._refSymbolAndPlacementOffset=e.i8888to32(0,0,Math.floor(127*m+127),Math.floor(127*t+127));else{if("circle"===w.boundsType&&(m||t)){var B=Math.sqrt(m*m+t*t);m/=B;t/=B}B=Math.max(w.height,w.width);this._refSymbolAndPlacementOffset=e.i8888to32(4*this._refPlacementPadding,B,Math.floor(127*m+127),Math.floor(127*t+127));this._referenceSize=B;this._refPlacementDirX=m;this._refPlacementDirY=
t;this._refOffsetX=w.xOffset;this._refOffsetY=w.yOffset}};u._write=function(w,m){if(!z.isNone(this._shapingInfo)){var t=this._shapingInfo,B=m.getDisplayId(),J="esriGeometryPolygon"===m.geometryType?m.readLegacyCentroid():m.readLegacyGeometry();if(J)switch(this._current={out:w,inId:B,inShaping:t,zoomLevel:this._zoomLevel},"esriGeometryPolyline"===m.geometryType&&"curved"===this._labelPosition&&(this._borderLineColor||this._backgroundColor)&&p.warnOnce("TextSymbol properties 'borderLineColor', 'borderLineSize', and 'backgroundColor' are not supported in curved labels"),
m.geometryType){case "esriGeometryPolyline":this._placeLineLabels(J);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(J);break;default:v(`Geometry of type ${m.geometryType} is not supported`)}}};u._isVisible=function(w,m){const t=Math.floor(10*this._current.zoomLevel);return Math.floor(10*w)<=t&&t<=Math.floor(10*m)};u._placePointLabels=function(w){const {out:m,inId:t,inShaping:B}=this._current;this._writeGlyphs(m,t,w,B)};u._placeLineLabels=function(w){w=c.smoothPaths(w.paths,
this._current.inShaping.bounds.width);const m=this._placeSubdivGlyphs.bind(this),t=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const B of w)c.pathDivide(B,t,m,this._repeatLabel)};u._placeSubdivGlyphs=function(w,m,t,B){var J=l(m),C=this._shapedBox.width/2,K=Math.sqrt(this._repeatLabelDistance)/2;t=Math.min(t,B-t);C=this._current.inShaping.isMultiline?25:Math.log2(t/(K+C/2));J=Math.max(this._minZoom,this._current.zoomLevel+1-(0===m?C:Math.min(J,C)));C=this._current.zoomLevel-J;K=this._shapedBox.width/
2*2**C;this._current.inShaping.isMultiline?0===m&&this._placeStraight(w,J):this._allowOverrun&&0>C?this._placeStraightAlong(w,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(w,J):"curved"===this._labelPosition&&this._placeCurved(w,J,K)};u._placeStraight=function(w,m){const {out:t,inId:B,inShaping:J}=this._current,C=Math.ceil((180/Math.PI*w.angle+180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*w.angle%360));this._writeGlyphs(t,B,w,J,m);this._outLineLabelAngle=
Math.round(254/360*C);this._writeGlyphs(t,B,w,J,m)};u._placeCurved=function(w,m,t){const {out:B,inId:J}=this._current;B.metricStart(J,m,w.x,w.y,0,0,0,0);const C=w.clone(),K=(180/Math.PI*w.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*w.angle%360*(254/360));this._placeFirst(C,m,1);this._placeBack(w,C,m,t,1);this._placeForward(w,C,m,t,1);this._outLineLabelAngle=Math.round(254/360*K);this._placeFirst(C,m,0);this._placeBack(w,C,m,t,0);this._placeForward(w,C,m,t,0);B.metricEnd()};u._placeStraightAlong=
function(w,m){const {out:t,inId:B,inShaping:J}=this._current;t.metricStart(B,m,w.x,w.y,0,0,0,0);const C=w.clone(),K=180/Math.PI*w.angle%360,E=(180/Math.PI*w.angle+180)%360;var I=0<J.glyphs.length&&(this._borderLineColor||this._backgroundColor);this._maxBackgroundZoom=25;this._minBackgroundZoom=Math.max(m,0);if(I){I=f.LabelMaterialKey.load(this._materialKey);I.textureBinding=J.glyphs[0].textureBinding;const H=D.fromRotation(x.create(),-w.angle),[N,U]=J.shapeBackground(H);this._outLineLabelAngle=Math.round(254/
360*K);t.recordStart(B,I.data,this.geometryType,!0);this._writeBackgroundGeometry(t,B,w,N,U);t.recordEnd();this._outLineLabelAngle=Math.round(254/360*E);t.recordStart(B,I.data,this.geometryType,!0);this._writeBackgroundGeometry(t,B,w,N,U);t.recordEnd()}this._outLineLabelAngle=Math.round(254/360*K);this._placeFirst(C,m,1,!0);this._outLineLabelAngle=Math.round(254/360*E);this._placeFirst(C,m,0,!0);t.metricEnd()};u._placeBack=function(w,m,t,B,J){const C=w.clone();for(w=w.backwardLength+0;C.prev()&&!(w>=
B);)this._placeOnSegment(C,m,w,t,-1,J),w+=C.length+0};u._placeForward=function(w,m,t,B,J){const C=w.clone();for(w=w.remainingLength+0;C.next()&&!(w>=B);)this._placeOnSegment(C,m,w,t,1,J),w+=C.length+0};u._placeFirst=function(w,m,t,B=!1){const J=this._current.inShaping;var C=J.glyphs;const K=this._current.zoomLevel,{out:E,inId:I}=this._current;for(const H of C)C=H.x>J.bounds.x?t:1-t,C=Math.max(0,K+Math.log2(Math.abs(H.x+H.width/2-J.bounds.x)/(C*w.remainingLength+(1-C)*w.backwardLength))),C=Math.max(m,
B?0:C),H.maxZoom=25,H.angle=w.angle+(1-t)*Math.PI,H.minZoom=C,this._writeGlyph(E,I,w.x,w.y,H),t&&this._isVisible(H.minZoom,H.maxZoom)&&(C=H.bounds,E.metricBoxWrite(C.center[0],C.center[1],C.width,C.height))};u._placeOnSegment=function(w,m,t,B,J,C){var K=this._current.inShaping.glyphs;const {out:E,inId:I}=this._current,H=this._current.inShaping,N=this._current.zoomLevel;var U=w.x+w.dx/w.length*-J*t,ba=w.y+w.dy/w.length*-J*t;for(const aa of K)if((K=aa.x>H.bounds.x?C:1-C)&&1===J||!K&&-1===J){var la=
Math.abs(aa.x+aa.width/2-H.bounds.x);K=Math.max(0,N+Math.log2(la/t)-.1);la=Math.max(B,N+Math.log2(la/(t+w.length+0)));0!==K&&(aa.angle=w.angle+(1-C)*Math.PI,aa.minZoom=la,aa.maxZoom=K,this._writeGlyph(E,I,U,ba,aa),C&&this._isVisible(aa.minZoom,aa.maxZoom)&&(K=aa.bounds,E.metricBoxWrite(K.center[0]+(w.x-m.x),K.center[1]+(w.y-m.y),K.width,K.height)))}};u._writeGlyphs=function(w,m,t,B,J=this._minZoom){if(!(0>t.x||512<=t.x||0>t.y||512<=t.y)){if(0<B.glyphs.length&&(this._borderLineColor||this._backgroundColor)){var C=
f.LabelMaterialKey.load(this._materialKey);C.textureBinding=B.glyphs[0].textureBinding;w.recordStart(m,C.data,this.geometryType,!0);this._writeBackgroundGeometry(w,m,t,B.bounds,B.background);w.recordEnd()}C=t.x+this._refOffsetX;t=t.y-this._refOffsetY;for(const K of B.glyphs)K.minZoom=J,K.maxZoom=this._maxZoom,this._writeGlyph(w,m,C,t,K);B=B.boundsT;w.metricStart(m,J,C,t,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);w.metricBoxWrite(B.center[0],B.center[1],B.width,
B.height);w.metricEnd()}};u._writeVertexCommon=function(w,m,t,B){const J=this._color,C=this._haloColor,K=e.i8888to32(0,0,this._size,this._haloSize);B=e.i8888to32(Math.floor(10*Math.max(B.minZoom,this._minZoom)),Math.floor(10*Math.min(B.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);w.vertexWrite(t);w.vertexWrite(m);w.vertexWrite(J);w.vertexWrite(C);w.vertexWrite(K);w.vertexWrite(this._refSymbolAndPlacementOffset);w.vertexWrite(B)};u._writeBackgroundVertex=function(w,m,t,B,J,C){const K=e.i8888to32(0,
0,this._size,this._haloSize),E=e.i8888to32(0,0,0,0),I=e.i8888to32(Math.floor(10*this._minBackgroundZoom),Math.floor(10*this._maxBackgroundZoom),this._outLineLabelAngle,1);w.vertexWrite(t);w.vertexWrite(m);w.vertexWrite(B);w.vertexWrite(E);w.vertexWrite(K);w.vertexWrite(this._refSymbolAndPlacementOffset);w.vertexWrite(I);w.vertexWrite(J);w.vertexWrite(C);w.vertexEnd()};q._createClass(r,[{key:"_shapedBox",get:function(){return z.unwrap(this._shapingInfo).bounds}}]);return r}(d)})},"esri/chunks/mat2d":function(){define(["exports",
"./common"],function(q,n){function G(w,m){w[0]=m[0];w[1]=m[1];w[2]=m[2];w[3]=m[3];w[4]=m[4];w[5]=m[5];return w}function F(w){w[0]=1;w[1]=0;w[2]=0;w[3]=1;w[4]=0;w[5]=0;return w}function z(w,m,t,B,J,C,K){w[0]=m;w[1]=t;w[2]=B;w[3]=J;w[4]=C;w[5]=K;return w}function y(w,m){const t=m[0],B=m[1],J=m[2],C=m[3],K=m[4];m=m[5];let E=t*C-B*J;if(!E)return null;E=1/E;w[0]=C*E;w[1]=-B*E;w[2]=-J*E;w[3]=t*E;w[4]=(J*m-C*K)*E;w[5]=(B*K-t*m)*E;return w}function D(w){return w[0]*w[3]-w[1]*w[2]}function x(w,m,t){const B=
m[0],J=m[1],C=m[2],K=m[3],E=m[4];m=m[5];const I=t[0],H=t[1],N=t[2],U=t[3],ba=t[4];t=t[5];w[0]=B*I+C*H;w[1]=J*I+K*H;w[2]=B*N+C*U;w[3]=J*N+K*U;w[4]=B*ba+C*t+E;w[5]=J*ba+K*t+m;return w}function k(w,m,t){const B=m[0],J=m[1],C=m[2],K=m[3],E=m[4];m=m[5];const I=Math.sin(t);t=Math.cos(t);w[0]=B*t+C*I;w[1]=J*t+K*I;w[2]=B*-I+C*t;w[3]=J*-I+K*t;w[4]=E;w[5]=m;return w}function g(w,m,t){const B=m[1],J=m[2],C=m[3],K=m[4],E=m[5],I=t[0];t=t[1];w[0]=m[0]*I;w[1]=B*I;w[2]=J*t;w[3]=C*t;w[4]=K;w[5]=E;return w}function b(w,
m,t){const B=m[0],J=m[1],C=m[2],K=m[3],E=m[4];m=m[5];const I=t[0];t=t[1];w[0]=B;w[1]=J;w[2]=C;w[3]=K;w[4]=B*I+C*t+E;w[5]=J*I+K*t+m;return w}function a(w,m){const t=Math.sin(m);m=Math.cos(m);w[0]=m;w[1]=t;w[2]=-t;w[3]=m;w[4]=0;w[5]=0;return w}function h(w,m){w[0]=m[0];w[1]=0;w[2]=0;w[3]=m[1];w[4]=0;w[5]=0;return w}function e(w,m){w[0]=1;w[1]=0;w[2]=0;w[3]=1;w[4]=m[0];w[5]=m[1];return w}function f(w){return"mat2d("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+")"}function c(w){return Math.sqrt(w[0]**
2+w[1]**2+w[2]**2+w[3]**2+w[4]**2+w[5]**2+1)}function d(w,m,t){w[0]=m[0]+t[0];w[1]=m[1]+t[1];w[2]=m[2]+t[2];w[3]=m[3]+t[3];w[4]=m[4]+t[4];w[5]=m[5]+t[5];return w}function p(w,m,t){w[0]=m[0]-t[0];w[1]=m[1]-t[1];w[2]=m[2]-t[2];w[3]=m[3]-t[3];w[4]=m[4]-t[4];w[5]=m[5]-t[5];return w}function v(w,m,t){w[0]=m[0]*t;w[1]=m[1]*t;w[2]=m[2]*t;w[3]=m[3]*t;w[4]=m[4]*t;w[5]=m[5]*t;return w}function l(w,m,t,B){w[0]=m[0]+t[0]*B;w[1]=m[1]+t[1]*B;w[2]=m[2]+t[2]*B;w[3]=m[3]+t[3]*B;w[4]=m[4]+t[4]*B;w[5]=m[5]+t[5]*B;return w}
function u(w,m){return w[0]===m[0]&&w[1]===m[1]&&w[2]===m[2]&&w[3]===m[3]&&w[4]===m[4]&&w[5]===m[5]}function r(w,m){const t=w[0],B=w[1],J=w[2],C=w[3],K=w[4];w=w[5];const E=m[0],I=m[1],H=m[2],N=m[3],U=m[4];m=m[5];const ba=n.getEpsilon();return Math.abs(t-E)<=ba*Math.max(1,Math.abs(t),Math.abs(E))&&Math.abs(B-I)<=ba*Math.max(1,Math.abs(B),Math.abs(I))&&Math.abs(J-H)<=ba*Math.max(1,Math.abs(J),Math.abs(H))&&Math.abs(C-N)<=ba*Math.max(1,Math.abs(C),Math.abs(N))&&Math.abs(K-U)<=ba*Math.max(1,Math.abs(K),
Math.abs(U))&&Math.abs(w-m)<=ba*Math.max(1,Math.abs(w),Math.abs(m))}const A=Object.freeze(Object.defineProperty({__proto__:null,add:d,copy:G,determinant:D,equals:r,exactEquals:u,frob:c,fromRotation:a,fromScaling:h,fromTranslation:e,identity:F,invert:y,mul:x,multiply:x,multiplyScalar:v,multiplyScalarAndAdd:l,rotate:k,scale:g,set:z,str:f,sub:p,subtract:p,translate:b},Symbol.toStringTag,{value:"Module"}));q.add=d;q.copy=G;q.determinant=D;q.equals=r;q.exactEquals=u;q.frob=c;q.fromRotation=a;q.fromScaling=
h;q.fromTranslation=e;q.identity=F;q.invert=y;q.mat2d=A;q.mul=x;q.multiply=x;q.multiplyScalar=v;q.multiplyScalarAndAdd=l;q.rotate=k;q.scale=g;q.set=z;q.str=f;q.sub=p;q.subtract=p;q.translate=b})},"esri/chunks/mat2df32":function(){define(["exports"],function(q){function n(){const k=new Float32Array(6);k[0]=1;k[3]=1;return k}function G(k){const g=new Float32Array(6);g[0]=k[0];g[1]=k[1];g[2]=k[2];g[3]=k[3];g[4]=k[4];g[5]=k[5];return g}function F(k,g,b,a,h,e){const f=new Float32Array(6);f[0]=k;f[1]=g;
f[2]=b;f[3]=a;f[4]=h;f[5]=e;return f}function z(k,g){return new Float32Array(k,g,6)}function y(k,g,b,a){const h=g[a];g=g[a+1];k[a]=b[0]*h+b[2]*g+b[4];k[a+1]=b[1]*h+b[3]*g+b[5]}function D(k,g,b,a=0,h=0,e=2){for(h=h||g.length/e;a<h;a++)y(k,g,b,a*e)}const x=Object.freeze(Object.defineProperty({__proto__:null,clone:G,create:n,createView:z,fromValues:F,transform:y,transformMany:D},Symbol.toStringTag,{value:"Module"}));q.clone=G;q.create=n;q.createView=z;q.fromValues=F;q.mat2df32=x;q.transform=y;q.transformMany=
D})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(q){q.HAlign=void 0;(function(n){n[n.Left=-1]="Left";n[n.Center=0]="Center";n[n.Right=1]="Right"})(q.HAlign||(q.HAlign={}));q.VAlign=void 0;(function(n){n[n.Top=1]="Top";n[n.Center=0]="Center";n[n.Bottom=-1]="Bottom";n[n.Baseline=2]="Baseline"})(q.VAlign||(q.VAlign={}));q.getAlignmentFromPlacement=function(n){switch(n){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[q.HAlign.Right,q.VAlign.Bottom];
case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[q.HAlign.Center,q.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[q.HAlign.Left,q.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[q.HAlign.Right,q.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[q.HAlign.Center,
q.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[q.HAlign.Left,q.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[q.HAlign.Right,q.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[q.HAlign.Center,q.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[q.HAlign.Left,q.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[q.HAlign.Center,
q.VAlign.Center];default:return console.debug(`Found invalid placement type ${n}`),[q.HAlign.Center,q.VAlign.Center]}};q.getJustification=function(n){switch(n){case "left":return q.HAlign.Left;case "right":return q.HAlign.Right;case "center":return q.HAlign.Center}};q.getXAnchorDirection=function(n){switch(n){case "left":return q.HAlign.Left;case "right":return q.HAlign.Right;case "center":return q.HAlign.Center}};q.getXDirection=function(n){switch(n){case q.HAlign.Right:return-1;case q.HAlign.Center:return 0;
case q.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${n}`),0}};q.getYAnchorDirection=function(n){switch(n){case "top":return q.VAlign.Top;case "middle":return q.VAlign.Center;case "baseline":return q.VAlign.Baseline;case "bottom":return q.VAlign.Bottom}};q.getYDirection=function(n){switch(n){case q.VAlign.Top:return 1;case q.VAlign.Center:return 0;case q.VAlign.Bottom:case q.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${n}`),
0}};q.isMapAligned=function(n){switch(n){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],
function(q,n,G,F,z){function y(v){return v===z.WGLSymbologyType.SIMPLE||v===z.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function D(v){return v===z.WGLSymbologyType.OUTLINE_FILL||v===z.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const x=Object.keys(z.WGLSymbologyType).filter(v=>"number"===typeof z.WGLSymbologyType[v]).reduce((v,l)=>({...v,[l]:z.WGLSymbologyType[l]}),{});let k=function(){function v(u){this._data=0;this._data=u}v.load=function(u){const r=this.shared;r.data=u;return r};var l=v.prototype;l.setBit=
function(u,r){u=1<<u;this._data=r?this._data|u:this._data&~u};l.bit=function(u){return(this._data&1<<u)>>u};l.setBits=function(u,r,A){for(let w=r,m=0;w<A;w++,m++)this.setBit(w,0!==(u&1<<m))};l.bits=function(u,r){let A=0;for(let w=u,m=0;w<r;w++,m++)A|=this.bit(w)<<m;return A};l.hasVV=function(){return!1};l.setVV=function(u,r){};l.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:z.WGLSymbologyType[this.symbologyType],options:x,namespace:"SYMBOLOGY_TYPE"}}};
l.getVariationHash=function(){return this._data&~(7&this.textureBinding)};n._createClass(v,[{key:"data",get:function(){return this._data},set:function(u){this._data=u??0}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(u){this.setBits(u,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(u){this.setBit(20,u)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(u){this.setBit(11,u??!1)}},{key:"pattern",get:function(){return!!this.bit(12)},
set:function(u){this.setBit(12,u)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(u){this.setBits(u,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(u){this.setBits(u,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case z.WGLGeometryType.FILL:return"fill";case z.WGLGeometryType.MARKER:return"marker";case z.WGLGeometryType.LINE:return"line";case z.WGLGeometryType.TEXT:return"text";case z.WGLGeometryType.LABEL:return"label";
default:throw new G(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return v}();k.shared=new k(0);const g=v=>function(l){function u(){return r.apply(this,arguments)}n._inherits(u,l);var r=n._createSuper(u);l=u.prototype;l.hasSizeVV=function(){return this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};l.hasVV=function(){return n._get(n._getPrototypeOf(u.prototype),"hasVV",this).call(this)||this.hasSizeVV()};l.setVV=function(A,w){n._get(n._getPrototypeOf(u.prototype),
"setVV",this).call(this,A,w);{var m=this.geometryType;const t=z.WGLVVFlag.SIZE_FIELD_STOPS|z.WGLVVFlag.SIZE_MINMAX_VALUE|z.WGLVVFlag.SIZE_SCALE_STOPS|z.WGLVVFlag.SIZE_UNIT_VALUE,B=(A&(z.WGLVVTarget.FIELD_TARGETS_OUTLINE|z.WGLVVTarget.MINMAX_TARGETS_OUTLINE|z.WGLVVTarget.SCALE_TARGETS_OUTLINE|z.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;w=m===z.WGLGeometryType.LINE&&w.isOutline||m===z.WGLGeometryType.FILL&&D(w.symbologyType)?t&B:t&~B}A&=w;this.vvSizeMinMaxValue=!!(A&z.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=
!!(A&z.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(A&z.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(A&z.WGLVVFlag.SIZE_SCALE_STOPS)};n._createClass(u,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(A){this.setBit(16,A)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(A){this.setBit(17,A)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(A){this.setBit(18,A)}},{key:"vvSizeUnitValue",get:function(){return 0!==
this.bit(19)},set:function(A){this.setBit(19,A)}}]);return u}(v),b=v=>function(l){function u(){return r.apply(this,arguments)}n._inherits(u,l);var r=n._createSuper(u);l=u.prototype;l.hasVV=function(){return n._get(n._getPrototypeOf(u.prototype),"hasVV",this).call(this)||this.vvRotation};l.setVV=function(A,w){n._get(n._getPrototypeOf(u.prototype),"setVV",this).call(this,A,w);this.vvRotation=!w.isOutline&&!!(A&z.WGLVVFlag.ROTATION)};n._createClass(u,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},
set:function(A){this.setBit(15,A)}}]);return u}(v),a=v=>function(l){function u(){return r.apply(this,arguments)}n._inherits(u,l);var r=n._createSuper(u);l=u.prototype;l.hasVV=function(){return n._get(n._getPrototypeOf(u.prototype),"hasVV",this).call(this)||this.vvColor};l.setVV=function(A,w){n._get(n._getPrototypeOf(u.prototype),"setVV",this).call(this,A,w);this.vvColor=!w.isOutline&&!!(A&z.WGLVVFlag.COLOR)};n._createClass(u,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(A){this.setBit(13,
A)}}]);return u}(v),h=v=>function(l){function u(){return r.apply(this,arguments)}n._inherits(u,l);var r=n._createSuper(u);l=u.prototype;l.hasVV=function(){return n._get(n._getPrototypeOf(u.prototype),"hasVV",this).call(this)||this.vvOpacity};l.setVV=function(A,w){n._get(n._getPrototypeOf(u.prototype),"setVV",this).call(this,A,w);this.vvOpacity=!w.isOutline&&!!(A&z.WGLVVFlag.OPACITY)};n._createClass(u,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(A){this.setBit(14,A)}}]);return u}(v);
let e=function(v){function l(){return u.apply(this,arguments)}n._inherits(l,v);var u=n._createSuper(l);l.load=function(r){const A=this.shared;A.data=r;return A};l.from=function(r){const {symbologyType:A,vvFlags:w}=r,m=this.load(0);m.geometryType=z.WGLGeometryType.FILL;m.symbologyType=A;A!==z.WGLSymbologyType.DOT_DENSITY&&m.setVV(w,r);return m.data};l.prototype.getVariation=function(){return{...n._get(n._getPrototypeOf(l.prototype),"getVariation",this).call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,
vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return n._createClass(l)}(a(h(g(k))));e.shared=new e(0);let f=function(v){function l(){return u.apply(this,arguments)}n._inherits(l,v);var u=n._createSuper(l);l.load=function(r){const A=this.shared;A.data=r;return A};l.from=function(r){const {symbologyType:A,vvFlags:w}=r,m=this.load(0);m.geometryType=z.WGLGeometryType.MARKER;m.symbologyType=
A;A!==z.WGLSymbologyType.HEATMAP&&m.setVV(w,r);return m.data};l.prototype.getVariation=function(){return{...n._get(n._getPrototypeOf(l.prototype),"getVariation",this).call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return n._createClass(l)}(a(h(b(g(k)))));f.shared=new f(0);let c=function(v){function l(){return u.apply(this,
arguments)}n._inherits(l,v);var u=n._createSuper(l);l.load=function(r){const A=this.shared;A.data=r;return A};l.from=function(r){const A=this.load(0);A.geometryType=z.WGLGeometryType.LINE;A.symbologyType=r.symbologyType;A.setVV(r.vvFlags,r);return A.data};l.prototype.getVariation=function(){return{...n._get(n._getPrototypeOf(l.prototype),"getVariation",this).call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,
vvSizeUnitValue:this.vvSizeUnitValue}};return n._createClass(l)}(a(h(g(k))));c.shared=new c(0);let d=function(v){function l(){return u.apply(this,arguments)}n._inherits(l,v);var u=n._createSuper(l);l.load=function(r){const A=this.shared;A.data=r;return A};l.from=function(r){const A=this.load(0);A.geometryType=z.WGLGeometryType.TEXT;A.symbologyType=r.symbologyType;A.setVV(r.vvFlags,r);return A.data};l.prototype.getVariation=function(){return{...n._get(n._getPrototypeOf(l.prototype),"getVariation",
this).call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return n._createClass(l)}(a(h(b(g(k)))));d.shared=new d(0);let p=function(v){function l(){return u.apply(this,arguments)}n._inherits(l,v);var u=n._createSuper(l);l.load=function(r){const A=this.shared;A.data=r;return A};l.from=function(r){const A=this.load(0);
A.geometryType=z.WGLGeometryType.LABEL;A.symbologyType=r.symbologyType;A.setVV(r.vvFlags,r);A.mapAligned=F.isMapAligned(r.placement);return A.data};l.prototype.getVariation=function(){return{...n._get(n._getPrototypeOf(l.prototype),"getVariation",this).call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return n._createClass(l)}(g(k));p.shared=new p(0);q.FillMaterialKey=e;q.LabelMaterialKey=
p;q.LineMaterialKey=c;q.MarkerMaterialKey=f;q.MaterialKeyBase=k;q.TextMaterialKey=d;q.createMaterialKey=function(v,l){switch(v){case z.WGLGeometryType.FILL:return e.from(l);case z.WGLGeometryType.LINE:return c.from(l);case z.WGLGeometryType.MARKER:return f.from(l);case z.WGLGeometryType.TEXT:return d.from(l);case z.WGLGeometryType.LABEL:return p.from(l);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${v}`);}};q.hasOutlineFillSymbology=function(v){return D(v.symbologyType)};
q.hasSimpleSymbology=function(v){return y(v.symbologyType)};q.hydrateMaterialKey=function(v){switch(k.load(v).geometryType){case z.WGLGeometryType.MARKER:return new f(v);case z.WGLGeometryType.FILL:return new e(v);case z.WGLGeometryType.LINE:return new c(v);case z.WGLGeometryType.TEXT:return new d(v);case z.WGLGeometryType.LABEL:return new p(v)}};q.isOutlineFillSymbology=D;q.isSimpleSymbology=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports",
"../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(q,n,G,F){function z(g){return g.length-1}function y(g){let b=0;for(let a=0;a<z(g);a++)b+=D(g,a);return b}function D(g,b,a=1){const [h,e]=g[b+1];return Math.sqrt(h*h+e*e)*a}function x(g,b,a,h,e){if(!(a<b)){var f=h.clone().seek(a/2);G.isNone(f)||(g(f.clone(),a,e),a=(a-b)/2,f=G.unwrap(f.seek(b/2)),x(g,b,a,h,e+1),x(g,b,a,f,e+1))}}let k=function(){function g(a,h,e,f,c){this._segments=a;this._index=h;
this._distance=e;this._xStart=f;this._yStart=c;this._done=!1}g.create=function(a){return new g(a,0,0,a[0][0],a[0][1])};var b=g.prototype;b.clone=function(){return new g(this._segments,this._index,this._distance,this.xStart,this.yStart)};b.equals=function(a){return this._index===a._index||a._index===this._index-1&&(0===this._distance||1===a._distance)||a._index===this._index+1&&(1===this._distance||0===a._distance)};b.leq=function(a){return this._index<a._index||this._index===a._index&&this._distance<=
a._distance};b.geq=function(a){return this._index>a._index||this._index===a._index&&this._distance>=a._distance};b.hasPrev=function(){return 0<=this._index-1};b.hasNext=function(){return this._index+1<z(this._segments)};b.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};b.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};
b._seekBackwards=function(a,h){var e=this.backwardLength;if(a<=e)return this._distance=(e-a)/this.length,this;for(e=this.backwardLength;this.prev();){if(e+this.length>a)return this._seekBackwards(a-e);e+=this.length}this._distance=0;return h?this:null};b.seek=function(a,h=!1){if(0>a)return this._seekBackwards(Math.abs(a),h);if(a<=this.remainingLength)return this._distance=(this.backwardLength+a)/this.length,this;let e=this.remainingLength;for(;this.next();){if(e+this.length>a)return this.seek(a-e,
h);e+=this.length}this._distance=1;return h?this:null};n._createClass(g,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const a=this.dy;let h=Math.acos((0*a+-1*-this.dx)/(1*this.length));0<a&&(h=2*Math.PI-h);return h}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},
{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:a,dy:h}=this;return Math.sqrt(a*a+h*h)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",
get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return g}();q.SegmentCursor=k;q.pathDivide=function(g,b,a,h=!0){const e=y(g);g=k.create(g);const f=e/2;if(h){h=Math.floor(Math.max((e-b)/2,0)/b);g.seek(f-h*b);for(let c=-h;c<=h;c++)512>g.x&&0<=g.x&&512>g.y&&0<=g.y&&a(g.clone(),c,f+c*b,e),g.seek(b)}else g.seek(f),a(g.clone(),0,f+0*b,e)};q.pathLength=y;q.pathSubdivide=function(g,b,a){x(a,b,y(g),k.create(g),
0)};q.segmentAt=function(g,b){return g[b+1]};q.segmentCount=z;q.segmentLength=D;q.smoothPaths=function(g,b){for(let B=0;B<g.length;B++){var a=g[B];const J=[];J.push(a[0]);for(var h=1;h<a.length;h++){let [C,K]=J[h-1];C+=a[h][0];K+=a[h][1];J.push([C,K])}a:{a=J;h=b;if(0>=h)break a;const C=a.length;if(3>C)break a;const K=[];var e=0;K.push(0);for(var f=1;f<C;f++)e+=F.dist(a[f],a[f-1]),K.push(e);h=Math.min(h,.2*e);e=[];e.push(a[0][0]);e.push(a[0][1]);f=a[C-1][0];const E=a[C-1][1];var c=F.sub([0,0],a[0],
a[1]);F.normalize(c);a[0][0]+=h*c[0];a[0][1]+=h*c[1];F.sub(c,a[C-1],a[C-2]);F.normalize(c);a[C-1][0]+=h*c[0];a[C-1][1]+=h*c[1];for(c=1;c<C;c++)K[c]+=h;K[C-1]+=h;c=.5*h;for(let I=1;I<C-1;I++){let H=0,N=0,U=0;for(var d=I-1;0<=d&&!(K[d+1]<K[I]-c);d--){var p=c+K[d+1]-K[I],v=K[d+1]-K[d],l=K[I]-K[d]<c?1:p/v;if(1E-6>Math.abs(l))break;var u=l*l,r=l*p-.5*u*v,A=l*v/h,w=a[d+1],m=a[d][0]-w[0],t=a[d][1]-w[1];H+=A/r*(w[0]*l*p+.5*u*(p*m-v*w[0])-u*l*v*m/3);N+=A/r*(w[1]*l*p+.5*u*(p*t-v*w[1])-u*l*v*t/3);U+=A}for(d=
I+1;d<C&&!(K[d-1]>K[I]+c);d++){p=c-K[d-1]+K[I];v=K[d]-K[d-1];l=K[d]-K[I]<c?1:p/v;if(1E-6>Math.abs(l))break;u=l*l;r=l*p-.5*u*v;A=l*v/h;w=a[d-1];m=a[d][0]-w[0];t=a[d][1]-w[1];H+=A/r*(w[0]*l*p+.5*u*(p*m-v*w[0])-u*l*v*m/3);N+=A/r*(w[1]*l*p+.5*u*(p*t-v*w[1])-u*l*v*t/3);U+=A}e.push(H/U);e.push(N/U)}e.push(f);e.push(E);for(let I=0,H=0;I<C;I++)a[I][0]=e[H++],a[I][1]=e[H++]}a=[];a.push(J[0]);for(h=1;h<J.length;h++){const [C,K]=J[h-1],[E,I]=J[h];a.push([Math.round(E-C),Math.round(I-K)])}g[B]=a}return g};Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(q){function n(G,F){return Math.sqrt(G*G+F*F)}q.DEFAULT_MAX_ZOOM=100;q.DEFAULT_MIN_ZOOM=0;q.dist=function(G,F){return n(G[0]-F[0],G[1]-F[1])};q.getLimitCosine=function(G=2){return 1/Math.max(G,1)};q.getMinMaxZoom=function(G,F){const z=!!G?.minScale&&F.scaleToZoom(G.minScale)||0;G=!!G?.maxScale&&F.scaleToZoom(G.maxScale)||100;return[z,G]};q.isExtent=function(G){return void 0!==
G.xmin&&void 0!==G.ymin&&void 0!==G.xmax&&void 0!==G.ymax};q.isFunction=function(G){return"function"===typeof G};q.isMultipoint=function(G){return void 0!==G.points};q.isPoint=function(G){return void 0!==G.x&&void 0!==G.y};q.isPolygon=function(G){return void 0!==G.rings};q.isPolyline=function(G){return void 0!==G.paths};q.len=n;q.normalize=function(G){const F=n(G[0],G[1]);G[0]/=F;G[1]/=F};q.sub=function(G,F,z){G[0]=F[0]-z[0];G[1]=F[1]-z[1];return G};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),function(q,n,G,F,z,y,D,x,k,g,b,a){return function(h){function e(c,d,p,v,l,u,r,A,w,m,t,B,J,C,K,E,I,H,N,U,ba,la,aa,ka){var V=
f.call(this);V._xOffset=G.pt2px(J);V._yOffset=G.pt2px(C);V._decoration=m||"none";V._backgroundColor=la;V._borderLineColor=aa;V._borderLineSize=ka;V._color=l;V._haloColor=u;V._haloSize=Math.min(Math.floor(5*G.pt2px(G.toPt(p))),127);V._size=Math.min(Math.round(G.pt2px(d)),127);d=Math.min(Math.round(G.pt2px(v||d)),127);V._referenceSize=Math.round(Math.sqrt(256*d));V._scale=V._size/D.GLYPH_SIZE;V._angle=B;V._justify=z.getJustification(r||"center");V._xAlignD=z.getXAnchorDirection(r||"center");V._yAlignD=
z.getYAnchorDirection(A||"baseline");V._baseline="baseline"===(A||"baseline");V._bitset=(w===F.Alignment.MAP?1:0)|(t?1:0)<<1;c=k.MaterialKeyBase.load(c);c.sdf=!0;V._materialKey=c.data;V._lineWidth=G.pt2px(K)||512;V._lineHeight=E||1;V._textPlacement=I;V._effects=H;V._isCIM=N??!1;V._minMaxZoom=x.i1616to32(Math.round(U*D.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(ba*D.MIN_MAX_ZOOM_PRECISION_FACTOR));return V}q._inherits(e,h);var f=q._createSuper(e);e.fromText=function(c,d){const p=c.font?.size,v=new e(c.materialKey,
p,c.haloSize||0,p,c.color&&y.premultiplyAlphaRGBAArray(c.color)||0,c.haloColor&&y.premultiplyAlphaRGBAArray(c.haloColor)||0,c.horizontalAlignment,c.verticalAlignment,F.Alignment.SCREEN,c.font?.decoration,!1,c.angle||0,c.xoffset||0,c.yoffset||0,c.lineWidth||0,c.lineHeight||0,null,null,!1,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM,c.backgroundColor&&y.premultiplyAlphaRGBAArray(c.backgroundColor),c.borderLineColor&&y.premultiplyAlphaRGBAArray(c.borderLineColor),c.borderLineSize),[,l]=n.bidiText(c.text);v.bindTextInfo(d??
[],l);v._vertexBoundsScale=c.maxVVSize&&p?c.maxVVSize/p:1;return v};e.fromCIMText=function(c,d,p){var v=c.scaleFactor||1;const l=c.size*c.sizeRatio*v,[u,r]=g.getMinMaxZoom(c.scaleInfo,p);p=new e(c.materialKey,l,c.outlineSize*c.sizeRatio,c.referenceSize,y.premultiplyAlphaRGBA(c.color),y.premultiplyAlphaRGBA(c.outlineColor),c.horizontalAlignment,c.verticalAlignment,c.alignment,c.decoration,c.colorLocked??!1,c.angle,c.offsetX*c.sizeRatio*v,c.offsetY*c.sizeRatio*v,512,1,c.markerPlacement,c.effects,!0,
u,r,c.backgroundColor?y.premultiplyAlphaRGBA(c.backgroundColor):void 0,c.borderLineColor?y.premultiplyAlphaRGBA(c.borderLineColor):void 0,c.borderLineWidth);[,v]=n.bidiText(c.text);p.bindTextInfo(d,v);p._vertexBoundsScale=c.maxVVSize?c.maxVVSize/l:1;return p};return q._createClass(e)}(b(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../geometry/GeometryCursor ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/CIMCursor ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){const h=g.i1616to32(4,4),e=g.i1616to32(4,2),f=g.i1616to32(4,6),c=[e,e,f,f],d=[e,f,e,f],p=[f,f,h,h],v=[h,h,f,f],l=[f,h,f,h],u=[h,f,h,f];return r=>function(A){function w(...t){t=m.call(this,...t);t._isCIM=!1;t._vertexBoundsScale=1;t.geometryType=k.WGLGeometryType.TEXT;t._aux=g.i8888to32(0,0,t._referenceSize,t._bitset);return t}q._inherits(w,A);var m=q._createSuper(w);A=w.prototype;A.bindTextInfo=function(t,B){this._shapingInfo=t&&t.length?n.applySome(t,J=>a.shapeGlyphs(J,
B,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:x.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM,hasBackground:!!this._backgroundColor,borderLineSize:this._borderLineSize})):null};A._write=function(t,B,J,C){const K=B.getDisplayId();this._writeGeometry(t,B,K,J,C)};A._writeGeometry=function(t,
B,J,C,K){const E=this._shapingInfo;if(!n.isNone(E)){if(n.isSome(this._textPlacement))return this._writePlacedText(t,J,E,C,B,K);B=K?z.deltaDecodeGeometry(z.convertFromGeometry(K),2):"esriGeometryPolygon"===B.geometryType?B.readCentroid():B.readGeometryForDisplay();if(!n.isNone(B)){if(B.isPoint){const [I,H]=B.coords;return!t.hasAggregates&&t.hasPixelBufferEnabled&&(0>I||512<=I||0>H||512<=H)?void 0:this._writeGlyphs(t,J,{x:I,y:H},E)}B.forEachVertex((I,H)=>this._writeGlyphs(t,J,{x:I,y:H},E))}}};A._writePlacedText=
function(t,B,J,C,K,E){var I=n.unwrap(this._textPlacement);E&&y.deltaDecodeGeometry(E);K=E?F.getJSONCursor(E):F.getOptimizedCursor(K.readGeometryForDisplay(),K.geometryType??null,!0);if(C=D.CIMMarkerPlacementHelper.getPlacement(K,I,G.pt2px(1),t.tileKey,C.geometryEngine))for(E=C.next();null!=E;)I=-E.getAngle(),J.setRotation(I),K=E.tx,E=-E.ty,0>K||512<=K||0>E||512<=E||(this._writeGlyphs(t,B,{x:K,y:E},J),J.setRotation(-I)),E=C.next()};A._writeGlyphs=function(t,B,J,C){const K=b.MaterialKeyBase.load(this._materialKey),
E=g.i1616to32(Math.round(8*J.x),Math.round(8*J.y)),I=this._vertexBoundsScale,{bounds:H,background:N,glyphs:U}=C;0<U.length&&(this._borderLineColor||this._backgroundColor)&&(K.textureBinding=U[0].textureBinding,t.recordStart(B,K.data,this.geometryType,!0),this._writeBackgroundGeometry(t,B,J,H,N),t.recordEnd());const ba=2*Math.max(H.width,H.height);for(const la of C.glyphs)K.textureBinding=la.textureBinding,t.recordStart(B,K.data,this.geometryType,!0),t.vertexBounds(J.x+H.x+this._xOffset,J.y+H.y-this._yOffset,
ba*I,ba*I),this._writeVertices(t,B,E,la),t.recordEnd()};A._writeGlyph=function(t,B,J,C,K){var E=b.MaterialKeyBase.load(this._materialKey);const I=g.i1616to32(Math.round(8*J),Math.round(8*C));E.textureBinding=K.textureBinding;t.recordStart(B,E.data,this.geometryType,!0);E=K.bounds;const H=this._vertexBoundsScale;t.vertexBounds(J+E.x*H,C+E.y*H,E.width*H,E.height*H);this._writeVertices(t,B,I,K);t.recordEnd()};A._writeVertices=function(t,B,J,C){const K=t.vertexCount();this._writeVertexCommon(t,B,J,C);
t.vertexWrite(C.offsets.upperLeft);t.vertexWrite(C.texcoords.upperLeft);t.vertexEnd();this._writeVertexCommon(t,B,J,C);t.vertexWrite(C.offsets.upperRight);t.vertexWrite(C.texcoords.upperRight);t.vertexEnd();this._writeVertexCommon(t,B,J,C);t.vertexWrite(C.offsets.lowerLeft);t.vertexWrite(C.texcoords.lowerLeft);t.vertexEnd();this._writeVertexCommon(t,B,J,C);t.vertexWrite(C.offsets.lowerRight);t.vertexWrite(C.texcoords.lowerRight);t.vertexEnd();t.indexWrite(K+0);t.indexWrite(K+1);t.indexWrite(K+2);
t.indexWrite(K+1);t.indexWrite(K+3);t.indexWrite(K+2)};A._writeVertexCommon=function(t,B,J,C){C=this._color;const K=this._haloColor,E=g.i8888to32(0,0,this._referenceSize,this._bitset),I=g.i8888to32(0,0,this._size,this._haloSize);t.vertexWrite(J);t.vertexWrite(B);t.vertexWrite(C);t.vertexWrite(K);t.vertexWrite(I);t.vertexWrite(E);t.vertexWrite(this._minMaxZoom)};A._writeBackgroundVertex=function(t,B,J,C,K,E){const I=g.i8888to32(0,1,this._referenceSize,this._bitset),H=g.i8888to32(0,0,this._size,this._haloSize),
N=g.i8888to32(0,0,0,0);t.vertexWrite(J);t.vertexWrite(B);t.vertexWrite(C);t.vertexWrite(N);t.vertexWrite(H);t.vertexWrite(I);t.vertexWrite(this._minMaxZoom);t.vertexWrite(K);t.vertexWrite(E);t.vertexEnd()};A._writeBackgroundQuad=function(t,B,J,C,K,E){const I=t.vertexCount();this._writeBackgroundVertex(t,B,J,C,K.upperLeft,E[0]);this._writeBackgroundVertex(t,B,J,C,K.upperRight,E[1]);this._writeBackgroundVertex(t,B,J,C,K.lowerLeft,E[2]);this._writeBackgroundVertex(t,B,J,C,K.lowerRight,E[3]);t.indexWrite(I+
0);t.indexWrite(I+1);t.indexWrite(I+2);t.indexWrite(I+1);t.indexWrite(I+3);t.indexWrite(I+2)};A._writeBackgroundGeometry=function(t,B,J,C,K){const E=g.i1616to32(Math.round(8*J.x),Math.round(8*J.y)),{x:I,y:H,width:N,height:U}=C;C=2*Math.max(N,U);t.vertexBounds(J.x+I+this._xOffset,J.y+H-this._yOffset,C*this._vertexBoundsScale,C*this._vertexBoundsScale);this._backgroundColor&&this._writeBackgroundQuad(t,B,E,this._backgroundColor,K.main,[h,h,h,h]);if(this._borderLineColor||this._backgroundColor){const [ba,
la,aa,ka,V]=this._borderLineColor&&this._borderLineSize&&0<this._borderLineSize?[c,c,d,d,this._borderLineColor]:[p,v,l,u,this._backgroundColor];this._writeBackgroundQuad(t,B,E,V,K.top,ba);this._writeBackgroundQuad(t,B,E,V,K.bot,la);this._writeBackgroundQuad(t,B,E,V,K.left,aa);this._writeBackgroundQuad(t,B,E,V,K.right,ka)}};return q._createClass(w)}(r)})},"esri/geometry/GeometryCursor":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./support/jsonUtils"],function(q,n,G){let F=function(){function x(){this._end=
-1;this._yFactor=1;this._ids=new Map}var k=x.prototype;k.initialize=function(g,b,a,h,e){this.hasZ=a;this.hasM=h;this.geometryType=b;this._geometry=g;this._pathIndex=-1;this._pathOffset=0;this._stride=2+Number(a)+Number(h);this._pointOffset=-this._stride;this._end=-1;this._yFactor=e;this._ids.clear();return this};k.reset=function(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this._yFactor)};k.seekPathFront=function(){this._pointOffset=this._pathOffset-this._stride};k.seekPathEnd=
function(){this._pointOffset=this._end};k.seekPathAt=function(g){g=this._pathOffset+g*this._stride;return 0<=g&&g<this._end?(this._pointOffset=g,!0):!1};k.nextPoint=function(){return(this._pointOffset+=this._stride)<this._end};k.prevPoint=function(){return(this._pointOffset-=this._stride)>=this._pathOffset};k.nextPath=function(){0<=this._pathIndex&&(this._pathOffset+=this._stride*this._geometry.lengths[this._pathIndex]);this._pointOffset=this._pathOffset-this._stride;this._end=this._pointOffset+this._stride+
this._stride*this._geometry.lengths[this._pathIndex+1];return++this._pathIndex<this._geometry.lengths.length};k.pathLength=function(){const g=this._end,b=this._stride,a=this._geometry.coords;let h=0;for(let e=this._pathOffset+b;e<g;e+=b){const f=a[e]-a[e-b],c=a[e+1]-a[e-b+1];h+=Math.sqrt(f*f+c*c)}return h};n._createClass(x,[{key:"numPoints",get:function(){const {lengths:g}=this._geometry;return 0>this._pathIndex||this._pathIndex>g.length-1?0:g[this._pathIndex]}},{key:"numPaths",get:function(){return this._geometry.lengths.length}},
{key:"pathIndex",get:function(){return this._pathIndex}},{key:"x",get:function(){return this._geometry.coords[this._pointOffset]}},{key:"y",get:function(){return this._yFactor*this._geometry.coords[this._pointOffset+1]}},{key:"z",get:function(){return this._geometry.coords[this._pointOffset+2]}},{key:"m",get:function(){return this._geometry.coords[this._pointOffset+(this.hasZ?3:2)]}},{key:"id",get:function(){return this._ids.get(this._pointOffset)||0},set:function(g){this._ids.set(this._pointOffset,
g)}}]);return x}(),z=function(){function x(){this._pathLen=0;this._yFactor=1}var k=x.prototype;k.initialize=function(g,b,a,h){if(G.isPolygon(g))g=[g.rings,"esriGeometryPolygon"];else if(G.isPolyline(g))g=[g.paths,"esriGeometryPolyline"];else if(G.isMultipoint(g))g=[[g.points],"esriGeometryMultipoint"];else if(G.isExtent(g))g=[[[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]]],"esriGeometryEnvelope"];else if(G.isPoint(g)){const c=[g.x,g.y];g.z&&c.push(g.z);g.m&&c.push(g.m);
g=[[[c]],"esriGeometryPoint"]}else g=[[],null];const [e,f]=g;this._paths=e;this.geometryType=f;this.hasZ=b;this.hasM=a;this._pathIndex=this._pointIndex=-1;this._yFactor=h;return this};k.reset=function(){this._pathIndex=this._pointIndex=-1};k.seekPathFront=function(){this._pointIndex=-1};k.seekPathEnd=function(){this._pointIndex=this._currentPath.length};k.seekPathAt=function(g){return 0<=g&&g<this._currentPath.length?(this._pointIndex=g,this._currentPoint=this._currentPath[this._pointIndex],!0):!1};
k.nextPoint=function(){this._currentPoint=this._currentPath[++this._pointIndex];return this._pointIndex<this._pathLen};k.prevPoint=function(){this._currentPoint=this._currentPath[--this._pointIndex];return 0<=this._pointIndex};k.nextPath=function(){this._pointIndex=-1;this._pathLen=this.pathIndex<this._paths.length-1?this._paths[this._pathIndex+1].length:0;this._currentPath=this._paths[++this._pathIndex];return this._pathIndex<this._paths.length};k.pathLength=function(){const g=this._currentPath.length,
b=this._currentPath;let a=0;for(let e=1;e<g;e++){var h=b[e-1];const f=b[e],c=f[0]-h[0];h=f[1]-h[1];a+=Math.sqrt(c*c+h*h)}return a};n._createClass(x,[{key:"numPoints",get:function(){return 0>this._pathIndex||this._pathIndex>this._paths.length-1?-1:this._paths[this._pathIndex].length}},{key:"numPaths",get:function(){return this._paths.length}},{key:"pathIndex",get:function(){return this._pathIndex}},{key:"pointIndex",get:function(){return this._pointIndex}},{key:"x",get:function(){return this._currentPoint[0]}},
{key:"y",get:function(){return this._yFactor*this._currentPoint[1]}},{key:"z",get:function(){return this._currentPoint[2]}},{key:"m",get:function(){return this._currentPoint[this.hasZ?3:2]}},{key:"id",get:function(){return this._currentPoint[4]},set:function(g){this._currentPoint[4]=g}}]);return x}();const y=new F,D=new z;q.getJSONCursor=function(x,k=!1,g=!1,b=!1){return D.initialize(x,g,b,k?-1:1)};q.getOptimizedCursor=function(x,k,g=!1,b=!1,a=!1){return y.initialize(x,k,b,a,g?-1:1)};Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(q,n,G,F,z){function y(d){d&&(F.isPoint(d)?d.y=-d.y:F.isPolygon(d)?x(d.rings):F.isPolyline(d)?x(d.paths):F.isMultipoint(d)&&D(d.points))}function D(d){if(d){const p=d.length;for(let v=0;v<p;v++)d[v][1]=-d[v][1]}}function x(d){if(d)for(const p of d)D(p)}function k(d){if(d){var p=d.length;
for(--p;0<p;--p)d[p][0]-=d[p-1][0],d[p][1]-=d[p-1][1]}}function g(d){if(d)for(const p of d)k(p)}function b(d){if(d){const p=d.length;for(let v=1;v<p;++v)d[v][0]+=d[v-1][0],d[v][1]+=d[v-1][1]}}function a(d){if(d)for(const p of d)b(p)}function h(d){d&&(F.isPolygon(d)?a(d.rings):F.isPolyline(d)?a(d.paths):F.isMultipoint(d)&&b(d.points),y(d))}function e(d){d&&d.reverse()}let f=function(){function d(p,v=!0,l=!0,u=0){this.isClosed=!1;this.geometryCursor=null;this.geometryCursor=!v&&"esriGeometryPolygon"===
p.geometryType||!l&&"esriGeometryPolyline"===p.geometryType?null:p;this.geomUnitsPerPoint=u;this.iteratePath=!1;this.internalPlacement=new z.Placement}d.prototype.next=function(){if(!this.geometryCursor)return null;for(;this.iteratePath||this.geometryCursor.nextPath();){this.geometryCursor.seekPathFront();const p=this.processPath(this.geometryCursor);if(p)return p}return this.geometryCursor=null};return n._createClass(d)}(),c=function(){function d(p,v,l,u=0){this.isClosed=!1;this.multiPath=null;this.inputGeometries=
p;this.acceptPolygon=v;this.acceptPolyline=l;this.geomUnitsPerPoint=u;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}d.prototype.next=function(){for(;;){if(!this.multiPath){for(var p=this.inputGeometries.next();p;)if(F.isPolygon(p)?this.acceptPolygon&&(this.multiPath=p.rings,this.isClosed=!0):F.isPolyline(p)?this.acceptPolyline&&(this.multiPath=p.paths,this.isClosed=!1):F.isExtent(p)&&this.acceptPolygon&&(this.multiPath=[[[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],[p.xmin,
p.ymin]]],this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else p=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,p=this.processPath(this.multiPath[this.pathIndex]))return p;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return n._createClass(d)}();q.PathGeometryCursor=c;q.PathTransformationCursor=f;q.cloneAndDecodeGeometry=function(d){d=G.clone(d);
h(d);return d};q.deltaDecodeGeometry=h;q.deltaEncodeGeometry=function(d){d&&(y(d),F.isPolygon(d)?g(d.rings):F.isPolyline(d)?g(d.paths):F.isMultipoint(d)&&k(d.points))};q.flipYs=y;q.getCoord2D=function(d,p,v){return[d[0]+(p[0]-d[0])*v,d[1]+(p[1]-d[1])*v]};q.getId=function(d){return d[4]};q.reverseMultipath=function(d){if(d)for(const p of d)e(p)};q.reversePath=e;q.setId=function(d,p){d[4]=p};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers"],function(q,n){let G=function(){function z(){this.setIdentity()}var y=z.prototype;y.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)this.rz=Math.atan2(this.rzSin,this.rzCos);return this.rz};y.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rzCos=1;this.rzSin=0};y.setTranslate=function(D,x){this.tx=D;this.ty=x};y.setTranslateZ=function(D){this.tz=D};y.setRotateCS=function(D,x){this.rz=
void 0;this.rzCos=D;this.rzSin=x};y.setRotate=function(D){this.rz=D;this.rzSin=this.rzCos=void 0};y.setRotateY=function(D){this.ry=D};y.setScale=function(D){this.s=D};y.setMeasure=function(D){this.m=D};return n._createClass(z)}(),F=function(){function z(){}z.prototype.next=function(){return null};return n._createClass(z)}();q.EmptyPlacementCursor=F;q.Placement=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMOperators"],function(q,n,G){let F=function(){function z(){}z.getPlacement=function(y,D,x,k,g){const b=G.getPlacementOperator(D);return b?b.execute(y,D,x,k,g):null};return n._createClass(z)}();q.CIMMarkerPlacementHelper=F;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r){q.getEffectOperator=function(A){if(!A)return null;switch(A.type){case "CIMGeometricEffectAddControlPoints":return n.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return G.EffectArrow.local();case "CIMGeometricEffectBuffer":return F.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return z.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return y.EffectCut.local();case "CIMGeometricEffectDashes":return D.EffectDashes.local();
case "CIMGeometricEffectDonut":return x.EffectDonut.local();case "CIMGeometricEffectJog":return k.EffectJog.local();case "CIMGeometricEffectMove":return g.EffectMove.local();case "CIMGeometricEffectOffset":return b.EffectOffset.local();case "CIMGeometricEffectReverse":return a.EffectReverse.local();case "CIMGeometricEffectRotate":return h.EffectRotate.local();case "CIMGeometricEffectScale":return e.EffectScale.local();case "CIMGeometricEffectWave":return f.EffectWave.local()}return null};q.getPlacementOperator=
function(A){if(!A)return null;switch(A.type){case "CIMMarkerPlacementAlongLineSameSize":return c.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return d.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return p.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return v.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return l.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return u.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return r.PlacementPolygonCenter.local()}return null};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(q,n,G,F,z){let y=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=
function(k,g,b,a,h){return new D(k,g,b)};return n._createClass(x)}();y.instance=null;let D=function(){function x(g,b,a){this._inputGeometries=g;this._angleTolerance=void 0!==b.angleTolerance?b.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var k=x.prototype;k.next=function(){for(var g=this._inputGeometries.next();g;){if(F.isPolygon(g))return this._isClosed=!0,g=G.clone(g),this._processMultipath(g.rings),g;if(F.isPolyline(g))return this._isClosed=!1,g=
G.clone(g),this._processMultipath(g.paths),g;if(F.isExtent(g)){if(this._maxCosAngle)return g;this._isClosed=!0;g=[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]];this._processPath(g);return{rings:[g]}}g=this._inputGeometries.next()}return null};k._processMultipath=function(g){if(g)for(const b of g)this._processPath(b)};k._processPath=function(g){if(g){let b=g.length,a=g[0],h,e,f,c,d,p;this._isClosed&&++b;for(let v=1;v<b;++v){let l;l=this._isClosed&&v===b-1?g[0]:g[v];
const u=l[0]-a[0],r=l[1]-a[1],A=Math.sqrt(u*u+r*r);1<v&&0<A&&0<f&&(h*u+e*r)/A/f<=this._maxCosAngle&&z.setId(a,1);1===v&&(c=u,d=r,p=A);0<A&&(a=l,h=u,e=r,f=A)}this._isClosed&&0<f&&0<p&&(h*c+e*d)/p/f<=this._maxCosAngle&&z.setId(g[0],1)}};return n._createClass(x)}();q.EffectAddControlPoints=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],
function(q,n,G,F,z){const y=z.GeometricEffectArrowType.OpenEnded;let D=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,b,a,h,e){return new x(g,b,a)};return n._createClass(k)}();D.instance=null;let x=function(k){function g(a,h,e){a=b.call(this,a,!1,!0);a._curveHelper=new F.CurveHelper;a._width=(void 0!==h.width?h.width:5)*e;a._arrowType=void 0!==h.geometricEffectArrowType?h.geometricEffectArrowType:void 0!==h.arrowType?
h.arrowType:y;a._offsetFlattenError=F.PIXEL_TOLERANCE*e;return a}n._inherits(g,k);var b=n._createSuper(g);k=g.prototype;k.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case z.GeometricEffectArrowType.Block:return this._constructSimpleArrow(a,!1);case z.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(a)}};k._constructSimpleArrow=function(a,h){var e=this._curveHelper.calculatePathLength(a),f=this._width;e<2*f&&(f=e/2);e=this._curveHelper.getSubCurve(a,
0,e-f);if(!e)return null;var c=f/2;if(this._curveHelper.isEmpty(e,!1))return null;f=this._constructOffset(e,-c);if(!f)return null;e=this._constructOffset(e,c);if(!e)return null;const d=this._constructArrowBasePoint(f,-c/2);if(!d)return null;c=this._constructArrowBasePoint(e,c/2);if(!c)return null;a=a[a.length-1];h||(this._makeControlPoint(e,!0),this._makeControlPoint(f,!0));const p=new F.PathHelper;p.addPath(e,!0);p.lineTo(c);this._makeControlPoint(p.path());p.lineTo(a);this._makeControlPoint(p.path());
p.lineTo(d);this._makeControlPoint(p.path());p.addPath(f,!1);return h?{paths:[p.path()]}:(p.close(),{rings:[p.path()]})};k._constructCrossedArrow=function(a){var h=this._curveHelper.calculatePathLength(a),e=this._width;h<3.732050807568877*e&&(e=h/3.732050807568877);var f=this._curveHelper.getSubCurve(a,0,h-2.732050807568877*e);if(!f)return null;var c=e/2;if(this._curveHelper.isEmpty(f,!1))return null;const d=this._constructOffset(f,c);if(!d)return null;f=this._constructOffset(f,-c);if(!f)return null;
h=this._curveHelper.getSubCurve(a,0,h-e);if(!h||this._curveHelper.isEmpty(h,!1))return null;e=this._constructOffset(h,c);if(!e)return null;var p=this._constructOffset(h,-c);if(!p)return null;h=e[e.length-1];e=this._constructArrowBasePoint(e,c/2);if(!e)return null;const v=p[p.length-1];c=this._constructArrowBasePoint(p,-c/2);if(!c)return null;a=a[a.length-1];this._makeControlPoint(d,!1);this._makeControlPoint(f,!1);p=new F.PathHelper;p.addPath(d,!0);this._makeControlPoint(p.path());p.lineTo(v);p.lineTo(c);
this._makeControlPoint(p.path());p.lineTo(a);this._makeControlPoint(p.path());p.lineTo(e);this._makeControlPoint(p.path());p.lineTo(h);this._makeControlPoint(p.path());p.addPath(f,!1);return{paths:[p.path()]}};k._constructOffset=function(a,h){return this._curveHelper.offset(a,h,z.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};k._constructArrowBasePoint=function(a,h){if(!a||2>a.length)return null;var e=a[a.length-2];a=a[a.length-1];e=[a[0]-e[0],a[1]-e[1]];this._curveHelper.normalize(e);
return[a[0]+e[1]*h,a[1]-e[0]*h]};k._makeControlPoint=function(a,h=!1){h?G.setId(a[0],1):G.setId(a[a.length-1],1)};return n._createClass(g)}(G.PathGeometryCursor);q.EffectArrow=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./enums"],function(q,n,G){let F=function(){function y(){this._path=[]}var D=y.prototype;D.path=function(){return this._path};D.addPath=function(x,k){k||x.reverse();
Array.prototype.push.apply(this._path,x);k||x.reverse()};y.mergePath=function(x,k){k&&Array.prototype.push.apply(x,k)};D.startPath=function(x){this._path.push(x)};D.lineTo=function(x){this._path.push(x)};D.close=function(){const x=this._path;1<x.length&&(x[0][0]!==x[x.length-1][0]||x[0][1]!==x[x.length-1][1])&&x.push([x[0][0],x[0][1]])};return n._createClass(y)}(),z=function(){function y(x,k){}var D=y.prototype;D.normalize=function(x){const k=Math.sqrt(x[0]*x[0]+x[1]*x[1]);0!==k&&(x[0]/=k,x[1]/=k)};
D.calculateLength=function(x,k){const g=k[0]-x[0];x=k[1]-x[1];return Math.sqrt(g*g+x*x)};D.calculateSegLength=function(x,k){return this.calculateLength(x[k],x[k+1])};D.calculatePathLength=function(x){let k=0;const g=x?x.length:0;for(let b=0;b<g-1;++b)k+=this.calculateSegLength(x,b);return k};D.calculatePathArea=function(x){let k=0;const g=x?x.length:0;for(let b=0;b<g-1;++b)k+=(x[b+1][0]-x[b][0])*(x[b+1][1]+x[b][1]);return k/2};D.getCoord2D=function(x,k,g){return[x[0]+(k[0]-x[0])*g,x[1]+(k[1]-x[1])*
g]};D.getSegCoord2D=function(x,k,g){return this.getCoord2D(x[k],x[k+1],g)};D.getAngle=function(x,k,g){return Math.atan2(k[1]-x[1],k[0]-x[0])};D.getSegAngle=function(x,k,g){return this.getAngle(x[k],x[k+1],g)};D.getAngleCS=function(x,k,g){g=k[0]-x[0];x=k[1]-x[1];k=Math.sqrt(g*g+x*x);return 0<k?[g/k,x/k]:[1,0]};D.getSegAngleCS=function(x,k,g){return this.getAngleCS(x[k],x[k+1],g)};D.cut=function(x,k,g,b){g=0>=g?x[k]:this.getSegCoord2D(x,k,g);x=1<=b?x[k+1]:this.getSegCoord2D(x,k,b);return[g,x]};D.addSegment=
function(x,k,g){g&&x.push(k[0]);x.push(k[1])};D.getSubCurve=function(x,k,g){const b=[];return this.appendSubCurve(b,x,k,g)?b:null};D.appendSubCurve=function(x,k,g,b){const a=k?k.length-1:0;let h=0,e=!0,f=0;for(;f<a;){const d=this.calculateSegLength(k,f);if(0!==d){if(e){if(h+d>g){var c=(g-h)/d;let p=1,v=!1;h+d>=b&&(p=(b-h)/d,v=!0);(c=this.cut(k,f,c,p))&&this.addSegment(x,c,e);if(v)break;e=!1}}else{if(h+d>b){(k=this.cut(k,f,0,(b-h)/d))&&this.addSegment(x,k,e);break}this.addSegment(x,[k[f],k[f+1]],e)}h+=
d}++f}return!0};D.getCIMPointAlong=function(x,k){const g=x?x.length-1:0;let b=0,a=-1;for(;a<g;){++a;const h=this.calculateSegLength(x,a);if(0!==h){if(b+h>k)return this.getCoord2D(x[a],x[a+1],(k-b)/h);b+=h}}return null};D.isEmpty=function(x,k){if(!x||1>=x.length)return!0;const g=x?x.length-1:0;let b=-1;for(;b<g;)if(++b,x[b+1][0]!==x[b][0]||x[b+1][1]!==x[b][1]||k&&x[b+1][2]!==x[b][2])return!1;return!0};D.offset=function(x,k,g,b,a){if(!x||2>x.length)return null;var h=0,e=x[h++];for(a=h;h<x.length;){var f=
x[h];if(f[0]!==e[0]||f[1]!==e[1])h!==a&&(x[a]=x[h]),e=x[a++];h++}(h=x[0][0]===x[a-1][0]&&x[0][1]===x[a-1][1])&&--a;if(a<(h?3:2))return null;f=[];e=h?x[a-1]:null;let c=x[0];for(let u=0;u<a;u++){const r=u===a-1?h?x[0]:null:x[u+1];if(e)if(r){var d=[r[0]-c[0],r[1]-c[1]];this.normalize(d);var p=[c[0]-e[0],c[1]-e[1]];this.normalize(p);var v=p[0]*d[1]-p[1]*d[0],l=p[0]*d[0]+p[1]*d[1];if(0===v&&1===l){c=r;continue}if(0<=v===0>=k)1>l&&(d=[d[0]-p[0],d[1]-p[1]],this.normalize(d),p=Math.sqrt((1+l)/2),p>1/b&&(p=
-Math.abs(k)/p,f.push([c[0]-d[0]*p,c[1]-d[1]*p])));else switch(g){case G.GeometricEffectOffsetMethod.Mitered:if(e=Math.sqrt((1+l)/2),0<e&&1/e<b){d=[d[0]-p[0],d[1]-p[1]];this.normalize(d);p=Math.abs(k)/e;f.push([c[0]-d[0]*p,c[1]-d[1]*p]);break}case G.GeometricEffectOffsetMethod.Bevelled:f.push([c[0]+p[1]*k,c[1]-p[0]*k]);f.push([c[0]+d[1]*k,c[1]-d[0]*k]);break;case G.GeometricEffectOffsetMethod.Rounded:if(1>l){f.push([c[0]+p[1]*k,c[1]-p[0]*k]);e=Math.floor(2.5*(1-l));if(0<e){v=l=1/e;for(let A=1;A<e;A++,
v+=l){const w=[p[1]*(1-v)+d[1]*v,-p[0]*(1-v)-d[0]*v];this.normalize(w);f.push([c[0]+w[0]*k,c[1]+w[1]*k])}}f.push([c[0]+d[1]*k,c[1]-d[0]*k])}break;default:0>v?(f.push([c[0]+(p[1]+p[0])*k,c[1]+(p[1]-p[0])*k]),f.push([c[0]+(d[1]-d[0])*k,c[1]-(d[0]+d[1])*k])):(e=Math.sqrt((1+Math.abs(l))/2),d=[d[0]-p[0],d[1]-p[1]],this.normalize(d),p=k/e,f.push([c[0]-d[0]*p,c[1]-d[1]*p]))}}else d=[c[0]-e[0],c[1]-e[1]],this.normalize(d),f.push([c[0]+d[1]*k,c[1]-d[0]*k]);else d=[r[0]-c[0],r[1]-c[1]],this.normalize(d),f.push([c[0]+
d[1]*k,c[1]-d[0]*k]);e=c;c=r}if(f.length<(h?3:2))return null;h&&f.push([f[0][0],f[0][1]]);return f};return n._createClass(y)}();q.CurveHelper=z;q.PIXEL_TOLERANCE=.03;q.PathHelper=F;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectBuffer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../CurveHelper ../enums ../../../geometry/SpatialReference".split(" "),
function(q,n,G,F,z,y,D,x,k){G=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(a,h,e,f,c){return new g(a,h,e,f,c)};return n._createClass(b)}();G.instance=null;let g=function(){function b(a,h,e,f,c){this._inputGeometries=a;this._tileKey=f;this._geometryEngine=c;this._curveHelper=new D.CurveHelper;this._size=(void 0!==h.size?h.size:1)*e;this._offsetFlattenError=D.PIXEL_TOLERANCE*e}b.prototype.next=function(){let a;for(;a=
this._inputGeometries.next();){if(0===this._size)return a;if(z.isExtent(a))if(0<this._size){var h=this._curveHelper.offset([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]],this._size,x.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(h)return{rings:[h]}}else if(0>this._size&&0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._size)return{xmin:a.xmin-this._size,xmax:a.xmax+this._size,ymin:a.ymin-this._size,ymax:a.ymax+this._size};h=this._geometryEngine;
if(F.isNone(h))break;let e=a;if(z.isPolygon(a)&&this._tileKey&&(e=y.clipPolygonToTileExtent(a,Math.abs(this._size)+1),!e||!e.rings||0===e.rings.length))continue;if(z.isPolyline(a)&&this._tileKey&&(e=y.clipPolylineToTileExtent(a,Math.abs(this._size)+1),!e||!e.paths||0===e.paths.length))continue;return h.buffer(k.WebMercator,e,this._size,1)}return null};return n._createClass(b)}();q.EffectBuffer=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMEffects":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","../../core/lang","../../geometry/support/TileClipper"],function(q,n,G,F){let z,y=function(){function D(x){this._geometry=x}D.prototype.next=function(){const x=this._geometry;this._geometry=null;return x};return n._createClass(D)}();q.SimpleGeometryCursor=y;q.clipPolygonToTileExtent=function(D,x){z||(z=new F.TileClipper(0,0,0,1));z.reset(F.GeometryType.Polygon);z.setPixelMargin(x+1);z.setExtent(512);for(var k of D.rings)if(k&&!(3>k.length)){D=k[0][0];x=-k[0][1];
z.moveTo(D,x);for(let g=1;g<k.length;g++)D=k[g][0],x=-k[g][1],z.lineTo(D,x);z.close()}if(D=z.result(!1)){k=[];for(const g of D){D=[];k.push(D);for(const b of g)D.push([b.x,-b.y])}return{rings:k}}return{rings:[]}};q.clipPolylineToTileExtent=function(D,x){z||(z=new F.TileClipper(0,0,0,1));z.reset(F.GeometryType.LineString);z.setPixelMargin(x+1);z.setExtent(512);for(var k of D.paths)if(k&&!(2>k.length)){D=k[0][0];x=-k[0][1];z.moveTo(D,x);for(let g=1;g<k.length;g++)D=k[g][0],x=-k[g][1],z.lineTo(D,x)}if(D=
z.result(!1)){k=[];for(const g of D){D=[];k.push(D);for(const b of g)D.push([b.x,-b.y])}return{paths:k}}return{paths:[]}};q.clone=function(D){return G.clone(D)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../geometry/support/jsonUtils","../CIMCursor","../enums"],function(q,n,G,F,z){let y=function(){function x(){}x.local=function(){null===x.instance&&
(x.instance=new x);return x.instance};x.prototype.execute=function(k,g,b,a,h){return new D(k,g,b)};return n._createClass(x)}();y.instance=null;let D=function(){function x(g,b,a){this._defaultPointSize=20;this._inputGeometries=g;this._geomUnitsPerPoint=a;this._rule=b.rule??z.GeometricEffectControlMeasureLineRule.FullGeometry;this._defaultSize=this._defaultPointSize*a}var k=x.prototype;k.next=function(){let g;for(;g=this._inputGeometries.next();){let b;G.isPoint(g)?b=this._processGeom([[[g.x,g.y]]]):
G.isMultipoint(g)?b=this._processGeom([g.points]):G.isPolyline(g)?b=this._processGeom(g.paths):G.isPolygon(g)&&(b=this._processGeom(g.rings));if(b&&b.length)return{paths:b}}return null};k._clone=function(g){return[g[0],g[1]]};k._mid=function(g,b){return[(g[0]+b[0])/2,(g[1]+b[1])/2]};k._mix=function(g,b,a,h){return[g[0]*b+a[0]*h,g[1]*b+a[1]*h]};k._add=function(g,b){return[g[0]+b[0],g[1]+b[1]]};k._add2=function(g,b,a){return[g[0]+b,g[1]+a]};k._sub=function(g,b){return[g[0]-b[0],g[1]-b[1]]};k._dist=
function(g,b){return Math.sqrt((g[0]-b[0])*(g[0]-b[0])+(g[1]-b[1])*(g[1]-b[1]))};k._norm=function(g){return Math.sqrt(g[0]*g[0]+g[1]*g[1])};k._normalize=function(g,b=1){b/=this._norm(g);g[0]*=b;g[1]*=b};k._leftPerpendicular=function(g){const b=g[0];g[0]=-g[1];g[1]=b};k._leftPerp=function(g){return[-g[1],g[0]]};k._rightPerpendicular=function(g){const b=-g[0];g[0]=g[1];g[1]=b};k._rightPerp=function(g){return[g[1],-g[0]]};k._dotProduct=function(g,b){return g[0]*b[0]+g[1]*b[1]};k._crossProduct=function(g,
b){return g[0]*b[1]-g[1]*b[0]};k._rotateDirect=function(g,b,a){const h=g[0]*a+g[1]*b;g[0]=g[0]*b-g[1]*a;g[1]=h};k._makeCtrlPt=function(g){g=[g[0],g[1]];F.setId(g,1);return g};k._addAngledTicks=function(g,b,a,h){const e=this._sub(a,b);this._normalize(e);var f=this._crossProduct(e,this._sub(h,b));h=0<f?this._rightPerp(e):this._leftPerp(e);f=Math.abs(f)/2;const c=[];c.push([b[0]+(h[0]-e[0])*f,b[1]+(h[1]-e[1])*f]);c.push(b);c.push(a);c.push([a[0]+(h[0]+e[0])*f,a[1]+(h[1]+e[1])*f]);g.push(c)};k._addBezier2=
function(g,b,a,h,e){if(0===e--)g.push(h);else{var f=this._mid(b,a);a=this._mid(a,h);var c=this._mid(f,a);this._addBezier2(g,b,f,c,e);this._addBezier2(g,c,a,h,e)}};k._addBezier3=function(g,b,a,h,e,f){if(0===f--)g.push(e);else{var c=this._mid(b,a),d=this._mid(a,h);h=this._mid(h,e);a=this._mid(c,d);d=this._mid(d,h);var p=this._mid(a,d);this._addBezier3(g,b,c,a,p,f);this._addBezier3(g,p,d,h,e,f)}};k._add90DegArc=function(g,b,a,h,e){h=e??0<this._crossProduct(this._sub(a,b),this._sub(h,b));e=this._mid(b,
a);const f=this._sub(e,b);h?this._leftPerpendicular(f):this._rightPerpendicular(f);e[0]+=f[0];e[1]+=f[1];this._addBezier3(g,b,this._mix(b,.33333,e,.66667),this._mix(a,.33333,e,.66667),a,4)};k._addArrow=function(g,b,a){var h=b[0],e=b[1],f=b[b.length-1],c=this._sub(h,e);this._normalize(c);const d=this._crossProduct(c,this._sub(f,e));e=.5*d;var p=this._leftPerp(c);const v=[f[0]-p[0]*d,f[1]-p[1]*d];var l=b.length-1;f=[];f.push(a?[-p[0],-p[1]]:p);var u=[-c[0],-c[1]];for(a=1;a<l-1;a++){c=this._sub(b[a+
1],b[a]);this._normalize(c);var r=this._dotProduct(c,u);p=this._crossProduct(c,u);r=Math.sqrt((1+r)/2);u=this._sub(c,u);this._normalize(u);u[0]/=r;u[1]/=r;f.push(0>p?[-u[0],-u[1]]:u);u=c}f.push(this._rightPerp(u));for(l=f.length-1;0<l;l--)g.push([b[l][0]+f[l][0]*e,b[l][1]+f[l][1]*e]);g.push([v[0]+f[0][0]*e,v[1]+f[0][1]*e]);g.push([v[0]+f[0][0]*d,v[1]+f[0][1]*d]);g.push(h);g.push([v[0]-f[0][0]*d,v[1]-f[0][1]*d]);g.push([v[0]-f[0][0]*e,v[1]-f[0][1]*e]);for(h=1;h<f.length;h++)g.push([b[h][0]-f[h][0]*
e,b[h][1]-f[h][1]*e])};k._cp2=function(g,b,a){return 2<=g.length?g[1]:this._add2(g[0],b*this._defaultSize,a*this._defaultSize)};k._cp3=function(g,b,a,h){if(3<=g.length)return g[2];a=this._mix(g[0],1-a,b,a);g=this._sub(b,g[0]);this._normalize(g);this._rightPerpendicular(g);return[a[0]+g[0]*h*this._defaultSize,a[1]+g[1]*h*this._defaultSize]};k._arrowPath=function(g){if(2<g.length)return g;const b=g[0];g=this._cp2(g,-4,0);const a=this._sub(b,g);this._normalize(a);const h=this._rightPerp(a);return[b,
g,[b[0]+(h[0]-a[0])*this._defaultSize,b[1]+(h[1]-a[1])*this._defaultSize]]};k._arrowLastSeg=function(g){var b=g[0];const a=this._cp2(g,-4,0);if(3<=g.length)b=g[g.length-1];else{g=this._sub(b,a);this._normalize(g);const h=this._rightPerp(g);b=[b[0]+(h[0]-g[0])*this._defaultSize,b[1]+(h[1]-g[1])*this._defaultSize]}return[a,b]};k._processGeom=function(g){if(!g)return null;const b=[];for(const a of g){if(!a||0===a.length)continue;const h=a.length;let e=a[0];switch(this._rule){case z.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:const f=
this._cp2(a,0,-1),c=this._cp3(a,f,.5,4),d=[];d.push(c);d.push(this._mid(e,f));b.push(d);break;case z.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:const p=this._cp2(a,0,-1);b.push([p,e]);break;case z.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:const v=this._cp2(a,-4,1),l=this._cp3(a,v,.882353,-1.94),u=[];u.push(this._mid(v,l));u.push(e);b.push(u);break;case z.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:const r=this._cp2(a,-4,1),A=this._cp3(a,r,
.882353,-1.94),w=this._sub(A,r);let m;m=0<this._crossProduct(w,this._sub(e,r))?this._rightPerp(m):this._leftPerp(w);const t=[];t.push([r[0]+(m[0]-w[0])/3,r[1]+(m[1]-w[1])/3]);t.push(r);t.push(A);t.push([A[0]+(m[0]+w[0])/3,A[1]+(m[1]+w[1])/3]);b.push(t);break;case z.GeometricEffectControlMeasureLineRule.DoublePerpendicular:const B=this._cp2(a,0,-1),J=this._cp3(a,B,.5,3),C=this._mid(e,B),K=this._sub(C,J);this._normalize(K);const E=this._crossProduct(K,this._sub(e,J));this._leftPerpendicular(K);const I=
[];I.push(e);I.push([J[0]+K[0]*E,J[1]+K[1]*E]);b.push(I);const H=[];H.push([J[0]-K[0]*E,J[1]-K[1]*E]);H.push(B);b.push(H);break;case z.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:const N=this._cp2(a,0,-1),U=this._cp3(a,N,.5,3),ba=this._mid(e,N),la=this._sub(ba,U);this._normalize(la);const aa=this._crossProduct(la,this._sub(e,U));this._leftPerpendicular(la);const ka=[];ka.push([U[0]+la[0]*aa,U[1]+la[1]*aa]);ka.push([U[0]-la[0]*aa,U[1]-la[1]*aa]);b.push(ka);break;case z.GeometricEffectControlMeasureLineRule.TriplePerpendicular:const V=
this._cp2(a,0,-1),P=this._cp3(a,V,.5,4),S=this._mid(e,V),X=this._sub(S,P);this._normalize(X);const ra=this._crossProduct(X,this._sub(e,P));this._leftPerpendicular(X);const Y=[];Y.push([P[0]+X[0]*ra*.8,P[1]+X[1]*ra*.8]);Y.push([S[0]+.8*(e[0]-S[0]),S[1]+.8*(e[1]-S[1])]);b.push(Y);b.push([P,S]);const ua=[];ua.push([P[0]-X[0]*ra*.8,P[1]-X[1]*ra*.8]);ua.push([S[0]+.8*(V[0]-S[0]),S[1]+.8*(V[1]-S[1])]);b.push(ua);break;case z.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:const ca=this._cp2(a,
0,-1),ia=this._cp3(a,ca,.5,4),oa=this._mid(e,ca);let M=this._sub(ca,e);const Q=Math.cos(Math.PI/18),fa=Math.sin(Math.PI/18),na=Math.sqrt((1+Q)/2),za=Math.sqrt((1-Q)/2),W=[];let da;0<this._crossProduct(M,this._sub(ia,e))?(W.push(e),M=this._sub(e,oa),da=ca):(W.push(ca),M=this._sub(ca,oa),da=e);this._rotateDirect(M,na,za);M[0]/=na;M[1]/=na;for(let eb=1;18>=eb;eb++)W.push(this._add(oa,M)),this._rotateDirect(M,Q,fa);W.push(da);b.push(W);break;case z.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:const ha=
this._cp2(a,0,-1),ma=this._cp3(a,ha,1,-1);let qa=this._sub(e,ha);this._normalize(qa);const wa=this._crossProduct(qa,this._sub(ma,ha))/2;this._leftPerpendicular(qa);const ya=[ha[0]+qa[0]*wa,ha[1]+qa[1]*wa];qa=this._sub(ha,ya);const Ea=Math.cos(Math.PI/18);let Da=Math.sin(Math.PI/18);0<wa&&(Da=-Da);const Ia=[ha];for(let eb=1;18>=eb;eb++)this._rotateDirect(qa,Ea,Da),Ia.push(this._add(ya,qa));b.push(Ia);break;case z.GeometricEffectControlMeasureLineRule.HalfCircleExtended:const Ja=this._cp2(a,0,-2),La=
this._cp3(a,Ja,1,-1);let Ra;if(4<=h)Ra=a[3];else{const eb=this._sub(e,Ja);Ra=this._add(La,eb)}const Pa=this._dist(Ja,La)/2/.75,Sa=this._sub(Ja,e);this._normalize(Sa,Pa);const Ta=this._sub(La,Ra);this._normalize(Ta,Pa);b.push([Ra,La]);const Qa=[this._clone(La)];this._addBezier3(Qa,La,this._add(La,Ta),this._add(Ja,Sa),Ja,4);Qa.push(e);b.push(Qa);break;case z.GeometricEffectControlMeasureLineRule.OpenCircle:const Ya=this._cp2(a,-2,0),Za=this._sub(Ya,e),Ha=Math.cos(Math.PI/18),gb=-Math.sin(Math.PI/18),
lb=[Ya];for(let eb=1;33>=eb;eb++)this._rotateDirect(Za,Ha,gb),lb.push(this._add(e,Za));b.push(lb);break;case z.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:const cb=this._cp2(a,0,-1);let O;if(3<=h)O=a[2];else{const eb=this._sub(cb,e),Ab=this._leftPerp(eb);O=[e[0]+Ab[0]-.25*eb[0],e[1]+Ab[1]-.25*eb[1]]}let fb;if(4<=h)fb=a[3];else{const eb=this._mid(e,cb),Ab=this._sub(e,cb);this._normalize(Ab);this._leftPerpendicular(Ab);const $a=this._crossProduct(Ab,this._sub(O,eb));this._rightPerpendicular(Ab);
fb=[O[0]+Ab[0]*$a*2,O[1]+Ab[1]*$a*2]}const sb=this._sub(cb,e);let Jb,mb;Jb=0<this._crossProduct(sb,this._sub(O,e))?this._rightPerp(sb):this._leftPerp(sb);mb=[];mb.push(O);mb.push(e);mb.push([e[0]+(Jb[0]-sb[0])/3,e[1]+(Jb[1]-sb[1])/3]);b.push(mb);Jb=0<this._crossProduct(sb,this._sub(fb,cb))?this._rightPerp(Jb):this._leftPerp(sb);mb=[];mb.push([cb[0]+(Jb[0]+sb[0])/3,cb[1]+(Jb[1]+sb[1])/3]);mb.push(cb);mb.push(fb);b.push(mb);break;case z.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:const Ba=
this._cp2(a,0,2),mc=this._cp3(a,Ba,0,1);let Sb;if(4<=h)Sb=a[3];else{const eb=this._sub(Ba,e);Sb=this._add(mc,eb)}this._addAngledTicks(b,e,Ba,this._mid(mc,Sb));this._addAngledTicks(b,mc,Sb,this._mid(e,Ba));break;case z.GeometricEffectControlMeasureLineRule.GapExtentMidline:const Gb=this._cp2(a,2,0),Pb=this._cp3(a,Gb,0,1);let ic;if(4<=h)ic=a[3];else{const eb=this._sub(Gb,e);ic=this._add(Pb,eb)}const $b=[];$b.push(this._mid(e,Pb));$b.push(this._mid(Gb,ic));b.push($b);break;case z.GeometricEffectControlMeasureLineRule.Chevron:const tc=
this._cp2(a,-1,-1);let Hb;if(3<=h)Hb=a[2];else{const eb=this._sub(tc,e);this._leftPerpendicular(eb);Hb=this._add(e,eb)}b.push([tc,this._makeCtrlPt(e),Hb]);break;case z.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:const Lb=this._cp2(a,0,-2),pb=this._cp3(a,Lb,.5,-1);let ob=this._sub(Lb,e);const Eb=this._norm(ob);ob[0]/=Eb;ob[1]/=Eb;const ab=this._crossProduct(ob,this._sub(pb,e));let Tb=this._dotProduct(ob,this._sub(pb,e));Tb<.05*Eb?Tb=.05*Eb:Tb>.95*Eb&&(Tb=.95*Eb);const pa=[e[0]+ob[0]*
Tb,e[1]+ob[1]*Tb];this._leftPerpendicular(ob);let xa=[];xa.push([pa[0]-ob[0]*ab,pa[1]-ob[1]*ab]);xa.push([pa[0]+ob[0]*ab,pa[1]+ob[1]*ab]);b.push(xa);const sa=[Lb[0]+ob[0]*ab,Lb[1]+ob[1]*ab];ob=this._sub(Lb,sa);const Ca=Math.cos(Math.PI/18);let Na=Math.sin(Math.PI/18);0>ab&&(Na=-Na);xa=[e,Lb];for(let eb=1;9>=eb;eb++)this._rotateDirect(ob,Ca,Na),xa.push(this._add(sa,ob));b.push(xa);break;case z.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:const Oa=this._cp2(a,2,0),Wa=this._mid(e,Oa),bb=this._sub(Oa,
Wa),ub=Math.cos(Math.PI/18),tb=Math.sin(Math.PI/18),rb=[e,Oa];for(let eb=1;18>=eb;eb++)this._rotateDirect(bb,ub,tb),rb.push(this._add(Wa,bb));b.push(rb);break;case z.GeometricEffectControlMeasureLineRule.TripleParallelExtended:const vb=this._cp2(a,0,-2),Mb=this._cp3(a,vb,1,-2),nc=this._mid(e,vb),Wb=this._sub(Mb,vb);this._normalize(Wb);const wd=Math.abs(this._crossProduct(Wb,this._sub(nc,vb)))/2,uc=this._dist(vb,Mb),xd=[vb,e];xd.push([e[0]+Wb[0]*uc*.5,e[1]+Wb[1]*uc*.5]);b.push(xd);const vc=[];vc.push([nc[0]-
Wb[0]*wd,nc[1]-Wb[1]*wd]);vc.push([nc[0]+Wb[0]*uc*.375,nc[1]+Wb[1]*uc*.375]);F.setId(vc[vc.length-1],1);vc.push([nc[0]+Wb[0]*uc*.75,nc[1]+Wb[1]*uc*.75]);b.push(vc);b.push([vb,Mb]);break;case z.GeometricEffectControlMeasureLineRule.ParallelWithTicks:const Fc=this._cp2(a,3,0),ed=this._cp3(a,Fc,.5,-1),Gc=this._sub(ed,Fc);this._normalize(Gc);const yd=this._crossProduct(Gc,this._sub(ed,e));this._leftPerpendicular(Gc);this._addAngledTicks(b,e,Fc,ed);this._addAngledTicks(b,this._mix(e,1,Gc,yd),this._mix(Fc,
1,Gc,yd),this._mid(e,Fc));break;case z.GeometricEffectControlMeasureLineRule.Parallel:const Oc=this._cp2(a,3,0),Pd=this._cp3(a,Oc,.5,-1),fd=this._sub(Oc,e);this._normalize(fd);const Pc=this._leftPerp(fd),Qc=this._crossProduct(fd,this._sub(Pd,e));let Zb=[e,Oc];b.push(Zb);Zb=[];Zb.push([e[0]+Pc[0]*Qc,e[1]+Pc[1]*Qc]);Zb.push([Oc[0]+Pc[0]*Qc,Oc[1]+Pc[1]*Qc]);b.push(Zb);break;case z.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:const Rc=this._cp2(a,3,0),ad=this._cp3(a,Rc,.5,-1),wc=
this._mid(e,Rc),xc=this._sub(Rc,e);this._normalize(xc);const yc=this._crossProduct(xc,this._sub(ad,e));this._leftPerpendicular(xc);const Vb=[];Vb.push([wc[0]-xc[0]*yc*.25,wc[1]-xc[1]*yc*.25]);Vb.push([wc[0]+xc[0]*yc*1.25,wc[1]+xc[1]*yc*1.25]);b.push(Vb);break;case z.GeometricEffectControlMeasureLineRule.ParallelOffset:const qc=this._cp2(a,3,0),od=this._cp3(a,qc,.5,-1),Rb=this._sub(qc,e);this._normalize(Rb);const Yb=this._crossProduct(Rb,this._sub(od,e));this._leftPerpendicular(Rb);const Hc=[];Hc.push([e[0]-
Rb[0]*Yb,e[1]-Rb[1]*Yb]);Hc.push([qc[0]-Rb[0]*Yb,qc[1]-Rb[1]*Yb]);b.push(Hc);const zd=[];zd.push([e[0]+Rb[0]*Yb,e[1]+Rb[1]*Yb]);zd.push([qc[0]+Rb[0]*Yb,qc[1]+Rb[1]*Yb]);b.push(zd);break;case z.GeometricEffectControlMeasureLineRule.OffsetOpposite:const gd=this._cp2(a,3,0),ne=this._cp3(a,gd,.5,-1),qb=this._sub(gd,e);this._normalize(qb);const Ic=this._crossProduct(qb,this._sub(ne,e));this._leftPerpendicular(qb);const Ib=[];Ib.push([e[0]-qb[0]*Ic,e[1]-qb[1]*Ic]);Ib.push([gd[0]-qb[0]*Ic,gd[1]-qb[1]*Ic]);
b.push(Ib);break;case z.GeometricEffectControlMeasureLineRule.OffsetSame:const bd=this._cp2(a,3,0),Ad=this._cp3(a,bd,.5,-1),oc=this._sub(bd,e);this._normalize(oc);const Sc=this._crossProduct(oc,this._sub(Ad,e));this._leftPerpendicular(oc);const hd=[];hd.push([e[0]+oc[0]*Sc,e[1]+oc[1]*Sc]);hd.push([bd[0]+oc[0]*Sc,bd[1]+oc[1]*Sc]);b.push(hd);break;case z.GeometricEffectControlMeasureLineRule.CircleWithArc:let bc=this._cp2(a,3,0);const id=this._cp3(a,bc,.5,-1);let zc,yb;if(4<=h)zc=a[3],yb=0<this._crossProduct(this._sub(zc,
bc),this._sub(id,bc));else{zc=bc;yb=0<this._crossProduct(this._sub(zc,e),this._sub(id,e));const eb=24*this._geomUnitsPerPoint,Ab=this._sub(zc,e);this._normalize(Ab,eb);const $a=Math.sqrt(2)/2;this._rotateDirect(Ab,$a,yb?$a:-$a);bc=this._add(e,Ab)}const Ld=this._sub(bc,e),pd=Math.cos(Math.PI/18),le=Math.sin(Math.PI/18),rc=[bc];for(let eb=1;36>=eb;eb++)this._rotateDirect(Ld,pd,le),rc.push(this._add(e,Ld));this._add90DegArc(rc,bc,zc,id,yb);F.setId(rc[rc.length-8],1);b.push(rc);break;case z.GeometricEffectControlMeasureLineRule.DoubleJog:let gc=
this._cp2(a,-3,1),kc;kc=3<=h?a[2]:this._add(e,this._sub(e,gc));let ac;if(4<=h)ac=a[3];else{const eb=e;e=gc;ac=kc;const Ab=this._dist(e,eb),$a=this._dist(ac,eb);let L=30*this._geomUnitsPerPoint;.5*Ab<L&&(L=.5*Ab);.5*$a<L&&(L=.5*$a);gc=this._mix(e,L/Ab,eb,(Ab-L)/Ab);kc=this._mix(ac,L/$a,eb,($a-L)/$a)}const Nd=this._mid(e,gc),Md=this._mid(ac,kc),me=this._dist(e,gc),Bd=this._dist(kc,ac);let Db=Math.min(me,Bd)/8;Db=Math.min(Db,24*this._geomUnitsPerPoint);const Fb=Math.cos(Math.PI/4);let Qb=this._sub(e,
gc);this._normalize(Qb,Db);0<this._crossProduct(Qb,this._sub(ac,gc))?this._rotateDirect(Qb,Fb,-Fb):this._rotateDirect(Qb,Fb,Fb);let Ub=[];Ub.push(gc);Ub.push(this._add(Nd,Qb));Ub.push(this._sub(Nd,Qb));Ub.push(e);b.push(Ub);Qb=this._sub(ac,kc);this._normalize(Qb,Db);0>this._crossProduct(Qb,this._sub(e,kc))?this._rotateDirect(Qb,Fb,Fb):this._rotateDirect(Qb,Fb,-Fb);Ub=[];Ub.push(kc);Ub.push(this._add(Md,Qb));Ub.push(this._sub(Md,Qb));Ub.push(ac);b.push(Ub);break;case z.GeometricEffectControlMeasureLineRule.PerpendicularOffset:const Jc=
this._cp2(a,-4,1),Cd=this._cp3(a,Jc,.882353,-1.94),Ac=this._sub(Cd,Jc);0<this._crossProduct(Ac,this._sub(e,Jc))?this._rightPerpendicular(Ac):this._leftPerpendicular(Ac);const oe=[Ac[0]/8,Ac[1]/8],Qd=this._sub(this._mid(Jc,Cd),oe);b.push([Qd,e]);break;case z.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:const Dd=this._arrowPath(a),Ed=[];let Fd=Dd.length-2;for(;Fd--;)Ed.push(Dd[Fd]);b.push(Ed);break;case z.GeometricEffectControlMeasureLineRule.MultivertexArrow:const pe=this._arrowPath(a),
Od=[];this._addArrow(Od,pe,!1);b.push(Od);break;case z.GeometricEffectControlMeasureLineRule.CrossedArrow:const qe=this._arrowPath(a),Rd=[];this._addArrow(Rd,qe,!0);b.push(Rd);break;case z.GeometricEffectControlMeasureLineRule.ChevronArrow:const [Sd,Tc]=this._arrowLastSeg(a),jd=10*this._geomUnitsPerPoint,Bc=this._sub(e,Sd);this._normalize(Bc);const Td=this._crossProduct(Bc,this._sub(Tc,Sd)),Ud=this._leftPerp(Bc),Gd=[Tc[0]-Ud[0]*Td*2,Tc[1]-Ud[1]*Td*2],kd=[];kd.push([Tc[0]+Bc[0]*jd,Tc[1]+Bc[1]*jd]);
kd.push(e);kd.push([Gd[0]+Bc[0]*jd,Gd[1]+Bc[1]*jd]);b.push(kd);break;case z.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:const [Vd,Hd]=this._arrowLastSeg(a),jc=this._sub(e,Vd);this._normalize(jc);const Kc=this._crossProduct(jc,this._sub(Hd,Vd));this._leftPerpendicular(jc);const Uc=[Hd[0]-jc[0]*Kc,Hd[1]-jc[1]*Kc],ld=[];ld.push([Uc[0]+jc[0]*Kc*.5,Uc[1]+jc[1]*Kc*.5]);ld.push(this._mid(Uc,e));ld.push([Uc[0]-jc[0]*Kc*.5,Uc[1]-jc[1]*Kc*.5]);b.push(ld);break;case z.GeometricEffectControlMeasureLineRule.PartialFirstSegment:const [md,
Id]=this._arrowLastSeg(a),Vc=this._sub(e,md);this._normalize(Vc);const pc=this._crossProduct(Vc,this._sub(Id,md));this._leftPerpendicular(Vc);b.push([md,[Id[0]-Vc[0]*pc,Id[1]-Vc[1]*pc]]);break;case z.GeometricEffectControlMeasureLineRule.Arch:const qd=this._cp2(a,0,-1),kb=this._cp3(a,qd,.5,1),zb=this._sub(e,qd),Wc=this._mix(kb,1,zb,.55),rd=this._mix(kb,1,zb,-.55),cd=[e];this._addBezier2(cd,e,Wc,kb,4);this._addBezier2(cd,kb,rd,qd,4);b.push(cd);break;case z.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:const lc=
this._cp2(a,-4,1),Ec=this._cp3(a,lc,.882353,-1.94),hc=this._sub(Ec,lc);0<this._crossProduct(hc,this._sub(e,lc))?this._rightPerpendicular(hc):this._leftPerpendicular(hc);const sd=[hc[0]/8,hc[1]/8],dd=this._sub(this._mid(lc,Ec),sd),ud=this._sub(this._mix(lc,.75,Ec,.25),sd),td=this._sub(this._mix(lc,.25,Ec,.75),sd),Nc=[lc];this._addBezier2(Nc,lc,ud,dd,3);this._addBezier2(Nc,dd,td,Ec,3);b.push(Nc);for(let eb=0;8>eb;eb++){const Ab=Nc[2*eb+1],$a=[this._clone(Ab)];$a.push(this._add(Ab,[hc[0]/4,hc[1]/4]));
b.push($a)}break;case z.GeometricEffectControlMeasureLineRule.Arc90Degrees:const Jd=this._cp2(a,0,-1),re=this._cp3(a,Jd,.5,1),vd=[Jd];this._add90DegArc(vd,Jd,e,re);b.push(vd);break;default:b.push(a)}}return b};return n._createClass(x)}();q.EffectControlMeasureLine=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(q,n,G,F){let z=function(){function D(){}
D.local=function(){null===D.instance&&(D.instance=new D);return D.instance};D.prototype.execute=function(x,k,g,b,a){return new y(x,k,g)};return n._createClass(D)}();z.instance=null;let y=function(D){function x(g,b,a){g=k.call(this,g,!0,!0);g._curveHelper=new F.CurveHelper;g._beginCut=(void 0!==b.beginCut?b.beginCut:1)*a;g._endCut=(void 0!==b.endCut?b.endCut:1)*a;g._middleCut=(void 0!==b.middleCut?b.middleCut:0)*a;g._invert=void 0!==b.invert?b.invert:!1;0>g._beginCut&&(g._beginCut=0);0>g._endCut&&
(g._endCut=0);0>g._middleCut&&(g._middleCut=0);return g}n._inherits(x,D);var k=n._createSuper(x);x.prototype.processPath=function(g){var b=this._beginCut;const a=this._endCut,h=this._middleCut,e=this._curveHelper.calculatePathLength(g),f=[];if(!this._invert)0===b&&0===a&&0===h?f.push(g):b+a+h>=e||(0===h?(g=this._curveHelper.getSubCurve(g,b,e-a))&&f.push(g):((b=this._curveHelper.getSubCurve(g,b,.5*(e-h)))&&f.push(b),(b=this._curveHelper.getSubCurve(g,.5*(e+h),e-a))&&f.push(b)));else if(0!==b||0!==
a||0!==h)b+a+h>=e?f.push(g):((b=this._curveHelper.getSubCurve(g,0,b))&&f.push(b),(b=this._curveHelper.getSubCurve(g,.5*(e-h),.5*(e+h)))&&f.push(b),(b=this._curveHelper.getSubCurve(g,e-a,a))&&f.push(b));return 0===f.length?null:{paths:f}};return n._createClass(x)}(G.PathGeometryCursor);q.EffectCut=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),
function(q,n,G,F,z,y){let D=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,b,a,h,e){return new x(g,b,a)};return n._createClass(k)}();D.instance=null;let x=function(k){function g(a,h,e){a=b.call(this,a,!0,!0);a._firstCurve=null;a._walker=new y.GeometryWalker;a._walker.updateTolerance(e);a._endings=h.lineDashEnding;a._customDashPos=-(h.offsetAlongLine??0)*e;a._offsetAtEnd=(h.customEndingOffset??0)*e;a._pattern=new y.DashPattern;
a._pattern.init(h.dashTemplate,!0);a._pattern.scale(e);return a}n._inherits(g,k);var b=n._createSuper(g);g.prototype.processPath=function(a){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[a]};if(!this.iteratePath){var h=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case z.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case z.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());
break;case z.LineDashEnding.NoConstraint:this.isClosed||(h=!1);break;case z.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var e=this._walker.calculatePathLength(a);if(this._pattern.isEmpty()||e<.1*this._pattern.length()||!this._walker.init(a,this._pattern,h))return{paths:[a]}}if(this.iteratePath)a=this._pattern.nextValue();else{switch(this._endings){default:h=.5*this._pattern.firstValue();break;case z.LineDashEnding.HalfGap:h=.5*-this._pattern.lastValue();break;
case z.LineDashEnding.FullGap:h=-this._pattern.lastValue();break;case z.LineDashEnding.FullPattern:h=0;break;case z.LineDashEnding.NoConstraint:case z.LineDashEnding.Custom:h=-this._customDashPos}a=h/this._pattern.length();a-=Math.floor(a);h=a*this._pattern.length();this._pattern.reset();a=this._pattern.nextValue();for(e=!1;h>=a;)h-=a,a=this._pattern.nextValue(),e=!e;a-=h;e?(this._walker.nextPosition(a),a=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(a),a=this._pattern.nextValue(),
this._walker.nextPosition(a),a=this._pattern.nextValue())}(h=this._walker.nextCurve(a))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),F.PathHelper.mergePath(h,this._firstCurve),this._firstCurve=null)):(a=this._pattern.nextValue(),!this._walker.nextPosition(a)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(h=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,h=this._firstCurve,this._firstCurve=null);
return{paths:[h]}};return n._createClass(g)}(G.PathGeometryCursor);q.EffectDashes=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(q,n,G,F){let z=function(){function k(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var g=k.prototype;g.isEmpty=function(){return 0===this._values.length};g.size=function(){return this._values.length};
g.init=function(b,a,h=!0){this._setEmpty();if(!b||0===b.length)return!1;for(let e=0;e<b.length;e++){let f=Math.abs(b[e]);h&&1E-7>f&&(f=1E-7);this._values.push(f);this._length+=f}a&&b.length&1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};g.scale=function(b){const a=this._values?this._values.length:0;for(let h=0;h<a;++h)this._values[h]*=b;this._length*=b;this.extPtGap*=b;this.ctrlPtGap*=b};g.addValue=function(b){this._length+=b;this._values.push(b)};
g.firstValue=function(){return this._values[0]};g.lastValue=function(){return this._values[this._values.length-1]};g.nextValue=function(){this._currentValue++;this._currentValue===this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};g.reset=function(){this._currentValue=-1};g.length=function(){return this._length};g._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return n._createClass(k)}(),y=n._createClass(function(){this.pt=
null;this.sa=this.ca=0});q.EndType=void 0;(function(k){k[k.FAIL=0]="FAIL";k[k.END=1]="END";k[k.CONTINUE=2]="CONTINUE"})(q.EndType||(q.EndType={}));let D=function(){function k(){this.reset()}var g=k.prototype;g.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};g.isValid=function(){return-1!==this.segment};g.copyTo=function(b){b.segment=this.segment;b.segmentLength=this.segmentLength;b.abscissa=this.abscissa;b.isPathEnd=this.isPathEnd;b.isPartEnd=
this.isPartEnd};return n._createClass(k)}(),x=function(k){function g(a=0,h=!1){a=b.call(this,a,h);a._tolerance=F.PIXEL_TOLERANCE;a._currentPosition=new D;return a}n._inherits(g,k);var b=n._createSuper(g);k=g.prototype;k.updateTolerance=function(a){this._tolerance=F.PIXEL_TOLERANCE*a};k.init=function(a,h,e=!0){e?(this._patternLength=h.length(),this._partExtPtGap=h.extPtGap,this._partCtrlPtGap=h.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=
0;this._path=a;this._seg=-1;return this._setPosAtNextPart()};k.curPositionIsValid=function(){return this._currentPosition.isValid()};k.nextPosition=function(a,h=q.EndType.FAIL){const e=new D;if(!this._nextPosition(a,e,null,h))return!1;e.copyTo(this._currentPosition);return!0};k.curPointAndAngle=function(a){a.pt=this._getPoint(this._currentPosition);const [h,e]=this._getAngle(this._currentPosition);a.ca=h;a.sa=e};k.nextPointAndAngle=function(a,h,e=q.EndType.FAIL){const f=new D;if(!this._nextPosition(a,
f,null,e))return!1;f.copyTo(this._currentPosition);h.pt=this._getPoint(f);const [c,d]=this._getAngle(f);h.ca=c;h.sa=d;return!0};k.nextCurve=function(a){if(0===a)return null;const h=[],e=new D;if(!this._nextPosition(a,e,h,q.EndType.END))return null;e.copyTo(this._currentPosition);return h};k.isPathEnd=function(){return this._currentPosition.isPathEnd};k.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};k._nextPosition=
function(a,h,e,f){if(this._currentPosition.isPathEnd)return!1;var c=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(c/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(h);h.abscissa+a*this._partLengthRatio>h.segmentLength+this._tolerance;)if(e&&(0===e.length&&(0===c?(c=this._path[h.segment],e.push([c[0],c[1]])):e.push(this.getSegCoord2D(this._path,h.segment,c))),c=this._path[h.segment+1],e.push([c[0],c[1]])),c=0,a-=(h.segmentLength-h.abscissa)/this._partLengthRatio,
this._partSegCount)h.segment=this._nextSegment(),h.segmentLength=this.calculateSegLength(this._path,h.segment),h.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(f===q.EndType.FAIL)return!1;h.segmentLength=this.calculateSegLength(this._path,h.segment);h.isPartEnd=!0;f===q.EndType.END?(h.abscissa=h.segmentLength,h.isPathEnd=!0):h.abscissa=h.segmentLength+a;return!0}this._currentPosition.copyTo(h)}h.abscissa+=a*this._partLengthRatio;e&&(0===e.length&&(0===c?(a=this._path[h.segment],
e.push([a[0],a[1]])):e.push(this.getSegCoord2D(this._path,h.segment,c))),a=h.abscissa/h.segmentLength,1===a?(a=this._path[h.segment+1],e.push([a[0],a[1]])):e.push(this.getSegCoord2D(this._path,h.segment,a)));!this._partSegCount&&Math.abs(h.abscissa-h.segmentLength)<this._tolerance&&(h.isPathEnd=this._partIsLast,h.isPartEnd=!0);return!0};k._getPoint=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};
k._getAngle=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};k._setPosAtNextPart=function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,
1===G.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var a=this._partSegCount;a;)this._previousSegment(),--a;this._currentPosition.segment=this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;a=this._getStartPointIndex();this._ctrlPtBegin=1===G.getId(this._path[a]);
a=a+this._partSegCount+1;a>=this._path.length&&(a=0);this._ctrlPtEnd=1===G.getId(this._path[a]);if(0<this._patternLength){a=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const h=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let e=Math.round((this._partLength-(a+h))/this._patternLength);0>=e&&(e=0<a+h?0:1);this._partLengthRatio=this._partLength/(a+h+e*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};k._hasNextSegment=
function(){return this._seg<this._path.length-2};k._previousSegment=function(){return--this._seg};k._nextSegment=function(){return++this._seg};k._getStartPointIndex=function(){return this._seg};k._getEndPointIndex=function(){return this._seg+1};return n._createClass(g)}(F.CurveHelper);q.DashPattern=z;q.GeometryWalker=x;q.Pos=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectDonut":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../enums ../../../geometry/SpatialReference".split(" "),
function(q,n,G,F,z,y,D,x){G=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(b,a,h,e,f){return new k(b,a,h,e,f)};return n._createClass(g)}();G.instance=null;let k=function(){function g(b,a,h,e,f){this._inputGeometries=b;this._tileKey=e;this._geometryEngine=f;this._width=(void 0!==a.width?a.width:2)*h;this._option=a.option}g.prototype.next=function(){let b;for(;b=this._inputGeometries.next();){if(z.isExtent(b)&&0<this._width){if(0>
Math.min(b.xmax-b.xmin,b.ymax-b.ymin)-2*this._width)return b;var a=[];a.push([[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]);a.push([[b.xmin+this._width,b.ymin+this._width],[b.xmax-this._width,b.ymin+this._width],[b.xmax-this._width,b.ymax-this._width],[b.xmin+this._width,b.ymax-this._width],[b.xmin+this._width,b.ymin+this._width]]);return{rings:a}}if(z.isPolygon(b)){a=null;var h=this._geometryEngine;let e=b;if(this._tileKey&&(e=y.clipPolygonToTileExtent(b,Math.abs(this._width)+
1),!e||!e.rings||0===e.rings.length))continue;F.isSome(h)&&(a=h.buffer(x.WebMercator,e,-this._width,1));if(0<this._width){h=[];for(const f of b.rings)f&&h.push(f);if(a)for(const f of a.rings)f&&h.push(f.reverse());if(h.length)return{rings:h}}}}return null};return n._createClass(g)}();q.EffectDonut=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],
function(q,n,G,F){let z=function(){function D(){}D.local=function(){null===D.instance&&(D.instance=new D);return D.instance};D.prototype.execute=function(x,k,g,b,a){return new y(x,k,g)};return n._createClass(D)}();z.instance=null;let y=function(D){function x(g,b,a){g=k.call(this,g,!1,!0);g._curveHelper=new F.CurveHelper;g._length=(void 0!==b.length?b.length:20)*a;g._angle=void 0!==b.angle?b.angle:225;g._position=void 0!==b.position?b.position:50;0>g._length&&(g._length=-g._length);20>g._position&&
(g._position=20);80<g._position&&(g._position=80);g._mirror=!1;return g}n._inherits(x,D);var k=n._createSuper(x);x.prototype.processPath=function(g){if(this._curveHelper.isEmpty(g,!1))return null;const b=g[0];g=g[g.length-1];this._curveHelper.normalize([g[0]-b[0],g[1]-b[1]]);const a=[b[0]+(g[0]-b[0])*this._position/100,b[1]+(g[1]-b[1])*this._position/100],h=Math.cos((90-this._angle)/180*Math.PI);let e=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(e=-e);this._mirror=!this._mirror;return{paths:[[b,
[a[0]-this._length/2*h,a[1]-this._length/2*e],[a[0]+this._length/2*h,a[1]+this._length/2*e],g]]}};return n._createClass(x)}(G.PathGeometryCursor);q.EffectJog=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/lang","../../../geometry/support/jsonUtils"],function(q,n,G,F){let z=function(){function D(){}D.local=function(){null===D.instance&&(D.instance=new D);
return D.instance};D.prototype.execute=function(x,k,g,b,a){return new y(x,k,g)};return n._createClass(D)}();z.instance=null;let y=function(){function D(k,g,b){this._inputGeometries=k;this._offsetX=void 0!==g.offsetX?g.offsetX*b:0;this._offsetY=void 0!==g.offsetY?-g.offsetY*b:0}var x=D.prototype;x.next=function(){for(var k=this._inputGeometries.next();k;){if(F.isExtent(k))return{xmin:k.xmin+this._offsetX,xmax:k.xmax+this._offsetX,ymin:k.ymin+this._offsetY,ymax:k.ymax+this._offsetY};if(F.isPolygon(k))return k=
G.clone(k),this._moveMultipath(k.rings,this._offsetX,this._offsetY),k;if(F.isPolyline(k))return k=G.clone(k),this._moveMultipath(k.paths,this._offsetX,this._offsetY),k;if(F.isMultipoint(k))return k=G.clone(k),this._movePath(k.points,this._offsetX,this._offsetY),k;if(F.isPoint(k))return{x:k.x+this._offsetX,y:k.y+this._offsetY};k=this._inputGeometries.next()}return null};x._moveMultipath=function(k,g,b){if(k)for(const a of k)this._movePath(a,g,b)};x._movePath=function(k,g,b){if(k)for(const a of k)a[0]+=
g,a[1]+=b};return n._createClass(D)}();q.EffectMove=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectOffset":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../CurveHelper ../enums ../../../geometry/SpatialReference".split(" "),function(q,n,G,F,z,y,D,x,k){G=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};
b.prototype.execute=function(a,h,e,f,c){return new g(a,h,e,f,c)};return n._createClass(b)}();G.instance=null;let g=function(){function b(a,h,e,f,c){this._inputGeometries=a;this._tileKey=f;this._geometryEngine=c;this._curveHelper=new D.CurveHelper;this._offset=(h.offset??1)*e;this._method=h.method;this._option=h.option;this._offsetFlattenError=D.PIXEL_TOLERANCE*e}b.prototype.next=function(){for(var a;a=this._inputGeometries.next();){if(0===this._offset)return a;if(z.isExtent(a)){if(this._method===
x.GeometricEffectOffsetMethod.Rounded&&0<this._offset)return(a=this._curveHelper.offset([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]],-this._offset,this._method,4,this._offsetFlattenError))?{rings:[a]}:null;if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._offset)return{xmin:a.xmin-this._offset,xmax:a.xmax+this._offset,ymin:a.ymin-this._offset,ymax:a.ymax+this._offset}}const h=this._geometryEngine;if(F.isNone(h))break;let e=a;if(z.isPolygon(a)){if(this._tileKey&&
(e=y.clipPolygonToTileExtent(a,Math.abs(this._offset)+1),!e||!e.rings||0===e.rings.length))continue}else if(z.isPolyline(a)&&this._tileKey&&(e=y.clipPolylineToTileExtent(a,Math.abs(this._offset)+1),!e||!e.paths||0===e.paths.length))continue;return h.offset(k.WebMercator,e,-this._offset,1,this._method,4,this._offsetFlattenError)}return null};return n._createClass(b)}();q.EffectOffset=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(q,n,G,F,z){let y=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(k,g,b,a,h){return new D(k,g,b)};return n._createClass(x)}();y.instance=null;let D=function(){function x(k,g,b){this._inputGeometries=k;this._reverse=void 0!==g.reverse?g.reverse:!0}x.prototype.next=function(){for(var k=this._inputGeometries.next();k;){if(!this._reverse)return k;
if(F.isPolyline(k))return k=G.clone(k),z.reverseMultipath(k.paths),k;k=this._inputGeometries.next()}return null};return n._createClass(x)}();q.EffectReverse=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectRotate":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),function(q,n,G,F,z,y){let D=
function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,b,a,h,e){return new x(g,b,a)};return n._createClass(k)}();D.instance=null;let x=function(){function k(b,a,h){this._inputGeometries=b;this._rotateAngle=void 0!==a.angle?a.angle*Math.PI/180:0}var g=k.prototype;g.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._rotateAngle)return b;var a=F.create();z.getBoundsXY(a,b);const h=(a[2]+a[0])/2;a=(a[3]+
a[1])/2;if(y.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._rotateMultipath(b.rings,h,a),b;if(y.isPolygon(b))return b=G.clone(b),this._rotateMultipath(b.rings,h,a),b;if(y.isPolyline(b))return b=G.clone(b),this._rotateMultipath(b.paths,h,a),b;if(y.isMultipoint(b))return b=G.clone(b),this._rotatePath(b.points,h,a),b;if(y.isPoint(b))return b;b=this._inputGeometries.next()}return null};g._rotateMultipath=function(b,a,h){if(b)for(const e of b)this._rotatePath(e,
a,h)};g._rotatePath=function(b,a,h){if(b){const e=Math.cos(this._rotateAngle),f=Math.sin(this._rotateAngle);for(const c of b){b=c[0]-a;const d=c[1]-h;c[0]=a+b*e-d*f;c[1]=h+b*f+d*e}}};return n._createClass(k)}();q.EffectRotate=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectScale":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),
function(q,n,G,F,z,y){let D=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,b,a,h,e){return new x(g,b,a)};return n._createClass(k)}();D.instance=null;let x=function(){function k(b,a,h){this._inputGeometries=b;this._xFactor=void 0!==a.xScaleFactor?a.xScaleFactor:1.15;this._yFactor=void 0!==a.yScaleFactor?a.yScaleFactor:1.15}var g=k.prototype;g.next=function(){for(var b=this._inputGeometries.next();b;){if(1===this._xFactor&&
1===this._yFactor)return b;var a=F.create();z.getBoundsXY(a,b);const h=(a[2]+a[0])/2;a=(a[3]+a[1])/2;if(y.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._scaleMultipath(b.rings,h,a),b;if(y.isPolygon(b))return b=G.clone(b),this._scaleMultipath(b.rings,h,a),b;if(y.isPolyline(b))return b=G.clone(b),this._scaleMultipath(b.paths,h,a),b;if(y.isMultipoint(b))return b=G.clone(b),this._scalePath(b.points,h,a),b;if(y.isPoint(b))return b;
b=this._inputGeometries.next()}return null};g._scaleMultipath=function(b,a,h){if(b)for(const e of b)this._scalePath(e,a,h)};g._scalePath=function(b,a,h){if(b)for(const e of b)b=(e[1]-h)*this._yFactor,e[0]=a+(e[0]-a)*this._xFactor,e[1]=h+b};return n._createClass(k)}();q.EffectScale=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectWave":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/jsonUtils ../CurveHelper ../enums ../GeometryWalker".split(" "),
function(q,n,G,F,z,y){let D=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,b,a,h,e){return new x(g,b,a)};return n._createClass(k)}();D.instance=null;let x=function(){function k(b,a,h){this._inputGeometries=b;this._height=(void 0!==a.amplitude?a.amplitude:2)*h;this._period=(void 0!==a.period?a.period:3)*h;this._style=a.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));
this._pattern=new y.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new y.GeometryWalker;this._walker.updateTolerance(h)}var g=k.prototype;g.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._height||0===this._period)return b;if(G.isPolyline(b)){const a=this._processGeom(b.paths);if(a.length)return{paths:a}}if(G.isPolygon(b)&&(b=this._processGeom(b.rings),b.length))return{rings:b};b=this._inputGeometries.next()}return null};g._processGeom=
function(b){const a=[];for(const h of b)if(this._walker.init(h,this._pattern))switch(this._style){default:a.push(this._constructCurve(h,!1));break;case z.GeometricEffectWaveform.Square:a.push(this._constructSquare(h));break;case z.GeometricEffectWaveform.Triangle:a.push(this._constructTriangle(h));break;case z.GeometricEffectWaveform.Random:a.push(this._constructCurve(h,!0))}else a.push(h);return a};g._constructCurve=function(b,a){const h=new F.PathHelper;var e=this._walker.calculatePathLength(b),
f=Math.round(e/this._period);0===f&&(f=1);const c=this._period/16,d=1/(16*f+1);e=2*Math.PI*e/(e/f);f=2*Math.PI*Math.random();const p=2*Math.PI*Math.random(),v=2*Math.PI*Math.random(),l=.75-Math.random()/2,u=.75-Math.random()/2,r=new y.Pos;this._walker.curPointAndAngle(r);h.startPath(r.pt);let A=0;for(;;)if(this._walker.nextPointAndAngle(c,r)){const w=A;A+=d;let m;if(a){const t=this._height/2*(1+.3*Math.sin(l*e*w+f));m=t*Math.sin(e*w+p);m+=t*Math.sin(u*e*w+v);m/=2}else m=.5*this._height*Math.sin(.5*
e*w);h.lineTo([r.pt[0]-m*r.sa,r.pt[1]+m*r.ca])}else{h.lineTo(b[b.length-1]);break}return h.path()};g._constructSquare=function(b){const a=new F.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let h=!1;if(this._walker.curPositionIsValid()){const e=new y.Pos;this._walker.curPointAndAngle(e);const f=new y.Pos;if(this._walker.nextPointAndAngle(this._period,f)){const c=new y.Pos;this._walker.nextPointAndAngle(this._period,c)&&(b?(a.startPath(e.pt),b=!1):a.lineTo(e.pt),
a.lineTo([e.pt[0]-this._height/2*e.sa,e.pt[1]+this._height/2*e.ca]),a.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),a.lineTo([f.pt[0]+this._height/2*f.sa,f.pt[1]-this._height/2*f.ca]),a.lineTo([c.pt[0]+this._height/2*c.sa,c.pt[1]-this._height/2*c.ca]),h=!0)}}if(!h){a.lineTo(this._walker.getPathEnd());break}}return a.path()};g._constructTriangle=function(b){const a=new F.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let h=!1;if(this._walker.curPositionIsValid()){const e=
new y.Pos;this._walker.curPointAndAngle(e);const f=new y.Pos;if(this._walker.nextPointAndAngle(this._period/2,f)){const c=new y.Pos;this._walker.nextPointAndAngle(this._period,c)&&(this._walker.nextPosition(this._period/2)&&(b?(a.startPath(e.pt),b=!1):a.lineTo(e.pt),a.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),a.lineTo([c.pt[0]+this._height/2*c.sa,c.pt[1]-this._height/2*c.ca])),h=!0)}}if(!h){a.lineTo(this._walker.getPathEnd());break}}return a.path()};return n._createClass(k)}();
q.EffectWave=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/geometryCursorCollectUtils ../CIMCursor ../enums ../GeometryWalker".split(" "),function(q,n,G,F,z,y){let D=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,b,a,h,e){return new x(g,b,a)};return n._createClass(k)}();
D.instance=null;let x=function(k){function g(a,h,e){a=b.call(this,a);a._geometryWalker=new y.GeometryWalker;a._geometryWalker.updateTolerance(e);a._angleToLine=h.angleToLine??!0;a._offset=(h.offset?h.offset:0)*e;a._originalEndings=h.endings;a._offsetAtEnd=(h.customEndingOffset?h.customEndingOffset:0)*e;a._position=-(h.offsetAlongLine?h.offsetAlongLine:0)*e;a._pattern=new y.DashPattern;a._pattern.init(h.placementTemplate,!1);a._pattern.scale(e);a._endings=a._originalEndings;return a}n._inherits(g,
k);var b=n._createSuper(g);k=g.prototype;k.processPath=function(a){if(this._pattern.isEmpty())return null;if(this.iteratePath)var h=this._pattern.nextValue();else{this._endings=this._originalEndings===z.PlacementEndings.WithFullGap&&this.isClosed?z.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;var e=!0;switch(this._endings){case z.PlacementEndings.NoConstraint:h=-this._position;h=this._adjustPosition(h);e=!1;break;default:h=-this._pattern.lastValue()/2;break;case z.PlacementEndings.WithFullGap:h=
-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case z.PlacementEndings.WithMarkers:h=0;break;case z.PlacementEndings.Custom:h=-this._position,h=this._adjustPosition(h),this._pattern.extPtGap=.5*this._offsetAtEnd}a=G.collectRing(a);if(!this._geometryWalker.init(a,this._pattern,e))return null;this._pattern.reset();for(e=0;h>e;)h-=e,e=this._pattern.nextValue();h=e-h;this.iteratePath=!0}e=new y.Pos;if(!this._geometryWalker.nextPointAndAngle(h,e)||this._endings===z.PlacementEndings.WithFullGap&&
this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===z.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(e.pt[0]-this._offset*e.sa,e.pt[1]+this._offset*e.ca);this._angleToLine&&this.internalPlacement.setRotateCS(e.ca,e.sa);return this.internalPlacement};k._adjustPosition=function(a){a/=this._pattern.length();a-=Math.floor(a);return a*this._pattern.length()};return n._createClass(g)}(F.PathTransformationCursor);
q.PlacementAlongLineSameSize=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(q,n,G,F,z){let y=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(k,g,b,a,h){return new D(k,g,b)};return n._createClass(x)}();y.instance=null;let D=
function(x){function k(b,a,h){b=g.call(this,b,!1,!0);b._curveHelper=new F.CurveHelper;b._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*h:0;b._type=a.extremityPlacement;b._position=void 0!==a.offsetAlongLine?a.offsetAlongLine*h:0;b._beginProcessed=!1;return b}n._inherits(k,x);var g=n._createSuper(k);x=k.prototype;x.processPath=function(b){let a;switch(this._type){default:this._beginProcessed?(a=this._atExtremities(b,this._position,!1),this.iteratePath=this._beginProcessed=
!1):(a=this._atExtremities(b,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case z.ExtremityPlacement.JustBegin:a=this._atExtremities(b,this._position,!0);break;case z.ExtremityPlacement.JustEnd:a=this._atExtremities(b,this._position,!1);case z.ExtremityPlacement.None:}return a};x._atExtremities=function(b,a,h){h||b.seekPathEnd();if(h?b.nextPoint():b.prevPoint()){let f=0;var e=[0,0];const c=[b.x,b.y];for(;h?b.nextPoint():b.prevPoint();){e[0]=c[0];e[1]=c[1];c[0]=b.x;c[1]=b.y;const d=
this._curveHelper.calculateLength(e,c);if(f+d>a){b=(a-f)/d;const [p,v]=this._curveHelper.getAngleCS(e,c,b);e=G.getCoord2D(e,c,b);this.internalPlacement.setTranslate(e[0]-this._offset*v,e[1]+this._offset*p);this._angleToLine&&this.internalPlacement.setRotateCS(-p,-v);return this.internalPlacement}f+=d}}return null};return n._createClass(k)}(G.PathTransformationCursor);q.PlacementAtExtremities=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../../../geometry/geometryCursorCollectUtils","../CIMCursor","../GeometryWalker"],function(q,n,G,F,z){let y=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(k,g,b,a,h){return new D(k,g,b)};return n._createClass(x)}();y.instance=null;let D=function(x){function k(b,a,h){b=g.call(this,b);b._walker=new z.GeometryWalker;b._walker.updateTolerance(h);b._angleToLine=void 0!==a.angleToLine?
a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*h:0;b._beginGap=void 0!==a.beginPosition?a.beginPosition*h:0;b._endGap=void 0!==a.endPosition?a.endPosition*h:0;b._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;b._pattern=new z.DashPattern;b._pattern.init(a.positionArray,!1,!1);b._subPathLen=0;b._posCount=b._pattern.size();b._isFirst=!0;b._prevPos=0;return b}n._inherits(k,x);var g=n._createSuper(k);k.prototype.processPath=function(b){if(this._pattern.isEmpty())return null;if(this.iteratePath){b=
this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+b;b=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;b=G.collectRing(b);this._subPathLen=this._walker.calculatePathLength(b)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(b,this._pattern,!1))return null;this._pattern.reset();b=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+b;b=a-this._prevPos;this._prevPos=a;
this.iteratePath=!0}a=new z.Pos;if(!this._walker.nextPointAndAngle(b,a,z.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca);b=this._isFirst&&this._flipFirst;let h;this._angleToLine?(h=a.ca,a=a.sa):(h=1,a=0);b&&(h=-h,a=-a);this.internalPlacement.setRotateCS(h,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return n._createClass(k)}(F.PathTransformationCursor);
q.PlacementAtRatioPositions=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/RandomLCG ../CIMPlacements ../enums".split(" "),function(q,n,G,F,z,y){let D=function(){function k(){}k.local=function(){null===k.instance&&(k.instance=new k);return k.instance};k.prototype.execute=function(g,b,a,h,e){return new x(g,b,a,h,e)};return n._createClass(k)}();
D.instance=null;let x=function(){function k(b,a,h,e,f){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._accelerationMap=null;this._testInsidePolygon=!1;this._verticalSubdivision=!0;this._stepX=Math.abs(a.stepX??16)*h;this._stepY=Math.abs(a.stepY??16)*h;if(0!==this._stepX&&0!==this._stepY){this._gridType=a.gridType??y.PlacementGridType.Fixed;if(this._gridType===y.PlacementGridType.Random)this._randomLCG=new F(1*(a.seed??13)),this._randomness=(a.randomness??100)/100,
this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0,this._buildRandomValues();else{this._randomness=0;this._gridAngle=a.gridAngle??0;this._shiftOddRows=a.shiftOddRows??!1;this._offsetX=(a.offsetX??0)*h;this._offsetY=(a.offsetY??0)*h;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=
.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;if(null!=e){const [,c,d]=e.split("/");a=parseFloat(c);this._graphicOriginX=512*-parseFloat(d);this._graphicOriginY=512*a;this._testInsidePolygon=!0}this._internalPlacement=new z.Placement;this._calculateMinMax(b);this._geometryCursor=b}}var g=k.prototype;
g.next=function(){return this._geometryCursor?this._nextInside():null};g._buildRandomValues=function(){if(!k._randValues){k._randValues=[];for(let b=0;24>b;b++)for(let a=0;24>a;a++)k._randValues.push(this._randomLCG.getFloat()),k._randValues.push(this._randomLCG.getFloat())}};g._calculateMinMax=function(b){this._yMax=this._yMin=this._xMax=this._xMin=0;let a,h,e,f,c,d,p,v;a=h=p=c=Number.MAX_VALUE;e=f=v=d=-Number.MAX_VALUE;var l=1!==this._cosAngle;for(b.reset();b.nextPath();)for(;b.nextPoint();){var u=
b.x;var r=b.y;var A=u-this._graphicOriginX-this._offsetX;var w=r-this._graphicOriginY-this._offsetY;if(l){var m=this._cosAngle*A-this._sinAngle*w;A=this._sinAngle*A+this._cosAngle*w}else m=A,A=w;a=Math.min(a,m);e=Math.max(e,m);h=Math.min(h,A);f=Math.max(f,A);c=Math.min(c,r);d=Math.max(d,r);p=Math.min(p,u);v=Math.max(v,u)}c=c!==Number.MAX_VALUE?c:-512-this._stepY;d=d!==-Number.MAX_VALUE?d:this._stepY;p=p!==Number.MAX_VALUE?p:-this._stepX;v=v!==-Number.MAX_VALUE?v:512+this._stepX;this._polygonMin=(this._verticalSubdivision=
d-c>=v-p)?c:p;if(this._testInsidePolygon){m=0-this._graphicOriginX-this._offsetX-this._stepX;r=512-this._graphicOriginX-this._offsetX+this._stepX;u=-512-this._graphicOriginY-this._offsetY-this._stepY;A=0-this._graphicOriginY-this._offsetY+this._stepY;if(l){l=[[m,u],[m,A],[r,u],[r,A]];m=u=Number.MAX_VALUE;r=A=-Number.MAX_VALUE;for(const t of l)l=this._cosAngle*t[0]-this._sinAngle*t[1],w=this._sinAngle*t[0]+this._cosAngle*t[1],m=Math.min(m,l),r=Math.max(r,l),u=Math.min(u,w),A=Math.max(A,w)}a=a!==Number.MAX_VALUE?
Math.max(a,m):m;h=h!==Number.MAX_VALUE?Math.max(h,u):u;e=e!==-Number.MAX_VALUE?Math.min(e,r):r;f=f!==-Number.MAX_VALUE?Math.min(f,A):A}this._xMin=Math.round(a/this._stepX);this._xMax=Math.round(e/this._stepX);this._yMin=Math.round(h/this._stepY);this._yMax=Math.round(f/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1;this._buildAccelerationMap(b,p,v,c,d)};g._buildAccelerationMap=function(b,a,h,e,f){b.reset();const c=new Map,d=this._verticalSubdivision;h=d?f-e:h-a;f=Math.ceil(h/
10);if(!(1>=f)){h=Math.floor(h/f);f++;this._delta=h;var p,v;if(d){f=-512-this._stepY;var l=this._stepY;var u=e}else f=-this._stepX,l=512+this._stepX,u=a;for(;b.nextPath();)if(!(2>b.numPoints)&&b.nextPoint()){var r=b.x;for(p=b.y;b.nextPoint();r=a,p=e){a=b.x;e=b.y;if(d){if(p===e||p<f&&e<f||p>l&&e>l)continue;var A=Math.min(p,e);var w=Math.max(p,e)}else{if(r===a||r<f&&a<f||r>l&&a>l)continue;A=Math.min(r,a);w=Math.max(r,a)}for(;A<w;){var m=v=Math.floor((A-u)/h),t=r,B=p,J=a,C=e,K=c;let E=K.get(m);E||(E=
[],K.set(m,E));E.push([[t,B],[J,C]]);A+=h}A=Math.floor((w-u)/h);A>v&&(w=a,m=e,t=c,B=t.get(A),B||(B=[],t.set(A,B)),B.push([[r,p],[w,m]]))}}this._accelerationMap=c}};g._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var b=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(b+=.5*this._stepX);const a=this._currentY*this._stepY+
this._offsetY;this._currentX++;let h;if(this._gridType===y.PlacementGridType.Random){const e=(this._currentX%24+24)%24,f=(this._currentY%24+24)%24;h=this._graphicOriginX+b+this._stepX*this._randomness*(.5-k._randValues[24*f+e])*2/3;b=this._graphicOriginY+a+this._stepY*this._randomness*(.5-k._randValues[24*f+e+1])*2/3}else h=this._graphicOriginX+this._cosAngle*b+this._sinAngle*a,b=this._graphicOriginY-this._sinAngle*b+this._cosAngle*a;if(!this._testInsidePolygon||this._isInsidePolygon(h,b,this._geometryCursor))return this._internalPlacement.setTranslate(h,
b),this._internalPlacement}};g._isInsidePolygon=function(b,a,h){if(G.isNone(this._accelerationMap)){var e=0,f;let p;for(h.reset();h.nextPath();)if(h.nextPoint()){var c=h.x;for(f=h.y;h.nextPoint();c=d,f=p){var d=h.x;p=h.y;f>a!==p>a&&(0<(d-c)*(a-f)-(p-f)*(b-c)?e++:e--)}}return 0!==e}h=this._verticalSubdivision;f=this._accelerationMap.get(Math.floor(((h?a:b)-this._polygonMin)/this._delta));if(!f)return!1;c=0;for(e of f){f=e[0];d=e[1];if(h){if(f[1]>a===d[1]>a)continue;f=(d[0]-f[0])*(a-f[1])-(d[1]-f[1])*
(b-f[0])}else{if(f[0]>b===d[0]>b)continue;f=(d[1]-f[1])*(b-f[0])-(d[0]-f[0])*(a-f[1])}0<f?c++:c--}return 0!==c};return n._createClass(k)}();q.PlacementInsidePolygon=D;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(q,n,G,F,z){let y=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);
return x.instance};x.prototype.execute=function(k,g,b,a,h){return new D(k,g,b)};return n._createClass(x)}();y.instance=null;let D=function(x){function k(b,a,h){b=g.call(this,b);b._curveHelper=new F.CurveHelper;b._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*h:0;b._relativeTo=a.relativeTo;b._position=void 0!==a.startPointOffset?a.startPointOffset*h:0;b._epsilon=.001*h;return b}n._inherits(k,x);var g=n._createSuper(k);x=k.prototype;x.processPath=function(b){var a=
this._position;if(this._relativeTo===z.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||(this.iteratePath=!0);if(b.nextPoint()){a=[b.x,b.y];const h=[0,0];for(;b.nextPoint();){h[0]=b.x;h[1]=b.y;const e=this._curveHelper.calculateLength(a,h);if(e<this._epsilon){a[0]=h[0];a[1]=h[1];continue}b=.5+this._position/e;const [f,c]=this._curveHelper.getAngleCS(a,h,b);b=G.getCoord2D(a,h,b);this.internalPlacement.setTranslate(b[0]-this._offset*c,b[1]+this._offset*f);this._angleToLine&&this.internalPlacement.setRotateCS(f,
c);return this.internalPlacement}}this.iteratePath=!1;return null}return this.onLine(b,a,this._relativeTo===z.PlacementOnLineRelativeTo.LineEnd)};x.onLine=function(b,a,h){let e,f=!1;switch(this._relativeTo){default:b.seekPathFront();e=b.pathLength()/2+a;break;case z.PlacementOnLineRelativeTo.LineBeginning:e=a;break;case z.PlacementOnLineRelativeTo.LineEnd:e=a,f=!0}h?b.seekPathEnd():b.seekPathFront();let c=0;if(h?b.prevPoint():b.nextPoint()){a=[b.x,b.y];const d=[0,0];for(;h?b.prevPoint():b.nextPoint();){d[0]=
b.x;d[1]=b.y;const p=this._curveHelper.calculateLength(a,d);if(c+p>e){b=(e-c)/p;const [v,l]=this._curveHelper.getAngleCS(a,d,b);b=G.getCoord2D(a,d,b);h=f?-this._offset:this._offset;this.internalPlacement.setTranslate(b[0]-h*l,b[1]+h*v);this._angleToLine&&(f?this.internalPlacement.setRotateCS(-v,-l):this.internalPlacement.setRotateCS(v,l));return this.internalPlacement}a[0]=d[0];a[1]=d[1];c+=p}}return null};return n._createClass(k)}(G.PathTransformationCursor);q.PlacementOnLine=y;Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(q,n,G,F){function z(x,k){const g=Math.PI;for(;Math.abs(k-x)>g+2E-15;)k=k-x>g?k-2*g:k+2*g;return(x+k)/2}let y=function(){function x(){}x.local=function(){null===x.instance&&(x.instance=new x);return x.instance};x.prototype.execute=function(k,g,b,a,h){return new D(k,g,b)};return n._createClass(x)}();
y.instance=null;let D=function(x){function k(b,a,h){b=g.call(this,b);b._curveHelper=new F.CurveHelper;b._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*h:0;b._endPoints=void 0!==a.placeOnEndPoints?a.placeOnEndPoints:!0;b._controlPoints=void 0!==a.placeOnControlPoints?a.placeOnControlPoints:!0;b._regularVertices=void 0!==a.placeOnRegularVertices?a.placeOnRegularVertices:!0;b._tags=[];b._tagIterator=0;return b}n._inherits(k,x);var g=n._createSuper(k);x=k.prototype;
x.processPath=function(b){this.iteratePath||(this._preparePath(b),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;b=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(b[2]);let a=b[0],h=b[1];if(0!==this._offset){const e=Math.cos(b[2]);a-=this._offset*Math.sin(b[2]);h+=this._offset*e}this.internalPlacement.setTranslate(a,h);this._tagIterator++;return this.internalPlacement};x._preparePath=
function(b){this._tagIterator=this._tags.length=0;b.seekPathFront();if(b.nextPoint()){var a=b.x;var h=b.y;b.seekPathEnd();if(b.prevPoint()){var e=b.y;a=a===b.x&&h===e}else a=!1}else a=!1;let f=e=h=0,c=0;b.seekPathFront();if(b.nextPoint()){var d=b.x;let v=b.y,l=b.id,u=!0;for(var p=b.nextPoint();p;){const r=b.x,A=b.y,w=b.id;p=[d,v];d=[r,A];if(this._angleToLine||0!==this._offset)f=this._curveHelper.getAngle(p,d,0);u?(u=!1,a?(h=f,e=l):(this._endPoints||this._controlPoints&&1===l)&&this._tags.push([p[0],
p[1],f])):1===l?this._controlPoints&&this._tags.push([p[0],p[1],z(c,f)]):this._regularVertices&&this._tags.push([p[0],p[1],z(c,f)]);if(this._angleToLine||0!==this._offset)c=this._curveHelper.getAngle(p,d,1);(p=b.nextPoint())||(a?1===w||1===e?this._controlPoints&&this._tags.push([d[0],d[1],z(c,h)]):this._regularVertices&&this._tags.push([d[0],d[1],z(c,h)]):(this._endPoints||this._controlPoints&&1===w)&&this._tags.push([d[0],d[1],c]));d=r;v=A;l=w}}this._tagIterator=0};return n._createClass(k)}(G.PathTransformationCursor);
q.PlacementOnVertices=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/has ../../../geometry/support/boundsUtils ../../../geometry/support/centroid ../../../geometry/support/labelPoint ../CIMPlacements ../enums".split(" "),function(q,n,G,F,z,y,D,x){let k=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};
b.prototype.execute=function(a,h,e,f,c){return new g(a,h,e)};return n._createClass(b)}();k.instance=null;let g=function(){function b(h,e,f){this._geometryCursor=h;this._offsetX=void 0!==e.offsetX?e.offsetX*f:0;this._offsetY=void 0!==e.offsetY?e.offsetY*f:0;this._method=void 0!==e.method?e.method:x.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new D.Placement}var a=b.prototype;a.next=function(){const h=this._geometryCursor;this._geometryCursor=null;return h?this._polygonCenter(h):
null};a._polygonCenter=function(h){let e=!1;switch(this._method){case x.PlacementPolygonCenterMethod.CenterOfMass:if(h=z.weightedAreaCentroid(h))this._internalPlacement.setTranslate(h[0]+this._offsetX,h[1]+this._offsetY),e=!0;break;case x.PlacementPolygonCenterMethod.BoundingBoxCenter:if(h=F.getBoundsXYCursor(h))this._internalPlacement.setTranslate((h[2]+h[0])/2+this._offsetX,(h[3]+h[1])/2+this._offsetY),e=!0;break;default:h=G("polylabel-placement-enabled")?y.getPolylabelPoint(h):y.labelPointAdapter(h),
null!==h&&(this._internalPlacement.setTranslate(h[0]+this._offsetX,h[1]+this._offsetY),e=!0)}return e?this._internalPlacement:null};return n._createClass(b)}();q.PlacementPolygonCenter=k;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/labelPoint":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/PriorityQueue ../geometryCursorCollectUtils ./aaBoundingRect ./boundsUtils ./centroid ./coordsUtils ./intersectsBase".split(" "),
function(q,n,G,F,z,y,D,x,k,g){function b(v){var {rings:l}=v;if(!l||0===l.length)return null;var u=D.getBoundsXY(y.create(),v);if(!u)return null;var r=8.8818E-14*(Math.abs(u[0])+Math.abs(u[2])+Math.abs(u[1])+Math.abs(u[3])+1),A=0,w=0;for(var m=0;m<l.length;m++){var t=k.getRingArea(l[m]);t>w&&(w=t,A=m)}if(Math.abs(w)<=2*r*r)return w=D.getPointsBounds(y.create(),l[A]),[(w[0]+w[2])/2,(w[1]+w[3])/2];var B=x.ringCentroid(l[A],!1,y.create());if(null===B)return null;if(1===l.length&&4>l[0].length)return B;
w=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]];m=[NaN,NaN,NaN,NaN];t=[NaN,NaN,NaN,NaN];var J=!1,C=h(B,v,!0);0===C.distance&&(J=!0,w[0][0]=B[0],w[0][1]=B[1],C=h(B,v,!1));m[0]=C.distance;t[0]=0;var K=[NaN,NaN],E=!1;let I=.25,H=-1;l=D.getPointsBounds(y.create(),l[A]);A=NaN;do if(A=NaN,C=l[0],w[1]=e(v,C+(l[2]-C)*I,r,u),isNaN(w[1][0])||isNaN(w[1][1])||(C=h(w[1],v,!1),A=C.distance),!isNaN(A)&&A>r&&a(w[1],v))E=!0,m[1]=A,t[1]=c(w[1],B);else if(!isNaN(A)&&A>H&&(H=A,K[0]=w[1][0],K[1]=w[1][1]),I-=.01,.1>I)if(0<=
H)E=!0,m[1]=H,w[1][0]=K[0],w[1][1]=K[1],t[1]=c(w[1],B);else break;while(!E);E=!1;I=.5;H=-1;let N=.01,U=1;do if(A=NaN,C=l[0],w[2]=e(v,C+(l[2]-C)*I,r,u),isNaN(w[2][0])||isNaN(w[2][1])||(C=h(w[2],v,!1),A=C.distance),!isNaN(A)&&A>r&&a(w[2],v))E=!0,m[2]=A,t[2]=c(w[2],B);else if(!isNaN(A)&&A>H)H=A,K[0]=w[2][0],K[1]=w[2][1];else if(A>H&&(H=A,K[0]=w[2][0],K[1]=w[2][1]),I=.5+N*U,N+=.01,U*=-1,.3>I||.7<I)if(0<=H)E=!0,m[2]=H,w[2][0]=K[0],w[2][1]=K[1],t[2]=c(w[2],B);else break;while(!E);E=!1;I=.75;H=-1;do if(A=
NaN,C=l[0],w[3]=e(v,C+(l[2]-C)*I,r,u),isNaN(w[3][0])||isNaN(w[3][1])||(C=h(w[3],v,!1),A=C.distance),!isNaN(A)&&A>r&&a(w[3],v))E=!0,m[3]=A,t[3]=c(w[3],B);else if(A>H&&(H=A,K[0]=w[3][0],K[1]=w[3][1]),I+=.01,.9<I)if(0<=H)E=!0,m[3]=H,w[3][0]=K[0],w[3][1]=K[1],t[3]=c(w[3],B);else break;while(!E);v=[0,1,2,3];u=J?0:1;for(J=u;4>J;J++)for(B=u;3>B;B++)K=t[B],E=t[B+1],0<d(K,E)&&(r=v[B],v[B]=v[B+1],v[B+1]=r,t[B]=E,t[B+1]=K);t=u;for(J=r=0;4>u;u++){switch(u){case 0:J=2*m[v[u]];break;case 1:J=1.66666666*m[v[u]];
break;case 2:J=1.33333333*m[v[u]];break;case 3:J=m[v[u]]}J>r&&(r=J,t=v[u])}return w[t]}function a(v,l){var {rings:u}=l;l=0;for(const r of u){u=r.length;for(let A=1;A<u;++A){const w=r[A-1],m=r[A];w[1]>v[1]!==m[1]>v[1]&&(0<(m[0]-w[0])*(v[1]-w[1])-(m[1]-w[1])*(v[0]-w[0])?l++:l--)}}return 0!==l}function h(v,l,u){if(u&&a(v,l))return{coord:v,distance:0};u=Infinity;let r=0,A=0;const w=[0,0];({rings:l}=l);for(const m of l)if(!(2>m.length))for(l=0;l<m.length-1;l++){k.projectPointOnLine(w,v,m,l);const t=c(v,
w);t<u&&(u=t,r=w[0],A=w[1])}return{coord:[r,A],distance:Math.sqrt(u)}}function e(v,l,u,r){u=[l,0];let A=Infinity,w=Infinity,m=!1,t=!1;l=[[l,r[1]-1],[l,r[3]+1]];r=[0,0];const B=[0,0],J=[0,0],C=[[0,0],[0,0]],K=y.create();({rings:v}=v);for(const N of v)if(!(2>N.length))for(v=1;v<N.length;v++){C[0][0]=N[v-1][0];C[0][1]=N[v-1][1];C[1][0]=N[v][0];C[1][1]=N[v][1];a:{var E=K;var I=C;if(2>I.length){E=null;break a}E||(E=y.create());const [U,ba]=I[0],[la,aa]=I[1];E[0]=Math.min(U,la);E[1]=Math.min(ba,aa);E[2]=
Math.max(U,la);E[3]=Math.max(ba,aa)}if(null!==E){B[0]=l[0][0];B[1]=l[0][1];J[0]=l[1][0];J[1]=l[1][1];a:{E=K;I=B;var H=J;let U=f(I,E),ba=f(H,E);const la=E[0],aa=E[1],ka=E[2],V=E[3];if(U&ba){E=0;break a}if(!(U|ba)){E=4;break a}const P=(U?1:0)|(ba?2:0);do{const S=H[0]-I[0],X=H[1]-I[1];if(S>X)U&3?(U&1?(I[1]+=X*(la-I[0])/S,I[0]=la):(I[1]+=X*(ka-I[0])/S,I[0]=ka),U=f(I,E)):ba&3?(ba&1?(H[1]+=X*(la-H[0])/S,H[0]=la):(H[1]+=X*(ka-H[0])/S,H[0]=ka),ba=f(H,E)):U?(U&4?(I[0]+=S*(aa-I[1])/X,I[1]=aa):(I[0]+=S*(V-I[1])/
X,I[1]=V),U=f(I,E)):(ba&4?(H[0]+=S*(aa-H[1])/X,H[1]=aa):(H[0]+=S*(V-H[1])/X,H[1]=V),ba=f(H,E));else if(U&12?(U&4?(I[0]+=S*(aa-I[1])/X,I[1]=aa):(I[0]+=S*(V-I[1])/X,I[1]=V),U=f(I,E)):ba&12?(ba&4?(H[0]+=S*(aa-H[1])/X,H[1]=aa):(H[0]+=S*(V-H[1])/X,H[1]=V),ba=f(H,E)):U?(U&1?(I[1]+=X*(la-I[0])/S,I[0]=la):(I[1]+=X*(ka-I[0])/S,I[0]=ka),U=f(I,E)):(ba&1?(H[1]+=X*(la-H[0])/S,H[0]=la):(H[1]+=X*(ka-H[0])/S,H[0]=ka),ba=f(H,E)),U&ba){E=0;break a}}while(U|ba);E=P}0!==E&&g.segmentIntersects(l[0],l[1],C[0],C[1],r)&&
(E=r[1],A>w?E<A&&(A=E,m=!0):E<w&&(w=E,t=!0))}}m&&t?u[1]=(A+w)/2:u[0]=u[1]=NaN;return u}function f(v,l){return(v[0]<l[0]?1:0)|(v[0]>l[2]?1:0)<<1|(v[1]<l[1]?1:0)<<2|(v[1]>l[3]?1:0)<<3}function c(v,l){return(v[0]-l[0])*(v[0]-l[0])+(v[1]-l[1])*(v[1]-l[1])}function d(v,l){if(v<l)return-1;if(v>l)return 1;if(v===l)return 0;v=isNaN(v);l=isNaN(l);return v<l?-1:v>l?1:0}let p=n._createClass(function(v,l,u,r){this.x=v;this.y=l;this.cellSize=u;this.distancefromCellCenter=k.distanceFromPointToPolygon(v,l,r);this.maxDistanceToPolygon=
this.distancefromCellCenter+this.cellSize*Math.SQRT2});q.getLabelPoint=b;q.getPolylabelPoint=function(v){if(!v.nextPath()||!v.numPoints)return null;var l=D.currPathBounds(v),u=l[2]-l[0],r=l[3]-l[1];if(0===u||0===r)return[l[0]+u/2,l[1]+r/2];const A=Math.max(Math.min(u,r)/100,1),w=new F((B,J)=>J.maxDistanceToPolygon-B.maxDistanceToPolygon);r=Math.min(u,r);u=r/2;let m=0,t=0;for(m=l[0];m<l[2];m+=r)for(t=l[1];t<l[3];t+=r)w.enqueue(new p(m+u,t+u,u,v));l=x.ringsCentroidCursor(v);if(null===l)return null;
for(l=new p(l[0],l[1],0,v);0<w.size;)r=G.unwrap(w.dequeue()),r.distancefromCellCenter>l.distancefromCellCenter&&(l=r),r.maxDistanceToPolygon-l.distancefromCellCenter<=A||(u=r.cellSize/2,w.enqueue(new p(r.x-u,r.y-u,u,v)),w.enqueue(new p(r.x+u,r.y-u,u,v)),w.enqueue(new p(r.x-u,r.y+u,u,v)),w.enqueue(new p(r.x+u,r.y+u,u,v)));return[l.x,l.y]};q.labelPointAdapter=function(v){v={rings:z.collectRings(v)};return b(v)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/PriorityQueue":function(){define(["../chunks/_rollupPluginBabelHelpers"],
function(q){const n=(G,F)=>G<F?-1:G>F?1:0;return function(){function G(z=n){this._data=[];this._compare=z}var F=G.prototype;F.enqueue=function(z){if(null!=z){var {_data:y,_compare:D}=this;y.push(z);z=y.length-1>>>0;for(var x=y[z];0<z;){const k=z-1>>1,g=y[k];if(0>=D(g,x))y[k]=x,y[z]=g,z=k;else break}}};F.dequeue=function(){const {_data:z,_compare:y}=this,D=z[0];var x=z.pop();if(0===z.length)return D;z[0]=x;x=0;const k=z.length,g=z[0];let b;let a=null;for(;;){var h=2*x+1;const e=2*x+2;a=null;h<k&&(b=
z[h],0<y(b,g)&&(a=h));e<k&&(h=z[e],null===a&&0>=y(h,g)||null!==a&&0>=y(h,b))&&(a=e);if(null===a)break;z[x]=z[a];z[a]=g;x=a}return D};q._createClass(G,[{key:"size",get:function(){return this._data.length}}]);return G}()})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b){function a(d,p){d.forEach(v=>y.transformMat2d(v,v,p));return{upperLeft:k.i1616to32(8*d[0][0],8*d[0][1]),upperRight:k.i1616to32(8*d[1][0],8*d[1][1]),lowerLeft:k.i1616to32(8*d[2][0],8*d[2][1]),lowerRight:k.i1616to32(8*d[3][0],8*d[3][1])}}const h=Math.PI/180;let e=function(){function d(v,l,u,r){this._rotationT=z.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const A=u.rect,w=new Float32Array(8);v*=r;l*=r;const m=u.code?A.width*r:
u.metrics.width,t=u.code?A.height*r:u.metrics.height;this.width=m;this.height=t;w[0]=v;w[1]=l;w[2]=v+m;w[3]=l;w[4]=v;w[5]=l+t;w[6]=v+m;w[7]=l+t;this._data=w;this._setTextureCoords(A);this._scale=r;this._mosaic=u;this.x=v;this.y=l;this.maxOffset=Math.max(v+m,l+t)}var p=d.prototype;p.setTransform=function(v){this._transform=v;this._offsets=null};p._setOffsets=function(v){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const l=this._offsets,u=new Float32Array(8),r=
F.multiply(z.create(),this._rotationT,this._transform);z.transformMany(u,v,r);l.upperLeft=k.i1616to32(8*u[0],8*u[1]);l.upperRight=k.i1616to32(8*u[2],8*u[3]);l.lowerLeft=k.i1616to32(8*u[4],8*u[5]);l.lowerRight=k.i1616to32(8*u[6],8*u[7])};p._setTextureCoords=function({x:v,y:l,width:u,height:r}){this._texcoords={upperLeft:k.i1616to32(v,l),upperRight:k.i1616to32(v+u,l),lowerLeft:k.i1616to32(v,l+r),lowerRight:k.i1616to32(v+u,l+r)}};n._createClass(d,[{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",
get:function(){return this._angle},set:function(v){this._angle=v;F.fromRotation(this._rotationT,-v);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",
get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:A,width:w}=this._mosaic.metrics;var v=w*this._scale,l=Math.abs(A)*this._scale,u=new Float32Array(8);u[0]=this.x;u[1]=this.y;u[2]=this.x+v;u[3]=this.y;u[4]=this.x;u[5]=this.y+l;u[6]=this.x+v;u[7]=this.y+l;v=F.multiply(z.create(),this._rotationT,
this._transform);z.transformMany(u,u,v);l=v=Infinity;let m=0;var r=0;for(let t=0;4>t;t++){const B=u[2*t],J=u[2*t+1];v=Math.min(v,B);l=Math.min(l,J);m=Math.max(m,B);r=Math.max(r,J)}u=m-v;r-=l;this._bounds=new b(v+u/2,l+r/2,u,r)}return this._bounds}}]);return d}(),f=function(){function d(v,l,u){this._rotation=0;this._decorate(v,l,u);this.glyphs=v;this.bounds=this._createBounds(v);this.isMultiline=1<l.length;this._hasRotation=0!==u.angle;this._transform=this._createGlyphTransform(this.bounds,u);if((this._borderLineSize=
u.borderLineSize)||u.hasBackground)[this.bounds,this.background]=this.shapeBackground(this._transform);for(const r of v)r.setTransform(this._transform)}var p=d.prototype;p.setRotation=function(v){if(0!==v||0!==this._rotation){this._rotation=v;var l=this._transform;v=F.fromRotation(z.create(),v);F.multiply(l,v,l);for(const u of this.glyphs)u.setTransform(this._transform)}};p._decorate=function(v,l,u){if(u.decoration&&"none"!==u.decoration&&v.length){var r=u.scale;u="underline"===u.decoration?30:20;
var A=v[0].textureBinding;for(const B of l){const J=B.startX*r,C=B.startY*r;l=v;var w=l.push;var m=(B.width+B.glyphWidthEnd)*r;var t=A;m={code:0,page:0,sdf:!0,rect:new g(0,0,11,8),textureBinding:t,metrics:{advance:0,height:4,width:m,left:0,top:0}};w.call(l,new e(J,C+u*r,m,1))}}};p.shapeBackground=function(v){const l=(1.5+G.pt2px(this._borderLineSize||0))/2;var u=this._borderLineSize?l:0;const {xmin:r,ymin:A,xmax:w,ymax:m,x:t,y:B,width:J,height:C}=this.bounds,K=[r-8,A-8],E=[w+8,A-8],I=[r-8,m+8],H=
[w+8,m+8],N=a([[K[0]-l,K[1]-l],[E[0]+l,E[1]-l],[K[0]+u,K[1]+u],[E[0]-u,E[1]+u]],v),U=a([[I[0]+u,I[1]-u],[H[0]-u,H[1]-u],[I[0]-l,I[1]+l],[H[0]+l,H[1]+l]],v),ba=a([[K[0]-l,K[1]-l],[K[0]+u,K[1]+u],[I[0]-l,I[1]+l],[I[0]+u,I[1]-u]],v);u=a([[E[0]-u,E[1]+u],[E[0]+l,E[1]-l],[H[0]-u,H[1]-u],[H[0]+l,H[1]+l]],v);v={main:a([K,E,I,H],v),top:N,bot:U,left:ba,right:u};return[new b(t,B,J+2*l,C+2*l),v]};p._createBounds=function(v){let l=Infinity,u=Infinity,r=0;var A=0;for(const w of v)l=Math.min(l,w.xTopLeft),u=Math.min(u,
w.yTopLeft),r=Math.max(r,w.xBottomRight),A=Math.max(A,w.yBottomRight);v=r-l;A-=u;return new b(l+v/2,u+A/2,v,A)};p._createGlyphTransform=function(v,l){const u=h*l.angle,r=z.create(),A=D.create();F.translate(r,r,y.set(A,l.xOffset,-l.yOffset));l.isCIM?F.rotate(r,r,u):(F.translate(r,r,y.set(A,v.x,v.y)),F.rotate(r,r,u),F.translate(r,r,y.set(A,-v.x,-v.y)));return r};n._createClass(d,[{key:"boundsT",get:function(){var v=this.bounds;const l=y.set(D.create(),v.x,v.y);y.transformMat2d(l,l,this._transform);
return this._hasRotation?(v=Math.max(v.width,v.height),new b(l[0],l[1],v,v)):new b(l[0],l[1],v.width,v.height)}}]);return d}(),c=n._createClass(function(d,p,v,l,u,r){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(p,v));this.end=Math.max(0,Math.max(p,v));this.end<d.length&&(this.glyphWidthEnd=d[this.end].metrics.width);this.width=l;this.yMin=u;this.yMax=r});q.ShapedGlyph=e;q.ShapingInfo=f;q.shapeGlyphs=function(d,p,v){const l=v.scale,u=[],r=[];var A=1/v.scale*v.maxLineWidth;
var w=p?d.length-1:0,m=p?-1:d.length;p=p?-1:1;var t=w,B=0,J=0;let C=t,K=C,E=0,I=Infinity,H=0;for(;t!==m;){const {code:la,metrics:aa}=d[t];var N=Math.abs(aa.top);10!==la&&32!==la&&(I=Math.min(I,N),H=Math.max(H,N+aa.height));10===la?(t!==w&&(r.push(new c(d,C,t-p,B,I,H)),I=Infinity,H=0),B=0,C=t+p,K=t+p,J=0):32===la?(K=t+p,J=0,E=aa.advance,B+=aa.advance):(B>A&&(K!==C?(N=K-2*p,B-=E,r.push(new c(d,C,N,B-J,I,H)),I=Infinity,H=0,C=K,B=J):(r.push(new c(d,C,t-p,B,I,H)),I=Infinity,H=0,K=C=t,B=0)),B+=aa.advance,
J+=aa.advance);t+=p}A=new c(d,C,t-p,B,I,H);0<=A.start&&A.end<d.length&&r.push(A);for(A=0;A<r.length;A++);w=r[0].yMin;A=r[r.length-1].yMax+v.lineHeight*(r.length-1)+("underline"===v.decoration?4:0)-w;const {vAlign:U,hAlign:ba}=v;m=U===x.VAlign.Baseline?1:0;A=(1-m)*-w+A/2*(m?0:U-1)+-26*(m?1:0);for(w=0;w<r.length;w++){const {start:la,end:aa,width:ka}=r[w];m=ka/2*(ba+1)*-1-3;p=w*v.lineHeight+A-3;r[w].startX=m;r[w].startY=p;for(t=la;t<=aa;t++)B=d[t],10!==B.code&&(J=new e(m+B.metrics.left,p-B.metrics.top,
B,l),m+=B.metrics.advance,u.push(J))}return new f(u,r,v)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec2f32":function(){define(["exports"],function(q){function n(){return new Float32Array(2)}function G(f){const c=new Float32Array(2);c[0]=f[0];c[1]=f[1];return c}function F(f,c){const d=new Float32Array(2);d[0]=f;d[1]=c;return d}function z(f,c){return new Float32Array(f,c,2)}function y(){return n()}function D(){return F(1,1)}function x(){return F(1,0)}function k(){return F(0,
1)}const g=n(),b=D(),a=x(),h=k(),e=Object.freeze(Object.defineProperty({__proto__:null,ONES:b,UNIT_X:a,UNIT_Y:h,ZEROS:g,clone:G,create:n,createView:z,fromValues:F,ones:D,unitX:x,unitY:k,zeros:y},Symbol.toStringTag,{value:"Module"}));q.ONES=b;q.UNIT_X=a;q.UNIT_Y=h;q.ZEROS=g;q.clone=G;q.create=n;q.createView=z;q.fromValues=F;q.ones=D;q.unitX=x;q.unitY=k;q.vec2f32=e;q.zeros=y})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],
function(q,n){return function(){function G(z,y,D,x){this.center=n.fromValues(z,y);this.centerT=n.create();this.halfWidth=D/2;this.halfHeight=x/2;this.width=D;this.height=x}var F=G.prototype;F.clone=function(){return new G(this.x,this.y,this.width,this.height)};F.serialize=function(z){z.writeF32(this.center[0]);z.writeF32(this.center[1]);z.push(this.width);z.push(this.height);return z};F.findCollisionDelta=function(z,y=4){return Math.log2(Math.min((z.halfWidth+this.halfWidth+y)/Math.abs(z.centerT[0]-
this.centerT[0]),(z.halfHeight+this.halfHeight+y)/Math.abs(z.centerT[1]-this.centerT[1])))};F.extend=function(z){const y=Math.min(this.xmin,z.xmin),D=Math.min(this.ymin,z.ymin),x=Math.max(this.xmax,z.xmax)-y;z=Math.max(this.ymax,z.ymax)-D;this.width=x;this.height=z;this.halfWidth=x/2;this.halfHeight=z/2;this.x=y+x/2;this.y=D+z/2};G.deserialize=function(z){const y=z.readF32(),D=z.readF32(),x=z.readInt32();z=z.readInt32();return new G(y,D,x,z)};q._createClass(G,[{key:"x",get:function(){return this.center[0]},
set:function(z){this.center[0]=z}},{key:"y",get:function(){return this.center[1]},set:function(z){this.center[1]=z}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",
get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return G}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(q,n,G){return function(){function F(){this._materialKey=null}var z=F.prototype;z.bindFeature=function(y,D,x){};z.write=function(y,D,x,k){if(n.isNone(this._effects)||
0===this._effects?.length)return this._write(y,D,k);x=G.CIMEffectHelper.executeEffects(this._effects,D.readLegacyGeometryForDisplay(),y.tileKey,k.geometryEngine);let g=G.CIMEffectHelper.next(x);for(;g;)this._write(y,D,k,g),g=G.CIMEffectHelper.next(x)};z._write=function(y,D,x,k){};return q._createClass(F)}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/jsonUtils ../CIMCursor ../CIMEffects ../CIMOperators".split(" "),
function(q,n,G,F,z,y){const D=96/72;let x=function(){function k(){}k.executeEffects=function(g,b,a,h){b=F.cloneAndDecodeGeometry(b);b=new z.SimpleGeometryCursor(b);for(const e of g)(g=y.getEffectOperator(e))&&(b=g.execute(b,e,D,a,h));return b};k.next=function(g){g=g.next();F.deltaEncodeGeometry(g);return g};k.applyEffects=function(g,b,a){if(!g)return b;b=new z.SimpleGeometryCursor(b);for(var h of g)(g=y.getEffectOperator(h))&&(b=g.execute(b,h,1,null,a));for(a=null;h=b.next();)a?G.isPolyline(a)?G.isPolyline(h)&&
a.paths.push(...h.paths):G.isPolygon(a)&&G.isPolygon(h)&&a.rings.push(...h.rings):a=h;return a};return n._createClass(k)}();q.CIMEffectHelper=x;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e){return function(f){function c(p,v,l,u,r,A,w,m,t,B,J,C,K,E,I,H,N,U,ba,la,aa,ka,V,P){var S=d.call(this);S.angle=u;S.height=w;S.width=A;S.xOffset=v*ba;S.yOffset=l*ba;S._markerPlacement=la;S._effects=aa;S._anchorX=H;S._anchorY=N;S._minMaxZoom=g.i1616to32(Math.round(ka*x.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(V*x.MIN_MAX_ZOOM_PRECISION_FACTOR));v=(E===y.Alignment.MAP?x.BITSET_MARKER_ALIGNMENT_MAP:x.BITSET_MARKER_ALIGNMENT_SCREEN)|(J?x.BITSET_GENERIC_LOCK_COLOR:
0)|(K?x.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(C?x.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);l=I&&I.sdf;p=b.MarkerMaterialKey.load(p);p.sdf=l;p.pattern=!0;p.textureBinding=I.textureBinding;S._materialKey=p.data;S._fillColor=r;S._outlineColor=t;S._sizeOutlineWidth=g.i8888to32(Math.round(Math.min(Math.sqrt(128*A),255)),Math.round(Math.min(Math.sqrt(128*w),255)),Math.round(Math.min(Math.sqrt(128*B),255)),Math.round(Math.min(Math.sqrt(128*m),255)));p.symbologyType===k.WGLSymbologyType.PIE_CHART?
(S._computedWidth=A*U*ba,S._computedHeight=w*U*ba,S._texUpperLeft=g.i1616to32(0,1),S._texUpperRight=g.i1616to32(1,1),S._texBottomLeft=g.i1616to32(0,0),S._texBottomRight=g.i1616to32(1,0)):S._computeSize(A,w,U,B,ba,I,p.hasSizeVV(),P);S._bitestAndDistRatio=g.i1616to32(v,Math.round(64*U));r=z.create();A=F.create();S._applyTransformation(A,r);return S}q._inherits(c,f);var d=q._createSuper(c);c.fromCIMMarker=function(p,v,l){const u=p.size,r=(v&&v.width||1)/(v&&v.height||1)*p.scaleX;var A=p.scaleSymbolsProportionally&&
p.frameHeight?u/p.frameHeight:1;const w=D.premultiplyAlphaRGBA(p.color),m=D.premultiplyAlphaRGBA(p.outlineColor),t=G.pt2px(u),B=t*r,J=G.pt2px(p.offsetX||0),C=G.pt2px(p.offsetY||0);A*=G.pt2px(p.outlineWidth||0);const K=p.alignment||y.Alignment.SCREEN,E=G.pt2px(p.referenceSize),[I,H]=a.getMinMaxZoom(p.scaleInfo,l);l=p.rotation||0;p.rotateClockwise||(l=-l);let N=0,U=0;const ba=p.anchorPoint;ba&&(p.isAbsoluteAnchorPoint?u&&(N=ba.x/(u*r),U=ba.y/u):(N=ba.x,U=ba.y));v=new c(p.materialKey,J,C,l,w,B,t,E,m,
A,p.colorLocked,p.scaleSymbolsProportionally,!1,K,v,N,U,p.sizeRatio,n.unwrapOr(p.scaleFactor,1),p.markerPlacement,p.effects,I,H,!0);v._vertexBoundsScaleX=p.maxVVSize?p.maxVVSize/B:1;v._vertexBoundsScaleY=p.maxVVSize?p.maxVVSize/t:1;return v};c.fromPictureMarker=function(p,v){const l=Math.round(G.pt2px(p.width)),u=Math.round(G.pt2px(p.height)),r=x.PICTURE_FILL_COLOR,A=Math.round(G.pt2px(p.xoffset||0)),w=Math.round(G.pt2px(p.yoffset||0));v=new c(p.materialKey,A,w,p.angle,r,l,u,u,0,0,!1,!1,!1,y.Alignment.SCREEN,
v,0,0,1,1,null,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM,!1);v._vertexBoundsScaleX=p.maxVVSize?p.maxVVSize/p.width:1;v._vertexBoundsScaleY=p.maxVVSize?p.maxVVSize/p.height:1;return v};c.fromSimpleMarker=function(p,v){const l=p.style,u=D.premultiplyAlphaRGBAArray(p.color),r=Math.round(G.pt2px(p.size));let A=r;"esriSMSTriangle"===l&&(A*=v.height/v.width);const w=Math.round(G.pt2px(p.xoffset||0)),m=Math.round(G.pt2px(p.yoffset||0));var t=p.outline;const B=(t?.color&&D.premultiplyAlphaRGBAArray(t.color))|
0;t=(t?.width&&Math.round(G.pt2px(t.width)))|0;v=new c(p.materialKey,w,m,p.angle??0,u,r,A,A,B,t,!1,!1,"esriSMSCross"===l||"esriSMSX"===l,y.Alignment.SCREEN,v,0,0,2,1,null,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM,!1);v.boundsType="esriSMSCircle"===l?"circle":"square";v._vertexBoundsScaleX=p.maxVVSize?p.maxVVSize/p.size:1;v._vertexBoundsScaleY=p.maxVVSize?p.maxVVSize/p.size:1;return v};c.fromLineSymbolMarker=function(p,v){const l=D.premultiplyAlphaRGBAArray(p.color),u=Math.round(G.pt2px(6*p.lineWidth)),
r="cross"===p.style||"x"===p.style;switch(p.placement){case "begin-end":var A=y.ExtremityPlacement.Both;break;case "begin":A=y.ExtremityPlacement.JustBegin;break;case "end":A=y.ExtremityPlacement.JustEnd;break;default:A=y.ExtremityPlacement.None}A={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:A,offsetAlongLine:0};v=new c(p.materialKey,0,0,0,l,u,u,u/6,l,r?Math.round(G.pt2px(p.lineWidth)):0,!1,!1,r,y.Alignment.MAP,v,0,0,2,1,A,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM,
!1);v.boundsType="circle"===p.style?"circle":"square";return v};return q._createClass(c)}(h(e))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../geometry/GeometryCursor ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/CIMCursor ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f){const c=3.14159265359/180;return d=>function(p){function v(...u){u=l.call(this,...u);u.angle=0;u.xOffset=0;u.yOffset=0;u.width=0;u.height=0;u.boundsType="square";u._anchorX=0;u._anchorY=0;u._computedWidth=0;u._computedHeight=0;u._allowBorrowing=!0;u._vertexBoundsScaleX=1;u._vertexBoundsScaleY=1;u.geometryType=h.WGLGeometryType.MARKER;return u}q._inherits(v,p);var l=q._createSuper(v);p=v.prototype;p._write=function(u,r,A,w){const m=r.getDisplayId();u.recordStart(m,
this._materialKey,this.geometryType,!0);this._writeGeometry(u,r,m,A,w);u.recordEnd()};p._writeGeometry=function(u,r,A,w,m){if(n.isSome(this._markerPlacement))return this._writePlacedMarkers(u,r,w,m);this._allowBorrowing=!0;if(!m&&"esriGeometryPoint"===r.geometryType)return w=r.getX(),r=r.getY(),!u.hasAggregates&&u.hasPixelBufferEnabled&&(0>w||513<=w||0>r||513<=r)?void 0:this._writeVertices(u,A,this._getPos(w,r),w,r);r=m?k.deltaDecodeGeometry(k.convertFromGeometry(m),2):"esriGeometryPolygon"===r.geometryType?
r.readCentroid():r.readGeometryForDisplay();if(!n.isNone(r)){if(r.isPoint){const [t,B]=r.coords;return!u.hasAggregates&&u.hasPixelBufferEnabled&&(0>t||512<=t||0>B||512<=B)?void 0:this._writeVertices(u,A,this._getPos(t,B),t,B)}r.forEachVertex((t,B)=>{const J=2*a.TILE_SIZE;t<-J||t>=J||B<-J||B>=J||this._writeVertices(u,A,this._getPos(t,B),t,B)})}};p._writePlacedMarkers=function(u,r,A,w){w&&g.deltaDecodeGeometry(w);w=w?x.getJSONCursor(w):x.getOptimizedCursor(r.readGeometryForDisplay(),r.geometryType??
null,!0);if(A=b.CIMMarkerPlacementHelper.getPlacement(w,n.unwrap(this._markerPlacement),G.pt2px(1),u.tileKey,A.geometryEngine)){this._allowBorrowing="esriGeometryPolygon"!==r.geometryType;r=r.getDisplayId();w=D.create();for(var m=z.create(),t=A.next();null!=t;){const B=t.tx,J=-t.ty;-128<=B&&640>=B&&-128<=J&&640>=J&&(this._applyTransformation(m,w,-t.getAngle()/c),this._writeVertices(u,r,this._getPos(B,J),B,J));t=A.next()}}};p._writeVertices=function(u,r,A,w,m){const t=f.MarkerMaterialKey.load(this._materialKey);
switch(t.symbologyType){case h.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(u,r,A);default:return this._writeMarkerVertices(u,r,t,A,w,m)}};p._writeMarkerVertices=function(u,r,A,w,m,t){var B=A.vvRotation;A=u.vertexCount();let J=this._computedWidth*this._vertexBoundsScaleX;var C=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(J=C=Math.max(J,C));B&&(B=Math.max(this.xOffset,this.yOffset),J+=B,C+=B);this._allowBorrowing&&u.vertexBounds(m+this.xOffset,t-this.yOffset,J,C);u.vertexWrite(w);
u.vertexWrite(this._offsetUpperLeft);u.vertexWrite(this._texUpperLeft);u.vertexWrite(this._bitestAndDistRatio);u.vertexWrite(r);u.vertexWrite(this._fillColor);u.vertexWrite(this._outlineColor);u.vertexWrite(this._sizeOutlineWidth);u.vertexWrite(this._minMaxZoom);u.vertexEnd();u.vertexWrite(w);u.vertexWrite(this._offsetUpperRight);u.vertexWrite(this._texUpperRight);u.vertexWrite(this._bitestAndDistRatio);u.vertexWrite(r);u.vertexWrite(this._fillColor);u.vertexWrite(this._outlineColor);u.vertexWrite(this._sizeOutlineWidth);
u.vertexWrite(this._minMaxZoom);u.vertexEnd();u.vertexWrite(w);u.vertexWrite(this._offsetBottomLeft);u.vertexWrite(this._texBottomLeft);u.vertexWrite(this._bitestAndDistRatio);u.vertexWrite(r);u.vertexWrite(this._fillColor);u.vertexWrite(this._outlineColor);u.vertexWrite(this._sizeOutlineWidth);u.vertexWrite(this._minMaxZoom);u.vertexEnd();u.vertexWrite(w);u.vertexWrite(this._offsetBottomRight);u.vertexWrite(this._texBottomRight);u.vertexWrite(this._bitestAndDistRatio);u.vertexWrite(r);u.vertexWrite(this._fillColor);
u.vertexWrite(this._outlineColor);u.vertexWrite(this._sizeOutlineWidth);u.vertexWrite(this._minMaxZoom);u.vertexEnd();this._writeIndices(u,A)};p._writeHeatmapVertices=function(u,r,A){const w=u.vertexCount();u.vertexWrite(A);u.vertexWrite(this._offsetUpperLeft);u.vertexWrite(r);u.vertexEnd();u.vertexWrite(A);u.vertexWrite(this._offsetUpperRight);u.vertexWrite(r);u.vertexEnd();u.vertexWrite(A);u.vertexWrite(this._offsetBottomLeft);u.vertexWrite(r);u.vertexEnd();u.vertexWrite(A);u.vertexWrite(this._offsetBottomRight);
u.vertexWrite(r);u.vertexEnd();this._writeIndices(u,w)};p._writeIndices=function(u,r){u.indexWrite(r+0);u.indexWrite(r+1);u.indexWrite(r+2);u.indexWrite(r+1);u.indexWrite(r+3);u.indexWrite(r+2)};p._applyTransformation=function(u,r,A=0){F.fromTranslation(u,D.fromValues(this.xOffset,-this.yOffset));null!=this.angle&&0!==this.angle+A&&F.rotate(u,u,c*(this.angle+A));A=this._computedWidth;const w=this._computedHeight,m=-(.5+this._anchorX)*A,t=-(.5-this._anchorY)*w;y.set(r,m,t);y.transformMat2d(r,r,u);
this._offsetUpperLeft=e.i1616to32(16*r[0],16*r[1]);y.set(r,m+A,t);y.transformMat2d(r,r,u);this._offsetUpperRight=e.i1616to32(16*r[0],16*r[1]);y.set(r,m,t+w);y.transformMat2d(r,r,u);this._offsetBottomLeft=e.i1616to32(16*r[0],16*r[1]);y.set(r,m+A,t+w);y.transformMat2d(r,r,u);this._offsetBottomRight=e.i1616to32(16*r[0],16*r[1])};p._computeSize=function(u,r,A,w,m,t,B,J){const C=u*A;A*=r;t.sdf&&!B?(w+=2,u=Math.min((J&&u>r?C:u)+w,C),r=Math.min(r+w,A)):(u=C,r=A);J=a.SDF_TEXTURE_SIZE/Math.max(C,A);B=.5*(C-
u)*J;var K=.5*(A-r)*J;J=t.rect.x+a.SPRITE_PADDING+B;w=t.rect.y+a.SPRITE_PADDING+K;B=J+t.width-2*B;t=w+t.height-2*K;K=Math.floor(J);const E=Math.floor(w),I=Math.ceil(B),H=Math.ceil(t);u*=(I-K)/(B-J);r*=(H-E)/(t-w);this._texUpperLeft=e.i1616to32(K,E);this._texUpperRight=e.i1616to32(I,E);this._texBottomLeft=e.i1616to32(K,H);this._texBottomRight=e.i1616to32(I,H);this._anchorX*=C/u;this._anchorY*=A/r;this._computedWidth=u*m;this._computedHeight=r*m};p._getPos=function(u,r){return e.i1616to32(Math.round(8*
u),Math.round(8*r))};return q._createClass(v)}(d)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l){function u(J,C){const K=J.length;J.push(null);C.then(E=>J[K]=E);return J}function r(J){return null!=J&&!!(J&1)}const A=F.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),w={sortKey:null,templates:[]};F={isOutline:!1,placement:null,symbologyType:D.WGLSymbologyType.DEFAULT,vvFlags:0};const m={...y.errorPointSymbolJSON,hash:JSON.stringify(y.errorPointSymbolJSON),materialKey:x.createMaterialKey(D.WGLGeometryType.MARKER,F)},t={...y.errorPolylineSymbolJSON,
hash:JSON.stringify(y.errorPolylineSymbolJSON),materialKey:x.createMaterialKey(D.WGLGeometryType.LINE,F)},B={...y.errorPolygonSymbolJSON,hash:JSON.stringify(y.errorPolygonSymbolJSON),materialKey:x.createMaterialKey(D.WGLGeometryType.FILL,F)};y=function(){function J(K,E){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new d.Lock;this._fetchResource=
K;this._tileInfo=E}var C=J.prototype;C.createTemplateGroup=function(K,E,I=null){this._initErrorTemplates();const H=K.hash;var N=this._symbolToTemplate.get(H);if(null!=N)return N;N=[];I={sortKey:I,templates:N};E&&this._createMeshTemplates(N,E,!0);this._createMeshTemplates(N,K,!1);E=this._createGroupId;if(N="expanded-cim"===K.type)a:{if(K.layers)for(const U of K.layers)if("function"===typeof U.materialHash){N=!0;break a}N=!1}K=E.call(this,N);this._idToTemplateGroup.set(K,I);this._symbolToTemplate.set(H,
K);return K};C.getTemplateGroup=function(K){return this._idToTemplateGroup.get(K)??w};C.getDynamicTemplateGroup=function(K){if(!this._idToTemplateGroup.has(K))return w;r(K)||A.error("mapview-template-store",`Id ${K} does not refer to a dynamic template`);return this._idToTemplateGroup.get(K)};C.getMosaicItem=function(K,E){const I=this._createTemplateId(),H=new Promise(N=>this._idToResolver.set(I,N));this._fetchQueue.push({symbol:K,id:I,glyphIds:E});return H};C.finalize=function(K){return this._fetchQueue.length||
this._lock.isHeld()?d.withLock(this._lock,this._fetchAllQueuedResources.bind(this),K):Promise.resolve()};C._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],B,!1),marker:this._createMeshTemplates([],m,!1),line:this._createMeshTemplates([],t,!1)})};C._fetchAllQueuedResources=function(K){if(!this._fetchQueue.length)return Promise.resolve();const E=this._fetchQueue,I=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(I).then(()=>
this._fetchResource(E,K).then(H=>{for(const {id:N,mosaicItem:U}of H)this._idToResolver.get(N)(U),this._idToResolver.delete(N)})).catch(H=>{z.isAbortError(H)?this._fetchQueue=this._fetchQueue.concat(E):"worker:port-closed"!==H.name&&A.error(new G("mapview-template-store","Unable to fetch requested texture resources",H))})};C._createGroupId=function(K){return this._idCounter++<<1|(K?1:0)};C._createTemplateId=function(){return this._templateIdCounter++};C._createSMS=async function(K){const {spriteMosaicItem:E}=
await this.getMosaicItem(K);return p.ok(E,A)?f.fromSimpleMarker(K,E):this._markerError};C._createPMS=async function(K){const {spriteMosaicItem:E}=await this.getMosaicItem(K);return p.ok(E,A)?f.fromPictureMarker(K,E):this._markerError};C._createSFS=async function(K,E){const {spriteMosaicItem:I}=await this.getMosaicItem(K);return p.ok(I,A)?h.fromSimpleFill(K,I,E):this._fillError};C._createPFS=async function(K,E){const {spriteMosaicItem:I}=await this.getMosaicItem(K);return p.ok(I,A)?h.fromPictureFill(K,
I,E):this._fillError};C._createSLS=async function(K,E){({spriteMosaicItem:E}=await this.getMosaicItem(K));return p.ok(E,A)?e.fromSimpleLine(K,E):this._lineError};C._createLMS=async function(K){const {spriteMosaicItem:E}=await this.getMosaicItem(K);return p.ok(E,A)?f.fromLineSymbolMarker(K,E):this._markerError};C._createTS=async function(K){const {glyphMosaicItems:E}=await this.getMosaicItem(K);return c.fromText(K,E??[])};C._createCIMText=async function(K){const {glyphMosaicItems:E}=await this.getMosaicItem(l.cimLayerToRasterizationInfo(K),
v.codepoints(K.text));return p.ok(E,A)?c.fromCIMText(K,E,this._tileInfo):this._textError};C._createCIMFill=async function(K){const {spriteMosaicItem:E}=await this.getMosaicItem(l.cimLayerToRasterizationInfo(K));return p.ok(E,A)?h.fromCIMFill(K,E,this._tileInfo):this._fillError};C._createCIMLine=async function(K){const {spriteMosaicItem:E}=await this.getMosaicItem(l.cimLayerToRasterizationInfo(K));return p.ok(E,A)?e.fromCIMLine(K,E,this._tileInfo):this._lineError};C._createCIMMarker=async function(K){const {spriteMosaicItem:E}=
await this.getMosaicItem(l.cimLayerToRasterizationInfo(K));return p.ok(E,A)?f.fromCIMMarker(K,E,this._tileInfo):this._markerError};C._createCIM=async function(K){const E=K.templateHash;let I=this._cimTemplateCache.get(E);if(null!=I)return I;switch(K.type){case "marker":I=await this._createCIMMarker(K);break;case "line":I=await this._createCIMLine(K);break;case "fill":I=await this._createCIMFill(K);break;case "text":I=await this._createCIMText(K)}this._cimTemplateCache.set(E,I);return I};C._createDynamicCIM=
async function(K){const E=K.templateHash;let I=this._cimTemplateCache.get(E);if(null!=I)return I;switch(K.type){case "marker":I=b.fromCIMMarker(K,this._tileInfo);break;case "line":I=g.fromCIMLine(K,this._tileInfo);break;case "fill":I=k.fromCIMFill(K,this._tileInfo);break;case "text":I=a.fromCIMText(K,this._tileInfo)}this._cimTemplateCache.set(E,I);return I};C._createPrimitiveMeshTemplates=function(K,E,I){switch(E.type){case "esriSMS":return u(K,this._createSMS(E));case "esriPMS":return u(K,this._createPMS(E));
case "esriSFS":return u(K,this._createSFS(E,I));case "line-marker":return u(K,this._createLMS(E));case "esriPFS":return u(K,this._createPFS(E,I));case "esriSLS":return u(K,this._createSLS(E,!1));case "esriTS":return u(K,this._createTS(E));default:return A.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),K}};C._createMeshTemplates=function(K,E,I){if(E.type.includes("3d"))return A.error("3D symbols are not supported with MapView"),K;if("expanded-cim"===E.type){for(const H of E.layers)"function"===
typeof H.materialHash?u(K,this._createDynamicCIM(H)):u(K,this._createCIM(H));return K}if("composite-symbol"===E.type){for(const H of E.layers)this._createPrimitiveMeshTemplates(K,H,I);return K}return"cim"===E.type||"label"===E.type||"web-style"===E.type?K:this._createPrimitiveMeshTemplates(K,E,I)};n._createClass(J,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},
{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return J}();q.WGLTemplateStore=y;q.errorPointSchema2D=m;q.errorPolygonSchema2D=B;q.errorPolylineSchema2D=t;q.isDynamicId=r;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){return function(h){function e(c,d,p){var v=f.call(this,c);v._minMaxZoom=D.i1616to32(Math.round(d*z.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(p*z.MIN_MAX_ZOOM_PRECISION_FACTOR));k.isFunction(c.color)?v._dynamicPropertyMap.set("fillColor",(m,t,B)=>(m=c.color(m,t,B))&&F.premultiplyAlphaRGBA(m)||0):(d=c.color,v.fillColor=d&&F.premultiplyAlphaRGBA(d)||0);const l="CIMMarkerPlacementInsidePolygon"===c.cim.placement?.type&&c.cim.placement.shiftOddRows?2:1,u=c.height;k.isFunction(u)?
v._dynamicPropertyMap.set("_height",(m,t,B)=>u(m,t,B)*l):v._height=(u||0)*l;const r=c.offsetX;k.isFunction(r)?v._dynamicPropertyMap.set("_offsetX",(m,t,B)=>G.pt2px(r(m,t,B))):v._offsetX=G.pt2px(r||0);const A=c.offsetY;k.isFunction(A)?v._dynamicPropertyMap.set("_offsetY",(m,t,B)=>G.pt2px(-A(m,t,B))):v._offsetY=G.pt2px(-A||0);d=c.scaleX;k.isFunction(d)?v._dynamicPropertyMap.set("_scaleX",d):v._scaleX=d||1;const w=c.angle;k.isFunction(w)?v._dynamicPropertyMap.set("_angle",(m,t,B)=>y.degToByte(w(m,t,
B))):v._angle=y.degToByte(w)||0;n.isSome(c.effects)&&(d=c.effects,k.isFunction(d)?v._dynamicPropertyMap.set("_effects",d):v._effects=d);v._cimFillLayer=c;v._bitset=(c.colorLocked?z.BITSET_GENERIC_LOCK_COLOR:0)|(c.applyRandomOffset?z.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(c.sampleAlphaOnly?z.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0)|(c.hasUnresolvedReplacementColor?z.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR:0);v._fillMaterialKey=c.materialKey;return v}q._inherits(e,h);var f=q._createSuper(e);e.fromCIMFill=
function(c,d){const [p,v]=k.getMinMaxZoom(c.scaleInfo,d);return new e(c,p,v)};e.prototype.bindFeature=function(c,d,p){const v=c.readLegacyFeature();this._dynamicPropertyMap.forEach((r,A)=>{this[A]=r(v,d,p)});c=x.FillMaterialKey.load(this._fillMaterialKey);var l=this._materialCache,u=this._cimFillLayer.materialHash;u=u(v,d,p);u=l.get(u);l=null;u&&a.ok(u.spriteMosaicItem)&&(l=u.spriteMosaicItem);if(l){const {rect:r,width:A,height:w}=l;u=r.x+z.SPRITE_PADDING;const m=r.y+z.SPRITE_PADDING,t=u+A,B=m+w;
let J=Math.round(G.pt2px(this._height));0>=J&&(J=B-m);let C=Math.round(G.pt2px(this._height/w*A||0));0>=C&&(C=t-u);const K=this._scaleX;this.tl=D.i1616to32(u,m);this.br=D.i1616to32(t,B);this.aux21=D.i1616to32(C,J);this.aux22=D.i1616to32(this._offsetX,this._offsetY);this.aux3=D.i8888to32(128*K,128,this._angle,0);c.sdf=l.sdf;c.pattern=!0;c.textureBinding=l.textureBinding}else this.aux3=this.aux22=this.aux21=this.br=this.tl=0,c.sdf=!1,c.pattern=!1,c.textureBinding=0;this._materialKey=c.data};return q._createClass(e)}(g(b))})},
"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(q){function n(y,D){y%=D;return 0<=y?y:y+D}const G=128/Math.PI,F=256/360,z=1/Math.LN2;q.between=function(y,D,x){return y>=D&&y<=x||y>=x&&y<=D};q.degToByte=function(y){return n(y*F,256)};q.interpolate=function(y,D,x){return y*(1-x)+D*x};q.log2=function(y){return Math.log(y)*z};q.positiveMod=n;q.radToByte=function(y){return n(y*G,256)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),
function(q,n,G,F,z,y,D,x,k){return g=>function(b){function a(...e){e=h.call(this,...e);e.forceLibtess=!1;e._bitset=0;e._lineTemplate=null;e.geometryType=F.WGLGeometryType.FILL;return e}q._inherits(a,b);var h=q._createSuper(a);b=a.prototype;b._maybeAddLineTemplate=function(e){this._lineTemplate=k.fromFillOutline(e)};b._write=function(e,f,c,d){c="esriGeometryPoint"===f.geometryType;const p=D.FillMaterialKey.load(this._materialKey);e.recordStart(f.getDisplayId(),this._materialKey,this.geometryType,c);
this._writeGeometry(e,f,p,d,c);D.hasOutlineFillSymbology(p)&&n.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(e,f,d,c);e.recordEnd()};b._writeGeometry=function(e,f,c,d,p){d=this._getGeometry(f,d,p);n.isNone(d)||(p=[],100<d.maxLength||this.forceLibtess||!x.triangulate(p,d)?(d=x.triangulateLibtess(d),this._writeVertices(e,f,d,[d.length/2],c)):p.length&&this._writeVertices(e,f,d.coords,d.lengths,c,p))};b._writeVertex=function(e,f,c,d,p,v){const l=z.i1616to32(1*d,1*p);e.vertexBounds(d,p,
0,0);e.vertexWrite(l);e.vertexWrite(f);c.symbologyType===F.WGLSymbologyType.DOT_DENSITY?e.vertexWriteF32(1/Math.abs(v.readGeometryArea())):(e.vertexWrite(this.fillColor),f=D.hasSimpleSymbology(c),f||(e.vertexWrite(this.tl),e.vertexWrite(this.br)),e.vertexWrite(this.aux21),e.vertexWrite(this.aux22),e.vertexWrite(this.aux3),f||e.vertexWrite(this._minMaxZoom))};b._writeVertices=function(e,f,c,d,p,v){var l=f.getDisplayId();l|=this._bitset<<24;var u=d.reduce((A,w)=>A+w);const r=y.getStrides(p.geometryType,
p.symbologyType).geometry/4;d=e.vertexCount();e.vertexEnsureSize(r*u);u=0;if(v)for(const A of v)this._writeVertex(e,l,p,c[2*A],c[2*A+1],f),u++;else for(v=0;v<c.length;v+=2)this._writeVertex(e,l,p,Math.round(c[v]),Math.round(c[v+1]),f),u++;e.indexEnsureSize(u);for(f=0;f<u;f++)e.indexWrite(f+d)};b._getGeometry=function(e,f,c){return(e=f?G.deltaDecodeGeometry(G.convertFromGeometry(f),2):e.readGeometryForDisplay())?x.clipMarshall(e,c?256:8):null};return q._createClass(a)}(g)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../geometry/support/TileClipper ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../bufcut".split(" "),
function(q,n,G,F,z,y,D,x){function k(h,e,f){let c=0;for(let d=1;d<f;d++)c+=(h[2*(e+d)]-h[2*(e+d-1)])*(h[2*(e+d)+1]+h[2*(e+d-1)+1]);return c}function g(h,e,f,c,d){let p=0;for(;f<c;f+=3){const v=2*(h[f]-d),l=2*(h[f+1]-d),u=2*(h[f+2]-d);p+=Math.abs((e[v]-e[u])*(e[l+1]-e[v+1])-(e[v]-e[l])*(e[u+1]-e[v+1]))}return p}const b=new z.TileClipper(0,0,0,1,0),a=new z.TileClipper(0,0,0,1,0);b.setExtent(D.TILE_SIZE);a.setExtent(D.TILE_SIZE);q.area=k;q.clipLinesMarshall=function(h,e){a.setPixelMargin(e);const f=
-e;e=D.TILE_SIZE+e;let c=[];var d=!1;let p=0;for(;p<h.length;){const v=[],l=h[p];if(!l)return null;a.reset(z.GeometryType.LineString);let [u,r]=l[0];if(d)a.moveTo(u,r);else{if(u<f||u>e||r<f||r>e){d=!0;continue}v.push({x:u,y:r})}let A=!1;const w=l.length;for(let m=1;m<w;++m)if(u+=l[m][0],r+=l[m][1],d)a.lineTo(u,r);else{if(u<f||u>e||r<f||r>e){A=!0;break}v.push({x:u,y:r})}if(A)d=!0;else{if(d){if(d=a.resultWithStarts())for(const m of d)c.push(m)}else c.push({line:v,start:0});p++;d=!1}}c=c.filter(v=>1<
v.line.length);return 0===c.length?null:c};q.clipMarshall=function(h,e){if(n.isNone(h))return null;a:{var f=D.TILE_SIZE+128;var c=0;for(var d=0;d<h.lengths.length;d++){var p=h.lengths[d];for(var v=0;v<p;v++){const l=h.coords[2*(v+c)],u=h.coords[2*(v+c)+1];if(-128>l||l>f||-128>u||u>f){f=!0;break a}}c+=p}f=!1}if(!f)return h;b.setPixelMargin(e);b.reset(z.GeometryType.Polygon);e=0;for(f=0;f<h.lengths.length;f++){c=h.lengths[f];d=h.coords[2*(0+e)];p=h.coords[2*(0+e)+1];b.moveTo(d,p);for(v=1;v<c;v++)d=
h.coords[2*(v+e)],p=h.coords[2*(v+e)+1],b.lineTo(d,p);b.close();e+=c}f=b.result(!1);if(!f)return null;h=[];e=[];for(const l of f){f=0;for(const u of l)e.push(u.x),e.push(u.y),f++;h.push(f)}return new y(h,e)};q.triangleAreaArray=g;q.triangulate=function(h,e){const {coords:f,lengths:c,hasIndeterminateRingOrder:d}=e;if(d)return!1;e=0;for(var p=0;p<c.length;){let u=p,r=c[p];p=k(f,e,r);for(var v=[];++u<c.length;){var l=c[u];const A=k(f,e+r,l);if(!(0<A))break;p+=A;v.push(e+r);r+=l}l=h.length;x.bufcut(h,
f,e,e+r,v,2,0);v=g(h,f,l,h.length,0);p=Math.abs(p);if(1E-5<Math.abs((v-p)/Math.max(1E-7,p)))return h.length=0,!1;p=u;e+=r}return!0};q.triangulateEarcut=function(h,e,f){const {coords:c,lengths:d,hasIndeterminateRingOrder:p}=e;if(p)return!1;let v=0;for(var l=0;l<d.length;){let r=l,A=d[l];for(l=[];++r<d.length;){var u=d[r];if(!(0<k(c,v+A,u)))break;l.push(v+A-v);A+=u}u=e.coords.slice(2*v,2*(v+A));l=G.earcut(u,l,2);for(const w of l)h.push(w+f+v);l=r;v+=A}return!0};q.triangulateLibtess=function(h){const {coords:e,
lengths:f}=h;({buffer:h}=F.triangulate(e,f));return h};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(q,n){function G(r,A,w,m,t,B,J){let C;w=0;for(let K=m,E=t-B;K<t;K+=B)w+=(r[E+A*B]-r[K+A*B])*(r[K+1+A*B]+r[E+1+A*B]),E=K;if(J===0<w)for(;m<t;m+=B)C=D(m+A*B,r[m+A*B],r[m+1+A*B],C);else for(t-=B;t>=m;t-=B)C=D(t+A*B,r[t+A*B],r[t+1+A*B],C);C&&c(C,C.next)&&(x(C),
C=C.next);return C}function F(r,A=r){if(!r)return r;let w;do if(w=!1,r.steiner||!c(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{x(r);r=A=r.prev;if(r===r.next)break;w=!0}while(w||r!==A);return A}function z(r,A,w,m,t,B,J,C){if(r){!C&&B&&(r=g(r,m,t,B));for(var K=r;r.prev!==r.next;){var E=r.prev,I=r.next;if(B)var H=y(r,m,t,B);else a:{H=r;var N=H.prev,U=H;const ba=H.next;if(0<=b(N,U,ba)){H=!1;break a}let la=H.next.next;const aa=la;let ka=0;for(;la!==H.prev&&(0===ka||la!==aa);){ka++;if(h(N.x,N.y,U.x,
U.y,ba.x,ba.y,la.x,la.y)&&0<=b(la.prev,la,la.next)){H=!1;break a}la=la.next}H=!0}if(H)A.push(E.index/w+J),A.push(r.index/w+J),A.push(I.index/w+J),x(r),K=r=I.next;else if(r=I,r===K){if(!C)z(F(r),A,w,m,t,B,J,1);else if(1===C){C=A;K=w;E=J;I=r;do H=I.prev,N=I.next.next,!c(H,N)&&a(H,I,I.next,N)&&e(H,N)&&e(N,H)&&(C.push(H.index/K+E),C.push(I.index/K+E),C.push(N.index/K+E),x(I),x(I.next),I=r=N),I=I.next;while(I!==r);r=I;z(r,A,w,m,t,B,J,2)}else if(2===C)a:{C=r;do{for(K=C.next.next;K!==C.prev;){if(E=C.index!==
K.index){H=H=H=void 0;E=C;I=K;if(H=E.next.index!==I.index&&E.prev.index!==I.index){b:{H=E;do{if(H.index!==E.index&&H.next.index!==E.index&&H.index!==I.index&&H.next.index!==I.index&&a(H,H.next,E,I)){H=!0;break b}H=H.next}while(H!==E);H=!1}H=!H}if(H=H&&e(E,I)&&e(I,E)){H=E;N=!1;U=(E.x+I.x)/2;I=(E.y+I.y)/2;do H.y>I!==H.next.y>I&&H.next.y!==H.y&&U<(H.next.x-H.x)*(I-H.y)/(H.next.y-H.y)+H.x&&(N=!N),H=H.next;while(H!==E);H=N}E=H}if(E){r=p(C,K);C=F(C,C.next);r=F(r,r.next);z(C,A,w,m,t,B,J,0);z(r,A,w,m,t,B,
J,0);break a}K=K.next}C=C.next}while(C!==r)}break}}}}function y(r,A,w,m){const t=r.prev,B=r.next;if(0<=b(t,r,B))return!1;const J=t.x>r.x?t.x>B.x?t.x:B.x:r.x>B.x?r.x:B.x,C=t.y>r.y?t.y>B.y?t.y:B.y:r.y>B.y?r.y:B.y,K=f(t.x<r.x?t.x<B.x?t.x:B.x:r.x<B.x?r.x:B.x,t.y<r.y?t.y<B.y?t.y:B.y:r.y<B.y?r.y:B.y,A,w,m);A=f(J,C,A,w,m);w=r.prevZ;for(m=r.nextZ;w&&w.z>=K&&m&&m.z<=A;){if(w!==r.prev&&w!==r.next&&h(t.x,t.y,r.x,r.y,B.x,B.y,w.x,w.y)&&0<=b(w.prev,w,w.next))return!1;w=w.prevZ;if(m!==r.prev&&m!==r.next&&h(t.x,
t.y,r.x,r.y,B.x,B.y,m.x,m.y)&&0<=b(m.prev,m,m.next))return!1;m=m.nextZ}for(;w&&w.z>=K;){if(w!==r.prev&&w!==r.next&&h(t.x,t.y,r.x,r.y,B.x,B.y,w.x,w.y)&&0<=b(w.prev,w,w.next))return!1;w=w.prevZ}for(;m&&m.z<=A;){if(m!==r.prev&&m!==r.next&&h(t.x,t.y,r.x,r.y,B.x,B.y,m.x,m.y)&&0<=b(m.prev,m,m.next))return!1;m=m.nextZ}return!0}function D(r,A,w,m){r=v.create(r,A,w);m?(r.next=m.next,r.prev=m,m.next.prev=r,m.next=r):(r.prev=r,r.next=r);return r}function x(r){r.next.prev=r.prev;r.prev.next=r.next;r.prevZ&&(r.prevZ.nextZ=
r.nextZ);r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function k(r,A){let w=A;const m=r.x,t=r.y;let B=-Infinity,J;do{if(t<=w.y&&t>=w.next.y&&w.next.y!==w.y){var C=w.x+(t-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(C<=m&&C>B){B=C;if(C===m){if(t===w.y)return w;if(t===w.next.y)return w.next}J=w.x<w.next.x?w:w.next}}w=w.next}while(w!==A);if(!J)return null;if(m===B)return J.prev;A=J;C=J.x;const K=J.y;let E=Infinity,I;for(w=J.next;w!==A;)m>=w.x&&w.x>=C&&m!==w.x&&h(t<K?m:B,t,C,K,t<K?B:m,t,w.x,w.y)&&(I=Math.abs(t-w.y)/(m-
w.x),(I<E||I===E&&w.x>J.x)&&e(w,r)&&(J=w,E=I)),w=w.next;return J}function g(r,A,w,m){for(var t;t!==r;t=t.next){t=t||r;null===t.z&&(t.z=f(t.x,t.y,A,w,m));if(t.prev.next!==t||t.next.prev!==t)return t.prev.next=t,t.next.prev=t,g(r,A,w,m);t.prevZ=t.prev;t.nextZ=t.next}r.prevZ.nextZ=null;r.prevZ=null;a:for(w=1;;){m=r;A=r=null;let B=0;for(;m;){B++;t=m;let J=0;for(;J<w&&t;J++)t=t.nextZ;let C=w;for(;0<J||0<C&&t;){let K;0===J?(K=t,t=t.nextZ,C--):0!==C&&t?m.z<=t.z?(K=m,m=m.nextZ,J--):(K=t,t=t.nextZ,C--):(K=
m,m=m.nextZ,J--);A?A.nextZ=K:r=K;K.prevZ=A;A=K}m=t}A.nextZ=null;w*=2;if(2>B)break a}return r}function b(r,A,w){return(A.y-r.y)*(w.x-A.x)-(A.x-r.x)*(w.y-A.y)}function a(r,A,w,m){return c(r,A)&&c(w,m)||c(r,m)&&c(w,A)?!0:0<b(r,A,w)!==0<b(r,A,m)&&0<b(w,m,r)!==0<b(w,m,A)}function h(r,A,w,m,t,B,J,C){return 0<=(t-J)*(A-C)-(r-J)*(B-C)&&0<=(r-J)*(m-C)-(w-J)*(A-C)&&0<=(w-J)*(B-C)-(t-J)*(m-C)}function e(r,A){return 0>b(r.prev,r,r.next)?0<=b(r,A,r.next)&&0<=b(r,r.prev,A):0>b(r,A,r.prev)||0>b(r,r.next,A)}function f(r,
A,w,m,t){r=32767*(r-w)*t;A=32767*(A-m)*t;r=(r|r<<8)&16711935;r=(r|r<<4)&252645135;r=(r|r<<2)&858993459;A=(A|A<<8)&16711935;A=(A|A<<4)&252645135;A=(A|A<<2)&858993459;return(r|r<<1)&1431655765|((A|A<<1)&1431655765)<<1}function c(r,A){return r.x===A.x&&r.y===A.y}function d(r,A){return r.x-A.x}function p(r,A){const w=v.create(r.index,r.x,r.y),m=v.create(A.index,A.x,A.y),t=r.next,B=A.prev;r.next=A;A.prev=r;w.next=t;t.prev=w;m.next=w;w.prev=m;B.next=m;m.prev=B;return m}let v=function(){function r(){this.y=
this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}r.create=function(A,w,m){const t=u<l.length?l[u++]:new r;t.index=A;t.x=w;t.y=m;t.prev=null;t.next=null;t.z=null;t.prevZ=null;t.nextZ=null;t.steiner=!1;return t};return n._createClass(r)}();const l=[];let u=0;for(let r=0;8096>r;r++)l.push(new v);q.bufcut=function(r,A,w,m,t,B,J){u=0;var C=(m-w)*B,K=t&&t.length;const E=K?(t[0]-w)*B:C;var I=G(A,w,m,0,E,B,!0);if(I&&I.next!==I.prev){var H;if(K){const aa=[];for(let ka=
0,V=t.length;ka<V;ka++){const P=G(A,w,m,t[ka]*B,ka<V-1?t[ka+1]*B:m*B,B,!1);P===P.next&&(P.steiner=!0);K=aa;var N=K.push;let S=P,X=P;do{if(S.x<X.x||S.x===X.x&&S.y<X.y)X=S;S=S.next}while(S!==P);N.call(K,X)}aa.sort(d);for(var U of aa)if(m=U,t=k(m,I))m=p(t,m),F(m,m.next),I=F(t,t.next)}if(C>80*B){var ba=C=A[w*B];var la=H=A[1+w*B];for(U=B;U<E;U+=B)m=A[U+w*B],t=A[U+1+w*B],ba=Math.min(ba,m),la=Math.min(la,t),C=Math.max(C,m),H=Math.max(H,t);H=Math.max(C-ba,H-la);H=0!==H?1/H:0}z(I,r,B,ba,la,H,J,0)}};Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(q,n,G,F,z,y,D,x,k,g,b,a){return function(h){function e(c,d,p,v,l,u,r,A,w,m,t,
B,J,C,K,E,I,H,N,U){var ba=f.call(this);c=k.LineMaterialKey.load(c);d&&(c.sdf=d.sdf,c.pattern=!0,c.textureBinding=d.textureBinding);ba._capType=v;ba._joinType=l;ba._miterLimitCosine=g.getLimitCosine(u);ba.tessellationProperties._fillColor=r;ba.tessellationProperties._tl=A;ba.tessellationProperties._br=w;ba._hasPattern=m;ba._isDashed=t;ba._zOrder=I;ba._effects=H;ba._minMaxZoom=D.i1616to32(Math.round(N*y.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(U*y.MIN_MAX_ZOOM_PRECISION_FACTOR));ba._materialKey=c.data;
ba.tessellationProperties._bitset=(J?y.BITSET_GENERIC_LOCK_COLOR:0)|(C?y.BITSET_TYPE_FILL_OUTLINE:0)|(B?y.BITSET_LINE_SCALE_DASH:0)|(K?y.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);ba.tessellationProperties._halfWidth=.5*p;ba.tessellationProperties._halfReferenceWidth=.5*E;ba.tessellationProperties.offset=0;ba._initializeTessellator(!1);return ba}q._inherits(e,h);var f=q._createSuper(e);e.fromCIMLine=function(c,d,p){var v=c.color,l=c.scaleFactor||1;const u=!!c.dashTemplate;let r=c.cap;u&&r===F.CapType.ROUND&&
(r=F.CapType.SQUARE);const A=c.join;l*=G.pt2px(c.width);const w=G.pt2px(c.referenceWidth),m=G.pt2px(c.miterLimit);v=v&&z.premultiplyAlphaRGBA(v)||0;const [t,B]=g.getMinMaxZoom(c.scaleInfo,p);if(!d)return new e(c.materialKey,d,l,r,A,m,v,0,0,!1,u,c.scaleDash??!1,c.colorLocked??!1,!1,c.sampleAlphaOnly,w,c.zOrder,c.effects,t,B);const {rect:J,width:C,height:K}=d;var E=J.x+y.SPRITE_PADDING;const I=J.y+y.SPRITE_PADDING;p=E+C;const H=I+K;E=D.i1616to32(E,I);p=D.i1616to32(p,H);return new e(c.materialKey,d,
l,r,A,m,v,E,p,!0,u,c.scaleDash??!1,c.colorLocked??!1,!1,c.sampleAlphaOnly,w,c.zOrder,c.effects,t,B)};e.fromFillOutline=function(c){const d=k.FillMaterialKey.load(c.materialKey);return k.hasOutlineFillSymbology(d)&&c.outline&&"esriSLSSolid"===c.outline?.style?e.fromSimpleLine({hash:"",materialKey:c.materialKey,...c.outline},null,!0):null};e.fromSimpleLine=function(c,d,p=!1){var {color:v}=c;const l="esriSLSSolid"!==c.style&&"esriSLSNull"!==c.style,u=x.getCapType(c.cap||"round"),r=x.getJoinType(c.join||
"round");v=v&&"esriSLSNull"!==c.style&&z.premultiplyAlphaRGBAArray(v)||0;"esriSLSNull"===c.style&&(v=0);const A=G.pt2px(c.width),w=c.miterLimit;if(!d)return new e(c.materialKey,d,A,u,r,w,v,0,0,!1,l,!0,!1,p,!1,A,0,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM);const {rect:m,width:t,height:B}=d;var J=m.x+y.SPRITE_PADDING;const C=m.y+y.SPRITE_PADDING;var K=J+t;const E=C+B;J=D.i1616to32(J,C);K=D.i1616to32(K,E);return new e(c.materialKey,d,A,u,r,w,v,J,K,!0,l,!0,!1,p,!1,A,0,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM)};
e.fromPictureLineSymbol=function(c,d,p,v){n.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate").error("PictureLineSymbol support does not exist!");return null};return q._createClass(e)}(b(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(q,n,G,F,z,y,D,
x){const k=(a,h,e)=>(f,c,d,p,v,l,u,r,A,w,m)=>{d=z.i1616to32(m,Math.ceil(16*a._halfWidth));u=z.i8888to32(Math.round(16*u),Math.round(16*r),Math.round(16*A),Math.round(16*w));v=z.i8888to32(16*v,16*l,0,a._bitset);l=a.out;l.vertexBounds(f,c,h,e);l.vertexWrite(z.i1616to32(8*f,8*c));l.vertexWrite(a.id);l.vertexWrite(a._fillColor);l.vertexWrite(u);l.vertexWrite(d);l.vertexWrite(a._tl);l.vertexWrite(a._br);l.vertexWrite(v);l.vertexWrite(z.i1616to32(Math.ceil(16*a._halfReferenceWidth),0));l.vertexWrite(a.minMaxZoom);
l.vertexEnd();return a.offset+a.vertexCount++},g=(a,h,e)=>(f,c,d,p,v,l,u,r,A,w,m)=>{d=z.i1616to32(16*a._halfWidth,16*a._halfReferenceWidth);u=z.i8888to32(16*u+128,16*r+128,16*A+128,16*w+128);r=a.out;A=a._bitset<<24|a.id;r.vertexBounds(f,c,h,e);r.vertexWrite(z.i1616to32(8*f,8*c));r.vertexWrite(A);r.vertexWrite(a._fillColor);f=D.hasSimpleSymbology(a.key);f||(r.vertexWrite(0),r.vertexWrite(0));r.vertexWrite(0);r.vertexWrite(d);r.vertexWrite(u);f||r.vertexWrite(a.minMaxZoom);r.vertexEnd();return a.offset+
a.vertexCount++},b=a=>(h,e,f)=>{const c=a.out;c.indexWrite(h);c.indexWrite(e);c.indexWrite(f);a.indexCount+=3};return a=>function(h){function e(...c){c=f.call(this,...c);c.tessellationProperties={};c._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};c.geometryType=F.WGLGeometryType.LINE;return c}q._inherits(e,h);var f=q._createSuper(e);h=e.prototype;h.writeGeometry=function(c,d,p,v){this._writeGeometry(c,d,p,v)};h._initializeTessellator=function(c){var d=D.LineMaterialKey.load(this._materialKey),
p=D.FillMaterialKey.load(this._materialKey),v=this._tessellationOptions;d=d.vvSizeFieldStops||d.vvSizeMinMaxValue||d.vvSizeScaleStops||d.vvSizeUnitValue;c=this.tessellationProperties._halfWidth<G.THIN_LINE_HALF_WIDTH_THRESHOLD&&!c&&!d;this.tessellationProperties.minMaxZoom=this._minMaxZoom;v.wrapDistance=65535;v.textured=this._isDashed||this._hasPattern;v.offset=this.tessellationProperties.offset;v.halfWidth=this.tessellationProperties._halfWidth;v=c?0:1;p=D.hasOutlineFillSymbology(p)?g:k;this._lineTessellator=
new y.LineTessellation(p(this.tessellationProperties,v,v),b(this.tessellationProperties),c)};h._write=function(c,d,p,v){p="esriGeometryPoint"===d.geometryType;c.recordStart(d.getDisplayId(),this._materialKey,this.geometryType,p);this._writeGeometry(c,d,v,p);c.recordEnd()};h._writeGeometry=function(c,d,p,v){p=p??d.readLegacyGeometryForDisplay();v=this._getLines(p,v);n.isNone(v)||this._writeVertices(c,d,v)};h._getLines=function(c,d){if(n.isNone(c))return null;c=c.paths||c.rings;return n.isNone(c)?null:
x.clipLinesMarshall(c,d?256:16)};h._writeVertices=function(c,d,p){const v=d.getDisplayId(),l=c.vertexCount(),u=this.tessellationProperties;d=this._tessellationOptions;u.out=c;u.id=v;u.indexCount=0;u.vertexCount=0;u.offset=l;d.capType=this._capType;d.joinType=this._joinType;c=D.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=D.hasOutlineFillSymbology(c)?c:D.LineMaterialKey.load(this._materialKey);for(const {line:r,start:A}of p)d.initialDistance=A%65535,this._lineTessellator.tessellate(r,
d)};return q._createClass(e)}(a)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(q,n,G,F,z){const y=n.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(D){function x(g){var b=k.call(this);b._ongoingMaterialRequestMap=new Map;b._materialCache=
new Map;b._dynamicPropertyMap=new Map;b._cimLayer=g;return b}q._inherits(x,D);var k=q._createSuper(x);x.prototype.analyze=async function(g,b,a,h,e){if(e&&0===e.length)return null;const f=e&&0<e.length,c=b.readLegacyFeature();b=b.getObjectId();const d=this._materialCache;var p=this._cimLayer.materialHash;if(!p)return y.error("A Dynamic mesh template must have a material hash value or function!"),null;const v="function"===typeof p?p(c,a,h,b):p;p=d.get(v);if(null!=p||(p=this._ongoingMaterialRequestMap.get(v)))return p;
p=this._cimLayer;const l=G.analyzeCIMResource(p.cim,this._cimLayer.materialOverrides);l.mosaicHash=v;const {type:u,url:r}=p;b={cim:l,type:u,mosaicHash:v,url:r,size:null,dashTemplate:null,text:null,fontName:null,objectId:b,animatedSymbolProperties:null};switch(u){case "marker":b.size=F.evaluateValueOrFunction(p.size,c,a,h);b.animatedSymbolProperties=F.evaluateValueOrFunction(p.animatedSymbolProperties,c,a,h);break;case "line":b.dashTemplate=p.dashTemplate;break;case "text":b.text=F.evaluateValueOrFunction(p.text,
c,a,h),b.fontName=F.evaluateValueOrFunction(p.fontName,c,a,h)}g=g.getMosaicItem(b,e).then(A=>{f||(this._ongoingMaterialRequestMap.delete(v),d.set(v,A));return A}).catch(A=>{this._ongoingMaterialRequestMap.delete(v);y.error(".analyze()",A.message);return null});f||this._ongoingMaterialRequestMap.set(v,g);return g};return q._createClass(x)}(z)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../Color ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./quantizeTime ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/grouping".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p){function v(Y){switch(Y){case "Butt":return b.CapType.BUTT;case "Square":return b.CapType.SQUARE;default:return b.CapType.ROUND}}function l(Y){switch(Y){case "Bevel":return b.JoinType.BEVEL;case "Miter":return b.JoinType.MITER;default:return b.JoinType.ROUND}}function u(Y,ua,ca,ia){let oa;Y[ua]?oa=Y[ua]:(oa={},Y[ua]=oa);oa[ca]=ia}function r(Y){return(Y=Y.markerPlacement)&&Y.angleToLine?b.Alignment.MAP:b.Alignment.SCREEN}function A(Y,ua,ca,ia,oa,M,Q){if(Y){var fa=
Y.symbolLayers;if(fa){var na=Y.effects,za=b.Alignment.SCREEN,W=g.CIMSymbolHelper.getSize(Y)??0;"CIMPointSymbol"===Y.type&&"Map"===Y.angleAlignment&&(za=b.Alignment.MAP);for(var da=fa.length;da--;){var ha=fa[da];if(!ha||!1===ha.enable)continue;let Ta;na&&na.length&&(Ta=[...na]);var ma=ha.effects;ma&&ma.length&&(na?Ta.push(...ma):Ta=[...ma]);ma=[];g.OverrideHelper.findEffectOverrides(Ta,ua,ma);ma=0<ma.length?ka(Ta,ma,ca,ia):Ta;var qa=[];g.OverrideHelper.findApplicableOverrides(ha,ua,qa);switch(ha.type){case "CIMSolidFill":w(ha,
ma,ca,qa,ia,oa);break;case "CIMPictureFill":m(ha,ma,ca,qa,ia,M,oa);break;case "CIMHatchFill":t(ha,ma,ca,qa,ia,oa);break;case "CIMGradientFill":var wa=ca,ya=ia,Ea=oa;const [Qa,Ya]=X(qa,ha.primitiveName,ma,null,null);var Da=x.numericHash(JSON.stringify(ha)+Ya).toString();Ea.push({type:"fill",templateHash:Da,materialHash:Qa?S(Da,wa,qa,ya):Da,cim:ha,materialOverrides:null,colorLocked:!!ha.colorLocked,effects:ma,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,
sampleAlphaOnly:!1});break;case "CIMSolidStroke":B(ha,ma,ca,qa,ia,oa,"CIMPolygonSymbol"===Y.type,W);break;case "CIMPictureStroke":J(ha,ma,ca,qa,ia,oa,"CIMPolygonSymbol"===Y.type,W);break;case "CIMGradientStroke":wa=ca;ya=ia;Ea=oa;Da="CIMPolygonSymbol"===Y.type;var Ia=W,Ja=ha.primitiveName,La=null!=ha.width?ha.width:4,Ra=v(ha.capStyle),Pa=l(ha.joinStyle),Sa=ha.miterLimit;const [Za,Ha]=X(qa,Ja,ma,null,null),gb=x.numericHash(JSON.stringify(ha)+Ha).toString();Ea.push({type:"line",templateHash:gb,materialHash:Za?
S(gb,wa,qa,ya):gb,cim:ha,materialOverrides:null,isOutline:Da,colorLocked:!!ha.colorLocked,effects:ma,color:{r:128,g:128,b:128,a:1},width:la(Ja,wa,"Width",ya,La),cap:la(Ja,wa,"CapStyle",ya,Ra),join:la(Ja,wa,"JoinStyle",ya,Pa),miterLimit:Sa&&la(Ja,wa,"MiterLimit",ya,Sa),referenceWidth:Ia,zOrder:U(ha.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1});break;case "CIMCharacterMarker":C(ha,ma,ca,qa,ia,oa);break;case "CIMPictureMarker":if(C(ha,ma,ca,qa,ia,oa))break;"CIMLineSymbol"===Y.type&&(za=r(ha));
K(ha,ma,ca,qa,ia,M,oa,za,W);break;case "CIMVectorMarker":if(C(ha,ma,ca,qa,ia,oa))break;"CIMLineSymbol"===Y.type&&(za=r(ha));wa=ca;ya=ia;Ea=oa;Da=M;Ia=za;Ja=W;La=Q;if(Pa=ha.markerGraphics){Ra=0;ha.scaleSymbolsProportionally&&(Sa=ha.frame)&&(Ra=Sa.ymax-Sa.ymin);Sa=V(ha.markerPlacement,qa,wa,ya);for(const lb of Pa)if(lb&&(Pa=lb.symbol))switch(Pa.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":I(ha,ma,Sa,null,lb,qa,wa,ya,Ea,Da,Ia,Ja,Ra,!!La);break;case "CIMTextSymbol":E(ha,ma,
Sa,lb,wa,qa,ya,Ea,Ia,Ja,Ra)}}break;default:ra.error("Cannot analyze CIM layer",ha.type)}}}}}function w(Y,ua,ca,ia,oa,M){const Q=Y.primitiveName,fa=e.fromCIMColor(Y.color),[na,za]=X(ia,Q,ua,null,null),W=x.numericHash(JSON.stringify(Y)+za).toString();M.push({type:"fill",templateHash:W,materialHash:na?()=>W:W,cim:Y,materialOverrides:null,colorLocked:!!Y.colorLocked,color:la(Q,ca,"Color",oa,fa,ba),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:ua,applyRandomOffset:!1,sampleAlphaOnly:!0})}function m(Y,
ua,ca,ia,oa,M,Q){const fa=Y.primitiveName,na=e.getTintColor(Y),[za,W]=X(ia,fa,ua,null,null);ia=x.numericHash(JSON.stringify(Y)+W).toString();const da=x.numericHash(`${Y.url}${JSON.stringify(Y.colorSubstitutions)}`).toString();let ha=e.getValue(Y.scaleX);if("width"in Y&&"number"===typeof Y.width){const ma=Y.width;let qa=1;M=M.getResource(Y.url);y.isSome(M)&&(qa=M.width/M.height);ha/=Y.height/ma*qa}Q.push({type:"fill",templateHash:ia,materialHash:za?()=>da:da,cim:Y,materialOverrides:null,colorLocked:!!Y.colorLocked,
effects:ua,color:la(fa,ca,"TintColor",oa,na,ba),height:la(fa,ca,"Height",oa,Y.height),scaleX:la(fa,ca,"ScaleX",oa,ha),angle:la(fa,ca,"Rotation",oa,e.getValue(Y.rotation)),offsetX:la(fa,ca,"OffsetX",oa,e.getValue(Y.offsetX)),offsetY:la(fa,ca,"OffsetY",oa,e.getValue(Y.offsetY)),url:Y.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function t(Y,ua,ca,ia,oa,M){const Q=["Rotation","OffsetX","OffsetY"],fa=ia.filter(wa=>wa.primitiveName!==Y.primitiveName||!Q.includes(wa.propertyName)),na=Y.primitiveName;let [za,
W]=X(ia,na,ua,null,null);ia=x.numericHash(JSON.stringify(Y)+W).toString();const da=x.numericHash(`${Y.separation}${JSON.stringify(Y.lineSymbol)}`).toString();let ha={r:255,g:255,b:255,a:1};var ma=!1;const qa=Y.lineSymbol?.symbolLayers?.find(wa=>"CIMSolidStroke"===wa.type&&null!=ca[wa.primitiveName]?.Color);qa&&(ha=e.fromCIMColor(qa.color),ha=la(qa.primitiveName,ca,"Color",oa,ha,ba),ma="function"===typeof ha,za=za||ma,ma=null!=qa.color||ma);M.push({type:"fill",templateHash:ia,materialHash:za?S(da,
ca,fa,oa):da,cim:Y,materialOverrides:fa,colorLocked:!!Y.colorLocked,effects:ua,color:ha,height:la(na,ca,"Separation",oa,Y.separation),scaleX:1,angle:la(na,ca,"Rotation",oa,e.getValue(Y.rotation)),offsetX:la(na,ca,"OffsetX",oa,e.getValue(Y.offsetX)),offsetY:la(na,ca,"OffsetY",oa,e.getValue(Y.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0,hasUnresolvedReplacementColor:!ma})}function B(Y,ua,ca,ia,oa,M,Q,fa){const na=Y.primitiveName,za=e.fromCIMColor(Y.color),W=null!=Y.width?Y.width:4,da=v(Y.capStyle),
ha=l(Y.joinStyle),ma=Y.miterLimit,[qa,wa]=X(ia,na,ua,null,null),ya=x.numericHash(JSON.stringify(Y)+wa).toString();let Ea;if(ua&&ua instanceof Array&&0<ua.length&&(ia=ua[ua.length-1],"CIMGeometricEffectDashes"===ia.type&&"NoConstraint"===ia.lineDashEnding&&null===ia.offsetAlongLine)){ua=[...ua];var Da=ua.pop();Ea=Da.dashTemplate;Da=Da.scaleDash}M.push({type:"line",templateHash:ya,materialHash:qa?()=>ya:ya,cim:Y,materialOverrides:null,isOutline:Q,colorLocked:!!Y.colorLocked,effects:ua,color:la(na,ca,
"Color",oa,za,ba),width:la(na,ca,"Width",oa,W),cap:la(na,ca,"CapStyle",oa,da),join:la(na,ca,"JoinStyle",oa,ha),miterLimit:ma&&la(na,ca,"MiterLimit",oa,ma),referenceWidth:fa,zOrder:U(Y.name),dashTemplate:Ea,scaleDash:Da,sampleAlphaOnly:!0})}function J(Y,ua,ca,ia,oa,M,Q,fa){const na=x.numericHash(`${Y.url}${JSON.stringify(Y.colorSubstitutions)}`).toString(),za=Y.primitiveName,W=e.getTintColor(Y),da=null!=Y.width?Y.width:4,ha=v(Y.capStyle),ma=l(Y.joinStyle),qa=Y.miterLimit,[wa,ya]=X(ia,za,ua,null,null);
ia=x.numericHash(JSON.stringify(Y)+ya).toString();M.push({type:"line",templateHash:ia,materialHash:wa?()=>na:na,cim:Y,materialOverrides:null,isOutline:Q,colorLocked:!!Y.colorLocked,effects:ua,color:la(za,ca,"TintColor",oa,W,ba),width:la(za,ca,"Width",oa,da),cap:la(za,ca,"CapStyle",oa,ha),join:la(za,ca,"JoinStyle",oa,ma),miterLimit:qa&&la(za,ca,"MiterLimit",oa,qa),referenceWidth:fa,zOrder:U(Y.name),dashTemplate:null,scaleDash:!1,url:Y.url,sampleAlphaOnly:!1})}function C(Y,ua,ca,ia,oa,M){const {markerPlacement:Q,
type:fa}=Y;if(!Q||"CIMMarkerPlacementInsidePolygon"!==Q.type)return!1;if("CIMVectorMarker"===fa||"CIMPictureMarker"===fa){var na=Y.primitiveName;if(na&&([na]=X(ia,na,ua,null,null),na))return!1;if(na=Q.primitiveName)if([na]=X(ia,na,ua,null,null),na)return!1;if("CIMVectorMarker"===fa){if({markerGraphics:na}=Y,na)for(var za of na)if({symbol:na}=za,"CIMPolygonSymbol"===na?.type&&na.symbolLayers){({symbolLayers:na}=na);for(var W of na)if("CIMSolidStroke"===W.type)return!1}}else if({animatedSymbolProperties:za}=
Y,za)return!1}na=Math.abs(Q.stepX);var da=Math.abs(Q.stepY);if(0===na||0===da)return!0;const ha=["Rotation","OffsetX","OffsetY"];za=ia.filter(Ea=>Ea.primitiveName!==Y.primitiveName||!ha.includes(Ea.propertyName));W="url"in Y&&"string"===typeof Y.url?Y.url:void 0;const [ma,qa]=X(ia,Q.primitiveName,ua,null,null);ia=x.numericHash(JSON.stringify(Y)+qa).toString();let wa=null;if("Random"===Q.gridType){var ya=D.px2pt(d.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const Ea=Math.max(Math.floor(ya/na),1),Da=Math.max(Math.floor(ya/
da),1);ya=da*Da;wa=Ia=>Ia?Ia*Da:0;na=Ea*na/ya}else Q.shiftOddRows?(ya=2*da,wa=Ea=>Ea?2*Ea:0,na=na/da*.5):(ya=da,wa=null,na/=da);da=e.getTintColor(Y);M.push({type:"fill",templateHash:ia,materialHash:ma?S(ia,ca,za,oa):ia,cim:Y,materialOverrides:za,colorLocked:!!Y.colorLocked,effects:ua,color:la(Q.primitiveName,ca,"TintColor",oa,da,ba),height:la(Q.primitiveName,ca,"StepY",oa,ya,wa),scaleX:na,angle:la(Q.primitiveName,ca,"GridAngle",oa,Q.gridAngle),offsetX:la(Q.primitiveName,ca,"OffsetX",oa,e.getValue(Q.offsetX)),
offsetY:la(Q.primitiveName,ca,"OffsetY",oa,e.getValue(Q.offsetY)),url:W,applyRandomOffset:"Random"===Q.gridType,sampleAlphaOnly:!W,hasUnresolvedReplacementColor:!0});return!0}function K(Y,ua,ca,ia,oa,M,Q,fa,na){function za(Pa,Sa){return y.isSome(Ia)?e.evaluateValueOrFunction(Ia,Pa,Sa):null}const W=Y.primitiveName,da=e.getValue(Y.size);let ha=e.getValue(Y.scaleX,1);const ma=e.getValue(Y.rotation),qa=e.getValue(Y.offsetX),wa=e.getValue(Y.offsetY),ya=e.getTintColor(Y),Ea=x.numericHash(`${Y.url}${JSON.stringify(Y.colorSubstitutions)}${JSON.stringify(Y.animatedSymbolProperties)}`).toString(),
Da=V(Y.markerPlacement,ia,ca,oa),Ia=P(Y.animatedSymbolProperties,ia,ca,oa),[Ja,La]=X(ia,W,ua,Da,Ia);ia=x.numericHash(JSON.stringify(Y)+La).toString();const Ra=Y.anchorPoint??{x:0,y:0};if("width"in Y&&"number"===typeof Y.width){const Pa=Y.width;let Sa=1;M=M.getResource(Y.url);y.isSome(M)&&(Sa=M.width/M.height);ha/=da/Pa*Sa}Q.push({type:"marker",templateHash:ia,materialHash:Y.animatedSymbolProperties&&!0===Y.animatedSymbolProperties.randomizeStartTime?(Pa,Sa,Ta,Qa)=>{Ta=p.getMaterialGroup(Qa??0);Pa=
za(Pa,Sa);return Ea+`-MATERIALGROUP(${Ta})`+`-ASP(${JSON.stringify(Pa)})`}:Ja?(Pa,Sa)=>{Pa=za(Pa,Sa);return Ea+`-ASP(${JSON.stringify(Pa)})`}:Ea,cim:Y,materialOverrides:null,colorLocked:!!Y.colorLocked,effects:ua,scaleSymbolsProportionally:!1,alignment:fa,size:la(W,ca,"Size",oa,da),scaleX:la(W,ca,"ScaleX",oa,ha),rotation:la(W,ca,"Rotation",oa,ma),offsetX:la(W,ca,"OffsetX",oa,qa),offsetY:la(W,ca,"OffsetY",oa,wa),color:la(W,ca,"TintColor",oa,ya,ba),anchorPoint:{x:Ra.x,y:-Ra.y},isAbsoluteAnchorPoint:"Relative"!==
Y.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:!!Y.rotateClockwise,referenceSize:na,sizeRatio:1,markerPlacement:Da,url:Y.url,animatedSymbolProperties:Ia})}function E(Y,ua,ca,ia,oa,M,Q,fa,na,za,W){g.OverrideHelper.findApplicableOverrides(ia,M,[]);var da=ia.geometry;if("x"in da&&"y"in da){var ha=ia.symbol,ma=e.fromCIMFontDecoration(ha),qa=e.fromCIMFontStyle(ha.fontStyleName),wa=G.getFontFamily(ha.fontFamilyName);ha.font={family:wa,decoration:ma,...qa};
var ya=Y.frame,Ea=da.x-.5*(ya.xmin+ya.xmax),Da=da.y-.5*(ya.ymin+ya.ymax),Ia=Y.size/W;W=Y.primitiveName;da=e.getValue(ha.height)*Ia;ya=e.getValue(ha.angle);Ea=e.getValue(Y.offsetX)+(e.getValue(ha.offsetX)+Ea)*Ia;Da=e.getValue(Y.offsetY)+(e.getValue(ha.offsetY)+Da)*Ia;var Ja=e.fromCIMColor(e.getFillColor(ha)),La=e.fromCIMColor(e.getStrokeColor(ha)),Ra=e.getStrokeWidth(ha)??0;Ra||(La=e.fromCIMColor(e.getFillColor(ha.haloSymbol)),ha.haloSize&&(Ra=ha.haloSize*Ia));var Pa=Ia=null,Sa=0;if(ha.callout&&"CIMBackgroundCallout"===
ha.callout.type){var Ta=ha.callout;if(Ta.backgroundSymbol&&(Ta=Ta.backgroundSymbol.symbolLayers))for(const gb of Ta)"CIMSolidFill"===gb.type?Ia=e.fromCIMColor(gb.color):"CIMSolidStroke"===gb.type&&(Pa=e.fromCIMColor(gb.color),Sa=e.getValue(gb.width))}var [Qa,Ya]=X(M,W,ua,ca,null);M=JSON.stringify(Y.effects)+Number(Y.colorLocked).toString()+JSON.stringify(Y.anchorPoint)+Y.anchorPointUnits+JSON.stringify(Y.markerPlacement)+Y.size.toString();M=x.numericHash(JSON.stringify(ia)+M+Ya).toString();var Za=
la(ia.primitiveName,oa,"TextString",Q,ia.textString??"",e.adjustTextCase,ha.textCase);if(null!=Za){({fontStyleName:ia}=ha);var Ha=wa+(ia?"-"+ia.toLowerCase():"-regular");"string"===typeof Za&&Za.includes("[")&&ha.fieldMap&&(Za=e.createLabelOverrideFunction(ha.fieldMap,Za,ha.textCase));fa.push({type:"text",templateHash:M,materialHash:Qa||"function"===typeof Za||Za.match(/\[(.*?)\]/)?(gb,lb,cb)=>Ha+"-"+e.evaluateValueOrFunction(Za,gb,lb,cb):Ha+"-"+x.numericHash(Za),cim:ha,materialOverrides:null,colorLocked:!!Y.colorLocked,
effects:ua,alignment:na,anchorPoint:{x:Y.anchorPoint?Y.anchorPoint.x:0,y:Y.anchorPoint?Y.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==Y.anchorPointUnits,fontName:Ha,decoration:ma,weight:la(W,oa,"Weight",Q,qa.weight),style:la(W,oa,"Size",Q,qa.style),size:la(W,oa,"Size",Q,da),angle:la(W,oa,"Rotation",Q,ya),offsetX:la(W,oa,"OffsetX",Q,Ea),offsetY:la(W,oa,"OffsetY",Q,Da),horizontalAlignment:e.fromCIMHorizontalAlignment(ha.horizontalAlignment),verticalAlignment:e.fromCIMVerticalAlignment(ha.verticalAlignment),
text:Za,color:Ja,outlineColor:La,outlineSize:Ra,backgroundColor:Ia,borderLineColor:Pa,borderLineWidth:Sa,referenceSize:za,sizeRatio:1,markerPlacement:ca})}}}function I(Y,ua,ca,ia,oa,M,Q,fa,na,za,W,da,ha,ma){var qa=oa.symbol;const wa=qa.symbolLayers;if(wa)if(ma)N(Y,ua,ca,ia,oa,Q,M,fa,na,za,W,da,ha);else if(ma=wa.length,wa&&2===wa.length&&wa[0].enable&&wa[1].enable&&"CIMSolidStroke"===wa[0].type&&"CIMSolidFill"===wa[1].type&&!wa[0].effects&&!wa[1].effects)H(Y,ua,ca,ia,oa,wa,M,Q,fa,na,W,da,ha);else if(qa=
f.CIMEffectHelper.applyEffects(qa.effects,oa.geometry,za.geometryEngine))for(;ma--;){var ya=wa[ma];if(ya&&!1!==ya.enable)switch(ya.type){case "CIMSolidFill":case "CIMSolidStroke":var Ea=f.CIMEffectHelper.applyEffects(ya.effects,qa,za.geometryEngine),Da=h.getExtent(Ea);if(!Da)continue;const La="Relative"!==Y.anchorPointUnits,[Ra,Pa,Sa]=h.getSDFMetrics(Da,Y.frame,Y.size,Y.anchorPoint,La);var Ia="CIMSolidFill"===ya.type;Ea={type:"sdf",geom:Ea,asFill:Ia};var Ja=Y.primitiveName;Da=e.getValue(Y.size)??
10;const Ta=e.getValue(Y.rotation),Qa=e.getValue(Y.offsetX),Ya=e.getValue(Y.offsetY),Za=ya.path,Ha=ya.primitiveName,gb=Ia?e.fromCIMColor(e.getFillColor(ya)):e.fromCIMColor(e.getStrokeColor(ya)),lb=Ia?{r:0,g:0,b:0,a:0}:e.fromCIMColor(e.getStrokeColor(ya)),cb=e.getStrokeWidth(ya)??0;if(!Ia&&!cb)break;Ia=!1;let O="";for(const sb of M)if(sb.primitiveName===Ha||sb.primitiveName===Ja)void 0!==sb.value?O+=`-${sb.primitiveName}-${sb.propertyName}-${JSON.stringify(sb.value)}`:sb.valueExpressionInfo&&(Ia=!0);
if(y.isSome(ua)&&"function"===typeof ua||y.isSome(ca)&&"function"===typeof ca)Ia=!0;Ja=JSON.stringify({...Y,markerGraphics:null});const fb=x.numericHash(JSON.stringify(Ea)+Za).toString();ya={type:"marker",templateHash:x.numericHash(JSON.stringify(oa)+JSON.stringify(ya)+Ja+O).toString(),materialHash:Ia?()=>fb:fb,cim:Ea,materialOverrides:null,colorLocked:!!Y.colorLocked,effects:ua,scaleSymbolsProportionally:!!Y.scaleSymbolsProportionally,alignment:W,anchorPoint:{x:Pa,y:Sa},isAbsoluteAnchorPoint:La,
size:la(Y.primitiveName,Q,"Size",fa,Da),rotation:la(Y.primitiveName,Q,"Rotation",fa,Ta),offsetX:la(Y.primitiveName,Q,"OffsetX",fa,Qa),offsetY:la(Y.primitiveName,Q,"OffsetY",fa,Ya),scaleX:1,frameHeight:ha,rotateClockwise:!!Y.rotateClockwise,referenceSize:da,sizeRatio:Ra,color:la(Ha,Q,"Color",fa,gb,ba),outlineColor:la(Ha,Q,"Color",fa,lb,ba),outlineWidth:la(Ha,Q,"Width",fa,cb),markerPlacement:ca,animatedSymbolProperties:ia,path:Za};na.push(ya);break;default:N(Y,ua,ca,ia,oa,Q,M,fa,na,za,W,da,ha)}}}function H(Y,
ua,ca,ia,oa,M,Q,fa,na,za,W,da,ha){var ma=oa.geometry;const qa=M[0];M=M[1];var wa=h.getExtent(ma);if(wa){var ya="Relative"!==Y.anchorPointUnits,[Ea,Da,Ia]=h.getSDFMetrics(wa,Y.frame,Y.size,Y.anchorPoint,ya);ma={type:"sdf",geom:ma,asFill:!0};var Ja=Y.primitiveName;wa=e.getValue(Y.size);var La=e.getValue(Y.rotation),Ra=e.getValue(Y.offsetX),Pa=e.getValue(Y.offsetY),Sa=M.path,Ta=M.primitiveName,Qa=qa.primitiveName,Ya=e.fromCIMColor(e.getFillColor(M)),Za=e.fromCIMColor(e.getStrokeColor(qa)),Ha=e.getStrokeWidth(qa)??
0,gb=!1,lb="";for(const O of Q)if(O.primitiveName===Ta||O.primitiveName===Qa||O.primitiveName===Ja)void 0!==O.value?lb+=`-${O.primitiveName}-${O.propertyName}-${JSON.stringify(O.value)}`:O.valueExpressionInfo&&(gb=!0);y.isSome(ca)&&"function"===typeof ca&&(gb=!0);Q=JSON.stringify({...Y,markerGraphics:null});var cb=x.numericHash(JSON.stringify(ma)+Sa).toString();Y={type:"marker",templateHash:x.numericHash(JSON.stringify(oa)+JSON.stringify(M)+JSON.stringify(qa)+Q+lb).toString(),materialHash:gb?()=>
cb:cb,cim:ma,materialOverrides:null,colorLocked:!!Y.colorLocked,effects:ua,scaleSymbolsProportionally:!!Y.scaleSymbolsProportionally,alignment:W,anchorPoint:{x:Da,y:Ia},isAbsoluteAnchorPoint:ya,size:la(Y.primitiveName,fa,"Size",na,wa),rotation:la(Y.primitiveName,fa,"Rotation",na,La),offsetX:la(Y.primitiveName,fa,"OffsetX",na,Ra),offsetY:la(Y.primitiveName,fa,"OffsetY",na,Pa),scaleX:1,frameHeight:ha,rotateClockwise:!!Y.rotateClockwise,referenceSize:da,sizeRatio:Ea,color:la(Ta,fa,"Color",na,Ya,ba),
outlineColor:la(Qa,fa,"Color",na,Za,ba),outlineWidth:la(Qa,fa,"Width",na,Ha),markerPlacement:ca,path:Sa,animatedSymbolProperties:ia};za.push(Y)}}function N(Y,ua,ca,ia,oa,M,Q,fa,na,za,W,da,ha){oa={type:Y.type,enable:!0,name:Y.name,colorLocked:Y.colorLocked,primitiveName:Y.primitiveName,anchorPoint:Y.anchorPoint,anchorPointUnits:Y.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:Y.rotateClockwise,rotation:0,size:Y.size,billboardMode3D:Y.billboardMode3D,depth3D:Y.depth3D,frame:Y.frame,markerGraphics:[oa],
scaleSymbolsProportionally:Y.scaleSymbolsProportionally,respectFrame:Y.respectFrame,clippingPath:Y.clippingPath};const ma=["Rotation","OffsetX","OffsetY"],qa=Q.filter(Ra=>Ra.primitiveName!==Y.primitiveName||!ma.includes(Ra.propertyName));var wa="";for(var ya of Q)void 0!==ya.value&&(wa+=`-${ya.primitiveName}-${ya.propertyName}-${JSON.stringify(ya.value)}`);const [Ea,Da,Ia]=g.CIMSymbolHelper.getTextureAnchor(oa,za);Q=Y.primitiveName;za=e.getValue(Y.rotation);ya=e.getValue(Y.offsetX);const Ja=e.getValue(Y.offsetY);
wa=x.numericHash(JSON.stringify(oa)+wa).toString();const La=0<qa.length||y.isSome(ua)&&"function"===typeof ua;ua={type:"marker",templateHash:wa,materialHash:La?S(wa,M,qa,fa):wa,cim:oa,materialOverrides:qa,colorLocked:!!Y.colorLocked,effects:ua,scaleSymbolsProportionally:!!Y.scaleSymbolsProportionally,alignment:W,anchorPoint:{x:Ea,y:Da},isAbsoluteAnchorPoint:!1,size:e.getValue(Y.size),rotation:la(Q,M,"Rotation",fa,za),offsetX:la(Q,M,"OffsetX",fa,ya),offsetY:la(Q,M,"OffsetY",fa,Ja),color:{r:255,g:255,
b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:ha,rotateClockwise:!!Y.rotateClockwise,referenceSize:da,sizeRatio:Ia/D.pt2px(Y.size),markerPlacement:ca,animatedSymbolProperties:ia,avoidSDFRasterization:!0};na.push(ua)}function U(Y){return Y&&0===Y.indexOf("Level_")&&(Y=parseInt(Y.substr(6),10),!isNaN(Y))?Y:0}function ba(Y){if(!Y||0===Y.length)return null;Y=(new n(Y)).toRgba();return{r:Y[0],g:Y[1],b:Y[2],a:Y[3]}}function la(Y,ua,ca,ia,oa,M,Q){if(null==Y)return oa;if(Y=
ua[Y]){const fa=Y[ca];if("string"===typeof fa||"number"===typeof fa||fa instanceof Array)return M?M.call(null,fa,Q):fa;if(null!=fa&&fa instanceof k.ArcadeExpression&&ia?.geometryType)return(na,za,W)=>{na=c(fa,na,{$view:W},ia.geometryType,za);null!==na&&M&&(na=M.call(null,na,Q));return null!==na?na:oa}}return oa}function aa(Y){return Y?Y.charAt(0).toLowerCase()+Y.substr(1):Y}function ka(Y,ua,ca,ia){for(const oa of ua)if(oa.valueExpressionInfo&&ia?.geometryType){const M=ca[oa.primitiveName]&&ca[oa.primitiveName][oa.propertyName];
M instanceof k.ArcadeExpression&&(oa.fn=(Q,fa,na)=>c(M,Q,{$view:na},ia.geometryType,fa))}return(oa,M,Q)=>{for(var fa of ua)fa.fn&&(fa.value=fa.fn(oa,M,Q));oa=[];for(let na of Y){if(M=na?.primitiveName){Q=!1;for(const za of ua)za.primitiveName===M&&(fa=aa(za.propertyName),null!=za.value&&za.value!==na[fa]&&(Q||(na=F.clone(na),Q=!0),na[fa]=za.value))}oa.push(na)}return oa}}function V(Y,ua,ca,ia){const oa=[];g.OverrideHelper.findApplicableOverrides(Y,ua,oa);if(null==Y||0===oa.length)return Y;for(const M of oa)if(M.valueExpressionInfo&&
ia?.geometryType){const Q=ca[M.primitiveName]&&ca[M.primitiveName][M.propertyName];Q instanceof k.ArcadeExpression&&(M.fn=(fa,na,za)=>c(Q,fa,{$view:za},ia.geometryType,na))}return(M,Q,fa)=>{for(const na of oa)na.fn&&(na.value=na.fn(M,Q,fa));M=F.clone(Y);Q=Y.primitiveName;for(const na of oa)na.primitiveName===Q&&(fa=aa(na.propertyName),null!=na.value&&na.value!==M[fa]&&(M[fa]=na.value));return M}}function P(Y,ua,ca,ia){const oa=[];g.OverrideHelper.findApplicableOverrides(Y,ua,oa);if(null==Y||0===oa.length)return Y;
for(const M of oa)if(M.valueExpressionInfo&&ia?.geometryType){const Q=ca[M.primitiveName]&&ca[M.primitiveName][M.propertyName];Q instanceof k.ArcadeExpression&&(M.fn=(fa,na,za)=>c(Q,fa,{$view:za},ia.geometryType,na))}return(M,Q,fa)=>{for(var na of oa)na.fn&&(na.value=na.fn(M,Q,fa));M=F.clone(Y);Q=Y.primitiveName;for(const za of oa)za.primitiveName===Q&&(fa=aa(za.propertyName),null!=za.value&&(na=a.quantizeIfNeeded(za.value,za.propertyName),na!==M[fa]&&(M[fa]=na)));return M}}function S(Y,ua,ca,ia){for(const oa of ca)if(oa.valueExpressionInfo&&
ia?.geometryType){const M=ua[oa.primitiveName]&&ua[oa.primitiveName][oa.propertyName];M instanceof k.ArcadeExpression&&(oa.fn=(Q,fa,na)=>c(M,Q,{$view:na},ia.geometryType,fa))}return(oa,M,Q)=>{for(const fa of ca)fa.fn&&(fa.value=fa.fn(oa,M,Q));return x.numericHash(Y+g.OverrideHelper.buildOverrideKey(ca)).toString()}}function X(Y,ua,ca,ia,oa){let M=!1,Q="";for(const fa of Y)fa.primitiveName===ua&&(void 0!==fa.value?Q+=`-${fa.primitiveName}-${fa.propertyName}-${JSON.stringify(fa.value)}`:fa.valueExpressionInfo&&
(M=!0));y.isSome(ca)&&"function"===typeof ca&&(M=!0);y.isSome(ia)&&"function"===typeof ia&&(M=!0);y.isSome(oa)&&"function"===typeof oa&&(M=!0);return[M,Q]}const ra=z.getLogger("esri.symbols.cim.cimAnalyzer");q.analyzeCIMResource=function(Y,ua){if(!ua||0===ua.length)return Y;Y=F.clone(Y);g.OverrideHelper.applyOverrides(Y,ua);return Y};q.analyzeCIMSymbol=async function(Y,ua,ca,ia,oa){ia=ia??[];if(!Y)return ia;let M;const Q={};if("CIMSymbolReference"===Y.type){if(M=Y.symbol,Y=Y.primitiveOverrides){var fa=
[];for(const za of Y){var na=za.valueExpressionInfo;na&&ua?(na=k.createRendererExpression(na.expression,ua.spatialReference,ua.fields).then(W=>{y.isNone(W)||u(Q,za.primitiveName,za.propertyName,W)}),fa.push(na)):null!=za.value&&u(Q,za.primitiveName,za.propertyName,za.value)}0<fa.length&&await Promise.all(fa)}}else return ra.error("Expect cim type to be 'CIMSymbolReference'"),ia;fa=[];g.CIMSymbolHelper.fetchResources(M,ca,fa);0<fa.length&&await Promise.all(fa);switch(M?.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":A(M,
Y,Q,ua,ia,ca,!!oa)}return ia};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/fontUtils":function(){define(["exports","../config"],function(q,n){function G(y){if(!y)return"arial-unicode-ms";y=y.toLowerCase().split(" ").join("-");switch(y){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return y}}function F(y){a:{if(y.weight)switch(y.weight.toLowerCase()){case "bold":case "bolder":var D=
"-bold";break a}D=""}a:{if(y.style)switch(y.style.toLowerCase()){case "italic":case "oblique":var x="-italic";break a}x=""}D+=x;return G(y.family)+(0<D.length?D:"-regular")}const z=new Map;q.getFontFamily=G;q.getFullyQualifiedFontName=F;q.loadFont=async function(y){const D=F(y);let x=z.get(D);if(x)return x;y=new FontFace(y.family,`url('${n.fontsUrl}/woff2/${D}.${"woff2"}') format('${"woff2"}')`);const k=document.fonts;if(k.has(y)&&"loading"===y.status)return y.loaded;x=y.load();z.set(D,x);k.add(y);
return x};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/BidiText ../../core/lang ../../core/Logger ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../support/arcadeOnDemand ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l){function u(V,P,S){switch(P.type){case "CIMSymbolReference":return u(V,P.symbol,S);case "CIMPointSymbol":null==S&&(S={x:0,y:0});V.drawSymbol(P,S);break;case "CIMLineSymbol":null==S&&(S={paths:[[[0,0],[10,0]]]});V.drawSymbol(P,S);break;case "CIMPolygonSymbol":null==S&&(S={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]});V.drawSymbol(P,S);break;case "CIMTextSymbol":V.drawSymbol(P,{x:0,y:0});break;case "CIMVectorMarker":S=new h.Placement,V.drawMarker(P,S)}return V.envelope()}
function r(V){if(!V)return 0;switch(V.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(V.offset);case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(V.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(V.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(V.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(V.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(V.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(V.offset);
case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}function A(V){if(!V)return 0;switch(V.type){case "CIMGeometricEffectArrow":return Math.abs(.5*V.width);case "CIMGeometricEffectBuffer":return Math.abs(V.size);case "CIMGeometricEffectExtension":return Math.abs(V.length);case "CIMGeometricEffectJog":return Math.abs(.5*V.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(c.getValue(V.offsetX)),Math.abs(c.getValue(V.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(V.offset);
case "CIMGeometricEffectOffsetTangent":return Math.abs(V.offset);case "CIMGeometricEffectRadial":return Math.abs(V.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(V.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(V.fromWidth),Math.abs(V.toWidth));case "CIMGeometricEffectWave":return Math.abs(V.amplitude);default:return 0}}function w(V){if(!V)return 0;let P=0;for(const S of V)P+=
A(S);return P}function m(V,P,S){V.effects&&!D.isSome(P.geometryEngine)&&(P.geometryEnginePromise?S.push(P.geometryEnginePromise):c.isGeometryEngineRequired(V.effects)&&(P.geometryEnginePromise=c.importGeometryEngine(),S.push(P.geometryEnginePromise),P.geometryEnginePromise.then(X=>P.geometryEngine=X)))}const t=Math.PI,B=t/2,J=96/72,C=Math.PI/180,K=y.getLogger("esri.symbols.cim.CIMSymbolHelper");y=function(){function V(){}var P=V.prototype;P.getSymbolInflateSize=function(S,X,ra,Y,ua){S||(S=[0,0,0,
0]);return X?this._getInflateSize(S,X,ra,Y,ua):S};V.safeSize=function(S){const X=Math.max(Math.abs(S[0]),Math.abs(S[2]));S=Math.max(Math.abs(S[1]),Math.abs(S[3]));return Math.sqrt(X*X+S*S)};P._vectorMarkerBounds=function(S,X,ra,Y){let ua=!0;const ca=g.create();if(X&&X.markerGraphics)for(const ia of X.markerGraphics)X=[0,0,0,0],ia.geometry&&(b.getBoundsXY(ca,ia.geometry),X[0]=0,X[1]=0,X[2]=0,X[3]=0,this.getSymbolInflateSize(X,ia.symbol,ra,0,Y),ca[0]+=X[0],ca[1]+=X[1],ca[2]+=X[2],ca[3]+=X[3],ua?(S[0]=
ca[0],S[1]=ca[1],S[2]=ca[2],S[3]=ca[3],ua=!1):(S[0]=Math.min(S[0],ca[0]),S[1]=Math.min(S[1],ca[1]),S[2]=Math.max(S[2],ca[2]),S[3]=Math.max(S[3],ca[3])));return S};P._getInflateSize=function(S,X,ra,Y,ua){return void 0!==X.symbolLayers?(S=this._getLayersInflateSize(S,X.symbolLayers,ra,Y,ua),X=w(X.effects),0<X&&(S[0]-=X,S[1]-=X,S[2]+=X,S[3]+=X),S):this._getTextInflatedSize(S,X,ua)};P._getLayersInflateSize=function(S,X,ra,Y,ua){let ca=!0;if(!X)return S;for(const na of X)if(na){X=[0,0,0,0];switch(na.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":var ia=
na,oa=ia.width;null!=oa&&(oa=ia.capStyle===f.LineCapStyle.Square||ia.joinStyle===f.LineJoinStyle.Miter?oa/1.4142135623730951:oa/2,X[0]=-oa,X[1]=-oa,X[2]=oa,X[3]=oa);break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":ia=na;if("CIMVectorMarker"===na.type){if(oa=na,X=this._vectorMarkerBounds(X,oa,ra,ua),oa.frame){var M=(oa.frame.xmin+oa.frame.xmax)/2,Q=(oa.frame.ymin+oa.frame.ymax)/2;X[0]-=M;X[1]-=Q;X[2]-=M;X[3]-=Q;null!=oa.size&&(oa=oa.size/(oa.frame.ymax-oa.frame.ymin),
X[0]*=oa,X[1]*=oa,X[2]*=oa,X[3]*=oa)}}else"CIMPictureMarker"===na.type?(oa=na,Q=ra.getResource(oa.url),M=1,D.isSome(Q)&&Q.height&&(M=Q.width/Q.height),null!=ia.size&&(X=ia.size/2,oa=ia.size*M*oa.scaleX/2,X=[-oa,-X,oa,X])):null!=ia.size&&(X=ia.size/2,X=[-X,-X,X,X]);ia.anchorPoint&&("Absolute"===ia.anchorPointUnits?(oa=ia.anchorPoint.x,M=ia.anchorPoint.y):(oa=ia.anchorPoint.x*(X[2]-X[0]),M=ia.anchorPoint.y*(X[3]-X[1])),X[0]-=oa,X[1]-=M,X[2]-=oa,X[3]-=M);oa=c.getValue(ia.rotation);ia.rotateClockwise&&
(oa=-oa);Y&&(oa-=Y);oa&&(M=C*oa,oa=Math.cos(M),M=Math.sin(M),Q=g.create([p.C_INFINITY,p.C_INFINITY,-p.C_INFINITY,-p.C_INFINITY]),g.expandPointInPlace(Q,[X[0]*oa-X[1]*M,X[0]*M+X[1]*oa]),g.expandPointInPlace(Q,[X[0]*oa-X[3]*M,X[0]*M+X[3]*oa]),g.expandPointInPlace(Q,[X[2]*oa-X[1]*M,X[2]*M+X[1]*oa]),g.expandPointInPlace(Q,[X[2]*oa-X[3]*M,X[2]*M+X[3]*oa]),X=Q);oa=c.getValue(ia.offsetX);M=c.getValue(ia.offsetY);if(Y){var fa=C*Y;Q=Math.cos(fa);fa=Math.sin(fa);const za=oa*fa+M*Q;oa=oa*Q-M*fa;M=za}X[0]+=oa;
X[1]+=M;X[2]+=oa;X[3]+=M;ia=r(ia.markerPlacement);0<ia&&(X[0]-=ia,X[1]-=ia,X[2]+=ia,X[3]+=ia)}ia=w(na.effects);0<ia&&(X[0]-=ia,X[1]-=ia,X[2]+=ia,X[3]+=ia);ca?(S[0]=X[0],S[1]=X[1],S[2]=X[2],S[3]=X[3],ca=!1):(S[0]=Math.min(S[0],X[0]),S[1]=Math.min(S[1],X[1]),S[2]=Math.max(S[2],X[2]),S[3]=Math.max(S[3],X[3]))}return S};P._getTextInflatedSize=function(S,X,ra){const Y=X.height??10;S[0]=-Y/2;S[1]=-Y/2;S[2]=Y/2;S[3]=Y/2;if(!ra)return S;ra=ra.get(X);if(!ra)return S;const {text:ua,mosaicItem:ca}=ra;if(!ca?.glyphMosaicItems?.length)return S;
const {lineGapType:ia,lineGap:oa}=X;ra=ia?e.lineGapType2LineHeight(ia,oa??0,Y):0;const M=F.bidiText(ua)[1],Q="CIMBackgroundCallout"===X.callout?.type;X=l.shapeGlyphs(ca.glyphMosaicItems,M,{scale:Y/v.GLYPH_SIZE,angle:c.getValue(X.angle),xOffset:c.getValue(X.offsetX),yOffset:c.getValue(X.offsetY),hAlign:e.horizontalAlignment2HAlign(X.horizontalAlignment),vAlign:e.verticalAlignment2VAlign(X.verticalAlignment),maxLineWidth:512,lineHeight:v.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(ra||1,4)),decoration:X.font.decoration||
"none",isCIM:!0,hasBackground:Q}).boundsT;S[0]=X.x-X.halfWidth;S[1]=-X.y-X.halfHeight;S[2]=X.x+X.halfWidth;S[3]=-X.y+X.halfHeight;return S};return n._createClass(V)}();let E=function(){function V(){}V.getEnvelope=function(P,S,X){if(!P)return null;X=new e.EnvDrawHelper(X);if(Array.isArray(P)){let ra;for(const Y of P)ra?ra.union(u(X,Y,S)):ra=u(X,Y,S);return ra}return u(X,P,S)};V.getTextureAnchor=function(P,S){P=this.getEnvelope(P,null,S);if(!P)return[0,0,0];S=P.height*J+2;return[-((P.x+.5*P.width)*
J)/(P.width*J+2),-((P.y+.5*P.height)*J)/S,S]};V.rasterize=function(P,S,X,ra,Y=!0){var ua=X||this.getEnvelope(S,null,ra);if(!ua)return[null,0,0,0,0];const ca=(ua.x+.5*ua.width)*J,ia=(ua.y+.5*ua.height)*J;P.width=ua.width*J;P.height=ua.height*J;X||(P.width+=2,P.height+=2);X=P.getContext("2d");ua=e.Transformation.createScale(J,-J);ua.translate(.5*P.width-ca,.5*P.height+ia);ra=new e.CanvasDrawHelper(X,ra,ua);switch(S.type){case "CIMPointSymbol":ra.drawSymbol(S,{type:"point",x:0,y:0});break;case "CIMVectorMarker":ua=
new h.Placement,ra.drawMarker(S,ua)}S=X.getImageData(0,0,P.width,P.height);S=new Uint8Array(S.data);if(Y)for(ra=0;ra<S.length;ra+=4)Y=S[ra+3]/255,S[ra]*=Y,S[ra+1]*=Y,S[ra+2]*=Y;return[S,P.width,P.height,-ca/P.width,-ia/P.height]};V.fromTextSymbol=function(P){const {angle:S,color:X,font:ra,haloColor:Y,haloSize:ua,horizontalAlignment:ca,kerning:ia,text:oa,verticalAlignment:M,xoffset:Q,yoffset:fa,backgroundColor:na,borderLineColor:za,borderLineSize:W}=P;let da,ha,ma;if(ra){var qa=ra.family;var wa=ra.style;
var ya=ra.weight;da=ra.size;ha=ra.decoration}P=!1;oa&&(P=F.bidiText(oa)[1]);if(na||W)ma={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:la(na)},{type:"CIMSolidStroke",color:la(za),width:W}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null};var Ea=f.BlockProgression.BTT,Da=f.FontEffects.Normal,Ia=f.FontEncoding.Unicode;qa=qa||"Arial";b:{if(ya)switch(ya.toLowerCase()){case "bold":case "bolder":ya="bold";break b}ya=
""}b:{if(wa)switch(wa.toLowerCase()){case "italic":case "oblique":wa="italic";break b}wa=""}ya=ya&&wa?`${ya}-${wa}`:`${ya}${wa}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:S,blockProgression:Ea,depth3D:1,extrapolateBaselines:!0,fontEffects:Da,
fontEncoding:Ia,fontFamilyName:qa,fontStyleName:ya,fontType:f.FontType.Unspecified,haloSize:ua,height:da,hinting:f.GlyphHinting.Default,horizontalAlignment:U(ca??"center"),kerning:ia,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:c.getValue(Q),offsetY:c.getValue(fa),strikethrough:"line-through"===ha,underline:"underline"===ha,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:la(X)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",
enable:!0,color:la(Y)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:P?f.TextReadingDirection.RTL:f.TextReadingDirection.LTR,verticalAlignment:ba(M??"baseline"),verticalGlyphOrientation:f.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:f.BillBoardMode.FaceNearPlane,callout:ma},textString:oa}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};V.fromPictureFillSymbol=function(P){const {height:S,outline:X,width:ra,
xoffset:Y,xscale:ua,yoffset:ca,yscale:ia}=P,oa=[],M={type:"CIMPolygonSymbol",symbolLayers:oa};if(X){const {cap:fa,join:na,miterLimit:za,width:W}=X;oa.push({type:"CIMSolidStroke",color:la(X.color),capStyle:H(fa),joinStyle:N(na),miterLimit:za,width:W})}let Q=P.url;"esriPFS"===P.type&&P.imageData&&(Q=P.imageData);P="angle"in P?P.angle??0:0;oa.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:f.TextureFilter.Picture,tintColor:null,url:Q,height:(S??0)*(ia||1),width:(ra??0)*(ua||
1),offsetX:c.getValue(Y),offsetY:c.getValue(ca),rotation:c.getValue(-P),colorSubstitutions:null});return M};V.fromSimpleFillSymbol=function(P){const {color:S,style:X,outline:ra}=P;P=[];const Y={type:"CIMPolygonSymbol",symbolLayers:P};var ua=null;if(ra){const {cap:ca,join:ia,style:oa}=ra;"solid"!==oa&&"none"!==oa&&"esriSLSSolid"!==oa&&"esriSLSNull"!==oa&&(ua=[{type:"CIMGeometricEffectDashes",dashTemplate:aa(oa,ca),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);P.push({type:"CIMSolidStroke",
color:la(ra.color),capStyle:H(ca),joinStyle:N(ia),miterLimit:ra.miterLimit,width:ra.width,effects:ua})}if(X&&"solid"!==X&&"none"!==X&&"esriSFSSolid"!==X&&"esriSFSNull"!==X){ua={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:la(S),capStyle:f.LineCapStyle.Butt,joinStyle:f.LineJoinStyle.Miter,width:.75}]};let ca=0;const ia=k.px2pt("vertical"===X||"horizontal"===X||"cross"===X||"esriSFSCross"===X||"esriSFSVertical"===X||"esriSFSHorizontal"===X?8:10);switch(X){case "vertical":case "esriSFSVertical":ca=
90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":ca=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":ca=45;break;case "cross":case "esriSFSCross":ca=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":ca=-45}P.push({type:"CIMHatchFill",lineSymbol:ua,offsetX:0,offsetY:0,rotation:ca,separation:ia});"cross"===X||"esriSFSCross"===X?P.push({type:"CIMHatchFill",lineSymbol:z.clone(ua),offsetX:0,offsetY:0,rotation:90,separation:ia}):("diagonal-cross"===X||"esriSFSDiagonalCross"===
X)&&P.push({type:"CIMHatchFill",lineSymbol:z.clone(ua),offsetX:0,offsetY:0,rotation:45,separation:ia})}else!X||"solid"!==X&&"esriSFSSolid"!==X||P.push({type:"CIMSolidFill",enable:!0,color:la(S)});return Y};V.fromSimpleLineSymbol=function(P){const {cap:S,color:X,join:ra,marker:Y,miterLimit:ua,style:ca,width:ia}=P;P=null;"solid"!==ca&&"none"!==ca&&"esriSLSSolid"!==ca&&"esriSLSNull"!==ca&&(P=[{type:"CIMGeometricEffectDashes",dashTemplate:aa(ca,S),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);
const oa=[];if(Y){let M;switch(Y.placement){case "begin-end":M=f.ExtremityPlacement.Both;break;case "begin":M=f.ExtremityPlacement.JustBegin;break;case "end":M=f.ExtremityPlacement.JustEnd;break;default:M=f.ExtremityPlacement.None}const Q=V.fromSimpleMarker(Y,ia,X).symbolLayers[0];Q.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:M,offsetAlongLine:0};oa.push(Q)}"none"!==ca&&"esriSLSNull"!==ca&&oa.push({type:"CIMSolidStroke",color:la(X),capStyle:H(S),
joinStyle:N(ra),miterLimit:ua,width:ia,effects:P});return{type:"CIMLineSymbol",symbolLayers:oa}};V.fromPictureMarker=function(P){const {angle:S,height:X,width:ra,xoffset:Y,yoffset:ua}=P;let ca=P.url;"esriPMS"===P.type&&P.imageData&&(ca=P.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:f.TextureFilter.Picture,tintColor:null,url:ca,size:X,width:ra,offsetX:c.getValue(Y),offsetY:c.getValue(ua),rotation:c.getValue(-S)}]}};V.fromSimpleMarker=
function(P,S,X){var {style:ra}=P;X=P.color??X;if("path"===ra){S=[];"outline"in P&&P.outline&&(ra=P.outline,S.push({type:"CIMSolidStroke",enable:!0,width:k.pt2px(Math.round(k.px2pt(ra.width))),color:la(ra.color)}));S.push({type:"CIMSolidFill",enable:!0,color:la(X),path:P.path});const [ia,oa]=ka("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:c.getValue(-P.angle),size:c.getValue(P.size||6),offsetX:c.getValue(P.xoffset),offsetY:c.getValue(P.yoffset),frame:ia,
markerGraphics:[{type:"CIMMarkerGraphic",geometry:oa,symbol:{type:"CIMPolygonSymbol",symbolLayers:S}}]}]}}const [Y,ua]=ka(ra);if(ua&&Y){ra=[];if("outline"in P&&P.outline){var ca=P.outline;ra.push({type:"CIMSolidStroke",enable:!0,width:null!=ca.width&&.667<ca.width?k.pt2px(Math.round(k.px2pt(ca.width))):ca.width,color:la(ca.color)})}else!S||"line-marker"!==P.type||"cross"!==P.style&&"x"!==P.style||ra.push({type:"CIMSolidStroke",enable:!0,width:S,color:la(X)});ra.push({type:"CIMSolidFill",enable:!0,
color:la(X)});X={type:"CIMPolygonSymbol",symbolLayers:ra};ca={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:c.getValue(-P.angle),size:c.getValue(P.size||6*S),offsetX:c.getValue(P.xoffset),offsetY:c.getValue(P.yoffset),frame:Y,markerGraphics:[{type:"CIMMarkerGraphic",geometry:ua,symbol:X}]}]}}return ca};V.fromCIMHatchFill=function(P,S){const X=S*(P.separation??4),ra=X/2;P=z.clone(P.lineSymbol);P.symbolLayers?.forEach(ua=>{switch(ua.type){case "CIMSolidStroke":null!=
ua.width&&(ua.width*=S);ua.effects?.forEach(ca=>{"CIMGeometricEffectDashes"===ca.type&&(ca.dashTemplate=ca.dashTemplate.map(ia=>ia*S))});break;case "CIMVectorMarker":null!=ua.size&&(ua.size*=S),ua=ua.markerPlacement,null!=ua&&"placementTemplate"in ua&&(ua.placementTemplate=ua.placementTemplate.map(ca=>ca*S))}});for(var Y=this._getLineSymbolPeriod(P)||4;4>Y;)Y*=2;Y/=2;return{type:"CIMVectorMarker",frame:{xmin:-Y,xmax:Y,ymin:-ra,ymax:ra},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-Y,
0],[Y,0]]]},symbol:P}],size:X}};V.fetchResources=function(P,S,X){if(P&&S)switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(P=P.symbolLayers)for(const ra of P)switch(m(ra,S,X),ra.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in ra&&ra.url&&X.push(S.fetchResource(ra.url,null));break;case "CIMVectorMarker":if(P=ra.markerGraphics)for(const Y of P)Y&&
(P=Y.symbol)&&V.fetchResources(P,S,X)}}};V._getLineSymbolPeriod=function(P){if(P){const S=this._getEffectsRepeat(P.effects);if(S)return S;if(P.symbolLayers)for(const X of P.symbolLayers)if(X){if(P=this._getEffectsRepeat(X.effects))return P;switch(X.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(P=this._getPlacementRepeat(X.markerPlacement))return P}}}return 0};V._getEffectsRepeat=function(P){if(P)for(var S of P)if(S)switch(S.type){case "CIMGeometricEffectDashes":if((P=
S.dashTemplate)&&P.length){S=0;for(const X of P)S+=X;P.length&1&&(S*=2);return S}break;case "CIMGeometricEffectWave":return S.period;default:K.error(`unsupported geometric effect type ${S.type}`)}return 0};V._getPlacementRepeat=function(P){if(P)switch(P.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((P=P.placementTemplate)&&P.length){let S=0;for(const X of P)S+=+X;P.length&1&&(S*=2);return S}}return 0};
V.fromCIMInsidePolygon=function(P){var S=P.markerPlacement;const X={...P,markerPlacement:null,anchorPoint:null};P=Math.abs(S.stepX);const ra=Math.abs(S.stepY);var Y=(S.randomness??100)/100;let ua,ca;if("Random"===S.gridType){var ia=k.px2pt(v.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const oa=Math.max(Math.floor(ia/P),1),M=Math.max(Math.floor(ia/ra),1);ia=oa*P/2;ua=M*ra/2;ca=2*ua;S=new x(S.seed);const Q=Y*P/1.5,fa=Y*ra/1.5;Y=[];for(let na=0;na<oa;na++)for(let za=0;za<M;za++){const W=na*P-ia+Q*(.5-S.getFloat()),
da=za*ra-ua+fa*(.5-S.getFloat());Y.push({x:W,y:da});0===na&&Y.push({x:W+2*ia,y:da});0===za&&Y.push({x:W,y:da+2*ua})}}else!0===S.shiftOddRows?(ia=P/2,ua=ra,ca=2*ra,Y=[{x:-ia,y:0},{x:ia,y:0},{x:0,y:ua},{x:0,y:-ua}]):(ia=P/2,ua=ra/2,ca=ra,Y=[{x:-P,y:0},{x:0,y:-ra},{x:-P,y:-ra},{x:0,y:0},{x:P,y:0},{x:0,y:ra},{x:P,y:ra},{x:-P,y:ra},{x:P,y:-ra}]);P=Y.map(oa=>({type:"CIMMarkerGraphic",geometry:oa,symbol:{type:"CIMPointSymbol",symbolLayers:[X]}}));return{type:"CIMVectorMarker",frame:{xmin:-ia,xmax:ia,ymin:-ua,
ymax:ua},markerGraphics:P,size:ca}};V.getSize=function(P){if(P)switch(P.type){case "CIMTextSymbol":return P.height;case "CIMPointSymbol":var S=0;if(P.symbolLayers)for(var X of P.symbolLayers)if(X)switch(X.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":P=X.size,null!=P&&P>S&&(S=P)}return S;case "CIMLineSymbol":case "CIMPolygonSymbol":X=0;if(P.symbolLayers)for(S of P.symbolLayers)if(S)switch(S.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":P=
S.width;null!=P&&P>X&&(X=P);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":S.markerPlacement&&c.isCIMMarkerStrokePlacement(S.markerPlacement)&&(P=S.size,null!=P&&P>X&&(X=P))}return X}};V.getMarkerScaleRatio=function(P){if(P)switch(P.type){case "CIMVectorMarker":if(!1!==P.scaleSymbolsProportionally&&P.frame&&null!=P.size)return P.size/(P.frame.ymax-P.frame.ymin)}return 1};return n._createClass(V)}(),I=function(){function V(){}
V.findApplicableOverrides=function(P,S,X){if(P&&S){if(P.primitiveName){let ra=!1;for(const Y of X)if(Y.primitiveName===P.primitiveName){ra=!0;break}if(!ra)for(const Y of S)Y.primitiveName===P.primitiveName&&X.push(Y)}switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(P.effects)for(const ra of P.effects)V.findApplicableOverrides(ra,S,X);if(P.symbolLayers)for(const ra of P.symbolLayers)V.findApplicableOverrides(ra,S,X);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(P.effects)for(const ra of P.effects)V.findApplicableOverrides(ra,
S,X);P.markerPlacement&&V.findApplicableOverrides(P.markerPlacement,S,X);if("CIMVectorMarker"===P.type){if(P.markerGraphics)for(const ra of P.markerGraphics)V.findApplicableOverrides(ra,S,X),V.findApplicableOverrides(ra.symbol,S,X)}else"CIMCharacterMarker"===P.type?V.findApplicableOverrides(P.symbol,S,X):"CIMHatchFill"===P.type?V.findApplicableOverrides(P.lineSymbol,S,X):"CIMPictureMarker"===P.type&&V.findApplicableOverrides(P.animatedSymbolProperties,S,X)}}};V.findEffectOverrides=function(P,S,X){if(S&&
P){var ra=P.length;for(let Y=0;Y<ra;Y++){const ua=P[Y]?.primitiveName;if(ua){let ca=!1;for(const ia of X)if(ia.primitiveName===ua){ca=!0;break}if(!ca)for(const ia of S)ia.primitiveName===ua&&X.push(ia)}}}};V.resolveSymbolOverrides=async function(P,S,X,ra,Y,ua,ca){if(!P||!P.symbol)return null;let {symbol:ia,primitiveOverrides:oa}=P;P=!!oa;if(!P&&!ra)return ia;ia=z.clone(ia);let M=!0;S||(S={attributes:{}},M=!1);P&&(M||(oa=oa.filter(Q=>!Q.valueExpressionInfo?.expression.includes("$feature"))),ca||(oa=
oa.filter(Q=>!Q.valueExpressionInfo?.expression.includes("$view"))),0<oa.length&&(P=c.attributesToFields(S.attributes),await V.evaluateOverrides(oa,S,{spatialReference:X,fields:P,geometryType:Y},ua,ca)),V.applyOverrides(ia,oa));ra&&V.applyDictionaryTextOverrides(ia,S,ra);return ia};V.evaluateOverrides=async function(P,S,X,ra,Y){if(S){var ua;for(const ca of P)(P=ca.valueExpressionInfo)&&X&&X.geometryType&&(ua||(ua=[]),ca.value=void 0,P=a.createRendererExpression(P.expression,X.spatialReference,X.fields).then(ia=>
{ca.value=d(ia,S,{$view:Y},X.geometryType,ra)}),ua.push(P));void 0!==ua&&0<ua.length&&await Promise.all(ua)}};V.applyDictionaryTextOverrides=function(P,S,X,ra="Normal"){if(P&&P.type)switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":case "CIMTextSymbol":var Y=P.symbolLayers;if(!Y)break;for(var ua of Y)ua&&"CIMVectorMarker"===ua.type&&V.applyDictionaryTextOverrides(ua,S,X,"CIMTextSymbol"===P.type?P.textCase:ra);break;case "CIMVectorMarker":P=P.markerGraphics;if(!P)break;
for(Y of P)Y&&V.applyDictionaryTextOverrides(Y,S,X);break;case "CIMMarkerGraphic":(ua=P.textString)&&ua.includes("[")&&(X=c.analyzeTextParts(ua,X),P.textString=c.assignTextValuesFromFeature(S,X,ra))}};V.applyOverrides=function(P,S,X,ra){if(P.primitiveName)for(const ua of S)if(ua.primitiveName===P.primitiveName){var Y=(Y=ua.propertyName)?Y.charAt(0).toLowerCase()+Y.substr(1):Y;ra&&ra.push({cim:P,nocapPropertyName:Y,value:P[Y]});ua.expression&&(ua.value=V.toValue(ua.propertyName,ua.expression));if(X){let ca=
!1;for(const ia of X)ia.primitiveName===P.primitiveName&&(ca=!0);ca||X.push(ua)}D.isSome(ua.value)&&(P[Y]=ua.value)}switch(P.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(P.effects)for(const ua of P.effects)V.applyOverrides(ua,S,X,ra);if(P.symbolLayers)for(const ua of P.symbolLayers)V.applyOverrides(ua,S,X,ra);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(P.effects)for(const ua of P.effects)V.applyOverrides(ua,S,X,ra);if("CIMVectorMarker"===
P.type&&P.markerGraphics)for(const ua of P.markerGraphics)V.applyOverrides(ua,S,X,ra),V.applyOverrides(ua.symbol,S,X,ra)}};V.restoreOverrides=function(P){for(const S of P)S.cim[S.nocapPropertyName]=S.value};V.buildOverrideKey=function(P){let S="";for(const X of P)void 0!==X.value&&(S+=`${X.primitiveName}${X.propertyName}${JSON.stringify(X.value)}`);return S};V.toValue=function(P,S){return"DashTemplate"===P?S.split(" ").map(X=>Number(X)):"Color"===P?(P=(new G(S)).toRgba(),P[3]*=255,P):S};return n._createClass(V)}();
const H=V=>{if(!V)return f.LineCapStyle.Butt;switch(V){case "butt":return f.LineCapStyle.Butt;case "square":return f.LineCapStyle.Square;case "round":return f.LineCapStyle.Round}},N=V=>{if(!V)return f.LineJoinStyle.Miter;switch(V){case "miter":return f.LineJoinStyle.Miter;case "round":return f.LineJoinStyle.Round;case "bevel":return f.LineJoinStyle.Bevel}},U=V=>{if(D.isNone(V))return"Center";switch(V){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},ba=V=>{if(D.isNone(V))return"Center";
switch(V){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},la=V=>{if(!V)return[0,0,0,0];const {r:P,g:S,b:X,a:ra}=V;return[P,S,X,255*ra]},aa=(V,P)=>{P="butt"===P;switch(V){case "dash":case "esriSLSDash":return P?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return P?[4,3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return P?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return P?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return P?
[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return P?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return P?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return P?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return P?[4,1,1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return P?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return K.error("Unexpected: style does not require rasterization"),
[0,0];default:return K.error(`Tried to rasterize SLS, but found an unexpected style: ${V}!`),[0,0]}},ka=V=>{if("circle"===V||"esriSMSCircle"===V){var P=Math.acos(.995);V=Math.ceil(t/P/4);0===V&&(V=1);P=B/V;V*=4;var S=[];S.push([50,0]);for(let X=1;X<V;X++)S.push([50*Math.cos(X*P),-50*Math.sin(X*P)]);S.push([50,0]);P={rings:[S]};S={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===V||"esriSMSCross"===V?(P={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,
50],[0,50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===V||"esriSMSDiamond"===V?(P={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===V||"esriSMSSquare"===V?(P={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"x"===V||"esriSMSX"===V?(P={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===
V||"esriSMSTriangle"===V?(V=2/3*100,S=V-100,P={rings:[[[-57.735026918962575,S],[0,V],[57.735026918962575,S],[-57.735026918962575,S]]]},S={xmin:-57.735026918962575,ymin:S,xmax:57.735026918962575,ymax:V}):"arrow"===V&&(P={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},S={xmin:-50,ymin:-50,xmax:50,ymax:50});return[S,P]};q.CIMSymbolHelper=E;q.CIMSymbolInflatedSizeHelper=y;q.OverrideHelper=I;q.slsDashToTemplateArray=aa;q.symbolToCIM=function(V){if(!V||!V.type)return null;let P;switch(V.type){case "cim":return V.data;
case "web-style":return V;case "simple-marker":V=E.fromSimpleMarker(V);if(!V)return null;P=V;break;case "picture-marker":P=E.fromPictureMarker(V);break;case "simple-line":P=E.fromSimpleLineSymbol(V);break;case "simple-fill":P=E.fromSimpleFillSymbol(V);break;case "picture-fill":P=E.fromPictureFillSymbol(V);break;case "text":P=E.fromTextSymbol(V)}return{type:"CIMSymbolReference",symbol:P}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/GeometryCursor ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMImageColorSubstitutionHelper ./CIMOperators ./CIMPlacements ./enums ./imageUtils ./Rect ./TextRasterizer ./utils ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r,A,w,m,t){function B(aa,ka=1){const V=A.fromCIMFontDecoration(aa);var P=A.fromCIMFontStyle(aa.fontStyleName);const S=F.getFontFamily(aa.fontFamilyName),{weight:X,style:ra}=P;P=ka*(aa.height||5);const Y=A.fromCIMHorizontalAlignment(aa.horizontalAlignment),ua=A.fromCIMVerticalAlignment(aa.verticalAlignment),ca=A.getFillColor(aa),ia=A.getStrokeColor(aa.haloSymbol);aa=ia?ka*(aa.haloSize|0):0;return{color:ca,size:P,horizontalAlignment:Y,verticalAlignment:ua,
font:{family:S,style:A.getFontStyle(ra),weight:A.getFontWeight(X),decoration:V},halo:{size:aa||0,color:ia,style:ra},pixelRatio:1,premultiplyColors:!0}}const J=Math.PI/180,C=y.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let K=function(){function aa(V){this._t=V}aa.createIdentity=function(){return new aa([1,0,0,0,1,0])};var ka=aa.prototype;ka.clone=function(){return new aa(this._t.slice())};ka.transform=function(V){const P=this._t;return[P[0]*V[0]+P[1]*V[1]+P[2],P[3]*V[0]+P[4]*V[1]+P[5]]};aa.createScale=
function(V,P){return new aa([V,0,0,0,P,0])};ka.scale=function(V,P){const S=this._t;S[0]*=V;S[1]*=V;S[2]*=V;S[3]*=P;S[4]*=P;S[5]*=P;return this};ka.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};aa.createTranslate=function(V,P){return new aa([0,0,V,0,0,P])};ka.translate=function(V,P){const S=this._t;S[2]+=V;S[5]+=P;return this};aa.createRotate=function(V){const P=Math.cos(V);V=Math.sin(V);return new aa([P,-V,0,V,P,0])};ka.rotate=function(V){return aa.multiply(this,
aa.createRotate(V),this)};ka.angle=function(){const V=this._t[0],P=this._t[3],S=Math.sqrt(V*V+P*P);return[V/S,P/S]};aa.multiply=function(V,P,S){V=V._t;P=P._t;const X=V[1]*P[0]+V[4]*P[1],ra=V[2]*P[0]+V[5]*P[1]+P[2],Y=V[0]*P[3]+V[3]*P[4],ua=V[1]*P[3]+V[4]*P[4],ca=V[2]*P[3]+V[5]*P[4]+P[5],ia=S._t;ia[0]=V[0]*P[0]+V[3]*P[1];ia[1]=X;ia[2]=ra;ia[3]=Y;ia[4]=ua;ia[5]=ca;return S};ka.invert=function(){const V=this._t;let P=V[0]*V[4]-V[1]*V[3];if(0===P)return new aa([0,0,0,0,0,0]);P=1/P;return new aa([V[4]*
P,-V[1]*P,(V[1]*V[5]-V[2]*V[4])*P,-V[3]*P,V[0]*P,(V[2]*V[3]-V[0]*V[5])*P])};return n._createClass(aa)}();y=function(){function aa(V,P){this._resourceManager=V;this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new x(p.Placement,void 0,void 0,100);this._earlyReturn=!1;this._mapRotation=0;this._transfos.push(P||K.createIdentity());this._sizeTransfos.push(P?P.scaleRatio():1)}var ka=aa.prototype;ka.setTransform=function(V,P){this._transfos=[V||K.createIdentity()];this._sizeTransfos=
[P||(V?V.scaleRatio():1)]};ka.setGeomUnitsPerPoint=function(V){this._geomUnitsPerPoint=V};ka.transformPt=function(V){return this._transfos[this._transfos.length-1].transform(V)};ka.transformSize=function(V){return V*this._sizeTransfos[this._sizeTransfos.length-1]};ka.reverseTransformPt=function(V){return this._transfos[this._transfos.length-1].invert().transform(V)};ka.reverseTransformSize=function(V){return V/this._sizeTransfos[this._sizeTransfos.length-1]};ka.getTransformAngle=function(){return this._transfos[this._transfos.length-
1].angle()};ka.geomUnitsPerPoint=function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};ka.isEmbedded=function(){return 1<this._transfos.length};ka.back=function(){return this._transfos[this._transfos.length-1]};ka.push=function(V,P){P=P?V.scaleRatio():1;K.multiply(V,this.back(),V);this._transfos.push(V);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*P)};ka.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};ka.drawSymbol=function(V,P,S){if(V)switch(V.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(V,
P);break;case "CIMTextSymbol":this.drawTextSymbol(V,P,S)}};ka.drawMultiLayerSymbol=function(V,P){if(V&&P){var S=V.symbolLayers;if(S)if((V=V.effects)&&0<V.length){if(P=this.executeEffects(V,P))for(V=P.next();V;)this.drawSymbolLayers(S,V),V=P.next()}else this.drawSymbolLayers(S,P)}};ka.executeEffects=function(V,P){const S=this._resourceManager.geometryEngine;P=new f.SimpleGeometryCursor(P);for(const X of V)(V=d.getEffectOperator(X))&&(P=V.execute(P,X,this.geomUnitsPerPoint(),null,S));return P};ka.drawSymbolLayers=
function(V,P){let S=V.length;for(;S--;){const ra=V[S];if(ra&&!1!==ra.enable){var X=ra.effects;if(X&&0<X.length){if(X=this.executeEffects(X,P)){let Y=null;for(;(Y=X.next())&&(this.drawSymbolLayer(ra,Y),!this._earlyReturn););}}else this.drawSymbolLayer(ra,P);if(this._earlyReturn)break}}};ka.drawSymbolLayer=function(V,P){switch(V.type){case "CIMSolidFill":this.drawSolidFill(P,V.color);break;case "CIMHatchFill":this.drawHatchFill(P,V);break;case "CIMPictureFill":this.drawPictureFill(P,V);break;case "CIMGradientFill":this.drawGradientFill(P,
V);break;case "CIMSolidStroke":this.drawSolidStroke(P,V.color,V.width,V.capStyle,V.joinStyle,V.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(P,V);break;case "CIMGradientStroke":this.drawGradientStroke(P,V);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(V,P)}};ka.drawHatchFill=function(V,P){const S=this._buildHatchPolyline(P,V,this.geomUnitsPerPoint());S&&(this.pushClipPath(V),this.drawMultiLayerSymbol(P.lineSymbol,S),this.popClipPath())};
ka.drawPictureFill=function(V,P){};ka.drawGradientFill=function(V,P){};ka.drawPictureStroke=function(V,P){};ka.drawGradientStroke=function(V,P){};ka.drawMarkerLayer=function(V,P){var S=V.markerPlacement;if(S){var X=d.getPlacementOperator(S);if(X){var ra="CIMMarkerPlacementInsidePolygon"===S.type||"CIMMarkerPlacementPolygonCenter"===S.type&&S.clipAtBoundary;ra&&this.pushClipPath(P);if(P=X.execute(g.getJSONCursor(P),S,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine))for(S=null;(S=
P.next())&&(this.drawMarker(V,S),!this._earlyReturn););ra&&this.popClipPath()}}else{ra=this._placementPool.acquire();if(e.isPoint(P))ra.tx=P.x,ra.ty=P.y,this.drawMarker(V,ra);else if(e.isPolygon(P)){if(P=h.polygonCentroid(P))[ra.tx,ra.ty]=P,this.drawMarker(V,ra)}else for(X of P.points)if(ra.tx=X[0],ra.ty=X[1],this.drawMarker(V,ra),this._earlyReturn)break;this._placementPool.release(ra)}};ka.drawMarker=function(V,P){switch(V.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(V,
P);break;case "CIMVectorMarker":this.drawVectorMarker(V,P)}};ka.drawPictureMarker=function(V,P){if(V){var S=this._resourceManager.getResource(V.url),X=V.size??10;if(!(D.isNone(S)||0>=X)){var ra=S.width;S=S.height;if(ra&&S){S=ra/S;var Y=V.scaleX??1;ra=K.createIdentity();var ua=V.anchorPoint;if(ua){var ca=ua.x;ua=ua.y;"Absolute"!==V.anchorPointUnits&&(ca*=X*S*Y,ua*=X);ra.translate(-ca,-ua)}S=V.rotation??0;V.rotateClockwise&&(S=-S);this._mapRotation&&(S+=this._mapRotation);S&&ra.rotate(S*J);S=V.offsetX??
0;Y=V.offsetY??0;if(S||Y){if(this._mapRotation){ua=J*this._mapRotation;ca=Math.cos(ua);ua=Math.sin(ua);const ia=S*ua+Y*ca;S=S*ca-Y*ua;Y=ia}ra.translate(S,Y)}S=this.geomUnitsPerPoint();1!==S&&ra.scale(S,S);(S=P.getAngle())&&ra.rotate(S);ra.translate(P.tx,P.ty);this.push(ra,!1);this.drawImage(V,X);this.pop()}}}};ka.drawVectorMarker=function(V,P){if(V){var S=V.markerGraphics;if(S){var X=V.size??10,ra=V.frame,Y=ra?ra.ymax-ra.ymin:0;Y=X&&Y?X/Y:1;X=K.createIdentity();ra&&X.translate(.5*-(ra.xmax+ra.xmin),
.5*-(ra.ymax+ra.ymin));var ua=V.anchorPoint;if(ua){var ca=ua.x;ua=ua.y;"Absolute"!==V.anchorPointUnits?ra&&(ca*=ra.xmax-ra.xmin,ua*=ra.ymax-ra.ymin):(ca/=Y,ua/=Y);X.translate(-ca,-ua)}1!==Y&&X.scale(Y,Y);ra=V.rotation??0;V.rotateClockwise&&(ra=-ra);this._mapRotation&&(ra+=this._mapRotation);ra&&X.rotate(ra*J);ra=V.offsetX??0;Y=V.offsetY??0;if(ra||Y){if(this._mapRotation){ua=J*this._mapRotation;ca=Math.cos(ua);ua=Math.sin(ua);const ia=ra*ua+Y*ca;ra=ra*ca-Y*ua;Y=ia}X.translate(ra,Y)}ra=this.geomUnitsPerPoint();
1!==ra&&X.scale(ra,ra);(ra=P.getAngle())&&X.rotate(ra);X.translate(P.tx,P.ty);this.push(X,V.scaleSymbolsProportionally);for(const ia of S)if(ia&&ia.symbol&&ia.geometry||C.error("Invalid marker graphic",ia),this.drawSymbol(ia.symbol,ia.geometry,ia.textString),this._earlyReturn)break;this.pop()}}};ka.drawTextSymbol=function(V,P,S){if(V&&e.isPoint(P)&&!(0>=(V.height??10))){var X=K.createIdentity(),ra=V.angle??0;(ra=-ra)&&X.rotate(ra*J);ra=V.offsetX??0;var Y=V.offsetY??0;(ra||Y)&&X.translate(ra,Y);ra=
this.geomUnitsPerPoint();1!==ra&&X.scale(ra,ra);X.translate(P.x,P.y);this.push(X,!1);this.drawText(V,S);this.pop()}};ka._buildHatchPolyline=function(V,P,S){var X=(void 0!==V.separation?V.separation:4)*S,ra=void 0!==V.rotation?V.rotation:0;if(0===X)return null;0>X&&(X=-X);for(var Y=0,ua=.5*X;Y>ua;)Y-=X;for(;Y<-ua;)Y+=X;Y=b.create();a.getBoundsXY(Y,P);Y[0]-=ua;Y[1]-=ua;Y[2]+=ua;Y[3]+=ua;for(var ca=[[Y[0],Y[1]],[Y[0],Y[3]],[Y[2],Y[3]],[Y[2],Y[1]]];180<ra;)ra-=180;for(;0>ra;)ra+=180;ua=Math.cos(ra*J);
var ia=Math.sin(ra*J);ra=-X*ia;P=X*ua;Y=(void 0!==V.offsetX?V.offsetX*S:0)*ia-(void 0!==V.offsetY?V.offsetY*S:0)*ua;let oa;var M=V=Number.MAX_VALUE;oa=S=-Number.MAX_VALUE;for(var Q of ca){var fa=Q[0];const na=Q[1];ca=ua*fa+ia*na;fa=-ia*fa+ua*na;M=Math.min(M,ca);V=Math.min(V,fa);oa=Math.max(oa,ca);S=Math.max(S,fa)}V=Math.floor(V/X)*X;Q=ua*M-ia*V-ra*Y/X;M=ia*M+ua*V-P*Y/X;ca=ua*oa-ia*V-ra*Y/X;Y=ia*oa+ua*V-P*Y/X;X=1+Math.round((S-V)/X);ua=[];for(ia=0;ia<X;ia++)Q+=ra,M+=P,ca+=ra,Y+=P,ua.push([[Q,M],[ca,
Y]]);return{paths:ua}};return n._createClass(aa)}();let E=function(aa){function ka(P,S){P=V.call(this,P,S);P.reset();return P}n._inherits(ka,aa);var V=n._createSuper(ka);aa=ka.prototype;aa.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};aa.envelope=function(){return new u(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};aa.bounds=function(){return b.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};aa.drawSolidFill=function(P){!P||
0<this._clipCount||(e.isPolygon(P)?this._processPath(P.rings,0):e.isPolyline(P)?this._processPath(P.paths,0):e.isExtent(P)?(P=N(P))&&this._processPath(P.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};aa.drawSolidStroke=function(P,S,X){!P||0<this._clipCount||(S=.5*this.transformSize(X??0),e.isPolygon(P)?this._processPath(P.rings,S):e.isPolyline(P)?this._processPath(P.paths,S):e.isExtent(P)?(P=N(P))&&this._processPath(P.rings,S):console.error("drawSolidStroke unexpected geometry type!"))};
aa.drawMarkerLayer=function(P,S){e.isPolygon(S)&&P.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===P.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===P.markerPlacement.type&&P.markerPlacement.clipAtBoundary)?this._processPath(S.rings,0):n._get(n._getPrototypeOf(ka.prototype),"drawMarkerLayer",this).call(this,P,S)};aa.drawHatchFill=function(P,S){this.drawSolidFill(P)};aa.drawPictureFill=function(P,S){this.drawSolidFill(P)};aa.drawGradientFill=function(P,S){this.drawSolidFill(P)};aa.drawPictureStroke=
function(P,S){this.drawSolidStroke(P,null,S.width)};aa.drawGradientStroke=function(P,S){this.drawSolidStroke(P,null,S.width)};aa.pushClipPath=function(P){this.drawSolidFill(P);this._clipCount++};aa.popClipPath=function(){this._clipCount--};aa.drawImage=function(P,S){var {url:X}=P;P=P.scaleX??1;let ra=P*S,Y=S;X=this._resourceManager.getResource(X);!S&&D.isSome(X)&&(ra=P*X.width,Y=X.height);this._merge(this.transformPt([-ra/2,-Y/2]),0);this._merge(this.transformPt([-ra/2,Y/2]),0);this._merge(this.transformPt([ra/
2,-Y/2]),0);this._merge(this.transformPt([ra/2,Y/2]),0)};aa.drawText=function(P,S){if(S&&0!==S.length){this._textRasterizer||(this._textRasterizer=new r);var X=B(P),[ra,Y]=this._textRasterizer.computeTextSize(S,X);S=0;switch(P.horizontalAlignment){case "Left":S=ra/2;break;case "Right":S=-ra/2}X=0;switch(P.verticalAlignment){case "Bottom":X=Y/2;break;case "Top":X=-Y/2;break;case "Baseline":X=Y/6}this._merge(this.transformPt([-ra/2+S,-Y/2+X]),0);this._merge(this.transformPt([-ra/2+S,Y/2+X]),0);this._merge(this.transformPt([ra/
2+S,-Y/2+X]),0);this._merge(this.transformPt([ra/2+S,Y/2+X]),0)}};aa._processPath=function(P,S){if(P)for(const X of P)if(P=X?X.length:0,1<P){this._merge(this.transformPt(X[0]),S);for(let ra=1;ra<P;ra++)this._merge(this.transformPt(X[ra]),S)}};aa._merge=function(P,S){P[0]-S<this._xmin&&(this._xmin=P[0]-S);P[0]+S>this._xmax&&(this._xmax=P[0]+S);P[1]-S<this._ymin&&(this._ymin=P[1]-S);P[1]+S>this._ymax&&(this._ymax=P[1]+S)};return n._createClass(ka)}(y),I=function(aa){function ka(){var P=V.apply(this,
arguments);P._searchPoint=[0,0];P._searchDistPoint=0;P._textInfo=null;return P}n._inherits(ka,aa);var V=n._createSuper(ka);aa=ka.prototype;aa.hitTest=function(P,S,X,ra,Y,ua){ua*=k.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(ua);this._searchPoint=[(P[0]+P[2])/2,(P[1]+P[3])/2];this._searchDistPoint=(P[2]-P[0])/2/ua;this._textInfo=ra;this._mapRotation=S&&("CIMPointSymbol"===S.type&&"Map"!==S.angleAlignment||"CIMTextSymbol"===S.type)?Y:0;this._earlyReturn=!1;this.drawSymbol(S,X);return this._earlyReturn};
aa.drawSolidFill=function(P,S){this._hitTestFill(P)};aa.drawHatchFill=function(P,S){this._hitTestFill(P)};aa.drawPictureFill=function(P,S){this._hitTestFill(P)};aa.drawGradientFill=function(P,S){this._hitTestFill(P)};aa.drawSolidStroke=function(P,S,X,ra,Y,ua){this._hitTestStroke(P,X)};aa.drawPictureStroke=function(P,S){this._hitTestStroke(P,S.width)};aa.drawGradientStroke=function(P,S){this._hitTestStroke(P,S.width)};aa.drawMarkerLayer=function(P,S){P.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===
P.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===P.markerPlacement.type&&P.markerPlacement.clipAtBoundary)?this._hitTestFill(S):n._get(n._getPrototypeOf(ka.prototype),"drawMarkerLayer",this).call(this,P,S)};aa.pushClipPath=function(P){};aa.popClipPath=function(){};aa.drawImage=function(P,S){var {url:X}=P;P=P.scaleX??1;X=this._resourceManager.getResource(X);if(!D.isNone(X)&&0!==X.height&&0!==S){S*=this.geomUnitsPerPoint();P=X.width/X.height*P*S;X=this.reverseTransformPt(this._searchPoint);
var ra=this._searchDistPoint;Math.abs(X[0])<P/2+ra&&Math.abs(X[1])<S/2+ra&&(this._earlyReturn=!0)}};aa.drawText=function(P,S){if(S=this._textInfo)if(S=S.get(P)){var {text:X,mosaicItem:ra}=S;if(ra?.glyphMosaicItems?.length){S=P.height??10;var {lineGapType:Y,lineGap:ua}=P,ca=Y?la(Y,ua??0,S):0,ia=G.bidiText(X)[1],oa="CIMBackgroundCallout"===P.callout?.type;P=t.shapeGlyphs(ra.glyphMosaicItems,ia,{scale:S/m.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:U(P.horizontalAlignment),vAlign:ba(P.verticalAlignment),
maxLineWidth:512,lineHeight:m.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(ca||1,4)),decoration:P.font.decoration||"none",isCIM:!0,hasBackground:oa});ca=this.reverseTransformPt(this._searchPoint);S=ca[0];ca=ca[1];for(const M of P.glyphs)if(S>M.xTopLeft&&S<M.xBottomRight&&ca>-M.yBottomRight&&ca<-M.yTopLeft){this._earlyReturn=!0;break}}}};aa._hitTestFill=function(P){let S=null;if(e.isExtent(P))S=[[[P.xmin,P.ymin],[P.xmin,P.ymax],[P.xmax,P.ymax],[P.xmax,P.ymin],[P.xmin,P.ymin]]];else if(e.isPolygon(P))S=
P.rings;else if(e.isPolyline(P))S=P.paths;else return;P=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(P,S)&&(this._earlyReturn=!0);if(!this._earlyReturn){const X=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(P,S,X)&&(this._earlyReturn=!0)}};aa._hitTestStroke=function(P,S){let X=null;if(e.isExtent(P))X=[[[P.xmin,P.ymin],[P.xmin,P.ymax],[P.xmax,P.ymax],[P.xmax,P.ymin],[P.xmin,P.ymin]]];else if(e.isPolygon(P))X=P.rings;else if(e.isPolyline(P))X=
P.paths;else return;P=this.reverseTransformPt(this._searchPoint);S=(S??0)*this.geomUnitsPerPoint();const ra=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(P,X,S/2+ra)&&(this._earlyReturn=!0)};aa._pointInPolygon=function(P,S){let X=0;for(const ra of S){S=ra.length;for(let Y=1;Y<S;Y++){const ua=ra[Y-1],ca=ra[Y];ua[1]>P[1]!==ca[1]>P[1]&&(0<(ca[0]-ua[0])*(P[1]-ua[1])-(ca[1]-ua[1])*(P[0]-ua[0])?X++:X--)}}return 0!==X};aa._nearLine=function(P,S,X){for(const Y of S){S=
Y.length;for(let ua=1;ua<S;ua++){var ra=Y[ua-1];const ca=Y[ua];let ia=(ca[0]-ra[0])*(ca[0]-ra[0])+(ca[1]-ra[1])*(ca[1]-ra[1]);if(0!==ia&&(ia=Math.sqrt(ia),Math.abs(((ca[0]-ra[0])*(P[1]-ra[1])-(ca[1]-ra[1])*(P[0]-ra[0]))/ia)<X&&(ra=((ca[0]-ra[0])*(P[0]-ra[0])+(ca[1]-ra[1])*(P[1]-ra[1]))/ia,ra>-X&&ra<ia+X)))return!0}}return!1};return n._createClass(ka)}(y),H=function(aa){function ka(P,S,X,ra){S=V.call(this,S,X);S._applyAdditionalRenderProps=ra;S._colorSubstitutionHelper=new c;S._ctx=P;return S}n._inherits(ka,
aa);var V=n._createSuper(ka);aa=ka.prototype;aa.drawSolidFill=function(P,S){if(P){if(e.isPolygon(P))this._buildPath(P.rings,!0);else if(e.isPolyline(P))this._buildPath(P.paths,!0);else if(e.isExtent(P))this._buildPath(N(P).rings,!0);else if(e.isMultipoint(P))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");else return;P=this._ctx;P.fillStyle="string"===typeof S?S:"rgba("+Math.round(S[0])+","+Math.round(S[1])+","+Math.round(S[2])+","+(S[3]??255)/255+")";P.fill("evenodd")}};aa.drawSolidStroke=
function(P,S,X,ra,Y,ua){if(P&&S&&0!==X){if(e.isPolygon(P))this._buildPath(P.rings,!0);else if(e.isPolyline(P))this._buildPath(P.paths,!1);else if(e.isExtent(P))this._buildPath(N(P).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}P=this._ctx;P.strokeStyle="string"===typeof S?S:"rgba("+Math.round(S[0])+","+Math.round(S[1])+","+Math.round(S[2])+","+(S[3]??255)/255+")";P.lineWidth=Math.max(this.transformSize(X),.5);this._setCapStyle(ra);this._setJoinStyle(Y);P.miterLimit=
ua;P.stroke()}};aa.pushClipPath=function(P){this._ctx.save();if(e.isPolygon(P))this._buildPath(P.rings,!0);else if(e.isPolyline(P))this._buildPath(P.paths,!0);else if(e.isExtent(P))this._buildPath(N(P).rings,!0);else return;this._ctx.clip("evenodd")};aa.popClipPath=function(){this._ctx.restore()};aa.drawImage=function(P,S){const {colorSubstitutions:X,url:ra,tintColor:Y}=P;P=P.scaleX??1;var ua=this._resourceManager.getResource(ra);if(!D.isNone(ua)){var ca=ua.width/ua.height*S,ia=S;S||(ca=ua.width,
ia=ua.height);var oa=A.isSVGImage(ra)||"src"in ua&&A.isSVGImage(ua.src);S="getFrame"in ua?l.getFirstFrame(ua):ua;X&&(S=this._colorSubstitutionHelper.applyColorSubstituition(S,X));this._applyAdditionalRenderProps&&!oa&&Y&&(S=this._colorSubstitutionHelper.tintImageData(S,Y));ua=this.transformPt([0,0]);var [M,Q]=this.getTransformAngle();oa=this.transformSize(1);var fa=this._ctx;fa.save();fa.setTransform({m11:P*oa*M,m12:P*oa*Q,m21:-oa*Q,m22:oa*M,m41:ua[0],m42:ua[1]});fa.drawImage(S,-ca/2,-ia/2,ca,ia);
fa.restore()}};aa.drawText=function(P,S){if(S&&0!==S.length&&(this._textRasterizer||(this._textRasterizer=new r),P=B(P),P.size*=this.transformSize(k.px2pt(1)),S=this._textRasterizer.rasterizeText(S,P))){var {size:X,anchorX:ra,anchorY:Y,canvas:ua}=S;S=X[0]*(ra+.5);P=X[1]*(Y-.5);var ca=this._ctx,ia=this.transformPt([0,0]),[oa,M]=this.getTransformAngle();ca.save();ca.setTransform({m11:1*oa,m12:1*M,m21:-1*M,m22:1*oa,m41:ia[0]-1*S,m42:ia[1]+1*P});ca.drawImage(ua,0,0);ca.restore()}};aa.drawPictureFill=
function(P,S){if(P){var {colorSubstitutions:X,height:ra,offsetX:Y,offsetY:ua,rotation:ca,scaleX:ia,tintColor:oa,url:M}=S;S=this._resourceManager.getResource(M);if(!D.isNone(S)){if(e.isPolygon(P))this._buildPath(P.rings,!0);else if(e.isPolyline(P))this._buildPath(P.paths,!0);else if(e.isExtent(P))this._buildPath(N(P).rings,!0);else if(e.isMultipoint(P))console.log("CanvasDrawHelper.drawPictureFill - No implementation!");else return;P=this._ctx;var Q=A.isSVGImage(M)||"src"in S&&A.isSVGImage(S.src),
fa="getFrame"in S?l.getFirstFrame(S):S;X&&(fa=this._colorSubstitutionHelper.applyColorSubstituition(fa,X));if(this._applyAdditionalRenderProps){if(Q||oa&&(fa=this._colorSubstitutionHelper.tintImageData(fa,oa)),Q=P.createPattern(fa,"repeat"),fa=this.transformSize(1),ca||(ca=0),Y=Y?fa*Y:0,ua=ua?fa*ua:0,ra&&(ra*=fa),fa=ra?ra/S.height:1,S=ia&&ra?ia*ra/S.width:1,0!==ca||1!==fa||1!==S||0!==Y||0!==ua){const na=new DOMMatrix;na.rotateSelf(0,0,-ca).translateSelf(Y,ua).scaleSelf(S,fa,1);Q.setTransform(na)}}else Q=
P.createPattern(fa,"repeat");P.save();P.fillStyle=Q;P.fill("evenodd");P.restore()}}};aa.drawPictureStroke=function(P,S){if(P){var {colorSubstitutions:X,capStyle:ra,joinStyle:Y,miterLimit:ua,tintColor:ca,url:ia,width:oa}=S;S=this._resourceManager.getResource(ia);if(!D.isNone(S)){if(e.isPolygon(P))var M=P.rings;else if(e.isPolyline(P))M=P.paths;else if(e.isExtent(P))M=N(P).rings;else{e.isMultipoint(P)&&console.log("CanvasDrawHelper.drawPictureStroke - No implementation!");return}oa||(oa=S.width);P=
A.isSVGImage(ia)||"src"in S&&A.isSVGImage(S.src);var Q="getFrame"in S?l.getFirstFrame(S):S;X&&(Q=this._colorSubstitutionHelper.applyColorSubstituition(Q,X));this._applyAdditionalRenderProps&&(P||ca&&(Q=this._colorSubstitutionHelper.tintImageData(Q,ca)));S=Math.max(this.transformSize(k.pt2px(oa)),.5);P=S/Q.width;var fa=this._ctx;Q=fa.createPattern(Q,"repeat-y");fa.save();this._setCapStyle(ra);this._setJoinStyle(Y);void 0!==ua&&(fa.miterLimit=ua);fa.lineWidth=S;var na;for(let ma of M){ma=z.clone(ma);
var za=na=void 0,W=void 0;let qa=za=void 0;M=ma;for(var da=M[0],ha=1;ha<M.length;)qa=M[ha][0]-da[0],za=M[ha][1]-da[1],za=0!==qa?za/qa:Math.PI/2,void 0!==W&&1E-4>=za-W?(M.splice(ha-1,1),da=na):(na=da,da=M[ha],ha++),W=za;if(ma&&!(1>=ma.length))for(M=this.transformPt(ma[0]),W=1;W<ma.length;W++)na=this.transformPt(ma[W]),da=180/Math.PI*Math.atan2(na[1]-M[1],na[0]-M[0]),ha=new DOMMatrix,ha.translateSelf(0,M[1]-S/2).scaleSelf(P,P,1).rotateSelf(0,0,90-da),Q.setTransform(ha),fa.strokeStyle=Q,fa.beginPath(),
fa.moveTo(M[0],M[1]),fa.lineTo(na[0],na[1]),fa.stroke(),M=na}fa.restore()}}};aa._buildPath=function(P,S){const X=this._ctx;X.beginPath();if(P)for(const ra of P)if(P=ra?ra.length:0,1<P){let Y=this.transformPt(ra[0]);X.moveTo(Y[0],Y[1]);for(let ua=1;ua<P;ua++)Y=this.transformPt(ra[ua]),X.lineTo(Y[0],Y[1]);S&&X.closePath()}};aa._setCapStyle=function(P){switch(P){case v.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case v.LineCapStyle.Round:this._ctx.lineCap="round";break;case v.LineCapStyle.Square:this._ctx.lineCap=
"square"}};aa._setJoinStyle=function(P){switch(P){case v.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case v.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case v.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return n._createClass(ka)}(y);const N=aa=>aa?{spatialReference:aa.spatialReference,rings:[[[aa.xmin,aa.ymin],[aa.xmin,aa.ymax],[aa.xmax,aa.ymax],[aa.xmax,aa.ymin],[aa.xmin,aa.ymin]]]}:null,U=aa=>{switch(aa){case "Left":return w.HAlign.Left;case "Right":return w.HAlign.Right;
case "Center":return w.HAlign.Center;case "Justify":return C.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),w.HAlign.Center}},ba=aa=>{switch(aa){case "Top":return w.VAlign.Top;case "Center":return w.VAlign.Center;case "Bottom":return w.VAlign.Bottom;case "Baseline":return w.VAlign.Baseline}},la=(aa,ka,V)=>{switch(aa){case "ExtraLeading":return 1+ka/V;case "Multiple":return ka;case "Exact":return ka/V}};q.CIMSymbolDrawHelper=y;q.C_DEG_TO_RAD=J;q.CanvasDrawHelper=
H;q.EnvDrawHelper=E;q.HittestDrawHelper=I;q.Transformation=K;q.horizontalAlignment2HAlign=U;q.lineGapType2LineHeight=la;q.verticalAlignment2VAlign=ba;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMImageColorSubstitutionHelper":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(q){return function(){function n(){}var G=n.prototype;G.applyColorSubstituition=function(F,z){if(!z)return F;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));
const {width:y,height:D}=F,x=this._rasterizationCanvas,k=x.getContext("2d");F!==x&&(x.width=y,x.height=D,k.drawImage(F,0,0,y,D));F=k.getImageData(0,0,y,D).data;if(z)for(var g of z)if(g&&g.oldColor&&4===g.oldColor.length&&g.newColor&&4===g.newColor.length){const [b,a,h,e]=g.oldColor,[f,c,d,p]=g.newColor;if(b!==f||a!==c||h!==d||e!==p)for(z=0;z<F.length;z+=4)b===F[z]&&a===F[z+1]&&h===F[z+2]&&e===F[z+3]&&(F[z]=f,F[z+1]=c,F[z+2]=d,F[z+3]=p)}g=new ImageData(F,y,D);k.putImageData(g,0,0);return x};G.tintImageData=
function(F,z){if(!z||4>z.length)return F;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const {width:y,height:D}=F,x=this._rasterizationCanvas,k=x.getContext("2d");F!==x&&(x.width=y,x.height=D,k.drawImage(F,0,0,y,D));F=k.getImageData(0,0,y,D);F=new Uint8Array(F.data);z=[z[0]/255,z[1]/255,z[2]/255,z[3]/255];for(let g=0;g<F.length;g+=4)F[g]*=z[0],F[g+1]*=z[1],F[g+2]*=z[2],F[g+3]*=z[3];z=new ImageData(new Uint8ClampedArray(F.buffer),y,D);k.putImageData(z,0,0);
return x};return q._createClass(n)}()})},"esri/symbols/cim/imageUtils":function(){define(["exports"],function(q){q.getFirstFrame=function(n){const G=n.getFrame(0);if(G instanceof HTMLImageElement||G instanceof HTMLCanvasElement)return G;const F=document.createElement("canvas");F.width=n.width;F.height=n.height;n=F.getContext("2d");G instanceof ImageData?n.putImageData(G,0,0):n.drawImage(G,0,0);return F};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],
function(q){return function(){function n(G=0,F=0,z=0,y=0){this.x=G;this.y=F;this.width=z;this.height=y}n.prototype.union=function(G){this.x=Math.min(this.x,G.x);this.y=Math.min(this.y,G.y);this.width=Math.max(this.width,G.width);this.height=Math.max(this.height,G.height)};q._createClass(n,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return n}()})},"esri/symbols/cim/TextRasterizer":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/screenUtils"],function(q,
n){return function(){function G(z){z&&(this._textRasterizationCanvas=z)}var F=G.prototype;F.rasterizeText=function(z,y){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const D=this._textRasterizationCanvas;var x=D.getContext("2d");this._setFontProperties(x,y);this._parameters=y;this._textLines=z.split(/\r?\n/);this._lineHeight=this._computeLineHeight();z=this._computeTextWidth(x,y);const {decoration:k,weight:g}=y.font;this._lineThroughWidthOffset=k&&
"line-through"===k?.1*this._lineHeight:0;var b=this._lineHeight*this._textLines.length;D.width=z+2*this._lineThroughWidthOffset;D.height=b;this._renderedLineHeight=Math.round(this._lineHeight*y.pixelRatio);this._renderedHaloSize=y.halo.size*y.pixelRatio;this._renderedWidth=z*y.pixelRatio;this._renderedHeight=b*y.pixelRatio;this._lineThroughWidthOffset*=y.pixelRatio;z=y.halo&&y.halo.color?y.halo.color:[0,0,0,0];b=y.color??[0,0,0,0];this._fillStyle=`rgba(${b.slice(0,3).toString()},${b[3]})`;this._haloStyle=
`rgb(${z.slice(0,3).toString()})`;z=this._renderedLineHeight;b=this._renderedHaloSize;x.save();x.clearRect(0,0,D.width,D.height);this._setFontProperties(x,y);var a=x.textAlign,h=this._renderedWidth;a=("center"===a?.5*h:"right"===a?h:0)+b;h=0<b;let e=this._lineThroughWidthOffset,f=0;h&&this._renderHalo(x,a,b,e,f,y);f+=b;e+=a;for(var c of this._textLines)h&&(x.globalCompositeOperation="destination-out",x.fillStyle="rgb(0, 0, 0)",x.fillText(c,e,f),x.globalCompositeOperation="source-over"),x.fillStyle=
this._fillStyle,x.fillText(c,e,f),k&&"none"!==k&&this._renderDecoration(x,e,f,k,g),f+=z;x.restore();c=this._renderedWidth+2*this._lineThroughWidthOffset;z=this._renderedHeight;x=x.getImageData(0,0,c,z);x=new Uint8Array(x.data);if(y.premultiplyColors)for(a=0;a<x.length;a+=4)b=x[a+3]/255,x[a]*=b,x[a+1]*=b,x[a+2]*=b;switch(y.horizontalAlignment){case "left":b=-.5;break;case "right":b=.5;break;default:b=0}switch(y.verticalAlignment){case "bottom":y=-.5;break;case "top":y=.5;break;default:y=0}return{size:[c,
z],image:new Uint32Array(x.buffer),sdf:!1,simplePattern:!1,anchorX:b,anchorY:y,canvas:D}};F._renderHalo=function(z,y,D,x,k,g){const b=this._renderedWidth,a=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=b;this._haloRasterizationCanvas.height=a;const h=this._haloRasterizationCanvas,e=h.getContext("2d");e.clearRect(0,0,b,a);this._setFontProperties(e,g);const {decoration:f,weight:c}=g.font;e.fillStyle=
this._haloStyle;e.strokeStyle=this._haloStyle;e.lineJoin="round";this._renderHaloNative(e,y,D,f,c);z.globalAlpha=this._parameters.halo.color[3];z.drawImage(h,0,0,b,a,x,k,b,a);z.globalAlpha=1};F._renderHaloNative=function(z,y,D,x,k){const g=this._renderedLineHeight,b=this._renderedHaloSize;for(const a of this._textLines){const h=2*b;for(let e=0;5>e;e++){const f=(.6+.1*e)*h;z.lineWidth=f;z.strokeText(a,y,D);x&&"none"!==x&&this._renderDecoration(z,y,D,x,k,f)}D+=g}};F._setFontProperties=function(z,y){var D=
y.font;D=`${D.style} ${D.weight} ${n.pt2px(Math.max(y.size,.5)*y.pixelRatio).toFixed(1)}px ${D.family}, sans-serif`;z.font=D;z.textBaseline="top";switch(y.horizontalAlignment){case "left":y="left";break;case "right":y="right";break;case "center":y="center";break;default:y="left"}z.textAlign=y};F.computeTextSize=function(z,y){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const D=this._textRasterizationCanvas;var x=D.getContext("2d");this._setFontProperties(x,
y);this._parameters=y;this._textLines=z.split(/\r?\n/);this._lineHeight=this._computeLineHeight();z=this._computeTextWidth(x,y);x=this._lineHeight*this._textLines.length;D.width=z;D.height=x;return[z*y.pixelRatio,x*y.pixelRatio]};F._computeTextWidth=function(z,y){let D=0;for(const x of this._textLines)D=Math.max(D,z.measureText(x).width);y=y.font;if("italic"===y.style||"oblique"===y.style||"string"===typeof y.weight&&("bold"===y.weight||"bolder"===y.weight)||"number"===typeof y.weight&&600<y.weight)D+=
.3*z.measureText("w").width;D+=2*this._parameters.halo.size;return Math.round(D)};F._computeLineHeight=function(){let z=1.275*this._parameters.size;const y=this._parameters.font.decoration;y&&"underline"===y&&(z*=1.3);return Math.round(z+2*this._parameters.halo.size)};F._renderDecoration=function(z,y,D,x,k,g){const b=.9*this._lineHeight;switch(z.textAlign){case "center":y-=this._renderedWidth/2;break;case "right":y-=this._renderedWidth}const a=z.textBaseline;if("underline"===x)switch(a){case "top":D+=
b;break;case "middle":D+=b/2}else if("line-through"===x)switch(a){case "top":D+=b/1.5;break;case "middle":D+=b/3}x=g?1.5*g:Math.ceil(b*("bold"===k?.06:"bolder"===k?.09:.04));z.save();z.beginPath();z.strokeStyle=z.fillStyle;z.lineWidth=x;z.moveTo(y-this._lineThroughWidthOffset,D);z.lineTo(y+this._renderedWidth+2*this._lineThroughWidthOffset,D);z.stroke();z.restore()};return q._createClass(G)}()})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(q,n){function G(b){let a=b.length;
for(;a--;)if(!" /-,\n".includes(b.charAt(a)))return!1;return!0}function F(b,a){const h=[];var e=0;let f=-1;do f=b.indexOf("[",e),f>=e&&(f>e&&(e=b.substr(e,f-e),h.push([e,null,G(e)])),e=f+1,f=b.indexOf("]",e),f>=e&&(f>e&&(e=b.substr(e,f-e),(e=a[e])&&h.push([null,e,!1])),e=f+1));while(-1!==f);e<b.length-1&&(b=b.substr(e),h.push([b,null,G(b)]));return h}function z(b,a,h){let e="",f=null;for(const c of a){const [d,p,v]=c;if(d)v?f=d:(f&&(e+=f,f=null),e+=d);else if(a=b.attributes[p])f&&(e+=f,f=null),e+=
a}return y(e,h)}function y(b,a){"string"!==typeof b&&(b=String(b));switch(a){case "LowerCase":return b.toLowerCase();case "Allcaps":return b.toUpperCase();default:return b}}function D(b){return b?{r:b[0],g:b[1],b:b[2],a:b[3]/255}:{r:0,g:0,b:0,a:0}}function x(b){if(!b)return null;switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers)for(const a of b.symbolLayers)if(b=x(a),null!=b)return b;break;case "CIMTextSymbol":return x(b.symbol);case "CIMSolidFill":return b.color}}function k(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b=
b.symbolLayers)for(const a of b)if(b=k(a),null!=b)return b;break;case "CIMTextSymbol":return k(b.symbol);case "CIMSolidStroke":case "CIMSolidFill":return b.color}}function g(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers)for(const a of b.symbolLayers)if(b=g(a),void 0!==b)return b;break;case "CIMTextSymbol":return g(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}}n.adjustTextCase=y;n.analyzeTextParts=F;n.assignTextValuesFromFeature=
z;n.attributesToFields=function(b){return(b?Object.keys(b):[]).map(a=>({name:a,alias:a,type:"string"===typeof b[a]?"esriFieldTypeString":"esriFieldTypeDouble"}))};n.colorToArray=function(b){return[b.r,b.g,b.b,b.a]};n.createLabelOverrideFunction=function(b,a,h){const e=F(a,b);return f=>z(f,e,h)};n.evaluateValueOrFunction=function(b,a,h,e){return"function"===typeof b?b(a,h,e):b};n.fromCIMColor=D;n.fromCIMFontDecoration=function(b){return b.underline?"underline":b.strikethrough?"line-through":"none"};
n.fromCIMFontStyle=function(b){let a="",h="";b&&(b=b.toLowerCase(),b.includes("italic")?a="italic":b.includes("oblique")&&(a="oblique"),b.includes("bold")?h="bold":b.includes("light")&&(h="lighter"));return{style:a,weight:h}};n.fromCIMHorizontalAlignment=function(b){switch(b){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};n.fromCIMVerticalAlignment=function(b){switch(b){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";
case "Bottom":return"bottom"}};n.getFillColor=x;n.getFontStyle=function(b){if(!b)return"normal";switch(b.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};n.getFontWeight=function(b){if(!b)return"normal";switch(b.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};n.getStrokeColor=k;n.getStrokeWidth=g;n.getTintColor=b=>b.tintColor?D(b.tintColor):{r:255,g:255,b:255,a:1};n.getValue=
(b,a=0)=>null==b||isNaN(b)?a:b;n.importGeometryEngine=function(){return new Promise((b,a)=>q(["../../geometry/geometryEngineJSON"],b,a))};n.isCIMFill=function(b){return null!=b&&("CIMGradientFill"===b.type||"CIMHatchFill"===b.type||"CIMPictureFill"===b.type||"CIMSolidFill"===b.type||"CIMWaterFill"===b.type)};n.isCIMMarker=function(b){return"CIMVectorMarker"===b.type||"CIMPictureMarker"===b.type||"CIMBarChartMarker"===b.type||"CIMCharacterMarker"===b.type||"CIMPieChartMarker"===b.type||"CIMStackedBarChartMarker"===
b.type};n.isCIMMarkerStrokePlacement=function(b){return null!=b&&("CIMMarkerPlacementAlongLineRandomSize"===b.type||"CIMMarkerPlacementAlongLineSameSize"===b.type||"CIMMarkerPlacementAlongLineVariableSize"===b.type||"CIMMarkerPlacementAtExtremities"===b.type||"CIMMarkerPlacementAtMeasuredUnits"===b.type||"CIMMarkerPlacementAtRatioPositions"===b.type||"CIMMarkerPlacementOnLine"===b.type||"CIMMarkerPlacementOnVertices"===b.type)};n.isCIMStroke=function(b){return"CIMGradientStroke"===b.type||"CIMPictureStroke"===
b.type||"CIMSolidStroke"===b.type};n.isGeometryEngineRequired=b=>{if(!b)return!1;for(const a of b)switch(a.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};n.isSVGImage=b=>b.includes("data:image/svg+xml");n.mapCIMSymbolToGeometryType=function(b){if(!b)return null;switch(b.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";
default:return null}};n.resampleHermite=function(b,a,h,e,f,c,d=!0){const p=a/f;h/=c;const v=Math.ceil(p/2),l=Math.ceil(h/2);for(let A=0;A<c;A++)for(let w=0;w<f;w++){const m=4*(w+(d?c-A-1:A)*f);var u=0;let t=0,B=0,J=0,C=0,K=0,E=0;const I=(A+.5)*h;for(let H=Math.floor(A*h);H<(A+1)*h;H++){var r=Math.abs(I-(H+.5))/l;const N=(w+.5)*p;r*=r;for(let U=Math.floor(w*p);U<(w+1)*p;U++){let ba=Math.abs(N-(U+.5))/v;u=Math.sqrt(r+ba*ba);-1<=u&&1>=u&&(u=2*u*u*u-3*u*u+1,0<u&&(ba=4*(U+H*a),E+=u*b[ba+3],B+=u,255>b[ba+
3]&&(u=u*b[ba+3]/250),J+=u*b[ba],C+=u*b[ba+1],K+=u*b[ba+2],t+=u))}}e[m]=J/t;e[m+1]=C/t;e[m+2]=K/t;e[m+3]=E/B}};n.toCIMSymbolJSON=function(b){return b.data?.symbol??null};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../core/maybe","../../../geometry/support/quantizationUtils"],function(q,n,G,F){function z(D){const x={};switch(D){case "esriGeometryPoint":return(k,
g,b,a)=>F.unquantizePoint(g,x,k,b,a);case "esriGeometryPolygon":return(k,g,b,a)=>F.unquantizePolygon(g,x,k,b,a);case "esriGeometryPolyline":return(k,g,b,a)=>F.unquantizePolyline(g,x,k,b,a);case "esriGeometryMultipoint":return(k,g,b,a)=>F.unquantizeMultipoint(g,x,k,b,a);default:return n.getLogger("esri.views.2d.support.arcadeOnDemand").error(new q("mapview-arcade",`Unable to handle geometryType: ${D}`)),k=>k}}const y=new Map;return function(D,x,k,g,b){if(G.isNone(D))return null;if(D.referencesGeometry()&&
b){const {transform:a,hasZ:h,hasM:e}=b;y.has(g)||y.set(g,z(g));g=y.get(g)(x.geometry,a,h,e);x={...x,geometry:g}}x=D.repurposeFeature(x);try{return D.evaluate({...k,$feature:x})}catch(a){return n.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}})},"esri/symbols/cim/quantizeTime":function(){define(["exports"],function(q){const n=new Set(["StartTimeOffset","Duration","RepeatDelay"]);q.quantizeIfNeeded=function(G,F){return n.has(F)?.05*Math.max(Math.round(G/
.05),1):G};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect","../../views/2d/engine/webgl/definitions"],function(q,n,G,F,z){function y(x){if(!x)return null;switch(x.type){case "CIMPointSymbol":x=x.symbolLayers;if(!x||1!==x.length)break;return y(x[0]);case "CIMVectorMarker":x=x.markerGraphics;if(!x||1!==x.length)break;var k=x[0];if(!k)break;x=k.geometry;if(!x)break;
k=k.symbol;if(!k||"CIMPolygonSymbol"!==k.type&&"CIMLineSymbol"!==k.type||k.symbolLayers?.some(g=>!!g.effects))break;return{geom:x,asFill:"CIMPolygonSymbol"===k.type};case "sdf":return{geom:x.geom,asFill:x.asFill}}return null}function D(x){let k=Infinity,g=-Infinity,b=Infinity,a=-Infinity;for(const h of x)for(const e of h)e[0]<k&&(k=e[0]),e[0]>g&&(g=e[0]),e[1]<b&&(b=e[1]),e[1]>a&&(a=e[1]);return[k,b,g,a]}q.buildSDF=function(x){var k=x.geom;var g=k?k.rings?k.rings:k.paths?k.paths:void 0!==k.xmin&&void 0!==
k.ymin&&void 0!==k.xmax&&void 0!==k.ymax?[[[k.xmin,k.ymin],[k.xmin,k.ymax],[k.xmax,k.ymax],[k.xmax,k.ymin],[k.xmin,k.ymin]]]:null:null;k=Infinity;var b=-Infinity;var a=Infinity;var h=-Infinity;for(var e of g)for(var f of e)f[0]<k&&(k=f[0]),f[0]>b&&(b=f[0]),f[1]<a&&(a=f[1]),f[1]>h&&(h=f[1]);a=new F(k,a,b-k,h-a);e=z.SPRITE_PADDING;k=Math.floor(.5*(64-e));h=(128-2*(k+e))/Math.max(a.width,a.height);e=Math.round(a.width*h)+2*k;f=Math.round(a.height*h)+2*k;b=[];for(var c of g)if(c&&1<c.length){g=[];for(var d of c){let [J,
C]=d;J-=a.x;C-=a.y;J*=h;C*=h;J+=k-.5;C+=k-.5;x.asFill?g.push([J,C]):g.push([Math.round(J),Math.round(C)])}if(x.asFill){var p=g.length-1;g[0][0]===g[p][0]&&g[0][1]===g[p][1]||g.push(g[0])}b.push(g)}d=e*f;c=Array(d);g=k*k+1;for(a=0;a<d;++a)c[a]=g;for(var v of b)for(g=v.length,a=1;a<g;++a){h=v[a-1];p=v[a];var l=void 0,u=void 0;h[0]<p[0]?(l=h[0],u=p[0]):(l=p[0],u=h[0]);var r=void 0,A=void 0;h[1]<p[1]?(r=h[1],A=p[1]):(r=p[1],A=h[1]);var w=Math.floor(l)-k;u=Math.floor(u)+k;r=Math.floor(r)-k;A=Math.floor(A)+
k;0>w&&(w=0);u>e&&(u=e);0>r&&(r=0);A>f&&(A=f);l=p[0]-h[0];const J=p[1]-h[1],C=l*l+J*J;for(;w<u;w++)for(let K=r;K<A;K++){var m=(w-h[0])*l+(K-h[1])*J,t=void 0;0>m?(t=h[0],m=h[1]):m>C?(t=p[0],m=p[1]):(m/=C,t=h[0]+m*l,m=h[1]+m*J);t=(w-t)*(w-t)+(K-m)*(K-m);m=(f-K-1)*e+w;t<c[m]&&(c[m]=t)}}for(v=0;v<d;++v)c[v]=Math.sqrt(c[v]);if(x.asFill)for(var B of b)for(x=B.length,v=1;v<x;++v)for(b=B[v-1],d=B[v],b[0]<d[0]?(g=b[0],a=d[0]):(g=d[0],a=b[0]),b[1]<d[1]?(p=b[1],h=d[1]):(p=d[1],h=b[1]),g=Math.floor(g),a=Math.floor(a)+
1,p=Math.floor(p),h=Math.floor(h)+1,g<k&&(g=k),a>e-k&&(a=e-k),p<k&&(p=k),h>f-k&&(h=f-k);p<h;++p)if(b[1]>p!==d[1]>p){u=(f-p-1)*e;for(r=g;r<a;++r)r<(d[0]-b[0])*(p-b[1])/(d[1]-b[1])+b[0]&&(c[u+r]=-c[u+r]);for(r=k;r<g;++r)c[u+r]=-c[u+r]}B=2*k;k=c.length;x=new Uint8Array(4*k);for(v=0;v<k;++v)n.packFloatRGBA(.5-c[v]/B,x,4*v);return[x,e,f]};q.getExtent=function(x){return x?x.rings?D(x.rings):x.paths?D(x.paths):G.isExtent(x)?[x.xmin,x.ymin,x.xmax,x.ymax]:null:null};q.getSDFInfo=y;q.getSDFMetrics=function(x,
k,g,b,a){const [h,e,f,c]=x;if(f<h||c<e)return[0,0,0];var d=f-h,p=c-e,v=z.SPRITE_PADDING;x=Math.floor(.5*(64-v));v=(128-2*(x+v))/Math.max(d,p);const l=Math.round(d*v),u=Math.round(p*v)+2*x;p=1;k&&(p=u/v/(k.ymax-k.ymin));let r=0,A=0;d=1;b&&(a?k&&g&&0<k.ymax-k.ymin&&(d=(k.xmax-k.xmin)/(k.ymax-k.ymin),r=b.x/(g*d),A=b.y/g):(r=b.x,A=b.y));k&&(r=.5*(k.xmax+k.xmin)+r*(k.xmax-k.xmin),A=.5*(k.ymax+k.ymin)+A*(k.ymax-k.ymin));r=(r-h)*v+x;A=(A-e)*v+x;k=r/(l+2*x)-.5;b=A/u-.5;a&&g&&(k*=g*d,b*=g);return[p,k,b]};
Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(q,n){function G(D,x=0){let k=0;for(let g=0;4>g;g++)k+=D[x+g]*z[g];return k}const F=[1,256,65536,16777216],z=[1/256,1/65536,1/16777216,1/4294967296],y=G(new Uint8ClampedArray([255,255,255,255]));q.packFloatRGBA=function(D,x,k=0){D=n.clamp(D,0,y);for(let a=0;4>a;a++){var g=Math,b=D*F[a];x[k+a]=g.floor.call(g,256*(b-Math.floor(b)))}};q.unpackFloatRGBA=G;Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/grouping":function(){define(["exports","../../../../core/string"],function(q,n){function G(F,z){if("string"===typeof F)F=n.numericHash(F+`-seed(${z})`);else{let y=12;F^=z;do F=107*(F>>8^F)+y|0;while(0!==--y)}return(1+F/-2147483648)/2}q.getMaterialGroup=function(F){return Math.floor(10*G(F,53290320))};q.getRandomValue=G;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports",
"../../../../../core/Error"],function(q,n){q.ok=function(G,F){return G&&"name"in G?(F&&F.error(new n(G.name,G.message,G.details)),!1):!0};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b){return function(a){function h(f,c,d){var p=e.call(this,f);p._minMaxZoom=y.i1616to32(Math.round(c*z.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(d*z.MIN_MAX_ZOOM_PRECISION_FACTOR));p._cimLineLayer=f;let v=0;x.isFunction(f.width)||(v=.5*G.pt2px(f.width));p._dynamicPropertyMap.set("_halfWidth",(r,A,w)=>x.isFunction(f.width)?.5*G.pt2px(f.width(r,A,w)):v);x.isFunction(f.cap)?p._dynamicPropertyMap.set("_capType",f.cap):p._capType=f.cap;x.isFunction(f.join)?p._dynamicPropertyMap.set("_joinType",
f.join):p._joinType=f.join;const l=f.color;x.isFunction(l)?p._dynamicPropertyMap.set("_fillColor",(r,A,w)=>F.premultiplyAlphaRGBA(l(r,A,w))):p._fillColor=l&&F.premultiplyAlphaRGBA(l)||0;const u=f.miterLimit;x.isFunction(u)?p._dynamicPropertyMap.set("_miterLimitCosine",(r,A,w)=>x.getLimitCosine(u(r,A,w))):p._miterLimitCosine=x.getLimitCosine(u);n.isSome(f.effects)&&(c=f.effects,x.isFunction(c)?p._dynamicPropertyMap.set("_effects",c):p._effects=c);p._scaleFactor=f.scaleFactor||1;p._isDashed=null!=f.dashTemplate;
p.tessellationProperties._bitset=(f.colorLocked?z.BITSET_GENERIC_LOCK_COLOR:0)|(f.scaleDash?z.BITSET_LINE_SCALE_DASH:0)|(f.sampleAlphaOnly?z.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);p._materialKey=f.materialKey;p._initializeTessellator(!0);return p}q._inherits(h,a);var e=q._createSuper(h);h.fromCIMLine=function(f,c){const [d,p]=x.getMinMaxZoom(f.scaleInfo,c);return new h(f,d,p)};h.prototype.bindFeature=function(f,c,d){const p=f.readLegacyFeature();this._dynamicPropertyMap.forEach((l,u)=>{this[u]=l(p,
c,d)});this._halfWidth*=this._scaleFactor;f=this._materialCache;var v=this._cimLineLayer.materialHash;v=v(p,c,d);v=f.get(v);f=null;v&&b.ok(v.spriteMosaicItem)&&(f=v.spriteMosaicItem);if(f){this._hasPattern=!0;const {rect:l,width:u,height:r}=f;v=l.x+z.SPRITE_PADDING;const A=l.y+z.SPRITE_PADDING,w=v+u,m=A+r;this.tessellationProperties._tl=y.i1616to32(v,A);this.tessellationProperties._br=y.i1616to32(w,m)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=
this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;v=D.LineMaterialKey.load(this._materialKey);f&&(v.sdf=f.sdf,v.pattern=!0,v.textureBinding=f.textureBinding);this._materialKey=v.data};return q._createClass(h)}(k(g))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c){const d=D.create(),p=y.create();return function(v){function l(r,A,w){var m=u.call(this,r);m._cimMarkerLayer=r;m._minMaxZoom=b.i1616to32(Math.round(A*g.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(w*g.MIN_MAX_ZOOM_PRECISION_FACTOR));const t=r.color;h.isFunction(t)?m._dynamicPropertyMap.set("_fillColor",(I,H,N)=>k.premultiplyAlphaRGBA(t(I,H,N))):m._fillColor=k.premultiplyAlphaRGBA(t);const B=r.outlineColor;h.isFunction(B)?m._dynamicPropertyMap.set("_outlineColor",
(I,H,N)=>k.premultiplyAlphaRGBA(B(I,H,N))):m._outlineColor=k.premultiplyAlphaRGBA(B);const J=r.size;h.isFunction(J)?m._dynamicPropertyMap.set("_size",(I,H,N)=>z.pt2px(J(I,H,N))):m._size=z.pt2px(J)||0;A=r.scaleX;h.isFunction(A)?m._dynamicPropertyMap.set("_scaleX",A):m._scaleX=A;const C=r.offsetX;h.isFunction(C)?m._dynamicPropertyMap.set("xOffset",(I,H,N)=>z.pt2px(C(I,H,N))):m.xOffset=z.pt2px(C)||0;const K=r.offsetY;h.isFunction(K)?m._dynamicPropertyMap.set("yOffset",(I,H,N)=>z.pt2px(K(I,H,N))):m.yOffset=
z.pt2px(K)||0;const E=r.outlineWidth;h.isFunction(E)?m._dynamicPropertyMap.set("_outlineWidth",(I,H,N)=>z.pt2px(E(I,H,N))):m._outlineWidth=z.pt2px(E)||0;A=r.rotation;h.isFunction(A)?m._dynamicPropertyMap.set("_angle",A):m._angle=A||0;F.isSome(r.effects)&&(A=r.effects,h.isFunction(A)?m._dynamicPropertyMap.set("_effects",A):m._effects=A);F.isSome(r.markerPlacement)&&(A=r.markerPlacement,h.isFunction(A)?m._dynamicPropertyMap.set("_markerPlacement",A):m._markerPlacement=A);m._scaleFactor=F.unwrapOr(r.scaleFactor,
1);m._bitSet=(r.alignment===x.Alignment.MAP?g.BITSET_MARKER_ALIGNMENT_MAP:g.BITSET_MARKER_ALIGNMENT_SCREEN)|(r.colorLocked?g.BITSET_GENERIC_LOCK_COLOR:0)|(r.scaleSymbolsProportionally?g.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);m._materialKey=r.materialKey;return m}q._inherits(l,v);var u=q._createSuper(l);l.fromCIMMarker=function(r,A){const [w,m]=h.getMinMaxZoom(r.scaleInfo,A);return new l(r,w,m)};l.prototype.bindFeature=function(r,A,w){const m=r.readLegacyFeature();r=r.getObjectId();this._dynamicPropertyMap.forEach((ka,
V)=>{this[V]=ka(m,A,w)});var t=this._cimMarkerLayer.materialHash;r="function"===typeof t?t(m,A,w,r):t;if((r=this._materialCache.get(r))&&c.ok(r.spriteMosaicItem)&&r.spriteMosaicItem){r=r.spriteMosaicItem;t=this._cimMarkerLayer.sizeRatio;var B=r.width/r.height*this._scaleX,J=a.MarkerMaterialKey.load(this._materialKey);J.sdf=r.sdf;J.pattern=!0;J.textureBinding=r.textureBinding;this._materialKey=J.data;var C=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,K=this._size,E=K*B,I=this.xOffset,
H=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var N=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/z.pt2px(this._cimMarkerLayer.frameHeight):1;N*=this._outlineWidth;var U=z.pt2px(this._cimMarkerLayer.referenceSize),ba=0,la=0,aa=this._cimMarkerLayer.anchorPoint;aa&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(ba=z.pt2px(aa.x)/(this._size*B),la=z.pt2px(aa.y)/this._size):(ba=aa.x,la=aa.y));this._anchorX=ba;this._anchorY=
la;this._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*E),255)),Math.round(Math.min(Math.sqrt(128*K),255)),Math.round(Math.min(Math.sqrt(128*N),255)),Math.round(Math.min(Math.sqrt(128*U),255)));this.angle=C;this._bitestAndDistRatio=b.i1616to32(this._bitSet,Math.round(64*t));this._computeSize(E,K,t,N,this._scaleFactor,r,J.hasSizeVV(),!0);this._applyTransformation(p,d);this.xOffset=I;this.yOffset=H}else G.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate").error(new n("mapview-cim",
"Encountered an error when binding feature"))};return q._createClass(l)}(e(f))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h){return function(e){function f(d,p,v){var l=c.call(this,d);l._horizontalAlignment="center";l._verticalAlignment="middle";l._textToGlyphs=new Map;l._minMaxZoom=x.i1616to32(Math.round(p*D.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(v*D.MIN_MAX_ZOOM_PRECISION_FACTOR));p=d.scaleFactor||1;l._cimTextLayer=d;const u=d.color;g.isFunction(u)?l._dynamicPropertyMap.set("_color",(t,B,J)=>y.premultiplyAlphaRGBA(u(t,B,J))):l._color=y.premultiplyAlphaRGBA(u);const r=d.outlineColor;
g.isFunction(r)?l._dynamicPropertyMap.set("_haloColor",(t,B,J)=>y.premultiplyAlphaRGBA(r(t,B,J))):l._haloColor=y.premultiplyAlphaRGBA(r);let A;g.isFunction(d.size)||(A=Math.min(Math.round(G.pt2px(d.size*d.sizeRatio)),127));l._dynamicPropertyMap.set("_size",(t,B,J)=>g.isFunction(d.size)?Math.min(Math.round(G.pt2px(d.size(t,B,J)*d.sizeRatio)),127):A);g.isFunction(d.outlineSize)?l._dynamicPropertyMap.set("_haloSize",(t,B,J)=>Math.min(Math.floor(5*G.pt2px(d.outlineSize(t,B,J)*d.sizeRatio)),127)):l._haloSize=
Math.min(Math.floor(5*G.pt2px(d.outlineSize*d.sizeRatio)),127);let w;g.isFunction(d.offsetX)||(w=Math.round(G.pt2px(d.offsetX*d.sizeRatio)));l._dynamicPropertyMap.set("_xOffset",(t,B,J)=>g.isFunction(d.offsetX)?Math.round(G.pt2px(d.offsetX(t,B,J)*d.sizeRatio)):w);let m;g.isFunction(d.offsetY)||(m=Math.round(G.pt2px(d.offsetY*d.sizeRatio)));l._dynamicPropertyMap.set("_yOffset",(t,B,J)=>g.isFunction(d.offsetY)?Math.round(G.pt2px(d.offsetY(t,B,J)*d.sizeRatio)):m);g.isFunction(d.angle)?l._dynamicPropertyMap.set("_angle",
d.angle):l._angle=d.angle;g.isFunction(d.horizontalAlignment)?l._dynamicPropertyMap.set("_horizontalAlignment",d.horizontalAlignment):l._horizontalAlignment=d.horizontalAlignment;g.isFunction(d.verticalAlignment)?l._dynamicPropertyMap.set("_verticalAlignment",d.verticalAlignment):l._verticalAlignment=d.verticalAlignment;n.isSome(d.effects)&&(v=d.effects,g.isFunction(v)?l._dynamicPropertyMap.set("_effects",v):l._effects=v);n.isSome(d.markerPlacement)&&(v=d.markerPlacement,g.isFunction(v)?l._dynamicPropertyMap.set("_markerPlacement",
v):l._textPlacement=v);g.isFunction(d.text)?l._dynamicPropertyMap.set("_text",d.text):l._text=d.text;l._backgroundColor=d.backgroundColor&&y.premultiplyAlphaRGBA(d.backgroundColor);l._borderLineColor=d.borderLineColor&&y.premultiplyAlphaRGBA(d.borderLineColor);l._borderLineSize=d.borderLineWidth;l._scaleFactor=p;p=Math.min(Math.round(G.pt2px(d.referenceSize*d.sizeRatio)),127);l._referenceSize=Math.round(Math.sqrt(256*p));l._materialKey=d.materialKey;p=k.TextMaterialKey.load(l._materialKey);p.sdf=
!0;l._bitset=(d.alignment===F.Alignment.MAP?1:0)|(d.colorLocked?1:0)<<1;l._materialKey=p.data;l._decoration="none";l._lineHeight=1;l._lineWidth=512;l._isCIM=!0;return l}q._inherits(f,e);var c=q._createSuper(f);f.fromCIMText=function(d,p){const [v,l]=g.getMinMaxZoom(d.scaleInfo,p);return new f(d,v,l)};e=f.prototype;e.analyze=async function(d,p,v,l){var u=p.readLegacyFeature();var r=this._cimTextLayer;u="string"===typeof r.text?r.text:"function"===typeof r.text?r.text(u,v,l)??"":"";(d=await q._get(q._getPrototypeOf(f.prototype),
"analyze",this).call(this,d,p,v,l,h.codepoints(u)))&&d.glyphMosaicItems&&this._textToGlyphs.set(u,d.glyphMosaicItems);return d};e.bindFeature=function(d,p,v){const l=d.readLegacyFeature();this._dynamicPropertyMap.forEach((u,r)=>{this[r]=u(l,p,v)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/D.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=z.getXAnchorDirection(n.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=
z.getYAnchorDirection(n.unwrapOr(this._verticalAlignment,"baseline")),d=this._textToGlyphs.get(this._text)??[],this.bindTextInfo(d,!1)):this._shapingInfo=null};return q._createClass(f)}(b(a))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(q){q.codepoints=function(n){if(null==n)return[];const G=Array(n.length);for(let F=0;F<n.length;F++)G[F]=n.charCodeAt(F);return G};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(q,n,G,F,z,y,D,x,k,g){return function(b){function a(e,f,c,d,p,v,l,u,r,A,w,m,t,B,J,C){var K=h.call(this);K._effects=B;e=D.FillMaterialKey.load(e);f&&(e.sdf=f.sdf,e.pattern=!0,e.textureBinding=f.textureBinding);K.fillColor=c;K.tl=d;K.br=p;K.aux21=y.i1616to32(v,l);K.aux22=y.i1616to32(u,r);K.aux3=y.i8888to32(A,w,m,0);K._bitset=t;K._minMaxZoom=y.i1616to32(Math.round(J*F.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(C*F.MIN_MAX_ZOOM_PRECISION_FACTOR));K._materialKey=e.data;return K}q._inherits(a,b);
var h=q._createSuper(a);a.fromCIMFill=function(e,f,c){var d=e.color;d=d&&G.premultiplyAlphaRGBA(d)||0;const p=e.materialKey,[v,l]=x.getMinMaxZoom(e.scaleInfo,c);c=(e.colorLocked?F.BITSET_GENERIC_LOCK_COLOR:0)|(e.applyRandomOffset?F.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(e.sampleAlphaOnly?F.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0)|(e.hasUnresolvedReplacementColor?F.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR:0);if(!f)return new a(p,null,d,0,0,0,0,0,0,0,0,0,c,e.effects,v,l);const {rect:u,width:r,height:A}=
f;var w=e.scaleX||1,m=u.x+F.SPRITE_PADDING;const t=u.y+F.SPRITE_PADDING;var B=m+r;const J=t+A;var C=n.pt2px(e.height);w*=C;"CIMHatchFill"===e.cim.type&&(w*=r/A);C=Math.round(C);0>=C&&(C=J-t);w=Math.round(w);0>=w&&(w=B-m);const K=n.pt2px(e.offsetX||0),E=n.pt2px(-e.offsetY||0);m=y.i1616to32(m,t);B=y.i1616to32(B,J);return new a(p,f,d,m,B,w,C,K,E,128,128,z.degToByte(e.angle),c,e.effects,v,l)};a.fromSimpleFill=function(e,f,c=!1){var {color:d}=e;d=d&&"esriSFSNull"!==e.style&&G.premultiplyAlphaRGBAArray(d)||
0;c=c?F.BITSET_GENERIC_LOCK_COLOR:0;const p=e.materialKey;if(f){const {rect:u,width:r,height:A,pixelRatio:w}=f;var v=u.x+F.SPRITE_PADDING;const m=u.y+F.SPRITE_PADDING;var l=v+r;const t=m+A;v=y.i1616to32(v,m);l=y.i1616to32(l,t);f=new a(p,f,d,v,l,r/w,A/w,0,0,128,128,0,c,null,x.DEFAULT_MIN_ZOOM,x.DEFAULT_MAX_ZOOM)}else f=new a(p,null,d,0,0,0,0,0,0,0,0,0,c,null,x.DEFAULT_MIN_ZOOM,x.DEFAULT_MAX_ZOOM);f._maybeAddLineTemplate(e);return f};a.fromPictureFill=function(e,f,c=!1){const d=F.PICTURE_FILL_COLOR,
{rect:p,width:v,height:l}=f;var u=p.x+F.SPRITE_PADDING,r=p.y+F.SPRITE_PADDING,A=u+v,w=r+l;u=y.i1616to32(u,r);A=y.i1616to32(A,w);w=Math.round(n.pt2px(e.width));r=Math.round(n.pt2px(e.height));const m=n.pt2px(e.xoffset),t=n.pt2px(-e.yoffset);f=new a(e.materialKey,f,d,u,A,w,r,m,t,128*e.xscale,128*e.yscale,0,c?F.BITSET_GENERIC_LOCK_COLOR:0,null,x.DEFAULT_MIN_ZOOM,x.DEFAULT_MAX_ZOOM);f._maybeAddLineTemplate(e);return f};return q._createClass(a)}(k(g))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(q,n,G){let F=function(){function z(){this._resolver=null}var y=z.prototype;y.isHeld=function(){return!!this._resolver};y.acquire=async function(){this._resolver?(await this._resolver.promise,await this.acquire()):this._resolver=G.createResolver()};y.release=function(){const D=this._resolver;this._resolver=null;D?.resolve()};return n._createClass(z)}();q.Lock=F;q.withLock=async function(z,y,D){try{await z.acquire(),
await y(D),z.release()}catch(x){throw z.release(),x;}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(q,n,G,F){const z=async(y,D,x)=>new G.ExpandedCIM(await n.analyzeCIMSymbol(y.data,D,x),y.data,y.rendererKey,y.maxVVSize);q.cimLayerToRasterizationInfo=function(y){if(!y)return null;const {avoidSDFRasterization:D,
type:x,cim:k,url:g,materialHash:b}=y,a={cim:k,type:x,mosaicHash:b,url:g,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:D};switch(x){case "marker":a.size=y.size;a.path=y.path;a.animatedSymbolProperties=y.animatedSymbolProperties;break;case "line":a.dashTemplate=y.dashTemplate;break;case "text":a.text=y.text,a.fontName=y.fontName}return a};q.expandSymbol=async function(y,D,x,k){return y?"cim"===y.type?z(y,D,x):"web-style"===y.type?(y=
{type:"cim",data:await F.fetchCIMSymbolReference(y,null,k)??void 0,rendererKey:y.rendererKey,maxVVSize:y.maxVVSize},z(y,D,x)):y:null};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(q,n,G,F){const z={marker:G.WGLGeometryType.MARKER,fill:G.WGLGeometryType.FILL,line:G.WGLGeometryType.LINE,
text:G.WGLGeometryType.TEXT};let y=function(){function D(x,k,g,b){const a={minScale:k?.minScale,maxScale:k?.maxScale};var h=a.minScale||a.maxScale?a.minScale+"-"+a.maxScale:"";this.layers=x;this.data=k;this.hash=this._createHash()+h;this.rendererKey=g;k={isOutline:!1,placement:null,symbologyType:G.WGLSymbologyType.DEFAULT,vvFlags:g};for(const e of x)x=z[e.type],k.isOutline="line"===e.type&&e.isOutline,e.materialKey=F.createMaterialKey(x,k),e.maxVVSize=b,e.scaleInfo=a,e.templateHash+=h}D.prototype._createHash=
function(){let x="";for(const k of this.layers)x+=k.templateHash;return x};n._createClass(D,[{key:"type",get:function(){return"expanded-cim"}}]);return D}();q.ExpandedCIM=y;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(q,n,G,F,z,y,D,x,k){async function g(a,h){a=k.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,a.name);try{const e=await k.requestJSON(a,h);return k.makeCIMSymbolRef(e.data)}catch(e){return z.throwIfAborted(e),null}}async function b(a,h,e,f){var c=a.data;a={portal:e&&F.isSome(e.portal)?e.portal:D.getDefault(),url:y.urlToObject(a.baseUrl),origin:"portal-item"};c=c.items.find(d=>d.name===h);if(!c)throw new G("symbolstyleutils:symbol-name-not-found",`The symbol name '${h}' could not be found`,{symbolName:h});
c=x.fromJSON(k.symbolUrlFromStyleItem(c,"cimRef"),a);n.isDevEnvironment()&&(c=n.adjustStaticAGOUrl(c));try{const d=await k.requestJSON(c,f);return k.makeCIMSymbolRef(d.data)}catch(d){return z.throwIfAborted(d),null}}q.fetchCIMSymbolReference=async function(a,h,e){if(!a.name)throw new G("style-symbol-reference-name-missing","Missing name in style symbol reference");if(a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName)return g(a,e);try{const f=await k.fetchStyle(a,h,e);return b(f,a.name,h,e)}catch(f){return z.throwIfAborted(f),
null}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(q){const n=/^devext.arcgis.com$/,G=/^qaext.arcgis.com$/,F=/^[\w-]*\.mapsdevext.arcgis.com$/,z=/^[\w-]*\.mapsqa.arcgis.com$/,y=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,n,G,/^jsapps.esri.com$/,F,z];q.adjustStaticAGOUrl=function(D,x){return D?(x=x||globalThis.location.hostname)?null!=x.match(n)||null!=x.match(F)?D.replace("static.arcgis.com","staticdev.arcgis.com"):
null!=x.match(G)||null!=x.match(z)?D.replace("static.arcgis.com","staticqa.arcgis.com"):D:D:D};q.isDevEnvironment=function(D){D=D||globalThis.location.hostname;return y.some(x=>null!=D?.match(x))};q.isTelemetryDevEnvironment=function(D){D=D||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(y).some(x=>null!=D?.match(x))};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a,h,e,f,c,d,p,v,l,u,r,A){const w=J=>Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));var m;let t;const B={PortalGroup:()=>new Promise((J,C)=>q(["./PortalGroup"],K=>J(w(K)),C)),PortalItem:()=>new Promise((J,C)=>q(["./PortalItem"],K=>J(w(K)),C)),PortalUser:()=>new Promise((J,C)=>q(["./PortalUser"],K=>J(w(K)),C))};x=m=function(J){function C(E){E=K.call(this,E);E._esriIdCredentialCreateHandle=null;E.access=null;E.allSSL=
!1;E.authMode="auto";E.authorizedCrossOriginDomains=null;E.basemapGalleryGroupQuery=null;E.bingKey=null;E.canListApps=!1;E.canListData=!1;E.canListPreProvisionedItems=!1;E.canProvisionDirectPurchase=!1;E.canSearchPublic=!0;E.canShareBingPublic=!1;E.canSharePublic=!1;E.canSignInArcGIS=!1;E.canSignInIDP=!1;E.colorSetsGroupQuery=null;E.commentsEnabled=!1;E.created=null;E.culture=null;E.customBaseUrl=null;E.defaultBasemap=null;E.defaultDevBasemap=null;E.defaultExtent=null;E.defaultVectorBasemap=null;
E.description=null;E.devBasemapGalleryGroupQuery=null;E.eueiEnabled=null;E.featuredGroups=null;E.featuredItemsGroupQuery=null;E.galleryTemplatesGroupQuery=null;E.livingAtlasGroupQuery=null;E.hasCategorySchema=!1;E.helperServices=null;E.homePageFeaturedContent=null;E.homePageFeaturedContentCount=null;E.httpPort=null;E.httpsPort=null;E.id=null;E.ipCntryCode=null;E.isPortal=!1;E.isReadOnly=!1;E.layerTemplatesGroupQuery=null;E.maxTokenExpirationMinutes=null;E.modified=null;E.name=null;E.portalHostname=
null;E.portalMode=null;E.portalProperties=null;E.region=null;E.rotatorPanels=null;E.showHomePageDescription=!1;E.sourceJSON=null;E.supportsHostedServices=!1;E.symbolSetsGroupQuery=null;E.templatesGroupQuery=null;E.units=null;E.url=F.portalUrl;E.urlKey=null;E.user=null;E.useStandardizedQuery=!1;E.useVectorBasemaps=!1;E.vectorBasemapGalleryGroupQuery=null;return E}n._inherits(C,J);var K=n._createSuper(C);J=C.prototype;J.normalizeCtorArgs=function(E){return"string"===typeof E?{url:E}:E};J.destroy=function(){this.defaultBasemap=
g.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=g.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=g.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=g.removeMaybe(this._esriIdCredentialCreateHandle)};J.readAuthorizedCrossOriginDomains=function(E){if(E)for(const I of E)F.request.trustedServers.includes(I)||F.request.trustedServers.push(I);return E};J.readDefaultBasemap=function(E){return this._readBasemap(E)};J.readDefaultDevBasemap=function(E){return this._readBasemap(E)};
J.readDefaultVectorBasemap=function(E){return this._readBasemap(E)};J.readUrlKey=function(E){return E?E.toLowerCase():E};J.readUser=function(E){let I=null;E&&(I=r.fromJSON(E),I.portal=this);return I};J.load=function(E){const I=(new Promise((H,N)=>q(["../Basemap"],U=>H(w(U)),N))).then(({default:H})=>{b.throwIfAborted(E);t=H}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,E)).then(H=>{if(z.id){const N=z.id;this.credential=N.findCredential(this.restUrl);this.credential||this.authMode!==
m.AUTH_MODE_AUTO||(this._esriIdCredentialCreateHandle=N.on("credential-create",()=>{N.findCredential(this.restUrl)&&this.signIn().catch(()=>{})}))}this.sourceJSON=H;this.read(H)});this.addResolvingPromise(I);return Promise.resolve(this)};J.createElevationLayers=async function(){await this.load();const E=this._getHelperService("defaultElevationLayers"),I=(await new Promise((H,N)=>q(["../layers/ElevationLayer"],U=>H(w(U)),N))).default;return E?E.map(H=>new I({id:H.id,url:H.url})):[]};J.fetchBasemaps=
function(E,I){const H=new l;H.query=E||(F.apiKey&&A.supportsApiKey(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);H.disableExtraQuery=!0;return this.queryGroups(H,I).then(N=>{H.num=100;H.query='type:"Web Map" -type:"Web Application"';return N.total?(N=N.results[0],H.sortField=N.sortField||"name",H.sortOrder=N.sortOrder||"desc",N.queryItems(H,I)):null}).then(N=>N&&N.total?N.results.filter(U=>"Web Map"===U.type).map(U=>
new t({portalItem:U})):[])};J.fetchCategorySchema=function(E){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",E).then(I=>I.categorySchema):b.isAborted(E)?Promise.reject(b.createAbortError()):Promise.resolve([])};J.fetchFeaturedGroups=function(E){const I=this.featuredGroups,H=new l;H.num=100;H.sortField="title";if(I&&I.length){const N=[];for(const U of I)N.push(`(title:"${U.title}" AND owner:${U.owner})`);H.query=N.join(" OR ");return this.queryGroups(H,E).then(U=>
U.results)}return b.isAborted(E)?Promise.reject(b.createAbortError()):Promise.resolve([])};J.fetchRegions=function(E){const I=this.user?.culture||this.culture||v.getLocale();return this.request(this.restUrl+"/portals/regions",{...E,query:{culture:I}})};J.fetchSettings=function(E){const I=this.user?.culture||this.culture||v.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...E,query:{culture:I}})};C.getDefault=function(){if(!m._default||m._default.destroyed)m._default=new m;return m._default};
J.queryGroups=function(E,I){return this.queryPortal("/community/groups",E,"PortalGroup",I)};J.queryItems=function(E,I){return this.queryPortal("/search",E,"PortalItem",I)};J.queryUsers=function(E,I){E.sortField||(E.sortField="username");return this.queryPortal("/community/users",E,"PortalUser",I)};J.fetchSelf=function(E=this.authMode,I=!1,H){const N=this.restUrl+"/portals/self";E={authMode:E,query:{culture:v.getLocale().toLowerCase()},...H};"auto"===E.authMode&&(E.authMode="no-prompt");I&&(E.query.default=
!0);return this.request(N,E)};J.queryPortal=function(E,I,H,N){const U=h.ensureType(l,I),ba=la=>this.request(this.restUrl+E,{...U.toRequestOptions(this),...N}).then(aa=>{const ka=U.clone();ka.start=aa.nextStart;return new u({nextQueryParams:ka,queryParams:U,total:aa.total,results:m._resultsToTypedArray(la,{portal:this},aa,N)})}).then(aa=>Promise.all(aa.results.map(ka=>"function"===typeof ka.when?ka.when():aa)).then(()=>aa,ka=>{b.throwIfAbortError(ka);return aa}));return H&&B[H]?B[H]().then(({default:la})=>
{b.throwIfAborted(N);return ba(la)}):ba()};J.signIn=function(){if(this.authMode===m.AUTH_MODE_ANONYMOUS)return Promise.reject(new D("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const E=I=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return I||(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;
this.credential=I;return this.fetchSelf("immediate")});if(this.user&&this.credential===I)return null;this.credential=I;return this.fetchSelf("immediate")}).then(H=>{H&&(this.sourceJSON=H,this.read(H))});return z.id?z.id.getCredential(this.restUrl).then(I=>E(I)):E(this.credential)};J.normalizeUrl=function(E){const I=this.credential&&this.credential.token;return this._normalizeSSL(I?E+(E.includes("?")?"\x26":"?")+"token\x3d"+I:E)};J.requestToTypedArray=function(E,I,H){return this.request(E,I).then(N=>
{const U=m._resultsToTypedArray(H,{portal:this},N);return Promise.all(U.map(ba=>"function"===typeof ba.when?ba.when():N)).then(()=>U,()=>U)})};J.request=function(E,I={}){const H={f:"json",...I.query},{authMode:N=this.authMode===m.AUTH_MODE_ANONYMOUS?"anonymous":"auto",body:U=null,cacheBust:ba=!1,method:la="auto",responseType:aa="json",signal:ka}=I;I={authMode:N,body:U,cacheBust:ba,method:la,query:H,responseType:aa,timeout:0,signal:ka};return y(this._normalizeSSL(E),I).then(V=>V.data)};J.toJSON=function(){throw new D("internal:not-yet-implemented",
"Portal.toJSON is not yet implemented");};C.fromJSON=function(E){if(!E)return null;if(E.declaredClass)throw Error("JSON object is already hydrated");return new m({sourceJSON:E})};J._getHelperService=function(E){const I=this.helperServices&&this.helperServices[E];if(!I)throw new D("portal:service-not-found",`The \`helperServices\` do not include an entry named "${E}"`);return I};J._normalizeSSL=function(E){return E.replace(/^http:/i,"https:").replace(":7080",":7443")};J._readBasemap=function(E){return E?
(E=t.fromJSON(E),E.portalItem={portal:this},E):null};C._resultsToTypedArray=function(E,I,H,N){let U=[];if(H){const ba=g.isSome(N)?N.signal:null;U=H.listings||H.notifications||H.userInvitations||H.tags||H.items||H.groups||H.comments||H.provisions||H.results||H.relatedItems||H;if(E||I)U=U.map(la=>{la=Object.assign(E?E.fromJSON(la):la,I);"function"===typeof la.load&&la.load(ba);return la})}else U=[];return U};n._createClass(C,[{key:"extraQuery",get:function(){const E=!(this.user&&this.user.orgId)||this.canSearchPublic;
return this.id&&!E?` AND orgid:${this.id}`:null}},{key:"isOrganization",get:function(){return!!this.access}},{key:"itemPageUrl",get:function(){return this.url?`${this.url}/home/item.html`:null}},{key:"restUrl",get:function(){let E=this.url;if(E){const I=E.indexOf("/sharing");E=0<I?E.substring(0,I):this.url.replace(/\/+$/,"");E+="/sharing/rest"}return E}},{key:"thumbnailUrl",get:function(){const E=this.restUrl,I=this.thumbnail;return E&&I?this._normalizeSSL(E+"/portals/self/resources/"+I):null}}]);
return C}(x.JSONSupportMixin(k));x.AUTH_MODE_ANONYMOUS="anonymous";x.AUTH_MODE_AUTO="auto";x.AUTH_MODE_IMMEDIATE="immediate";G.__decorate([a.property()],x.prototype,"access",void 0);G.__decorate([a.property()],x.prototype,"allSSL",void 0);G.__decorate([a.property()],x.prototype,"authMode",void 0);G.__decorate([a.property()],x.prototype,"authorizedCrossOriginDomains",void 0);G.__decorate([c.reader("authorizedCrossOriginDomains")],x.prototype,"readAuthorizedCrossOriginDomains",null);G.__decorate([a.property()],
x.prototype,"basemapGalleryGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"bingKey",void 0);G.__decorate([a.property()],x.prototype,"canListApps",void 0);G.__decorate([a.property()],x.prototype,"canListData",void 0);G.__decorate([a.property()],x.prototype,"canListPreProvisionedItems",void 0);G.__decorate([a.property()],x.prototype,"canProvisionDirectPurchase",void 0);G.__decorate([a.property()],x.prototype,"canSearchPublic",void 0);G.__decorate([a.property()],x.prototype,"canShareBingPublic",
void 0);G.__decorate([a.property()],x.prototype,"canSharePublic",void 0);G.__decorate([a.property()],x.prototype,"canSignInArcGIS",void 0);G.__decorate([a.property()],x.prototype,"canSignInIDP",void 0);G.__decorate([a.property()],x.prototype,"colorSetsGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"commentsEnabled",void 0);G.__decorate([a.property({type:Date})],x.prototype,"created",void 0);G.__decorate([a.property()],x.prototype,"credential",void 0);G.__decorate([a.property()],x.prototype,
"culture",void 0);G.__decorate([a.property()],x.prototype,"currentVersion",void 0);G.__decorate([a.property()],x.prototype,"customBaseUrl",void 0);G.__decorate([a.property()],x.prototype,"defaultBasemap",void 0);G.__decorate([c.reader("defaultBasemap")],x.prototype,"readDefaultBasemap",null);G.__decorate([a.property()],x.prototype,"defaultDevBasemap",void 0);G.__decorate([c.reader("defaultDevBasemap")],x.prototype,"readDefaultDevBasemap",null);G.__decorate([a.property({type:p})],x.prototype,"defaultExtent",
void 0);G.__decorate([a.property()],x.prototype,"defaultVectorBasemap",void 0);G.__decorate([c.reader("defaultVectorBasemap")],x.prototype,"readDefaultVectorBasemap",null);G.__decorate([a.property()],x.prototype,"description",void 0);G.__decorate([a.property()],x.prototype,"devBasemapGalleryGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"eueiEnabled",void 0);G.__decorate([a.property({readOnly:!0})],x.prototype,"extraQuery",null);G.__decorate([a.property()],x.prototype,"featuredGroups",
void 0);G.__decorate([a.property()],x.prototype,"featuredItemsGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"galleryTemplatesGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"livingAtlasGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"hasCategorySchema",void 0);G.__decorate([a.property()],x.prototype,"helpBase",void 0);G.__decorate([a.property()],x.prototype,"helperServices",void 0);G.__decorate([a.property()],x.prototype,"helpMap",void 0);G.__decorate([a.property()],
x.prototype,"homePageFeaturedContent",void 0);G.__decorate([a.property()],x.prototype,"homePageFeaturedContentCount",void 0);G.__decorate([a.property()],x.prototype,"httpPort",void 0);G.__decorate([a.property()],x.prototype,"httpsPort",void 0);G.__decorate([a.property()],x.prototype,"id",void 0);G.__decorate([a.property()],x.prototype,"ipCntryCode",void 0);G.__decorate([a.property({readOnly:!0})],x.prototype,"isOrganization",null);G.__decorate([a.property()],x.prototype,"isPortal",void 0);G.__decorate([a.property()],
x.prototype,"isReadOnly",void 0);G.__decorate([a.property({readOnly:!0})],x.prototype,"itemPageUrl",null);G.__decorate([a.property()],x.prototype,"layerTemplatesGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"maxTokenExpirationMinutes",void 0);G.__decorate([a.property({type:Date})],x.prototype,"modified",void 0);G.__decorate([a.property()],x.prototype,"name",void 0);G.__decorate([a.property()],x.prototype,"portalHostname",void 0);G.__decorate([a.property()],x.prototype,"portalMode",void 0);
G.__decorate([a.property()],x.prototype,"portalProperties",void 0);G.__decorate([a.property()],x.prototype,"region",void 0);G.__decorate([a.property({readOnly:!0})],x.prototype,"restUrl",null);G.__decorate([a.property()],x.prototype,"rotatorPanels",void 0);G.__decorate([a.property()],x.prototype,"showHomePageDescription",void 0);G.__decorate([a.property()],x.prototype,"sourceJSON",void 0);G.__decorate([a.property()],x.prototype,"staticImagesUrl",void 0);G.__decorate([a.property({json:{name:"2DStylesGroupQuery"}})],
x.prototype,"stylesGroupQuery2d",void 0);G.__decorate([a.property({json:{name:"stylesGroupQuery"}})],x.prototype,"stylesGroupQuery3d",void 0);G.__decorate([a.property()],x.prototype,"supportsHostedServices",void 0);G.__decorate([a.property()],x.prototype,"symbolSetsGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"templatesGroupQuery",void 0);G.__decorate([a.property()],x.prototype,"thumbnail",void 0);G.__decorate([a.property({readOnly:!0})],x.prototype,"thumbnailUrl",null);G.__decorate([a.property()],
x.prototype,"units",void 0);G.__decorate([a.property()],x.prototype,"url",void 0);G.__decorate([a.property()],x.prototype,"urlKey",void 0);G.__decorate([c.reader("urlKey")],x.prototype,"readUrlKey",null);G.__decorate([a.property()],x.prototype,"user",void 0);G.__decorate([c.reader("user")],x.prototype,"readUser",null);G.__decorate([a.property()],x.prototype,"useStandardizedQuery",void 0);G.__decorate([a.property()],x.prototype,"useVectorBasemaps",void 0);G.__decorate([a.property()],x.prototype,"vectorBasemapGalleryGroupQuery",
void 0);return x=m=G.__decorate([d.subclass("esri.portal.Portal")],x)})},"esri/core/Loadable":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Error ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(q,n,G,F,z,y,D,x){const k=g=>{g=function(b){function a(...e){var f=h.call(this,...e);f._loadController=null;f.loadError=null;f.loadStatus="not-loaded";f._set("loadWarnings",[]);f.addResolvingPromise(new Promise(c=>
{const d=f.load.bind(q._assertThisInitialized(f));f.load=p=>{const v=new Promise((l,u)=>{const r=z.onAbortOrThrow(p,u);f.destroyed&&u(new G("load:instance-destroyed",`Instance of '${f.declaredClass||f.constructor.name}' is already destroyed`,{instance:q._assertThisInitialized(f)}));f._promiseProps.when(l,u).finally(()=>{r&&r.remove()})});if("not-loaded"===f.loadStatus){f._set("loadStatus","loading");const l=f._loadController=new AbortController;d({signal:l.signal});z.onAbort(l.signal,()=>{f._promiseProps.abort()})}c();
return v}}));f.when(()=>{f._set("loadStatus","loaded");f._loadController=null},c=>{f._set("loadStatus","failed");f._set("loadError",c);f._loadController=null});return f}q._inherits(a,b);var h=q._createSuper(a);b=a.prototype;b.destroy=function(){this._loadController=null;this._set("loadError",null);this._set("loadWarnings",[])};b.load=function(){return null};b.cancelLoad=function(){if(this.isFulfilled())return this;this._set("loadError",new G("load:cancelled","Cancelled"));this._loadController?.abort();
return this};q._createClass(a,[{key:"loaded",get:function(){return"loaded"===this.loadStatus}},{key:"loadWarnings",get:function(){return this._get("loadWarnings")}}]);return a}(g);n.__decorate([D.property({readOnly:!0})],g.prototype,"loaded",null);n.__decorate([D.property({readOnly:!0})],g.prototype,"loadError",void 0);n.__decorate([D.property({clonable:!1})],g.prototype,"loadStatus",void 0);n.__decorate([D.property({type:[y],readOnly:!0})],g.prototype,"loadWarnings",null);return g=n.__decorate([x.subclass("esri.core.Loadable")],
g)};F=function(g){function b(){return a.apply(this,arguments)}q._inherits(b,g);var a=q._createSuper(b);return q._createClass(b)}(k(F.EsriPromise));F=n.__decorate([x.subclass("esri.core.Loadable")],F);(function(g){g.LoadableMixin=k;g.isLoadable=function(b){return!(!b||!b.load)}})(F||(F={}));return F})},"esri/core/Promise":function(){define("exports ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ./Accessor ./maybe ./promiseUtils ./accessorSupport/decorators/subclass".split(" "),function(q,
n,G,F,z,y,D){var x;(function(b){b[b.PENDING=0]="PENDING";b[b.RESOLVED=1]="RESOLVED";b[b.REJECTED=2]="REJECTED"})(x||(x={}));let k=function(){function b(h){this.instance=h;this._resolver=y.createDeferred();this._status=x.PENDING;this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=x.RESOLVED;this._cleanUp()},()=>{this._status=x.REJECTED;this._cleanUp()})}var a=b.prototype;a.addResolvingPromise=function(h){this._resolvingPromises.push(h);this._tryResolve()};a.isResolved=function(){return this._status===
x.RESOLVED};a.isRejected=function(){return this._status===x.REJECTED};a.isFulfilled=function(){return this._status!==x.PENDING};a.abort=function(){this._resolver.reject(y.createAbortError())};a.when=function(h,e){return this._resolver.promise.then(h,e)};a._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};a._tryResolve=function(){if(!this.isFulfilled()){var h=y.createDeferred(),e=[...this._resolvingPromises,z.assumeNonNull(h.promise)],f=this._allPromise=Promise.all(e);
f.then(()=>{this.isFulfilled()||this._allPromise!==f||this._resolver.resolve(this.instance)},c=>{this.isFulfilled()||this._allPromise!==f||y.isAbortError(c)||this._resolver.reject(c)});h.resolve()}};return n._createClass(b)}();const g=b=>{b=function(a){function h(...f){f=e.call(this,...f);f._promiseProps=new k(n._assertThisInitialized(f));f.addResolvingPromise(Promise.resolve());return f}n._inherits(h,a);var e=n._createSuper(h);a=h.prototype;a.isResolved=function(){return this._promiseProps.isResolved()};
a.isRejected=function(){return this._promiseProps.isRejected()};a.isFulfilled=function(){return this._promiseProps.isFulfilled()};a.when=function(f,c){return(new Promise((d,p)=>{this._promiseProps.when(d,p)})).then(f,c)};a.catch=function(f){return this.when(null,f)};a.addResolvingPromise=function(f){f&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in f?f.when():f)};return n._createClass(h)}(b);return b=G.__decorate([D.subclass("esri.core.Promise")],b)};q.EsriPromise=
function(b){function a(){return h.apply(this,arguments)}n._inherits(a,b);var h=n._createSuper(a);return n._createClass(a)}(g(F));q.EsriPromise=G.__decorate([D.subclass("esri.core.Promise")],q.EsriPromise);q.EsriPromiseMixin=g;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/intl/locale":function(){define(["exports"],function(q){function n(){return x??globalThis.navigator?.language??"en"}function G(){void 0===D&&(D=n());return D}function F(a=G()){return/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(a)?.[1].toLowerCase()}
function z(){const a=y??n();D!==a&&(D=a,[...b].forEach(h=>{h.call(null,a)}),[...g].forEach(h=>{h.call(null,a)}))}let y=void 0,D=void 0;const x=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,k={he:!0,ar:!0},g=[],b=[];globalThis.addEventListener?.("languagechange",z);q.beforeLocaleChange=function(a){b.push(a);return{remove(){g.splice(b.indexOf(a),1)}}};q.getDefaultLocale=n;q.getLanguage=F;q.getLocale=G;q.onLocaleChange=function(a){g.push(a);return{remove(){g.splice(g.indexOf(a),1)}}};
q.prefersRTL=function(a=G()){a=F(a);return void 0!==a&&(k[a]||!1)};q.setLocale=function(a){y=a||void 0;z()};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalQueryParams":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){var h;const e=new F.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});G=h=function(f){function c(p){p=d.call(this,p);p.categories=null;p.disableExtraQuery=!1;p.extent=null;p.filter=null;p.num=10;p.query=null;p.sortField=null;p.start=1;return p}q._inherits(c,f);var d=q._createSuper(c);f=c.prototype;f.clone=function(){return new h({categories:this.categories?z.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,
extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};f.toRequestOptions=function(p,v){let l=[];this.categories&&(l=this.categories.map(A=>Array.isArray(A)?JSON.stringify(A):A));let u="";if(this.extent){var r=a.project(this.extent,b.WGS84);y.isSome(r)&&(u=`${r.xmin},${r.ymin},${r.xmax},${r.ymax}`)}r=this.query;!this.disableExtraQuery&&p.extraQuery&&(r="("+r+")"+p.extraQuery);p={categories:l,
bbox:u,q:r,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(p.sortField=this.sortField.split(",").map(A=>e.toJSON(A.trim())).join(","),p.sortOrder=this.sortOrder);return{query:{...v,...p}}};q._createClass(c,[{key:"sortOrder",get:function(){return this._get("sortOrder")||"asc"},set:function(p){"asc"!==p&&"desc"!==p||this._set("sortOrder",p)}}]);return c}(G);n.__decorate([D.property()],G.prototype,"categories",void 0);n.__decorate([D.property()],G.prototype,
"disableExtraQuery",void 0);n.__decorate([D.property({type:g})],G.prototype,"extent",void 0);n.__decorate([D.property()],G.prototype,"filter",void 0);n.__decorate([D.property()],G.prototype,"num",void 0);n.__decorate([D.property()],G.prototype,"query",void 0);n.__decorate([D.property()],G.prototype,"sortField",void 0);n.__decorate([D.property()],G.prototype,"sortOrder",null);n.__decorate([D.property()],G.prototype,"start",void 0);return G=h=n.__decorate([k.subclass("esri.portal.PortalQueryParams")],
G)})},"esri/portal/PortalQueryResult":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),function(q,n,G,F,z,y,D,x){G=function(k){function g(a){a=b.call(this,a);a.nextQueryParams=null;a.queryParams=null;a.results=null;a.total=null;return a}q._inherits(g,k);var b=q._createSuper(g);return q._createClass(g)}(G);
n.__decorate([F.property()],G.prototype,"nextQueryParams",void 0);n.__decorate([F.property()],G.prototype,"queryParams",void 0);n.__decorate([F.property()],G.prototype,"results",void 0);n.__decorate([F.property()],G.prototype,"total",void 0);return G=n.__decorate([x.subclass("esri.portal.PortalQueryResult")],G)})},"esri/portal/PortalUser":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b,a){var h;z=h=function(e){function f(...d){d=c.call(this,...d);d.access=null;d.created=null;d.culture=null;d.description=null;d.email=null;d.fullName=null;d.modified=null;d.orgId=null;d.portal=null;d.preferredView=null;d.privileges=null;d.region=null;d.role=null;d.roleId=null;d.sourceJSON=null;d.units=null;d.username=null;d.userType=null;return d}n._inherits(f,e);var c=n._createSuper(f);e=f.prototype;e.addItem=function(d){const p=d&&d.item;var v=d&&d.data;d=d&&d.folder;
const l={method:"post"};p&&(l.query=p.createPostQuery(),null!=v&&("string"===typeof v?l.query.text=v:"object"===typeof v&&(l.query.text=JSON.stringify(v))));v=this.userContentUrl;d&&(v+="/"+("string"===typeof d?d:d.id));return this.portal.request(v+"/addItem",l).then(u=>{p.id=u.id;p.portal=this.portal;return p.loaded?p.reload():p.load()})};e.deleteItem=function(d){let p=this.userContentUrl;d.ownerFolder&&(p+="/"+d.ownerFolder);return this.portal.request(p+`/items/${d.id}/delete`,{method:"post"}).then(()=>
{d.id=null;d.portal=null})};e.deleteItems=function(d){const p=this.userContentUrl+"/deleteItems";var v=d.map(l=>l.id);return v.length?(v={method:"post",query:{items:v.join(",")}},this.portal.request(p,v).then(()=>{d.forEach(l=>{l.id=null;l.portal=null})})):Promise.resolve(void 0)};e.fetchFolders=function(){return this.portal.request(this.userContentUrl??"",{query:{num:1}}).then(d=>d&&d.folders?d.folders.map(p=>{p=b.fromJSON(p);p.portal=this.portal;return p}):[])};e.fetchGroups=function(){return this.portal.request(this.url??
"").then(d=>d&&d.groups?d.groups.map(p=>{p=a.fromJSON(p);p.portal=this.portal;return p}):[])};e.fetchItems=function(d){const p=d??{};let v=this.userContentUrl??"";p.folder&&(v+="/"+p.folder.id);let l;return(new Promise((u,r)=>q(["./PortalItem"],A=>u(Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}))),r))).then(({default:u})=>{l=u;return this.portal.request(v,{query:{folders:!1,num:p.num||10,start:p.start||1,sortField:p.sortField||"created",sortOrder:p.sortOrder||
"asc"}})}).then(u=>{let r;return u&&u.items?(r=u.items.map(A=>{A=l.fromJSON(A);A.portal=this.portal;return A}),Promise.all(r.map(A=>A.load())).catch(A=>A).then(()=>({items:r,nextStart:u.nextStart,total:u.total}))):{items:[],nextStart:-1,total:0}})};e.fetchTags=function(){return this.portal.request(this.url+"/tags").then(d=>d.tags)};e.getThumbnailUrl=function(d){let p=this.thumbnailUrl;p&&d&&(p+=`&w=${d}`);return p};e.queryFavorites=function(d){return this.favGroupId?(this._favGroup||(this._favGroup=
new a({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(d)):Promise.reject(new F("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};e.toJSON=function(){throw new F("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};f.fromJSON=function(d){if(!d)return null;if(d.declaredClass)throw Error("JSON object is already hydrated");const p=new h;p.sourceJSON=d;p.read(d);return p};n._createClass(f,[{key:"thumbnailUrl",get:function(){const d=
this.url,p=this.thumbnail;return d&&p?this.portal.normalizeUrl(`${d}/info/${p}?f=json`):null}},{key:"userContentUrl",get:function(){const d=this.get("portal.restUrl");return d?`${d}/content/users/${this.username}`:null}},{key:"url",get:function(){const d=this.get("portal.restUrl");return d?`${d}/community/users/${this.username}`:null}}]);return f}(z.JSONSupport);G.__decorate([y.property()],z.prototype,"access",void 0);G.__decorate([y.property({type:Date})],z.prototype,"created",void 0);G.__decorate([y.property()],
z.prototype,"culture",void 0);G.__decorate([y.property()],z.prototype,"description",void 0);G.__decorate([y.property()],z.prototype,"email",void 0);G.__decorate([y.property()],z.prototype,"favGroupId",void 0);G.__decorate([y.property()],z.prototype,"fullName",void 0);G.__decorate([y.property({type:Date})],z.prototype,"modified",void 0);G.__decorate([y.property()],z.prototype,"orgId",void 0);G.__decorate([y.property()],z.prototype,"portal",void 0);G.__decorate([y.property()],z.prototype,"preferredView",
void 0);G.__decorate([y.property()],z.prototype,"privileges",void 0);G.__decorate([y.property()],z.prototype,"region",void 0);G.__decorate([y.property()],z.prototype,"role",void 0);G.__decorate([y.property()],z.prototype,"roleId",void 0);G.__decorate([y.property()],z.prototype,"sourceJSON",void 0);G.__decorate([y.property()],z.prototype,"thumbnail",void 0);G.__decorate([y.property({readOnly:!0})],z.prototype,"thumbnailUrl",null);G.__decorate([y.property()],z.prototype,"units",void 0);G.__decorate([y.property({readOnly:!0})],
z.prototype,"userContentUrl",null);G.__decorate([y.property({readOnly:!0})],z.prototype,"url",null);G.__decorate([y.property()],z.prototype,"username",void 0);G.__decorate([y.property()],z.prototype,"userType",void 0);return z=h=G.__decorate([g.subclass("esri.portal.PortalUser")],z)})},"esri/portal/PortalFolder":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(q,n,G,F,z,y,D,x,k){F=function(g){function b(h){h=a.call(this,h);h.created=null;h.id=null;h.portal=null;h.title=null;h.username=null;return h}q._inherits(b,g);var a=q._createSuper(b);b.prototype.toJSON=function(){throw new G("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};q._createClass(b,[{key:"url",get:function(){const h=this.get("portal.restUrl");return h?`${h}/content/users/${this.username}/${this.id}`:null}}]);return b}(F.JSONSupport);n.__decorate([z.property({type:Date})],
F.prototype,"created",void 0);n.__decorate([z.property()],F.prototype,"id",void 0);n.__decorate([z.property()],F.prototype,"portal",void 0);n.__decorate([z.property()],F.prototype,"title",void 0);n.__decorate([z.property({readOnly:!0})],F.prototype,"url",null);n.__decorate([z.property()],F.prototype,"username",void 0);return F=n.__decorate([k.subclass("esri.portal.PortalFolder")],F)})},"esri/portal/PortalGroup":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(q,n,G,F,z,y,D,x,k,g,b){F=function(a){function h(f){f=e.call(this,f);f.access=null;f.created=null;f.description=null;f.id=null;f.isInvitationOnly=!1;f.modified=null;f.owner=null;f.portal=null;f.snippet=null;f.sortField=null;f.sortOrder=null;f.tags=null;f.title=null;return f}q._inherits(h,a);var e=q._createSuper(h);a=h.prototype;a.fetchCategorySchema=function(f){return z.unwrapOrThrow(this.portal).request(this.url+"/categorySchema",f).then(c=>{c=c.categorySchema||[];return c.some(d=>"contentCategorySetsGroupQuery.LivingAtlas"===
d.source)?this._fetchCategorySchemaSet("LivingAtlas",f):c})};a.fetchMembers=function(f){return z.unwrapOrThrow(this.portal).request(this.url+"/users",f)};a.getThumbnailUrl=function(f){let c=this.thumbnailUrl;c&&f&&(c+=`&w=${f}`);return c};a.toJSON=function(){throw new G("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};a.queryItems=function(f,c){f=D.ensureType(b,f);const d=z.unwrapOrThrow(this.portal);if(5<parseFloat(d.currentVersion))return f=f||new b,d.queryPortal(`/content/groups/${this.id}/search`,
f,"PortalItem",c);f=f?f.clone():new b;f.query="group:"+this.id+(f.query?" "+f.query:"");return d.queryItems(f,c)};a._fetchCategorySchemaSet=function(f,c){const d=z.unwrapOrThrow(this.portal);return d.fetchSelf(d.authMode,!0,c).then(p=>{if(p=p.contentCategorySetsGroupQuery){const v=new b;v.disableExtraQuery=!0;v.num=1;v.query=p;return d.queryGroups(v,c)}throw new G("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(p=>{if(p.total){p=p.results[0];const v=new b;
v.num=1;v.query=`typekeywords:"${f}"`;return p.queryItems(v,c)}throw new G("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(p=>p.total?p.results[0].fetchData("json",c).then(v=>(v=v&&v.categorySchema)&&v.length?v:[]):[])};q._createClass(h,[{key:"thumbnailUrl",get:function(){const f=this.url,c=this.thumbnail;return f&&c&&this.portal?this.portal?.normalizeUrl(`${f}/info/${c}?f=json`):null}},{key:"url",get:function(){const f=this.get("portal.restUrl");return f?
f+"/community/groups/"+this.id:null}}]);return h}(F.JSONSupport);n.__decorate([y.property()],F.prototype,"access",void 0);n.__decorate([y.property({type:Date})],F.prototype,"created",void 0);n.__decorate([y.property()],F.prototype,"description",void 0);n.__decorate([y.property()],F.prototype,"id",void 0);n.__decorate([y.property()],F.prototype,"isInvitationOnly",void 0);n.__decorate([y.property({type:Date})],F.prototype,"modified",void 0);n.__decorate([y.property()],F.prototype,"owner",void 0);n.__decorate([y.property()],
F.prototype,"portal",void 0);n.__decorate([y.property()],F.prototype,"snippet",void 0);n.__decorate([y.property()],F.prototype,"sortField",void 0);n.__decorate([y.property()],F.prototype,"sortOrder",void 0);n.__decorate([y.property()],F.prototype,"tags",void 0);n.__decorate([y.property()],F.prototype,"thumbnail",void 0);n.__decorate([y.property({readOnly:!0})],F.prototype,"thumbnailUrl",null);n.__decorate([y.property()],F.prototype,"title",void 0);n.__decorate([y.property({readOnly:!0})],F.prototype,
"url",null);return F=n.__decorate([g.subclass("esri.portal.PortalGroup")],F)})},"esri/symbols/support/styleUtils":function(){define("exports ../../request ../../core/Error ../../core/maybe ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags".split(" "),function(q,n,G,F,z,y,D,x,k){async function g(e,f){try{return{data:(await h(e,f)).data,baseUrl:y.removeFile(e),styleUrl:e}}catch(c){return z.throwIfAbortError(c),null}}function b(e,
f,c){f=F.isSome(f.portal)?f.portal:D.getDefault();let d;const p=`${f.url} - ${f.user&&f.user.username} - ${e}`;q.cachedStyles[p]||(q.cachedStyles[p]=a(e,f,c).then(v=>{d=v;return v.fetchData()}).then(v=>({data:v,baseUrl:d.itemUrl??"",styleName:e})));return q.cachedStyles[p]}function a(e,f,c){return f.load(c).then(()=>{const d=new x({disableExtraQuery:!0,query:`owner:${"esri_en"} AND type:${"Style"} AND typekeywords:"${e}"`});return f.queryItems(d,c)}).then(({results:d})=>{let p=null;const v=e.toLowerCase();
if(d&&Array.isArray(d))for(const l of d)if(l.typeKeywords?.some(u=>u.toLowerCase()===v)&&"Style"===l.type&&"esri_en"===l.owner){p=l;break}if(!p)throw new G("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return p.load(c)})}function h(e,f){f={responseType:"json",query:{f:"json"},...f};return n(y.normalize(e),f)}q.cachedStyles={};q.Style2DUrlTemplate="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson";
q.cleanupStyleUtilsCache=function(){q.cachedStyles&&(q.cachedStyles={})};q.fetchStyle=function(e,f,c){return e&&F.isSome(e.styleUrl)?g(e.styleUrl,c):e&&F.isSome(e.styleName)?b(e.styleName,f,c):Promise.reject(new G("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))};q.makeCIMSymbolRef=function(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}};q.requestJSON=h;q.symbolUrlFromStyleItem=function(e,f){if("cimRef"===
f)return e.cimRef;if(e.formatInfos&&!k.enableWebStyleForceWOSR())for(const c of e.formatInfos)if("gltf"===c.type)return c.href;return e.webRef};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/support/featureFlags":function(){define(["exports","../core/has"],function(q,n){const G=()=>n.cache["enable-feature:direct-3d-object-feature-layer-display"]=!0,F=()=>n.cache["enable-i3s-patching"]=!0;q.direct3DObjectFeatureLayerDisplayEnabled=()=>!!n("enable-feature:direct-3d-object-feature-layer-display");
q.enableDirect3DObjectFeatureLayerDisplay=G;q.enableI3SPatching=F;q.enableSceneLayerEditing=()=>{n.cache["enable-feature:SceneLayer-editing"]=!0;G();F()};q.enableWebStyleForceWOSR=()=>!!n("enable-feature:force-wosr");q.i3sPatchingEnabled=()=>!!n("enable-i3s-patching");q.sceneLayerEditingEnabled=()=>!!n("enable-feature:SceneLayer-editing");Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../core/maybe ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),
function(q,n,G,F,z,y,D,x,k,g){async function b(u,r,A,w){switch(u.type){case "simple":case "heatmap":return f.fromBasicRenderer(u,r,A,w);case "map":return p.fromUVRenderer(u,r,A,w);case "interval":return d.fromCBRenderer(u,r,A,w);case "dictionary":return l.fromDictionaryRenderer(u,r,A,w);case "pie-chart":return c.fromPieChartRenderer(u,r,A,w);case "subtype":return c.fromSubtypes(u,r,A,w)}}async function a(u,r){const A=u||1;if("number"===typeof A)return(m,t,B)=>A;const w=await x.createRendererExpression(A,
r.spatialReference,r.fields);return(m,t,B)=>k(w,m,{$view:B},r.geometryType,t)||1}async function h(){v||(v=new Promise((u,r)=>q(["../../../layers/features/createSymbolSchema"],u,r)));return v}const e=z.getLogger("esri/views/2d/engine/webgl/util/Matcher");let f=function(){function u(){this.type="feature";this._defaultResult=null}u.fromBasicRenderer=async function(A,w,m,t){const B=new u;A.symbol&&(A=await g.expandSymbol(A.symbol,m,t),w=w.createTemplateGroup(A,null),B.setDefault(w));return B};u.fromPieChartRenderer=
async function(A,w,m,t){const B=new u;if(A.markerSymbol){const J=await g.expandSymbol(A.markerSymbol,m,t);let C;A.fillSymbol&&(C=await g.expandSymbol(A.fillSymbol,m,t));A=w.createTemplateGroup(J,C);B.setDefault(A)}return B};var r=u.prototype;r.size=function(){return 1};r.getDefault=function(){return this._defaultResult};r.setDefault=function(A){this._defaultResult=A};r.match=function(A,w,m,t,B){return this.getDefault()};r.analyze=async function(A,w,m,t,B,J){return null};return G._createClass(u)}(),
c=function(u){function r(w,m){var t=A.call(this);t._subMatchers=w;t._subtypeField=m;return t}G._inherits(r,u);var A=G._createSuper(r);r.fromSubtypes=async function(w,m,t,B){const J=new Map,C=[];for(const K in w.renderers){const E=parseInt(K,10),I=b(w.renderers[K],m,t,B).then(H=>J.set(E,H));C.push(I)}await Promise.all(C);return new r(J,w.subtypeField)};r.prototype.match=function(w,m,t,B,J){var C=m.readAttribute(this._subtypeField);return(C=this._subMatchers.get(C))?C.match(w,m,t,B,J):null};return G._createClass(r)}(f),
d=function(u){function r(w,m,t,B){var J=A.call(this);J.type="interval";J._intervals=[];J._isMaxInclusive=m;J._fieldIndex=B;J._field=w;J._normalizationInfo=t;return J}G._inherits(r,u);var A=G._createSuper(r);r.fromCBRenderer=async function(w,m,t,B){const {isMaxInclusive:J,normalizationField:C,normalizationTotal:K,normalizationType:E}=w,I=new r(w.field,J,{normalizationField:C,normalizationTotal:K,normalizationType:E},w.fieldIndex),H=await g.expandSymbol(w.backgroundFillSymbol,t,B);await Promise.all(w.intervals.map(async N=>
{var U=await g.expandSymbol(N.symbol,t,B);U=await m.createTemplateGroup(U,H);I.add({min:N.min,max:N.max},U)}));if(w=await g.expandSymbol(w.defaultSymbol,t,B))w=await m.createTemplateGroup(w,H),I.setDefault(w);return I};u=r.prototype;u.add=function(w,m){this._intervals.push({interval:w,result:m});this._intervals.sort((t,B)=>t.interval.min-B.interval.min)};u.size=function(){return G._get(G._getPrototypeOf(r.prototype),"size",this).call(this)+this._intervals.length};u.match=function(w,m,t,B,J){if(null==
this._fieldIndex&&!this._field)return this.getDefault();w=null!=this._fieldIndex?m.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(m);if(null===w||void 0===w||isNaN(w)||Infinity===w||-Infinity===w)return this.getDefault();for(m=0;m<this._intervals.length;m++){const {interval:C,result:K}=this._intervals[m];t=this._isMaxInclusive?w<=C.max:w<C.max;if(w>=C.min&&t)return K}return this.getDefault()};u._needsNormalization=function(){const w=this._normalizationInfo;return w&&(w.normalizationField||
w.normalizationTotal||w.normalizationType)};u._getValueFromField=function(w){const m=w.readAttribute(this._field);if(!this._needsNormalization()||null==m)return m;const {normalizationField:t,normalizationTotal:B,normalizationType:J}=this._normalizationInfo;w=w.readAttribute(t)??1;if(J)switch(J){case "esriNormalizeByField":return(w||void 0)&&m/w;case "esriNormalizeByLog":return Math.log(m)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return m/B*100;default:e.error(`Found unknown normalization type: ${J}`)}else e.error("Normalization is required, but no type was set!")};
return G._createClass(r)}(f),p=function(u){function r(w,m,t){var B=A.call(this);B.type="map";B._nullResult=null;B._resultsMap=new Map;B._fields=[];B._fieldsIndex=t;B._fields=w;B._seperator=m||"";return B}G._inherits(r,u);var A=G._createSuper(r);r.fromUVRenderer=async function(w,m,t,B){const J=w.fieldDelimiter,C=[w.field];w.field2&&C.push(w.field2);w.field3&&C.push(w.field3);const K=await g.expandSymbol(w.backgroundFillSymbol,t,B),E=new r(C,J,w.fieldIndex);await Promise.all(w.map.map(async(I,H)=>{const N=
await g.expandSymbol(I.symbol,t,B);H=await m.createTemplateGroup(N,K,H+1);"\x3cNull\x3e"===I.value?E.setNullResult(H):E.add(I.value,H)}));if(w=await g.expandSymbol(w.defaultSymbol,t,B))w=await m.createTemplateGroup(w,K,Number.MAX_SAFE_INTEGER),E.setDefault(w);return E};u=r.prototype;u.setNullResult=function(w){this._nullResult=w};u.add=function(w,m){this._resultsMap.set(w.toString(),m)};u.size=function(){return G._get(G._getPrototypeOf(r.prototype),"size",this).call(this)+this._resultsMap.size};u.match=
function(w,m,t,B,J){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();w=null!=this._fieldsIndex?m.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(m);if(null!==this._nullResult&&(null==w||""===w||"\x3cNull\x3e"===w))return this._nullResult;if(null==w)return this.getDefault();w=w.toString();return this._resultsMap.has(w)?this._resultsMap.get(w):this.getDefault()};u._getValueFromFields=function(w){const m=[];for(const t of this._fields){const B=w.readAttribute(t);
null==B||""===B?m.push("\x3cNull\x3e"):m.push(B)}return m.join(this._seperator)};return G._createClass(r)}(f),v,l=function(u){function r(w,m,t,B,J,C){var K=A.call(this);K.type="dictionary";K._groupIdCache=new y(100);K._loader=w;K._fieldMap=w.fieldMap;K._symbolFields=w.getSymbolFields();K._templates=m;K._info=t;K._scaleFn=B;K._schemaUtilsModule=J;K._symbolOptions=C;return K}G._inherits(r,u);var A=G._createSuper(r);r.fromDictionaryRenderer=async function(w,m,t,B){const [{DictionaryLoader:J},C]=await Promise.all([new Promise((E,
I)=>q(["../../../../../renderers/support/DictionaryLoader"],E,I)),h()]);B=new J(w.url,w.config,w.fieldMap);await B.fetchResources({spatialReference:t.spatialReference,fields:t.fields});const K=await a(w.scaleExpression,t);return new r(B,m,t,K,C,w.symbolOptions)};u=r.prototype;u._analyzeFeature=async function(w,m,t,B,J){w=w.readLegacyFeature();const C=this._scaleFn(w,t,B);t=this._attributeHash(w)+"-"+C;const K=this._groupIdCache.get(t);if(K)return K;B=await this._loader.getSymbolAsync(w,{...B,spatialReference:this._info.spatialReference,
abortOptions:J,fields:this._info.fields});B=this._schemaUtilsModule.createSymbolSchema(B,this._symbolOptions);m=g.expandSymbol(B,this._info,m,J).then(E=>{if("expanded-cim"!==E?.type)return e.error(new F("mapview-bad-type",`Found unexpected type ${E?.type} in dictionary response`)),null;E.hash+="-"+C;for(const I of E.layers)I.scaleFactor=C,I.templateHash+="-"+C;return this._templates.createTemplateGroup(E,null)});this._groupIdCache.put(t,m,1);return m};u.analyze=async function(w,m,t,B,J,C){w=m.getCursor();
for(m=[];w.next();)m.push(this._analyzeFeature(w,t,B,J,C));return Promise.all(m).then(K=>K.filter(D.isSome))};u.match=function(w,m,t,B,J){return null};u._attributeHash=function(w){let m="";for(const t of this._symbolFields){const B=this._fieldMap?.[t];B&&(m+=w.attributes[B]+"-")}return m};return G._createClass(r)}(f);n.DictionaryMatcher=l;n.FeatureMatcher=f;n.IntervalMatcher=d;n.MapMatcher=p;n.SubtypeMatcher=c;n.createMatcher=b;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/core/LRUCache":function(){define(["../chunks/_rollupPluginBabelHelpers",
"./MemCache"],function(q,n){return function(){function G(z,y){this._storage=new n.MemCacheStorage;this._storage.maxSize=z;y&&this._storage.registerRemoveFunc("",y)}var F=G.prototype;F.put=function(z,y,D){this._storage.put(z,y,D,1)};F.pop=function(z){return this._storage.pop(z)};F.get=function(z){return this._storage.get(z)};F.clear=function(){this._storage.clearAll()};F.destroy=function(){this._storage.destroy()};q._createClass(G,[{key:"maxSize",get:function(){return this._storage.maxSize},set:function(z){this._storage.maxSize=
z}}]);return G}()})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass".split(" "),function(q,n,G,F,z,y,D,x){G=function(k){function g(){return b.apply(this,
arguments)}q._inherits(g,k);var b=q._createSuper(g);k=g.prototype;k.initialize=function(){};k.destroy=function(){};q._createClass(g,[{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){const a=this.get("tileStore.tileScheme.spatialReference");return a&&a.toJSON()||null}}]);return g}(G.HandleOwner);n.__decorate([F.property({readOnly:!0})],G.prototype,"supportsTileUpdates",null);n.__decorate([F.property({constructOnly:!0})],G.prototype,"remoteClient",void 0);
n.__decorate([F.property({constructOnly:!0})],G.prototype,"service",void 0);n.__decorate([F.property()],G.prototype,"spatialReference",null);n.__decorate([F.property({constructOnly:!0})],G.prototype,"tileInfo",void 0);n.__decorate([F.property({constructOnly:!0})],G.prototype,"tileStore",void 0);return G=n.__decorate([x.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],G)})},"esri/views/2d/layers/features/support/ResourceManagerProxy":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/promiseUtils"],function(q,n){return function(){function G(z){this._remoteClient=z;this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEnginePromise=this.geometryEngine=null}var F=G.prototype;F.destroy=function(){};F.fetchResource=async function(z,y){const D=this._resourceMap;var x=D.get(z);if(x||(x=this._inFlightResourceMap.get(z)))return x;try{x=this._remoteClient.invoke("tileRenderer.fetchResource",{url:z},{...y}),this._inFlightResourceMap.set(z,x),x.then(k=>
{this._inFlightResourceMap.delete(z);D.set(z,k);return k})}catch(k){return n.isAbortError(k)?null:{width:0,height:0}}return x};F.getResource=function(z){return this._resourceMap.get(z)??null};return q._createClass(G)}()})},"*noref":1}});
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/HandleOwner ../../../../core/has ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/spatialReferenceUtils ../../../../layers/support/TileInfo ./processors ./controllers/FeatureController2D ./support/TileStore ./support/UpdateToken ../../tiling/TileInfoView".split(" "),function(q,
n,G,F,z,y,D,x,k,g,b,a,h,e,f,c){G=function(d){function p(){var l=v.apply(this,arguments);l.controller=null;l.processor=null;l.remoteClient=null;l.tileStore=null;l.service=null;l.viewState=null;l._paused=!1;l._pendingTileUpdates=[];return l}q._inherits(p,d);var v=q._createSuper(p);d=p.prototype;d.initialize=function(){this.handles.add(z.watch(()=>this.updating,l=>{this.remoteClient.invoke("setUpdating",l).catch(u=>{})}))};d.destroy=function(){this.stop();this.controller?.destroy();this.processor?.destroy();
this.controller=this.processor=this.tileStore=this.remoteClient=null};d.stop=function(){this._paused=!0;Array.isArray(this.service?.source)&&(this.service.source.forEach(l=>l.close()),this.service.source.length=0);this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map(l=>l.id)});this.tileStore?.destroy();this.tileStore=null;this._pendingTileUpdates.length=0};d.startup=async function({service:l,config:u,tileInfo:r,tiles:A}){this._paused=!0;Array.isArray(this.service?.source)&&(this.service.source.forEach(w=>
w.close()),this.service.source.length=0);this.service=l;this.tileStore&&g.equals(this.tileStore.tileScheme.spatialReference,r.spatialReference)||(l=new c(b.fromJSON(r)),A.added.length=A.removed.length=0,this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map(w=>w.id)}),this.tileStore?.destroy(),this.tileStore=new e(l),this._pendingTileUpdates.length=0);await this._createProcessorAndController(u);await this.update({config:u});this.controller.resume();this.tileStore.clear();this.tileStore.updateTiles(A);
for(this._paused=!1;this._pendingTileUpdates.length;)this.tileStore.updateTiles(this._pendingTileUpdates.pop())};d.updateTiles=async function(l){this._paused?this._pendingTileUpdates.push(l):this.tileStore?.updateTiles(l)};d.update=async function({config:l}){const u=f.UpdateToken.empty();await Promise.all([this.processor.update(u,l),this.controller.update(u,l)]);return u.toJSON()};d.applyUpdate=async function(l){return this.controller.applyUpdate(f.UpdateToken.create(l))};d._createProcessorAndController=
async function(l){await Promise.all([this._handleControllerConfig(l),this._handleProcessorConfig(l)]);this.controller.processor=this.processor};d._handleControllerConfig=async function(l){return this._createController(this.service,l)};d._handleProcessorConfig=async function(l){return this._createProcessor(this.service,l)};d._createController=async function(l,u){this.controller&&this.controller.destroy();const {tileStore:r,remoteClient:A}=this;return this.controller=l=new h({service:l,tileStore:r,
remoteClient:A})};d._createProcessor=async function(l,u){const r=(await a.loadProcessorModule(u.schema.processors[0].type)).default,{remoteClient:A,tileStore:w}=this;l=new r({service:l,config:u,tileStore:w,remoteClient:A});this.processor&&this.processor.destroy();return this.processor=l};q._createClass(p,[{key:"updating",get:function(){return!this.controller||this.controller.updating}}]);return p}(G.HandleOwner);n.__decorate([y.property()],G.prototype,"controller",void 0);n.__decorate([y.property()],
G.prototype,"processor",void 0);n.__decorate([y.property()],G.prototype,"updating",null);n.__decorate([y.property()],G.prototype,"viewState",void 0);return G=n.__decorate([k.subclass("esri.views.2d.layers.features.Pipeline")],G)});