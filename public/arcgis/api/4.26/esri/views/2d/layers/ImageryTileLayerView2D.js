// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/support/rasterDatasets/multidimensionalUtils":function(){define(["exports","../../../core/maybe","../DimensionalDefinition"],function(u,D,F){function m(E,h,f){const d=h.shift();0===f.length&&f.push({sliceId:-1,multidimensionalDefinition:[]});const k=f.length;for(let p=0;p<k;p++){const J=f.shift().multidimensionalDefinition;d.values?.forEach(a=>{f.push({sliceId:-1,multidimensionalDefinition:[...J,{variableName:E,dimensionName:d.name,values:[a]}]})})}h.length&&m(E,h,f)}
function q(E,h){return Array.isArray(E)?h[0]===h[1]?E[0]===h[0]||E[1]===h[0]:E[0]>=h[0]&&E[0]<=h[1]&&E[1]>=h[0]&&E[1]<=h[1]:E>=h[0]&&E<=h[1]}function A(E,h){return E[0]<=h[0]&&E[1]>=h[0]||E[0]<=h[1]&&E[1]>=h[1]||E[0]>=h[0]&&E[1]<=h[1]}function x(E){return 1===E.length?[E[0],E[0]]:[E[0],E[E.length-1]]}function I(E,h,f){if(!h?.subsetDefinitions?.length)return E;if(f){const {variables:k}=h;if(k.length&&!k.includes(f))return null;h=h.subsetDefinitions.find(p=>p.dimensionName===E.name&&p.variableName===
f);if(!h?.values?.length)return E;h=x(h.values)}else h=h.dimensions.find(({name:k})=>k===E.name)?.extent;const d=h;if(!d||!d?.length)return E;h=E.values.filter(k=>q(k,d));return{...E,extent:[...d],values:h}}function B(E,h,f){if(!h?.subsetDefinitions?.length)return!1;const {variables:d}=h;if(d.length&&E.some(({variableName:k})=>k&&!d.includes(k)))return!0;for(let k=0;k<E.length;k++){const p=E[k],J=h.subsetDefinitions.find(a=>(""===p.variableName||a.variableName===p.variableName)&&a.dimensionName===
p.dimensionName);if(J?.values.length){const a=x(J.values);if(!p.isSlice&&2===p.values.length&&!Array.isArray(p.values[0])&&p.values[0]!==p.values[1]&&f){if(!A(p.values,a))return!0}else if(p.values.some(c=>!q(c,a)))return!0}}return!1}function G(E,h){var f=E.dimensions.find(({name:J})=>"StdTime"===J);if(null==f||D.isNone(h.start)&&D.isNone(h.end))return h;h=h.clone();const {start:d,end:k}=h.toJSON(),p=d===k?[d]:null!=d&&null!=k?[d,k]:[d??k];if(2===p.length&&f?.extent.length&&(p[0]=Math.max(p[0],f.extent[0]),
p[1]=Math.min(p[1],f.extent[1]??f.extent[0]),p[1]<p[0]))return null;f=new F({variableName:"",dimensionName:"StdTime",isSlice:1===p.length,values:p});if(B([f],E,!0))return null;h.start=new Date(p[0]);h.end=new Date(p[1]??p[0]);return h}function w(E,h={}){const {multidimensionalInfo:f,keyProperties:d}=E;if(D.isNone(f))return null;const {variableName:k,multidimensionalSubset:p,multidimensionalDefinition:J}=h;E=D.isSome(J)?J[0]?.variableName:null;const a=k||E||d?.DefaultVariable;({variables:E}=f);p?.variables?.length&&
(E=E.filter(({name:c})=>p.variables.includes(c)));return a?E.find(({name:c})=>c===a)??E[0]:E[0]}function t(E,h){var {values:f}=h;if(f?.length)return Array.isArray(f[0])!==Array.isArray(E)?-1:Array.isArray(f[0])?f.findIndex(p=>p[0]===E[0]&&p[1]===E[1]):f.indexOf(E);var {extent:d}=h;if(Array.isArray(E)||E<d[0]||E>d[1])return-1;f=h.interval||1;if("ISO8601"!==h.unit)return Math.round((E-d[0])/f);d=d[0];let k=-1;switch(h.intervalUnit?.toLowerCase()||"seconds"){case "seconds":k=Math.round((E-d)/1E3/f);
break;case "minutes":k=Math.round((E-d)/6E4/f);break;case "hours":k=Math.round((E-d)/36E5/f);break;case "days":k=Math.round((E-d)/864E5/f);break;case "months":h=(new Date(E)).getUTCFullYear()-(new Date(d)).getUTCFullYear();f=(new Date(d)).getUTCMonth();d=(new Date(E)).getUTCMonth();k=0===h?d-f:d+11-f+12*(h-1);break;case "years":k=Math.round(((new Date(E)).getUTCFullYear()-(new Date(d)).getUTCFullYear())/f);break;case "decades":k=Math.round(((new Date(E)).getUTCFullYear()-(new Date(d)).getUTCFullYear())/
10/f)}return k}function L(E){var h=E.values?.length;if(h)return h;const {extent:f,unit:d}=E;h=E.interval||1;var k=f?f[1]-f[0]:0;if("ISO8601"!==d)return Math.round(k/h);switch(E.intervalUnit?.toLowerCase()??"seconds"){case "seconds":h=Math.round(k/1E3/h);break;case "minutes":h=Math.round(k/6E4/h);break;case "hours":h=Math.round(k/36E5/h);break;case "days":h=Math.round(k/864E5/h);break;case "months":E=(new Date(f[1])).getUTCFullYear()-(new Date(f[0])).getUTCFullYear();h=(new Date(f[1][0])).getUTCMonth();
k=(new Date(f[1][1])).getUTCMonth();h=0===E?k-h+1:k+11-h+12*(E-1)+1;break;case "years":h=Math.round(((new Date(f[1])).getUTCFullYear()-(new Date(f[0])).getUTCFullYear())/h);break;case "decades":h=Math.round(((new Date(f[1])).getUTCFullYear()-(new Date(f[0])).getUTCFullYear())/10/h);break;default:h=0}return h}u.createSlices=function(E,h){const f=[];let d=0;(h?E.variables.filter(k=>k.name.toLowerCase()===h.toLowerCase()):[...E.variables].sort((k,p)=>k.name>p.name?1:-1)).forEach(k=>{const p=[],J=[...k.dimensions].sort((a,
c)=>a.name>c.name?-1:1);m(k.name,J,p);p.forEach(a=>{f.push({...a,sliceId:d++})})});return f};u.getDefaultMultidimensionalDefinition=function(E,h={}){var f=w(E,h);if(!f)return null;E=[];const {dimensions:d,name:k}=f;if(0===d.length)return[new F({variableName:k,dimensionName:"",values:[],isSlice:!0})];for(f=0;f<d.length;f++){const p=I(d[f],h.multidimensionalSubset,k);if(!p)return null;const {values:J,extent:a}=p;let c=J?.[0]??a[0];"stdz"===p.name.toLowerCase()&&!p.hasRanges&&Math.abs(a[1])<=Math.abs(a[0])&&
(c=J?.length?J[J.length-1]:a[1]);E.push(new F({variableName:k,dimensionName:p.name,values:[c],isSlice:h.useRangeForRangedDimensionInfo?!!p.hasRanges:!0}))}return E};u.getDefaultVariablInfo=w;u.getSliceIds=function(E,h,f){let d=E;h&&(h=[...h].sort((k,p)=>k.dimensionName<p.dimensionName?-1:1),h.forEach(({dimensionName:k,values:p,isSlice:J})=>{p.length&&(d=d.filter(a=>{a=a.multidimensionalDefinition.find(e=>e.dimensionName===k);if(null==a)return!1;const c=a.values[0];return"number"===typeof c?"number"===
typeof p[0]?p.includes(c):p.some(e=>e[0]<=c&&e[1]>=c):"number"===typeof p[0]?p.some(e=>c[0]<=e&&c[1]>=e):J?p.some(e=>e[0]===c[0]&&e[0]===c[1]):p.some(e=>e[0]>=c[0]&&e[0]<=c[1]||e[1]>=c[0]&&e[1]<=c[1]||e[0]<c[0]&&e[1]>c[1])}))}));if(d.length&&f&&D.isSome(f.start)&&D.isSome(f.end)){const k=f.start.getTime(),p=f.end.getTime(),J=d[0].multidimensionalDefinition.findIndex(a=>"StdTime"===a.dimensionName);-1<J&&(d=d.filter(a=>{a=a.multidimensionalDefinition[J].values[0];return k<=a&&p>=a}))}return d.map(k=>
k.sliceId)};u.getSliceIndex=function(E,h){let f=0;var d=E[0].variableName;h=[...h.variables].sort((p,J)=>p.name>J.name?1:-1);for(var k=0;k<h.length;k++){const p=h[k],J=[...p.dimensions].sort((a,c)=>a.name>c.name?-1:1);if(p.name!==d)f+=J.map(a=>L(a)).reduce((a,c)=>a*c);else{d=J.map(a=>L(a));h=J.length;for(let a=0;a<h;a++){k=E.find(c=>c.dimensionName===J[a].name);if(null==k)return null;k=t(k.values[0],J[a]);if(-1===k)return null;d.shift();f=a===h-1?f+k:f+k*d.reduce((c,e)=>c*e)}break}}return f};u.getSubsetVariablesFromMdInfo=
function(E,h){if(D.isNone(h)||D.isNone(E))return null;h=h.variables.map(f=>({...f}));E?.variables?.length&&(h=h.filter(({name:f})=>E.variables.includes(f)),h.forEach(f=>{f.dimensions=f.dimensions.map(d=>I(d,E,f.name)).filter(D.isSome)}));return h};u.hasExcludedVariableOrDimension=B;u.intersectMultimensionalSubset=function(E,h){if(D.isNone(E))return{isOutside:!1};const {geometry:f,timeExtent:d,multidimensionalDefinition:k}=h;h=null;if(D.isSome(d)&&(h=G(E,d),D.isNone(h)))return{isOutside:!0};const {areaOfInterest:p}=
E;if(p&&f){const J="point"===f.type?f:"extent"===f.type?f.center:"polygon"===f.type?f.centroid:null;if(J&&!p.contains(J))return{isOutside:!0}}return D.isSome(k)&&k.length&&B(k,E,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:f,timeExtent:h,multidimensionalDefinition:k}}};u.isMultiSliceOrRangeDefinition=function(E){return D.isNone(E)||!E.length?!1:E.some(h=>{if(null==h.values)return!0;const f=h.values.length;return 0===f||1<f||!h.isSlice&&Array.isArray(h.values[0])})};Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/DimensionalDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(u,D,F,m,q,A,x){var I;F=I=function(B){function G(t){t=w.call(this,t);t.variableName=null;t.dimensionName=null;t.values=[];t.isSlice=!1;return t}u._inherits(G,
B);var w=u._createSuper(G);G.prototype.clone=function(){return new I({variableName:this.variableName,dimensionName:this.dimensionName,values:m.clone(this.values),isSlice:this.isSlice})};return u._createClass(G)}(F.JSONSupport);D.__decorate([q.property({type:String,json:{write:!0}})],F.prototype,"variableName",void 0);D.__decorate([q.property({type:String,json:{write:!0}})],F.prototype,"dimensionName",void 0);D.__decorate([q.property({type:A.types.array(A.types.oneOf([A.types.native(Number),A.types.array(A.types.native(Number))])),
json:{write:!0}})],F.prototype,"values",void 0);D.__decorate([q.property({type:Boolean,json:{write:!0}})],F.prototype,"isSlice",void 0);return F=I=D.__decorate([x.subclass("esri.layers.support.DimensionalDefinition")],F)})},"esri/views/2d/engine/flow/FlowView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../Graphic ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ./createFlowStyle ./dataUtils ./FlowContainer ./FlowStrategy".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w,t,L,E){m=function(h){function f(){var k=d.apply(this,arguments);k._loadImagery=(p,J,a,c,e)=>t.loadImagery(k.layer,p,J,a,c,e);k._createFlowMesh=(p,J,a,c)=>k.layer.createFlowMesh({meshType:p,flowData:a,simulationSettings:J},{signal:c});k.attached=!1;k.type="flow";k.timeExtent=null;k.redrawOrRefetch=async()=>{k._updateVisualization()};return k}u._inherits(f,h);var d=u._createSuper(f);h=f.prototype;h.attach=function(){const {layer:k}=this,p=()=>{this._loadImagery=(J,a,c,
e,n)=>t.loadImagery(k,J,a,c,e,n);this._updateVisualization()};"multidimensionalDefinition"in k?this.addHandles(q.watch(()=>k.multidimensionalDefinition,p)):this.addHandles([q.watch(()=>k.mosaicRule,p),q.watch(()=>k.renderingRule,p),q.watch(()=>k.definitionExpression,p)]);this.container=new L;this._strategy=new E({flowContainer:this.container});this._updateVisualization()};h.detach=function(){this._strategy.destroy();this.container?.removeAllChildren();this.container=null;this.removeHandles()};h.update=
function(k){k.stationary?this._strategy.update(k):this.layerView.requestUpdate()};h.hitTest=function(k){return new F({attributes:{},geometry:k.clone(),layer:this.layer})};h.moveEnd=function(){};h.doRefresh=async function(){};h._updateVisualization=function(){var k=this.layer.renderer;null!=k&&"flow"===k.type&&(k=w(k,{loadImagery:this._loadImagery,createFlowMesh:this._createFlowMesh,timeExtent:this.timeExtent}),this.container.flowStyle=k,this.layerView.requestUpdate())};u._createClass(f,[{key:"updating",
get:function(){return!this.attached||this._strategy.updating}}]);return f}(m);D.__decorate([A.property()],m.prototype,"_strategy",void 0);D.__decorate([A.property()],m.prototype,"attached",void 0);D.__decorate([A.property()],m.prototype,"container",void 0);D.__decorate([A.property()],m.prototype,"layer",void 0);D.__decorate([A.property()],m.prototype,"layerView",void 0);D.__decorate([A.property()],m.prototype,"type",void 0);D.__decorate([A.property()],m.prototype,"updating",null);D.__decorate([A.property()],
m.prototype,"timeExtent",void 0);return m=D.__decorate([G.subclass("esri.views.2d.engine.flow.FlowView2D")],m)})},"esri/views/2d/engine/flow/createFlowStyle":function(){define("../../../../core/maybe ./utils ./styles/Imagery ./styles/Particles ./styles/Stack ./styles/Streamlines".split(" "),function(u,D,F,m,q,A){return function(x,I){const {flowSpeed:B,trailLength:G}=x,w=D.getFlowSimulationSettings(x);let t=null;const L={opacity:D.getOpacity(x),size:D.getSize(x)};let E=D.getColor(x);"none"===x.background?
L.color=E:("constant"===E.kind&&(E={kind:"ramp",stops:[0,1],values:[0,0,0,1,E.value[0],E.value[1],E.value[2],E.value[3]],count:2}),t=new F.Imagery({loadImagery:I.loadImagery,timeExtent:I.timeExtent,color:E,opacity:{kind:"constant",value:[1]}}),L.color=D.getForegroundColor());I={loadImagery:I.loadImagery,createFlowMesh:I.createFlowMesh,simulationSettings:w,timeExtent:I.timeExtent,trailLength:G,flowSpeed:B,featheringSize:1,featheringOffset:.5,introFade:!0,fadeToZero:!0,decayRate:2.3,color:L.color,opacity:L.opacity,
size:L.size};x="butt"===x.trailCap||4>=D.getMax(D.getSize(x))?new A(I):new m.Particles(I);return u.isSome(t)?new q.Stack([t,x]):x}})},"esri/views/2d/engine/flow/utils":function(){define(["exports","../../../../core/maybe","../../../../core/screenUtils"],function(u,D,F){function m(B){return"constant"===B.kind?B.value[0]:B.values[B.values.length-1]}function q(B){B=B.toRgba();return[B[0]/255,B[1]/255,B[2]/255,B[3]]}function A(B){if(!B.hasVisualVariables("size"))return{kind:"constant",value:[F.pt2px(B.trailWidth)]};
const G=B.getVisualVariablesForType("size")[0];B=[];const w=[];if(G.stops){for(t of G.stops)B.push(t.value),w.push(F.pt2px(t.size));var t=G.stops.length}else B.push(G.minDataValue,G.maxDataValue),w.push(F.pt2px(G.minSize),F.pt2px(G.maxSize)),t=2;return{kind:"ramp",stops:B,values:w,count:t}}function x(B,G,w,t){switch(G){case "int":B.setUniform1iv(w,t);break;case "float":B.setUniform1fv(w,t);break;case "vec2":B.setUniform2fv(w,t);break;case "vec3":B.setUniform3fv(w,t);break;case "vec4":B.setUniform4fv(w,
t)}}function I(B,G){return B===G?!0:D.isSome(B)&&D.isSome(G)?B.equals(G):!1}u.areStreamlinesCompatible=function(B,G){var w=B.simulationSettings,t=G.simulationSettings;let L;L=(L=(L=(L=(L=(L=(L=(L=(L=(L=(L=w.collisions===t.collisions)&&w.density===t.density)&&w.interpolate===t.interpolate)&&w.lineCollisionWidth===t.lineCollisionWidth)&&w.lineSpacing===t.lineSpacing)&&w.maxTurnAngle===t.maxTurnAngle)&&w.minSpeedThreshold===t.minSpeedThreshold)&&w.segmentLength===t.segmentLength)&&w.smoothing===t.smoothing)&&
w.velocityScale===t.velocityScale)&&w.verticesPerLine===t.verticesPerLine;return L&&I(B.timeExtent,G.timeExtent)?w=(w=(w=(w=(w=B.loadImagery===G.loadImagery)&&B.createFlowMesh===G.createFlowMesh)&&B.color.kind===G.color.kind)&&B.opacity.kind===G.opacity.kind)&&B.size.kind===G.size.kind:!1};u.getColor=function(B){if(!B.hasVisualVariables("color"))return{kind:"constant",value:q(B.color)};B=B.getVisualVariablesForType("color")[0];const G=[],w=[];for(const t of B.stops)G.push(t.value),Array.prototype.push.apply(w,
q(t.color));return{kind:"ramp",stops:G,values:w,count:B.stops.length}};u.getFlowSimulationSettings=function(B){var G=A(B);G=m(G);const w=Math.max(G/2,5),t=Math.round(F.pt2px(B.maxPathLength)/w)+1,{density:L}=B;return{smoothing:F.pt2px(B.smoothing),interpolate:!0,velocityScale:"flow-from"===B.flowRepresentation?1:-1,verticesPerLine:t,minSpeedThreshold:.001,segmentLength:w,maxTurnAngle:1,collisions:!0,lineCollisionWidth:G,lineSpacing:10,density:L}};u.getForegroundColor=function(B){return{kind:"constant",
value:[.1,.1,.1,1]}};u.getMax=m;u.getOpacity=function(B){if(!B.hasVisualVariables("opacity"))return{kind:"constant",value:[1]};B=B.getVisualVariablesForType("opacity")[0];const G=[],w=[];for(const t of B.stops)G.push(t.value),w.push(t.opacity);return{kind:"ramp",stops:G,values:w,count:B.stops.length}};u.getSize=A;u.setUniform=x;u.setUniforms=function(B,G,w,t){"constant"===t.kind?x(B,w,`u_${G}`,t.value):(x(B,"float",`u_${G}_stops`,t.stops),x(B,w,`u_${G}_values`,t.values),B.setUniform1i(`u_${G}_count`,
t.count))};u.timeExtentsEqual=I;u.toRgba=q;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/flow/styles/Imagery":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/promiseUtils ../utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/VertexElementDescriptor".split(" "),function(u,D,F,m,q,A,x,I,B){let G=function(){function h(d){this._params=
d;this.animated=!1}var f=h.prototype;f.isCompatible=function(d){if(!(d instanceof h&&m.timeExtentsEqual(this._params.timeExtent,d._params.timeExtent)))return!1;let k;return k=(k=(k=this._params.loadImagery===d._params.loadImagery)&&this._params.color.kind===d._params.color.kind)&&this._params.opacity.kind===d._params.opacity.kind};f.load=async function(d,k){const {extent:p,size:J}=d;F.throwIfAborted(k);d=await this._params.loadImagery(p,J[0],J[1],this._params.timeExtent,k);return new E(d,{color:this._params.color,
opacity:this._params.opacity})};f.render=function(d,k,p){({context:d}=d);const {program:J}=p;d.setFaceCullingEnabled(!1);d.setBlendingEnabled(!0);d.setBlendFunction(A.BlendFactor.ONE,A.BlendFactor.ONE_MINUS_SRC_ALPHA);d.useProgram(J);J.setUniformMatrix3fv("u_dvsMat3",k.dvsMat3);d.bindTexture(p.texture,0);J.setUniform1i("u_texture",0);J.setUniform1f("u_Min",p.min);J.setUniform1f("u_Max",p.max);m.setUniforms(J,"color","vec4",this._params.color);m.setUniforms(J,"opacity","float",this._params.opacity);
d.bindVAO(p.vertexArray);d.drawArrays(A.PrimitiveType.TRIANGLE_STRIP,0,4)};return D._createClass(h)}();const w=new Map;w.set("a_position",0);w.set("a_texcoord",1);const t={geometry:[new B.VertexElementDescriptor("a_position",2,A.DataType.UNSIGNED_SHORT,0,8),new B.VertexElementDescriptor("a_texcoord",2,A.DataType.UNSIGNED_SHORT,4,8)]},L={vsPath:"raster/flow/imagery",fsPath:"raster/flow/imagery",attributes:w};let E=function(){function h(d,k){this._flowData=d;this._values=k}var f=h.prototype;f.attach=
function(d){var {context:k}=d;const {width:p,height:J}=this._flowData;var a={geometry:q.BufferObject.createVertex(k,A.Usage.STATIC_DRAW,new Uint16Array([0,0,0,1,p,0,1,1,0,J,0,0,p,J,1,0]))};a=new I.VertexArrayObject(k,w,t,a);var c=[];"ramp"===this._values.color.kind&&c.push("vvColor");"ramp"===this._values.opacity.kind&&c.push("vvOpacity");d=d.painter.materialManager.getProgram(L,c);c=1E6;let e=-1E6;for(var n=0;n<J;n++)for(var b=0;b<p;b++)if(0!==this._flowData.mask[n*p+b]){var l=this._flowData.data[2*
(n*p+b)],r=this._flowData.data[2*(n*p+b)+1];l=Math.sqrt(l*l+r*r);c=Math.min(c,l);e=Math.max(e,l)}n=new Uint8Array(4*p*J);for(b=0;b<J;b++)for(l=0;l<p;l++)if(0!==this._flowData.mask[b*p+l]){r=this._flowData.data[2*(b*p+l)];const y=this._flowData.data[2*(b*p+l)+1];n[4*(b*p+l)]=(Math.sqrt(r*r+y*y)-c)/(e-c)*255;n[4*(b*p+l)+1]=0;n[4*(b*p+l)+2]=0;n[4*(b*p+l)+3]=255}else n[4*(b*p+l)]=0,n[4*(b*p+l)+1]=0,n[4*(b*p+l)+2]=0,n[4*(b*p+l)+3]=0;k=new x.Texture(k,{pixelFormat:A.PixelFormat.RGBA,internalFormat:A.PixelFormat.RGBA,
samplingMode:A.TextureSamplingMode.LINEAR,dataType:A.PixelType.UNSIGNED_BYTE,wrapMode:A.TextureWrapMode.CLAMP_TO_EDGE,flipped:!0,width:p,height:J},n);this.vertexArray=a;this.program=d;this.texture=k;this.min=c;this.max=e;this._flowData=null};f.detach=function(){this.vertexArray.dispose();this.texture.dispose()};D._createClass(h,[{key:"ready",get:function(){return this.program.compiled}}]);return h}();u.Imagery=G;u.ImageryResources=E;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/flow/styles/Particles":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/promiseUtils ../utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject ../../../../webgl/VertexElementDescriptor".split(" "),function(u,D,F,m,q,A,x,I){let B=function(){function E(f){this._params=f}var h=E.prototype;h.isCompatible=function(f){return f instanceof E?m.areStreamlinesCompatible(this._params,f._params):!1};
h.load=async function(f,d){const {extent:k,size:p}=f;F.throwIfAborted(d);f=await this._params.loadImagery(k,p[0],p[1],this._params.timeExtent,d);const {vertexData:J,indexData:a}=await this._params.createFlowMesh("Particles",this._params.simulationSettings,f,d);return new L(J,a,{color:this._params.color,opacity:this._params.opacity,size:this._params.size})};h.render=function(f,d,k){({context:f}=f);const {program:p}=k;f.setFaceCullingEnabled(!1);f.setBlendingEnabled(!0);f.setBlendFunction(A.BlendFactor.ONE,
A.BlendFactor.ONE_MINUS_SRC_ALPHA);f.useProgram(p);p.setUniform1f("u_time",d.time);p.setUniform1f("u_trailLength",this._params.trailLength);p.setUniform1f("u_flowSpeed",this._params.flowSpeed);p.setUniform1f("u_featheringSize",this._params.featheringSize);p.setUniform1f("u_featheringOffset",this._params.featheringOffset);p.setUniform1f("u_introFade",this._params.introFade?1:0);p.setUniform1f("u_fadeToZero",this._params.fadeToZero?1:0);p.setUniform1f("u_decayRate",this._params.decayRate);p.setUniformMatrix3fv("u_dvsMat3",
d.dvsMat3);p.setUniformMatrix3fv("u_displayViewMat3",d.displayViewMat3);m.setUniforms(p,"color","vec4",this._params.color);m.setUniforms(p,"opacity","float",this._params.opacity);m.setUniforms(p,"size","float",this._params.size);f.bindVAO(k.vertexArray);f.drawElements(A.PrimitiveType.TRIANGLES,k.indexCount,A.DataType.UNSIGNED_INT,0)};D._createClass(E,[{key:"animated",get:function(){return 0<this._params.flowSpeed}}]);return E}();const G=new Map;G.set("a_xyts0",0);G.set("a_xyts1",1);G.set("a_typeIdDurationSeed",
2);G.set("a_extrudeInfo",3);const w={geometry:[new I.VertexElementDescriptor("a_xyts0",4,A.DataType.FLOAT,0,64),new I.VertexElementDescriptor("a_xyts1",4,A.DataType.FLOAT,16,64),new I.VertexElementDescriptor("a_typeIdDurationSeed",4,A.DataType.FLOAT,32,64),new I.VertexElementDescriptor("a_extrudeInfo",4,A.DataType.FLOAT,48,64)]},t={vsPath:"raster/flow/particles",fsPath:"raster/flow/particles",attributes:G};let L=function(){function E(f,d,k){this._vertexData=f;this._indexData=d;this._values=k}var h=
E.prototype;h.attach=function(f){var {context:d}=f,k=q.BufferObject.createVertex(d,A.Usage.STATIC_DRAW,this._vertexData);const p=q.BufferObject.createIndex(d,A.Usage.STATIC_DRAW,this._indexData);d=new x.VertexArrayObject(d,G,w,{geometry:k},p);k=[];"ramp"===this._values.color.kind&&k.push("vvColor");"ramp"===this._values.opacity.kind&&k.push("vvOpacity");"ramp"===this._values.size.kind&&k.push("vvSize");f=f.painter.materialManager.getProgram(t,k);this.vertexArray=d;this.program=f;this.indexCount=this._indexData.length;
this._indexData=this._vertexData=null};h.detach=function(){this.vertexArray.dispose()};D._createClass(E,[{key:"ready",get:function(){return this.program.compiled}}]);return E}();u.Particles=B;u.ParticlesResources=L;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/flow/styles/Stack":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(u,D){let F=function(){function q(x){this._styles=x}var A=q.prototype;A.isCompatible=function(x){if(!(x instanceof
q)||this._styles.length!==x._styles.length)return!1;const I=this._styles.length;for(let B=0;B<I;B++)if(!this._styles[B].isCompatible(x._styles[B]))return!1;return!0};A.load=async function(x,I){const B=await Promise.all(this._styles.map(G=>G.load(x,I)));return new m(B)};A.render=function(x,I,B){for(let G=0;G<this._styles.length;G++)this._styles[G].render(x,I,B.resources[G])};D._createClass(q,[{key:"animated",get:function(){return this._styles.reduce((x,I)=>x||I.animated,!1)}}]);return q}(),m=function(){function q(x){this.resources=
x}var A=q.prototype;A.attach=function(x){for(const I of this.resources)I.attach(x)};A.detach=function(){for(const x of this.resources)x.detach()};D._createClass(q,[{key:"ready",get:function(){return this.resources.reduce((x,I)=>x&&I.ready,!0)}}]);return q}();u.Stack=F;u.StackResources=m;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/flow/styles/Streamlines":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/promiseUtils ../utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject ../../../../webgl/VertexElementDescriptor".split(" "),
function(u,D,F,m,q,A,x){let I=function(){function L(h){this._params=h}var E=L.prototype;E.isCompatible=function(h){return h instanceof L?F.areStreamlinesCompatible(this._params,h._params):!1};E.load=async function(h,f){const {extent:d,size:k}=h;D.throwIfAborted(f);h=await this._params.loadImagery(d,k[0],k[1],this._params.timeExtent,f);const {vertexData:p,indexData:J}=await this._params.createFlowMesh("Streamlines",this._params.simulationSettings,h,f);return new t(p,J,{color:this._params.color,opacity:this._params.opacity,
size:this._params.size})};E.render=function(h,f,d){({context:h}=h);const {program:k}=d;h.setFaceCullingEnabled(!1);h.setBlendingEnabled(!0);h.setBlendFunction(q.BlendFactor.ONE,q.BlendFactor.ONE_MINUS_SRC_ALPHA);h.useProgram(k);k.setUniform1f("u_time",f.time);k.setUniform1f("u_trailLength",this._params.trailLength);k.setUniform1f("u_flowSpeed",this._params.flowSpeed);k.setUniform1f("u_featheringSize",this._params.featheringSize);k.setUniform1f("u_featheringOffset",this._params.featheringOffset);k.setUniform1f("u_introFade",
this._params.introFade?1:0);k.setUniform1f("u_fadeToZero",this._params.fadeToZero?1:0);k.setUniform1f("u_decayRate",this._params.decayRate);k.setUniformMatrix3fv("u_dvsMat3",f.dvsMat3);k.setUniformMatrix3fv("u_displayViewMat3",f.displayViewMat3);F.setUniforms(k,"color","vec4",this._params.color);F.setUniforms(k,"opacity","float",this._params.opacity);F.setUniforms(k,"size","float",this._params.size);h.bindVAO(d.vertexArray);h.drawElements(q.PrimitiveType.TRIANGLES,d.indexCount,q.DataType.UNSIGNED_INT,
0)};u._createClass(L,[{key:"animated",get:function(){return 0<this._params.flowSpeed}}]);return L}();const B=new Map;B.set("a_positionAndSide",0);B.set("a_timeInfo",1);B.set("a_extrude",2);B.set("a_speed",3);const G={geometry:[new x.VertexElementDescriptor("a_positionAndSide",3,q.DataType.FLOAT,0,36),new x.VertexElementDescriptor("a_timeInfo",3,q.DataType.FLOAT,12,36),new x.VertexElementDescriptor("a_extrude",2,q.DataType.FLOAT,24,36),new x.VertexElementDescriptor("a_speed",1,q.DataType.FLOAT,32,
36)]},w={vsPath:"raster/flow/streamlines",fsPath:"raster/flow/streamlines",attributes:B};let t=function(){function L(h,f,d){this._vertexData=h;this._indexData=f;this._values=d}var E=L.prototype;E.attach=function(h){var {context:f}=h,d=m.BufferObject.createVertex(f,q.Usage.STATIC_DRAW,this._vertexData);const k=m.BufferObject.createIndex(f,q.Usage.STATIC_DRAW,this._indexData);f=new A.VertexArrayObject(f,B,G,{geometry:d},k);d=[];"ramp"===this._values.color.kind&&d.push("vvColor");"ramp"===this._values.opacity.kind&&
d.push("vvOpacity");"ramp"===this._values.size.kind&&d.push("vvSize");h=h.painter.materialManager.getProgram(w,d);this.vertexArray=f;this.program=h;this.indexCount=this._indexData.length;this._indexData=this._vertexData=null};E.detach=function(){this.vertexArray.dispose()};u._createClass(L,[{key:"ready",get:function(){return this.program.compiled}}]);return L}();return I})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),
function(u,D,F,m,q,A,x,I,B,G){function w(a,c){const e=E(c.data,c.width,c.height,a.smoothing);return a.interpolate?(n,b)=>{const l=Math.floor(n),r=Math.floor(b);if(0>l||l>=c.width||0>r||r>=c.height)return[0,0];n-=l;b-=r;const y=l<c.width-1?l+1:l,z=r<c.height-1?r+1:r;return[(e[2*(r*c.width+l)]*(1-b)+e[2*(z*c.width+l)]*b)*(1-n)+(e[2*(r*c.width+y)]*(1-b)+e[2*(z*c.width+y)]*b)*n,(e[2*(r*c.width+l)+1]*(1-b)+e[2*(z*c.width+l)+1]*b)*(1-n)+(e[2*(r*c.width+y)+1]*(1-b)+e[2*(z*c.width+y)+1]*b)*n]}:(n,b)=>{n=
Math.round(n);b=Math.round(b);return 0>n||n>=c.width||0>b||b>=c.height?[0,0]:[e[2*(b*c.width+n)],e[2*(b*c.width+n)+1]]}}function t(a,c,e,n,b,l,r,y,z){const O=[];let Q=0,[v,H]=c(e,n);v*=a.velocityScale;H*=a.velocityScale;O.push({x:e,y:n,t:Q,speed:Math.sqrt(v*v+H*H)});for(let T=0;T<a.verticesPerLine;T++){let [X,ba]=c(e,n);X*=a.velocityScale;ba*=a.velocityScale;const Y=Math.sqrt(X*X+ba*ba);if(Y<a.minSpeedThreshold)break;const g=X/Y,C=ba/Y;e+=g*a.segmentLength;n+=C*a.segmentLength;Q+=a.segmentLength/
Y;if(Math.acos(g*M+C*R)>a.maxTurnAngle)break;if(a.collisions){var M=Math.round(e*z);var R=Math.round(n*z);if(0>M||M>r-1||0>R||R>y-1)break;const K=l[R*r+M];if(-1!==K&&K!==b)break;l[R*r+M]=b}O.push({x:e,y:n,t:Q,speed:Y});M=g;R=C}return O}function L(a,c,e,n){const b=[],l=new I,r=1/Math.max(a.lineCollisionWidth,1),y=Math.round(e*r),z=Math.round(n*r),O=new Int32Array(y*z);for(var Q=0;Q<O.length;Q++)O[Q]=-1;Q=[];for(let v=0;v<n;v+=a.lineSpacing)for(let H=0;H<e;H+=a.lineSpacing)Q.push({x:H,y:v,sort:l.getFloat()});
Q.sort((v,H)=>v.sort-H.sort);for(const {x:v,y:H}of Q)l.getFloat()<a.density&&(e=t(a,c,v,H,b.length,O,y,z,r),2>e.length||b.push(e));return b}function E(a,c,e,n){if(0===n)return a;const b=Math.round(3*n),l=Array(2*b+1);var r=0;for(var y=-b;y<=b;y++){var z=Math.exp(-y*y/(n*n));l[y+b]=z;r+=z}for(n=-b;n<=b;n++)l[n+b]/=r;r=new Float32Array(a.length);for(n=0;n<e;n++)for(y=0;y<c;y++){var O=z=0;for(var Q=-b;Q<=b;Q++)if(!(0>y+Q||y+Q>=c)){var v=l[Q+b];z+=v*a[2*(n*c+(y+Q))];O+=v*a[2*(n*c+(y+Q))+1]}r[2*(n*c+y)]=
z;r[2*(n*c+y)+1]=O}a=new Float32Array(a.length);for(n=0;n<c;n++)for(y=0;y<e;y++){O=z=0;for(Q=-b;Q<=b;Q++)0>y+Q||y+Q>=e||(v=l[Q+b],z+=v*r[2*((y+Q)*c+n)],O+=v*r[2*((y+Q)*c+n)+1]);a[2*(y*c+n)]=z;a[2*(y*c+n)+1]=O}return a}function h(a,c){const e=new I;var n=a.reduce((y,z)=>y+z.length,0);n=new Float32Array(4*n);const b=Array(a.length);let l=0,r=0;for(const y of a){a=l;for(const z of y)n[4*l]=z.x,n[4*l+1]=z.y,n[4*l+2]=z.t,n[4*l+3]=z.speed,l++;b[r++]={startVertex:a,numberOfVertices:y.length,totalTime:y[y.length-
1].t,timeSeed:c?e.getFloat():0}}return{lineVertices:n,lineDescriptors:b}}function f(a,c){function e(M,R,T,X,ba,Y,g,C){const K=9*z;let N=0;y[K+N++]=M;y[K+N++]=R;y[K+N++]=1;y[K+N++]=T;y[K+N++]=Y;y[K+N++]=g;y[K+N++]=X/2;y[K+N++]=ba/2;y[K+N++]=C;z++;y[K+N++]=M;y[K+N++]=R;y[K+N++]=-1;y[K+N++]=T;y[K+N++]=Y;y[K+N++]=g;y[K+N++]=-X/2;y[K+N++]=-ba/2;y[K+N++]=C;z++}const {lineVertices:n,lineDescriptors:b}=a;var l=a=0;for(var r of b)a+=2*r.numberOfVertices,l+=6*(r.numberOfVertices-1);const y=new Float32Array(9*
a);r=new Uint32Array(l);let z=0;a=0;for(const M of b){const {totalTime:R,timeSeed:T}=M;let X=l=null,ba=null;var O=null,Q=null,v=null;for(let Y=0;Y<M.numberOfVertices;Y++){O=n[4*(M.startVertex+Y)];const g=n[4*(M.startVertex+Y)+1],C=n[4*(M.startVertex+Y)+2],K=n[4*(M.startVertex+Y)+3];let N=null,U=null;var H=null;let P=null;0<Y&&(N=O-l,U=g-X,H=Math.sqrt(N*N+U*U),N/=H,U/=H,1<Y?(Q=N+Q,v=U+v,H=Math.sqrt(Q*Q+v*v),Q/=H,v/=H,H=Math.min(1/(Q*N+v*U),c),Q*=H,v*=H,H=-v,P=Q):(H=-U,P=N),null!==H&&null!==P&&(e(l,
X,ba,H,P,R,T,K),r[a++]=z-2,r[a++]=z,r[a++]=z-1,r[a++]=z,r[a++]=z+1,r[a++]=z-1));l=O;X=g;ba=C;Q=N;v=U;O=K}e(l,X,ba,-v,Q,R,T,O)}return{vertexData:y,indexData:r}}function d(a){function c(W,S){var Z=C+N,aa=K+U,ca=Math.sqrt(Z*Z+aa*aa);Z/=ca;aa/=ca;var ea=C*Z+K*aa,da=N+P,ia=U+V;ca=Math.sqrt(da*da+ia*ia);da/=ca;ia/=ca;var fa=N*da+U*ia;ca=H;var ja=M,ha=R,la=T;aa=-(aa/ea);Z/=ea;ea=X;var na=ba,oa=Y,pa=g;ia=-(ia/fa);da/=fa;fa=16*Q;let ma=0;for(const ta of[1,2])for(const qa of[1,2,3,4])z[fa+ma++]=ca,z[fa+ma++]=
ja,z[fa+ma++]=ha,z[fa+ma++]=la,z[fa+ma++]=ea,z[fa+ma++]=na,z[fa+ma++]=oa,z[fa+ma++]=pa,z[fa+ma++]=ta,z[fa+ma++]=qa,z[fa+ma++]=W,z[fa+ma++]=S,z[fa+ma++]=aa/2,z[fa+ma++]=Z/2,z[fa+ma++]=ia/2,z[fa+ma++]=da/2,Q++;O[v++]=Q-8;O[v++]=Q-7;O[v++]=Q-6;O[v++]=Q-7;O[v++]=Q-5;O[v++]=Q-6;O[v++]=Q-4;O[v++]=Q-3;O[v++]=Q-2;O[v++]=Q-3;O[v++]=Q-1;O[v++]=Q-2}function e(W,S,Z,aa,ca,ea){C=N;K=U;N=P;U=V;null==C&&null==K&&(C=N,K=U);if(null!=X&&null!=ba){P=W-X;V=S-ba;const da=Math.sqrt(P*P+V*V);P/=da;V/=da}null!=C&&null!=
K&&c(ca,ea);H=X;M=ba;R=Y;T=g;X=W;ba=S;Y=Z;g=aa}function n(W,S){C=N;K=U;N=P;U=V;null==C&&null==K&&(C=N,K=U);null!=C&&null!=K&&c(W,S)}const {lineVertices:b,lineDescriptors:l}=a;let r=a=0;for(var y of l){const W=y.numberOfVertices-1;a+=8*W;r+=12*W}const z=new Float32Array(16*a),O=new Uint32Array(r);let Q=0,v=0,H,M,R,T,X,ba,Y,g,C,K,N,U,P,V;for(const W of l){V=P=U=N=K=C=g=Y=ba=X=T=R=M=H=null;const {totalTime:S,timeSeed:Z}=W;for(y=0;y<W.numberOfVertices;y++)e(b[4*(W.startVertex+y)],b[4*(W.startVertex+y)+
1],b[4*(W.startVertex+y)+2],b[4*(W.startVertex+y)+3],S,Z);n(S,Z)}return{vertexData:z,indexData:O}}function k(a,c){const e=c.pixels,{width:n,height:b}=c,l=new Float32Array(n*b*2),r=c.mask||new Uint8Array(n*b*2);c.mask||r.fill(255);if("vector-uv"===a)for(a=0;a<n*b;a++)l[2*a]=e[0][a],l[2*a+1]=-e[1][a];else if("vector-magdir"===a)for(a=0;a<n*b;a++){c=e[0][a];const y=q.deg2rad(e[1][a]),z=Math.sin(y-Math.PI/2);l[2*a]=Math.cos(y-Math.PI/2)*c;l[2*a+1]=z*c}return{data:l,mask:r,width:n,height:b}}async function p(a,
c,e,n,b,l){const r={requestProjectedLocalDirections:!0,signal:l};A.isSome(b)&&(r.timeExtent=b);if("imagery"===a.type)return await a.load({signal:l}),b=a.rasterInfo.dataType,a=await a.fetchImage(c,e,n,r),!a||A.isNone(a.pixelData)||A.isNone(a.pixelData.pixelBlock)?{data:new Float32Array(e*n*2),mask:new Uint8Array(e*n),width:e,height:n}:k(b,a.pixelData.pixelBlock);await a.load({signal:l});b=a.rasterInfo.dataType;a=await a.fetchPixels(c,e,n,r);return!a||A.isNone(a.pixelBlock)?{data:new Float32Array(e*
n*2),mask:new Uint8Array(e*n),width:e,height:n}:k(b,a.pixelBlock)}const J=m.getLogger("esri.views.2d.engine.flow.dataUtils");u.createAnimatedLinesData=h;u.createFlowMesh=async function(a,c,e,n){const b=performance.now();var l=w(c,e);const r=performance.now();e=L(c,l,e.width,e.height);c=performance.now();l=h(e,!0);e=performance.now();a="Streamlines"===a?f(l,10):d(l);l=performance.now();F("esri-2d-profiler")&&(J.info("I.1","_createFlowFieldFromData (ms)",Math.round(r-b)),J.info("I.2","_getStreamlines (ms)",
Math.round(c-r)),J.info("I.3","createAnimatedLinesData (ms)",Math.round(e-c)),J.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(l-e)),J.info("I.5","createFlowMesh (ms)",Math.round(l-b)),J.info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();x.throwIfAborted(n);return a};u.createParticlesMesh=d;u.createStreamlinesMesh=f;u.loadImagery=async function(a,c,e,n,b,l){const r=performance.now();var y=B.getInfo(c.spatialReference);
if(!y)return e=await p(a,c,e,n,b,l),F("esri-2d-profiler")&&J.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-r)),F("esri-2d-profiler")&&J.info("I.9","Number of parts",1),e;const [z,O]=y.valid,Q=Math.ceil(c.width/(O-z)),v=c.width/Q,H=Math.round(e/Q);let M=c.xmin;const R=[];y=performance.now();for(let T=0;T<Q;T++){const X=new G({xmin:M,xmax:M+v,ymin:c.ymin,ymax:c.ymax,spatialReference:c.spatialReference});R.push(p(a,X,H,n,b,l));M+=v}a=await Promise.all(R);F("esri-2d-profiler")&&
J.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-y));F("esri-2d-profiler")&&J.info("I.9","Number of parts",a.length);n={data:new Float32Array(e*n*2),mask:new Uint8Array(e*n),width:e,height:n};c=0;for(const T of a){for(a=0;a<T.height;a++)for(b=0;b<T.width;b++)c+b>=e||(n.data[2*(a*e+c+b)]=T.data[2*(a*T.width+b)],n.data[2*(a*e+c+b)+1]=T.data[2*(a*T.width+b)+1],n.mask[a*e+c+b]=T.mask[a*T.width+b]);c+=T.width}F("esri-2d-profiler")&&J.info("I.10","loadImagery, general exit (ms)",
Math.round(performance.now()-r));return n};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/flow/FlowContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./BrushFlow","../webgl/enums","../webgl/WGLContainer"],function(u,D,F,m){return function(q){function A(){var I=x.apply(this,arguments);I.flowStyle=null;return I}u._inherits(A,q);var x=u._createSuper(A);q=A.prototype;q.doRender=function(I){u._get(u._getPrototypeOf(A.prototype),"doRender",
this).call(this,I)};q.prepareRenderPasses=function(I){const B=I.registerRenderPass({name:"flow",brushes:[D],target:()=>this.children,drawPhase:F.WGLDrawPhase.MAP});return[...u._get(u._getPrototypeOf(A.prototype),"prepareRenderPasses",this).call(this,I),B]};u._createClass(A,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return A}(m)})},"esri/views/2d/engine/flow/BrushFlow":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","../../../../chunks/mat3f32",
"../webgl/brushes/WGLBrush","../../../webgl/enums"],function(u,D,F,m,q){return function(A){function x(){var B=I.apply(this,arguments);B._visualState={time:0,dvsMat3:F.create(),displayViewMat3:F.create()};return B}u._inherits(x,A);var I=u._createSuper(x);A=x.prototype;A.dispose=function(){};A.prepareState=function(B){({context:B}=B);B.setColorMask(!0,!0,!0,!0);B.setStencilFunction(q.CompareFunction.EQUAL,0,255)};A.draw=function(B,G){const {requestRender:w,allowDelayedRender:t}=B,{displayData:L}=G;
if(!D.isNone(L)&&("loaded"===L.state.name&&L.attach(B),"attached"===L.state.name)){var E=L.state.resources;t&&!E.ready&&D.isSome(w)?w():(this._visualState.time=B.time/1E3,this._visualState.dvsMat3=G.transforms.dvs,this._visualState.displayViewMat3=B.state.displayViewMat3,L.flowStyle.render(B,this._visualState,E),L.flowStyle.animated&&D.isSome(w)&&w())}};return u._createClass(x)}(m)})},"esri/views/2d/engine/flow/FlowStrategy":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../core/Accessor ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Point ./FlowDisplayData ./FlowDisplayObject ../../../../geometry/Extent".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w,t,L,E,h,f,d){function k(p,J){const a=new E({x:(p.xmax+p.xmin)/2,y:(p.ymax+p.ymin)/2,spatialReference:p.spatialReference});var c=p.xmax-p.xmin;const e=p.ymax-p.ymin,n=Math.abs(Math.cos(A.deg2rad(J))),b=Math.abs(Math.sin(A.deg2rad(J)));J=n*c+b*e;c=b*c+n*e;p=new d({xmin:a.x-J/2,ymin:a.y-c/2,xmax:a.x+J/2,ymax:a.y+c/2,spatialReference:p.spatialReference});p.centerAt(a);return p}F=function(p){function J(c){c=a.call(this,c);c._flowDisplayObject=new f.FlowDisplayObject;c._loading=
null;return c}u._inherits(J,p);var a=u._createSuper(J);p=J.prototype;p.initialize=function(){this.flowContainer.addChild(this._flowDisplayObject)};p.destroy=function(){this._clear();this.flowContainer.removeAllChildren()};p.update=function(c){var {flowStyle:e}=this.flowContainer;if(x.isNone(e))this._clear();else{var {extent:n,rotation:b,resolution:l,pixelRatio:r}=c.state;c=k(n,b);c.expand(1.15);e=new h(e,c,[Math.round((c.xmax-c.xmin)/l),Math.round((c.ymax-c.ymin)/l)],r);if(x.isSome(this._loading)){if(this._loading.update(e))return;
this._loading.detach();this._loading=null}if(x.isNone(this._flowDisplayObject.displayData)||!this._flowDisplayObject.displayData.update(e))e.load().then(()=>{this._flowDisplayObject.clear();this._flowDisplayObject.displayData=this._loading;this._loading=null},y=>{I.isAbortError(y)||(q.getLogger(this.declaredClass).error("A resource failed to load.",y),this._loading=null)}),this._loading=e}};p._clear=function(){this._flowDisplayObject.clear();x.isSome(this._loading)&&(this._loading.detach(),this._loading=
null)};u._createClass(J,[{key:"updating",get:function(){return null!=this._loading}}]);return J}(m);D.__decorate([B.property()],F.prototype,"_loading",void 0);D.__decorate([B.property()],F.prototype,"flowContainer",void 0);D.__decorate([B.property()],F.prototype,"updating",null);return F=D.__decorate([L.subclass("esri.views.2d.engine.flow.FlowStrategy")],F)})},"esri/views/2d/engine/flow/FlowDisplayData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/Logger"],function(u,
D){return function(){function F(q,A,x,I){this.state={name:"created"};this.flowStyle=q;this.extent=A;this.size=x;this.pixelRatio=I}var m=F.prototype;m.load=async function(){const q=new AbortController;this.state={name:"loading",abortController:q};this.state={name:"loaded",resources:await this.flowStyle.load({extent:this.extent,size:this.size,pixelRatio:this.pixelRatio},q.signal)}};m.attach=function(q){if("loaded"!==this.state.name)D.getLogger("esri.views.2d.engine.flow.FlowDisplayData").error("Only loaded resources can be attached.");
else{var A=this.state.resources;A.attach(q);this.state={name:"attached",resources:A}}};m.detach=function(){"loading"===this.state.name?(this.state.abortController.abort(),this.state={name:"detached"}):"attached"===this.state.name&&(this.state.resources.detach(),this.state={name:"detached"})};m.update=function(q){if(!this.flowStyle.isCompatible(q.flowStyle)||!this.extent.equals(q.extent)||this.size[0]!==q.size[0]||this.size[1]!==q.size[1]||this.pixelRatio!==q.pixelRatio)return!1;this.flowStyle=q.flowStyle;
return!0};return u._createClass(F)}()})},"esri/views/2d/engine/flow/FlowDisplayObject":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/mathUtils ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../DisplayObject".split(" "),function(u,D,F,m,q,A,x){x=function(I){function B(){var w=G.apply(this,arguments);w._displayData=null;return w}D._inherits(B,I);var G=D._createSuper(B);I=B.prototype;I.clear=function(){m.isSome(this._displayData)&&
(this._displayData.detach(),this._displayData=null,this.requestRender())};I.setTransform=function(w){var {displayData:t}=this;if(!m.isNone(t)){var L=[0,0];w.toScreen(L,[t.extent.xmin,t.extent.ymax]);t=(t.extent.xmax-t.extent.xmin)/t.size[0]/w.resolution;var E=F.deg2rad(w.rotation),{dvs:h}=this.transforms;q.fromTranslation(h,[-1,1,0]);q.scale(h,h,[2/(w.size[0]*w.pixelRatio),-2/(w.size[1]*w.pixelRatio),1]);q.translate(h,h,[L[0],L[1],0]);q.rotate(h,h,E);q.scale(h,h,[t*w.pixelRatio,t*w.pixelRatio,1])}};
I._createTransforms=function(){return{dvs:A.create()}};D._createClass(B,[{key:"displayData",get:function(){return this._displayData},set:function(w){this._displayData=w;this.requestRender()}}]);return B}(x.DisplayObject);u.FlowDisplayObject=x;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../engine/Container ../support/HighlightOptions ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w,t,L,E,h,f,d){const k=m.ofType({key:"type",base:null,typeMap:{rect:h,path:d,geometry:f}});u.LayerView2DMixin=p=>{p=function(J){function a(){var e=c.apply(this,arguments);e.attached=!1;e.clips=new k;e.lastUpdateId=-1;e.moving=!1;e.updateRequested=!1;e.visibleAtCurrentScale=!1;e.highlightOptions=null;return e}D._inherits(a,J);var c=D._createSuper(a);J=a.prototype;J.initialize=function(){const e=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&e&&!this.spatialReferenceSupported?
this.addResolvingPromise(Promise.reject(new A("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new L.Container),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([x.watch(()=>this.suspended,n=>{this.container&&(this.container.visible=!n);this.view&&!n&&this.updateRequested&&this.view.requestUpdate()},x.syncAndInitial),
x.watch(()=>this.layer?.opacity??1,n=>{this.container&&(this.container.opacity=n)},x.syncAndInitial),x.watch(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",n=>{this.container&&(this.container.blendMode=n)},x.syncAndInitial),x.watch(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,n=>{this.container&&(this.container.effect=n)},x.syncAndInitial),x.watch(()=>this.highlightOptions,n=>this.container.highlightOptions=n,x.syncAndInitial),x.on(()=>this.clips,"change",()=>
{this.container&&(this.container.clips=this.clips)},x.syncAndInitial),x.watch(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:n})=>{n=null!=n?this.isVisibleAtScale(n):!1;n!==this.visibleAtCurrentScale&&this._set("visibleAtCurrentScale",n)},x.syncAndInitial)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(n=>{n===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},
()=>{}))};J.destroy=function(){this.processDetach();this.updateRequested=!1};J.processAttach=function(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())};J.processDetach=function(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)};J.isVisibleAtScale=function(e){const n=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!n)return!0;
const {minScale:b,maxScale:l}=n;return(0===b||e<=b)&&(0===l||e>=l)};J.requestUpdate=function(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())};J.processUpdate=function(e){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e)))};J.hitTest=function(e,n){return Promise.resolve(null)};J.supportsSpatialReference=function(e){return!0};
J.canResume=function(){return this.spatialReferenceSupported?D._get(D._getPrototypeOf(a.prototype),"canResume",this).call(this)?this.visibleAtCurrentScale:!1:!1};J.getSuspendInfo=function(){const e=D._get(D._getPrototypeOf(a.prototype),"getSuspendInfo",this).call(this),n=!this.spatialReferenceSupported,b=this.visibleAtCurrentScale;n&&(e.spatialReferenceNotSupported=n);b&&(e.outsideScaleRange=b);return e};J.addAttachHandles=function(e){this.addHandles(e,"attach")};D._createClass(a,[{key:"spatialReferenceSupported",
get:function(){const e=this.view?.spatialReference;return null==e||this.supportsSpatialReference(e)}},{key:"updating",get:function(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this.updatingHandles?.updating)}}]);return a}(p);F.__decorate([I.property()],p.prototype,"attached",void 0);F.__decorate([I.property({type:k,set(J){J=q.referenceSetter(J,this._get("clips"),k);this._set("clips",J)}})],p.prototype,"clips",void 0);F.__decorate([I.property()],
p.prototype,"container",void 0);F.__decorate([I.property()],p.prototype,"moving",void 0);F.__decorate([I.property({readOnly:!0})],p.prototype,"spatialReferenceSupported",null);F.__decorate([I.property({readOnly:!0})],p.prototype,"updateParameters",void 0);F.__decorate([I.property()],p.prototype,"updateRequested",void 0);F.__decorate([I.property()],p.prototype,"updating",null);F.__decorate([I.property()],p.prototype,"view",void 0);F.__decorate([I.property({readOnly:!0})],p.prototype,"visibleAtCurrentScale",
void 0);F.__decorate([I.property({type:E})],p.prototype,"highlightOptions",void 0);return p=F.__decorate([t.subclass("esri.views.2d.layers.LayerView2D")],p)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),
function(u,D,F,m,q,A,x,I){var B;m=B=function(G){function w(L){L=t.call(this,L);L.type="rect";L.left=null;L.right=null;L.top=null;L.bottom=null;return L}u._inherits(w,G);var t=u._createSuper(w);G=w.prototype;G.clone=function(){return new B({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};G.commitVersionProperties=function(){this.commitProperty("left");this.commitProperty("right");this.commitProperty("top");this.commitProperty("bottom")};return u._createClass(w)}(I);D.__decorate([F.property({type:[Number,
String],json:{write:!0}})],m.prototype,"left",void 0);D.__decorate([F.property({type:[Number,String],json:{write:!0}})],m.prototype,"right",void 0);D.__decorate([F.property({type:[Number,String],json:{write:!0}})],m.prototype,"top",void 0);D.__decorate([F.property({type:[Number,String],json:{write:!0}})],m.prototype,"bottom",void 0);return m=B=D.__decorate([x.subclass("esri.views.layers.support.ClipRect")],m)})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(u,D,F,m,q,A,x,I){F=function(B){function G(){return w.apply(this,arguments)}u._inherits(G,B);var w=u._createSuper(G);u._createClass(G,[{key:"version",get:function(){this.commitVersionProperties();return(this._get("version")||0)+1}}]);return G}(F.JSONSupport);D.__decorate([m.property({readOnly:!0})],F.prototype,"version",null);return F=D.__decorate([I.subclass("esri.views.layers.support.ClipArea")],F)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea ../../../geometry/Extent ../../../geometry/Polygon".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w,t,L){var E;F={base:B,key:"type",typeMap:{extent:t,polygon:L}};w=E=function(h){function f(k){k=d.call(this,k);k.type="geometry";k.geometry=null;return k}u._inherits(f,h);var d=u._createSuper(f);h=f.prototype;h.clone=function(){return new E({geometry:this.geometry?.clone()??null})};h.commitVersionProperties=function(){this.commitProperty("geometry")};return u._createClass(f)}(w);D.__decorate([m.property({types:F,json:{read:G.fromJSON,write:!0}})],w.prototype,"geometry",
void 0);return w=E=D.__decorate([I.subclass("esri.views.layers.support.Geometry")],w)})},"esri/views/layers/support/Path":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),function(u,D,F,m,q,A,x,I){m=function(B){function G(t){t=w.call(this,t);t.type="path";
t.path=[];return t}u._inherits(G,B);var w=u._createSuper(G);G.prototype.commitVersionProperties=function(){this.commitProperty("path")};return u._createClass(G)}(I);D.__decorate([F.property({type:[[[Number]]],json:{write:!0}})],m.prototype,"path",void 0);return m=D.__decorate([x.subclass("esri.views.layers.support.Path")],m)})},"esri/views/2d/layers/imagery/ImageryTileView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/maybe ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../engine/imagery/RasterTileContainer ./BaseImageryTileSubView2D ../support/util".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w){q=function(t){function L(){var h=E.apply(this,arguments);h.type="raster";return h}u._inherits(L,t);var E=u._createSuper(L);t=L.prototype;t.attach=function(){u._get(u._getPrototypeOf(L.prototype),"attach",this).call(this);this.container=new B.RasterTileContainer(this._tileInfoView);this.container.isCustomTilingScheme=this._isCustomTilingScheme;this.updateRasterFunctionParameters()};t.detach=function(){u._get(u._getPrototypeOf(L.prototype),"detach",this).call(this);this.container.removeAllChildren();
this.container=null};t.canUseWebGLForProcessing=function(){return this.useWebGLForProcessing&&this.layer.symbolizer.canRenderInWebGL&&!("majority"===this.layer.interpolation&&w.canUseMajorityInterpolationOnDataSource(this.layer))};t.fetchTile=function(h,f){return this.layer.fetchTile(h.level,h.row,h.col,f)};t.updateRasterFunctionParameters=function(){const {raster:h,type:f}=this.layer,{container:d}=this;if("Function"!==h.datasetFormat||"wcs"===f)d.rasterFunctionChain=null,d.children.forEach(b=>{({bitmap:b}=
b);b&&(b.suspended=!0,b.processed=!1,b.projected&&(b.invalidateTexture(),b.rasterTexture=null))}),this._rasterFunctionState="na";else{var k=this._rasterFunctionState,{rasterFunction:p,primaryRasters:J}=h,a=p.supportsGPU&&(!J||1>=J.rasters.length),c=a?p.flatWebGLFunctionChain:null,{renderer:e}=this.layer;a=!a||!c?.functions.length||"raster-stretch"===e.type&&e.dynamicRangeAdjustment||!this.canUseWebGLForProcessing();d.rasterFunctionChain=a?null:c;var n=null==p?"na":d.rasterFunctionChain?"gpu":"cpu";
d.children.forEach(b=>{({bitmap:b}=b);b&&(b.suspended=k!==n,b.processed=!1,b.processedTexture=null)});this._rasterFunctionState=n}};t.updateTileSource=async function(h,f){const d=this._getBandIds(),k=this._getLayerInterpolation(),p=this.canUseWebGLForProcessing(),{source:J,globalSymbolizerParams:a,suspended:c,coords:e,resolution:n}=f;f=this.layerView.hasTilingEffects?a:f.symbolizerParams;({bitmap:h}=h);[h.x,h.y]=e;h.resolution=n;if(J&&F.isSome(J)&&F.isSome(J.pixelBlock)){var b={extent:J.extent,pixelBlock:J.pixelBlock};
h.rawPixelData=b;p?(h.source=J.pixelBlock,h.isRendereredSource=!1):(b=await this.layer.applyRenderer(b,"stretch"===a?.type?a:void 0),h.source=b,h.isRendereredSource=!0);h.symbolizerParameters=p?f:null;p?h.transformGrid||(h.transformGrid=J.transformGrid):h.transformGrid=null}else b=this.createEmptyTilePixelBlock(),h.source=b,h.symbolizerParameters=p?f:null,h.transformGrid=null;h.bandIds=p?d:null;h.width=this._tileInfoView.tileInfo.size[0];h.height=this._tileInfoView.tileInfo.size[1];h.interpolation=
k;h.suspended=c;h.invalidateTexture()};t.updateTileSymbolizerParameters=async function(h,f){const {local:d,global:k}=f;f=this._getBandIds();const p=this._getLayerInterpolation(),J=this.canUseWebGLForProcessing();({bitmap:h}=h);const {rawPixelData:a}=h;!J&&F.isSome(a)?(h.source=await this.layer.applyRenderer(a,"stretch"===k?.type?k:void 0),h.isRendereredSource=!0):(h.isRendereredSource&&F.isSome(a)&&(h.source=a.pixelBlock),h.isRendereredSource=!1);h.symbolizerParameters=J?this.layerView.hasTilingEffects?
k:d:null;h.bandIds=J?f:null;h.interpolation=p;h.suspended=!1};t._getLayerInterpolation=function(){var h=this.layer.renderer.type;if("raster-colormap"===h||"unique-value"===h||"class-breaks"===h)return"nearest";({interpolation:h}=this.layer);const {renderer:f}=this.layer;return"raster-stretch"===f.type&&null!=f.colorRamp?"bilinear"===h||"cubic"===h?"bilinear":"nearest":h};return u._createClass(L)}(G.BaseImageryTileSubView2D);D.__decorate([m.property()],q.prototype,"container",void 0);D.__decorate([m.property()],
q.prototype,"layer",void 0);D.__decorate([m.property()],q.prototype,"type",void 0);return q=D.__decorate([I.subclass("esri.views.2d.layers.imagery.ImageryTileView2D")],q)})},"esri/views/2d/engine/imagery/RasterTileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry/support/aaBoundingRect ../../viewpointUtils ./BrushRasterBitmap ./RasterTile ../webgl/enums ../webgl/TileContainer".split(" "),function(u,D,F,m,q,A,x,I){I=function(B){function G(){var t=
w.apply(this,arguments);t.isCustomTilingScheme=!1;return t}D._inherits(G,B);var w=D._createSuper(G);B=G.prototype;B.createTile=function(t){const L=this._getTileBounds(t),[E,h]=this._tileInfoView.tileInfo.size,f=this._tileInfoView.getTileResolution(t.level);return new A.RasterTile(t,f,L[0],L[3],E,h)};B.prepareRenderPasses=function(t){const L=t.registerRenderPass({name:"imagery (tile)",brushes:[q],target:()=>this.children.map(E=>E.bitmap),drawPhase:x.WGLDrawPhase.MAP});return[...D._get(D._getPrototypeOf(G.prototype),
"prepareRenderPasses",this).call(this,t),L]};B.doRender=function(t){if(this.visible&&t.drawPhase===x.WGLDrawPhase.MAP){var {rasterFunctionChain:L}=this;if(L){var [E,h]=this._tileInfoView.tileInfo.size;t.renderPass="raster";t.rasterFunction={name:"Reproject",parameters:{targetImageSize:[E,h],requireBilinear:L.hasSurfaceFunction},pixelType:"f32",id:0,isNoopProcess:!1};D._get(D._getPrototypeOf(G.prototype),"doRender",this).call(this,t);if(L?.functions.length){const {functions:f,hasBranches:d}=L;for(L=
0;L<f.length;L++){const k=f[L];"Constant"!==k.name&&"Identity"!==k.name&&(t.renderPass="raster",t.rasterFunction=k,t.hasBranches=d,D._get(D._getPrototypeOf(G.prototype),"doRender",this).call(this,t))}}t.rasterFunction=null;t.renderPass="bitmap"}else t.renderPass="raster-bitmap";D._get(D._getPrototypeOf(G.prototype),"doRender",this).call(this,t)}};B._getTileBounds=function(t){const L=this._tileInfoView.getTileBounds(F.create(),t);if(this.isCustomTilingScheme&&t.world){var {tileInfo:E}=this._tileInfoView,
h=m.getWorldWidth(E.spatialReference);if(h){var f=E.lodAt(t.level);if(!f)return L;({resolution:f}=f);E=(h=h/f%E.size[0])?(E.size[0]-h)*f:0;L[0]-=E*t.world;L[2]-=E*t.world}}return L};return D._createClass(G)}(I);u.RasterTileContainer=I;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/BrushRasterBitmap":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./RasterBitmap ./colorizer/rasterColorizer ./processor/rasterProcessor ../webgl/definitions ../webgl/VertexStream ../webgl/brushes/WGLBrush ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/rasterUtils".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w){return function(t){function L(){var h=E.apply(this,arguments);h.name="raster";h._quad=null;h._rendererUniformInfos=new Map;h._fbo=null;return h}u._inherits(L,t);var E=u._createSuper(L);t=L.prototype;t.dispose=function(){D.disposeMaybe(this._quad);D.disposeMaybe(this._fbo)};t.prepareState=function(h){const {context:f,renderPass:d}=h;h="raster"===d;f.setBlendingEnabled(!h);f.setBlendFunctionSeparate(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA,B.BlendFactor.ONE,
B.BlendFactor.ONE_MINUS_SRC_ALPHA);f.setColorMask(!0,!0,!0,!0);f.setStencilWriteMask(0);f.setStencilTestEnabled(!h)};t.draw=function(h,f){if(F.hasSource(f)&&!f.suspended){var {renderPass:d}=h;if("raster-bitmap"===d)this._drawBitmap(h,f);else{if("raster"===d)return this._process(h,f);this._drawBitmap(h,f,!0)}}};t._process=function(h,f){var {rasterFunction:d}=h;d="Reproject"===d.name;if(!(d?f.rasterTexture&&f.projected:f.processed)){var {timeline:k,context:p}=h;k.begin(this.name);var J=p.getBoundFramebufferObject(),
a=p.getViewport();d||(f.processedTexture=D.disposeMaybe(f.processedTexture));p.setStencilFunction(B.CompareFunction.EQUAL,f.stencilRef,255);f.updateTexture(h);this._initQuad(p);var {isStandardRasterTileSize:c,fbo:e}=this._getRasterFBO(p,f.width,f.height);q.process(h,this._quad,e,f);c||e.dispose();p.bindFramebuffer(J);p.setViewport(a.x,a.y,a.width,a.height);k.end(this.name)}};t._drawBitmap=function(h,f,d=!1){const {timeline:k,context:p}=h;k.begin(this.name);p.setStencilFunction(B.CompareFunction.EQUAL,
f.stencilRef,255);f.updateTexture(h);if(d&&!f.processedTexture){f.updateProcessedTexture();if(!f.processedTexture){k.end(this.name);return}f.processed=!0}this._initBitmapCommonUniforms(f);var J=f.symbolizerParameters.type;const a=m.getColorizer(J),{requestRender:c,allowDelayedRender:e}=h,{defines:n,program:b}=a.createProgram(h,f,d);e&&D.isSome(c)&&!b.compiled?c():(p.useProgram(b),J=this._getUniformInfos(J,p,b,n),this._quad||(this._quad=new x(p,[0,0,1,0,0,1,1,1])),a.bindTextureAndUniforms(h,b,f,J,
d),this._quad.draw(),k.end(this.name))};t._initBitmapCommonUniforms=function(h){if(!h.commonUniforms){const f=w.getBasicGridUniforms(1,[0,0]),{transformGrid:d,width:k,height:p}=h,J=w.getCommonUniforms(d,[k,p],[h.source.width,h.source.height],1,!1);h.commonUniforms={...f,...J,u_coordScale:h.coordScale}}};t._getRasterFBO=function(h,f,d){const k=f===A.TILE_SIZE||d===A.TILE_SIZE;return k?(this._fbo||(this._fbo=this._createNewFBO(h,f,d)),{isStandardRasterTileSize:k,fbo:this._fbo}):{isStandardRasterTileSize:k,
fbo:this._createNewFBO(h,f,d)}};t._createNewFBO=function(h,f,d){const k=q.createTexture(h,f,d);return new G.FramebufferObject(h,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.NONE,width:f,height:d},k)};t._initQuad=function(h){this._quad||(this._quad=new x(h,[0,0,1,0,0,1,1,1]))};t._getUniformInfos=function(h,f,d,k){h=0<k.length?h+"-"+k.join("-"):h;if(this._rendererUniformInfos.has(h))return this._rendererUniformInfos.get(h);f=w.getUniformLocationInfos(f,d);this._rendererUniformInfos.set(h,
f);return f};return u._createClass(L)}(I)})},"esri/views/2d/engine/imagery/RasterBitmap":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../layers/support/rasterFunctions/pixelUtils ../DisplayObject ../../../webgl/enums ../../../webgl/rasterUtils".split(" "),function(u,D,F,m,q,A,x,I,B,G){const w={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],
factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};I=function(L){function E(f=null,d=null,k=null){var p=h.call(this);p._textureInvalidated=!0;p._colormapTextureInvalidated=!0;p._rasterTexture=null;p._rasterTextureBandIds=null;p._transformGridTexture=null;p._colormapTexture=null;p._colormap=null;p._supportsBilinearTexture=!0;p._processedTexture=null;p.functionTextures=[];p.projected=!1;p.stencilRef=0;p.coordScale=
[1,1];p._processed=!1;p._symbolizerParameters=null;p.height=null;p.isRendereredSource=!1;p.pixelRatio=1;p.resolution=0;p.rotation=0;p._source=null;p.rawPixelData=null;p._suspended=!1;p._bandIds=null;p._interpolation=null;p._transformGrid=null;p.width=null;p.x=0;p.y=0;p.source=f;p.transformGrid=d;p.interpolation=k;return p}D._inherits(E,L);var h=D._createSuper(E);L=E.prototype;L.destroy=function(){this._disposeTextures()};L.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=
!0,this.requestRender())};L._createTransforms=function(){return{dvs:q.create()}};L.setTransform=function(f){const d=m.identity(this.transforms.dvs),[k,p]=f.toScreenNoRotation([0,0],[this.x,this.y]);var J=this.resolution/this.pixelRatio/f.resolution;const a=J*this.width;J*=this.height;const c=Math.PI*this.rotation/180;m.translate(d,d,A.fromValues(k,p));m.translate(d,d,A.fromValues(a/2,J/2));m.rotate(d,d,-c);m.translate(d,d,A.fromValues(-a/2,-J/2));m.scaleByVec2(d,d,A.fromValues(a,J));m.multiply(this.transforms.dvs,
f.displayViewMat3,d)};L.getTextures=function({forProcessing:f=!1,useProcessedTexture:d=!1}={}){const k=d?this._processedTexture??this._rasterTexture:this._rasterTexture,p=[],J=[];if(!k)return{names:p,textures:J};if(d)return J.push(k),p.push("u_image"),this._colormapTexture&&(J.push(this._colormapTexture),p.push("u_colormap")),{names:p,textures:J};this._transformGridTexture&&(J.push(this._transformGridTexture),p.push("u_transformGrid"));J.push(k);p.push("u_image");this._colormapTexture&&!f&&(J.push(this._colormapTexture),
p.push("u_colormap"));return{names:p,textures:J}};L.onAttach=function(){this.invalidateTexture()};L.onDetach=function(){this.invalidateTexture()};L.updateTexture=function({context:f}){if(this.stage){var d=this._isValidSource(this.source);d&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(f));this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(f),this._rasterTexture&&(d?this.transformGrid&&!this._transformGridTexture&&
(this._transformGridTexture=G.createTransformTexture(f,this.transformGrid)):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}else this._disposeTextures()};L.updateProcessedTexture=function(){const {functionTextures:f}=this;0!==f.length&&(this.processedTexture=f.shift(),f.forEach(d=>d?.dispose()),f.length=0)};L._createOrDestroyRasterTexture=function(f){const d=F.isSome(this.source)?x.extractBands(this.source,this.bandIds):null;if(this._isValidSource(d)){var k=
!this._isBandIdschanged(this.bandIds);if(this._rasterTexture){if(k)return;this._rasterTexture.dispose();this._rasterTexture=this._rasterTextureBandIds=null}this._supportsBilinearTexture=!!f.capabilities.textureFloat?.textureFloatLinear;k=this._getTextureSamplingMethod(this.interpolation);this._rasterTexture=G.createRasterTexture(f,d,k,this.isRendereredSource||!f.capabilities.textureFloat?.textureFloat);this._processed=this.projected=!1;this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}else this._rasterTexture&&
(this._rasterTexture.dispose(),this._rasterTexture=this._rasterTextureBandIds=null)};L._isBandIdschanged=function(f){const d=this._rasterTextureBandIds;return!(null==d&&null==f||d&&f&&d.join("")===f.join(""))};L._isValidSource=function(f){return F.isSome(f)&&0<f.pixels?.length};L._getTextureSamplingMethod=function(f){const {type:d,colormap:k}=this.symbolizerParameters,p="lut"===d||"stretch"===d&&F.isSome(k);return!this._supportsBilinearTexture||p||"bilinear"!==f&&"cubic"!==f?"nearest":"bilinear"};
L._updateColormapTexture=function(f){const d=this._colormap,k=this.symbolizerParameters.colormap;if(!k)this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null;else if(!d)this._colormapTexture=G.createColormapTexture(f,k),this._colormap=k;else if(k.length!==d.length||k.some((p,J)=>p!==d[J]))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=G.createColormapTexture(f,k),this._colormap=k};L._disposeTextures=
function(f=!1){this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null);!f&&this._colormapTexture&&(this._colormapTexture.dispose(),this._colormap=this._colormapTexture=null,this._colormapTextureInvalidated=!0);!f&&this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=this._rasterTexture=null);this._processedTexture&&(this._processedTexture.dispose(),this._processedTexture=null)};D._createClass(E,[{key:"processedTexture",get:function(){return this._processedTexture},
set:function(f){this._processedTexture!==f&&(this._disposeTextures(!0),this._processedTexture=f)}},{key:"rasterTexture",get:function(){return this._rasterTexture},set:function(f){this._rasterTexture!==f&&(this._rasterTexture?.dispose(),this._rasterTexture=f)}},{key:"processed",get:function(){return this._processed},set:function(f){this._processed=f;f||(F.disposeMaybe(this.processedTexture),this.invalidateTexture())}},{key:"symbolizerParameters",get:function(){return this._symbolizerParameters||w},
set:function(f){this._symbolizerParameters!==f&&(this._symbolizerParameters=f,this._colormapTextureInvalidated=!0,this.commonUniforms=null)}},{key:"source",get:function(){return this._source},set:function(f){this._source!==f&&(this._source=f,this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTextureBandIds=this._rasterTexture=null),this.projected=!1,this.invalidateTexture())}},{key:"suspended",get:function(){return this._suspended},set:function(f){this._suspended&&!f&&this.stage&&(this.ready(),
this.requestRender());this._suspended=f}},{key:"bandIds",get:function(){return this._bandIds},set:function(f){this._bandIds=f;this._isBandIdschanged(f)&&(this.projected=!1,this.invalidateTexture())}},{key:"interpolation",get:function(){return this._interpolation||"nearest"},set:function(f){this._interpolation=f;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(f||"nearest")?B.TextureSamplingMode.LINEAR:B.TextureSamplingMode.NEAREST)}},{key:"transformGrid",
get:function(){return this._transformGrid},set:function(f){this._transformGrid=f;this._transformGridTexture=F.disposeMaybe(this._transformGridTexture)}}]);return E}(I.DisplayObject);let t=function(L){function E(){return h.apply(this,arguments)}D._inherits(E,L);var h=D._createSuper(E);D._createClass(E,[{key:"source",get:function(){return this._source}}]);return E}(I);u.RasterBitmap=I;u.RasterBitmapWithSource=t;u.hasSource=function(L){return F.isSome(L.source)};Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(u,D,F,m){function q(a){return D.isSome(a)&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function A(a,c,e,n,b){const l=a.length;b=F.createEmptyBand(b,l);if(c)for(let r=0;r<l;r++)c[r]&&(b[r]=e[a[r]-n]);else for(c=0;c<l;c++)b[c]=e[a[c]-n];return b}function x(a,c,e,n){const b=null!=e&&2<=
e.length?new Set(e):null;e=1===e?.length?e[0]:null;const l=!!c?.length;for(let r=0;r<a.length;r++)if(n[r]){const y=a[r];if(l){let z=!1;for(let O=0;O<c.length;O+=2)if(y>=c[O]&&y<=c[O+1]){z=!0;break}z||(n[r]=0)}n[r]&&(y===e||b?.has(y))&&(n[r]=0)}}function I(a,c){const e=a[0].length;for(let n=0;n<e;n++)if(c[n]){let b=!1;for(let l=0;l<a.length;l++)if(a[l][n]){b=!0;break}b||(c[n]=0)}}function B(a,c){const e=a[0].length;for(let n=0;n<e;n++)if(c[n]){let b=!1;for(let l=0;l<a.length;l++)if(0===a[l][n]){b=
!0;break}b&&(c[n]=0)}}function G(a,c,e,n,b,l,r,y){return{xmin:b<=e*a?0:b<e*a+a?b-e*a:a,ymin:l<=n*c?0:l<n*c+c?l-n*c:c,xmax:b+r<=e*a?0:b+r<e*a+a?b+r-e*a:a,ymax:l+y<=n*c?0:l+y<n*c+c?l+y-n*c:c}}function w(a,c,e,n,b,l){const {width:r,height:y}=e.block,{x:z,y:O}=e.offset,{width:Q,height:v}=e.mosaic;e=G(r,y,n,b,z,O,Q,v);let H=0;var M=0;if(l){var R=l.hasGCSSShiftTransform?360:l.halfWorldWidth??0,T=r*l.resolutionX;const X=l.startX+n*T;X<R&&X+T>R?M=l.rightPadding:X>=R&&(H=l.leftMargin-l.rightPadding,M=0)}e.xmax-=
M;if("number"===typeof c)for(l=e.ymin;l<e.ymax;l++)for(M=(b*y+l-O)*Q+(n*r-z)+H,R=e.xmin;R<e.xmax;R++)a[M+R]=c;else for(l=e.ymin;l<e.ymax;l++)for(M=(b*y+l-O)*Q+(n*r-z)+H,R=l*r,T=e.xmin;T<e.xmax;T++)a[M+T]=c[R+T]}function t(a,c,e={}){const {clipOffset:n,clipSize:b,alignmentInfo:l,blockWidths:r}=e;if(r)return L(a,c,{blockWidths:r});var y=a.find(Y=>q(Y));if(D.isNone(y))return null;e=b?b.width:c.width;const z=b?b.height:c.height;var O=y.width,Q=y.height;const v=c.width/O,H=c.height/Q;c={offset:n||{x:0,
y:0},mosaic:b||c,block:{width:O,height:Q}};O=y.pixelType;Q=F.getPixelArrayConstructor(O);var M=y.pixels.length;y=[];for(var R=0;R<M;R++){var T=new Q(e*z);for(let Y=0;Y<H;Y++)for(let g=0;g<v;g++){var X=a[Y*v+g];q(X)&&(X=X.pixels[R],w(T,X,c,g,Y,l))}y.push(T)}let ba;if(a.some(Y=>D.isNone(Y)||D.isSome(Y.mask)&&0<Y.mask.length))for(ba=new Uint8Array(e*z),Q=0;Q<H;Q++)for(M=0;M<v;M++)T=a[Q*v+M],R=D.isSome(T)?T.mask:null,D.isSome(R)?w(ba,R,c,M,Q,l):T?w(ba,1,c,M,Q,l):w(ba,0,c,M,Q,l);a=new F({width:e,height:z,
pixels:y,pixelType:O,mask:ba});a.updateStatistics();return a}function L(a,c,e){const n=a.find(M=>D.isSome(M));if(D.isNone(n))return null;var b=a.some(M=>D.isSome(M)?!!M.mask:!0);const {width:l,height:r}=c;c=b?new Uint8Array(l*r):null;({blockWidths:e}=e);const y=[],z=n.getPlaneCount(),O=F.getPixelArrayConstructor(n.pixelType);if(b)for(let M=0,R=0;M<a.length;R+=e[M],M++)if(b=a[M],q(b)){var Q=D.unwrap(b.mask);for(var v=0;v<r;v++)for(var H=0;H<e[M];H++)c[v*l+H+R]=null==Q?255:Q[v*b.width+H]}for(b=0;b<
z;b++){Q=new O(l*r);for(let M=0,R=0;M<a.length;R+=e[M],M++)if(v=a[M],q(v)&&(H=v.pixels[b],null!=H))for(let T=0;T<r;T++)for(let X=0;X<e[M];X++)Q[T*l+X+R]=H[T*v.width+X];y.push(Q)}a=new F({width:l,height:r,mask:c,pixels:y,pixelType:n.pixelType});a.updateStatistics();return a}function E(a){if(!q(a))return null;const c=a.clone(),{width:e,height:n,pixels:b}=a;var l=b[0];const r=c.pixels[0];a=D.unwrap(a.mask);for(let O=2;O<n-1;O++){const Q=new Map;for(var y=O-2;y<O+2;y++)for(var z=0;4>z;z++){const v=y*
e+z;d(Q,l[v],a?a[v]:1)}r[O*e]=h(Q);r[O*e+1]=r[O*e+2]=r[O*e];for(y=3;y<e-1;y++)z=(O-2)*e+y+1,d(Q,l[z],a?a[z]:1),z=(O-1)*e+y+1,d(Q,l[z],a?a[z]:1),z=O*e+y+1,d(Q,l[z],a?a[z]:1),z=(O+1)*e+y+1,d(Q,l[z],a?a[z]:1),z=(O-2)*e+y-3,f(Q,l[z],a?a[z]:1),z=(O-1)*e+y-3,f(Q,l[z],a?a[z]:1),z=O*e+y-3,f(Q,l[z],a?a[z]:1),z=(O+1)*e+y-3,f(Q,l[z],a?a[z]:1),r[O*e+y]=h(Q);r[O*e+y+1]=r[O*e+y]}for(l=0;l<e;l++)r[l]=r[e+l]=r[2*e+l],r[(n-1)*e+l]=r[(n-2)*e+l];c.updateStatistics();return c}function h(a){if(0===a.size)return 0;let c=
0,e=-1,n=0;const b=a.keys();let l=b.next();for(;!l.done;)n=a.get(l.value),n>c&&(e=l.value,c=n),l=b.next();return e}function f(a,c,e){0!==e&&(e=a.get(c),1===e?a.delete(c):a.set(c,e-1))}function d(a,c,e){0!==e&&a.set(c,a.has(c)?a.get(c)+1:1)}function k(a,c,e){let {x:n,y:b}=c;const {width:l,height:r}=e;if(0===n&&0===b&&r===a.height&&l===a.width)return a;const {width:y,height:z}=a;c=Math.max(0,b);const O=Math.max(0,n),Q=Math.min(n+l,y),v=Math.min(b+r,z);if(0>Q||0>v||!q(a))return null;n=Math.max(0,-n);
b=Math.max(0,-b);var {pixels:H}=a,M=l*r,R=H.length;const T=[];for(var X=0;X<R;X++){var ba=H[X],Y=F.createEmptyBand(a.pixelType,M);for(let g=c;g<v;g++){const C=g*y;let K=(g+b-c)*l+n;for(let N=O;N<Q;N++)Y[K++]=ba[C+N]}T.push(Y)}H=new Uint8Array(M);M=D.unwrap(a.mask);for(R=c;R<v;R++)for(X=R*y,ba=(R+b-c)*l+n,Y=O;Y<Q;Y++)H[ba++]=M?M[X+Y]:1;a=new F({width:e.width,height:e.height,pixelType:a.pixelType,pixels:T,mask:H});a.updateStatistics();return a}function p(a,c=!0){if(!q(a))return null;const {pixels:e,
width:n,height:b,mask:l,pixelType:r}=a;a=[];const y=Math.round(n/2),z=Math.round(b/2),O=b-1,Q=n-1;for(var v=0;v<e.length;v++){var H=e[v],M=F.createEmptyBand(r,y*z),R=0;for(var T=0;T<b;T+=2)for(var X=0;X<n;X+=2){var ba=H[T*n+X];if(c){var Y=X===Q?ba:H[T*n+X+1];const g=T===O?ba:H[T*n+X+n],C=X===Q?g:T===O?Y:H[T*n+X+n+1];M[R++]=(ba+Y+g+C)/4}else M[R++]=ba}a.push(M)}v=null;if(D.isSome(l))for(v=new Uint8Array(y*z),H=0,M=0;M<b;M+=2)for(R=0;R<n;R+=2)T=l[M*n+R],c?(X=R===Q?T:l[M*n+R+1],ba=M===O?T:l[M*n+R+n],
Y=R===Q?ba:M===O?X:l[M*n+R+n+1],v[H++]=T*X*ba*Y?1:0):v[H++]=T;return new F({width:y,height:z,pixelType:r,pixels:a,mask:v})}function J(a,c,e,n,b=0){const {width:l,height:r}=a,{width:y,height:z}=c;a=n.cols;n=n.rows;c=Math.ceil(y/a-.1/a);const O=Math.ceil(z/n-.1/n);let Q,v,H,M,R;const T=c*a;var X=T*O*n;const ba=new Float32Array(X),Y=new Float32Array(X),g=new Uint32Array(X),C=new Uint32Array(X);let K=0,N,U;for(let W=0;W<O;W++)for(let S=0;S<c;S++){var P=12*(W*c+S);X=e[P];Q=e[P+1];v=e[P+2];H=e[P+3];M=e[P+
4];R=e[P+5];for(var V=0;V<n;V++){K=(W*n+V)*T+S*a;U=(V+.5)/n;for(let Z=0;Z<V;Z++)N=(Z+.5)/a,ba[K+Z]=(X*N+Q*U+v)*l+b,Y[K+Z]=(H*N+M*U+R)*r+b,g[K+Z]=Math.floor(ba[K+Z]),C[K+Z]=Math.floor(Y[K+Z])}P+=6;X=e[P];Q=e[P+1];v=e[P+2];H=e[P+3];M=e[P+4];R=e[P+5];for(P=0;P<n;P++)for(K=(W*n+P)*T+S*a,U=(P+.5)/n,V=P;V<a;V++)N=(V+.5)/a,ba[K+V]=(X*N+Q*U+v)*l+b,Y[K+V]=(H*N+M*U+R)*r+b,g[K+V]=Math.floor(ba[K+V]),C[K+V]=Math.floor(Y[K+V])}return{offsets_x:ba,offsets_y:Y,offsets_xi:g,offsets_yi:C,gridWidth:T}}u.NoDataInterpretation=
void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(u.NoDataInterpretation||(u.NoDataInterpretation={}));u.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]="fail"})(u.MissingBandAction||(u.MissingBandAction={}));u.MAX_MAP_SIZE_GPU=6;u.approximateTransform=function(a,c,e,n,b="nearest"){if(!q(a))return null;"majority"===b&&(a=E(a));const {pixels:l,mask:r,pixelType:y}=a,z=a.width;var O=a.height;const Q=F.getPixelArrayConstructor(y),v=l.length,{width:H,
height:M}=c;a=!1;for(let C=0;C<e.length;C+=3)-1===e[C]&&-1===e[C+1]&&-1===e[C+2]&&(a=!0);const {offsets_x:R,offsets_y:T,offsets_xi:X,offsets_yi:ba,gridWidth:Y}=J({width:z,height:O},c,e,n,"majority"===b?.5:0);let g;c=(C,K,N)=>{const U=C instanceof Float32Array||C instanceof Float64Array?0:.5;for(let P=0;P<M;P++){g=P*Y;for(let V=0;V<H;V++){if(0>R[g]||0>T[g])C[P*H+V]=0;else if(N)C[P*H+V]=K[X[g]+ba[g]*z];else{const W=Math.floor(R[g]),S=Math.floor(T[g]),Z=Math.ceil(R[g]),aa=Math.ceil(T[g]),ca=R[g]-W,ea=
T[g]-S;C[P*H+V]=!r||r[W+S*z]&&r[Z+S*z]&&r[W+aa*z]&&r[Z+aa*z]?(1-ea)*((1-ca)*K[W+S*z]+ca*K[Z+S*z])+ea*((1-ca)*K[W+aa*z]+ca*K[Z+aa*z])+U:K[X[g]+ba[g]*z]}g++}}};e=[];for(O=0;O<v;O++)n=new Q(H*M),c(n,l[O],"nearest"===b||"majority"===b),e.push(n);b=new F({width:H,height:M,pixelType:y,pixels:e});if(D.isSome(r))b.mask=new Uint8Array(H*M),c(b.mask,r,!0);else if(a)for(b.mask=new Uint8Array(H*M),a=0;a<H*M;a++)b.mask[a]=0>R[a]||0>T[a]?0:1;b.updateStatistics();return b};u.clip=k;u.colorize=function(a,c){if(!q(a)||
!c||!c.indexedColormap&&!c.indexed2DColormap)return a;const e=a.clone();var n=e.pixels;let b=e.mask;const l=e.width*e.height;if(1!==n.length)return a;const {indexedColormap:r,indexed2DColormap:y,offset:z,alphaSpecified:O}=c;a=0;n=n[0];c=new Uint8Array(n.length);const Q=new Uint8Array(n.length),v=new Uint8Array(n.length);var H=0;if(r){const M=r.length-1;if(D.isSome(b))for(a=0;a<l;a++)b[a]&&(H=4*(n[a]-z),H<z||H>M?b[a]=0:(c[a]=r[H],Q[a]=r[H+1],v[a]=r[H+2],b[a]=r[H+3]));else{b=new Uint8Array(l);for(a=
0;a<l;a++)H=4*(n[a]-z),H<z||H>M?b[a]=0:(c[a]=r[H],Q[a]=r[H+1],v[a]=r[H+2],b[a]=r[H+3]);e.mask=b}}else if(y)if(D.isSome(b))for(a=0;a<l;a++)b[a]&&(H=y[n[a]],c[a]=H[0],Q[a]=H[1],v[a]=H[2],b[a]=H[3]);else{b=new Uint8Array(l);for(a=0;a<l;a++)H=y[n[a]],c[a]=H[0],Q[a]=H[1],v[a]=H[2],b[a]=H[3];e.mask=b}e.pixels=[c,Q,v];e.statistics=null;e.pixelType="u8";e.maskIsAlpha=O;return e};u.compositeBands=function(a){if(!a?.length||a.some(z=>!q(z)))return null;if(1===a.length)return D.isSome(a[0])?a[0].clone():null;
const {width:c,height:e,pixelType:n}=a[0];if(a.some(z=>z.width!==c||z.height!==e))return null;const b=a.map(({mask:z})=>z).filter(z=>null!=z);let l=null;b.length&&(l=new Uint8Array(c*e),l.set(b[0]),1<b.length&&B(b.slice(1),l));const r=[];a.forEach(({pixels:z})=>r.push(...z));const y=[];a.map(({statistics:z})=>z).filter(z=>z?.length).forEach(z=>y.push(...z));return new F({pixelType:n,width:c,height:e,mask:l,pixels:r,statistics:y.length?y:null})};u.createColormapLUT=function(a){if(a){var c=a.colormap;
if(c&&0!==c.length){c=c.sort((O,Q)=>O[0]-Q[0]);var e=0;0>c[0][0]&&(e=c[0][0]);var n=Math.max(256,c[c.length-1][0]-e+1),b=new Uint8Array(4*n),l=[],r=0,y=0,z=5===c[0].length;if(65536<n)return c.forEach(O=>{l[O[0]-e]=z?O.slice(1):O.slice(1).concat([255])}),{indexed2DColormap:l,offset:e,alphaSpecified:z};if(a.fillUnspecified)for(a=c[y],r=a[0]-e;r<n;r++)b[4*r]=a[1],b[4*r+1]=a[2],b[4*r+2]=a[3],b[4*r+3]=z?a[4]:255,r===a[0]-e&&(a=y===c.length-1?a:c[++y]);else for(r=0;r<c.length;r++)a=c[r],y=4*(a[0]-e),b[y]=
a[1],b[y+1]=a[2],b[y+2]=a[3],b[y+3]=z?a[4]:255;return{indexedColormap:b,offset:e,alphaSpecified:z}}}};u.createMaskLUT=function(a,c,e){if("u8"!==a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var n=a.includes("16")?65536:256;a=a.includes("s")?-n/2:0;n=new Uint8Array(n);if(c)for(let l=0;l<c.length;l++){var b=Math.ceil(c[2*l]-a);const r=Math.floor(c[2*l+1]-a);for(;b<=r;b++)n[b]=255}else n.fill(255);if(e)for(c=0;c<e.length;c++)n[e[c]-a]=0;return{lut:n,offset:a}};u.createRemapLUT=function(a){const {srcPixelType:c,
inputRanges:e,outputValues:n,allowUnmatched:b,noDataRanges:l,isLastInputRangeInclusive:r,outputPixelType:y}=a;if("u8"!==c&&"s8"!==c&&"u16"!==c&&"s16"!==c)return null;var z=c.includes("16")?65536:256;a=c.includes("s")?-z/2:0;const O=F.createEmptyBand(y,z);z=new Uint8Array(z);b&&z.fill(255);const [Q,v]=m.getPixelValueRange(y);if(e?.length&&n?.length){var H=e.map(X=>X-1E-6);H[0]=e[0];r&&(H[H.length-1]=e[e.length-1]);for(var M=0;M<H.length;M++){var R=n[M]>v?v:n[M]<Q?Q:n[M],T=Math.ceil(H[2*M]-a);const X=
Math.floor(H[2*M+1]-a);for(;T<=X;T++)O[T]=R,z[T]=255}}if(l?.length)for(H=0;H<l.length;H++)for(R=Math.ceil(l[2*H]-a),M=Math.floor(l[2*H+1]-a);R<=M;R++)z[R]=0;return{lut:O,offset:a,mask:z}};u.extractBands=function(a,c){if(!c?.length||!q(a))return a;const e=a.pixels.length;return c&&c.some(n=>n>=e)||1===e&&1===c.length&&0===c[0]||e===c.length&&!c.some((n,b)=>n!==b)?a:new F({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:c.map(n=>
a.pixels[n]),statistics:a.statistics&&c.map(n=>a.statistics[n])})};u.getClipBounds=G;u.getLocalArithmeticNorthRotations=function(a,c){const {coefficients:e,spacing:n}=c,{offsets_x:b,offsets_y:l,gridWidth:r}=J(a,a,e,{rows:n[0],cols:n[1]}),{width:y,height:z}=a;a=new Float32Array(y*z);c=180/Math.PI;for(let v=0;v<z;v++)for(let H=0;H<y;H++){var O=v*r+H,Q=0===v?O:O-r;const M=v===z-1?O:O+r;O=b[Q]-b[M];Q=l[M]-l[Q];isNaN(O)||isNaN(Q)?a[v*y+H]=90:(Q=Math.atan2(Q,O)*c,Q=(360+Q)%360,a[v*y+H]=Q)}return a};u.interpolateOffsets=
J;u.isValidPixelBlock=q;u.lookupBandValues=A;u.lookupPixels=function(a,c){if(!q(a))return null;const {pixels:e,mask:n}=a,b=e.length;let l=c.lut;const {offset:r}=c;l&&1===l[0].length&&(l=e.map(()=>l));const y=[];c=c.outputPixelType||"u8";for(let z=0;z<b;z++){const O=A(e[z],n,l[z],r||0,c);y.push(O)}a=new F({width:a.width,height:a.height,pixels:y,mask:n,pixelType:c});a.updateStatistics();return a};u.mask=function(a,c){if(!q(a))return null;const {width:e,height:n,pixels:b}=a;var l=e*n;const r=new Uint8Array(l);
a.mask?r.set(a.mask):r.fill(255);a=b.length;const {includedRanges:y,noDataValues:z,outputPixelType:O,matchAll:Q,lookups:v}=c;if(v){l=[];for(c=0;c<a;c++){var H=v[c];H=A(b[c],r,H.lut,H.offset||0,"u8");l.push(H)}1===l.length?r.set(l[0]):Q?I(l,r):B(l,r)}else if(Q){c=[];for(H=0;H<a;H++){const M=new Uint8Array(l);M.set(r);x(b[H],y?.slice(2*H,2*H+2),z?.[H],M);c.push(M)}1===c.length?r.set(c[0]):I(c,r)}else for(l=0;l<a;l++)x(b[l],y?.slice(2*l,2*l+2),z?.[l],r);return new F({width:e,height:n,pixelType:O,pixels:b,
mask:r})};u.mosaic=t;u.mosaicPixelData=function(a,c){if(!a||0===a.length)return null;var e=a.find(v=>v.pixelBlock);if(!e||D.isNone(e.pixelBlock))return null;var n=(e.extent.xmax-e.extent.xmin)/e.pixelBlock.width;const b=(e.extent.ymax-e.extent.ymin)/e.pixelBlock.height,l=.01*Math.min(n,b),r=a.sort((v,H)=>Math.abs(v.extent.ymax-H.extent.ymax)>l?H.extent.ymax-v.extent.ymax:Math.abs(v.extent.xmin-H.extent.xmin)>l?v.extent.xmin-H.extent.xmin:0);var y=Math.min.apply(null,r.map(v=>v.extent.xmin));const z=
Math.min.apply(null,r.map(v=>v.extent.ymin)),O=Math.max.apply(null,r.map(v=>v.extent.xmax)),Q=Math.max.apply(null,r.map(v=>v.extent.ymax));a={x:Math.round((c.xmin-y)/n),y:Math.round((Q-c.ymax)/b)};y={width:Math.round((O-y)/n),height:Math.round((Q-z)/b)};n={width:Math.round((c.xmax-c.xmin)/n),height:Math.round((c.ymax-c.ymin)/b)};if(Math.round(y.width/e.pixelBlock.width)*Math.round(y.height/e.pixelBlock.height)!==r.length||0>a.x||0>a.y||y.width<n.width||y.height<n.height)return null;e=r.map(v=>v.pixelBlock);
e=t(e,y,{clipOffset:a,clipSize:n});return{extent:c,pixelBlock:e}};u.remap=function(a,c){if(!q(a))return null;const {width:e,height:n}=a,{inputRanges:b,outputValues:l,outputPixelType:r,noDataRanges:y,allowUnmatched:z,isLastInputRangeInclusive:O}=c;c=a.pixels[0];const Q=F.createEmptyBand(r,c.length),v=a.mask,H=new Uint8Array(e*n);v?H.set(v):H.fill(255);const M=a.pixelType.startsWith("f")?1E-6:0;a=b.map(K=>K-M);a[0]=b[0];a[a.length-1]=b[b.length-1]+(O?1E-6:0);var R=b.length/2;const [T,X]=m.getPixelValueRange(r);
for(var ba=0;ba<n;ba++)for(var Y=0;Y<e;Y++){var g=ba*e+Y;if(H[g]){var C=c[g];let K=!1;for(let N=R-1;0<=N;N--)if(C===a[2*N]||C>a[2*N]&&C<a[2*N+1]){Q[g]=l[N];K=!0;break}K||(z?Q[g]=C>X?X:C<T?T:C:H[g]=0)}}if(a=y?.length)for(R=0;R<n;R++)for(ba=0;ba<e;ba++)if(Y=R*e+ba,!v||v[Y])for(g=c[Y],C=0;C<a;C+=2)if(g>=y[C]&&g<=y[C+1]){Q[Y]=0;H[Y]=0;break}return new F({width:e,height:n,pixelType:r,pixels:[Q],mask:H})};u.remapColor=function(a,c){if(!q(a))return null;a=a.clone();var {pixels:e}=a;const n=a.width*a.height,
b=c.length,l=Math.floor(b/2),r=c[Math.floor(l)];e=e[0];let y,z,O,Q,v,H,M=!1;const R=new Uint8Array(n),T=new Uint8Array(n),X=new Uint8Array(n);let ba=a.mask;const Y=4===c[0].mappedColor.length;ba||(ba=new Uint8Array(n),ba.fill(Y?255:1),a.mask=ba);for(v=0;v<n;v++)if(ba[v]){y=e[v];M=!1;H=l;z=r;O=0;for(Q=b-1;1<Q-O;){if(y===z.value){M=!0;break}y>z.value?O=H:Q=H;H=Math.floor((O+Q)/2);z=c[Math.floor(H)]}M||(y===c[O].value?(z=c[O],M=!0):y===c[Q].value?(z=c[Q],M=!0):y<c[O].value?(M=!1,z=null):y>c[O].value&&
(y<c[Q].value?(z=c[O],M=!0):Q===b-1?(M=!1,z=null):(z=c[Q],M=!0)));M?(R[v]=z.mappedColor[0],T[v]=z.mappedColor[1],X[v]=z.mappedColor[2],ba[v]=z.mappedColor[3]):R[v]=T[v]=X[v]=ba[v]=0}a.pixels=[R,T,X];a.mask=ba;a.pixelType="u8";a.maskIsAlpha=Y;return a};u.resampleByMajority=E;u.setValidBoundary=function(a,c,e){if(!q(a))return null;const {width:n,height:b}=a,l=c.x;c=c.y;const r=e.width+l;e=e.height+c;if(0>l||0>c||r>n||e>b||0===l&&0===c&&r===n&&e===b)return a;a.mask||(a.mask=new Uint8Array(n*b));const y=
a.mask;for(let z=0;z<b;z++){const O=z*n;for(let Q=0;Q<n;Q++)y[O+Q]=z<c||z>=e||Q<l||Q>=r?0:1}a.updateStatistics();return a};u.split=function(a,c,e){if(!q(a))return null;const {width:n,height:b}=c;let {width:l,height:r}=a;const y=new Map,z={x:0,y:0};e=null==e?1:1+e;for(let O=0;O<e;O++){const Q=Math.ceil(l/n),v=Math.ceil(r/b);for(let H=0;H<v;H++){z.y=H*b;for(let M=0;M<Q;M++){z.x=M*n;const R=k(a,z,c);y.set(`${O}/${H}/${M}`,R)}}O<e-1&&(a=p(a));l=Math.round(l/2);r=Math.round(r/2)}return y};Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),function(u,D,F,m,q,A,x,I,B,G,w,t){var L;m=L=function(E){function h(d){d=
f.call(this,d);d.width=null;d.height=null;d.pixelType="f32";d.validPixelCount=null;d.mask=null;d.maskIsAlpha=!1;d.premultiplyAlpha=!1;d.statistics=null;d.depthCount=1;return d}u._inherits(h,E);var f=u._createSuper(h);h.createEmptyBand=function(d,k){return new (L.getPixelArrayConstructor(d))(k)};h.getPixelArrayConstructor=function(d){let k;switch(d){case "u1":case "u2":case "u4":case "u8":k=Uint8Array;break;case "u16":k=Uint16Array;break;case "u32":k=Uint32Array;break;case "s8":k=Int8Array;break;case "s16":k=
Int16Array;break;case "s32":k=Int32Array;break;case "f32":k=Float32Array;break;case "f64":k=Float64Array;break;case "c64":case "c128":case "unknown":k=Float32Array}return k};E=h.prototype;E.castPixelType=function(d){if(!d)return"f32";d=d.toLowerCase();["u1","u2","u4"].includes(d)?d="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(d)||(d="f32");return d};E.getPlaneCount=function(){return this.pixels?.length};E.addData=function(d){if(!d.pixels||d.pixels.length!==this.width*this.height)throw new F("pixelblock:invalid-or-missing-pixels",
"add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(d.pixels);this.statistics.push(d.statistics??new w.SimpleBandStatistics)};E.getAsRGBA=function(){const d=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(d);break;default:this._fillFrom8Bit(d)}return new Uint8ClampedArray(d)};
E.getAsRGBAFloat=function(){const d=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(d);return d};E.updateStatistics=function(){if(this.pixels){this.statistics=this.pixels.map(p=>this._calculateBandStatistics(p,this.mask));var d=this.mask,k=0;if(x.isSome(d))for(let p=0;p<d.length;p++)d[p]&&k++;else k=this.width*this.height;this.validPixelCount=k}};E.clamp=function(d){if(d&&"f64"!==d&&"f32"!==d&&this.pixels){var [k,p]=t.getPixelValueRange(d),J=this.pixels,a=this.width*this.height,c=J.length,
e=[];for(let r=0;r<c;r++){var n=L.createEmptyBand(d,a);var b=J[r];for(let y=0;y<a;y++){var l=b[y];n[y]=l>p?p:l<k?k:l}e.push(n)}this.pixels=e;this.pixelType=d}};E.extractBands=function(d){const {pixels:k,statistics:p}=this;if(x.isNone(d)||0===d.length||!k||0===k.length)return this;var J=k.length;const a=d.some(c=>c>=k.length);J=J===d.length&&!d.some((c,e)=>c!==e);return a||J?this:new L({pixelType:this.pixelType,width:this.width,height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,
maskIsAlpha:this.maskIsAlpha,pixels:d.map(c=>k[c]),statistics:p&&d.map(c=>p[c])})};E.clone=function(){const d=new L({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});x.isSome(this.mask)&&(d.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let k;const p=L.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){d.pixels=[];const J=!!this.pixels[0].slice;for(k=0;k<
this.pixels.length;k++)d.pixels[k]=J?this.pixels[k].slice(0,this.pixels[k].length):new p(this.pixels[k])}if(this.statistics)for(d.statistics=[],k=0;k<this.statistics.length;k++)d.statistics[k]=q.clone(this.statistics[k]);d.premultiplyAlpha=this.premultiplyAlpha;return d};E._fillFrom8Bit=function(d){const {mask:k,maskIsAlpha:p,premultiplyAlpha:J,pixels:a}=this;if(d&&a&&a.length){var c,e;var n=c=e=a[0];3<=a.length?(c=a[1],e=a[2]):2===a.length&&(c=a[1]);var b=new Uint32Array(d),l=this.width*this.height;
if(n.length!==l)A.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(x.isSome(k)&&k.length===l)if(p)for(d=0;d<l;d++){const r=k[d];if(r){const y=r/255;b[d]=J?r<<24|e[d]*y<<16|c[d]*y<<8|n[d]*y:r<<24|e[d]<<16|c[d]<<8|n[d]}}else for(d=0;d<l;d++)k[d]&&(b[d]=-16777216|e[d]<<16|c[d]<<8|n[d]);else for(d=0;d<l;d++)b[d]=-16777216|e[d]<<16|c[d]<<8|n[d]}else A.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};
E._fillFromNon8Bit=function(d){const {pixels:k,mask:p,statistics:J}=this;if(d&&k&&k.length){var a=this.pixelType,c=1,e=0;c=1;if(J&&0<J.length){for(var n of J)null!=n.minValue&&(e=Math.min(e,n.minValue)),null!=n.maxValue&&null!=n.minValue&&(c=Math.max(c,n.maxValue-n.minValue));c=255/c}else c=255,"s8"===a?(e=-128,c=127):"u16"===a?c=65535:"s16"===a?(e=-32768,c=32767):"u32"===a?c=4294967295:"s32"===a?(e=-2147483648,c=2147483647):"f32"===a?(e=-3.4*1E39,c=3.4*1E39):"f64"===a&&(e=-Number.MAX_VALUE,c=Number.MAX_VALUE),
c=255/(c-e);d=new Uint32Array(d);a=this.width*this.height;var b,l,r;n=b=l=k[0];if(n.length!==a)return A.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=k.length)if(b=k[1],3<=k.length&&(l=k[2]),x.isSome(p)&&p.length===a)for(r=0;r<a;r++)p[r]&&(d[r]=-16777216|(l[r]-e)*c<<16|(b[r]-e)*c<<8|(n[r]-e)*c);else for(r=0;r<a;r++)d[r]=-16777216|(l[r]-e)*c<<16|(b[r]-e)*c<<8|(n[r]-e)*c;else if(x.isSome(p)&&p.length===a)for(r=0;r<a;r++)b=(n[r]-e)*c,
p[r]&&(d[r]=-16777216|b<<16|b<<8|b);else for(r=0;r<a;r++)b=(n[r]-e)*c,d[r]=-16777216|b<<16|b<<8|b}else A.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};E._fillFrom32Bit=function(d){const {pixels:k,mask:p}=this;if(!d||!k||!k.length)return A.getLogger(this.declaredClass).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let J,a,c,e;J=a=c=k[0];3<=k.length?(a=k[1],c=k[2]):2===k.length&&(a=k[1]);const n=
this.width*this.height;if(J.length!==n)return A.getLogger(this.declaredClass).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let b=0;if(x.isSome(p)&&p.length===n)for(e=0;e<n;e++)d[b++]=J[e],d[b++]=a[e],d[b++]=c[e],d[b++]=p[e]&1;else for(e=0;e<n;e++)d[b++]=J[e],d[b++]=a[e],d[b++]=c[e],d[b++]=1};E._calculateBandStatistics=function(d,k){let p=Infinity,J=-Infinity;const a=d.length;let c,e=0;if(x.isSome(k))for(c=0;c<a;c++)k[c]&&(e=d[c],p=e<p?e:p,J=e>J?e:J);else for(c=
0;c<a;c++)e=d[c],p=e<p?e:p,J=e>J?e:J;return new w.SimpleBandStatistics(p,J)};return u._createClass(h)}(m.JSONSupport);D.__decorate([I.property({json:{write:!0}})],m.prototype,"width",void 0);D.__decorate([I.property({json:{write:!0}})],m.prototype,"height",void 0);D.__decorate([I.property({json:{write:!0}})],m.prototype,"pixelType",void 0);D.__decorate([B.cast("pixelType")],m.prototype,"castPixelType",null);D.__decorate([I.property({json:{write:!0}})],m.prototype,"validPixelCount",void 0);D.__decorate([I.property({json:{write:!0}})],
m.prototype,"mask",void 0);D.__decorate([I.property({json:{write:!0}})],m.prototype,"maskIsAlpha",void 0);D.__decorate([I.property({json:{write:!0}})],m.prototype,"pixels",void 0);D.__decorate([I.property()],m.prototype,"premultiplyAlpha",void 0);D.__decorate([I.property({json:{write:!0}})],m.prototype,"statistics",void 0);D.__decorate([I.property({json:{write:!0}})],m.prototype,"depthCount",void 0);D.__decorate([I.property({json:{write:!0}})],m.prototype,"noDataValues",void 0);D.__decorate([I.property({json:{write:!0}})],
m.prototype,"bandMasks",void 0);return m=L=D.__decorate([G.subclass("esri.layers.support.PixelBlock")],m)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(u,D){D=D._createClass(function(F=null,m=null,q=null){this.minValue=F;this.maxValue=m;this.noDataValue=q});u.SimpleBandStatistics=D;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],
function(u){function D(m){return F[m]??[-3.4028234663852886E38,3.4028234663852886E38]}const F={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]};u.convertNoDataToMask=function(m,q,A){if(!(m.depthCount&&1<m.depthCount)){var {pixels:x,statistics:I,pixelType:B}=m,G=x[0].length,w=m.bandMasks??[],t=m.mask??(new Uint8Array(G)).fill(255),
L="f32"===B||"f64"===B,E=D(B),h=!1;for(let k=0;k<x.length;k++){const p="number"===typeof q?q:q[k];if(null==p)continue;var f=I?.[k].maxValue??E[1];if((I?.[k].minValue??E[0])>p+Number.EPSILON||f<p-Number.EPSILON)continue;f=w[k]||(new Uint8Array(G)).fill(255);const J=x[k];var d=A?.customFloatTolerance;if(L&&0!==d){d||(d=9.999999E37<=Math.abs(p)?2E-7*Math.abs(p):"f32"===B?2**-23:Number.EPSILON);for(let a=0;a<J.length;a++)f[a]&&Math.abs(J[a]-p)<d&&(J[a]=0,f[a]=0,t[a]=0,h=!0)}else for(d=0;d<J.length;d++)f[d]&&
J[d]===p&&(J[d]=0,f[d]=0,t[d]=0,h=!0);w[k]=f}h&&(m.bandMasks=w,m.mask=t);h&&"updateStatistics"in m&&m.updateStatistics()}};u.getPixelValueRange=D;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/rasterUtils":function(){define("exports ../../core/maybe ../../chunks/vec2f64 ./context-util ./enums ./Texture".split(" "),function(u,D,F,m,q,A){u.createColormapTexture=function(x,I){return new A.Texture(x,{width:I.length/4,height:1,target:q.TextureType.TEXTURE_2D,pixelFormat:q.PixelFormat.RGBA,
internalFormat:q.PixelFormat.RGBA,dataType:q.PixelType.UNSIGNED_BYTE,samplingMode:q.TextureSamplingMode.NEAREST,wrapMode:q.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},I)};u.createRasterTexture=function(x,I,B="nearest",G=!1){const w=(G=!(G&&"u8"===I.pixelType))?q.PixelType.FLOAT:q.PixelType.UNSIGNED_BYTE,t=null==I.pixels||0===I.pixels.length?null:G?I.getAsRGBAFloat():I.getAsRGBA();return new A.Texture(x,{width:I.width,height:I.height,target:q.TextureType.TEXTURE_2D,pixelFormat:q.PixelFormat.RGBA,internalFormat:x.type===
m.ContextType.WEBGL2&&G?q.SizedPixelFormat.RGBA32F:q.PixelFormat.RGBA,samplingMode:!x.capabilities.textureFloat?.textureFloatLinear||"bilinear"!==B&&"cubic"!==B?q.TextureSamplingMode.NEAREST:q.TextureSamplingMode.LINEAR,dataType:w,wrapMode:q.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1},t)};u.createTransformTexture=function(x,I){const {spacing:B,offsets:G,coefficients:w,size:[t,L]}=I;var E=1<B[0];I={width:E?4*t:t,height:L,target:q.TextureType.TEXTURE_2D,pixelFormat:q.PixelFormat.RGBA,internalFormat:x.type===
m.ContextType.WEBGL2?q.SizedPixelFormat.RGBA32F:q.PixelFormat.RGBA,dataType:q.PixelType.FLOAT,samplingMode:q.TextureSamplingMode.NEAREST,wrapMode:q.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1};const h=new Float32Array(E?t*L*16:2*G.length);if(E&&null!=w)for(let f=0,d=0;f<w.length;f++)h[d++]=w[f],2===f%3&&(h[d++]=1);else for(E=0;E<L;E++)for(let f=0;f<t;f++){const d=4*(E*t+f),k=2*(f*L+E);h[d]=G[k];h[d+1]=G[k+1];h[d+3]=-1===G[k]?0:1}return new A.Texture(x,I,h)};u.getBasicGridUniforms=function(x,I){return{u_scale:x,
u_offset:I}};u.getColormapUniforms=function(x,I){return{u_colormapOffset:I||0,u_colormapMaxIndex:x?x.length/4-1:0}};u.getCommonUniforms=function(x,I,B,G=1,w=!0){return{u_flipY:w,u_applyTransform:!!x,u_opacity:G,u_transformSpacing:x?x.spacing:F.ZEROS,u_transformGridSize:x?x.size:F.ZEROS,u_targetImageSize:I,u_srcImageSize:B}};u.getShadedReliefUniforms=function(x){return{u_hillshadeType:x.hillshadeType,u_sinZcosAs:x.sinZcosAs,u_sinZsinAs:x.sinZsinAs,u_cosZs:x.cosZs,u_weights:x.weights,u_factor:x.factor,
u_minValue:x.minValue,u_maxValue:x.maxValue}};u.getStretchUniforms=function(x){return{u_bandCount:x.bandCount,u_minOutput:x.outMin,u_maxOutput:x.outMax,u_minCutOff:x.minCutOff,u_maxCutOff:x.maxCutOff,u_factor:x.factor,u_useGamma:x.useGamma,u_gamma:x.gamma,u_gammaCorrection:x.gammaCorrection}};u.getUniformLocationInfos=function(x,I){x=x.gl;I=I.glName;const B=new Map;if(D.isNone(I))return B;const G=x.getProgramParameter(I,x.ACTIVE_UNIFORMS);let w;for(let t=0;t<G;t++)(w=x.getActiveUniform(I,t))&&B.set(w.name,
{location:x.getUniformLocation(I,w.name),info:w});return B};u.setTextures=function(x,I,B,G){B.length===G.length&&(G.some(w=>null==w)||B.some(w=>null==w)||B.forEach((w,t)=>{I.setUniform1i(w,t);x.bindTexture(G[t],t)}))};u.setUniforms=function(x,I,B){Object.keys(B).forEach(G=>{var w=I.get(G)||I.get(G+"[0]");if(w){var t=B[G];if(null!==w&&null!=t)switch({info:w}=w,w.type){case q.UniformType.FLOAT:1<w.size?x.setUniform1fv(G,t):x.setUniform1f(G,t);break;case q.UniformType.FLOAT_VEC2:x.setUniform2fv(G,t);
break;case q.UniformType.FLOAT_VEC3:x.setUniform3fv(G,t);break;case q.UniformType.FLOAT_VEC4:x.setUniform4fv(G,t);break;case q.UniformType.FLOAT_MAT3:x.setUniformMatrix3fv(G,t);break;case q.UniformType.FLOAT_MAT4:x.setUniformMatrix4fv(G,t);break;case q.UniformType.INT:1<w.size?x.setUniform1iv(G,t):x.setUniform1i(G,t);break;case q.UniformType.BOOL:x.setUniform1i(G,t?1:0);break;case q.UniformType.INT_VEC2:case q.UniformType.BOOL_VEC2:x.setUniform2iv(G,t);break;case q.UniformType.INT_VEC3:case q.UniformType.BOOL_VEC3:x.setUniform3iv(G,
t);break;case q.UniformType.INT_VEC4:case q.UniformType.BOOL_VEC4:x.setUniform4iv(G,t)}}})};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/colorizer/rasterColorizer":function(){define(["exports","./lut","./shadedrelief","./stretch"],function(u,D,F,m){const q=new Map;q.set("lut",D);q.set("hillshade",F);q.set("stretch",m);u.getColorizer=function(A){return q.get(A)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/colorizer/lut":function(){define(["./utils",
"../../../../webgl/rasterUtils"],function(u,D){const F={vsPath:"raster/common",fsPath:"raster/lut",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(m,q,A){q=A?[]:u.getProjectionDefines(q.transformGrid);m=m.painter.materialManager.getProgram(F,q);return{defines:q,program:m}},bindTextureAndUniforms:function(m,q,A,x,I=!1){const {names:B,textures:G}=A.getTextures({useProcessedTexture:I});D.setTextures(m.context,q,B,G);D.setUniforms(q,x,A.commonUniforms);q.setUniformMatrix3fv("u_dvsMat3",
A.transforms.dvs);const {colormap:w,colormapOffset:t}=A.symbolizerParameters;m=D.getColormapUniforms(w,t);D.setUniforms(q,x,m)}}})},"esri/views/2d/engine/imagery/colorizer/utils":function(){define(["exports"],function(u){u.getInterpolationDefines=function(D,F,m){m=!m.capabilities.textureFloat?.textureFloatLinear;const q=[];"cubic"===D?q.push("bicubic"):"bilinear"===D&&(F?(q.push("bilinear"),q.push("nnedge")):m&&q.push("bilinear"));return q};u.getProjectionDefines=function(D){const F=[];D&&(F.push("applyProjection"),
1===D.spacing[0]&&F.push("lookupProjection"));return F};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/colorizer/shadedrelief":function(){define(["./utils","../../../../webgl/rasterUtils"],function(u,D){const F={vsPath:"raster/common",fsPath:"raster/hillshade",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(m,q,A){const {colormap:x}=q.symbolizerParameters;A=A?[]:u.getProjectionDefines(q.transformGrid);q=u.getInterpolationDefines(q.interpolation,
null!=x,m.context);q=[...A,...q];null!=x&&q.push("applyColormap");m=m.painter.materialManager.getProgram(F,q);return{defines:q,program:m}},bindTextureAndUniforms:function(m,q,A,x,I=!1){const {names:B,textures:G}=A.getTextures({useProcessedTexture:I});D.setTextures(m.context,q,B,G);D.setUniforms(q,x,A.commonUniforms);q.setUniformMatrix3fv("u_dvsMat3",A.transforms.dvs);m=A.symbolizerParameters;const {colormap:w,colormapOffset:t}=m;null!=w&&(A=D.getColormapUniforms(w,t),D.setUniforms(q,x,A));m=D.getShadedReliefUniforms(m);
D.setUniforms(q,x,m)}}})},"esri/views/2d/engine/imagery/colorizer/stretch":function(){define(["./utils","../../../../webgl/rasterUtils"],function(u,D){const F={vsPath:"raster/common",fsPath:"raster/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(m,q,A){const {colormap:x}=q.symbolizerParameters;var I=A?[]:u.getProjectionDefines(q.transformGrid);const B=u.getInterpolationDefines(q.interpolation,null!=x,m.context);I=[...I,...B];q.isRendereredSource&&!A?
I.push("noop"):null!=x&&I.push("applyColormap");m=m.painter.materialManager.getProgram(F,I);return{defines:I,program:m}},bindTextureAndUniforms:function(m,q,A,x,I=!1){const {names:B,textures:G}=A.getTextures({useProcessedTexture:I});D.setTextures(m.context,q,B,G);D.setUniforms(q,x,A.commonUniforms);q.setUniformMatrix3fv("u_dvsMat3",A.transforms.dvs);m=A.symbolizerParameters;const {colormap:w,colormapOffset:t}=m;null!=w&&(A=D.getColormapUniforms(w,t),D.setUniforms(q,x,A));m=D.getStretchUniforms(m);
D.setUniforms(q,x,m)}}})},"esri/views/2d/engine/imagery/processor/rasterProcessor":function(){define("exports ../../../../../core/maybe ./aspectProcessor ./bandArithmeticProcessor ./compositeBandProcessor ./convolutionProcessor ./extractBandProcessor ./localProcessor ./maskProcessor ./ndviProcessor ./remapProcessor ./reprojectProcessor ./slopeProcessor ./stretchProcessor ../../../../webgl/context-util ../../../../webgl/enums ../../../../webgl/Texture".split(" "),function(u,D,F,m,q,A,x,I,B,G,w,t,L,
E,h,f,d){function k(J,a,c){return new d.Texture(J,{width:a,height:c,target:f.TextureType.TEXTURE_2D,pixelFormat:f.PixelFormat.RGBA,internalFormat:J.type===h.ContextType.WEBGL2?f.SizedPixelFormat.RGBA32F:f.PixelFormat.RGBA,samplingMode:f.TextureSamplingMode.NEAREST,dataType:f.PixelType.FLOAT,isImmutable:J.type===h.ContextType.WEBGL2,wrapMode:f.TextureWrapMode.CLAMP_TO_EDGE,flipped:!1})}const p=new Map;p.set("aspect",F);p.set("bandarithmetic",m);p.set("compositeband",q);p.set("convolution",A);p.set("extractband",
x);p.set("local",I);p.set("mask",B);p.set("ndvi",G);p.set("remap",w);p.set("slope",L);p.set("stretch",E);u.createTexture=k;u.process=function(J,a,c,e){const n=J.rasterFunction.name.toLowerCase(),b="reproject"===n?t:p.get(n.toLowerCase());if(null!=b){{const {context:Q,requestRender:v,allowDelayedRender:H}=J;var l=b.createProgram(J,e);if(H&&D.isSome(v)&&!l.compiled)v(),l=null;else{var {width:r,height:y}=e;Q.bindFramebuffer(c);Q.setViewport(0,0,r,y);Q.useProgram(l)}}if(l){b.bindTextureAndUniforms(J,
l,e);a.draw();var {width:z,height:O}=e;a=k(J.context,z,O);c.copyToTexture(0,0,z,O,0,0,a);"reproject"===n?(e.rasterTexture=a,e.projected=!0):e.functionTextures[J.hasBranches?J.rasterFunction.id:0]=a}}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/processor/aspectProcessor":function(){define(["./utils"],function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/aspect",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,
m){return F.painter.materialManager.getProgram(D,[])},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);const {width:A,height:x,resolution:I}=q;m.setUniform2fv("u_srcImageSize",[A,x]);m.setUniform2fv("u_cellSize",[I,I])}}})},"esri/views/2d/engine/imagery/processor/utils":function(){define(["exports","../../../../webgl/rasterUtils"],function(u,D){function F(A,x,I){const {context:B,rasterFunction:G,hasBranches:w}=A;({raster:A}=G.parameters);D.setTextures(B,
x,["u_image"],[I.functionTextures[w?A?.id??-1:0]??I.rasterTexture])}const m=[1,1],q=[2,0,0,0,2,0,-1,-1,0];u.setCoordsAndTransforms=function(A){A.setUniform2fv("u_coordScale",m);A.setUniformMatrix3fv("u_dvsMat3",q)};u.setMultipleImageTextures=function(A,x,I){var {rasters:B}=A.rasterFunction.parameters;if(B){if(2>B.length)return F(A,x,I);var G=B.filter(w=>"Constant"!==w.name).map(w=>null!=w.id&&"Identity"!==w.name?I.functionTextures[w.id]:I.rasterTexture);D.setTextures(A.context,x,["u_image","u_image1",
"u_image2"].slice(0,G.length),G);if(G.length!==B.length)if(2===B.length)G=B.findIndex(w=>"Constant"===w.name),A=0===G?[0,1,0,1,0,0,0,0,0]:[1,0,0,0,1,0,0,0,0],{value:B}=B[G].parameters,x.setUniform1f("u_image1Const",B),x.setUniformMatrix3fv("u_imageSwap",A);else if(3===B.length){const w=[];B.forEach((t,L)=>"Constant"===t.name&&w.push(L));1===w.length?({value:B}=B[w[0]].parameters,x.setUniform1f("u_image1Const",B),x.setUniformMatrix3fv("u_imageSwap",0===w[0]?[0,1,0,0,0,1,1,0,0]:1===w[0]?[1,0,0,0,0,
1,0,1,0]:[1,0,0,0,1,0,0,0,1])):2===w.length&&({value:A}=B[w[0]].parameters,x.setUniform1f("u_image1Const",A),{value:A}=B[w[1]].parameters,x.setUniform1f("u_image2Const",A),B=B.findIndex(t=>"Constant"!==t.name),x.setUniformMatrix3fv("u_imageSwap",0===B?[1,0,0,0,1,0,0,0,1]:1===B?[0,1,0,1,0,0,0,0,1]:[0,0,1,1,0,0,0,1,0]))}}};u.setSingleImageTextures=F;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/processor/bandArithmeticProcessor":function(){define(["./utils"],
function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/bandarithmetic",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,m){const {painter:q,rasterFunction:A}=F;({indexType:F}=A.parameters);return q.materialManager.getProgram(D,[F])},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);({bandIndexMat3:F}=F.rasterFunction.parameters);m.setUniformMatrix3fv("u_bandIndexMat3",F)}}})},"esri/views/2d/engine/imagery/processor/compositeBandProcessor":function(){define(["./utils"],
function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/compositeband",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,m){return F.painter.materialManager.getProgram(D,[])},bindTextureAndUniforms:function(F,m,q){u.setMultipleImageTextures(F,m,q);u.setCoordsAndTransforms(m)}}})},"esri/views/2d/engine/imagery/processor/convolutionProcessor":function(){define(["./utils"],function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/convolution",attributes:new Map([["a_position",
0],["a_texcoord",1]])};return{createProgram:function(F,m){const {painter:q,rasterFunction:A}=F,{kernelRows:x,kernelCols:I}=A.parameters;return q.materialManager.getProgram(D,[{name:"rows",value:x},{name:"cols",value:I}])},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);m.setUniform2fv("u_srcImageSize",[q.width,q.height]);const {kernel:A,clampRange:x}=F.rasterFunction.parameters;m.setUniform1fv("u_kernel",A);m.setUniform2fv("u_clampRange",x)}}})},
"esri/views/2d/engine/imagery/processor/extractBandProcessor":function(){define(["./utils"],function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/extractband",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,m){return F.painter.materialManager.getProgram(D,[])},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);({bandIndexMat3:F}=F.rasterFunction.parameters);m.setUniformMatrix3fv("u_bandIndexMat3",F)}}})},
"esri/views/2d/engine/imagery/processor/localProcessor":function(){define(["./utils","../../../../webgl/context-util"],function(u,D){const F={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/local",attributes:new Map([["a_position",0],["a_texcoord",1]])},m=new Set("sinh cosh tanh asinh acosh atanh".split(" "));return{createProgram:function(q){const {painter:A,rasterFunction:x}=q,{imageCount:I,operationName:B,rasters:G,isOutputRounded:w}=x.parameters;var t=B.toLowerCase();q.context.type===D.ContextType.WEBGL1&&
m.has(t)&&(t=`polyfill${t}`);q=[t];2===I&&q.push("twoImages");t=G.filter(L=>"Constant"===L.name);t.length&&(q.push("oneConstant"),2===t.length&&q.push("twoConstant"));w&&q.push("roundOutput");return A.materialManager.getProgram(F,q)},bindTextureAndUniforms:function(q,A,x){u.setMultipleImageTextures(q,A,x);u.setCoordsAndTransforms(A);({domainRange:q}=q.rasterFunction.parameters);A.setUniform2fv("u_domainRange",q)}}})},"esri/views/2d/engine/imagery/processor/maskProcessor":function(){define(["./utils"],
function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/mask",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,m){const {painter:q,rasterFunction:A}=F;return q.materialManager.getProgram(D,1<A.parameters.bandCount?["multiBand"]:[])},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);const {includedRanges:A,noDataValues:x}=F.rasterFunction.parameters;m.setUniform1fv("u_includedRanges",A);m.setUniform1fv("u_noDataValues",
x)}}})},"esri/views/2d/engine/imagery/processor/ndviProcessor":function(){define(["./utils"],function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/ndvi",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,m){const {painter:q,rasterFunction:A}=F;return q.materialManager.getProgram(D,A.parameters.scaled?["scaled"]:[])},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);({bandIndexMat3:F}=F.rasterFunction.parameters);
m.setUniformMatrix3fv("u_bandIndexMat3",F)}}})},"esri/views/2d/engine/imagery/processor/remapProcessor":function(){define(["./utils"],function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/remap",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,m){return F.painter.materialManager.getProgram(D,[])},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);const {noDataRanges:A,rangeMaps:x,allowUnmatched:I,clampRange:B}=
F.rasterFunction.parameters;m.setUniform1fv("u_noDataRanges",A);m.setUniform1fv("u_rangeMaps",x);m.setUniform1f("u_unmatchMask",I?1:0);m.setUniform2fv("u_clampRange",B)}}})},"esri/views/2d/engine/imagery/processor/reprojectProcessor":function(){define(["../../../../../chunks/vec2f64","../../../../webgl/rasterUtils"],function(u,D){const F={vsPath:"raster/common",fsPath:"raster/reproject",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(m,q){const {painter:A}=m,
x=[],{interpolation:I,transformGrid:B}=q;q=!!m.rasterFunction?.parameters?.requireBilinear;m="bilinear"===I?!m.context.capabilities.textureFloat?.textureFloatLinear:q;"cubic"===I?x.push("bicubic"):m&&x.push("bilinear");B&&(x.push("applyProjection"),1===B.spacing[0]&&x.push("lookupProjection"));return A.materialManager.getProgram(F,x)},bindTextureAndUniforms:function(m,q,A){const {names:x,textures:I}=A.getTextures({forProcessing:!0});D.setTextures(m.context,q,x,I);q.setUniform1f("u_scale",1);q.setUniform2fv("u_offset",
[0,0]);q.setUniform2fv("u_coordScale",[1,1]);q.setUniformMatrix3fv("u_dvsMat3",[2,0,0,0,2,0,-1,-1,0]);q.setUniform1i("u_flipY",0);q.setUniform1f("u_opacity",1);const {width:B,height:G,source:w,transformGrid:t}=A;q.setUniform2fv("u_srcImageSize",[w.width,w.height]);q.setUniform2fv("u_targetImageSize",[B,G]);q.setUniform2fv("u_transformSpacing",t?t.spacing:u.ZEROS);q.setUniform2fv("u_transformGridSize",t?t.size:u.ZEROS)}}})},"esri/views/2d/engine/imagery/processor/slopeProcessor":function(){define(["./utils"],
function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/slope",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,m){const {painter:q,rasterFunction:A}=F;({slopeType:F}=A.parameters);return q.materialManager.getProgram(D,"percent-rise"===F?["percentRise"]:[])},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);const {width:A,height:x,resolution:I}=q,{zFactor:B,slopeType:G,pixelSizePower:w,pixelSizeFactor:t}=
F.rasterFunction.parameters;m.setUniform2fv("u_srcImageSize",[A,x]);m.setUniform2fv("u_cellSize",[I,I]);m.setUniform1f("u_zFactor",B);m.setUniform1f("u_pixelSizePower","adjusted"===G?w:0);m.setUniform1f("u_pixelSizeFactor","adjusted"===G?t:0)}}})},"esri/views/2d/engine/imagery/processor/stretchProcessor":function(){define(["./utils"],function(u){const D={vsPath:"raster/rfx/vs",fsPath:"raster/rfx/stretch",attributes:new Map([["a_position",0],["a_texcoord",1]])};return{createProgram:function(F,m){const {useGamma:q,
bandCount:A,isOutputRounded:x}=F.rasterFunction.parameters;m=[];q&&m.push("useGamma");1<A&&m.push("multiBand");x&&m.push("roundOutput");return F.painter.materialManager.getProgram(D,m)},bindTextureAndUniforms:function(F,m,q){u.setSingleImageTextures(F,m,q);u.setCoordsAndTransforms(m);const {width:A,height:x}=q;F=F.rasterFunction.parameters;m.setUniform2fv("u_srcImageSize",[A,x]);m.setUniform1f("u_minOutput",F.outMin);m.setUniform1f("u_maxOutput",F.outMax);m.setUniform1fv("u_factor",F.factor);m.setUniform1fv("u_minCutOff",
F.minCutOff);m.setUniform1fv("u_maxCutOff",F.maxCutOff);m.setUniform1fv("u_gamma",F.gamma);m.setUniform1fv("u_gammaCorrection",F.gammaCorrection)}}})},"esri/views/2d/engine/imagery/RasterTile":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/mat3f32","./RasterBitmap","../webgl/TiledDisplayObject"],function(u,D,F,m,q){q=function(A){function x(B,G,w,t,L,E,h=null){var f=I.call(this,B,G,w,t,L,E);f.bitmap=null;f.bitmap=new m.RasterBitmap(h,null,null);f.bitmap.coordScale=
[L,E];f.bitmap.once("isReady",()=>f.ready());return f}D._inherits(x,A);var I=D._createSuper(x);A=x.prototype;A.destroy=function(){D._get(D._getPrototypeOf(x.prototype),"destroy",this).call(this);this.bitmap.destroy();this.stage=this.bitmap=null};A.setTransform=function(B){D._get(D._getPrototypeOf(x.prototype),"setTransform",this).call(this,B);this.bitmap.transforms.dvs=this.transforms.dvs};A._createTransforms=function(){return{dvs:F.create(),tileMat3:F.create()}};A.onAttach=function(){this.bitmap.stage=
this.stage};A.onDetach=function(){this.bitmap.stage=null};D._createClass(x,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(B){this.bitmap.stencilRef=B}}]);return x}(q.TiledDisplayObject);u.RasterTile=q;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/imagery/BaseImageryTileSubView2D":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../core/HandleOwner ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Point ../../../../layers/support/PixelBlock ../../../../layers/support/TileInfo ../../../../layers/support/rasterDatasets/RawBlockCache ../../../../layers/support/rasterFunctions/pixelUtils ../../../../layers/support/rasterFunctions/rasterProjectionHelper ../../tiling/PagedTileQueue ../../tiling/TileInfoView ../../tiling/TileKey ../../tiling/TileQueue ../../tiling/TileStrategy ../../engine/webgl/definitions ../../../webgl/capabilities ../../../../geometry/Extent".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w,t,L,E,h,f,d,k,p,J,a,c,e,n,b,l,r){const y=[0,0];u.BaseImageryTileSubView2D=function(z){function O(){var v=Q.apply(this,arguments);v._emptyTilePixelBlock=null;v._tileStrategy=null;v._tileInfoView=null;v._fetchQueue=null;v._blockCacheRegistryUrl=null;v._blockCacheRegistryId=null;v._srcResolutions=[];v.previousLOD=null;v._needBlockCacheUpdate=!1;v._globalSymbolizerParams=null;v._symbolizerParams=null;v._abortController=null;v._isCustomTilingScheme=!1;v._rasterFunctionState=
"na";v._globalUpdateRequested=!1;v.attached=!1;v.timeExtent=null;v.redrawOrRefetch=I.debounce(async(H={})=>{if(v.previousLOD&&!v.layerView.suspended){var M=v._rasterFunctionState;H.reprocess&&(await v.updatingHandles.addPromise(v.layer.updateRasterFunction()),v.updateRasterFunctionParameters());var R=v._rasterFunctionState,{type:T}=D._assertThisInitialized(v);return H.refetch||"raster"!==T&&H.reprocess||"cpu"===R||"cpu"===M?v.updatingHandles.addPromise(v.doRefresh()):v.updatingHandles.addPromise(v._redrawImage(H.signal))}});
return v}D._inherits(O,z);var Q=D._createSuper(O);z=O.prototype;z.update=function(v){this._fetchQueue.pause();this._fetchQueue.state=v.state;this._tileStrategy.update(v);this._fetchQueue.resume();const {extent:H,resolution:M,scale:R}=v.state;v=this._tileInfoView.getClosestInfoForScale(R);if(this.layer.raster){if(!this.useProgressiveUpdate||this._needBlockCacheUpdate){const T=this._srcResolutions[v.level],X=H.toJSON?H:r.fromJSON(H);d.update(this._blockCacheRegistryUrl,this._blockCacheRegistryId,X,
M,T,this.layer.raster.ioConfig.sampling)}this._needBlockCacheUpdate=!1;this.previousLOD?.level!==v.level&&(this.previousLOD=v,null==this._symbolizerParams||this.layerView.hasTilingEffects||this._updateSymbolizerParams(),this._tileStrategy.updateCacheSize(0))}};z.moveEnd=function(){if(this.layerView.hasTilingEffects||!this.useProgressiveUpdate)this._abortController&&this._abortController.abort(),this._abortController=new AbortController,0===this._fetchQueue.length&&this._redrawImage(this._abortController.signal).then(()=>
{this._globalUpdateRequested=!1;this.layerView.requestUpdate()});const v=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy.updateCacheSize(v);this.layerView.requestUpdate()};z.attach=function(){l.getWebGLCapabilities("2d").supportsTextureFloat||(this.useWebGLForProcessing=!1);this._initializeTileInfo();this._tileInfoView=new a(this.layerView.tileInfo,this.layerView.fullExtent);var v=this._computeFetchConcurrency();this._fetchQueue=new e({tileInfoView:this._tileInfoView,concurrency:v,
process:(H,M)=>this._fetchTile1(H,M)});v=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy=new n({cachePolicy:"purge",acquireTile:H=>this.acquireTile(H),releaseTile:H=>this.releaseTile(H),cacheSize:v,tileInfoView:this._tileInfoView});this._updateBlockCacheRegistry()};z.detach=function(){this._tileStrategy.destroy();this._fetchQueue.clear();this.container.removeAllChildren();this._fetchQueue=this._tileStrategy=this._tileInfoView=null;d.unregister(this._blockCacheRegistryUrl,this._blockCacheRegistryId);
this._blockCacheRegistryUrl=this._blockCacheRegistryId=null};z.acquireTile=function(v){v=this.container.createTile(v);this._enqueueTileFetch(v);this.layerView.requestUpdate();this._needBlockCacheUpdate=!0;this._globalUpdateRequested=this.layerView.hasTilingEffects||!this.useProgressiveUpdate;return v};z.releaseTile=function(v){this._fetchQueue.abort(v.key.id);this.container.removeChild(v);v.once("detach",()=>{v.destroy();this.layerView.requestUpdate()});this.layerView.requestUpdate()};z.createEmptyTilePixelBlock=
function(v=null){const H=null==v||v.join(",")===this._tileInfoView.tileInfo.size.join(",");if(H&&x.isSome(this._emptyTilePixelBlock))return this._emptyTilePixelBlock;v=v||this._tileInfoView.tileInfo.size;const [M,R]=v;v=new h({width:M,height:R,pixels:[new Uint8Array(M*R)],mask:new Uint8Array(M*R),pixelType:"u8"});H&&(this._emptyTilePixelBlock=v);return v};z._getBandIds=function(){if(!("rasterFunctionChain"in this.container&&this.container.rasterFunctionChain))return this.layer.bandIds;const {bandIds:v,
raster:H}=this.layer,M="rasterFunction"in H?H.rasterFunction.rawInputBandIds:null;return v?.length&&M?.length&&1!==H.rasterInfo.bandCount?v.map(R=>M[Math.min(R,M.length-1)]):v||M};z.updateRasterFunctionParameters=function(){};z._fetchTile1=function(v,H){H=x.isSome(H)?H.signal:null;const M=this.canUseWebGLForProcessing(),{layerView:R}=this,{tileInfo:T}=R,X=!T.isWrappable&&x.isSome(p.getWorldWidth(R.view.spatialReference));H={allowPartialFill:!0,datumTransformation:R.datumTransformation,interpolation:M?
"nearest":this.layer.interpolation,registryId:this._blockCacheRegistryId,requestRawData:M&&this.layer.raster.hasUniqueSourceStorageInfo,skipRasterFunction:"raster"===this.type&&null!=this.container.rasterFunctionChain,signal:x.unwrap(H),srcResolution:this._srcResolutions[v.level],timeExtent:R.timeExtent,tileInfo:T,disableWrapAround:X};return this.fetchTile(v,H)};z._getCacheSize=function(v){return v?40:0};z._initializeTileInfo=function(){const {layerView:v}=this;var H=v.view.spatialReference;const M=
new E({x:v.fullExtent.xmin,y:v.fullExtent.ymax,spatialReference:H});if(this._canUseLayerLODs()){const {lods:ba}=this.layer.tileInfo,Y=ba.map(({scale:C})=>C),g=f.create({spatialReference:H,size:b.TILE_SIZE,scales:Y});this._isCustomTilingScheme=Math.abs(g.origin.x-M.x)>(H.isGeographic?.01*1E-5:.01);if(0===g.origin.x||g.origin.x>M.x)g.origin=M;if(!this._isCustomTilingScheme){const C=f.create({spatialReference:H,size:b.TILE_SIZE}).lods.map(({scale:K})=>K);this._isCustomTilingScheme=Y.some(K=>!C.some(N=>
.001>Math.abs(N-K)))}v.set("tileInfo",g);this._srcResolutions=ba.map(({resolution:C})=>({x:C,y:C}))}else{var {scales:R,srcResolutions:T,isCustomTilingScheme:X}=p.computeProjectedScales(this.layer.rasterInfo,H,b.TILE_SIZE);H=f.create({spatialReference:H,size:b.TILE_SIZE,scales:R});if(0===H.origin.x||H.origin.x>M.x)H.origin=M;this._isCustomTilingScheme=X;v.set("tileInfo",H);this._srcResolutions=T??[]}};z._canUseLayerLODs=function(){const {layer:v,layerView:H}=this;if("Map"!==v.raster.tileType)return!1;
const {lods:M}=v.tileInfo;var R=H.view.constraints?.effectiveLODs;if(R?.length!==M.length||!R.every(({scale:T},X)=>.001>Math.abs(T-M[X].scale)))return!1;R=[];for(let T=0;T<M.length-1;T++)R.push(Math.round(10*M[T].resolution/M[T+1].resolution)/10);return R.some(T=>T!==T[0])};z._computeFetchConcurrency=function(){var {blockBoundary:v}=this.layer.rasterInfo.storageInfo;v=v[v.length-1];return 64<(v.maxCol-v.minCol+1)*(v.maxRow-v.minRow+1)?2:10};z._enqueueTileFetch=async function(v,H){this.updatingHandles.addPromise(this._enqueueTileFetch1(v,
H))};z._enqueueTileFetch1=async function(v,H){if(!this._fetchQueue.has(v.key.id)){try{const M=await this._fetchQueue.push(v.key),R=this._getBandIds();let T=!this.useProgressiveUpdate||this.layerView.hasTilingEffects&&!this._globalSymbolizerParams;if(this._globalUpdateRequested&&!this.layerView.moving&&0===this._fetchQueue.length){T=!1;try{await this._redrawImage(this._abortController?.signal)}catch(Y){I.isAbortError(Y)&&A.getLogger(this.declaredClass).error(Y)}this._globalUpdateRequested=!1}!this.canUseWebGLForProcessing()&&
"rasterVF"!==this.type||this.layerView.hasTilingEffects||null!=this._symbolizerParams||this._updateSymbolizerParams();const X=this._tileInfoView.getTileCoords(y,v.key),ba=this._tileInfoView.getTileResolution(v.key);await this.updateTileSource(v,{source:M,symbolizerParams:this._symbolizerParams,globalSymbolizerParams:this._globalSymbolizerParams,suspended:T,bandIds:R,coords:X,resolution:ba});v.once("attach",()=>this.layerView.requestUpdate());this.container.addChild(v)}catch(M){I.isAbortError(M)||
A.getLogger(this.declaredClass).error(M)}this.layerView.requestUpdate()}};z._redrawImage=async function(v){0!==this.container.children.length&&(await this.layer.updateRenderer(),this.layerView.hasTilingEffects?await this._updateGlobalSymbolizerParams(v):(this._updateSymbolizerParams(),this._globalSymbolizerParams=null),v=this.container.children.map(async H=>this.updateTileSymbolizerParameters(H,{local:this._symbolizerParams,global:this._globalSymbolizerParams})),await I.eachAlways(v),this.container.requestRender())};
z._updateGlobalSymbolizerParams=async function(v){if((v=await this.layer.fetchPixels(this.layerView.view.extent,this.layerView.view.width,this.layerView.view.height,{srcResolution:this._srcResolutions[this.previousLOD.level],registryId:this._blockCacheRegistryId,signal:v}))&&v.pixelBlock){var {resolution:H}=this.previousLOD,M=this._getBandIds();v=this.layer.symbolizer.generateWebGLParameters({pixelBlock:k.extractBands(v.pixelBlock,M),isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:H,
y:H},bandIds:M});!this.canUseWebGLForProcessing()&&v&&"stretch"===v.type&&this.layer.renderer&&"raster-stretch"===this.layer.renderer.type&&(v.factor=v.factor.map(R=>255*R),v.outMin=Math.round(255*v.outMin),v.outMax=Math.round(255*v.outMax));this._globalSymbolizerParams=v}};z._updateSymbolizerParams=function(){const {resolution:v}=this.previousLOD,H=this._getBandIds();this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null,isGCS:this.layerView.view.spatialReference.isGeographic,
resolution:{x:v,y:v},bandIds:H})};z._updateBlockCacheRegistry=function(v=!1){const {layer:H,layerView:M}=this,{url:R,raster:T}=H;var {multidimensionalDefinition:X}=H.normalizeRasterFetchOptions({multidimensionalDefinition:H.multidimensionalDefinition,timeExtent:M.timeExtent});X=T.rasterInfo.multidimensionalInfo?T.getSliceIndex(X):null;X=d.getRasterId(R,X);if(X!==this._blockCacheRegistryUrl){null!=this._blockCacheRegistryUrl&&d.unregister(this._blockCacheRegistryUrl,this._blockCacheRegistryId);this._blockCacheRegistryId=
d.register(X,T.rasterInfo);if(v){({view:v}=M);const ba=this._tileInfoView.getClosestInfoForScale(v.scale);d.update(X,this._blockCacheRegistryId,v.extent,v.resolution,this._srcResolutions[ba.level],T.ioConfig.sampling)}this._blockCacheRegistryUrl=X}};z.doRefresh=async function(){if(this.attached){await this.layer.updateRenderer();this.layerView.hasTilingEffects||this._updateSymbolizerParams();this._updateBlockCacheRegistry(!0);this._fetchQueue.reset();var v=[];this._globalUpdateRequested=this.layerView.hasTilingEffects||
!this.useProgressiveUpdate;this._tileStrategy.tiles.forEach(H=>v.push(this._enqueueTileFetch(H)));await I.eachAlways(v)}};D._createClass(O,[{key:"useWebGLForProcessing",get:function(){return this._get("useWebGLForProcessing")??!0},set:function(v){this._set("useWebGLForProcessing",v)}},{key:"useProgressiveUpdate",get:function(){return this._get("useProgressiveUpdate")??!0},set:function(v){if(this._tileStrategy&&this.useProgressiveUpdate!==v){this._tileStrategy.destroy();this.container.removeAllChildren();
const H=this._getCacheSize(v);this._tileStrategy=new n({cachePolicy:"purge",acquireTile:M=>this.acquireTile(M),releaseTile:M=>this.releaseTile(M),cacheSize:H,tileInfoView:this._tileInfoView});this._set("useProgressiveUpdate",v);this.layerView.requestUpdate()}}},{key:"updating",get:function(){return this._fetchQueue?.updating||this._globalUpdateRequested||!(!this.updatingHandles||!this.updatingHandles.updating)}}]);return O}(q.HandleOwner);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,
"_fetchQueue",void 0);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"_globalUpdateRequested",void 0);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"attached",void 0);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"container",void 0);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"layer",void 0);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"layerView",void 0);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,
"type",void 0);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"useWebGLForProcessing",null);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"useProgressiveUpdate",null);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"timeExtent",void 0);F.__decorate([B.property()],u.BaseImageryTileSubView2D.prototype,"updating",null);u.BaseImageryTileSubView2D=F.__decorate([L.subclass("esri.views.2d.layers.imagery.BaseImageryTileSubView2D")],u.BaseImageryTileSubView2D);
Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define("exports ../../../geometry ../../../core/maybe ./EphemeralBlockCache ../rasterFunctions/rasterProjectionHelper ../../../geometry/Point".split(" "),function(u,D,F,m,q,A){function x(G,w){return(G=I.get(G))?G[w]??null:null}const I=new Map,B=new m;u.decreaseRefCount=function(G,w,t){const L=I.get(G);if(!L)return null==w?B.decreaseRefCount(G,t):0;if(null==w||null==L[w])return B.decreaseRefCount(G,
t);w=L[w]?.cache;G=w?.get(t);if(w&&G){G.refCount--;if(0===G.refCount){w.delete(t);for(w=0;w<L.length;w++)L[w]?.cache.delete(t);G.controller&&G.controller.abort()}return G.refCount}return 0};u.deleteBlock=function(G,w,t){const L=I.get(G);L?null==w||null==L[w]?B.deleteBlock(G,t):L[w]?.cache.delete(t):null==w&&B.deleteBlock(G,t)};u.deleteRaster=function(G){I.delete(G)};u.getBlock=function(G,w,t){const L=I.get(G);if(!L)return null==w?B.getBlock(G,t):null;if(null==w||null==L[w]){for(w=0;w<L.length;w++){var E=
L[w]?.cache.get(t);if(E)return E.refCount++,E.block}return B.getBlock(G,t)}if(G=L[w]?.cache.get(t))return G.refCount++,G.block;for(G=0;G<L.length;G++){if(G===w||!L[G])continue;E=L[G]?.cache;const h=E?.get(t);if(E&&h)return h.refCount++,E.set(t,h),h.block}return null};u.getRasterId=function(G,w){return null==w?G:`${G}?sliceId=${w}`};u.putBlock=function(G,w,t,L,E=null){const h=I.get(G);if(h)if(null==w||null==h[w])B.putBlock(G,t,L,E);else{var f={refCount:1,block:L,isResolved:!1,isRejected:!1,controller:E};
L.then(()=>f.isResolved=!0).catch(()=>f.isRejected=!0);h[w]?.cache.set(t,f)}else null==w&&B.putBlock(G,t,L,E)};u.register=function(G,w){w={extent:null,rasterInfo:w,cache:new Map};const t=I.get(G);if(t)return t.push(w),t.length-1;I.set(G,[w]);return 0};u.unregister=function(G,w){const t=I.get(G);t&&(t[w]=null,t.some(L=>null!=L)||I.delete(G))};u.update=function(G,w,t,L,E,h,f=null){if(G=x(G,w)){w=G.extent;var {cache:d,rasterInfo:k}=G;if(!w||w.xmin!==t.xmin||w.xmax!==t.xmax||w.ymin!==t.ymin||w.ymax!==
t.ymax){L=L??0;w=t.clone().normalize();var {spatialReference:p,transform:J}=k,a=new Set;for(let r=0;r<w.length;r++){var c=w[r];if(c.xmax-c.xmin<=L||c.ymax-c.ymin<=L)continue;var e=q.projectExtent(c,p,f);F.isSome(J)&&(e=J.inverseTransform(e));var n=new A({x:L,y:L,spatialReference:c.spatialReference});if(null==E&&(E=q.projectResolution(n,p,c,f),!E))return;const {pyramidLevel:y,pyramidResolution:z,excessiveReading:O}=q.snapPyramid(E,k,h||"closest");if(O)return;({storageInfo:c}=k);var {origin:b}=c;n=
Math.max(0,Math.floor((e.xmin-b.x)/z.x));b=Math.max(0,Math.floor((b.y-e.ymax)/z.y));const Q=0<y?c.pyramidBlockWidth:c.blockWidth,v=0<y?c.pyramidBlockHeight:c.blockHeight;c=Math.max(0,Math.floor(n/Q)-1);var l=Math.max(0,Math.floor(b/v)-1);n=Math.floor((n+Math.ceil((e.xmax-e.xmin)/z.x-.1)-1)/Q)+1;e=Math.floor((b+Math.ceil((e.ymax-e.ymin)/z.y-.1)-1)/v)+1;for(b=l;b<=e;b++)for(l=c;l<=n;l++)a.add(`${y}/${b}/${l}`)}d.forEach((r,y)=>{a.has(y)||(r=d.get(y),(null==r||r.isResolved||r.isRejected)&&d.delete(y))});
G.extent={xmin:t.xmin,ymin:t.ymin,xmax:t.xmax,ymax:t.ymax}}}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(u){return function(){function D(m=15E3,q=5E3){this._timer=null;this._cachedBlocks=new Map;this._size=-1;this._duration=m;this._interval=Math.min(m,q)}var F=D.prototype;F.decreaseRefCount=function(m,q){m=m+"/"+q;q=this._cachedBlocks;if(q.has(m)){const A=
q.get(m);A.refCount--;0>=A.refCount&&(q.delete(m),A.controller&&A.controller.abort());return A.refCount}return 0};F.getBlock=function(m,q){m=m+"/"+q;q=this._cachedBlocks;if(q.has(m)){const A=q.get(m);A.ts=Date.now();A.refCount++;q.delete(m);q.set(m,A);return A.block}return null};F.putBlock=function(m,q,A,x){const I=this._cachedBlocks;m=m+"/"+q;I.has(m)?(A=I.get(m),A.ts=Date.now(),A.refCount++):I.set(m,{block:A,ts:Date.now(),refCount:1,controller:x});this._trim();this._updateTimer()};F.deleteBlock=
function(m,q){const A=this._cachedBlocks;m=m+"/"+q;A.has(m)&&A.delete(m)};F.updateMaxSize=function(m){this._size=m;this._trim()};F.empty=function(){this._cachedBlocks.clear();this._clearTimer()};F.getCurrentSize=function(){return this._cachedBlocks.size};F._updateTimer=function(){if(null==this._timer){var m=this._cachedBlocks;this._timer=setInterval(()=>{const q=Array.from(m),A=Date.now();for(let x=0;x<q.length;x++)if(q[x][1].ts<=A-this._duration)m.delete(q[x][0]);else break;0===m.size&&this._clearTimer()},
this._interval)}};F._trim=function(){const m=this._cachedBlocks;if(!(-1===this._size||this._size>=m.size)){var q=Array.from(m);for(let A=0;A<q.length-this._size;A++)m.delete(q[A][0])}};F._clearTimer=function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)};return u._createClass(D)}()})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w){function t(g,C,K){return!x.canProjectWithoutEngine(g,C,K)}function L(g,C,K){if((g=t(g,C,K))&&!x.isLoaded())throw new F("rasterprojectionhelper-project","projection engine is not loaded");return g}function E(g,C,K,N=null){const U=g.spatialReference;if(U.equals(C))return g;L(U,C,N);K=K.center;K=new I({xmin:K.x-g.x/2,xmax:K.x+g.x/2,ymin:K.y-g.y/2,ymax:K.y+g.y/2,spatialReference:U});N=x.project(K,C,N);K=z(C);m.isNone(N)||m.isSome(K)&&N.width>=K?(C=q.getMetersPerUnitForSR(U)/
q.getMetersPerUnitForSR(C),g={x:g.x*C,y:g.y*C}):g={x:N.width,y:N.height};return g}function h(g,C=.01){return q.getMetersPerUnitForSR(g)?C/q.getMetersPerUnitForSR(g):0}function f(g,C,K=null,N=!0){const U=g.spatialReference;if(U.equals(C))return g;L(U,C,K);K=x.project(g,C,K);if(!N||!K)return K;d([g],[K],U,C);return K}function d(g,C,K,N){const U=O(K,!0),P=O(N,!0);K=h(K,500);N=h(N,500);if(K&&m.isSome(U)&&m.isSome(P))for(let V=0;V<g.length;V++){const W=C[V];if(!W)continue;const {x:S}=g[V],{x:Z}=W;Z>=P[1]-
N&&Math.abs(S-U[0])<K?W.x-=P[1]-P[0]:Z<=P[0]+N&&Math.abs(S-U[1])<K&&(W.x+=P[1]-P[0])}}function k(g){const {inSR:C,outSR:K,datumTransformation:N,preferPE:U}=g;if(C.equals(K))return{points:g}=e(g,null),g;if(C.isWebMercator&&K.isWGS84||C.isWGS84&&K.isWebMercator){const {cols:Z,rows:aa,xres:ca,yres:ea,usePixelCenter:da,inSR:ia,outSR:fa}=g;let {xmin:ja,ymax:ha}=g;da&&(ja+=ca/2,ha-=ea/2);g=[];var P=[],V=Math.max(Z,aa);for(var W=0;W<V;W++){var S=x.project(new B({x:ja+ca*Math.min(Z,W),y:ha-ea*Math.min(aa,
W),spatialReference:ia}),fa);W<=Z&&g.push(S.x);W<=aa&&P.push(S.y)}V=[];for(W=0;W<Z;W++)for(S=0;S<aa;S++)V.push([g[W],P[S]]);return V}if(L(C,K,N)&&U){if(C.isGeographic)return J(g);P=a(C);if(m.isSome(P))return J(g)}return p(g)}function p(g){var {points:C}=e(g,null);const {inSR:K,outSR:N,datumTransformation:U}=g;g=C.map(P=>new B(P[0],P[1],K));C=x.project(g,N,U);U&&d(g,C,K,N);return C.map(P=>P?[P.x,P.y]:[NaN,NaN])}function J(g){const {inSR:C,outSR:K,datumTransformation:N}=g;var U=a(C);const {points:P,
mask:V}=e(g,U);C.isGeographic||(g=C.wkid?A.PeFactory.coordsys(C.wkid):A.PeFactory.fromString(C.isGeographic?A.PeDefs.PE_TYPE_GEOGCS:A.PeDefs.PE_TYPE_PROJCS,C.wkt),A.PeCSTransformations.projToGeog(g,P.length,P));if(m.isSome(N)&&N.steps.length){var W;K.isGeographic&&(W=P.map(([S])=>179.9955<S?1:-179.9955>S?-1:0));N.steps.forEach(S=>{const Z=S.wkid?A.PeFactory.geogtran(S.wkid):A.PeFactory.fromString(A.PeDefs.PE_TYPE_GEOGTRAN,S.wkt);A.PeGTTransformations.geogToGeog(Z,P.length,P,null,S.isInverse?A.PeDefs.PE_TRANSFORM_2_TO_1:
A.PeDefs.PE_TRANSFORM_1_TO_2)});if(W)for(g=0;g<P.length;g++){U=W[g];const S=P[g][0],Z=179.9955<S?1:-179.9955>S?-1:0;U&&Z&&U!==Z&&(P[g][0]=0<U?S+360:S-360)}}K.isGeographic||(W=a(K,!0),W=m.isSome(W)&&W.isEnvelope?[W.bbox[1],W.bbox[3]]:[-90,90],n(P,W),W=K.wkid?A.PeFactory.coordsys(K.wkid):A.PeFactory.fromString(K.isGeographic?A.PeDefs.PE_TYPE_GEOGCS:A.PeDefs.PE_TYPE_PROJCS,K.wkt),A.PeCSTransformations.geogToProj(W,P.length,P));W=P;if(V&&P.length!==V.length){W=[];for(let S=0,Z=0;S<V.length;S++)V[S]?W.push(P[Z++]):
W.push([NaN,NaN])}return W}function a(g,C=!1){var K=g.wkid||g.wkt;if(!K||g.isGeographic)return null;K=String(K);if(ba.has(K))return K=ba.get(K),C?K?.gcs:K?.pcs;var N=g.wkid?A.PeFactory.coordsys(g.wkid):A.PeFactory.fromString(g.isGeographic?A.PeDefs.PE_TYPE_GEOGCS:A.PeDefs.PE_TYPE_PROJCS,g.wkt);g=h(g,1E-4);g=c(N,g);N=c(N,0,!0);ba.set(K,{pcs:g,gcs:N});return C?N:g}function c(g,C=0,K=!1){var N=A.PePCSInfo.generate(g),U=K?g.horizonGcsGenerate():g.horizonPcsGenerate();if(!N||!U?.length)return null;g=!1;
var P=U.find(aa=>1===aa.getInclusive()&&1===aa.getKind());if(!P){P=U.find(aa=>1===aa.getInclusive()&&0===aa.getKind());if(!P)return null;g=!0}K=K?0:(2===N.getNorthPoleLocation()?1:0)|(2===N.getSouthPoleLocation()?2:0);N=N.isPannableRectangle();P=P.getCoord();if(g)return{isEnvelope:g,isPannable:N,vertices:P,coef:null,bbox:[P[0][0]-C,P[0][1]-C,P[1][0]+C,P[1][1]+C],poleLocation:K};C=0;g=[];let [V,W]=P[0],[S,Z]=P[0];for(let aa=0,ca=P.length;aa<ca;aa++){C++;C===ca&&(C=0);const [ea,da]=P[aa],[ia,fa]=P[C];
if(fa===da)g.push([ea,ia,da,fa,2]);else{U=(ia-ea)/(fa-da||1E-4);const ja=ea-U*da;da<fa?g.push([U,ja,da,fa,0]):g.push([U,ja,fa,da,1])}V=V<ea?V:ea;W=W<da?W:da;S=S>ea?S:ea;Z=Z>da?Z:da}return{isEnvelope:!1,isPannable:N,vertices:P,coef:g,bbox:[V,W,S,Z],poleLocation:K}}function e(g,C){const K=[],{cols:N,rows:U,xres:P,yres:V,usePixelCenter:W}=g;let {xmin:S,ymax:Z}=g;W&&(S+=P/2,Z-=V/2);if(m.isNone(C)){for(g=0;g<N;g++)for(C=0;C<U;C++)K.push([S+P*g,Z-V*C]);return{points:K}}g=new Uint8Array(N*U);if(C.isEnvelope){const {bbox:[ja,
ha,la,na]}=C;for(let oa=0,pa=0;oa<N;oa++){var aa=S+P*oa,ca=C.isPannable||aa>=ja&&aa<=la;for(var ea=0;ea<U;ea++,pa++){var da=Z-V*ea;ca&&da>=ha&&da<=na&&(K.push([aa,da]),g[pa]=1)}}return{points:K,mask:g}}aa=C.coef;C=[];for(ca=0;ca<U;ca++){var ia=Z-V*ca;ea=[];da=[];for(var fa=0;fa<aa.length;fa++){const [ja,ha,la,na,oa]=aa[fa];ia===la&&la===na?(ea.push(ja),ea.push(ha),da.push(2),da.push(2)):ia>=la&&ia<=na&&(ea.push(ja*ia+ha),da.push(oa))}ia=ea;if(2<ea.length){fa=2===da[0]?0:da[0];let ja=ea[0];ia=[];for(let ha=
1;ha<da.length;ha++)if(2!==da[ha]||ha===da.length-1)da[ha]!==fa&&(ia.push(0===fa?Math.min(ja,ea[ha-1]):Math.max(ja,ea[ha-1])),fa=da[ha],ja=ea[ha]),ha===da.length-1&&ia.push(0===da[ha]?Math.min(ja,ea[ha]):Math.max(ja,ea[ha]));ia.sort((ha,la)=>ha-la)}else ea[0]>ea[1]&&(ia=[ea[1],ea[0]]);C.push(ia)}for(let ja=0,ha=0;ja<N;ja++)for(aa=S+P*ja,ca=0;ca<U;ca++,ha++)if(ea=Z-V*ca,da=C[ca],2===da.length)aa>=da[0]&&aa<=da[1]&&(K.push([aa,ea]),g[ha]=1);else if(2<da.length){ia=!1;for(fa=0;fa<da.length;fa+=2)if(aa>=
da[fa]&&aa<=da[fa+1]){ia=!0;break}ia&&(K.push([aa,ea]),g[ha]=1)}return{points:K,mask:g}}function n(g,C){const [K,N]=C;for(C=0;C<g.length;C++){const U=g[C][1];if(U<K||U>N)g[C]=[NaN,NaN]}}function b(g){const C=z(g[0].spatialReference);if(2>g.length||m.isNone(C))return g[0];const K=h(g[0].spatialReference);g=g.filter(W=>W.width>K);if(1===g.length)return g[0];let {xmin:N,xmax:U,ymin:P,ymax:V}=g[0];for(let W=1;W<g.length;W++){const S=g[W];U=S.xmax+C*W;P=Math.min(P,S.ymin);V=Math.max(V,S.ymax)}return new I({xmin:N,
xmax:U,ymin:P,ymax:V,spatialReference:g[0].spatialReference})}function l(g,C,K=null,N=!0){var U=g.spatialReference;if(U.equals(C))return g;var P=v(g);const V=z(U,!0);var W=z(C);if(0===P||m.isNone(V)||m.isNone(W))return P=y(g,C,K,N),m.isNone(V)&&m.isSome(W)&&Math.abs(P.width-W)<h(C)&&x.isLoaded()&&(U=a(U),m.isSome(U)&&U.poleLocation===R.None&&g.width<(U.bbox[2]-U.bbox[0])/2)?r(g,C)||P:P;W=g.clone().normalize();if(1===W.length&&g.xmax<V&&g.xmax-V/2>h(U)){const {xmin:S,xmax:Z}=g;for(let aa=0;aa<=P;aa++)W[aa]=
new I({xmin:0===aa?S:-V/2,xmax:aa===P?Z-V*aa:V/2,ymin:g.ymin,ymax:g.ymax,spatialReference:U})}g=W.map(S=>y(S,C,K,N));return b(g.filter(m.isSome))}function r(g,C){const K=z(C);if(m.isNone(K))return null;let {xmin:N,ymin:U,xmax:P,ymax:V}=g;var W=g.spatialReference;g=new G({spatialReference:W,rings:[[[N,U],[P,U],[P,V],[N,V],[N,U]]]});g=x.project(g,C);if(2!==g.rings.length||!g.rings[0].length||!g.rings[1].length)return null;({rings:g}=g);W=h(W);C=new I({spatialReference:C});for(let S=0;2>S;S++){N=P=g[S][0][0];
U=V=g[S][0][1];for(let Z=0;Z<g[S].length;Z++)N=N>g[S][Z][0]?g[S][Z][0]:N,P=P<g[S][Z][0]?g[S][Z][0]:P,U=U>g[S][Z][1]?g[S][Z][1]:U,V=V<g[S][Z][1]?g[S][Z][1]:V;if(0===S)C.ymin=U,C.ymax=V,C.xmin=N,C.xmax=P;else if(C.ymin=Math.min(C.ymin,U),C.ymax=Math.max(C.ymax,V),Math.abs(P-K/2)<W)C.xmin=N,C.xmax+=K;else if(Math.abs(N+K/2)<W)C.xmax=P+K;else return null}return C}function y(g,C,K=null,N=!0,U=!0){const P=g.spatialReference;if(P.equals(C)||!C)return g;L(P,C,K);const V=x.project(g,C,K);if(U&&C.isWebMercator&&
V&&(V.ymax=Math.min(2.0037508342787E7,V.ymax),V.ymin=Math.max(-2.0037508342787E7,V.ymin),V.ymin>=V.ymax))return null;if(!N||!V)return V;var W=O(P,!0);N=O(C,!0);if(m.isNone(W)||m.isNone(N))return V;U=h(P,.001);const S=h(P,500);var Z=h(C,.001);if(Math.abs(V.xmin-N[0])<Z&&Math.abs(V.xmax-N[1])<Z){Z=Math.abs(g.xmin-W[0]);W=Math.abs(W[1]-g.xmax);if(Z<U&&W>S){V.xmin=N[0];var aa=[];aa.push(new B(g.xmax,g.ymin,P));aa.push(new B(g.xmax,(g.ymin+g.ymax)/2,P));aa.push(new B(g.xmax,g.ymax,P));aa=aa.map(ca=>f(ca,
C,K)).filter(ca=>!isNaN(ca?.x)).map(ca=>ca.x);V.xmax=Math.max.apply(null,aa)}W<U&&Z>S&&(V.xmax=N[1],N=[],N.push(new B(g.xmin,g.ymin,P)),N.push(new B(g.xmin,(g.ymin+g.ymax)/2,P)),N.push(new B(g.xmin,g.ymax,P)),g=N.map(ca=>f(ca,C,K)).filter(ca=>!isNaN(ca?.x)).map(ca=>ca.x),V.xmin=Math.min.apply(null,g))}else g=h(C,.001),Math.abs(V.xmin-N[0])<g&&(V.xmin=N[0]),Math.abs(V.xmax-N[1])<g&&(V.xmax=N[1]);return V}function z(g,C=!1){return g?g.isWebMercator?2*(C?2.0037508342787E7:2.0037508342788905E7):g.wkid&&
g.isGeographic?360:2*X[g.wkid]||null:null}function O(g,C=!1){if(g.isGeographic)return[-180,180];g=z(g,C);return m.isSome(g)?[-g/2,g/2]:null}function Q(g,C,K,N){g=(g-C)/K;0!==g-Math.floor(g)?g=Math.floor(g):N&&--g;return g}function v(g,C=!1){var K=z(g.spatialReference);if(m.isNone(K))return 0;const N=C?0:-(K/2),U=h(g.spatialReference),P=!C&&Math.abs(g.xmin+K/2)<U?-K/2:g.xmin;g=Q(!C&&Math.abs(g.xmax-K/2)<U?K/2:g.xmax,N,K,!0);K=Q(P,N,K,!1);return g-K}function H(g){const {projectedExtent:C,srcBufferExtent:K,
pixelSize:N,datumTransformation:U,rasterTransform:P}=g;var V=C.spatialReference;const W=K.spatialReference;var S=L(V,W);const {xmin:Z,ymin:aa,xmax:ca,ymax:ea}=C,da=z(W),ia=m.isSome(da)&&(g.hasWrapAround||"gcs-shift"===P?.type);g=g.spacing||[32,32];var fa=g[0]*N.x,ja=g[1]*N.y;const ha=1===g[0],la=Math.ceil((ca-Z)/fa-.1/g[0])+(ha?0:1),na=Math.ceil((ea-aa)/ja-.1/g[1])+(ha?0:1);fa=k({cols:la,rows:na,xmin:Z,ymax:ea,xres:fa,yres:ja,inSR:V,outSR:W,datumTransformation:U,preferPE:4>=g[0],usePixelCenter:ha});
ja=[];let oa,pa=0;const ma=ha?-1:NaN,{xmin:ta,xmax:qa,ymax:ua,width:va,height:wa}=K,xa=h(W,500),ya=m.isSome(da)&&0<ta&&qa>da/2;var ra=!1;S&&(ra=a(V),ra=m.isSome(ra)&&0<ra.poleLocation);for(V=0;V<la;V++){S=[];for(let sa=0;sa<na;sa++){var ka=fa[V*na+sa];ia&&ka[0]>qa&&ka[0]>da/2-xa?ka[0]-=da:ia&&0===V&&0>ka[0]&&ya&&!P&&(ka[0]+=da);!ka||isNaN(ka[0])||isNaN(ka[1])?(ja.push(ma),ja.push(ma),S.push(null),pa++):(P&&(ka=P.inverseTransform(new B({x:ka[0],y:ka[1],spatialReference:W})),ka=[ka.x,ka.y]),S.push(ka),
0<V&&ia&&oa[sa]&&ka[0]<oa[sa][0]&&(ka[0]+=da,ra&&ka[0]>qa&&ka[0]>da&&(ka[0]-=da)),ja.push((ka[0]-ta)/va),ja.push((ua-ka[1])/wa))}oa=S}return{offsets:ja,error:null,coefficients:null,outofBoundPointCount:pa,spacing:g,size:ha?[la,na]:[la-1,na-1]}}function M(g,C,K){const {cols:N,rows:U}=C;C=new Float32Array((N-1)*(U-1)*12);const P=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),V=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let ea=0;ea<N-1;ea++){for(var W=0;W<U-1;W++){var S=ea*U*2+2*W,Z=g[S];const da=g[S+
1];var aa=g[S+2],ca=g[S+3];S+=2*U;const ia=g[S],fa=g[S+1],ja=g[S+2];S=g[S+3];let ha=0,la=12*(W*(N-1)+ea);for(let na=0;3>na;na++)C[la++]=P[ha++]*Z+P[ha++]*aa+P[ha++]*ja;ha=0;for(aa=0;3>aa;aa++)C[la++]=P[ha++]*da+P[ha++]*ca+P[ha++]*S;ha=0;for(ca=0;3>ca;ca++)C[la++]=V[ha++]*Z+V[ha++]*ia+V[ha++]*ja;ha=0;for(Z=0;3>Z;Z++)C[la++]=V[ha++]*da+V[ha++]*fa+V[ha++]*S}if(K)for(W=0;W<C.length;W++)isNaN(C[W])&&(C[W]=-1)}return C}var R;(function(g){g[g.None=0]="None";g[g.North=1]="North";g[g.South=2]="South";g[g.Both=
3]="Both"})(R||(R={}));const T=(g,C,K,N=0)=>{if(1===K[0])return[0,0];var U=1,P=-1,V=1,W=-1;for(var S=0;S<g.length;S+=2)isNaN(g[S])||(U=U>g[S]?g[S]:U,P=P>g[S]?P:g[S],V=V>g[S+1]?g[S+1]:V,W=W>g[S+1]?W:g[S+1]);const {cols:Z,rows:aa}=C;C=(P-U)/Z/K[0];K=(W-V)/aa/K[1];N*=2;V=0;W=!1;U=[0,0];for(P=0;P<Z-3;P++){for(S=0;S<aa-3;S++){var ca=P*aa*2+2*S;const ea=Math.abs(((g[ca]+g[ca+4]+g[ca+4*aa]+g[ca+4*aa+4])/4-g[ca+2*aa+2])/C);ca=Math.abs(((g[ca+1]+g[ca+5]+g[ca+4*aa+1]+g[ca+4*aa+5])/4-g[ca+2*aa+3])/K);ea+ca>
V&&(V=ea+ca,U=[ea,ca]);if(N&&V>N){W=!0;break}}if(W)break}return U},X={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,
54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},ba=new Map,Y=new Map;u.computeProjectedScales=function(g,C,K=512,N=!0){const {extent:U,spatialReference:P,pixelSize:V}=g,W=E(new B({x:V.x,y:V.y,spatialReference:P}),C,U);if(null==W)return{projectedPixelSize:null,
scales:null,srcResolutions:null,isCustomTilingScheme:!1};const S=(W.x+W.y)/2,Z=q.getMetersPerUnitForSR(C);var aa=S*Z*96*39.37,ca=C.isGeographic?256/K*2.958287637958547E8:256/K*5.91657527591555E8,ea="vector-magdir"===g.dataType||"vector-uv"===g.dataType,da=l(U,C),ia=Math.min(Math.ceil(Math.log(Math.min(g.width,g.height)/32)/Math.LN2),Math.ceil(Math.log(ca/2/aa)/Math.LN2));!ea&&N&&(C.isGeographic||C.isWebMercator)&&(ea=0>da.xmin*da.xmax,!ea&&3>ia&&(N=z(C),m.isSome(N)&&(ea=2**ia*S*K,K=Math.ceil(N/ea),
ea=1===K||2===K&&N/2-da.xmax<ea)));N=aa;g=Math.min(2,Math.max(1.414,g.storageInfo?.pyramidScalingFactor||2));if(ea)N=ca,ca=C.isGeographic?1.341104507446289E-6:.29858214164761665,ia=96*ca*Z*39.37,C=E(new B({x:ca,y:ca,spatialReference:{wkid:C.isGeographic?4326:3857}}),P,da),C.x*=N/ia,C.y*=N/ia;else{C={x:V.x,y:V.y};for(da=0;N<.5005*ca&&da<ia;)da++,N*=g,C.x*=g,C.y*=g;1.001>=Math.max(N,ca)/Math.min(N,ca)&&(N=ca)}ca=[N];da=[{x:C.x,y:C.y}];for(aa=Math.min(70.5310735,aa)/1.001;N>=aa;)N/=g,C.x/=g,C.y/=g,ca.push(N),
da.push({x:C.x,y:C.y});return{projectedPixelSize:W,scales:ca,srcResolutions:da,isCustomTilingScheme:!ea}};u.defaultGridSpacing=32;u.defaultProjectionToleranceInPixels=4;u.getDefaultDatumTransformationForDataset=function(g,C,K){return L(g.spatialReference,C)?K?x.getTransformation(C,g.spatialReference,g):x.getTransformation(g.spatialReference,C,g):null};u.getProjectedGridPoints=k;u.getProjectionOffsetGrid=function(g){var C=g.isAdaptive&&null==g.spacing;let K=g.spacing||[32,32],N=H(g);var U={cols:N.size[0]+
1,rows:N.size[1]+1};const P=0<N.outofBoundPointCount&&N.outofBoundPointCount<N.offsets.length/2;let V=N.outofBoundPointCount===N.offsets.length/2||C&&P?[0,0]:T(N.offsets,U,K,4);const W=(V[0]+V[1])/2;var S=g.projectedExtent.spatialReference;const Z=g.srcBufferExtent.spatialReference;C&&(P||4<W)&&(t(S,Z,g.datumTransformation)&&(S.isGeographic||m.isSome(a(S))),K=[4,4],N=H({...g,spacing:K}),U={cols:N.size[0]+1,rows:N.size[1]+1},V=T(N.offsets,U,K,4));N.error=V;1<K[0]&&(N.coefficients=M(N.offsets,U,P));
!g.includeGCSGrid||S.isGeographic||S.isWebMercator||(Z.isGeographic?N.gcsGrid={offsets:N.offsets,coefficients:N.coefficients,spacing:K}:(C=a(S),m.isSome(C)&&!C.isEnvelope&&(S&&!S.isGeographic&&(C=String(S.wkid||S.wkt),Y.has(C)?S=Y.get(C):(S=(S.wkid?A.PeFactory.coordsys(S.wkid):A.PeFactory.fromString(A.PeDefs.PE_TYPE_PROJCS,S.wkt)).getGeogcs().getCode(),Y.set(C,S)),S=new w({wkid:S})),S=l(g.projectedExtent,S),{offsets:g}=H({...g,srcBufferExtent:S,spacing:K}),U=M(g,U,P),N.gcsGrid={offsets:g,coefficients:U,
spacing:K})));return N};u.getRasterDatasetAlignmentInfo=function(g){const C=g.storageInfo.origin.x;var K=z(g.spatialReference,!0);if(m.isNone(K))return{originX:C,halfWorldWidth:null,pyramidsInfo:null};const N=K/2,{nativePixelSize:U,storageInfo:P,extent:V}=g,{maximumPyramidLevel:W,blockWidth:S,pyramidScalingFactor:Z}=P;let aa=U.x;const ca=[];g=m.isSome(g.transform)&&"gcs-shift"===g.transform.type;const ea=C+(g?0:N);K=g?K-C:N-C;for(let da=0;da<=W;da++){const ia=(V.xmax-C)/aa/S,fa=K/aa/S;ca.push({resolutionX:aa,
blockWidth:S,datsetColumnCount:0===ia-Math.floor(ia)?ia:Math.ceil(ia),worldColumnCountFromOrigin:0===fa-Math.floor(fa)?fa:Math.ceil(fa),leftMargin:Math.round(ea/aa)%S,rightPadding:(S-Math.round(K/aa)%S)%S,originColumnOffset:Math.floor(ea/aa/S)});aa*=Z}return{originX:C,halfWorldWidth:N,pyramidsInfo:ca,hasGCSSShiftTransform:g}};u.getWorldWidth=z;u.getWorldWrapCount=v;u.load=async function(){x.isLoaded()||await x.load()};u.minimumGridSpacing=4;u.projectExtent=l;u.projectPoint=f;u.projectResolution=E;
u.requirePE=t;u.snapExtent=function(g){g=g.clone().normalize();return 1===g.length?g[0]:b(g)};u.snapPyramid=function(g,C,K){const {storageInfo:N,pixelSize:U}=C;var P=0;let V=!1;var {pyramidResolutions:W}=N;if(m.isSome(W)&&W.length){g=(g.x+g.y)/2;var S=W[W.length-1];S=(S.x+S.y)/2;var Z=(U.x+U.y)/2;if(g<=Z)P=0;else if(g>=S)P=W.length,V=8<g/S;else{S=Z;for(let aa=1;aa<=W.length;aa++){Z=(W[aa-1].x+W[aa-1].y)/2;if(g<=Z){g===Z?P=aa:"down"===K?(P=aa-1,V=8<g/S):P="up"===K?aa:g-S>Z-g||2<g/S?aa:aa-1;break}S=
Z}}K=0===P?U:W[P-1];V&&(W=Math.min(K.x,K.y),g=q.getMetersPerUnitForSR(C.spatialReference),19567<W*g&&(V=!1));return{pyramidLevel:P,pyramidResolution:new B({x:K.x,y:K.y,spatialReference:C.spatialReference}),excessiveReading:V}}P=Math.log(g.x/U.x)/Math.LN2;g=Math.log(g.y/U.y)/Math.LN2;W=C.storageInfo.maximumPyramidLevel||0;P="down"===K?Math.floor(Math.min(P,g)):"up"===K?Math.ceil(Math.max(P,g)):Math.round((P+g)/2);0>P?P=0:P>W&&(V=P>W+3,P=W);K=2**P;C=new B({x:K*C.nativePixelSize.x,y:K*C.nativePixelSize.y,
spatialReference:C.spatialReference});return{pyramidLevel:P,pyramidResolution:C,excessiveReading:V}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/imagery/VectorFieldTileView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/maybe ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../layers/support/rasterFunctions/vectorFieldUtils ../../engine/imagery/RasterVFTileContainer ./BaseImageryTileSubView2D".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w,t){A=function(L){function E(){var f=h.apply(this,arguments);f._handle=null;f.type="rasterVF";return f}u._inherits(E,L);var h=u._createSuper(E);L=E.prototype;L.canUseWebGLForProcessing=function(){return!1};L.fetchTile=async function(f,d){d={...d,interpolation:"nearest",requestProjectedLocalDirections:!0};f=await this.layer.fetchTile(f.level,f.row,f.col,d);"vector-magdir"===this.layer.rasterInfo.dataType&&f?.pixelBlock&&(f.pixelBlock=await this.layer.convertVectorFieldData(f.pixelBlock,
d));return f};L.updateTileSource=function(f,d){const k=d.symbolizerParams,{tileData:p}=f;p.key=f.key;p.width=this._tileInfoView.tileInfo.size[0];p.height=this._tileInfoView.tileInfo.size[1];({symbolTileSize:f}=k);({source:d}=d);p.offset=this._getTileSymbolOffset(p.key,f);F.isSome(d)&&F.isSome(d.pixelBlock)?(p.rawPixelData={extent:d.extent,pixelBlock:d.pixelBlock},p.symbolizerParameters=k,p.source=this._sampleVectorFieldData(d.pixelBlock,k,p.offset)):(d=this.createEmptyTilePixelBlock([Math.round((this._tileInfoView.tileInfo[0]-
p.offset[0])/f),Math.round((this._tileInfoView.tileInfo[1]-p.offset[1])/f)]),p.source=d,p.symbolizerParameters=k);p.invalidateVAO();return Promise.resolve()};L.updateTileSymbolizerParameters=function(f,d){var k=d.local;({symbolTileSize:d}=k);({tileData:f}=f);f.offset=this._getTileSymbolOffset(f.key,d);const p=f.symbolizerParameters.symbolTileSize;f.symbolizerParameters=k;k=f.rawPixelData?.pixelBlock;F.isSome(k)&&p!==d&&(f.source=this._sampleVectorFieldData(k,f.symbolizerParameters,f.offset));return Promise.resolve()};
L.attach=function(){u._get(u._getPrototypeOf(E.prototype),"attach",this).call(this);this.container=new w.RasterVFTileContainer(this._tileInfoView);this.container.isCustomTilingScheme=this._isCustomTilingScheme;this._updateSymbolType(this.layer.renderer);this._handle=m.watch(()=>this.layer.renderer,f=>this._updateSymbolType(f))};L.detach=function(){u._get(u._getPrototypeOf(E.prototype),"detach",this).call(this);this.container.removeAllChildren();this._handle?.remove();this.container=this._handle=null};
L._getTileSymbolOffset=function(f,d){const k=f.col*this._tileInfoView.tileInfo.size[0]%d;f=f.row*this._tileInfoView.tileInfo.size[1]%d;return[k>d/2?d-k:-k,f>d/2?d-f:-f]};L._sampleVectorFieldData=function(f,d,k){({symbolTileSize:d}=d);return G.sampleVectorField(f,"vector-uv",d,k)};L._updateSymbolType=function(f){"vector-field"===f.type&&(this.container.symbolTypes="wind-barb"===f.style?["scalar","triangle"]:"simple-scalar"===f.style?["scalar"]:["triangle"])};return u._createClass(E)}(t.BaseImageryTileSubView2D);
D.__decorate([q.property()],A.prototype,"container",void 0);D.__decorate([q.property()],A.prototype,"layer",void 0);D.__decorate([q.property()],A.prototype,"type",void 0);return A=D.__decorate([B.subclass("esri.views.2d.layers.imagery.VectorFieldTileView2D")],A)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../../../core/maybe","../PixelBlock","./pixelUtils"],function(u,D,F,m,q){function A(b,l){return d.get(b)/d.get(l)||1}function x(b,
l="geographic"){const [r,y]=b;b=Math.sqrt(r*r+y*y);let z=Math.atan2(y,r)*k;z=(360+z)%360;"geographic"===l&&(z=(450-z)%360);return[b,z]}function I(b,l="geographic"){let r=b[1];"geographic"===l&&(r=(450-r)%360);r%=360;b=b[0];return[b*Math.cos(r/k),b*Math.sin(r/k)]}function B(b,l,r="geographic",y=1){if(!q.isValidPixelBlock(b))return b;const {pixels:z,width:O,height:Q}=b;var v=O*Q;const H=z[0],M=z[1],R=b.pixelType.startsWith("f")?b.pixelType:"f32",T=m.createEmptyBand(R,v);v=m.createEmptyBand(R,v);let X=
0;for(let ba=0;ba<Q;ba++)for(let Y=0;Y<O;Y++)"vector-uv"===l?([T[X],v[X]]=x([H[X],M[X]],r),T[X]*=y):([T[X],v[X]]=I([H[X],M[X]],r),T[X]*=y,v[X]*=y),X++;b=new m({pixelType:R,width:b.width,height:b.height,mask:b.mask,validPixelCount:b.validPixelCount,maskIsAlpha:b.maskIsAlpha,pixels:[T,v]});b.updateStatistics();return b}function G(b=0,l=0,r=Math.PI,y=!0){y&&(r=(2*Math.PI-r)%(2*Math.PI));y=y?-1:1;const z=-7*y,O=-2*y,Q=-16*y,[v,H]=t(0,l+13*y,r,21.75),[M,R]=t(b-5.5,l+z,r,21.75),[T,X]=t(b+5.5,l+z,r,21.75),
[ba,Y]=t(b-1.5,l+O,r,21.75),[g,C]=t(b+1.5,l+O,r,21.75),[K,N]=t(b-1.5,l+Q,r,21.75),[U,P]=t(b+1.5,l+Q,r,21.75);return[v,H,M,R,ba,Y,g,C,T,X,K,N,U,P]}function w(b=0,l=Math.PI,r=!0){r&&(l=(2*Math.PI-l)%(2*Math.PI));var y=r?-1:1,z=5*y;const O=20*y,Q=25*y;y*=2;const v=r?1:-1;r=5*v;let [H,M]=[0+r,0-O],[R,T]=[H+2*v,M],[X,ba]=[R-0*v,T+y],[Y,g]=[0-r,0-Q],[C,K]=[Y+0*v,g-y],N=Math.ceil(b/5),U=Math.floor(N/10);N-=8*U;b=[];const P=[];for(let ia=0;ia<N/2;ia++,U--){0>=U&&1===N%2&&ia===(N-1)/2&&(Y=0,C=Y+0*v,g=(g+M)/
2,K=g-y);const [fa,ja]=t(Y,g,l,45);if(0<U){const [ha,la]=t(R,g,l,45),[na,oa]=t(H,M,l,45);b.push(ha);b.push(la);b.push(fa);b.push(ja);b.push(na);b.push(oa)}else{const [ha,la]=t(R,T,l,45),[na,oa]=t(X,ba,l,45),[pa,ma]=t(C,K,l,45);P.push(fa);P.push(ja);P.push(pa);P.push(ma);P.push(na);P.push(oa);P.push(ha);P.push(la)}g+=z;M+=z;T+=z;ba+=z;K+=z}const [V,W]=t(0+r,0+O,l,45);z=7*v;const [S,Z]=t(0+z,0+O,l,45),[aa,ca]=t(0+r,0-Q,l,45),[ea,da]=t(0+z,0-Q,l,45);return{pennants:b,barbs:P,shaft:[V,W,S,Z,aa,ca,ea,
da]}}function t(b,l,r,y=1){return[Math.sqrt(b*b+l*l)/y,(2*Math.PI+(2*Math.PI+Math.atan2(l,b))%(2*Math.PI)-r)%(2*Math.PI)]}function L(b,l,r,y){r=A(y||"knots",r);for(y=1;y<l.length;y++)if(y===l.length-1){if(b<l[y]*r)break}else if(b<=l[y]*r)break;return Math.min(y-1,l.length-2)}function E(b,l,r,y,z){let O=0;switch(l){case "beaufort_kn":O=L(b,a,"knots",r);break;case "beaufort_km":O=L(b,a,"kilometer-per-hour",r);break;case "beaufort_ft":O=L(b,a,"feet-per-second",r);break;case "beaufort_m":O=L(b,a,"meter-per-second",
r);break;case "classified_arrow":O=L(b,z??[],y,r);break;case "ocean_current_m":O=L(b,c,"meter-per-second",r);break;case "ocean_current_kn":O=L(b,e,"knots",r)}return O}function h(b,l){const {style:r,inputUnit:y,outputUnit:z,breakValues:O}=l,Q=p.fromJSON(y),v=p.fromJSON(z);let H=0,M=0;const {width:R,height:T,mask:X}=b,ba=b.pixels[0];b=b.pixels[1];var Y=F.isSome(X)?X.filter(K=>0<K).length:R*T;const g=new Float32Array(42*Y);Y=new Uint32Array(15*Y);l=l.invertDirection?G(0,0,0,!1):J;for(let K=0;K<T;K++)for(let N=
0;N<R;N++){var C=K*R+N;if(!X||X[K*R+N]){const U=(b[C]+360)%360/180*Math.PI,P=E(ba[C],r,Q,v,O);for(let V=0;V<l.length;V+=2)g[H++]=(N+.5)/R,g[H++]=(K+.5)/T,g[H++]=l[V],g[H++]=l[V+1]+U,g[H++]=P,g[H++]=ba[C];C=7*(H/42-1);Y[M++]=C;Y[M++]=C+1;Y[M++]=C+2;Y[M++]=C+0;Y[M++]=C+4;Y[M++]=C+3;Y[M++]=C+0;Y[M++]=C+2;Y[M++]=C+3;Y[M++]=C+2;Y[M++]=C+5;Y[M++]=C+3;Y[M++]=C+5;Y[M++]=C+6;Y[M++]=C+3}}return{vertexData:g,indexData:Y}}function f(b,l){let r=0,y=0;const {width:z,height:O,mask:Q}=b;b=b.pixels[0];const v=[],
H=[];var M=p.fromJSON(l.inputUnit);M=A(M,"knots");l="wind_speed"===l.style?5:Number.MAX_VALUE;for(let T=0;T<O;T++)for(let X=0;X<z;X++){var R=b[T*z+X]*M;if((!Q||Q[T*z+X])&&R<l){for(let ba=0;4>ba;ba++)v[r++]=(X+.5)/z,v[r++]=(T+.5)/O,v[r++]=2>ba?-.5:.5,v[r++]=0===ba%2?-.5:.5,v[r++]=0,v[r++]=R;R=4*(r/24-1);H[y++]=R;H[y++]=R+1;H[y++]=R+2;H[y++]=R+1;H[y++]=R+2;H[y++]=R+3}}return{vertexData:new Float32Array(v),indexData:new Uint32Array(H)}}const d=new Map;d.set("meter-per-second",1);d.set("kilometer-per-hour",
.277778);d.set("knots",.514444);d.set("feet-per-second",.3048);d.set("mile-per-hour",.44704);const k=180/Math.PI,p=new D.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),J=G(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],c=[0,.5,1,1.5,2],e=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],n=[];u.convertToLocalDirections=function(b,l,r,y="geographic"){if(!q.isValidPixelBlock(b)||F.isNone(r))return b;
b="vector-magdir"===l?b.clone():F.unwrap(B(b,l));const z=b.pixels[1];for(let O=0;O<z.length;O++)z[O]="geographic"===y?(z[O]+r[O]+270)%360:(z[O]+360-r[O])%360;return"vector-magdir"===l?b:B(b,"vector-magdir")};u.convertVectorFieldData=B;u.convertVectorFieldUnit=function(b,l,r=1){if(1===r||!q.isValidPixelBlock(b))return b;b=b.clone();const {pixels:y,width:z,height:O}=b,Q=y[0],v=y[1];let H=0;for(let M=0;M<O;M++)for(let R=0;R<z;R++)"vector-uv"===l?(Q[H]*=r,v[H]*=r):Q[H]*=r,H++;b.updateStatistics();return b};
u.createVFMesh=function(b,l){if("simple_scalar"===l.style)l=f(b,l);else if("wind_speed"===l.style){if(0===n.length)for(var r=0;30>r;r++)n.push(w(5*r,0,!l.invertDirection));l=p.fromJSON(l.inputUnit);l=A(l,"knots");const {width:Q,height:v,mask:H}=b;r=b.pixels[0];b=b.pixels[1];const M=[],R=[];let T=0,X=0;for(let ba=0;ba<v;ba++)for(let Y=0;Y<Q;Y++){var y=ba*Q+Y,z=r[y]*l;if((!H||H[ba*Q+Y])&&5<=z){const g=(b[y]+360)%360/180*Math.PI,{pennants:C,barbs:K,shaft:N}=n[Math.min(Math.floor(z/5),29)];if(0===C.length+
K.length)continue;y=M.length/6;const U=(Y+.5)/Q,P=(ba+.5)/v;for(var O=0;O<C.length;O+=2)M[T++]=U,M[T++]=P,M[T++]=C[O],M[T++]=C[O+1]+g,M[T++]=0,M[T++]=z;for(O=0;O<K.length;O+=2)M[T++]=U,M[T++]=P,M[T++]=K[O],M[T++]=K[O+1]+g,M[T++]=0,M[T++]=z;for(O=0;O<N.length;O+=2)M[T++]=U,M[T++]=P,M[T++]=N[O],M[T++]=N[O+1]+g,M[T++]=0,M[T++]=z;for(z=0;z<C.length/6;z++)R[X++]=y,R[X++]=y+1,R[X++]=y+2,y+=3;for(z=0;z<K.length/8;z++)R[X++]=y,R[X++]=y+1,R[X++]=y+2,R[X++]=y+1,R[X++]=y+2,R[X++]=y+3,y+=4;R[X++]=y+0;R[X++]=
y+1;R[X++]=y+2;R[X++]=y+1;R[X++]=y+3;R[X++]=y+2;y+=4}}l={vertexData:new Float32Array(M),indexData:new Uint32Array(R)}}else l=h(b,l);return l};u.createVFMeshScalar=f;u.getUnitConversionFactor=A;u.sampleVectorField=function(b,l,r,y=[0,0],z=.5){const {width:O,height:Q,mask:v}=b,[H,M]=b.pixels,[R,T]=y;b=Math.round((O-R)/r);y=Math.round((Q-T)/r);var X=b*y;const ba=new Float32Array(X),Y=new Float32Array(X);X=new Uint8Array(X);l="vector-uv"===l;for(let C=0;C<y;C++)for(let K=0;K<b;K++){let N=0;const U=C*
b+K,P=Math.max(0,C*r+T),V=Math.max(0,K*r+R),W=Math.min(Q,P+r),S=Math.min(O,V+r);for(let Z=P;Z<W;Z++)for(let aa=V;aa<S;aa++){var g=Z*O+aa;if(!v||v[g]){N++;g=l?[H[g],M[g]]:[H[g],(360+M[g])%360];const [ca,ea]=l?g:I(g);ba[U]+=ca;Y[U]+=ea}}if(N>=(W-P)*(S-V)*(1-z)){X[U]=1;const [Z,aa]=x([ba[U]/N,Y[U]/N]);ba[U]=Z;Y[U]=aa}else X[U]=0,ba[U]=0,Y[U]=0}r=new m({width:b,height:y,pixels:[ba,Y],mask:X});r.updateStatistics();return r};u.snapImageToSymbolTile=function(b,l,r,y,z){if(F.isNone(z)||!z.spatialReference.equals(b.spatialReference))return{extent:b,
width:Math.round(l/y),height:Math.round(r/y),resolution:b.width/l};const O=z.xmin;z=z.ymax;l=(b.xmax-b.xmin)/l*y;r=(b.ymax-b.ymin)/r*y;b.xmin=O+Math.floor((b.xmin-O)/l)*l;b.xmax=O+Math.ceil((b.xmax-O)/l)*l;b.ymin=z+Math.floor((b.ymin-z)/r)*r;b.ymax=z+Math.ceil((b.ymax-z)/r)*r;return{extent:b,width:Math.round(b.width/l),height:Math.round(b.height/r),resolution:(l+r)/2}};u.unitKebabDict=p;u.uvComponentToVector=x;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/RasterVFTileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../geometry/support/aaBoundingRect ./BrushVectorField ./RasterVFTile ../webgl/enums ../webgl/TileContainer".split(" "),
function(u,D,F,m,q,A,x){x=function(I){function B(){var w=G.apply(this,arguments);w.isCustomTilingScheme=!1;w.symbolTypes=["triangle"];return w}D._inherits(B,I);var G=D._createSuper(B);I=B.prototype;I.createTile=function(w){const t=this._tileInfoView.getTileBounds(F.create(),w),[L,E]=this._tileInfoView.tileInfo.size,h=this._tileInfoView.getTileResolution(w.level);return new q.RasterVFTile(w,h,t[0],t[3],L,E)};I.prepareRenderPasses=function(w){const t=w.registerRenderPass({name:"imagery (vf tile)",brushes:[m],
target:()=>this.children.map(L=>L.tileData),drawPhase:A.WGLDrawPhase.MAP});return[...D._get(D._getPrototypeOf(B.prototype),"prepareRenderPasses",this).call(this,w),t]};I.doRender=function(w){this.visible&&w.drawPhase===A.WGLDrawPhase.MAP&&this.symbolTypes.forEach(t=>{w.renderPass=t;D._get(D._getPrototypeOf(B.prototype),"doRender",this).call(this,w)})};return D._createClass(B)}(x);u.RasterVFTileContainer=x;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/BrushVectorField":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../../../core/maybe","../webgl/brushes/WGLBrush","../../../webgl/enums"],function(u,D,F,m){const q=new Float32Array([.27058823529411763,.4588235294117647,.7098039215686275,1,.396078431372549,.5372549019607843,.7215686274509804,1,.5176470588235295,.6196078431372549,.7294117647058823,1,.6352941176470588,.7058823529411765,.7411764705882353,1,.7529411764705882,.8,.7450980392156863,1,.8705882352941177,.8901960784313725,.7490196078431373,1,1,1,.7490196078431373,1,1,.8627450980392157,.6313725490196078,
1,.9803921568627451,.7254901960784313,.5176470588235295,1,.9607843137254902,.596078431372549,.4117647058823529,1,.9294117647058824,.4588235294117647,.3176470588235294,1,.9098039215686274,.08235294117647059,.08235294117647059,1]),A={beaufort_ft:q,beaufort_m:q,beaufort_km:q,beaufort_mi:q,beaufort_kn:new Float32Array([.1568627450980392,.5725490196078431,.7803921568627451,1,.34901960784313724,.6352941176470588,.7294117647058823,1,.5058823529411764,.7019607843137254,.6705882352941176,1,.6274509803921569,
.7607843137254902,.6078431372549019,1,.7490196078431373,.8313725490196079,.5411764705882353,1,.8549019607843137,.9019607843137255,.4666666666666667,1,.9803921568627451,.9803921568627451,.39215686274509803,1,.9882352941176471,.8352941176470589,.3254901960784314,1,.9882352941176471,.7019607843137254,.4,1,.9803921568627451,.5529411764705883,.20392156862745098,1,.9686274509803922,.43137254901960786,.16470588235294117,1,.9411764705882353,.2784313725490196,.11372549019607843,1]),classified_arrow:new Float32Array([.2196078431372549,
.6588235294117647,0,1,.5450980392156862,1.2117647058823529,0,1,1,1,0,1,1,.5019607843137255,0,1,1,0,0,1]),ocean_current_m:new Float32Array([.3058823529411765,.10196078431372549,.6,1,.7019607843137254,.10588235294117647,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),ocean_current_kn:new Float32Array([0,0,0,1,0,.1450980392156863,.39215686274509803,1,.3058823529411765,.10196078431372549,.6,1,.592156862745098,0,.39215686274509803,
1,.7019607843137254,.10588235294117647,.10196078431372549,1,.6941176470588235,.3058823529411765,.10196078431372549,1,.792156862745098,.5019607843137255,.10196078431372549,1,.6941176470588235,.7019607843137254,.20392156862745098,1,.6941176470588235,.6941176470588235,.6941176470588235,1]),single_arrow:new Float32Array([0,92/255,230/255,1]),wind_speed:new Float32Array([0,0,0,1])},x=[0,20];return function(I){function B(){var w=G.apply(this,arguments);w._desc={magdir:{vsPath:"raster/magdir",fsPath:"raster/magdir",
attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])},scalar:{vsPath:"raster/scalar",fsPath:"raster/scalar",attributes:new Map([["a_pos",0],["a_offset",1],["a_vv",2]])}};return w}u._inherits(B,I);var G=u._createSuper(B);I=B.prototype;I.dispose=function(){};I.prepareState=function({context:w}){w.setBlendingEnabled(!0);w.setBlendFunctionSeparate(m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA,m.BlendFactor.ONE,m.BlendFactor.ONE_MINUS_SRC_ALPHA);w.setColorMask(!0,!0,!0,!0);w.setStencilWriteMask(0);
w.setStencilTestEnabled(!0);w.setStencilOp(m.StencilOperation.KEEP,m.StencilOperation.KEEP,m.StencilOperation.REPLACE)};I.draw=function(w,t){if(!D.isNone(t.source)&&0!==t.source.validPixelCount){var {context:L,timeline:E}=w;E.begin(this.name);L.setStencilFunction(m.CompareFunction.EQUAL,t.stencilRef,255);t.updateVectorFieldVAO(w);if("scalar"===w.renderPass){var h=t.vaoData.scalar;h&&this._drawScalars(w,t,h.vao,h.elementCount)}else(h=t.vaoData.magdir)&&this._drawTriangles(w,t,h.vao,h.elementCount);
E.end(this.name)}};I._drawTriangles=function(w,t,L,E){const {context:h,painter:f,requestRender:d,allowDelayedRender:k}=w,{symbolizerParameters:p}=t;var J=p.dataRange?["dataRange"]:[];"geographic"===p.rotationType&&J.push("rotationGeographic");J=f.materialManager.getProgram(this._desc.magdir,J);if(k&&D.isSome(d)&&!J.compiled)d();else{h.useProgram(J);var {coordScale:a,opacity:c,transforms:e}=t;J.setUniform2fv("u_coordScale",a);J.setUniform1f("u_opacity",c);J.setUniformMatrix3fv("u_dvsMat3",e.dvs);var {style:n,
dataRange:b,rotation:l,symbolPercentRange:r}=p;J.setUniform4fv("u_colors",A[n]||A.single_arrow);J.setUniform2fv("u_dataRange",b||x);J.setUniform1f("u_rotation",l);J.setUniform2fv("u_symbolPercentRange",r);w=this._getSymbolSize(w,t);J.setUniform2fv("u_symbolSize",w);h.bindVAO(L);h.drawElements(m.PrimitiveType.TRIANGLES,E,m.DataType.UNSIGNED_INT,0)}};I._drawScalars=function(w,t,L,E){const {context:h,painter:f,requestRender:d,allowDelayedRender:k}=w,{symbolizerParameters:p}=t;var J=[];"wind_speed"===
p.style?J.push("innerCircle"):p.dataRange&&J.push("dataRange");"geographic"===p.rotationType&&J.push("rotationGeographic");J=f.materialManager.getProgram(this._desc.scalar,J);if(k&&D.isSome(d)&&!J.compiled)d();else{h.useProgram(J);var {coordScale:a,opacity:c,transforms:e}=t;J.setUniform2fv("u_coordScale",a);J.setUniform1f("u_opacity",c);J.setUniformMatrix3fv("u_dvsMat3",e.dvs);var {dataRange:n,symbolPercentRange:b}=p;J.setUniform2fv("u_dataRange",n||x);J.setUniform2fv("u_symbolPercentRange",b);w=
this._getSymbolSize(w,t);J.setUniform2fv("u_symbolSize",w);h.bindVAO(L);h.drawElements(m.PrimitiveType.TRIANGLES,E,m.DataType.UNSIGNED_INT,0)}};I._getSymbolSize=function(w,t){w=t.key?2**(w.displayLevel-t.key.level):t.resolution/w.state.resolution;const {symbolTileSize:L}=t.symbolizerParameters;return[L/(Math.round((t.width-t.offset[0])/L)*L)/w,L/(Math.round((t.height-t.offset[1])/L)*L)/w]};return u._createClass(B)}(F)})},"esri/views/2d/engine/imagery/RasterVFTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat3 ../../../../chunks/mat3f32 ./RasterVFDisplayObject ../webgl/TiledDisplayObject".split(" "),
function(u,D,F,m,q,A){A=function(x){function I(G,w,t,L,E,h,f=null){var d=B.call(this,G,w,t,L,E,h);d.tileData=new q.RasterVFDisplayObject(f);d.tileData.coordScale=[E,h];d.tileData.once("isReady",()=>d.ready());return d}D._inherits(I,x);var B=D._createSuper(I);x=I.prototype;x.destroy=function(){D._get(D._getPrototypeOf(I.prototype),"destroy",this).call(this);this.tileData.destroy();this.stage=this.tileData=null};x._createTransforms=function(){return{dvs:m.create(),tileMat3:m.create()}};x.setTransform=
function(G){D._get(D._getPrototypeOf(I.prototype),"setTransform",this).call(this,G);const w=this.resolution/(G.resolution*G.pixelRatio),t=this.transforms.tileMat3,[L,E]=this.tileData.offset,[h,f]=G.toScreenNoRotation([0,0],[this.x+L*this.resolution,this.y-E*this.resolution]),{symbolTileSize:d}=this.tileData.symbolizerParameters;F.set(t,Math.round((this.width-this.tileData.offset[0])/d)*d/this.rangeX*w,0,0,0,Math.round((this.height-this.tileData.offset[1])/d)*d/this.rangeY*w,0,h,f,1);F.multiply(this.transforms.dvs,
G.displayViewMat3,t);this.tileData.transforms.dvs=this.transforms.dvs};x.onAttach=function(){this.tileData.stage=this.stage};x.onDetach=function(){this.tileData.stage=null};D._createClass(I,[{key:"stencilRef",get:function(){return this.tileData.stencilRef},set:function(G){this.tileData.stencilRef=G}}]);return I}(A.TiledDisplayObject);u.RasterVFTile=A;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/imagery/RasterVFDisplayObject":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../layers/support/rasterFunctions/vectorFieldUtils ../DisplayObject ../webgl/Utils ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w,t,L){F=function(E){function h(d=null){var k=f.call(this);k._source=null;k._symbolizerParameters=null;k._vaoInvalidated=!0;k.coordScale=[1,1];k.height=null;k.key=null;k.offset=null;k.stencilRef=0;k.resolution=null;k.pixelRatio=1;k.x=0;k.y=0;k.rotation=0;k.rawPixelData=null;k.vaoData=null;k.width=null;k.source=d;return k}D._inherits(h,E);var f=D._createSuper(h);E=h.prototype;E.destroy=function(){m.isSome(this.vaoData)&&(this.vaoData.magdir?.vao.dispose(),this.vaoData.scalar?.vao.dispose(),
this.vaoData=null)};E.invalidateVAO=function(){!this._vaoInvalidated&&m.isSome(this.vaoData)&&(this.vaoData.magdir?.vao.dispose(),this.vaoData.scalar?.vao.dispose(),this.vaoData=null,this._vaoInvalidated=!0,this.requestRender())};E.updateVectorFieldVAO=function(d){if(this._vaoInvalidated){this._vaoInvalidated=!1;if(m.isSome(this.source)&&m.isNone(this.vaoData)){var {style:k}=this.symbolizerParameters;switch(k){case "beaufort_ft":case "beaufort_km":case "beaufort_kn":case "beaufort_m":case "beaufort_mi":case "classified_arrow":case "ocean_current_kn":case "ocean_current_m":case "single_arrow":k=
I.createVFMesh(this.source,this.symbolizerParameters);this.vaoData={magdir:this._createVectorFieldVAO(d.context,k)};break;case "simple_scalar":k=I.createVFMeshScalar(this.source,this.symbolizerParameters);this.vaoData={scalar:this._createVectorFieldVAO(d.context,k)};break;case "wind_speed":k=I.createVFMesh(this.source,this.symbolizerParameters);k=this._createVectorFieldVAO(d.context,k);const p=I.createVFMeshScalar(this.source,this.symbolizerParameters);d=this._createVectorFieldVAO(d.context,p);this.vaoData=
{magdir:k,scalar:d}}}this.ready();this.requestRender()}};E._createTransforms=function(){return{dvs:A.create()}};E.setTransform=function(d){const k=q.identity(this.transforms.dvs),[p,J]=d.toScreenNoRotation([0,0],[this.x,this.y]);var a=this.resolution/this.pixelRatio/d.resolution;const c=a*this.width;a*=this.height;const e=Math.PI*this.rotation/180;q.translate(k,k,x.fromValues(p,J));q.translate(k,k,x.fromValues(c/2,a/2));q.rotate(k,k,-e);q.translate(k,k,x.fromValues(-c/2,-a/2));q.scaleByVec2(k,k,x.fromValues(c,
a));q.multiply(this.transforms.dvs,d.displayViewMat3,k)};E.onAttach=function(){this.invalidateVAO()};E.onDetach=function(){this.invalidateVAO()};E._createVectorFieldVAO=function(d,k){const {vertexData:p,indexData:J}=k;k=w.BufferObject.createVertex(d,t.Usage.STATIC_DRAW,new Float32Array(p));const a=w.BufferObject.createIndex(d,t.Usage.STATIC_DRAW,new Uint32Array(J)),c=G.createProgramDescriptor("vector-field",{geometry:[{location:0,name:"a_pos",count:2,type:t.DataType.FLOAT,normalized:!1},{location:1,
name:"a_offset",count:2,type:t.DataType.FLOAT,normalized:!1},{location:2,name:"a_vv",count:2,type:t.DataType.FLOAT,normalized:!1}]});return{vao:new L.VertexArrayObject(d,c.attributes,c.bufferLayouts,{geometry:k},a),elementCount:J.length}};D._createClass(h,[{key:"symbolizerParameters",get:function(){return this._symbolizerParameters},set:function(d){JSON.stringify(this._symbolizerParameters)!==JSON.stringify(d)&&(this._symbolizerParameters=d,this.invalidateVAO())}},{key:"source",get:function(){return this._source},
set:function(d){this._source=d;this.invalidateVAO()}}]);return h}(B.DisplayObject);u.RasterVFDisplayObject=F;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/ImageryTileLayerView":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Error ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/commonProperties ../../layers/support/rasterFunctions/rasterProjectionHelper ./support/popupUtils".split(" "),
function(u,D,F,m,q,A,x,I,B,G,w,t,L){return E=>{E=function(h){function f(){var k=d.apply(this,arguments);k._rasterFieldPrefix="Raster.";k.layer=null;k.view=null;k.tileInfo=null;return k}u._inherits(f,h);var d=u._createSuper(f);h=f.prototype;h._getfullExtent=function(){return this.projectFullExtent(this.view.spatialReference)};h.supportsSpatialReference=function(k){return!!this.projectFullExtent(k)};h.projectFullExtent=function(k){const p=q.unwrap(this.layer.fullExtent),J=t.getDefaultDatumTransformationForDataset(p,
k,!1);return t.projectExtent(p,k,J)};h.fetchPopupFeatures=async function(k,p){const {layer:J}=this;if(!k)throw new m("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:J});var {popupEnabled:a}=J;p=L.getFetchPopupTemplate(J,p);if(!a||q.isNone(p))throw new m("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:a,popupTemplate:p});a=[];const {value:c,magdirValue:e}=await J.identify(k,{timeExtent:this.timeExtent});let n=
"";if(c&&c.length){n="imagery-tile"===J.type&&J.hasStandardTime()&&null!=c[0]?c.map(l=>J.getStandardTimeValue(l)).join(", "):c.join(", ");k={ObjectId:0};k["Raster.ServicePixelValue"]=n;p=J.rasterInfo.attributeTable;if(q.isSome(p)){const {fields:l,features:r}=p,y=l.find(({name:z})=>"value"===z.toLowerCase());if(p=y?r.find(z=>String(z.attributes[y.name])===n):null)for(var b in p.attributes)p.attributes.hasOwnProperty(b)&&(k[this._rasterFieldPrefix+b]=p.attributes[b])}b=J.rasterInfo.dataType;if("vector-magdir"===
b||"vector-uv"===b)k["Raster.Magnitude"]=e?.[0],k["Raster.Direction"]=e?.[1];b=new F(this.fullExtent.clone(),null,k);b.layer=J;b.sourceLayer=b.layer;a.push(b)}return a};u._createClass(f,[{key:"fullExtent",get:function(){return this._getfullExtent()}},{key:"hasTilingEffects",get:function(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}},{key:"datumTransformation",get:function(){return t.getDefaultDatumTransformationForDataset(q.unwrap(this.layer.fullExtent),
this.view.spatialReference,!0)}}]);return f}(E);D.__decorate([A.property()],E.prototype,"layer",void 0);D.__decorate([A.property(w.combinedViewLayerTimeExtentProperty)],E.prototype,"timeExtent",void 0);D.__decorate([A.property()],E.prototype,"view",void 0);D.__decorate([A.property()],E.prototype,"fullExtent",null);D.__decorate([A.property()],E.prototype,"tileInfo",void 0);D.__decorate([A.property({readOnly:!0})],E.prototype,"hasTilingEffects",null);D.__decorate([A.property()],E.prototype,"datumTransformation",
null);return E=D.__decorate([G.subclass("esri.views.layers.ImageryTileLayerView")],E)}})},"esri/views/layers/support/popupUtils":function(){define(["exports","../../../core/maybe","../../../layers/support/fieldUtils"],function(u,D,F){u.getFetchPopupTemplate=function(m,q){return m.popupTemplate?m.popupTemplate:D.isSome(q)&&q.defaultPopupTemplateEnabled&&D.isSome(m.defaultPopupTemplate)?m.defaultPopupTemplate:null};u.getRequiredFields=async function(m,q=m.popupTemplate){if(D.isNone(q))return[];const A=
await q.getRequiredFields(m.fieldsIndex);({lastEditInfoEnabled:q}=q);const {objectIdField:x,typeIdField:I,globalIdField:B,relationships:G}=m;if(A.includes("*"))return["*"];q=q?await F.getFeatureEditFields(m):[];const w=F.fixFields(m.fieldsIndex,[...A,...q]);I&&w.push(I);w&&x&&m.fieldsIndex?.has(x)&&!w.includes(x)&&w.push(x);w&&B&&m.fieldsIndex?.has(B)&&!w.includes(B)&&w.push(B);G&&G.forEach(t=>{({keyField:t}=t);w&&t&&m.fieldsIndex?.has(t)&&!w.includes(t)&&w.push(t)});return w};Object.defineProperty(u,
Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/RefreshableLayerView":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(u,D,F,m,q,A,x,I,B,G){return w=>{w=function(t){function L(){return E.apply(this,arguments)}
u._inherits(L,t);var E=u._createSuper(L);L.prototype.initialize=function(){this.handles.add(q.on(()=>this.layer,"refresh",h=>{this.doRefresh(h.dataChanged).catch(f=>{m.isAbortError(f)||F.getLogger(this.declaredClass).error(f)})}),"RefreshableLayerView")};return u._createClass(L)}(w);D.__decorate([A.property()],w.prototype,"layer",void 0);return w=D.__decorate([G.subclass("esri.layers.mixins.RefreshableLayerView")],w)}})},"*noref":1}});
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/rasterDatasets/multidimensionalUtils ../engine/flow/FlowView2D ./LayerView2D ./imagery/ImageryTileView2D ./imagery/VectorFieldTileView2D ./support/util ../../layers/ImageryTileLayerView ../../layers/LayerView ../../layers/RefreshableLayerView".split(" "),function(u,
D,F,m,q,A,x,I,B,G,w,t,L,E,h,f,d,k,p,J,a){B=function(c){function e(){var b=n.apply(this,arguments);b._useWebGLForProcessing=!0;b._useProgressiveUpdate=!0;b.subview=null;return b}u._inherits(e,c);var n=u._createSuper(e);c=e.prototype;c.update=function(b){this.subview?.update(b);this.notifyChange("updating")};c.isUpdating=function(){return!this.subview||this.subview.updating};c.attach=function(){this.layer.increaseRasterJobHandlerUsage();this._updateSubview();this.addAttachHandles([x.watch(()=>{const {layer:b}=
this;return{bandIds:b.bandIds,renderer:b.renderer,interpolation:b.interpolation,multidimensionalDefinition:b.multidimensionalDefinition,rasterFunction:"imagery-tile"===b.type?b.rasterFunction:null}},(b,l)=>{const r=b.interpolation!==l?.interpolation&&("majority"===b.interpolation||"majority"===l?.interpolation)&&k.canUseMajorityInterpolationOnDataSource(this.layer),y=b.renderer!==l?.renderer&&l?.renderer?.type!==b.renderer?.type;y&&this._updateSubview();const z=b.rasterFunction!==l?.rasterFunction,
O=z&&!this._useWebGLForProcessing;this.subview.redrawOrRefetch({refetch:b.multidimensionalDefinition!==l?.multidimensionalDefinition||r||y||O,reprocess:z}).catch(Q=>{A.isAbortError(Q)||m.getLogger(this.declaredClass).error(Q)});this.notifyChange("updating")}),x.watch(()=>this.layer.blendMode??"normal",b=>{this.subview.container.blendMode=b},x.syncAndInitial),x.watch(()=>this.layer.effect??null,b=>{this.subview.container.effect=b},x.syncAndInitial),x.watch(()=>this.layer.multidimensionalSubset??null,
(b,l)=>{const {multidimensionalDefinition:r}=this.layer;q.isSome(r)&&L.hasExcludedVariableOrDimension(r,b)!==L.hasExcludedVariableOrDimension(r,l)&&(this.subview.redrawOrRefetch({refetch:!0}).catch(y=>{A.isAbortError(y)||m.getLogger(this.declaredClass).error(y)}),this.notifyChange("updating"))},x.sync),x.watch(()=>this.timeExtent,()=>{this.subview.timeExtent=this.timeExtent;this.subview.redrawOrRefetch({refetch:!0}).catch(b=>{A.isAbortError(b)||m.getLogger(this.declaredClass).error(b)})},x.initial)])};
c.detach=function(){this.layer.decreaseRasterJobHandlerUsage();this._detachSubview(this.subview);this.subview?.destroy();this.subview=null};c.moveStart=function(){this.requestUpdate()};c.viewChange=function(){this.requestUpdate()};c.moveEnd=function(){this.subview.moveEnd()};c.hitTest=async function(b,l){return[{type:"graphic",layer:this.layer,mapPoint:b,graphic:new F({attributes:{},geometry:b.clone()})}]};c.doRefresh=function(){return this.subview?this.subview.doRefresh():Promise.resolve()};c._updateSubview=
function(){var b="vector-field"===this.layer.renderer.type?"rasterVF":"flow"===this.layer.renderer.type?"flow":"raster";if(this.subview){if(this.subview.type===b){this._attachSubview(this.subview);return}this._detachSubview(this.subview);this.subview?.destroy();this.subview=null}var {layer:l}=this;b="rasterVF"===b?new d({layer:l,layerView:this}):"flow"===b?new E({layer:l,layerView:this}):new f({layer:l,layerView:this});"useWebGLForProcessing"in b&&(b.useWebGLForProcessing=this._useWebGLForProcessing);
"useProgressiveUpdate"in b&&(b.useProgressiveUpdate=this._useProgressiveUpdate);"previousLOD"in b&&({subview:l}=this,b.previousLOD=l&&"previousLOD"in l?l.previousLOD:null);this._attachSubview(b);this.subview=b;this.requestUpdate()};c._attachSubview=function(b){b&&!b.attached&&(b.attach(),b.attached=!0,this.container.addChildAt(b.container,0),b.container.blendMode=this.layer.blendMode,b.container.effect=this.layer.effect)};c._detachSubview=function(b){b?.attached&&(this.container.removeChild(b.container),
b.detach(),b.attached=!1)};u._createClass(e,[{key:"useWebGLForProcessing",get:function(){return this._useWebGLForProcessing},set:function(b){this._useWebGLForProcessing=b;this.subview&&"useWebGLForProcessing"in this.subview&&(this.subview.useWebGLForProcessing=b)}},{key:"useProgressiveUpdate",get:function(){return this._useWebGLForProcessing},set:function(b){this._useProgressiveUpdate=b;this.subview&&"useProgressiveUpdate"in this.subview&&(this.subview.useProgressiveUpdate=b)}}]);return e}(p(a(h.LayerView2DMixin(J))));
D.__decorate([I.property()],B.prototype,"subview",void 0);D.__decorate([I.property()],B.prototype,"useWebGLForProcessing",null);D.__decorate([I.property()],B.prototype,"useProgressiveUpdate",null);return B=D.__decorate([t.subclass("esri.views.2d.layers.ImageryTileLayerView2D")],B)});