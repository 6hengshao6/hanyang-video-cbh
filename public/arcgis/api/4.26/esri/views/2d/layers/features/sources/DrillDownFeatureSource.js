// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/has","../../../../../core/promiseUtils","./BaseFeatureSource"],function(m,e,f,n,g){var u=(f=f("esri-mobile"))?1:4,v=f?1:3;g=function(w){function c(a){return x.call(this,a)}e._inherits(c,w);var x=e._createSuper(c);c.prototype._fetchDataTile=async function(a){const y=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,p=this._subscriptions.get(a.key.id),q=p.signal,z=a.getQuantizationParameters();let h=
0;const l=async(k,d)=>{const A=this._queryInfo,r=this.createTileQuery(k,{maxRecordCountFactor:y?v:void 0,returnExceededLimitFeatures:!1,quantizationParameters:z});h++;try{const b=await this.enqueueQuery({tile:a,query:r,signal:q,depth:d});h--;n.throwIfAborted(q);if(b)if(A!==this._queryInfo)l(k,d);else if(b.exceededTransferLimit&&d<u)for(const B of k.createChildTiles())l(B,d+1);else{var t={id:a.id,addOrUpdate:b,end:0===h,type:"append"};p.add({query:r,message:t});this._onMessage(t)}}catch(b){n.isAbortError(b)||
this._onMessage({id:a.id,addOrUpdate:null,end:!0,type:"append"})}};l(a,0)};return e._createClass(c)}(g.BaseFeatureSource);m.DrillDownFeatureSource=g;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});