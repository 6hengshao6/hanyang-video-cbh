// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Extent ../../engine/imagery/RasterVFDisplayObject".split(" "),function(p,h,f,r,t,q,n,z,A,B,u,v,w){f=
function(k){function l(b){var a=x.call(this,b);a._loading=null;a.update=q.debounce((d,e)=>a._update(d,e).catch(g=>{q.isAbortError(g)||r.getLogger(a.declaredClass).error(g)}));return a}p._inherits(l,k);var x=p._createSuper(l);k=l.prototype;k.redraw=function(b){if(this.container.children.length){var a=this.container.children[0];a.symbolizerParameters=b;a.invalidateVAO();this.container.symbolTypes="wind_speed"===b.style?["scalar","triangle"]:"simple_scalar"===b.style?["scalar"]:["triangle"];this.container.requestRender()}};
k._update=async function(b,a,d){if(b.stationary){var {extent:e,spatialReference:g}=b.state,c=new v({xmin:e.xmin,ymin:e.ymin,xmax:e.xmax,ymax:e.ymax,spatialReference:g}),[m,y]=b.state.size;this._loading=this.fetchPixels(c,m,y,d);d=await this._loading;this._addToDisplay(d,a,b.state);this._loading=null}};k._addToDisplay=function(b,a,d){if(t.isNone(b.pixelBlock))this.container.children.forEach(m=>m.destroy()),this.container.removeAllChildren();else{var {extent:e,pixelBlock:g}=b,c=new w.RasterVFDisplayObject(g);
c.offset=[0,0];c.symbolizerParameters=a;c.rawPixelData=b;c.invalidateVAO();c.x=e.xmin;c.y=e.ymax;c.pixelRatio=d.pixelRatio;c.rotation=d.rotation;c.resolution=d.resolution;c.width=g.width*a.symbolTileSize;c.height=g.height*a.symbolTileSize;this.container.children.forEach(m=>m.destroy());this.container.removeAllChildren();this.container.symbolTypes="wind_speed"===a.style?["scalar","triangle"]:"simple_scalar"===a.style?["scalar"]:["triangle"];this.container.addChild(c)}};p._createClass(l,[{key:"updating",
get:function(){return!!this._loading}}]);return l}(f);h.__decorate([n.property()],f.prototype,"fetchPixels",void 0);h.__decorate([n.property()],f.prototype,"container",void 0);h.__decorate([n.property()],f.prototype,"_loading",void 0);h.__decorate([n.property()],f.prototype,"updating",null);return f=h.__decorate([u.subclass("esri.views.2d.layers.imagery.ImageryVFStrategy")],f)});