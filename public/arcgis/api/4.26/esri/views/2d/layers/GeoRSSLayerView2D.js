// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../PopupTemplate ../../../core/Collection ../../../core/reactiveUtils ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../../../renderers/SimpleRenderer ../../../renderers/support/jsonUtils ../../../rest/support/FeatureSet ./LayerView2D ./graphics/GraphicContainer ./graphics/GraphicsView2D ../../layers/LayerView".split(" "),
function(k,p,q,r,f,l,C,D,E,F,t,m,u,v,w,x,y,z){l=function(b){function h(){var a=A.apply(this,arguments);a._graphicsViewMap={};a._popupTemplates=new Map;a.graphicsViews=[];return a}k._inherits(h,b);var A=k._createSuper(h);b=h.prototype;b.hitTest=async function(a,e){if(!this.graphicsViews.length)return null;const c=this.layer;return this.graphicsViews.reverse().map(d=>{const n=this._popupTemplates.get(d);d=d.hitTest(a);for(const g of d)g.layer=c,g.sourceLayer=c,g.popupTemplate=n;return d}).flat().map(d=>
({type:"graphic",graphic:d,layer:c,mapPoint:a}))};b.update=function(a){if(this.graphicsViews)for(const e of this.graphicsViews)e.processUpdate(a)};b.attach=function(){this.addAttachHandles([f.watch(()=>this.layer?.featureCollections,a=>{this._clear();for(const {popupInfo:d,featureSet:n,layerDefinition:g}of a){a=v.fromJSON(n);var e=new r(a.features),c=g.drawingInfo;const B=d?q.fromJSON(d):null;c=u.fromJSON(c.renderer);e=new y({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:e,
renderer:c,container:new x(this.view.featuresTilingScheme)});this._graphicsViewMap[a.geometryType]=e;this._popupTemplates.set(e,B);"polygon"!==a.geometryType||this.layer.polygonSymbol?"polyline"!==a.geometryType||this.layer.lineSymbol?"point"!==a.geometryType||this.layer.pointSymbol||(this.layer.pointSymbol=c.symbol):this.layer.lineSymbol=c.symbol:this.layer.polygonSymbol=c.symbol;this.graphicsViews.push(e);this.container.addChild(e.container)}},f.initial),f.watch(()=>this.layer?.polygonSymbol,a=>
{this._graphicsViewMap.polygon.renderer=new m({symbol:a})},f.initial),f.watch(()=>this.layer?.lineSymbol,a=>{this._graphicsViewMap.polyline.renderer=new m({symbol:a})},f.initial),f.watch(()=>this.layer?.pointSymbol,a=>{this._graphicsViewMap.point.renderer=new m({symbol:a})},f.initial)])};b.detach=function(){this._clear()};b.moveStart=function(){};b.moveEnd=function(){};b.viewChange=function(){for(const a of this.graphicsViews)a.viewChange()};b._clear=function(){this.container.removeAllChildren();
for(const a of this.graphicsViews)a.destroy();this._graphicsViewMap={};this._popupTemplates.clear();this.graphicsViews.length=0};return k._createClass(h)}(w.LayerView2DMixin(z));return l=p.__decorate([t.subclass("esri.views.2d.layers.GeoRSSLayerView2D")],l)});