// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../Viewpoint ../../core/Accessor ../../core/maybe ../../core/scheduling ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../ViewAnimation ./unitBezier ./viewpointUtils ../../geometry/Point".split(" "),function(l,h,g,q,r,t,u,k,z,A,B,v,n,m,w,x){let y=function(){function f(d,e,a,b){const c=d.targetGeometry,
p=e.targetGeometry;b?"string"===typeof b&&(b=m.parse(b)||m.easingFunctions.ease):b=m.easingFunctions.ease;this.easing=b;this.duration=a;this.sCenterX=c.x;this.sCenterY=c.y;this.sScale=d.scale;this.sRotation=d.rotation;this.tCenterX=p.x;this.tCenterY=p.y;this.tScale=e.scale;this.tRotation=e.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:
-180>this.dRotation&&(this.dRotation+=360)}f.prototype.applyRatio=function(d,e){var a=this.easing(e);let b,c;1<=e?(e=this.tCenterX,b=this.tCenterY,c=this.tRotation,a=this.tScale):(e=this.sCenterX+a*this.dCenterX,b=this.sCenterY+a*this.dCenterY,c=this.sRotation+a*this.dRotation,a=this.sScale+a*this.dScale);d.targetGeometry.x=e;d.targetGeometry.y=b;d.scale=a;d.rotation=c};return l._createClass(f)}();g=function(f){function d(a){a=e.call(this,a);a.updateFunction=null;a.animation=null;a.duration=200;a.transition=
null;a.easing=m.easingFunctions.ease;a.view=null;a.viewpoint=new q({targetGeometry:new x,scale:0,rotation:0});a._updateTask=u.addFrameTask({postRender:a._postRender.bind(l._assertThisInitialized(a))});a._updateTask.pause();return a}l._inherits(d,f);var e=l._createSuper(d);f=d.prototype;f.destroy=function(){this._updateTask=t.removeMaybe(this._updateTask)};f.animate=function(a,b,c){this.stop();w.copy(this.viewpoint,b);this.transition=new y(this.viewpoint,a.target,c&&c.duration||this.duration,c&&c.easing||
this.easing);b=()=>{this.animation===a&&this._updateTask&&("finished"===a.state&&(this.transition?.applyRatio(this.viewpoint,1),this.view?.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.updateFunction=this.animation=null)};a.when(b,b);this._startTime=performance.now();this._updateTask.resume();return this.animation=a};f.animateContinous=function(a,b){this.stop();this.updateFunction=b;this.viewpoint=a;const c=new n({target:a.clone()});a=()=>{this.animation===c&&this._updateTask&&(this.updateFunction=
this.animation=null)};c.when(a,a);this._startTime=performance.now();this._updateTask.resume();return this.animation=c};f.stop=function(){this.animation&&(this.animation.stop(),this.updateFunction=this.animation=null)};f._postRender=function(a){var b=this.animation;if(b&&b.state!==n.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,a.deltaTime);else{a=this.transition;b=(performance.now()-this._startTime)/a.duration;const c=1<=b;a.applyRatio(this.viewpoint,b);c&&this.animation?.finish()}this.view?.state&&
(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()};return l._createClass(d)}(r);h.__decorate([k.property()],g.prototype,"animation",void 0);h.__decorate([k.property()],g.prototype,"duration",void 0);h.__decorate([k.property()],g.prototype,"transition",void 0);h.__decorate([k.property()],g.prototype,"easing",void 0);h.__decorate([k.property()],g.prototype,"view",void 0);h.__decorate([k.property()],g.prototype,"viewpoint",void 0);return g=h.__decorate([v.subclass("esri.views.2d.AnimationManager")],
g)});