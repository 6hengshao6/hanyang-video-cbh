// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["../../../chunks/_rollupPluginBabelHelpers","../../../layers/support/TileInfo","./TileInfoView","./TileKey"],function(e,l,m,h){return function(c){function f(){var a=n.apply(this,arguments);a._fullCacheLodInfos=null;a._levelByScale={};return a}e._inherits(f,c);var n=e._createSuper(f);c=f.prototype;c.getTileParentId=function(a){a=h.pool.acquire(a);const b=0===a.level?null:h.getId(a.level-1,a.row>>1,a.col>>1,a.world);h.pool.release(a);return b};c.getTileCoverage=function(a,b,g){a=e._get(e._getPrototypeOf(f.prototype),
"getTileCoverage",this).call(this,a,b,g);if(!a)return a;const d=1<<a.lodInfo.level;a.spans=a.spans.filter(k=>0<=k.row&&k.row<d);return a};c.scaleToLevel=function(a){this._fullCacheLodInfos||this._initializeFullCacheLODs(this._lodInfos);if(this._levelByScale[a])return this._levelByScale[a];var b=this._fullCacheLodInfos;if(a>b[0].scale)return b[0].level;let g;for(let d=0;d<b.length-1;d++)if(g=b[d+1],a>g.scale)return b=b[d],b.level+(b.scale-a)/(b.scale-g.scale);return b[b.length-1].level};c._initializeFullCacheLODs=
function(a){a=0===a[0].level?a.map(b=>({level:b.level,resolution:b.resolution,scale:b.scale})):l.create({size:this.tileInfo.size[0],spatialReference:this.tileInfo.spatialReference}).lods.map(b=>({level:b.level,resolution:b.resolution,scale:b.scale}));for(let b=0;b<a.length;b++)this._levelByScale[a[b].scale]=a[b].level;this._fullCacheLodInfos=a};return e._createClass(f)}(m)});