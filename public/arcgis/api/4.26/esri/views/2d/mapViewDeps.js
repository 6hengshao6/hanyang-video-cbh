// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ../../../core/events ../../../core/has ../../../core/maybe ../../../core/scheduling ../../../chunks/mat3f32 ../../../symbols/cim/CIMResourceManager ./Container ./webgl/BufferPool ./webgl/enums ./webgl/Painter ./webgl/Profiler ../support/Timeline ../../support/screenshotUtils ../../webgl/context-util ../../webgl/enums ../../webgl/FramebufferObject ../../webgl/RenderingContext ../../../core/imageUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q,B,y){let u=function(v){function r(A,C){var F=z.call(this);F._trash=new Set;F._renderRemainingTime=0;F._lastFrameRenderTime=0;F.renderRequested=!1;F.stage=h._assertThisInitialized(F);F._stationary=!0;const {canvas:G=document.createElement("canvas"),alpha:H=!0,stencil:K=!0,contextOptions:J={}}=C;F._canvas=G;const N=n.createContextOrErrorHTML("2d",G,{alpha:H,antialias:!1,depth:!0,stencil:K});F.context=new B.RenderingContext(t.unwrap(N)??null,J);F.resourceManager=
new f;F.painter=new e(F.context,h._assertThisInitialized(F),F.resourceManager);w("esri-2d-profiler")&&(F._debugOutput=document.createElement("div"),F._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),A.appendChild(F._debugOutput));F._renderParameters={drawPhase:0,state:F.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:F.context,painter:F.painter,timeline:C.timeline||
new m.Timeline,renderingOptions:C.renderingOptions,requestRender:()=>F.requestRender(),allowDelayedRender:!1,requireFBO:!1,profiler:new c.Profiler(F.context,F._debugOutput),dataUploadCounter:0,get highlightGradient(){return F._highlightGradient}};F._taskHandle=p.addFrameTask({render:P=>F.renderFrame(P)});F._taskHandle.pause();F._lostWebGLContextHandle=E.on(G,"webglcontextlost",P=>{F.emit("webgl-error",{error:new D("webgl-context-lost",P.statusMessage)})});F._bufferPool=new b.BufferPool;G.setAttribute("style",
"width: 100%; height:100%; display:block;");A.appendChild(G);return F}h._inherits(r,v);var z=h._createSuper(r);v=r.prototype;v.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle=t.removeMaybe(this._taskHandle);this._lostWebGLContextHandle=t.removeMaybe(this._lostWebGLContextHandle);this._canvas.parentNode?.removeChild(this._canvas);this._debugOutput?.parentNode?.removeChild(this._debugOutput);this._bufferPool.destroy();this.resourceManager.destroy();this.painter.dispose();
this.context.dispose();this._canvas=null};v.trashDisplayObject=function(A){this._trash.add(A);this.requestRender()};v.untrashDisplayObject=function(A){return this._trash.delete(A)};v.requestRender=function(){this._renderRemainingTime=2E3;this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};v.renderFrame=function(A){this._renderRemainingTime-=this._lastFrameRenderTime?A.time-this._lastFrameRenderTime:0;0>=this._renderRemainingTime&&this._taskHandle.pause();
this._lastFrameRenderTime=A.time;this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=A.time;this._renderParameters.deltaTime=A.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};v._createTransforms=function(){return{dvs:g.create()}};
v.renderChildren=function(A){for(const C of this.children)C.beforeRender(A);this._renderChildren(this.children,A);for(const C of this.children)C.afterRender(A)};v._renderChildren=function(A,C){const F=this.context;this.painter.textureUploadManager.upload();F.resetInfo();C.profiler.recordStart("drawLayers");C.dataUploadCounter=0;C.drawPhase=a.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(F,this.background);for(const G of A)G.processRender(C);this.painter.prepareDisplay(C,this.background,this.state.padding);
this.painter.renderLayers(F);C.drawPhase=a.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(F);for(const G of A)G.processRender(C);this.painter.renderLayers(F);if(this._isLabelDrawPhaseRequired(A)){C.drawPhase=a.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(F);for(const G of A)G.processRender(C);this.painter.renderLayers(F)}if(w("esri-tiles-debug")){C.drawPhase=a.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(F);for(const G of A)G.processRender(C);this.painter.renderLayers(F)}C.profiler.recordEnd("drawLayers");
F.logInfo()};v.doRender=function(A){const C=this.context,{state:F,pixelRatio:G}=A;this._resizeCanvas(A);C.setViewport(0,0,G*F.size[0],G*F.size[1]);C.setDepthWriteEnabled(!0);C.setStencilWriteMask(255);h._get(h._getPrototypeOf(r.prototype),"doRender",this).call(this,A)};v.takeScreenshot=async function(A){const {framebufferWidth:C,framebufferHeight:F}={framebufferWidth:Math.round(this.state.size[0]*A.resolutionScale),framebufferHeight:Math.round(this.state.size[1]*A.resolutionScale)};var G=A.resolutionScale,
H=this.context,K=this._state.clone();if(null!=A.rotation){var J=K.viewpoint;K.viewpoint.rotation=A.rotation;K.viewpoint=J}J={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:K,pixelRatio:G,time:performance.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};const N=new q.FramebufferObject(H,{colorTarget:x.TargetType.TEXTURE,depthStencilTarget:x.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER,width:C,height:F});G=H.getBoundFramebufferObject();K=H.getViewport();
H.bindFramebuffer(N);H.setViewport(0,0,C,F);this._renderChildren(A.children,J);J=this._readbackScreenshot(N,{...A.cropArea,y:F-(A.cropArea.y+A.cropArea.height)});H.bindFramebuffer(G);H.setViewport(K.x,K.y,K.width,K.height);this.requestRender();H=await J;1===A.outputScale?A=H:(A=new ImageData(Math.round(H.width*A.outputScale),Math.round(H.height*A.outputScale)),k.resampleHermite(H,A,!0));return A};v._readbackScreenshot=async function(A,C){const F=y.createEmptyImageData(C.width,C.height,document.createElement("canvas"));
await A.readPixelsAsync(C.x,C.y,C.width,C.height,x.PixelFormat.RGBA,x.PixelType.UNSIGNED_BYTE,new Uint8Array(F.data.buffer));return F};v._resizeCanvas=function(A){const C=this._canvas,F=C.style,{state:{size:G},pixelRatio:H}=A;A=G[0];const K=G[1],J=Math.round(A*H),N=Math.round(K*H);if(C.width!==J||C.height!==N)C.width=J,C.height=N;F.width=A+"px";F.height=K+"px"};v._emptyTrash=function(){for(;0<this._trash.size;){const A=Array.from(this._trash);this._trash.clear();for(const C of A)C.processDetach()}};
v._isLabelDrawPhaseRequired=function(A){let C=!1;for(const F of A){if(!(F instanceof d.Container)){C=C||!1;break}if(F.hasLabels)return!0;C=C||this._isLabelDrawPhaseRequired(F.children)}return C};h._createClass(r,[{key:"background",get:function(){return this._background},set:function(A){this._background=A;this.requestRender()}},{key:"bufferPool",get:function(){return this._bufferPool}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(A){this._renderingOptions=A;this.requestRender()}},
{key:"state",get:function(){return this._state},set:function(A){this._state=A;this.requestRender()}},{key:"stationary",get:function(){return this._stationary},set:function(A){this._stationary!==A&&(this._stationary=A,this.requestRender())}}]);return r}(d.Container);l.EXTRA_RENDER_TIME=2E3;l.Stage=u;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMResourceManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../request ../../core/Error ../../core/promiseUtils ../../views/2d/engine/webgl/animatedFormats/apng ../../views/2d/engine/webgl/animatedFormats/gif".split(" "),
function(l,h,D,E,w,t){async function p(d,b){d=window.URL.createObjectURL(d);try{const {data:a}=await h(d,{...b,responseType:"image"});return a}catch(a){if(!E.isAbortError(a))throw new D("mapview-invalid-resource",`Could not fetch requested resource at ${d}`);throw a;}finally{window.URL.revokeObjectURL(d)}}async function g(d,b){const {arrayBuffer:a,mediaType:e}=await f(d,b);d="image/png"===e;if("image/gif"===e&&t.isAnimatedGIF(a))return t.parseGif(a);if(d&&w.isAnimatedPNG(a))return w.parseApng(a,b);
d=new Blob([a],{type:e});return p(d,b)}async function f(d,b){if(d.includes(";base64,")){b=d.indexOf(";base64,");var a=d.indexOf(";base64,")+8;a=d.substring(a);a=atob(a);var e=new Uint8Array(a.length);for(var c=0;c<a.length;c++)e[c]=a.charCodeAt(c);a=e.buffer;d=d.substring(0,b).replace("data:","");a={arrayBuffer:a,mediaType:d}}else try{e=await h(d,{responseType:"array-buffer",...b});c=e.data;const m=e.getHeader("Content-Type");a={arrayBuffer:c,mediaType:m}}catch(m){if(!E.isAbortError(m))throw new D("mapview-invalid-resource",
`Could not fetch requested resource at ${d}`);}return a}return function(){function d(){this._resourceMap=new Map;this._inFlightResourceMap=new Map;this.geometryEnginePromise=this.geometryEngine=null}var b=d.prototype;b.destroy=function(){this._inFlightResourceMap.clear();this._resourceMap.clear()};b.getResource=function(a){return this._resourceMap.get(a)??null};b.fetchResource=async function(a,e){var c=this._resourceMap.get(a);if(c)return{width:c.width,height:c.height};if(c=this._inFlightResourceMap.get(a))return c.then(m=>
({width:m.width,height:m.height}));c=g(a,e);this._inFlightResourceMap.set(a,c);return c.then(m=>{this._inFlightResourceMap.delete(a);this._resourceMap.set(a,m);return{width:m.width,height:m.height}},()=>({width:0,height:0}))};b.deleteResource=function(a){this._inFlightResourceMap.delete(a);this._resourceMap.delete(a)};return l._createClass(d)}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../chunks/index3","../../../../../core/promiseUtils","../../../../../core/time"],
function(l,h,D,E){function w(p){const g=new Uint8Array(p);return!t.some((f,d)=>f!==g[d])}const t=[137,80,78,71,13,10,26,10];l.isAnimatedPNG=function(p){if(!w(p))return!1;const g=new DataView(p);p=new Uint8Array(p);let f=8,d;do{const b=g.getUint32(f);d=String.fromCharCode.apply(String,Array.prototype.slice.call(p.subarray(f+4,f+8)));if("acTL"===d)return!0;f+=12+b}while("IEND"!==d&&f<p.length);return!1};l.isPNG=w;l.parseApng=async function(p,g){p=h.parseApng3rdParty(p);if(p instanceof Error)throw p;
await p.createImages();D.throwIfAborted(g);const {frames:f,width:d,height:b}=p;g=document.createElement("canvas");g.width=d;g.height=b;g=g.getContext("2d",{willReadFrequently:!0});const a=[];p=[];for(const c of f){p.push(E.Milliseconds(c.delay||100));var e=c.imageElement;g.globalCompositeOperation=0===c.blendOp?"copy":"source-over";const m=2===c.disposeOp?g.getImageData(c.left,c.top,c.width,c.height):void 0;g.drawImage(e,c.left,c.top);e=g.getImageData(0,0,d,b);a.push(e);0!==c.disposeOp&&(1===c.disposeOp?
g.clearRect(c.left,c.top,c.width,c.height):2===c.disposeOp&&g.putImageData(m,c.left,c.top))}return{frameDurations:p,getFrame:c=>a[c],width:d,height:b}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/index3":function(){define(["exports","./_commonjsHelpers"],function(l,h){var D={};(function(w,t){(function(p,g){w.exports=g()})(h.commonjsGlobal,function(){return function(p){function g(d){if(f[d])return f[d].exports;var b=f[d]={exports:{},id:d,loaded:!1};p[d].call(b.exports,
b,b.exports,g);b.loaded=!0;return b.exports}var f={};g.m=p;g.c=f;g.p="";return g(0)}([function(p,g,f){function d(q,B){var y=new DataView(q.buffer),u=8,v=void 0,r=void 0,z=void 0;do r=y.getUint32(u),v=u+4,v=Array.prototype.slice.call(q.subarray(v,v+4)),v=String.fromCharCode.apply(String,v),z=B(v,q,u,r),u+=12+r;while(!1!==z&&"IEND"!=v&&u<q.length)}function b(q,B,y){var u=new Uint8Array(y);u.set(q.subarray(B,B+y));return u}Object.defineProperty(g,"__esModule",{value:!0});g.isNotPNG=function(q){return q===
c};g.isNotAPNG=function(q){return q===m};g.default=function(q){var B=new Uint8Array(q);if(Array.prototype.some.call(k,function(H,K){return H!==B[K]}))return c;var y=!1;d(B,function(H){return!(y="acTL"===H)});if(!y)return m;var u=[],v=[],r=null,z=null,A=0,C=new e.APNG;d(B,function(H,K,J,N){var P=new DataView(K.buffer);switch(H){case "IHDR":r=K.subarray(J+8,J+8+N);C.width=P.getUint32(J+8);C.height=P.getUint32(J+12);break;case "acTL":C.numPlays=P.getUint32(J+8+4);break;case "fcTL":z&&(C.frames.push(z),
A++);z=new e.Frame;z.width=P.getUint32(J+8+4);z.height=P.getUint32(J+8+8);z.left=P.getUint32(J+8+12);z.top=P.getUint32(J+8+16);H=P.getUint16(J+8+20);K=P.getUint16(J+8+22);0===K&&(K=100);z.delay=1E3*H/K;10>=z.delay&&(z.delay=100);C.playTime+=z.delay;z.disposeOp=P.getUint8(J+8+24);z.blendOp=P.getUint8(J+8+25);z.dataParts=[];0===A&&2===z.disposeOp&&(z.disposeOp=1);break;case "fdAT":z&&z.dataParts.push(K.subarray(J+8+4,J+8+N));break;case "IDAT":z&&z.dataParts.push(K.subarray(J+8,J+8+N));break;case "IEND":v.push(b(K,
J,12+N));break;default:u.push(b(K,J,12+N))}});z&&C.frames.push(z);if(0==C.frames.length)return m;var F=new Blob(u),G=new Blob(v);C.frames.forEach(function(H){var K=[];K.push(k);r.set(x(H.width),0);r.set(x(H.height),4);K.push(n("IHDR",r));K.push(F);H.dataParts.forEach(function(J){return K.push(n("IDAT",J))});K.push(G);H.imageData=new Blob(K,{type:"image/png"});delete H.dataParts;K=null});return C};var a=(p=f(1))&&p.__esModule?p:{default:p},e=f(2),c=Error("Not a PNG"),m=Error("Not an animated PNG"),
k=new Uint8Array([137,80,78,71,13,10,26,10]),n=function(q,B){var y=q.length+B.length,u=new Uint8Array(y+8),v=new DataView(u.buffer);v.setUint32(0,B.length);for(var r=u.set,z=new Uint8Array(q.length),A=0;A<q.length;A++)z[A]=q.charCodeAt(A);r.call(u,z,4);u.set(B,8);q=(0,a.default)(u,4,y);v.setUint32(y+4,q);return u},x=function(q){return new Uint8Array([q>>>24&255,q>>>16&255,q>>>8&255,q&255])}},function(p,g){Object.defineProperty(g,"__esModule",{value:!0});g.default=function(b){var a=1<arguments.length&&
void 0!==arguments[1]?arguments[1]:0,e=-1,c=a;for(a+=2<arguments.length&&void 0!==arguments[2]?arguments[2]:b.length-a;c<a;c++)e=e>>>8^f[(e^b[c])&255];return e^-1};var f=new Uint32Array(256);for(p=0;256>p;p++){g=p;for(var d=0;8>d;d++)g=0!==(g&1)?3988292384^g>>>1:g>>>1;f[p]=g}},function(p,g,f){function d(e,c){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function");}Object.defineProperty(g,"__esModule",{value:!0});g.Frame=g.APNG=void 0;var b=function(){function e(c,m){for(var k=
0;k<m.length;k++){var n=m[k];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(c,n.key,n)}}return function(c,m,k){m&&e(c.prototype,m);k&&e(c,k);return c}}(),a=(p=f(3))&&p.__esModule?p:{default:p};g.APNG=function(){function e(){d(this,e);this.playTime=this.numPlays=this.height=this.width=0;this.frames=[]}b(e,[{key:"createImages",value:function(){return Promise.all(this.frames.map(function(c){return c.createImage()}))}},{key:"getPlayer",value:function(c){var m=
this,k=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;return this.createImages().then(function(){return new a.default(m,c,k)})}}]);return e}();g.Frame=function(){function e(){d(this,e);this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageElement=this.imageData=null}b(e,[{key:"createImage",value:function(){var c=this;return this.imageElement?Promise.resolve():new Promise(function(m,k){var n=URL.createObjectURL(c.imageData);c.imageElement=document.createElement("img");
c.imageElement.onload=function(){URL.revokeObjectURL(n);m()};c.imageElement.onerror=function(){URL.revokeObjectURL(n);c.imageElement=null;k(Error("Image creation error"))};c.imageElement.src=n})}}]);return e}()},function(p,g,f){function d(a,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,e):a.__proto__=e)}Object.defineProperty(g,"__esModule",{value:!0});var b=function(){function a(e,c){for(var m=0;m<c.length;m++){var k=c[m];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(e,k.key,k)}}return function(e,c,m){c&&a(e.prototype,c);m&&a(e,m);return e}}();p=f(4);p=function(a){function e(c,m,k){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var n=(e.__proto__||Object.getPrototypeOf(e)).call(this);
if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");n=!n||"object"!==typeof n&&"function"!==typeof n?this:n;n.playbackRate=1;n._currentFrameNumber=0;n._ended=!1;n._paused=!0;n._numPlays=0;n._apng=c;n.context=m;n.stop();k&&n.play();return n}d(e,a);b(e,[{key:"renderNextFrame",value:function(){this._currentFrameNumber=(this._currentFrameNumber+1)%this._apng.frames.length;this._currentFrameNumber===this._apng.frames.length-1&&(this._numPlays++,0!==this._apng.numPlays&&
this._numPlays>=this._apng.numPlays&&(this._paused=this._ended=!0));this._prevFrame&&1==this._prevFrame.disposeOp?this.context.clearRect(this._prevFrame.left,this._prevFrame.top,this._prevFrame.width,this._prevFrame.height):this._prevFrame&&2==this._prevFrame.disposeOp&&this.context.putImageData(this._prevFrameData,this._prevFrame.left,this._prevFrame.top);var c=this.currentFrame;this._prevFrame=c;this._prevFrameData=null;2==c.disposeOp&&(this._prevFrameData=this.context.getImageData(c.left,c.top,
c.width,c.height));0==c.blendOp&&this.context.clearRect(c.left,c.top,c.width,c.height);this.context.drawImage(c.imageElement,c.left,c.top);this.emit("frame",this._currentFrameNumber);this._ended&&this.emit("end")}},{key:"play",value:function(){var c=this;this.emit("play");this._ended&&this.stop();this._paused=!1;var m=performance.now()+this.currentFrame.delay/this.playbackRate;requestAnimationFrame(function x(n){if(!c._ended&&!c._paused){if(n>=m){for(;n-m>=c._apng.playTime/c.playbackRate;)m+=c._apng.playTime/
c.playbackRate,c._numPlays++;do c.renderNextFrame(),m+=c.currentFrame.delay/c.playbackRate;while(!c._ended&&n>m)}requestAnimationFrame(x)}})}},{key:"pause",value:function(){this._paused||(this.emit("pause"),this._paused=!0)}},{key:"stop",value:function(){this.emit("stop");this._numPlays=0;this._ended=!1;this._paused=!0;this._currentFrameNumber=-1;this.context.clearRect(0,0,this._apng.width,this._apng.height);this.renderNextFrame()}},{key:"currentFrameNumber",get:function(){return this._currentFrameNumber}},
{key:"currentFrame",get:function(){return this._apng.frames[this._currentFrameNumber]}},{key:"paused",get:function(){return this._paused}},{key:"ended",get:function(){return this._ended}}]);return e}((p&&p.__esModule?p:{default:p}).default);g.default=p},function(p,g){function f(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function d(a){return"function"===typeof a}function b(a){return"object"===typeof a&&null!==a}p.exports=f;f.EventEmitter=f;f.prototype._events=void 0;
f.prototype._maxListeners=void 0;f.defaultMaxListeners=10;f.prototype.setMaxListeners=function(a){if("number"!==typeof a||0>a||isNaN(a))throw TypeError("n must be a positive number");this._maxListeners=a;return this};f.prototype.emit=function(a){var e;this._events||(this._events={});if("error"===a&&(!this._events.error||b(this._events.error)&&!this._events.error.length)){var c=arguments[1];if(c instanceof Error)throw c;var m=Error('Uncaught, unspecified "error" event. ('+c+")");m.context=c;throw m;
}m=this._events[a];if(void 0===m)return!1;if(d(m))switch(arguments.length){case 1:m.call(this);break;case 2:m.call(this,arguments[1]);break;case 3:m.call(this,arguments[1],arguments[2]);break;default:c=Array.prototype.slice.call(arguments,1),m.apply(this,c)}else if(b(m)){c=Array.prototype.slice.call(arguments,1);var k=m.slice();m=k.length;for(e=0;e<m;e++)k[e].apply(this,c)}return!0};f.prototype.addListener=function(a,e){if(!d(e))throw TypeError("listener must be a function");this._events||(this._events=
{});this._events.newListener&&this.emit("newListener",a,d(e.listener)?e.listener:e);this._events[a]?b(this._events[a])?this._events[a].push(e):this._events[a]=[this._events[a],e]:this._events[a]=e;b(this._events[a])&&!this._events[a].warned&&(e=void 0!==this._maxListeners?this._maxListeners:f.defaultMaxListeners)&&0<e&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[a].length),"function"===typeof console.trace&&console.trace());return this};f.prototype.on=f.prototype.addListener;f.prototype.once=function(a,e){function c(){this.removeListener(a,c);m||(m=!0,e.apply(this,arguments))}if(!d(e))throw TypeError("listener must be a function");var m=!1;c.listener=e;this.on(a,c);return this};f.prototype.removeListener=function(a,e){if(!d(e))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;var c=this._events[a];
var m=c.length;var k=-1;if(c===e||d(c.listener)&&c.listener===e)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,e);else if(b(c)){for(;0<m--;)if(c[m]===e||c[m].listener&&c[m].listener===e){k=m;break}if(0>k)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(k,1);this._events.removeListener&&this.emit("removeListener",a,e)}return this};f.prototype.removeAllListeners=function(a){if(!this._events)return this;if(!this._events.removeListener)return 0===
arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);this.removeAllListeners("removeListener");this._events={};return this}var e=this._events[a];if(d(e))this.removeListener(a,e);else if(e)for(;e.length;)this.removeListener(a,e[e.length-1]);delete this._events[a];return this};f.prototype.listeners=function(a){return this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:
this._events[a].slice():[]};f.prototype.listenerCount=function(a){if(this._events){a=this._events[a];if(d(a))return 1;if(a)return a.length}return 0};f.listenerCount=function(a,e){return a.listenerCount(e)}}])})})({get exports(){return D},set exports(w){D=w}});const E=h.getDefaultExportFromCjs(D);l.parseApng3rdParty=E})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../core/time","../../../../../geometry/support/meshUtils/exporters/gltf/imageutils","../../../../../chunks/index4"],
function(l,h,D,E){function w(p){const g=new Uint8Array(p);return!t.some((f,d)=>f!==g[d])}const t=[71,73,70];l.isAnimatedGIF=function(p){function g(){a++;b+=8;const c=d.getUint8(b++);b+=c&128?3*2**((c&7)+1):0;b++;f()}function f(){let c;for(;c=d.getUint8(b++);)b+=c}if(!w(p))return!1;const d=new DataView(p);p=d.getUint8(10);let b=13+(p&128?3*2**((p&7)+1):0),a=0;for(p=!1;!p;){switch(d.getUint8(b++)){case 33:a:{switch(d.getUint8(b++)){case 249:b++;b+=4;f();break;case 1:a++;b++;b+=12;f();break;case 254:f();
break;case 255:b++;b+=8;b+=3;f();break;default:var e=!1;break a}e=!0}if(!e)return!1;break;case 44:g();break;case 59:p=!0;break;default:return!1}if(1<a)return!0}return!1};l.isGIF=w;l.parseGif=async function(p,g){p=E.parseGIF_1(p);var f=E.decompressFrames_1(p,!0);const {width:d,height:b}=p.lsd;p=document.createElement("canvas");p.width=d;p.height=b;p=p.getContext("2d",{willReadFrequently:!0});const a=[];g=[];for(const c of f){g.push(h.Milliseconds(c.delay||100));f=new ImageData(c.patch,c.dims.width,
c.dims.height);var e=D.imageTypeToCanvas(f);f=3===c.disposalType?p.getImageData(c.dims.left,c.dims.top,c.dims.width,c.dims.height):void 0;p.drawImage(e,c.dims.left,c.dims.top);e=p.getImageData(0,0,d,b);a.push(e);1!==c.disposalType&&(2===c.disposalType?p.clearRect(c.dims.left,c.dims.top,c.dims.width,c.dims.height):3===c.disposalType&&p.putImageData(f,c.dims.left,c.dims.top))}return{frameDurations:g,getFrame:c=>a[c],width:d,height:b}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/geometry/support/meshUtils/exporters/gltf/imageutils":function(){define(["exports","../../../../../core/has","../../../../../core/Error","../../../../../core/maybe","../../../../../core/urlUtils"],function(l,h,D,E,w){async function t(g){if(!(g instanceof HTMLImageElement))return"image/png";g=g.src;return w.isDataProtocol(g)?(g=w.dataComponents(g),"image/jpeg"===g?.mediaType?g.mediaType:"image/png"):/\.png$/i.test(g)?"image/png":/\.(jpg|jpeg)$/i.test(g)?"image/jpeg":"image/png"}function p(g){if(g instanceof
HTMLCanvasElement)return g;if(g instanceof HTMLVideoElement)return null;const f=document.createElement("canvas");f.width=g.width;f.height=g.height;const d=f.getContext("2d");g instanceof HTMLImageElement?d.drawImage(g,0,0,g.width,g.height):g instanceof ImageData&&d.putImageData(g,0,0);return f}l.encodeBase64DataUri=function(g){const f=[];g=new Uint8Array(g);for(let d=0;d<g.length;d++)f.push(String.fromCharCode(g[d]));return"data:application/octet-stream;base64,"+btoa(f.join(""))};l.imageToArrayBuffer=
async function(g){const f=p(g);if(E.isNone(f))throw new D("imageToArrayBuffer","Unsupported image type");const d=await t(g);g=await new Promise(b=>f.toBlob(b,d));if(!g)throw new D("imageToArrayBuffer","Failed to encode image");return{data:await g.arrayBuffer(),type:d}};l.imageToDataURI=function(g){g=p(g);return E.isSome(g)?g.toDataURL():""};l.imageTypeToCanvas=p;l.isArrayBufferPNG=function(g){if(8>g.byteLength)return!1;g=new Uint8Array(g);return 137===g[0]&&80===g[1]&&78===g[2]&&71===g[3]&&13===g[4]&&
10===g[5]&&26===g[6]&&10===g[7]};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/index4":function(){define(["exports"],function(l){var h={},D={},E={};Object.defineProperty(E,"__esModule",{value:!0});E.loop=E.conditional=E.parse=void 0;E.parse=function m(e,c){var k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:k;if(Array.isArray(c))c.forEach(function(q){return m(e,q,k,n)});else if("function"===typeof c)c(e,
k,n,m);else{var x=Object.keys(c)[0];Array.isArray(c[x])?(n[x]={},m(e,c[x],k,n[x])):n[x]=c[x](e,k,n,m)}return k};E.conditional=function(e,c){return function(m,k,n,x){c(m,k,n)&&x(m,e,k,n)}};E.loop=function(e,c){return function(m,k,n,x){for(var q=[],B=m.pos;c(m,k,n);){var y={};x(m,e,k,y);if(m.pos===B)break;B=m.pos;q.push(y)}return q}};var w={};Object.defineProperty(w,"__esModule",{value:!0});w.readBits=w.readArray=w.readUnsigned=w.readString=w.peekBytes=w.readBytes=w.peekByte=w.readByte=w.buildStream=
void 0;w.buildStream=function(e){return{data:e,pos:0}};var t=function(){return function(e){return e.data[e.pos++]}};w.readByte=t;w.peekByte=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(c){return c.data[c.pos+e]}};var p=function(e){return function(c){return c.data.subarray(c.pos,c.pos+=e)}};w.readBytes=p;w.peekBytes=function(e){return function(c){return c.data.subarray(c.pos,c.pos+e)}};w.readString=function(e){return function(c){return Array.from(p(e)(c)).map(function(m){return String.fromCharCode(m)}).join("")}};
w.readUnsigned=function(e){return function(c){c=p(2)(c);return e?(c[1]<<8)+c[0]:(c[0]<<8)+c[1]}};w.readArray=function(e,c){return function(m,k,n){k="function"===typeof c?c(m,k,n):c;n=p(e);for(var x=Array(k),q=0;q<k;q++)x[q]=n(m);return x}};w.readBits=function(e){return function(c){c=t()(c);for(var m=Array(8),k=0;8>k;k++)m[7-k]=!!(c&1<<k);return Object.keys(e).reduce(function(n,x){var q=e[x];if(q.length){for(var B=q.length,y=0,u=0;u<B;u++)y+=m[q.index+u]&&Math.pow(2,B-u-1);n[x]=y}else n[x]=m[q.index];
return n},{})}};(function(e){Object.defineProperty(e,"__esModule",{value:!0});e["default"]=void 0;var c={blocks:function(q){for(var B=[],y=q.data.length,u=0,v=(0,w.readByte)()(q);0!==v&&v;v=(0,w.readByte)()(q)){if(q.pos+v>=y){y-=q.pos;B.push((0,w.readBytes)(y)(q));u+=y;break}B.push((0,w.readBytes)(v)(q));u+=v}q=new Uint8Array(u);for(y=u=0;y<B.length;y++)q.set(B[y],u),u+=B[y].length;return q}},m=(0,E.conditional)({gce:[{codes:(0,w.readBytes)(2)},{byteSize:(0,w.readByte)()},{extras:(0,w.readBits)({future:{index:0,
length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,w.readUnsigned)(!0)},{transparentColorIndex:(0,w.readByte)()},{terminator:(0,w.readByte)()}]},function(q){q=(0,w.peekBytes)(2)(q);return 33===q[0]&&249===q[1]}),k=(0,E.conditional)({image:[{code:(0,w.readByte)()},{descriptor:[{left:(0,w.readUnsigned)(!0)},{top:(0,w.readUnsigned)(!0)},{width:(0,w.readUnsigned)(!0)},{height:(0,w.readUnsigned)(!0)},{lct:(0,w.readBits)({exists:{index:0},interlaced:{index:1},
sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,E.conditional)({lct:(0,w.readArray)(3,function(q,B,y){return Math.pow(2,y.descriptor.lct.size+1)})},function(q,B,y){return y.descriptor.lct.exists}),{data:[{minCodeSize:(0,w.readByte)()},c]}]},function(q){return 44===(0,w.peekByte)()(q)}),n=(0,E.conditional)({text:[{codes:(0,w.readBytes)(2)},{blockSize:(0,w.readByte)()},{preData:function(q,B,y){return(0,w.readBytes)(y.text.blockSize)(q)}},c]},function(q){q=(0,w.peekBytes)(2)(q);
return 33===q[0]&&1===q[1]}),x=(0,E.conditional)({application:[{codes:(0,w.readBytes)(2)},{blockSize:(0,w.readByte)()},{id:function(q,B,y){return(0,w.readString)(y.blockSize)(q)}},c]},function(q){q=(0,w.peekBytes)(2)(q);return 33===q[0]&&255===q[1]});c=(0,E.conditional)({comment:[{codes:(0,w.readBytes)(2)},c]},function(q){q=(0,w.peekBytes)(2)(q);return 33===q[0]&&254===q[1]});m=[{header:[{signature:(0,w.readString)(3)},{version:(0,w.readString)(3)}]},{lsd:[{width:(0,w.readUnsigned)(!0)},{height:(0,w.readUnsigned)(!0)},
{gct:(0,w.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,w.readByte)()},{pixelAspectRatio:(0,w.readByte)()}]},(0,E.conditional)({gct:(0,w.readArray)(3,function(q,B){return Math.pow(2,B.lsd.gct.size+1)})},function(q,B){return B.lsd.gct.exists}),{frames:(0,E.loop)([m,x,c,k,n],function(q){q=(0,w.peekByte)()(q);return 33===q||44===q})}];e["default"]=m})(D);var g={};Object.defineProperty(g,"__esModule",{value:!0});g.deinterlace=
void 0;g.deinterlace=function(e,c){for(var m=Array(e.length),k=e.length/c,n=[0,4,2,1],x=[8,8,4,2],q=0,B=0;4>B;B++)for(var y=n[B];y<k;y+=x[B]){var u=y,v=e.slice(q*c,(q+1)*c);m.splice.apply(m,[u*c,c].concat(v));q++}return m};var f={};Object.defineProperty(f,"__esModule",{value:!0});f.lzw=void 0;f.lzw=function(e,c,m){var k,n,x,q,B,y,u,v,r=Array(m),z=Array(4096),A=Array(4096),C=Array(4097);var F=1<<e;var G=F+1;var H=F+2;var K=-1;var J=e+1;var N=(1<<J)-1;for(n=0;n<F;n++)z[n]=0,A[n]=n;for(x=q=k=B=y=v=u=
0;x<m;){if(0===y){if(k<J){q+=c[u]<<k;k+=8;u++;continue}n=q&N;q>>=J;k-=J;if(n>H||n==G)break;if(n==F){J=e+1;N=(1<<J)-1;H=F+2;K=-1;continue}if(-1==K){C[y++]=A[n];B=K=n;continue}var P=n;n==H&&(C[y++]=B,n=K);for(;n>F;)C[y++]=A[n],n=z[n];B=A[n]&255;C[y++]=B;4096>H&&(z[H]=K,A[H]=B,H++,0===(H&N)&&4096>H&&(J++,N+=H));K=P}y--;r[v++]=C[y];x++}for(x=v;x<m;x++)r[x]=0;return r};Object.defineProperty(h,"__esModule",{value:!0});l.decompressFrames_1=h.decompressFrames=h.decompressFrame=l.parseGIF_1=h.parseGIF=void 0;
var d=D&&D.__esModule?D:{default:D};l.parseGIF_1=h.parseGIF=function(e){e=new Uint8Array(e);return(0,E.parse)((0,w.buildStream)(e),d["default"])};var b=function(e,c,m){if(e.image){var k=e.image,n=(0,f.lzw)(k.data.minCodeSize,k.data.blocks,k.descriptor.width*k.descriptor.height);k.descriptor.lct.interlaced&&(n=(0,g.deinterlace)(n,k.descriptor.width));n={pixels:n,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};n.colorTable=
k.descriptor.lct&&k.descriptor.lct.exists?k.lct:c;e.gce&&(n.delay=10*(e.gce.delay||10),n.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(n.transparentIndex=e.gce.transparentColorIndex));if(m){e=n.pixels.length;c=new Uint8ClampedArray(4*e);for(m=0;m<e;m++){k=4*m;var x=n.pixels[m],q=n.colorTable[x]||[0,0,0];c[k]=q[0];c[k+1]=q[1];c[k+2]=q[2];c[k+3]=x!==n.transparentIndex?255:0}n.patch=c}return n}console.warn("gif frame does not have associated image.")};h.decompressFrame=b;l.decompressFrames_1=
h.decompressFrames=function(e,c){return e.frames.filter(function(m){return m.image}).map(function(m){return b(m,e.gct,c)})}})},"esri/views/2d/engine/Container":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/mat3f32 ../../../layers/effects/EffectView ./DisplayObject ./webgl/effects/highlight/HighlightGradient".split(" "),function(l,h,D,E,w,t){w=function(p){function g(){var d=f.apply(this,arguments);d._childrenSet=new Set;d._needsSort=!1;d.children=[];d._effectView=
null;d._highlightOptions=null;d._highlightGradient=null;return d}h._inherits(g,p);var f=h._createSuper(g);p=g.prototype;p.updateTransitionProperties=function(d,b){h._get(h._getPrototypeOf(g.prototype),"updateTransitionProperties",this).call(this,d,b);this._effectView&&(this._effectView.transitionStep(d,b),this._effectView.transitioning&&this.requestRender())};p.doRender=function(d){d=this.createRenderParams(d);this.renderChildren(d)};p.addChild=function(d){return this.addChildAt(d,this.children.length)};
p.addChildAt=function(d,b=this.children.length){if(!d||this.contains(d))return d;this._needsSort=!0;const a=d.parent;a&&a!==this&&a.removeChild(d);b>=this.children.length?this.children.push(d):this.children.splice(b,0,d);this._childrenSet.add(d);d.parent=this;d.stage=this.stage;this!==this.stage&&(d.clips=this.clips);this.requestRender();return d};p.contains=function(d){return this._childrenSet.has(d)};p.endTransitions=function(){h._get(h._getPrototypeOf(g.prototype),"endTransitions",this).call(this);
this._effectView&&(this._effectView.endTransitions(),this.requestRender())};p.removeAllChildren=function(){this._childrenSet.clear();this._needsSort=!0;for(const d of this.children)this!==this.stage&&(d.clips=null),d.stage=null,d.parent=null;this.children.length=0};p.removeChild=function(d){return this.contains(d)?this.removeChildAt(this.children.indexOf(d)):d};p.removeChildAt=function(d){if(0>d||d>=this.children.length)return null;this._needsSort=!0;d=this.children.splice(d,1)[0];this._childrenSet.delete(d);
this!==this.stage&&(d.clips=null);d.stage=null;d.parent=null;return d};p.sortChildren=function(d){this._needsSort&&(this.children.sort(d),this._needsSort=!1)};p.beforeRender=function(d){h._get(h._getPrototypeOf(g.prototype),"beforeRender",this).call(this,d);for(const b of this.children)b.beforeRender(d)};p.afterRender=function(d){h._get(h._getPrototypeOf(g.prototype),"afterRender",this).call(this,d);for(const b of this.children)b.afterRender(d)};p._createTransforms=function(){return{dvs:D.create()}};
p.onAttach=function(){h._get(h._getPrototypeOf(g.prototype),"onAttach",this).call(this);const d=this.stage;for(const b of this.children)b.stage=d};p.onDetach=function(){h._get(h._getPrototypeOf(g.prototype),"onDetach",this).call(this);for(const d of this.children)d.stage=null};p.renderChildren=function(d){for(const b of this.children)b.processRender(d)};p.createRenderParams=function(d){return{...d,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:d.globalOpacity*this.computedOpacity,
inFadeTransition:this.inFadeTransition,highlightGradient:this._highlightGradient||d.highlightGradient}};h._createClass(g,[{key:"blendMode",get:function(){return this._blendMode},set:function(d){this._blendMode=d;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(d){this._clips=d;this.children.forEach(b=>b.clips=d)}},{key:"computedEffects",get:function(){return this._effectView?.effects??null}},{key:"effect",get:function(){return this._effectView?.effect??""},set:function(d){if(this._effectView||
d)this._effectView||(this._effectView=new E.EffectView),this._effectView.effect=d,this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},set:function(d){d?this._highlightOptions&&this._highlightOptions.equals(d)||(this._highlightOptions=d,this._highlightGradient||(this._highlightGradient=new t),this._highlightGradient.setHighlightOptions(d),this.requestRender()):(this._highlightOptions=null,this._highlightGradient&&(this._highlightGradient.destroy(),this._highlightGradient=
null,this.requestRender()))}}]);return g}(w.DisplayObject);l.Container=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(l,h,
D,E,w,t,p,g,f,d,b,a){function e(k){k=b.parse(k)||[];var n=(n=k[0])?"type"in n:!1;return n?[{scale:-1,effects:k}]:k}function c(k,n,x){return k[0]?.effects&&n[0]?.effects?(-1===k[0]?.scale||-1===n[0]?.scale)&&(1<k.length||1<n.length)&&0>=x?!1:a.canInterpolateEffects(k[0].effects,n[0].effects):!0}function m(k,n,x){const q=k.length>n.length?k:n;k=k.length>n.length?n:k;var B=k[k.length-1];n=B?.scale??x;B=B?.effects??[];for(let y=k.length;y<q.length;y++)k.push({scale:n,effects:[...B]});for(n=0;n<q.length;n++)k[n].scale=
-1===k[n].scale?x:k[n].scale,q[n].scale=-1===q[n].scale?x:q[n].scale,a.normalizeEffects(k[n].effects,q[n].effects)}l.EffectView=function(k){function n(q){q=x.call(this,q);q._from=null;q._to=null;q._final=null;q._current=[];q._time=0;q.duration=w("mapview-transitions-duration");q.effects=[];return q}h._inherits(n,k);var x=h._createSuper(n);k=n.prototype;k.canTransitionTo=function(q){try{return 0<this.scale&&c(this._current,e(q),this.scale)}catch{return!1}};k.transitionStep=function(q,B){this._applyTimeTransition(q);
this._updateForScale(B)};k.endTransitions=function(){this._applyTimeTransition(this.duration)};k._transitionTo=function(q){0<this.scale&&c(this._current,q,this.scale)?(this._final=q,this._to=t.clone(q),m(this._current,this._to,this.scale),this._from=t.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=q);this._set("effects",this._current[0]?t.clone(this._current[0].effects):[])};k._applyTimeTransition=function(q){if(this._to&&this._from&&this._current&&this._final){this._time+=
q;q=Math.min(1,this._time/this.duration);for(let y=0;y<this._current.length;y++){const u=this._current[y],v=this._from[y],r=this._to[y];var B=v.scale;u.scale=B+(r.scale-B)*q;for(B=0;B<u.effects.length;B++)u.effects[B].interpolate(v.effects[B],r.effects[B],q)}1===q&&(this._current=this._final,this._set("effects",this._current[0]?t.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}};k._updateForScale=function(q){this._set("scale",q);if(0!==this._current.length){var B=this._current,
y=this._current.length-1,u,v=1;if(1===B.length||q>=B[0].scale)var r=u=B[0].effects;else if(q<=B[y].scale)r=u=B[y].effects;else for(let z=0;z<y;z++){const A=B[z],C=B[z+1];if(A.scale>=q&&C.scale<=q){v=(q-A.scale)/(C.scale-A.scale);u=A.effects;r=C.effects;break}}for(q=0;q<this.effects.length;q++)this.effects[q].interpolate(u[q],r[q],v)}};h._createClass(n,[{key:"effect",set:function(q){const B=this._get("effect");q=q||"";if(B!==q){this._set("effect",q);try{this._transitionTo(e(q))}catch(y){this._transitionTo([]),
p.getLogger(this.declaredClass).warn("Invalid Effect",{effect:q,error:y})}}}},{key:"hasEffects",get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(q){this._updateForScale(q)}},{key:"transitioning",get:function(){return null!==this._to}}]);return n}(E);D.__decorate([g.property()],l.EffectView.prototype,"_to",void 0);D.__decorate([g.property()],l.EffectView.prototype,"duration",void 0);D.__decorate([g.property({value:""})],l.EffectView.prototype,"effect",null);
D.__decorate([g.property({readOnly:!0})],l.EffectView.prototype,"effects",void 0);D.__decorate([g.property({readOnly:!0})],l.EffectView.prototype,"hasEffects",null);D.__decorate([g.property({value:0})],l.EffectView.prototype,"scale",null);D.__decorate([g.property({readOnly:!0})],l.EffectView.prototype,"transitioning",null);l.EffectView=D.__decorate([d.subclass("esri.layers.effects.EffectView")],l.EffectView);l.canInterpolateEffectStops=c;l.convertEffectToStops=e;l.normalizeEffectStops=m;Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/DisplayObject":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/Evented ../../../core/has ../../../core/maybe ../../../core/promiseUtils".split(" "),function(l,h,D,E,w,t){const p=1/E("mapview-transitions-duration");D=function(g){function f(){var b=d.apply(this,arguments);b._fadeOutResolver=null;b._fadeInResolver=null;b._clips=null;b.computedVisible=!0;b.computedOpacity=1;b.fadeTransitionEnabled=!1;b.inFadeTransition=
!1;b._isReady=!1;b._opacity=1;b.parent=null;b._stage=null;b._visible=!0;return b}h._inherits(f,g);var d=h._createSuper(f);g=f.prototype;g._getTransforms=function(){w.isNone(this._transforms)&&(this._transforms=this._createTransforms());return this._transforms};g.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.opacity=1;this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=
t.createResolver();this.requestRender();return this._fadeInResolver.promise};g.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;this.opacity=0;this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=t.createResolver();this.requestRender();return this._fadeOutResolver.promise};g.endTransitions=function(){this._fadeInResolver?.();this._fadeInResolver=null;this._fadeOutResolver?.();this._fadeOutResolver=
null;this.computedOpacity=this.visible?this.opacity:0;this.requestRender()};g.beforeRender=function(b){this.updateTransitionProperties(b.deltaTime,b.state.scale)};g.afterRender=function(b){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)};g.remove=function(){this.parent?.removeChild(this)};g.setTransform=function(b){};g.processRender=function(b){this.stage&&
this.computedVisible&&this.doRender(b)};g.requestRender=function(){this.stage&&this.stage.requestRender()};g.processDetach=function(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.onDetach();this.emit("detach")};g.updateTransitionProperties=function(b,a){if(this.fadeTransitionEnabled){a=this._fadeOutResolver||!this.visible?0:this.opacity;const e=this.computedOpacity;e===a?this.computedVisible=
this.visible:(b*=p,this.computedOpacity=e>a?Math.max(a,e-b):Math.min(a,e+b),this.computedVisible=0<this.computedOpacity,b=a===this.computedOpacity,this.inFadeTransition=!b,b||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};g.onAttach=function(){};g.onDetach=function(){};g.doRender=function(b){};g.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};h._createClass(f,[{key:"clips",get:function(){return this._clips},
set:function(b){this._clips=b;this.requestRender()}},{key:"isReady",get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(b){this._opacity!==b&&(this._opacity=Math.min(1,Math.max(b,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(b){if(this._stage!==b){var a=this._stage;(this._stage=b)?this._stage?.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):a?.trashDisplayObject(this)}}},{key:"transforms",
get:function(){return this._getTransforms()}},{key:"visible",get:function(){return this._visible},set:function(b){this._visible!==b&&(this._visible=b,this.requestRender())}}]);return f}(D);l.DisplayObject=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../definitions ./parameters ../../../../../webgl/enums ../../../../../webgl/Texture".split(" "),
function(l,h,D,E,w,t){function p(d,b){b.fillColor[0]=d.color.r/255;b.fillColor[1]=d.color.g/255;b.fillColor[2]=d.color.b/255;b.fillColor[3]=d.color.a;d.haloColor?(b.outlineColor[0]=d.haloColor.r/255,b.outlineColor[1]=d.haloColor.g/255,b.outlineColor[2]=d.haloColor.b/255,b.outlineColor[3]=d.haloColor.a):(b.outlineColor[0]=b.fillColor[0],b.outlineColor[1]=b.fillColor[1],b.outlineColor[2]=b.fillColor[2],b.outlineColor[3]=b.fillColor[3]);b.fillColor[3]*=d.fillOpacity;b.outlineColor[3]*=d.haloOpacity;
b.fillColor[0]*=b.fillColor[3];b.fillColor[1]*=b.fillColor[3];b.fillColor[2]*=b.fillColor[3];b.outlineColor[0]*=b.outlineColor[3];b.outlineColor[1]*=b.outlineColor[3];b.outlineColor[2]*=b.outlineColor[3];b.outlineWidth=E.HIGHLIGHT_SIZING.outlineWidth;b.outerHaloWidth=E.HIGHLIGHT_SIZING.outerHaloWidth;b.innerHaloWidth=E.HIGHLIGHT_SIZING.innerHaloWidth;b.outlinePosition=E.HIGHLIGHT_SIZING.outlinePosition}const g=h.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),f=[0,0,0,
0];return function(){function d(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:E.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:E.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:E.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:E.HIGHLIGHT_SIZING.outerHaloWidth};this._shadeTexChanged=!0;this._texelData=new Uint8Array(4*E.SHADE_TEXTURE_SIZE);this._minMaxDistance=[0,0]}var b=d.prototype;b.setHighlightOptions=function(a){function e(y,
u,v){B[0]=(1-v)*y[0]+v*u[0];B[1]=(1-v)*y[1]+v*u[1];B[2]=(1-v)*y[2]+v*u[2];B[3]=(1-v)*y[3]+v*u[3]}const c=this._convertedHighlightOptions;p(a,c);a=c.outlinePosition-c.outlineWidth/2-c.outerHaloWidth;const m=c.outlinePosition-c.outlineWidth/2,k=c.outlinePosition+c.outlineWidth/2,n=c.outlinePosition+c.outlineWidth/2+c.innerHaloWidth;var x=Math.sqrt(Math.PI/2)*E.SIGMA,q=Math.abs(a)>x?Math.round(10*(Math.abs(a)-x))/10:0;x=Math.abs(n)>x?Math.round(10*(Math.abs(n)-x))/10:0;q&&!x?g.error("The outer rim of the highlight is "+
q+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!q&&x?g.error("The inner rim of the highlight is "+x+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):q&&x&&g.error("The highlight is "+Math.max(q,x)+"px away from the edge of the feature; consider reducing some width values.");const B=[void 0,void 0,void 0,
void 0];({_texelData:x}=this);for(let y=0;y<E.SHADE_TEXTURE_SIZE;++y)q=a+y/(E.SHADE_TEXTURE_SIZE-1)*(n-a),q<a?(B[4*y]=0,B[4*y+1]=0,B[4*y+2]=0,B[4*y+3]=0):q<m?e(f,c.outlineColor,(q-a)/(m-a)):q<k?[B[0],B[1],B[2],B[3]]=c.outlineColor:q<n?e(c.outlineColor,c.fillColor,(q-k)/(n-k)):[B[4*y],B[4*y+1],B[4*y+2],B[4*y+3]]=c.fillColor,x[4*y]=255*B[0],x[4*y+1]=255*B[1],x[4*y+2]=255*B[2],x[4*y+3]=255*B[3];this._minMaxDistance[0]=a;this._minMaxDistance[1]=n;this._shadeTexChanged=!0};b.applyHighlightOptions=function(a,
e){this._shadeTex||(this._shadeTex=new t.Texture(a,{target:w.TextureType.TEXTURE_2D,pixelFormat:w.PixelFormat.RGBA,dataType:w.PixelType.UNSIGNED_BYTE,wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,width:E.SHADE_TEXTURE_SIZE,height:1,samplingMode:w.TextureSamplingMode.LINEAR}));this._shadeTexChanged&&(this._shadeTex.updateData(0,0,0,E.SHADE_TEXTURE_SIZE,1,this._texelData),this._shadeTexChanged=!1);a.bindTexture(this._shadeTex,D.TEXTURE_BINDING_HIGHLIGHT_1);e.setUniform2fv("u_minMaxDistance",this._minMaxDistance)};
b.destroy=function(){this._shadeTex?.dispose();this._shadeTex=null};return l._createClass(d)}()})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],function(l){l.ANGLE_FACTOR_256=256/360;l.ATTRIBUTE_DATA_ANIMATION=1;l.ATTRIBUTE_DATA_DD0=3;l.ATTRIBUTE_DATA_DD1=4;l.ATTRIBUTE_DATA_FILTER_FLAGS=0;l.ATTRIBUTE_DATA_GPGPU=2;l.ATTRIBUTE_DATA_VV=3;l.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;l.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};l.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR=
8;l.BITSET_FILL_RANDOM_PATTERN_OFFSET=4;l.BITSET_GENERIC_CONSIDER_ALPHA_ONLY=16;l.BITSET_GENERIC_LOCK_COLOR=2;l.BITSET_LINE_SCALE_DASH=4;l.BITSET_MARKER_ALIGNMENT_MAP=1;l.BITSET_MARKER_ALIGNMENT_SCREEN=0;l.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE=4;l.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY=8;l.BITSET_TYPE_FILL_OUTLINE=1;l.BUFFER_DATA_MINIMUM_SIZE=128;l.BUFFER_DATA_POOL_SIZE=4;l.CHART_MAX_FIELDS=10;l.COLLISION_BOX_PADDING=16;l.COLLISION_BUCKET_SIZE=128;l.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;
l.COLLISION_MAX_ZOOM_DELTA=1;l.COLLISION_PLACEMENT_PADDING=8;l.COLLISION_TILE_BOX_SIZE=4;l.DEBUG_LABELS=!1;l.DISPLAY_RECORD_INT_PER_ELEMENT=8;l.DOT_DENSITY_MAX_FIELDS=8;l.EFFECT_FLAG_0=4;l.ENABLE_EARLY_LABEL_DISCARD=!1;l.EXTRUDE_SCALE=64;l.FILTER_FLAG_0=2;l.GLYPH_SIZE=24;l.HEURISTIC_GLYPHS_PER_FEATURE=10;l.HEURISTIC_GLYPHS_PER_LINE=50;l.HIGHLIGHT_FLAG=1;l.HITTEST_RADIUS=3;l.MAGIC_LABEL_LINE_HEIGHT=29;l.MAX_FILTERS=2;l.MAX_GPU_UPLOADS_PER_FRAME=2;l.MIN_MAX_ZOOM_PRECISION_FACTOR=10;l.NAN_MAGIC_NUMBER=
1E-30;l.PATCH_PIXEL_BUFFER_ALLOC_SIZE=500;l.PATTERN_FILL_RASTERIZATION_SCALE=2;l.PICTURE_FILL_COLOR=4294967295;l.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE=1024;l.RASTER_TILE_SIZE=256;l.SDF_TEXTURE_SIZE=124;l.SPRITE_PADDING=2;l.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;l.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;l.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;l.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;l.TEXTURE_BINDING_ATTRIBUTE_DATA_4=5;l.TEXTURE_BINDING_ATTRIBUTE_DATA_5=6;l.TEXTURE_BINDING_BITMAP=0;l.TEXTURE_BINDING_GLYPH_ATLAS=0;l.TEXTURE_BINDING_GPGPU=
12;l.TEXTURE_BINDING_HIGHLIGHT_0=5;l.TEXTURE_BINDING_HIGHLIGHT_1=6;l.TEXTURE_BINDING_RENDERER_0=5;l.TEXTURE_BINDING_RENDERER_1=6;l.TEXTURE_BINDING_SPRITE_ATLAS=0;l.TEXTURE_UPLOAD_MANAGER_BUDGET=4;l.TEXTURE_UPLOAD_MANAGER_CHUNK_SIZE=128;l.TEXT_PLACEMENT_PADDING=8;l.THIN_LINE_HALF_WIDTH_THRESHOLD=1.05;l.TILE_SIZE=512;l.VTL_HIGH_RES_CUTOFF=1.15;l.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;l.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;l.WEBGL_MAX_INNER_STOPS=6;l.WEBGL_MAX_STOPS=8;Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],function(l){l.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];l.HIGHLIGHT_SIZING={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,outlinePosition:0};l.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l.SHADE_TEXTURE_SIZE=256;l.SIGMA=1;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/BufferPool":function(){define(["exports",
"../../../../chunks/_rollupPluginBabelHelpers","../../../../core/has","../../../../core/maybe","./cpuMapped/FreeList"],function(l,h,D,E,w){const t=D("esri-2d-log-allocations");D=function(){function f(b,a){this._array=b;this._pool=a}f.create=function(b,a){b=a.acquire(b);return new f(b,a)};var d=f.prototype;d.expand=function(b){b=this._pool.acquire(b);b.set(this._array);this._pool.release(this._array);this._array=b};d.destroy=function(){this._pool.release(this._array)};d.set=function(b,a){this._array.set(b._array,
a)};d.slice=function(){const b=this._pool.acquire(this._array.byteLength);b.set(this._array);return new f(b,this._pool)};h._createClass(f,[{key:"array",get:function(){return this._array}},{key:"length",get:function(){return this._array.length}}]);return f}();let p=function(){function f(){this._data=new ArrayBuffer(f.BYTE_LENGTH);this._freeList=new w.FreeList({start:0,end:this._data.byteLength})}var d=f.prototype;d.allocate=function(b){const a=this._freeList.firstFit(b);return E.isNone(a)?null:new Uint32Array(this._data,
a,b/Uint32Array.BYTES_PER_ELEMENT)};d.free=function(b){this._freeList.free(b.byteOffset,b.byteLength)};h._createClass(f,[{key:"buffer",get:function(){return this._data}}],[{key:"BYTE_LENGTH",get:function(){return 64E6}}]);return f}(),g=function(){function f(){this._bytesAllocated=0;this._pages=[];this._pagesByBuffer=new Map;this._addPage()}var d=f.prototype;d.destroy=function(){this._pages=[];this._pagesByBuffer=null};d.acquire=function(b){this._bytesAllocated+=b;t&&console.log(`Allocating ${b}, (${this._bytesAllocated} / ${this._bytesTotal})`);
if(b>p.BYTE_LENGTH)return new Uint32Array(b/Uint32Array.BYTES_PER_ELEMENT);for(const a of this._pages){const e=a.allocate(b);if(E.isSome(e))return e}return E.unwrapOrThrow(this._addPage().allocate(b),"Expected to allocate page")};d.release=function(b){this._bytesAllocated-=b.byteLength;t&&console.log(`Freeing ${b.byteLength}, (${this._bytesAllocated} / ${this._bytesTotal})`);const a=this._pagesByBuffer.get(b.buffer);a&&a.free(b)};d._addPage=function(){const b=new p;this._pages.push(b);this._pagesByBuffer.set(b.buffer,
b);return b};h._createClass(f,[{key:"_bytesTotal",get:function(){return this._pages.length*p.BYTE_LENGTH}}]);return f}();l.BufferPool=g;l.TypedBuffer=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/cpuMapped/FreeList":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe"],function(l,h,D){let E=function(){function t(g){this.next=null;if(Array.isArray(g)){this.data=g[0];var f=this;for(let d=1;d<g.length;d++)f.next=
new t([g[d]]),f=f.next}else this.data=g}var p=t.prototype;p.values=function*(){let g=this;for(;g;)yield g.data,g=g.next};p.forEach=function(g){let f=this;for(;f;)g(f.data),f=f.next};p.find=function(g){return g(this.data)?this:this.next?.find(g)};p.max=function(g,f=this){f=g(this.data)>g(f.data)?this:f;return this.next?this.next.max(g,f):f};p.remove=function(g,f=null){return this===g?f?(f.next=this.next,f):this.next:this.next?.remove(g,this)??null};h._createClass(t,[{key:"last",get:function(){return this.next?
this.next.last:this}}]);return t}(),w=function(){function t(g){this._head=null;D.isNone(g)||(this._head=new E(g))}var p=t.prototype;p.maxAvailableSpace=function(){if(D.isNone(this._head))return 0;const g=this._head.max(f=>f.end-f.start);return g.data.end-g.data.start};p.firstFit=function(g){if(D.isNone(this._head))return null;var f=null;let d=this._head;for(;d;){const b=d.data.end-d.data.start;if(b===g)return f?f.next=d.next:this._head=d.next,d.data.start;if(b>g)return f=d.data.start,d.data.start+=
g,f;f=d;d=d.next}return null};p.free=function(g,f){const d=g+f;if(D.isNone(this._head))this._head=new E({start:g,end:d});else if(d<=this._head.data.start)if(d===this._head.data.start)this._head.data.start-=f;else{var b=new E({start:g,end:d});b.next=this._head;this._head=b}else{b=this._head;for(var a=b.next;a;){if(a.data.start>=d){if(b.data.end===g){b.data.end+=f;b.data.end===a.data.start&&(b.data.end+=a.data.end-a.data.start,b.next=a.next);return}if(a.data.start===d){a.data.start-=f;return}g=new E({start:g,
end:d});g.next=b.next;b.next=g;return}b=a;a=a.next}g===b.data.end?b.data.end+=f:(g=new E({start:g,end:d}),b.next=g)}};h._createClass(t,[{key:"head",get:function(){return this._head}}]);return t}();l.FreeList=w;l.List=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(l){l.WGLGeometryType=void 0;(function(h){h[h.FILL=0]="FILL";h[h.LINE=1]="LINE";h[h.MARKER=2]="MARKER";h[h.TEXT=3]="TEXT";h[h.LABEL=4]="LABEL"})(l.WGLGeometryType||
(l.WGLGeometryType={}));l.WGLDrawPhase=void 0;(function(h){h[h.NONE=0]="NONE";h[h.MAP=1]="MAP";h[h.LABEL=2]="LABEL";h[h.LABEL_ALPHA=4]="LABEL_ALPHA";h[h.HITTEST=8]="HITTEST";h[h.HIGHLIGHT=16]="HIGHLIGHT";h[h.CLIP=32]="CLIP";h[h.DEBUG=64]="DEBUG";h[h.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(l.WGLDrawPhase||(l.WGLDrawPhase={}));l.VVType=void 0;(function(h){h[h.SIZE=0]="SIZE";h[h.COLOR=1]="COLOR";h[h.OPACITY=2]="OPACITY";h[h.ROTATION=3]="ROTATION"})(l.VVType||(l.VVType={}));l.WGLVVFlag=void 0;(function(h){h[h.NONE=
0]="NONE";h[h.OPACITY=1]="OPACITY";h[h.COLOR=2]="COLOR";h[h.ROTATION=4]="ROTATION";h[h.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";h[h.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";h[h.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";h[h.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(l.WGLVVFlag||(l.WGLVVFlag={}));l.WGLVVTarget=void 0;(function(h){h[h.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";h[h.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";h[h.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";h[h.UNIT_TARGETS_OUTLINE=
1024]="UNIT_TARGETS_OUTLINE"})(l.WGLVVTarget||(l.WGLVVTarget={}));l.MosaicType=void 0;(function(h){h[h.SPRITE=0]="SPRITE";h[h.GLYPH=1]="GLYPH"})(l.MosaicType||(l.MosaicType={}));l.WGLSymbologyType=void 0;(function(h){h[h.DEFAULT=0]="DEFAULT";h[h.SIMPLE=1]="SIMPLE";h[h.DOT_DENSITY=2]="DOT_DENSITY";h[h.OUTLINE_FILL=3]="OUTLINE_FILL";h[h.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE";h[h.HEATMAP=5]="HEATMAP";h[h.PIE_CHART=6]="PIE_CHART"})(l.WGLSymbologyType||(l.WGLSymbologyType={}));Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../brushes ../vectorTiles/shaders/VTLMaterialManager ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./TextureUploadManager ./WorldExtentClipRenderer ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/HittestEffectVTL ./effects/post-processing/EffectManager ./painter/RenderPass ../../../webgl/context-util ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Renderbuffer".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q,B,y,u){function v(z,A){switch(z){case t.WGLGeometryType.LINE:return D.brushes.line;case t.WGLGeometryType.TEXT:return D.brushes.text;case t.WGLGeometryType.LABEL:return D.brushes.label;case t.WGLGeometryType.FILL:switch(A){case t.WGLSymbologyType.DOT_DENSITY:return D.brushes.dotDensity;default:return D.brushes.fill}case t.WGLGeometryType.MARKER:switch(A){case t.WGLSymbologyType.HEATMAP:return D.brushes.heatmap;case t.WGLSymbologyType.PIE_CHART:return D.brushes.pieChart;
default:return D.brushes.marker}}}function r(z,A,C,F){return z!==t.WGLDrawPhase.HIGHLIGHT&&(1!==F||h.isSome(A)&&"normal"!==A||h.isSome(C)&&0<C.length)}return function(){function z(C,F,G){this.context=C;this._blitRenderer=new w.BitBlitRenderer;this._worldExtentClipRenderer=new d.WorldExtentClipRenderer;this._isClippedToWorldExtent=!1;this._brushCache=new Map;this._prevFBO=this._lastHeight=this._lastWidth=null;this._vtlMaterialManager=new E;this._blendEffect=new a.BlendEffect;this._fbos=this._stencilBuf=
null;this._fboPool=[];this._renderTarget=null;this.effects={highlight:new c,hittest:new m.HittestEffect,hittestVTL:new k.HittestEffectVTL,integrate:new b.AnimationEffect,insideEffect:new e.FeatureEffect("inside"),outsideEffect:new e.FeatureEffect("outside")};this.materialManager=new p(C);this.textureManager=new g(F,G,C.type===q.ContextType.WEBGL2);this.textureUploadManager=new f.TextureUploadManager(C,F);this._effectsManager=new n.EffectManager}var A=z.prototype;A.getRenderTarget=function(){return this._renderTarget};
A.setRenderTarget=function(C){this._renderTarget=C};A.getFbos=function(C,F){if(C!==this._lastWidth||F!==this._lastHeight){this._lastWidth=C;this._lastHeight=F;if(this._fbos){for(var G in this._fbos)this._fbos[G].resize(C,F);return this._fbos}G={target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,samplingMode:B.TextureSamplingMode.NEAREST,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,width:C,height:F};const H={colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER};
this._stencilBuf=C=new u.Renderbuffer(this.context,{width:C,height:F,internalFormat:B.RenderbufferFormat.DEPTH_STENCIL});this._fbos={output:new y.FramebufferObject(this.context,H,G,C),blend:new y.FramebufferObject(this.context,H,G,C),effect0:new y.FramebufferObject(this.context,H,G,C)}}return this._fbos};A.acquireFbo=function(C,F){let G;G=0<this._fboPool.length?this._fboPool.pop():new y.FramebufferObject(this.context,{colorTarget:B.TargetType.TEXTURE,depthStencilTarget:B.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},
{target:B.TextureType.TEXTURE_2D,pixelFormat:B.PixelFormat.RGBA,dataType:B.PixelType.UNSIGNED_BYTE,samplingMode:B.TextureSamplingMode.NEAREST,wrapMode:B.TextureWrapMode.CLAMP_TO_EDGE,width:C,height:F},this._stencilBuf);const H=G.descriptor;H.width===C&&H.height===F||G.resize(C,F);return G};A.releaseFbo=function(C){this._fboPool.push(C)};A.getSharedStencilBuffer=function(){return this._stencilBuf};A.beforeRenderLayers=function(C,F=null){const {width:G,height:H}=C.getViewport();this._prevFBO=C.getBoundFramebufferObject();
const K=this.getFbos(G,H);C.bindFramebuffer(K?.output);C.setColorMask(!0,!0,!0,!0);if(h.isSome(F)){const {r:J,g:N,b:P,a:W}=F.color;C.setClearColor(W*J/255,W*N/255,W*P/255,W)}else C.setClearColor(0,0,0,0);C.setDepthWriteEnabled(!0);C.setClearDepth(1);C.clear(C.gl.COLOR_BUFFER_BIT|C.gl.DEPTH_BUFFER_BIT);C.setDepthWriteEnabled(!1)};A.beforeRenderLayer=function(C,F,G){const {context:H,blendMode:K,effects:J,requireFBO:N,drawPhase:P}=C;N||r(P,K,J,G)?(H.bindFramebuffer(this._fbos?.blend),H.setColorMask(!0,
!0,!0,!0),H.setClearColor(0,0,0,0),H.setDepthWriteEnabled(!0),H.setClearDepth(1),H.clear(H.gl.COLOR_BUFFER_BIT|H.gl.DEPTH_BUFFER_BIT),H.setDepthWriteEnabled(!1)):(C=this._getOutputFBO(),H.bindFramebuffer(C));H.setDepthWriteEnabled(!1);H.setDepthTestEnabled(!1);H.setStencilTestEnabled(!0);H.setClearStencil(F);H.setStencilWriteMask(255);H.clear(H.gl.STENCIL_BUFFER_BIT)};A.compositeLayer=function(C,F){const {context:G,blendMode:H,effects:K,requireFBO:J,drawPhase:N}=C;if(J||r(N,H,K,F)){h.isSome(K)&&0<
K.length&&N===t.WGLDrawPhase.MAP&&this._applyEffects(C,K);var P=this._getOutputFBO();G.bindFramebuffer(P);G.setStencilTestEnabled(!1);G.setStencilWriteMask(0);G.setBlendingEnabled(!0);G.setBlendFunctionSeparate(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA,B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);G.setColorMask(!0,!0,!0,!0);P=h.isNone(H)||N===t.WGLDrawPhase.HIGHLIGHT?"normal":H;const W=this._fbos;W?.blend.colorTexture&&this._blendEffect.draw(C,W.blend.colorTexture,B.TextureSamplingMode.NEAREST,
P,F)}};A.renderLayers=function(C){C.bindFramebuffer(this._prevFBO);const F=this._getOutputFBO();F&&(C.setDepthTestEnabled(!1),C.setStencilWriteMask(0),this._isClippedToWorldExtent?(C.setStencilTestEnabled(!0),C.setStencilFunction(B.CompareFunction.EQUAL,1,255)):C.setStencilTestEnabled(!1),this.blitTexture(C,F.colorTexture,B.TextureSamplingMode.NEAREST))};A.prepareDisplay=function(C,F,G){const {context:H}=C;H.bindFramebuffer(this._prevFBO);H.setColorMask(!0,!0,!0,!0);if(h.isSome(F)){const {r:K,g:J,
b:N,a:P}=F.color;H.setClearColor(P*K/255,P*J/255,P*N/255,P)}else H.setClearColor(0,0,0,0);H.setStencilWriteMask(255);H.setClearStencil(0);H.clear(H.gl.COLOR_BUFFER_BIT|H.gl.STENCIL_BUFFER_BIT);this._isClippedToWorldExtent=this._worldExtentClipRenderer.render(C,G)};A.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this.textureUploadManager.destroy();this._blitRenderer=h.disposeMaybe(this._blitRenderer);this._worldExtentClipRenderer=h.disposeMaybe(this._worldExtentClipRenderer);
this._brushCache&&(this._brushCache.forEach(C=>C.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const C in this._fbos)this._fbos[C]&&this._fbos[C].dispose();for(const C of this._fboPool)C.dispose();this._fboPool.length=0;if(this.effects)for(const C in this.effects)this.effects[C]&&this.effects[C].dispose();this._effectsManager.dispose();this._vtlMaterialManager=h.disposeMaybe(this._vtlMaterialManager);this._prevFBO=null};A.getBrush=function(C,F){C=v(C,F);F=this._brushCache.get(C);
void 0===F&&(F=new C,this._brushCache.set(C,F));return F};A.renderObject=function(C,F,G,H){if(G=D.brushes[G]){var K=this._brushCache.get(G);void 0===K&&(K=new G,this._brushCache.set(G,K));K.prepareState(C,H);K.draw(C,F,H)}};A.renderObjects=function(C,F,G,H){if(G=D.brushes[G]){var K=this._brushCache.get(G);void 0===K&&(K=new G,this._brushCache.set(G,K));K.drawMany(C,F,H)}};A.registerRenderPass=function(C){const F=C.brushes.map(G=>{this._brushCache.has(G)||this._brushCache.set(G,new G);return this._brushCache.get(G)});
return new x(F,C)};A.blitTexture=function(C,F,G,H=1){C.setBlendingEnabled(!0);C.setBlendFunctionSeparate(B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA,B.BlendFactor.ONE,B.BlendFactor.ONE_MINUS_SRC_ALPHA);C.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(C,F,G,H)};A.getPostProcessingEffects=function(C){return this._effectsManager.getPostProcessingEffects(C)};A._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos?.output??null};A._applyEffects=function(C,
F){const G=this._fbos?.blend;if(G){var {context:H}=C;F=this._effectsManager.getPostProcessingEffects(F);for(const {postProcessingEffect:K,effect:J}of F)H.bindFramebuffer(G),K.draw(C,G,J)}};l._createClass(z,[{key:"vectorTilesMaterialManager",get:function(){return this._vtlMaterialManager}}]);return z}()})},"esri/views/2d/engine/brushes":function(){define("exports ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/BrushOverlay ./webgl/brushes/WGLBrushDotDensity ./webgl/brushes/WGLBrushHeatmap ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushPieChart ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q){l.brushes={marker:x,line:n,fill:m,text:q,label:k,clip:D,stencil:f,bitmap:h,overlay:E,tileInfo:p,vtlBackground:d.WGLBrushVTLBackground,vtlFill:a.WGLBrushVTLFill,vtlLine:e.WGLBrushVTLLine,vtlCircle:b.WGLBrushVTLCircle,vtlSymbol:c.WGLBrushVTLSymbol,dotDensity:w,heatmap:t,pieChart:g};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./WGLBrush ../../../../webgl/enums".split(" "),
function(l,h,D,E,w,t){const p={nearest:{defines:[],samplingMode:t.TextureSamplingMode.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:t.TextureSamplingMode.LINEAR,mips:!1},bicubic:{defines:["bicubic"],samplingMode:t.TextureSamplingMode.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:t.TextureSamplingMode.LINEAR_MIPMAP_LINEAR,mips:!0}};return function(g){function f(){var b=d.apply(this,arguments);b._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_pos",0]])};return b}
l._inherits(f,g);var d=l._createSuper(f);g=f.prototype;g.dispose=function(){this._quad&&this._quad.dispose()};g.prepareState=function({context:b}){b.setBlendingEnabled(!0);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0)};g.draw=function(b,a){const {context:e,renderingOptions:c,painter:m,requestRender:k,allowDelayedRender:n}=b;if(a.source&&a.isReady){if("dynamic"===c.samplingMode){({state:q}=b);var x=a.resolution/a.pixelRatio/q.resolution;const v=Math.round(b.pixelRatio)!==
b.pixelRatio;var q=q.rotation||1.05<x||.95>x||v||a.isSourceScaled||a.rotation?p.bilinear:p.nearest}else q=p[c.samplingMode];x=m.materialManager.getProgram(this._desc,q.defines);if(n&&h.isSome(k)&&!x.compiled)k();else{b.timeline.begin(this.name);"additive"===a.blendFunction?e.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE,t.BlendFactor.ONE,t.BlendFactor.ONE):e.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA,t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA);
e.setStencilFunction(t.CompareFunction.EQUAL,a.stencilRef,255);this._quad||(this._quad=new E(e,[0,0,1,0,0,1,1,1]));var {coordScale:B,computedOpacity:y,transforms:u}=a;a.setSamplingProfile(q);a.bind(b.context,D.TEXTURE_BINDING_BITMAP);e.useProgram(x);x.setUniformMatrix3fv("u_dvsMat3",u.dvs);x.setUniform1i("u_texture",D.TEXTURE_BINDING_BITMAP);x.setUniform2fv("u_coordScale",B);x.setUniform1f("u_opacity",y);this._quad.draw();b.timeline.end(this.name)}}};return l._createClass(f)}(w)})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject","../../../webgl/VertexElementDescriptor"],function(l,h,D,E,w){return function(){function t(g,f){this._rctx=g;this._vertexBuffer=h.BufferObject.createVertex(g,D.Usage.STATIC_DRAW,new Uint16Array(f));this._vao=new E.VertexArrayObject(g,new Map([["a_position",0]]),{geometry:[new w.VertexElementDescriptor("a_position",2,D.DataType.SHORT,0,4)]},{geometry:this._vertexBuffer});this._count=f.length/2}var p=t.prototype;
p.bind=function(){this._rctx.bindVAO(this._vao)};p.unbind=function(){this._rctx.bindVAO(null)};p.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};p.draw=function(){this._rctx.bindVAO(this._vao);this._rctx.drawArrays(D.PrimitiveType.TRIANGLE_STRIP,0,this._count)};return l._createClass(t)}()})},"esri/views/webgl/VertexElementDescriptor":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(l,h){h=h._createClass(function(D,E,w,t,p,g=!1,f=0){this.name=D;
this.count=E;this.type=w;this.offset=t;this.stride=p;this.normalized=g;this.divisor=f});l.VertexElementDescriptor=h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function h(){this.name=this.constructor.name||"UnnamedBrush";this.brushEffect=null}var D=h.prototype;D.prepareState=function(E,w){};D.draw=function(E,w,t){};D.drawMany=function(E,
w,t){for(const p of w)p.visible&&this.draw(E,p,t)};return l._createClass(h)}()})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/enums ../../../../webgl/ProgramTemplate".split(" "),function(l,h,D,E,w,t,p,g){return function(f){function d(){var a=b.apply(this,arguments);a._color=D.fromValues(0,1,0,1);return a}l._inherits(d,
f);var b=l._createSuper(d);f=d.prototype;f.dispose=function(){this._program&&this._program.dispose()};f.prepareState=function({context:a}){a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(p.StencilOperation.KEEP,p.StencilOperation.KEEP,p.StencilOperation.REPLACE);a.setStencilWriteMask(255);a.setStencilFunction(p.CompareFunction.ALWAYS,0,255)};f.draw=function(a,e){const {context:c,state:m,requestRender:k,allowDelayedRender:n}=
a;a=E.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:p.DataType.SHORT}]});e=e.getVAO(c,m,a.attributes,a.bufferLayouts);h.isNone(e.indexBuffer)||(this._program||(this._program=g.createProgram(c,t.background)),n&&h.isSome(k)&&!this._program.compiled?k():(c.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",m.displayMat3),c.bindVAO(e),c.drawElements(p.PrimitiveType.TRIANGLES,
e.indexBuffer.size,p.DataType.UNSIGNED_INT,0),c.bindVAO()))};return l._createClass(d)}(w)})},"esri/chunks/vec4f32":function(){define(["exports"],function(l){function h(){return new Float32Array(4)}function D(q){const B=new Float32Array(4);B[0]=q[0];B[1]=q[1];B[2]=q[2];B[3]=q[3];return B}function E(q,B,y,u){const v=new Float32Array(4);v[0]=q;v[1]=B;v[2]=y;v[3]=u;return v}function w(q,B){return new Float32Array(q,B,4)}function t(){return h()}function p(){return E(1,1,1,1)}function g(){return E(1,0,
0,0)}function f(){return E(0,1,0,0)}function d(){return E(0,0,1,0)}function b(){return E(0,0,0,1)}const a=h(),e=p(),c=g(),m=f(),k=d(),n=b(),x=Object.freeze(Object.defineProperty({__proto__:null,ONES:e,UNIT_W:n,UNIT_X:c,UNIT_Y:m,UNIT_Z:k,ZEROS:a,clone:D,create:h,createView:w,fromValues:E,ones:p,unitW:b,unitX:g,unitY:f,unitZ:d,zeros:t},Symbol.toStringTag,{value:"Module"}));l.ONES=e;l.UNIT_W=n;l.UNIT_X=c;l.UNIT_Y=m;l.UNIT_Z=k;l.ZEROS=a;l.clone=D;l.create=h;l.createView=w;l.fromValues=E;l.ones=p;l.unitW=
b;l.unitX=g;l.unitY=f;l.unitZ=d;l.vec4f32=x;l.zeros=t})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Error ../../../../core/Logger ../../../../symbols/cim/enums ./enums ../../../webgl/enums ../../../webgl/VertexElementDescriptor".split(" "),function(l,h,D,E,w,t,p){function g(J){const N={};for(const P of J)N[P.name]=P.strideInBytes;return N}function f(J){switch(J){case w.WGLGeometryType.MARKER:return u;case w.WGLGeometryType.FILL:return v;case w.WGLGeometryType.LINE:return r;
case w.WGLGeometryType.TEXT:return z;case w.WGLGeometryType.LABEL:return A}}function d(J){switch(J%4){case 0:case 2:return 4;case 1:case 3:return 1}}function b(J){switch(J){case t.DataType.BYTE:case t.DataType.UNSIGNED_BYTE:return 1;case t.DataType.SHORT:case t.DataType.UNSIGNED_SHORT:return 2;case t.DataType.FLOAT:case t.DataType.INT:case t.DataType.UNSIGNED_INT:return 4}}function a(J){const N={};for(const P in J){let W=0;N[P]=J[P].map(X=>{const aa=new p.VertexElementDescriptor(X.name,X.count,X.type,
W,0,X.normalized||!1);W+=X.count*b(X.type);return aa});N[P]?.forEach(X=>X.stride=W)}return N}const e=D.getLogger("esri.views.2d.engine.webgl.Utils"),c=g([{name:"geometry",strideInBytes:36}]),m=g([{name:"geometry",strideInBytes:12}]),k=g([{name:"geometry",strideInBytes:36}]),n=g([{name:"geometry",strideInBytes:24}]),x=g([{name:"geometry",strideInBytes:12}]),q=g([{name:"geometry",strideInBytes:40}]),B=g([{name:"geometry",strideInBytes:36}]),y=g([{name:"geometry",strideInBytes:36}]),u=["geometry"],v=
["geometry"],r=["geometry"],z=["geometry"],A=["geometry"];D={geometry:t.Usage.STATIC_DRAW};const C=new Map,F=J=>null!=J&&J.startsWith("data:image/gif"),G=J=>null!=J&&J.startsWith("data:image/png"),H=J=>{if(!J)return!1;J=J.trim();return/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(J)&&/[\dz]$/i.test(J)&&4<J.length?!0:!1},K=J=>"fill"===J.type&&"CIMMarkerPlacementInsidePolygon"===J?.cim?.markerPlacement?.type;l.C_VBO_INFO=D;l.allocateTypedArrayBuffer=function(J,N){switch(N%4){case 0:case 2:return new Uint32Array(Math.floor(J*
N/4));case 1:case 3:return new Uint8Array(J*N)}};l.allocateTypedArrayBufferwithData=function(J,N){switch(N%4){case 0:case 2:return new Uint32Array(J);case 1:case 3:return new Uint8Array(J)}};l.charCodes=function(J){const N=[];for(let P=0;P<J.length;P++)N.push(J.charCodeAt(P));return N};l.copyMeshData=function(J,N,P,W,X,aa,Z){for(const I in aa){var ea=aa[I].stride,T=d(ea);const M=aa[I].data,S=P[I].data;if(null==M||null==S)continue;const V=ea*X.vertexCount/T,Q=ea*J/T;ea=ea*X.vertexFrom/T;for(T=0;T<
V;++T)S[T+Q]=M[T+ea]}if(null!=Z&&null!=W)for(P=X.indexCount,aa=0;aa<P;++aa)W[aa+N]=Z[aa+X.indexFrom]-X.vertexFrom+J};l.createGeometryData=function(J,N){const P=[];for(let W=0;5>W;++W){const X=f(W),aa={};for(const Z of X)aa[Z]={data:N(W,Z)};P.push({data:J(W),buffers:aa})}return P};l.createProgramDescriptor=(J,N)=>{if(!C.has(J)){const X=a(N);var P=X;var W={};for(const aa in P){const Z=P[aa];W[aa]=Z?.length?Z[0].stride:0}P=W;W=new Map;for(const aa in N)for(const Z of N[aa])W.set(Z.name,Z.location);C.set(J,
{strides:P,bufferLayouts:X,attributes:W})}return C.get(J)};l.forEachGeometryType=function(J){J(w.WGLGeometryType.FILL);J(w.WGLGeometryType.LINE);J(w.WGLGeometryType.MARKER);J(w.WGLGeometryType.TEXT);J(w.WGLGeometryType.LABEL)};l.getBytes=b;l.getCapType=function(J){switch(J){case "butt":return E.CapType.BUTT;case "round":return E.CapType.ROUND;case "square":return E.CapType.SQUARE;default:return e.error(new h("mapview-invalid-type",`Cap type ${J} is not a valid option. Defaulting to round`)),E.CapType.ROUND}};
l.getJoinType=function(J){switch(J){case "miter":return E.JoinType.MITER;case "bevel":return E.JoinType.BEVEL;case "round":return E.JoinType.ROUND;default:return e.error(new h("mapview-invalid-type",`Join type ${J} is not a valid option. Defaulting to round`)),E.JoinType.ROUND}};l.getNamedBuffers=f;l.getPMSResourceSize=function(J){const N="width"in J&&J.width||"size"in J&&J.size||0;return"maxVVSize"in J&&J.maxVVSize||N};l.getPixelArrayCtor=function(J){switch(J){case t.PixelType.UNSIGNED_BYTE:return Uint8Array;
case t.PixelType.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case t.PixelType.FLOAT:return Float32Array;default:e.error(new h("webgl-utils",`Unable to handle type ${J}`))}};l.getPixelBytes=function(J){switch(J){case t.PixelType.UNSIGNED_BYTE:return 1;case t.PixelType.UNSIGNED_SHORT_4_4_4_4:return 2;case t.PixelType.FLOAT:return 4;default:e.error(new h("webgl-utils",`Unable to handle type ${J}`))}};l.getStrides=function(J,N){switch(J){case w.WGLGeometryType.MARKER:switch(N){case w.WGLSymbologyType.HEATMAP:return m;
default:return c}case w.WGLGeometryType.FILL:switch(N){case w.WGLSymbologyType.DOT_DENSITY:return x;case w.WGLSymbologyType.SIMPLE:case w.WGLSymbologyType.OUTLINE_FILL_SIMPLE:return n;default:return k}case w.WGLGeometryType.LINE:return q;case w.WGLGeometryType.TEXT:return B;case w.WGLGeometryType.LABEL:return y}};l.getUrl=J=>"imageData"in J&&J.imageData&&"contentType"in J&&J.contentType?`data:${J.contentType};base64,${J.imageData}`:"url"in J?J.url:null;l.getVVType=function(J){switch(J){case "opacity":return w.VVType.OPACITY;
case "color":return w.VVType.COLOR;case "rotation":return w.VVType.ROTATION;case "size":return w.VVType.SIZE;default:return e.error(`Cannot interpret unknown vv: ${J}`),null}};l.is3D=J=>J.type&&J.type.toLowerCase().includes("3d");l.isDefined=function(J){return null!=J};l.isGIF=J=>"url"in J&&J.url&&(J.url.includes(".gif")||F(J.url))||"contentType"in J&&"image/gif"===J.contentType||"imageData"in J&&F(J.imageData);l.isGIFDataUri=F;l.isImageResource=J=>"url"in J&&J.url||"imageData"in J&&J.imageData;l.isMarkerPlacementInsidePolygon=
K;l.isNumber=function(J){return"number"===typeof J};l.isPNG=J=>"url"in J&&J.url&&(J.url.includes(".png")||G(J.url))||"contentType"in J&&"image/png"===J.contentType||"imageData"in J&&G(J.imageData);l.isPNGDataUri=G;l.isSVGImage=J=>J.includes("data:image/svg+xml");l.isSVGResource=J=>"path"in J&&H(J.path);l.isSimple=function(J){switch(J.type){case "line":return"CIMSolidStroke"===J.cim.type&&!J.dashTemplate;case "fill":return"CIMSolidFill"===J.cim.type;case "esriSFS":return"esriSFSSolid"===J.style||"esriSFSNull"===
J.style;case "esriSLS":return"esriSLSSolid"===J.style||"esriSLSNull"===J.style;default:return!1}};l.isValidSVG=H;l.shouldRepeat=function(J){switch("cim"in J?J.cim.type:J.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":return!1;case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":return K(J);default:return!0}};l.strideToPackingFactor=d;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/enums":function(){define(["exports"],function(l){l.CapType=
void 0;(function(h){h[h.BUTT=0]="BUTT";h[h.ROUND=1]="ROUND";h[h.SQUARE=2]="SQUARE";h[h.UNKNOWN=4]="UNKNOWN"})(l.CapType||(l.CapType={}));l.JoinType=void 0;(function(h){h[h.BEVEL=0]="BEVEL";h[h.ROUND=1]="ROUND";h[h.MITER=2]="MITER";h[h.UNKNOWN=4]="UNKNOWN"})(l.JoinType||(l.JoinType={}));l.Alignment=void 0;(function(h){h[h.SCREEN=0]="SCREEN";h[h.MAP=1]="MAP"})(l.Alignment||(l.Alignment={}));l.ExternalColorMixMode=void 0;(function(h){h[h.Tint=0]="Tint";h[h.Ignore=1]="Ignore";h[h.Multiply=99]="Multiply"})(l.ExternalColorMixMode||
(l.ExternalColorMixMode={}));l.ExtremityPlacement=void 0;(function(h){h.Both="Both";h.JustBegin="JustBegin";h.JustEnd="JustEnd";h.None="None"})(l.ExtremityPlacement||(l.ExtremityPlacement={}));l.FillMode=void 0;(function(h){h[h.Mosaic=0]="Mosaic";h[h.Centered=1]="Centered"})(l.FillMode||(l.FillMode={}));l.FontEffects=void 0;(function(h){h[h.Normal=0]="Normal";h[h.Superscript=1]="Superscript";h[h.Subscript=2]="Subscript"})(l.FontEffects||(l.FontEffects={}));l.FontEncoding=void 0;(function(h){h[h.MSSymbol=
0]="MSSymbol";h[h.Unicode=1]="Unicode"})(l.FontEncoding||(l.FontEncoding={}));l.FontType=void 0;(function(h){h[h.Unspecified=0]="Unspecified";h[h.TrueType=1]="TrueType";h[h.PSOpenType=2]="PSOpenType";h[h.TTOpenType=3]="TTOpenType";h[h.Type1=4]="Type1"})(l.FontType||(l.FontType={}));l.AngleAlignment=void 0;(function(h){h[h.Display=0]="Display";h[h.Map=1]="Map"})(l.AngleAlignment||(l.AngleAlignment={}));l.AnimatedSymbolRepeatType=void 0;(function(h){h.None="None";h.Loop="Loop";h.Oscillate="Oscillate"})(l.AnimatedSymbolRepeatType||
(l.AnimatedSymbolRepeatType={}));l.DominantSizeAxis=void 0;(function(h){h[h.Z=0]="Z";h[h.X=1]="X";h[h.Y=2]="Y"})(l.DominantSizeAxis||(l.DominantSizeAxis={}));l.RotationOrder=void 0;(function(h){h[h.XYZ=0]="XYZ";h[h.ZXY=1]="ZXY";h[h.YXZ=2]="YXZ"})(l.RotationOrder||(l.RotationOrder={}));l.BalloonCalloutStyle=void 0;(function(h){h[h.Rectangle=0]="Rectangle";h[h.RoundedRectangle=1]="RoundedRectangle";h[h.Oval=2]="Oval"})(l.BalloonCalloutStyle||(l.BalloonCalloutStyle={}));l.BlendingMode=void 0;(function(h){h[h.None=
0]="None";h[h.Alpha=1]="Alpha";h[h.Screen=2]="Screen";h[h.Multiply=3]="Multiply";h[h.Add=4]="Add"})(l.BlendingMode||(l.BlendingMode={}));l.BlockProgression=void 0;(function(h){h[h.TTB=0]="TTB";h[h.RTL=1]="RTL";h[h.BTT=2]="BTT"})(l.BlockProgression||(l.BlockProgression={}));l.BillBoardMode=void 0;(function(h){h[h.None=0]="None";h[h.SignPost=1]="SignPost";h[h.FaceNearPlane=2]="FaceNearPlane"})(l.BillBoardMode||(l.BillBoardMode={}));l.CGAAttributeType=void 0;(function(h){h[h.Float=0]="Float";h[h.String=
1]="String";h[h.Boolean=2]="Boolean"})(l.CGAAttributeType||(l.CGAAttributeType={}));l.ClippingType=void 0;(function(h){h[h.Intersect=0]="Intersect";h[h.Subtract=1]="Subtract"})(l.ClippingType||(l.ClippingType={}));l.GeometricEffectArrowType=void 0;(function(h){h.OpenEnded="OpenEnded";h.Block="Block";h.Crossed="Crossed"})(l.GeometricEffectArrowType||(l.GeometricEffectArrowType={}));l.GeometricEffectControlMeasureLineRule=void 0;(function(h){h.FullGeometry="FullGeometry";h.PerpendicularFromFirstSegment=
"PerpendicularFromFirstSegment";h.ReversedFirstSegment="ReversedFirstSegment";h.PerpendicularToSecondSegment="PerpendicularToSecondSegment";h.SecondSegmentWithTicks="SecondSegmentWithTicks";h.DoublePerpendicular="DoublePerpendicular";h.OppositeToFirstSegment="OppositeToFirstSegment";h.TriplePerpendicular="TriplePerpendicular";h.HalfCircleFirstSegment="HalfCircleFirstSegment";h.HalfCircleSecondSegment="HalfCircleSecondSegment";h.HalfCircleExtended="HalfCircleExtended";h.OpenCircle="OpenCircle";h.CoverageEdgesWithTicks=
"CoverageEdgesWithTicks";h.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks";h.GapExtentMidline="GapExtentMidline";h.Chevron="Chevron";h.PerpendicularWithArc="PerpendicularWithArc";h.ClosedHalfCircle="ClosedHalfCircle";h.TripleParallelExtended="TripleParallelExtended";h.ParallelWithTicks="ParallelWithTicks";h.Parallel="Parallel";h.PerpendicularToFirstSegment="PerpendicularToFirstSegment";h.ParallelOffset="ParallelOffset";h.OffsetOpposite="OffsetOpposite";h.OffsetSame="OffsetSame";h.CircleWithArc=
"CircleWithArc";h.DoubleJog="DoubleJog";h.PerpendicularOffset="PerpendicularOffset";h.LineExcludingLastSegment="LineExcludingLastSegment";h.MultivertexArrow="MultivertexArrow";h.CrossedArrow="CrossedArrow";h.ChevronArrow="ChevronArrow";h.ChevronArrowOffset="ChevronArrowOffset";h.PartialFirstSegment="PartialFirstSegment";h.Arch="Arch";h.CurvedParallelTicks="CurvedParallelTicks";h.Arc90Degrees="Arc90Degrees"})(l.GeometricEffectControlMeasureLineRule||(l.GeometricEffectControlMeasureLineRule={}));l.GeometricEffectDonutMethod=
void 0;(function(h){h.Mitered="Mitered";h.Bevelled="Bevelled";h.Rounded="Rounded";h.Square="Square";h.TrueBuffer="TrueBuffer"})(l.GeometricEffectDonutMethod||(l.GeometricEffectDonutMethod={}));l.GeometricEffectEnclosingPolygonMethod=void 0;(function(h){h.ClosePath="ClosePath";h.ConvexHull="ConvexHull";h.RectangularBox="RectangularBox"})(l.GeometricEffectEnclosingPolygonMethod||(l.GeometricEffectEnclosingPolygonMethod={}));l.GeometricEffectExtensionOrigin=void 0;(function(h){h.BeginningOfLine="BeginningOfLine";
h.EndOfLine="EndOfLine"})(l.GeometricEffectExtensionOrigin||(l.GeometricEffectExtensionOrigin={}));l.GeometricEffectOffsetMethod=void 0;(function(h){h.Mitered="Mitered";h.Bevelled="Bevelled";h.Rounded="Rounded";h.Square="Square"})(l.GeometricEffectOffsetMethod||(l.GeometricEffectOffsetMethod={}));l.GeometricEffectOffsetOption=void 0;(function(h){h.Fast="Fast";h.Accurate="Accurate"})(l.GeometricEffectOffsetOption||(l.GeometricEffectOffsetOption={}));l.GeometricEffectOffsetTangentMethod=void 0;(function(h){h.BeginningOfLine=
"BeginningOfLine";h.EndOfLine="EndOfLine"})(l.GeometricEffectOffsetTangentMethod||(l.GeometricEffectOffsetTangentMethod={}));l.GeometricEffectWaveform=void 0;(function(h){h.Sinus="Sinus";h.Square="Square";h.Triangle="Triangle";h.Random="Random"})(l.GeometricEffectWaveform||(l.GeometricEffectWaveform={}));l.GlyphHinting=void 0;(function(h){h[h.None=0]="None";h[h.Default=1]="Default";h[h.Force=2]="Force"})(l.GlyphHinting||(l.GlyphHinting={}));l.GradientAlignment=void 0;(function(h){h[h.Buffered=0]=
"Buffered";h[h.Left=1]="Left";h[h.Right=2]="Right";h[h.AlongLine=3]="AlongLine"})(l.GradientAlignment||(l.GradientAlignment={}));l.GradientFillMethod=void 0;(function(h){h[h.Linear=0]="Linear";h[h.Rectangular=1]="Rectangular";h[h.Circular=2]="Circular";h[h.Buffered=3]="Buffered"})(l.GradientFillMethod||(l.GradientFillMethod={}));l.GradientStrokeType=void 0;(function(h){h[h.Discrete=0]="Discrete";h[h.Continuous=1]="Continuous"})(l.GradientStrokeType||(l.GradientStrokeType={}));l.GradientStrokeMethod=
void 0;(function(h){h[h.AcrossLine=0]="AcrossLine";h[h.AloneLine=1]="AloneLine"})(l.GradientStrokeMethod||(l.GradientStrokeMethod={}));l.HorizontalAlignment=void 0;(function(h){h[h.Left=0]="Left";h[h.Right=1]="Right";h[h.Center=2]="Center";h[h.Justify=3]="Justify"})(l.HorizontalAlignment||(l.HorizontalAlignment={}));l.LeaderLineStyle=void 0;(function(h){h[h.Base=0]="Base";h[h.MidPoint=1]="MidPoint";h[h.ThreePoint=2]="ThreePoint";h[h.FourPoint=3]="FourPoint";h[h.Underline=4]="Underline";h[h.CircularCW=
5]="CircularCW";h[h.CircularCCW=6]="CircularCCW"})(l.LeaderLineStyle||(l.LeaderLineStyle={}));l.LineCapStyle=void 0;(function(h){h.Butt="Butt";h.Round="Round";h.Square="Square"})(l.LineCapStyle||(l.LineCapStyle={}));l.LineDashEnding=void 0;(function(h){h.NoConstraint="NoConstraint";h.HalfPattern="HalfPattern";h.HalfGap="HalfGap";h.FullPattern="FullPattern";h.FullGap="FullGap";h.Custom="Custom"})(l.LineDashEnding||(l.LineDashEnding={}));l.LineDecorationStyle=void 0;(function(h){h[h.None=-1]="None";
h[h.Custom=0]="Custom";h[h.Circle=1]="Circle";h[h.OpenArrow=2]="OpenArrow";h[h.ClosedArrow=3]="ClosedArrow";h[h.Diamond=4]="Diamond"})(l.LineDecorationStyle||(l.LineDecorationStyle={}));l.LineGapType=void 0;(function(h){h[h.ExtraLeading=0]="ExtraLeading";h[h.Multiple=1]="Multiple";h[h.Exact=2]="Exact"})(l.LineGapType||(l.LineGapType={}));l.LineJoinStyle=void 0;(function(h){h.Bevel="Bevel";h.Round="Round";h.Miter="Miter"})(l.LineJoinStyle||(l.LineJoinStyle={}));l.ExpressionReturnType=void 0;(function(h){h[h.Default=
0]="Default";h[h.String=1]="String";h[h.Numeric=2]="Numeric"})(l.ExpressionReturnType||(l.ExpressionReturnType={}));l.MarkerPlacementType=void 0;(function(h){h[h.InsidePolygon=0]="InsidePolygon";h[h.PolygonCenter=1]="PolygonCenter";h[h.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"})(l.MarkerPlacementType||(l.MarkerPlacementType={}));l.MaterialMode=void 0;(function(h){h[h.Tint=0]="Tint";h[h.Replace=1]="Replace";h[h.Multiply=2]="Multiply"})(l.MaterialMode||(l.MaterialMode={}));l.PlacementClip=void 0;
(function(h){h[h.ClipAtBoundary=0]="ClipAtBoundary";h[h.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary";h[h.DoNotTouchBoundary=2]="DoNotTouchBoundary";h[h.DoNotClip=3]="DoNotClip"})(l.PlacementClip||(l.PlacementClip={}));l.PlacementEndings=void 0;(function(h){h.NoConstraint="NoConstraint";h.WithMarkers="WithMarkers";h.WithFullGap="WithFullGap";h.WithHalfGap="WithHalfGap";h.Custom="Custom"})(l.PlacementEndings||(l.PlacementEndings={}));l.PlacementGridType=void 0;(function(h){h.Fixed=
"Fixed";h.Random="Random";h.RandomFixedQuantity="RandomFixedQuantity"})(l.PlacementGridType||(l.PlacementGridType={}));l.PlacementOnLineRelativeTo=void 0;(function(h){h.LineMiddle="LineMiddle";h.LineBeginning="LineBeginning";h.LineEnd="LineEnd";h.SegmentMidpoint="SegmentMidpoint"})(l.PlacementOnLineRelativeTo||(l.PlacementOnLineRelativeTo={}));l.PlacementPolygonCenterMethod=void 0;(function(h){h.OnPolygon="OnPolygon";h.CenterOfMass="CenterOfMass";h.BoundingBoxCenter="BoundingBoxCenter"})(l.PlacementPolygonCenterMethod||
(l.PlacementPolygonCenterMethod={}));l.PlacementRandomlyAlongLineRandomization=void 0;(function(h){h[h.Low=0]="Low";h[h.Medium=1]="Medium";h[h.High=2]="High"})(l.PlacementRandomlyAlongLineRandomization||(l.PlacementRandomlyAlongLineRandomization={}));l.PlacementStepPosition=void 0;(function(h){h[h.MarkerCenter=0]="MarkerCenter";h[h.MarkerBounds=1]="MarkerBounds"})(l.PlacementStepPosition||(l.PlacementStepPosition={}));l.PointSymbolCalloutScale=void 0;(function(h){h[h.None=0]="None";h[h.PropUniform=
1]="PropUniform";h[h.PropNonuniform=2]="PropNonuniform";h[h.DifUniform=3]="DifUniform";h[h.DifNonuniform=4]="DifNonuniform"})(l.PointSymbolCalloutScale||(l.PointSymbolCalloutScale={}));l.Simple3DLineStyle=void 0;(function(h){h.Tube="Tube";h.Strip="Strip";h.Wall="Wall"})(l.Simple3DLineStyle||(l.Simple3DLineStyle={}));l.SizeVariationMethod=void 0;(function(h){h[h.Random=0]="Random";h[h.Increasing=1]="Increasing";h[h.Decreasing=2]="Decreasing";h[h.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"})(l.SizeVariationMethod||
(l.SizeVariationMethod={}));l.SymbolUnits=void 0;(function(h){h[h.Relative=0]="Relative";h[h.Absolute=1]="Absolute"})(l.SymbolUnits||(l.SymbolUnits={}));l.TextCase=void 0;(function(h){h[h.Normal=0]="Normal";h[h.LowerCase=1]="LowerCase";h[h.Allcaps=2]="Allcaps"})(l.TextCase||(l.TextCase={}));l.TextReadingDirection=void 0;(function(h){h[h.LTR=0]="LTR";h[h.RTL=1]="RTL"})(l.TextReadingDirection||(l.TextReadingDirection={}));l.TextureFilter=void 0;(function(h){h.Draft="Draft";h.Picture="Picture";h.Text=
"Text"})(l.TextureFilter||(l.TextureFilter={}));l.VerticalAlignment=void 0;(function(h){h[h.Top=0]="Top";h[h.Center=1]="Center";h[h.Baseline=2]="Baseline";h[h.Bottom=3]="Bottom"})(l.VerticalAlignment||(l.VerticalAlignment={}));l.VerticalGlyphOrientation=void 0;(function(h){h[h.Right=0]="Right";h[h.Upright=1]="Upright"})(l.VerticalGlyphOrientation||(l.VerticalGlyphOrientation={}));l.WaterbodySize=void 0;(function(h){h[h.Small=0]="Small";h[h.Medium=1]="Medium";h[h.Large=2]="Large"})(l.WaterbodySize||
(l.WaterbodySize={}));l.WaveStrength=void 0;(function(h){h[h.Calm=0]="Calm";h[h.Rippled=1]="Rippled";h[h.Slight=2]="Slight";h[h.Moderate=3]="Moderate"})(l.WaveStrength||(l.WaveStrength={}));Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports","./sources/resolver"],function(l,h){h={shaders:{vertexShader:h.resolveIncludes("background/background.vert"),fragmentShader:h.resolveIncludes("background/background.frag")},
attributes:new Map([["a_pos",0]])};l.background=h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(l,h,D){const E=new D.ShaderCompiler(function(w){let t=h;w.split("/").forEach(p=>{t&&(t=t[p])});return t});l.resolveIncludes=function(w){return E.resolveIncludes(w)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor \x3d u_color;\n}",
"background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color \x3d texture2D(u_tex, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_pos, 0.0, 1.0);\nv_uv \x3d a_tex;\n}"},
blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn \x3d rgb2v(Cb);\nvec3 hsvTint \x3d rgb2hsv(Cs);\nvec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs \x3c\x3d 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb \x3c\x3d 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum \x3d lumv3(color);\nfloat mincol \x3d minv3(color);\nfloat maxcol \x3d maxv3(color);\nif (mincol \x3c 0.0) {\ncolor \x3d lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol \x3e 1.0) {\ncolor \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase \x3d lumv3(cbase);\nfloat llum \x3d lumv3(clum);\nfloat ldiff \x3d llum - lbase;\nvec3 color \x3d cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase \x3d minv3(cbase);\nfloat sbase \x3d satv3(cbase);\nfloat ssat \x3d satv3(csat);\nvec3 color;\nif (sbase \x3e 0.0) {\ncolor \x3d (cbase - minbase) * ssat / sbase;\n} else {\ncolor \x3d vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor \x3d src *  u_opacity;\n#else\nvec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\nvec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as \x3d u_opacity * src.a;\nfloat ab \x3d dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color \x3d vec4(as * Cs * ab, as * ab);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color \x3d vec4(ab * Cb * as, ab * as);\nvec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor \x3d color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f \x3d clamp(vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f \x3d vec3(clamp(vividLight(Cb.r, Cs.r), 0.0, 1.0),\nclamp(vividLight(Cb.g, Cs.g), 0.0, 1.0),\nclamp(vividLight(Cb.b, Cs.b), 0.0, 1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f \x3d setLumSat(Cs,Cb,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f \x3d setLumSat(Cb,Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f \x3d setLum(Cs,Cb);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f \x3d setLum(Cb,Cs);\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f \x3d (Cb + Cs) / 2.0;\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f \x3d clamp(vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position \x3d vec4(a_position , 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"},debug:{overlay:{"overlay.frag":"precision mediump float;\nvarying vec4 v_color;\nvoid main(void) {\ngl_FragColor \x3d v_color;\n}","overlay.vert":"attribute vec3 a_PositionAndFlags;\nuniform mat3 u_dvsMat3;\nuniform vec4 u_colors[4];\nuniform float u_opacities[4];\nvarying vec4 v_color;\nvoid main(void) {\nvec2 position \x3d a_PositionAndFlags.xy;\nfloat flags \x3d a_PositionAndFlags.z;\nint colorIndex \x3d int(mod(flags, 4.0));\nvec4 color;\nfor (int i \x3d 0; i \x3c 4; i++) {\ncolor \x3d u_colors[i];\nif (i \x3d\x3d colorIndex) {\nbreak;\n}\n}\nint opacityIndex \x3d int(mod(floor(flags / 4.0), 4.0));\nfloat opacity;\nfor (int i \x3d 0; i \x3c 4; i++) {\nopacity \x3d u_opacities[i];\nif (i \x3d\x3d opacityIndex) {\nbreak;\n}\n}\nv_color \x3d color * opacity;\ngl_Position \x3d vec4((u_dvsMat3 * vec3(position, 1.0)).xy, 0.0, 1.0);\n}"}},
dot:{dot:{"dot.frag":"precision mediump float;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nuniform highp float u_tileZoomFactor;\nvoid main()\n{\nfloat dist \x3d length(gl_PointCoord - vec2(.5, .5)) * 2.;\nfloat alpha \x3d smoothstep(0., 1., v_invEdgeRatio * (dist - v_dotRatio) + 1.);\ngl_FragColor \x3d v_color * alpha;\n}","dot.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform sampler2D u_texture;\nuniform highp mat3 u_dvsMat3;\nuniform highp float u_tileZoomFactor;\nuniform highp float u_dotSize;\nuniform highp float u_pixelRatio;\nvarying vec2 v_pos;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nconst float EPSILON \x3d 0.000001;\nvoid main()\n{\nmat3 tileToTileTexture \x3d mat3(  1., 0., 0.,\n0., -1., 0.,\n0., 1., 1.  );\nvec3 texCoords \x3d tileToTileTexture * vec3(a_pos.xy / 512., 1.);\nv_color \x3d texture2D(u_texture, texCoords.xy);\nfloat smoothEdgeWidth \x3d max(u_dotSize / 2., 1.) ;\nfloat z \x3d 0.;\nz +\x3d 2.0 * step(v_color.a, EPSILON);\ngl_PointSize \x3d (smoothEdgeWidth + u_dotSize);\ngl_Position \x3d vec4((u_dvsMat3 * vec3(a_pos + .5, 1.)).xy, z, 1.);\nv_dotRatio \x3d u_dotSize / gl_PointSize;\nv_invEdgeRatio \x3d -1. / ( smoothEdgeWidth / gl_PointSize );\ngl_PointSize  *\x3d (u_pixelRatio * u_tileZoomFactor);\n}"}},
filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b \x3d 1.0 / 6.0;\nfloat v2 \x3d v * v;\nfloat v3 \x3d v2 * v;\nfloat w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 \x3d b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w \x3d computeWeights(v);\nfloat g0 \x3d w.x + w.y;\nfloat g1 \x3d w.z + w.w;\nfloat h0 \x3d 1.0 - (w.y / g0) + v;\nfloat h1 \x3d 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\nvec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\nvec2 texel \x3d coords * texSize - 0.5;\nvec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 \x3d coords + hgX.x * eX;\nvec2 coords00 \x3d coords - hgX.y * eX;\nvec2 coords11 \x3d coords10 + hgY.x * eY;\nvec2 coords01 \x3d coords00 + hgY.x * eY;\ncoords10 \x3d coords10 - hgY.y * eY;\ncoords00 \x3d coords00 - hgY.y * eY;\nvec4 color00 \x3d texture2D(sampler, coords00);\nvec4 color10 \x3d texture2D(sampler, coords10);\nvec4 color01 \x3d texture2D(sampler, coords01);\nvec4 color11 \x3d texture2D(sampler, coords11);\ncolor00 \x3d mix(color00, color01, hgY.z);\ncolor10 \x3d mix(color10, color11, hgY.z);\ncolor00 \x3d mix(color00, color10, hgX.z);\nreturn color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart \x3d floor(coords * texSize);\nvec2 coord0 \x3d texelStart / texSize;\nvec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 \x3d texture2D(sampler, coord0);\nvec4 color1 \x3d texture2D(sampler, coord1);\nvec4 color2 \x3d texture2D(sampler, coord2);\nvec4 color3 \x3d texture2D(sampler, coord3);\nvec2 blend \x3d fract(coords * texSize);\nvec4 color01 \x3d mix(color0, color1, blend.x);\nvec4 color23 \x3d mix(color2, color3, blend.x);\nvec4 color \x3d mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha \x3d floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor \x3d color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize \x3d 1.0 / texSize;\nvec2 texel \x3d coords * texSize;\nvec2 texel_i \x3d floor(texel);\nvec2 texel_frac \x3d fract(texel);\nvec4 colorP \x3d texture2D(sampler, texel_i * invSize);\nvec4 colorP1 \x3d vec4(colorP);\nvec4 colorP2 \x3d vec4(colorP);\nvec4 colorP3 \x3d vec4(colorP);\nvec4 colorP4 \x3d vec4(colorP);\nvec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\ncolorP1 \x3d colorA;\n}\nif (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\ncolorP2 \x3d colorB;\n}\nif (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\ncolorP3 \x3d colorC;\n}\nif (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\ncolorP4 \x3d colorD;\n}\nvec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\nfloat flags \x3d data0.r * 255.0;\nfloat groupMinZoom \x3d data0.g * 255.0;\nfloat isVisible \x3d getFilterBit(flags, 0);\nfloat wouldClip \x3d step(groupMinZoom, u_zoomLevel);\nfloat direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState \x3d vec4(texel + direction * dt);\ngl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},heatmap:{heatmapResolve:{"heatmapResolve.frag":"precision highp float;\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 4.0\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform sampler2D u_texture;\nuniform sampler2D u_gradient;\nuniform vec2 u_densityMinAndInvRange;\nuniform float u_densityNormalization;\nvarying vec2 v_uv;\nvoid main() {\nvec4 data \x3d texture2D(u_texture, v_uv);\nfloat density \x3d data.r * COMPRESSION_FACTOR;\ndensity *\x3d u_densityNormalization;\ndensity \x3d (density - u_densityMinAndInvRange.x) * u_densityMinAndInvRange.y;\nvec4 color \x3d texture2D(u_gradient, vec2(density, 0.5));\ngl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}",
"heatmapResolve.vert":"precision highp float;\nattribute vec2 a_pos;\nvarying vec2 v_uv;\nvoid main() {\nv_uv \x3d a_pos;\ngl_Position \x3d vec4(a_pos * 2.0 - 1.0, 1., 1.);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w \x3d gauss1(i * u_direction.xy);\ntot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight +\x3d w;\n}\nvoid main(void) {\nmediump float tot \x3d 0.0;\nmediump float weight \x3d 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y \x3d texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 \x3d 0.5;\nmediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d \x3d (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d \x3d estimateDistance();\ngl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn \x3d uv * 2.0 - 1.0;\nif (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta \x3d atan(uvn.y, uvn.x);\nlowp float r \x3d pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor \x3d (color + (1.0 - color.a) * u_background);\nlowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *\x3d mask;\nlowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord \x3d a_pos;\ngl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp sampler2D u_attributeData4;\nuniform highp sampler2D u_attributeData5;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel \x3d unpackDisplayIdTexel(id);\nhighp float size \x3d float(u_attributeTextureSize);\nhighp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col \x3d mod(u32, size);\nhighp float row \x3d (u32 - col) / size;\nhighp float u \x3d col / size;\nhighp float v \x3d row / size;\nreturn vec2(u, v);\n}\nhighp vec2 getAttributeDataTextureCoords(in highp vec3 id) {\nreturn (getAttributeDataCoords(id) * 2.0) - 1.0 + (.5 / vec2(u_attributeTextureSize));\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nhighp vec4 getAttributeData4(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData4, coords);\n}\nhighp vec4 getAttributeData5(in highp vec3 id) {\nhighp vec2 coords \x3d getAttributeDataCoords(id);\nreturn texture2D(u_attributeData5, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}",
"barycentric.glsl":"float inTriangle(vec3 bary) {\nvec3 absBary \x3d abs(bary);\nreturn step((absBary.x + absBary.y + absBary.z), 1.05);\n}\nvec3 xyToBarycentric(in vec2 pos, in vec2 v0,  in vec2 v1, in vec2 v2) {\nmat3 xyToBarycentricMat3 \x3d mat3(\nv1.x * v2.y - v2.x * v1.y, v2.x * v0.y - v0.x * v2.y, v0.x * v1.y - v1.x * v0.y,\nv1.y - v2.y, v2.y - v0.y, v0.y - v1.y,\nv2.x - v1.x, v0.x - v2.x, v1.x - v0.x\n);\nfloat A2 \x3d v0.x * (v1.y - v2.y) + v1.x * (v2.y - v0.y) + v2.x * (v0.y - v1.y);\nreturn (1. / A2) * xyToBarycentricMat3 * vec3(1., pos);\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_RAD_TO_DEG \x3d 180.0 / 3.141592654;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.00001;\nconst float EPSILON_HITTEST \x3d 0.05;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR \x3d 1;\nconst int BITSET_GENERIC_CONSIDER_ALPHA_ONLY \x3d 4;\nconst int BITSET_MARKER_ALIGNMENT_MAP \x3d 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE \x3d 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY \x3d 3;\nconst int BITSET_TYPE_FILL_OUTLINE \x3d 0;\nconst int BITSET_FILL_RANDOM_PATTERN_OFFSET \x3d 2;\nconst int BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR \x3d 3;\nconst int BITSET_LINE_SCALE_DASH \x3d 2;",
fill:{"common.glsl":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvarying lowp float v_isOutline;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\nlowp vec4 drawLine() {\nfloat v_lineWidth \x3d v_aux1.x;\nvec2  v_normal    \x3d v_aux1.yz;\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color \x3d vec4(0.);\n#ifdef HITTEST\nout_color \x3d v_color;\n#elif defined(PATTERN)\nmediump vec4 v_tlbr \x3d v_aux1;\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\nout_color \x3d v_opacity * v_color * color;\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY \x26\x26 !defined(HIGHLIGHT)\nvec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 \x3d step(0.0, difference0);\nvec4 isPositive1 \x3d step(0.0, difference1);\nfloat weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero \x3d step(weightSum, 0.0);\nfloat greaterThanZero \x3d 1.0 - lessThanEqZero ;\nfloat divisor \x3d (weightSum + lessThanEqZero);\nvec4 weights0 \x3d difference0 * isPositive0 / divisor;\nvec4 weights1 \x3d difference1 * isPositive1 / divisor;\nvec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax \x3d max(max4(difference0), max4(difference1));\nfloat lessThanZero \x3d step(diffMax, 0.0);\nfloat greaterOrEqZero \x3d 1.0 - lessThanZero;\nvec4 isMax0 \x3d step(diffMax, difference0);\nvec4 isMax1 \x3d step(diffMax, difference1);\nvec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color \x3d preEffectColor;\n#else\nout_color \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a \x3d 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (v_isOutline \x3e 0.5) {\ngl_FragColor \x3d drawLine();\n} else {\ngl_FragColor \x3d drawFill();\n}\n#else\ngl_FragColor \x3d drawFill();\n#endif\n}",
"fill.vert":"#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#include \x3cmaterials/fill/hittest.glsl\x3e\nconst float INV_SCALE_COMPRESSION_FACTOR \x3d 1.0 / 128.0;\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs \x3d buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      \x3d outputs.id;\nv_opacity \x3d outputs.opacity;\nv_aux1    \x3d vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color \x3d outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet \x3d a_bitset;\nout_color \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nmat3 tileToTileNormalized \x3d mat3(  2. / 512.,  0.,  0.,\n0., -2. / 512.,  0.,\n-1.,  1.,  1.  );\nout_pos   \x3d tileToTileNormalized * vec3((a_pos * FILL_POSITION_PRECISION), 1.);\n#else\nout_pos   \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#endif\n#ifdef PATTERN\nvec4  a_tlbr   \x3d a_aux1;\nfloat a_width  \x3d a_aux2.x;\nfloat a_height \x3d a_aux2.y;\nvec2  a_offset \x3d a_aux2.zw;\nvec2  a_scale  \x3d a_aux3.xy;\nfloat a_angle  \x3d a_aux3.z;\nvec2 scale \x3d INV_SCALE_COMPRESSION_FACTOR * a_scale;\nfloat width \x3d u_zoomFactor * a_width * scale.x;\nfloat height \x3d u_zoomFactor * a_height * scale.y;\nfloat angle \x3d C_256_TO_RAD * a_angle;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nfloat dx \x3d 0.0;\nfloat dy \x3d 0.0;\nif (getBit(a_bitset, BITSET_FILL_RANDOM_PATTERN_OFFSET) \x3e 0.5) {\nfloat id \x3d rgba2float(vec4(a_id, 0.0));\ndx \x3d rand(vec2(id, 0.0));\ndy \x3d rand(vec2(0.0, id));\n}\nmat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\ndx,            dy,           1);\nvec2 tileOffset \x3d vec2(u_tileOffset.x * cosA - u_tileOffset.y * sinA, u_tileOffset.x * sinA + u_tileOffset.y * cosA);\ntileOffset \x3d mod(tileOffset, vec2(a_aux2.x, a_aux2.y));\nvec2 symbolOffset \x3d (a_offset - tileOffset) / vec2(width, height);\nv_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 \x3d a_tlbr / u_mosaicSize.xyxy;\nv_sampleAlphaOnly \x3d getBit(a_bitset, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\nif (getBit(a_bitSet, BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR) \x3e 0.5) {\n#ifdef VV_COLOR\nv_sampleAlphaOnly *\x3d 1.0 - getBit(a_bitSet, BITSET_GENERIC_LOCK_COLOR);\n#else\nv_sampleAlphaOnly \x3d 0.0;\n#endif\n}\n#elif SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\n#ifdef HITTEST\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE) \x3e 0.5) {\nout_pos \x3d vec3(0., 0., 2.);\nreturn;\n}\n#endif\nhittestFill(out_color, out_pos);\ngl_PointSize \x3d 1.0;\n}\n#elif defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\nv_isOutline \x3d getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline \x3e 0.5) {\ndrawLine(out_color, out_pos);\n} else {\ndrawFill(out_color, out_pos);\n}\n}\n#else\n#define draw drawFill\n#endif\nvoid main()\n{\nINIT;\nhighp vec3 pos  \x3d vec3(0.);\nhighp vec4 color  \x3d vec4(0.);\ndraw(color, pos);\nv_color \x3d color;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}",
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestFill(\nout lowp vec4 out_color,\nout highp vec3 out_pos\n) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * FILL_POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * FILL_POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * FILL_POSITION_PRECISION, 1.);\nfloat hittestDist \x3d u_hittestDist;\nfloat dist \x3d distPointTriangle(u_hittestPos, pos.xy, pos1.xy, pos2.xy);\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3c 0. || dist \x3e\x3d hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3d\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif"},
hittest:{"common.glsl":"#ifdef HITTEST\nuniform float u_hittestDist;\nuniform highp vec2 u_hittestPos;\nfloat projectScalar(vec2 a, vec2 b) {\nreturn dot(a, normalize(b));\n}\nfloat distPointSegment(vec2 p0, vec2 p1, vec2 p2) {\nvec2 L \x3d p2 - p1;\nvec2 A \x3d p0 - p1;\nfloat projAL \x3d projectScalar(A, L);\nfloat t \x3d clamp(projAL / length(L), 0., 1.);\nreturn distance(p0, p1 + t * (p2 - p1));\n}\nvoid hittestMarker(out lowp vec4 out_color, out highp vec3 out_pos, in highp vec3 pos, float size) {\nfloat dist \x3d distance(pos, vec3(u_hittestPos, 1.));\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif ((dist - size) \x3e u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, (dist - size) \x3c 0. ? (1. / 255.) : 0.);\n}\nfloat intersectPointTriangleBary(vec2 p, vec2 a, vec2 b, vec2 c) {\nreturn inTriangle(xyToBarycentric(p, a, b, c));\n}\nfloat distPointTriangle(vec2 p, vec2 a, vec2 b, vec2 c) {\nvec2 ba \x3d b - a;\nvec2 ca \x3d c - a;\nfloat crossProduct \x3d ba.x * ca.y - ca.x * ba.y;\nbool isParallel \x3d crossProduct \x3c EPSILON_HITTEST \x26\x26 crossProduct \x3e -EPSILON_HITTEST;\nif (isParallel) {\nreturn -1.;\n}\nif (intersectPointTriangleBary(p.xy, a, b, c) \x3d\x3d 1.) {\nreturn 0.;\n}\nfloat distAB \x3d distPointSegment(p, a, b);\nfloat distBC \x3d distPointSegment(p, b, c);\nfloat distCA \x3d distPointSegment(p, c, a);\nreturn min(min(distAB, distBC), distCA);\n}\n#endif"},
icon:{"common.glsl":"#include \x3cutil/encoding.glsl\x3e\nuniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif\n#ifdef SDF\nvec4 getColor(vec2 v_size, vec2 v_tex) {\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth \x3d v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize \x3d min(outlineWidth, size);\noutlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\nreturn v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nreturn v_opacity * fillPixelColor;\n}\n#else\nvec4 getColor(vec2 _v_size, vec2 v_tex) {\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\nreturn v_opacity * texColor * v_color;\n}\n#endif",
heatmapAccumulate:{"common.glsl":"varying lowp vec4 v_hittestResult;\nvarying mediump vec2 v_offsetFromCenter;\nvarying highp float v_fieldValue;","heatmapAccumulate.frag":"precision mediump float;\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 0.25\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform lowp sampler2D u_texture;\nvoid main() {\n#ifdef HITTEST\ngl_FragColor \x3d v_hittestResult;\n#else\nfloat radius \x3d length(v_offsetFromCenter);\nfloat shapeWeight \x3d step(radius, 1.0);\nfloat oneMinusRadiusSquared \x3d 1.0 - radius * radius;\nfloat kernelWeight \x3d oneMinusRadiusSquared * oneMinusRadiusSquared;\ngl_FragColor \x3d vec4(shapeWeight * kernelWeight * v_fieldValue * COMPRESSION_FACTOR);\n#endif\n}",
"heatmapAccumulate.vert":"precision highp float;\nattribute vec2 a_vertexOffset;\nvec4 a_color \x3d vec4(0.0);\nvec2 a_zoomRange \x3d vec2(0.0, 10000.0);\nuniform float u_radius;\nuniform float u_isFieldActive;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\n#include \x3cmaterials/icon/heatmapAccumulate/common.glsl\x3e\nvoid main() {\nfloat filterFlags \x3d getFilterFlags();\n#ifdef HITTEST\nhighp vec4 out_hittestResult \x3d vec4(0.);\nhighp vec3 out_pos \x3d vec3(0.);\nvec3 pos \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nhittestMarker(out_hittestResult, out_pos, pos, u_radius);\nv_hittestResult \x3d out_hittestResult;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(a_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\nv_offsetFromCenter \x3d sign(a_vertexOffset);\nv_fieldValue \x3d getAttributeData2(a_id).x * u_isFieldActive + 1.0 - u_isFieldActive;\nvec3 centerPos \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nvec3 vertexPos \x3d centerPos + u_displayViewMat3 * vec3(v_offsetFromCenter, 0.0) * u_radius;\ngl_Position \x3d vec4(clip(a_color, vertexPos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
"hittest.glsl":"#ifdef HITTEST\n#include \x3cmaterials/hittest/common.glsl\x3e\nattribute vec2 a_vertexOffset1;\nattribute vec2 a_vertexOffset2;\nattribute vec2 a_texCoords1;\nattribute vec2 a_texCoords2;\nvec2 getTextureCoords(in vec3 bary, in vec2 texCoords0, in vec2 texCoords1, in vec2 texCoords2) {\nreturn texCoords0 * bary.x + texCoords1 * bary.y + texCoords2 * bary.z;\n}\nvoid hittestIcon(\ninout lowp vec4 out_color,\nout highp vec3 out_pos,\nin vec3 pos,\nin vec3 offset,\nin vec2 size,\nin float scaleFactor,\nin float isMapAligned\n) {\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3 posBase \x3d u_viewMat3 * u_tileMat3  * pos;\nvec3 offset1 \x3d scaleFactor * vec3(a_vertexOffset1 / 16.0, 0.);\nvec3 offset2 \x3d scaleFactor * vec3(a_vertexOffset2 / 16.0, 0.);\nvec2 pos0    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset).xy;\nvec2 pos1    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset1).xy;\nvec2 pos2    \x3d (posBase + getMatrixNoDisplay(isMapAligned) * offset2).xy;\nvec3 bary0 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary1 \x3d xyToBarycentric(u_hittestPos + vec2(0., -u_hittestDist), pos0, pos1, pos2);\nvec3 bary2 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary3 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary4 \x3d xyToBarycentric(u_hittestPos, pos0, pos1, pos2);\nvec3 bary5 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary6 \x3d xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec3 bary7 \x3d xyToBarycentric(u_hittestPos + vec2(0., u_hittestDist), pos0, pos1, pos2);\nvec3 bary8 \x3d xyToBarycentric(u_hittestPos + vec2(u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec2 tex0 \x3d a_texCoords  / u_mosaicSize;\nvec2 tex1 \x3d a_texCoords1 / u_mosaicSize;\nvec2 tex2 \x3d a_texCoords2 / u_mosaicSize;\nfloat alphaSum \x3d 0.;\nalphaSum +\x3d inTriangle(bary0) * getColor(size, getTextureCoords(bary0, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary1) * getColor(size, getTextureCoords(bary1, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary2) * getColor(size, getTextureCoords(bary2, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary3) * getColor(size, getTextureCoords(bary3, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary4) * getColor(size, getTextureCoords(bary4, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary5) * getColor(size, getTextureCoords(bary5, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary6) * getColor(size, getTextureCoords(bary6, tex0, tex1, tex2)).a;\nalphaSum +\x3d inTriangle(bary7) * getColor(size, getTextureCoords(bary7, tex0, tex1, tex2)).a;\nout_pos.z +\x3d step(alphaSum, .05) * 2.0;\nout_color \x3d vec4(1. / 255., 0., 0., alphaSum / 255.);\n}\n#endif",
"icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvoid main()\n{\n#ifdef HITTEST\nvec4 color \x3d v_color;\n#else\nvec4 color \x3d getColor(v_sizeTex.xy, v_sizeTex.zw);\n#endif\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}","icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/icon/hittest.glsl\x3e\nfloat getMarkerScaleFactor(inout vec2 size, in float referenceSize) {\n#ifdef VV_SIZE\nfloat f \x3d getSize(size.y) / size.y;\nfloat sizeFactor \x3d size.y / referenceSize;\nreturn getSize(referenceSize) / referenceSize;\n#else\nreturn 1.;\n#endif\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec3  pos           \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nvec2  size          \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec3  offset        \x3d vec3(a_vertexOffset / 16.0, 0.);\nfloat outlineSize   \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat isMapAligned  \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nfloat referenceSize \x3d a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0;\nfloat scaleSymbolProportionally \x3d getBit(a_bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\nfloat scaleFactor               \x3d getMarkerScaleFactor(size, referenceSize);\nsize.xy     *\x3d scaleFactor;\noffset.xy   *\x3d scaleFactor;\noutlineSize *\x3d scaleSymbolProportionally * (scaleFactor - 1.0) + 1.0;\nvec2 v_tex   \x3d a_texCoords / u_mosaicSize;\nfloat filterFlags \x3d getFilterFlags();\nv_color    \x3d getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  \x3d getOpacity();\nv_id       \x3d norm(a_id);\nv_pos      \x3d u_dvsMat3 * pos + getMatrix(isMapAligned) * getRotation()  * offset;\nv_sizeTex  \x3d vec4(size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   \x3d getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor \x3d v_isThin;\n#else\nv_overridingOutlineColor \x3d 0.0;\n#endif\nv_outlineWidth \x3d min(outlineSize, max(max(size.x, size.y) - 0.99, 0.0));\nv_outlineColor \x3d a_outlineColor;\nv_distRatio \x3d a_bitSetAndDistRatio.y / 128.0;\n#endif\n#ifdef HITTEST\nhighp vec4 out_color \x3d vec4(0.);\nhighp vec3 out_pos   \x3d vec3(0.);\nhittestIcon(out_color, out_pos, pos, offset, size, scaleFactor, isMapAligned);\nv_color \x3d out_color;\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHaloPass;\nuniform float u_isBackgroundPass;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle \x3d angle * 360.0 / 254.0;\nfloat mapAngle \x3d u_mapRotation * 360.0 / 254.0;\nfloat diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z \x3d 0.0;\nz +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\nz +\x3d 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    \x3d getMinZoom();\nfloat glyphMinZoom    \x3d a_glyphData.x;\nfloat glyphMaxZoom    \x3d a_glyphData.y;\nfloat glyphAngle      \x3d a_glyphData.z;\nfloat a_isBackground  \x3d a_glyphData.w;\nfloat a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\nfloat fontSize           \x3d a_texAndSize.z;\nfloat haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    \x3d fontSize / SDF_FONT_SIZE;\nfloat halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\nfloat animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\nfloat isText \x3d 1.0 - a_isBackground;\nfloat isBackground \x3d u_isBackgroundPass * a_isBackground;\nvec4  nonHaloColor \x3d (isBackground + isText) * a_color;\nv_color     \x3d animation * ((1.0 - u_isHaloPass) * nonHaloColor + (u_isHaloPass * a_haloColor));\nv_opacity   \x3d 1.0;\nv_tex       \x3d a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset \x3d u_isHaloPass * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\nfloat isHidden \x3d u_isBackgroundPass * isText + (1.0 - u_isBackgroundPass) * a_isBackground;\nv_pos.z +\x3d 2.0 * isHidden;\ngl_Position \x3d vec4(v_pos, 1.0);\n#ifdef DEBUG\nv_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestLine(out lowp vec4 out_color, out highp vec3 out_pos, float halfWidth) {\nvec3 pos        \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3 pos1       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos1 * POSITION_PRECISION, 1.);\nvec3 pos2       \x3d u_viewMat3 * u_tileMat3 * vec3(a_pos2 * POSITION_PRECISION, 1.);\nvec3 outTextureCoords \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat dist \x3d min(distPointSegment(u_hittestPos, pos.xy, pos1.xy),\ndistPointSegment(u_hittestPos, pos.xy, pos2.xy)) - halfWidth;\nout_pos \x3d vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist \x3e\x3d u_hittestDist) {\nout_pos.z +\x3d 2.0;\n}\nout_color \x3d vec4(1. / 255., 0, 0, dist \x3c\x3d 0. ? (1. / 255.) : 0.);\n}\n#endif",
"line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.frag\x3e\n#ifdef HITTEST\nvoid main() {\ngl_FragColor \x3d v_color;\n}\n#else\nvoid main() {\nLineData inputs \x3d LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor \x3d shadeLine(inputs);\n}\n#endif",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/symbologyTypeUtils.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\n#include \x3cmaterials/line/hittest.glsl\x3e\n#include \x3cmaterials/shared/line/common.glsl\x3e\n#include \x3cmaterials/shared/line/line.vert\x3e\n#ifdef HITTEST\nvoid draw() {\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat a_halfWidth \x3d a_accumulatedDistanceAndHalfWidth.y / 16.;\nfloat a_cimHalfWidth \x3d a_aux.x / 16. ;\nvec2  a_offset \x3d a_offsetAndNormal.xy / 16.;\nfloat baseWidth \x3d getBaseLineHalfWidth(a_halfWidth, a_cimHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nhighp vec3 pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestLine(v_color, pos, halfWidth);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#else\nvoid draw()\n{\nhighp vec3 pos \x3d vec3(0.);\nLineData outputs \x3d buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              \x3d outputs.id;\nv_color           \x3d outputs.color;\nv_normal          \x3d outputs.normal;\nv_lineHalfWidth   \x3d outputs.lineHalfWidth;\nv_opacity         \x3d outputs.opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr          \x3d outputs.tlbr;\nv_patternSize   \x3d outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio \x3d outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position \x3d vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#endif\nvoid main() {\nINIT;\ndraw();\n}"},
pie:{"pie.frag":"precision mediump float;\n#include \x3cutil/atan2.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nuniform lowp vec4 u_colors[NUMBER_OF_FIELDS];\nuniform lowp vec4 u_defaultColor;\nuniform lowp vec4 u_othersColor;\nuniform lowp vec4 u_outlineColor;\nuniform float u_donutRatio;\nuniform float u_sectorThreshold;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nlowp vec4 getSectorColor(in int index, in vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\n#if __VERSION__ \x3d\x3d 300\nmediump int colorIndex \x3d int(filteredSectorToColorId[index].y);\nreturn u_colors[colorIndex];\n#else\nmediump int colorIndex;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d index) {\ncolorIndex \x3d int(filteredSectorToColorId[i].y);\n}\n}\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d colorIndex) {\nreturn u_colors[i];\n}\n}\nreturn u_colors[NUMBER_OF_FIELDS - 1];\n#endif\n}\nconst int OTHER_SECTOR_ID \x3d 255;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor() {\nfloat angle \x3d 90.0 - C_RAD_TO_DEG * atan2(v_offset.y, v_offset.x);\nif (angle \x3c 0.0) {\nangle +\x3d 360.0;\n} else if (angle \x3e 360.0) {\nangle \x3d mod(angle, 360.0);\n}\nint numOfEntries \x3d int(v_numOfEntries);\nfloat maxSectorAngle \x3d v_maxSectorAngle;\nlowp vec4 fillColor \x3d (maxSectorAngle \x3e 0.0 || u_sectorThreshold \x3e 0.0) ? u_othersColor : u_defaultColor;\nlowp vec4 prevColor \x3d vec4(0.0);\nlowp vec4 nextColor \x3d vec4(0.0);\nfloat startSectorAngle \x3d 0.0;\nfloat endSectorAngle \x3d 0.0;\nif (angle \x3c maxSectorAngle) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nstartSectorAngle \x3d endSectorAngle;\nendSectorAngle \x3d v_filteredSectorToColorId[index].x;\nif (endSectorAngle \x3e angle) {\nfillColor \x3d getSectorColor(index, v_filteredSectorToColorId);\nprevColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 index \x3d\x3d 0 \x26\x26 abs(360.0 - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3e 0 ? index - 1 : numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d u_sectorThreshold !\x3d 0.0 \x26\x26 abs(endSectorAngle - maxSectorAngle) \x3c EPSILON ? u_othersColor :\ngetSectorColor(index \x3c numOfEntries - 1 ? index + 1 : 0, v_filteredSectorToColorId);\nbreak;\n}\nif (index \x3d\x3d numOfEntries - 1) {\nbreak;\n}\n}\n} else {\nprevColor \x3d getSectorColor(numOfEntries - 1, v_filteredSectorToColorId);\nnextColor \x3d getSectorColor(0, v_filteredSectorToColorId);\nstartSectorAngle \x3d maxSectorAngle;\nendSectorAngle \x3d 360.0;\n}\nlowp vec4 outlineColor \x3d u_outlineColor;\nfloat offset \x3d length(v_offset);\nfloat distanceSize \x3d offset * v_size;\nif (startSectorAngle !\x3d 0.0 || endSectorAngle !\x3d 360.0) {\nfloat distanceToStartSector \x3d (angle - startSectorAngle);\nfloat distanceToEndSector \x3d (endSectorAngle - angle);\nfloat sectorThreshold \x3d 0.6;\nfloat beginSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToStartSector * offset);\nfloat endSectorAlpha \x3d smoothstep(0.0, sectorThreshold, distanceToEndSector * offset);\nif (endSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(nextColor, fillColor, endSectorAlpha);\n} else if (beginSectorAlpha \x3e 0.0) {\nfillColor \x3d mix(prevColor, fillColor, beginSectorAlpha);\n}\n}\nfloat donutSize \x3d u_donutRatio * (v_size - v_outlineWidth);\nfloat endOfDonut \x3d donutSize - v_outlineWidth;\nfloat aaThreshold \x3d 0.75;\nfloat innerCircleAlpha \x3d endOfDonut - aaThreshold \x3e 0.0 ? smoothstep(endOfDonut - aaThreshold, endOfDonut + aaThreshold, distanceSize) : 1.0;\nfloat outerCircleAlpha \x3d 1.0 - smoothstep(v_size - aaThreshold, v_size + aaThreshold , distanceSize);\nfloat circleAlpha \x3d innerCircleAlpha * outerCircleAlpha;\nfloat startOfOutline \x3d v_size - v_outlineWidth;\nif (startOfOutline \x3e 0.0 \x26\x26 v_outlineWidth \x3e 0.25) {\nfloat outlineFactor \x3d smoothstep(startOfOutline - aaThreshold, startOfOutline + aaThreshold, distanceSize);\nfloat innerLineFactor \x3d donutSize - aaThreshold \x3e 0.0 ? 1.0 - smoothstep(donutSize - aaThreshold, donutSize + aaThreshold , distanceSize) : 0.0;\nfillColor \x3d mix(fillColor, outlineColor, innerLineFactor + outlineFactor);\n}\nreturn v_opacity * circleAlpha * fillColor;\n}\n#endif\nvoid main()\n{\nvec4 color \x3d getColor();\n#ifdef HIGHLIGHT\ncolor.a \x3d step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor \x3d color;\n}",
"pie.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\nuniform float u_outlineWidth;\nuniform mediump float u_sectorThreshold;\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nint filter(in float sectorAngle,\nin int currentIndex,\ninout FilteredChartInfo filteredInfo,\ninout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\nif (sectorAngle \x3e u_sectorThreshold * 360.0) {\nfilteredInfo.endSectorAngle +\x3d sectorAngle;\n#if __VERSION__ \x3d\x3d 300\nfilteredSectorToColorId[filteredInfo.colorId] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; i++) {\nif (i \x3d\x3d filteredInfo.colorId) {\nfilteredSectorToColorId[i] \x3d vec2(filteredInfo.endSectorAngle, currentIndex);\n}\n}\n#endif\n++filteredInfo.colorId;\n}\nreturn 0;\n}\nint filterValues(inout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS],\ninout FilteredChartInfo filteredInfo,\nin float sectorAngles[NUMBER_OF_FIELDS]) {\nfor (int index \x3d 0; index \x3c NUMBER_OF_FIELDS; ++index) {\nfloat sectorValue \x3d sectorAngles[index];\nfilter(sectorValue, index, filteredInfo, filteredSectorToColorId);\n}\nreturn filteredInfo.colorId;\n}\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\n#include \x3cmaterials/hittest/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\nvec2 outSize \x3d baseSize;\n#ifdef VV_SIZE\nfloat r \x3d 0.5 * getSize(referenceSize) / referenceSize;\noutSize.xy *\x3d r;\noffset.xy *\x3d r;\nfloat scaleSymbolProportionally \x3d getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn outSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned \x3d getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       \x3d vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nfloat filterNaNValues(in float value) {\nreturn value !\x3d NAN_MAGIC_NUMBER \x26\x26 value \x3e 0.0 ? value : 0.0;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset \x3d a_vertexOffset / 16.0;\nfloat outlineSize \x3d u_outlineWidth;\nfloat a_bitSet \x3d a_bitSetAndDistRatio.x;\nvec2 size \x3d getMarkerSize(a_offset, a_size, outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nfloat filterFlags \x3d getFilterFlags();\nvec3  pos         \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nv_opacity      \x3d getOpacity();\nv_id           \x3d norm(a_id);\nv_pos          \x3d u_dvsMat3 * pos + getOffset(a_offset, a_bitSet);\nv_offset       \x3d sign(a_texCoords - 0.5);\nv_size         \x3d max(size.x, size.y);\nv_outlineWidth \x3d outlineSize;\nfloat attributeData[10];\nvec4 attributeData0 \x3d getAttributeData3(a_id);\nattributeData[0] \x3d filterNaNValues(attributeData0.x);\nattributeData[1] \x3d filterNaNValues(attributeData0.y);\nattributeData[2] \x3d filterNaNValues(attributeData0.z);\nattributeData[3] \x3d filterNaNValues(attributeData0.w);\n#if (NUMBER_OF_FIELDS \x3e 4)\nvec4 attributeData1 \x3d getAttributeData4(a_id);\nattributeData[4] \x3d filterNaNValues(attributeData1.x);\nattributeData[5] \x3d filterNaNValues(attributeData1.y);\nattributeData[6] \x3d filterNaNValues(attributeData1.z);\nattributeData[7] \x3d filterNaNValues(attributeData1.w);\n#endif\n#if (NUMBER_OF_FIELDS \x3e 8)\nvec4 attributeData2 \x3d getAttributeData5(a_id);\nattributeData[8] \x3d filterNaNValues(attributeData2.x);\nattributeData[9] \x3d filterNaNValues(attributeData2.y);\n#endif\nfloat sum \x3d 0.0;\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsum +\x3d attributeData[i];\n}\nfloat sectorAngles[NUMBER_OF_FIELDS];\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nsectorAngles[i] \x3d 360.0 * attributeData[i] / sum;\n}\nvec2 filteredSectorToColorId[NUMBER_OF_FIELDS];\nFilteredChartInfo filteredInfo \x3d FilteredChartInfo(0.0, 0);\nint numOfEntries \x3d filterValues(filteredSectorToColorId, filteredInfo, sectorAngles);\nv_numOfEntries \x3d float(numOfEntries);\nv_maxSectorAngle \x3d filteredInfo.endSectorAngle;\n#if __VERSION__ \x3d\x3d 300\nv_filteredSectorToColorId \x3d filteredSectorToColorId;\n#else\nfor (int i \x3d 0; i \x3c NUMBER_OF_FIELDS; ++i) {\nif (i \x3d\x3d numOfEntries) {\nbreak;\n}\nv_filteredSectorToColorId[i] \x3d filteredSectorToColorId[i];\n}\n#endif\n#ifdef HITTEST\nhighp vec3 out_pos \x3d vec3(0.0);\nv_color            \x3d vec4(0.0);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  pos, v_size);\ngl_PointSize \x3d 1.0;\ngl_Position \x3d vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position \x3d vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},
shared:{line:{"common.glsl":"#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};",
"line.frag":"uniform lowp float u_blur;\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth \x3d line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX \x3d fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY \x3d 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT) \x26\x26 !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth \x3d line.lineHalfWidth;\nmediump float adjustedPatternHeight \x3d line.patternSize.y * 2.0 * lineHalfWidth / line.patternSize.x;\nmediump float relativeTexY \x3d fract(line.accumulatedDistance / adjustedPatternHeight);\nmediump float relativeTexX \x3d 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord \x3d mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly \x3e 0.5) {\ncolor.rgb \x3d vec3(color.a);\n}\n#endif\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist \x3d length(line.normal) * line.lineHalfWidth;\nlowp float alpha \x3d clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color \x3d getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a \x3d step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a \x3c 1.0 / 255.0) {\ndiscard;\n}\nout_color \x3d vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}",
"line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat refLineWidth \x3d 2.0 * referenceHalfWidth;\nreturn 0.5 * (lineHalfWidth / max(referenceHalfWidth, EPSILON)) * getSize(refLineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth \x3d max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        \x3d 0.5 * u_antialiasing;\nfloat baseWidth \x3d getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth \x3d getLineHalfWidth(baseWidth, aa);\nfloat z         \x3d 2.0 * step(baseWidth, 0.0);\nvec2  dist      \x3d getDist(in_offset, halfWidth);\nvec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       \x3d u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvec4  color     \x3d in_color;\nfloat opacity   \x3d 1.0;\n#else\nvec4  color     \x3d getColor(in_color, in_bitSet, BITSET_GENERIC_LOCK_COLOR);\nfloat opacity   \x3d getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH \x3d 15.5;\nfloat scaleDash \x3d getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio \x3d (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) \x26\x26 defined(PATTERN)\nv_sampleAlphaOnly \x3d getBit(in_bitSet, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#endif\nout_pos \x3d vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},
"symbologyTypeUtils.glsl":"#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#endif\n#if SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_SIMPLE || SYMBOLOGY_TYPE \x3d\x3d SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\n#endif",text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;",
"hittest.glsl":"#include \x3cmaterials/hittest/common.glsl\x3e","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor()\n{\nfloat SDF_CUTOFF \x3d (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /\x3d 2.0;\n#endif\nlowp float aa \x3d v_antialiasingWidth;\nlowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\nreturn alpha * v_color * v_opacity;\n}\n#endif\nvoid main()\n{\ngl_FragColor \x3d getColor();\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\n#include \x3cmaterials/text/hittest.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHaloPass;\nuniform float u_isBackgroundPass;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r \x3d getSize(referenceSize) / referenceSize;\nbaseSize *\x3d r;\noffset.xy *\x3d r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_isBackground  \x3d a_aux.y;\nfloat a_referenceSize \x3d a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        \x3d a_aux.w;\nfloat a_fontSize      \x3d a_texFontSize.z;\nvec2  a_offset        \x3d a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      \x3d getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     \x3d fontSize / SDF_FONT_SIZE;\nvec3  offset        \x3d getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\nfloat isText \x3d 1.0 - a_isBackground;\nfloat isBackground \x3d u_isBackgroundPass * a_isBackground;\nvec4  nonHaloColor  \x3d (isBackground * a_color) + (isText * getColor(a_color, a_bitSet, 1));\nv_color   \x3d u_isHaloPass * a_haloColor + (1.0 - u_isHaloPass) * nonHaloColor;\nv_opacity \x3d getOpacity();\nv_id      \x3d norm(a_id);\nv_tex     \x3d a_texCoords / u_mosaicSize;\nv_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\nfloat isHidden \x3d u_isBackgroundPass * isText + (1.0 - u_isBackgroundPass) * a_isBackground;\nv_pos.z +\x3d 2.0 * isHidden;\nv_edgeDistanceOffset \x3d u_isHaloPass * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n#ifdef HITTEST\nhighp vec3 out_pos  \x3d vec3(0.);\nv_color \x3d vec4(0.);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  vec3(a_pos * POSITION_PRECISION, 1.0)\n+ u_tileMat3 * offset, fontSize / 2.);\ngl_PointSize \x3d 1.;\ngl_Position \x3d vec4(clip(v_color, out_pos, getFilterFlags(), a_zoomRange), 1.0);\n#else\ngl_Position \x3d  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n#endif\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset \x3d pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate \x3d getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r \x3d mod(rshift(u32, 0), 255.0);\nfloat g \x3d mod(rshift(u32, 8), 255.0);\nfloat b \x3d mod(rshift(u32, 16), 255.0);\nfloat a \x3d mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /\x3d 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}\nhighp float rand(in vec2 co) {\nhighp float a \x3d 12.9898;\nhighp float b \x3d 78.233;\nhighp float c \x3d 43758.5453;\nhighp float dt \x3d dot(co, vec2(a,b));\nhighp float sn \x3d mod(dt, 3.14);\nreturn fract(sin(sn) * c);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/barycentric.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp mat3 u_tileMat3;\nuniform highp mat3 u_viewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef SUPPORTS_TEXTURE_FLOAT\ntarget.rgba \x3d getAttributeData2(a_id);\n#else\nvec4 data0 \x3d getAttributeData2(a_id);\nvec4 data1 \x3d getAttributeData3(a_id);\ntarget.r \x3d u88VVToFloat(data0.rg * 255.0);\ntarget.g \x3d u88VVToFloat(data0.ba * 255.0);\ntarget.b \x3d u88VVToFloat(data1.rg * 255.0);\ntarget.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   \x3d getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 \x3d getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrixNoDisplay(float isMapAligned) {\nreturn isMapAligned * u_viewMat3 * u_tileMat3 + (1.0 - isMapAligned) * u_tileMat3;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z +\x3d 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\nfloat f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\nfloat f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation \x3d rotationValue;\nif (u_vvRotationType \x3d\x3d 1.0) {\nrotation \x3d 90.0 - rotation;\n}\nfloat angle \x3d C_DEG_TO_RAD * -rotation;\nfloat sinA \x3d sin(angle);\nfloat cosA \x3d cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\nreturn fallback;\n}\nif (colorValue \x3c\x3d u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] \x3e\x3d colorValue) {\nfloat f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize \x3d getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},
overlay:{overlay:{"overlay.frag":"precision lowp float;\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_texture, v_uv);\ngl_FragColor \x3d color *  u_opacity;\n}","overlay.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_uv;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_perspective;\nvarying mediump vec2 v_uv;\nvoid main(void) {\nv_uv \x3d a_uv;\nfloat w \x3d 1.0 + dot(a_uv, u_perspective);\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0);\ngl_Position \x3d vec4(w * pos.xy, 0.0, w);\n}"}},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor \x3d 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\nvec4 color \x3d u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\ngl_FragColor \x3d clamp(color, 0.0, 1.0);\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d float(SIGMA);\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel \x3d texture2D(u_texture, v_uv);\nvec3 luma \x3d vec3(0.299, 0.587, 0.114);\nfloat v \x3d dot(texel.xyz, luma);\nvec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize \x3d 1.0 / u_texSize;\nfloat fSigma \x3d u_sigma;\nfloat weightSum \x3d gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\nfloat x \x3d float(i);\nfloat w \x3d gaussianPdf(x, fSigma);\nvec2 uvOffset \x3d u_direction * invSize * x;\nvec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum +\x3d (sample1 + sample2) * w;\nweightSum +\x3d 2.0 * w;\n}\ngl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] \x3d -0.08;\nsamples[1] \x3d -0.05;\nsamples[2] \x3d -0.03;\nsamples[3] \x3d -0.02;\nsamples[4] \x3d -0.01;\nsamples[5] \x3d  0.01;\nsamples[6] \x3d  0.02;\nsamples[7] \x3d  0.03;\nsamples[8] \x3d  0.05;\nsamples[9] \x3d  0.08;\nvec2 dir \x3d 0.5 - v_uv;\nfloat dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\ndir \x3d dir / dist;\nvec4 color \x3d texture2D(u_colorTexture,v_uv);\nvec4 sum \x3d color;\nfor (int i \x3d 0; i \x3c 10; i++) {\nsum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *\x3d 1.0 / 11.0;\nfloat t \x3d dist * sampleStrength;\nt \x3d clamp(t, 0.0, 1.0);\ngl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\nvec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\nvec4 color \x3d texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply \x3d color.rgb / color.a;\nvec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel \x3d vec2(1.0) / u_srcResolution;\nvec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor \x3d vec4(1.0);\nvec4 maxColor \x3d vec4(0.0);\nfor (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\nfor (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\nvec2 offset \x3d uv + vec2(x, y) * onePixel;\nminColor \x3d min(minColor, texture2D(u_minTexture, offset));\nmaxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] \x3d minColor;\ngl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nuniform vec2 u_shadowOffset;\nuniform highp mat3 u_displayViewMat3;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset \x3d u_displayViewMat3 * vec3(u_shadowOffset, 0.0);\nvec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor \x3d texture2D(u_blurTexture, v_uv - offset.xy / 2.0);\ngl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"}},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] \x3d g0,\nG[1] \x3d g1,\nG[2] \x3d g2,\nG[3] \x3d g3,\nG[4] \x3d g4,\nG[5] \x3d g5,\nG[6] \x3d g6,\nG[7] \x3d g7,\nG[8] \x3d g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 9; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nfloat M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\ngl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] \x3d g0;\nG[1] \x3d g1;\nfor (float i \x3d 0.0; i \x3c 3.0; i++) {\nfor (float j \x3d 0.0; j \x3c 3.0; j++) {\nsample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] \x3d length(sample);\n}\n}\nfor (int i \x3d 0; i \x3c 2; i++) {\nfloat dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] \x3d dp3 * dp3;\n}\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\ngl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color \x3d texture2D(u_colorTexture, v_uv);\nvec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a \x3d color.a;\ngl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position \x3d vec4(a_position, 0.0, 1.0);\nv_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\ngl_FragColor \x3d vec4(color.rgb * u_opacity, color.a * u_opacity);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation \x3d projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}",
"common.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos * u_scale + u_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}","contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI \x3d 255.0;\nfloat mid \x3d 128.0;\nfloat c \x3d u_contrastOffset;\nfloat b \x3d u_brightnessOffset;\nvec4 v;\nif (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c \x3d\x3d 100.0) {\nv \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv \x3d (sign(v) + 1.0) / 2.0;\n} else if (c \x3d\x3d -100.0) {\nv \x3d vec4(mid, mid, mid, currentPixel.a);\n}\nreturn vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"inverse.glsl":"float invertValue(float value) {\nfloat s \x3d sign(value);\nreturn (s * s) / (value + abs(s) - 1.0);\n}","mirror.glsl":"vec2 mirror(vec2 pos) {\nvec2 pos1 \x3d abs(pos);\nreturn step(pos1, vec2(1.0, 1.0)) * pos1 + step(1.0, pos1) * (2.0 - pos1);\n}","projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n#ifdef LOOKUP_PROJECTION\nvec4 pv \x3d texture2D(u_transformGrid, coords);\nreturn vec2(pv.r, pv.g);\n#endif\nvec2 index_image \x3d floor(coords * u_targetImageSize);\nvec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\nif (pos.s \x3c\x3d pos.t) {\nvec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},
flow:{"getFadeOpacity.glsl":"uniform float u_decayRate;\nuniform float u_fadeToZero;\nfloat getFadeOpacity(float x) {\nfloat cutOff \x3d mix(0.0, exp(-u_decayRate), u_fadeToZero);\nreturn (exp(-u_decayRate * x) - cutOff) / (1.0 - cutOff);\n}","getFragmentColor.glsl":"vec4 getFragmentColor(vec4 color, float dist, float size, float featheringSize) {\nfloat featheringStart \x3d clamp(0.5 - featheringSize / size, 0.0, 0.5);\nif (dist \x3e featheringStart) {\ncolor *\x3d 1.0 - (dist - featheringStart) / (0.5 - featheringStart);\n}\nreturn color;\n}",
imagery:{"imagery.frag":"precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform float u_Min;\nuniform float u_Max;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nfloat getIntensity(float v) {\nreturn u_Min + v * (u_Max - u_Min);\n}\nvoid main(void) {\nvec4 sampled \x3d texture2D(u_texture, v_texcoord);\nfloat intensity \x3d getIntensity(sampled.r);\ngl_FragColor \x3d getColor(intensity);\ngl_FragColor.a *\x3d getOpacity(sampled.r);\ngl_FragColor.a *\x3d sampled.a;\ngl_FragColor.rgb *\x3d gl_FragColor.a;\n}",
"imagery.vert":"attribute vec2 a_position;\nattribute vec2 a_texcoord;\nuniform mat3 u_dvsMat3;\nvarying vec2 v_texcoord;\nvoid main(void) {\nvec2 xy \x3d (u_dvsMat3 * vec3(a_position, 1.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_texcoord \x3d a_texcoord;\n}"},particles:{"particles.frag":"precision highp float;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\nvoid main(void) {\ngl_FragColor \x3d getFragmentColor(v_color, length(v_texcoord - 0.5), v_size, u_featheringSize);\n}",
"particles.vert":"attribute vec4 a_xyts0;\nattribute vec4 a_xyts1;\nattribute vec4 a_typeIdDurationSeed;\nattribute vec4 a_extrudeInfo;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/vv.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nvec2 position0 \x3d a_xyts0.xy;\nfloat t0 \x3d a_xyts0.z;\nfloat speed0 \x3d a_xyts0.w;\nvec2 position1 \x3d a_xyts1.xy;\nfloat t1 \x3d a_xyts1.z;\nfloat speed1 \x3d a_xyts1.w;\nfloat type \x3d a_typeIdDurationSeed.x;\nfloat id \x3d a_typeIdDurationSeed.y;\nfloat duration \x3d a_typeIdDurationSeed.z;\nfloat seed \x3d a_typeIdDurationSeed.w;\nvec2 e0 \x3d a_extrudeInfo.xy;\nvec2 e1 \x3d a_extrudeInfo.zw;\nfloat animationPeriod \x3d duration + u_trailLength;\nfloat scaledTime \x3d u_time * u_flowSpeed;\nfloat randomizedTime \x3d scaledTime + seed * animationPeriod;\nfloat t \x3d mod(randomizedTime, animationPeriod);\nfloat fUnclamped \x3d (t - t0) / (t1 - t0);\nfloat f \x3d clamp(fUnclamped, 0.0, 1.0);\nfloat clampedTime \x3d mix(t0, t1, f);\nfloat speed \x3d mix(speed0, speed1, f);\nvec2 extrude;\nvec2 position;\nfloat fadeOpacity;\nfloat introOpacity;\nif (type \x3d\x3d 2.0) {\nif (fUnclamped \x3c 0.0 || (fUnclamped \x3e 1.0 \x26\x26 t1 !\x3d duration)) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nvec2 ortho \x3d mix(e0, e1, f);\nvec2 parallel;\nparallel \x3d normalize(position1 - position0) * 0.5;\nif (id \x3d\x3d 1.0) {\nextrude \x3d ortho;\nv_texcoord \x3d vec2(0.5, 0.0);\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -ortho;\nv_texcoord \x3d vec2(0.5, 1.0);\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d ortho + parallel;\nv_texcoord \x3d vec2(1.0, 0.0);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -ortho + parallel;\nv_texcoord \x3d vec2(1.0, 1.0);\n}\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else {\nif (fUnclamped \x3c 0.0) {\ngl_Position \x3d vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nif (id \x3d\x3d 1.0) {\nextrude \x3d e0;\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 2.0) {\nextrude \x3d -e0;\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-t0);\nv_size \x3d getSize(speed0);\nv_color \x3d getColor(speed0);\nv_color.a *\x3d getOpacity(speed0);\nposition \x3d position0;\n} else if (id \x3d\x3d 3.0) {\nextrude \x3d mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 0.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n} else if (id \x3d\x3d 4.0) {\nextrude \x3d -mix(e0, e1, f);\nv_texcoord \x3d vec2(0.5, 1.0);\nfadeOpacity \x3d getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity \x3d 1.0 - exp(-clampedTime);\nv_size \x3d getSize(speed);\nv_color \x3d getColor(speed);\nv_color.a *\x3d getOpacity(speed);\nposition \x3d mix(position0, position1, f);\n}\n}\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(extrude * v_size, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_color.a *\x3d fadeOpacity;\nv_color.a *\x3d mix(1.0, introOpacity, u_introFade);\nv_color.rgb *\x3d v_color.a;\n}"},
streamlines:{"streamlines.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_size;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include \x3craster/flow/getFragmentColor.glsl\x3e\n#include \x3craster/flow/getFadeOpacity.glsl\x3e\nvoid main(void) {\nfloat t \x3d mod(v_timeSeed * (v_totalTime + u_trailLength) + u_time * u_flowSpeed, v_totalTime + u_trailLength) - v_time;\nvec4 color \x3d v_color * step(0.0, t) * getFadeOpacity(t / u_trailLength);\ncolor *\x3d mix(1.0, 1.0 - exp(-v_time), u_introFade);\ngl_FragColor \x3d getFragmentColor(color, length((v_side + 1.0) / 2.0 - 0.5), v_size, u_featheringSize);\n}",
"streamlines.vert":"attribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nattribute float a_speed;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_side;\nvarying float v_size;\nuniform float u_featheringSize;\n#include \x3craster/flow/vv.glsl\x3e\nvoid main(void) {\nvec4 lineColor \x3d getColor(a_speed);\nfloat lineOpacity \x3d getOpacity(a_speed);\nfloat lineSize \x3d getSize(a_speed);\nvec2 position \x3d a_positionAndSide.xy;\nv_side \x3d a_positionAndSide.z;\nvec2 xy \x3d (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * lineSize, 0.0)).xy;\ngl_Position \x3d vec4(xy, 0.0, 1.0);\nv_time \x3d a_timeInfo.x;\nv_totalTime \x3d a_timeInfo.y;\nv_timeSeed \x3d a_timeInfo.z;\nv_color \x3d lineColor;\nv_color.a *\x3d lineOpacity;\nv_color.rgb *\x3d v_color.a;\nv_size \x3d lineSize;\n}"},
"vv.glsl":"#define MAX_STOPS 8\n#ifdef VV_COLOR\nuniform float u_color_stops[MAX_STOPS];\nuniform vec4 u_color_values[MAX_STOPS];\nuniform int u_color_count;\n#else\nuniform vec4 u_color;\n#endif\n#ifdef VV_OPACITY\nuniform float u_opacity_stops[MAX_STOPS];\nuniform float u_opacity_values[MAX_STOPS];\nuniform int u_opacity_count;\n#else\nuniform float u_opacity;\n#endif\n#ifdef VV_SIZE\nuniform float u_size_stops[MAX_STOPS];\nuniform float u_size_values[MAX_STOPS];\nuniform int u_size_count;\n#else\nuniform float u_size;\n#endif\nuniform float u_featheringOffset;\nvec4 getColor(float x) {\n#ifdef VV_COLOR\nvec4 color \x3d u_color_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_color_count) {\nbreak;\n}\nfloat x1 \x3d u_color_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_color_stops[i];\nvec4 y2 \x3d u_color_values[i];\nif (x \x3c x2) {\nvec4 y1 \x3d u_color_values[i - 1];\ncolor \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\ncolor \x3d y2;\n}\n}\n}\n#else\nvec4 color \x3d u_color;\n#endif\nreturn color;\n}\nfloat getOpacity(float x) {\n#ifdef VV_OPACITY\nfloat opacity \x3d u_opacity_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_opacity_count) {\nbreak;\n}\nfloat x1 \x3d u_opacity_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_opacity_stops[i];\nfloat y2 \x3d u_opacity_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_opacity_values[i - 1];\nopacity \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nopacity \x3d y2;\n}\n}\n}\n#else\nfloat opacity \x3d u_opacity;\n#endif\nreturn opacity;\n}\nfloat getSize(float x) {\n#ifdef VV_SIZE\nfloat size \x3d u_size_values[0];\n{\nfor (int i \x3d 1; i \x3c MAX_STOPS; i++) {\nif (i \x3e\x3d u_size_count) {\nbreak;\n}\nfloat x1 \x3d u_size_stops[i - 1];\nif (x \x3c x1) {\nbreak;\n}\nfloat x2 \x3d u_size_stops[i];\nfloat y2 \x3d u_size_values[i];\nif (x \x3c x2) {\nfloat y1 \x3d u_size_values[i - 1];\nsize \x3d y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nsize \x3d y2;\n}\n}\n}\n#else\nfloat size \x3d u_size;\n#endif\nreturn size + 2.0 * u_featheringSize * u_featheringOffset;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\nif (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\nreturn 0.0;\n}\nelse {\nreturn e;\n}\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d \x3d q.x - min(q.w, q.y);\nfloat e \x3d 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv \x3d rgb2hsv(rgb.xyz);\nhsv.z \x3d hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nif (currentPixel.a \x3d\x3d 0.0) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nif (pixelLocation.s \x3c onePixel.s) {\naxy[0] \x3d 1.0;\ndxy[0] \x3d 1.0;\ngxy[0] \x3d 1.0;\n}\nif (pixelLocation.t \x3c onePixel.t) {\naxy[1] \x3d 1.0;\nbxy[1] \x3d 1.0;\ncxy[1] \x3d 1.0;\n}\nif (pixelLocation.s \x3e 1.0 - onePixel.s) {\ncxy[0] \x3d -1.0;\nfxy[0] \x3d -1.0;\nixy[0] \x3d -1.0;\n}\nif (pixelLocation.t \x3e 1.0 - onePixel.t) {\ngxy[1] \x3d -1.0;\nhxy[1] \x3d -1.0;\nixy[1] \x3d -1.0;\n}\nvec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\nvec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\nvec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\nvec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\nvec4 ve \x3d texture2D(u_image, pixelLocation);\nvec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\nvec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\nvec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\nvec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\nfloat dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\nfloat dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade \x3d 0.0;\nif (u_hillshadeType \x3d\x3d 0){\nfloat cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z \x3d (u_cosZs[0] + cosDelta) / dzd;\nif (z \x3c 0.0)  z \x3d 0.0;\nhillshade \x3d z;\n} else {\nfor (int k \x3d 0; k \x3c 6; k++) {\nfloat cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z \x3d (u_cosZs[k] + cosDelta) / dzd;\nif (z \x3c 0.0) z \x3d 0.0;\nhillshade \x3d hillshade + z * u_weights[k];\nif (k \x3d\x3d 5) break;\n}\n}\nfloat alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\ngl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}"},
lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color \x3d texture2D(u_colormap, clrPosition);\nvec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}","lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\nvec4 result \x3d colorize(currentPixel, 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}"},
magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor \x3d v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle \x3d a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle \x3d 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset \x3d vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos \x3d a_pos + offset * sizePercentage * u_symbolSize;\nv_color \x3d u_colors[int(a_vv.x)];\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_position;\ngl_Position \x3d vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},
rfx:{aspect:{"aspect.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_cellSize;\nuniform vec2 u_srcImageSize;\n#include \x3craster/common/mirror.glsl\x3e\nconst float pi \x3d 3.14159265359;\nvoid main() {\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nvec4 va \x3d texture2D(u_image, mirror(v_texcoord + onePixel * axy));\nvec4 vb \x3d texture2D(u_image, mirror(v_texcoord + onePixel * bxy));\nvec4 vc \x3d texture2D(u_image, mirror(v_texcoord + onePixel * cxy));\nvec4 vd \x3d texture2D(u_image, mirror(v_texcoord + onePixel * dxy));\nvec4 ve \x3d texture2D(u_image, mirror(v_texcoord + onePixel * vec2(0, 0)));\nvec4 vf \x3d texture2D(u_image, mirror(v_texcoord + onePixel * fxy));\nvec4 vg \x3d texture2D(u_image, mirror(v_texcoord + onePixel * gxy));\nvec4 vh \x3d texture2D(u_image, mirror(v_texcoord + onePixel * hxy));\nvec4 vi \x3d texture2D(u_image, mirror(v_texcoord + onePixel * ixy));\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r / (8.0 * u_cellSize[0]);\nfloat dzy \x3d -(vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r / (8.0 * u_cellSize[1]);\nfloat alpha \x3d va.a * vb.a * vc.a * vd.a * ve.a * vf.a * vg.a * vh.a * vi.a * sign(abs(dzx) + abs(dzy));\nfloat aspect_rad \x3d (dzx \x3d\x3d 0.0) ? (step(0.0, dzy) * 0.5 * pi + step(dzy, 0.0) * 1.5 * pi) : mod((2.5 * pi + atan(dzy, -dzx)), 2.0 * pi);\nfloat aspect \x3d aspect_rad * 180.0 / pi;\ngl_FragColor \x3d vec4(aspect, aspect, aspect, 1.0) * alpha;\n}"},
bandarithmetic:{"bandarithmetic.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\nuniform float u_adjustments[3];\n#include \x3craster/common/inverse.glsl\x3e\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nvec3 pv2 \x3d u_bandIndexMat3 * pv.rgb;\nfloat nir \x3d pv2.r;\nfloat red \x3d pv2.g;\nfloat index;\n#ifdef NDXI\nindex \x3d (nir - red) * invertValue(nir + red);\n#elif defined(SR)\nindex \x3d nir * invertValue(red);\n#elif defined(CI)\nindex \x3d nir * invertValue(red) - 1.0;\n#elif defined(SAVI)\nindex \x3d (nir - red) * invertValue(nir + red + u_adjustments[0]) * (1.0 + u_adjustments[0]);\n#elif defined(TSAVI)\nfloat s \x3d u_adjustments[0];\nfloat a \x3d u_adjustments[1];\nfloat x \x3d u_adjustments[2];\nfloat y \x3d -a * s + x * (1.0 + s * s);\nindex \x3d (s * (nir - s * red - a)) * invertValue(a * nir + red + y);\n#elif defined(MAVI)\nindex \x3d 0.5 * (2.0 * (nir + 1.0) - sqrt(pow((2.0 * nir + 1.0), 2.0) - 8.0 * (nir - red)));\n#elif defined(GEMI)\nfloat eta \x3d (2.0 * (nir * nir - red * red) + 1.5 * nir + 0.5 * red) * invertValue(nir + red + 0.5);\nindex \x3d eta * (1.0 - 0.25 * eta) - (red - 0.125) * invertValue(1.0 - red);\n#elif defined(PVI)\nfloat a \x3d u_adjustments[0];\nfloat b \x3d u_adjustments[1];\nfloat y \x3d sqrt(1.0 + a * a);\nindex \x3d (nir - a * red - b) * invertValue(y);\n#elif defined(VARI)\nindex \x3d (pv2.g - pv2.r) * invertValue(pv2.g + pv2.r - pv2.b);\n#elif defined(MTVI2)\nfloat green \x3d pv2.b;\nfloat v \x3d pow(sqrt((2.0 * nir + 1.0), 2.0) - 6.0 * nir - 5.0 * sqrt(red) - 0.5);\nindex \x3d 1.5 * (1.2 * (nir - green) - 2.5 * (red - green)) * v;\n#elif defined(RTVICORE)\nfloat green \x3d pv2.b;\nindex \x3d 100.0 * (nir - red) - 10.0 * (nir - green);\n#elif defined(EVI)\nfloat blue \x3d pv2.b;\nfloat denom \x3d nir + 6.0 * red - 7.5 * blue + 1.0;\nindex \x3d  (2.5 * (nir - red)) * invertValue(denom);\n#elif defined(WNDWI)\nfloat g \x3d pv2.r;\nfloat n \x3d pv2.g;\nfloat s \x3d pv2.s;\nfloat a \x3d u_adjustments[0];\nfloat denom \x3d g + a * n + (1.0 - a) * s;\nindex \x3d (g - a * n - (1 - a) * s) * invertValue(denom);\n#elif defined(BAI)\nindex \x3d invertValue(pow((0.1 - red), 2.0) + pow((0.06 - nir), 2.0));\n#else\ngl_FragColor \x3d pv;\nreturn;\n#endif\ngl_FragColor \x3d vec4(index, index, index, pv.a);\n}"},
compositeband:{"compositeband.frag":"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nuniform sampler2D u_image2;\nvarying vec2 v_texcoord;\nvoid main() {\nvec4 p0 \x3d texture2D(u_image, v_texcoord);\nvec4 p1 \x3d texture2D(u_image1, v_texcoord);\nvec4 p2 \x3d texture2D(u_image2, v_texcoord);\ngl_FragColor \x3d vec4(p0.r, p1.r, p2.r, p0.a * p1.a * p2.a);\n}"},convolution:{"convolution.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_srcImageSize;\n#define KERNEL_SIZE_ROWS ROWS\n#define KERNEL_SIZE_COLS COLS\nuniform vec2 u_clampRange;\nuniform float u_kernel[25];\n#include \x3craster/common/mirror.glsl\x3e\nvoid main() {\nvec3 rgb \x3d vec3(0.0, 0.0, 0.0);\nvec2 resolution \x3d 1.0 / u_srcImageSize;\nfloat rowOffset \x3d -float(floor(float(KERNEL_SIZE_ROWS) / 2.0));\nfloat colOffset \x3d -float(floor(float(KERNEL_SIZE_COLS) / 2.0));\nfloat alpha \x3d 1.0;\nfor (int row \x3d 0; row \x3c KERNEL_SIZE_ROWS; row++) {\nfloat pos_row \x3d rowOffset + float(row);\nfor (int col \x3d 0; col \x3c KERNEL_SIZE_COLS; col++) {\nvec2 pos \x3d v_texcoord + vec2(colOffset + float(col), pos_row) * resolution;\nvec4 pv \x3d texture2D(u_image, mirror(pos));\nrgb +\x3d pv.rgb * u_kernel[row * KERNEL_SIZE_COLS + col];\nalpha *\x3d pv.a;\n}\n}\nrgb \x3d clamp(rgb, u_clampRange.s, u_clampRange.t);\ngl_FragColor \x3d vec4(rgb * alpha, alpha);\n}"},
extractband:{"extractband.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nvec3 pv2 \x3d u_bandIndexMat3 * pv.rgb;\ngl_FragColor \x3d vec4(pv2, pv.a);\n}"},local:{"local.frag":"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\n#ifdef ONE_CONSTANT\nuniform float u_image1Const;\n#ifdef TWO_CONSTANT\nuniform float u_image2Const;\n#endif\nuniform mat3 u_imageSwap;\n#endif\nvarying vec2 v_texcoord;\nuniform vec2 u_domainRange;\n#include \x3craster/common/inverse.glsl\x3e\nvoid main() {\nvec4 pv0 \x3d texture2D(u_image, v_texcoord);\nfloat a \x3d pv0.r;\n#ifdef TWO_IMAGES\n#ifdef ONE_CONSTANT\nfloat b \x3d u_image1Const;\nvec3 abc \x3d u_imageSwap * vec3(a, b, 0);\na \x3d abc.s;\nb \x3d abc.t;\n#else\nvec4 pv1 \x3d texture2D(u_image1, v_texcoord);\nfloat b \x3d pv1.r;\n#endif\n#elif defined(CONDITIONAL)\n#ifdef TWO_CONSTANT\nfloat b \x3d u_image1Const;\nfloat c \x3d u_image2Const;\nvec3 abc \x3d u_imageSwap * vec3(a, b, c);\na \x3d abc.s;\nb \x3d abc.t;\nc \x3d abc.p;\n#elif defined(ONE_CONSTANT)\nvec4 pv1 \x3d texture2D(u_image1, v_texcoord);\nfloat b \x3d pv1.r;\nfloat c \x3d u_image1Const;\nvec3 abc \x3d u_imageSwap * vec3(a, b, c);\na \x3d abc.s;\nb \x3d abc.t;\nc \x3d abc.p;\n#else\nvec4 pv1 \x3d texture2D(u_image1, v_texcoord);\nvec4 pv2 \x3d texture2D(u_image2, v_texcoord);\nfloat b \x3d pv1.r;\nfloat c \x3d pv2.r;\n#endif\n#endif\nfloat result \x3d a;\nfloat alpha \x3d pv0.a;\n#ifdef PLUS\nresult \x3d a + b;\n#elif defined(MINUS)\nresult \x3d a - b;\n#elif defined(TIMES)\nresult \x3d a * b;\n#elif defined(DIVIDE)\nresult \x3d a * invertValue(b);\nalpha *\x3d float(abs(sign(b)));\n#elif defined(FLOATDIVIDE)\nresult \x3d a * invertValue(b);\nalpha *\x3d float(abs(sign(b)));\n#elif defined(FLOORDIVIDE)\nresult \x3d floor(a * invertValue(b));\nalpha *\x3d float(abs(sign(b)));\n#elif defined(SQUARE)\nresult \x3d a * a;\n#elif defined(SQRT)\nresult \x3d sqrt(a);\n#elif defined(POWER)\nresult \x3d pow(a, b);\n#elif defined(LN)\nresult \x3d a \x3c\x3d 0.0 ? 0.0: log(a);\nalpha *\x3d float(a \x3e 0.0);\n#elif defined(LOG_1_0)\nresult \x3d a \x3c\x3d 0.0 ? 0.0: log2(a) * invertValue(log2(10.0));\nalpha *\x3d float(a \x3e 0.0);\n#elif defined(LOG_2)\nresult \x3d a \x3c\x3d 0.0 ? 0.0: log2(a);\nalpha *\x3d float(a \x3e 0.0);\n#elif defined(EXP)\nresult \x3d exp(a);\n#elif defined(EXP_1_0)\nresult \x3d pow(10.0, a);\n#elif defined(EXP_2)\nresult \x3d pow(2.0, a);\n#elif defined(ROUNDDOWN)\nresult \x3d floor(a);\n#elif defined(ROUNDUP)\nresult \x3d ceil(a);\n#elif defined(INT)\nresult \x3d float(sign(a)) * floor(abs(a));\n#elif defined(MOD)\nresult \x3d mod(a, b);\n#elif defined(NEGATE)\nresult \x3d -a;\n#elif defined(ABS)\nresult \x3d abs(a);\n#elif defined(ACOS)\nresult \x3d abs(a) \x3e 1.0 ? 0.0: acos(a);\nalpha *\x3d step(abs(a), 1.00001);\n#elif defined(ACOSH)\nresult \x3d acosh(a);\n#elif defined(POLYFILLACOSH)\nresult \x3d log(a + sqrt(a * a - 1.0));\n#elif defined(ASIN)\nresult \x3d abs(a) \x3e 1.0 ? 0.0: asin(a);\nalpha *\x3d step(abs(a), 1.00001);\n#elif defined(ASINH)\nresult \x3d asinh(a);\n#elif defined(POLYFILLASINH)\nresult \x3d log(a + sqrt(a * a + 1.0));\n#elif defined(ATAN)\nresult \x3d atan(a);\n#elif defined(ATANH)\nresult \x3d abs(a) \x3e 1.0 ? 0.0: atanh(a);\nalpha *\x3d step(abs(a), 1.0);\n#elif defined(POLYFILLATANH)\nresult \x3d a \x3d\x3d 1.0 ? 0.0 : 0.5 * log((1.0 + a)/(1.0 -a));\n#elif defined(ATAN_2)\nresult \x3d atan(a, b);\n#elif defined(COS)\nresult \x3d cos(a);\n#elif defined(COSH)\nresult \x3d cosh(a);\n#elif defined(POLYFILLCOSH)\nfloat halfexp \x3d exp(a) / 2.0;\nresult \x3d halfexp + 1.0 / halfexp;\n#elif defined(SIN)\nresult \x3d sin(a);\n#elif defined(SINH)\nresult \x3d sinh(a);\n#elif defined(POLYFILLSINH)\nfloat halfexp \x3d exp(a) / 2.0;\nresult \x3d halfexp - 1.0 / halfexp;\n#elif defined(TAN)\nresult \x3d tan(a);\n#elif defined(TANH)\nresult \x3d tanh(a);\n#elif defined(POLYFILLTANH)\nfloat expx \x3d exp(a);\nresult \x3d (expx - 1.0 / expx) / (expx + 1.0 / expx);\n#elif defined(BITWISEAND)\nresult \x3d a \x26 b;\n#elif defined(BITWISEOR)\nresult \x3d a | b;\n#elif defined(BITWISELEFTSHIFT)\nresult \x3d a \x3c\x3c b;\n#elif defined(BITWISERIGHTSHIFT)\nresult \x3d a \x3e\x3e b;\n#elif defined(BITWISENOT)\nresult \x3d ~a;\n#elif defined(BITWISEXOR)\nresult \x3d a ^ b;\n#elif defined(BOOLEANAND)\nresult \x3d float((a !\x3d 0.0) \x26\x26 (b !\x3d 0.0));\n#elif defined(BOOLEANNOT)\nresult \x3d float(a \x3d\x3d 0.0);\n#elif defined(BOOLEANOR)\nresult \x3d float((a !\x3d 0.0) || (b !\x3d 0.0));\n#elif defined(BOOLEANXOR)\nresult \x3d float((a !\x3d 0.0) ^^ (b !\x3d 0.0));\n#elif defined(GREATERTHAN)\nresult \x3d float(a \x3e b);\n#elif defined(GREATERTHANEQUAL)\nresult \x3d float(a \x3e\x3d b);\n#elif defined(LESSTHAN)\nresult \x3d float(a \x3c b);\n#elif defined(LESSTHANEQUAL)\nresult \x3d float(a \x3c\x3d b);\n#elif defined(EQUALTO)\nresult \x3d float(a \x3d\x3d b);\n#elif defined(NOTEQUAL)\nresult \x3d float(a !\x3d b);\n#elif defined(ISNULL)\nresult \x3d float(alpha \x3d\x3d 0.0);\nalpha \x3d 1.0;\n#elif defined(SETNULL)\nfloat maskValue \x3d float(a \x3d\x3d 0.0);\nresult \x3d maskValue * b;\nalpha *\x3d maskValue;\n#elif defined(CONDITIONAL)\nfloat weight \x3d float(abs(sign(a)));\nresult \x3d weight * b + (1.0 - weight) * c;\n#endif\nbool isInvalid \x3d result \x3c u_domainRange.s || result \x3e u_domainRange.t;\nresult \x3d isInvalid ? 0.0 : result;\nalpha *\x3d float(!isInvalid);\n#ifdef ROUND_OUTPUT\nresult \x3d floor(result + 0.5);\n#endif\ngl_FragColor \x3d vec4(result, result, result, alpha);\n}"},
mask:{"mask.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#define LEN_INCLUDED_RANGES 6\n#define LEN_NODATA_VALUES 6\nuniform highp float u_includedRanges[6];\nuniform highp float u_noDataValues[6];\nfloat maskFactor(float bandValue, float fromValue, float to) {\nfloat factor \x3d 1.0;\nfor (int i \x3d 0; i \x3c LEN_NODATA_VALUES; i++) {\nfactor *\x3d float(u_noDataValues[i] !\x3d bandValue);\n}\nfactor *\x3d step(fromValue, bandValue) * step(bandValue, to);\nreturn factor;\n}\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nfloat redFactor \x3d maskFactor(pv.r, u_includedRanges[0], u_includedRanges[1]);\n#ifdef MULTI_BAND\nfloat greenFactor \x3d maskFactor(pv.g, u_includedRanges[2], u_includedRanges[3]);\nfloat blueFactor \x3d maskFactor(pv.b, u_includedRanges[4], u_includedRanges[5]);\nfloat maskFactor \x3d redFactor * greenFactor * blueFactor;\ngl_FragColor \x3d pv * maskFactor;\n#else\ngl_FragColor \x3d pv * redFactor;\n#endif\n}"},
ndvi:{"ndvi.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\n#include \x3craster/common/inverse.glsl\x3e\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nvec3 pv2 \x3d u_bandIndexMat3 * pv.rgb;\nfloat nir \x3d pv2.r;\nfloat red \x3d pv2.g;\nfloat index \x3d (nir - red) * invertValue(nir + red);\n#ifdef SCALED\nindex \x3d floor((index + 1.0) * 100.0 + 0.5);\n#endif\ngl_FragColor \x3d vec4(index, index, index, pv.a);\n}"},
remap:{"remap.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#define LEN_REMAP_RANGES 18\n#define LEN_NODATA_RANGES 12\nuniform highp float u_rangeMaps[18];\nuniform highp float u_noDataRanges[12];\nuniform highp float u_unmatchMask;\nuniform vec2 u_clampRange;\nvoid main() {\nvec4 pv \x3d texture2D(u_image, v_texcoord);\nfloat factor \x3d 1.0;\nfloat bandValue \x3d pv.r;\nfor (int i \x3d 0; i \x3c LEN_NODATA_RANGES; i+\x3d2) {\nfloat inside \x3d 1.0 - step(u_noDataRanges[i], bandValue) * step(bandValue, u_noDataRanges[i+1]);\nfactor *\x3d inside;\n}\nfloat mapValue \x3d 0.0;\nfloat includeMask \x3d 0.0;\nfor (int i \x3d 0; i \x3c LEN_REMAP_RANGES; i+\x3d3) {\nfloat stepMask \x3d step(u_rangeMaps[i], bandValue) * step(bandValue, u_rangeMaps[i+1]);\nincludeMask \x3d (1.0 - stepMask) * includeMask + stepMask;\nmapValue \x3d (1.0 - stepMask) * mapValue + stepMask * u_rangeMaps[i+2];\n}\nbandValue \x3d factor * (mapValue + (1.0 - includeMask) * u_unmatchMask * pv.r);\nfloat bandMask \x3d factor * max(u_unmatchMask, includeMask);\nbandValue \x3d clamp(bandValue, u_clampRange.s, u_clampRange.t);\ngl_FragColor \x3d vec4(bandValue, bandValue, bandValue, bandMask * pv.a);\n}"},
slope:{"slope.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_cellSize;\nuniform float u_zFactor;\nuniform vec2 u_srcImageSize;\nuniform float u_pixelSizePower;\nuniform float u_pixelSizeFactor;\n#include \x3craster/common/mirror.glsl\x3e\nvoid main() {\nvec2 axy \x3d vec2(-1.0, -1.0);\nvec2 bxy \x3d vec2(0.0, -1.0);\nvec2 cxy \x3d vec2(1.0, -1.0);\nvec2 dxy \x3d vec2(-1.0, 0.0);\nvec2 fxy \x3d vec2(1.0, 0.0);\nvec2 gxy \x3d vec2(-1.0, 1.0);\nvec2 hxy \x3d vec2(0.0, 1.0);\nvec2 ixy \x3d vec2(1.0, 1.0);\nvec2 onePixel \x3d 1.0 / u_srcImageSize;\nvec4 va \x3d texture2D(u_image, mirror(v_texcoord + onePixel * axy));\nvec4 vb \x3d texture2D(u_image, mirror(v_texcoord + onePixel * bxy));\nvec4 vc \x3d texture2D(u_image, mirror(v_texcoord + onePixel * cxy));\nvec4 vd \x3d texture2D(u_image, mirror(v_texcoord + onePixel * dxy));\nvec4 ve \x3d texture2D(u_image, mirror(v_texcoord + onePixel * vec2(0, 0)));\nvec4 vf \x3d texture2D(u_image, mirror(v_texcoord + onePixel * fxy));\nvec4 vg \x3d texture2D(u_image, mirror(v_texcoord + onePixel * gxy));\nvec4 vh \x3d texture2D(u_image, mirror(v_texcoord + onePixel * hxy));\nvec4 vi \x3d texture2D(u_image, mirror(v_texcoord + onePixel * ixy));\nfloat xf \x3d (u_zFactor + pow(u_cellSize[0], u_pixelSizePower) * u_pixelSizeFactor) / (8.0 * u_cellSize[0]);\nfloat yf \x3d (u_zFactor + pow(u_cellSize[1], u_pixelSizePower) * u_pixelSizeFactor) / (8.0 * u_cellSize[1]);\nfloat dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * xf;\nfloat dzy \x3d -(vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * yf;\nfloat alpha \x3d va.a * vb.a * vc.a * vd.a * ve.a * vf.a * vg.a * vh.a * vi.a;\nfloat rise2run \x3d sqrt(dzx * dzx + dzy * dzy);\n#ifdef PERCENT_RISE\nfloat percentRise \x3d rise2run * 100.0;\ngl_FragColor \x3d vec4(percentRise, percentRise, percentRise, alpha);\n#else\nfloat degree \x3d atan(rise2run) * 57.2957795;\ngl_FragColor \x3d vec4(degree, degree, degree, alpha);\n#endif\n}"},
stretch:{"stretch.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying highp vec2 v_texcoord;\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, float gamma, float gammaCorrection) {\nval \x3d clamp(val, minCutOff, maxCutOff);\nfloat stretchedVal;\n#ifdef USE_GAMMA\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\ntempf -\x3d step(1.0, gamma) * sign(gamma - 1.0) * pow(1.0 / outRange, relativeVal * gammaCorrection);\nstretchedVal \x3d tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput;\nstretchedVal \x3d clamp(stretchedVal, minOutput, maxOutput);\n#else\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n#endif\n#ifdef ROUND_OUTPUT\nstretchedVal \x3d floor(stretchedVal + 0.5);\n#endif\nreturn stretchedVal;\n}\nvoid main() {\nvec4 currentPixel \x3d texture2D(u_image, v_texcoord);\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_gamma[0], u_gammaCorrection[0]);\n#ifdef MULTI_BAND\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n#else\ngl_FragColor \x3d vec4(redVal, redVal, redVal, currentPixel.a);\n#endif\n}"},
vs:{"vs.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord \x3d a_pos;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor \x3d vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize \x3d 0.02;\nconst float innerRadius \x3d 0.25;\nconst float outerRadius \x3d 0.42;\nconst float innerSquareLength \x3d 0.15;\nvoid main() {\nmediump float dist \x3d length(v_pos);\nmediump float fillalpha1 \x3d smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *\x3d (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 \x3d smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *\x3d (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 \x3d (abs(v_pos.x) \x3c innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) \x3c innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor \x3d (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}",
"scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage \x3d clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio \x3d u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage \x3d clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage \x3d (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size \x3d u_symbolSize * sizePercentage;\nvec2 pos \x3d a_pos + a_offset * size;\nv_pos \x3d a_offset;\ngl_Position \x3d vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val \x3e\x3d maxCutOff) {\nreturn maxOutput;\n} else if (val \x3c\x3d minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf \x3d 1.0;\nfloat outRange \x3d maxOutput - minOutput;\nfloat relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma \x3e 1.0) {\ntempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal \x3d minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation \x3d getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount \x3d\x3d 1) {\nfloat grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}"}},
stencil:{"stencil.frag":"void main() {\ngl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nuniform mat3 u_worldExtent;\nvoid main() {\ngl_Position \x3d vec4(u_worldExtent * vec3(a_pos, 1.0), 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\ngl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\nv_tex \x3d a_pos;\n}"},
util:{"atan2.glsl":"float atan2(in float y, in float x) {\nfloat t0, t1, t2, t3, t4;\nt3 \x3d abs(x);\nt1 \x3d abs(y);\nt0 \x3d max(t3, t1);\nt1 \x3d min(t3, t1);\nt3 \x3d 1.0 / t0;\nt3 \x3d t1 * t3;\nt4 \x3d t3 * t3;\nt0 \x3d         - 0.013480470;\nt0 \x3d t0 * t4 + 0.057477314;\nt0 \x3d t0 * t4 - 0.121239071;\nt0 \x3d t0 * t4 + 0.195635925;\nt0 \x3d t0 * t4 - 0.332994597;\nt0 \x3d t0 * t4 + 0.999995630;\nt3 \x3d t0 * t3;\nt3 \x3d (abs(y) \x3e abs(x)) ? 1.570796327 - t3 : t3;\nt3 \x3d x \x3c 0.0 ?  3.141592654 - t3 : t3;\nt3 \x3d y \x3c 0.0 ? -t3 : t3;\nreturn t3;\n}",
"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/BrushOverlay":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../Utils ./WGLBrush ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t){return function(p){function g(){var d=
f.apply(this,arguments);d._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])};return d}l._inherits(g,p);var f=l._createSuper(g);p=g.prototype;p.dispose=function(){};p.prepareState=function({context:d}){d.setBlendingEnabled(!0);d.setColorMask(!0,!0,!0,!0);d.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA,t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA);d.setStencilWriteMask(0);d.setStencilTestEnabled(!0);d.setStencilFunction(t.CompareFunction.GREATER,
255,255)};p.draw=function(d,b){const {context:a,painter:e,requestRender:c,allowDelayedRender:m}=d;if(b.isReady){var {computedOpacity:k,dvsMat3:n,isWrapAround:x,perspectiveTransform:q,texture:B}=b;d.timeline.begin(this.name);var y=e.materialManager.getProgram(this._desc);if(m&&h.isSome(c)&&!y.compiled)c();else{var u=E.createProgramDescriptor("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:t.DataType.FLOAT}],tex:[{location:1,name:"a_uv",count:2,type:t.DataType.UNSIGNED_SHORT}]});if(b=b.getVAO(a,
u.bufferLayouts,u.attributes))a.bindVAO(b),a.useProgram(y),a.bindTexture(B,D.TEXTURE_BINDING_BITMAP),y.setUniformMatrix3fv("u_dvsMat3",n),y.setUniform1i("u_texture",D.TEXTURE_BINDING_BITMAP),y.setUniform1f("u_opacity",k),y.setUniform2fv("u_perspective",q),a.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,x?10:4),a.bindVAO(),d.timeline.end(this.name)}}};return l._createClass(g)}(w)})},"esri/views/2d/engine/webgl/brushes/WGLBrushDotDensity":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../core/RandomLCG ../definitions ../enums ./WGLGeometryBrushFill ../techniques/utils ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/Renderbuffer ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e){return function(c){function m(){var n=k.apply(this,arguments);n._dotTextureSize=0;n._dotTextures=null;n._dotSamplers=new Int32Array([E.TEXTURE_BINDING_RENDERER_0,E.TEXTURE_BINDING_RENDERER_1]);n._dotVAO=null;n._dotDesc={vsPath:"dot/dot",fsPath:"dot/dot",attributes:new Map([["a_pos",0]])};return n}l._inherits(m,c);var k=l._createSuper(m);c=m.prototype;c.dispose=function(){l._get(l._getPrototypeOf(m.prototype),"dispose",this).call(this);this._disposeTextures();this._dotFBO=
h.disposeMaybe(this._dotFBO);this._dotVAO=h.disposeMaybe(this._dotVAO)};c.getGeometryType=function(){return w.WGLGeometryType.FILL};c.supportsSymbology=function(n){return n===w.WGLSymbologyType.DOT_DENSITY};c._drawFills=function(n,x,q,B,y,u){const {passOptions:v}=n;h.isSome(v)&&"hittest"===v.type?l._get(l._getPrototypeOf(m.prototype),"_drawFills",this).call(this,n,x,q,B,y,u):(q=this._drawDotLocations(n,x,q,y,u),this._drawDotDensity(n,x,q))};c._drawDotDensity=function(n,x,q){const {context:B,painter:y,
rendererInfo:u,requestRender:v,allowDelayedRender:r}=n,z=y.materialManager.getProgram(this._dotDesc);if(r&&h.isSome(v)&&!z.compiled)v();else{var {rendererSchema:A}=u;p.assertRendererSchema(A,"dot-density");var C=this._createDotDensityMesh(B,this._dotDesc.attributes,{geometry:[{name:"a_pos",count:2,type:f.DataType.SHORT,divisor:0,normalized:!1,offset:0,stride:4}]});B.setStencilTestEnabled(!0);B.useProgram(z);z.setUniform1f("u_tileZoomFactor",1);z.setUniform1i("u_texture",this._dotSamplers[0]);z.setUniform1f("u_dotSize",
Math.max(A.dotSize,1));z.setUniform1f("u_pixelRatio",window.devicePixelRatio);this._setSharedUniforms(z,n,x);B.bindTexture(q,this._dotSamplers[0]);B.bindVAO(C);B.drawArrays(f.PrimitiveType.POINTS,0,262144)}};c._drawDotLocations=function(n,x,q,B,y){const {context:u,rendererInfo:v,requiredLevel:r}=n,z=u.getViewport();var {rendererSchema:A}=v;p.assertRendererSchema(A,"dot-density");const {dotScale:C,colors:F,activeDots:G,backgroundColor:H,dotValue:K}=A;u.setViewport(0,0,512,512);A=u.getBoundFramebufferObject();
const J=this._createFBO(u);u.bindFramebuffer(J);u.setClearColor(0,0,0,0);u.clear(u.gl.COLOR_BUFFER_BIT|u.gl.STENCIL_BUFFER_BIT);u.setStencilTestEnabled(!1);x=1/2**(r-x.key.level);const N=E.TILE_SIZE,P=N*window.devicePixelRatio*N*window.devicePixelRatio,W=1/x*(1/x);n=C?n.state.scale/C:1;q.setUniform1f("u_tileZoomFactor",x);q.setUniform1f("u_tileDotsOverArea",P/(E.TILE_SIZE*window.devicePixelRatio*E.TILE_SIZE*window.devicePixelRatio));q.setUniformMatrix4fv("u_dotColors",F);q.setUniform4fv("u_isActive",
G);q.setUniform4fv("u_dotBackgroundColor",H);q.setUniform1f("u_dotValue",Math.max(1,K*n*W));this._bindDotDensityTextures(u,q,v,N);u.drawElements(f.PrimitiveType.TRIANGLES,B,f.DataType.UNSIGNED_INT,y);u.setViewport(z.x,z.y,z.width,z.height);u.bindFramebuffer(A);return J.colorTexture};c._createFBO=function(n){if(h.isNone(this._dotFBO)){const x={target:f.TextureType.TEXTURE_2D,pixelFormat:f.PixelFormat.RGBA,dataType:f.PixelType.UNSIGNED_BYTE,samplingMode:f.TextureSamplingMode.NEAREST,wrapMode:f.TextureWrapMode.CLAMP_TO_EDGE,
width:512,height:512},q={colorTarget:f.TargetType.TEXTURE,depthStencilTarget:f.DepthStencilTargetType.DEPTH_STENCIL_RENDER_BUFFER},B=new b.Renderbuffer(n,{width:512,height:512,internalFormat:f.RenderbufferFormat.DEPTH_STENCIL});this._dotFBO=new d.FramebufferObject(n,q,x,B)}return this._dotFBO};c._disposeTextures=function(){if(this._dotTextures){for(let n=0;n<this._dotTextures.length;n++)this._dotTextures[n].dispose();this._dotTextures=null}};c._bindDotDensityTextures=function(n,x,q,B){({rendererSchema:q}=
q);p.assertRendererSchema(q,"dot-density");B=this._createDotDensityTextures(n,B,q.seed);x.setUniform1iv("u_dotTextures",this._dotSamplers);for(x=0;x<B.length;x++)n.bindTexture(B[x],this._dotSamplers[x])};c._createDotDensityMesh=function(n,x,q){if(h.isNone(this._dotVAO)){var B=new Int16Array(524288);for(let y=0;512>y;y++)for(let u=0;512>u;u++)B[2*(u+512*y)]=u,B[2*(u+512*y)+1]=y;B=g.BufferObject.createVertex(n,f.Usage.STATIC_DRAW,B);this._dotVAO=new e.VertexArrayObject(n,x,q,{geometry:B},null)}return this._dotVAO};
c._createDotDensityTextures=function(n,x,q){if(this._dotTextureSize!==x||this._seed!==q)this._disposeTextures(),this._dotTextureSize=x,this._seed=q;null===this._dotTextures&&(q=new D(q),this._dotTextures=[this._allocDotDensityTexture(n,x,q),this._allocDotDensityTexture(n,x,q)]);return this._dotTextures};c._allocDotDensityTexture=function(n,x,q){const B=new Float32Array(x*x*4);for(let y=0;y<B.length;y++)B[y]=q.getFloat();return new a.Texture(n,{wrapMode:f.TextureWrapMode.REPEAT,pixelFormat:f.PixelFormat.RGBA,
dataType:f.PixelType.FLOAT,samplingMode:f.TextureSamplingMode.NEAREST,width:x,height:x},B)};return l._createClass(m)}(t)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t,p,g){return function(f){function d(){return b.apply(this,arguments)}l._inherits(d,f);
var b=l._createSuper(d);f=d.prototype;f.dispose=function(){};f.getGeometryType=function(){return D.WGLGeometryType.FILL};f.supportsSymbology=function(a){return a!==D.WGLSymbologyType.DOT_DENSITY};f.drawGeometry=function(a,e,c,m){const {context:k,painter:n,rendererInfo:x,requiredLevel:q,passOptions:B,requestRender:y,allowDelayedRender:u}=a;var v=t.FillMaterialKey.load(c.materialKey),r=p.getTechniqueFromMaterialKey(v.data);const z=h.isSome(B)&&"hittest"===B.type;var A=n.materialManager,C=h.unwrapOr;
r=r.programSpec;const F={geometry:[{location:0,name:"a_pos",count:2,type:g.DataType.SHORT},{location:1,name:"a_id",count:3,type:g.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:g.DataType.UNSIGNED_BYTE},{location:3,name:"a_color",count:4,type:g.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:g.DataType.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:g.DataType.SHORT},{location:6,name:"a_aux3",count:4,type:g.DataType.UNSIGNED_BYTE},{location:7,
name:"a_zoomRange",count:2,type:g.DataType.UNSIGNED_SHORT}]};switch(v.symbologyType){case D.WGLSymbologyType.SIMPLE:case D.WGLSymbologyType.OUTLINE_FILL_SIMPLE:F.geometry.splice(7,1),F.geometry.splice(4,1)}const {shader:G,vertexLayout:H,hittestAttributes:K}=C.call(h,r,{shader:"materials/fill",vertexLayout:F});C=g.PrimitiveType.TRIANGLES;r=E.createProgramDescriptor(v.data,H);z&&(r=this._getTriangleDesc(c.materialKey,r,K),C=g.PrimitiveType.POINTS);const {attributes:J,bufferLayouts:N}=r;m=A.getMaterialProgram(a,
v,G,J,m);u&&h.isSome(y)&&!m.compiled?y():(k.useProgram(m),this._setSharedUniforms(m,a,e),m.setUniform2f("u_tileOffset",512*e.key.col,512*e.key.row),v.textureBinding&&(n.textureManager.bindTextures(k,m,v),m.setUniform1f("u_zoomFactor",1/2**(q-e.key.level))),A=1/a.pixelRatio,m.setUniform1f("u_blur",A),m.setUniform1f("u_antialiasing",A),this._setSizeVVUniforms(v,m,x,e),this._setColorAndOpacityVVUniforms(v,m,x),v=c.target.getVAO(k,N,J,z),A=c.indexCount,c=c.indexFrom*Uint32Array.BYTES_PER_ELEMENT,z&&(A/=
3,c/=3),k.bindVAO(v),this._drawFills(a,e,m,C,A,c))};f._drawFills=function(a,e,c,m,k,n){a.context.drawElements(m,k,g.DataType.UNSIGNED_INT,n)};return l._createClass(d)}(w)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./WGLBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t){return function(p){function g(){var d=f.apply(this,arguments);d._computeDesc=
new Map;return d}l._inherits(g,p);var f=l._createSuper(g);p=g.prototype;p.prepareState=function({context:d},b){b&&b.includes("hittest")?d.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE,t.BlendFactor.ONE,t.BlendFactor.ONE):d.setBlendFunctionSeparate(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA,t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA);d.setBlendingEnabled(!0);d.setColorMask(!0,!0,!0,!0);d.setStencilWriteMask(0);d.setStencilTestEnabled(!0)};p.draw=function(d,b,a){var e=
this.getGeometryType();b.commit(d);e=b.getGeometry(e);h.isNone(e)||(d.timeline.begin(this.name),d.attributeView.bindTextures(d.context),d.context.setStencilFunction(t.CompareFunction.EQUAL,b.stencilRef,255),e.forEachCommand(c=>{const m=w.MaterialKeyBase.load(c.materialKey).symbologyType;this.supportsSymbology(m)&&this.drawGeometry(d,b,c,a)}))};p._setSharedUniforms=function(d,b,a){const {displayLevel:e,pixelRatio:c,state:m,passOptions:k}=b;h.isSome(k)&&"hittest"===k.type&&(d.setUniform2fv("u_hittestPos",
k.position),d.setUniform1f("u_hittestDist",k.distance));d.setUniform1f("u_pixelRatio",c);d.setUniformMatrix3fv("u_tileMat3",a.transforms.tileMat3);d.setUniformMatrix3fv("u_viewMat3",m.viewMat3);d.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);d.setUniformMatrix3fv("u_displayViewMat3",m.displayViewMat3);d.setUniform1f("u_currentZoom",Math.round(e*D.MIN_MAX_ZOOM_PRECISION_FACTOR));d.setUniform1i("u_attributeTextureSize",b.attributeView.size);d.setUniform1i("u_attributeData0",D.TEXTURE_BINDING_ATTRIBUTE_DATA_0);
d.setUniform1i("u_attributeData1",D.TEXTURE_BINDING_ATTRIBUTE_DATA_1);d.setUniform1i("u_attributeData2",D.TEXTURE_BINDING_ATTRIBUTE_DATA_2);d.setUniform1i("u_attributeData3",D.TEXTURE_BINDING_ATTRIBUTE_DATA_3);d.setUniform1i("u_attributeData4",D.TEXTURE_BINDING_ATTRIBUTE_DATA_4);d.setUniform1i("u_attributeData5",D.TEXTURE_BINDING_ATTRIBUTE_DATA_5)};p._setSizeVVUniforms=function(d,b,a,e){d.vvSizeMinMaxValue&&b.setUniform4fv("u_vvSizeMinMaxValue",a.vvSizeMinMaxValue);d.vvSizeScaleStops&&b.setUniform1f("u_vvSizeScaleStopsValue",
a.vvSizeScaleStopsValue);d.vvSizeFieldStops&&(e=a.getSizeVVFieldStops(e.key.level),null!=e&&(b.setUniform1fv("u_vvSizeFieldStopsValues",e.values),b.setUniform1fv("u_vvSizeFieldStopsSizes",e.sizes)));d.vvSizeUnitValue&&b.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",a.vvSizeUnitValueToPixelsRatio)};p._setColorAndOpacityVVUniforms=function(d,b,a){d.vvColor&&(b.setUniform1fv("u_vvColorValues",a.vvColorValues),b.setUniform4fv("u_vvColors",a.vvColors));d.vvOpacity&&(b.setUniform1fv("u_vvOpacityValues",
a.vvOpacityValues),b.setUniform1fv("u_vvOpacities",a.vvOpacities))};p._setRotationVVUniforms=function(d,b,a){d.vvRotation&&b.setUniform1f("u_vvRotationType","geographic"===a.vvMaterialParameters.vvRotationType?0:1)};p._getTriangleDesc=function(d,b,a=["a_pos"]){const e=b.bufferLayouts.geometry;a=a.map(k=>e.findIndex(n=>n.name===k));d=`${d}-${a.join("-")}`;var c=this._computeDesc.get(d);if(!c){c=b.strides;const k=b.strides.geometry,n=new Map(b.attributes);var m=e.map(q=>({...q}));b=Math.max(...b.attributes.values());
m={geometry:m};let x=0;for(const q of a)a=e[q],m.geometry.push({count:a.count,name:a.name+"1",divisor:a.divisor,normalized:a.normalized,offset:k+a.offset,stride:k,type:a.type}),m.geometry.push({count:a.count,name:a.name+"2",divisor:a.divisor,normalized:a.normalized,offset:2*k+a.offset,stride:k,type:a.type}),n.set(a.name+"1",b+ ++x),n.set(a.name+"2",b+ ++x);c={bufferLayouts:m,attributes:n,strides:c};this._computeDesc.set(d,c)}return c};return l._createClass(g)}(E)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../alignmentUtils","../enums"],function(l,h,D,E,w){function t(q){return q===w.WGLSymbologyType.SIMPLE||q===w.WGLSymbologyType.OUTLINE_FILL_SIMPLE}function p(q){return q===w.WGLSymbologyType.OUTLINE_FILL||q===w.WGLSymbologyType.OUTLINE_FILL_SIMPLE}const g=Object.keys(w.WGLSymbologyType).filter(q=>"number"===typeof w.WGLSymbologyType[q]).reduce((q,B)=>({...q,[B]:w.WGLSymbologyType[B]}),{});let f=function(){function q(y){this._data=
0;this._data=y}q.load=function(y){const u=this.shared;u.data=y;return u};var B=q.prototype;B.setBit=function(y,u){y=1<<y;this._data=u?this._data|y:this._data&~y};B.bit=function(y){return(this._data&1<<y)>>y};B.setBits=function(y,u,v){for(let r=u,z=0;r<v;r++,z++)this.setBit(r,0!==(y&1<<z))};B.bits=function(y,u){let v=0;for(let r=y,z=0;r<u;r++,z++)v|=this.bit(r)<<z;return v};B.hasVV=function(){return!1};B.setVV=function(y,u){};B.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,
sdf:this.sdf,symbologyType:{value:w.WGLSymbologyType[this.symbologyType],options:g,namespace:"SYMBOLOGY_TYPE"}}};B.getVariationHash=function(){return this._data&~(7&this.textureBinding)};h._createClass(q,[{key:"data",get:function(){return this._data},set:function(y){this._data=y??0}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(y){this.setBits(y,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(y){this.setBit(20,y)}},{key:"sdf",get:function(){return!!this.bit(11)},
set:function(y){this.setBit(11,y??!1)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(y){this.setBit(12,y)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(y){this.setBits(y,0,8)}},{key:"symbologyType",get:function(){return this.bits(21,26)},set:function(y){this.setBits(y,21,26)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case w.WGLGeometryType.FILL:return"fill";case w.WGLGeometryType.MARKER:return"marker";case w.WGLGeometryType.LINE:return"line";
case w.WGLGeometryType.TEXT:return"text";case w.WGLGeometryType.LABEL:return"label";default:throw new D(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return q}();f.shared=new f(0);const d=q=>function(B){function y(){return u.apply(this,arguments)}h._inherits(y,B);var u=h._createSuper(y);B=y.prototype;B.hasSizeVV=function(){return this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};B.hasVV=function(){return h._get(h._getPrototypeOf(y.prototype),
"hasVV",this).call(this)||this.hasSizeVV()};B.setVV=function(v,r){h._get(h._getPrototypeOf(y.prototype),"setVV",this).call(this,v,r);{var z=this.geometryType;const A=w.WGLVVFlag.SIZE_FIELD_STOPS|w.WGLVVFlag.SIZE_MINMAX_VALUE|w.WGLVVFlag.SIZE_SCALE_STOPS|w.WGLVVFlag.SIZE_UNIT_VALUE,C=(v&(w.WGLVVTarget.FIELD_TARGETS_OUTLINE|w.WGLVVTarget.MINMAX_TARGETS_OUTLINE|w.WGLVVTarget.SCALE_TARGETS_OUTLINE|w.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;r=z===w.WGLGeometryType.LINE&&r.isOutline||z===w.WGLGeometryType.FILL&&
p(r.symbologyType)?A&C:A&~C}v&=r;this.vvSizeMinMaxValue=!!(v&w.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(v&w.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(v&w.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(v&w.WGLVVFlag.SIZE_SCALE_STOPS)};h._createClass(y,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(v){this.setBit(16,v)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(v){this.setBit(17,v)}},{key:"vvSizeFieldStops",
get:function(){return 0!==this.bit(18)},set:function(v){this.setBit(18,v)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(v){this.setBit(19,v)}}]);return y}(q),b=q=>function(B){function y(){return u.apply(this,arguments)}h._inherits(y,B);var u=h._createSuper(y);B=y.prototype;B.hasVV=function(){return h._get(h._getPrototypeOf(y.prototype),"hasVV",this).call(this)||this.vvRotation};B.setVV=function(v,r){h._get(h._getPrototypeOf(y.prototype),"setVV",this).call(this,v,r);
this.vvRotation=!r.isOutline&&!!(v&w.WGLVVFlag.ROTATION)};h._createClass(y,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(v){this.setBit(15,v)}}]);return y}(q),a=q=>function(B){function y(){return u.apply(this,arguments)}h._inherits(y,B);var u=h._createSuper(y);B=y.prototype;B.hasVV=function(){return h._get(h._getPrototypeOf(y.prototype),"hasVV",this).call(this)||this.vvColor};B.setVV=function(v,r){h._get(h._getPrototypeOf(y.prototype),"setVV",this).call(this,v,r);this.vvColor=
!r.isOutline&&!!(v&w.WGLVVFlag.COLOR)};h._createClass(y,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(v){this.setBit(13,v)}}]);return y}(q),e=q=>function(B){function y(){return u.apply(this,arguments)}h._inherits(y,B);var u=h._createSuper(y);B=y.prototype;B.hasVV=function(){return h._get(h._getPrototypeOf(y.prototype),"hasVV",this).call(this)||this.vvOpacity};B.setVV=function(v,r){h._get(h._getPrototypeOf(y.prototype),"setVV",this).call(this,v,r);this.vvOpacity=!r.isOutline&&
!!(v&w.WGLVVFlag.OPACITY)};h._createClass(y,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(v){this.setBit(14,v)}}]);return y}(q);let c=function(q){function B(){return y.apply(this,arguments)}h._inherits(B,q);var y=h._createSuper(B);B.load=function(u){const v=this.shared;v.data=u;return v};B.from=function(u){const {symbologyType:v,vvFlags:r}=u,z=this.load(0);z.geometryType=w.WGLGeometryType.FILL;z.symbologyType=v;v!==w.WGLSymbologyType.DOT_DENSITY&&z.setVV(r,u);return z.data};
B.prototype.getVariation=function(){return{...h._get(h._getPrototypeOf(B.prototype),"getVariation",this).call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return h._createClass(B)}(a(e(d(f))));c.shared=new c(0);let m=function(q){function B(){return y.apply(this,arguments)}h._inherits(B,q);var y=h._createSuper(B);B.load=function(u){const v=
this.shared;v.data=u;return v};B.from=function(u){const {symbologyType:v,vvFlags:r}=u,z=this.load(0);z.geometryType=w.WGLGeometryType.MARKER;z.symbologyType=v;v!==w.WGLSymbologyType.HEATMAP&&z.setVV(r,u);return z.data};B.prototype.getVariation=function(){return{...h._get(h._getPrototypeOf(B.prototype),"getVariation",this).call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,
vvSizeUnitValue:this.vvSizeUnitValue}};return h._createClass(B)}(a(e(b(d(f)))));m.shared=new m(0);let k=function(q){function B(){return y.apply(this,arguments)}h._inherits(B,q);var y=h._createSuper(B);B.load=function(u){const v=this.shared;v.data=u;return v};B.from=function(u){const v=this.load(0);v.geometryType=w.WGLGeometryType.LINE;v.symbologyType=u.symbologyType;v.setVV(u.vvFlags,u);return v.data};B.prototype.getVariation=function(){return{...h._get(h._getPrototypeOf(B.prototype),"getVariation",
this).call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return h._createClass(B)}(a(e(d(f))));k.shared=new k(0);let n=function(q){function B(){return y.apply(this,arguments)}h._inherits(B,q);var y=h._createSuper(B);B.load=function(u){const v=this.shared;v.data=u;return v};B.from=function(u){const v=this.load(0);v.geometryType=w.WGLGeometryType.TEXT;
v.symbologyType=u.symbologyType;v.setVV(u.vvFlags,u);return v.data};B.prototype.getVariation=function(){return{...h._get(h._getPrototypeOf(B.prototype),"getVariation",this).call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return h._createClass(B)}(a(e(b(d(f)))));n.shared=new n(0);let x=function(q){function B(){return y.apply(this,
arguments)}h._inherits(B,q);var y=h._createSuper(B);B.load=function(u){const v=this.shared;v.data=u;return v};B.from=function(u){const v=this.load(0);v.geometryType=w.WGLGeometryType.LABEL;v.symbologyType=u.symbologyType;v.setVV(u.vvFlags,u);v.mapAligned=E.isMapAligned(u.placement);return v.data};B.prototype.getVariation=function(){return{...h._get(h._getPrototypeOf(B.prototype),"getVariation",this).call(this),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,
vvSizeUnitValue:this.vvSizeUnitValue}};return h._createClass(B)}(d(f));x.shared=new x(0);l.FillMaterialKey=c;l.LabelMaterialKey=x;l.LineMaterialKey=k;l.MarkerMaterialKey=m;l.MaterialKeyBase=f;l.TextMaterialKey=n;l.createMaterialKey=function(q,B){switch(q){case w.WGLGeometryType.FILL:return c.from(B);case w.WGLGeometryType.LINE:return k.from(B);case w.WGLGeometryType.MARKER:return m.from(B);case w.WGLGeometryType.TEXT:return n.from(B);case w.WGLGeometryType.LABEL:return x.from(B);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${q}`);
}};l.hasOutlineFillSymbology=function(q){return p(q.symbologyType)};l.hasSimpleSymbology=function(q){return t(q.symbologyType)};l.hydrateMaterialKey=function(q){switch(f.load(q).geometryType){case w.WGLGeometryType.MARKER:return new m(q);case w.WGLGeometryType.FILL:return new c(q);case w.WGLGeometryType.LINE:return new k(q);case w.WGLGeometryType.TEXT:return new n(q);case w.WGLGeometryType.LABEL:return new x(q)}};l.isOutlineFillSymbology=p;l.isSimpleSymbology=t;Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(l){l.HAlign=void 0;(function(h){h[h.Left=-1]="Left";h[h.Center=0]="Center";h[h.Right=1]="Right"})(l.HAlign||(l.HAlign={}));l.VAlign=void 0;(function(h){h[h.Top=1]="Top";h[h.Center=0]="Center";h[h.Bottom=-1]="Bottom";h[h.Baseline=2]="Baseline"})(l.VAlign||(l.VAlign={}));l.getAlignmentFromPlacement=function(h){switch(h){case "above-left":case "esriServerPointLabelPlacementAboveLeft":return[l.HAlign.Right,
l.VAlign.Bottom];case "above-center":case "above-along":case "esriServerPointLabelPlacementAboveCenter":case "esriServerLinePlacementAboveAlong":return[l.HAlign.Center,l.VAlign.Bottom];case "above-right":case "esriServerPointLabelPlacementAboveRight":return[l.HAlign.Left,l.VAlign.Bottom];case "center-left":case "esriServerPointLabelPlacementCenterLeft":return[l.HAlign.Right,l.VAlign.Center];case "center-center":case "center-along":case "esriServerPointLabelPlacementCenterCenter":case "esriServerLinePlacementCenterAlong":return[l.HAlign.Center,
l.VAlign.Center];case "center-right":case "esriServerPointLabelPlacementCenterRight":return[l.HAlign.Left,l.VAlign.Center];case "below-left":case "esriServerPointLabelPlacementBelowLeft":return[l.HAlign.Right,l.VAlign.Top];case "below-center":case "below-along":case "esriServerPointLabelPlacementBelowCenter":case "esriServerLinePlacementBelowAlong":return[l.HAlign.Center,l.VAlign.Top];case "below-right":case "esriServerPointLabelPlacementBelowRight":return[l.HAlign.Left,l.VAlign.Top];case "always-horizontal":case "esriServerPolygonPlacementAlwaysHorizontal":return[l.HAlign.Center,
l.VAlign.Center];default:return console.debug(`Found invalid placement type ${h}`),[l.HAlign.Center,l.VAlign.Center]}};l.getJustification=function(h){switch(h){case "left":return l.HAlign.Left;case "right":return l.HAlign.Right;case "center":return l.HAlign.Center}};l.getXAnchorDirection=function(h){switch(h){case "left":return l.HAlign.Left;case "right":return l.HAlign.Right;case "center":return l.HAlign.Center}};l.getXDirection=function(h){switch(h){case l.HAlign.Right:return-1;case l.HAlign.Center:return 0;
case l.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${h}`),0}};l.getYAnchorDirection=function(h){switch(h){case "top":return l.VAlign.Top;case "middle":return l.VAlign.Center;case "baseline":return l.VAlign.Baseline;case "bottom":return l.VAlign.Bottom}};l.getYDirection=function(h){switch(h){case l.VAlign.Top:return 1;case l.VAlign.Center:return 0;case l.VAlign.Bottom:case l.VAlign.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${h}`),
0}};l.isMapAligned=function(h){switch(h){case "above-along":case "below-along":case "center-along":case "esriServerLinePlacementAboveAlong":case "esriServerLinePlacementBelowAlong":case "esriServerLinePlacementCenterAlong":return!0;default:return!1}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/utils":function(){define("exports ../../../../../core/Error ../enums ../materialKey/MaterialKey ./Technique ./dotDensity/TechniqueDotDensity ./heatmap/TechniqueHeatmap ./pieChart/TechniquePieChart".split(" "),
function(l,h,D,E,w,t,p,g){l.assertRendererSchema=function(f,d){if(f.type!==d)throw new h("material-view-model:unexpected-renderer-schema",`expected to find renderer schema of type "${d}" but found type "${f.type}"`);};l.getTechniqueFromMaterialKey=function(f){const {geometryType:d,symbologyType:b}=E.MaterialKeyBase.load(f);switch(d){case D.WGLGeometryType.FILL:switch(b){case D.WGLSymbologyType.DOT_DENSITY:return t.DotDensityTechnique}break;case D.WGLGeometryType.MARKER:switch(b){case D.WGLSymbologyType.HEATMAP:return p.HeatmapTechnique;
case D.WGLSymbologyType.PIE_CHART:return g.PieChartTechnique}}return w.Technique};l.getTechniqueFromRenderer=function(f){switch(f?.type){case "dot-density":return t.DotDensityTechnique;case "heatmap":return p.HeatmapTechnique;case "pie-chart":return g.PieChartTechnique;default:return w.Technique}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/Technique":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe"],
function(l,h,D){let E=function(){function w(){}w.getStorageSpec=function(t){return null};w.createOrUpdateRendererSchema=function(t,p){return D.isSome(t)&&"default"===t.type?t:{type:"default"}};w.getVariation=function(t){return{}};w.getVariationHash=function(t){return 0};return h._createClass(w)}();E.type="default";E.programSpec=null;l.Technique=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/dotDensity/TechniqueDotDensity":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p){t=function(g){function f(){return d.apply(this,arguments)}h._inherits(f,g);var d=h._createSuper(f);f.getStorageSpec=function({attributes:b}){return{visualVariables:!1,attributes:b??null}};f._createRendererSchema=function(){return{type:"dot-density",colors:new Float32Array(32),dotValue:-1,dotSize:-1,dotScale:-1,dotBlending:!1,backgroundColor:new Float32Array(4),activeDots:new Float32Array(8),seed:-1}};f.createOrUpdateRendererSchema=function(b,a){const {attributes:e,dotValue:c,
referenceScale:m,dotSize:k,dotBlendingEnabled:n,seed:x,backgroundColor:q}=a;b=D.isSome(b)&&"dot-density"===b.type?b:this._createRendererSchema();b.dotValue=c;b.dotSize=k;b.dotScale=m;b.dotBlending=n;b.seed=x;const {colors:B,activeDots:y,backgroundColor:u}=b;for(var v=0;v<w.DOT_DENSITY_MAX_FIELDS;v++)E.writeColor(B,v>=e.length?null:e[v].color,4*v);for(v=0;8>v;v++)y[v]=v<a.attributes.length?1:0;E.writeColor(u,q);return b};f.getVariation=function(b){return{ddDotBlending:b.dotBlending}};f.getVariationHash=
function(b){return b.dotBlending?1:0};return h._createClass(f)}(t.Technique);t.type="dot-density";t.programSpec={shader:"materials/fill",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:p.DataType.SHORT},{location:1,name:"a_id",count:3,type:p.DataType.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:p.DataType.UNSIGNED_BYTE},{location:3,name:"a_inverseArea",count:1,type:p.DataType.FLOAT}]}};l.DotDensityTechnique=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/color":function(){define(["exports","../../../../core/maybe","./number"],function(l,h,D){l.premultiplyAlpha=function(E,w=0,t=!1){const p=E[w+3];E[w]*=p;E[w+1]*=p;E[w+2]*=p;t||(E[w+3]*=255);return E};l.premultiplyAlphaRGBA=function(E){if(!E)return 0;const {r:w,g:t,b:p,a:g}=E;return D.i8888to32(w*g,t*g,p*g,255*g)};l.premultiplyAlphaRGBAArray=function(E){if(!E)return 0;const [w,t,p,g]=E;return D.i8888to32(g/255*w,g/255*t,g/255*p,g)};l.writeColor=function(E,w,t=0){if(h.isNone(w))E[t]=
0,E[t+1]=0,E[t+2]=0,E[t+3]=0;else{var {r:p,g,b:f,a:d}=w;E[t]=p*d/255;E[t+1]=g*d/255;E[t+2]=f*d/255;E[t+3]=d}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(l){function h(w,t,p){return Math.round(Math.max(Math.min(w,p),t))}const D=new Float32Array(1),E=new Uint32Array(D.buffer);l.i16=function(w){return h(w,-32768,32767)};l.i1616to32=function(w,t){return 65535&w|t<<16};l.i32=function(w){return h(w,-2147483648,
2147483647)};l.i8=function(w){return h(w,-128,127)};l.i8816to32=function(w,t,p){return w&255|(t&255)<<8|p<<16};l.i8888to32=function(w,t,p,g){return w&255|(t&255)<<8|(p&255)<<16|g<<24};l.numTo32=function(w){return w|0};l.toFloat32=function(w){E[0]=w;return D[0]};l.toUint32=function(w){D[0]=w;return E[0]};l.u16=function(w){return h(w,0,65535)};l.u32=function(w){return h(w,0,4294967295)};l.u32to4Xu8=function(w){return[w&255,(w&65280)>>>8,(w&16711680)>>>16,(w&4278190080)>>>24]};l.u4u4to8=function(w,t){return 15&
w|(15&t)<<4};l.u8=function(w){return h(w,0,255)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/heatmap/TechniqueHeatmap":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../renderers/support/heatmapUtils ../Technique ../../../../../webgl/enums".split(" "),function(l,h,D,E,w,t,p){t=function(g){function f(){return d.apply(this,arguments)}
h._inherits(f,g);var d=h._createSuper(f);f.getStorageSpec=function({field:b,valueExpression:a}){return{visualVariables:!1,attributes:b||a?[{field:b,valueExpression:a}]:null}};f._createRendererSchema=function(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}};f.createOrUpdateRendererSchema=function(b,a){const {radius:e,minDensity:c,maxDensity:m,referenceScale:k,field:n,valueExpression:x,colorStops:q}=
a;a=m-c;const B=n||x?1:0,y=q.map(({color:r,ratio:z})=>`${z}:${r.toString()}`).join();let u=!0,v;D.isSome(b)&&"heatmap"===b.type?(v=b,u=y!==b.gradientHash):v=this._createRendererSchema();v.radius=E.pt2px(e);v.minDensity=c;v.densityRange=a;v.referenceScale=k;v.isFieldActive=B;u&&(v.gradient=w.generateGradient(q),v.gradientHash=y);return v};return h._createClass(f)}(t.Technique);t.type="heatmap";t.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,name:"a_pos",
count:2,type:p.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:p.DataType.SHORT},{location:4,name:"a_id",count:4,type:p.DataType.UNSIGNED_BYTE}]}};l.HeatmapTechnique=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/techniques/pieChart/TechniquePieChart":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../Color ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../Technique ../../../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p,g,f){g=function(d){function b(){return a.apply(this,arguments)}h._inherits(b,d);var a=h._createSuper(b);b.getStorageSpec=function({attributes:e}){return{visualVariables:!0,attributes:e??null}};b._createRendererSchema=function(){return{type:"pie-chart",colors:new Float32Array(4*p.CHART_MAX_FIELDS),defaultColor:new Float32Array(4),othersColor:new Float32Array(4),outlineColor:new Float32Array(4),holePercentage:0,sectorThreshold:0,outlineWidth:1,numberOfFields:10}};b.createOrUpdateRendererSchema=
function(e,c){const {attributes:m,defaultColor:k,holePercentage:n,othersCategory:x,outline:q}=c;e=E.isSome(e)&&"pie-chart"===e.type?e:this._createRendererSchema();for(c=0;c<p.CHART_MAX_FIELDS;c++){const B=c>=m.length?new D([0,0,0,0]):m[c].color;t.writeColor(e.colors,B,4*c)}t.writeColor(e.defaultColor,k);t.writeColor(e.othersColor,x?.color);t.writeColor(e.outlineColor,q?.color);e.outlineWidth=w.pt2px(q?.width||0);e.holePercentage=n;e.sectorThreshold=x?.threshold||0;e.numberOfFields=m.length;return e};
b.getVariation=function(e){return{numberOfFields:e.numberOfFields}};b.getVariationHash=function(e){return e.numberOfFields};return h._createClass(b)}(g.Technique);g.type="pie-chart";g.programSpec={shader:"materials/pie",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:f.DataType.SHORT},{location:1,name:"a_vertexOffset",count:2,type:f.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:f.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:f.DataType.UNSIGNED_SHORT},
{location:4,name:"a_id",count:4,type:f.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:f.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:f.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:f.DataType.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:f.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};l.PieChartTechnique=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/brushes/WGLBrushHeatmap":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ./WGLGeometryBrushMarker ../effects/Effect ../techniques/utils ../../../../webgl/context-util ../../../../webgl/enums ../../../../webgl/FramebufferObject ../../../../webgl/heatmapTextureUtils ../../../../webgl/Renderbuffer ../../../../webgl/Texture".split(" "),function(l,h,D,E,w,t,p,g,f,d,b,a,e,c){const m=
h.getLogger("esri.views.2d.engine.webgl.brushes.WGLBrushHeatmap");h=function(x){function q(){var y=B.apply(this,arguments);y.brushEffect=new n;return y}l._inherits(q,x);var B=l._createSuper(q);x=q.prototype;x.supportsSymbology=function(y){return y===E.WGLSymbologyType.HEATMAP};x.dispose=function(){l._get(l._getPrototypeOf(q.prototype),"dispose",this).call(this);this.brushEffect.dispose();this.brushEffect=null};x.prepareState=function(){};x.drawGeometry=function(y,u,v,r){const {defines:z}=this.brushEffect.loadQualityProfile(y.context);
l._get(l._getPrototypeOf(q.prototype),"drawGeometry",this).call(this,y,u,v,r?[...r,...z]:z)};x._drawMarkers=function(y,u,v,r,z,A,C){const {context:F,rendererInfo:G,state:H}=y;({rendererSchema:y}=G);g.assertRendererSchema(y,"heatmap");const {referenceScale:K,radius:J,isFieldActive:N}=y;v.setUniform1f("u_radius",J*(0!==K?K/H.scale:1));C||(v.setUniform1f("u_isFieldActive",N),F.setStencilFunction(d.CompareFunction.GEQUAL,u.stencilRef,255));F.drawElements(r,z,d.DataType.UNSIGNED_INT,A)};return l._createClass(q)}(t);
const k={vsPath:"heatmap/heatmapResolve",fsPath:"heatmap/heatmapResolve",attributes:new Map([["a_position",0]])};let n=function(x){function q(){var y=B.apply(this,arguments);y.name=y.constructor.name;return y}l._inherits(q,x);var B=l._createSuper(q);x=q.prototype;x.createOptions=function({passOptions:y}){return y};x.dispose=function(){this._prevFBO=null;this._accumulateOutputTexture=D.disposeMaybe(this._accumulateOutputTexture);D.isSome(this._accumulateFramebuffer)&&this._accumulateFramebuffer.detachDepthStencilBuffer();
this._accumulateOutputStencilBuffer=D.disposeMaybe(this._accumulateOutputStencilBuffer);this._accumulateFramebuffer=D.disposeMaybe(this._accumulateFramebuffer);this._resolveGradientTexture=D.disposeMaybe(this._resolveGradientTexture);this._tileQuad=D.disposeMaybe(this._tileQuad)};x.bind=function(y){const {context:u,rendererInfo:v,passOptions:r}=y,{rendererSchema:z}=v;D.isSome(r)&&"hittest"===r.type||"heatmap"!==z.type||(this._prevFBO=u.getBoundFramebufferObject(),this._prevViewport=u.getViewport(),
g.assertRendererSchema(z,"heatmap"),this._loadResources(y),this._updateResources(u,z),u.bindFramebuffer(this._accumulateFramebuffer),u.setViewport(0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height),u.setStencilTestEnabled(!0),u.setBlendingEnabled(!0),u.setBlendFunction(d.BlendFactor.ONE,d.BlendFactor.ONE),u.setClearColor(0,0,0,0),u.clear(d.ClearBufferBit.COLOR_BUFFER_BIT))};x.unbind=function(){this._prevViewport=this._prevFBO=null};x.draw=function(y){const {context:u,painter:v,
rendererInfo:r,passOptions:z}=y;({rendererSchema:y}=r);if(!(D.isSome(z)&&"hittest"===z.type||"heatmap"!==y.type)){var {defines:A}=this.loadQualityProfile(u);A=v.materialManager.getProgram(k,A);u.useProgram(A);u.bindFramebuffer(this._prevFBO);u.setViewport(0,0,this._prevViewport.width,this._prevViewport.height);u.setBlendFunction(d.BlendFactor.ONE,d.BlendFactor.ONE_MINUS_SRC_ALPHA);u.setStencilTestEnabled(!1);var {radius:C,minDensity:F,densityRange:G}=y;u.bindTexture(this._accumulateOutputTexture,
8);u.bindTexture(this._resolveGradientTexture,9);A.setUniform1i("u_texture",8);A.setUniform1i("u_gradient",9);A.setUniform2f("u_densityMinAndInvRange",F,1/G);A.setUniform1f("u_densityNormalization",3/(C*C*Math.PI));this._tileQuad.draw()}};x._loadResources=function({context:y,painter:u}){const {dataType:v,samplingMode:r,pixelFormat:z,internalFormat:A,shadingRate:C,requiresSharedStencilBuffer:F}=this.loadQualityProfile(y),{width:G,height:H}=this._prevViewport,K=G*C,J=H*C;this._accumulateOutputTexture??
(this._accumulateOutputTexture=new c.Texture(y,{target:d.TextureType.TEXTURE_2D,pixelFormat:z,internalFormat:A,dataType:v,samplingMode:r,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE,width:K,height:J}));F||(this._accumulateOutputStencilBuffer??(this._accumulateOutputStencilBuffer=new e.Renderbuffer(y,{width:K,height:J,internalFormat:d.RenderbufferFormat.DEPTH_STENCIL})));this._accumulateFramebuffer??(this._accumulateFramebuffer=new b.FramebufferObject(y,{},this._accumulateOutputTexture,F?u.getSharedStencilBuffer():
this._accumulateOutputStencilBuffer));this._resolveGradientTexture??(this._resolveGradientTexture=new c.Texture(y,{target:d.TextureType.TEXTURE_2D,pixelFormat:d.PixelFormat.RGBA,dataType:d.PixelType.UNSIGNED_BYTE,samplingMode:d.TextureSamplingMode.LINEAR,wrapMode:d.TextureWrapMode.CLAMP_TO_EDGE}));this._tileQuad??(this._tileQuad=new w(y,[0,0,1,0,0,1,1,1]))};x._updateResources=function(y,u){const {gradientHash:v,gradient:r}=u;this._prevGradientHash!==v&&(this._resolveGradientTexture.resize(r.length/
4,1),this._resolveGradientTexture.setData(r),this._prevGradientHash=v);const {shadingRate:z,requiresSharedStencilBuffer:A}=this.loadQualityProfile(y),{width:C,height:F}=this._prevViewport;u=C*z;const G=F*z,{width:H,height:K}=this._accumulateFramebuffer;if(H!==u||K!==G){const J=this._accumulateFramebuffer.depthStencilAttachment;if(A&&D.isSome(J)){const {width:N,height:P}=J.descriptor;if(N!==u||P!==G)m.errorOnce("Attempted to resize shared stencil buffer! Detaching instead."),this._accumulateFramebuffer.detachDepthStencilBuffer()}this._accumulateFramebuffer.resize(u,
G)}A||y.blitFramebuffer(this._prevFBO,this._accumulateFramebuffer,0,0,this._prevFBO.width,this._prevFBO.height,0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height,d.ClearBufferBit.STENCIL_BUFFER_BIT,d.TextureSamplingMode.NEAREST)};x.loadQualityProfile=function(y){if(D.isNone(this._qualityProfile)){const u=a.loadHeatmapTextureConfiguration(y,m);y=y.type===f.ContextType.WEBGL1;this._qualityProfile={...u,requiresSharedStencilBuffer:y,shadingRate:y?1:.25,defines:u.dataType!==d.PixelType.FLOAT?
["heatmapPrecisionHalfFloat"]:[]}}return this._qualityProfile};return l._createClass(q)}(p.Effect);return h})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../techniques/utils ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t,p,g){const f={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:g.DataType.SHORT},
{location:1,name:"a_vertexOffset",count:2,type:g.DataType.SHORT},{location:2,name:"a_texCoords",count:2,type:g.DataType.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:g.DataType.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:g.DataType.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:g.DataType.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:g.DataType.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:g.DataType.UNSIGNED_BYTE},
{location:8,name:"a_zoomRange",count:2,type:g.DataType.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};return function(d){function b(){return a.apply(this,arguments)}l._inherits(b,d);var a=l._createSuper(b);d=b.prototype;d.dispose=function(){};d.getGeometryType=function(){return D.WGLGeometryType.MARKER};d.supportsSymbology=function(e){return e!==D.WGLSymbologyType.HEATMAP&&e!==D.WGLSymbologyType.PIE_CHART};d.drawGeometry=function(e,c,m,k){const {context:n,painter:x,rendererInfo:q,
state:B,passOptions:y,requestRender:u,allowDelayedRender:v}=e;var r=t.MarkerMaterialKey.load(m.materialKey),z=p.getTechniqueFromMaterialKey(r.data);const A=h.isSome(y)&&"hittest"===y.type,{shader:C,vertexLayout:F,hittestAttributes:G}=h.unwrapOr(z.programSpec,f);z=g.PrimitiveType.TRIANGLES;var H=E.createProgramDescriptor(r.data,F);A&&(H=this._getTriangleDesc(m.materialKey,H,G),z=g.PrimitiveType.POINTS);const {attributes:K,bufferLayouts:J}=H;k=x.materialManager.getMaterialProgram(e,r,C,K,k);v&&h.isSome(u)&&
!k.compiled?u():(n.useProgram(k),r.textureBinding&&x.textureManager.bindTextures(n,k,r,!0),this._setSharedUniforms(k,e,c),k.setUniformMatrix3fv("u_displayMat3",r.vvRotation?B.displayViewMat3:B.displayMat3),this._setSizeVVUniforms(r,k,q,c),this._setColorAndOpacityVVUniforms(r,k,q),this._setRotationVVUniforms(r,k,q),r=m.target.getVAO(n,J,K,A),H=m.indexCount,m=m.indexFrom*Uint32Array.BYTES_PER_ELEMENT,A&&(H/=3,m/=3),n.bindVAO(r),this._drawMarkers(e,c,k,z,H,m,A),n.bindVAO(null))};d._drawMarkers=function(e,
c,m,k,n,x,q){e.context.drawElements(k,n,g.DataType.UNSIGNED_INT,x)};return l._createClass(b)}(w)})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(l,h){let D=function(){function E(){this.name=this.constructor.name}E.prototype.createOptions=function(w,t){return null};return h._createClass(E)}();l.Effect=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/heatmapTextureUtils":function(){define(["exports",
"../../core/Error","../../core/maybe","./enums"],function(l,h,D,E){l.loadHeatmapTextureConfiguration=function(w,t){const {textureFloat:p,colorBufferFloat:g}=w.capabilities,f=p?.textureFloat,d=p?.textureFloatLinear;var b=p?.textureHalfFloat;const a=p?.textureHalfFloatLinear,e=p?.HALF_FLOAT,c=g?.textureFloat;var m=g?.textureHalfFloat;const k=g?.floatBlend;w=D.unwrapOrThrow(w.driverTest).floatBufferBlend.result;if(!f&&!b)throw new h("heatmap:missing-texture-float","HeatmapRenderer requires WebGL2 or the WebGL1 extension OES_texture_float or OES_texture_half_float.");
if(!c&&!m)throw new h("heatmap:missing-color-buffer-float","HeatmapRenderer requires the WebGL extension EXT_color_buffer_float or EXT_color_buffer_half_float or WEBGL_color_buffer_float.");if(!(k&&w||m))throw new h("heatmap:missing-float-blend",`HeatmapRenderer requires the WebGL extension EXT_float_blend or EXT_color_buffer_half_float.${w?"":" This device claims support for EXT_float_blend, but does not actually support it."}`);b=b&&m;m=!!g?.R32F;const n=!!g?.R16F;if(f&&c&&k&&w&&(d||!a))return d||
t.warnOnce("Missing WebGL extension OES_texture_float_linear. Heatmap quality may be reduced."),{dataType:E.PixelType.FLOAT,samplingMode:d?E.TextureSamplingMode.LINEAR:E.TextureSamplingMode.NEAREST,pixelFormat:m?E.PixelFormat.RED:E.PixelFormat.RGBA,internalFormat:m?E.SizedPixelFormat.R32F:E.PixelFormat.RGBA};if(b)return a||t.warnOnce("Missing WebGL extension OES_texture_half_float_linear. Heatmap quality may be reduced."),{dataType:e,samplingMode:a?E.TextureSamplingMode.LINEAR:E.TextureSamplingMode.NEAREST,
pixelFormat:n?E.PixelFormat.RED:E.PixelFormat.RGBA,internalFormat:n?E.SizedPixelFormat.R16F:E.PixelFormat.RGBA};throw new h("heatmap:missing-hardware-support","HeatmapRenderer requires WebGL extensions that allow it to render and blend to float or half float textures.");};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a){return function(e){function c(){var k=m.apply(this,arguments);k._color=D.fromValues(1,0,0,1);return k}l._inherits(c,e);var m=l._createSuper(c);e=c.prototype;e.dispose=function(){this._outlineProgram?.dispose();this._outlineProgram=null;this._tileInfoProgram?.dispose();this._tileInfoProgram=null;this._outlineVertexArrayObject?.dispose();this._outlineVertexArrayObject=null;this._tileInfoVertexArrayObject?.dispose();this._canvas=this._tileInfoVertexArrayObject=null};
e.prepareState=function({context:k}){k.setBlendingEnabled(!0);k.setBlendFunctionSeparate(f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA,f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA);k.setColorMask(!0,!0,!0,!0);k.setStencilWriteMask(0);k.setStencilTestEnabled(!1)};e.draw=function(k,n){const {context:x,requestRender:q,allowDelayedRender:B}=k;if(n.isReady)if(this._loadWGLResources(x),!B||!h.isSome(q)||this._outlineProgram.compiled&&this._tileInfoProgram.compiled){x.bindVAO(this._outlineVertexArrayObject);
x.useProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",n.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",n.rangeX,n.rangeY);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);x.drawArrays(f.PrimitiveType.LINE_STRIP,0,4);if(k=this._getTexture(x,n))x.bindVAO(this._tileInfoVertexArrayObject),x.useProgram(this._tileInfoProgram),x.bindTexture(k,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",
n.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",n.rangeX/n.width,n.rangeY/n.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",k.descriptor.width,k.descriptor.height),x.drawArrays(f.PrimitiveType.TRIANGLE_STRIP,0,4);x.bindVAO()}else q()};e._loadWGLResources=function(k){if(!this._outlineProgram||!this._tileInfoProgram){var n=d.createProgram(k,t.background),x=d.createProgram(k,
p.tileInfo),q=new Int8Array([0,0,1,0,1,1,0,1]);q=g.BufferObject.createVertex(k,f.Usage.STATIC_DRAW,q);q=new a.VertexArrayObject(k,t.background.attributes,E.Pos2b,{geometry:q});var B=new Int8Array([0,0,1,0,0,1,1,1]);B=g.BufferObject.createVertex(k,f.Usage.STATIC_DRAW,B);k=new a.VertexArrayObject(k,p.tileInfo.attributes,E.Pos2b,{geometry:B});this._outlineProgram=n;this._tileInfoProgram=x;this._outlineVertexArrayObject=q;this._tileInfoVertexArrayObject=k}};e._getTexture=function(k,n){if(n.texture&&n.triangleCountReportedInDebug===
n.triangleCount)return n.texture;n.triangleCountReportedInDebug=n.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const x=n.triangleCount;let q=n.key.id;0<n.triangleCount&&(q+=`, ${x}`);const B=this._canvas,y=B.getContext("2d");y.font="24px sans-serif";y.textAlign="left";y.textBaseline="top";y.clearRect(0,
0,300,32);1E5<x?(y.fillStyle="red",y.fillRect(0,0,300,32),y.fillStyle="black"):(y.clearRect(0,0,300,32),y.fillStyle="blue");y.fillText(q,0,0);n.texture=new b.Texture(k,{target:f.TextureType.TEXTURE_2D,pixelFormat:f.PixelFormat.RGBA,dataType:f.PixelType.UNSIGNED_BYTE,samplingMode:f.TextureSamplingMode.NEAREST,wrapMode:f.TextureWrapMode.CLAMP_TO_EDGE},B);return n.texture};return l._createClass(c)}(w)})},"esri/views/2d/engine/webgl/DefaultVertexAttributeLayouts":function(){define(["exports","../../../webgl/enums",
"../../../webgl/VertexElementDescriptor"],function(l,h,D){const E={geometry:[new D.VertexElementDescriptor("a_pos",2,h.DataType.BYTE,0,2)]},w={geometry:[new D.VertexElementDescriptor("a_pos",2,h.DataType.BYTE,0,4),new D.VertexElementDescriptor("a_tex",2,h.DataType.BYTE,2,4)]};h={geometry:[new D.VertexElementDescriptor("a_pos",2,h.DataType.UNSIGNED_SHORT,0,4)]};l.Pos2b=E;l.Pos2us=h;l.PosTex2b=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports",
"./sources/resolver"],function(l,h){h={shaders:{vertexShader:h.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:h.resolveIncludes("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])};l.tileInfo=h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushPieChart":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","./WGLGeometryBrushMarker","../techniques/utils","../../../../webgl/enums"],function(l,h,D,
E,w){return function(t){function p(){return g.apply(this,arguments)}l._inherits(p,t);var g=l._createSuper(p);t=p.prototype;t.supportsSymbology=function(f){return f===h.WGLSymbologyType.PIE_CHART};t._drawMarkers=function(f,d,b,a,e,c,m){({context:d}=f);({rendererInfo:f}=f);({rendererSchema:f}=f);E.assertRendererSchema(f,"pie-chart");b.setUniform4fv("u_colors",f.colors);b.setUniform4fv("u_defaultColor",f.defaultColor);b.setUniform4fv("u_othersColor",f.othersColor);b.setUniform4fv("u_outlineColor",f.outlineColor);
b.setUniform1f("u_donutRatio",f.holePercentage);b.setUniform1f("u_sectorThreshold",f.sectorThreshold);b.setUniform1f("u_outlineWidth",f.outlineWidth);d.drawElements(a,e,w.DataType.UNSIGNED_INT,c)};return l._createClass(p)}(D)})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../DefaultVertexAttributeLayouts ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/ProgramTemplate ../../../../webgl/VertexArrayObject".split(" "),
function(l,h,D,E,w,t,p,g,f,d){return function(b){function a(){var c=e.apply(this,arguments);c._color=D.fromValues(1,0,0,1);c._initialized=!1;return c}l._inherits(a,b);var e=l._createSuper(a);b=a.prototype;b.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};b.prepareState=function({context:c}){c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.setStencilTestEnabled(!0);
c.setBlendingEnabled(!1);c.setColorMask(!1,!1,!1,!1);c.setStencilOp(g.StencilOperation.KEEP,g.StencilOperation.KEEP,g.StencilOperation.REPLACE);c.setStencilWriteMask(255)};b.draw=function(c,m){const {context:k,requestRender:n,allowDelayedRender:x}=c;this._initialized||this._initialize(k);x&&h.isSome(n)&&!this._solidProgram.compiled?n():(k.setStencilFunctionSeparate(g.Face.FRONT_AND_BACK,g.CompareFunction.GREATER,m.stencilRef,255),k.bindVAO(this._solidVertexArrayObject),k.useProgram(this._solidProgram),
this._solidProgram.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",[m.rangeX,m.rangeY]),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),k.drawArrays(g.PrimitiveType.TRIANGLE_STRIP,0,4),k.bindVAO())};b._initialize=function(c){if(this._initialized)return!0;const m=f.createProgram(c,t.background);if(!m)return!1;var k=new Int8Array([0,0,1,0,0,1,1,1]);k=p.BufferObject.createVertex(c,g.Usage.STATIC_DRAW,
k);c=new d.VertexArrayObject(c,t.background.attributes,E.Pos2b,{geometry:k});this._solidProgram=m;this._solidVertexArrayObject=c;return this._initialized=!0};return l._createClass(a)}(w)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../definitions ../enums ../number ./WGLBrush ../../../../webgl/BufferObject ../../../../webgl/enums ../../../../webgl/VertexArrayObject".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e){d=function(c){function m(){var n=k.apply(this,arguments);n._color=t.fromValues(1,0,0,1);n._patternMatrix=w.create();n._programOptions={id:!1,pattern:!1};return n}h._inherits(m,c);var k=h._createSuper(m);c=m.prototype;c.dispose=function(){this._vao&&(this._vao.dispose(),this._vao=null)};c.drawMany=function(n,x){const {context:q,painter:B,styleLayerUID:y,requestRender:u,allowDelayedRender:v}=n;this._loadWGLResources(n);const r=n.displayLevel;var z=n.styleLayer,A=
z.backgroundMaterial;const C=B.vectorTilesMaterialManager;var F=z.getPaintValue("background-color",r);const G=z.getPaintValue("background-opacity",r),H=z.getPaintValue("background-pattern",r),K=void 0!==H,J=F[3]*G,N=n.spriteMosaic;let P,W;const X=(window.devicePixelRatio|1)>p.VTL_HIGH_RES_CUTOFF?2:1;n=n.drawPhase===g.WGLDrawPhase.HITTEST;const aa=this._programOptions;aa.id=n;aa.pattern=K;A=C.getMaterialProgram(q,A,aa);if(v&&E.isSome(u)&&!A.compiled)u();else{q.bindVAO(this._vao);q.useProgram(A);if(K){F=
N.getMosaicItemPosition(H,!0);if(E.isSome(F)){const {tl:Z,br:ea,page:T}=F;P=ea[0]-Z[0];W=ea[1]-Z[1];F=N.getPageSize(T);E.isSome(F)&&(N.bind(q,a.TextureSamplingMode.LINEAR,T,p.VTL_TEXTURE_BINDING_UNIT_SPRITES),A.setUniform4f("u_tlbr",Z[0],Z[1],ea[0],ea[1]),A.setUniform2fv("u_mosaicSize",F),A.setUniform1i("u_texture",p.VTL_TEXTURE_BINDING_UNIT_SPRITES))}A.setUniform1f("u_opacity",G)}else this._color[0]=J*F[0],this._color[1]=J*F[1],this._color[2]=J*F[2],this._color[3]=J,A.setUniform4fv("u_color",this._color);
A.setUniform1f("u_depth",z.z||0);n&&(z=f.u32to4Xu8(y+1),A.setUniform4fv("u_id",z));for(const Z of x)A.setUniform1f("u_coord_range",Z.rangeX),A.setUniformMatrix3fv("u_dvsMat3",Z.transforms.dvs),K&&(z=X*Z.width*Math.max(2**(Math.round(r)-Z.key.level),1),x=z/D.nextPowerOfTwo(P),z/=D.nextPowerOfTwo(W),this._patternMatrix[0]=x,this._patternMatrix[4]=z,A.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),q.setStencilFunction(a.CompareFunction.EQUAL,0,255),q.drawArrays(a.PrimitiveType.TRIANGLE_STRIP,
0,4)}};c._loadWGLResources=function(n){if(!this._vao){var {context:x,styleLayer:q}=n;n=q.backgroundMaterial;var B=new Int8Array([0,0,1,0,0,1,1,1]);B=b.BufferObject.createVertex(x,a.Usage.STATIC_DRAW,B);this._vao=new e.VertexArrayObject(x,n.getAttributeLocations(),n.getLayoutInfo(),{geometry:B})}};return h._createClass(m)}(d);l.WGLBrushVTLBackground=d;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p,g){p=function(f){function d(){var a=b.apply(this,arguments);a._programOptions={id:!1};return a}h._inherits(d,f);var b=h._createSuper(d);f=d.prototype;f.dispose=function(){};f.drawMany=function(a,e){const {context:c,displayLevel:m,requiredLevel:k,state:n,drawPhase:x,painter:q,spriteMosaic:B,styleLayerUID:y,requestRender:u,allowDelayedRender:v}=a;if(e.some(H=>H.layerData.get(y)?.circleIndexCount??!1)){a=a.styleLayer;var r=a.circleMaterial,z=q.vectorTilesMaterialManager,A=a.getPaintValue("circle-translate",
m),C=a.getPaintValue("circle-translate-anchor",m),F=x===w.WGLDrawPhase.HITTEST,G=this._programOptions;G.id=F;z=z.getMaterialProgram(c,r,G);if(v&&D.isSome(u)&&!z.compiled)u();else{c.useProgram(z);z.setUniformMatrix3fv("u_displayMat3",C===E.TranslateAnchor.VIEWPORT?n.displayMat3:n.displayViewMat3);z.setUniform2fv("u_circleTranslation",A);z.setUniform1f("u_depth",a.z);z.setUniform1f("u_antialiasingWidth",1.2);A=-1;F&&(F=t.u32to4Xu8(y+1),z.setUniform4fv("u_id",F));for(const H of e)H.layerData.has(y)&&
(H.key.level!==A&&(A=H.key.level,r.setDataUniforms(z,m,a,A,B)),e=H.layerData.get(y),e.circleIndexCount&&(e.prepareForRendering(c),F=e.circleVertexArrayObject,D.isNone(F)||(c.bindVAO(F),z.setUniformMatrix3fv("u_dvsMat3",H.transforms.dvs),k!==H.key.level?c.setStencilFunction(g.CompareFunction.EQUAL,H.stencilRef,255):c.setStencilFunction(g.CompareFunction.GREATER,255,255),c.drawElements(g.PrimitiveType.TRIANGLES,e.circleIndexCount,g.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.circleIndexStart),
H.triangleCount+=e.circleIndexCount/3)))}}};return h._createClass(d)}(p);l.WGLBrushVTLCircle=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../symbols/cim/enums"],function(l,h,D){l.StyleLayerType=void 0;(function(E){E[E.BACKGROUND=0]="BACKGROUND";E[E.FILL=1]="FILL";E[E.LINE=2]="LINE";E[E.SYMBOL=3]="SYMBOL";E[E.CIRCLE=4]="CIRCLE"})(l.StyleLayerType||
(l.StyleLayerType={}));l.Visibility=void 0;(function(E){E[E.VISIBLE=0]="VISIBLE";E[E.NONE=1]="NONE"})(l.Visibility||(l.Visibility={}));l.SymbolPlacement=void 0;(function(E){E[E.POINT=0]="POINT";E[E.LINE=1]="LINE";E[E.LINE_CENTER=2]="LINE_CENTER"})(l.SymbolPlacement||(l.SymbolPlacement={}));l.RotationAlignment=void 0;(function(E){E[E.MAP=0]="MAP";E[E.VIEWPORT=1]="VIEWPORT";E[E.AUTO=2]="AUTO"})(l.RotationAlignment||(l.RotationAlignment={}));l.TextJustification=void 0;(function(E){E[E.AUTO=0]="AUTO";
E[E.LEFT=1]="LEFT";E[E.CENTER=2]="CENTER";E[E.RIGHT=3]="RIGHT"})(l.TextJustification||(l.TextJustification={}));l.SymbolAnchor=void 0;(function(E){E[E.CENTER=0]="CENTER";E[E.LEFT=1]="LEFT";E[E.RIGHT=2]="RIGHT";E[E.TOP=3]="TOP";E[E.BOTTOM=4]="BOTTOM";E[E.TOP_LEFT=5]="TOP_LEFT";E[E.TOP_RIGHT=6]="TOP_RIGHT";E[E.BOTTOM_LEFT=7]="BOTTOM_LEFT";E[E.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(l.SymbolAnchor||(l.SymbolAnchor={}));l.TextTransform=void 0;(function(E){E[E.NONE=0]="NONE";E[E.UPPERCASE=1]="UPPERCASE";E[E.LOWERCASE=
2]="LOWERCASE"})(l.TextTransform||(l.TextTransform={}));l.TranslateAnchor=void 0;(function(E){E[E.MAP=0]="MAP";E[E.VIEWPORT=1]="VIEWPORT"})(l.TranslateAnchor||(l.TranslateAnchor={}));l.TextWritingMode=void 0;(function(E){E[E.HORIZONTAL=0]="HORIZONTAL";E[E.VERTICAL=1]="VERTICAL"})(l.TextWritingMode||(l.TextWritingMode={}));h=h._createClass(function(){});h.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:l.Visibility.VISIBLE}};h.fillLayoutDefinition={visibility:{type:"enum",
values:["visible","none"],default:l.Visibility.VISIBLE}};h.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:l.Visibility.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:D.CapType.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:D.JoinType.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};h.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:l.Visibility.VISIBLE},
"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:l.SymbolPlacement.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:l.SymbolAnchor.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},
"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:l.RotationAlignment.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",
values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:l.SymbolAnchor.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:l.TextJustification.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},
"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:l.RotationAlignment.AUTO},"text-size":{type:"number",minimum:0,default:16},
"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:l.TextTransform.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[l.TextWritingMode.HORIZONTAL]}};h.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:l.Visibility.VISIBLE}};h.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}};
h.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:l.TranslateAnchor.MAP}};h.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",
default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:l.TranslateAnchor.MAP},"line-width":{type:"number",minimum:0,default:1}};h.symbolPaintDefinition={"icon-color":{type:"color",
default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:l.TranslateAnchor.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},
"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:l.TranslateAnchor.MAP}};h.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",
minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};h.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",
minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:l.TranslateAnchor.MAP}};l.StyleDefinition=h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p,g,f){const d=1/65536;g=function(b){function a(){var c=e.apply(this,arguments);c._fillProgramOptions={id:!1,pattern:!1};c._outlineProgramOptions={id:!1};return c}h._inherits(a,b);var e=h._createSuper(a);b=a.prototype;b.dispose=function(){};b.drawMany=function(c,m){const {displayLevel:k,drawPhase:n,renderPass:x,spriteMosaic:q,styleLayerUID:B}=c;var y=!1;for(var u of m)if(u.layerData.has(B)){var v=u.layerData.get(B);if(0<v.fillIndexCount||0<v.outlineIndexCount){y=!0;break}}if(y){y=
c.styleLayer;var r=y.getPaintProperty("fill-pattern");v=(u=void 0!==r)&&r.isDataDriven;if(u&&!v){var z=r.getValue(k);z=q.getMosaicItemPosition(z,!0)}r=!u&&y.getPaintValue("fill-antialias",k);var A=!0,C=1;if(!u){var F=y.getPaintProperty("fill-color"),G=y.getPaintProperty("fill-opacity");F?.isDataDriven||G?.isDataDriven||(C=y.getPaintValue("fill-color",k),C=y.getPaintValue("fill-opacity",k)*C[3],1<=C&&(A=!1))}if(!A||"opaque"!==x){var H;n===t.WGLDrawPhase.HITTEST&&(H=p.u32to4Xu8(B+1));F=y.getPaintValue("fill-translate",
k);G=y.getPaintValue("fill-translate-anchor",k);(A||"translucent"!==x)&&this._drawFill(c,B,y,m,F,G,u,z,v,H);z=!y.hasDataDrivenOutlineColor&&y.outlineUsesFillColor&&1>C;r&&"opaque"!==x&&!z&&this._drawOutline(c,B,y,m,F,G,H)}}};b._drawFill=function(c,m,k,n,x,q,B,y,u,v){if(!B||u||!D.isNone(y)){var {context:r,displayLevel:z,state:A,drawPhase:C,painter:F,pixelRatio:G,spriteMosaic:H,requestRender:K,allowDelayedRender:J}=c;c=k.fillMaterial;var N=F.vectorTilesMaterialManager,P=G>w.VTL_HIGH_RES_CUTOFF?2:1,
W=C===t.WGLDrawPhase.HITTEST,X=this._fillProgramOptions;X.id=W;X.pattern=B;N=N.getMaterialProgram(r,c,X);if(J&&D.isSome(K)&&!N.compiled)K();else{r.useProgram(N);D.isSome(y)&&({page:y}=y,X=H.getPageSize(y),D.isSome(X)&&(H.bind(r,f.TextureSamplingMode.LINEAR,y,w.VTL_TEXTURE_BINDING_UNIT_SPRITES),N.setUniform2fv("u_mosaicSize",X),N.setUniform1i("u_texture",w.VTL_TEXTURE_BINDING_UNIT_SPRITES)));N.setUniformMatrix3fv("u_displayMat3",q===E.TranslateAnchor.VIEWPORT?A.displayMat3:A.displayViewMat3);N.setUniform2fv("u_fillTranslation",
x);N.setUniform1f("u_depth",k.z+d);W&&N.setUniform4fv("u_id",v);x=-1;for(const aa of n)if(aa.layerData.has(m)&&(aa.key.level!==x&&(x=aa.key.level,c.setDataUniforms(N,z,k,x,H)),n=aa.layerData.get(m),n.fillIndexCount&&(n.prepareForRendering(r),q=n.fillVertexArrayObject,!D.isNone(q)))){r.bindVAO(q);N.setUniformMatrix3fv("u_dvsMat3",aa.transforms.dvs);r.setStencilFunction(f.CompareFunction.EQUAL,aa.stencilRef,255);B&&N.setUniform1f("u_patternFactor",aa.rangeX/(P*aa.width*Math.max(2**(Math.round(z)-aa.key.level),
1)));if(u){q=n.patternMap;if(!q)continue;for(const [Z,ea]of q)q=H.getPageSize(Z),D.isSome(q)&&(H.bind(r,f.TextureSamplingMode.LINEAR,Z,w.VTL_TEXTURE_BINDING_UNIT_SPRITES),N.setUniform2fv("u_mosaicSize",q),N.setUniform1i("u_texture",w.VTL_TEXTURE_BINDING_UNIT_SPRITES),r.drawElements(f.PrimitiveType.TRIANGLES,ea[1],f.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*ea[0]))}else r.drawElements(f.PrimitiveType.TRIANGLES,n.fillIndexCount,f.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*n.fillIndexStart);
aa.triangleCount+=n.fillIndexCount/3}}}};b._drawOutline=function(c,m,k,n,x,q,B){const {context:y,displayLevel:u,state:v,drawPhase:r,painter:z,pixelRatio:A,spriteMosaic:C,requestRender:F,allowDelayedRender:G}=c;c=k.outlineMaterial;var H=z.vectorTilesMaterialManager;const K=.75/A,J=r===t.WGLDrawPhase.HITTEST,N=this._outlineProgramOptions;N.id=J;H=H.getMaterialProgram(y,c,N);if(G&&D.isSome(F)&&!H.compiled)F();else{y.useProgram(H);H.setUniformMatrix3fv("u_displayMat3",q===E.TranslateAnchor.VIEWPORT?v.displayMat3:
v.displayViewMat3);H.setUniform2fv("u_fillTranslation",x);H.setUniform1f("u_depth",k.z+d);H.setUniform1f("u_outline_width",K);J&&H.setUniform4fv("u_id",B);x=-1;for(const P of n)P.layerData.has(m)&&(P.key.level!==x&&(x=P.key.level,c.setDataUniforms(H,u,k,x,C)),n=P.layerData.get(m),n.prepareForRendering(y),n.outlineIndexCount&&(q=n.outlineVertexArrayObject,D.isNone(q)||(y.bindVAO(q),H.setUniformMatrix3fv("u_dvsMat3",P.transforms.dvs),y.setStencilFunction(f.CompareFunction.EQUAL,P.stencilRef,255),y.drawElements(f.PrimitiveType.TRIANGLES,
n.outlineIndexCount,f.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*n.outlineIndexStart),P.triangleCount+=n.outlineIndexCount/3)))}};return h._createClass(a)}(g);l.WGLBrushVTLFill=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../number ./WGLBrush ../../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p,g,f){g=function(d){function b(){var e=a.apply(this,arguments);e._programOptions={id:!1,pattern:!1,sdf:!1};return e}h._inherits(b,d);var a=h._createSuper(b);d=b.prototype;d.dispose=function(){};d.drawMany=function(e,c){const {context:m,displayLevel:k,state:n,drawPhase:x,painter:q,pixelRatio:B,spriteMosaic:y,styleLayerUID:u,requestRender:v,allowDelayedRender:r}=e;if(c.some(aa=>aa.layerData.get(u)?.lineIndexCount??!1)){e=e.styleLayer;var z=e.lineMaterial,A=q.vectorTilesMaterialManager,
C=e.getPaintValue("line-translate",k),F=e.getPaintValue("line-translate-anchor",k),G=e.getPaintProperty("line-pattern"),H=void 0!==G,K=H&&G.isDataDriven;if(H&&!K){G=G.getValue(k);var J=y.getMosaicItemPosition(G)}var N;G=!1;if(!H){var P=e.getPaintProperty("line-dasharray");G=(N=void 0!==P)&&P.isDataDriven;N&&!G&&(J=P.getValue(k),J=e.getDashKey(J,e.getLayoutValue("line-cap",k)),J=y.getMosaicItemPosition(J))}P=1/B;var W=x===t.WGLDrawPhase.HITTEST,X=this._programOptions;X.id=W;X.pattern=H;X.sdf=N;N=A.getMaterialProgram(m,
z,X);if(r&&D.isSome(v)&&!N.compiled)v();else{m.useProgram(N);N.setUniformMatrix3fv("u_displayViewMat3",n.displayViewMat3);N.setUniformMatrix3fv("u_displayMat3",F===E.TranslateAnchor.VIEWPORT?n.displayMat3:n.displayViewMat3);N.setUniform2fv("u_lineTranslation",C);N.setUniform1f("u_depth",e.z);N.setUniform1f("u_antialiasing",P);W&&(C=p.u32to4Xu8(u+1),N.setUniform4fv("u_id",C));J&&D.isSome(J)&&({page:C}=J,F=y.getPageSize(C),D.isSome(F)&&(y.bind(m,f.TextureSamplingMode.LINEAR,C,w.VTL_TEXTURE_BINDING_UNIT_SPRITES),
N.setUniform2fv("u_mosaicSize",F),N.setUniform1i("u_texture",w.VTL_TEXTURE_BINDING_UNIT_SPRITES)));C=-1;for(const aa of c)if(aa.layerData.has(u)&&(aa.key.level!==C&&(C=aa.key.level,z.setDataUniforms(N,k,e,C,y)),N.setUniform1f("u_zoomFactor",2**(k-C)/B),c=aa.layerData.get(u),c.lineIndexCount&&(c.prepareForRendering(m),F=c.lineVertexArrayObject,!D.isNone(F)))){m.bindVAO(F);N.setUniformMatrix3fv("u_dvsMat3",aa.transforms.dvs);m.setStencilFunction(f.CompareFunction.EQUAL,aa.stencilRef,255);if(K||G){F=
c.patternMap;if(!F)continue;for(const [Z,ea]of F)F=y.getPageSize(Z),D.isSome(F)&&(y.bind(m,f.TextureSamplingMode.LINEAR,Z,w.VTL_TEXTURE_BINDING_UNIT_SPRITES),N.setUniform2fv("u_mosaicSize",F),N.setUniform1i("u_texture",w.VTL_TEXTURE_BINDING_UNIT_SPRITES),m.drawElements(f.PrimitiveType.TRIANGLES,ea[1],f.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*ea[0]))}else m.drawElements(f.PrimitiveType.TRIANGLES,c.lineIndexCount,f.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*c.lineIndexStart);aa.triangleCount+=
c.lineIndexCount/3}}}};return h._createClass(b)}(g);l.WGLBrushVTLLine=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec2f32 ../../vectorTiles/decluttering/config ../../vectorTiles/style/StyleDefinition ../definitions ../enums ../GeometryUtils ../number ./WGLBrush ../../../../webgl/enums".split(" "),function(l,
h,D,E,w,t,p,g,f,d,b,a){const e=1/65536;b=function(c){function m(){var n=k.apply(this,arguments);n._iconProgramOptions={id:!1,sdf:!1};n._sdfProgramOptions={id:!1};n._spritesTextureSize=E.create();return n}h._inherits(m,c);var k=h._createSuper(m);c=m.prototype;c.dispose=function(){};c.drawMany=function(n,x){const {drawPhase:q,styleLayerUID:B}=n,y=n.styleLayer;let u;q===g.WGLDrawPhase.HITTEST&&(u=d.u32to4Xu8(B+1));this._drawIcons(n,y,x,u);this._drawText(n,y,x,u)};c._drawIcons=function(n,x,q,B){const {context:y,
displayLevel:u,drawPhase:v,painter:r,spriteMosaic:z,state:A,styleLayerUID:C,requestRender:F,allowDelayedRender:G}=n,H=x.iconMaterial;var K=r.vectorTilesMaterialManager,J=!1;for(var N of q)if(N.layerData.has(C)){var P=N.layerData.get(C);if(0<P.iconPerPageElementsMap.size){J=!0;break}}if(J){J=x.getPaintValue("icon-translate",u);N=x.getPaintValue("icon-translate-anchor",u);var W=x.getLayoutValue("icon-rotation-alignment",u);W===t.RotationAlignment.AUTO&&(W=x.getLayoutValue("symbol-placement",u)===t.SymbolPlacement.POINT?
t.RotationAlignment.VIEWPORT:t.RotationAlignment.MAP);var X=W===t.RotationAlignment.MAP;X=x.getLayoutValue("icon-keep-upright",u)&&X;var aa=P.isIconSDF;P=v===g.WGLDrawPhase.HITTEST;var Z=this._iconProgramOptions;Z.id=P;Z.sdf=aa;K=K.getMaterialProgram(y,H,Z);if(G&&D.isSome(F)&&!K.compiled)F();else{y.useProgram(K);K.setUniformMatrix3fv("u_displayViewMat3",W===t.RotationAlignment.MAP?A.displayViewMat3:A.displayMat3);K.setUniformMatrix3fv("u_displayMat3",N===t.TranslateAnchor.VIEWPORT?A.displayMat3:A.displayViewMat3);
K.setUniform2fv("u_iconTranslation",J);K.setUniform1f("u_depth",x.z);K.setUniform1f("u_mapRotation",f.degToByte(A.rotation));K.setUniform1f("u_keepUpright",X?1:0);K.setUniform1f("u_level",10*u);K.setUniform1i("u_texture",p.VTL_TEXTURE_BINDING_UNIT_SPRITES);K.setUniform1f("u_fadeDuration",w.FADE_DURATION/1E3);P&&K.setUniform4fv("u_id",B);B=-1;for(const ea of q)if(ea.layerData.has(C)&&(ea.key.level!==B&&(B=ea.key.level,H.setDataUniforms(K,u,x,B,z)),P=ea.layerData.get(C),0!==P.iconPerPageElementsMap.size&&
(P.prepareForRendering(y),P.updateOpacityInfo(),q=P.iconVertexArrayObject,!D.isNone(q)))){y.bindVAO(q);K.setUniformMatrix3fv("u_dvsMat3",ea.transforms.dvs);K.setUniform1f("u_time",(performance.now()-P.lastOpacityUpdate)/1E3);for(const [T,I]of P.iconPerPageElementsMap)this._renderIconRange(n,K,I,T,ea)}}}};c._renderIconRange=function(n,x,q,B,y){const {context:u,spriteMosaic:v}=n;this._spritesTextureSize[0]=v.getWidth(B)/4;this._spritesTextureSize[1]=v.getHeight(B)/4;x.setUniform2fv("u_mosaicSize",this._spritesTextureSize);
v.bind(u,a.TextureSamplingMode.LINEAR,B,p.VTL_TEXTURE_BINDING_UNIT_SPRITES);u.setStencilTestEnabled(!0);u.setStencilFunction(a.CompareFunction.GREATER,255,255);u.setStencilWriteMask(0);u.drawElements(a.PrimitiveType.TRIANGLES,q[1],a.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*q[0]);y.triangleCount+=q[1]/3};c._drawText=function(n,x,q,B){const {context:y,displayLevel:u,drawPhase:v,glyphMosaic:r,painter:z,pixelRatio:A,spriteMosaic:C,state:F,styleLayerUID:G,requestRender:H,allowDelayedRender:K}=
n;n=x.textMaterial;const J=z.vectorTilesMaterialManager;var N=!1;for(var P of q)if(P.layerData.has(G)){var W=P.layerData.get(G);if(0<W.glyphPerPageElementsMap.size){N=!0;break}}if(N&&(W=x.getPaintProperty("text-opacity"),!W||W.isDataDriven||0!==W.getValue(u))){W=x.getPaintProperty("text-color");var X=!W||W.isDataDriven||0<W.getValue(u)[3];W=x.getPaintProperty("text-halo-width");P=x.getPaintProperty("text-halo-color");var aa=(!W||W.isDataDriven||0<W.getValue(u))&&(!P||P.isDataDriven||0<P.getValue(u)[3]);
if(X||aa){W=x.getLayoutValue("text-rotation-alignment",u);W===t.RotationAlignment.AUTO&&(W=x.getLayoutValue("symbol-placement",u)===t.SymbolPlacement.POINT?t.RotationAlignment.VIEWPORT:t.RotationAlignment.MAP);P=W===t.RotationAlignment.MAP;P=x.getLayoutValue("text-keep-upright",u)&&P;N=v===g.WGLDrawPhase.HITTEST;var Z=.8*3/A;this._glyphTextureSize||(this._glyphTextureSize=E.fromValues(r.width/4,r.height/4));var ea=x.getPaintValue("text-translate",u),T=x.getPaintValue("text-translate-anchor",u),I=
this._sdfProgramOptions;I.id=N;var M=J.getMaterialProgram(y,n,I);if(K&&D.isSome(H)&&!M.compiled)H();else{y.useProgram(M);M.setUniformMatrix3fv("u_displayViewMat3",W===t.RotationAlignment.MAP?F.displayViewMat3:F.displayMat3);M.setUniformMatrix3fv("u_displayMat3",T===t.TranslateAnchor.VIEWPORT?F.displayMat3:F.displayViewMat3);M.setUniform2fv("u_textTranslation",ea);M.setUniform1f("u_depth",x.z+e);M.setUniform2fv("u_mosaicSize",this._glyphTextureSize);M.setUniform1f("u_mapRotation",f.degToByte(F.rotation));
M.setUniform1f("u_keepUpright",P?1:0);M.setUniform1f("u_level",10*u);M.setUniform1i("u_texture",p.VTL_TEXTURE_BINDING_UNIT_GLYPHS);M.setUniform1f("u_antialiasingWidth",Z);M.setUniform1f("u_fadeDuration",w.FADE_DURATION/1E3);N&&M.setUniform4fv("u_id",B);B=-1;for(const S of q)S.layerData.has(G)&&(S.key.level!==B&&(B=S.key.level,n.setDataUniforms(M,u,x,B,C)),W=S.layerData.get(G),0!==W.glyphPerPageElementsMap.size&&(W.prepareForRendering(y),W.updateOpacityInfo(),q=W.textVertexArrayObject,D.isNone(q)||
(y.bindVAO(q),M.setUniformMatrix3fv("u_dvsMat3",S.transforms.dvs),y.setStencilTestEnabled(!0),y.setStencilFunction(a.CompareFunction.GREATER,255,255),y.setStencilWriteMask(0),q=(performance.now()-W.lastOpacityUpdate)/1E3,M.setUniform1f("u_time",q),W.glyphPerPageElementsMap.forEach((V,Q)=>{this._renderGlyphRange(y,V,Q,r,M,aa,X,S)}))))}}}};c._renderGlyphRange=function(n,x,q,B,y,u,v,r){B.bind(n,a.TextureSamplingMode.LINEAR,q,p.VTL_TEXTURE_BINDING_UNIT_GLYPHS);u&&(y.setUniform1f("u_halo",1),n.drawElements(a.PrimitiveType.TRIANGLES,
x[1],a.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*x[0]),r.triangleCount+=x[1]/3);v&&(y.setUniform1f("u_halo",0),n.drawElements(a.PrimitiveType.TRIANGLES,x[1],a.DataType.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*x[0]),r.triangleCount+=x[1]/3)};return h._createClass(m)}(b);l.WGLBrushVTLSymbol=b;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(l){l.COLLISION_GRID_CELL_SIZE=32;l.DECLUTTER_BUDGET=
1.5;l.DECLUTTER_TILES=!0;l.FADE_DURATION=200;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(l){function h(t,p){t%=p;return 0<=t?t:t+p}const D=128/Math.PI,E=256/360,w=1/Math.LN2;l.between=function(t,p,g){return t>=p&&t<=g||t>=g&&t<=p};l.degToByte=function(t){return h(t*E,256)};l.interpolate=function(t,p,g){return t*(1-g)+p*g};l.log2=function(t){return Math.log(t)*w};l.positiveMod=h;l.radToByte=function(t){return h(t*
D,256)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t,p){return function(g){function f(){return d.apply(this,arguments)}l._inherits(f,g);var d=l._createSuper(f);g=f.prototype;g.dispose=function(){};g.getGeometryType=
function(){return D.WGLGeometryType.LABEL};g.supportsSymbology=function(b){return!0};g.drawGeometry=function(b,a,e,c){const {context:m,painter:k,state:n,rendererInfo:x,requestRender:q,allowDelayedRender:B}=b,y=t.LabelMaterialKey.load(e.materialKey),u=y.mapAligned?1:0;if(u||!(1<=Math.abs(a.key.level-Math.round(100*b.displayLevel)/100))){var {bufferLayouts:v,attributes:r}=E.createProgramDescriptor(y.data,{geometry:[{location:0,name:"a_pos",count:2,type:p.DataType.SHORT},{location:1,name:"a_id",count:4,
type:p.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:p.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:p.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:p.DataType.UNSIGNED_BYTE},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:p.DataType.UNSIGNED_BYTE},{location:6,name:"a_glyphData",count:4,type:p.DataType.UNSIGNED_BYTE},{location:7,name:"a_vertexOffset",count:2,type:p.DataType.SHORT},{location:8,
name:"a_texCoords",count:2,type:p.DataType.UNSIGNED_SHORT}]});c=k.materialManager.getMaterialProgram(b,y,"materials/label",r,c);if(B&&h.isSome(q)&&!c.compiled)q();else{b.context.setStencilFunction(p.CompareFunction.EQUAL,0,255);m.useProgram(c);this._setSharedUniforms(c,b,a);k.textureManager.bindTextures(m,c,y);var z=1===u?n.displayViewMat3:n.displayMat3;this._setSizeVVUniforms(y,c,x,a);c.setUniform1f("u_mapRotation",Math.floor(n.rotation/360*254));c.setUniform1f("u_mapAligned",u);c.setUniformMatrix3fv("u_displayMat3",
z);c.setUniform1f("u_opacity",1);c.setUniform2fv("u_screenSize",b.state.size);b=e.target.getVAO(m,v,r);a=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT;m.bindVAO(b);c.setUniform1f("u_isHaloPass",0);c.setUniform1f("u_isBackgroundPass",1);m.drawElements(p.PrimitiveType.TRIANGLES,e.indexCount,p.DataType.UNSIGNED_INT,a);c.setUniform1f("u_isHaloPass",1);c.setUniform1f("u_isBackgroundPass",0);m.drawElements(p.PrimitiveType.TRIANGLES,e.indexCount,p.DataType.UNSIGNED_INT,a);c.setUniform1f("u_isHaloPass",0);c.setUniform1f("u_isBackgroundPass",
0);m.drawElements(p.PrimitiveType.TRIANGLES,e.indexCount,p.DataType.UNSIGNED_INT,a);m.setStencilTestEnabled(!0);m.setBlendingEnabled(!0)}}};return l._createClass(f)}(w)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t,p){return function(g){function f(){return d.apply(this,arguments)}
l._inherits(f,g);var d=l._createSuper(f);g=f.prototype;g.dispose=function(){};g.getGeometryType=function(){return D.WGLGeometryType.LINE};g.supportsSymbology=function(b){return!0};g.drawGeometry=function(b,a,e,c){const {context:m,painter:k,rendererInfo:n,displayLevel:x,passOptions:q,requestRender:B,allowDelayedRender:y}=b,u=t.LineMaterialKey.load(e.materialKey),v=h.isSome(q)&&"hittest"===q.type;var r=E.createProgramDescriptor(u.data,{geometry:[{location:0,name:"a_pos",count:2,type:p.DataType.SHORT},
{location:1,name:"a_id",count:4,type:p.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:p.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:p.DataType.BYTE},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:p.DataType.UNSIGNED_SHORT},{location:5,name:"a_tlbr",count:4,type:p.DataType.UNSIGNED_SHORT},{location:6,name:"a_segmentDirection",count:4,type:p.DataType.BYTE},{location:7,name:"a_aux",count:2,type:p.DataType.UNSIGNED_SHORT},
{location:8,name:"a_zoomRange",count:2,type:p.DataType.UNSIGNED_SHORT}]});let z=p.PrimitiveType.TRIANGLES;v&&(r=this._getTriangleDesc(e.materialKey,r),z=p.PrimitiveType.POINTS);const {attributes:A,bufferLayouts:C}=r;c=k.materialManager.getMaterialProgram(b,u,"materials/line",A,c);y&&h.isSome(B)&&!c.compiled?B():(r=1/b.pixelRatio,m.useProgram(c),this._setSharedUniforms(c,b,a),u.textureBinding&&k.textureManager.bindTextures(m,c,u),c.setUniform1f("u_zoomFactor",2**(x-a.key.level)),c.setUniform1f("u_blur",
0+r),c.setUniform1f("u_antialiasing",r),this._setSizeVVUniforms(u,c,n,a),this._setColorAndOpacityVVUniforms(u,c,n),m.setFaceCullingEnabled(!1),b=e.target.getVAO(m,C,A,v),a=e.indexCount,e=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT,v&&(a/=3,e/=3),m.bindVAO(b),m.drawElements(z,a,p.DataType.UNSIGNED_INT,e))};return l._createClass(f)}(w)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey ../../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p){return function(g){function f(){return d.apply(this,arguments)}l._inherits(f,g);var d=l._createSuper(f);g=f.prototype;g.dispose=function(){};g.getGeometryType=function(){return D.WGLGeometryType.TEXT};g.supportsSymbology=function(b){return!0};g.drawGeometry=function(b,a,e,c){const {context:m,painter:k,rendererInfo:n,state:x,passOptions:q,requestRender:B,allowDelayedRender:y}=b,u=t.TextMaterialKey.load(e.materialKey),v=h.isSome(q)&&"hittest"===q.type,{bufferLayouts:r,attributes:z}=
E.createProgramDescriptor(u.data,{geometry:[{location:0,name:"a_pos",count:2,type:p.DataType.SHORT},{location:1,name:"a_id",count:4,type:p.DataType.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:p.DataType.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:p.DataType.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:p.DataType.UNSIGNED_BYTE},{location:5,name:"a_aux",count:4,type:p.DataType.BYTE},{location:6,name:"a_zoomRange",count:2,type:p.DataType.UNSIGNED_SHORT},
{location:7,name:"a_vertexOffset",count:2,type:p.DataType.SHORT},{location:8,name:"a_texCoords",count:2,type:p.DataType.UNSIGNED_SHORT}]});c=k.materialManager.getMaterialProgram(b,u,"materials/text",z,c);if(y&&h.isSome(B)&&!c.compiled)B();else{m.useProgram(c);var A=p.PrimitiveType.TRIANGLES;v&&(A=p.PrimitiveType.POINTS);this._setSharedUniforms(c,b,a);k.textureManager.bindTextures(m,c,u);c.setUniformMatrix3fv("u_displayMat3",x.displayMat3);c.setUniformMatrix3fv("u_displayViewMat3",x.displayViewMat3);
this._setSizeVVUniforms(u,c,n,a);this._setColorAndOpacityVVUniforms(u,c,n);this._setRotationVVUniforms(u,c,n);b=e.target.getVAO(m,r,z);a=e.indexFrom*Uint32Array.BYTES_PER_ELEMENT;c.setUniform1f("u_isHaloPass",0);c.setUniform1f("u_isBackgroundPass",1);m.bindVAO(b);m.drawElements(A,e.indexCount,p.DataType.UNSIGNED_INT,a);c.setUniform1f("u_isHaloPass",1);c.setUniform1f("u_isBackgroundPass",0);m.drawElements(p.PrimitiveType.TRIANGLES,e.indexCount,p.DataType.UNSIGNED_INT,a);c.setUniform1f("u_isHaloPass",
0);c.setUniform1f("u_isBackgroundPass",0);m.drawElements(A,e.indexCount,p.DataType.UNSIGNED_INT,a)}};return l._createClass(f)}(w)})},"esri/views/2d/engine/vectorTiles/shaders/VTLMaterialManager":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","./Programs"],function(l,h,D){return function(){function E(){this._programByKey=new Map}var w=E.prototype;w.dispose=function(){this._programByKey.forEach(t=>t.dispose());this._programByKey.clear()};w.getMaterialProgram=function(t,
p,g){const f=p.key<<3|this._getMaterialOptionsValue(p.type,g);if(this._programByKey.has(f))return this._programByKey.get(f);var d=this._getProgramTemplate(p.type);({shaders:d}=d);const {vertexShader:b,fragmentShader:a}=d(g);g=p.getShaderHeader();d=p.getShaderMain();g=b.replace("#pragma header",g).replace("#pragma main",d);t=t.programCache.acquire(g,a,p.getAttributeLocations());this._programByKey.set(f,t);return t};w._getMaterialOptionsValue=function(t,p){switch(t){case h.ShaderProgramType.BACKGROUND:return(p.pattern?
1:0)<<1|(p.id?1:0);case h.ShaderProgramType.FILL:return(p.pattern?1:0)<<1|(p.id?1:0);case h.ShaderProgramType.OUTLINE:return p.id?1:0;case h.ShaderProgramType.LINE:return(p.sdf?1:0)<<2|(p.pattern?1:0)<<1|(p.id?1:0);case h.ShaderProgramType.ICON:return(p.sdf?1:0)<<1|(p.id?1:0);case h.ShaderProgramType.CIRCLE:return p.id?1:0;case h.ShaderProgramType.TEXT:return p.id?1:0;default:return 0}};w._getProgramTemplate=function(t){switch(t){case h.ShaderProgramType.BACKGROUND:return D.background;case h.ShaderProgramType.CIRCLE:return D.circle;
case h.ShaderProgramType.FILL:return D.fill;case h.ShaderProgramType.ICON:return D.icon;case h.ShaderProgramType.LINE:return D.line;case h.ShaderProgramType.OUTLINE:return D.outline;case h.ShaderProgramType.TEXT:return D.text;default:return null}};return l._createClass(E)}()})},"esri/views/2d/engine/vectorTiles/enums":function(){define(["exports"],function(l){l.BucketType=void 0;(function(h){h[h.FILL=1]="FILL";h[h.LINE=2]="LINE";h[h.SYMBOL=3]="SYMBOL";h[h.CIRCLE=4]="CIRCLE"})(l.BucketType||(l.BucketType=
{}));l.ShaderProgramType=void 0;(function(h){h[h.BACKGROUND=0]="BACKGROUND";h[h.FILL=1]="FILL";h[h.OUTLINE=2]="OUTLINE";h[h.LINE=3]="LINE";h[h.ICON=4]="ICON";h[h.CIRCLE=5]="CIRCLE";h[h.TEXT=6]="TEXT";h[h.TILEINFO=7]="TILEINFO"})(l.ShaderProgramType||(l.ShaderProgramType={}));l.StyleUpdateType=void 0;(function(h){h[h.PAINTER_CHANGED=0]="PAINTER_CHANGED";h[h.LAYOUT_CHANGED=1]="LAYOUT_CHANGED";h[h.LAYER_CHANGED=2]="LAYER_CHANGED";h[h.LAYER_REMOVED=3]="LAYER_REMOVED";h[h.SPRITES_CHANGED=4]="SPRITES_CHANGED"})(l.StyleUpdateType||
(l.StyleUpdateType={}));Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["exports","./sources/resolver","../../../../webgl/programUtils"],function(l,h,D){l.background={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern})+h.resolveIncludes("background/background.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern})+h.resolveIncludes("background/background.frag")})};l.circle={shaders:E=>
({vertexShader:D.glslifyDefineMap({ID:E.id})+h.resolveIncludes("circle/circle.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id})+h.resolveIncludes("circle/circle.frag")})};l.fill={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern})+h.resolveIncludes("fill/fill.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern})+h.resolveIncludes("fill/fill.frag")})};l.icon={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id,SDF:E.sdf})+h.resolveIncludes("icon/icon.vert"),
fragmentShader:D.glslifyDefineMap({ID:E.id,SDF:E.sdf})+h.resolveIncludes("icon/icon.frag")})};l.line={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern,SDF:E.sdf})+h.resolveIncludes("line/line.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id,PATTERN:E.pattern,SDF:E.sdf})+h.resolveIncludes("line/line.frag")})};l.outline={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id})+h.resolveIncludes("outline/outline.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id})+h.resolveIncludes("outline/outline.frag")})};
l.text={shaders:E=>({vertexShader:D.glslifyDefineMap({ID:E.id})+h.resolveIncludes("text/text.vert"),fragmentShader:D.glslifyDefineMap({ID:E.id})+h.resolveIncludes("text/text.frag")})};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["exports","./shaderRepository","../../../../../webgl/ShaderCompiler"],function(l,h,D){const E=new D.ShaderCompiler(function(w){let t=h;w.split("/").forEach(p=>{t&&(t=t[p])});
return t});l.resolveIncludes=function(w){return E.resolveIncludes(w)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform lowp sampler2D u_texture;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d u_opacity * color;\n#else\ngl_FragColor \x3d u_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\nuniform mediump vec4 u_tlbr;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\n#endif\nvoid main() {\ngl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\nv_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d u_tlbr / u_mosaicSize.xyxy;\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float dist \x3d length(v_offset);\nmediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\nlowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\ngl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_stroke_color \x3d stroke_color * stroke_opacity;\nv_stroke_width \x3d stroke_width;\nv_radius \x3d radius;\nv_blur \x3d max(blur, u_antialiasingWidth / (radius + stroke_width));\nmediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\nv_offset \x3d offset;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\nmediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\nmediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color \x3d texture2D(u_texture, samplePos);\ngl_FragColor \x3d v_color[3] * color;\n#else\ngl_FragColor \x3d v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\n#include \x3cutil/util.glsl\x3e\nuniform mediump vec2 u_mosaicSize;\nuniform mediump float u_patternFactor;\nvarying mediump vec2 v_tileTextureCoord;\nvarying mediump vec4 v_tlbr;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\nfloat patternWidth \x3d nextPOT(tlbr.z - tlbr.x);\nfloat patternHeight \x3d nextPOT(tlbr.w - tlbr.y);\nfloat scaleX \x3d 1.0 / (patternWidth * u_patternFactor);\nfloat scaleY \x3d 1.0 / (patternHeight * u_patternFactor);\nmat3 patterMat \x3d mat3(scaleX, 0.0,    0.0,\n0.0,    -scaleY, 0.0,\n0.0,    0.0,    1.0);\nv_tileTextureCoord \x3d (patterMat * vec3(a_pos, 1.0)).xy;\nv_tlbr             \x3d tlbr / u_mosaicSize.xyxy;\n#endif\nvec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump flaot v_halo_width;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\nfloat compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\nvec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\nreturn vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\nlowp vec4 fillPixelColor \x3d v_color;\nfloat d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\nconst float softEdgeRatio \x3d 0.248062016;\nfloat size \x3d max(v_size.x, v_size.y);\nfloat dist \x3d d * softEdgeRatio * size;\nfillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\nif (v_halo_width \x3e 0.25) {\nlowp vec4 outlinePixelColor \x3d u_outlineColor;\nconst float outlineLimitRatio \x3d (16.0 / 86.0);\nfloat clampedOutlineSize \x3d softEdgeRatio * min(v_halo_width, outlineLimitRatio * max(v_size.x, v_size.y));\noutlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\ngl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n}\nelse {\ngl_FragColor \x3d v_opacity * fillPixelColor;\n}\n#else\nlowp vec4 texColor \x3d texture2D(u_texture, v_tex);\ngl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\n#ifdef SDF\nvarying mediump float v_halo_width;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nv_color \x3d color;\nv_opacity \x3d opacity;\n#ifdef SDF\nv_halo_width \x3d halo_width;\n#endif\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_opacity *\x3d interpolatedOpacity;\nmediump float a_angle         \x3d a_levelInfo[1];\nmediump float a_minLevel      \x3d a_levelInfo[2];\nmediump float a_maxLevel      \x3d a_levelInfo[3];\nmediump vec2 a_tex            \x3d a_texAngleRange.xy;\nmediump float delta_z \x3d 0.0;\nmediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_opacity, 0.0);\nvec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\nv_size \x3d abs(offset);\n#ifdef SDF\noffset \x3d (120.0 / 86.0) * offset;\n#endif\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_tex \x3d a_tex.xy / u_mosaicSize;\n}"},
line:{"line.frag":"precision lowp float;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#if defined (PATTERN) || defined(SDF)\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\nuniform sampler2D u_texture;\nuniform mediump float u_antialiasing;\n#endif\n#ifdef SDF\n#include \x3cutil/encoding.glsl\x3e\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nmediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\nlowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\nmediump float relativeTexX \x3d fract(v_accumulatedDistance / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d 0.5 + v_normal.y * v_lineHalfWidth / (v_patternSize.y * v_widthRatio);\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color \x3d texture2D(u_texture, texCoord);\ngl_FragColor \x3d alpha * v_color[3] * color;\n#elif defined(SDF)\nmediump float relativeTexX \x3d fract((v_accumulatedDistance * 0.5) / (v_patternSize.x * v_widthRatio));\nmediump float relativeTexY \x3d  0.5 + 0.25 * v_normal.y;\nmediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist \x3d d * (v_lineHalfWidth + u_antialiasing / 2.0);\ngl_FragColor \x3d alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n#else\ngl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_extrude_offset;\nattribute vec4 a_dir_normal;\nattribute vec2 a_accumulatedDistance;\n#pragma header\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump float u_zoomFactor;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\nconst mediump float tileCoordRatio \x3d 8.0;\n#if defined (SDF)\nconst mediump float sdfPatternHalfWidth \x3d 15.5;\n#endif\n#if defined (PATTERN) || defined(SDF)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\nvarying mediump float v_widthRatio;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\nv_blur \x3d blur + u_antialiasing;\nv_normal \x3d a_dir_normal.zw * scale;\n#if defined (PATTERN) || defined(SDF)\nv_tlbr          \x3d tlbr / u_mosaicSize.xyxy;\nv_patternSize   \x3d vec2(tlbr.z - tlbr.x, tlbr.y - tlbr.w);\n#if defined (PATTERN)\nv_widthRatio \x3d width / v_patternSize.y;\n#else\nv_widthRatio \x3d width / sdfPatternHalfWidth / 2.0;\n#endif\n#endif\nv_lineHalfWidth \x3d (width + u_antialiasing) * 0.5;\nmediump vec2 dir \x3d a_dir_normal.xy * scale;\nmediump vec2 offset_ \x3d a_extrude_offset.zw * scale * offset;\nmediump vec2 dist \x3d v_lineHalfWidth * scale * a_extrude_offset.xy;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos + offset_ * tileCoordRatio / u_zoomFactor, 1.0) + u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n#if defined (PATTERN) || defined(SDF)\nv_accumulatedDistance \x3d a_accumulatedDistance.x * u_zoomFactor / tileCoordRatio + dot(dir, dist + offset_);\n#endif\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d abs(v_normal.y);\nlowp float alpha \x3d smoothstep(1.0, 0.0, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#pragma main\nv_color \x3d color * opacity;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_normal \x3d a_xnormal;\nmediump vec2 dist \x3d u_outline_width * scale * a_offset;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nvarying lowp vec2 v_tex;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\nlowp float dist \x3d texture2D(u_texture, v_tex).a;\nmediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist);\ngl_FragColor \x3d alpha * v_color;\n#ifdef ID\nif (gl_FragColor.a \x3c 1.0 / 255.0) {\ndiscard;\n}\ngl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#pragma header\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nconst float sdfPixel \x3d 3.0;\nuniform highp float u_time;\nvoid main()\n{\n#pragma main\nif (u_halo \x3e 0.5)\n{\nv_color \x3d halo_color * opacity;\nhalo_width *\x3d sdfPixel;\nhalo_blur *\x3d sdfPixel;\n}\nelse\n{\nv_color \x3d color * opacity;\nhalo_width \x3d 0.0;\nhalo_blur \x3d 0.0;\n}\nfloat modded \x3d mod(a_opacityInfo, 128.0);\nfloat targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\nfloat startOpacity \x3d modded / 127.0;\nfloat interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\nv_color *\x3d interpolatedOpacity;\nmediump float a_angle       \x3d a_levelInfo[1];\nmediump float a_minLevel    \x3d a_levelInfo[2];\nmediump float a_maxLevel    \x3d a_levelInfo[3];\nmediump vec2 a_tex          \x3d a_texAngleRange.xy;\nmediump float a_visMinAngle    \x3d a_texAngleRange.z;\nmediump float a_visMaxAngle    \x3d a_texAngleRange.w;\nmediump float delta_z \x3d 0.0;\nmediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\nif (a_visMinAngle \x3c a_visMaxAngle)\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n}\nelse\n{\ndelta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n}\ndelta_z +\x3d 1.0 - step(a_minLevel, u_level);\ndelta_z +\x3d step(a_maxLevel, u_level);\ndelta_z +\x3d step(v_color[3], 0.0);\nv_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef ID\nv_id \x3d u_id / 255.0;\n#endif\nv_edgeDistance \x3d edgePos - halo_width / size;\nv_edgeWidth \x3d (u_antialiasingWidth + halo_blur) / size;\nmediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\ngl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}","util.glsl":"float nextPOT(in float x) {\nreturn pow(2.0, ceil(log2(abs(x))));\n}"}}})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./DefaultVertexAttributeLayouts ./shaders/BitBlitPrograms ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/ProgramTemplate ../../../webgl/VertexArrayObject".split(" "),
function(l,h,D,E,w,t,p,g,f){let d=function(){function b(){this._initialized=!1}var a=b.prototype;a.dispose=function(){this._program=D.disposeMaybe(this._program);this._vertexArrayObject=D.disposeMaybe(this._vertexArrayObject)};a.render=function(e,c,m,k){e&&(this._initialized||this._initialize(e),e.setBlendFunctionSeparate(p.BlendFactor.ONE,p.BlendFactor.ONE_MINUS_SRC_ALPHA,p.BlendFactor.ONE,p.BlendFactor.ONE_MINUS_SRC_ALPHA),e.bindVAO(this._vertexArrayObject),e.useProgram(this._program),c.setSamplingMode(m),
e.bindTexture(c,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",k),e.drawArrays(p.PrimitiveType.TRIANGLE_STRIP,0,4),e.bindTexture(null,0),e.bindVAO())};a._initialize=function(e){if(this._initialized)return!0;const c=g.createProgram(e,w.bitBlit);if(!c)return!1;const m=new Int8Array(16);m[0]=-1;m[1]=-1;m[2]=0;m[3]=0;m[4]=1;m[5]=-1;m[6]=1;m[7]=0;m[8]=-1;m[9]=1;m[10]=0;m[11]=1;m[12]=1;m[13]=1;m[14]=1;m[15]=1;e=new f.VertexArrayObject(e,w.bitBlit.attributes,E.PosTex2b,{geometry:t.BufferObject.createVertex(e,
p.Usage.STATIC_DRAW,m)});this._program=c;this._vertexArrayObject=e;return this._initialized=!0};return h._createClass(b)}();l.BitBlitRenderer=d;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(l,h){h={shaders:{vertexShader:h.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:h.resolveIncludes("bitBlit/bitBlit.frag")},attributes:new Map([["a_pos",0],["a_tex",1]])};l.bitBlit=
h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/maybe","./enums","./shaders/MaterialPrograms"],function(l,h,D,E){const w=({rendererInfo:p,drawPhase:g},f,d)=>`${f.getVariationHash()}-${(g===D.WGLDrawPhase.HITTEST||g===D.WGLDrawPhase.LABEL_ALPHA?1:0)|(g===D.WGLDrawPhase.HIGHLIGHT?2:0)}-${p.getVariationHash()}-${h.isSome(d)&&d.join(".")}`,t=(p,g,f,d={})=>
{d={...d};g={...g.getVariation()};var b={...p.rendererInfo.getVariation()},a=p.drawPhase;d={...d,...g,...b,highlight:p.drawPhase===D.WGLDrawPhase.HIGHLIGHT,id:a===D.WGLDrawPhase.HITTEST||a===D.WGLDrawPhase.LABEL_ALPHA};if(h.isSome(f))for(const e of f)d[e]=!0;return d};return function(){function p(f){this._rctx=f;this._programByKey=new Map}var g=p.prototype;g.dispose=function(){this._programByKey.forEach(f=>f.dispose());this._programByKey.clear()};g.getProgram=function(f,d=[]){const b=f.vsPath+"."+
f.fsPath+JSON.stringify(d);if(this._programByKey.has(b))return this._programByKey.get(b);d={...d.map(m=>"string"===typeof m?{name:m,value:!0}:m).reduce((m,k)=>({...m,[k.name]:k.value}),{})};const {vsPath:a,fsPath:e,attributes:c}=f;f=E.createProgramTemplate(a,e,c,d);f=this._rctx.programCache.acquire(f.shaders.vertexShader,f.shaders.fragmentShader,f.attributes);if(!f)throw Error("Unable to get program for key: ${key}");this._programByKey.set(b,f);return f};g.getMaterialProgram=function(f,d,b,a,e){const c=
w(f,d,e);if(this._programByKey.has(c))return this._programByKey.get(c);f=t(f,d,e,{ignoresSamplerPrecision:f.context.driverTest.ignoresSamplerPrecision.result});b=E.createProgramTemplate(b,b,a,f);b=this._rctx.programCache.acquire(b.shaders.vertexShader,b.shaders.fragmentShader,b.attributes);if(!b)throw Error("Unable to get program for key: ${key}");this._programByKey.set(c,b);return b};return l._createClass(p)}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["exports",
"./sources/resolver","../../../../webgl/programUtils"],function(l,h,D){l.createProgramTemplate=(E,w,t,p)=>{E+=E.substring(E.lastIndexOf("/"));w+=w.substring(w.lastIndexOf("/"));const g={};for(const d in p){let b=void 0;var f=d;b=""+f[0].toUpperCase();for(let a=1;a<f.length;a++){const e=f[a];e===e.toUpperCase()?(b+="_",b+=e):b+=e.toUpperCase()}g[b]=p[d]}p=D.glslifyDefineMap(g);return{attributes:t,shaders:{vertexShader:p+h.resolveIncludes(`${E}.vert`),fragmentShader:p+h.resolveIncludes(`${w}.frag`)}}};
Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../request ../../../../core/BidiText ../../../../core/Error ../../../../core/fontUtils ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../chunks/vec2 ../../../../chunks/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./Utils ./animatedFormats/AnimatableTextureResource ./animatedFormats/utils ./util/Result ./util/symbolUtils ../../../support/QueueProcessor ../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q,B,y,u,v,r,z,A,C){function F(J,N){N=Math.round(b.pt2px(N)*window.devicePixelRatio);return Math.min(J,N*(128<=N?2:4))}const G=e.create(),H=p.getLogger("esri.views.2d.engine.webgl.TextureManager");let K=function(){function J(N,P,W){this.mosaicType=N;this.page=P;this.sdf=W}J.fromMosaic=function(N,P){return new J(N,P.page,P.sdf)};return l._createClass(J)}();return function(){function J(P,W,X){this._requestRender=P;this.resourceManager=W;this._allowNonPowerOfTwo=
X;this._invalidFontsMap=new Map;this._sdfConverter=new q(m.SDF_TEXTURE_SIZE);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._ongoingRasterizations=new Map;this._imageRequestQueue=new A.QueueProcessor({concurrency:10,process:async(aa,Z)=>{d.throwIfAborted(Z);try{return await D(aa,{responseType:"image",signal:Z})}catch(ea){if(!d.isAbortError(ea))throw new w("mapview-invalid-resource",`Could not fetch requested resource at ${aa}`,ea);throw ea;}}});this._spriteMosaic=new B(2048,2048,500);
this._glyphSource=new x(`${h.fontsUrl}/{fontstack}/{range}.pbf`);this._glyphMosaic=new n(1024,1024,this._glyphSource);this._rasterizer=new c(W)}var N=J.prototype;N.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._glyphMosaic=this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=
null;this._imageRequestQueue.clear();this._imageRequestQueue=null};N.rasterizeItem=async function(P,W,X,aa){if(f.isNone(P))return H.error(new w("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(P.type){case "text":case "esriTS":return P=await this._rasterizeText(P,X,aa),P.forEach(Z=>this._setTextureBinding(k.MosaicType.GLYPH,Z)),{glyphMosaicItems:P};default:if(y.is3D(P))return H.error(new w("mapview-invalid-type",`MapView does not support symbol type: ${P.type}`,P)),
null;P=await this._rasterizeSpriteSymbol(P,W,aa);r.ok(P)&&P&&this._setTextureBinding(k.MosaicType.SPRITE,P);return{spriteMosaicItem:P}}};N.bindTextures=function(P,W,X,aa=!1){if(0!==X.textureBinding){var Z=this._bindingInfos[X.textureBinding-1];X=Z.page;aa=aa?C.TextureSamplingMode.LINEAR_MIPMAP_LINEAR:C.TextureSamplingMode.LINEAR;switch(Z.mosaicType){case k.MosaicType.SPRITE:Z=this.sprites.getWidth(X);const ea=this.sprites.getHeight(X);Z=a.set(G,Z,ea);this._spriteMosaic.bind(P,aa,X,m.TEXTURE_BINDING_SPRITE_ATLAS);
W.setUniform1i("u_texture",m.TEXTURE_BINDING_SPRITE_ATLAS);W.setUniform2fv("u_mosaicSize",Z);break;case k.MosaicType.GLYPH:Z=a.set(G,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(P,aa,X,m.TEXTURE_BINDING_GLYPH_ATLAS);W.setUniform1i("u_texture",m.TEXTURE_BINDING_GLYPH_ATLAS);W.setUniform2fv("u_mosaicSize",Z);break;default:H.error("mapview-texture-manager",`Cannot handle unknown type ${Z.mosaicType}`)}}};N._hashMosaic=function(P,W){return 1|P<<1|(W.sdf?1:0)<<2|W.page<<3};N._setTextureBinding=
function(P,W){const X=this._hashMosaic(P,W);this._hashToBindingIndex.has(X)||(P=K.fromMosaic(P,W),this._hashToBindingIndex.set(X,this._bindingInfos.length+1),this._bindingInfos.push(P));W.textureBinding=this._hashToBindingIndex.get(X)};N._rasterizeText=async function(P,W,X){let aa,Z;aa="cim"in P?P.fontName:t.getFullyQualifiedFontName(P.font);Z=P.text;P=this._invalidFontsMap.has(aa);W=W||y.charCodes(E.bidiText(Z)[0]);try{return await this._glyphMosaic.getGlyphItems(P?"arial-unicode-ms-regular":aa,
W,X)}catch(ea){return H.error(new w("mapview-invalid-resource",`Couldn't find font ${aa}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(aa,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",W,X)}};N._rasterizeSpriteSymbol=async function(P,W,X){if(!y.isSimple(P)){W=z.keyFromSymbol(P);if(this._spriteMosaic.has(W))return this._spriteMosaic.getSpriteItem(W);if(y.isSVGResource(P)||y.isImageResource(P)&&!y.isMarkerPlacementInsidePolygon(P))return this._handleAsyncResource(W,
P,X);if(X=this._rasterizer.rasterizeJSONResource(P,m.PATTERN_FILL_RASTERIZATION_SCALE)){const {size:aa,image:Z,sdf:ea,simplePattern:T,rasterizationScale:I}=X;return this._addItemToMosaic(W,aa,{type:"static",data:Z},y.shouldRepeat(P),ea,T,I)}return new w("TextureManager","unrecognized or null rasterized image")}};N._handleAsyncResource=async function(P,W,X){if(this._ongoingRasterizations.has(P))return this._ongoingRasterizations.get(P);W=y.isSVGResource(W)?this._handleSVG(W,P,X):this._handleImage(W,
P,X);this._ongoingRasterizations.set(P,W);try{await W,this._ongoingRasterizations.delete(P)}catch{this._ongoingRasterizations.delete(P)}return W};N._handleSVG=async function(P,W,X){const aa=[m.SDF_TEXTURE_SIZE,m.SDF_TEXTURE_SIZE];P=await this._sdfConverter.draw(P.path,X);return this._addItemToMosaic(W,aa,{type:"static",data:new Uint32Array(P.buffer)},!1,!0,!0)};N._handleGIFOrPNG=async function(P,W,X){var aa=y.getUrl(P);await this.resourceManager.fetchResource(aa,X);X=this.resourceManager.getResource(aa);
if(f.isNone(X))return new w("mapview-invalid-resource",`Could not fetch requested resource at ${aa}.`);aa=X.width;let Z=X.height;if(X instanceof HTMLImageElement){"esriPMS"===P.type&&(aa=Math.round(F(X.width,y.getPMSResourceSize(P))),Z=Math.round(aa/X.width*X.height));const {size:ea,sdf:T,image:I}=this._rasterizer.rasterizeImageResource(aa,Z,X,"cim"in P?P.cim.colorSubstitutions:void 0);return this._addItemToMosaic(W,ea,{type:"static",data:I},y.shouldRepeat(P),T,!1)}this._allowNonPowerOfTwo||(aa=g.nextPowerOfTwo(X.width+
2*m.SPRITE_PADDING)-2*m.SPRITE_PADDING,Z=g.nextPowerOfTwo(X.height+2*m.SPRITE_PADDING)-2*m.SPRITE_PADDING);if(aa!==X.width||Z!==X.height)X=v.resize(X,aa,Z);X=new u.AnimatableTextureResource(X,this._requestRender,P.animatedSymbolProperties||{},P.objectId);return this._addItemToMosaic(W,[X.width,X.height],{type:"animated",data:X},y.shouldRepeat(P),!1,!1)};N._handleImage=async function(P,W,X){if(y.isGIF(P)||y.isPNG(P))return this._handleGIFOrPNG(P,W,X);const aa=y.getUrl(P);try{let Z;const ea=this.resourceManager.getResource(aa);
if(f.isSome(ea)&&ea instanceof HTMLImageElement)Z=ea;else{const {data:Q}=await this._imageRequestQueue.push(aa,{...X});Z=Q}if(y.isSVGImage(aa))if("width"in P&&"height"in P)Z.width=b.pt2px(P.width),Z.height=b.pt2px(P.height);else if("cim"in P){const Q=P.cim;Z.width=b.pt2px(Q.width??Q.scaleX*Q.size);Z.height=b.pt2px(Q.size)}if(!Z.width||!Z.height)return null;let T=Z.width,I=Z.height;"esriPMS"===P.type&&(T=Math.round(F(Z.width,y.getPMSResourceSize(P))),I=Math.round(T/Z.width*Z.height));const {size:M,
sdf:S,image:V}=this._rasterizer.rasterizeImageResource(T,I,Z,"cim"in P?P.cim.colorSubstitutions:void 0);return this._addItemToMosaic(W,M,{type:"static",data:V},y.shouldRepeat(P),S,!1)}catch(Z){if(!d.isAbortError(Z))return new w("mapview-invalid-resource",`Could not fetch requested resource at ${aa}. ${Z.message}`)}};N._addItemToMosaic=function(P,W,X,aa,Z,ea,T){return this._spriteMosaic.addSpriteItem(P,W,X,aa,Z,ea,T)};l._createClass(J,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",
get:function(){return this._glyphMosaic}}]);return J}()})},"esri/core/BidiText":function(){define(["exports","./BidiEngine"],function(l,h){const D=new h;l.bidiText=function(E){if(null==E)return["",!1];if(!D.hasBidiChar(E))return[E,!1];let w;w="rtl"===D.checkContextual(E)?"IDNNN":"ICNNN";return[D.bidiTransform(E,w,"VLYSN"),!0]};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/core/BidiEngine":function(){define(["../chunks/_rollupPluginBabelHelpers","./bidiEngineTables"],function(l,
h){function D(v,r,z,A,C){var F=v;void 0===r&&(r=C.defInFormat);void 0===z&&(z=C.defOutFormat);void 0===A&&(A=C.defSwap);if(r!==z){var G=r.substring(0,1),H=z.substring(0,1);var K=r.substring(1,4);var J=z.substring(1,4);"C"===K.charAt(0)&&(K=E(F),K="ltr"===K||"rtl"===K?K.toUpperCase():"L"===r.charAt(2)?"LTR":"RTL",r=G+K);"C"===J.charAt(0)&&(K=E(F),"rtl"===K?J="RTL":"ltr"===K?(F=F.split(""),F.reverse(),K=E(F.join("")),J=K.toUpperCase()):J="L"===z.charAt(2)?"LTR":"RTL",z=H+J)}if(r===z)return v;H=r.substring(0,
1);F=r.substring(1,4);G=z.substring(0,1);J=z.substring(1,4);C.inFormat=r;C.outFormat=z;C.swap=A;if("L"===H&&"VLTR"===z){if("LTR"===F)return C.dir=0,w(v,C);if("RTL"===F)return C.dir=1,w(v,C)}if("V"===H&&"V"===G)return C.dir="RTL"===F?1:0,p(v,C);if("L"===H&&"VRTL"===z)return C.dir="LTR"===F?0:1,v=w(v,C),p(v);if("VLTR"===r&&"LLTR"===z)return C.dir=0,w(v,C);if("V"===H&&"L"===G&&F!==J)return v=p(v),"RTL"===F?D(v,"LLTR","VLTR",A,C):D(v,"LRTL","VRTL",A,C);if("VRTL"===r&&"LRTL"===z)return D(v,"LRTL","VRTL",
A,C);"L"===H&&"L"===G&&(r=C.swap,C.swap=r.substr(0,1)+"N","RTL"===F?(C.dir=1,v=w(v,C),C.swap="N"+r.substr(1,2),C.dir=0,v=w(v,C)):(C.dir=0,v=w(v,C),C.swap="N"+r.substr(1,2),v=D(v,"VLTR","LRTL",C.swap,C)));return v}function E(v){return(v=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(v))?"z">=v[0]?"ltr":"rtl":""}function w(v,r){v=v.split("");const z=[];t(v,z,r);if(0!==r.hiLevel&&r.swap.substr(0,1)!==r.swap.substr(1,2))for(let F=0;F<v.length;F++)if(1===z[F]){var A=F;
b:{let G=void 0;var C=v[F];let H=0,K=h.SwapTable.length-1;for(;H<=K;)if(G=Math.floor((H+K)/2),C<h.SwapTable[G][0])K=G-1;else if(C>h.SwapTable[G][0])H=G+1;else{C=h.SwapTable[G][1];break b}}v[A]=C}d(2,v,z,r);d(1,v,z,r);q=z;return v.join("")}function t(v,r,z){const A=v.length;var C=z.dir?h.impTabRtl:h.impTabLtr,F=0,G=-1;const H=[],K=[];z.hiLevel=z.dir;z.lastArabic=!1;z.hasUbatAl=!1;z.hasUbatB=!1;z.hasUbatS=!1;for(var J=0;J<A;J++){var N=J,P=v[J].charCodeAt(0);const W=h.PrimaryTable[P>>8];H[N]=W<h.TBBASE?
W:h.UnicodeTable[W-h.TBBASE][P&255]}for(N=0;N<A;N++){J=b(v,H,K,N,z);K[N]=J;F=C[F][J];P=F&240;F&=15;J=C[F][5];r[N]=J;if(0<P){if(16===P)for(;G<N;G++)r[G]=1;G=-1}if(C[F][6])-1===G&&(G=N);else if(-1<G){for(;G<N;G++)r[G]=J;G=-1}H[N]===h.UBAT_B&&(r[N]=0);z.hiLevel|=J}if(z.hasUbatS)for(v=0;v<A;v++)if(H[v]===h.UBAT_S)for(r[v]=z.dir,C=v-1;0<=C;C--)if(H[C]===h.UBAT_WS)r[C]=z.dir;else break}function p(v,r){v=v.split("");if(r){const z=[];t(v,z,r);q=z}v.reverse();n.reverse();return v.join("")}function g(v){for(let r=
0;r<h.ArabicAlefBetIntervalsBegine.length;r++)if(v>=h.ArabicAlefBetIntervalsBegine[r]&&v<=h.ArabicAlefBetIntervalsEnd[r])return!0;return!1}function f(v,r,z,A){for(;r*z<A&&e(v[r]);)r+=z;return r*z<A&&g(v[r])?!0:!1}function d(v,r,z,A){if(!(A.hiLevel<v))if(1!==v||1!==A.dir||A.hasUbatB){A=r.length;for(var C=0,F,G,H;C<A;){if(z[C]>=v){for(F=C+1;F<A&&z[F]>=v;)F++;for(G=F-1;C<G;C++,G--)H=r[C],r[C]=r[G],r[G]=H,H=n[C],n[C]=n[G],n[G]=H;C=F}C++}}else r.reverse(),n.reverse()}function b(v,r,z,A,C){return{UBAT_L:()=>
{C.lastArabic=!1;return h.UBAT_L},UBAT_R:()=>{C.lastArabic=!1;return h.UBAT_R},UBAT_ON:()=>h.UBAT_ON,UBAT_AN:()=>h.UBAT_AN,UBAT_EN:()=>C.lastArabic?h.UBAT_AN:h.UBAT_EN,UBAT_AL:()=>{C.lastArabic=!0;C.hasUbatAl=!0;return h.UBAT_R},UBAT_WS:()=>h.UBAT_ON,UBAT_CS:()=>{let F,G;if(1>A||A+1>=r.length||(F=z[A-1])!==h.UBAT_EN&&F!==h.UBAT_AN||(G=r[A+1])!==h.UBAT_EN&&G!==h.UBAT_AN)return h.UBAT_ON;C.lastArabic&&(G=h.UBAT_AN);return G===F?G:h.UBAT_ON},UBAT_ES:()=>(0<A?z[A-1]:h.UBAT_B)===h.UBAT_EN&&A+1<r.length&&
r[A+1]===h.UBAT_EN?h.UBAT_EN:h.UBAT_ON,UBAT_ET:()=>{if(0<A&&z[A-1]===h.UBAT_EN)return h.UBAT_EN;if(C.lastArabic)return h.UBAT_ON;let F=A+1;const G=r.length;for(;F<G&&r[F]===h.UBAT_ET;)F++;return F<G&&r[F]===h.UBAT_EN?h.UBAT_EN:h.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===C.inFormat){for(var F=r.length,G=A+1;G<F&&r[G]===h.UBAT_NSM;)G++;if(G<F&&(F=v[A].charCodeAt[0],G=r[G],(1425<=F&&2303>=F||64286===F)&&(G===h.UBAT_R||G===h.UBAT_AL)))return h.UBAT_R}return 1>A||r[A-1]===h.UBAT_B?h.UBAT_ON:z[A-1]},UBAT_B:()=>
{C.lastArabic=!0;C.hasUbatB=!0;return C.dir},UBAT_S:()=>{C.hasUbatS=!0;return h.UBAT_ON},UBAT_LRE:()=>{C.lastArabic=!1;return h.UBAT_ON},UBAT_RLE:()=>{C.lastArabic=!1;return h.UBAT_ON},UBAT_LRO:()=>{C.lastArabic=!1;return h.UBAT_ON},UBAT_RLO:()=>{C.lastArabic=!1;return h.UBAT_ON},UBAT_PDF:()=>{C.lastArabic=!1;return h.UBAT_ON},UBAT_BN:()=>h.UBAT_ON}[h.TYPES_NAMES[r[A]]]()}function a(v,r){for(let z=0;z<h.BaseForm.length;z++)if(v===h.BaseForm[z])return r[z];return v}function e(v){return"\u064b"<=v&&
"\u0655">=v}function c(v){return"L"===v?"LTR":"R"===v?"RTL":"C"===v?"CLR":"D"===v?"CRL":""}function m(v,r){for(let z=0;z<h.AlefTable.length;z++)if(v===h.AlefTable[z])return r[z];return v}function k(v,r,z,A){for(let C=0;C<v.length;C++)if(v[C]>r||!z&&v[C]===r)v[C]+=A}let n=[],x=[],q=[];const B={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},y=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,
u=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function v(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}var r=v.prototype;r.bidiTransform=function(z,A,C){this.sourceToTarget=[];this.targetToSource=[];if(!z)return"";var F=this.sourceToTarget,G=this.targetToSource,H=z.length;n=[];q=[];for(var K=0;K<H;K++)F[K]=K,G[K]=K,n[K]=K;if(!this.checkParameters(A,C))return z;A=this.inputFormat;C=this.outputFormat;F=z;H=c(A.charAt(1));F=c(C.charAt(1));
K="I"===A.charAt(0)?"L":A.charAt(0);G="I"===C.charAt(0)?"L":C.charAt(0);H=K+H;F=G+F;G=A.charAt(2)+C.charAt(2);B.defInFormat=H;B.defOutFormat=F;B.defSwap=G;z=D(z,H,F,G,B);F=!1;if("R"===C.charAt(1))F=!0;else if("C"===C.charAt(1)||"D"===C.charAt(1))F="rtl"===this.checkContextual(z);G=this.sourceToTarget=n;H=Array(G.length);for(K=0;K<G.length;K++)H[G[K]]=K;x=this.targetToSource=H;if(A.charAt(3)===C.charAt(3))F=z;else if("S"===C.charAt(3))if(A=F,C=!0,0===z.length)F="";else{void 0===A&&(A=!0);void 0===
C&&(C=!0);z=String(z);z=z.split("");H=0;F=1;G=z.length;A||(H=z.length-1,F=-1,G=1);var J=H;H=C;var N=0;K=[];for(var P=0;J*F<G;J+=F)if(g(z[J])||e(z[J])){var W;if(W="\u0644"===z[J])b:{for(var X=z,aa=J+F,Z=F,ea=G;aa*Z<ea&&e(X[aa]);)aa+=Z;W=" ";if(aa*Z<ea)for(W=X[aa],X=0;X<h.AlefTable.length;X++)if(h.AlefTable[X]===W){W=!0;break b}W=!1}if(W){z[J]=0===N?m(z[J+F],h.LamAlefInialTableFE):m(z[J+F],h.LamAlefMedialTableFE);J+=F;N=z;W=J;X=F;for(aa=G;W*X<aa&&e(N[W]);)W+=X;W*X<aa&&(N[W]=" ");H&&(K[P]=J,P++);N=0}else{W=
z[J];if(1===N){X=J;if(f(z,J+F,F,G))b:for(aa=z[J],Z=0;Z<h.BaseForm.length;Z++){if(aa===h.BaseForm[Z]){aa=h.MedialForm[Z];break b}}else aa=a(z[J],h.FinalForm);z[X]=aa}else!0===f(z,J+F,F,G)?z[J]=a(z[J],h.InitialForm):z[J]=a(z[J],h.IsolatedForm);e(W)||(N=1);b:{for(X=0;X<h.StandAlonForm.length;X++)if(h.StandAlonForm[X]===W){W=!0;break b}W=!1}!0===W&&(N=0)}}else N=0;F=K;G="";for(H=0;H<z.length;H++){if(K=C){b:{for(K=0;K<F.length;K++)if(F[K]===H)break b;K=-1}K=-1<K}K?(k(x,H,!A,-1),n.splice(H,1)):G+=z[H]}F=
G}else if(A=z,C=F,z=!0,0===A.length)F="";else for(void 0===z&&(z=!0),void 0===C&&(C=!0),A=String(A),F="",G=A.split(""),H=0;H<A.length;H++)K=!1,"\ufe70"<=G[H]&&"\ufeff">G[H]?(P=A.charCodeAt(H),"\ufef5"<=G[H]&&"\ufefc">=G[H]?(C?(0<H&&z&&" "===G[H-1]?F=F.substring(0,F.length-1)+"\u0644":(F+="\u0644",K=!0),F+=h.AlefTable[(P-65269)/2]):(F+=h.AlefTable[(P-65269)/2],F+="\u0644",H+1<A.length&&z&&" "===G[H+1]?H++:K=!0),K&&(k(x,H,!0,1),n.splice(H,0,n[H]))):F+=h.FETo06Table[P-65136]):F+=G[H];this.sourceToTarget=
n;this.targetToSource=x;this.levels=q;return F};r._inputFormatSetter=function(z){if(!y.test(z))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=z};r._outputFormatSetter=function(z){if(!y.test(z))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=z};r.checkParameters=function(z,A){z?this._inputFormatSetter(z):z=this.inputFormat;A?this._outputFormatSetter(A):A=this.outputFormat;return z===A?!1:!0};r.checkContextual=function(z){z=
E(z);if("ltr"!==z&&"rtl"!==z){try{z=document.dir.toLowerCase()}catch(A){}"ltr"!==z&&"rtl"!==z&&(z="ltr")}return z};r.hasBidiChar=function(z){return u.test(z)};return l._createClass(v)}()})},"esri/core/bidiEngineTables":function(){define(["exports"],function(l){l.AlefTable=["\u0622","\u0623","\u0625","\u0627"];l.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];l.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];l.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");
l.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
l.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");l.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
l.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");l.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];l.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];l.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
l.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];l.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");l.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];l.TBBASE=100;l.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");l.UBAT_AL=7;l.UBAT_AN=3;l.UBAT_B=5;l.UBAT_BN=18;l.UBAT_CS=9;l.UBAT_EN=2;l.UBAT_ES=10;l.UBAT_ET=11;l.UBAT_L=0;l.UBAT_LRE=13;l.UBAT_LRO=16;l.UBAT_NSM=12;l.UBAT_ON=
4;l.UBAT_PDF=15;l.UBAT_R=1;l.UBAT_RLE=14;l.UBAT_RLO=17;l.UBAT_S=6;l.UBAT_WS=8;l.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];l.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];l.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/core/fontUtils":function(){define(["exports","../config"],function(l,h){function D(t){if(!t)return"arial-unicode-ms";t=t.toLowerCase().split(" ").join("-");switch(t){case "serif":return"noto-serif";
case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return t}}function E(t){a:{if(t.weight)switch(t.weight.toLowerCase()){case "bold":case "bolder":var p="-bold";break a}p=""}a:{if(t.style)switch(t.style.toLowerCase()){case "italic":case "oblique":var g="-italic";break a}g=""}p+=g;return D(t.family)+(0<p.length?p:"-regular")}const w=new Map;l.getFontFamily=D;l.getFullyQualifiedFontName=E;l.loadFont=
async function(t){const p=E(t);let g=w.get(p);if(g)return g;t=new FontFace(t.family,`url('${h.fontsUrl}/woff2/${p}.${"woff2"}') format('${"woff2"}')`);const f=document.fonts;if(f.has(t)&&"loading"===t.status)return t.loaded;g=t.load();w.set(p,g);f.add(t);return g};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/Rasterizer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../core/mathUtils ./CIMSymbolHelper ./rasterizingUtils ./Rect ./SDFHelper ./utils".split(" "),
function(l,h,D,E,w,t,p){return function(){function g(d){this._resourceManager=d;this._rasterizationCanvas=null}var f=g.prototype;f.dispose=function(){this._rasterizationCanvas=null};f.rasterizeJSONResource=function(d,b,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===d.type||"esriSFS"===d.type){const [u,v,r]=E.rasterizeSimpleFill(this._rasterizationCanvas,d.style,b);return{size:[v,r],image:new Uint32Array(u.buffer),sdf:!1,simplePattern:!0,
anchorX:0,anchorY:0,rasterizationScale:h.nextPowerOfTwo(Math.ceil(b))}}if("simple-line"===d.type||"esriSLS"===d.type||"line"===d.type&&d.dashTemplate){if("simple-line"===d.type||"esriSLS"===d.type)switch(b=D.slsDashToTemplateArray(d.style,d.cap),d.cap){case "butt":d="Butt";break;case "square":d="Square";break;default:d="Round"}else b=d.dashTemplate,d=d.cim.capStyle;const [u,v,r]=E.rasterizeDash(b,d);return{size:[v,r],image:new Uint32Array(u.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let e,
c=null,m=null,k=1;"simple-marker"===d.type||"esriSMS"===d.type||"line-marker"===d.type?(e=D.CIMSymbolHelper.fromSimpleMarker(d),m=t.getSDFInfo(e)):d.cim&&"CIMHatchFill"===d.cim.type?(e=D.CIMSymbolHelper.fromCIMHatchFill(d.cim,b),c=new w(e.frame.xmin,-e.frame.ymax,e.frame.xmax-e.frame.xmin,e.frame.ymax-e.frame.ymin),k=b):d.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===d.cim.markerPlacement.type?(e=D.CIMSymbolHelper.fromCIMInsidePolygon(d.cim),c=new w(e.frame.xmin,-e.frame.ymax,e.frame.xmax-
e.frame.xmin,e.frame.ymax-e.frame.ymin)):(e=d.cim,d.avoidSDFRasterization||(m=t.getSDFInfo(e)));if(m&&!a){const [u,v,r]=t.buildSDF(m);return u?{size:[v,r],image:new Uint32Array(u.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:k}:null}const [n,x,q,B,y]=D.CIMSymbolHelper.rasterize(this._rasterizationCanvas,e,c,this._resourceManager,!a);return n?{size:[x,q],image:new Uint32Array(n.buffer),sdf:!1,simplePattern:!1,anchorX:B,anchorY:y}:null};f.rasterizeImageResource=function(d,b,
a,e){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=d;this._rasterizationCanvas.height=b;var c=this._rasterizationCanvas.getContext("2d");a instanceof ImageData?c.putImageData(a,0,0):(a.setAttribute("width",`${d}px`),a.setAttribute("height",`${b}px`),c.drawImage(a,0,0,d,b));a=c.getImageData(0,0,d,b);a=new Uint8Array(a.data);if(e)for(var m of e)if(m&&m.oldColor&&4===m.oldColor.length&&m.newColor&&4===m.newColor.length){const [k,
n,x,q]=m.oldColor,[B,y,u,v]=m.newColor;if(k!==B||n!==y||x!==u||q!==v)for(e=0;e<a.length;e+=4)k===a[e]&&n===a[e+1]&&x===a[e+2]&&q===a[e+3]&&(a[e]=B,a[e+1]=y,a[e+2]=u,a[e+3]=v)}for(e=0;e<a.length;e+=4)m=a[e+3]/255,a[e]*=m,a[e+1]*=m,a[e+2]*=m;c=a;m=d;e=b;if(512<=m||512<=e){c=m/e;1<c?(m=512,e=Math.round(512/c)):(e=512,m=Math.round(512*c));c=new Uint8Array(4*m*e);const k=new Uint8ClampedArray(c.buffer);p.resampleHermite(a,d,b,k,m,e,!1)}return{size:[m,e],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,
anchorX:0,anchorY:0}};return l._createClass(g)}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../Color ../../core/BidiText ../../core/lang ../../core/Logger ../../core/maybe ../../core/RandomLCG ../../core/screenUtils ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../support/arcadeOnDemand ./CIMPlacements ./CIMSymbolDrawHelper ./enums ./utils ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/vectorTiles/GeometryUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q,B){function y(T,I,M){switch(I.type){case "CIMSymbolReference":return y(T,I.symbol,M);case "CIMPointSymbol":null==M&&(M={x:0,y:0});T.drawSymbol(I,M);break;case "CIMLineSymbol":null==M&&(M={paths:[[[0,0],[10,0]]]});T.drawSymbol(I,M);break;case "CIMPolygonSymbol":null==M&&(M={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]});T.drawSymbol(I,M);break;case "CIMTextSymbol":T.drawSymbol(I,{x:0,y:0});break;case "CIMVectorMarker":M=new e.Placement,T.drawMarker(I,M)}return T.envelope()}
function u(T){if(!T)return 0;switch(T.type){case "CIMMarkerPlacementAlongLineSameSize":return Math.abs(T.offset);case "CIMMarkerPlacementAlongLineRandomSize":return Math.abs(T.offset);case "CIMMarkerPlacementAtExtremities":return Math.abs(T.offset);case "CIMMarkerPlacementAtMeasuredUnits":return Math.abs(T.offset);case "CIMMarkerPlacementAtRatioPositions":return Math.abs(T.offset);case "CIMMarkerPlacementInsidePolygon":return 0;case "CIMMarkerPlacementOnLine":return Math.abs(T.offset);case "CIMMarkerPlacementOnVertices":return Math.abs(T.offset);
case "CIMMarkerPlacementPolygonCenter":return 0;default:return 0}}function v(T){if(!T)return 0;switch(T.type){case "CIMGeometricEffectArrow":return Math.abs(.5*T.width);case "CIMGeometricEffectBuffer":return Math.abs(T.size);case "CIMGeometricEffectExtension":return Math.abs(T.length);case "CIMGeometricEffectJog":return Math.abs(.5*T.length);case "CIMGeometricEffectMove":return Math.max(Math.abs(k.getValue(T.offsetX)),Math.abs(k.getValue(T.offsetY)));case "CIMGeometricEffectOffset":return Math.abs(T.offset);
case "CIMGeometricEffectOffsetTangent":return Math.abs(T.offset);case "CIMGeometricEffectRadial":return Math.abs(T.length);case "CIMGeometricEffectRegularPolygon":return Math.abs(T.radius);case "CIMGeometricEffectRotate":return 0;case "CIMGeometricEffectScale":return 0;case "CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(T.fromWidth),Math.abs(T.toWidth));case "CIMGeometricEffectWave":return Math.abs(T.amplitude);default:return 0}}function r(T){if(!T)return 0;let I=0;for(const M of T)I+=
v(M);return I}function z(T,I,M){T.effects&&!p.isSome(I.geometryEngine)&&(I.geometryEnginePromise?M.push(I.geometryEnginePromise):k.isGeometryEngineRequired(T.effects)&&(I.geometryEnginePromise=k.importGeometryEngine(),M.push(I.geometryEnginePromise),I.geometryEnginePromise.then(S=>I.geometryEngine=S)))}const A=Math.PI,C=A/2,F=96/72,G=Math.PI/180,H=t.getLogger("esri.symbols.cim.CIMSymbolHelper");t=function(){function T(){}var I=T.prototype;I.getSymbolInflateSize=function(M,S,V,Q,Y){M||(M=[0,0,0,0]);
return S?this._getInflateSize(M,S,V,Q,Y):M};T.safeSize=function(M){const S=Math.max(Math.abs(M[0]),Math.abs(M[2]));M=Math.max(Math.abs(M[1]),Math.abs(M[3]));return Math.sqrt(S*S+M*M)};I._vectorMarkerBounds=function(M,S,V,Q){let Y=!0;const L=d.create();if(S&&S.markerGraphics)for(const O of S.markerGraphics)S=[0,0,0,0],O.geometry&&(b.getBoundsXY(L,O.geometry),S[0]=0,S[1]=0,S[2]=0,S[3]=0,this.getSymbolInflateSize(S,O.symbol,V,0,Q),L[0]+=S[0],L[1]+=S[1],L[2]+=S[2],L[3]+=S[3],Y?(M[0]=L[0],M[1]=L[1],M[2]=
L[2],M[3]=L[3],Y=!1):(M[0]=Math.min(M[0],L[0]),M[1]=Math.min(M[1],L[1]),M[2]=Math.max(M[2],L[2]),M[3]=Math.max(M[3],L[3])));return M};I._getInflateSize=function(M,S,V,Q,Y){return void 0!==S.symbolLayers?(M=this._getLayersInflateSize(M,S.symbolLayers,V,Q,Y),S=r(S.effects),0<S&&(M[0]-=S,M[1]-=S,M[2]+=S,M[3]+=S),M):this._getTextInflatedSize(M,S,Y)};I._getLayersInflateSize=function(M,S,V,Q,Y){let L=!0;if(!S)return M;for(const da of S)if(da){S=[0,0,0,0];switch(da.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":var O=
da,R=O.width;null!=R&&(R=O.capStyle===m.LineCapStyle.Square||O.joinStyle===m.LineJoinStyle.Miter?R/1.4142135623730951:R/2,S[0]=-R,S[1]=-R,S[2]=R,S[3]=R);break;case "CIMCharacterMarker":case "CIMVectorMarker":case "CIMPictureMarker":O=da;if("CIMVectorMarker"===da.type){if(R=da,S=this._vectorMarkerBounds(S,R,V,Y),R.frame){var U=(R.frame.xmin+R.frame.xmax)/2,ba=(R.frame.ymin+R.frame.ymax)/2;S[0]-=U;S[1]-=ba;S[2]-=U;S[3]-=ba;null!=R.size&&(R=R.size/(R.frame.ymax-R.frame.ymin),S[0]*=R,S[1]*=R,S[2]*=R,
S[3]*=R)}}else"CIMPictureMarker"===da.type?(R=da,ba=V.getResource(R.url),U=1,p.isSome(ba)&&ba.height&&(U=ba.width/ba.height),null!=O.size&&(S=O.size/2,R=O.size*U*R.scaleX/2,S=[-R,-S,R,S])):null!=O.size&&(S=O.size/2,S=[-S,-S,S,S]);O.anchorPoint&&("Absolute"===O.anchorPointUnits?(R=O.anchorPoint.x,U=O.anchorPoint.y):(R=O.anchorPoint.x*(S[2]-S[0]),U=O.anchorPoint.y*(S[3]-S[1])),S[0]-=R,S[1]-=U,S[2]-=R,S[3]-=U);R=k.getValue(O.rotation);O.rotateClockwise&&(R=-R);Q&&(R-=Q);R&&(U=G*R,R=Math.cos(U),U=Math.sin(U),
ba=d.create([x.C_INFINITY,x.C_INFINITY,-x.C_INFINITY,-x.C_INFINITY]),d.expandPointInPlace(ba,[S[0]*R-S[1]*U,S[0]*U+S[1]*R]),d.expandPointInPlace(ba,[S[0]*R-S[3]*U,S[0]*U+S[3]*R]),d.expandPointInPlace(ba,[S[2]*R-S[1]*U,S[2]*U+S[1]*R]),d.expandPointInPlace(ba,[S[2]*R-S[3]*U,S[2]*U+S[3]*R]),S=ba);R=k.getValue(O.offsetX);U=k.getValue(O.offsetY);if(Q){var ca=G*Q;ba=Math.cos(ca);ca=Math.sin(ca);const ha=R*ca+U*ba;R=R*ba-U*ca;U=ha}S[0]+=R;S[1]+=U;S[2]+=R;S[3]+=U;O=u(O.markerPlacement);0<O&&(S[0]-=O,S[1]-=
O,S[2]+=O,S[3]+=O)}O=r(da.effects);0<O&&(S[0]-=O,S[1]-=O,S[2]+=O,S[3]+=O);L?(M[0]=S[0],M[1]=S[1],M[2]=S[2],M[3]=S[3],L=!1):(M[0]=Math.min(M[0],S[0]),M[1]=Math.min(M[1],S[1]),M[2]=Math.max(M[2],S[2]),M[3]=Math.max(M[3],S[3]))}return M};I._getTextInflatedSize=function(M,S,V){const Q=S.height??10;M[0]=-Q/2;M[1]=-Q/2;M[2]=Q/2;M[3]=Q/2;if(!V)return M;V=V.get(S);if(!V)return M;const {text:Y,mosaicItem:L}=V;if(!L?.glyphMosaicItems?.length)return M;const {lineGapType:O,lineGap:R}=S;V=O?c.lineGapType2LineHeight(O,
R??0,Q):0;const U=E.bidiText(Y)[1],ba="CIMBackgroundCallout"===S.callout?.type;S=B.shapeGlyphs(L.glyphMosaicItems,U,{scale:Q/q.GLYPH_SIZE,angle:k.getValue(S.angle),xOffset:k.getValue(S.offsetX),yOffset:k.getValue(S.offsetY),hAlign:c.horizontalAlignment2HAlign(S.horizontalAlignment),vAlign:c.verticalAlignment2VAlign(S.verticalAlignment),maxLineWidth:512,lineHeight:q.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(V||1,4)),decoration:S.font.decoration||"none",isCIM:!0,hasBackground:ba}).boundsT;M[0]=
S.x-S.halfWidth;M[1]=-S.y-S.halfHeight;M[2]=S.x+S.halfWidth;M[3]=-S.y+S.halfHeight;return M};return h._createClass(T)}();let K=function(){function T(){}T.getEnvelope=function(I,M,S){if(!I)return null;S=new c.EnvDrawHelper(S);if(Array.isArray(I)){let V;for(const Q of I)V?V.union(y(S,Q,M)):V=y(S,Q,M);return V}return y(S,I,M)};T.getTextureAnchor=function(I,M){I=this.getEnvelope(I,null,M);if(!I)return[0,0,0];M=I.height*F+2;return[-((I.x+.5*I.width)*F)/(I.width*F+2),-((I.y+.5*I.height)*F)/M,M]};T.rasterize=
function(I,M,S,V,Q=!0){var Y=S||this.getEnvelope(M,null,V);if(!Y)return[null,0,0,0,0];const L=(Y.x+.5*Y.width)*F,O=(Y.y+.5*Y.height)*F;I.width=Y.width*F;I.height=Y.height*F;S||(I.width+=2,I.height+=2);S=I.getContext("2d");Y=c.Transformation.createScale(F,-F);Y.translate(.5*I.width-L,.5*I.height+O);V=new c.CanvasDrawHelper(S,V,Y);switch(M.type){case "CIMPointSymbol":V.drawSymbol(M,{type:"point",x:0,y:0});break;case "CIMVectorMarker":Y=new e.Placement,V.drawMarker(M,Y)}M=S.getImageData(0,0,I.width,
I.height);M=new Uint8Array(M.data);if(Q)for(V=0;V<M.length;V+=4)Q=M[V+3]/255,M[V]*=Q,M[V+1]*=Q,M[V+2]*=Q;return[M,I.width,I.height,-L/I.width,-O/I.height]};T.fromTextSymbol=function(I){const {angle:M,color:S,font:V,haloColor:Q,haloSize:Y,horizontalAlignment:L,kerning:O,text:R,verticalAlignment:U,xoffset:ba,yoffset:ca,backgroundColor:da,borderLineColor:ha,borderLineSize:ia}=I;let ja,fa,ka;if(V){var la=V.family;var ma=V.style;var na=V.weight;ja=V.size;fa=V.decoration}I=!1;R&&(I=E.bidiText(R)[1]);if(da||
ia)ka={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:aa(da)},{type:"CIMSolidStroke",color:aa(ha),width:ia}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null};var oa=m.BlockProgression.BTT,ra=m.FontEffects.Normal,pa=m.FontEncoding.Unicode;la=la||"Arial";b:{if(na)switch(na.toLowerCase()){case "bold":case "bolder":na="bold";break b}na=""}b:{if(ma)switch(ma.toLowerCase()){case "italic":case "oblique":ma="italic";
break b}ma=""}na=na&&ma?`${na}-${ma}`:`${na}${ma}`;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:M,blockProgression:oa,depth3D:1,extrapolateBaselines:!0,fontEffects:ra,fontEncoding:pa,fontFamilyName:la,fontStyleName:na,fontType:m.FontType.Unspecified,
haloSize:Y,height:ja,hinting:m.GlyphHinting.Default,horizontalAlignment:W(L??"center"),kerning:O,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:k.getValue(ba),offsetY:k.getValue(ca),strikethrough:"line-through"===fa,underline:"underline"===fa,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:aa(S)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:aa(Q)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",
textDirection:I?m.TextReadingDirection.RTL:m.TextReadingDirection.LTR,verticalAlignment:X(U??"baseline"),verticalGlyphOrientation:m.VerticalGlyphOrientation.Right,wordSpacing:100,billboardMode3D:m.BillBoardMode.FaceNearPlane,callout:ka},textString:R}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}};T.fromPictureFillSymbol=function(I){const {height:M,outline:S,width:V,xoffset:Q,xscale:Y,yoffset:L,yscale:O}=I,R=[],U={type:"CIMPolygonSymbol",symbolLayers:R};if(S){const {cap:ca,
join:da,miterLimit:ha,width:ia}=S;R.push({type:"CIMSolidStroke",color:aa(S.color),capStyle:N(ca),joinStyle:P(da),miterLimit:ha,width:ia})}let ba=I.url;"esriPFS"===I.type&&I.imageData&&(ba=I.imageData);I="angle"in I?I.angle??0:0;R.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:m.TextureFilter.Picture,tintColor:null,url:ba,height:(M??0)*(O||1),width:(V??0)*(Y||1),offsetX:k.getValue(Q),offsetY:k.getValue(L),rotation:k.getValue(-I),colorSubstitutions:null});return U};T.fromSimpleFillSymbol=
function(I){const {color:M,style:S,outline:V}=I;I=[];const Q={type:"CIMPolygonSymbol",symbolLayers:I};var Y=null;if(V){const {cap:L,join:O,style:R}=V;"solid"!==R&&"none"!==R&&"esriSLSSolid"!==R&&"esriSLSNull"!==R&&(Y=[{type:"CIMGeometricEffectDashes",dashTemplate:Z(R,L),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);I.push({type:"CIMSolidStroke",color:aa(V.color),capStyle:N(L),joinStyle:P(O),miterLimit:V.miterLimit,width:V.width,effects:Y})}if(S&&"solid"!==S&&"none"!==S&&"esriSFSSolid"!==
S&&"esriSFSNull"!==S){Y={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:aa(M),capStyle:m.LineCapStyle.Butt,joinStyle:m.LineJoinStyle.Miter,width:.75}]};let L=0;const O=f.px2pt("vertical"===S||"horizontal"===S||"cross"===S||"esriSFSCross"===S||"esriSFSVertical"===S||"esriSFSHorizontal"===S?8:10);switch(S){case "vertical":case "esriSFSVertical":L=90;break;case "forward-diagonal":case "esriSFSForwardDiagonal":L=-45;break;case "backward-diagonal":case "esriSFSBackwardDiagonal":L=45;break;
case "cross":case "esriSFSCross":L=0;break;case "diagonal-cross":case "esriSFSDiagonalCross":L=-45}I.push({type:"CIMHatchFill",lineSymbol:Y,offsetX:0,offsetY:0,rotation:L,separation:O});"cross"===S||"esriSFSCross"===S?I.push({type:"CIMHatchFill",lineSymbol:w.clone(Y),offsetX:0,offsetY:0,rotation:90,separation:O}):("diagonal-cross"===S||"esriSFSDiagonalCross"===S)&&I.push({type:"CIMHatchFill",lineSymbol:w.clone(Y),offsetX:0,offsetY:0,rotation:45,separation:O})}else!S||"solid"!==S&&"esriSFSSolid"!==
S||I.push({type:"CIMSolidFill",enable:!0,color:aa(M)});return Q};T.fromSimpleLineSymbol=function(I){const {cap:M,color:S,join:V,marker:Q,miterLimit:Y,style:L,width:O}=I;I=null;"solid"!==L&&"none"!==L&&"esriSLSSolid"!==L&&"esriSLSNull"!==L&&(I=[{type:"CIMGeometricEffectDashes",dashTemplate:Z(L,M),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const R=[];if(Q){let U;switch(Q.placement){case "begin-end":U=m.ExtremityPlacement.Both;break;case "begin":U=m.ExtremityPlacement.JustBegin;
break;case "end":U=m.ExtremityPlacement.JustEnd;break;default:U=m.ExtremityPlacement.None}const ba=T.fromSimpleMarker(Q,O,S).symbolLayers[0];ba.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:U,offsetAlongLine:0};R.push(ba)}"none"!==L&&"esriSLSNull"!==L&&R.push({type:"CIMSolidStroke",color:aa(S),capStyle:N(M),joinStyle:P(V),miterLimit:Y,width:O,effects:I});return{type:"CIMLineSymbol",symbolLayers:R}};T.fromPictureMarker=function(I){const {angle:M,
height:S,width:V,xoffset:Q,yoffset:Y}=I;let L=I.url;"esriPMS"===I.type&&I.imageData&&(L=I.imageData);return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:m.TextureFilter.Picture,tintColor:null,url:L,size:S,width:V,offsetX:k.getValue(Q),offsetY:k.getValue(Y),rotation:k.getValue(-M)}]}};T.fromSimpleMarker=function(I,M,S){var {style:V}=I;S=I.color??S;if("path"===V){M=[];"outline"in I&&I.outline&&(V=I.outline,M.push({type:"CIMSolidStroke",
enable:!0,width:f.pt2px(Math.round(f.px2pt(V.width))),color:aa(V.color)}));M.push({type:"CIMSolidFill",enable:!0,color:aa(S),path:I.path});const [O,R]=ea("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:k.getValue(-I.angle),size:k.getValue(I.size||6),offsetX:k.getValue(I.xoffset),offsetY:k.getValue(I.yoffset),frame:O,markerGraphics:[{type:"CIMMarkerGraphic",geometry:R,symbol:{type:"CIMPolygonSymbol",symbolLayers:M}}]}]}}const [Q,Y]=ea(V);if(Y&&Q){V=[];
if("outline"in I&&I.outline){var L=I.outline;V.push({type:"CIMSolidStroke",enable:!0,width:null!=L.width&&.667<L.width?f.pt2px(Math.round(f.px2pt(L.width))):L.width,color:aa(L.color)})}else!M||"line-marker"!==I.type||"cross"!==I.style&&"x"!==I.style||V.push({type:"CIMSolidStroke",enable:!0,width:M,color:aa(S)});V.push({type:"CIMSolidFill",enable:!0,color:aa(S)});S={type:"CIMPolygonSymbol",symbolLayers:V};L={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:k.getValue(-I.angle),
size:k.getValue(I.size||6*M),offsetX:k.getValue(I.xoffset),offsetY:k.getValue(I.yoffset),frame:Q,markerGraphics:[{type:"CIMMarkerGraphic",geometry:Y,symbol:S}]}]}}return L};T.fromCIMHatchFill=function(I,M){const S=M*(I.separation??4),V=S/2;I=w.clone(I.lineSymbol);I.symbolLayers?.forEach(Y=>{switch(Y.type){case "CIMSolidStroke":null!=Y.width&&(Y.width*=M);Y.effects?.forEach(L=>{"CIMGeometricEffectDashes"===L.type&&(L.dashTemplate=L.dashTemplate.map(O=>O*M))});break;case "CIMVectorMarker":null!=Y.size&&
(Y.size*=M),Y=Y.markerPlacement,null!=Y&&"placementTemplate"in Y&&(Y.placementTemplate=Y.placementTemplate.map(L=>L*M))}});for(var Q=this._getLineSymbolPeriod(I)||4;4>Q;)Q*=2;Q/=2;return{type:"CIMVectorMarker",frame:{xmin:-Q,xmax:Q,ymin:-V,ymax:V},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-Q,0],[Q,0]]]},symbol:I}],size:S}};T.fetchResources=function(I,M,S){if(I&&M)switch(I.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(I=I.symbolLayers)for(const V of I)switch(z(V,
M,S),V.type){case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMCharacterMarker":case "CIMPictureMarker":"url"in V&&V.url&&S.push(M.fetchResource(V.url,null));break;case "CIMVectorMarker":if(I=V.markerGraphics)for(const Q of I)Q&&(I=Q.symbol)&&T.fetchResources(I,M,S)}}};T._getLineSymbolPeriod=function(I){if(I){const M=this._getEffectsRepeat(I.effects);if(M)return M;if(I.symbolLayers)for(const S of I.symbolLayers)if(S){if(I=this._getEffectsRepeat(S.effects))return I;
switch(S.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":if(I=this._getPlacementRepeat(S.markerPlacement))return I}}}return 0};T._getEffectsRepeat=function(I){if(I)for(var M of I)if(M)switch(M.type){case "CIMGeometricEffectDashes":if((I=M.dashTemplate)&&I.length){M=0;for(const S of I)M+=S;I.length&1&&(M*=2);return M}break;case "CIMGeometricEffectWave":return M.period;default:H.error(`unsupported geometric effect type ${M.type}`)}return 0};
T._getPlacementRepeat=function(I){if(I)switch(I.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((I=I.placementTemplate)&&I.length){let M=0;for(const S of I)M+=+S;I.length&1&&(M*=2);return M}}return 0};T.fromCIMInsidePolygon=function(I){var M=I.markerPlacement;const S={...I,markerPlacement:null,anchorPoint:null};I=Math.abs(M.stepX);const V=Math.abs(M.stepY);var Q=(M.randomness??100)/100;let Y,L;if("Random"===
M.gridType){var O=f.px2pt(q.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const R=Math.max(Math.floor(O/I),1),U=Math.max(Math.floor(O/V),1);O=R*I/2;Y=U*V/2;L=2*Y;M=new g(M.seed);const ba=Q*I/1.5,ca=Q*V/1.5;Q=[];for(let da=0;da<R;da++)for(let ha=0;ha<U;ha++){const ia=da*I-O+ba*(.5-M.getFloat()),ja=ha*V-Y+ca*(.5-M.getFloat());Q.push({x:ia,y:ja});0===da&&Q.push({x:ia+2*O,y:ja});0===ha&&Q.push({x:ia,y:ja+2*Y})}}else!0===M.shiftOddRows?(O=I/2,Y=V,L=2*V,Q=[{x:-O,y:0},{x:O,y:0},{x:0,y:Y},{x:0,y:-Y}]):(O=I/2,Y=V/2,
L=V,Q=[{x:-I,y:0},{x:0,y:-V},{x:-I,y:-V},{x:0,y:0},{x:I,y:0},{x:0,y:V},{x:I,y:V},{x:-I,y:V},{x:I,y:-V}]);I=Q.map(R=>({type:"CIMMarkerGraphic",geometry:R,symbol:{type:"CIMPointSymbol",symbolLayers:[S]}}));return{type:"CIMVectorMarker",frame:{xmin:-O,xmax:O,ymin:-Y,ymax:Y},markerGraphics:I,size:L}};T.getSize=function(I){if(I)switch(I.type){case "CIMTextSymbol":return I.height;case "CIMPointSymbol":var M=0;if(I.symbolLayers)for(var S of I.symbolLayers)if(S)switch(S.type){case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":I=
S.size,null!=I&&I>M&&(M=I)}return M;case "CIMLineSymbol":case "CIMPolygonSymbol":S=0;if(I.symbolLayers)for(M of I.symbolLayers)if(M)switch(M.type){case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":I=M.width;null!=I&&I>S&&(S=I);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":case "CIMObjectMarker3D":case "CIMglTFMarker3D":M.markerPlacement&&k.isCIMMarkerStrokePlacement(M.markerPlacement)&&(I=M.size,null!=I&&I>S&&(S=I))}return S}};T.getMarkerScaleRatio=
function(I){if(I)switch(I.type){case "CIMVectorMarker":if(!1!==I.scaleSymbolsProportionally&&I.frame&&null!=I.size)return I.size/(I.frame.ymax-I.frame.ymin)}return 1};return h._createClass(T)}(),J=function(){function T(){}T.findApplicableOverrides=function(I,M,S){if(I&&M){if(I.primitiveName){let V=!1;for(const Q of S)if(Q.primitiveName===I.primitiveName){V=!0;break}if(!V)for(const Q of M)Q.primitiveName===I.primitiveName&&S.push(Q)}switch(I.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(I.effects)for(const V of I.effects)T.findApplicableOverrides(V,
M,S);if(I.symbolLayers)for(const V of I.symbolLayers)T.findApplicableOverrides(V,M,S);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(I.effects)for(const V of I.effects)T.findApplicableOverrides(V,M,S);I.markerPlacement&&T.findApplicableOverrides(I.markerPlacement,M,S);if("CIMVectorMarker"===I.type){if(I.markerGraphics)for(const V of I.markerGraphics)T.findApplicableOverrides(V,
M,S),T.findApplicableOverrides(V.symbol,M,S)}else"CIMCharacterMarker"===I.type?T.findApplicableOverrides(I.symbol,M,S):"CIMHatchFill"===I.type?T.findApplicableOverrides(I.lineSymbol,M,S):"CIMPictureMarker"===I.type&&T.findApplicableOverrides(I.animatedSymbolProperties,M,S)}}};T.findEffectOverrides=function(I,M,S){if(M&&I){var V=I.length;for(let Q=0;Q<V;Q++){const Y=I[Q]?.primitiveName;if(Y){let L=!1;for(const O of S)if(O.primitiveName===Y){L=!0;break}if(!L)for(const O of M)O.primitiveName===Y&&S.push(O)}}}};
T.resolveSymbolOverrides=async function(I,M,S,V,Q,Y,L){if(!I||!I.symbol)return null;let {symbol:O,primitiveOverrides:R}=I;I=!!R;if(!I&&!V)return O;O=w.clone(O);let U=!0;M||(M={attributes:{}},U=!1);I&&(U||(R=R.filter(ba=>!ba.valueExpressionInfo?.expression.includes("$feature"))),L||(R=R.filter(ba=>!ba.valueExpressionInfo?.expression.includes("$view"))),0<R.length&&(I=k.attributesToFields(M.attributes),await T.evaluateOverrides(R,M,{spatialReference:S,fields:I,geometryType:Q},Y,L)),T.applyOverrides(O,
R));V&&T.applyDictionaryTextOverrides(O,M,V);return O};T.evaluateOverrides=async function(I,M,S,V,Q){if(M){var Y;for(const L of I)(I=L.valueExpressionInfo)&&S&&S.geometryType&&(Y||(Y=[]),L.value=void 0,I=a.createRendererExpression(I.expression,S.spatialReference,S.fields).then(O=>{L.value=n(O,M,{$view:Q},S.geometryType,V)}),Y.push(I));void 0!==Y&&0<Y.length&&await Promise.all(Y)}};T.applyDictionaryTextOverrides=function(I,M,S,V="Normal"){if(I&&I.type)switch(I.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":case "CIMTextSymbol":var Q=
I.symbolLayers;if(!Q)break;for(var Y of Q)Y&&"CIMVectorMarker"===Y.type&&T.applyDictionaryTextOverrides(Y,M,S,"CIMTextSymbol"===I.type?I.textCase:V);break;case "CIMVectorMarker":I=I.markerGraphics;if(!I)break;for(Q of I)Q&&T.applyDictionaryTextOverrides(Q,M,S);break;case "CIMMarkerGraphic":(Y=I.textString)&&Y.includes("[")&&(S=k.analyzeTextParts(Y,S),I.textString=k.assignTextValuesFromFeature(M,S,V))}};T.applyOverrides=function(I,M,S,V){if(I.primitiveName)for(const Y of M)if(Y.primitiveName===I.primitiveName){var Q=
(Q=Y.propertyName)?Q.charAt(0).toLowerCase()+Q.substr(1):Q;V&&V.push({cim:I,nocapPropertyName:Q,value:I[Q]});Y.expression&&(Y.value=T.toValue(Y.propertyName,Y.expression));if(S){let L=!1;for(const O of S)O.primitiveName===I.primitiveName&&(L=!0);L||S.push(Y)}p.isSome(Y.value)&&(I[Q]=Y.value)}switch(I.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(I.effects)for(const Y of I.effects)T.applyOverrides(Y,M,S,V);if(I.symbolLayers)for(const Y of I.symbolLayers)T.applyOverrides(Y,
M,S,V);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(I.effects)for(const Y of I.effects)T.applyOverrides(Y,M,S,V);if("CIMVectorMarker"===I.type&&I.markerGraphics)for(const Y of I.markerGraphics)T.applyOverrides(Y,M,S,V),T.applyOverrides(Y.symbol,M,S,V)}};T.restoreOverrides=function(I){for(const M of I)M.cim[M.nocapPropertyName]=M.value};T.buildOverrideKey=function(I){let M="";for(const S of I)void 0!==S.value&&(M+=`${S.primitiveName}${S.propertyName}${JSON.stringify(S.value)}`);
return M};T.toValue=function(I,M){return"DashTemplate"===I?M.split(" ").map(S=>Number(S)):"Color"===I?(I=(new D(M)).toRgba(),I[3]*=255,I):M};return h._createClass(T)}();const N=T=>{if(!T)return m.LineCapStyle.Butt;switch(T){case "butt":return m.LineCapStyle.Butt;case "square":return m.LineCapStyle.Square;case "round":return m.LineCapStyle.Round}},P=T=>{if(!T)return m.LineJoinStyle.Miter;switch(T){case "miter":return m.LineJoinStyle.Miter;case "round":return m.LineJoinStyle.Round;case "bevel":return m.LineJoinStyle.Bevel}},
W=T=>{if(p.isNone(T))return"Center";switch(T){case "left":return"Left";case "right":return"Right";case "center":return"Center"}},X=T=>{if(p.isNone(T))return"Center";switch(T){case "baseline":return"Baseline";case "top":return"Top";case "middle":return"Center";case "bottom":return"Bottom"}},aa=T=>{if(!T)return[0,0,0,0];const {r:I,g:M,b:S,a:V}=T;return[I,M,S,255*V]},Z=(T,I)=>{I="butt"===I;switch(T){case "dash":case "esriSLSDash":return I?[4,3]:[3,4];case "dash-dot":case "esriSLSDashDot":return I?[4,
3,1,3]:[3,4,0,4];case "dot":case "esriSLSDot":return I?[1,3]:[0,4];case "long-dash":case "esriSLSLongDash":return I?[8,3]:[7,4];case "long-dash-dot":case "esriSLSLongDashDot":return I?[8,3,1,3]:[7,4,0,4];case "long-dash-dot-dot":case "esriSLSDashDotDot":return I?[8,3,1,3,1,3]:[7,4,0,4,0,4];case "short-dash":case "esriSLSShortDash":return I?[4,1]:[3,2];case "short-dash-dot":case "esriSLSShortDashDot":return I?[4,1,1,1]:[3,2,0,2];case "short-dash-dot-dot":case "esriSLSShortDashDotDot":return I?[4,1,
1,1,1,1]:[3,2,0,2,0,2];case "short-dot":case "esriSLSShortDot":return I?[1,1]:[0,2];case "solid":case "esriSLSSolid":case "none":return H.error("Unexpected: style does not require rasterization"),[0,0];default:return H.error(`Tried to rasterize SLS, but found an unexpected style: ${T}!`),[0,0]}},ea=T=>{if("circle"===T||"esriSMSCircle"===T){var I=Math.acos(.995);T=Math.ceil(A/I/4);0===T&&(T=1);I=C/T;T*=4;var M=[];M.push([50,0]);for(let S=1;S<T;S++)M.push([50*Math.cos(S*I),-50*Math.sin(S*I)]);M.push([50,
0]);I={rings:[M]};M={xmin:-50,ymin:-50,xmax:50,ymax:50}}else"cross"===T||"esriSMSCross"===T?(I={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},M={xmin:-50,ymin:-50,xmax:50,ymax:50}):"diamond"===T||"esriSMSDiamond"===T?(I={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},M={xmin:-50,ymin:-50,xmax:50,ymax:50}):"square"===T||"esriSMSSquare"===T?(I={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},M={xmin:-50,ymin:-50,xmax:50,ymax:50}):
"x"===T||"esriSMSX"===T?(I={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},M={xmin:-50,ymin:-50,xmax:50,ymax:50}):"triangle"===T||"esriSMSTriangle"===T?(T=2/3*100,M=T-100,I={rings:[[[-57.735026918962575,M],[0,T],[57.735026918962575,M],[-57.735026918962575,M]]]},M={xmin:-57.735026918962575,ymin:M,xmax:57.735026918962575,ymax:T}):"arrow"===T&&(I={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},M={xmin:-50,ymin:-50,
xmax:50,ymax:50});return[M,I]};l.CIMSymbolHelper=K;l.CIMSymbolInflatedSizeHelper=t;l.OverrideHelper=J;l.slsDashToTemplateArray=Z;l.symbolToCIM=function(T){if(!T||!T.type)return null;let I;switch(T.type){case "cim":return T.data;case "web-style":return T;case "simple-marker":T=K.fromSimpleMarker(T);if(!T)return null;I=T;break;case "picture-marker":I=K.fromPictureMarker(T);break;case "simple-line":I=K.fromSimpleLineSymbol(T);break;case "simple-fill":I=K.fromSimpleFillSymbol(T);break;case "picture-fill":I=
K.fromPictureFillSymbol(T);break;case "text":I=K.fromTextSymbol(T)}return{type:"CIMSymbolReference",symbol:I}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(l,h){let D=function(){function w(){this.setIdentity()}var t=w.prototype;t.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)this.rz=Math.atan2(this.rzSin,this.rzCos);return this.rz};
t.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rzCos=1;this.rzSin=0};t.setTranslate=function(p,g){this.tx=p;this.ty=g};t.setTranslateZ=function(p){this.tz=p};t.setRotateCS=function(p,g){this.rz=void 0;this.rzCos=p;this.rzSin=g};t.setRotate=function(p){this.rz=p;this.rzSin=this.rzCos=void 0};t.setRotateY=function(p){this.ry=p};t.setScale=function(p){this.s=p};t.setMeasure=function(p){this.m=p};return h._createClass(w)}(),E=function(){function w(){}w.prototype.next=
function(){return null};return h._createClass(w)}();l.EmptyPlacementCursor=E;l.Placement=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/BidiText ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/ObjectPool ../../core/screenUtils ../../geometry/GeometryCursor ../../geometry/support/aaBoundingRect ../../geometry/support/boundsUtils ../../geometry/support/centroid ../../geometry/support/jsonUtils ./CIMEffects ./CIMImageColorSubstitutionHelper ./CIMOperators ./CIMPlacements ./enums ./imageUtils ./Rect ./TextRasterizer ./utils ../../views/2d/engine/webgl/alignmentUtils ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/mesh/templates/shapingUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q,B,y,u,v,r,z,A){function C(Z,ea=1){const T=v.fromCIMFontDecoration(Z);var I=v.fromCIMFontStyle(Z.fontStyleName);const M=E.getFontFamily(Z.fontFamilyName),{weight:S,style:V}=I;I=ea*(Z.height||5);const Q=v.fromCIMHorizontalAlignment(Z.horizontalAlignment),Y=v.fromCIMVerticalAlignment(Z.verticalAlignment),L=v.getFillColor(Z),O=v.getStrokeColor(Z.haloSymbol);Z=O?ea*(Z.haloSize|0):0;return{color:L,size:I,horizontalAlignment:Q,verticalAlignment:Y,font:{family:M,
style:v.getFontStyle(V),weight:v.getFontWeight(S),decoration:T},halo:{size:Z||0,color:O,style:V},pixelRatio:1,premultiplyColors:!0}}const F=Math.PI/180,G=t.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let H=function(){function Z(T){this._t=T}Z.createIdentity=function(){return new Z([1,0,0,0,1,0])};var ea=Z.prototype;ea.clone=function(){return new Z(this._t.slice())};ea.transform=function(T){const I=this._t;return[I[0]*T[0]+I[1]*T[1]+I[2],I[3]*T[0]+I[4]*T[1]+I[5]]};Z.createScale=function(T,I){return new Z([T,
0,0,0,I,0])};ea.scale=function(T,I){const M=this._t;M[0]*=T;M[1]*=T;M[2]*=T;M[3]*=I;M[4]*=I;M[5]*=I;return this};ea.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};Z.createTranslate=function(T,I){return new Z([0,0,T,0,0,I])};ea.translate=function(T,I){const M=this._t;M[2]+=T;M[5]+=I;return this};Z.createRotate=function(T){const I=Math.cos(T);T=Math.sin(T);return new Z([I,-T,0,T,I,0])};ea.rotate=function(T){return Z.multiply(this,Z.createRotate(T),this)};ea.angle=
function(){const T=this._t[0],I=this._t[3],M=Math.sqrt(T*T+I*I);return[T/M,I/M]};Z.multiply=function(T,I,M){T=T._t;I=I._t;const S=T[1]*I[0]+T[4]*I[1],V=T[2]*I[0]+T[5]*I[1]+I[2],Q=T[0]*I[3]+T[3]*I[4],Y=T[1]*I[3]+T[4]*I[4],L=T[2]*I[3]+T[5]*I[4]+I[5],O=M._t;O[0]=T[0]*I[0]+T[3]*I[1];O[1]=S;O[2]=V;O[3]=Q;O[4]=Y;O[5]=L;return M};ea.invert=function(){const T=this._t;let I=T[0]*T[4]-T[1]*T[3];if(0===I)return new Z([0,0,0,0,0,0]);I=1/I;return new Z([T[4]*I,-T[1]*I,(T[1]*T[5]-T[2]*T[4])*I,-T[3]*I,T[0]*I,(T[2]*
T[3]-T[0]*T[5])*I])};return h._createClass(Z)}();t=function(){function Z(T,I){this._resourceManager=T;this._transfos=[];this._sizeTransfos=[];this._geomUnitsPerPoint=1;this._placementPool=new g(x.Placement,void 0,void 0,100);this._earlyReturn=!1;this._mapRotation=0;this._transfos.push(I||H.createIdentity());this._sizeTransfos.push(I?I.scaleRatio():1)}var ea=Z.prototype;ea.setTransform=function(T,I){this._transfos=[T||H.createIdentity()];this._sizeTransfos=[I||(T?T.scaleRatio():1)]};ea.setGeomUnitsPerPoint=
function(T){this._geomUnitsPerPoint=T};ea.transformPt=function(T){return this._transfos[this._transfos.length-1].transform(T)};ea.transformSize=function(T){return T*this._sizeTransfos[this._sizeTransfos.length-1]};ea.reverseTransformPt=function(T){return this._transfos[this._transfos.length-1].invert().transform(T)};ea.reverseTransformSize=function(T){return T/this._sizeTransfos[this._sizeTransfos.length-1]};ea.getTransformAngle=function(){return this._transfos[this._transfos.length-1].angle()};ea.geomUnitsPerPoint=
function(){return this.isEmbedded()?1:this._geomUnitsPerPoint};ea.isEmbedded=function(){return 1<this._transfos.length};ea.back=function(){return this._transfos[this._transfos.length-1]};ea.push=function(T,I){I=I?T.scaleRatio():1;H.multiply(T,this.back(),T);this._transfos.push(T);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*I)};ea.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};ea.drawSymbol=function(T,I,M){if(T)switch(T.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(T,
I);break;case "CIMTextSymbol":this.drawTextSymbol(T,I,M)}};ea.drawMultiLayerSymbol=function(T,I){if(T&&I){var M=T.symbolLayers;if(M)if((T=T.effects)&&0<T.length){if(I=this.executeEffects(T,I))for(T=I.next();T;)this.drawSymbolLayers(M,T),T=I.next()}else this.drawSymbolLayers(M,I)}};ea.executeEffects=function(T,I){const M=this._resourceManager.geometryEngine;I=new m.SimpleGeometryCursor(I);for(const S of T)(T=n.getEffectOperator(S))&&(I=T.execute(I,S,this.geomUnitsPerPoint(),null,M));return I};ea.drawSymbolLayers=
function(T,I){let M=T.length;for(;M--;){const V=T[M];if(V&&!1!==V.enable){var S=V.effects;if(S&&0<S.length){if(S=this.executeEffects(S,I)){let Q=null;for(;(Q=S.next())&&(this.drawSymbolLayer(V,Q),!this._earlyReturn););}}else this.drawSymbolLayer(V,I);if(this._earlyReturn)break}}};ea.drawSymbolLayer=function(T,I){switch(T.type){case "CIMSolidFill":this.drawSolidFill(I,T.color);break;case "CIMHatchFill":this.drawHatchFill(I,T);break;case "CIMPictureFill":this.drawPictureFill(I,T);break;case "CIMGradientFill":this.drawGradientFill(I,
T);break;case "CIMSolidStroke":this.drawSolidStroke(I,T.color,T.width,T.capStyle,T.joinStyle,T.miterLimit);break;case "CIMPictureStroke":this.drawPictureStroke(I,T);break;case "CIMGradientStroke":this.drawGradientStroke(I,T);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(T,I)}};ea.drawHatchFill=function(T,I){const M=this._buildHatchPolyline(I,T,this.geomUnitsPerPoint());M&&(this.pushClipPath(T),this.drawMultiLayerSymbol(I.lineSymbol,M),this.popClipPath())};
ea.drawPictureFill=function(T,I){};ea.drawGradientFill=function(T,I){};ea.drawPictureStroke=function(T,I){};ea.drawGradientStroke=function(T,I){};ea.drawMarkerLayer=function(T,I){var M=T.markerPlacement;if(M){var S=n.getPlacementOperator(M);if(S){var V="CIMMarkerPlacementInsidePolygon"===M.type||"CIMMarkerPlacementPolygonCenter"===M.type&&M.clipAtBoundary;V&&this.pushClipPath(I);if(I=S.execute(d.getJSONCursor(I),M,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine))for(M=null;(M=I.next())&&
(this.drawMarker(T,M),!this._earlyReturn););V&&this.popClipPath()}}else{V=this._placementPool.acquire();if(c.isPoint(I))V.tx=I.x,V.ty=I.y,this.drawMarker(T,V);else if(c.isPolygon(I)){if(I=e.polygonCentroid(I))[V.tx,V.ty]=I,this.drawMarker(T,V)}else for(S of I.points)if(V.tx=S[0],V.ty=S[1],this.drawMarker(T,V),this._earlyReturn)break;this._placementPool.release(V)}};ea.drawMarker=function(T,I){switch(T.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(T,I);break;case "CIMVectorMarker":this.drawVectorMarker(T,
I)}};ea.drawPictureMarker=function(T,I){if(T){var M=this._resourceManager.getResource(T.url),S=T.size??10;if(!(p.isNone(M)||0>=S)){var V=M.width;M=M.height;if(V&&M){M=V/M;var Q=T.scaleX??1;V=H.createIdentity();var Y=T.anchorPoint;if(Y){var L=Y.x;Y=Y.y;"Absolute"!==T.anchorPointUnits&&(L*=S*M*Q,Y*=S);V.translate(-L,-Y)}M=T.rotation??0;T.rotateClockwise&&(M=-M);this._mapRotation&&(M+=this._mapRotation);M&&V.rotate(M*F);M=T.offsetX??0;Q=T.offsetY??0;if(M||Q){if(this._mapRotation){Y=F*this._mapRotation;
L=Math.cos(Y);Y=Math.sin(Y);const O=M*Y+Q*L;M=M*L-Q*Y;Q=O}V.translate(M,Q)}M=this.geomUnitsPerPoint();1!==M&&V.scale(M,M);(M=I.getAngle())&&V.rotate(M);V.translate(I.tx,I.ty);this.push(V,!1);this.drawImage(T,S);this.pop()}}}};ea.drawVectorMarker=function(T,I){if(T){var M=T.markerGraphics;if(M){var S=T.size??10,V=T.frame,Q=V?V.ymax-V.ymin:0;Q=S&&Q?S/Q:1;S=H.createIdentity();V&&S.translate(.5*-(V.xmax+V.xmin),.5*-(V.ymax+V.ymin));var Y=T.anchorPoint;if(Y){var L=Y.x;Y=Y.y;"Absolute"!==T.anchorPointUnits?
V&&(L*=V.xmax-V.xmin,Y*=V.ymax-V.ymin):(L/=Q,Y/=Q);S.translate(-L,-Y)}1!==Q&&S.scale(Q,Q);V=T.rotation??0;T.rotateClockwise&&(V=-V);this._mapRotation&&(V+=this._mapRotation);V&&S.rotate(V*F);V=T.offsetX??0;Q=T.offsetY??0;if(V||Q){if(this._mapRotation){Y=F*this._mapRotation;L=Math.cos(Y);Y=Math.sin(Y);const O=V*Y+Q*L;V=V*L-Q*Y;Q=O}S.translate(V,Q)}V=this.geomUnitsPerPoint();1!==V&&S.scale(V,V);(V=I.getAngle())&&S.rotate(V);S.translate(I.tx,I.ty);this.push(S,T.scaleSymbolsProportionally);for(const O of M)if(O&&
O.symbol&&O.geometry||G.error("Invalid marker graphic",O),this.drawSymbol(O.symbol,O.geometry,O.textString),this._earlyReturn)break;this.pop()}}};ea.drawTextSymbol=function(T,I,M){if(T&&c.isPoint(I)&&!(0>=(T.height??10))){var S=H.createIdentity(),V=T.angle??0;(V=-V)&&S.rotate(V*F);V=T.offsetX??0;var Q=T.offsetY??0;(V||Q)&&S.translate(V,Q);V=this.geomUnitsPerPoint();1!==V&&S.scale(V,V);S.translate(I.x,I.y);this.push(S,!1);this.drawText(T,M);this.pop()}};ea._buildHatchPolyline=function(T,I,M){var S=
(void 0!==T.separation?T.separation:4)*M,V=void 0!==T.rotation?T.rotation:0;if(0===S)return null;0>S&&(S=-S);for(var Q=0,Y=.5*S;Q>Y;)Q-=S;for(;Q<-Y;)Q+=S;Q=b.create();a.getBoundsXY(Q,I);Q[0]-=Y;Q[1]-=Y;Q[2]+=Y;Q[3]+=Y;for(var L=[[Q[0],Q[1]],[Q[0],Q[3]],[Q[2],Q[3]],[Q[2],Q[1]]];180<V;)V-=180;for(;0>V;)V+=180;Y=Math.cos(V*F);var O=Math.sin(V*F);V=-S*O;I=S*Y;Q=(void 0!==T.offsetX?T.offsetX*M:0)*O-(void 0!==T.offsetY?T.offsetY*M:0)*Y;let R;var U=T=Number.MAX_VALUE;R=M=-Number.MAX_VALUE;for(var ba of L){var ca=
ba[0];const da=ba[1];L=Y*ca+O*da;ca=-O*ca+Y*da;U=Math.min(U,L);T=Math.min(T,ca);R=Math.max(R,L);M=Math.max(M,ca)}T=Math.floor(T/S)*S;ba=Y*U-O*T-V*Q/S;U=O*U+Y*T-I*Q/S;L=Y*R-O*T-V*Q/S;Q=O*R+Y*T-I*Q/S;S=1+Math.round((M-T)/S);Y=[];for(O=0;O<S;O++)ba+=V,U+=I,L+=V,Q+=I,Y.push([[ba,U],[L,Q]]);return{paths:Y}};return h._createClass(Z)}();let K=function(Z){function ea(I,M){I=T.call(this,I,M);I.reset();return I}h._inherits(ea,Z);var T=h._createSuper(ea);Z=ea.prototype;Z.reset=function(){this._xmin=this._ymin=
Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=0};Z.envelope=function(){return new y(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};Z.bounds=function(){return b.fromValues(this._xmin,this._ymin,this._xmax,this._ymax)};Z.drawSolidFill=function(I){!I||0<this._clipCount||(c.isPolygon(I)?this._processPath(I.rings,0):c.isPolyline(I)?this._processPath(I.paths,0):c.isExtent(I)?(I=P(I))&&this._processPath(I.rings,0):console.error("drawSolidFill Unexpected geometry type!"))};
Z.drawSolidStroke=function(I,M,S){!I||0<this._clipCount||(M=.5*this.transformSize(S??0),c.isPolygon(I)?this._processPath(I.rings,M):c.isPolyline(I)?this._processPath(I.paths,M):c.isExtent(I)?(I=P(I))&&this._processPath(I.rings,M):console.error("drawSolidStroke unexpected geometry type!"))};Z.drawMarkerLayer=function(I,M){c.isPolygon(M)&&I.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===I.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===I.markerPlacement.type&&I.markerPlacement.clipAtBoundary)?
this._processPath(M.rings,0):h._get(h._getPrototypeOf(ea.prototype),"drawMarkerLayer",this).call(this,I,M)};Z.drawHatchFill=function(I,M){this.drawSolidFill(I)};Z.drawPictureFill=function(I,M){this.drawSolidFill(I)};Z.drawGradientFill=function(I,M){this.drawSolidFill(I)};Z.drawPictureStroke=function(I,M){this.drawSolidStroke(I,null,M.width)};Z.drawGradientStroke=function(I,M){this.drawSolidStroke(I,null,M.width)};Z.pushClipPath=function(I){this.drawSolidFill(I);this._clipCount++};Z.popClipPath=function(){this._clipCount--};
Z.drawImage=function(I,M){var {url:S}=I;I=I.scaleX??1;let V=I*M,Q=M;S=this._resourceManager.getResource(S);!M&&p.isSome(S)&&(V=I*S.width,Q=S.height);this._merge(this.transformPt([-V/2,-Q/2]),0);this._merge(this.transformPt([-V/2,Q/2]),0);this._merge(this.transformPt([V/2,-Q/2]),0);this._merge(this.transformPt([V/2,Q/2]),0)};Z.drawText=function(I,M){if(M&&0!==M.length){this._textRasterizer||(this._textRasterizer=new u);var S=C(I),[V,Q]=this._textRasterizer.computeTextSize(M,S);M=0;switch(I.horizontalAlignment){case "Left":M=
V/2;break;case "Right":M=-V/2}S=0;switch(I.verticalAlignment){case "Bottom":S=Q/2;break;case "Top":S=-Q/2;break;case "Baseline":S=Q/6}this._merge(this.transformPt([-V/2+M,-Q/2+S]),0);this._merge(this.transformPt([-V/2+M,Q/2+S]),0);this._merge(this.transformPt([V/2+M,-Q/2+S]),0);this._merge(this.transformPt([V/2+M,Q/2+S]),0)}};Z._processPath=function(I,M){if(I)for(const S of I)if(I=S?S.length:0,1<I){this._merge(this.transformPt(S[0]),M);for(let V=1;V<I;V++)this._merge(this.transformPt(S[V]),M)}};Z._merge=
function(I,M){I[0]-M<this._xmin&&(this._xmin=I[0]-M);I[0]+M>this._xmax&&(this._xmax=I[0]+M);I[1]-M<this._ymin&&(this._ymin=I[1]-M);I[1]+M>this._ymax&&(this._ymax=I[1]+M)};return h._createClass(ea)}(t),J=function(Z){function ea(){var I=T.apply(this,arguments);I._searchPoint=[0,0];I._searchDistPoint=0;I._textInfo=null;return I}h._inherits(ea,Z);var T=h._createSuper(ea);Z=ea.prototype;Z.hitTest=function(I,M,S,V,Q,Y){Y*=f.pt2px(1);this.setTransform();this.setGeomUnitsPerPoint(Y);this._searchPoint=[(I[0]+
I[2])/2,(I[1]+I[3])/2];this._searchDistPoint=(I[2]-I[0])/2/Y;this._textInfo=V;this._mapRotation=M&&("CIMPointSymbol"===M.type&&"Map"!==M.angleAlignment||"CIMTextSymbol"===M.type)?Q:0;this._earlyReturn=!1;this.drawSymbol(M,S);return this._earlyReturn};Z.drawSolidFill=function(I,M){this._hitTestFill(I)};Z.drawHatchFill=function(I,M){this._hitTestFill(I)};Z.drawPictureFill=function(I,M){this._hitTestFill(I)};Z.drawGradientFill=function(I,M){this._hitTestFill(I)};Z.drawSolidStroke=function(I,M,S,V,Q,
Y){this._hitTestStroke(I,S)};Z.drawPictureStroke=function(I,M){this._hitTestStroke(I,M.width)};Z.drawGradientStroke=function(I,M){this._hitTestStroke(I,M.width)};Z.drawMarkerLayer=function(I,M){I.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===I.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===I.markerPlacement.type&&I.markerPlacement.clipAtBoundary)?this._hitTestFill(M):h._get(h._getPrototypeOf(ea.prototype),"drawMarkerLayer",this).call(this,I,M)};Z.pushClipPath=function(I){};Z.popClipPath=
function(){};Z.drawImage=function(I,M){var {url:S}=I;I=I.scaleX??1;S=this._resourceManager.getResource(S);if(!p.isNone(S)&&0!==S.height&&0!==M){M*=this.geomUnitsPerPoint();I=S.width/S.height*I*M;S=this.reverseTransformPt(this._searchPoint);var V=this._searchDistPoint;Math.abs(S[0])<I/2+V&&Math.abs(S[1])<M/2+V&&(this._earlyReturn=!0)}};Z.drawText=function(I,M){if(M=this._textInfo)if(M=M.get(I)){var {text:S,mosaicItem:V}=M;if(V?.glyphMosaicItems?.length){M=I.height??10;var {lineGapType:Q,lineGap:Y}=
I,L=Q?aa(Q,Y??0,M):0,O=D.bidiText(S)[1],R="CIMBackgroundCallout"===I.callout?.type;I=A.shapeGlyphs(V.glyphMosaicItems,O,{scale:M/z.GLYPH_SIZE,angle:0,xOffset:0,yOffset:0,hAlign:W(I.horizontalAlignment),vAlign:X(I.verticalAlignment),maxLineWidth:512,lineHeight:z.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(L||1,4)),decoration:I.font.decoration||"none",isCIM:!0,hasBackground:R});L=this.reverseTransformPt(this._searchPoint);M=L[0];L=L[1];for(const U of I.glyphs)if(M>U.xTopLeft&&M<U.xBottomRight&&L>
-U.yBottomRight&&L<-U.yTopLeft){this._earlyReturn=!0;break}}}};Z._hitTestFill=function(I){let M=null;if(c.isExtent(I))M=[[[I.xmin,I.ymin],[I.xmin,I.ymax],[I.xmax,I.ymax],[I.xmax,I.ymin],[I.xmin,I.ymin]]];else if(c.isPolygon(I))M=I.rings;else if(c.isPolyline(I))M=I.paths;else return;I=this.reverseTransformPt(this._searchPoint);this._pointInPolygon(I,M)&&(this._earlyReturn=!0);if(!this._earlyReturn){const S=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(I,M,
S)&&(this._earlyReturn=!0)}};Z._hitTestStroke=function(I,M){let S=null;if(c.isExtent(I))S=[[[I.xmin,I.ymin],[I.xmin,I.ymax],[I.xmax,I.ymax],[I.xmax,I.ymin],[I.xmin,I.ymin]]];else if(c.isPolygon(I))S=I.rings;else if(c.isPolyline(I))S=I.paths;else return;I=this.reverseTransformPt(this._searchPoint);M=(M??0)*this.geomUnitsPerPoint();const V=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(I,S,M/2+V)&&(this._earlyReturn=!0)};Z._pointInPolygon=function(I,M){let S=
0;for(const V of M){M=V.length;for(let Q=1;Q<M;Q++){const Y=V[Q-1],L=V[Q];Y[1]>I[1]!==L[1]>I[1]&&(0<(L[0]-Y[0])*(I[1]-Y[1])-(L[1]-Y[1])*(I[0]-Y[0])?S++:S--)}}return 0!==S};Z._nearLine=function(I,M,S){for(const Q of M){M=Q.length;for(let Y=1;Y<M;Y++){var V=Q[Y-1];const L=Q[Y];let O=(L[0]-V[0])*(L[0]-V[0])+(L[1]-V[1])*(L[1]-V[1]);if(0!==O&&(O=Math.sqrt(O),Math.abs(((L[0]-V[0])*(I[1]-V[1])-(L[1]-V[1])*(I[0]-V[0]))/O)<S&&(V=((L[0]-V[0])*(I[0]-V[0])+(L[1]-V[1])*(I[1]-V[1]))/O,V>-S&&V<O+S)))return!0}}return!1};
return h._createClass(ea)}(t),N=function(Z){function ea(I,M,S,V){M=T.call(this,M,S);M._applyAdditionalRenderProps=V;M._colorSubstitutionHelper=new k;M._ctx=I;return M}h._inherits(ea,Z);var T=h._createSuper(ea);Z=ea.prototype;Z.drawSolidFill=function(I,M){if(I){if(c.isPolygon(I))this._buildPath(I.rings,!0);else if(c.isPolyline(I))this._buildPath(I.paths,!0);else if(c.isExtent(I))this._buildPath(P(I).rings,!0);else if(c.isMultipoint(I))console.log("CanvasDrawHelper.drawSolidFill - No implementation!");
else return;I=this._ctx;I.fillStyle="string"===typeof M?M:"rgba("+Math.round(M[0])+","+Math.round(M[1])+","+Math.round(M[2])+","+(M[3]??255)/255+")";I.fill("evenodd")}};Z.drawSolidStroke=function(I,M,S,V,Q,Y){if(I&&M&&0!==S){if(c.isPolygon(I))this._buildPath(I.rings,!0);else if(c.isPolyline(I))this._buildPath(I.paths,!1);else if(c.isExtent(I))this._buildPath(P(I).rings,!0);else{console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");return}I=this._ctx;I.strokeStyle="string"===typeof M?
M:"rgba("+Math.round(M[0])+","+Math.round(M[1])+","+Math.round(M[2])+","+(M[3]??255)/255+")";I.lineWidth=Math.max(this.transformSize(S),.5);this._setCapStyle(V);this._setJoinStyle(Q);I.miterLimit=Y;I.stroke()}};Z.pushClipPath=function(I){this._ctx.save();if(c.isPolygon(I))this._buildPath(I.rings,!0);else if(c.isPolyline(I))this._buildPath(I.paths,!0);else if(c.isExtent(I))this._buildPath(P(I).rings,!0);else return;this._ctx.clip("evenodd")};Z.popClipPath=function(){this._ctx.restore()};Z.drawImage=
function(I,M){const {colorSubstitutions:S,url:V,tintColor:Q}=I;I=I.scaleX??1;var Y=this._resourceManager.getResource(V);if(!p.isNone(Y)){var L=Y.width/Y.height*M,O=M;M||(L=Y.width,O=Y.height);var R=v.isSVGImage(V)||"src"in Y&&v.isSVGImage(Y.src);M="getFrame"in Y?B.getFirstFrame(Y):Y;S&&(M=this._colorSubstitutionHelper.applyColorSubstituition(M,S));this._applyAdditionalRenderProps&&!R&&Q&&(M=this._colorSubstitutionHelper.tintImageData(M,Q));Y=this.transformPt([0,0]);var [U,ba]=this.getTransformAngle();
R=this.transformSize(1);var ca=this._ctx;ca.save();ca.setTransform({m11:I*R*U,m12:I*R*ba,m21:-R*ba,m22:R*U,m41:Y[0],m42:Y[1]});ca.drawImage(M,-L/2,-O/2,L,O);ca.restore()}};Z.drawText=function(I,M){if(M&&0!==M.length&&(this._textRasterizer||(this._textRasterizer=new u),I=C(I),I.size*=this.transformSize(f.px2pt(1)),M=this._textRasterizer.rasterizeText(M,I))){var {size:S,anchorX:V,anchorY:Q,canvas:Y}=M;M=S[0]*(V+.5);I=S[1]*(Q-.5);var L=this._ctx,O=this.transformPt([0,0]),[R,U]=this.getTransformAngle();
L.save();L.setTransform({m11:1*R,m12:1*U,m21:-1*U,m22:1*R,m41:O[0]-1*M,m42:O[1]+1*I});L.drawImage(Y,0,0);L.restore()}};Z.drawPictureFill=function(I,M){if(I){var {colorSubstitutions:S,height:V,offsetX:Q,offsetY:Y,rotation:L,scaleX:O,tintColor:R,url:U}=M;M=this._resourceManager.getResource(U);if(!p.isNone(M)){if(c.isPolygon(I))this._buildPath(I.rings,!0);else if(c.isPolyline(I))this._buildPath(I.paths,!0);else if(c.isExtent(I))this._buildPath(P(I).rings,!0);else if(c.isMultipoint(I))console.log("CanvasDrawHelper.drawPictureFill - No implementation!");
else return;I=this._ctx;var ba=v.isSVGImage(U)||"src"in M&&v.isSVGImage(M.src),ca="getFrame"in M?B.getFirstFrame(M):M;S&&(ca=this._colorSubstitutionHelper.applyColorSubstituition(ca,S));if(this._applyAdditionalRenderProps){if(ba||R&&(ca=this._colorSubstitutionHelper.tintImageData(ca,R)),ba=I.createPattern(ca,"repeat"),ca=this.transformSize(1),L||(L=0),Q=Q?ca*Q:0,Y=Y?ca*Y:0,V&&(V*=ca),ca=V?V/M.height:1,M=O&&V?O*V/M.width:1,0!==L||1!==ca||1!==M||0!==Q||0!==Y){const da=new DOMMatrix;da.rotateSelf(0,
0,-L).translateSelf(Q,Y).scaleSelf(M,ca,1);ba.setTransform(da)}}else ba=I.createPattern(ca,"repeat");I.save();I.fillStyle=ba;I.fill("evenodd");I.restore()}}};Z.drawPictureStroke=function(I,M){if(I){var {colorSubstitutions:S,capStyle:V,joinStyle:Q,miterLimit:Y,tintColor:L,url:O,width:R}=M;M=this._resourceManager.getResource(O);if(!p.isNone(M)){if(c.isPolygon(I))var U=I.rings;else if(c.isPolyline(I))U=I.paths;else if(c.isExtent(I))U=P(I).rings;else{c.isMultipoint(I)&&console.log("CanvasDrawHelper.drawPictureStroke - No implementation!");
return}R||(R=M.width);I=v.isSVGImage(O)||"src"in M&&v.isSVGImage(M.src);var ba="getFrame"in M?B.getFirstFrame(M):M;S&&(ba=this._colorSubstitutionHelper.applyColorSubstituition(ba,S));this._applyAdditionalRenderProps&&(I||L&&(ba=this._colorSubstitutionHelper.tintImageData(ba,L)));M=Math.max(this.transformSize(f.pt2px(R)),.5);I=M/ba.width;var ca=this._ctx;ba=ca.createPattern(ba,"repeat-y");ca.save();this._setCapStyle(V);this._setJoinStyle(Q);void 0!==Y&&(ca.miterLimit=Y);ca.lineWidth=M;var da;for(let ka of U){ka=
w.clone(ka);var ha=da=void 0,ia=void 0;let la=ha=void 0;U=ka;for(var ja=U[0],fa=1;fa<U.length;)la=U[fa][0]-ja[0],ha=U[fa][1]-ja[1],ha=0!==la?ha/la:Math.PI/2,void 0!==ia&&1E-4>=ha-ia?(U.splice(fa-1,1),ja=da):(da=ja,ja=U[fa],fa++),ia=ha;if(ka&&!(1>=ka.length))for(U=this.transformPt(ka[0]),ia=1;ia<ka.length;ia++)da=this.transformPt(ka[ia]),ja=180/Math.PI*Math.atan2(da[1]-U[1],da[0]-U[0]),fa=new DOMMatrix,fa.translateSelf(0,U[1]-M/2).scaleSelf(I,I,1).rotateSelf(0,0,90-ja),ba.setTransform(fa),ca.strokeStyle=
ba,ca.beginPath(),ca.moveTo(U[0],U[1]),ca.lineTo(da[0],da[1]),ca.stroke(),U=da}ca.restore()}}};Z._buildPath=function(I,M){const S=this._ctx;S.beginPath();if(I)for(const V of I)if(I=V?V.length:0,1<I){let Q=this.transformPt(V[0]);S.moveTo(Q[0],Q[1]);for(let Y=1;Y<I;Y++)Q=this.transformPt(V[Y]),S.lineTo(Q[0],Q[1]);M&&S.closePath()}};Z._setCapStyle=function(I){switch(I){case q.LineCapStyle.Butt:this._ctx.lineCap="butt";break;case q.LineCapStyle.Round:this._ctx.lineCap="round";break;case q.LineCapStyle.Square:this._ctx.lineCap=
"square"}};Z._setJoinStyle=function(I){switch(I){case q.LineJoinStyle.Bevel:this._ctx.lineJoin="bevel";break;case q.LineJoinStyle.Round:this._ctx.lineJoin="round";break;case q.LineJoinStyle.Miter:this._ctx.lineJoin="miter"}};return h._createClass(ea)}(t);const P=Z=>Z?{spatialReference:Z.spatialReference,rings:[[[Z.xmin,Z.ymin],[Z.xmin,Z.ymax],[Z.xmax,Z.ymax],[Z.xmax,Z.ymin],[Z.xmin,Z.ymin]]]}:null,W=Z=>{switch(Z){case "Left":return r.HAlign.Left;case "Right":return r.HAlign.Right;case "Center":return r.HAlign.Center;
case "Justify":return G.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),r.HAlign.Center}},X=Z=>{switch(Z){case "Top":return r.VAlign.Top;case "Center":return r.VAlign.Center;case "Bottom":return r.VAlign.Bottom;case "Baseline":return r.VAlign.Baseline}},aa=(Z,ea,T)=>{switch(Z){case "ExtraLeading":return 1+ea/T;case "Multiple":return ea;case "Exact":return ea/T}};l.CIMSymbolDrawHelper=t;l.C_DEG_TO_RAD=F;l.CanvasDrawHelper=N;l.EnvDrawHelper=K;l.HittestDrawHelper=
J;l.Transformation=H;l.horizontalAlignment2HAlign=W;l.lineGapType2LineHeight=aa;l.verticalAlignment2VAlign=X;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/GeometryCursor":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./support/jsonUtils"],function(l,h,D){let E=function(){function g(){this._end=-1;this._yFactor=1;this._ids=new Map}var f=g.prototype;f.initialize=function(d,b,a,e,c){this.hasZ=a;this.hasM=e;this.geometryType=b;this._geometry=d;this._pathIndex=
-1;this._pathOffset=0;this._stride=2+Number(a)+Number(e);this._pointOffset=-this._stride;this._end=-1;this._yFactor=c;this._ids.clear();return this};f.reset=function(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this._yFactor)};f.seekPathFront=function(){this._pointOffset=this._pathOffset-this._stride};f.seekPathEnd=function(){this._pointOffset=this._end};f.seekPathAt=function(d){d=this._pathOffset+d*this._stride;return 0<=d&&d<this._end?(this._pointOffset=d,!0):!1};f.nextPoint=
function(){return(this._pointOffset+=this._stride)<this._end};f.prevPoint=function(){return(this._pointOffset-=this._stride)>=this._pathOffset};f.nextPath=function(){0<=this._pathIndex&&(this._pathOffset+=this._stride*this._geometry.lengths[this._pathIndex]);this._pointOffset=this._pathOffset-this._stride;this._end=this._pointOffset+this._stride+this._stride*this._geometry.lengths[this._pathIndex+1];return++this._pathIndex<this._geometry.lengths.length};f.pathLength=function(){const d=this._end,b=
this._stride,a=this._geometry.coords;let e=0;for(let c=this._pathOffset+b;c<d;c+=b){const m=a[c]-a[c-b],k=a[c+1]-a[c-b+1];e+=Math.sqrt(m*m+k*k)}return e};h._createClass(g,[{key:"numPoints",get:function(){const {lengths:d}=this._geometry;return 0>this._pathIndex||this._pathIndex>d.length-1?0:d[this._pathIndex]}},{key:"numPaths",get:function(){return this._geometry.lengths.length}},{key:"pathIndex",get:function(){return this._pathIndex}},{key:"x",get:function(){return this._geometry.coords[this._pointOffset]}},
{key:"y",get:function(){return this._yFactor*this._geometry.coords[this._pointOffset+1]}},{key:"z",get:function(){return this._geometry.coords[this._pointOffset+2]}},{key:"m",get:function(){return this._geometry.coords[this._pointOffset+(this.hasZ?3:2)]}},{key:"id",get:function(){return this._ids.get(this._pointOffset)||0},set:function(d){this._ids.set(this._pointOffset,d)}}]);return g}(),w=function(){function g(){this._pathLen=0;this._yFactor=1}var f=g.prototype;f.initialize=function(d,b,a,e){if(D.isPolygon(d))d=
[d.rings,"esriGeometryPolygon"];else if(D.isPolyline(d))d=[d.paths,"esriGeometryPolyline"];else if(D.isMultipoint(d))d=[[d.points],"esriGeometryMultipoint"];else if(D.isExtent(d))d=[[[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]]],"esriGeometryEnvelope"];else if(D.isPoint(d)){const k=[d.x,d.y];d.z&&k.push(d.z);d.m&&k.push(d.m);d=[[[k]],"esriGeometryPoint"]}else d=[[],null];const [c,m]=d;this._paths=c;this.geometryType=m;this.hasZ=b;this.hasM=a;this._pathIndex=this._pointIndex=
-1;this._yFactor=e;return this};f.reset=function(){this._pathIndex=this._pointIndex=-1};f.seekPathFront=function(){this._pointIndex=-1};f.seekPathEnd=function(){this._pointIndex=this._currentPath.length};f.seekPathAt=function(d){return 0<=d&&d<this._currentPath.length?(this._pointIndex=d,this._currentPoint=this._currentPath[this._pointIndex],!0):!1};f.nextPoint=function(){this._currentPoint=this._currentPath[++this._pointIndex];return this._pointIndex<this._pathLen};f.prevPoint=function(){this._currentPoint=
this._currentPath[--this._pointIndex];return 0<=this._pointIndex};f.nextPath=function(){this._pointIndex=-1;this._pathLen=this.pathIndex<this._paths.length-1?this._paths[this._pathIndex+1].length:0;this._currentPath=this._paths[++this._pathIndex];return this._pathIndex<this._paths.length};f.pathLength=function(){const d=this._currentPath.length,b=this._currentPath;let a=0;for(let c=1;c<d;c++){var e=b[c-1];const m=b[c],k=m[0]-e[0];e=m[1]-e[1];a+=Math.sqrt(k*k+e*e)}return a};h._createClass(g,[{key:"numPoints",
get:function(){return 0>this._pathIndex||this._pathIndex>this._paths.length-1?-1:this._paths[this._pathIndex].length}},{key:"numPaths",get:function(){return this._paths.length}},{key:"pathIndex",get:function(){return this._pathIndex}},{key:"pointIndex",get:function(){return this._pointIndex}},{key:"x",get:function(){return this._currentPoint[0]}},{key:"y",get:function(){return this._yFactor*this._currentPoint[1]}},{key:"z",get:function(){return this._currentPoint[2]}},{key:"m",get:function(){return this._currentPoint[this.hasZ?
3:2]}},{key:"id",get:function(){return this._currentPoint[4]},set:function(d){this._currentPoint[4]=d}}]);return g}();const t=new E,p=new w;l.getJSONCursor=function(g,f=!1,d=!1,b=!1){return p.initialize(g,d,b,f?-1:1)};l.getOptimizedCursor=function(g,f,d=!1,b=!1,a=!1){return t.initialize(g,f,b,a,d?-1:1)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/lang","../../geometry/support/TileClipper"],
function(l,h,D,E){let w,t=function(){function p(g){this._geometry=g}p.prototype.next=function(){const g=this._geometry;this._geometry=null;return g};return h._createClass(p)}();l.SimpleGeometryCursor=t;l.clipPolygonToTileExtent=function(p,g){w||(w=new E.TileClipper(0,0,0,1));w.reset(E.GeometryType.Polygon);w.setPixelMargin(g+1);w.setExtent(512);for(var f of p.rings)if(f&&!(3>f.length)){p=f[0][0];g=-f[0][1];w.moveTo(p,g);for(let d=1;d<f.length;d++)p=f[d][0],g=-f[d][1],w.lineTo(p,g);w.close()}if(p=
w.result(!1)){f=[];for(const d of p){p=[];f.push(p);for(const b of d)p.push([b.x,-b.y])}return{rings:f}}return{rings:[]}};l.clipPolylineToTileExtent=function(p,g){w||(w=new E.TileClipper(0,0,0,1));w.reset(E.GeometryType.LineString);w.setPixelMargin(g+1);w.setExtent(512);for(var f of p.paths)if(f&&!(2>f.length)){p=f[0][0];g=-f[0][1];w.moveTo(p,g);for(let d=1;d<f.length;d++)p=f[d][0],g=-f[d][1],w.lineTo(p,g)}if(p=w.result(!1)){f=[];for(const d of p){p=[];f.push(p);for(const b of d)p.push([b.x,-b.y])}return{paths:f}}return{paths:[]}};
l.clone=function(p){return D.clone(p)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/TileClipper":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(l,h){l.GeometryType=void 0;(function(d){d[d.Unknown=0]="Unknown";d[d.Point=1]="Point";d[d.LineString=2]="LineString";d[d.Polygon=3]="Polygon"})(l.GeometryType||(l.GeometryType={}));let D=function(){function d(a,e){this.x=a;this.y=e}var b=d.prototype;b.clone=function(){return new d(this.x,
this.y)};b.equals=function(a,e){return a===this.x&&e===this.y};b.isEqual=function(a){return a.x===this.x&&a.y===this.y};b.setCoords=function(a,e){this.x=a;this.y=e};b.normalize=function(){var a=this.x;const e=this.y;a=Math.sqrt(a*a+e*e);this.x/=a;this.y/=a};b.rightPerpendicular=function(){const a=this.x;this.x=this.y;this.y=-a};b.move=function(a,e){this.x+=a;this.y+=e};b.assign=function(a){this.x=a.x;this.y=a.y};b.assignAdd=function(a,e){this.x=a.x+e.x;this.y=a.y+e.y};b.assignSub=function(a,e){this.x=
a.x-e.x;this.y=a.y-e.y};b.rotate=function(a,e){const c=this.x,m=this.y;this.x=c*a-m*e;this.y=c*e+m*a};b.scale=function(a){this.x*=a;this.y*=a};b.length=function(){const a=this.x,e=this.y;return Math.sqrt(a*a+e*e)};d.distance=function(a,e){const c=e.x-a.x;a=e.y-a.y;return Math.sqrt(c*c+a*a)};d.add=function(a,e){return new d(a.x+e.x,a.y+e.y)};d.sub=function(a,e){return new d(a.x-e.x,a.y-e.y)};return h._createClass(d)}(),E=h._createClass(function(d,b,a){this.ratio=d;this.x=b;this.y=a}),w=function(){function d(a,
e,c,m=8,k=8){this._lines=[];this._starts=[];this.validateTessellation=!0;this._pixelRatio=m;this._pixelMargin=k;this._tileSize=512*m;this._dz=a;this._yPos=e;this._xPos=c}var b=d.prototype;b.setPixelMargin=function(a){a!==this._pixelMargin&&(this._pixelMargin=a,this.setExtent(this._extent))};b.setExtent=function(a){this._extent=a;this._finalRatio=this._tileSize/a*(1<<this._dz);let e=this._pixelRatio*this._pixelMargin;e/=this._finalRatio;a>>=this._dz;e>a&&(e=a);this._margin=e;this._xmin=a*this._xPos-
e;this._ymin=a*this._yPos-e;this._xmax=this._xmin+a+2*e;this._ymax=this._ymin+a+2*e};b.reset=function(a){this._type=a;this._lines=[];this._starts=[];this._line=null;this._start=0};b.moveTo=function(a,e){this._pushLine();this._prevIsIn=this._isIn(a,e);this._moveTo(a,e,this._prevIsIn);this._prevPt=new D(a,e);this._firstPt=new D(a,e);this._dist=0};b.lineTo=function(a,e){const c=this._isIn(a,e),m=new D(a,e),k=D.distance(this._prevPt,m);if(c)if(this._prevIsIn)this._lineTo(a,e,!0);else{var n=this._prevPt;
var x=m;a=this._intersect(x,n);this._start=this._dist+k*(1-this._r);this._lineTo(a.x,a.y,!0);this._lineTo(x.x,x.y,!0)}else if(this._prevIsIn)x=this._prevPt,n=m,a=this._intersect(x,n),this._lineTo(a.x,a.y,!0),this._lineTo(n.x,n.y,!1);else{const B=this._prevPt;if(!(B.x<=this._xmin&&m.x<=this._xmin||B.x>=this._xmax&&m.x>=this._xmax||B.y<=this._ymin&&m.y<=this._ymin||B.y>=this._ymax&&m.y>=this._ymax)){a=[];if(B.x<this._xmin&&m.x>this._xmin||B.x>this._xmin&&m.x<this._xmin){e=(this._xmin-B.x)/(m.x-B.x);
var q=B.y+e*(m.y-B.y);q<=this._ymin?x=!1:q>=this._ymax?x=!0:a.push(new E(e,this._xmin,q))}if(B.x<this._xmax&&m.x>this._xmax||B.x>this._xmax&&m.x<this._xmax)e=(this._xmax-B.x)/(m.x-B.x),q=B.y+e*(m.y-B.y),q<=this._ymin?x=!1:q>=this._ymax?x=!0:a.push(new E(e,this._xmax,q));if(B.y<this._ymin&&m.y>this._ymin||B.y>this._ymin&&m.y<this._ymin)e=(this._ymin-B.y)/(m.y-B.y),q=B.x+e*(m.x-B.x),q<=this._xmin?n=!1:q>=this._xmax?n=!0:a.push(new E(e,q,this._ymin));if(B.y<this._ymax&&m.y>this._ymax||B.y>this._ymax&&
m.y<this._ymax)e=(this._ymax-B.y)/(m.y-B.y),q=B.x+e*(m.x-B.x),q<=this._xmin?n=!1:q>=this._xmax?n=!0:a.push(new E(e,q,this._ymax));if(0===a.length)n?x?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):x?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(1<a.length&&a[0].ratio>a[1].ratio)this._start=this._dist+k*a[1].ratio,this._lineTo(a[1].x,a[1].y,!0),this._lineTo(a[0].x,a[0].y,!0);else for(this._start=this._dist+k*a[0].ratio,n=0;n<a.length;n++)this._lineTo(a[n].x,
a[n].y,!0)}this._lineTo(m.x,m.y,!1)}this._dist+=k;this._prevIsIn=c;this._prevPt=m};b.close=function(){if(2<this._line.length){var a=this._firstPt,e=this._prevPt;a.x===e.x&&a.y===e.y||this.lineTo(a.x,a.y);a=this._line;for(e=a.length;4<=e;)if(a[0].x===a[1].x&&a[0].x===a[e-2].x||a[0].y===a[1].y&&a[0].y===a[e-2].y)a.pop(),a[0].x=a[e-2].x,a[0].y=a[e-2].y,--e;else break}};b.result=function(a=!0){this._pushLine();if(0===this._lines.length)return null;this._type===l.GeometryType.Polygon&&a&&g.simplify(this._tileSize,
this._margin*this._finalRatio,this._lines);return this._lines};b.resultWithStarts=function(){if(this._type!==l.GeometryType.LineString)throw Error("Only valid for lines");this._pushLine();const a=this._lines,e=a.length;if(0===e)return null;const c=[];for(let m=0;m<e;m++)c.push({line:a[m],start:this._starts[m]||0});return c};b._isIn=function(a,e){return a>=this._xmin&&a<=this._xmax&&e>=this._ymin&&e<=this._ymax};b._intersect=function(a,e){let c,m,k;if(e.x>=this._xmin&&e.x<=this._xmax)m=e.y<=this._ymin?
this._ymin:this._ymax,k=(m-a.y)/(e.y-a.y),c=a.x+k*(e.x-a.x);else if(e.y>=this._ymin&&e.y<=this._ymax)c=e.x<=this._xmin?this._xmin:this._xmax,k=(c-a.x)/(e.x-a.x),m=a.y+k*(e.y-a.y);else{m=e.y<=this._ymin?this._ymin:this._ymax;c=e.x<=this._xmin?this._xmin:this._xmax;const n=(c-a.x)/(e.x-a.x),x=(m-a.y)/(e.y-a.y);n<x?(k=n,m=a.y+n*(e.y-a.y)):(k=x,c=a.x+x*(e.x-a.x))}this._r=k;return new D(c,m)};b._pushLine=function(){this._line&&(this._type===l.GeometryType.Point?0<this._line.length&&(this._lines.push(this._line),
this._starts.push(this._start)):this._type===l.GeometryType.LineString?1<this._line.length&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===l.GeometryType.Polygon&&3<this._line.length&&(this._lines.push(this._line),this._starts.push(this._start)));this._line=[];this._start=0};b._moveTo=function(a,e,c){this._type!==l.GeometryType.Polygon?c&&(a=Math.round((a-(this._xmin+this._margin))*this._finalRatio),e=Math.round((e-(this._ymin+this._margin))*this._finalRatio),this._line.push(new D(a,
e))):(c||(a<this._xmin&&(a=this._xmin),a>this._xmax&&(a=this._xmax),e<this._ymin&&(e=this._ymin),e>this._ymax&&(e=this._ymax)),a=Math.round((a-(this._xmin+this._margin))*this._finalRatio),e=Math.round((e-(this._ymin+this._margin))*this._finalRatio),this._line.push(new D(a,e)),this._isV=this._isH=!1)};b._lineTo=function(a,e,c){if(this._type!==l.GeometryType.Polygon)if(c){a=Math.round((a-(this._xmin+this._margin))*this._finalRatio);e=Math.round((e-(this._ymin+this._margin))*this._finalRatio);if(0<this._line.length&&
(c=this._line[this._line.length-1],c.equals(a,e)))return;this._line.push(new D(a,e))}else this._line&&0<this._line.length&&this._pushLine();else if(c||(a<this._xmin&&(a=this._xmin),a>this._xmax&&(a=this._xmax),e<this._ymin&&(e=this._ymin),e>this._ymax&&(e=this._ymax)),a=Math.round((a-(this._xmin+this._margin))*this._finalRatio),e=Math.round((e-(this._ymin+this._margin))*this._finalRatio),this._line&&0<this._line.length){c=this._line[this._line.length-1];const m=c.x===a,k=c.y===e;m&&k||(this._isH&&
m?(c.x=a,c.y=e,c=this._line[this._line.length-2],c.x===a&&c.y===e?(this._line.pop(),1>=this._line.length?this._isV=this._isH=!1:(c=this._line[this._line.length-2],this._isH=c.x===a,this._isV=c.y===e)):(this._isH=c.x===a,this._isV=c.y===e)):this._isV&&k?(c.x=a,c.y=e,c=this._line[this._line.length-2],c.x===a&&c.y===e?(this._line.pop(),1>=this._line.length?this._isV=this._isH=!1:(c=this._line[this._line.length-2],this._isH=c.x===a,this._isV=c.y===e)):(this._isH=c.x===a,this._isV=c.y===e)):(this._line.push(new D(a,
e)),this._isH=m,this._isV=k))}else this._line.push(new D(a,e))};return h._createClass(d)}(),t=function(){function d(){}var b=d.prototype;b.setExtent=function(a){this._ratio=4096===a?1:4096/a};b.reset=function(a){this._lines=[];this._line=null};b.moveTo=function(a,e){this._line&&this._lines.push(this._line);this._line=[];const c=this._ratio;this._line.push(new D(a*c,e*c))};b.lineTo=function(a,e){const c=this._ratio;this._line.push(new D(a*c,e*c))};b.close=function(){const a=this._line;a&&!a[0].isEqual(a[a.length-
1])&&a.push(a[0])};b.result=function(){this._line&&this._lines.push(this._line);return 0===this._lines.length?null:this._lines};h._createClass(d,[{key:"validateTessellation",get:function(){return 1>this._ratio}}]);return d}();var p;(function(d){d[d.sideLeft=0]="sideLeft";d[d.sideRight=1]="sideRight";d[d.sideTop=2]="sideTop";d[d.sideBottom=3]="sideBottom"})(p||(p={}));let g=function(){function d(){}d.simplify=function(b,a,e){if(e){var c=-a,m=b+a,k=-a,n=b+a;b=[];a=[];var x=e.length;for(let q=0;q<x;++q){const B=
e[q];if(!B||2>B.length)continue;let y=B[0],u;const v=B.length;for(let r=1;r<v;++r)u=B[r],y.x===u.x&&(y.x<=c&&(y.y>u.y?(b.push(q),b.push(r),b.push(p.sideLeft),b.push(-1)):(a.push(q),a.push(r),a.push(p.sideLeft),a.push(-1))),y.x>=m&&(y.y<u.y?(b.push(q),b.push(r),b.push(p.sideRight),b.push(-1)):(a.push(q),a.push(r),a.push(p.sideRight),a.push(-1)))),y.y===u.y&&(y.y<=k&&(y.x<u.x?(b.push(q),b.push(r),b.push(p.sideTop),b.push(-1)):(a.push(q),a.push(r),a.push(p.sideTop),a.push(-1))),y.y>=n&&(y.x>u.x?(b.push(q),
b.push(r),b.push(p.sideBottom),b.push(-1)):(a.push(q),a.push(r),a.push(p.sideBottom),a.push(-1)))),y=u}0!==b.length&&0!==a.length&&(d.fillParent(e,a,b),d.fillParent(e,b,a),c=[],d.calcDeltas(c,a,b),d.calcDeltas(c,b,a),d.addDeltas(c,e))}};d.fillParent=function(b,a,e){const c=e.length,m=a.length;for(let B=0;B<m;B+=4){var k=a[B],n=a[B+1];const y=a[B+2],u=b[k][n-1];k=b[k][n];n=8092;let v=-1;for(let r=0;r<c;r+=4){if(e[r+2]!==y)continue;var x=e[r];const z=e[r+1];var q=b[x][z-1];x=b[x][z];switch(y){case p.sideLeft:case p.sideRight:f(u.y,
q.y,x.y)&&f(k.y,q.y,x.y)&&(q=Math.abs(x.y-q.y),q<n&&(n=q,v=r));break;case p.sideTop:case p.sideBottom:f(u.x,q.x,x.x)&&f(k.x,q.x,x.x)&&(q=Math.abs(x.x-q.x),q<n&&(n=q,v=r))}}a[B+3]=v}};d.calcDeltas=function(b,a,e){const c=a.length;for(let m=0;m<c;m+=4){const k=d.calcDelta(m,a,e,[]);b.push(a[m]);b.push(a[m+1]);b.push(a[m+2]);b.push(k)}};d.calcDelta=function(b,a,e,c){b=a[b+3];if(-1===b)return 0;const m=c.length;if(1<m&&c[m-2]===b)return 0;c.push(b);return d.calcDelta(b,e,a,c)+1};d.addDeltas=function(b,
a){const e=b.length;let c=0;for(var m=0;m<e;m+=4){var k=b[m+3];k>c&&(c=k)}for(m=0;m<e;m+=4){k=a[b[m]];const n=b[m+1],x=c-b[m+3];switch(b[m+2]){case p.sideLeft:k[n-1].x-=x;k[n].x-=x;1===n&&(k[k.length-1].x-=x);n===k.length-1&&(k[0].x-=x);break;case p.sideRight:k[n-1].x+=x;k[n].x+=x;1===n&&(k[k.length-1].x+=x);n===k.length-1&&(k[0].x+=x);break;case p.sideTop:k[n-1].y-=x;k[n].y-=x;1===n&&(k[k.length-1].y-=x);n===k.length-1&&(k[0].y-=x);break;case p.sideBottom:k[n-1].y+=x,k[n].y+=x,1===n&&(k[k.length-
1].y+=x),n===k.length-1&&(k[0].y+=x)}}};return h._createClass(d)}();const f=(d,b,a)=>d>=b&&d<=a||d>=a&&d<=b;l.Point=D;l.SimpleBuilder=t;l.TileClipper=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMImageColorSubstitutionHelper":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function h(){}var D=h.prototype;D.applyColorSubstituition=function(E,w){if(!w)return E;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));
const {width:t,height:p}=E,g=this._rasterizationCanvas,f=g.getContext("2d");E!==g&&(g.width=t,g.height=p,f.drawImage(E,0,0,t,p));E=f.getImageData(0,0,t,p).data;if(w)for(var d of w)if(d&&d.oldColor&&4===d.oldColor.length&&d.newColor&&4===d.newColor.length){const [b,a,e,c]=d.oldColor,[m,k,n,x]=d.newColor;if(b!==m||a!==k||e!==n||c!==x)for(w=0;w<E.length;w+=4)b===E[w]&&a===E[w+1]&&e===E[w+2]&&c===E[w+3]&&(E[w]=m,E[w+1]=k,E[w+2]=n,E[w+3]=x)}d=new ImageData(E,t,p);f.putImageData(d,0,0);return g};D.tintImageData=
function(E,w){if(!w||4>w.length)return E;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const {width:t,height:p}=E,g=this._rasterizationCanvas,f=g.getContext("2d");E!==g&&(g.width=t,g.height=p,f.drawImage(E,0,0,t,p));E=f.getImageData(0,0,t,p);E=new Uint8Array(E.data);w=[w[0]/255,w[1]/255,w[2]/255,w[3]/255];for(let d=0;d<E.length;d+=4)E[d]*=w[0],E[d+1]*=w[1],E[d+2]*=w[2],E[d+3]*=w[3];w=new ImageData(new Uint8ClampedArray(E.buffer),t,p);f.putImageData(w,0,0);
return g};return l._createClass(h)}()})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectControlMeasureLine ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q,B,y,u){l.getEffectOperator=function(v){if(!v)return null;switch(v.type){case "CIMGeometricEffectAddControlPoints":return h.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return D.EffectArrow.local();case "CIMGeometricEffectBuffer":return E.EffectBuffer.local();case "CIMGeometricEffectControlMeasureLine":return w.EffectControlMeasureLine.local();case "CIMGeometricEffectCut":return t.EffectCut.local();case "CIMGeometricEffectDashes":return p.EffectDashes.local();
case "CIMGeometricEffectDonut":return g.EffectDonut.local();case "CIMGeometricEffectJog":return f.EffectJog.local();case "CIMGeometricEffectMove":return d.EffectMove.local();case "CIMGeometricEffectOffset":return b.EffectOffset.local();case "CIMGeometricEffectReverse":return a.EffectReverse.local();case "CIMGeometricEffectRotate":return e.EffectRotate.local();case "CIMGeometricEffectScale":return c.EffectScale.local();case "CIMGeometricEffectWave":return m.EffectWave.local()}return null};l.getPlacementOperator=
function(v){if(!v)return null;switch(v.type){case "CIMMarkerPlacementAlongLineSameSize":return k.PlacementAlongLineSameSize.local();case "CIMMarkerPlacementAtExtremities":return n.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return x.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return q.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return B.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return y.PlacementOnVertices.local();
case "CIMMarkerPlacementPolygonCenter":return u.PlacementPolygonCenter.local()}return null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(l,h,D,E,w){let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=
function(f,d,b,a,e){return new p(f,d,b)};return h._createClass(g)}();t.instance=null;let p=function(){function g(d,b,a){this._inputGeometries=d;this._angleTolerance=void 0!==b.angleTolerance?b.angleTolerance:120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var f=g.prototype;f.next=function(){for(var d=this._inputGeometries.next();d;){if(E.isPolygon(d))return this._isClosed=!0,d=D.clone(d),this._processMultipath(d.rings),d;if(E.isPolyline(d))return this._isClosed=!1,d=
D.clone(d),this._processMultipath(d.paths),d;if(E.isExtent(d)){if(this._maxCosAngle)return d;this._isClosed=!0;d=[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]];this._processPath(d);return{rings:[d]}}d=this._inputGeometries.next()}return null};f._processMultipath=function(d){if(d)for(const b of d)this._processPath(b)};f._processPath=function(d){if(d){let b=d.length,a=d[0],e,c,m,k,n,x;this._isClosed&&++b;for(let q=1;q<b;++q){let B;B=this._isClosed&&q===b-1?d[0]:d[q];
const y=B[0]-a[0],u=B[1]-a[1],v=Math.sqrt(y*y+u*u);1<q&&0<v&&0<m&&(e*y+c*u)/v/m<=this._maxCosAngle&&w.setId(a,1);1===q&&(k=y,n=u,x=v);0<v&&(a=B,e=y,c=u,m=v)}this._isClosed&&0<m&&0<x&&(e*k+c*n)/x/m<=this._maxCosAngle&&w.setId(d[0],1)}};return h._createClass(g)}();l.EffectAddControlPoints=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/lang","../../geometry/support/jsonUtils",
"./CIMPlacements"],function(l,h,D,E,w){function t(n){n&&(E.isPoint(n)?n.y=-n.y:E.isPolygon(n)?g(n.rings):E.isPolyline(n)?g(n.paths):E.isMultipoint(n)&&p(n.points))}function p(n){if(n){const x=n.length;for(let q=0;q<x;q++)n[q][1]=-n[q][1]}}function g(n){if(n)for(const x of n)p(x)}function f(n){if(n){var x=n.length;for(--x;0<x;--x)n[x][0]-=n[x-1][0],n[x][1]-=n[x-1][1]}}function d(n){if(n)for(const x of n)f(x)}function b(n){if(n){const x=n.length;for(let q=1;q<x;++q)n[q][0]+=n[q-1][0],n[q][1]+=n[q-1][1]}}
function a(n){if(n)for(const x of n)b(x)}function e(n){n&&(E.isPolygon(n)?a(n.rings):E.isPolyline(n)?a(n.paths):E.isMultipoint(n)&&b(n.points),t(n))}function c(n){n&&n.reverse()}let m=function(){function n(x,q=!0,B=!0,y=0){this.isClosed=!1;this.geometryCursor=null;this.geometryCursor=!q&&"esriGeometryPolygon"===x.geometryType||!B&&"esriGeometryPolyline"===x.geometryType?null:x;this.geomUnitsPerPoint=y;this.iteratePath=!1;this.internalPlacement=new w.Placement}n.prototype.next=function(){if(!this.geometryCursor)return null;
for(;this.iteratePath||this.geometryCursor.nextPath();){this.geometryCursor.seekPathFront();const x=this.processPath(this.geometryCursor);if(x)return x}return this.geometryCursor=null};return h._createClass(n)}(),k=function(){function n(x,q,B,y=0){this.isClosed=!1;this.multiPath=null;this.inputGeometries=x;this.acceptPolygon=q;this.acceptPolyline=B;this.geomUnitsPerPoint=y;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}n.prototype.next=function(){for(;;){if(!this.multiPath){for(var x=this.inputGeometries.next();x;)if(E.isPolygon(x)?
this.acceptPolygon&&(this.multiPath=x.rings,this.isClosed=!0):E.isPolyline(x)?this.acceptPolyline&&(this.multiPath=x.paths,this.isClosed=!1):E.isExtent(x)&&this.acceptPolygon&&(this.multiPath=[[[x.xmin,x.ymin],[x.xmin,x.ymax],[x.xmax,x.ymax],[x.xmax,x.ymin],[x.xmin,x.ymin]]],this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else x=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||
this.pathIndex++,x=this.processPath(this.multiPath[this.pathIndex]))return x;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return h._createClass(n)}();l.PathGeometryCursor=k;l.PathTransformationCursor=m;l.cloneAndDecodeGeometry=function(n){n=D.clone(n);e(n);return n};l.deltaDecodeGeometry=e;l.deltaEncodeGeometry=function(n){n&&(t(n),E.isPolygon(n)?d(n.rings):E.isPolyline(n)?d(n.paths):E.isMultipoint(n)&&f(n.points))};l.flipYs=t;l.getCoord2D=function(n,x,q){return[n[0]+(x[0]-n[0])*q,n[1]+
(x[1]-n[1])*q]};l.getId=function(n){return n[4]};l.reverseMultipath=function(n){if(n)for(const x of n)c(x)};l.reversePath=c;l.setId=function(n,x){n[4]=x};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(l,h,D,E,w){const t=w.GeometricEffectArrowType.OpenEnded;let p=function(){function f(){}f.local=function(){null===f.instance&&
(f.instance=new f);return f.instance};f.prototype.execute=function(d,b,a,e,c){return new g(d,b,a)};return h._createClass(f)}();p.instance=null;let g=function(f){function d(a,e,c){a=b.call(this,a,!1,!0);a._curveHelper=new E.CurveHelper;a._width=(void 0!==e.width?e.width:5)*c;a._arrowType=void 0!==e.geometricEffectArrowType?e.geometricEffectArrowType:void 0!==e.arrowType?e.arrowType:t;a._offsetFlattenError=E.PIXEL_TOLERANCE*c;return a}h._inherits(d,f);var b=h._createSuper(d);f=d.prototype;f.processPath=
function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case w.GeometricEffectArrowType.Block:return this._constructSimpleArrow(a,!1);case w.GeometricEffectArrowType.Crossed:return this._constructCrossedArrow(a)}};f._constructSimpleArrow=function(a,e){var c=this._curveHelper.calculatePathLength(a),m=this._width;c<2*m&&(m=c/2);c=this._curveHelper.getSubCurve(a,0,c-m);if(!c)return null;var k=m/2;if(this._curveHelper.isEmpty(c,!1))return null;m=this._constructOffset(c,-k);
if(!m)return null;c=this._constructOffset(c,k);if(!c)return null;const n=this._constructArrowBasePoint(m,-k/2);if(!n)return null;k=this._constructArrowBasePoint(c,k/2);if(!k)return null;a=a[a.length-1];e||(this._makeControlPoint(c,!0),this._makeControlPoint(m,!0));const x=new E.PathHelper;x.addPath(c,!0);x.lineTo(k);this._makeControlPoint(x.path());x.lineTo(a);this._makeControlPoint(x.path());x.lineTo(n);this._makeControlPoint(x.path());x.addPath(m,!1);return e?{paths:[x.path()]}:(x.close(),{rings:[x.path()]})};
f._constructCrossedArrow=function(a){var e=this._curveHelper.calculatePathLength(a),c=this._width;e<3.732050807568877*c&&(c=e/3.732050807568877);var m=this._curveHelper.getSubCurve(a,0,e-2.732050807568877*c);if(!m)return null;var k=c/2;if(this._curveHelper.isEmpty(m,!1))return null;const n=this._constructOffset(m,k);if(!n)return null;m=this._constructOffset(m,-k);if(!m)return null;e=this._curveHelper.getSubCurve(a,0,e-c);if(!e||this._curveHelper.isEmpty(e,!1))return null;c=this._constructOffset(e,
k);if(!c)return null;var x=this._constructOffset(e,-k);if(!x)return null;e=c[c.length-1];c=this._constructArrowBasePoint(c,k/2);if(!c)return null;const q=x[x.length-1];k=this._constructArrowBasePoint(x,-k/2);if(!k)return null;a=a[a.length-1];this._makeControlPoint(n,!1);this._makeControlPoint(m,!1);x=new E.PathHelper;x.addPath(n,!0);this._makeControlPoint(x.path());x.lineTo(q);x.lineTo(k);this._makeControlPoint(x.path());x.lineTo(a);this._makeControlPoint(x.path());x.lineTo(c);this._makeControlPoint(x.path());
x.lineTo(e);this._makeControlPoint(x.path());x.addPath(m,!1);return{paths:[x.path()]}};f._constructOffset=function(a,e){return this._curveHelper.offset(a,e,w.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError)};f._constructArrowBasePoint=function(a,e){if(!a||2>a.length)return null;var c=a[a.length-2];a=a[a.length-1];c=[a[0]-c[0],a[1]-c[1]];this._curveHelper.normalize(c);return[a[0]+c[1]*e,a[1]-c[0]*e]};f._makeControlPoint=function(a,e=!1){e?D.setId(a[0],1):D.setId(a[a.length-1],1)};return h._createClass(d)}(D.PathGeometryCursor);
l.EffectArrow=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/CurveHelper":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./enums"],function(l,h,D){let E=function(){function t(){this._path=[]}var p=t.prototype;p.path=function(){return this._path};p.addPath=function(g,f){f||g.reverse();Array.prototype.push.apply(this._path,g);f||g.reverse()};t.mergePath=function(g,f){f&&Array.prototype.push.apply(g,f)};p.startPath=function(g){this._path.push(g)};
p.lineTo=function(g){this._path.push(g)};p.close=function(){const g=this._path;1<g.length&&(g[0][0]!==g[g.length-1][0]||g[0][1]!==g[g.length-1][1])&&g.push([g[0][0],g[0][1]])};return h._createClass(t)}(),w=function(){function t(g,f){}var p=t.prototype;p.normalize=function(g){const f=Math.sqrt(g[0]*g[0]+g[1]*g[1]);0!==f&&(g[0]/=f,g[1]/=f)};p.calculateLength=function(g,f){const d=f[0]-g[0];g=f[1]-g[1];return Math.sqrt(d*d+g*g)};p.calculateSegLength=function(g,f){return this.calculateLength(g[f],g[f+
1])};p.calculatePathLength=function(g){let f=0;const d=g?g.length:0;for(let b=0;b<d-1;++b)f+=this.calculateSegLength(g,b);return f};p.calculatePathArea=function(g){let f=0;const d=g?g.length:0;for(let b=0;b<d-1;++b)f+=(g[b+1][0]-g[b][0])*(g[b+1][1]+g[b][1]);return f/2};p.getCoord2D=function(g,f,d){return[g[0]+(f[0]-g[0])*d,g[1]+(f[1]-g[1])*d]};p.getSegCoord2D=function(g,f,d){return this.getCoord2D(g[f],g[f+1],d)};p.getAngle=function(g,f,d){return Math.atan2(f[1]-g[1],f[0]-g[0])};p.getSegAngle=function(g,
f,d){return this.getAngle(g[f],g[f+1],d)};p.getAngleCS=function(g,f,d){d=f[0]-g[0];g=f[1]-g[1];f=Math.sqrt(d*d+g*g);return 0<f?[d/f,g/f]:[1,0]};p.getSegAngleCS=function(g,f,d){return this.getAngleCS(g[f],g[f+1],d)};p.cut=function(g,f,d,b){d=0>=d?g[f]:this.getSegCoord2D(g,f,d);g=1<=b?g[f+1]:this.getSegCoord2D(g,f,b);return[d,g]};p.addSegment=function(g,f,d){d&&g.push(f[0]);g.push(f[1])};p.getSubCurve=function(g,f,d){const b=[];return this.appendSubCurve(b,g,f,d)?b:null};p.appendSubCurve=function(g,
f,d,b){const a=f?f.length-1:0;let e=0,c=!0,m=0;for(;m<a;){const n=this.calculateSegLength(f,m);if(0!==n){if(c){if(e+n>d){var k=(d-e)/n;let x=1,q=!1;e+n>=b&&(x=(b-e)/n,q=!0);(k=this.cut(f,m,k,x))&&this.addSegment(g,k,c);if(q)break;c=!1}}else{if(e+n>b){(f=this.cut(f,m,0,(b-e)/n))&&this.addSegment(g,f,c);break}this.addSegment(g,[f[m],f[m+1]],c)}e+=n}++m}return!0};p.getCIMPointAlong=function(g,f){const d=g?g.length-1:0;let b=0,a=-1;for(;a<d;){++a;const e=this.calculateSegLength(g,a);if(0!==e){if(b+e>
f)return this.getCoord2D(g[a],g[a+1],(f-b)/e);b+=e}}return null};p.isEmpty=function(g,f){if(!g||1>=g.length)return!0;const d=g?g.length-1:0;let b=-1;for(;b<d;)if(++b,g[b+1][0]!==g[b][0]||g[b+1][1]!==g[b][1]||f&&g[b+1][2]!==g[b][2])return!1;return!0};p.offset=function(g,f,d,b,a){if(!g||2>g.length)return null;var e=0,c=g[e++];for(a=e;e<g.length;){var m=g[e];if(m[0]!==c[0]||m[1]!==c[1])e!==a&&(g[a]=g[e]),c=g[a++];e++}(e=g[0][0]===g[a-1][0]&&g[0][1]===g[a-1][1])&&--a;if(a<(e?3:2))return null;m=[];c=e?
g[a-1]:null;let k=g[0];for(let y=0;y<a;y++){const u=y===a-1?e?g[0]:null:g[y+1];if(c)if(u){var n=[u[0]-k[0],u[1]-k[1]];this.normalize(n);var x=[k[0]-c[0],k[1]-c[1]];this.normalize(x);var q=x[0]*n[1]-x[1]*n[0],B=x[0]*n[0]+x[1]*n[1];if(0===q&&1===B){k=u;continue}if(0<=q===0>=f)1>B&&(n=[n[0]-x[0],n[1]-x[1]],this.normalize(n),x=Math.sqrt((1+B)/2),x>1/b&&(x=-Math.abs(f)/x,m.push([k[0]-n[0]*x,k[1]-n[1]*x])));else switch(d){case D.GeometricEffectOffsetMethod.Mitered:if(c=Math.sqrt((1+B)/2),0<c&&1/c<b){n=
[n[0]-x[0],n[1]-x[1]];this.normalize(n);x=Math.abs(f)/c;m.push([k[0]-n[0]*x,k[1]-n[1]*x]);break}case D.GeometricEffectOffsetMethod.Bevelled:m.push([k[0]+x[1]*f,k[1]-x[0]*f]);m.push([k[0]+n[1]*f,k[1]-n[0]*f]);break;case D.GeometricEffectOffsetMethod.Rounded:if(1>B){m.push([k[0]+x[1]*f,k[1]-x[0]*f]);c=Math.floor(2.5*(1-B));if(0<c){q=B=1/c;for(let v=1;v<c;v++,q+=B){const r=[x[1]*(1-q)+n[1]*q,-x[0]*(1-q)-n[0]*q];this.normalize(r);m.push([k[0]+r[0]*f,k[1]+r[1]*f])}}m.push([k[0]+n[1]*f,k[1]-n[0]*f])}break;
default:0>q?(m.push([k[0]+(x[1]+x[0])*f,k[1]+(x[1]-x[0])*f]),m.push([k[0]+(n[1]-n[0])*f,k[1]-(n[0]+n[1])*f])):(c=Math.sqrt((1+Math.abs(B))/2),n=[n[0]-x[0],n[1]-x[1]],this.normalize(n),x=f/c,m.push([k[0]-n[0]*x,k[1]-n[1]*x]))}}else n=[k[0]-c[0],k[1]-c[1]],this.normalize(n),m.push([k[0]+n[1]*f,k[1]-n[0]*f]);else n=[u[0]-k[0],u[1]-k[1]],this.normalize(n),m.push([k[0]+n[1]*f,k[1]-n[0]*f]);c=k;k=u}if(m.length<(e?3:2))return null;e&&m.push([m[0][0],m[0][1]]);return m};return h._createClass(t)}();l.CurveHelper=
w;l.PIXEL_TOLERANCE=.03;l.PathHelper=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectBuffer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../CurveHelper ../enums ../../../geometry/SpatialReference".split(" "),function(l,h,D,E,w,t,p,g,f){D=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};
b.prototype.execute=function(a,e,c,m,k){return new d(a,e,c,m,k)};return h._createClass(b)}();D.instance=null;let d=function(){function b(a,e,c,m,k){this._inputGeometries=a;this._tileKey=m;this._geometryEngine=k;this._curveHelper=new p.CurveHelper;this._size=(void 0!==e.size?e.size:1)*c;this._offsetFlattenError=p.PIXEL_TOLERANCE*c}b.prototype.next=function(){let a;for(;a=this._inputGeometries.next();){if(0===this._size)return a;if(w.isExtent(a))if(0<this._size){var e=this._curveHelper.offset([[a.xmin,
a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]],this._size,g.GeometricEffectOffsetMethod.Rounded,4,this._offsetFlattenError);if(e)return{rings:[e]}}else if(0>this._size&&0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._size)return{xmin:a.xmin-this._size,xmax:a.xmax+this._size,ymin:a.ymin-this._size,ymax:a.ymax+this._size};e=this._geometryEngine;if(E.isNone(e))break;let c=a;if(w.isPolygon(a)&&this._tileKey&&(c=t.clipPolygonToTileExtent(a,Math.abs(this._size)+1),!c||!c.rings||
0===c.rings.length))continue;if(w.isPolyline(a)&&this._tileKey&&(c=t.clipPolylineToTileExtent(a,Math.abs(this._size)+1),!c||!c.paths||0===c.paths.length))continue;return e.buffer(f.WebMercator,c,this._size,1)}return null};return h._createClass(b)}();l.EffectBuffer=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectControlMeasureLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../geometry/support/jsonUtils","../CIMCursor",
"../enums"],function(l,h,D,E,w){let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(f,d,b,a,e){return new p(f,d,b)};return h._createClass(g)}();t.instance=null;let p=function(){function g(d,b,a){this._defaultPointSize=20;this._inputGeometries=d;this._geomUnitsPerPoint=a;this._rule=b.rule??w.GeometricEffectControlMeasureLineRule.FullGeometry;this._defaultSize=this._defaultPointSize*a}var f=g.prototype;f.next=function(){let d;
for(;d=this._inputGeometries.next();){let b;D.isPoint(d)?b=this._processGeom([[[d.x,d.y]]]):D.isMultipoint(d)?b=this._processGeom([d.points]):D.isPolyline(d)?b=this._processGeom(d.paths):D.isPolygon(d)&&(b=this._processGeom(d.rings));if(b&&b.length)return{paths:b}}return null};f._clone=function(d){return[d[0],d[1]]};f._mid=function(d,b){return[(d[0]+b[0])/2,(d[1]+b[1])/2]};f._mix=function(d,b,a,e){return[d[0]*b+a[0]*e,d[1]*b+a[1]*e]};f._add=function(d,b){return[d[0]+b[0],d[1]+b[1]]};f._add2=function(d,
b,a){return[d[0]+b,d[1]+a]};f._sub=function(d,b){return[d[0]-b[0],d[1]-b[1]]};f._dist=function(d,b){return Math.sqrt((d[0]-b[0])*(d[0]-b[0])+(d[1]-b[1])*(d[1]-b[1]))};f._norm=function(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])};f._normalize=function(d,b=1){b/=this._norm(d);d[0]*=b;d[1]*=b};f._leftPerpendicular=function(d){const b=d[0];d[0]=-d[1];d[1]=b};f._leftPerp=function(d){return[-d[1],d[0]]};f._rightPerpendicular=function(d){const b=-d[0];d[0]=d[1];d[1]=b};f._rightPerp=function(d){return[d[1],
-d[0]]};f._dotProduct=function(d,b){return d[0]*b[0]+d[1]*b[1]};f._crossProduct=function(d,b){return d[0]*b[1]-d[1]*b[0]};f._rotateDirect=function(d,b,a){const e=d[0]*a+d[1]*b;d[0]=d[0]*b-d[1]*a;d[1]=e};f._makeCtrlPt=function(d){d=[d[0],d[1]];E.setId(d,1);return d};f._addAngledTicks=function(d,b,a,e){const c=this._sub(a,b);this._normalize(c);var m=this._crossProduct(c,this._sub(e,b));e=0<m?this._rightPerp(c):this._leftPerp(c);m=Math.abs(m)/2;const k=[];k.push([b[0]+(e[0]-c[0])*m,b[1]+(e[1]-c[1])*
m]);k.push(b);k.push(a);k.push([a[0]+(e[0]+c[0])*m,a[1]+(e[1]+c[1])*m]);d.push(k)};f._addBezier2=function(d,b,a,e,c){if(0===c--)d.push(e);else{var m=this._mid(b,a);a=this._mid(a,e);var k=this._mid(m,a);this._addBezier2(d,b,m,k,c);this._addBezier2(d,k,a,e,c)}};f._addBezier3=function(d,b,a,e,c,m){if(0===m--)d.push(c);else{var k=this._mid(b,a),n=this._mid(a,e);e=this._mid(e,c);a=this._mid(k,n);n=this._mid(n,e);var x=this._mid(a,n);this._addBezier3(d,b,k,a,x,m);this._addBezier3(d,x,n,e,c,m)}};f._add90DegArc=
function(d,b,a,e,c){e=c??0<this._crossProduct(this._sub(a,b),this._sub(e,b));c=this._mid(b,a);const m=this._sub(c,b);e?this._leftPerpendicular(m):this._rightPerpendicular(m);c[0]+=m[0];c[1]+=m[1];this._addBezier3(d,b,this._mix(b,.33333,c,.66667),this._mix(a,.33333,c,.66667),a,4)};f._addArrow=function(d,b,a){var e=b[0],c=b[1],m=b[b.length-1],k=this._sub(e,c);this._normalize(k);const n=this._crossProduct(k,this._sub(m,c));c=.5*n;var x=this._leftPerp(k);const q=[m[0]-x[0]*n,m[1]-x[1]*n];var B=b.length-
1;m=[];m.push(a?[-x[0],-x[1]]:x);var y=[-k[0],-k[1]];for(a=1;a<B-1;a++){k=this._sub(b[a+1],b[a]);this._normalize(k);var u=this._dotProduct(k,y);x=this._crossProduct(k,y);u=Math.sqrt((1+u)/2);y=this._sub(k,y);this._normalize(y);y[0]/=u;y[1]/=u;m.push(0>x?[-y[0],-y[1]]:y);y=k}m.push(this._rightPerp(y));for(B=m.length-1;0<B;B--)d.push([b[B][0]+m[B][0]*c,b[B][1]+m[B][1]*c]);d.push([q[0]+m[0][0]*c,q[1]+m[0][1]*c]);d.push([q[0]+m[0][0]*n,q[1]+m[0][1]*n]);d.push(e);d.push([q[0]-m[0][0]*n,q[1]-m[0][1]*n]);
d.push([q[0]-m[0][0]*c,q[1]-m[0][1]*c]);for(e=1;e<m.length;e++)d.push([b[e][0]-m[e][0]*c,b[e][1]-m[e][1]*c])};f._cp2=function(d,b,a){return 2<=d.length?d[1]:this._add2(d[0],b*this._defaultSize,a*this._defaultSize)};f._cp3=function(d,b,a,e){if(3<=d.length)return d[2];a=this._mix(d[0],1-a,b,a);d=this._sub(b,d[0]);this._normalize(d);this._rightPerpendicular(d);return[a[0]+d[0]*e*this._defaultSize,a[1]+d[1]*e*this._defaultSize]};f._arrowPath=function(d){if(2<d.length)return d;const b=d[0];d=this._cp2(d,
-4,0);const a=this._sub(b,d);this._normalize(a);const e=this._rightPerp(a);return[b,d,[b[0]+(e[0]-a[0])*this._defaultSize,b[1]+(e[1]-a[1])*this._defaultSize]]};f._arrowLastSeg=function(d){var b=d[0];const a=this._cp2(d,-4,0);if(3<=d.length)b=d[d.length-1];else{d=this._sub(b,a);this._normalize(d);const e=this._rightPerp(d);b=[b[0]+(e[0]-d[0])*this._defaultSize,b[1]+(e[1]-d[1])*this._defaultSize]}return[a,b]};f._processGeom=function(d){if(!d)return null;const b=[];for(const a of d){if(!a||0===a.length)continue;
const e=a.length;let c=a[0];switch(this._rule){case w.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:const m=this._cp2(a,0,-1),k=this._cp3(a,m,.5,4),n=[];n.push(k);n.push(this._mid(c,m));b.push(n);break;case w.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:const x=this._cp2(a,0,-1);b.push([x,c]);break;case w.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:const q=this._cp2(a,-4,1),B=this._cp3(a,q,.882353,-1.94),y=[];y.push(this._mid(q,B));y.push(c);
b.push(y);break;case w.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:const u=this._cp2(a,-4,1),v=this._cp3(a,u,.882353,-1.94),r=this._sub(v,u);let z;z=0<this._crossProduct(r,this._sub(c,u))?this._rightPerp(z):this._leftPerp(r);const A=[];A.push([u[0]+(z[0]-r[0])/3,u[1]+(z[1]-r[1])/3]);A.push(u);A.push(v);A.push([v[0]+(z[0]+r[0])/3,v[1]+(z[1]+r[1])/3]);b.push(A);break;case w.GeometricEffectControlMeasureLineRule.DoublePerpendicular:const C=this._cp2(a,0,-1),F=this._cp3(a,C,.5,3),G=this._mid(c,
C),H=this._sub(G,F);this._normalize(H);const K=this._crossProduct(H,this._sub(c,F));this._leftPerpendicular(H);const J=[];J.push(c);J.push([F[0]+H[0]*K,F[1]+H[1]*K]);b.push(J);const N=[];N.push([F[0]-H[0]*K,F[1]-H[1]*K]);N.push(C);b.push(N);break;case w.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:const P=this._cp2(a,0,-1),W=this._cp3(a,P,.5,3),X=this._mid(c,P),aa=this._sub(X,W);this._normalize(aa);const Z=this._crossProduct(aa,this._sub(c,W));this._leftPerpendicular(aa);const ea=
[];ea.push([W[0]+aa[0]*Z,W[1]+aa[1]*Z]);ea.push([W[0]-aa[0]*Z,W[1]-aa[1]*Z]);b.push(ea);break;case w.GeometricEffectControlMeasureLineRule.TriplePerpendicular:const T=this._cp2(a,0,-1),I=this._cp3(a,T,.5,4),M=this._mid(c,T),S=this._sub(M,I);this._normalize(S);const V=this._crossProduct(S,this._sub(c,I));this._leftPerpendicular(S);const Q=[];Q.push([I[0]+S[0]*V*.8,I[1]+S[1]*V*.8]);Q.push([M[0]+.8*(c[0]-M[0]),M[1]+.8*(c[1]-M[1])]);b.push(Q);b.push([I,M]);const Y=[];Y.push([I[0]-S[0]*V*.8,I[1]-S[1]*
V*.8]);Y.push([M[0]+.8*(T[0]-M[0]),M[1]+.8*(T[1]-M[1])]);b.push(Y);break;case w.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:const L=this._cp2(a,0,-1),O=this._cp3(a,L,.5,4),R=this._mid(c,L);let U=this._sub(L,c);const ba=Math.cos(Math.PI/18),ca=Math.sin(Math.PI/18),da=Math.sqrt((1+ba)/2),ha=Math.sqrt((1-ba)/2),ia=[];let ja;0<this._crossProduct(U,this._sub(O,c))?(ia.push(c),U=this._sub(c,R),ja=L):(ia.push(L),U=this._sub(L,R),ja=c);this._rotateDirect(U,da,ha);U[0]/=da;U[1]/=da;for(let qa=
1;18>=qa;qa++)ia.push(this._add(R,U)),this._rotateDirect(U,ba,ca);ia.push(ja);b.push(ia);break;case w.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:const fa=this._cp2(a,0,-1),ka=this._cp3(a,fa,1,-1);let la=this._sub(c,fa);this._normalize(la);const ma=this._crossProduct(la,this._sub(ka,fa))/2;this._leftPerpendicular(la);const na=[fa[0]+la[0]*ma,fa[1]+la[1]*ma];la=this._sub(fa,na);const oa=Math.cos(Math.PI/18);let ra=Math.sin(Math.PI/18);0<ma&&(ra=-ra);const pa=[fa];for(let qa=1;18>=
qa;qa++)this._rotateDirect(la,oa,ra),pa.push(this._add(na,la));b.push(pa);break;case w.GeometricEffectControlMeasureLineRule.HalfCircleExtended:const sa=this._cp2(a,0,-2),ta=this._cp3(a,sa,1,-1);let wa;if(4<=e)wa=a[3];else{const qa=this._sub(c,sa);wa=this._add(ta,qa)}const va=this._dist(sa,ta)/2/.75,ua=this._sub(sa,c);this._normalize(ua,va);const xa=this._sub(ta,wa);this._normalize(xa,va);b.push([wa,ta]);const Fa=[this._clone(ta)];this._addBezier3(Fa,ta,this._add(ta,xa),this._add(sa,ua),sa,4);Fa.push(c);
b.push(Fa);break;case w.GeometricEffectControlMeasureLineRule.OpenCircle:const Ma=this._cp2(a,-2,0),za=this._sub(Ma,c),Ha=Math.cos(Math.PI/18),Aa=-Math.sin(Math.PI/18),Ia=[Ma];for(let qa=1;33>=qa;qa++)this._rotateDirect(za,Ha,Aa),Ia.push(this._add(c,za));b.push(Ia);break;case w.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:const Ea=this._cp2(a,0,-1);let Ba;if(3<=e)Ba=a[2];else{const qa=this._sub(Ea,c),ya=this._leftPerp(qa);Ba=[c[0]+ya[0]-.25*qa[0],c[1]+ya[1]-.25*qa[1]]}let Ya;if(4<=
e)Ya=a[3];else{const qa=this._mid(c,Ea),ya=this._sub(c,Ea);this._normalize(ya);this._leftPerpendicular(ya);const Ga=this._crossProduct(ya,this._sub(Ba,qa));this._rightPerpendicular(ya);Ya=[Ba[0]+ya[0]*Ga*2,Ba[1]+ya[1]*Ga*2]}const Da=this._sub(Ea,c);let Za,Na;Za=0<this._crossProduct(Da,this._sub(Ba,c))?this._rightPerp(Da):this._leftPerp(Da);Na=[];Na.push(Ba);Na.push(c);Na.push([c[0]+(Za[0]-Da[0])/3,c[1]+(Za[1]-Da[1])/3]);b.push(Na);Za=0<this._crossProduct(Da,this._sub(Ya,Ea))?this._rightPerp(Za):this._leftPerp(Da);
Na=[];Na.push([Ea[0]+(Za[0]+Da[0])/3,Ea[1]+(Za[1]+Da[1])/3]);Na.push(Ea);Na.push(Ya);b.push(Na);break;case w.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:const Ab=this._cp2(a,0,2),Tb=this._cp3(a,Ab,0,1);let Bb;if(4<=e)Bb=a[3];else{const qa=this._sub(Ab,c);Bb=this._add(Tb,qa)}this._addAngledTicks(b,c,Ab,this._mid(Tb,Bb));this._addAngledTicks(b,Tb,Bb,this._mid(c,Ab));break;case w.GeometricEffectControlMeasureLineRule.GapExtentMidline:const Ub=this._cp2(a,2,0),qc=this._cp3(a,Ub,0,1);
let Vb;if(4<=e)Vb=a[3];else{const qa=this._sub(Ub,c);Vb=this._add(qc,qa)}const Wb=[];Wb.push(this._mid(c,qc));Wb.push(this._mid(Ub,Vb));b.push(Wb);break;case w.GeometricEffectControlMeasureLineRule.Chevron:const rc=this._cp2(a,-1,-1);let Xb;if(3<=e)Xb=a[2];else{const qa=this._sub(rc,c);this._leftPerpendicular(qa);Xb=this._add(c,qa)}b.push([rc,this._makeCtrlPt(c),Xb]);break;case w.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:const hb=this._cp2(a,0,-2),sc=this._cp3(a,hb,.5,-1);let Ca=
this._sub(hb,c);const ib=this._norm(Ca);Ca[0]/=ib;Ca[1]/=ib;const $a=this._crossProduct(Ca,this._sub(sc,c));let jb=this._dotProduct(Ca,this._sub(sc,c));jb<.05*ib?jb=.05*ib:jb>.95*ib&&(jb=.95*ib);const Cb=[c[0]+Ca[0]*jb,c[1]+Ca[1]*jb];this._leftPerpendicular(Ca);let kb=[];kb.push([Cb[0]-Ca[0]*$a,Cb[1]-Ca[1]*$a]);kb.push([Cb[0]+Ca[0]*$a,Cb[1]+Ca[1]*$a]);b.push(kb);const tc=[hb[0]+Ca[0]*$a,hb[1]+Ca[1]*$a];Ca=this._sub(hb,tc);const Sc=Math.cos(Math.PI/18);let Yb=Math.sin(Math.PI/18);0>$a&&(Yb=-Yb);kb=
[c,hb];for(let qa=1;9>=qa;qa++)this._rotateDirect(Ca,Sc,Yb),kb.push(this._add(tc,Ca));b.push(kb);break;case w.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:const Zb=this._cp2(a,2,0),uc=this._mid(c,Zb),vc=this._sub(Zb,uc),Tc=Math.cos(Math.PI/18),Uc=Math.sin(Math.PI/18),wc=[c,Zb];for(let qa=1;18>=qa;qa++)this._rotateDirect(vc,Tc,Uc),wc.push(this._add(uc,vc));b.push(wc);break;case w.GeometricEffectControlMeasureLineRule.TripleParallelExtended:const ab=this._cp2(a,0,-2),$b=this._cp3(a,ab,1,-2),
bb=this._mid(c,ab),Oa=this._sub($b,ab);this._normalize(Oa);const xc=Math.abs(this._crossProduct(Oa,this._sub(bb,ab)))/2,lb=this._dist(ab,$b),yc=[ab,c];yc.push([c[0]+Oa[0]*lb*.5,c[1]+Oa[1]*lb*.5]);b.push(yc);const mb=[];mb.push([bb[0]-Oa[0]*xc,bb[1]-Oa[1]*xc]);mb.push([bb[0]+Oa[0]*lb*.375,bb[1]+Oa[1]*lb*.375]);E.setId(mb[mb.length-1],1);mb.push([bb[0]+Oa[0]*lb*.75,bb[1]+Oa[1]*lb*.75]);b.push(mb);b.push([ab,$b]);break;case w.GeometricEffectControlMeasureLineRule.ParallelWithTicks:const qb=this._cp2(a,
3,0),ac=this._cp3(a,qb,.5,-1),rb=this._sub(ac,qb);this._normalize(rb);const zc=this._crossProduct(rb,this._sub(ac,c));this._leftPerpendicular(rb);this._addAngledTicks(b,c,qb,ac);this._addAngledTicks(b,this._mix(c,1,rb,zc),this._mix(qb,1,rb,zc),this._mid(c,qb));break;case w.GeometricEffectControlMeasureLineRule.Parallel:const sb=this._cp2(a,3,0),Vc=this._cp3(a,sb,.5,-1),bc=this._sub(sb,c);this._normalize(bc);const Db=this._leftPerp(bc),Eb=this._crossProduct(bc,this._sub(Vc,c));let tb=[c,sb];b.push(tb);
tb=[];tb.push([c[0]+Db[0]*Eb,c[1]+Db[1]*Eb]);tb.push([sb[0]+Db[0]*Eb,sb[1]+Db[1]*Eb]);b.push(tb);break;case w.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:const cc=this._cp2(a,3,0),Wc=this._cp3(a,cc,.5,-1),Fb=this._mid(c,cc),cb=this._sub(cc,c);this._normalize(cb);const Gb=this._crossProduct(cb,this._sub(Wc,c));this._leftPerpendicular(cb);const dc=[];dc.push([Fb[0]-cb[0]*Gb*.25,Fb[1]-cb[1]*Gb*.25]);dc.push([Fb[0]+cb[0]*Gb*1.25,Fb[1]+cb[1]*Gb*1.25]);b.push(dc);break;case w.GeometricEffectControlMeasureLineRule.ParallelOffset:const nb=
this._cp2(a,3,0),Xc=this._cp3(a,nb,.5,-1),Ka=this._sub(nb,c);this._normalize(Ka);const Ra=this._crossProduct(Ka,this._sub(Xc,c));this._leftPerpendicular(Ka);const ec=[];ec.push([c[0]-Ka[0]*Ra,c[1]-Ka[1]*Ra]);ec.push([nb[0]-Ka[0]*Ra,nb[1]-Ka[1]*Ra]);b.push(ec);const fc=[];fc.push([c[0]+Ka[0]*Ra,c[1]+Ka[1]*Ra]);fc.push([nb[0]+Ka[0]*Ra,nb[1]+Ka[1]*Ra]);b.push(fc);break;case w.GeometricEffectControlMeasureLineRule.OffsetOpposite:const Hb=this._cp2(a,3,0),Yc=this._cp3(a,Hb,.5,-1),db=this._sub(Hb,c);this._normalize(db);
const Ib=this._crossProduct(db,this._sub(Yc,c));this._leftPerpendicular(db);const gc=[];gc.push([c[0]-db[0]*Ib,c[1]-db[1]*Ib]);gc.push([Hb[0]-db[0]*Ib,Hb[1]-db[1]*Ib]);b.push(gc);break;case w.GeometricEffectControlMeasureLineRule.OffsetSame:const Jb=this._cp2(a,3,0),Zc=this._cp3(a,Jb,.5,-1),eb=this._sub(Jb,c);this._normalize(eb);const Kb=this._crossProduct(eb,this._sub(Zc,c));this._leftPerpendicular(eb);const hc=[];hc.push([c[0]+eb[0]*Kb,c[1]+eb[1]*Kb]);hc.push([Jb[0]+eb[0]*Kb,Jb[1]+eb[1]*Kb]);b.push(hc);
break;case w.GeometricEffectControlMeasureLineRule.CircleWithArc:let Sa=this._cp2(a,3,0);const ic=this._cp3(a,Sa,.5,-1);let ob,Lb;if(4<=e)ob=a[3],Lb=0<this._crossProduct(this._sub(ob,Sa),this._sub(ic,Sa));else{ob=Sa;Lb=0<this._crossProduct(this._sub(ob,c),this._sub(ic,c));const qa=24*this._geomUnitsPerPoint,ya=this._sub(ob,c);this._normalize(ya,qa);const Ga=Math.sqrt(2)/2;this._rotateDirect(ya,Ga,Lb?Ga:-Ga);Sa=this._add(c,ya)}const Ac=this._sub(Sa,c),$c=Math.cos(Math.PI/18),ad=Math.sin(Math.PI/18),
ub=[Sa];for(let qa=1;36>=qa;qa++)this._rotateDirect(Ac,$c,ad),ub.push(this._add(c,Ac));this._add90DegArc(ub,Sa,ob,ic,Lb);E.setId(ub[ub.length-8],1);b.push(ub);break;case w.GeometricEffectControlMeasureLineRule.DoubleJog:let Ta=this._cp2(a,-3,1),Ua;Ua=3<=e?a[2]:this._add(c,this._sub(c,Ta));let Pa;if(4<=e)Pa=a[3];else{const qa=c;c=Ta;Pa=Ua;const ya=this._dist(c,qa),Ga=this._dist(Pa,qa);let Va=30*this._geomUnitsPerPoint;.5*ya<Va&&(Va=.5*ya);.5*Ga<Va&&(Va=.5*Ga);Ta=this._mix(c,Va/ya,qa,(ya-Va)/ya);Ua=
this._mix(Pa,Va/Ga,qa,(Ga-Va)/Ga)}const Bc=this._mid(c,Ta),Cc=this._mid(Pa,Ua),bd=this._dist(c,Ta),cd=this._dist(Ua,Pa);let Mb=Math.min(bd,cd)/8;Mb=Math.min(Mb,24*this._geomUnitsPerPoint);const Wa=Math.cos(Math.PI/4);let Ja=this._sub(c,Ta);this._normalize(Ja,Mb);0<this._crossProduct(Ja,this._sub(Pa,Ta))?this._rotateDirect(Ja,Wa,-Wa):this._rotateDirect(Ja,Wa,Wa);let La=[];La.push(Ta);La.push(this._add(Bc,Ja));La.push(this._sub(Bc,Ja));La.push(c);b.push(La);Ja=this._sub(Pa,Ua);this._normalize(Ja,Mb);
0>this._crossProduct(Ja,this._sub(c,Ua))?this._rotateDirect(Ja,Wa,Wa):this._rotateDirect(Ja,Wa,-Wa);La=[];La.push(Ua);La.push(this._add(Cc,Ja));La.push(this._sub(Cc,Ja));La.push(Pa);b.push(La);break;case w.GeometricEffectControlMeasureLineRule.PerpendicularOffset:const Nb=this._cp2(a,-4,1),Dc=this._cp3(a,Nb,.882353,-1.94),vb=this._sub(Dc,Nb);0<this._crossProduct(vb,this._sub(c,Nb))?this._rightPerpendicular(vb):this._leftPerpendicular(vb);const dd=[vb[0]/8,vb[1]/8],ed=this._sub(this._mid(Nb,Dc),dd);
b.push([ed,c]);break;case w.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:const Ec=this._arrowPath(a),Fc=[];let Gc=Ec.length-2;for(;Gc--;)Fc.push(Ec[Gc]);b.push(Fc);break;case w.GeometricEffectControlMeasureLineRule.MultivertexArrow:const fd=this._arrowPath(a),Hc=[];this._addArrow(Hc,fd,!1);b.push(Hc);break;case w.GeometricEffectControlMeasureLineRule.CrossedArrow:const gd=this._arrowPath(a),Ic=[];this._addArrow(Ic,gd,!0);b.push(Ic);break;case w.GeometricEffectControlMeasureLineRule.ChevronArrow:const [Jc,
wb]=this._arrowLastSeg(a),Ob=10*this._geomUnitsPerPoint,fb=this._sub(c,Jc);this._normalize(fb);const Kc=this._crossProduct(fb,this._sub(wb,Jc)),Lc=this._leftPerp(fb),Mc=[wb[0]-Lc[0]*Kc*2,wb[1]-Lc[1]*Kc*2],Pb=[];Pb.push([wb[0]+fb[0]*Ob,wb[1]+fb[1]*Ob]);Pb.push(c);Pb.push([Mc[0]+fb[0]*Ob,Mc[1]+fb[1]*Ob]);b.push(Pb);break;case w.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:const [Nc,jc]=this._arrowLastSeg(a),Qa=this._sub(c,Nc);this._normalize(Qa);const pb=this._crossProduct(Qa,this._sub(jc,
Nc));this._leftPerpendicular(Qa);const xb=[jc[0]-Qa[0]*pb,jc[1]-Qa[1]*pb],Qb=[];Qb.push([xb[0]+Qa[0]*pb*.5,xb[1]+Qa[1]*pb*.5]);Qb.push(this._mid(xb,c));Qb.push([xb[0]-Qa[0]*pb*.5,xb[1]-Qa[1]*pb*.5]);b.push(Qb);break;case w.GeometricEffectControlMeasureLineRule.PartialFirstSegment:const [kc,lc]=this._arrowLastSeg(a),yb=this._sub(c,kc);this._normalize(yb);const Oc=this._crossProduct(yb,this._sub(lc,kc));this._leftPerpendicular(yb);b.push([kc,[lc[0]-yb[0]*Oc,lc[1]-yb[1]*Oc]]);break;case w.GeometricEffectControlMeasureLineRule.Arch:const mc=
this._cp2(a,0,-1),Rb=this._cp3(a,mc,.5,1),Pc=this._sub(c,mc),hd=this._mix(Rb,1,Pc,.55),id=this._mix(Rb,1,Pc,-.55),nc=[c];this._addBezier2(nc,c,hd,Rb,4);this._addBezier2(nc,Rb,id,mc,4);b.push(nc);break;case w.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:const Xa=this._cp2(a,-4,1),zb=this._cp3(a,Xa,.882353,-1.94),gb=this._sub(zb,Xa);0<this._crossProduct(gb,this._sub(c,Xa))?this._rightPerpendicular(gb):this._leftPerpendicular(gb);const oc=[gb[0]/8,gb[1]/8],Qc=this._sub(this._mid(Xa,zb),
oc),jd=this._sub(this._mix(Xa,.75,zb,.25),oc),kd=this._sub(this._mix(Xa,.25,zb,.75),oc),Sb=[Xa];this._addBezier2(Sb,Xa,jd,Qc,3);this._addBezier2(Sb,Qc,kd,zb,3);b.push(Sb);for(let qa=0;8>qa;qa++){const ya=Sb[2*qa+1],Ga=[this._clone(ya)];Ga.push(this._add(ya,[gb[0]/4,gb[1]/4]));b.push(Ga)}break;case w.GeometricEffectControlMeasureLineRule.Arc90Degrees:const pc=this._cp2(a,0,-1),ld=this._cp3(a,pc,.5,1),Rc=[pc];this._add90DegArc(Rc,pc,c,ld);b.push(Rc);break;default:b.push(a)}}return b};return h._createClass(g)}();
l.EffectControlMeasureLine=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(l,h,D,E){let w=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(g,f,d,b,a){return new t(g,f,d)};return h._createClass(p)}();w.instance=null;let t=function(p){function g(d,b,a){d=
f.call(this,d,!0,!0);d._curveHelper=new E.CurveHelper;d._beginCut=(void 0!==b.beginCut?b.beginCut:1)*a;d._endCut=(void 0!==b.endCut?b.endCut:1)*a;d._middleCut=(void 0!==b.middleCut?b.middleCut:0)*a;d._invert=void 0!==b.invert?b.invert:!1;0>d._beginCut&&(d._beginCut=0);0>d._endCut&&(d._endCut=0);0>d._middleCut&&(d._middleCut=0);return d}h._inherits(g,p);var f=h._createSuper(g);g.prototype.processPath=function(d){var b=this._beginCut;const a=this._endCut,e=this._middleCut,c=this._curveHelper.calculatePathLength(d),
m=[];if(!this._invert)0===b&&0===a&&0===e?m.push(d):b+a+e>=c||(0===e?(d=this._curveHelper.getSubCurve(d,b,c-a))&&m.push(d):((b=this._curveHelper.getSubCurve(d,b,.5*(c-e)))&&m.push(b),(b=this._curveHelper.getSubCurve(d,.5*(c+e),c-a))&&m.push(b)));else if(0!==b||0!==a||0!==e)b+a+e>=c?m.push(d):((b=this._curveHelper.getSubCurve(d,0,b))&&m.push(b),(b=this._curveHelper.getSubCurve(d,.5*(c-e),.5*(c+e)))&&m.push(b),(b=this._curveHelper.getSubCurve(d,c-a,a))&&m.push(b));return 0===m.length?null:{paths:m}};
return h._createClass(g)}(D.PathGeometryCursor);l.EffectCut=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectDashes":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../CIMCursor ../CurveHelper ../enums ../GeometryWalker".split(" "),function(l,h,D,E,w,t){let p=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,b,a,e,c){return new g(d,b,a)};return h._createClass(f)}();
p.instance=null;let g=function(f){function d(a,e,c){a=b.call(this,a,!0,!0);a._firstCurve=null;a._walker=new t.GeometryWalker;a._walker.updateTolerance(c);a._endings=e.lineDashEnding;a._customDashPos=-(e.offsetAlongLine??0)*c;a._offsetAtEnd=(e.customEndingOffset??0)*c;a._pattern=new t.DashPattern;a._pattern.init(e.dashTemplate,!0);a._pattern.scale(c);return a}h._inherits(d,f);var b=h._createSuper(d);d.prototype.processPath=function(a){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[a]};
if(!this.iteratePath){var e=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case w.LineDashEnding.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case w.LineDashEnding.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case w.LineDashEnding.NoConstraint:this.isClosed||(e=!1);break;case w.LineDashEnding.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var c=this._walker.calculatePathLength(a);
if(this._pattern.isEmpty()||c<.1*this._pattern.length()||!this._walker.init(a,this._pattern,e))return{paths:[a]}}if(this.iteratePath)a=this._pattern.nextValue();else{switch(this._endings){default:e=.5*this._pattern.firstValue();break;case w.LineDashEnding.HalfGap:e=.5*-this._pattern.lastValue();break;case w.LineDashEnding.FullGap:e=-this._pattern.lastValue();break;case w.LineDashEnding.FullPattern:e=0;break;case w.LineDashEnding.NoConstraint:case w.LineDashEnding.Custom:e=-this._customDashPos}a=e/
this._pattern.length();a-=Math.floor(a);e=a*this._pattern.length();this._pattern.reset();a=this._pattern.nextValue();for(c=!1;e>=a;)e-=a,a=this._pattern.nextValue(),c=!c;a-=e;c?(this._walker.nextPosition(a),a=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(a),a=this._pattern.nextValue(),this._walker.nextPosition(a),a=this._pattern.nextValue())}(e=this._walker.nextCurve(a))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,
1),E.PathHelper.mergePath(e,this._firstCurve),this._firstCurve=null)):(a=this._pattern.nextValue(),!this._walker.nextPosition(a)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(e=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,e=this._firstCurve,this._firstCurve=null);return{paths:[e]}};return h._createClass(d)}(D.PathGeometryCursor);l.EffectDashes=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(l,h,D,E){let w=function(){function f(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var d=f.prototype;d.isEmpty=function(){return 0===this._values.length};d.size=function(){return this._values.length};d.init=function(b,a,e=!0){this._setEmpty();if(!b||0===b.length)return!1;for(let c=0;c<b.length;c++){let m=Math.abs(b[c]);e&&1E-7>m&&(m=1E-7);this._values.push(m);this._length+=m}a&&b.length&
1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};d.scale=function(b){const a=this._values?this._values.length:0;for(let e=0;e<a;++e)this._values[e]*=b;this._length*=b;this.extPtGap*=b;this.ctrlPtGap*=b};d.addValue=function(b){this._length+=b;this._values.push(b)};d.firstValue=function(){return this._values[0]};d.lastValue=function(){return this._values[this._values.length-1]};d.nextValue=function(){this._currentValue++;this._currentValue===
this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};d.reset=function(){this._currentValue=-1};d.length=function(){return this._length};d._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return h._createClass(f)}(),t=h._createClass(function(){this.pt=null;this.sa=this.ca=0});l.EndType=void 0;(function(f){f[f.FAIL=0]="FAIL";f[f.END=1]="END";f[f.CONTINUE=2]="CONTINUE"})(l.EndType||(l.EndType={}));let p=function(){function f(){this.reset()}
var d=f.prototype;d.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};d.isValid=function(){return-1!==this.segment};d.copyTo=function(b){b.segment=this.segment;b.segmentLength=this.segmentLength;b.abscissa=this.abscissa;b.isPathEnd=this.isPathEnd;b.isPartEnd=this.isPartEnd};return h._createClass(f)}(),g=function(f){function d(a=0,e=!1){a=b.call(this,a,e);a._tolerance=E.PIXEL_TOLERANCE;a._currentPosition=new p;return a}h._inherits(d,f);var b=h._createSuper(d);
f=d.prototype;f.updateTolerance=function(a){this._tolerance=E.PIXEL_TOLERANCE*a};f.init=function(a,e,c=!0){c?(this._patternLength=e.length(),this._partExtPtGap=e.extPtGap,this._partCtrlPtGap=e.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=a;this._seg=-1;return this._setPosAtNextPart()};f.curPositionIsValid=function(){return this._currentPosition.isValid()};f.nextPosition=function(a,e=l.EndType.FAIL){const c=new p;
if(!this._nextPosition(a,c,null,e))return!1;c.copyTo(this._currentPosition);return!0};f.curPointAndAngle=function(a){a.pt=this._getPoint(this._currentPosition);const [e,c]=this._getAngle(this._currentPosition);a.ca=e;a.sa=c};f.nextPointAndAngle=function(a,e,c=l.EndType.FAIL){const m=new p;if(!this._nextPosition(a,m,null,c))return!1;m.copyTo(this._currentPosition);e.pt=this._getPoint(m);const [k,n]=this._getAngle(m);e.ca=k;e.sa=n;return!0};f.nextCurve=function(a){if(0===a)return null;const e=[],c=
new p;if(!this._nextPosition(a,c,e,l.EndType.END))return null;c.copyTo(this._currentPosition);return e};f.isPathEnd=function(){return this._currentPosition.isPathEnd};f.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");return this._path[this._currentPosition.segment+1]};f._nextPosition=function(a,e,c,m){if(this._currentPosition.isPathEnd)return!1;var k=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(k/=this._currentPosition.segmentLength);
for(this._currentPosition.copyTo(e);e.abscissa+a*this._partLengthRatio>e.segmentLength+this._tolerance;)if(c&&(0===c.length&&(0===k?(k=this._path[e.segment],c.push([k[0],k[1]])):c.push(this.getSegCoord2D(this._path,e.segment,k))),k=this._path[e.segment+1],c.push([k[0],k[1]])),k=0,a-=(e.segmentLength-e.abscissa)/this._partLengthRatio,this._partSegCount)e.segment=this._nextSegment(),e.segmentLength=this.calculateSegLength(this._path,e.segment),e.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart()){if(m===
l.EndType.FAIL)return!1;e.segmentLength=this.calculateSegLength(this._path,e.segment);e.isPartEnd=!0;m===l.EndType.END?(e.abscissa=e.segmentLength,e.isPathEnd=!0):e.abscissa=e.segmentLength+a;return!0}this._currentPosition.copyTo(e)}e.abscissa+=a*this._partLengthRatio;c&&(0===c.length&&(0===k?(a=this._path[e.segment],c.push([a[0],a[1]])):c.push(this.getSegCoord2D(this._path,e.segment,k))),a=e.abscissa/e.segmentLength,1===a?(a=this._path[e.segment+1],c.push([a[0],a[1]])):c.push(this.getSegCoord2D(this._path,
e.segment,a)));!this._partSegCount&&Math.abs(e.abscissa-e.segmentLength)<this._tolerance&&(e.isPathEnd=this._partIsLast,e.isPartEnd=!0);return!0};f._getPoint=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};f._getAngle=function(a){if(-1===a.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,a.segment,0>=a.segmentLength?0:a.abscissa/a.segmentLength)};f._setPosAtNextPart=
function(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===D.getId(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}for(var a=this._partSegCount;a;)this._previousSegment(),--a;this._currentPosition.segment=
this._nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;a=this._getStartPointIndex();this._ctrlPtBegin=1===D.getId(this._path[a]);a=a+this._partSegCount+1;a>=this._path.length&&(a=0);this._ctrlPtEnd=1===D.getId(this._path[a]);if(0<this._patternLength){a=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const e=
this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let c=Math.round((this._partLength-(a+e))/this._patternLength);0>=c&&(c=0<a+e?0:1);this._partLengthRatio=this._partLength/(a+e+c*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0};f._hasNextSegment=function(){return this._seg<this._path.length-2};f._previousSegment=function(){return--this._seg};f._nextSegment=function(){return++this._seg};f._getStartPointIndex=function(){return this._seg};
f._getEndPointIndex=function(){return this._seg+1};return h._createClass(d)}(E.CurveHelper);l.DashPattern=w;l.GeometryWalker=g;l.Pos=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectDonut":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../enums ../../../geometry/SpatialReference".split(" "),function(l,h,D,E,w,t,p,g){D=function(){function d(){}
d.local=function(){null===d.instance&&(d.instance=new d);return d.instance};d.prototype.execute=function(b,a,e,c,m){return new f(b,a,e,c,m)};return h._createClass(d)}();D.instance=null;let f=function(){function d(b,a,e,c,m){this._inputGeometries=b;this._tileKey=c;this._geometryEngine=m;this._width=(void 0!==a.width?a.width:2)*e;this._option=a.option}d.prototype.next=function(){let b;for(;b=this._inputGeometries.next();){if(w.isExtent(b)&&0<this._width){if(0>Math.min(b.xmax-b.xmin,b.ymax-b.ymin)-2*
this._width)return b;var a=[];a.push([[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]);a.push([[b.xmin+this._width,b.ymin+this._width],[b.xmax-this._width,b.ymin+this._width],[b.xmax-this._width,b.ymax-this._width],[b.xmin+this._width,b.ymax-this._width],[b.xmin+this._width,b.ymin+this._width]]);return{rings:a}}if(w.isPolygon(b)){a=null;var e=this._geometryEngine;let c=b;if(this._tileKey&&(c=t.clipPolygonToTileExtent(b,Math.abs(this._width)+1),!c||!c.rings||0===c.rings.length))continue;
E.isSome(e)&&(a=e.buffer(g.WebMercator,c,-this._width,1));if(0<this._width){e=[];for(const m of b.rings)m&&e.push(m);if(a)for(const m of a.rings)m&&e.push(m.reverse());if(e.length)return{rings:e}}}}return null};return h._createClass(d)}();l.EffectDonut=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(l,h,D,E){let w=function(){function p(){}
p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(g,f,d,b,a){return new t(g,f,d)};return h._createClass(p)}();w.instance=null;let t=function(p){function g(d,b,a){d=f.call(this,d,!1,!0);d._curveHelper=new E.CurveHelper;d._length=(void 0!==b.length?b.length:20)*a;d._angle=void 0!==b.angle?b.angle:225;d._position=void 0!==b.position?b.position:50;0>d._length&&(d._length=-d._length);20>d._position&&(d._position=20);80<d._position&&(d._position=80);
d._mirror=!1;return d}h._inherits(g,p);var f=h._createSuper(g);g.prototype.processPath=function(d){if(this._curveHelper.isEmpty(d,!1))return null;const b=d[0];d=d[d.length-1];this._curveHelper.normalize([d[0]-b[0],d[1]-b[1]]);const a=[b[0]+(d[0]-b[0])*this._position/100,b[1]+(d[1]-b[1])*this._position/100],e=Math.cos((90-this._angle)/180*Math.PI);let c=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(c=-c);this._mirror=!this._mirror;return{paths:[[b,[a[0]-this._length/2*e,a[1]-this._length/2*
c],[a[0]+this._length/2*e,a[1]+this._length/2*c],d]]}};return h._createClass(g)}(D.PathGeometryCursor);l.EffectJog=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/lang","../../../geometry/support/jsonUtils"],function(l,h,D,E){let w=function(){function p(){}p.local=function(){null===p.instance&&(p.instance=new p);return p.instance};p.prototype.execute=function(g,
f,d,b,a){return new t(g,f,d)};return h._createClass(p)}();w.instance=null;let t=function(){function p(f,d,b){this._inputGeometries=f;this._offsetX=void 0!==d.offsetX?d.offsetX*b:0;this._offsetY=void 0!==d.offsetY?-d.offsetY*b:0}var g=p.prototype;g.next=function(){for(var f=this._inputGeometries.next();f;){if(E.isExtent(f))return{xmin:f.xmin+this._offsetX,xmax:f.xmax+this._offsetX,ymin:f.ymin+this._offsetY,ymax:f.ymax+this._offsetY};if(E.isPolygon(f))return f=D.clone(f),this._moveMultipath(f.rings,
this._offsetX,this._offsetY),f;if(E.isPolyline(f))return f=D.clone(f),this._moveMultipath(f.paths,this._offsetX,this._offsetY),f;if(E.isMultipoint(f))return f=D.clone(f),this._movePath(f.points,this._offsetX,this._offsetY),f;if(E.isPoint(f))return{x:f.x+this._offsetX,y:f.y+this._offsetY};f=this._inputGeometries.next()}return null};g._moveMultipath=function(f,d,b){if(f)for(const a of f)this._movePath(a,d,b)};g._movePath=function(f,d,b){if(f)for(const a of f)a[0]+=d,a[1]+=b};return h._createClass(p)}();
l.EffectMove=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectOffset":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry ../../../core/maybe ../../../geometry/support/jsonUtils ../CIMEffects ../CurveHelper ../enums ../../../geometry/SpatialReference".split(" "),function(l,h,D,E,w,t,p,g,f){D=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(a,
e,c,m,k){return new d(a,e,c,m,k)};return h._createClass(b)}();D.instance=null;let d=function(){function b(a,e,c,m,k){this._inputGeometries=a;this._tileKey=m;this._geometryEngine=k;this._curveHelper=new p.CurveHelper;this._offset=(e.offset??1)*c;this._method=e.method;this._option=e.option;this._offsetFlattenError=p.PIXEL_TOLERANCE*c}b.prototype.next=function(){for(var a;a=this._inputGeometries.next();){if(0===this._offset)return a;if(w.isExtent(a)){if(this._method===g.GeometricEffectOffsetMethod.Rounded&&
0<this._offset)return(a=this._curveHelper.offset([[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]],-this._offset,this._method,4,this._offsetFlattenError))?{rings:[a]}:null;if(0<Math.min(a.xmax-a.xmin,a.ymax-a.ymin)+2*this._offset)return{xmin:a.xmin-this._offset,xmax:a.xmax+this._offset,ymin:a.ymin-this._offset,ymax:a.ymax+this._offset}}const e=this._geometryEngine;if(E.isNone(e))break;let c=a;if(w.isPolygon(a)){if(this._tileKey&&(c=t.clipPolygonToTileExtent(a,Math.abs(this._offset)+
1),!c||!c.rings||0===c.rings.length))continue}else if(w.isPolyline(a)&&this._tileKey&&(c=t.clipPolylineToTileExtent(a,Math.abs(this._offset)+1),!c||!c.paths||0===c.paths.length))continue;return e.offset(f.WebMercator,c,-this._offset,1,this._method,4,this._offsetFlattenError)}return null};return h._createClass(b)}();l.EffectOffset=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(l,h,D,E,w){let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(f,d,b,a,e){return new p(f,d,b)};return h._createClass(g)}();t.instance=null;let p=function(){function g(f,d,b){this._inputGeometries=f;this._reverse=void 0!==d.reverse?d.reverse:!0}g.prototype.next=function(){for(var f=this._inputGeometries.next();f;){if(!this._reverse)return f;
if(E.isPolyline(f))return f=D.clone(f),w.reverseMultipath(f.paths),f;f=this._inputGeometries.next()}return null};return h._createClass(g)}();l.EffectReverse=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectRotate":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),function(l,h,D,E,w,t){let p=
function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,b,a,e,c){return new g(d,b,a)};return h._createClass(f)}();p.instance=null;let g=function(){function f(b,a,e){this._inputGeometries=b;this._rotateAngle=void 0!==a.angle?a.angle*Math.PI/180:0}var d=f.prototype;d.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._rotateAngle)return b;var a=E.create();w.getBoundsXY(a,b);const e=(a[2]+a[0])/2;a=(a[3]+
a[1])/2;if(t.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._rotateMultipath(b.rings,e,a),b;if(t.isPolygon(b))return b=D.clone(b),this._rotateMultipath(b.rings,e,a),b;if(t.isPolyline(b))return b=D.clone(b),this._rotateMultipath(b.paths,e,a),b;if(t.isMultipoint(b))return b=D.clone(b),this._rotatePath(b.points,e,a),b;if(t.isPoint(b))return b;b=this._inputGeometries.next()}return null};d._rotateMultipath=function(b,a,e){if(b)for(const c of b)this._rotatePath(c,
a,e)};d._rotatePath=function(b,a,e){if(b){const c=Math.cos(this._rotateAngle),m=Math.sin(this._rotateAngle);for(const k of b){b=k[0]-a;const n=k[1]-e;k[0]=a+b*c-n*m;k[1]=e+b*m+n*c}}};return h._createClass(f)}();l.EffectRotate=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectScale":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/lang ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils".split(" "),
function(l,h,D,E,w,t){let p=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,b,a,e,c){return new g(d,b,a)};return h._createClass(f)}();p.instance=null;let g=function(){function f(b,a,e){this._inputGeometries=b;this._xFactor=void 0!==a.xScaleFactor?a.xScaleFactor:1.15;this._yFactor=void 0!==a.yScaleFactor?a.yScaleFactor:1.15}var d=f.prototype;d.next=function(){for(var b=this._inputGeometries.next();b;){if(1===this._xFactor&&
1===this._yFactor)return b;var a=E.create();w.getBoundsXY(a,b);const e=(a[2]+a[0])/2;a=(a[3]+a[1])/2;if(t.isExtent(b))return b={rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]},this._scaleMultipath(b.rings,e,a),b;if(t.isPolygon(b))return b=D.clone(b),this._scaleMultipath(b.rings,e,a),b;if(t.isPolyline(b))return b=D.clone(b),this._scaleMultipath(b.paths,e,a),b;if(t.isMultipoint(b))return b=D.clone(b),this._scalePath(b.points,e,a),b;if(t.isPoint(b))return b;
b=this._inputGeometries.next()}return null};d._scaleMultipath=function(b,a,e){if(b)for(const c of b)this._scalePath(c,a,e)};d._scalePath=function(b,a,e){if(b)for(const c of b)b=(c[1]-e)*this._yFactor,c[0]=a+(c[0]-a)*this._xFactor,c[1]=e+b};return h._createClass(f)}();l.EffectScale=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/effects/EffectWave":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/jsonUtils ../CurveHelper ../enums ../GeometryWalker".split(" "),
function(l,h,D,E,w,t){let p=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,b,a,e,c){return new g(d,b,a)};return h._createClass(f)}();p.instance=null;let g=function(){function f(b,a,e){this._inputGeometries=b;this._height=(void 0!==a.amplitude?a.amplitude:2)*e;this._period=(void 0!==a.period?a.period:3)*e;this._style=a.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));
this._pattern=new t.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);this._walker=new t.GeometryWalker;this._walker.updateTolerance(e)}var d=f.prototype;d.next=function(){for(var b=this._inputGeometries.next();b;){if(0===this._height||0===this._period)return b;if(D.isPolyline(b)){const a=this._processGeom(b.paths);if(a.length)return{paths:a}}if(D.isPolygon(b)&&(b=this._processGeom(b.rings),b.length))return{rings:b};b=this._inputGeometries.next()}return null};d._processGeom=
function(b){const a=[];for(const e of b)if(this._walker.init(e,this._pattern))switch(this._style){default:a.push(this._constructCurve(e,!1));break;case w.GeometricEffectWaveform.Square:a.push(this._constructSquare(e));break;case w.GeometricEffectWaveform.Triangle:a.push(this._constructTriangle(e));break;case w.GeometricEffectWaveform.Random:a.push(this._constructCurve(e,!0))}else a.push(e);return a};d._constructCurve=function(b,a){const e=new E.PathHelper;var c=this._walker.calculatePathLength(b),
m=Math.round(c/this._period);0===m&&(m=1);const k=this._period/16,n=1/(16*m+1);c=2*Math.PI*c/(c/m);m=2*Math.PI*Math.random();const x=2*Math.PI*Math.random(),q=2*Math.PI*Math.random(),B=.75-Math.random()/2,y=.75-Math.random()/2,u=new t.Pos;this._walker.curPointAndAngle(u);e.startPath(u.pt);let v=0;for(;;)if(this._walker.nextPointAndAngle(k,u)){const r=v;v+=n;let z;if(a){const A=this._height/2*(1+.3*Math.sin(B*c*r+m));z=A*Math.sin(c*r+x);z+=A*Math.sin(y*c*r+q);z/=2}else z=.5*this._height*Math.sin(.5*
c*r);e.lineTo([u.pt[0]-z*u.sa,u.pt[1]+z*u.ca])}else{e.lineTo(b[b.length-1]);break}return e.path()};d._constructSquare=function(b){const a=new E.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const c=new t.Pos;this._walker.curPointAndAngle(c);const m=new t.Pos;if(this._walker.nextPointAndAngle(this._period,m)){const k=new t.Pos;this._walker.nextPointAndAngle(this._period,k)&&(b?(a.startPath(c.pt),b=!1):a.lineTo(c.pt),
a.lineTo([c.pt[0]-this._height/2*c.sa,c.pt[1]+this._height/2*c.ca]),a.lineTo([m.pt[0]-this._height/2*m.sa,m.pt[1]+this._height/2*m.ca]),a.lineTo([m.pt[0]+this._height/2*m.sa,m.pt[1]-this._height/2*m.ca]),a.lineTo([k.pt[0]+this._height/2*k.sa,k.pt[1]-this._height/2*k.ca]),e=!0)}}if(!e){a.lineTo(this._walker.getPathEnd());break}}return a.path()};d._constructTriangle=function(b){const a=new E.PathHelper;b=this._walker.calculatePathLength(b);Math.round(b/this._period);for(b=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const c=
new t.Pos;this._walker.curPointAndAngle(c);const m=new t.Pos;if(this._walker.nextPointAndAngle(this._period/2,m)){const k=new t.Pos;this._walker.nextPointAndAngle(this._period,k)&&(this._walker.nextPosition(this._period/2)&&(b?(a.startPath(c.pt),b=!1):a.lineTo(c.pt),a.lineTo([m.pt[0]-this._height/2*m.sa,m.pt[1]+this._height/2*m.ca]),a.lineTo([k.pt[0]+this._height/2*k.sa,k.pt[1]-this._height/2*k.ca])),e=!0)}}if(!e){a.lineTo(this._walker.getPathEnd());break}}return a.path()};return h._createClass(f)}();
l.EffectWave=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/geometryCursorCollectUtils ../CIMCursor ../enums ../GeometryWalker".split(" "),function(l,h,D,E,w,t){let p=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,b,a,e,c){return new g(d,b,a)};return h._createClass(f)}();
p.instance=null;let g=function(f){function d(a,e,c){a=b.call(this,a);a._geometryWalker=new t.GeometryWalker;a._geometryWalker.updateTolerance(c);a._angleToLine=e.angleToLine??!0;a._offset=(e.offset?e.offset:0)*c;a._originalEndings=e.endings;a._offsetAtEnd=(e.customEndingOffset?e.customEndingOffset:0)*c;a._position=-(e.offsetAlongLine?e.offsetAlongLine:0)*c;a._pattern=new t.DashPattern;a._pattern.init(e.placementTemplate,!1);a._pattern.scale(c);a._endings=a._originalEndings;return a}h._inherits(d,
f);var b=h._createSuper(d);f=d.prototype;f.processPath=function(a){if(this._pattern.isEmpty())return null;if(this.iteratePath)var e=this._pattern.nextValue();else{this._endings=this._originalEndings===w.PlacementEndings.WithFullGap&&this.isClosed?w.PlacementEndings.WithMarkers:this._originalEndings;this._pattern.extPtGap=0;var c=!0;switch(this._endings){case w.PlacementEndings.NoConstraint:e=-this._position;e=this._adjustPosition(e);c=!1;break;default:e=-this._pattern.lastValue()/2;break;case w.PlacementEndings.WithFullGap:e=
-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case w.PlacementEndings.WithMarkers:e=0;break;case w.PlacementEndings.Custom:e=-this._position,e=this._adjustPosition(e),this._pattern.extPtGap=.5*this._offsetAtEnd}a=D.collectRing(a);if(!this._geometryWalker.init(a,this._pattern,c))return null;this._pattern.reset();for(c=0;e>c;)e-=c,c=this._pattern.nextValue();e=c-e;this.iteratePath=!0}c=new t.Pos;if(!this._geometryWalker.nextPointAndAngle(e,c)||this._endings===w.PlacementEndings.WithFullGap&&
this._geometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===w.PlacementEndings.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(c.pt[0]-this._offset*c.sa,c.pt[1]+this._offset*c.ca);this._angleToLine&&this.internalPlacement.setRotateCS(c.ca,c.sa);return this.internalPlacement};f._adjustPosition=function(a){a/=this._pattern.length();a-=Math.floor(a);return a*this._pattern.length()};return h._createClass(d)}(E.PathTransformationCursor);
l.PlacementAlongLineSameSize=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(l,h,D,E,w){let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(f,d,b,a,e){return new p(f,d,b)};return h._createClass(g)}();t.instance=null;let p=
function(g){function f(b,a,e){b=d.call(this,b,!1,!0);b._curveHelper=new E.CurveHelper;b._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*e:0;b._type=a.extremityPlacement;b._position=void 0!==a.offsetAlongLine?a.offsetAlongLine*e:0;b._beginProcessed=!1;return b}h._inherits(f,g);var d=h._createSuper(f);g=f.prototype;g.processPath=function(b){let a;switch(this._type){default:this._beginProcessed?(a=this._atExtremities(b,this._position,!1),this.iteratePath=this._beginProcessed=
!1):(a=this._atExtremities(b,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case w.ExtremityPlacement.JustBegin:a=this._atExtremities(b,this._position,!0);break;case w.ExtremityPlacement.JustEnd:a=this._atExtremities(b,this._position,!1);case w.ExtremityPlacement.None:}return a};g._atExtremities=function(b,a,e){e||b.seekPathEnd();if(e?b.nextPoint():b.prevPoint()){let m=0;var c=[0,0];const k=[b.x,b.y];for(;e?b.nextPoint():b.prevPoint();){c[0]=k[0];c[1]=k[1];k[0]=b.x;k[1]=b.y;const n=
this._curveHelper.calculateLength(c,k);if(m+n>a){b=(a-m)/n;const [x,q]=this._curveHelper.getAngleCS(c,k,b);c=D.getCoord2D(c,k,b);this.internalPlacement.setTranslate(c[0]-this._offset*q,c[1]+this._offset*x);this._angleToLine&&this.internalPlacement.setRotateCS(-x,-q);return this.internalPlacement}m+=n}}return null};return h._createClass(f)}(D.PathTransformationCursor);l.PlacementAtExtremities=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../../../geometry/geometryCursorCollectUtils","../CIMCursor","../GeometryWalker"],function(l,h,D,E,w){let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(f,d,b,a,e){return new p(f,d,b)};return h._createClass(g)}();t.instance=null;let p=function(g){function f(b,a,e){b=d.call(this,b);b._walker=new w.GeometryWalker;b._walker.updateTolerance(e);b._angleToLine=void 0!==a.angleToLine?
a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*e:0;b._beginGap=void 0!==a.beginPosition?a.beginPosition*e:0;b._endGap=void 0!==a.endPosition?a.endPosition*e:0;b._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;b._pattern=new w.DashPattern;b._pattern.init(a.positionArray,!1,!1);b._subPathLen=0;b._posCount=b._pattern.size();b._isFirst=!0;b._prevPos=0;return b}h._inherits(f,g);var d=h._createSuper(f);f.prototype.processPath=function(b){if(this._pattern.isEmpty())return null;if(this.iteratePath){b=
this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+b;b=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0;b=D.collectRing(b);this._subPathLen=this._walker.calculatePathLength(b)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(b,this._pattern,!1))return null;this._pattern.reset();b=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+b;b=a-this._prevPos;this._prevPos=a;
this.iteratePath=!0}a=new w.Pos;if(!this._walker.nextPointAndAngle(b,a,w.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*a.ca);b=this._isFirst&&this._flipFirst;let e;this._angleToLine?(e=a.ca,a=a.sa):(e=1,a=0);b&&(e=-e,a=-a);this.internalPlacement.setRotateCS(e,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return h._createClass(f)}(E.PathTransformationCursor);
l.PlacementAtRatioPositions=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/RandomLCG ../CIMPlacements ../enums".split(" "),function(l,h,D,E,w,t){let p=function(){function f(){}f.local=function(){null===f.instance&&(f.instance=new f);return f.instance};f.prototype.execute=function(d,b,a,e,c){return new g(d,b,a,e,c)};return h._createClass(f)}();
p.instance=null;let g=function(){function f(b,a,e,c,m){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._accelerationMap=null;this._testInsidePolygon=!1;this._verticalSubdivision=!0;this._stepX=Math.abs(a.stepX??16)*e;this._stepY=Math.abs(a.stepY??16)*e;if(0!==this._stepX&&0!==this._stepY){this._gridType=a.gridType??t.PlacementGridType.Fixed;if(this._gridType===t.PlacementGridType.Random)this._randomLCG=new E(1*(a.seed??13)),this._randomness=(a.randomness??100)/100,
this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0,this._buildRandomValues();else{this._randomness=0;this._gridAngle=a.gridAngle??0;this._shiftOddRows=a.shiftOddRows??!1;this._offsetX=(a.offsetX??0)*e;this._offsetY=(a.offsetY??0)*e;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=
.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;if(null!=c){const [,k,n]=c.split("/");a=parseFloat(k);this._graphicOriginX=512*-parseFloat(n);this._graphicOriginY=512*a;this._testInsidePolygon=!0}this._internalPlacement=new w.Placement;this._calculateMinMax(b);this._geometryCursor=b}}var d=f.prototype;
d.next=function(){return this._geometryCursor?this._nextInside():null};d._buildRandomValues=function(){if(!f._randValues){f._randValues=[];for(let b=0;24>b;b++)for(let a=0;24>a;a++)f._randValues.push(this._randomLCG.getFloat()),f._randValues.push(this._randomLCG.getFloat())}};d._calculateMinMax=function(b){this._yMax=this._yMin=this._xMax=this._xMin=0;let a,e,c,m,k,n,x,q;a=e=x=k=Number.MAX_VALUE;c=m=q=n=-Number.MAX_VALUE;var B=1!==this._cosAngle;for(b.reset();b.nextPath();)for(;b.nextPoint();){var y=
b.x;var u=b.y;var v=y-this._graphicOriginX-this._offsetX;var r=u-this._graphicOriginY-this._offsetY;if(B){var z=this._cosAngle*v-this._sinAngle*r;v=this._sinAngle*v+this._cosAngle*r}else z=v,v=r;a=Math.min(a,z);c=Math.max(c,z);e=Math.min(e,v);m=Math.max(m,v);k=Math.min(k,u);n=Math.max(n,u);x=Math.min(x,y);q=Math.max(q,y)}k=k!==Number.MAX_VALUE?k:-512-this._stepY;n=n!==-Number.MAX_VALUE?n:this._stepY;x=x!==Number.MAX_VALUE?x:-this._stepX;q=q!==-Number.MAX_VALUE?q:512+this._stepX;this._polygonMin=(this._verticalSubdivision=
n-k>=q-x)?k:x;if(this._testInsidePolygon){z=0-this._graphicOriginX-this._offsetX-this._stepX;u=512-this._graphicOriginX-this._offsetX+this._stepX;y=-512-this._graphicOriginY-this._offsetY-this._stepY;v=0-this._graphicOriginY-this._offsetY+this._stepY;if(B){B=[[z,y],[z,v],[u,y],[u,v]];z=y=Number.MAX_VALUE;u=v=-Number.MAX_VALUE;for(const A of B)B=this._cosAngle*A[0]-this._sinAngle*A[1],r=this._sinAngle*A[0]+this._cosAngle*A[1],z=Math.min(z,B),u=Math.max(u,B),y=Math.min(y,r),v=Math.max(v,r)}a=a!==Number.MAX_VALUE?
Math.max(a,z):z;e=e!==Number.MAX_VALUE?Math.max(e,y):y;c=c!==-Number.MAX_VALUE?Math.min(c,u):u;m=m!==-Number.MAX_VALUE?Math.min(m,v):v}this._xMin=Math.round(a/this._stepX);this._xMax=Math.round(c/this._stepX);this._yMin=Math.round(e/this._stepY);this._yMax=Math.round(m/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1;this._buildAccelerationMap(b,x,q,k,n)};d._buildAccelerationMap=function(b,a,e,c,m){b.reset();const k=new Map,n=this._verticalSubdivision;e=n?m-c:e-a;m=Math.ceil(e/
10);if(!(1>=m)){e=Math.floor(e/m);m++;this._delta=e;var x,q;if(n){m=-512-this._stepY;var B=this._stepY;var y=c}else m=-this._stepX,B=512+this._stepX,y=a;for(;b.nextPath();)if(!(2>b.numPoints)&&b.nextPoint()){var u=b.x;for(x=b.y;b.nextPoint();u=a,x=c){a=b.x;c=b.y;if(n){if(x===c||x<m&&c<m||x>B&&c>B)continue;var v=Math.min(x,c);var r=Math.max(x,c)}else{if(u===a||u<m&&a<m||u>B&&a>B)continue;v=Math.min(u,a);r=Math.max(u,a)}for(;v<r;){var z=q=Math.floor((v-y)/e),A=u,C=x,F=a,G=c,H=k;let K=H.get(z);K||(K=
[],H.set(z,K));K.push([[A,C],[F,G]]);v+=e}v=Math.floor((r-y)/e);v>q&&(r=a,z=c,A=k,C=A.get(v),C||(C=[],A.set(v,C)),C.push([[u,x],[r,z]]))}}this._accelerationMap=k}};d._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var b=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(b+=.5*this._stepX);const a=this._currentY*this._stepY+
this._offsetY;this._currentX++;let e;if(this._gridType===t.PlacementGridType.Random){const c=(this._currentX%24+24)%24,m=(this._currentY%24+24)%24;e=this._graphicOriginX+b+this._stepX*this._randomness*(.5-f._randValues[24*m+c])*2/3;b=this._graphicOriginY+a+this._stepY*this._randomness*(.5-f._randValues[24*m+c+1])*2/3}else e=this._graphicOriginX+this._cosAngle*b+this._sinAngle*a,b=this._graphicOriginY-this._sinAngle*b+this._cosAngle*a;if(!this._testInsidePolygon||this._isInsidePolygon(e,b,this._geometryCursor))return this._internalPlacement.setTranslate(e,
b),this._internalPlacement}};d._isInsidePolygon=function(b,a,e){if(D.isNone(this._accelerationMap)){var c=0,m;let x;for(e.reset();e.nextPath();)if(e.nextPoint()){var k=e.x;for(m=e.y;e.nextPoint();k=n,m=x){var n=e.x;x=e.y;m>a!==x>a&&(0<(n-k)*(a-m)-(x-m)*(b-k)?c++:c--)}}return 0!==c}e=this._verticalSubdivision;m=this._accelerationMap.get(Math.floor(((e?a:b)-this._polygonMin)/this._delta));if(!m)return!1;k=0;for(c of m){m=c[0];n=c[1];if(e){if(m[1]>a===n[1]>a)continue;m=(n[0]-m[0])*(a-m[1])-(n[1]-m[1])*
(b-m[0])}else{if(m[0]>b===n[0]>b)continue;m=(n[1]-m[1])*(b-m[0])-(n[0]-m[0])*(a-m[1])}0<m?k++:k--}return 0!==k};return h._createClass(f)}();l.PlacementInsidePolygon=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../enums"],function(l,h,D,E,w){let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);
return g.instance};g.prototype.execute=function(f,d,b,a,e){return new p(f,d,b)};return h._createClass(g)}();t.instance=null;let p=function(g){function f(b,a,e){b=d.call(this,b);b._curveHelper=new E.CurveHelper;b._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*e:0;b._relativeTo=a.relativeTo;b._position=void 0!==a.startPointOffset?a.startPointOffset*e:0;b._epsilon=.001*e;return b}h._inherits(f,g);var d=h._createSuper(f);g=f.prototype;g.processPath=function(b){var a=
this._position;if(this._relativeTo===w.PlacementOnLineRelativeTo.SegmentMidpoint){this.iteratePath||(this.iteratePath=!0);if(b.nextPoint()){a=[b.x,b.y];const e=[0,0];for(;b.nextPoint();){e[0]=b.x;e[1]=b.y;const c=this._curveHelper.calculateLength(a,e);if(c<this._epsilon){a[0]=e[0];a[1]=e[1];continue}b=.5+this._position/c;const [m,k]=this._curveHelper.getAngleCS(a,e,b);b=D.getCoord2D(a,e,b);this.internalPlacement.setTranslate(b[0]-this._offset*k,b[1]+this._offset*m);this._angleToLine&&this.internalPlacement.setRotateCS(m,
k);return this.internalPlacement}}this.iteratePath=!1;return null}return this.onLine(b,a,this._relativeTo===w.PlacementOnLineRelativeTo.LineEnd)};g.onLine=function(b,a,e){let c,m=!1;switch(this._relativeTo){default:b.seekPathFront();c=b.pathLength()/2+a;break;case w.PlacementOnLineRelativeTo.LineBeginning:c=a;break;case w.PlacementOnLineRelativeTo.LineEnd:c=a,m=!0}e?b.seekPathEnd():b.seekPathFront();let k=0;if(e?b.prevPoint():b.nextPoint()){a=[b.x,b.y];const n=[0,0];for(;e?b.prevPoint():b.nextPoint();){n[0]=
b.x;n[1]=b.y;const x=this._curveHelper.calculateLength(a,n);if(k+x>c){b=(c-k)/x;const [q,B]=this._curveHelper.getAngleCS(a,n,b);b=D.getCoord2D(a,n,b);e=m?-this._offset:this._offset;this.internalPlacement.setTranslate(b[0]-e*B,b[1]+e*q);this._angleToLine&&(m?this.internalPlacement.setRotateCS(-q,-B):this.internalPlacement.setRotateCS(q,B));return this.internalPlacement}a[0]=n[0];a[1]=n[1];k+=x}}return null};return h._createClass(f)}(D.PathTransformationCursor);l.PlacementOnLine=t;Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(l,h,D,E){function w(g,f){const d=Math.PI;for(;Math.abs(f-g)>d+2E-15;)f=f-g>d?f-2*d:f+2*d;return(g+f)/2}let t=function(){function g(){}g.local=function(){null===g.instance&&(g.instance=new g);return g.instance};g.prototype.execute=function(f,d,b,a,e){return new p(f,d,b)};return h._createClass(g)}();
t.instance=null;let p=function(g){function f(b,a,e){b=d.call(this,b);b._curveHelper=new E.CurveHelper;b._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;b._offset=void 0!==a.offset?a.offset*e:0;b._endPoints=void 0!==a.placeOnEndPoints?a.placeOnEndPoints:!0;b._controlPoints=void 0!==a.placeOnControlPoints?a.placeOnControlPoints:!0;b._regularVertices=void 0!==a.placeOnRegularVertices?a.placeOnRegularVertices:!0;b._tags=[];b._tagIterator=0;return b}h._inherits(f,g);var d=h._createSuper(f);g=f.prototype;
g.processPath=function(b){this.iteratePath||(this._preparePath(b),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;b=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(b[2]);let a=b[0],e=b[1];if(0!==this._offset){const c=Math.cos(b[2]);a-=this._offset*Math.sin(b[2]);e+=this._offset*c}this.internalPlacement.setTranslate(a,e);this._tagIterator++;return this.internalPlacement};g._preparePath=
function(b){this._tagIterator=this._tags.length=0;b.seekPathFront();if(b.nextPoint()){var a=b.x;var e=b.y;b.seekPathEnd();if(b.prevPoint()){var c=b.y;a=a===b.x&&e===c}else a=!1}else a=!1;let m=c=e=0,k=0;b.seekPathFront();if(b.nextPoint()){var n=b.x;let q=b.y,B=b.id,y=!0;for(var x=b.nextPoint();x;){const u=b.x,v=b.y,r=b.id;x=[n,q];n=[u,v];if(this._angleToLine||0!==this._offset)m=this._curveHelper.getAngle(x,n,0);y?(y=!1,a?(e=m,c=B):(this._endPoints||this._controlPoints&&1===B)&&this._tags.push([x[0],
x[1],m])):1===B?this._controlPoints&&this._tags.push([x[0],x[1],w(k,m)]):this._regularVertices&&this._tags.push([x[0],x[1],w(k,m)]);if(this._angleToLine||0!==this._offset)k=this._curveHelper.getAngle(x,n,1);(x=b.nextPoint())||(a?1===r||1===c?this._controlPoints&&this._tags.push([n[0],n[1],w(k,e)]):this._regularVertices&&this._tags.push([n[0],n[1],w(k,e)]):(this._endPoints||this._controlPoints&&1===r)&&this._tags.push([n[0],n[1],k]));n=u;q=v;B=r}}this._tagIterator=0};return h._createClass(f)}(D.PathTransformationCursor);
l.PlacementOnVertices=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/has ../../../geometry/support/boundsUtils ../../../geometry/support/centroid ../../../geometry/support/labelPoint ../CIMPlacements ../enums".split(" "),function(l,h,D,E,w,t,p,g){let f=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};
b.prototype.execute=function(a,e,c,m,k){return new d(a,e,c)};return h._createClass(b)}();f.instance=null;let d=function(){function b(e,c,m){this._geometryCursor=e;this._offsetX=void 0!==c.offsetX?c.offsetX*m:0;this._offsetY=void 0!==c.offsetY?c.offsetY*m:0;this._method=void 0!==c.method?c.method:g.PlacementPolygonCenterMethod.OnPolygon;this._internalPlacement=new p.Placement}var a=b.prototype;a.next=function(){const e=this._geometryCursor;this._geometryCursor=null;return e?this._polygonCenter(e):
null};a._polygonCenter=function(e){let c=!1;switch(this._method){case g.PlacementPolygonCenterMethod.CenterOfMass:if(e=w.weightedAreaCentroid(e))this._internalPlacement.setTranslate(e[0]+this._offsetX,e[1]+this._offsetY),c=!0;break;case g.PlacementPolygonCenterMethod.BoundingBoxCenter:if(e=E.getBoundsXYCursor(e))this._internalPlacement.setTranslate((e[2]+e[0])/2+this._offsetX,(e[3]+e[1])/2+this._offsetY),c=!0;break;default:e=D("polylabel-placement-enabled")?t.getPolylabelPoint(e):t.labelPointAdapter(e),
null!==e&&(this._internalPlacement.setTranslate(e[0]+this._offsetX,e[1]+this._offsetY),c=!0)}return c?this._internalPlacement:null};return h._createClass(b)}();l.PlacementPolygonCenter=f;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/labelPoint":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/PriorityQueue ../geometryCursorCollectUtils ./aaBoundingRect ./boundsUtils ./centroid ./coordsUtils ./intersectsBase".split(" "),
function(l,h,D,E,w,t,p,g,f,d){function b(q){var {rings:B}=q;if(!B||0===B.length)return null;var y=p.getBoundsXY(t.create(),q);if(!y)return null;var u=8.8818E-14*(Math.abs(y[0])+Math.abs(y[2])+Math.abs(y[1])+Math.abs(y[3])+1),v=0,r=0;for(var z=0;z<B.length;z++){var A=f.getRingArea(B[z]);A>r&&(r=A,v=z)}if(Math.abs(r)<=2*u*u)return r=p.getPointsBounds(t.create(),B[v]),[(r[0]+r[2])/2,(r[1]+r[3])/2];var C=g.ringCentroid(B[v],!1,t.create());if(null===C)return null;if(1===B.length&&4>B[0].length)return C;
r=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]];z=[NaN,NaN,NaN,NaN];A=[NaN,NaN,NaN,NaN];var F=!1,G=e(C,q,!0);0===G.distance&&(F=!0,r[0][0]=C[0],r[0][1]=C[1],G=e(C,q,!1));z[0]=G.distance;A[0]=0;var H=[NaN,NaN],K=!1;let J=.25,N=-1;B=p.getPointsBounds(t.create(),B[v]);v=NaN;do if(v=NaN,G=B[0],r[1]=c(q,G+(B[2]-G)*J,u,y),isNaN(r[1][0])||isNaN(r[1][1])||(G=e(r[1],q,!1),v=G.distance),!isNaN(v)&&v>u&&a(r[1],q))K=!0,z[1]=v,A[1]=k(r[1],C);else if(!isNaN(v)&&v>N&&(N=v,H[0]=r[1][0],H[1]=r[1][1]),J-=.01,.1>J)if(0<=
N)K=!0,z[1]=N,r[1][0]=H[0],r[1][1]=H[1],A[1]=k(r[1],C);else break;while(!K);K=!1;J=.5;N=-1;let P=.01,W=1;do if(v=NaN,G=B[0],r[2]=c(q,G+(B[2]-G)*J,u,y),isNaN(r[2][0])||isNaN(r[2][1])||(G=e(r[2],q,!1),v=G.distance),!isNaN(v)&&v>u&&a(r[2],q))K=!0,z[2]=v,A[2]=k(r[2],C);else if(!isNaN(v)&&v>N)N=v,H[0]=r[2][0],H[1]=r[2][1];else if(v>N&&(N=v,H[0]=r[2][0],H[1]=r[2][1]),J=.5+P*W,P+=.01,W*=-1,.3>J||.7<J)if(0<=N)K=!0,z[2]=N,r[2][0]=H[0],r[2][1]=H[1],A[2]=k(r[2],C);else break;while(!K);K=!1;J=.75;N=-1;do if(v=
NaN,G=B[0],r[3]=c(q,G+(B[2]-G)*J,u,y),isNaN(r[3][0])||isNaN(r[3][1])||(G=e(r[3],q,!1),v=G.distance),!isNaN(v)&&v>u&&a(r[3],q))K=!0,z[3]=v,A[3]=k(r[3],C);else if(v>N&&(N=v,H[0]=r[3][0],H[1]=r[3][1]),J+=.01,.9<J)if(0<=N)K=!0,z[3]=N,r[3][0]=H[0],r[3][1]=H[1],A[3]=k(r[3],C);else break;while(!K);q=[0,1,2,3];y=F?0:1;for(F=y;4>F;F++)for(C=y;3>C;C++)H=A[C],K=A[C+1],0<n(H,K)&&(u=q[C],q[C]=q[C+1],q[C+1]=u,A[C]=K,A[C+1]=H);A=y;for(F=u=0;4>y;y++){switch(y){case 0:F=2*z[q[y]];break;case 1:F=1.66666666*z[q[y]];
break;case 2:F=1.33333333*z[q[y]];break;case 3:F=z[q[y]]}F>u&&(u=F,A=q[y])}return r[A]}function a(q,B){var {rings:y}=B;B=0;for(const u of y){y=u.length;for(let v=1;v<y;++v){const r=u[v-1],z=u[v];r[1]>q[1]!==z[1]>q[1]&&(0<(z[0]-r[0])*(q[1]-r[1])-(z[1]-r[1])*(q[0]-r[0])?B++:B--)}}return 0!==B}function e(q,B,y){if(y&&a(q,B))return{coord:q,distance:0};y=Infinity;let u=0,v=0;const r=[0,0];({rings:B}=B);for(const z of B)if(!(2>z.length))for(B=0;B<z.length-1;B++){f.projectPointOnLine(r,q,z,B);const A=k(q,
r);A<y&&(y=A,u=r[0],v=r[1])}return{coord:[u,v],distance:Math.sqrt(y)}}function c(q,B,y,u){y=[B,0];let v=Infinity,r=Infinity,z=!1,A=!1;B=[[B,u[1]-1],[B,u[3]+1]];u=[0,0];const C=[0,0],F=[0,0],G=[[0,0],[0,0]],H=t.create();({rings:q}=q);for(const P of q)if(!(2>P.length))for(q=1;q<P.length;q++){G[0][0]=P[q-1][0];G[0][1]=P[q-1][1];G[1][0]=P[q][0];G[1][1]=P[q][1];a:{var K=H;var J=G;if(2>J.length){K=null;break a}K||(K=t.create());const [W,X]=J[0],[aa,Z]=J[1];K[0]=Math.min(W,aa);K[1]=Math.min(X,Z);K[2]=Math.max(W,
aa);K[3]=Math.max(X,Z)}if(null!==K){C[0]=B[0][0];C[1]=B[0][1];F[0]=B[1][0];F[1]=B[1][1];a:{K=H;J=C;var N=F;let W=m(J,K),X=m(N,K);const aa=K[0],Z=K[1],ea=K[2],T=K[3];if(W&X){K=0;break a}if(!(W|X)){K=4;break a}const I=(W?1:0)|(X?2:0);do{const M=N[0]-J[0],S=N[1]-J[1];if(M>S)W&3?(W&1?(J[1]+=S*(aa-J[0])/M,J[0]=aa):(J[1]+=S*(ea-J[0])/M,J[0]=ea),W=m(J,K)):X&3?(X&1?(N[1]+=S*(aa-N[0])/M,N[0]=aa):(N[1]+=S*(ea-N[0])/M,N[0]=ea),X=m(N,K)):W?(W&4?(J[0]+=M*(Z-J[1])/S,J[1]=Z):(J[0]+=M*(T-J[1])/S,J[1]=T),W=m(J,K)):
(X&4?(N[0]+=M*(Z-N[1])/S,N[1]=Z):(N[0]+=M*(T-N[1])/S,N[1]=T),X=m(N,K));else if(W&12?(W&4?(J[0]+=M*(Z-J[1])/S,J[1]=Z):(J[0]+=M*(T-J[1])/S,J[1]=T),W=m(J,K)):X&12?(X&4?(N[0]+=M*(Z-N[1])/S,N[1]=Z):(N[0]+=M*(T-N[1])/S,N[1]=T),X=m(N,K)):W?(W&1?(J[1]+=S*(aa-J[0])/M,J[0]=aa):(J[1]+=S*(ea-J[0])/M,J[0]=ea),W=m(J,K)):(X&1?(N[1]+=S*(aa-N[0])/M,N[0]=aa):(N[1]+=S*(ea-N[0])/M,N[0]=ea),X=m(N,K)),W&X){K=0;break a}}while(W|X);K=I}0!==K&&d.segmentIntersects(B[0],B[1],G[0],G[1],u)&&(K=u[1],v>r?K<v&&(v=K,z=!0):K<r&&(r=
K,A=!0))}}z&&A?y[1]=(v+r)/2:y[0]=y[1]=NaN;return y}function m(q,B){return(q[0]<B[0]?1:0)|(q[0]>B[2]?1:0)<<1|(q[1]<B[1]?1:0)<<2|(q[1]>B[3]?1:0)<<3}function k(q,B){return(q[0]-B[0])*(q[0]-B[0])+(q[1]-B[1])*(q[1]-B[1])}function n(q,B){if(q<B)return-1;if(q>B)return 1;if(q===B)return 0;q=isNaN(q);B=isNaN(B);return q<B?-1:q>B?1:0}let x=h._createClass(function(q,B,y,u){this.x=q;this.y=B;this.cellSize=y;this.distancefromCellCenter=f.distanceFromPointToPolygon(q,B,u);this.maxDistanceToPolygon=this.distancefromCellCenter+
this.cellSize*Math.SQRT2});l.getLabelPoint=b;l.getPolylabelPoint=function(q){if(!q.nextPath()||!q.numPoints)return null;var B=p.currPathBounds(q),y=B[2]-B[0],u=B[3]-B[1];if(0===y||0===u)return[B[0]+y/2,B[1]+u/2];const v=Math.max(Math.min(y,u)/100,1),r=new E((C,F)=>F.maxDistanceToPolygon-C.maxDistanceToPolygon);u=Math.min(y,u);y=u/2;let z=0,A=0;for(z=B[0];z<B[2];z+=u)for(A=B[1];A<B[3];A+=u)r.enqueue(new x(z+y,A+y,y,q));B=g.ringsCentroidCursor(q);if(null===B)return null;for(B=new x(B[0],B[1],0,q);0<
r.size;)u=D.unwrap(r.dequeue()),u.distancefromCellCenter>B.distancefromCellCenter&&(B=u),u.maxDistanceToPolygon-B.distancefromCellCenter<=v||(y=u.cellSize/2,r.enqueue(new x(u.x-y,u.y-y,y,q)),r.enqueue(new x(u.x+y,u.y-y,y,q)),r.enqueue(new x(u.x-y,u.y+y,y,q)),r.enqueue(new x(u.x+y,u.y+y,y,q)));return[B.x,B.y]};l.labelPointAdapter=function(q){q={rings:w.collectRings(q)};return b(q)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/core/PriorityQueue":function(){define(["../chunks/_rollupPluginBabelHelpers"],
function(l){const h=(D,E)=>D<E?-1:D>E?1:0;return function(){function D(w=h){this._data=[];this._compare=w}var E=D.prototype;E.enqueue=function(w){if(null!=w){var {_data:t,_compare:p}=this;t.push(w);w=t.length-1>>>0;for(var g=t[w];0<w;){const f=w-1>>1,d=t[f];if(0>=p(d,g))t[f]=g,t[w]=d,w=f;else break}}};E.dequeue=function(){const {_data:w,_compare:t}=this,p=w[0];var g=w.pop();if(0===w.length)return p;w[0]=g;g=0;const f=w.length,d=w[0];let b;let a=null;for(;;){var e=2*g+1;const c=2*g+2;a=null;e<f&&(b=
w[e],0<t(b,d)&&(a=e));c<f&&(e=w[c],null===a&&0>=t(e,d)||null!==a&&0>=t(e,b))&&(a=c);if(null===a)break;w[g]=w[a];w[a]=d;g=a}return p};l._createClass(D,[{key:"size",get:function(){return this._data.length}}]);return D}()})},"esri/symbols/cim/imageUtils":function(){define(["exports"],function(l){l.getFirstFrame=function(h){const D=h.getFrame(0);if(D instanceof HTMLImageElement||D instanceof HTMLCanvasElement)return D;const E=document.createElement("canvas");E.width=h.width;E.height=h.height;h=E.getContext("2d");
D instanceof ImageData?h.putImageData(D,0,0):h.drawImage(D,0,0);return E};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function h(D=0,E=0,w=0,t=0){this.x=D;this.y=E;this.width=w;this.height=t}h.prototype.union=function(D){this.x=Math.min(this.x,D.x);this.y=Math.min(this.y,D.y);this.width=Math.max(this.width,D.width);this.height=Math.max(this.height,D.height)};l._createClass(h,
[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return h}()})},"esri/symbols/cim/TextRasterizer":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/screenUtils"],function(l,h){return function(){function D(w){w&&(this._textRasterizationCanvas=w)}var E=D.prototype;E.rasterizeText=function(w,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const p=this._textRasterizationCanvas;var g=p.getContext("2d");this._setFontProperties(g,
t);this._parameters=t;this._textLines=w.split(/\r?\n/);this._lineHeight=this._computeLineHeight();w=this._computeTextWidth(g,t);const {decoration:f,weight:d}=t.font;this._lineThroughWidthOffset=f&&"line-through"===f?.1*this._lineHeight:0;var b=this._lineHeight*this._textLines.length;p.width=w+2*this._lineThroughWidthOffset;p.height=b;this._renderedLineHeight=Math.round(this._lineHeight*t.pixelRatio);this._renderedHaloSize=t.halo.size*t.pixelRatio;this._renderedWidth=w*t.pixelRatio;this._renderedHeight=
b*t.pixelRatio;this._lineThroughWidthOffset*=t.pixelRatio;w=t.halo&&t.halo.color?t.halo.color:[0,0,0,0];b=t.color??[0,0,0,0];this._fillStyle=`rgba(${b.slice(0,3).toString()},${b[3]})`;this._haloStyle=`rgb(${w.slice(0,3).toString()})`;w=this._renderedLineHeight;b=this._renderedHaloSize;g.save();g.clearRect(0,0,p.width,p.height);this._setFontProperties(g,t);var a=g.textAlign,e=this._renderedWidth;a=("center"===a?.5*e:"right"===a?e:0)+b;e=0<b;let c=this._lineThroughWidthOffset,m=0;e&&this._renderHalo(g,
a,b,c,m,t);m+=b;c+=a;for(var k of this._textLines)e&&(g.globalCompositeOperation="destination-out",g.fillStyle="rgb(0, 0, 0)",g.fillText(k,c,m),g.globalCompositeOperation="source-over"),g.fillStyle=this._fillStyle,g.fillText(k,c,m),f&&"none"!==f&&this._renderDecoration(g,c,m,f,d),m+=w;g.restore();k=this._renderedWidth+2*this._lineThroughWidthOffset;w=this._renderedHeight;g=g.getImageData(0,0,k,w);g=new Uint8Array(g.data);if(t.premultiplyColors)for(a=0;a<g.length;a+=4)b=g[a+3]/255,g[a]*=b,g[a+1]*=
b,g[a+2]*=b;switch(t.horizontalAlignment){case "left":b=-.5;break;case "right":b=.5;break;default:b=0}switch(t.verticalAlignment){case "bottom":t=-.5;break;case "top":t=.5;break;default:t=0}return{size:[k,w],image:new Uint32Array(g.buffer),sdf:!1,simplePattern:!1,anchorX:b,anchorY:t,canvas:p}};E._renderHalo=function(w,t,p,g,f,d){const b=this._renderedWidth,a=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=
b;this._haloRasterizationCanvas.height=a;const e=this._haloRasterizationCanvas,c=e.getContext("2d");c.clearRect(0,0,b,a);this._setFontProperties(c,d);const {decoration:m,weight:k}=d.font;c.fillStyle=this._haloStyle;c.strokeStyle=this._haloStyle;c.lineJoin="round";this._renderHaloNative(c,t,p,m,k);w.globalAlpha=this._parameters.halo.color[3];w.drawImage(e,0,0,b,a,g,f,b,a);w.globalAlpha=1};E._renderHaloNative=function(w,t,p,g,f){const d=this._renderedLineHeight,b=this._renderedHaloSize;for(const a of this._textLines){const e=
2*b;for(let c=0;5>c;c++){const m=(.6+.1*c)*e;w.lineWidth=m;w.strokeText(a,t,p);g&&"none"!==g&&this._renderDecoration(w,t,p,g,f,m)}p+=d}};E._setFontProperties=function(w,t){var p=t.font;p=`${p.style} ${p.weight} ${h.pt2px(Math.max(t.size,.5)*t.pixelRatio).toFixed(1)}px ${p.family}, sans-serif`;w.font=p;w.textBaseline="top";switch(t.horizontalAlignment){case "left":t="left";break;case "right":t="right";break;case "center":t="center";break;default:t="left"}w.textAlign=t};E.computeTextSize=function(w,
t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const p=this._textRasterizationCanvas;var g=p.getContext("2d");this._setFontProperties(g,t);this._parameters=t;this._textLines=w.split(/\r?\n/);this._lineHeight=this._computeLineHeight();w=this._computeTextWidth(g,t);g=this._lineHeight*this._textLines.length;p.width=w;p.height=g;return[w*t.pixelRatio,g*t.pixelRatio]};E._computeTextWidth=function(w,t){let p=0;for(const g of this._textLines)p=Math.max(p,
w.measureText(g).width);t=t.font;if("italic"===t.style||"oblique"===t.style||"string"===typeof t.weight&&("bold"===t.weight||"bolder"===t.weight)||"number"===typeof t.weight&&600<t.weight)p+=.3*w.measureText("w").width;p+=2*this._parameters.halo.size;return Math.round(p)};E._computeLineHeight=function(){let w=1.275*this._parameters.size;const t=this._parameters.font.decoration;t&&"underline"===t&&(w*=1.3);return Math.round(w+2*this._parameters.halo.size)};E._renderDecoration=function(w,t,p,g,f,d){const b=
.9*this._lineHeight;switch(w.textAlign){case "center":t-=this._renderedWidth/2;break;case "right":t-=this._renderedWidth}const a=w.textBaseline;if("underline"===g)switch(a){case "top":p+=b;break;case "middle":p+=b/2}else if("line-through"===g)switch(a){case "top":p+=b/1.5;break;case "middle":p+=b/3}g=d?1.5*d:Math.ceil(b*("bold"===f?.06:"bolder"===f?.09:.04));w.save();w.beginPath();w.strokeStyle=w.fillStyle;w.lineWidth=g;w.moveTo(t-this._lineThroughWidthOffset,p);w.lineTo(t+this._renderedWidth+2*this._lineThroughWidthOffset,
p);w.stroke();w.restore()};return l._createClass(D)}()})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),function(l,h,D,E,w,t,p,g,f,d,b){function a(n,x){n.forEach(q=>
t.transformMat2d(q,q,x));return{upperLeft:f.i1616to32(8*n[0][0],8*n[0][1]),upperRight:f.i1616to32(8*n[1][0],8*n[1][1]),lowerLeft:f.i1616to32(8*n[2][0],8*n[2][1]),lowerRight:f.i1616to32(8*n[3][0],8*n[3][1])}}const e=Math.PI/180;let c=function(){function n(q,B,y,u){this._rotationT=w.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;this._bounds=null;const v=y.rect,r=new Float32Array(8);q*=u;B*=u;const z=y.code?v.width*u:y.metrics.width,A=y.code?v.height*u:y.metrics.height;this.width=
z;this.height=A;r[0]=q;r[1]=B;r[2]=q+z;r[3]=B;r[4]=q;r[5]=B+A;r[6]=q+z;r[7]=B+A;this._data=r;this._setTextureCoords(v);this._scale=u;this._mosaic=y;this.x=q;this.y=B;this.maxOffset=Math.max(q+z,B+A)}var x=n.prototype;x.setTransform=function(q){this._transform=q;this._offsets=null};x._setOffsets=function(q){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const B=this._offsets,y=new Float32Array(8),u=E.multiply(w.create(),this._rotationT,this._transform);w.transformMany(y,
q,u);B.upperLeft=f.i1616to32(8*y[0],8*y[1]);B.upperRight=f.i1616to32(8*y[2],8*y[3]);B.lowerLeft=f.i1616to32(8*y[4],8*y[5]);B.lowerRight=f.i1616to32(8*y[6],8*y[7])};x._setTextureCoords=function({x:q,y:B,width:y,height:u}){this._texcoords={upperLeft:f.i1616to32(q,B),upperRight:f.i1616to32(q+y,B),lowerLeft:f.i1616to32(q,B+u),lowerRight:f.i1616to32(q+y,B+u)}};h._createClass(n,[{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",get:function(){return this._angle},set:function(q){this._angle=
q;E.fromRotation(this._rotationT,-q);this._setOffsets(this._data)}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},
{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){if(!this._bounds){const {height:v,width:r}=this._mosaic.metrics;var q=r*this._scale,B=Math.abs(v)*this._scale,y=new Float32Array(8);y[0]=this.x;y[1]=this.y;y[2]=this.x+q;y[3]=this.y;y[4]=this.x;y[5]=this.y+B;y[6]=this.x+q;y[7]=this.y+B;q=E.multiply(w.create(),this._rotationT,this._transform);w.transformMany(y,y,q);B=q=Infinity;let z=0;var u=
0;for(let A=0;4>A;A++){const C=y[2*A],F=y[2*A+1];q=Math.min(q,C);B=Math.min(B,F);z=Math.max(z,C);u=Math.max(u,F)}y=z-q;u-=B;this._bounds=new b(q+y/2,B+u/2,y,u)}return this._bounds}}]);return n}(),m=function(){function n(q,B,y){this._rotation=0;this._decorate(q,B,y);this.glyphs=q;this.bounds=this._createBounds(q);this.isMultiline=1<B.length;this._hasRotation=0!==y.angle;this._transform=this._createGlyphTransform(this.bounds,y);if((this._borderLineSize=y.borderLineSize)||y.hasBackground)[this.bounds,
this.background]=this.shapeBackground(this._transform);for(const u of q)u.setTransform(this._transform)}var x=n.prototype;x.setRotation=function(q){if(0!==q||0!==this._rotation){this._rotation=q;var B=this._transform;q=E.fromRotation(w.create(),q);E.multiply(B,q,B);for(const y of this.glyphs)y.setTransform(this._transform)}};x._decorate=function(q,B,y){if(y.decoration&&"none"!==y.decoration&&q.length){var u=y.scale;y="underline"===y.decoration?30:20;var v=q[0].textureBinding;for(const C of B){const F=
C.startX*u,G=C.startY*u;B=q;var r=B.push;var z=(C.width+C.glyphWidthEnd)*u;var A=v;z={code:0,page:0,sdf:!0,rect:new d(0,0,11,8),textureBinding:A,metrics:{advance:0,height:4,width:z,left:0,top:0}};r.call(B,new c(F,G+y*u,z,1))}}};x.shapeBackground=function(q){const B=(1.5+D.pt2px(this._borderLineSize||0))/2;var y=this._borderLineSize?B:0;const {xmin:u,ymin:v,xmax:r,ymax:z,x:A,y:C,width:F,height:G}=this.bounds,H=[u-8,v-8],K=[r+8,v-8],J=[u-8,z+8],N=[r+8,z+8],P=a([[H[0]-B,H[1]-B],[K[0]+B,K[1]-B],[H[0]+
y,H[1]+y],[K[0]-y,K[1]+y]],q),W=a([[J[0]+y,J[1]-y],[N[0]-y,N[1]-y],[J[0]-B,J[1]+B],[N[0]+B,N[1]+B]],q),X=a([[H[0]-B,H[1]-B],[H[0]+y,H[1]+y],[J[0]-B,J[1]+B],[J[0]+y,J[1]-y]],q);y=a([[K[0]-y,K[1]+y],[K[0]+B,K[1]-B],[N[0]-y,N[1]-y],[N[0]+B,N[1]+B]],q);q={main:a([H,K,J,N],q),top:P,bot:W,left:X,right:y};return[new b(A,C,F+2*B,G+2*B),q]};x._createBounds=function(q){let B=Infinity,y=Infinity,u=0;var v=0;for(const r of q)B=Math.min(B,r.xTopLeft),y=Math.min(y,r.yTopLeft),u=Math.max(u,r.xBottomRight),v=Math.max(v,
r.yBottomRight);q=u-B;v-=y;return new b(B+q/2,y+v/2,q,v)};x._createGlyphTransform=function(q,B){const y=e*B.angle,u=w.create(),v=p.create();E.translate(u,u,t.set(v,B.xOffset,-B.yOffset));B.isCIM?E.rotate(u,u,y):(E.translate(u,u,t.set(v,q.x,q.y)),E.rotate(u,u,y),E.translate(u,u,t.set(v,-q.x,-q.y)));return u};h._createClass(n,[{key:"boundsT",get:function(){var q=this.bounds;const B=t.set(p.create(),q.x,q.y);t.transformMat2d(B,B,this._transform);return this._hasRotation?(q=Math.max(q.width,q.height),
new b(B[0],B[1],q,q)):new b(B[0],B[1],q.width,q.height)}}]);return n}(),k=h._createClass(function(n,x,q,B,y,u){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(x,q));this.end=Math.max(0,Math.max(x,q));this.end<n.length&&(this.glyphWidthEnd=n[this.end].metrics.width);this.width=B;this.yMin=y;this.yMax=u});l.ShapedGlyph=c;l.ShapingInfo=m;l.shapeGlyphs=function(n,x,q){const B=q.scale,y=[],u=[];var v=1/q.scale*q.maxLineWidth;var r=x?n.length-1:0,z=x?-1:n.length;x=x?-1:1;var A=
r,C=0,F=0;let G=A,H=G,K=0,J=Infinity,N=0;for(;A!==z;){const {code:aa,metrics:Z}=n[A];var P=Math.abs(Z.top);10!==aa&&32!==aa&&(J=Math.min(J,P),N=Math.max(N,P+Z.height));10===aa?(A!==r&&(u.push(new k(n,G,A-x,C,J,N)),J=Infinity,N=0),C=0,G=A+x,H=A+x,F=0):32===aa?(H=A+x,F=0,K=Z.advance,C+=Z.advance):(C>v&&(H!==G?(P=H-2*x,C-=K,u.push(new k(n,G,P,C-F,J,N)),J=Infinity,N=0,G=H,C=F):(u.push(new k(n,G,A-x,C,J,N)),J=Infinity,N=0,H=G=A,C=0)),C+=Z.advance,F+=Z.advance);A+=x}v=new k(n,G,A-x,C,J,N);0<=v.start&&v.end<
n.length&&u.push(v);for(v=0;v<u.length;v++);r=u[0].yMin;v=u[u.length-1].yMax+q.lineHeight*(u.length-1)+("underline"===q.decoration?4:0)-r;const {vAlign:W,hAlign:X}=q;z=W===g.VAlign.Baseline?1:0;v=(1-z)*-r+v/2*(z?0:W-1)+-26*(z?1:0);for(r=0;r<u.length;r++){const {start:aa,end:Z,width:ea}=u[r];z=ea/2*(X+1)*-1-3;x=r*q.lineHeight+v-3;u[r].startX=z;u[r].startY=x;for(A=aa;A<=Z;A++)C=n[A],10!==C.code&&(F=new c(z+C.metrics.left,x-C.metrics.top,C,B),z+=C.metrics.advance,y.push(F))}return new m(y,u,q)};Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function h(D=0,E=0,w=0,t=0){this.x=D;this.y=E;this.width=w;this.height=t}h.prototype.union=function(D){this.x=Math.min(this.x,D.x);this.y=Math.min(this.y,D.y);this.width=Math.max(this.width,D.width);this.height=Math.max(this.height,D.height)};l._createClass(h,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);
return h}()})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2f32"],function(l,h){return function(){function D(w,t,p,g){this.center=h.fromValues(w,t);this.centerT=h.create();this.halfWidth=p/2;this.halfHeight=g/2;this.width=p;this.height=g}var E=D.prototype;E.clone=function(){return new D(this.x,this.y,this.width,this.height)};E.serialize=function(w){w.writeF32(this.center[0]);w.writeF32(this.center[1]);
w.push(this.width);w.push(this.height);return w};E.findCollisionDelta=function(w,t=4){return Math.log2(Math.min((w.halfWidth+this.halfWidth+t)/Math.abs(w.centerT[0]-this.centerT[0]),(w.halfHeight+this.halfHeight+t)/Math.abs(w.centerT[1]-this.centerT[1])))};E.extend=function(w){const t=Math.min(this.xmin,w.xmin),p=Math.min(this.ymin,w.ymin),g=Math.max(this.xmax,w.xmax)-t;w=Math.max(this.ymax,w.ymax)-p;this.width=g;this.height=w;this.halfWidth=g/2;this.halfHeight=w/2;this.x=t+g/2;this.y=p+w/2};D.deserialize=
function(w){const t=w.readF32(),p=w.readF32(),g=w.readInt32();w=w.readInt32();return new D(t,p,g,w)};l._createClass(D,[{key:"x",get:function(){return this.center[0]},set:function(w){this.center[0]=w}},{key:"y",get:function(){return this.center[1]},set:function(w){this.center[1]=w}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-
this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return D}()})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Error","../../../core/Logger","../../../core/maybe","../../../geometry/support/quantizationUtils"],function(l,h,D,E){function w(p){const g={};switch(p){case "esriGeometryPoint":return(f,
d,b,a)=>E.unquantizePoint(d,g,f,b,a);case "esriGeometryPolygon":return(f,d,b,a)=>E.unquantizePolygon(d,g,f,b,a);case "esriGeometryPolyline":return(f,d,b,a)=>E.unquantizePolyline(d,g,f,b,a);case "esriGeometryMultipoint":return(f,d,b,a)=>E.unquantizeMultipoint(d,g,f,b,a);default:return h.getLogger("esri.views.2d.support.arcadeOnDemand").error(new l("mapview-arcade",`Unable to handle geometryType: ${p}`)),f=>f}}const t=new Map;return function(p,g,f,d,b){if(D.isNone(p))return null;if(p.referencesGeometry()&&
b){const {transform:a,hasZ:e,hasM:c}=b;t.has(d)||t.set(d,w(d));d=t.get(d)(g.geometry,a,e,c);g={...g,geometry:d}}g=p.repurposeFeature(g);try{return p.evaluate({...f,$feature:g})}catch(a){return h.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(l,h,D){function E({scale:C,translate:F},G){return Math.round((G-F[0])/C[0])}function w({scale:C,
translate:F},G){return Math.round((F[1]-G)/C[1])}function t(C,F,G){const H=[];let K,J,N,P;for(let W=0;W<G.length;W++){const X=G[W];if(0<W){if(N=E(C,X[0]),P=w(C,X[1]),N!==K||P!==J)H.push(F(X,N-K,P-J)),K=N,J=P}else K=E(C,X[0]),J=w(C,X[1]),H.push(F(X,K,J))}return 0<H.length?H:null}function p(C,F,G,H){return t(C,G?H?A:z:H?z:r,F)}function g(C,F,G,H){const K=[];G=G?H?A:z:H?z:r;for(H=0;H<F.length;H++){const J=t(C,G,F[H]);J&&3<=J.length&&K.push(J)}return K.length?K:null}function f(C,F,G,H){const K=[];G=G?
H?A:z:H?z:r;for(H=0;H<F.length;H++){const J=t(C,G,F[H]);J&&2<=J.length&&K.push(J)}return K.length?K:null}function d({scale:C,translate:F},G){return G*C[0]+F[0]}function b({scale:C,translate:F},G){return F[1]-G*C[1]}function a(C,F,G){const H=Array(G.length);if(!G.length)return H;const [K,J]=C.scale;let N=d(C,G[0][0]);C=b(C,G[0][1]);H[0]=F(G[0],N,C);for(let P=1;P<G.length;P++){const W=G[P];N+=W[0]*K;C-=W[1]*J;H[P]=F(W,N,C)}return H}function e(C,F,G){const H=Array(G.length);for(let K=0;K<G.length;K++)H[K]=
a(C,F,G[K]);return H}function c(C,F,G,H){return a(C,G?H?A:z:H?z:r,F)}function m(C,F,G,H){return e(C,G?H?A:z:H?z:r,F)}function k(C,F,G,H){return e(C,G?H?A:z:H?z:r,F)}function n(C,F,G){let [H,K]=G[0],J=Math.min(H,F[0]),N=Math.min(K,F[1]),P=Math.max(H,F[2]);F=Math.max(K,F[3]);for(let W=1;W<G.length;W++){const [X,aa]=G[W];H+=X;K+=aa;0>X&&(J=Math.min(J,H));0<X&&(P=Math.max(P,H));0>aa?N=Math.min(N,K):0<aa&&(F=Math.max(F,K))}C[0]=J;C[1]=N;C[2]=P;C[3]=F;return C}function x(C,F){if(!F.length)return null;C[0]=
C[1]=Number.POSITIVE_INFINITY;C[2]=C[3]=Number.NEGATIVE_INFINITY;for(let G=0;G<F.length;G++)n(C,C,F[G]);return C}function q(C,F,G,H,K){F.xmin=E(C,G.xmin);F.ymin=w(C,G.ymin);F.xmax=E(C,G.xmax);F.ymax=w(C,G.ymax);F!==G&&(H&&(F.zmin=G.zmin,F.zmax=G.zmax),K&&(F.mmin=G.mmin,F.mmax=G.mmax));return F}function B(C,F,G,H,K){F.points=p(C,G.points,H,K)??[];return F}function y(C,F,G,H,K){F.x=E(C,G.x);F.y=w(C,G.y);F!==G&&(H&&(F.z=G.z),K&&(F.m=G.m));return F}function u(C,F,G,H,K){C=g(C,G.rings,H,K);if(!C)return null;
F.rings=C;return F}function v(C,F,G,H,K){C=f(C,G.paths,H,K);if(!C)return null;F.paths=C;return F}const r=(C,F,G)=>[F,G],z=(C,F,G)=>[F,G,C[2]],A=(C,F,G)=>[F,G,C[2],C[3]];l.equals=function(C,F){if(C===F||null==C&&null==F)return!0;if(null==C||null==F)return!1;let G,H,K,J;C&&"upperLeft"===C.originPosition?(G=C.translate[0],H=C.translate[1],C=C.scale[0]):(G=h.isSome(C.extent)?C.extent.xmin:0,H=h.isSome(C.extent)?C.extent.ymax:0,C=C.tolerance);F&&"upperLeft"===F.originPosition?(K=F.translate[0],J=F.translate[1],
F=F.scale[0]):(K=h.isSome(F.extent)?F.extent.xmin:0,J=h.isSome(F.extent)?F.extent.ymax:0,F=F.tolerance);return G===K&&H===J&&C===F};l.getQuantizedBoundsCoordsArray=n;l.getQuantizedBoundsCoordsArrayArray=x;l.getQuantizedBoundsPaths=function(C){return x([0,0,0,0],C)};l.getQuantizedBoundsPoints=function(C){const F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return n(F,F,C)};l.getQuantizedBoundsRings=function(C){return x([0,0,0,0],C)};l.quantizeBounds=
function(C,F,G){F[0]=E(C,G[0]);F[3]=w(C,G[1]);F[2]=E(C,G[2]);F[1]=w(C,G[3]);return F};l.quantizeExtent=q;l.quantizeGeometry=function(C,F){return C&&F?D.isPoint(F)?y(C,{},F,!1,!1):D.isPolyline(F)?v(C,{},F,!1,!1):D.isPolygon(F)?u(C,{},F,!1,!1):D.isMultipoint(F)?B(C,{},F,!1,!1):D.isExtent(F)?q(C,{},F,!1,!1):null:null};l.quantizeMultipoint=B;l.quantizePaths=f;l.quantizePoint=y;l.quantizePoints=p;l.quantizePolygon=u;l.quantizePolyline=v;l.quantizeRings=g;l.quantizeX=E;l.quantizeY=w;l.toQuantizationTransform=
function(C){return C?{originPosition:"upper-left"===C.originPosition?"upperLeft":"lower-left"===C.originPosition?"lowerLeft":C.originPosition,scale:C.tolerance?[C.tolerance,C.tolerance]:[1,1],translate:h.isSome(C.extent)?[C.extent.xmin,C.extent.ymax]:[0,0]}:null};l.unquantizeBounds=function(C,F,G){return G?(F[0]=d(C,G[0]),F[1]=b(C,G[3]),F[2]=d(C,G[2]),F[3]=b(C,G[1]),F):[d(C,F[0]),b(C,F[3]),d(C,F[2]),b(C,F[1])]};l.unquantizeCoordsArray=a;l.unquantizeCoordsArrayArray=e;l.unquantizeExtent=function(C,
F,G,H,K){F.xmin=d(C,G.xmin);F.ymin=b(C,G.ymin);F.xmax=d(C,G.xmax);F.ymax=b(C,G.ymax);F!==G&&(H&&(F.zmin=G.zmin,F.zmax=G.zmax),K&&(F.mmin=G.mmin,F.mmax=G.mmax));return F};l.unquantizeMultipoint=function(C,F,G,H,K){h.isSome(G)&&(F.points=c(C,G.points,H,K));return F};l.unquantizePaths=m;l.unquantizePoint=function(C,F,G,H,K){if(h.isNone(G))return F;F.x=d(C,G.x);F.y=b(C,G.y);F!==G&&(H&&(F.z=G.z),K&&(F.m=G.m));return F};l.unquantizePoints=c;l.unquantizePolygon=function(C,F,G,H,K){h.isSome(G)&&(F.rings=
k(C,G.rings,H,K));return F};l.unquantizePolyline=function(C,F,G,H,K){h.isSome(G)&&(F.paths=m(C,G.paths,H,K));return F};l.unquantizeRings=k;l.unquantizeX=d;l.unquantizeY=b;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["exports"],function(l){function h(g,f){g%=f;return 0<=g?g:g+f}const D=Number.POSITIVE_INFINITY,E=Math.PI,w=128/E,t=256/360,p=1/Math.LN2;l.C_2PI=2*E;l.C_DEG_TO_256=t;l.C_DEG_TO_RAD=E/180;l.C_INFINITY=
D;l.C_PI=E;l.C_RAD_TO_256=w;l.between=function(g,f,d){return g>=f&&g<=d||g>=d&&g<=f};l.degToByte=function(g){return h(g*t,256)};l.interpolate=function(g,f,d){return g*(1-d)+f*d};l.log2=function(g){return Math.log(g)*p};l.positiveMod=h;l.radToByte=function(g){return h(g*w,256)};l.sqr=function(g){return g*g};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/rasterizingUtils":function(){define(["exports","../../core/floatRGBA","../../core/mathUtils"],function(l,h,D){l.rasterizeDash=
function(E,w){var t="Butt"===w,p="Square"===w;w=!t&&!p;1===E.length%2&&(E=[...E,...E]);var g=0;for(var f of E)g+=f;f=Math.round(15.5*g);g=new Float32Array(31*f);let d=0,b=0,a=.5,e=!0;for(var c of E){d=b;for(b+=15.5*c;a<=b;){for(E=.5;31>E;){const m=w?(E-15.5)*(E-15.5):Math.abs(E-15.5);g[(E-.5)*f+a-.5]=e?t?Math.max(Math.max(d+7.75-a,m),Math.max(a-b+7.75,m)):m:w?Math.min((a-d)*(a-d)+m,(a-b)*(a-b)+m):p?Math.min(Math.max(a-d,m),Math.max(b-a,m)):Math.min(Math.max(a-d+7.75,m),Math.max(b+7.75-a,m));E++}a++}e=
!e}t=g.length;c=new Uint8Array(4*t);for(p=0;p<t;++p)h.packFloatRGBA((w?Math.sqrt(g[p]):g[p])/15.5,c,4*p);return[c,f,31]};l.rasterizeSimpleFill=function(E,w,t){t=D.nextPowerOfTwo(Math.ceil(t));var p="vertical"===w||"horizontal"===w||"cross"===w||"esriSFSCross"===w||"esriSFSVertical"===w||"esriSFSHorizontal"===w?8*t:16*t;const g=2*t;E.width=p;E.height=p;const f=E.getContext("2d");f.strokeStyle="#FFFFFF";f.lineWidth=t;f.beginPath();if("vertical"===w||"cross"===w||"esriSFSCross"===w||"esriSFSVertical"===
w)f.moveTo(p/2,-g),f.lineTo(p/2,p+g);if("horizontal"===w||"cross"===w||"esriSFSCross"===w||"esriSFSHorizontal"===w)f.moveTo(-g,p/2),f.lineTo(p+g,p/2);if("forward-diagonal"===w||"diagonal-cross"===w||"esriSFSDiagonalCross"===w||"esriSFSForwardDiagonal"===w)f.moveTo(-g,-g),f.lineTo(p+g,p+g),f.moveTo(p-g,-g),f.lineTo(p+g,g),f.moveTo(-g,p-g),f.lineTo(g,p+g);if("backward-diagonal"===w||"diagonal-cross"===w||"esriSFSBackwardDiagonal"===w||"esriSFSDiagonalCross"===w)f.moveTo(p+g,-g),f.lineTo(-g,p+g),f.moveTo(g,
-g),f.lineTo(-g,g),f.moveTo(p+g,p-g),f.lineTo(p-g,p+g);f.stroke();w=f.getImageData(0,0,E.width,E.height);w=new Uint8Array(w.data);for(p=0;p<w.length;p+=4)t=w[p+3]/255,w[p]*=t,w[p+1]*=t,w[p+2]*=t;return[w,E.width,E.height]};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/core/floatRGBA":function(){define(["exports","./mathUtils"],function(l,h){function D(p,g=0){let f=0;for(let d=0;4>d;d++)f+=p[g+d]*w[d];return f}const E=[1,256,65536,16777216],w=[1/256,1/65536,1/16777216,1/4294967296],
t=D(new Uint8ClampedArray([255,255,255,255]));l.packFloatRGBA=function(p,g,f=0){p=h.clamp(p,0,t);for(let a=0;4>a;a++){var d=Math,b=p*E[a];g[f+a]=d.floor.call(d,256*(b-Math.floor(b)))}};l.unpackFloatRGBA=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/SDFHelper":function(){define(["exports","../../core/floatRGBA","../../geometry/support/jsonUtils","./Rect","../../views/2d/engine/webgl/definitions"],function(l,h,D,E,w){function t(g){if(!g)return null;switch(g.type){case "CIMPointSymbol":g=
g.symbolLayers;if(!g||1!==g.length)break;return t(g[0]);case "CIMVectorMarker":g=g.markerGraphics;if(!g||1!==g.length)break;var f=g[0];if(!f)break;g=f.geometry;if(!g)break;f=f.symbol;if(!f||"CIMPolygonSymbol"!==f.type&&"CIMLineSymbol"!==f.type||f.symbolLayers?.some(d=>!!d.effects))break;return{geom:g,asFill:"CIMPolygonSymbol"===f.type};case "sdf":return{geom:g.geom,asFill:g.asFill}}return null}function p(g){let f=Infinity,d=-Infinity,b=Infinity,a=-Infinity;for(const e of g)for(const c of e)c[0]<f&&
(f=c[0]),c[0]>d&&(d=c[0]),c[1]<b&&(b=c[1]),c[1]>a&&(a=c[1]);return[f,b,d,a]}l.buildSDF=function(g){var f=g.geom;var d=f?f.rings?f.rings:f.paths?f.paths:void 0!==f.xmin&&void 0!==f.ymin&&void 0!==f.xmax&&void 0!==f.ymax?[[[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]]]:null:null;f=Infinity;var b=-Infinity;var a=Infinity;var e=-Infinity;for(var c of d)for(var m of c)m[0]<f&&(f=m[0]),m[0]>b&&(b=m[0]),m[1]<a&&(a=m[1]),m[1]>e&&(e=m[1]);a=new E(f,a,b-f,e-a);c=w.SPRITE_PADDING;
f=Math.floor(.5*(64-c));e=(128-2*(f+c))/Math.max(a.width,a.height);c=Math.round(a.width*e)+2*f;m=Math.round(a.height*e)+2*f;b=[];for(var k of d)if(k&&1<k.length){d=[];for(var n of k){let [F,G]=n;F-=a.x;G-=a.y;F*=e;G*=e;F+=f-.5;G+=f-.5;g.asFill?d.push([F,G]):d.push([Math.round(F),Math.round(G)])}if(g.asFill){var x=d.length-1;d[0][0]===d[x][0]&&d[0][1]===d[x][1]||d.push(d[0])}b.push(d)}n=c*m;k=Array(n);d=f*f+1;for(a=0;a<n;++a)k[a]=d;for(var q of b)for(d=q.length,a=1;a<d;++a){e=q[a-1];x=q[a];var B=void 0,
y=void 0;e[0]<x[0]?(B=e[0],y=x[0]):(B=x[0],y=e[0]);var u=void 0,v=void 0;e[1]<x[1]?(u=e[1],v=x[1]):(u=x[1],v=e[1]);var r=Math.floor(B)-f;y=Math.floor(y)+f;u=Math.floor(u)-f;v=Math.floor(v)+f;0>r&&(r=0);y>c&&(y=c);0>u&&(u=0);v>m&&(v=m);B=x[0]-e[0];const F=x[1]-e[1],G=B*B+F*F;for(;r<y;r++)for(let H=u;H<v;H++){var z=(r-e[0])*B+(H-e[1])*F,A=void 0;0>z?(A=e[0],z=e[1]):z>G?(A=x[0],z=x[1]):(z/=G,A=e[0]+z*B,z=e[1]+z*F);A=(r-A)*(r-A)+(H-z)*(H-z);z=(m-H-1)*c+r;A<k[z]&&(k[z]=A)}}for(q=0;q<n;++q)k[q]=Math.sqrt(k[q]);
if(g.asFill)for(var C of b)for(g=C.length,q=1;q<g;++q)for(b=C[q-1],n=C[q],b[0]<n[0]?(d=b[0],a=n[0]):(d=n[0],a=b[0]),b[1]<n[1]?(x=b[1],e=n[1]):(x=n[1],e=b[1]),d=Math.floor(d),a=Math.floor(a)+1,x=Math.floor(x),e=Math.floor(e)+1,d<f&&(d=f),a>c-f&&(a=c-f),x<f&&(x=f),e>m-f&&(e=m-f);x<e;++x)if(b[1]>x!==n[1]>x){y=(m-x-1)*c;for(u=d;u<a;++u)u<(n[0]-b[0])*(x-b[1])/(n[1]-b[1])+b[0]&&(k[y+u]=-k[y+u]);for(u=f;u<d;++u)k[y+u]=-k[y+u]}C=2*f;f=k.length;g=new Uint8Array(4*f);for(q=0;q<f;++q)h.packFloatRGBA(.5-k[q]/
C,g,4*q);return[g,c,m]};l.getExtent=function(g){return g?g.rings?p(g.rings):g.paths?p(g.paths):D.isExtent(g)?[g.xmin,g.ymin,g.xmax,g.ymax]:null:null};l.getSDFInfo=t;l.getSDFMetrics=function(g,f,d,b,a){const [e,c,m,k]=g;if(m<e||k<c)return[0,0,0];var n=m-e,x=k-c,q=w.SPRITE_PADDING;g=Math.floor(.5*(64-q));q=(128-2*(g+q))/Math.max(n,x);const B=Math.round(n*q),y=Math.round(x*q)+2*g;x=1;f&&(x=y/q/(f.ymax-f.ymin));let u=0,v=0;n=1;b&&(a?f&&d&&0<f.ymax-f.ymin&&(n=(f.xmax-f.xmin)/(f.ymax-f.ymin),u=b.x/(d*n),
v=b.y/d):(u=b.x,v=b.y));f&&(u=.5*(f.xmax+f.xmin)+u*(f.xmax-f.xmin),v=.5*(f.ymax+f.ymin)+v*(f.ymax-f.ymin));u=(u-e)*q+g;v=(v-c)*q+g;f=u/(B+2*g)-.5;b=v/y-.5;a&&d&&(f*=d*n,b*=d);return[x,f,b]};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/promiseUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),function(l,
h,D,E,w,t,p){function g(d){const b=new Set;for(const a of d)b.add(Math.floor(a/256));return b}function f(d,b,a){d.has(b)||d.set(b,a().then(()=>{d.delete(b)}).catch(e=>{d.delete(b);D.throwIfNotAbortError(e)}));return d.get(b)}return function(){function d(a,e,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=e;this._glyphSource=c;this._binPack=new w(a-4,e-4);this._glyphData.push(new Uint8Array(a*
e));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var b=d.prototype;b.dispose=function(){this._binPack=null;for(const a of this._textures)a&&a.dispose();this._textures.length=0;this._glyphData.length=0};b._initDecorationGlyph=function(){var a=[117,149,181,207,207,181,149,117];const e=[];for(let c=0;c<a.length;c++){const m=a[c];for(let k=0;11>k;k++)e.push(m)}a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(e)};this._recordGlyph(a)};b.getGlyphItems=
async function(a,e,c){const m=this._getGlyphCache(a);await this._fetchRanges(a,e,c);return e.map(k=>this._getMosaicItem(m,a,k))};b.bind=function(a,e,c,m){const k=this._getTexture(a,c);k.setSamplingMode(e);this._dirties[c]&&(k.setData(this._glyphData[c]),this._dirties[c]=!1);a.bindTexture(k,m)};b._getGlyphCache=function(a){this._glyphCache[a]||(this._glyphCache[a]={});return this._glyphCache[a]};b._getTexture=function(a,e){this._textures[e]||(this._textures[e]=new p.Texture(a,{pixelFormat:t.PixelFormat.ALPHA,
dataType:t.PixelType.UNSIGNED_BYTE,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[e]};b._invalidate=function(){this._dirties[this._currentPage]=!0};b._fetchRanges=async function(a,e,c){const m=[];g(e).forEach(k=>{m.push(this._fetchRange(a,k,c))});await Promise.all(m)};b._fetchRange=async function(a,e,c){if(!(256<e))return f(this._rangePromises,a+e,()=>this._glyphSource.getRange(a,e,c))};b._getMosaicItem=function(a,e,c){if(!a[c]){e=this._glyphSource.getGlyph(e,
c);if(!e||!e.metrics)return{rect:new E(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:c,sdf:!0};const m=this._recordGlyph(e);a[c]={rect:m,page:this._currentPage,metrics:e.metrics,code:c,sdf:!0};this._invalidate()}return a[c]};b._recordGlyph=function(a){var e=a.metrics;if(0===e.width)e=new E(0,0,0,0);else{const c=e.width+6,m=e.height+6;e=this._binPack.allocate(c,m);e.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,
this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new w(this.width-4,this.height-4),e=this._binPack.allocate(c,m));const k=this._glyphData[this._currentPage];a=a.bitmap;let n,x;if(a)for(let q=0;q<m;q++){n=c*q;x=this.width*(e.y+q)+e.x;for(let B=0;B<c;B++)k[x+B]=a[n+B]}h("esri-glyph-debug")&&this._showDebugPage(k)}return e};b._showDebugPage=function(a){const e=document.createElement("canvas"),c=e.getContext("2d"),
m=new ImageData(this.width,this.height),k=m.data;e.width=this.width;e.height=this.height;e.style.border="1px solid black";for(let n=0;n<a.length;++n)k[4*n]=a[n],k[4*n+1]=0,k[4*n+2]=0,k[4*n+3]=255;c.putImageData(m,0,0);document.body.appendChild(e)};return l._createClass(d)}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Rect"],function(l,h){return function(){function D(w,t){this._height=this._width=0;this._free=[];this._width=
w;this._height=t;this._free.push(new h(0,0,w,t))}var E=D.prototype;E.allocate=function(w,t){if(w>this._width||t>this._height)return new h;let p=null,g=-1;for(let f=0;f<this._free.length;++f){const d=this._free[f];w<=d.width&&t<=d.height&&(null===p||d.y<=p.y&&d.x<=p.x)&&(p=d,g=f)}if(null===p)return new h;this._free.splice(g,1);p.width<p.height?(p.width>w&&this._free.push(new h(p.x+w,p.y,p.width-w,t)),p.height>t&&this._free.push(new h(p.x,p.y+t,p.width,p.height-t))):(p.width>w&&this._free.push(new h(p.x+
w,p.y,p.width-w,p.height)),p.height>t&&this._free.push(new h(p.x,p.y+t,w,p.height-t)));return new h(p.x,p.y,w,t)};E.release=function(w){for(let t=0;t<this._free.length;++t){const p=this._free[t];if(p.y===w.y&&p.height===w.height&&p.x+p.width===w.x)p.width+=w.width;else if(p.x===w.x&&p.width===w.width&&p.y+p.height===w.y)p.height+=w.height;else if(w.y===p.y&&w.height===p.height&&w.x+w.width===p.x)p.x=w.x,p.width+=w.width;else if(w.x===p.x&&w.width===p.width&&w.y+w.height===p.y)p.y=w.y,p.height+=w.height;
else continue;this._free.splice(t,1);this.release(w)}this._free.push(w)};l._createClass(D,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return D}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../request","../../../../core/pbf"],function(l,h,D){let E=function(){function t(g){this._metrics=[];for(this._bitmaps=[];g.next();)switch(g.tag()){case 1:const f=g.getMessage();
for(;f.next();)switch(f.tag()){case 3:const d=f.getMessage();let b,a,e,c,m,k,n;for(;d.next();)switch(d.tag()){case 1:b=d.getUInt32();break;case 2:a=d.getBytes();break;case 3:e=d.getUInt32();break;case 4:c=d.getUInt32();break;case 5:m=d.getSInt32();break;case 6:k=d.getSInt32();break;case 7:n=d.getUInt32();break;default:d.skip()}d.release();b&&(this._metrics[b]={width:e,height:c,left:m,top:k,advance:n},this._bitmaps[b]=a);break;default:f.skip()}f.release();break;default:g.skip()}}var p=t.prototype;
p.getMetrics=function(g){return this._metrics[g]};p.getBitmap=function(g){return this._bitmaps[g]};return l._createClass(t)}(),w=function(){function t(){this._ranges=[]}var p=t.prototype;p.getRange=function(g){return this._ranges[g]};p.addRange=function(g,f){this._ranges[g]=f};return l._createClass(t)}();return function(){function t(g){this._glyphInfo={};this._baseURL=g}var p=t.prototype;p.getRange=function(g,f,d){const b=this._getFontStack(g);if(b.getRange(f))return Promise.resolve();const a=256*
f,e=a+255;g=this._baseURL.replace("{fontstack}",g).replace("{range}",a+"-"+e);return h(g,{responseType:"array-buffer",...d}).then(c=>{b.addRange(f,new E(new D(new Uint8Array(c.data),new DataView(c.data))))})};p.getGlyph=function(g,f){if(g=this._getFontStack(g)){var d=Math.floor(f/256);if(!(256<d)&&(g=g.getRange(d)))return{metrics:g.getMetrics(f),bitmap:g.getBitmap(f)}}};p._getFontStack=function(g){let f=this._glyphInfo[g];f||(f=this._glyphInfo[g]=new w);return f};return l._createClass(t)}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../../../core/floatRGBA","../../../../core/promiseUtils"],function(l,h,D){return function(){function E(t){this._svg=null;this.size=t;const p=document.createElement("canvas");p.width=p.height=t;this._context=p.getContext("2d");this._gridOuter=new Float64Array(t*t);this._gridInner=new Float64Array(t*t);this._f=new Float64Array(t);this._d=new Float64Array(t);this._z=new Float64Array(t+1);this._v=new Int16Array(t)}var w=E.prototype;w.dispose=function(){this._context=this._gridOuter=this._gridInner=
this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),this._svg=null)};w.draw=function(t,p,g=31){this._initSVG();const f=this.createSVGString(t);return new Promise((d,b)=>{const a=new Image;a.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(f);a.onload=()=>{a.onload=null;this._context.clearRect(0,0,this.size,this.size);this._context.drawImage(a,0,0,this.size,this.size);var c=this._context.getImageData(0,0,this.size,this.size);const m=new Uint8Array(this.size*
this.size*4);for(let k=0;k<this.size*this.size;k++){const n=c.data[4*k+3]/255;this._gridOuter[k]=1===n?0:0===n?1E20:Math.max(0,.5-n)**2;this._gridInner[k]=1===n?1E20:0===n?0:Math.max(0,n-.5)**2}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(c=0;c<this.size*this.size;c++)h.packFloatRGBA(.5-(this._gridOuter[c]-this._gridInner[c])/(2*g),m,4*c);d(m)};const e=p&&p.signal;if(e)D.onAbort(e,()=>b(D.createAbortError()))})};w._initSVG=function(){if(!this._svg){const t=
document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("style","position: absolute;");t.setAttribute("width","0");t.setAttribute("height","0");t.setAttribute("aria-hidden","true");t.setAttribute("role","presentation");document.body.appendChild(t);this._svg=t}return this._svg};w.createSVGString=function(t){const p=this._initSVG(),g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("d",t);p.appendChild(g);t=g.getBBox();var f=t.width/t.height;const d=this.size/
2;let b,a,e;1<f?(a=b=d/t.width,e=this.size/4,f=d-1/f*d/2):(b=a=d/t.height,e=d-d*f/2,f=this.size/4);g.setAttribute("style",`transform: matrix(${b}, 0, 0, ${a}, ${-t.x*b+e}, ${-t.y*a+f})`);t=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${p.innerHTML}</svg>`;p.removeChild(g);return t};w._edt=function(t,p,g){const f=this._f,d=this._d,b=this._v,a=this._z;for(var e=0;e<p;e++){for(var c=0;c<g;c++)f[c]=t[c*p+e];this._edt1d(f,d,b,a,g);for(c=0;c<g;c++)t[c*
p+e]=d[c]}for(e=0;e<g;e++){for(c=0;c<p;c++)f[c]=t[e*p+c];this._edt1d(f,d,b,a,p);for(c=0;c<p;c++)t[e*p+c]=Math.sqrt(d[c])}};w._edt1d=function(t,p,g,f,d){g[0]=0;f[0]=-1E20;f[1]=1E20;for(let b=1,a=0;b<d;b++){let e=(t[b]+b*b-(t[g[a]]+g[a]*g[a]))/(2*b-2*g[a]);for(;e<=f[a];)a--,e=(t[b]+b*b-(t[g[a]]+g[a]*g[a]))/(2*b-2*g[a]);a++;g[a]=b;f[a]=e;f[a+1]=1E20}for(let b=0,a=0;b<d;b++){for(;f[a+1]<b;)a++;p[b]=(b-g[a])*(b-g[a])+t[g[a]]}};return l._createClass(E)}()})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ./definitions ./GeometryUtils ./Rect ./RectangleBinPack ../../../webgl/enums ../../../webgl/Texture".split(" "),
function(l,h,D,E,w,t,p,g){function f(d){return d&&"static"===d.type}return function(){function d(a,e,c=0){this._mosaicPages=[];this._pageHeight=this._pageWidth=this._currentPage=this._maxItemSize=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=a||0>=e)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=a;this._pageHeight=e;0<c&&(this._maxItemSize=c);this.pixelRatio=window.devicePixelRatio||1;this._binPack=new t(this._pageWidth,
this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var b=d.prototype;b.getWidth=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[0]};b.getHeight=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[1]};b.getPageTexture=function(a){return a<this._mosaicPages.length?this._mosaicPages[a].texture:
null};b.has=function(a){return this._mosaicRects.has(a)};b.getSpriteItem=function(a){return this._mosaicRects.get(a)};b.addSpriteItem=function(a,e,c,m,k,n,x=1){if(this._mosaicRects.has(a))return this._mosaicRects.get(a);let q,B,y;f(c)?[q,B,y]=this._allocateImage(e[0],e[1]):(q=new w(0,0,e[0],e[1]),B=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:c,size:[e[0]+2*D.SPRITE_PADDING,e[1]+2*D.SPRITE_PADDING],dirty:!0,texture:void 0}));if(0>=q.width||0>=q.height)return null;n={rect:q,width:e[0],
height:e[1],sdf:k,simplePattern:n,pixelRatio:x,page:B};this._mosaicRects.set(a,n);f(c)&&this._copy({rect:q,spriteSize:e,spriteData:c.data,page:B,pageSize:y,repeat:m,sdf:k});return n};b.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};b.processNextItem=function(){const a=this._spriteCopyQueue.pop();a&&this._copy(a)};b.getSpriteItems=function(a){const e={};for(const c of a)e[c]=this.getSpriteItem(c);return e};b.getMosaicItemPosition=function(a){const e=(a=this.getSpriteItem(a))&&
a.rect;if(!e)return null;e.width=a.width;e.height=a.height;const c=D.SPRITE_PADDING,m=this._mosaicPages[a.page];return{size:[a.width,a.height],tl:[(e.x+c)/m[0],(e.y+c)/m[1]],br:[(e.x+c+a.width)/m[0],(e.y+c+a.height)/m[1]],page:a.page}};b.bind=function(a,e,c=0,m=0){c=this._mosaicPages[c];const k=c.mosaicsData;var n=c.texture;n||(n=c.size,n=new g.Texture(a,{pixelFormat:p.PixelFormat.RGBA,dataType:p.PixelType.UNSIGNED_BYTE,width:n[0],height:n[1]},null),c.texture=n);n.setSamplingMode(e);f(k)?(a.bindTexture(n,
m),c.dirty&&(n.setData(new Uint8Array(k.data.buffer)),n.generateMipmap())):(k.data.bindFrame(a,n,m),n.generateMipmap());c.dirty=!1};d._copyBits=function(a,e,c,m,k,n,x,q,B,y,u){let v=m*e+c;x=q*n+x;if(u)for(x-=n,u=-1;u<=y;u++,v=((u+y)%y+m)*e+c,x+=n)for(q=-1;q<=B;q++)k[x+q]=a[v+(q+B)%B];else for(c=0;c<y;c++){for(m=0;m<B;m++)k[x+m]=a[v+m];v+=e;x+=n}};b._copy=function(a){if(!(a.page>=this._mosaicPages.length)){var e=this._mosaicPages[a.page],c=e.mosaicsData;if(!f(e.mosaicsData))throw new h("mapview-invalid-resource",
"unsuitable data type!");var m=a.spriteData;(c=c.data)&&m||console.error("Source or target images are uninitialized!");d._copyBits(m,a.spriteSize[0],0,0,c,a.pageSize[0],a.rect.x+D.SPRITE_PADDING,a.rect.y+D.SPRITE_PADDING,a.spriteSize[0],a.spriteSize[1],a.repeat);e.dirty=!0}};b._allocateImage=function(a,e){a+=2*D.SPRITE_PADDING;e+=2*D.SPRITE_PADDING;var c=Math.max(a,e);if(this._maxItemSize&&this._maxItemSize<c){c=2**Math.ceil(E.log2(a));const m=2**Math.ceil(E.log2(e));a=new w(0,0,a,e);this._mosaicPages.push({mosaicsData:{type:"static",
data:new Uint32Array(c*m)},size:[c,m],dirty:!0,texture:void 0});return[a,this._mosaicPages.length-1,[c,m]]}c=this._binPack.allocate(a,e);return 0>=c.width?(c=this._mosaicPages[this._currentPage],!c.dirty&&f(c.mosaicsData)&&(c.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new t(this._pageWidth,
this._pageHeight),this._allocateImage(a,e)):[c,this._currentPage,[this._pageWidth,this._pageHeight]]};b.dispose=function(){this._binPack=null;for(const e of this._mosaicPages){var a=e.texture;a&&a.dispose();a=e.mosaicsData;f(a)||a.data.destroy()}this._mosaicPages=null;this._mosaicRects.clear()};l._createClass(d,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);return d}()})},"esri/views/2d/engine/webgl/animatedFormats/AnimatableTextureResource":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../core/maybe","../definitions","./utils"],function(l,h,D,E,w){let t=function(){function p(f,d,b,a){this._animation=f;this._frameData=null;this.frameCount=this._animation.frameDurations.length;this.width=this._animation.width;this.height=this._animation.height;this._playHandle=w.play(this._animation,b,a,e=>{this._frameData=e;d.requestRender()})}var g=p.prototype;g.destroy=function(){this._playHandle.remove()};g.bindFrame=function(f,d,b){f.bindTexture(d,b);D.isNone(this._frameData)||(d.updateData(0,
E.SPRITE_PADDING,E.SPRITE_PADDING,this._frameData.width,this._frameData.height,this._frameData),this._frameData=null)};return h._createClass(p)}();l.AnimatableTextureResource=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/animatedFormats/utils":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/time ../../../../../geometry/support/meshUtils/exporters/gltf/imageutils ../../../../../symbols/cim/enums ../grouping".split(" "),
function(l,h,D,E,w,t){function p(k){return D.Milliseconds(k.frameDurations.reduce((n,x)=>n+x,0))}function g(k){const {width:n,height:x}=k;return{frameDurations:k.frameDurations.reverse(),getFrame:q=>k.getFrame(k.frameDurations.length-1-q),width:n,height:x}}function f(k,n){const {width:x,height:q,getFrame:B}=k,y=p(k),u=n/y;return{frameDurations:k.frameDurations.map(v=>D.Milliseconds(v*u)),getFrame:B,width:x,height:q}}function d(k,n){const {width:x,height:q,getFrame:B}=k;k=k.frameDurations.slice();
const y=k.shift();k.unshift(D.Milliseconds(y+n));return{frameDurations:k,getFrame:B,width:x,height:q}}function b(k,n){const {width:x,height:q,getFrame:B}=k;k=k.frameDurations.slice();const y=k.pop();k.push(D.Milliseconds(y+n));return{frameDurations:k,getFrame:B,width:x,height:q}}function a(k,n,x,q){let {repeatType:B}=n;null==B&&(B=w.AnimatedSymbolRepeatType.Loop);!0===n.reverseAnimation&&(k=g(k));null!=n.duration&&(k=f(k,D.Milliseconds(1E3*n.duration)));if(null!=n.repeatDelay){const y=1E3*n.repeatDelay;
B===w.AnimatedSymbolRepeatType.Loop?k=b(k,D.Milliseconds(y)):B===w.AnimatedSymbolRepeatType.Oscillate&&(k=d(b(k,D.Milliseconds(y/2)),D.Milliseconds(y/2)))}null!=n.startTimeOffset?n=D.Milliseconds(1E3*n.startTimeOffset):null!=n.randomizeStartTime?(x=t.getMaterialGroup(x),n=t.getRandomValue(x,null!=n.randomizeStartSeed?n.randomizeStartSeed:82749913),n=D.Milliseconds(n*p(k))):n=D.Milliseconds(0);return new e(k,n,B,q)}let e=function(){function k(n,x,q,B){this._animation=n;this._repeatType=q;this._onFrameData=
B;this._direction=1;this._currentFrame=0;this.timeToFrame=this._animation.frameDurations[this._currentFrame];for(n=0;x>n;)n+=this.timeToFrame,this.nextFrame();x=this._animation.getFrame(this._currentFrame);this._onFrameData(x)}k.prototype.nextFrame=function(){this._currentFrame+=this._direction;if(0<this._direction){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case w.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;case w.AnimatedSymbolRepeatType.Loop:this._currentFrame=
0;break;case w.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case w.AnimatedSymbolRepeatType.None:this._currentFrame-=this._direction;break;case w.AnimatedSymbolRepeatType.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case w.AnimatedSymbolRepeatType.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];
const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)};return h._createClass(k)}();const c=document.createElement("canvas"),m=c.getContext("2d");l.Player=e;l.adjustDuration=f;l.appendDelay=b;l.createPlayer=a;l.getDuration=p;l.play=function(k,n,x,q){function B(){r=y?setTimeout(()=>{u.nextFrame();v=u.timeToFrame;B()},v):void 0}const y=null!=n.playAnimation?n.playAnimation:!0,u=a(k,n,x,q);let v=u.timeToFrame,r;B();return{remove:()=>{y&&clearTimeout(r)}}};l.prependDelay=d;l.resize=
function(k,n,x){c.width=n;c.height=x;const q=[],B=k.frameDurations.length;for(let y=0;y<B;y++){const u=k.getFrame(y);m.clearRect(0,0,n,x);u instanceof ImageData?m.drawImage(E.imageTypeToCanvas(u),0,0,n,x):m.drawImage(u,0,0,n,x);q.push(m.getImageData(0,0,n,x))}return{width:n,height:x,frameDurations:k.frameDurations,getFrame:y=>q[y]}};l.reverse=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/grouping":function(){define(["exports","../../../../core/string"],
function(l,h){function D(E,w){if("string"===typeof E)E=h.numericHash(E+`-seed(${w})`);else{let t=12;E^=w;do E=107*(E>>8^E)+t|0;while(0!==--t)}return(1+E/-2147483648)/2}l.getMaterialGroup=function(E){return Math.floor(10*D(E,53290320))};l.getRandomValue=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports","../../../../../core/Error"],function(l,h){l.ok=function(D,E){return D&&"name"in D?(E&&E.error(new h(D.name,D.message,
D.details)),!1):!0};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(l){l.keyFromSymbol=function(h){switch(h.type){case "esriSMS":return`${h.style}.${h.path}`;case "esriSLS":return`${h.style}.${h.cap}`;case "esriSFS":return`${h.style}`;case "esriPFS":case "esriPMS":return h.imageData?`${h.imageData}${h.width}${h.height}`:`${h.url}${h.width}${h.height}`;default:return"mosaicHash"in h?h.mosaicHash:JSON.stringify(h)}};
Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TextureUploadManager":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/promiseUtils ./definitions ../../../webgl/context-util".split(" "),function(l,h,D,E,w,t){let p=function(){function g(d,b){this._queue=[];this._context=d;this._refreshable=b}var f=g.prototype;f.destroy=function(){this._queue=[]};f.enqueueTextureUpdate=function(d,b){const a=E.createResolver(),
e=w.TEXTURE_UPLOAD_MANAGER_CHUNK_SIZE,c=Math.ceil(d.height/e);E.throwIfAborted(b);if(this._context.type===t.ContextType.WEBGL1)this._queue.push({type:"no-chunk",request:d,resolver:a,options:b});else for(let m=0;m<c;m++){const k=m===c-1;this._queue.push({type:"chunk",request:d,resolver:a,chunk:m,chunkOffset:m*e,destHeight:k?d.height-e*m:e,chunkIsLast:k,options:b})}E.onAbortOrThrow(b,m=>a.reject(m));return a.promise};f.upload=function(){let d=0;for(;this._queue.length;){var b=performance.now();const a=
this._queue.shift();if(a&&(!D.isSome(a.options.signal)||!a.options.signal.aborted)){switch(a.type){case "chunk":this._uploadChunk(a);break;case "no-chunk":this._uploadNoChunk(a)}b=performance.now()-b;d+=b;if(d+b>=w.TEXTURE_UPLOAD_MANAGER_BUDGET)break}}this._queue.length&&this._refreshable.requestRender()};f._uploadChunk=function(d){const {request:b,resolver:a,chunkOffset:e,chunkIsLast:c,destHeight:m}=d,{data:k,texture:n,width:x}=b;D.isSome(k)&&(n.updateData(0,0,e,x,m,k,e),c&&a.resolve())};f._uploadNoChunk=
function(d){const {request:b,resolver:a}=d,{data:e,texture:c}=b;c.setData(e);a.resolve()};return h._createClass(g)}();l.TextureUploadManager=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/WorldExtentClipRenderer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/common ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ./VertexStream ./shaders/StencilPrograms ../../../webgl/enums ../../../webgl/ProgramTemplate".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e){const c=p.fromValues(-.5,-.5);p=function(){function m(){this._centerNdc=f.create();this._pxToNdc=f.create();this._worldDimensionsPx=f.create();this._mat3=t.create();this._initialized=!1}var k=m.prototype;k.dispose=function(){this._program=D.disposeMaybe(this._program);this._quad=D.disposeMaybe(this._quad)};k.render=function(n,x){const {context:q}=n;if(!this._updateGeometry(n,x))return!1;this._initialized||this._initialize(q);q.setDepthWriteEnabled(!1);q.setDepthTestEnabled(!1);
q.setColorMask(!1,!1,!1,!1);q.setBlendingEnabled(!1);q.setStencilOp(a.StencilOperation.KEEP,a.StencilOperation.KEEP,a.StencilOperation.REPLACE);q.setStencilFunction(a.CompareFunction.ALWAYS,1,255);q.setStencilTestEnabled(!0);q.useProgram(this._program);this._program.setUniformMatrix3fv("u_worldExtent",this._mat3);this._quad.draw();this._quad.unbind();return!0};k._initialize=function(n){if(!this._initialized){var x=e.createProgram(n,b.stencil);x&&(this._program=x,this._quad=new d(n,[0,0,1,0,0,1,1,
1]),this._initialized=!0)}};k._updateGeometry=function(n,x){const {state:q,pixelRatio:B}=n,{size:y,rotation:u}=q,v=Math.round(y[0]*B),r=Math.round(y[1]*B);if(!q.spatialReference.isWrappable)return!1;n=E.toRadian(u);const z=Math.abs(Math.cos(n)),A=Math.abs(Math.sin(n)),C=Math.round(q.worldScreenWidth);if(Math.round(v*z+r*A)<=C)return!1;const F=(x.left-x.right)*B/v;x=(x.bottom-x.top)*B/r;g.set(this._worldDimensionsPx,C*B,v*A+r*z,1);g.set(this._pxToNdc,2/v,-2/r,1);g.set(this._centerNdc,F,x,1);x=this._mat3;
w.fromTranslation(x,this._centerNdc);w.scale(x,x,this._pxToNdc);0!==u&&w.rotate(x,x,n);w.scale(x,x,this._worldDimensionsPx);w.translate(x,x,c);return!0};return h._createClass(m)}();l.WorldExtentClipRenderer=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(l,h){h={shaders:{vertexShader:h.resolveIncludes("stencil/stencil.vert"),fragmentShader:h.resolveIncludes("stencil/stencil.frag")},
attributes:new Map([["a_pos",0]])};l.stencil=h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(l,h,D,E,w,t,p){p=function(g){function f(){var b=d.apply(this,arguments);b.defines=[];b._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",attributes:new Map([["a_position",
0]])};return b}h._inherits(f,g);var d=h._createSuper(f);g=f.prototype;g.dispose=function(){this._quad&&this._quad.dispose()};g.bind=function(){};g.unbind=function(){};g.draw=function(b,a){if(a?.size){var {context:e,renderingOptions:c}=b;this._quad||(this._quad=new t(e,[0,0,1,0,0,1,1,1]));var m=e.getBoundFramebufferObject(),{x:k,y:n,width:x,height:q}=e.getViewport();a.bindTextures(e);var B=a.getBlock(w.ATTRIBUTE_DATA_ANIMATION);if(!E.isNone(B)){var y=B.getFBO(e);B=B.getFBO(e,1);e.setViewport(0,0,a.size,
a.size);this._computeDelta(b,B,c.labelsAnimationTime);this._updateAnimationState(b,B,y);e.bindFramebuffer(m);e.setViewport(k,n,x,q)}}};g._computeDelta=function(b,a,e){const {context:c,painter:m,displayLevel:k}=b,n=m.materialManager.getProgram(this._desc,["delta"]);c.bindFramebuffer(a);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);c.useProgram(n);a=D("featurelayer-animation-enabled")?e:1;n.setUniform1i("u_maskTexture",w.TEXTURE_BINDING_ATTRIBUTE_DATA_0);n.setUniform1i("u_sourceTexture",w.TEXTURE_BINDING_ATTRIBUTE_DATA_1);
n.setUniform1f("u_timeDelta",b.deltaTime);n.setUniform1f("u_animationTime",a);n.setUniform1f("u_zoomLevel",Math.round(10*k));this._quad.draw()};g._updateAnimationState=function(b,a,e){const {context:c,painter:m}=b;b=m.materialManager.getProgram(this._desc,["update"]);c.bindTexture(a.colorTexture,1);c.useProgram(b);b.setUniform1i("u_sourceTexture",1);c.bindFramebuffer(e);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._quad.draw()};return h._createClass(f)}(p.Effect);l.AnimationEffect=
p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../enums ../VertexStream ../shaders/BlendPrograms ../../../../webgl/enums ../../../../webgl/Texture".split(" "),function(l,h,D,E,w,t,p,g,f,d){const b=E.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");E=function(){function a(){this._size=
[0,0]}var e=a.prototype;e.dispose=function(c){this._backBufferTexture=w.disposeMaybe(this._backBufferTexture);this._quad=w.disposeMaybe(this._quad)};e.draw=function(c,m,k,n,x){const {context:q,drawPhase:B}=c;this._setupShader(q);n&&"normal"!==n&&B!==t.WGLDrawPhase.LABEL?this._drawBlended(c,m,k,n,x):(c=g.createProgramTemplate("normal"),(c=q.programCache.acquire(c.shaders.vertexShader,c.shaders.fragmentShader,c.attributes))?(q.useProgram(c),m.setSamplingMode(k),q.bindTexture(m,0),c.setUniform1i("u_layerTexture",
0),c.setUniform1f("u_opacity",x),q.setBlendingEnabled(!0),q.setBlendFunction(f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA),m=this._quad,m.draw(),m.unbind(),c.dispose()):b.error(new D("mapview-BlendEffect",'Error creating shader program for blend mode "normal"')))};e._drawBlended=function(c,m,k,n,x){const {context:q,state:B,pixelRatio:y,inFadeTransition:u}=c;var {size:v}=B,r=q.getBoundFramebufferObject();let z;w.isSome(r)?(v=r.descriptor,z=v.width,v=v.height):(z=Math.round(y*v[0]),v=Math.round(y*
v[1]));this._createOrResizeTexture(c,z,v);c=this._backBufferTexture;r.copyToTexture(0,0,z,v,0,0,c);q.setStencilTestEnabled(!1);q.setStencilWriteMask(0);q.setBlendingEnabled(!0);q.setDepthTestEnabled(!1);q.setDepthWriteEnabled(!1);r=g.createProgramTemplate(n);(r=q.programCache.acquire(r.shaders.vertexShader,r.shaders.fragmentShader,r.attributes))?(q.useProgram(r),c.setSamplingMode(k),q.bindTexture(c,0),r.setUniform1i("u_backbufferTexture",0),m.setSamplingMode(k),q.bindTexture(m,1),r.setUniform1i("u_layerTexture",
1),r.setUniform1f("u_opacity",x),r.setUniform1f("u_inFadeOpacity",u?1:0),q.setBlendFunction(f.BlendFactor.ONE,f.BlendFactor.ZERO),m=this._quad,m.draw(),m.unbind(),r.dispose(),q.setBlendFunction(f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA)):b.error(new D("mapview-BlendEffect",`Error creating shader program for blend mode ${n}`))};e._setupShader=function(c){this._quad||(this._quad=new p(c,[-1,-1,1,-1,-1,1,1,1]))};e._createOrResizeTexture=function(c,m,k){({context:c}=c);if(null===this._backBufferTexture||
m!==this._size[0]||k!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(m,k):this._backBufferTexture=new d.Texture(c,{target:f.TextureType.TEXTURE_2D,pixelFormat:f.PixelFormat.RGBA,internalFormat:f.PixelFormat.RGBA,dataType:f.PixelType.UNSIGNED_BYTE,wrapMode:f.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:f.TextureSamplingMode.LINEAR,flipped:!1,width:m,height:k}),this._size[0]=m,this._size[1]=k};return h._createClass(a)}();l.BlendEffect=E;Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],function(l,h){l.createProgramTemplate=function(D){return{attributes:new Map([["a_pos",0],["a_tex",1]]),shaders:{vertexShader:`#define ${D.replace("-","_").toUpperCase()}\n`+h.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${D.replace("-","_").toUpperCase()}\n`+h.resolveIncludes("blend/blend.frag")}}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect","../../../../webgl/enums"],function(l,h,D,E){D=function(w){function t(g){var f=p.call(this);f.name=f.constructor.name;f.defines=[g];return f}h._inherits(t,w);var p=h._createSuper(t);w=t.prototype;w.dispose=function(){};w.bind=function({context:g,painter:f}){this._prev=g.getBoundFramebufferObject();const {width:d,height:b}=g.getViewport();f=f.getFbos(d,b).effect0;
g.bindFramebuffer(f);g.setColorMask(!0,!0,!0,!0);g.setClearColor(0,0,0,0);g.clear(g.gl.COLOR_BUFFER_BIT)};w.unbind=function(){};w.draw=function(g,f){const {context:d,painter:b}=g;f=b.getPostProcessingEffects(f);const a=d.getBoundFramebufferObject();for(const {postProcessingEffect:e,effect:c}of f)e.draw(g,a,c);d.bindFramebuffer(this._prev);d.setStencilTestEnabled(!1);b.blitTexture(d,a.colorTexture,E.TextureSamplingMode.NEAREST);d.setStencilTestEnabled(!0)};return h._createClass(t)}(D.Effect);l.FeatureEffect=
D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightRenderer ./highlight/HighlightSurfaces ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t,p){return function(g){function f(){var b=d.apply(this,arguments);b.defines=["highlight"];b._hlRenderer=new w;b._width=void 0;b._height=void 0;b._boundFBO=
null;b._hlSurfaces=new t;b._adjustedWidth=void 0;b._adjustedHeight=void 0;b._blitRenderer=new D.BitBlitRenderer;return b}l._inherits(f,g);var d=l._createSuper(f);g=f.prototype;g.dispose=function(){this._hlSurfaces?.dispose();this._hlRenderer?.dispose();this._boundFBO=null};g.bind=function(b){const {context:a,painter:e}=b,{width:c,height:m}=a.getViewport(),k=e.getFbos(c,m).effect0;this.setup(b,c,m);a.bindFramebuffer(k);a.setColorMask(!0,!0,!0,!0);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT)};
g.unbind=function(){};g.setup=function({context:b},a,e){this._width=a;this._height=e;const c=a%4,m=e%4;a+=2>c?-c:4-c;e+=2>m?-m:4-m;this._adjustedWidth=a;this._adjustedHeight=e;this._boundFBO=b.getBoundFramebufferObject();a=Math.round(1*a);e=Math.round(1*e);this._hlRenderer.setup(b,a,e);this._hlSurfaces.setup(b,a,e)};g.draw=function(b){const {context:a,highlightGradient:e}=b;e&&(b=a.getBoundFramebufferObject(),a.setViewport(0,0,1*this._adjustedWidth,1*this._adjustedHeight),a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),
a.setStencilTestEnabled(!1),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),this._blitRenderer.render(a,b.colorTexture,p.TextureSamplingMode.NEAREST,1),a.setStencilTestEnabled(!1),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!0),a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex),a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo),a.setClearColor(0,0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT),
this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex),a.bindFramebuffer(this._boundFBO),a.setBlendingEnabled(!0),a.setColorMask(!0,!0,!0,!0),a.setViewport(0,0,this._width,this._height),this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,e),this._boundFBO=null)};return l._createClass(f)}(E.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../definitions ./parameters ../../shaders/HighlightPrograms ../../../../../webgl/BufferObject ../../../../../webgl/enums ../../../../../webgl/ProgramTemplate ../../../../../webgl/VertexArrayObject ../../../../../webgl/VertexElementDescriptor".split(" "),
function(l,h,D,E,w,t,p,g,f){return function(){function d(){this._height=this._width=void 0;this._resources=null}var b=d.prototype;b.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};b.preBlur=function(a,e){a.bindTexture(e,h.TEXTURE_BINDING_HIGHLIGHT_0);a.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",D.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,4);a.bindVAO()};b.finalBlur=function(a,e){a.bindTexture(e,h.TEXTURE_BINDING_HIGHLIGHT_0);a.useProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",D.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,4);a.bindVAO()};b.renderHighlight=function(a,e,c){a.bindTexture(e,h.TEXTURE_BINDING_HIGHLIGHT_0);a.useProgram(this._resources.highlightProgram);c.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA);a.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,4);a.bindVAO()};b._initialize=function(a,
e,c){this._width=e;this._height=c;e=w.BufferObject.createVertex(a,t.Usage.STATIC_DRAW,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);c=new g.VertexArrayObject(a,new Map([["a_position",0],["a_texcoord",1]]),{geometry:[new f.VertexElementDescriptor("a_position",2,t.DataType.BYTE,0,4),new f.VertexElementDescriptor("a_texcoord",2,t.DataType.UNSIGNED_BYTE,2,4)]},{geometry:e});const m=p.createProgram(a,E.highlight),k=p.createProgram(a,E.blur);a.useProgram(m);m.setUniform1i("u_texture",h.TEXTURE_BINDING_HIGHLIGHT_0);
m.setUniform1i("u_shade",h.TEXTURE_BINDING_HIGHLIGHT_1);m.setUniform1f("u_sigma",D.SIGMA);a.useProgram(k);k.setUniform1i("u_texture",h.TEXTURE_BINDING_HIGHLIGHT_0);k.setUniform1f("u_sigma",D.SIGMA);this._resources={quadGeometry:e,quadVAO:c,highlightProgram:m,blurProgram:k}};b.setup=function(a,e,c){this._resources?(this._width=e,this._height=c):this._initialize(a,e,c)};return l._createClass(d)}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],
function(l,h){const D={shaders:{vertexShader:h.resolveIncludes("highlight/textured.vert"),fragmentShader:h.resolveIncludes("highlight/highlight.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};h={shaders:{vertexShader:h.resolveIncludes("highlight/textured.vert"),fragmentShader:h.resolveIncludes("highlight/blur.frag")},attributes:new Map([["a_position",0],["a_texcoord",1]])};l.blur=h;l.highlight=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../../core/maybe","../../../../../webgl/enums","../../../../../webgl/FramebufferObject","../../../../../webgl/Texture"],function(l,h,D,E,w){function t(p,g,f){g=new w.Texture(p,{target:D.TextureType.TEXTURE_2D,pixelFormat:D.PixelFormat.RGBA,dataType:D.PixelType.UNSIGNED_BYTE,wrapMode:D.TextureWrapMode.CLAMP_TO_EDGE,width:g,height:f,samplingMode:D.TextureSamplingMode.LINEAR});p=new E.FramebufferObject(p,{colorTarget:D.TargetType.TEXTURE,depthStencilTarget:D.DepthStencilTargetType.STENCIL_RENDER_BUFFER},
g);return[g,p]}return function(){function p(){this._height=this._width=void 0;this._resources=null}var g=p.prototype;g.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=h.nullifyNonNullableForDispose(this._resources))};g._initialize=function(f,d,b){this._width=d;this._height=b;const [a,e]=t(f,d,b),[c,m]=t(f,d,b);this._resources={sharedBlur1Tex:a,
sharedBlur1Fbo:e,sharedBlur2Tex:c,sharedBlur2Fbo:m}};g.setup=function(f,d,b){!this._resources||this._width===d&&this._height===b||this.dispose();this._resources||this._initialize(f,d,b)};l._createClass(p,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);
return p}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t){w=function(p){function g(){var d=f.apply(this,arguments);d.name=d.constructor.name;d.defines=["hittest"];return d}h._inherits(g,p);var f=h._createSuper(g);p=g.prototype;p.dispose=function(){D.isSome(this._fbo)&&this._fbo.dispose()};p.createOptions=function({pixelRatio:d},
b,a=E.HITTEST_RADIUS){if(!b.length)return null;b=b.shift();const e=b.x,c=b.y;this._outstanding=b;return{type:"hittest",distance:a*d,position:[e,c]}};p.bind=function(d){const {context:b,attributeView:a}=d;a.size&&(d=a.getBlock(E.ATTRIBUTE_DATA_GPGPU),D.isNone(d)||(d=d.getFBO(b),b.setViewport(0,0,a.size,a.size),b.bindFramebuffer(d),b.setColorMask(!0,!0,!0,!0),b.setClearColor(0,0,0,0),b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT)))};p.unbind=function(d){};p.draw=function(d){if(!D.isNone(this._outstanding)){var b=
this._outstanding;this._outstanding=null;this._resolve(d,b.resolvers)}};p._resolve=async function(d,b){const {context:a,attributeView:e}=d;d=e.getBlock(E.ATTRIBUTE_DATA_GPGPU);if(D.isNone(d))b.forEach(k=>k.resolve([]));else{var c=d.getFBO(a);d=new Uint8Array(c.width*c.height*4);try{await c.readPixelsAsync(0,0,c.width,c.height,t.PixelFormat.RGBA,t.PixelType.UNSIGNED_BYTE,d)}catch(k){b.forEach(n=>n.resolve([]));return}c=[];for(let k=0;k<d.length;k+=4){const n=d[k+3];d[k]&&c.push({id:k/4,directHits:n})}c.sort((k,
n)=>n.directHits===k.directHits?n.id-k.id:n.directHits-k.directHits);var m=c.map(k=>k.id);b.forEach(k=>k.resolve(m))}};return h._createClass(g)}(w.Effect);l.HittestEffect=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/HittestEffectVTL":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ./Effect ../../../../webgl/enums".split(" "),function(l,h,D,E,w,t){w=function(p){function g(){var d=
f.apply(this,arguments);d.name=d.constructor.name;d.defines=["id"];d._lastSize=0;d._boundFBO=null;return d}h._inherits(g,p);var f=h._createSuper(g);p=g.prototype;p.dispose=function(){D.isSome(this._fbo)&&this._fbo.dispose()};p.bind=function({context:d,painter:b}){const {width:a,height:e}=d.getViewport();this._boundFBO=d.getBoundFramebufferObject();b=b.getFbos(a,e).effect0;d.bindFramebuffer(b);d.setColorMask(!0,!0,!0,!0);d.setClearColor(0,0,0,0);d.clear(d.gl.COLOR_BUFFER_BIT)};p.unbind=function({context:d}){d.bindFramebuffer(this._boundFBO);
this._boundFBO=null};p.draw=function(d,b,a=2*E.HITTEST_RADIUS){this._resolve(d,b,a)};p._resolve=async function({context:d,state:b,pixelRatio:a},e,c){const m=d.getBoundFramebufferObject(),k=b.size[1]*a,n=Math.round(c*a),x=n/2,q=n/2;this._ensureBuffer(n);e.forEach(async(B,y)=>{var u=new Map;await m.readPixelsAsync(Math.floor(y.x*a-n/2),Math.floor(k-y.y*a-n/2),n,n,t.PixelFormat.RGBA,t.PixelType.UNSIGNED_BYTE,this._buf);for(let z=0;z<this._buf32.length;z++){const A=this._buf32[z];if(4294967295!==A&&0!==
A){var v=z%n,r=n-Math.floor(z/n);v=(x-v)*(x-v)+(q-r)*(q-r);r=u.has(A)?u.get(A):4294967295;u.set(A,Math.min(v,r))}}u=Array.from(u).sort((z,A)=>z[1]-A[1]).map(z=>z[0]);B.resolve(u);e.delete(y)})};p._ensureBuffer=function(d){this._lastSize!==d&&(this._lastSize=d,this._buf=new Uint8Array(4*d*d),this._buf32=new Uint32Array(this._buf.buffer))};return h._createClass(g)}(w.Effect);l.HittestEffectVTL=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ./Bloom ./Blur ./Colorize ./DropShadow ./Opacity".split(" "),
function(l,h,D,E,w,t,p){const g={colorize:()=>new w.Colorize,blur:()=>new E.Blur,bloom:()=>new D.Bloom,opacity:()=>new p.Opacity,"drop-shadow":()=>new t.DropShadow};let f=function(){function d(){this._effectMap=new Map}var b=d.prototype;b.dispose=function(){this._effectMap.forEach(a=>a.dispose());this._effectMap.clear()};b.getPostProcessingEffects=function(a){if(!a||0===a.length)return[];const e=[];for(const c of a){a:switch(a=c.type,a){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;
default:a="colorize"}let m=this._effectMap.get(a);m||(m=g[a](),this._effectMap.set(a,m));e.push({postProcessingEffect:m,effect:c})}return e};return h._createClass(d)}();l.EffectManager=f;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/Bloom":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/FramebufferObject".split(" "),
function(l,h,D,E,w,t){const p=[1,0],g=[0,1],f=[1,.8,.6,.4,.2],d=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];let b=function(){function a(){this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=5;this._kernelSizeArray=[3,5,7,9,11];this._size=[0,0];this._programDesc={luminosityHighPass:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/luminosityHighPass",attributes:new Map([["a_position",0]])},gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/gaussianBlur",
attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/bloom/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var e=a.prototype;e.dispose=function(){this._quad=D.disposeMaybe(this._quad);this._intensityFBO=D.disposeMaybe(this._intensityFBO);this._compositeFBO=D.disposeMaybe(this._compositeFBO);if(this._mipsFBOs){for(let c=0;c<this._nMips;c++)this._mipsFBOs[c]&&
(this._mipsFBOs[c].horizontal.dispose(),this._mipsFBOs[c].vertical.dispose());this._mipsFBOs=null}};e.draw=function(c,m,k){const {width:n,height:x}=m,{context:q,painter:B}=c,{materialManager:y}=B;var u=q.gl;const v=this._programDesc,{strength:r,radius:z,threshold:A}=k;this._quad||(this._quad=new E(q,[-1,-1,1,-1,-1,1,1,1]));this._createOrResizeResources(c,n,x);q.setStencilTestEnabled(!1);q.setBlendingEnabled(!0);q.setBlendFunction(w.BlendFactor.ONE,w.BlendFactor.ONE_MINUS_SRC_ALPHA);q.setStencilWriteMask(0);
c=this._quad;c.bind();q.bindFramebuffer(this._intensityFBO);k=y.getProgram(v.luminosityHighPass);q.useProgram(k);q.bindTexture(m.colorTexture,0);k.setUniform1i("u_texture",0);k.setUniform3fv("u_defaultColor",[0,0,0]);k.setUniform1f("u_defaultOpacity",0);k.setUniform1f("u_luminosityThreshold",A);k.setUniform1f("u_smoothWidth",.01);k=[Math.round(n/2),Math.round(x/2)];q.setViewport(0,0,k[0],k[1]);q.setClearColor(0,0,0,0);q.clear(u.COLOR_BUFFER_BIT);c.draw();q.setBlendingEnabled(!1);u=this._intensityFBO.colorTexture;
for(let C=0;C<this._nMips;C++){const F=y.getProgram(v.gaussianBlur,[{name:"radius",value:this._kernelSizeArray[C]}]);q.useProgram(F);q.bindTexture(u,C+1);F.setUniform1i("u_colorTexture",C+1);F.setUniform2fv("u_texSize",k);F.setUniform2fv("u_direction",p);q.setViewport(0,0,k[0],k[1]);const G=this._mipsFBOs[C];q.bindFramebuffer(G.horizontal);c.draw();u=G.horizontal.colorTexture;q.bindFramebuffer(G.vertical);q.bindTexture(u,C+1);F.setUniform2fv("u_direction",g);c.draw();u=G.vertical.colorTexture;k[0]=
Math.round(k[0]/2);k[1]=Math.round(k[1]/2)}q.setViewport(0,0,n,x);k=y.getProgram(v.composite,[{name:"nummips",value:5}]);q.bindFramebuffer(this._compositeFBO);q.useProgram(k);k.setUniform1f("u_bloomStrength",r);k.setUniform1f("u_bloomRadius",z);k.setUniform1fv("u_bloomFactors",f);k.setUniform3fv("u_bloomTintColors",d);q.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);k.setUniform1i("u_blurTexture1",1);q.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);k.setUniform1i("u_blurTexture2",
2);q.bindTexture(this._mipsFBOs[2].vertical.colorTexture,3);k.setUniform1i("u_blurTexture3",3);q.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);k.setUniform1i("u_blurTexture4",4);q.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5);k.setUniform1i("u_blurTexture5",5);c.draw();q.bindFramebuffer(m);q.setBlendingEnabled(!0);m=y.getProgram(v.blit);q.useProgram(m);q.bindTexture(this._compositeFBO.colorTexture,6);m.setUniform1i("u_texture",6);q.setBlendFunction(w.BlendFactor.ONE,w.BlendFactor.ONE);
c.draw();c.unbind();q.setBlendFunction(w.BlendFactor.ONE,w.BlendFactor.ONE_MINUS_SRC_ALPHA);q.setStencilTestEnabled(!0)};e._createOrResizeResources=function(c,m,k){({context:c}=c);if(!this._compositeFBO||this._size[0]!==m||this._size[1]!==k){this._size[0]=m;this._size[1]=k;var n=[Math.round(m/2),Math.round(k/2)];this._compositeFBO?this._compositeFBO.resize(m,k):this._compositeFBO=new t.FramebufferObject(c,{colorTarget:w.TargetType.TEXTURE,depthStencilTarget:w.DepthStencilTargetType.NONE,width:m,height:k});
this._intensityFBO?this._intensityFBO.resize(n[0],n[1]):this._intensityFBO=new t.FramebufferObject(c,{colorTarget:w.TargetType.TEXTURE,depthStencilTarget:w.DepthStencilTargetType.NONE,width:n[0],height:n[1]},{target:w.TextureType.TEXTURE_2D,pixelFormat:w.PixelFormat.RGBA,internalFormat:w.PixelFormat.RGBA,dataType:w.PixelType.UNSIGNED_BYTE,wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:w.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]});for(m=0;m<this._nMips;m++)this._mipsFBOs[m]?
(this._mipsFBOs[m].horizontal.resize(n[0],n[1]),this._mipsFBOs[m].vertical.resize(n[0],n[1])):this._mipsFBOs[m]={horizontal:new t.FramebufferObject(c,{colorTarget:w.TargetType.TEXTURE,depthStencilTarget:w.DepthStencilTargetType.NONE,width:n[0],height:n[1]},{target:w.TextureType.TEXTURE_2D,pixelFormat:w.PixelFormat.RGBA,internalFormat:w.PixelFormat.RGBA,dataType:w.PixelType.UNSIGNED_BYTE,wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:w.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]}),
vertical:new t.FramebufferObject(c,{colorTarget:w.TargetType.TEXTURE,depthStencilTarget:w.DepthStencilTargetType.NONE,width:n[0],height:n[1]},{target:w.TextureType.TEXTURE_2D,pixelFormat:w.PixelFormat.RGBA,internalFormat:w.PixelFormat.RGBA,dataType:w.PixelType.UNSIGNED_BYTE,wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:w.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]})},n[0]=Math.round(n[0]/2),n[1]=Math.round(n[1]/2)}};return h._createClass(a)}();l.Bloom=b;Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/Blur":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../VertexStream","../../../../../webgl/enums","../../../../../webgl/FramebufferObject"],function(l,h,D,E,w){const t=[1,0],p=[0,1];let g=function(){function f(){this._blurFBO=null;this._size=[0,0];this._programDesc={gaussianBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",
0]])},radialBlur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/radial-blur",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var d=f.prototype;d.dispose=function(){this._blurFBO&&(this._blurFBO.dispose(),this._blurFBO=null)};d.draw=function(b,a,e){const {context:c}=b,{type:m,radius:k}=e;0!==k&&(this._createOrResizeResources(b),this._quad||(this._quad=new D(c,[-1,-1,1,-1,-1,1,1,1])),e=this._quad,
e.bind(),"blur"===m?this._gaussianBlur(b,a,k):this._radialBlur(b,a),e.unbind())};d._gaussianBlur=function(b,a,e){const {context:c,state:m,painter:k,pixelRatio:n}=b;var {size:x}=m,{materialManager:q}=k;b=this._quad;x=[Math.round(n*x[0]),Math.round(n*x[1])];const B=this._blurFBO;q=q.getProgram(this._programDesc.gaussianBlur,[{name:"radius",value:Math.ceil(e)}]);c.useProgram(q);c.setBlendingEnabled(!1);c.bindFramebuffer(B);c.bindTexture(a.colorTexture,4);q.setUniform1i("u_colorTexture",4);q.setUniform2fv("u_texSize",
x);q.setUniform2fv("u_direction",t);q.setUniform1f("u_sigma",e);b.draw();c.bindFramebuffer(a);c.setStencilWriteMask(0);c.setStencilTestEnabled(!1);c.setDepthWriteEnabled(!1);c.setDepthTestEnabled(!1);c.bindTexture(B?.colorTexture,5);q.setUniform1i("u_colorTexture",5);q.setUniform2fv("u_direction",p);b.draw();c.setBlendingEnabled(!0);c.setBlendFunction(E.BlendFactor.ONE,E.BlendFactor.ONE_MINUS_SRC_ALPHA);c.setStencilTestEnabled(!0)};d._radialBlur=function(b,a){const {context:e,painter:c}=b,{materialManager:m}=
c,k=this._programDesc;b=this._quad;const n=this._blurFBO;e.bindFramebuffer(n);const x=m.getProgram(k.radialBlur);e.useProgram(x);e.setBlendingEnabled(!1);e.bindTexture(a.colorTexture,4);x.setUniform1i("u_colorTexture",4);b.draw();e.bindFramebuffer(a);e.setStencilWriteMask(0);e.setStencilTestEnabled(!1);e.setDepthWriteEnabled(!1);e.setDepthTestEnabled(!1);e.setBlendingEnabled(!0);a=m.getProgram(k.blit);e.useProgram(a);e.bindTexture(n?.colorTexture,5);a.setUniform1i("u_texture",5);e.setBlendFunction(E.BlendFactor.ONE,
E.BlendFactor.ONE_MINUS_SRC_ALPHA);b.draw()};d._createOrResizeResources=function(b){const {context:a,state:e,pixelRatio:c}=b;var {size:m}=e;b=Math.round(c*m[0]);m=Math.round(c*m[1]);this._blurFBO&&this._size[0]===b&&this._size[1]===m||(this._size[0]=b,this._size[1]=m,this._blurFBO?this._blurFBO.resize(b,m):this._blurFBO=new w.FramebufferObject(a,{colorTarget:E.TargetType.TEXTURE,depthStencilTarget:E.DepthStencilTargetType.NONE,width:b,height:m},{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,
internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.LINEAR,flipped:!1,width:b,height:m}))};return h._createClass(f)}();l.Blur=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/Colorize":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/Texture".split(" "),
function(l,h,D,E,w,t){let p=function(){function g(){this._layerFBOTexture=null;this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}var f=g.prototype;f.dispose=function(){this._layerFBOTexture=D.disposeMaybe(this._layerFBOTexture)};f.draw=function(d,b,a){const {width:e,height:c}=b;this._createOrResizeResources(d,e,c);const {context:m,painter:k}=d,{materialManager:n}=k,x=this._programDesc;d=this._quad;a=a.colorMatrix;
d.bind();const q=this._layerFBOTexture;m.bindFramebuffer(b);b.copyToTexture(0,0,e,c,0,0,q);m.setBlendingEnabled(!1);m.setStencilTestEnabled(!1);b=n.getProgram(x);m.useProgram(b);m.bindTexture(q,2);b.setUniformMatrix4fv("u_coefficients",a);b.setUniform1i("u_colorTexture",2);d.draw();m.setBlendingEnabled(!0);m.setBlendFunction(w.BlendFactor.ONE,w.BlendFactor.ONE_MINUS_SRC_ALPHA);m.setStencilTestEnabled(!0);d.unbind()};f._createOrResizeResources=function(d,b,a){({context:d}=d);this._layerFBOTexture&&
this._size[0]===b&&this._size[1]===a||(this._size[0]=b,this._size[1]=a,this._layerFBOTexture?this._layerFBOTexture.resize(b,a):this._layerFBOTexture=new t.Texture(d,{target:w.TextureType.TEXTURE_2D,pixelFormat:w.PixelFormat.RGBA,internalFormat:w.PixelFormat.RGBA,dataType:w.PixelType.UNSIGNED_BYTE,wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:w.TextureSamplingMode.LINEAR,flipped:!1,width:b,height:a}),this._quad||(this._quad=new E(d,[-1,-1,1,-1,-1,1,1,1])))};return h._createClass(g)}();l.Colorize=
p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/DropShadow":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/FramebufferObject ../../../../../webgl/Texture".split(" "),function(l,h,D,E,w,t,p,g){const f=[1,0],d=[0,1];let b=function(){function a(){this._verticalBlurFBO=this._horizontalBlurFBO=
this._layerFBOTexture=null;this._size=[0,0];this._quad=null;this._programDesc={blur:{vsPath:"post-processing/pp",fsPath:"post-processing/blur/gaussianBlur",attributes:new Map([["a_position",0]])},composite:{vsPath:"post-processing/pp",fsPath:"post-processing/drop-shadow/composite",attributes:new Map([["a_position",0]])},blit:{vsPath:"post-processing/pp",fsPath:"post-processing/blit",attributes:new Map([["a_position",0]])}}}var e=a.prototype;e.dispose=function(){this._layerFBOTexture=D.disposeMaybe(this._layerFBOTexture);
this._horizontalBlurFBO=D.disposeMaybe(this._horizontalBlurFBO);this._verticalBlurFBO=D.disposeMaybe(this._verticalBlurFBO)};e.draw=function(c,m,k){const {context:n,state:x,painter:q}=c,{materialManager:B}=q,y=this._programDesc,u=m.width,v=m.height,r=[Math.round(u),Math.round(v)],{blurRadius:z,offsetX:A,offsetY:C,color:F}=k;k=[E.pt2px(A),E.pt2px(C)];this._createOrResizeResources(c,u,v,r);const G=this._horizontalBlurFBO;c=this._verticalBlurFBO;n.setStencilWriteMask(0);n.setStencilTestEnabled(!1);n.setDepthWriteEnabled(!1);
n.setDepthTestEnabled(!1);const H=this._layerFBOTexture;m.copyToTexture(0,0,u,v,0,0,H);this._quad||(this._quad=new w(n,[-1,-1,1,-1,-1,1,1,1]));n.setViewport(0,0,r[0],r[1]);const K=this._quad;K.bind();n.setBlendingEnabled(!1);const J=B.getProgram(y.blur,[{name:"radius",value:Math.ceil(z)}]);n.useProgram(J);n.bindFramebuffer(G);n.bindTexture(m.colorTexture,4);J.setUniform1i("u_colorTexture",4);J.setUniform2fv("u_texSize",r);J.setUniform2fv("u_direction",f);J.setUniform1f("u_sigma",z);K.draw();n.bindFramebuffer(c);
n.bindTexture(G?.colorTexture,5);J.setUniform1i("u_colorTexture",5);J.setUniform2fv("u_direction",d);K.draw();n.bindFramebuffer(m);n.setViewport(0,0,u,v);m=B.getProgram(y.composite);n.useProgram(m);n.bindTexture(c?.colorTexture,2);m.setUniform1i("u_blurTexture",2);n.bindTexture(H,3);m.setUniform1i("u_layerFBOTexture",3);m.setUniform4fv("u_shadowColor",[F[0]/255*F[3],F[1]/255*F[3],F[2]/255*F[3],F[3]]);m.setUniformMatrix3fv("u_displayViewMat3",x.displayMat3);m.setUniform2fv("u_shadowOffset",k);K.draw();
n.setBlendingEnabled(!0);n.setStencilTestEnabled(!0);n.setBlendFunction(t.BlendFactor.ONE,t.BlendFactor.ONE_MINUS_SRC_ALPHA);K.unbind()};e._createOrResizeResources=function(c,m,k,n){({context:c}=c);this._horizontalBlurFBO&&this._size[0]===m&&this._size[1]===k||(this._size[0]=m,this._size[1]=k,this._horizontalBlurFBO?this._horizontalBlurFBO.resize(n[0],n[1]):this._horizontalBlurFBO=new p.FramebufferObject(c,{colorTarget:t.TargetType.TEXTURE,depthStencilTarget:t.DepthStencilTargetType.NONE,width:n[0],
height:n[1]},{target:t.TextureType.TEXTURE_2D,pixelFormat:t.PixelFormat.RGBA,internalFormat:t.PixelFormat.RGBA,dataType:t.PixelType.UNSIGNED_BYTE,wrapMode:t.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:t.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]}),this._verticalBlurFBO?this._verticalBlurFBO.resize(n[0],n[1]):this._verticalBlurFBO=new p.FramebufferObject(c,{colorTarget:t.TargetType.TEXTURE,depthStencilTarget:t.DepthStencilTargetType.NONE,width:n[0],height:n[1]},{target:t.TextureType.TEXTURE_2D,
pixelFormat:t.PixelFormat.RGBA,internalFormat:t.PixelFormat.RGBA,dataType:t.PixelType.UNSIGNED_BYTE,wrapMode:t.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:t.TextureSamplingMode.LINEAR,flipped:!1,width:n[0],height:n[1]}),this._layerFBOTexture?this._layerFBOTexture.resize(m,k):this._layerFBOTexture=new g.Texture(c,{target:t.TextureType.TEXTURE_2D,pixelFormat:t.PixelFormat.RGBA,internalFormat:t.PixelFormat.RGBA,dataType:t.PixelType.UNSIGNED_BYTE,wrapMode:t.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:t.TextureSamplingMode.LINEAR,
flipped:!1,width:m,height:k}))};return h._createClass(a)}();l.DropShadow=b;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/effects/post-processing/Opacity":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","../../../../../webgl/enums","../../../../../webgl/Texture"],function(l,h,D,E,w){let t=function(){function p(){this._size=[0,0];this._layerFBOTexture=null}var g=p.prototype;g.dispose=function(){this._layerFBOTexture=
D.disposeMaybe(this._layerFBOTexture)};g.draw=function(f,d,b){const {width:a,height:e}=d;this._createOrResizeResources(f,a,e);const {context:c,painter:m}=f;({amount:f}=b);b=c.gl;const k=this._layerFBOTexture;c.bindFramebuffer(d);d.copyToTexture(0,0,a,e,0,0,k);c.setBlendingEnabled(!0);c.setStencilTestEnabled(!1);c.setDepthTestEnabled(!1);c.setClearColor(0,0,0,0);c.clear(b.COLOR_BUFFER_BIT);m.blitTexture(c,k,E.TextureSamplingMode.NEAREST,f)};g._createOrResizeResources=function(f,d,b){({context:f}=f);
this._layerFBOTexture&&this._size[0]===d&&this._size[1]===b||(this._size[0]=d,this._size[1]=b,this._layerFBOTexture?this._layerFBOTexture.resize(d,b):this._layerFBOTexture=new w.Texture(f,{target:E.TextureType.TEXTURE_2D,pixelFormat:E.PixelFormat.RGBA,internalFormat:E.PixelFormat.RGBA,dataType:E.PixelType.UNSIGNED_BYTE,wrapMode:E.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:E.TextureSamplingMode.NEAREST,flipped:!1,width:d,height:b}))};return h._createClass(p)}();l.Opacity=t;Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/arrayUtils","../../../../../core/maybe","../enums"],function(l,h,D,E){return function(){function w(p,g){this.brushes=p;this.name=g.name;this.drawPhase=g.drawPhase||E.WGLDrawPhase.MAP;this._targetFn=g.target;this.effects=g.effects||[];this.enableDefaultDraw=g.enableDefaultDraw??(()=>!0)}var t=w.prototype;t.render=function(p){const {context:g,
profiler:f}=p,d=this._targetFn();var b=this.drawPhase&p.drawPhase;f.recordPassStart(this.name);if(b){this.enableDefaultDraw()&&this._doRender(p,d);f.recordPassEnd();for(const a of this.effects){if(!a.enable())continue;b=a.apply;const e=a.args&&a.args(),c=g.getViewport(),m=g.getBoundFramebufferObject(),k=p.passOptions;this._bindEffect(p,b,e);this._doRender(p,d,b.defines);this._drawAndUnbindEffect(p,b,c,m,k,e)}}};t._doRender=function(p,g,f){if(!D.isNone(g)){var {profiler:d,context:b}=p;for(const a of this.brushes){d.recordBrushStart(a.name);
if(D.isSome(a.brushEffect)){const e=b.getViewport(),c=b.getBoundFramebufferObject(),m=p.passOptions;this._bindEffect(p,a.brushEffect);this._drawWithBrush(a,p,g,f);this._drawAndUnbindEffect(p,a.brushEffect,e,c,m)}else this._drawWithBrush(a,p,g,f);d.recordBrushEnd()}}};t._drawWithBrush=function(p,g,f,d){h.isArrayLike(f)?(p.prepareState(g,d),p.drawMany(g,f,d)):f.visible&&(p.prepareState(g,d),p.draw(g,f,d))};t._bindEffect=function(p,g,f){const {profiler:d}=p;d.recordPassStart(this.name+"."+g.name);g.bind(p,
f);g=g.createOptions(p,f);p.passOptions=g};t._drawAndUnbindEffect=function(p,g,f,d,b,a){const {profiler:e,context:c}=p;p.passOptions=b;e.recordBrushStart(g.name);g.draw(p,a);g.unbind(p,a);c.bindFramebuffer(d);const {x:m,y:k,width:n,height:x}=f;c.setViewport(m,k,n,x);e.recordBrushEnd();e.recordPassEnd()};return l._createClass(w)}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),
function(l,h,D,E,w,t,p){const g=w("esri-2d-profiler");w=function(){function f(b,a){this._events=new E;this._entries=new Map;this._timings=new D(10);this._currentSummary=this._currentBrush=this._currentPass=this._currentContainer=null;if(g){this._ext=p.createDisjointTimerQuery(b.gl,{});this._debugOutput=a;var e=b.gl;if(this.enableCommandLogging)for(const c in e)if("function"===typeof e[c]){const m=e[c],k=c.includes("draw");e[c]=(...n)=>{this._events.emit("command",{container:this._currentContainer,
pass:this._currentPass,brush:this._currentBrush,method:c,args:n,isDrawCommand:k});this._currentSummary&&(this._currentSummary.commands++,k&&this._currentSummary.drawCommands++);return m.apply(e,n)}}}}var d=f.prototype;d.recordContainerStart=function(b){g&&(this._currentContainer=b)};d.recordContainerEnd=function(){g&&(this._currentContainer=null)};d.recordPassStart=function(b){g&&(this._currentPass=b,this._initSummary())};d.recordPassEnd=function(){g&&(this._currentPass=null,this._emitSummary())};
d.recordBrushStart=function(b){g&&(this._currentBrush=b)};d.recordBrushEnd=function(){g&&(this._currentBrush=null)};d.recordStart=function(b){if(g&&t.isSome(this._ext)){if(this._entries.has(b)){const k=this._entries.get(b);var a=this._ext.resultAvailable(k.query),e=this._ext.disjoint();if(a&&!e){a=this._ext.getResult(k.query)/1E6;e=0;if(t.isSome(this._timings.enqueue(a))){e=this._timings.entries;const n=e.length;let x=0;for(var c of e)x+=c;e=x/n}c=a.toFixed(2);a=e?e.toFixed(2):"--";this.enableCommandLogging?
(console.groupCollapsed(`Frame report for ${b}, ${c} ms (${a} last 10 avg)\n${k.commandsLen} Commands (${k.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(k.summaries),console.log("Commands: ",k.commands),console.groupEnd()):console.log(`Frame report for ${b}, ${c} ms (${a} last 10 avg)`);this._debugOutput.innerHTML=`${c} (${a})`}for(const n of k.handles)n.remove();this._ext.deleteQuery(k.query);this._entries.delete(b)}const m={name:b,query:this._ext.createQuery(),commands:[],
commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(m.handles.push(this._events.on("command",k=>{m.commandsLen++;m.commands.push(k);k.isDrawCommand&&m.drawCommands++})),m.handles.push(this._events.on("summary",k=>{m.summaries.push(k)})));this._ext.beginTimeElapsed(m.query);this._entries.set(b,m)}};d.recordEnd=function(b){g&&t.isSome(this._ext)&&this._entries.has(b)&&this._ext.endTimeElapsed()};d._initSummary=function(){this.enableCommandLogging&&(this._currentSummary=
{container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};d._emitSummary=function(){this.enableCommandLogging&&this._currentSummary&&this._events.emit("summary",this._currentSummary)};h._createClass(f,[{key:"enableCommandLogging",get:function(){return!("object"===typeof g&&g.disableCommands)}}]);return f}();l.Profiler=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],
function(l,h){return function(){function D(w){this._start=this.size=0;this.maxSize=w;this._buffer=Array(w)}var E=D.prototype;E.enqueue=function(w){if(this.size===this.maxSize){const t=this._buffer[this._start];this._buffer[this._start]=w;this._start=(this._start+1)%this.maxSize;return t}this._buffer[(this._start+this.size++)%this.maxSize]=w;return null};E.dequeue=function(){if(0===this.size)return null;const w=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+
1)%this.maxSize;return w};E.peek=function(){return 0===this.size?null:this._buffer[this._start]};E.find=function(w){if(0===this.size)return null;for(const t of this._buffer)if(h.isSome(t)&&w(t))return t;return null};E.clear=function(w){let t=this.dequeue();for(;h.isSome(t);)w&&w(t),t=this.dequeue()};l._createClass(D,[{key:"entries",get:function(){return this._buffer}}]);return D}()})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers",
"./isWebGL2Context"],function(l,h,D){let E=h._createClass(function(w,t,p,g,f,d,b,a,e){this.createQuery=w;this.deleteQuery=t;this.resultAvailable=p;this.getResult=g;this.disjoint=f;this.beginTimeElapsed=d;this.endTimeElapsed=b;this.createTimestamp=a;this.timestampBits=e});l.hasRunningElapsedTimer=!1;l.DisjointTimerQuery=E;l.createDisjointTimerQuery=function(w,t){if(t.disjointTimerQuery)return null;let p=w.getExtension("EXT_disjoint_timer_query_webgl2");return p&&D(w)?new E(()=>w.createQuery(),g=>{w.deleteQuery(g);
l.hasRunningElapsedTimer=!1},g=>w.getQueryParameter(g,w.QUERY_RESULT_AVAILABLE),g=>w.getQueryParameter(g,w.QUERY_RESULT),()=>w.getParameter(p.GPU_DISJOINT_EXT),g=>{l.hasRunningElapsedTimer||(l.hasRunningElapsedTimer=!0,w.beginQuery(p.TIME_ELAPSED_EXT,g))},()=>{w.endQuery(p.TIME_ELAPSED_EXT);l.hasRunningElapsedTimer=!1},g=>p.queryCounterEXT(g,p.TIMESTAMP_EXT),()=>w.getQuery(p.TIMESTAMP_EXT,p.QUERY_COUNTER_BITS_EXT)):(p=w.getExtension("EXT_disjoint_timer_query"))?new E(()=>p.createQueryEXT(),g=>{p.deleteQueryEXT(g);
l.hasRunningElapsedTimer=!1},g=>p.getQueryObjectEXT(g,p.QUERY_RESULT_AVAILABLE_EXT),g=>p.getQueryObjectEXT(g,p.QUERY_RESULT_EXT),()=>w.getParameter(p.GPU_DISJOINT_EXT),g=>{l.hasRunningElapsedTimer||(l.hasRunningElapsedTimer=!0,p.beginQueryEXT(p.TIME_ELAPSED_EXT,g))},()=>{p.endQueryEXT(p.TIME_ELAPSED_EXT);l.hasRunningElapsedTimer=!1},g=>p.queryCounterEXT(g,p.TIMESTAMP_EXT),()=>p.getQueryEXT(p.TIMESTAMP_EXT,p.QUERY_COUNTER_BITS_EXT)):null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/views/webgl/capabilities/isWebGL2Context":function(){define(function(){return function(l){return window.WebGL2RenderingContext&&l instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/RenderingContext":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ../../core/promiseUtils ../../core/time ./checkWebGLError ./context-util ./ContextState ./enums ./InstanceCounter ./ProgramCache ./renderState ./Texture ./Util ./WebGLDriverTest ./capabilities/Capabilities ./capabilities/isWebGL2Context".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n){function x(y,u,v,r){u?r!==u&&y.bindBuffer(v,u.glName):y.bindBuffer(v,null);return u}function q(y,u){switch(y){case f.PrimitiveType.POINTS:return 2*u;case f.PrimitiveType.TRIANGLES:return u/3;case f.PrimitiveType.TRIANGLE_STRIP:return u-2;case f.PrimitiveType.TRIANGLE_FAN:return u-2;default:return 0}}let B=function(){function y(v,r){this.gl=v;this.instanceCounter=new d.InstanceCounter;this.programCache=new b.ProgramCache(this);this._state=new g.ContextState;
this._numOfTriangles=this._numOfDrawCalls=0;this.type=n(v)?p.ContextType.WEBGL2:p.ContextType.WEBGL1;this._loadExtensions();this.configure(r)}var u=y.prototype;u.configure=function(v){this._capabilities=new k.Capabilities(this.gl,v);this._parameters=this._loadParameters(v);v=this.gl.getParameter(this.gl.VIEWPORT);this._state=new g.ContextState;this._state.viewport={x:v[0],y:v[1],width:v[2],height:v[3]};this._stateTracker=new a.StateTracker({setBlending:r=>{r?(this.setBlendingEnabled(!0),this.setBlendEquationSeparate(r.opRgb,
r.opAlpha),this.setBlendFunctionSeparate(r.srcRgb,r.dstRgb,r.srcAlpha,r.dstAlpha),r=r.color,this.setBlendColor(r.r,r.g,r.b,r.a)):this.setBlendingEnabled(!1)},setCulling:r=>{r?(this.setFaceCullingEnabled(!0),this.setCullFace(r.face),this.setFrontFace(r.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:r=>{r?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(r.factor,r.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:r=>{r?(this.setDepthTestEnabled(!0),this.setDepthFunction(r.func)):
this.setDepthTestEnabled(!1)},setStencilTest:r=>{if(r){this.setStencilTestEnabled(!0);const z=r.function;this.setStencilFunction(z.func,z.ref,z.mask);r=r.operation;this.setStencilOp(r.fail,r.zFail,r.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:r=>{r?(this.setDepthWriteEnabled(!0),this.setDepthRange(r.zNear,r.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:r=>{r?this.setColorMask(r.r,r.g,r.b,r.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:r=>{r?this.setStencilWriteMask(r.mask):
this.setStencilWriteMask(0)}});this.enforceState();D.disposeMaybe(this._driverTest);this._driverTest=new m.WebGLDriverTest(this)};u.dispose=function(){D.disposeMaybe(this._driverTest);this.programCache.dispose();this.bindVAO(null);this.unbindBuffer(f.BufferType.ARRAY_BUFFER);this.unbindBuffer(f.BufferType.ELEMENT_ARRAY_BUFFER);this.type===p.ContextType.WEBGL2&&(this.unbindBuffer(f.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(f.BufferType.PIXEL_PACK_BUFFER),
this.unbindBuffer(f.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(f.BufferType.COPY_READ_BUFFER),this.unbindBuffer(f.BufferType.COPY_WRITE_BUFFER));this._state.textureUnitMap.length=0;t.webglDebugEnabled()&&console.log(this.instanceCounter.resourceInformation)};u.setPipelineState=function(v){this._stateTracker.setPipeline(v)};u.setBlendingEnabled=function(v){this._state.blend!==v&&(!0===v?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=v,this._stateTracker.invalidateBlending())};
u.externalProgramUpdate=function(){this._state.program?.stop();this._state.program=null};u.externalTextureUnitUpdate=function(v,r){for(let z=0;z<v.length;++z)this._state.textureUnitMap[v[z]]=null;0<=r&&(this._state.activeTexture=r)};u.externalVertexArrayObjectUpdate=function(){const v=this.capabilities.vao;v&&(v.bindVertexArray(null),this._state.vertexArrayObject=null);this._state.vertexBuffer=null;this._state.indexBuffer=null};u.externalVertexBufferUpdate=function(){this._state.vertexBuffer=null};
u.externalIndexBufferUpdate=function(){this._state.indexBuffer=null};u.setBlendColor=function(v,r,z,A){if(v!==this._state.blendColor.r||r!==this._state.blendColor.g||z!==this._state.blendColor.b||A!==this._state.blendColor.a)this.gl.blendColor(v,r,z,A),this._state.blendColor.r=v,this._state.blendColor.g=r,this._state.blendColor.b=z,this._state.blendColor.a=A,this._stateTracker.invalidateBlending()};u.setBlendFunction=function(v,r){if(v!==this._state.blendFunction.srcRGB||r!==this._state.blendFunction.dstRGB)this.gl.blendFunc(v,
r),this._state.blendFunction.srcRGB=v,this._state.blendFunction.srcAlpha=v,this._state.blendFunction.dstRGB=r,this._state.blendFunction.dstAlpha=r,this._stateTracker.invalidateBlending()};u.setBlendFunctionSeparate=function(v,r,z,A){if(this._state.blendFunction.srcRGB!==v||this._state.blendFunction.srcAlpha!==z||this._state.blendFunction.dstRGB!==r||this._state.blendFunction.dstAlpha!==A)this.gl.blendFuncSeparate(v,r,z,A),this._state.blendFunction.srcRGB=v,this._state.blendFunction.srcAlpha=z,this._state.blendFunction.dstRGB=
r,this._state.blendFunction.dstAlpha=A,this._stateTracker.invalidateBlending()};u.setBlendEquation=function(v){this._state.blendEquation.mode!==v&&(this.gl.blendEquation(v),this._state.blendEquation.mode=v,this._state.blendEquation.modeAlpha=v,this._stateTracker.invalidateBlending())};u.setBlendEquationSeparate=function(v,r){if(this._state.blendEquation.mode!==v||this._state.blendEquation.modeAlpha!==r)this.gl.blendEquationSeparate(v,r),this._state.blendEquation.mode=v,this._state.blendEquation.modeAlpha=
r,this._stateTracker.invalidateBlending()};u.setColorMask=function(v,r,z,A){if(this._state.colorMask.r!==v||this._state.colorMask.g!==r||this._state.colorMask.b!==z||this._state.colorMask.a!==A)this.gl.colorMask(v,r,z,A),this._state.colorMask.r=v,this._state.colorMask.g=r,this._state.colorMask.b=z,this._state.colorMask.a=A,this._stateTracker.invalidateColorWrite()};u.setClearColor=function(v,r,z,A){if(this._state.clearColor.r!==v||this._state.clearColor.g!==r||this._state.clearColor.b!==z||this._state.clearColor.a!==
A)this.gl.clearColor(v,r,z,A),this._state.clearColor.r=v,this._state.clearColor.g=r,this._state.clearColor.b=z,this._state.clearColor.a=A};u.setFaceCullingEnabled=function(v){this._state.faceCulling!==v&&(!0===v?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=v,this._stateTracker.invalidateCulling())};u.setPolygonOffsetFillEnabled=function(v){this._state.polygonOffsetFill!==v&&(!0===v?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),
this._state.polygonOffsetFill=v,this._stateTracker.invalidatePolygonOffset())};u.setPolygonOffset=function(v,r){if(this._state.polygonOffset[0]!==v||this._state.polygonOffset[1]!==r)this._state.polygonOffset[0]=v,this._state.polygonOffset[1]=r,this.gl.polygonOffset(v,r),this._stateTracker.invalidatePolygonOffset()};u.setCullFace=function(v){this._state.cullFace!==v&&(this.gl.cullFace(v),this._state.cullFace=v,this._stateTracker.invalidateCulling())};u.setFrontFace=function(v){this._state.frontFace!==
v&&(this.gl.frontFace(v),this._state.frontFace=v,this._stateTracker.invalidateCulling())};u.setScissorTestEnabled=function(v){this._state.scissorTest!==v&&(!0===v?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=v)};u.setScissorRect=function(v,r,z,A){if(this._state.scissorRect.x!==v||this._state.scissorRect.y!==r||this._state.scissorRect.width!==z||this._state.scissorRect.height!==A)this.gl.scissor(v,r,z,A),this._state.scissorRect.x=v,this._state.scissorRect.y=
r,this._state.scissorRect.width=z,this._state.scissorRect.height=A};u.setDepthTestEnabled=function(v){this._state.depthTest!==v&&(!0===v?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=v,this._stateTracker.invalidateDepthTest())};u.setClearDepth=function(v){this._state.clearDepth!==v&&(this.gl.clearDepth(v),this._state.clearDepth=v)};u.setDepthFunction=function(v){this._state.depthFunction!==v&&(this.gl.depthFunc(v),this._state.depthFunction=v,this._stateTracker.invalidateDepthTest())};
u.setDepthWriteEnabled=function(v){this._state.depthWrite!==v&&(this.gl.depthMask(v),this._state.depthWrite=v,this._stateTracker.invalidateDepthWrite())};u.setDepthRange=function(v,r){if(this._state.depthRange.zNear!==v||this._state.depthRange.zFar!==r)this.gl.depthRange(v,r),this._state.depthRange.zNear=v,this._state.depthRange.zFar=r,this._stateTracker.invalidateDepthWrite()};u.setStencilTestEnabled=function(v){this._state.stencilTest!==v&&(!0===v?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),
this._state.stencilTest=v,this._stateTracker.invalidateStencilTest())};u.setClearStencil=function(v){v!==this._state.clearStencil&&(this.gl.clearStencil(v),this._state.clearStencil=v)};u.setStencilFunction=function(v,r,z){if(this._state.stencilFunction.func!==v||this._state.stencilFunction.ref!==r||this._state.stencilFunction.mask!==z)this.gl.stencilFunc(v,r,z),this._state.stencilFunction.face=f.Face.FRONT_AND_BACK,this._state.stencilFunction.func=v,this._state.stencilFunction.ref=r,this._state.stencilFunction.mask=
z,this._stateTracker.invalidateStencilTest()};u.setStencilFunctionSeparate=function(v,r,z,A){if(this._state.stencilFunction.face!==v||this._state.stencilFunction.func!==r||this._state.stencilFunction.ref!==z||this._state.stencilFunction.mask!==A)this.gl.stencilFuncSeparate(v,r,z,A),this._state.stencilFunction.face=v,this._state.stencilFunction.func=r,this._state.stencilFunction.ref=z,this._state.stencilFunction.mask=A,this._stateTracker.invalidateStencilTest()};u.setStencilWriteMask=function(v){this._state.stencilWriteMask!==
v&&(this.gl.stencilMask(v),this._state.stencilWriteMask=v,this._stateTracker.invalidateStencilWrite())};u.setStencilOp=function(v,r,z){if(this._state.stencilOperation.face!==f.Face.FRONT_AND_BACK||this._state.stencilOperation.fail!==v||this._state.stencilOperation.zFail!==r||this._state.stencilOperation.zPass!==z)this.gl.stencilOp(v,r,z),this._state.stencilOperation.face=f.Face.FRONT_AND_BACK,this._state.stencilOperation.fail=v,this._state.stencilOperation.zFail=r,this._state.stencilOperation.zPass=
z,this._stateTracker.invalidateStencilTest()};u.setStencilOpSeparate=function(v,r,z,A){if(this._state.stencilOperation.face!==v||this._state.stencilOperation.fail!==r||this._state.stencilOperation.zFail!==z||this._state.stencilOperation.zPass!==A)this.gl.stencilOpSeparate(v,r,z,A),this._state.stencilOperation.face=v,this._state.stencilOperation.fail=r,this._state.stencilOperation.zFail=z,this._state.stencilOperation.zPass=A,this._stateTracker.invalidateStencilTest()};u.setActiveTexture=function(v,
r=!1){const z=this._state.activeTexture;0<=v&&(r||v!==this._state.activeTexture)&&(this.gl.activeTexture(f.BASE_TEXTURE_UNIT+v),this._state.activeTexture=v);return z};u.clear=function(v){v&&this.gl.clear(v)};u.clearSafe=function(v,r=255){v&&(v&f.ClearBufferBit.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),v&f.ClearBufferBit.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),v&f.ClearBufferBit.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(r),this.gl.clear(v))};u.drawArrays=function(v,r,z){t.webglDebugEnabled()&&
(this._numOfDrawCalls++,this._numOfTriangles+=q(v,z));this.gl.drawArrays(v,r,z);t.webglDebugEnabled()&&(v=c.getErrorString(this))&&console.error("drawArrays:",v)};u.drawElements=function(v,r,z,A){t.webglDebugEnabled()&&(this._numOfDrawCalls++,this._numOfTriangles+=q(v,r));this.gl.drawElements(v,r,z,A);if(t.webglDebugEnabled()){const G=c.getErrorString(this);if(G){var C=this.getBoundVAO(),F=C?.indexBuffer;C={indexBuffer:F,vertexBuffers:C?.vertexBuffers};v={mode:v,count:r,type:z,offset:A};F=D.applySome(F,
H=>H.size)??0;r=A+r;console.error(`drawElements: ${G}${F<r?`. Buffer is too small. Attempted to draw index ${r} of ${F}`:""}`,{args:v,vao:C})}}};u.logInfo=function(){t.webglDebugEnabled()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)};u.resetInfo=function(){t.webglDebugEnabled()&&(this._numOfTriangles=this._numOfDrawCalls=0)};u.setViewport=function(v,r,z,A){z=Math.max(Math.round(z),1);A=Math.max(Math.round(A),1);const C=this._state.viewport;if(C.x!==v||C.y!==
r||C.width!==z||C.height!==A)C.x=v,C.y=r,C.width=z,C.height=A,this.gl.viewport(v,r,z,A)};u.getViewport=function(){const v=this._state.viewport;return{x:v.x,y:v.y,width:v.width,height:v.height}};u.useProgram=function(v){this._state.program!==v&&(this._state.program?.stop(),this._state.program=v,this.gl.useProgram(v?.glName??null))};u.bindTexture=function(v,r,z=!1){(r>=this.parameters.maxTextureImageUnits||0>r)&&console.error("Input texture unit is out of range of available units!");const A=this._state.textureUnitMap[r];
if(D.isNone(v)||null==v.glName)return D.isSome(A)&&(this.setActiveTexture(r,z),this.gl.bindTexture(A.descriptor.target,null)),this._state.textureUnitMap[r]=null,A;if(!z&&A===v)return v.isDirty&&(this.setActiveTexture(r,z),v.applyChanges()),A;this.setActiveTexture(r,z);this.gl.bindTexture(v.descriptor.target,v.glName);v.applyChanges();this._state.textureUnitMap[r]=v;return A};u.unbindTexture=function(v){if(!D.isNone(v))for(let r=0;r<this.parameters.maxTextureImageUnits;r++)this._state.textureUnitMap[r]===
v&&(this.bindTexture(null,r),this._state.textureUnitMap[r]=null)};u.bindFramebuffer=function(v,r=!1){if(r||this._state.readFramebuffer!==v||this._state.drawFramebuffer!==v)D.isNone(v)?(this.gl.bindFramebuffer(f.FramebufferTarget.FRAMEBUFFER,null),this._state.readFramebuffer=null,this._state.drawFramebuffer=null):(v.initializeAndBind(f.FramebufferTarget.FRAMEBUFFER),this._state.readFramebuffer=v,this._state.drawFramebuffer=v)};u.bindFramebufferSeparate=function(v,r,z=!1){const A=r===f.FramebufferTarget.READ_FRAMEBUFFER,
C=A?this._state.readFramebuffer:this._state.drawFramebuffer;if(z||C!==v)D.isNone(v)?this.gl.bindFramebuffer(r,null):v.initializeAndBind(r),A?this._state.readFramebuffer=D.unwrapOr(v,null):this._state.drawFramebuffer=D.unwrapOr(v,null)};u.blitFramebuffer=function(v,r,z=0,A=0,C=v.width,F=v.height,G=0,H=0,K=r.width,J=r.height,N=f.ClearBufferBit.COLOR_BUFFER_BIT,P=f.TextureSamplingMode.NEAREST){this.bindFramebufferSeparate(v,f.FramebufferTarget.READ_FRAMEBUFFER);this.bindFramebufferSeparate(r,f.FramebufferTarget.DRAW_FRAMEBUFFER);
this.gl.blitFramebuffer(z,A,C,F,G,H,K,J,N,P)};u.bindBuffer=function(v,r){if(v)switch(r??(r=v.bufferType),r){case f.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=x(this.gl,v,r,this._state.vertexBuffer);break;case f.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=x(this.gl,v,r,this._state.indexBuffer);break;case f.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=x(this.gl,v,r,this._state.uniformBuffer);break;case f.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=x(this.gl,v,r,
this._state.pixelPackBuffer);break;case f.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=x(this.gl,v,r,this._state.pixelUnpackBuffer);break;case f.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=x(this.gl,v,r,this._state.copyReadBuffer);break;case f.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=x(this.gl,v,r,this._state.copyWriteBuffer)}};u.bindRenderbuffer=function(v){const r=this.gl;v||(r.bindRenderbuffer(r.RENDERBUFFER,null),this._state.renderbuffer=null);this._state.renderbuffer!==
v&&(r.bindRenderbuffer(r.RENDERBUFFER,v.glName),this._state.renderbuffer=v)};u._getBufferBinding=function(v,r){if(r>=this.parameters.maxUniformBufferBindings||0>r)return console.error("Uniform buffer binding point is out of range!"),null;v=this._state.uniformBufferBindingPoints;let z=v[r];D.isNone(z)&&(z={buffer:null,offset:0,size:0},v[r]=z);return z};u.bindBufferBase=function(v,r,z){const A=this._getBufferBinding(v,r);D.isNone(A)||A.buffer===z&&0===A.offset&&0===A.size||(this.gl.bindBufferBase(v,
r,z?z.glName:null),A.buffer=z,A.offset=0,A.size=0)};u.bindBufferRange=function(v,r,z,A,C){const F=this._getBufferBinding(v,r);D.isNone(F)||F.buffer===z&&F.offset===A&&F.size===C||(0!==A%this._parameters.uniformBufferOffsetAlignment?console.error("Uniform buffer binding offset is not a multiple of the context offset alignment"):(this.gl.bindBufferRange(v,r,z.glName,A,C),F.buffer=z,F.offset=A,F.size=C))};u.bindUBO=function(v,r,z,A){D.isNone(r)?this.bindBufferBase(f.BufferType.UNIFORM_BUFFER,v,null):
(t.webglDebugEnabled()&&(A??r.byteLength)>this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),r.initialize(),void 0!==z&&void 0!==A?this.bindBufferRange(f.BufferType.UNIFORM_BUFFER,v,r.buffer,z,A):this.bindBufferBase(f.BufferType.UNIFORM_BUFFER,v,r.buffer))};u.unbindUBO=function(v){for(let r=0,z=this._state.uniformBufferBindingPoints.length;r<z;r++){const A=this._state.uniformBufferBindingPoints[r];D.isSome(A)&&A.buffer===v.buffer&&
this.bindBufferBase(f.BufferType.UNIFORM_BUFFER,r,null)}};u.unbindBuffer=function(v){switch(v){case f.BufferType.ARRAY_BUFFER:this._state.vertexBuffer=x(this.gl,null,v,this._state.vertexBuffer);break;case f.BufferType.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=x(this.gl,null,v,this._state.indexBuffer);break;case f.BufferType.UNIFORM_BUFFER:this._state.uniformBuffer=x(this.gl,null,v,this._state.uniformBuffer);break;case f.BufferType.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=x(this.gl,null,v,
this._state.pixelPackBuffer);break;case f.BufferType.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=x(this.gl,null,v,this._state.pixelUnpackBuffer);break;case f.BufferType.COPY_READ_BUFFER:this._state.copyReadBuffer=x(this.gl,null,v,this._state.copyReadBuffer);break;case f.BufferType.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=x(this.gl,null,v,this._state.copyWriteBuffer)}};u.bindVAO=function(v=null){D.isNone(v)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=
null):this._state.vertexArrayObject!==v&&(v.bind(),this._state.vertexArrayObject=v)};u.clientWaitAsync=async function(v=w.Milliseconds(10)){const r=this.gl,z=r.fenceSync(f.SyncCondition.SYNC_GPU_COMMANDS_COMPLETE,0);if(!z)throw Error("Client wait failed, could not create sync object");this.instanceCounter.increment(f.ResourceType.Sync,z);r.flush();let A;do await E.after(v),A=r.clientWaitSync(z,0,0);while(A===f.ClientWaitSyncStatus.TIMEOUT_EXPIRED);this.instanceCounter.decrement(f.ResourceType.Sync,
z);r.deleteSync(z);if(A===f.ClientWaitSyncStatus.WAIT_FAILED)throw Error("Client wait failed");};u.getBoundFramebufferObject=function(v=f.FramebufferTarget.FRAMEBUFFER){return v===f.FramebufferTarget.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer};u.getBoundVAO=function(){return this._state.vertexArrayObject};u.resetState=function(){this.useProgram(null);this.bindVAO(null);this.bindFramebuffer(null,!0);this.unbindBuffer(f.BufferType.ARRAY_BUFFER);this.unbindBuffer(f.BufferType.ELEMENT_ARRAY_BUFFER);
this.type===p.ContextType.WEBGL2&&(this.unbindBuffer(f.BufferType.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(f.BufferType.PIXEL_PACK_BUFFER),this.unbindBuffer(f.BufferType.PIXEL_UNPACK_BUFFER),this.unbindBuffer(f.BufferType.COPY_READ_BUFFER),this.unbindBuffer(f.BufferType.COPY_WRITE_BUFFER));for(let v=0;v<this.parameters.maxTextureImageUnits;++v)this.bindTexture(null,v);this.setBlendingEnabled(!1);this.setBlendFunction(f.BlendFactor.ONE,f.BlendFactor.ZERO);this.setBlendEquation(f.BlendOperation.ADD);
this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(f.Face.BACK);this.setFrontFace(f.CullMode.CCW);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(f.CompareFunction.LESS);this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(f.CompareFunction.ALWAYS,0,0);this.setStencilOp(f.StencilOperation.KEEP,
f.StencilOperation.KEEP,f.StencilOperation.KEEP);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};u.enforceState=function(){var v=this.capabilities.vao;v&&v.bindVertexArray(null);const {gl:r,gl2:z}=this;for(var A=0;A<this.parameters.maxVertexAttributes;A++)r.disableVertexAttribArray(A);this._state.vertexBuffer?
r.bindBuffer(this._state.vertexBuffer.bufferType,this._state.vertexBuffer.glName):r.bindBuffer(f.BufferType.ARRAY_BUFFER,null);this._state.indexBuffer?r.bindBuffer(this._state.indexBuffer.bufferType,this._state.indexBuffer.glName):r.bindBuffer(f.BufferType.ELEMENT_ARRAY_BUFFER,null);if(D.isSome(z)){this._state.uniformBuffer?z.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):z.bindBuffer(f.BufferType.UNIFORM_BUFFER,null);for(A=0;A<this._parameters.maxUniformBufferBindings;A++){const C=
this._state.uniformBufferBindingPoints[A];if(D.isSome(C)){const {buffer:F,offset:G,size:H}=C;null!==F?0===G&&0===H?z.bindBufferBase(f.BufferType.UNIFORM_BUFFER,A,F.glName):z.bindBufferRange(f.BufferType.UNIFORM_BUFFER,A,F.glName,G,H):z.bindBufferBase(f.BufferType.UNIFORM_BUFFER,A,null)}}this._state.pixelPackBuffer?z.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):z.bindBuffer(f.BufferType.PIXEL_PACK_BUFFER,null);this._state.pixelUnpackBuffer?z.bindBuffer(this._state.pixelUnpackBuffer.bufferType,
this._state.pixelUnpackBuffer.glName):z.bindBuffer(f.BufferType.PIXEL_UNPACK_BUFFER,null);this._state.copyReadBuffer?z.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):z.bindBuffer(f.BufferType.COPY_READ_BUFFER,null);this._state.copyWriteBuffer?z.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):z.bindBuffer(f.BufferType.COPY_WRITE_BUFFER,null);z.bindFramebuffer(f.FramebufferTarget.READ_FRAMEBUFFER,null);z.readBuffer(z.BACK);this._state.readFramebuffer&&
(z.bindFramebuffer(f.FramebufferTarget.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),z.readBuffer(f.ColorAttachment.COLOR_ATTACHMENT0));z.bindFramebuffer(f.FramebufferTarget.DRAW_FRAMEBUFFER,this._state.drawFramebuffer?.glName??null)}else this._state.readFramebuffer=this._state.drawFramebuffer,r.bindFramebuffer(f.FramebufferTarget.FRAMEBUFFER,this._state.drawFramebuffer?.glName??null);if(v&&this._state.vertexArrayObject){if(v=this._state.vertexArrayObject)this._state.vertexArrayObject.unbind(),
this._state.vertexArrayObject=null;this.bindVAO(v)}r.useProgram(this._state.program?.glName??null);r.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a);r.bindRenderbuffer(r.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null);!0===this._state.blend?r.enable(this.gl.BLEND):r.disable(this.gl.BLEND);r.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha);r.blendFuncSeparate(this._state.blendFunction.srcRGB,
this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha);r.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,this._state.clearColor.a);r.clearDepth(this._state.clearDepth);r.clearStencil(this._state.clearStencil);r.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a);r.cullFace(this._state.cullFace);r.depthFunc(this._state.depthFunction);r.depthRange(this._state.depthRange.zNear,
this._state.depthRange.zFar);!0===this._state.depthTest?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST);r.depthMask(this._state.depthWrite);r.frontFace(this._state.frontFace);r.lineWidth(1);!0===this._state.faceCulling?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE);r.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]);!0===this._state.polygonOffsetFill?r.enable(r.POLYGON_OFFSET_FILL):r.disable(r.POLYGON_OFFSET_FILL);r.scissor(this._state.scissorRect.x,this._state.scissorRect.y,this._state.scissorRect.width,
this._state.scissorRect.height);!0===this._state.scissorTest?r.enable(r.SCISSOR_TEST):r.disable(r.SCISSOR_TEST);r.stencilFunc(this._state.stencilFunction.func,this._state.stencilFunction.ref,this._state.stencilFunction.mask);r.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass);!0===this._state.stencilTest?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST);r.stencilMask(this._state.stencilWriteMask);
for(v=0;v<this.parameters.maxTextureImageUnits;v++)r.activeTexture(f.BASE_TEXTURE_UNIT+v),r.bindTexture(f.TextureType.TEXTURE_2D,null),r.bindTexture(f.TextureType.TEXTURE_CUBE_MAP,null),this.type===p.ContextType.WEBGL2&&(r.bindTexture(f.TextureType.TEXTURE_3D,null),r.bindTexture(f.TextureType.TEXTURE_2D_ARRAY,null)),A=this._state.textureUnitMap[v],D.isSome(A)&&r.bindTexture(A.descriptor.target,A.glName);r.activeTexture(f.BASE_TEXTURE_UNIT+this._state.activeTexture);v=this._state.viewport;r.viewport(v.x,
v.y,v.width,v.height);this.resetInfo()};u._loadExtensions=function(){this.type===p.ContextType.WEBGL1&&this.gl.getExtension("OES_element_index_uint");this.gl.getExtension("KHR_parallel_shader_compile")};u._loadParameters=function(v){var r=this.capabilities.textureFilterAnisotropic;v=v.maxAnisotropy??Infinity;const z=this.type===p.ContextType.WEBGL2,A=this.gl;r={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:r?Math.min(this.gl.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY),v):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:z?A.getParameter(A.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:z?A.getParameter(A.MAX_VERTEX_UNIFORM_BLOCKS):0,maxFragmentUniformBlocks:z?A.getParameter(A.MAX_FRAGMENT_UNIFORM_BLOCKS):
0,maxUniformBlockSize:z?A.getParameter(A.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:z?A.getParameter(A.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:z?A.getParameter(A.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:z?A.getParameter(A.MAX_SAMPLES):1};e.Texture.TEXTURE_UNIT_FOR_UPDATES=r.maxTextureImageUnits-1;return r};h._createClass(y,[{key:"gl2",get:function(){return this.type===p.ContextType.WEBGL1?null:this.gl}},{key:"driverTest",get:function(){return this._driverTest}},{key:"contextAttributes",
get:function(){return this.gl.getContextAttributes()}},{key:"parameters",get:function(){return this._parameters}},{key:"capabilities",get:function(){return this._capabilities}}]);return y}();l.RenderingContext=B;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/ContextState":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./enums"],function(l,h,D){h=h._createClass(function(){this.blend=!1;this.blendColor={r:0,g:0,b:0,a:0};this.blendFunction={srcRGB:D.BlendFactor.ONE,
dstRGB:D.BlendFactor.ZERO,srcAlpha:D.BlendFactor.ONE,dstAlpha:D.BlendFactor.ZERO};this.blendEquation={mode:D.BlendOperation.ADD,modeAlpha:D.BlendOperation.ADD};this.colorMask={r:!0,g:!0,b:!0,a:!0};this.faceCulling=!1;this.cullFace=D.Face.BACK;this.frontFace=D.CullMode.CCW;this.scissorTest=!1;this.scissorRect={x:0,y:0,width:0,height:0};this.depthTest=!1;this.depthFunction=D.CompareFunction.LESS;this.clearDepth=1;this.depthWrite=!0;this.depthRange={zNear:0,zFar:1};this.viewport=null;this.polygonOffsetFill=
this.stencilTest=!1;this.polygonOffset=[0,0];this.stencilFunction={face:D.Face.FRONT_AND_BACK,func:D.CompareFunction.ALWAYS,ref:0,mask:1};this.clearStencil=0;this.stencilWriteMask=1;this.stencilOperation={face:D.Face.FRONT_AND_BACK,fail:D.StencilOperation.KEEP,zFail:D.StencilOperation.KEEP,zPass:D.StencilOperation.KEEP};this.clearColor={r:0,g:0,b:0,a:0};this.copyWriteBuffer=this.copyReadBuffer=this.pixelUnpackBuffer=this.pixelPackBuffer=this.uniformBuffer=this.indexBuffer=this.vertexBuffer=this.program=
null;this.uniformBufferBindingPoints=[];this.renderbuffer=this.drawFramebuffer=this.readFramebuffer=null;this.activeTexture=0;this.textureUnitMap=[];this.vertexArrayObject=null});l.ContextState=h;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/InstanceCounter":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../support/AllocationTracer","./enums"],function(l,h,D,E){const w={RECORD_ALLOCATIONS:!1};let t=function(){function p(){this._current=[];
this._max=[];for(this._allocations=new D.AllocationTracer(w.RECORD_ALLOCATIONS);this._current.length<E.ResourceType.COUNT;)this._current.push(0),this._max.push(0)}var g=p.prototype;g.resetMax=function(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)};g.increment=function(f,d){const b=++this._current[f];this._max[f]=Math.max(b,this._max[f]);this._allocations.add(d)};g.decrement=function(f,d){--this._current[f];this._allocations.remove(d)};h._createClass(p,[{key:"max",
get:function(){return this._max}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this.current.reduce((f,d)=>f+d,0)}},{key:"resourceInformation",get:function(){let f="";if(0<this.total){f+="Live objects:\n";for(let d=0;d<E.ResourceType.COUNT;++d){const b=this._current[d];0<b&&(f+=`${E.ResourceType[d]}: ${b}\n`)}}return f+=this._allocations.information}}]);return p}();l.InstanceCounter=t;l.test=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/views/support/AllocationTracer":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(l,h){let D=function(){function E(t){this._allocations=new Map;t?Error.stackTraceLimit=Infinity:(this.add=()=>{},this.remove=()=>{})}var w=E.prototype;w.add=function(t){this._allocations.set(t,Error().stack)};w.remove=function(t){this._allocations.delete(t)};h._createClass(E,[{key:"information",get:function(){let t="";if(0<this._allocations.size){t+=`${this._allocations.size} live object allocations:\n`;
const p=new Map;this._allocations.forEach(g=>{p.set(g,(p.get(g)??0)+1)});p.forEach((g,f)=>{f=f.split("\n");f.shift();f.shift();t+=`${g}: ${f.shift()}\n`;f.forEach(d=>t+=`   ${d}\n`)})}return t}}]);return E}();l.AllocationTracer=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/renderState":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../3d/webgl-engine/lib/basicInterfaces","./enums"],function(l,h,D,E){function w(P){return z.intern(P)}function t(P){return A.intern(P)}
function p(P){return C.intern(P)}function g(P){return F.intern(P)}function f(P){return G.intern(P)}function d(P){return H.intern(P)}function b(P){return K.intern(P)}function a(P){return J.intern(P)}function e(P){return"["+P.join(",")+"]"}function c(P){return P?e([P.srcRgb,P.srcAlpha,P.dstRgb,P.dstAlpha,P.opRgb,P.opAlpha,P.color.r,P.color.g,P.color.b,P.color.a]):null}function m(P){return P?e([P.face,P.mode]):null}function k(P){return P?e([P.factor,P.units]):null}function n(P){return P?e([P.func]):
null}function x(P){return P?e([P.function.func,P.function.ref,P.function.mask,P.operation.fail,P.operation.zFail,P.operation.zPass]):null}function q(P){return P?e([P.zNear,P.zFar]):null}function B(P){return P?e([P.r,P.g,P.b,P.a]):null}function y(P){return P?e([P.mask]):null}const u={face:E.Face.BACK,mode:E.CullMode.CCW},v={face:E.Face.FRONT,mode:E.CullMode.CCW};var r=function(){function P(W,X){this._makeKey=W;this._makeRef=X;this._interns=new Map}P.prototype.intern=function(W){if(!W)return null;const X=
this._makeKey(W),aa=this._interns;aa.has(X)||aa.set(X,this._makeRef(W));return aa.get(X)??null};return h._createClass(P)}();const z=new r(c,P=>({__tag:"Blending",...P})),A=new r(m,P=>({__tag:"Culling",...P})),C=new r(k,P=>({__tag:"PolygonOffset",...P})),F=new r(n,P=>({__tag:"DepthTest",...P})),G=new r(x,P=>({__tag:"StencilTest",...P})),H=new r(q,P=>({__tag:"DepthWrite",...P})),K=new r(B,P=>({__tag:"ColorWrite",...P})),J=new r(y,P=>({__tag:"StencilWrite",...P})),N=new r(function(P){return P?e([c(P.blending),
m(P.culling),k(P.polygonOffset),n(P.depthTest),x(P.stencilTest),q(P.depthWrite),B(P.colorWrite),y(P.stencilWrite)]):null},P=>({blending:w(P.blending),culling:t(P.culling),polygonOffset:p(P.polygonOffset),depthTest:g(P.depthTest),stencilTest:f(P.stencilTest),depthWrite:d(P.depthWrite),colorWrite:b(P.colorWrite),stencilWrite:a(P.stencilWrite)}));r=function(){function P(X){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=
this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=X}var W=P.prototype;W.setPipeline=function(X){if(this._pipelineInvalid||X!==this._pipeline)this._setBlending(X.blending),this._setCulling(X.culling),this._setPolygonOffset(X.polygonOffset),this._setDepthTest(X.depthTest),this._setStencilTest(X.stencilTest),this._setDepthWrite(X.depthWrite),this._setColorWrite(X.colorWrite),this._setStencilWrite(X.stencilWrite),this._pipeline=X;this._pipelineInvalid=!1};W.invalidateBlending=
function(){this._pipelineInvalid=this._blendingInvalid=!0};W.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};W.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};W.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};W.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};W.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};W.invalidateColorWrite=
function(){this._pipelineInvalid=this._colorWriteInvalid=!0};W.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};W._setBlending=function(X){this._blending=this._setSubState(X,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};W._setCulling=function(X){this._culling=this._setSubState(X,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};W._setPolygonOffset=function(X){this._polygonOffset=
this._setSubState(X,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};W._setDepthTest=function(X){this._depthTest=this._setSubState(X,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};W._setStencilTest=function(X){this._stencilTest=this._setSubState(X,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};W._setDepthWrite=function(X){this._depthWrite=
this._setSubState(X,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};W._setColorWrite=function(X){this._colorWrite=this._setSubState(X,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=!1};W._setStencilWrite=function(X){this._stencilWrite=this._setSubState(X,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};W._setSubState=function(X,aa,
Z,ea){if(Z||X!==aa)ea(X),this._pipelineInvalid=!0;return X};return h._createClass(P)}();l.StateTracker=r;l.backFaceCullingParams=u;l.cullingParams=P=>P===D.CullFaceOptions.Back?u:P===D.CullFaceOptions.Front?v:null;l.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};l.defaultDepthWriteParams={zNear:0,zFar:1};l.frontFaceCullingParams=v;l.makeBlending=w;l.makeColorWrite=b;l.makeCulling=t;l.makeDepthTest=g;l.makeDepthWrite=d;l.makePipelineState=function(P){return N.intern(P)};l.makePolygonOffset=p;l.makeStencilTest=
f;l.makeStencilWrite=a;l.separateBlendingParams=function(P,W,X,aa,Z=E.BlendOperation.ADD,ea=E.BlendOperation.ADD,T=[0,0,0,0]){return{srcRgb:P,srcAlpha:W,dstRgb:X,dstAlpha:aa,opRgb:Z,opAlpha:ea,color:{r:T[0],g:T[1],b:T[2],a:T[3]}}};l.simpleBlendingParams=function(P,W,X=E.BlendOperation.ADD,aa=[0,0,0,0]){return{srcRgb:P,srcAlpha:P,dstRgb:W,dstAlpha:W,opRgb:X,opAlpha:X,color:{r:aa[0],g:aa[1],b:aa[2],a:aa[3]}}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/lib/basicInterfaces":function(){define(["exports"],
function(l){l.CullFaceOptions=void 0;(function(h){h[h.None=0]="None";h[h.Front=1]="Front";h[h.Back=2]="Back";h[h.COUNT=3]="COUNT"})(l.CullFaceOptions||(l.CullFaceOptions={}));l.DepthTestFunction=void 0;(function(h){h[h.Less=0]="Less";h[h.Lequal=1]="Lequal";h[h.COUNT=2]="COUNT"})(l.DepthTestFunction||(l.DepthTestFunction={}));l.RenderRequestType=void 0;(function(h){h[h.BACKGROUND=0]="BACKGROUND";h[h.UPDATE=1]="UPDATE"})(l.RenderRequestType||(l.RenderRequestType={}));l.ResourceState=void 0;(function(h){h[h.NOT_LOADED=
0]="NOT_LOADED";h[h.LOADING=1]="LOADING";h[h.LOADED=2]="LOADED"})(l.ResourceState||(l.ResourceState={}));l.StencilBits=void 0;(function(h){h[h.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded";h[h.OutlineVisualElementMask=2]="OutlineVisualElementMask"})(l.StencilBits||(l.StencilBits={}));l.Object3DState=void 0;(function(h){h[h.Highlight=0]="Highlight";h[h.MaskOccludee=1]="MaskOccludee";h[h.COUNT=2]="COUNT"})(l.Object3DState||(l.Object3DState={}));l.PowerOfTwoResizeMode=void 0;(function(h){h[h.STRETCH=
1]="STRETCH";h[h.PAD=2]="PAD"})(l.PowerOfTwoResizeMode||(l.PowerOfTwoResizeMode={}));l.ValidationState=void 0;(function(h){h[h.CHANGED=0]="CHANGED";h[h.UNCHANGED=1]="UNCHANGED"})(l.ValidationState||(l.ValidationState={}));l.AlphaDiscardMode=void 0;(function(h){h[h.Blend=0]="Blend";h[h.Opaque=1]="Opaque";h[h.Mask=2]="Mask";h[h.MaskBlend=3]="MaskBlend";h[h.COUNT=4]="COUNT"})(l.AlphaDiscardMode||(l.AlphaDiscardMode={}));l.Decorations=void 0;(function(h){h[h.OFF=0]="OFF";h[h.ON=1]="ON"})(l.Decorations||
(l.Decorations={}));l.TextureEncodingMimeType=void 0;(function(h){h.DDS_ENCODING="image/vnd-ms.dds";h.KTX2_ENCODING="image/ktx2";h.BASIS_ENCODING="image/x.basis"})(l.TextureEncodingMimeType||(l.TextureEncodingMimeType={}));Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/WebGLDriverTest":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ./testAppleAmdDrawArrays ./testDoublePrecisionArithmetic ./testFloatBufferBlend ./testSamplerPrecision ./testSVGPremultipliedAlpha".split(" "),
function(l,h,D,E,w,t,p){let g=function(){function f(d){this.rctx=d;this.floatBufferBlend=new w.FloatBufferBlend(d);this.svgPremultipliesAlpha=new p.SVGPremultipliedAlpha(d);this.doublePrecisionRequiresObfuscation=new E.DoublePrecisionRequiresObfuscation(d);this.ignoresSamplerPrecision=new t.IgnoresSamplerPrecision(d);this.drawArraysRequiresIndicesTypeReset=new D.DrawArraysRequiresIndicesTypeReset(d)}f.prototype.dispose=function(){this.ignoresSamplerPrecision.dispose();this.doublePrecisionRequiresObfuscation.dispose();
this.svgPremultipliesAlpha.dispose();this.floatBufferBlend.dispose();this.drawArraysRequiresIndicesTypeReset.dispose()};return h._createClass(f)}();l.WebGLDriverTest=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testAppleAmdDrawArrays":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../3d/webgl-engine/core/shaderModules/interfaces ../3d/webgl-engine/lib/AppleAmdDriverHelper ./BufferObject ./context-util ./enums ./FramebufferObject ./WebGLDriverTestModule".split(" "),
function(l,h,D,E,w,t,p,g,f,d){d=function(b){function a(c){var m=e.call(this);m._rctx=c;m._helperProgram=null;m._rctx.type===p.ContextType.WEBGL2&&D("mac")&&D("chrome")&&(m._program=m._prepareProgram(),m._helperProgram=m._prepareHelperProgram());return m}h._inherits(a,b);var e=h._createSuper(a);b=a.prototype;b.dispose=function(){h._get(h._getPrototypeOf(a.prototype),"dispose",this).call(this);this._helperProgram?.dispose();this._helperProgram=null};b._test=function(c){const m=this._rctx;m.resetState();
const k=new f.FramebufferObject(m,{colorTarget:g.TargetType.TEXTURE,depthStencilTarget:g.DepthStencilTargetType.NONE},{target:g.TextureType.TEXTURE_2D,wrapMode:g.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:g.PixelFormat.RGBA,dataType:g.PixelType.UNSIGNED_BYTE,samplingMode:g.TextureSamplingMode.NEAREST,width:1,height:1}),n=t.BufferObject.createIndex(this._rctx,g.Usage.STATIC_DRAW,new Uint8Array([0]));m.bindFramebuffer(k);m.setViewport(0,0,1,1);m.useProgram(this._helperProgram);m.bindBuffer(n,g.BufferType.ELEMENT_ARRAY_BUFFER);
m.drawElements(g.PrimitiveType.POINTS,1,g.DataType.UNSIGNED_BYTE,0);m.useProgram(c);m.bindVAO(null);m.drawArrays(g.PrimitiveType.TRIANGLES,0,258);c=new Uint8Array(4);k.readPixels(0,0,1,1,g.PixelFormat.RGBA,g.PixelType.UNSIGNED_BYTE,c);k.dispose();n.dispose();return 255===c[0]};b._prepareProgram=function(){const c=`#version 300 es\n    precision highp float;\n\n    out float triangleId;\n\n    const vec3 triangleVertices[3] = vec3[3](vec3(-0.5, -0.5, 0.0), vec3(0.5, -0.5, 0.0), vec3(0.0, 0.5, 0.0));\n\n    void main(void) {\n      triangleId = floor(float(gl_VertexID)/3.0);\n\n      vec3 position = triangleVertices[gl_VertexID % 3];\n      float offset = triangleId / ${E.glsl.float(85)};\n      position.z = 0.5 - offset;\n\n      gl_Position = vec4(position, 1.0);\n    }\n    `,
m=`#version 300 es\n    precision highp float;\n\n    in float triangleId;\n\n    out vec4 fragColor;\n\n    void main(void) {\n      fragColor = triangleId == ${E.glsl.float(85)} ? vec4(0.0, 1.0, 0.0, 1.0) : vec4(1.0, 0.0, 0.0, 1.0);\n    }\n    `;return this._rctx.programCache.acquire(c,m,new Map([]))};b._prepareHelperProgram=function(){const c=w.AppleAmdDriverHelper.getShaderSources();return this._rctx.programCache.acquire(c.vertex,c.fragment,new Map([]))};return h._createClass(a)}(d.WebGLDriverTestModule);
l.DrawArraysRequiresIndicesTypeReset=d;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/core/shaderModules/interfaces":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(l,h){function D(E,...w){let t="";for(let p=0;p<w.length;p++)t+=E[p]+w[p];return t+=E[E.length-1]}h=h._createClass(function(){});(function(E){E.int=function(w){return Math.round(w).toString()};E.float=function(w){return w.toPrecision(8)}})(D||(D={}));
l.NoParameters=h;l.glsl=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/lib/AppleAmdDriverHelper":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../webgl/BufferObject","../../../webgl/enums"],function(l,h,D,E){let w=function(){function t(g){this._rctx=g;this._indexBuffer=this._createIndexbuffer();this._program=this._createHelperProgram()}t.getShaderSources=function(){return{vertex:"#version 300 es\n    precision highp float;\n\n    void main(void) {\n      gl_Position \x3d vec4(0.0, 0.0, float(gl_VertexID)-2.0, 1.0);\n    }",
fragment:"#version 300 es\n    precision highp float;\n\n    out vec4 fragColor;\n\n    void main(void) {\n      fragColor \x3d vec4(0.0, 0.0, 0.0, 1.0);\n    }"}};var p=t.prototype;p._createHelperProgram=function(){const g=t.getShaderSources();return this._rctx.programCache.acquire(g.vertex,g.fragment,new Map([]))};p._createIndexbuffer=function(){return D.BufferObject.createIndex(this._rctx,E.Usage.STATIC_DRAW,new Uint32Array([0]))};p.resetIndicesType=function(){this._program.compiled&&this._indexBuffer&&
(this._rctx.bindVAO(null),this._rctx.useProgram(this._program),this._rctx.bindBuffer(this._indexBuffer,E.BufferType.ELEMENT_ARRAY_BUFFER),this._rctx.drawElements(E.PrimitiveType.POINTS,1,E.DataType.UNSIGNED_INT,0))};p.dispose=function(){this._program.dispose();this._indexBuffer.dispose()};return h._createClass(t)}();l.AppleAmdDriverHelper=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/WebGLDriverTestModule":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers",
"../../core/maybe"],function(l,h,D){let E=function(){function w(){this._result=!1}w.prototype.dispose=function(){this._program=D.disposeMaybe(this._program)};h._createClass(w,[{key:"result",get:function(){D.isSome(this._program)&&(this._result=this._test(this._program),this.dispose());return this._result}}]);return w}();l.WebGLDriverTestModule=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testDoublePrecisionArithmetic":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/floatRGBA ../../core/has ../../core/maybe ../../chunks/vec3f64 ./BufferObject ./doublePrecisionUtils ./enums ./FramebufferObject ./VertexArrayObject ./VertexElementDescriptor ./WebGLDriverTestModule".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e){function c(m,k){return m.programCache.acquire(`\n\n  precision highp float;\n\n  attribute vec2 position;\n\n  uniform vec3 u_highA;\n  uniform vec3 u_lowA;\n  uniform vec3 u_highB;\n  uniform vec3 u_lowB;\n\n  varying vec4 v_color;\n\n  ${k?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}\n\n  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION\n\n  vec3 dpPlusFrc(vec3 a, vec3 b) {\n    return mix(a, a + b, vec3(notEqual(b, vec3(0))));\n  }\n\n  vec3 dpMinusFrc(vec3 a, vec3 b) {\n    return mix(vec3(0), a - b, vec3(notEqual(a, b)));\n  }\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = dpPlusFrc(hiA, hiB);\n    vec3 e = dpMinusFrc(t1, hiA);\n    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;\n    return t1 + t2;\n  }\n\n  #else\n\n  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {\n    vec3 t1 = hiA + hiB;\n    vec3 e = t1 - hiA;\n    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;\n    return t1 + t2;\n  }\n\n  #endif\n\n  const float MAX_RGBA_FLOAT =\n    255.0 / 256.0 +\n    255.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 +\n    255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n  vec4 float2rgba(const float value) {\n    // Make sure value is in the domain we can represent\n    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n    // Decompose value in 32bit fixed point parts represented as\n    // uint8 rgba components. Decomposition uses the fractional part after multiplying\n    // by a power of 256 (this removes the bits that are represented in the previous\n    // component) and then converts the fractional part to 8bits.\n    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n    // Convert uint8 values (from 0 to 255) to floating point representation for\n    // the shader\n    const float toU8AsFloat = 1.0 / 255.0;\n\n    return fixedPointU8 * toU8AsFloat;\n  }\n\n  void main() {\n    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);\n\n    v_color = float2rgba(val.z / 25.0);\n\n    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);\n  }\n  `,
"\n  precision highp float;\n\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor \x3d v_color;\n  }\n  ",new Map([["position",0]]))}e=function(m){function k(x){var q=n.call(this);q._rctx=x;q._program=c(q._rctx,!1);q._obfuscated=c(q._rctx,!0);return q}h._inherits(k,m);var n=h._createSuper(k);m=k.prototype;m.dispose=function(){h._get(h._getPrototypeOf(k.prototype),"dispose",this).call(this);this._obfuscated=w.disposeMaybe(this._obfuscated)};m._test=function(x){if(E("force-double-precision-obfuscation"))return!0;
if(w.isNone(this._obfuscated))return!1;x=this._runProgram(x);const q=this._runProgram(this._obfuscated);return 0!==x&&(0===q||5<x/q)};m._runProgram=function(x){const q=this._rctx;q.resetState();var B=new d.FramebufferObject(q,{colorTarget:f.TargetType.TEXTURE,depthStencilTarget:f.DepthStencilTargetType.NONE},{target:f.TextureType.TEXTURE_2D,wrapMode:f.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:f.PixelFormat.RGBA,dataType:f.PixelType.UNSIGNED_BYTE,samplingMode:f.TextureSamplingMode.NEAREST,width:1,
height:1}),y=p.BufferObject.createVertex(q,f.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1]));const u=new b.VertexArrayObject(q,new Map([["position",0]]),{geometry:[new a.VertexElementDescriptor("position",2,f.DataType.UNSIGNED_SHORT,0,4)]},{geometry:y}),v=t.fromValues(5633261.287538229,2626832.878767164,1434988.0495278358),r=t.fromValues(5633271.46742708,2626873.6381334523,1434963.231608387),z=new Float32Array(6);g.encodeDoubleArray(v,z,3);const A=new Float32Array(6);g.encodeDoubleArray(r,A,
3);q.useProgram(x);x.setUniform3f("u_highA",z[0],z[2],z[4]);x.setUniform3f("u_lowA",z[1],z[3],z[5]);x.setUniform3f("u_highB",A[0],A[2],A[4]);x.setUniform3f("u_lowB",A[1],A[3],A[5]);q.bindFramebuffer(B);q.setViewport(0,0,1,1);q.bindVAO(u);q.drawArrays(f.PrimitiveType.TRIANGLE_STRIP,0,4);x=new Uint8Array(4);B.readPixels(0,0,1,1,f.PixelFormat.RGBA,f.PixelType.UNSIGNED_BYTE,x);u.dispose(!1);y.dispose();B.dispose();B=(v[2]-r[2])/25;y=D.unpackFloatRGBA(x);return Math.abs(B-y)};return h._createClass(k)}(e.WebGLDriverTestModule);
l.DoublePrecisionRequiresObfuscation=e;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/doublePrecisionUtils":function(){define(["exports"],function(l){const h=new Float32Array(2);l.decodeDoubleArray=function(D,E,w){for(let t=0;t<w;++t)E[t]=D[2*t]+D[2*t+1]};l.encodeDoubleArray=function(D,E,w){for(let t=0;t<w;++t)E[2*t]=D[t],E[2*t+1]=D[t]-E[2*t]};l.encodeDoubleHi=function(D,E){const w=D.length;for(let t=0;t<w;++t)h[0]=D[t],E[t]=h[0];return E};l.encodeDoubleLo=function(D,
E){const w=D.length;for(let t=0;t<w;++t)h[0]=D[t],h[1]=D[t]-h[0],E[t]=h[1];return E};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testFloatBufferBlend":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../3d/webgl-engine/lib/OrderIndependentTransparency ./BufferObject ./context-util ./enums ./FramebufferObject ./renderState ./VertexArrayObject ./VertexElementDescriptor ./WebGLDriverTestModule".split(" "),function(l,h,D,E,w,t,p,g,f,d,b){b=function(a){function e(m){var k=
c.call(this);k._rctx=m;if(!m.gl)return h._possibleConstructorReturn(k);if(m.type===w.ContextType.WEBGL1)return k._result=!(!m.capabilities.textureFloat?.textureFloat||!m.capabilities.colorBufferFloat?.textureFloat),h._possibleConstructorReturn(k);if(!(m.capabilities.textureFloat?.textureFloat&&m.capabilities.colorBufferFloat?.textureFloat&&m.capabilities.colorBufferFloat?.floatBlend))return h._possibleConstructorReturn(k);k._program=m.programCache.acquire("\n    precision highp float;\n    attribute vec2 a_pos;\n\n    void main() {\n      gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",
"\n     precision highp float;\n\n     void main() {\n      gl_FragColor \x3d vec4(0.5, 0.5, 0.5, 0.5);\n     }\n    ",new Map([["a_pos",0]]));return k}h._inherits(e,a);var c=h._createSuper(e);e.prototype._test=function(m){const k=this._rctx,n=new p.FramebufferObject(k,{colorTarget:t.TargetType.TEXTURE,depthStencilTarget:t.DepthStencilTargetType.NONE},{target:t.TextureType.TEXTURE_2D,wrapMode:t.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:t.PixelFormat.RGBA,dataType:t.PixelType.FLOAT,internalFormat:t.SizedPixelFormat.RGBA32F,
samplingMode:t.TextureSamplingMode.NEAREST,width:1,height:1}),x=E.BufferObject.createVertex(k,t.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),q=new f.VertexArrayObject(k,new Map([["a_pos",0]]),{geometry:[new d.VertexElementDescriptor("a_pos",2,t.DataType.UNSIGNED_SHORT,0,4)]},{geometry:x});k.useProgram(m);m=k.getBoundFramebufferObject();const {x:B,y,width:u,height:v}=k.getViewport();k.bindFramebuffer(n);k.setViewport(0,0,1,1);k.bindVAO(q);k.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,4);var r=
g.makePipelineState({blending:D.blendingAlpha});k.setPipelineState(r);k.drawArrays(t.PrimitiveType.TRIANGLE_STRIP,0,4);r=k.gl.getError();k.setViewport(B,y,u,v);k.bindFramebuffer(m);q.dispose(!1);x.dispose();n.dispose();return 1282===r?(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1):!0};return h._createClass(e)}(b.WebGLDriverTestModule);l.FloatBufferBlend=b;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/lib/OrderIndependentTransparency":function(){define(["exports",
"./TransparencyPassType","../../../webgl/enums","../../../webgl/renderState"],function(l,h,D,E){const w=E.separateBlendingParams(D.BlendFactor.SRC_ALPHA,D.BlendFactor.ONE,D.BlendFactor.ONE_MINUS_SRC_ALPHA,D.BlendFactor.ONE_MINUS_SRC_ALPHA),t=E.simpleBlendingParams(D.BlendFactor.ONE,D.BlendFactor.ONE),p=E.simpleBlendingParams(D.BlendFactor.ZERO,D.BlendFactor.ONE_MINUS_SRC_ALPHA),g={factor:-1,units:-2};l.OITPolygonOffset=g;l.OITPolygonOffsetLimit=5E5;l.blendingAlpha=p;l.blendingColor=t;l.blendingDefault=
w;l.getOITPolygonOffset=function(f){return f?g:null};l.oitBlending=function(f){return f===h.TransparencyPassType.FrontFace?null:f===h.TransparencyPassType.Alpha?p:t};l.oitDepthTest=function(f,d=D.CompareFunction.LESS){return f===h.TransparencyPassType.NONE||f===h.TransparencyPassType.FrontFace?d:D.CompareFunction.LEQUAL};l.oitDepthWrite=function(f){return f===h.TransparencyPassType.FrontFace?E.defaultDepthWriteParams:null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/lib/TransparencyPassType":function(){define(["exports"],
function(l){l.TransparencyPassType=void 0;var h=l.TransparencyPassType||(l.TransparencyPassType={});h[h.Color=0]="Color";h[h.Alpha=1]="Alpha";h[h.FrontFace=2]="FrontFace";h[h.NONE=3]="NONE";h[h.COUNT=4]="COUNT";Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testSamplerPrecision":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject ./VertexElementDescriptor ./WebGLDriverTestModule".split(" "),
function(l,h,D,E,w,t,p,g,f,d){d=function(b){function a(c){var m=e.call(this);m._rctx=c;m._program=c.programCache.acquire("\n      precision highp float;\n      attribute vec2 a_pos;\n      uniform highp sampler2D u_texture;\n      varying vec4 v_color;\n\n      float getBit(in float bitset, in int bitIndex) {\n        float offset \x3d pow(2.0, float(bitIndex));\n        return mod(floor(bitset / offset), 2.0);\n      }\n\n      void main() {\n        vec4 value \x3d texture2D(u_texture, vec2(0.0));\n        float bit \x3d getBit(value.x * 255.0, 1);\n\n        v_color \x3d bit * vec4(1.0);\n        gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n      }\n      ",
"\n      precision highp float;\n      varying vec4 v_color;\n\n      void main() {\n        gl_FragColor \x3d v_color;\n      }\n      ",new Map([["a_pos",0]]));return m}h._inherits(a,b);var e=h._createSuper(a);a.prototype._test=function(c){const m=this._rctx,k=new t.FramebufferObject(m,{colorTarget:w.TargetType.TEXTURE,depthStencilTarget:w.DepthStencilTargetType.NONE},{target:w.TextureType.TEXTURE_2D,wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:w.PixelFormat.RGBA,dataType:w.PixelType.UNSIGNED_BYTE,
samplingMode:w.TextureSamplingMode.NEAREST,width:1,height:1}),n=new Uint8Array(4),x=E.BufferObject.createVertex(m,w.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),q=new g.VertexArrayObject(m,new Map([["a_position",0]]),{geometry:[new f.VertexElementDescriptor("a_position",2,w.DataType.SHORT,0,4)]},{geometry:x});m.useProgram(c);var B=new p.Texture(m,{target:w.TextureType.TEXTURE_2D,wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:w.PixelFormat.RGBA,dataType:w.PixelType.UNSIGNED_BYTE,samplingMode:w.TextureSamplingMode.NEAREST,
width:1,height:1},new Uint8Array([2,255,0,0]));c.setUniform1i("u_texture",0);m.bindTexture(B,0);B=m.getBoundFramebufferObject();m.bindFramebuffer(k);m.useProgram(c);const {x:y,y:u,width:v,height:r}=m.getViewport();m.setViewport(0,0,1,1);m.bindVAO(q);m.drawArrays(w.PrimitiveType.TRIANGLE_STRIP,0,4);m.setViewport(y,u,v,r);k.readPixels(0,0,1,1,w.PixelFormat.RGBA,w.PixelType.UNSIGNED_BYTE,n);q.dispose(!1);x.dispose();k.dispose();(c=255!==n[0]||255!==n[1]||255!==n[2]||255!==n[3])&&D.getLogger("esri.views.webgl.testSamplerPrecision").warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${n[0]}.${n[1]}.${n[2]}.${n[3]}]`);
m.bindFramebuffer(B);return c};return h._createClass(a)}(d.WebGLDriverTestModule);l.IgnoresSamplerPrecision=d;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/testSVGPremultipliedAlpha":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../2d/engine/webgl/DefaultVertexAttributeLayouts ./BufferObject ./enums ./FramebufferObject ./Texture ./VertexArrayObject ./WebGLDriverTestModule".split(" "),function(l,h,D,E,w,t,p,g,f){f=function(d){function b(e){var c=
a.call(this);c._rctx=e;c._image=new Image;c._image.src="data:image/svg+xml,%3C%3Fxml version\x3d'1.0' encoding\x3d'UTF-8'%3F%3E%3Csvg width\x3d'5' height\x3d'5' version\x3d'1.1' viewBox\x3d'0 0 5 5' xmlns\x3d'http://www.w3.org/2000/svg'%3E%3Crect width\x3d'5' height\x3d'5' fill\x3d'%23f00' fill-opacity\x3d'.5'/%3E%3C/svg%3E%0A";c._image.width=5;c._image.height=5;c._image.decode();c._program=e.programCache.acquire("\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv \x3d a_pos;\n      gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",
"\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor \x3d texture2D(u_texture, v_uv);\n    }\n    ",new Map([["a_pos",0]]));return c}h._inherits(b,d);var a=h._createSuper(b);d=b.prototype;d.dispose=function(){h._get(h._getPrototypeOf(b.prototype),"dispose",this).call(this);this._image.src=""};d._test=function(e){const c=this._rctx;if(!c.gl)return e.dispose(),!0;const m=new t.FramebufferObject(c,{colorTarget:w.TargetType.TEXTURE,
depthStencilTarget:w.DepthStencilTargetType.NONE},{target:w.TextureType.TEXTURE_2D,wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:w.PixelFormat.RGBA,dataType:w.PixelType.UNSIGNED_BYTE,samplingMode:w.TextureSamplingMode.NEAREST,width:1,height:1}),k=E.BufferObject.createVertex(c,w.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),n=new g.VertexArrayObject(c,new Map([["a_pos",0]]),D.Pos2us,{geometry:k}),x=new p.Texture(c,{dataType:w.PixelType.UNSIGNED_BYTE,pixelFormat:w.PixelFormat.RGBA,preMultiplyAlpha:!1,
wrapMode:w.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:w.TextureSamplingMode.LINEAR},this._image);c.useProgram(e);c.bindTexture(x,0);e.setUniform1i("u_texture",0);e=c.getBoundFramebufferObject();const {x:q,y:B,width:y,height:u}=c.getViewport();c.bindFramebuffer(m);c.setViewport(0,0,1,1);c.setClearColor(0,0,0,0);c.setBlendingEnabled(!1);c.clearSafe(w.ClearBufferBit.COLOR_BUFFER_BIT);c.bindVAO(n);c.drawArrays(w.PrimitiveType.TRIANGLE_STRIP,0,4);const v=new Uint8Array(4);m.readPixels(0,0,1,1,w.PixelFormat.RGBA,
w.PixelType.UNSIGNED_BYTE,v);n.dispose(!1);k.dispose();m.dispose();x.dispose();c.setViewport(q,B,y,u);c.bindFramebuffer(e);return 255!==v[0]};return h._createClass(b)}(f.WebGLDriverTestModule);l.SVGPremultipliedAlpha=f;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/Capabilities":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ./DisjointTimerQuery ./DrawBuffers ./Instancing ./load ./LoseContext ./VertexArrayObjects".split(" "),function(l,
h,D,E,w,t,p,g){let f=function(){function d(b,a){this._gl=b;this._textureFloatLinear=this._depthTexture=this._textureNorm16=this._drawBuffers=this._loseContext=this._minMaxBlending=this._colorBufferFloat=this._textureFloat=this._textureFilterAnisotropic=this._compressedTextureS3TC=this._compressedTextureETC=this._vertexArrayObject=this._instancing=null;this._disabledExtensions=a.disabledExtensions||{};this._debugWebGLExtensions=a.debugWebGLExtensions||{}}d.prototype.enable=function(b){return this[b]};
h._createClass(d,[{key:"drawBuffers",get:function(){this._drawBuffers||(this._drawBuffers=E.load(this._gl,this._disabledExtensions));return this._drawBuffers}},{key:"instancing",get:function(){this._instancing||(this._instancing=w.load(this._gl));return this._instancing}},{key:"vao",get:function(){this._vertexArrayObject||(this._vertexArrayObject=g.load(this._gl,this._disabledExtensions));return this._vertexArrayObject}},{key:"compressedTextureETC",get:function(){this._compressedTextureETC||(this._compressedTextureETC=
t.loadCompressedTextureETC(this._gl,this._disabledExtensions));return this._compressedTextureETC}},{key:"compressedTextureS3TC",get:function(){this._compressedTextureS3TC||(this._compressedTextureS3TC=t.loadCompressedTextureS3TC(this._gl,this._disabledExtensions));return this._compressedTextureS3TC}},{key:"textureFilterAnisotropic",get:function(){this._textureFilterAnisotropic||(this._textureFilterAnisotropic=t.loadTextureFilterAnisotropicCapability(this._gl,this._disabledExtensions));return this._textureFilterAnisotropic}},
{key:"disjointTimerQuery",get:function(){this._disjointTimerQuery||(this._disjointTimerQuery=D.createDisjointTimerQuery(this._gl,this._disabledExtensions));return this._disjointTimerQuery}},{key:"textureFloat",get:function(){this._textureFloat||(this._textureFloat=t.loadTextureFloat(this._gl,this._disabledExtensions));return this._textureFloat}},{key:"colorBufferFloat",get:function(){this._colorBufferFloat||(this._colorBufferFloat=t.loadColorBufferFloat(this._gl,this._disabledExtensions));return this._colorBufferFloat}},
{key:"blendMinMax",get:function(){this._minMaxBlending||(this._minMaxBlending=t.loadMinMaxBlending(this._gl,this._disabledExtensions));return this._minMaxBlending}},{key:"depthTexture",get:function(){null===this._depthTexture&&(this._depthTexture=t.loadBooleanExtension(this._gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return this._depthTexture}},{key:"loseContext",get:function(){this._loseContext||(this._loseContext=
p.load(this._gl,this._debugWebGLExtensions));return this._loseContext}},{key:"textureNorm16",get:function(){this._textureNorm16||(this._textureNorm16=t.loadTextureNorm16(this._gl,this._disabledExtensions));return this._textureNorm16}},{key:"textureFloatLinear",get:function(){null===this._textureFloatLinear&&(this._textureFloatLinear=t.loadBooleanExtension(this._gl,this._disabledExtensions,"textureFloatLinear",!1,["OES_texture_float_linear"]));return this._textureFloatLinear}}]);return d}();l.Capabilities=
f;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/DrawBuffers":function(){define(["exports","./isWebGL2Context"],function(l,h){l.load=function(D,E){return E.disjointTimerQuery?null:h(D)?{drawBuffers:D.drawBuffers.bind(D),MAX_DRAW_BUFFERS:D.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:D.MAX_COLOR_ATTACHMENTS}:E.drawBuffers?null:(D=D.getExtension("WEBGL_draw_buffers"))?{drawBuffers:D.drawBuffersWEBGL.bind(D),MAX_DRAW_BUFFERS:D.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:D.MAX_COLOR_ATTACHMENTS_WEBGL}:
null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/Instancing":function(){define(["exports","./isWebGL2Context"],function(l,h){l.load=function(D){return h(D)?D:(D=D.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:D.drawArraysInstancedANGLE.bind(D),drawElementsInstanced:D.drawElementsInstancedANGLE.bind(D),vertexAttribDivisor:D.vertexAttribDivisorANGLE.bind(D)}:null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/load":function(){define(["exports",
"./isWebGL2Context"],function(l,h){l.loadBooleanExtension=function(D,E,w,t,p){if(t&&h(D))return!0;if(E[w])return!1;for(const g of p)if(D.getExtension(g))return!0;return!1};l.loadColorBufferFloat=function(D,E){if(h(D)){var w=!E.colorBufferHalfFloat&&D.getExtension("EXT_color_buffer_half_float")||!E.colorBufferFloat&&D.getExtension("EXT_color_buffer_float"),t=!E.colorBufferFloat&&D.getExtension("EXT_color_buffer_float");E=!E.floatBlend&&!E.colorBufferFloat&&D.getExtension("EXT_float_blend");return w||
t||E?{textureFloat:!!t,textureHalfFloat:!!w,floatBlend:!!E,R16F:D.R16F,RG16F:D.RG16F,RGBA16F:D.RGBA16F,R32F:D.R32F,RG32F:D.RG32F,RGBA32F:D.RGBA32F,R11F_G11F_B10F:D.R11F_G11F_B10F,RGB16F:D.RGB16F}:null}return D instanceof WebGLRenderingContext?(w=!E.colorBufferHalfFloat&&D.getExtension("EXT_color_buffer_half_float"),t=!E.colorBufferFloat&&D.getExtension("WEBGL_color_buffer_float"),D=!E.floatBlend&&!E.colorBufferFloat&&D.getExtension("EXT_float_blend"),w||t||D?{textureFloat:!!t,textureHalfFloat:!!w,
floatBlend:!!D,RGBA16F:w?w.RGBA16F_EXT:void 0,RGB16F:w?w.RGB16F_EXT:void 0,RGBA32F:t?t.RGBA32F_EXT:void 0}:null):null};l.loadCompressedTextureETC=function(D,E){return E.compressedTextureETC?null:(D=D.getExtension("WEBGL_compressed_texture_etc"))?{COMPRESSED_R11_EAC:D.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:D.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:D.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:D.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:D.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:D.COMPRESSED_SRGB8_ETC2,
COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:D.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:D.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:D.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:D.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null};l.loadCompressedTextureS3TC=function(D,E){return E.compressedTextureS3TC?null:(D=D.getExtension("WEBGL_compressed_texture_s3tc"))?{COMPRESSED_RGB_S3TC_DXT1:D.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:D.COMPRESSED_RGBA_S3TC_DXT1_EXT,
COMPRESSED_RGBA_S3TC_DXT3:D.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:D.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null};l.loadMinMaxBlending=function(D,E){return h(D)?{MIN:D.MIN,MAX:D.MAX}:E.blendMinMax?null:(D=D.getExtension("EXT_blend_minmax"))?{MIN:D.MIN_EXT,MAX:D.MAX_EXT}:null};l.loadTextureFilterAnisotropicCapability=function(D,E){return E.textureFilterAnisotropic?null:(D=D.getExtension("EXT_texture_filter_anisotropic")||D.getExtension("MOZ_EXT_texture_filter_anisotropic")||D.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))?
{MAX_TEXTURE_MAX_ANISOTROPY:D.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:D.TEXTURE_MAX_ANISOTROPY_EXT}:null};l.loadTextureFloat=function(D,E){if(h(D))return{textureFloat:!0,textureFloatLinear:!E.textureFloatLinear&&!!D.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!0,HALF_FLOAT:D.HALF_FLOAT,R16F:D.R16F,RG16F:D.RG16F,RGBA16F:D.RGBA16F,R32F:D.R32F,RG32F:D.RG32F,RGBA32F:D.RGBA32F,R11F_G11F_B10F:D.R11F_G11F_B10F,RGB16F:D.RGB16F};if(D instanceof WebGLRenderingContext){const w=
!E.textureHalfFloat&&D.getExtension("OES_texture_half_float");return{textureFloat:!E.textureFloat&&!!D.getExtension("OES_texture_float"),textureFloatLinear:!E.textureFloatLinear&&!!D.getExtension("OES_texture_float_linear"),textureHalfFloat:!!w,textureHalfFloatLinear:!E.textureHalfFloatLinear&&!!D.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:w?w.HALF_FLOAT_OES:void 0}}return null};l.loadTextureNorm16=function(D,E){return!h(D)||E.textureNorm16?null:(D=D.getExtension("EXT_texture_norm16"))?
{R16:D.R16_EXT,RG16:D.RG16_EXT,RGB16:D.RGB16_EXT,RGBA16:D.RGBA16_EXT,R16_SNORM:D.R16_SNORM_EXT,RG16_SNORM:D.RG16_SNORM_EXT,RGB16_SNORM:D.RGB16_SNORM_EXT,RGBA16_SNORM:D.RGBA16_SNORM_EXT}:null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/LoseContext":function(){define(["exports"],function(l){l.load=function(h,D){const E=D.loseContext&&h.getExtension("WEBGL_lose_context");return E?{loseRenderingContext:()=>E.loseContext()}:null};Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["exports","./isWebGL2Context"],function(l,h){l.load=function(D,E){return h(D)?{createVertexArray:D.createVertexArray.bind(D),deleteVertexArray:D.deleteVertexArray.bind(D),bindVertexArray:D.bindVertexArray.bind(D)}:E.vao?null:(D=D.getExtension("OES_vertex_array_object")||D.getExtension("MOZ_OES_vertex_array_object")||D.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:D.createVertexArrayOES.bind(D),
deleteVertexArray:D.deleteVertexArrayOES.bind(D),bindVertexArray:D.bindVertexArrayOES.bind(D)}:null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/HandleOwner ../../core/has ../../core/Logger ../../core/maybe ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/accessorSupport/decorators/subclass ./engine/webgl/collisions/CollisionEngine".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c){D=function(m){function k(x){x=n.call(this,x);x._applyVisibilityPassThrottled=f.throttle(x._applyVisibilityPass,32,l._assertThisInitialized(x));x.lastUpdateId=-1;x.updateRequested=!1;x.view=null;return x}l._inherits(k,m);var n=l._createSuper(k);m=k.prototype;m.initialize=function(){this.collisionEngine=new c.CollisionEngine};m.destroy=function(){this.collisionEngine=null;this._applyVisibilityPassThrottled=g.removeMaybe(this._applyVisibilityPassThrottled)};m.update=
function(x){this._applyVisibilityPassThrottled(x)};m.viewChange=function(){this.requestUpdate()};m.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view?.requestUpdate())};m.processUpdate=function(x){this._set("updateParameters",x);this.updateRequested&&(this.updateRequested=!1,this.update(x))};m._applyVisibilityPass=function(x){const q=this.view;if(q)try{const B=q.featuresTilingScheme.getClosestInfoForScale(x.state.scale).level;this.collisionEngine.run(q.allLayerViews.items,
x,B)}catch(B){}};l._createClass(k,[{key:"updating",get:function(){t("esri-2d-log-updating")&&console.log(`Updating LabelManager ${this.updateRequested}:\n-> updateRequested: ${this.updateRequested}`);return this.updateRequested}}]);return k}(w.HandleOwnerMixin(D));h.__decorate([d.property()],D.prototype,"updateRequested",void 0);h.__decorate([d.property({readOnly:!0})],D.prototype,"updateParameters",void 0);h.__decorate([d.property()],D.prototype,"updating",null);h.__decorate([d.property()],D.prototype,
"view",void 0);return D=h.__decorate([e.subclass("esri.views.2d.layers.labels.LabelManager")],D)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../core/screenUtils ../definitions ./CollisionGrid ./visualVariableSimpleUtils".split(" "),function(l,h,D,E,w,t,p){function g(a,e){const c=[];a.forEachTile(m=>c.push(m));c.sort((m,k)=>m.instanceId-k.instanceId);c.forEach(m=>{D.isSome(m.labelMetrics)&&
m.isReady&&e(m,m.labelMetrics.getCursor())})}function f(a){return e=>E.pt2px(p.getSizeForValueSimple(e,a))}function d(a){for(const e of a)if(a=("featureReduction"in e&&e.featureReduction&&"labelingInfo"in e.featureReduction?e.featureReduction:void 0)?.labelingInfo||[],a=[...(e.labelingInfo||[]),...a],e.labelsVisible&&a.length&&a.some(c=>"none"===c.deconflictionStrategy))return!0;return!1}let b=function(){function a(){}var e=a.prototype;e.run=function(c,m,k){const n=[];for(let y=c.length-1;0<=y;y--)a:{var x=
n,q=c[y];if(!q.layer||"feature"!==q.layer.type&&"csv"!==q.layer.type&&"geojson"!==q.layer.type&&"ogc-feature"!==q.layer.type&&"stream"!==q.layer.type&&"subtype-group"!==q.layer.type&&"wfs"!==q.layer.type)break a;const u=q.layer.geometryType,v=!d("subtype-group"===q.layer.type?q.layer.sublayers.items:[q.layer]),r={};if("subtype-group"!==q.layer.type){if("heatmap"===q.tileRenderer?.type)break a;b:{var B=q.layer.renderer;if(B=null!=B&&"visualVariables"in B&&B.visualVariables)for(const z of B)if("size"===
z.type){B=f(z);break b}B=null}r[0]=B}B=q.tileRenderer;D.isNone(B)||x.push({tileRenderer:B,vvEvaluators:r,deconflictionEnabled:v,geometryType:u,visible:q.layer.visible&&!q.suspended})}this._transformMetrics(n);this._runCollision(n,m,k)};e._runCollision=function(c,m,k){const [n,x]=m.state.size,q=new t.CollisionBitsetGrid(n,x,m.pixelRatio);for(const {tileRenderer:B,deconflictionEnabled:y,visible:u}of c){const v=B.featuresView.attributeView;y?u?(this._prepare(B),this._collideVisible(q,B,k),this._collideInvisible(q,
B)):g(B,(r,z)=>{for(;z.nextId();)v.setLabelMinZoom(z.id,255)}):g(B,(r,z)=>{for(;z.nextId();)v.setLabelMinZoom(z.id,0),u&&q.insertMetrics(z)})}};e._isFiltered=function(c,m,k){m=m.getFilterFlags(c);c=!k.hasFilter||!!(m&w.FILTER_FLAG_0);k=D.isNone(k.featureEffect)||k.featureEffect.excludedLabelsVisible||!!(m&w.EFFECT_FLAG_0);return!(c&&k)};e._prepare=function(c){const m=c.featuresView.attributeView,k=new Set;g(c,(n,x)=>{for(;x.nextId();)k.has(x.id)||(k.add(x.id),this._isFiltered(x.id,m,c.layerView)?
m.setLabelMinZoom(x.id,254):0!==m.getLabelMinZoom(x.id)?m.setLabelMinZoom(x.id,255):m.setLabelMinZoom(x.id,0))})};e._collideVisible=function(c,m,k){const n=m.featuresView.attributeView,x=new Set;g(m,(q,B)=>{for(;B.nextId();)if(!x.has(B.id))if(q.key.level!==k)n.setLabelMinZoom(B.id,254);else if(0===n.getLabelMinZoom(B.id))switch(c.insertMetrics(B)){case t.HAS_COLLISION:n.setLabelMinZoom(B.id,254);x.add(B.id);break;case t.NONE:n.setLabelMinZoom(B.id,0),x.add(B.id)}})};e._collideInvisible=function(c,
m){const k=m.featuresView.attributeView,n=new Set;g(m,(x,q)=>{for(;q.nextId();)if(!n.has(q.id)&&255===k.getLabelMinZoom(q.id))switch(c.insertMetrics(q)){case t.HAS_COLLISION:k.setLabelMinZoom(q.id,255);n.add(q.id);break;case t.NONE:k.setLabelMinZoom(q.id,0),n.add(q.id)}})};e._transformMetrics=function(c){for(const {tileRenderer:m,geometryType:k,vvEvaluators:n}of c)g(m,(x,q)=>{const B=m.featuresView.attributeView;x=x.transforms.labelMat2d;x[4]=Math.round(x[4]);x[5]=Math.round(x[5]);const y="polyline"===
k;for(;q.next();){const C=q.boundsCount,F=q.anchorX,G=q.anchorY;var u=q.size,v=n[0];if(D.isSome(v)){var r=B.getVVSize(q.id);v=v(r);u=isNaN(v)||null==v||Infinity===v?u:v}v=u/2*q.directionX;u=u/2*q.directionY;for(r=0;r<C;r++){var z=F,A=q.anchorY;y?(z=z+q.boundsX(r)+v,A=A+q.boundsY(r)+u,z=x[0]*z+x[2]*A+x[4],A=x[1]*z+x[3]*A+x[5],q.setBoundsComputedAnchorX(r,Math.floor(z)),q.setBoundsComputedAnchorY(r,Math.floor(A))):(z=x[0]*F+x[2]*G+x[4],A=x[1]*F+x[3]*G+x[5],z=z+q.boundsX(r)+v,A=A+q.boundsY(r)+u,q.setBoundsComputedAnchorX(r,
z),q.setBoundsComputedAnchorY(r,A))}}})};return h._createClass(a)}();l.CollisionEngine=b;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/mathUtils","../../../layers/features/support/StaticBitSet"],function(l,h,D,E){let w=function(){function t(g,f,d){this._debugMap=new Map;this._width=g*d;this._height=f*d;this._pixelRatio=d;g=Math.ceil(this._width/
1);f=Math.ceil(this._height/1);this._cols=g;this._rows=f;this._cells=E.StaticBitSet.create(g*f)}var p=t.prototype;p.insertMetrics=function(g){const f=this._hasCollision(g);0===f&&this._markMetrics(g);return f};p.getCellId=function(g,f){return g+f*this._cols};p.has=function(g){return this._cells.has(g)};p.hasRange=function(g,f){return this._cells.hasRange(g,f)};p.set=function(g){this._cells.set(g)};p.setRange=function(g,f){this._cells.setRange(g,f)};p._collide=function(g,f,d,b){g-=d/2;f-=b/2;d=g+d;
var a=f+b;if(0>d||0>a||g>this._width||f>this._height)return 1;b=D.clamp(Math.floor(g/1),0,this._cols);var e=D.clamp(Math.floor(f/1),0,this._rows);g=D.clamp(Math.ceil(d/1),0,this._cols);f=D.clamp(Math.ceil(a/1),0,this._rows);for(d=e;d<=f;d++)for(a=b;a<=g;a++)if(e=this.getCellId(a,d),this.has(e))return 2;return 0};p._mark=function(g,f,d,b,a){g-=d/2;f-=b/2;d=g+d;var e=f+b;b=D.clamp(Math.floor(g/1),0,this._cols);var c=D.clamp(Math.floor(f/1),0,this._rows);g=D.clamp(Math.ceil(d/1),0,this._cols);f=D.clamp(Math.ceil(e/
1),0,this._rows);for(d=c;d<=f;d++)for(e=b;e<=g;e++)c=this.getCellId(e,d),this._debugMap.set(c,a),this.set(c);return!1};p._hasCollision=function(g){const f=g.id;let d=0,b=0;g.save();do{const a=g.boundsCount;d+=a;for(let e=0;e<a;e++){const c=g.boundsComputedAnchorX(e),m=g.boundsComputedAnchorY(e),k=(g.boundsWidth(e)+2)*this._pixelRatio,n=(g.boundsHeight(e)+2)*this._pixelRatio;switch(this._collide(c,m,k,n)){case 2:return 2;case 1:b++}}}while(g.peekId()===f&&g.next());g.restore();return d===b?1:0};p._markMetrics=
function(g){const f=g.id;g.save();do{const d=g.boundsCount;for(let b=0;b<d;b++){const a=g.boundsComputedAnchorX(b),e=g.boundsComputedAnchorY(b),c=(g.boundsWidth(b)+2)*this._pixelRatio,m=(g.boundsHeight(b)+2)*this._pixelRatio;this._mark(a,e,c,m,g.id)}}while(g.peekId()===f&&g.next());g.restore()};return h._createClass(t)}();l.CollisionBitsetGrid=w;l.HAS_COLLISION=2;l.NONE=0;l.OUTSIDE_EXTENT=1;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers"],function(l,h){let D=function(){function E(t,p){this._mask=0;this._buf=t;this._mask=p}E.fromBuffer=function(t,p){return new E(t,p)};E.create=function(t,p=4294967295){t=new Uint32Array(Math.ceil(t/32));return new E(t,p)};var w=E.prototype;w._getIndex=function(t){return Math.floor(t/32)};w.has=function(t){t&=this._mask;return!!(this._buf[this._getIndex(t)]&1<<t%32)};w.hasRange=function(t,p){for(;t%32&&t!==p;){if(this.has(t))return!0;t++}for(;p%32&&t!==
p;){if(this.has(t))return!0;p--}if(t===p)return!1;for(t/=32;t!==p/32;t++)if(this._buf[t])return!0;return!1};w.set=function(t){t&=this._mask;const p=this._getIndex(t);this._buf[p]|=1<<t%32};w.setRange=function(t,p){for(;t%32&&t!==p;)this.set(t++);for(;p%32&&t!==p;)this.set(p--);if(t!==p)for(t/=32;t!==p/32;t++)this._buf[t]=4294967295};w.unset=function(t){t&=this._mask;const p=this._getIndex(t);this._buf[p]&=4294967295^1<<t%32};w.resize=function(t){const p=this._buf;t=new Uint32Array(Math.ceil(t/32));
t.set(p);this._buf=t};w.or=function(t){for(let p=0;p<this._buf.length;p++)this._buf[p]|=t._buf[p];return this};w.and=function(t){for(let p=0;p<this._buf.length;p++)this._buf[p]&=t._buf[p];return this};w.xor=function(t){for(let p=0;p<this._buf.length;p++)this._buf[p]^=t._buf[p];return this};w.ior=function(t){for(let p=0;p<this._buf.length;p++)this._buf[p]|=~t._buf[p];return this};w.iand=function(t){for(let p=0;p<this._buf.length;p++)this._buf[p]&=~t._buf[p];return this};w.ixor=function(t){for(let p=
0;p<this._buf.length;p++)this._buf[p]^=~t._buf[p];return this};w.any=function(){for(let t=0;t<this._buf.length;t++)if(this._buf[t])return!0;return!1};w.copy=function(t){for(let p=0;p<this._buf.length;p++)this._buf[p]=t._buf[p];return this};w.clone=function(){return new E(this._buf.slice(),this._mask)};w.clear=function(){for(let t=0;t<this._buf.length;t++)this._buf[t]=0};w.forEachSet=function(t){for(let p=0;p<this._buf.length;p++){let g=this._buf[p],f=32*p;if(g)for(;g;)g&1&&t(f),g>>>=1,f++}};w.countSet=
function(){let t=0;this.forEachSet(p=>{t++});return t};return h._createClass(E)}();l.StaticBitSet=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports","../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils","../../../../../renderers/visualVariables/support/sizeVariableUtils"],function(l,h,D,E){function w(f,d){switch(d.transformationType){case E.TransformationType.Additive:var b=
t(d.minSize,f);return f+(b||d.minDataValue);case E.TransformationType.Constant:return b=(b=d.stops)&&b.length&&b[0].size,null==b&&(b=d.minSize),t(b,f);case E.TransformationType.ClampedLinear:b=d.minDataValue;var a=d.maxDataValue,e=(f-b)/(a-b),c=t(d.minSize,f);d=t(d.maxSize,f);f=f<=b?c:f>=a?d:c+e*(d-c);return f;case E.TransformationType.Proportional:return b=f/d.minDataValue,a=t(d.minSize,f),f=t(d.maxSize,f),h.clamp(b*a,a,f);case E.TransformationType.Stops:{const [m,k,n]=p(f,d.cache.ipData);m===k?
f=t(d.stops[m].size,f):(b=t(d.stops[m].size,f),f=t(d.stops[k].size,f),f=b+(f-b)*n)}return f;case E.TransformationType.RealWorldSize:return b=D.meterIn[d.valueUnit],a=t(d.minSize,f),e=t(d.maxSize,f),{valueRepresentation:d}=d,c=null,c="area"===d?2*Math.sqrt(f/g)/b:"radius"===d||"distance"===d?2*f/b:f/b,h.clamp(c,a,e);case E.TransformationType.Identity:return f;case E.TransformationType.Unknown:return null}}function t(f,d){return"number"===typeof f?f:w(d,f)}function p(f,d){if(d){var b=0,a=d.length-1;
d.some((e,c)=>{if(f<e)return a=c,!0;b=c;return!1});return[b,a,(f-d[b])/(d[a]-d[b])]}}const g=Math.PI;l.getSizeForValueSimple=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/BidiText ../../../../core/HandleOwner ../../../../core/has ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/coordsUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtilsSync ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/data/projectionSupport ../../../../symbols/cim/CIMSymbolHelper ../../../../symbols/support/defaults ../../engine/webgl/definitions ../../engine/webgl/enums ../../engine/webgl/GraphicTile ../../engine/webgl/TileData ../../engine/webgl/WGLDisplayObject ../../engine/webgl/mesh/MeshData ../../engine/webgl/mesh/factories/WGLMeshFactory ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/util/Matcher ../features/schemaUtils ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ./GraphicStore ./graphicsUtils ../support/cimSymbolUtils ../../../layers/GraphicsView ../../../webgl/capabilities ../features/createSymbolSchema".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q,B,y,u,v,r,z,A,C,F,G,H,K,J,N,P,W,X,aa,Z,ea,T,I){function M(V,Q,Y){let L=Y.get(V);L||(L={tile:Q,addedOrModified:[],removed:[]},Y.set(V,L));return L}const S=t("esri-2d-graphic-debug");D=function(V){function Q(L){L=Y.call(this,L);L._storage=new P.ComputedAttributeStorage;L._displayIds=new Map;L._controller=new AbortController;L._tiles=new Map;L._graphicStoreUpdate=!1;L._graphicsSet=new Set;L._matcher=Promise.resolve(null);L._tileUpdateSet=new Set;L._tilesToUpdate=
new Map;L._graphicIdToAbortController=new Map;L._attached=!1;L._updatingGraphicsTimer=null;L._hashToExpandedSymbol=new Map;L._hashToExpandedSymbolPromise=new Map;L._hashToCIMSymbolPromise=new Map;L._hashToCIM=new Map;L._processing=!1;L._needsProcessing=!1;L._pendingUpdate={added:new Set,updated:new Set,removed:new Set};L.lastUpdateId=-1;L.updateRequested=!1;L.defaultPointSymbolEnabled=!0;L.graphicUpdateHandler=L.graphicUpdateHandler.bind(l._assertThisInitialized(L));return L}l._inherits(Q,V);var Y=
l._createSuper(Q);V=Q.prototype;V.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this._controller.abort();this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._attributeStore=null;this._hashToExpandedSymbol.clear();this.renderer=this.view=null;this._hashToCIM.clear();this._hashToCIMSymbolPromise.clear();this._hashToExpandedSymbolPromise.clear()};V._createMatcher=
function(L,O,R){if(L){const U=J.createSymbolSchemaOptions(L);L=J.createMatcherSchema({indexCount:0,fields:{}},"feature",L,U);this._matcher=K.createMatcher(L,O,null,R)}};V._createDisplayId=function(L){let O=this._displayIds.get(L);O||(O=this._storage.createDisplayId(),this._displayIds.set(L,O));return O};V.initialize=function(){this._attributeStore=new N({type:"local",initialize:O=>Promise.resolve(this.container.attributeView.initialize(O)),update:O=>this.container.attributeView.requestUpdate(O),render:()=>
this.container.requestRender()},T.getWebGLCapabilities("2d"));this.container.hasHighlight=()=>this._attributeStore.hasHighlight;const L=new H.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),this.view.featuresTilingScheme.tileInfo);this._graphicStore=new X(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,O=>{this._createDisplayId(O.uid);this._setFilterState(O.uid,O.visible)},O=>{const R=this._displayIds.get(O.uid);this._displayIds.delete(O.uid);this._storage.releaseDisplayId(R)},
this._hashToCIM);this._meshFactory=new G.WGLMeshFactory(null,this.uid,L);this._templateStore=L;this.handles.add([f.watch(()=>this.renderer,O=>{this._createMatcher(O,L,this.container.stage.resourceManager);for(const R of this.graphics)this._pendingUpdate.updated.add(R);this.requestUpdate()}),this.view.graphicsTileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",()=>{S&&this.container.enableRenderingBounds(()=>this._graphicStore.getAllBounds());0<this.graphics.items.length&&
this._graphicsChangeHandler({target:this.graphics,added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",R=>this._graphicsChangeHandler(R)),"graphics");const O=this.container.stage.resourceManager;this._createMatcher(this.renderer,L,O);this._graphicStore.setResourceManager(O);this._attached=!0;this.notifyChange("updating")})]);this._onTileUpdate({added:this.view.graphicsTileStore.tiles,removed:[]})};V.hitTest=function(L){if(!this.view||!this.view.position)return[];
const {resolution:O,rotation:R}=this.view.state;return this._graphicStore.hitTest(L.x,L.y,2,O,R)};V.update=function(L){g.throwIfAborted(this._controller.signal);({resolution:L}=L.state);this._graphicStore.updateLevel(L);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};V.viewChange=function(){this.requestUpdate()};V.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};
V.processUpdate=function(L){this.updateRequested&&(this.updateRequested=!1,this.update(L))};V.graphicUpdateHandler=function(L){const {graphic:O,property:R}=L;switch(R){case "attributes":case "geometry":case "symbol":this._pendingUpdate.updated.add(O);this.requestUpdate();break;case "visible":this._setFilterState(O.uid,O.visible),this._attributeStore.sendUpdates()}};V.setHighlight=function(L){const O=L.map(R=>this._displayIds.get(R)).filter(p.isSome);this._attributeStore.setHighlight(L,O)};V._getIntersectingTiles=
function(L){L=this._graphicStore.getBounds(L);if(!L||0===m.width(L)||0===m.height(L))return[];const O=aa.intersectingInternationalDateline(L,this.view.spatialReference);return p.isSome(O)?[...(new Set([...this.view.graphicsTileStore.boundsIntersections(O[0]),...this.view.graphicsTileStore.boundsIntersections(O[1])]))]:this.view.graphicsTileStore.boundsIntersections(L)};V._updateTile=async function(L){g.throwIfAborted(this._controller.signal);const O=L.tile;var R=this._getGraphicsData(this._templateStore,
O,L.addedOrModified);R=await this._processGraphics(O,R);g.throwIfAborted(this._controller.signal);this._patchTile(O.key,{type:"update",addOrUpdate:R,remove:L.removed,end:!0,clear:!1,sort:!1});return R};V._patchTile=function(L,O){if(L=this._tiles.get(L))this.container.onTileData(L,O),this.container.requestRender()};V._graphicsChangeHandler=function(L){const O=this._pendingUpdate;for(const R of L.added)O.added.add(R);for(const R of L.moved)O.updated.add(R);for(const R of L.removed)this._pendingUpdate.added.has(R)?
O.added.delete(R):O.removed.add(R);this._processing?this._needsProcessing=!0:this._updateGraphics()};V._getGraphicsToUpdate=function(){const L={added:[],removed:[],updated:[]};if(!this.graphics)return L;const O=this._pendingUpdate;for(const R of this.graphics.items)O.added.has(R)?L.added.push(R):O.updated.has(R)&&L.updated.push(R);for(const R of O.removed)this._graphicStore.has(R)&&L.removed.push(R);O.added.clear();O.removed.clear();O.updated.clear();return L};V._updateGraphics=async function(){this._processing=
!0;const {added:L,removed:O,updated:R}=this._getGraphicsToUpdate(),U=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var {resolution:ba}=this.view.state;this._graphicStore.updateLevel(ba)}ba=[];const ia=Array(L.length+O.length);for(let fa=0;fa<R.length;fa++){var ca=R[fa];const ka=this._getIntersectingTiles(ca);for(const la of ka){var da=la.id;M(da,la,U).removed.push(this._displayIds.get(ca.uid))}ba.push(this._updateGraphic(ca,null));ia[fa]=ca}var ha=R.length;for(ca=0;ca<L.length;ca++){const fa=
L[ca];ia[ha+ca]=fa;this._graphicsSet.add(fa);ba.push(this._addGraphic(fa))}for(const fa of O){this._abortProcessingGraphic(fa.uid);const ka=this._getIntersectingTiles(fa);for(const la of ka)da=la.id,M(da,la,U).removed.push(this._displayIds.get(fa.uid));this._graphicsSet.delete(fa);this._graphicStore.remove(fa)}this._flipUpdatingGraphics();await Promise.all(ba);let ja;for(ha=0;ha<ia.length;ha++){ja=ia[ha];const fa=this._getIntersectingTiles(ja);for(const ka of fa)da=ka.id,M(da,ka,U).addedOrModified.push(ja)}this._graphicStore.updateZ();
da=[];for(const [,fa]of U)da.push(this._updateTile(fa));await Promise.all(da)}catch(ia){g.isAbortError(ia)}for(const ia of O)try{const ja=await this._getSymbolForGraphic(ia,null);if(ja){const fa=ja.hash();this._hashToExpandedSymbol.delete(fa)}}catch(ja){g.isAbortError(ja)}U.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&(this._needsProcessing=!1,this._updateGraphics())};V._getArcadeInfo=function(L){const O=(L.attributes?Object.keys(L.attributes):[]).map(R=>({name:R,
alias:R,type:"string"===typeof L.attributes[R]?"esriFieldTypeString":"esriFieldTypeDouble"}));return p.isNone(L.geometry)?null:{geometryType:n.getJsonType(L.geometry),spatialReference:c.fromJSON(L.geometry.spatialReference),fields:O}};V._getSymbolForGraphic=function(L,O){g.throwIfAborted(this._controller.signal);return p.isSome(L.symbol)?Promise.resolve(L.symbol):p.isSome(this.renderer)?this.renderer.getSymbolAsync(L,{scale:this.view.scale,signal:p.isSome(O)?O.signal:null}):Promise.resolve(this._getNullSymbol(L))};
V._getCIMSymbol=function(L,O,R){var U=this._hashToCIM.get(O);if(U)return Promise.resolve(U);L=y.symbolToCIM(L);if(p.isSome(L)){if("CIMSymbolReference"===L.type)return U=L,this._hashToCIM.set(O,U),Promise.resolve(U);if(U=this._hashToCIMSymbolPromise.get(O))return U;U=L.fetchCIMSymbol(R).then(ba=>{this._hashToCIM.set(O,ba.data);this._hashToCIMSymbolPromise.delete(O);return ba}).catch(ba=>{this._hashToCIMSymbolPromise.delete(O);g.throwIfAbortError(ba);return null});this._hashToCIMSymbolPromise.set(O,
U);return U}return Promise.resolve(null)};V._expandCIMSymbol=function(L,O,R,U){var ba=this._hashToExpandedSymbol.get(R);if(ba)return Promise.resolve(ba);if(ba=this._hashToExpandedSymbolPromise.get(R))return ba;ba=this.container.stage;O=this._getArcadeInfo(O);const ca=J.createSymbolSchemaOptions(null);L=I.createSymbolSchema(L,ca);ba=Z.expandSymbol(L,O,ba.resourceManager,U);this._hashToExpandedSymbolPromise.set(R,ba);ba.then(da=>{this._hashToExpandedSymbol.set(R,da);this._hashToExpandedSymbolPromise.delete(R);
return da});return ba};V._getSymbolResources=async function(L,O){g.throwIfAborted(this._controller.signal);return this.container.stage?this._getSymbolForGraphic(L,O).then(R=>{if(!R)return null;const U=R.hash();return this._getCIMSymbol(R,U,O).then(ba=>p.isNone(ba)?null:this._expandCIMSymbol(ba,L,U,O).then(ca=>{const da=ca.layers.filter(ha=>"text"===ha.type&&"string"===typeof ha.text);if(da&&0<da.length){const ha=Array(da.length);for(let ja=0;ja<da.length;ja++){const fa=da[ja],ka=[],[la]=E.bidiText(fa.text);
fa.text=la;for(let ma=0;ma<la.length;ma++)ka.push(la.charCodeAt(ma));ha[ja]={symbol:fa,id:ja,glyphIds:ka}}const ia=new Map;return this.container.getMaterialItems(ha).then(ja=>{p.assertIsSome(ja);for(let fa=0;fa<da.length;fa++){const ka=da[fa];ia.set(ka.cim,{text:ka.text,mosaicItem:ja[fa].mosaicItem})}return{symbol:ca,textInfo:ia,hash:U}})}return{symbol:ca,hash:U}}))}).catch(R=>{g.throwIfAbortError(R);return null}):null};V._projectAndNormalizeGeometry=async function(L,O){g.throwIfAborted(this._controller.signal);
if(p.isNone(L.geometry)||"mesh"===L.geometry.type)return null;var R=L.geometry;n.isPolygon(R)?R.rings=R.rings:n.isPolyline(R)?R.paths=R.paths:n.isExtent(R)&&(L=await this._getSymbolForGraphic(L,O),g.throwIfAborted(this._controller.signal),R=L&&(aa.isMarkerSymbol(L.type)||aa.isTextSymbol(L.type))?R.center:aa.polygonFromExtent(R));await B.checkProjectionSupport(R.spatialReference,this.view.spatialReference);L=x.normalizeCentralMeridianForDisplay(R);(R=B.project(L,R.spatialReference,this.view.spatialReference))&&
k.closeRingsAndFixWinding(R);return R};V._onTileUpdate=function(L){const O=q.getInfo(this.view.spatialReference);if(L.added&&0<L.added.length)for(const R of L.added)this._addNewTile(R,O);if(L.removed&&0<L.removed.length)for(const R of L.removed)this._removeTile(R.key)};V._addGraphic=async function(L){this._abortProcessingGraphic(L.uid);g.throwIfAborted(this._controller.signal);var O=new AbortController;this._graphicIdToAbortController.set(L.uid,O);O={signal:O.signal};try{await this._addOrUpdateGraphic(L,
O),g.throwIfAborted(this._controller.signal),this._graphicIdToAbortController.delete(L.uid)}catch(R){if(this._graphicIdToAbortController.delete(L.uid),!g.isAbortError(R))throw R;}};V._updateGraphic=function(L,O){g.throwIfAborted(this._controller.signal);const R=this._projectAndNormalizeGeometry(L,O);O=this._getSymbolResources(L,O);return Promise.all([R,O]).then(([U,ba])=>{g.throwIfAborted(this._controller.signal);this._graphicStore.addOrModify(L,ba,U)})};V._addOrUpdateGraphic=function(L,O){g.throwIfAborted(this._controller.signal);
const R=this._projectAndNormalizeGeometry(L,O);O=this._getSymbolResources(L,O);return Promise.all([R,O]).then(([U,ba])=>{g.throwIfAborted(this._controller.signal);this._graphicsSet.has(L)&&this._graphicStore.addOrModify(L,ba,U)})};V._addTile=function(L){var O=this.view.featuresTilingScheme.getTileBounds(m.create(),L);const R=this.view.featuresTilingScheme.getTileResolution(L.level);O=new z.GraphicTile(L,R,O[0],O[3]);this._tiles.set(L,O);this.container.addChild(O);return O};V._addNewTile=async function(L,
O){const R=this._addTile(L.key),U=this._graphicStore.queryTileData(this._templateStore,L);if(0!==U.length){if(O){O=Math.round((O.valid[1]-O.valid[0])/L.resolution);for(var ba of U)ba.geometry&&(n.isPoint(ba.geometry)||n.isMultipoint(ba.geometry))&&this._wrapPoints(ba,O)}ba=L.key;this._tileUpdateSet.add(L.key);this.notifyChange("updating");try{const ca={type:"update",clear:!1,addOrUpdate:await this._processGraphics(L,U),remove:[],end:!0,sort:!1};R.patch(ca);this._tileUpdateSet.delete(ba);this.notifyChange("updating")}catch(ca){if(this._tileUpdateSet.delete(ba),
this.notifyChange("updating"),!g.isAbortError(ca))throw ca;}}};V._removeTile=function(L){if(this._tiles.has(L)){var O=this._tiles.get(L);this.container.removeChild(O);O.destroy();this._tiles.delete(L)}};V._setFilterState=function(L,O){const R=this._displayIds.get(L);L=this._attributeStore.getHighlightFlag(L);this._attributeStore.setData(R,0,0,L|(O?v.FILTER_FLAG_0:0))};V._getGraphicsData=function(L,O,R){const U=q.getInfo(this.view.spatialReference);L=this._graphicStore.getGraphicsData(L,O,R);if(U){O=
Math.round((U.valid[1]-U.valid[0])/O.resolution);for(const ba of L)ba.geometry&&(n.isPoint(ba.geometry)||n.isMultipoint(ba.geometry))&&this._wrapPoints(ba,O)}return L};V._wrapPoints=function(L,O){const R=L.geometry;n.isMultipoint(R)?this._wrapMultipoint(R,O):this._wrapPoint(L,O)};V._wrapMultipoint=function(L,O){var R=L.points;const U=[];let ba=0,ca=0;for(const [da,ha]of R)U.push([da+ba,ha]),ba=0,O===aa.TILE_SIZE?(R=5*aa.PIXEL_BUFFER,da+ca<R?(U.push([O,0]),ba=-O):da+ca>aa.TILE_SIZE-R&&(U.push([-O,
0]),ba=O)):da+ca<-aa.PIXEL_BUFFER?(U.push([O,0]),ba=-O):da+ca>aa.TILE_SIZE+aa.PIXEL_BUFFER&&(U.push([-O,0]),ba=O),ca+=da;L.points=U};V._wrapPoint=function(L,O){const R=L.geometry;if(O===aa.TILE_SIZE){const U=5*aa.PIXEL_BUFFER;R.x<U?L.geometry={points:[[R.x,R.y],[O,0]]}:R.x>aa.TILE_SIZE-U&&(L.geometry={points:[[R.x,R.y],[-O,0]]})}else R.x<-aa.PIXEL_BUFFER?L.geometry={points:[[R.x,R.y],[O,0]]}:R.x>aa.TILE_SIZE+aa.PIXEL_BUFFER&&(L.geometry={points:[[R.x,R.y],[-O,0]]})};V._processGraphics=function(L,
O,R){if(!O||!O.length||!this._meshFactory)return Promise.resolve(null);const U=W.GraphicsReader.from(O,this.uid,L.transform),ba=this._meshFactory;return this._matcher.then(ca=>ba.analyzeGraphics(U,this.container.stage.resourceManager,ca,null,null,R).then(()=>{this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(L,U)}))};V._processAnalyzedGraphics=function(L,O){const R=this._meshFactory;var U=O.getSize();O=O.getCursor();const ba=new F.MeshData(L.key.id,{features:U,records:U,metrics:0},
r.WGLSymbologyType.DEFAULT,!1,!1);for(U=[];O.next();){const ca=O.readGraphic();ca.insertAfter=-1===ca.insertAfter?-1:this._displayIds.get(ca.insertAfter);ca.displayId=this._displayIds.get(ca.attributes[this.uid]);const da=new C(ca.displayId);da.insertAfter=ca.insertAfter;U.push(da);R.writeGraphic(ba,O,L.level,this.container.stage.resourceManager)}L=ba.serialize(L.tileInfoView.tileInfo.isWrappable);return 1!==L.length?new A.TileData:A.TileData.fromVertexData(L[0].message,U)};V._abortProcessingGraphic=
function(L){this._graphicIdToAbortController.get(L)?.abort()};V._getNullSymbol=function(L){L=L.geometry;return n.isPolyline(L)?u.errorPolylineSymbol2D:n.isPolygon(L)||n.isExtent(L)?u.errorPolygonSymbol2D:this.defaultPointSymbolEnabled?u.errorPointSymbol2D:null};V._flipUpdatingGraphics=function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};
l._createClass(Q,[{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||0<this._pendingUpdate.added.size||0<this._pendingUpdate.removed.size||0<this._pendingUpdate.updated.size||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size||this._attributeStore?.updatingHandles.updating}}]);return Q}(ea.GraphicsView(w.HandleOwnerMixin(D)));h.__decorate([d.property({constructOnly:!0})],D.prototype,"requestUpdateCallback",void 0);h.__decorate([d.property()],D.prototype,
"container",void 0);h.__decorate([d.property({constructOnly:!0})],D.prototype,"graphics",void 0);h.__decorate([d.property()],D.prototype,"updating",null);h.__decorate([d.property()],D.prototype,"view",void 0);h.__decorate([d.property()],D.prototype,"updateRequested",void 0);h.__decorate([d.property()],D.prototype,"defaultPointSymbolEnabled",void 0);return D=h.__decorate([e.subclass("esri.views.2d.layers.support.GraphicsView2D")],D)})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/maybe ./aaBoundingRect ./boundsUtils ./coordsUtils ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),
function(l,h,D,E,w,t,p,g,f){function d(y,u){if(D.isNone(y))return null;var v=y.spatialReference,r=f.getInfo(v);y="toJSON"in y?y.toJSON():y;if(!r)return y;v=f.isWebMercator(v)?102100:4326;const z=g.cutParams[v].maxX,A=g.cutParams[v].minX;if(p.isPoint(y))return a(y,z,A);if(p.isMultipoint(y))y.points=y.points.map(C=>a(C,z,A));else{if(p.isExtent(y))return b(y,r);if(p.isPolygon(y)||p.isPolyline(y)){v=w.getBoundsXY(q,y);r=v[0];v=v[2];const C=2*g.offsetMagnitude(r,A)*z;y=0===C?y:g.updatePolyGeometry(y,C);
r+=C;v+=C;return v>z?n(y,z,u):r<A?n(y,A,u):y}}return y}function b(y,u){if(!u)return y;const v=e(y,u).map(r=>r.extent);return 2>v.length?v[0]||y:2<v.length?(y.xmin=u.valid[0],y.xmax=u.valid[1],y):{rings:v.map(r=>[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]])}}function a(y,u,v){if(Array.isArray(y)){var r=y[0];r>u?(v=g.offsetMagnitude(r,u),y[0]=r+-2*v*u):r<v&&(u=g.offsetMagnitude(r,v),y[0]=r+-2*u*v)}else r=y.x,r>u?(v=g.offsetMagnitude(r,u),y.x+=-2*v*u):r<v&&(u=g.offsetMagnitude(r,
v),y.x+=-2*u*v);return y}function e(y,u){const v=[],{ymin:r,ymax:z,xmin:A,xmax:C}=y;var F=y.xmax-y.xmin;const [G,H]=u.valid,{x:K,frameId:J}=c(y.xmin,u),{x:N,frameId:P}=c(y.xmax,u);y=K===N&&0<F;if(F>2*H){F={xmin:A<C?K:N,ymin:r,xmax:H,ymax:z};y={xmin:G,ymin:r,xmax:A<C?N:K,ymax:z};u={xmin:0,ymin:r,xmax:H,ymax:z};const W={xmin:G,ymin:r,xmax:0,ymax:z},X=[],aa=[];m(F,u)&&X.push(J);m(F,W)&&aa.push(J);m(y,u)&&X.push(P);m(y,W)&&aa.push(P);for(let Z=J+1;Z<P;Z++)X.push(Z),aa.push(Z);v.push(new x(F,[J]),new x(y,
[P]),new x(u,X),new x(W,aa))}else K>N||y?v.push(new x({xmin:K,ymin:r,xmax:H,ymax:z},[J]),new x({xmin:G,ymin:r,xmax:N,ymax:z},[P])):v.push(new x({xmin:K,ymin:r,xmax:N,ymax:z},[J]));return v}function c(y,u){const [v,r]=u.valid;u=2*r;var z=0;y>r?(z=Math.ceil(Math.abs(y-r)/u),y-=z*u):y<v&&(z=Math.ceil(Math.abs(y-v)/u),y+=z*u,z=-z);return{x:y,frameId:z}}function m(y,u){const {xmin:v,ymin:r,xmax:z,ymax:A}=u;return k(y,v,r)&&k(y,v,A)&&k(y,z,A)&&k(y,z,r)}function k(y,u,v){return u>=y.xmin&&u<=y.xmax&&v>=
y.ymin&&v<=y.ymax?!0:!1}function n(y,u,v=!0){const r=!p.isPolyline(y);r&&t.closeRings(y);if(v)return(new B).cut(y,u);v=r?y.rings:y.paths;const z=r?4:2,A=v.length;u*=-2;for(let C=0;C<A;C++){const F=v[C];if(F&&F.length>=z){const G=[];for(const H of F)G.push([H[0]+u,H[1]]);v.push(G)}}r?y.rings=v:y.paths=v;return y}let x=h._createClass(function(y,u){this.extent=y;this.frameIds=u});const q=E.create();let B=function(){function y(){this._linesIn=[];this._linesOut=[]}var u=y.prototype;u.cut=function(v,r){this._xCut=
r;if(v.rings)this._closed=!0,r=v.rings,this._minPts=4;else if(v.paths)this._closed=!1,r=v.paths,this._minPts=2;else return null;for(var z of r)if(z&&!(z.length<this._minPts)){r=!0;for(const A of z)r?(this.moveTo(A),r=!1):this.lineTo(A);this._closed&&this.close()}this._pushLineIn();this._pushLineOut();r=[];for(const A of this._linesIn)A&&A.length>=this._minPts&&r.push(A);z=-2*this._xCut;for(const A of this._linesOut)if(A&&A.length>=this._minPts){for(const C of A)C[0]+=z;r.push(A)}this._closed?v.rings=
r:v.paths=r;return v};u.moveTo=function(v){this._pushLineIn();this._pushLineOut();this._prevSide=this._side(v[0]);this._moveTo(v[0],v[1],this._prevSide);this._firstPt=this._prevPt=v};u.lineTo=function(v){const r=this._side(v[0]);if(-1===r*this._prevSide){const z=this._intersect(this._prevPt,v);this._lineTo(this._xCut,z,0);this._prevSide=0}this._lineTo(v[0],v[1],r);this._prevSide=r;this._prevPt=v};u.close=function(){const v=this._firstPt,r=this._prevPt;v[0]===r[0]&&v[1]===r[1]||this.lineTo(v);this._checkClosingPt(this._lineIn);
this._checkClosingPt(this._lineOut)};u._moveTo=function(v,r,z){this._closed?(this._lineIn.push([0>=z?v:this._xCut,r]),this._lineOut.push([0<=z?v:this._xCut,r])):(0>=z&&this._lineIn.push([v,r]),0<=z&&this._lineOut.push([v,r]))};u._lineTo=function(v,r,z){this._closed?(this._addPolyVertex(this._lineIn,0>=z?v:this._xCut,r),this._addPolyVertex(this._lineOut,0<=z?v:this._xCut,r)):0>z?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([v,r])):0<z?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([v,
r])):0>this._prevSide?(this._lineIn.push([v,r]),this._lineOut.push([v,r])):0<this._prevSide&&(this._lineOut.push([v,r]),this._lineIn.push([v,r]))};u._addPolyVertex=function(v,r,z){const A=v.length;1<A&&v[A-1][0]===r&&v[A-2][0]===r?v[A-1][1]=z:v.push([r,z])};u._checkClosingPt=function(v){const r=v.length;3<r&&v[0][0]===this._xCut&&v[r-2][0]===this._xCut&&v[1][0]===this._xCut&&(v[0][1]=v[r-2][1],v.pop())};u._side=function(v){return v<this._xCut?-1:v>this._xCut?1:0};u._intersect=function(v,r){return v[1]+
(this._xCut-v[0])/(r[0]-v[0])*(r[1]-v[1])};u._pushLineIn=function(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn);this._lineIn=[]};u._pushLineOut=function(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut);this._lineOut=[]};return h._createClass(y)}();l.CutVertical=B;l.normalizeCentralMeridianForDisplay=function(y){return d(y,!1)};l.normalizeCentralMeridianSync=function(y){return d(y,!0)};Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(l,h,D,E,w,t,p){function g(m,k){if(!k)return null;if("x"in k){var n={x:0,y:0};[n.x,n.y]=m(k.x,k.y,b);null!=k.z&&(n.z=k.z);null!=k.m&&(n.m=k.m);return n}return"xmin"in
k?(n={xmin:0,ymin:0,xmax:0,ymax:0},[n.xmin,n.ymin]=m(k.xmin,k.ymin,b),[n.xmax,n.ymax]=m(k.xmax,k.ymax,b),k.hasZ&&(n.zmin=k.zmin,n.zmax=k.zmax,n.hasZ=!0),k.hasM&&(n.mmin=k.mmin,n.mmax=k.mmax,n.hasM=!0),n):"rings"in k?{rings:f(k.rings,m),hasM:k.hasM,hasZ:k.hasZ}:"paths"in k?{paths:f(k.paths,m),hasM:k.hasM,hasZ:k.hasZ}:"points"in k?{points:d(k.points,m),hasM:k.hasM,hasZ:k.hasZ}:null}function f(m,k){const n=[];for(const x of m)n.push(d(x,k));return n}function d(m,k){const n=[];for(const x of m)m=k(x[0],
x[1],[0,0]),n.push(m),2<x.length&&m.push(x[2]),3<x.length&&m.push(x[3]);return n}const b=[0,0],a=g.bind(null,p.lngLatToXY),e=g.bind(null,p.xyToLngLat),c=new (function(){function m(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var k=m.prototype;k.push=async function(n,x,q){if(!(n&&n.length&&x&&q)||t.equals(x,q))return n;const B={geometries:n,inSpatialReference:x,outSpatialReference:q,resolve:null};this._jobs.push(B);return new Promise(y=>{B.resolve=y;null===this._timer&&(this._timer=
setTimeout(this._process,10))})};k._process=function(){this._timer=null;const n=this._jobs.shift();if(n){var {geometries:x,inSpatialReference:q,outSpatialReference:B,resolve:y}=n;p.canProject(q,B)?t.isWebMercator(B)?y(x.map(a)):y(x.map(e)):y(E.projectMany(w.jsonAdapter,x,q,B,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return h._createClass(m)}());l.checkProjectionSupport=async function(m,k){m&&k&&(m=Array.isArray(m)?m.map(n=>D.isSome(n.geometry)?n.geometry.spatialReference:
null).filter(D.isSome):[m],await E.initializeProjection(m.map(n=>({source:n,dest:k}))))};l.project=function(m,k,n,x){if(!m)return m;n||(n=k,k=m.spatialReference);return t.isValid(k)&&t.isValid(n)&&!t.equals(k,n)?p.canProject(k,n)?(m=t.isWebMercator(n)?a(m):e(m),m.spatialReference=n,m):E.projectMany(w.jsonAdapter,[m],k,n,null,x)[0]:m};l.projectMany=function(m,k,n){return c.push(m,k,n)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers"],function(l,h){let D=h._createClass(function(g,f,d){this.x=g;this.y=f;this.spatialReference=d;this.m=this.z=void 0}),E=h._createClass(function(g,f,d,b){this.rings=g;this.spatialReference=f;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);b&&(this.hasM=b)}),w=h._createClass(function(g,f,d,b){this.paths=g;this.spatialReference=f;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);b&&(this.hasM=b)}),t=h._createClass(function(g,f,d,b){this.points=g;this.spatialReference=f;
this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);b&&(this.hasM=b)}),p=h._createClass(function(g,f,d,b,a){this.xmin=g;this.ymin=f;this.xmax=d;this.ymax=b;this.spatialReference=a;this.mmax=this.mmin=this.zmax=this.zmin=void 0});l.jsonAdapter={convertToGEGeometry:function(g,f){return null==f?null:g.convertJSONToGeometry(f)},exportPoint:function(g,f,d){d=new D(g.getPointX(f),g.getPointY(f),d);const b=g.hasZ(f),a=g.hasM(f);b&&(d.z=g.getPointZ(f));a&&(d.m=g.getPointM(f));return d},exportPolygon:function(g,f,
d){return new E(g.exportPaths(f),d,g.hasZ(f),g.hasM(f))},exportPolyline:function(g,f,d){return new w(g.exportPaths(f),d,g.hasZ(f),g.hasM(f))},exportMultipoint:function(g,f,d){return new t(g.exportPoints(f),d,g.hasZ(f),g.hasM(f))},exportExtent:function(g,f,d){var b=g.hasZ(f);const a=g.hasM(f);d=new p(g.getXMin(f),g.getYMin(f),g.getXMax(f),g.getYMax(f),d);b&&(b=g.getZExtent(f),d.zmin=b.vmin,d.zmax=b.vmax);a&&(g=g.getMExtent(f),d.mmin=g.vmin,d.mmax=g.vmax);return d}};Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/GraphicTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./DirtyMap ./DisplayRecordStore ./WGLBuffers ./WGLTile".split(" "),function(l,h,D,E,w,t){t=function(p){function g(){var d=f.apply(this,arguments);d._data=null;d._displayList=null;d._lastCommitTime=0;d._hasData=!1;d._invalidated=!1;d._wglBuffers=null;d._dirtyMap=new D;return d}h._inherits(g,p);var f=h._createSuper(g);p=g.prototype;p.destroy=function(){h._get(h._getPrototypeOf(g.prototype),
"destroy",this).call(this);this.clear()};p.getGeometry=function(d){return this._wglBuffers&&this._wglBuffers.has(d)?this._wglBuffers.get(d):null};p.getDisplayList=function(){return this._displayList};p.patch=function(d){if(!0===d.clear)this.clear(),this._hasData=!1;else{var b=d.addOrUpdate,a=d.remove;!this._data&&b&&b.tileDisplayData?.displayObjects.length?(b.tileDisplayData.computeDisplayList(),this._dirtyMap=new D,this._dispRecStore=E.fromTileData(b,this._dirtyMap),this._data=b,this._dirtyMap.markAllDirty(),
this._hasData=!0,d.end&&this.ready()):this._data?b&&b.tileDisplayData?.displayObjects.length||a.length?this._doPatchData(d):d.end&&this.ready():d.end&&this.ready();d.end&&!this._data&&this.clear();this.requestRender();this.emit("change")}};p.commit=function(d){if(!d.time||d.time!==this._lastCommitTime)if(this._lastCommitTime=d.time,this.visible&&this._data&&(this._wglBuffers||(this._wglBuffers=new w(d.context)),this._dirtyMap.hasDirty()||this._invalidated))this._invalidated=!1,this._wglBuffers.upload(this._data.tileBufferData,
this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._dirtyMap.markAllClean()};p.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};p._doPatchData=function(d){this._invalidated=!0;this._patchData(d)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=E.fromTileData(this._data,this._dirtyMap));
this.requestRender()};p._patchData=function(d){let b=!0;var a=d.addOrUpdate&&d.addOrUpdate.tileDisplayData&&d.addOrUpdate.tileDisplayData.displayObjects||[],e=(d.remove||[]).slice();for(var c of a)null!=c.insertAfter&&e.push(c.id);let m;0<e.length&&(m=new Set(e));c=this._data.tileDisplayData;for(var k of e)if(e=c.displayObjectRegistry.get(k)){c.displayList.removeFromList(e.displayRecords);for(var n of e.displayRecords)this._dispRecStore.delete(n);c.displayObjectRegistry.delete(k)}m?.size&&(c.displayObjects=
c.displayObjects.filter(u=>!m.has(u.id)));for(const u of a){a=c.displayObjectRegistry.get(u.id);let v;if(a){k=a.displayRecords;a.set(u);a.displayRecords=k;k=a.displayRecords.length;for(n=0;n<k;++n){e=a.displayRecords[n];var x=u.displayRecords[n];if(n>=u.displayRecords.length||e.geometryType!==x.geometryType||e.symbolLevel!==x.symbolLevel||e.zOrder!==x.zOrder||e.materialKey!==x.materialKey)this._dispRecStore.delete(a.displayRecords[n]),n<u.displayRecords.length&&(a.displayRecords[n]=void 0)}a.displayRecords.length=
u.displayRecords.length}else if(a=u.copy(),a.displayRecords=[],c.displayObjectRegistry.set(u.id,a),k=c.displayObjects,null!=a.insertAfter?(v={},0<=a.insertAfter?(n=c.displayObjectRegistry.get(a.insertAfter))?(x=k.indexOf(n)+1,x<k.length?k.splice(x,0,a):(k.push(a),x=k.length)):(k.push(a),x=k.length):(k.unshift(a),x=0)):(k.push(a),x=k.length),v)for(n=0<u.displayRecords.length?1:0,e=0,--x;0<=x&&e<n;--x)for(var q=k[x].displayRecords.length-1;0<=q&&e<n;--q){var B=k[x].displayRecords[q],y=c.displayList.getDPInfoType();
v[y]||(v[y]=B,++e)}k=u.displayRecords.length;for(n=0;n<k;++n){e=u.displayRecords[n];(x=a.displayRecords[n])?(x.meshData=e.meshData,x.materialKey=e.materialKey):(x=e.copy(),x.vertexFrom=void 0,x.indexFrom=void 0,a.displayRecords[n]=x);B=e.geometryType;q=c.displayList.getDPInfoType();y=d.addOrUpdate.tileBufferData.geometries[B];B=y.vertexBuffer;y=y.indexBuffer;let r=void 0;v&&(r=v[q]?c.displayList.splitAfter(v[q]):-1);b=this._dispRecStore.setMeshData(x,e,B,y,r)&&b;v&&null!=x.indexFrom&&null!=x.indexFrom&&
(v[q]=x)}}return b};h._createClass(g,[{key:"hasData",get:function(){return!!this._hasData}},{key:"displayObjects",get:function(){return this._displayObjects??[]}}]);return g}(t.WGLTile);l.GraphicTile=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function h(){this._dirties=[{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,
vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1},{vertexFrom:-1,vertexCount:-1,indexFrom:-1,indexCount:-1,allDirty:!1}]}var D=h.prototype;D.hasDirty=function(){return this._dirties.some(E=>-1!==E.indexCount||E.allDirty)};D.markAllClean=function(){for(const E of this._dirties)E.indexFrom=-1,E.indexCount=-1,E.vertexFrom=-1,E.vertexCount=-1,E.allDirty=!1};
D.markAllDirty=function(){for(const E of this._dirties)E.allDirty=!0};D.forEach=function(E){for(let w=0;w<this._dirties.length;++w){const {indexCount:t,indexFrom:p,vertexCount:g,vertexFrom:f,allDirty:d}=this._dirties[w],b={};let a=void 0,e=!1;if(d||-1!==f&&0<g)b.geometry={count:g,from:f,allDirty:d},e=!0;if(d||-1!==p&&0<t)a={count:t,from:p,allDirty:d},e=!0;e&&E({indices:a,vertices:b},w)}};D.markDirtyIndices=function(E,w,t){E=this._dirties[E];if(!E.allDirty)if(-1!==E.indexCount){const p=Math.min(E.indexFrom,
w);w=Math.max(E.indexFrom+E.indexCount,w+t)-p;E.indexFrom=p;E.indexCount=w}else E.indexFrom=w,E.indexCount=t};D.markDirtyVertices=function(E,w,t,p){E=this._dirties[E];E.allDirty||(-1!==E.vertexCount?(w=Math.min(E.vertexFrom,t),t=Math.max(E.vertexFrom+E.vertexCount,t+p)-w,E.vertexFrom=w,E.vertexCount=t):(E.vertexFrom=t,E.vertexCount=p))};return l._createClass(h)}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/has",
"./FreeList","./Utils"],function(l,h,D,E){const w=["FILL","LINE","MARKER","TEXT","LABEL"];return function(){function t(g,f,d,b){this._strides=g;this._displayList=f;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=d;for(const a in g){this._freeListsAndStorage[a]={vtxFreeList:b?new D.FreeList(b):null,idxFreeList:b?new D.FreeList(b):null,vertexBuffers:{},indexBuffer:b?new Uint32Array(b):null};for(const e in g[a])this._freeListsAndStorage[a].vertexBuffers[e]={data:b?E.allocateTypedArrayBuffer(b,
g[a][e]):null,stride:g[a][e]}}}t.fromTileData=function(g,f){var d=g.getStrides(),b={};for(var a=0;a<d.length;a++)b[w[a]]=d[a];d=[0,0,0,0,0];a=[0,0,0,0,0];for(var e of g.tileDisplayData.displayObjects)for(var c of e.displayRecords)d[c.geometryType]=Math.max(d[c.geometryType],c.vertexFrom+c.vertexCount),a[c.geometryType]=Math.max(a[c.geometryType],c.indexFrom+c.indexCount);f=new t(b,g.tileDisplayData.displayList,f,void 0);g=g.tileBufferData?.geometries??[];for(b=0;b<g.length;++b){e=d[b];var m=a[b],
k=g[b];c=f._storageFor(w[b]);var n=g[b].indexBuffer;c.indexBuffer=n;c.idxFreeList=new D.FreeList(n.length);c.idxFreeList.allocate(m);m=0;for(const x in k.vertexBuffer)k=g[b].vertexBuffer[x],c.vertexBuffers[x].data=k.data,c.vertexBuffers[x].stride=k.stride,n=E.strideToPackingFactor(k.stride),k=k.data.length*n/k.stride,m||(m=k);c.vtxFreeList=new D.FreeList(m);c.vtxFreeList.allocate(e)}return f};var p=t.prototype;p.delete=function(g){const f=w[g.geometryType];this._freeVertices(f,g.vertexFrom,g.vertexCount);
this._freeIndices(f,g.indexFrom,g.indexCount);this._displayList.removeFromList(g);g.vertexFrom=void 0;g.indexFrom=void 0};p.setMeshData=function(g,f,d,b,a){const e=w[g.geometryType];g.meshData=null;let c=void 0,m=void 0;void 0===g.vertexFrom?(m=f.vertexCount,c=this._allocateVertices(e,m)):f.vertexCount>g.vertexCount?(this._freeVertices(e,g.vertexFrom,g.vertexCount),m=f.vertexCount,c=this._allocateVertices(e,m)):f.vertexCount===g.vertexCount?(c=g.vertexFrom,m=g.vertexCount):(this._freeVertices(e,g.vertexFrom+
f.vertexCount,g.vertexCount-f.vertexCount),c=g.vertexFrom,m=f.vertexCount);let k=!0,n=void 0,x=void 0,q=void 0;void 0===g.indexFrom?(n=a,q=f.indexCount,x=this._allocateIndices(e,q)):f.indexCount>g.indexCount?(n=this._displayList.removeFromList(g),this._freeIndices(e,g.indexFrom,g.indexCount),q=f.indexCount,x=this._allocateIndices(e,q)):f.indexCount===g.indexCount?(k=!1,x=g.indexFrom,q=g.indexCount):(n=this._displayList.removeFromList(g),this._freeIndices(e,g.indexFrom+f.indexCount,g.indexCount-f.indexCount),
x=g.indexFrom,q=f.indexCount);if(-1!==c&&-1!==x){a=this._storageFor(e);E.copyMeshData(c,x,a.vertexBuffers,a.indexBuffer,f,d,b);g.vertexFrom=c;g.indexFrom=x;g.vertexCount=f.vertexCount;g.indexCount=f.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(g.geometryType,g.indexFrom,g.indexCount);for(const B in d)this._dirtyMap.markDirtyVertices(g.geometryType,B,g.vertexFrom,g.vertexCount)}k&&this._displayList.addToList(g,n);return!0}-1!==c&&this._freeVertices(e,c,m);-1!==x&&this._freeIndices(e,
x,q);g.setMeshDataFromBuffers(f,d,b);g.vertexFrom=void 0;g.vertexCount=0;g.indexFrom=void 0;g.indexCount=0;return!1};p.tryAddMeshData=function(g,f){const d=f.vertexBuffer;f=f.indexBuffer;var b=w[g.geometryType];const a=this._allocateVertices(b,g.vertexCount);if(-1===a)return this._freeVertices(b,a,g.vertexCount),!1;const e=this._allocateIndices(b,g.indexCount);if(-1===e)return this._freeVertices(b,a,g.vertexCount),this._freeIndices(b,e,g.indexCount),!1;b=this._storageFor(b);E.copyMeshData(a,e,b.vertexBuffers,
b.indexBuffer,g,d,f);g.vertexFrom=a;g.indexFrom=e;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(g.geometryType,g.indexFrom,g.indexCount);for(const c in d)this._dirtyMap.markDirtyVertices(g.geometryType,c,a,g.vertexCount)}this._displayList.addToList(g);return!0};p._allocateVertices=function(g,f){g=this._storageFor(g);f=g.vtxFreeList?.allocate(f);if(null==f||-1===f)return-1;g=g.vtxFreeList?.fragmentation;return null==g||.5<g?-1:f};p._freeVertices=function(g,f,d){this._storageFor(g).vtxFreeList?.free(f,
d)};p._freeIndices=function(g,f,d){this._storageFor(g).idxFreeList?.free(f,d)};p._allocateIndices=function(g,f){g=this._storageFor(g);f=g.idxFreeList?.allocate(f);if(null==f||-1===f)return-1;g=g.idxFreeList?.fragmentation;return null==g||.5<g?-1:f};p._storageFor=function(g){return this._freeListsAndStorage[g]};p._stridesFor=function(g,f){return this._strides[g][f]};return l._createClass(t)}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],
function(l,h){let D=function(){function w(p){this._largestRange=null;this._parent=p;this._updateLargestRange()}var t=w.prototype;t.rangeCreated=function(p){if(!this._largestRange||p.count>this._largestRange.count)this._largestRange=p};t.rangeResized=function(p,g){if(p===this._largestRange)p.count<g&&this._updateLargestRange();else if(!this._largestRange||p.count>this._largestRange.count)this._largestRange=p};t.findBestRange=function(p){let g=this._parent._freeHead,f=null;for(;null!==g;)g.count>=p&&
(!f||g.count-p<f.count-p)&&(f=g),g=g.next;return f};t.findAdjacentRanges=function(p,g){let f=!0,d=!1,b=null,a=this._parent._freeHead;for(;f&&!d;){const e=null!==a?a.from:this._parent._size;p>=(null!==b?b.from+b.count:0)&&p+g<=e?(f=!1,d=!0):null!==a?(b=a,a=a.next):f=!1}return[b,a]};t._updateLargestRange=function(){let p=null,g=this._parent._freeHead;for(;null!==g;){if(!p||g.count>p.count)p=g;g=g.next}this._largestRange=p};h._createClass(w,[{key:"largestRange",get:function(){return this._largestRange}}]);
return w}(),E=function(){function w(p,g){this._allocated=0;this._size=p;this._freeHead=0<p?{from:0,count:p,prev:null,next:null}:null;this._bookKeeper=g||new D(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var t=w.prototype;t.allocate=function(p){const g=this._bookKeeper.findBestRange(p);if(null==g)return-1;const f=g.from,d=g.count;g.from+=p;g.count-=p;this._bookKeeper.rangeResized(g,f,d);this._allocated+=p;0===g.count&&(p=null!==g.prev?this._freeHead:g.next,w._removeRange(g),
this._freeHead=p);return f};t.free=function(p,g){const [f,d]=this._bookKeeper.findAdjacentRanges(p,g);p={from:p,count:g,prev:f??null,next:d??null};null!=f&&(f.next=p);null!=d&&(d.prev=p);this._bookKeeper.rangeCreated(p);this._allocated-=g;if(null!=d&&p.from+p.count===d.from){g=p.from;var b=p.count;w._fuse(p,d);w._removeRange(d);this._bookKeeper.rangeResized(p,g,b);this._bookKeeper.rangeResized(d,void 0,0)}null!=f&&f.from+f.count===p.from&&(g=f.from,b=f.count,w._fuse(f,p),w._removeRange(p),this._bookKeeper.rangeResized(f,
g,b),this._bookKeeper.rangeResized(p,void 0,0));this._freeHead=null!==p.prev?this._freeHead:p};w._removeRange=function(p){null!==p.prev?null!==p.next?(p.prev.next=p.next,p.next.prev=p.prev):p.prev.next=null:null!==p.next&&(p.next.prev=null)};w._fuse=function(p,g){p.count+=g.count;p.next=g.next;g.from+=g.count;g.count=0;null!==g.next&&(g.next.prev=p)};h._createClass(w,[{key:"fragmentation",get:function(){const p=this._size-this._allocated;return 0===p?0:1-this._bookKeeper.largestRange.count/p}}]);
return w}();l.FreeList=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Utils","../../../webgl/BufferObject","../../../webgl/enums","../../../webgl/VertexArrayObject"],function(l,h,D,E,w){return function(){function t(g){this.geometryMap=h.createGeometryData(()=>({indexBuffer:D.BufferObject.createIndex(g,E.Usage.STATIC_DRAW),vao:null}),(f,d)=>({vertexBuffer:D.BufferObject.createVertex(g,
h.C_VBO_INFO[d])}))}var p=t.prototype;p.dispose=function(){for(let g=0;5>g;g++){const f=this.geometryMap[g];if(f){f.data.vao&&f.data.vao.dispose(!1);f.data.indexBuffer&&f.data.indexBuffer.dispose();for(const d in f.buffers)f.buffers[d]&&f.buffers[d].data.vertexBuffer.dispose()}}};p.get=function(g){const f=this.geometryMap[g];return{getVAO(d,b,a){if(!f.data.vao){const e={};for(const c in f.buffers)e[c]=f.buffers[c].data.vertexBuffer;f.data.vao=new w.VertexArrayObject(d,a,b,e,f.data.indexBuffer)}return f.data.vao}}};
p.has=function(g){return null!=this.geometryMap[g]};p.upload=function(g,f){f.forEach((d,b)=>{this._upload(d,b,g)})};p._upload=function(g,f,d){g.indices&&(g.indices.allDirty?this._uploadIndices(d,f):null!=g.indices.from&&null!=g.indices.count&&this._uploadIndices(d,f,g.indices.from,g.indices.count));if(g.vertices){g=g.vertices;for(const b in g){const a=g[b];a.allDirty?this._uploadVertices(d,f,b):null!=a.from&&null!=a.count&&this._uploadVertices(d,f,b,a.from,a.count)}}};p._uploadVertices=function(g,
f,d,b,a){const e=this.geometryMap[f];if(e&&(g=g.geometries[f].vertexBuffer[d])){var {data:c,stride:m}=g;e.buffers[d]&&0<c.length&&(g=m/c.BYTES_PER_ELEMENT,null!=b&&null!=a?e.buffers[d].data.vertexBuffer.setSubData(c,b*g,b*g,(b+a)*g):e.buffers[d].data.vertexBuffer.setData(c))}};p._uploadIndices=function(g,f,d,b){const a=this.geometryMap[f];a&&(g=g.geometries[f].indexBuffer,a.data.indexBuffer&&0<g.length&&(null!=d&&null!=b?a.data.indexBuffer.setSubData(g,d,d,d+b):a.data.indexBuffer.setData(g)))};return l._createClass(t)}()})},
"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/mat2d ../../../../chunks/mat2df32 ../../../../chunks/mat3 ../../../../chunks/mat3f32 ./definitions ./TiledDisplayObject".split(" "),function(l,h,D,E,w,t,p,g){let f=function(){function d(){}var b=d.prototype;b.acquire=function(a){return{refCount:1,version:-1,labelMat2d:E.create(),tileMat3:t.create(),dvs:t.create()}};b.release=function(a){};return h._createClass(d)}();g=function(d){function b(e,
c,m,k){return a.call(this,e,c,m,k,p.TILE_SIZE,p.TILE_SIZE)}h._inherits(b,d);var a=h._createSuper(b);d=b.prototype;d.destroy=function(){h._get(h._getPrototypeOf(b.prototype),"destroy",this).call(this);this._transforms&&b.TransformCache.release(this.key.hash)};d.setTransform=function(e){var c=this.resolution/e.resolution,m=this.transforms.tileMat3;const [k,n]=e.toScreenNoRotation([0,0],[this.x,this.y]);var x=this.width/this.rangeX*c;c*=this.height/this.rangeY;w.set(m,x,0,0,0,c,0,k,n,1);w.multiply(this.transforms.dvs,
e.displayViewMat3,m);m=this.transforms.labelMat2d;const q=window.devicePixelRatio;x=D.set(E.create(),x*q,0,0,c*q,k*q,n*q);D.multiply(m,e.viewMat2d,x)};d._createTransforms=function(){return b.TransformCache.acquire(this.key.hash)};return h._createClass(b)}(g.TiledDisplayObject);g.TransformCache=new f;l.WGLTile=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers",
"../../../../chunks/mat3","../DisplayObject","../../tiling/TileKey"],function(l,h,D,E,w){E=function(t){function p(f,d,b,a,e,c,m=e,k=c){var n=g.call(this);n.triangleCountReportedInDebug=0;n.triangleCount=0;n.texture=null;n.key=new w(f);n.resolution=d;n.x=b;n.y=a;n.width=e;n.height=c;n.rangeX=m;n.rangeY=k;return n}h._inherits(p,t);var g=h._createSuper(p);t=p.prototype;t.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};t.setTransform=function(f){const d=this.resolution/(f.resolution*
f.pixelRatio),b=this.transforms.tileMat3,[a,e]=f.toScreenNoRotation([0,0],[this.x,this.y]);D.set(b,this.width/this.rangeX*d,0,0,0,this.height/this.rangeY*d,0,a,e,1);D.multiply(this.transforms.dvs,f.displayViewMat3,b)};return h._createClass(p)}(E.DisplayObject);l.TiledDisplayObject=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ./enums ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./WGLDisplayRecord ./cpuMapped/DisplayRecordReader ./mesh/VertexBuffer ./mesh/VertexVector ./util/Writer".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e){const c=new w,m=new w;w=function(){function k(){this.tileBufferData=this.tileDisplayData=null}var n=k.prototype;n.reshuffle=function(){c.reset();if(this.tileDisplayData){var x=[[],[],[],[],[]],q=this.tileDisplayData.displayObjects;for(var B of q)for(var y of B.displayRecords)x[y.geometryType].push(y);for(var u of x)for(var v of u)v&&c.needMore(v.geometryType,v.meshData?v.meshData.vertexCount:v.vertexCount,v.meshData?v.meshData.indexData.length:v.indexCount);q=x.length;
B=new t;for(y=0;y<q;++y)if(B.geometries[y].indexBuffer=new Uint32Array(Math.round(1.5*c.indicesFor(y))),v=[],u=this.tileBufferData?.geometries[y].vertexBuffer){for(var r in u)v.push(u[r].stride);v=k._computeVertexAlignment(v);var z=Math.round(1.5*c.verticesFor(y));v=k._align(z,v);for(var A in u)z=u[A].stride,B.geometries[y].vertexBuffer[A]={stride:z,data:g.allocateTypedArrayBuffer(v,z)}}m.reset();this.tileDisplayData.displayList?.clear();for(r=0;r<q;++r){A=x[r];for(const G of A){if(G.meshData)G.writeMeshDataToBuffers(m.verticesFor(r),
B.geometries[r].vertexBuffer,m.indicesFor(r),B.geometries[r].indexBuffer),G.meshData=null;else if(y=this.tileBufferData?.geometries[r]){A=y.vertexBuffer;y=y.indexBuffer;u=B.geometries[r].vertexBuffer;v=B.geometries[r].indexBuffer;z=m.verticesFor(r);const H=m.indicesFor(r);g.copyMeshData(z,H,u,v,G,A,y);G.vertexFrom=z;G.indexFrom=H}m.needMore(r,G.vertexCount,G.indexCount)}}var {displayList:C,displayObjects:F}=this.tileDisplayData;if(C)for(const G of F)C.addToList(G.displayRecords);this.tileBufferData=
B}};n.getStrides=function(){const x=[],q=this.tileBufferData?.geometries;if(!q)return x;for(let B=0;B<q.length;++B){const y=q[B];x[B]={};for(const u in y.vertexBuffer)x[B][u]=y.vertexBuffer[u].stride}return x};n.clone=function(){const x=new k;x.tileBufferData=this.tileBufferData?.clone()??null;x.tileDisplayData=this.tileDisplayData?.clone()??null;return x};n._guessSize=function(){const x=this.tileDisplayData?.displayObjects??[],q=Math.min(x.length,4);let B=0;for(let y=0;y<q;y++)B=Math.max(B,x[y].displayRecords.length);
return 2*(12*x.length+x.length*B*40)};n.serialize=function(){const x=this.tileBufferData.serialize(),q=this.tileBufferData.getBuffers(),B=this.tileDisplayData.serialize(new e(Int32Array,this._guessSize())).buffer();q.push(B);return{result:{displayData:B,bufferData:x},transferList:q}};k.fromVertexData=function(x,q){const B={},y=new Map;for(const u of q)y.set(u.id,u);g.forEachGeometryType(u=>{const v=x.data[u];if(D.isSome(v)){const z=d.DisplayRecordReader.from(v.records).getCursor();for(;z.next();){var r=
z.id;const A=z.materialKey,C=z.indexFrom,F=z.indexCount,G=z.vertexFrom,H=z.vertexCount,K=y.get(r);r=new f(r,u,A);r.indexFrom=C;r.indexCount=F;r.vertexFrom=G;r.vertexCount=H;K.displayRecords.push(r)}B[u]=b.VertexBuffers.fromVertexData(v,u)}else B[u]=(new a.VertexVectors(u,0,E.WGLSymbologyType.DEFAULT)).intoBuffers()});return k.fromMeshData({displayObjects:q,vertexBuffersMap:B})};k.fromMeshData=function(x){const q=new k,B=new p,y=new t;B.displayObjects=x.displayObjects;for(const u in x.vertexBuffersMap){const v=
x.vertexBuffersMap[u];y.geometries[u].indexBuffer=v.indexBuffer;y.geometries[u].vertexBuffer=v.namedBuffers}q.tileDisplayData=B;q.tileBufferData=y;return q};k.bind=function(x,q){const B=new k;B.tileDisplayData=x;B.tileBufferData=q;return B};k.create=function(x,q){const B=new k;B.tileDisplayData=new p;B.tileDisplayData.displayObjects=x;const y=[0,0,0,0,0],u=[0,0,0,0,0],v=[[],[],[],[],[]];for(var r of x)for(var z of r.displayRecords)v[z.geometryType].push(z),y[z.geometryType]+=z.meshData.vertexCount,
u[z.geometryType]+=z.meshData.indexData.length;x=new t;q=[q.fill||{},q.line||{},q.icon||{},q.text||{},q.label||{}];for(r=0;5>r;r++){z=new Uint32Array(u[r]);var A=q[r],C=y[r];const F={};for(const G in A){const H={data:g.allocateTypedArrayBuffer(C,A[G]),stride:A[G]};F[G]=H}A=F;f.writeAllMeshDataToBuffers(v[r],A,z);x.geometries[r]={indexBuffer:z,vertexBuffer:A}}B.tileBufferData=x;return B};k._align=function(x,q){const B=x%q;return 0===B?x:x+(q-B)};k._computeVertexAlignment=function(x){let q=!1,B=!1;
for(const y of x)2===y%4?q=!0:0!==y%4&&(B=!0);return B?4:q?2:1};return h._createClass(k)}();l.TileData=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function h(){this._byGeometryType=null}var D=h.prototype;D.reset=function(){this._byGeometryType=null};D.verticesFor=function(E){return this._byGeometryType?this._byGeometryType[E].vertices:
0};D.indicesFor=function(E){return this._byGeometryType?this._byGeometryType[E].indices:0};D.needMore=function(E,w,t){if(w||t)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),E=this._byGeometryType[E],E.vertices+=w,E.indices+=t};l._createClass(h,[{key:"satisfied",get:function(){return!this._byGeometryType}}]);return h}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./Utils"],function(l,h){return function(){function D(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var E=D.prototype;E.clone=function(){const w=new D;for(let t=0;t<this.geometries.length;t++){const p=this.geometries[t],g=w.geometries[t];g.indexBuffer=p.indexBuffer.slice();g.vertexBuffer={};for(const f in p.vertexBuffer){const {data:d,stride:b}=
p.vertexBuffer[f];g.vertexBuffer[f]={data:d.slice(),stride:b}}}return w};D.deserialize=function(w){const t=new D;for(let p=0;5>p;++p){t.geometries[p].indexBuffer=new Uint32Array(w.geometries[p].indexBuffer);t.geometries[p].vertexBuffer={};for(const g in w.geometries[p].vertexBuffer)t.geometries[p].vertexBuffer[g]={data:h.allocateTypedArrayBufferwithData(w.geometries[p].vertexBuffer[g].data,w.geometries[p].vertexBuffer[g].stride),stride:w.geometries[p].vertexBuffer[g].stride}}return t};E.serialize=
function(){const w={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let t=0;5>t;++t)for(const p in this.geometries[t].vertexBuffer)w.geometries[t].vertexBuffer[p]={data:this.geometries[t].vertexBuffer[p].data.buffer,
stride:this.geometries[t].vertexBuffer[p].stride};return w};E.getBuffers=function(){const w=[];for(let t=0;5>t;++t){w.push(this.geometries[t].indexBuffer.buffer);for(const p in this.geometries[t].vertexBuffer)w.push(this.geometries[t].vertexBuffer[p].data.buffer)}return w};return l._createClass(D)}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./GraphicDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(l,h,
D,E){return function(){function w(){this.displayObjects=[];this._displayList=null}var t=w.prototype;t.computeDisplayList=function(){this._displayList=new h;for(const p of this.displayObjects)for(const g of p.displayRecords)this._displayList.addToList(g)};t.clone=function(){const p=new w;this.displayObjects&&(p.displayObjects=this.displayObjects.map(g=>g.clone()));return p};t.serialize=function(p){E.serializeList(p,this.displayObjects);return p};t._deserializeObjects=function(p){var g=p.readInt32();
g=Array(g);const f=new Map;for(let d=0;d<g.length;++d){const b=D.deserialize(p);g[d]=b;f.set(b.id,b)}this.displayObjects=g;this._displayList=null;this._displayObjectRegistry=f};w.deserialize=function(p){const g=new w;g._deserializeObjects(p);return g};l._createClass(w,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const p of this.displayObjects)this._displayObjectRegistry.set(p.id,p)}return this._displayObjectRegistry}},{key:"displayList",
get:function(){return this._displayList}}]);return w}()})},"esri/views/2d/engine/webgl/GraphicDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./materialKey/MaterialKey"],function(l,h){function D(f,d,b,...a){d<f.length?f.splice(d,b,...a):f.push(...a)}let E=function(){function f(){this.symbolLevels=[]}var d=f.prototype;d.replay=function(b,a,e){for(const k of this.symbolLevels)for(const n of k.zLevels){var c=n.geometryDPInfo.unified;if(c)for(const x of c){const {geometryType:q,
materialKey:B,indexFrom:y,indexCount:u}=x;c=h.MaterialKeyBase.load(B).symbologyType;c=b.painter.getBrush(q,c);var m=a.getGeometry(q);m={geometryType:q,materialKey:B,indexFrom:y,indexCount:u,target:m};c.prepareState(b);c.drawGeometry(b,a,m,e)}}};d.clear=function(){this.symbolLevels.length=0};d.addToList=function(b,a){if(Array.isArray(b))for(const e of b)this._addToList(e,a);else this._addToList(b,a)};d.removeFromList=function(b){Array.isArray(b)||(b=[b]);let a=null;for(const e of b)a=this._removeFromList(e);
return a};d.clone=function(){const b=new f;for(const a of this.symbolLevels)b.symbolLevels.push(a.clone());return b};d.splitAfter=function(b){const a=this._getDisplayList(b.symbolLevel,b.zOrder),e=a.length,c=b.indexFrom+b.indexCount;for(let m=0;m<e;++m){const k=a[m];if(k.geometryType===b.geometryType&&c>k.indexFrom&&c<=k.indexFrom+k.indexCount)return c<k.indexFrom+k.indexCount&&(b=new w,b.geometryType=k.geometryType,b.materialKey=k.materialKey,b.indexFrom=c,b.indexCount=k.indexFrom+k.indexCount-c,
a.splice(m+1,0,b),k.indexCount=c-k.indexFrom),m}};d._addToList=function(b,a){const e=this._getDisplayList(b.symbolLevel,b.zOrder);a=null!=a?a:e.length-1;var c=0<=a&&a<e.length?e[a]:null;null!==c&&c.materialKey===b.materialKey&&c.indexFrom+c.indexCount===b.indexFrom&&c.geometryType===b.geometryType?c.indexCount+=b.indexCount:(c=new w,c.indexFrom=b.indexFrom,c.indexCount=b.indexCount,c.materialKey=b.materialKey,c.geometryType=b.geometryType,D(e,a+1,0,c))};d._removeFromList=function(b){const a=this._getDisplayList(b.symbolLevel,
b.zOrder);var e=a.length;let c=void 0;for(var m=0;m<e;++m){var k=a[m];if(b.indexFrom+b.indexCount>k.indexFrom&&b.indexFrom<k.indexFrom+k.indexCount&&k.geometryType===b.geometryType){c=m;break}}if(void 0!==c){e=a[c];if(b.indexFrom===e.indexFrom)return e.indexCount-=b.indexCount,e.indexFrom+=b.indexCount,0===e.indexCount&&D(a,c,1),c-1;if(b.indexFrom+b.indexCount===e.indexFrom+e.indexCount)return e.indexCount-=b.indexCount,0===e.indexCount?(D(a,c,1),c-1):c;m=e.indexFrom;k=b.indexFrom-e.indexFrom;const n=
b.indexCount;b=e.indexFrom+e.indexCount-(b.indexFrom+b.indexCount);e.indexCount=k;const x=new w;x.geometryType=e.geometryType;x.materialKey=e.materialKey;x.indexFrom=m+k+n;x.indexCount=b;D(a,c+1,0,x);return c}return null};d._getDisplayList=function(b,a){let e;var c=this.symbolLevels.length;for(let k=0;k<c;k++)if(this.symbolLevels[k].symbolLevel===b){e=this.symbolLevels[k];break}e||(e=new g,e.symbolLevel=b,this.symbolLevels.push(e));let m;b=e.zLevels.length;for(c=0;c<b;c++)if(e.zLevels[c].zLevel===
a){m=e.zLevels[c];break}m||(m=new p,m.geometryDPInfo=new t,m.zLevel=a,e.zLevels.push(m));m.geometryDPInfo.unified||(m.geometryDPInfo.unified=[]);return m.geometryDPInfo.unified};d.getDPInfoType=function(){return"unified"};l._createClass(f,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return f}(),w=function(){function f(){this.materialKey=null;this.indexCount=this.indexFrom=0}f.prototype.clone=function(){const d=new f;d.geometryType=this.geometryType;d.materialKey=
this.materialKey;d.indexFrom=this.indexFrom;d.indexCount=this.indexCount;return d};return l._createClass(f)}(),t=function(){function f(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}f.prototype.clone=function(){const d=new f;d.fill=this.fill&&this.fill.map(b=>b.clone());d.line=this.line&&this.line.map(b=>b.clone());d.marker=this.marker&&this.marker.map(b=>b.clone());d.text=this.text&&this.text.map(b=>b.clone());d.label=this.label&&this.label.map(b=>b.clone());d.unified=this.unified&&
this.unified.map(b=>b.clone());return d};return l._createClass(f)}(),p=function(){function f(){this.geometryDPInfo=new t}f.prototype.clone=function(){const d=new f;d.zLevel=this.zLevel;d.geometryDPInfo=this.geometryDPInfo.clone();return d};return l._createClass(f)}(),g=function(){function f(){this.zLevels=[]}f.prototype.clone=function(){const d=new f;d.symbolLevel=this.symbolLevel;for(const b of this.zLevels)d.zLevels.push(b.clone());return d};return l._createClass(f)}();return E})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"./WGLDisplayRecord","./util/serializationUtils"],function(l,h,D){return function(){function E(t){this.insertAfter=null;this.id=t;this.displayRecords=[]}var w=E.prototype;w.copy=function(){const t=new E(this.id);t.set(this);return t};w.clone=function(){const t=new E(this.id);t.displayRecords=this.displayRecords.map(p=>p.clone());t.insertAfter=this.insertAfter;return t};w.set=function(t){this.id=t.id;this.displayRecords=t.displayRecords;this.insertAfter=t.insertAfter};w.serialize=function(t){t.push(this.id);
D.serializeList(t,this.displayRecords);return t};E.deserialize=function(t){const p=t.readInt32(),g=new E(p);g.displayRecords=D.deserializeList(t,h,{id:p})??[];return g};return l._createClass(E)}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./MeshData","./Utils"],function(l,h,D){return function(){function E(t,p,g,f=0,d=0){this.id=t;this.geometryType=p;this.materialKey=g;this.minZoom=f;this.maxZoom=d;this.meshData=null;this.indexCount=
this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0;this._sortKey=null}var w=E.prototype;w.clone=function(){return this.copy()};w.copy=function(){const t=new E(this.id,this.geometryType,this.materialKey);t.vertexFrom=this.vertexFrom;t.vertexCount=this.vertexCount;t.indexFrom=this.indexFrom;t.indexCount=this.indexCount;t.zOrder=this.zOrder;t.symbolLevel=this.symbolLevel;t.meshData=this.meshData;t.minZoom=this.minZoom;t.maxZoom=this.maxZoom;return t};w.setMeshDataFromBuffers=
function(t,p,g){const f=new h;for(const d in p){const b=p[d].stride,a=p[d].data;if(!a)continue;const e=[],c=D.strideToPackingFactor(b);for(let m=0;m<b*t.vertexCount/c;++m)e[m]=a[m+b*t.vertexFrom/c];f.vertexData.set(d,e)}f.indexData.length=0;for(p=0;p<t.indexCount;++p)f.indexData[p]=g[p+t.indexFrom]-t.vertexFrom;f.vertexCount=t.vertexCount;this.meshData=f};w.readMeshDataFromBuffers=function(t,p){this.meshData?this.meshData.clear():this.meshData=new h;for(const g in t){const f=t[g].stride,d=t[g].data,
b=[],a=D.strideToPackingFactor(f);for(let e=0;e<f*this.vertexCount/a;++e)b[e]=d[e+f*this.vertexFrom/a];this.meshData.vertexData.set(g,b)}this.meshData.indexData.length=0;for(t=0;t<this.indexCount;++t)this.meshData.indexData[t]=p[t+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};w.writeMeshDataToBuffers=function(t,p,g,f){if(this.meshData){for(const d in p){const b=p[d].stride,a=this.meshData.vertexData.get(d),e=p[d].data,c=D.strideToPackingFactor(b);for(let m=0;m<b*this.meshData.vertexCount/
c;++m)e[m+b*t/c]=a[m]}for(p=0;p<this.meshData.indexData.length;++p)f[p+g]=this.meshData.indexData[p]+t;this.vertexFrom=t;this.vertexCount=this.meshData.vertexCount;this.indexFrom=g;this.indexCount=this.meshData.indexData.length}};E.writeAllMeshDataToBuffers=function(t,p,g){let f=0,d=0;for(const b of t)b.writeMeshDataToBuffers(f,p,d,g),f+=b.vertexCount,d+=b.indexCount};w._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};w.serialize=function(t){t.push(this.geometryType);
t.push(this.materialKey);t.push(this.vertexFrom);t.push(this.vertexCount);t.push(this.indexFrom);t.push(this.indexCount);t.push(this.minZoom);t.push(this.maxZoom);return t};E.deserialize=function(t,p){const g=t.readInt32(),f=t.readInt32();p=new E(p.id,g,f);p.vertexFrom=t.readInt32();p.vertexCount=t.readInt32();p.indexFrom=t.readInt32();p.indexCount=t.readInt32();p.minZoom=t.readInt32();p.maxZoom=t.readInt32();return p};l._createClass(E,[{key:"sortKey",get:function(){null==this._sortKey&&this._computeSortKey();
return this._sortKey}}]);return E}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function h(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var D=h.prototype;D.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};D.update=function(E,w,t){for(const p in E)this.vertexData.set(p,E[p]);for(const p in this.vertexData)null===E[p]&&this.vertexData.delete(p);this.vertexCount=
w;this.indexData=t};return l._createClass(h)}()})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(l){l.deserializeList=function(h,D,E){var w=h.readInt32();w=Array(w);for(let t=0;t<w.length;t++)w[t]=D.deserialize(h,E);return w};l.serializeList=function(h,D){if(null===D)h.push(0);else{h.push(D.length);for(const E of D)E.serialize(h);return h}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/cpuMapped/DisplayRecordReader":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions"],function(l,h,D,E){let w=function(){function p(f){this._cursor=this._head=f}p.from=function(f,d=0,b=f.byteLength/t.BYTES_PER_RECORD-d){f=new t(new Int32Array(f,d*t.BYTES_PER_RECORD,b*t.ELEMENTS_PER_RECORD));return new p(f)};var g=p.prototype;g.size=function(){let f=this._cursor,d=0;for(;f;)d+=f.size(),f=f._link;return d};g.seekIndex=function(f){for(this._cursor=this._head;this._cursor;){const d=this._cursor.size();
if(f<d)return this._cursor._index=f,!0;f-=d;this._cursor=this._cursor._link}return!1};g.forEach=function(f){const d=this.getCursor();for(;d.next();)f(d)};g.link=function(f){if(this._head){for(var d=this._head;d._link;)d=d._link;d._link=f._head;d._link._indexStart=d._indexStart+d.size()}else this._head=f._head};g.getCursor=function(){return this.copy()};g.lookup=function(f){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(f);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor};
g.copy=function(){const f=new p(this._head?.copy());if(!f._head)return f;let d=f._head,b=f._head._link;for(;b;)d._link=b.copy(),d=b,b=d._link;return f};g.next=function(){if(!this._cursor)return!1;if(!this._cursor.next()){if(!this._cursor._link)return!1;this._cursor=this._cursor._link;return this.next()}return!0};g.peekId=function(){return this._cursor.peekId()??this._cursor._link.peekId()};g.delete=function(f){let d=this._head,b=null;for(;d;){if(d.delete(f))return d.isEmpty()&&(D.isSome(b)&&(b._link=
d._link),d===this._head&&(this._head=d._link),d===this._cursor&&(this._cursor=d._link)),!0;b=d;d=d._link}return!1};h._createClass(p,[{key:"id",get:function(){return this._cursor.id},set:function(f){this._cursor.id=f}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(f){this._cursor.materialKey=f}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(f){this._cursor.indexFrom=f}},
{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(f){this._cursor.indexCount=f}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(f){this._cursor.vertexFrom=f}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(f){this._cursor.vertexCount=f}},{key:"sortKey",get:function(){return this._cursor.sortKey},set:function(f){this._cursor.sortKey=f}},{key:"index",get:function(){return this._cursor._indexStart+this._cursor._index}}]);
return p}();w.ELEMENTS_PER_RECORD=E.DISPLAY_RECORD_INT_PER_ELEMENT;w.BYTES_PER_RECORD=w.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;let t=function(){function p(f){this._link=null;this._index=-1;this._indexStart=0;this._packedRecordsF32=null;this._deletedCount=0;this._offsets={instance:null};this._packedRecords=f}p.from=function(f,d=0,b=f.byteLength/this.BYTES_PER_RECORD-d){return new p(new Int32Array(f,d*this.BYTES_PER_RECORD,b*this.ELEMENTS_PER_RECORD))};var g=p.prototype;g.delete=function(f){const d=
this._index,b=this.lookup(f);if(b)for(this.id=2147483647,++this._deletedCount;this.next()&&this.id===f;)this.id=2147483647,++this._deletedCount;this._index=d;return b};g.isEmpty=function(){return this._deletedCount===this.size()};g.link=function(f){this._link?this._link.link(f):this._link=f};g.lookup=function(f){if(D.isNone(this._offsets.instance)){this._offsets.instance=new Map;var d=this.copy();d._index=-1;let b=0;for(;d.next();)d.id!==b&&(this._offsets.instance.set(d.id,d._index),b=d.id)}if(!this._offsets.instance.has(f))return!1;
d=this._index;this._index=this._offsets.instance.get(f);return 2147483647===this.id?(this._index=d,!1):!0};g.size=function(){return this._packedRecords.length/p.ELEMENTS_PER_RECORD};g.next=function(){for(;++this._index<this.size()&&2147483647===this.id;);return this._index<this.size()};g.peekId=function(){const f=(this._index+1)*p.ELEMENTS_PER_RECORD;return f>=this._packedRecords.length?0:this._packedRecords[f]};g.getCursor=function(){return this.copy()};g.copy=function(){const f=new p(this._packedRecords);
f._indexStart=this._indexStart;f._link=this._link;f._index=this._index;f._offsets=this._offsets;f._deletedCount=this._deletedCount;return f};h._createClass(p,[{key:"id",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD]},set:function(f){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD]=f}},{key:"materialKey",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+1]},set:function(f){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+1]=f}},{key:"insertAfter",
get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+3]},set:function(f){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+3]=f}},{key:"indexCount",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+4]},set:function(f){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+4]=f}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*
p.ELEMENTS_PER_RECORD+5]},set:function(f){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+5]=f}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+6]},set:function(f){this._packedRecords[this._index*p.ELEMENTS_PER_RECORD+6]=f}},{key:"sortKey",get:function(){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));return this._packedRecordsF32[this._index*p.ELEMENTS_PER_RECORD+7]},set:function(f){this._packedRecordsF32||
(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer));this._packedRecordsF32[this._index*p.ELEMENTS_PER_RECORD+7]=f}},{key:"index",get:function(){return this._index}}]);return p}();t.ELEMENTS_PER_RECORD=E.DISPLAY_RECORD_INT_PER_ELEMENT;t.BYTES_PER_RECORD=t.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;l.DisplayRecordReader=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../Utils"],function(l,h,D){let E=function(){function t(p,g){this.data=p;this.stride=g}t.decode=function(p){const g=D.allocateTypedArrayBufferwithData(p.data,p.stride);return new t(g,p.stride)};t.fromVertexVector=function(p){const g=D.allocateTypedArrayBufferwithData(p.data.buffer(),p.stride);return new t(g,p.stride)};return h._createClass(t)}(),w=function(){function t(p,g,f){this.geometryType=p;this.indexBuffer=new Uint32Array(g);this.namedBuffers=f}t.decode=function(p){const g=p.geometryType,f=
p.indexBuffer,d={};for(const b in p.namedBuffers)d[b]=E.decode(p.namedBuffers[b]);return new t(g,f,d)};t.fromVertexData=function(p,g){const f=p.indices,d=D.allocateTypedArrayBufferwithData(p.vertices,p.stride);p={geometry:new E(d,p.stride)};return new t(g,f,p)};t.fromVertexVectors=function(p){const g=p.geometryType,f=p.indexVector.buffer(),d={};for(const b in p.namedVectors)d[b]=E.fromVertexVector(p.namedVectors[b]);return new t(g,f,d)};return h._createClass(t)}();l.VertexBuffers=w;Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","./VertexBuffer","../util/Writer"],function(l,h,D,E,w){let t=function(){function g(f,d){this.data=f;this.stride=d}g.prototype.transfer=function(f,d){const b=this.data.buffer();f.vertexCount=this.vertexCount;f.data=b;f.stride=this.stride;d.push(b)};h._createClass(g,[{key:"vertexCount",get:function(){const f=this.data.length/
(this.stride/4);f!==(f|0)&&console.debug("Corrupted stride");return f}}]);return g}(),p=function(){function g(d,b,a){this.geometryType=d;this.indexVector=new w(Uint32Array,6*b);this.namedVectors={};d=D.getStrides(d,a);for(const e in d){a=d[e];let c;switch(a%4){case 0:case 2:c=new w(Uint32Array,a*b);break;case 1:case 3:c=new w(Uint8Array,a*b)}this.namedVectors[e]=new t(c,a)}}var f=g.prototype;f.get=function(d){return this.namedVectors[d].data};f.getVector=function(d){return this.namedVectors[d]};f.transfer=
function(d,b){const a=this.indexVector.buffer(),e={};b.push(a);for(const c in this.namedVectors){const m=this.namedVectors[c];e[c]={};m.transfer(e[c],b)}d.geometryType=this.geometryType;d.indexBuffer=a;d.namedBuffers=e;this.destroy()};f.intoBuffers=function(){const d=E.VertexBuffers.fromVertexVectors(this);this.destroy();return d};f.destroy=function(){this.namedVectors=this.indexVector=null};return h._createClass(g)}();l.VertexVector=t;l.VertexVectors=p;Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(l){return function(){function h(E,w){this._pos=0;w=w?this._roundToNearest(w,E.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(w);this._buffer=new E(this._array);this._ctor=E;this._i16View=new Int16Array(this._array)}var D=h.prototype;D._roundToNearest=function(E,w){E=Math.round(E);return E+(w-E%w)};D._ensureSize=function(E){if(this._pos+E>=this._buffer.length){E=
this._roundToNearest(1.25*(this._array.byteLength+E*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);E=new ArrayBuffer(E);const w=new this._ctor(E);w.set(this._buffer,0);this._array=E;this._buffer=w;this._i16View=new Int16Array(this._array)}};D.ensureSize=function(E){this._ensureSize(E)};D.writeF32=function(E){this._ensureSize(1);const w=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=E;this._pos++;return w};D.push=function(E){this._ensureSize(1);const w=this._pos;this._buffer[this._pos++]=
E;return w};D.writeFixed=function(E){this._buffer[this._pos++]=E};D.setValue=function(E,w){this._buffer[E]=w};D.i1616Add=function(E,w,t){this._i16View[2*E]+=w;this._i16View[2*E+1]+=t};D.getValue=function(E){return this._buffer[E]};D.incr=function(E){if(this._buffer.length<E)throw Error("Increment index overflows the target buffer");this._buffer[E]++};D.decr=function(E){this._buffer[E]--};D.writeRegion=function(E){this._ensureSize(E.length);const w=this._pos;this._buffer.set(E,this._pos);this._pos+=
E.length;return w};D.writeManyFrom=function(E,w,t){for(this._ensureSize(t-w);w!==t;w++)this.writeFixed(E._buffer[w])};D.buffer=function(){const E=this._array.slice(0,4*this._pos);this.destroy();return E};D.toArray=function(){const E=this._array,w=[];for(let t=0;t<E.byteLength/4;t++)w.push(E[t]);return w};D.seek=function(E){this._pos=E};D.destroy=function(){this._buffer=this._array=null};l._createClass(h,[{key:"length",get:function(){return this._pos}}]);return h}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileKey ../../../tiling/TileQueue ../../../tiling/TileStrategy ../definitions ../DisplayId ../enums ../Utils ./VertexDataWriter ../../../layers/features/support/tileUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e){function c(k){switch(k){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case 128:return 1}}function m(k){switch(k){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case 128:return 1}}D=function(){function k(x,q,B,y,u,v=0){this.hasRecords=this._hasAggregate=!1;this._data={self:new Map,neighbors:[]};this._version=0;this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,
vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0};this.hint=q;this.tileKey=x;this._hasAggregate=y;this._pixelBufferEnabled=u;this._version=v;this._symbologyType=B}var n=k.prototype;n.serialize=function(x){const q=[];q.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self));this._data.neighbors.forEach((B,y)=>{var u=1<<y;y=c(u);u=m(u);y=e.getPow2NeighborKey(new w(this.tileKey),y,u,x);y=this._serializeTileVertexData(this.tileKey,y.id,B.vertexData);y.message.bufferIds=
B.displayIds;q.push(y)});return q};n._serializeTileVertexData=function(x,q,B){const y=[];B={[d.WGLGeometryType.MARKER]:B.get(d.WGLGeometryType.MARKER)?.serialize(y),[d.WGLGeometryType.FILL]:B.get(d.WGLGeometryType.FILL)?.serialize(y),[d.WGLGeometryType.LINE]:B.get(d.WGLGeometryType.LINE)?.serialize(y),[d.WGLGeometryType.TEXT]:B.get(d.WGLGeometryType.TEXT)?.serialize(y),[d.WGLGeometryType.LABEL]:B.get(d.WGLGeometryType.LABEL)?.serialize(y)};return{message:{tileKeyOrigin:x,tileKey:q,data:B,version:this._version},
transferList:y}};n.featureStart=function(x,q){this._current.insertAfter=x;this._current.sortKey=q};n.featureEnd=function(){};n.recordStart=function(x,q,B,y){this._current.writer=this._getVertexWriter(B);this._current.overlaps=0;this._current.indexStart=this._current.writer.indexCount;this._current.vertStart=this._current.writer.vertexCount;this._current.bufferingEnabled=y;this._current.id=x;this._current.materialKey=q;this._current.geometryType=B;this._current.isDotDensity=!1;this._current.writer.recordStart()};
n.recordCount=function(){return this._current.writer.recordCount};n.vertexCount=function(){return this._current.writer.vertexCount};n.indexCount=function(){return this._current.writer.indexCount};n.vertexEnsureSize=function(x){this._current.writer.vertexEnsureSize(x)};n.indexEnsureSize=function(x){this._current.writer.indexEnsureSize(x)};n.vertexBounds=function(x,q,B,y){this._current.bufferingEnabled&&this._addOverlap(x,q,B,y)};n.vertexWrite=function(x){this._current.writer.writeVertex(x)};n.vertexWriteF32=
function(x){this._current.writer.writeVertexF32(x)};n.vertexEnd=function(){};n.vertexWriter=function(){return this._current.writer.vertexWriter};n.indexWrite=function(x){this._current.writer.writeIndex(x)};n.indexWriter=function(){return this._current.writer.indexWriter};n.metricWriter=function(){return this._current.writer.metricWriter};n.metricStart=function(x,q,B,y,u,v,r,z){this._current.writer=this._getVertexWriter(d.WGLGeometryType.LABEL);const A=this._current.writer.metricWriter;A.push(f.getDisplayIdTexel(x));
A.push(q);A.push(B);A.push(y);A.push(u);A.push(v);A.push(r);A.push(z);A.push(255);this._current.metricBoxLenPointer=A.push(0)};n.metricEnd=function(){const x=this._current.writer.metricWriter;0===x.getValue(this._current.metricBoxLenPointer)&&x.seek(x.length-10)};n.metricBoxWrite=function(x,q,B,y){const u=this._current.writer.metricWriter;u.incr(this._current.metricBoxLenPointer);u.push(0);u.push(0);u.push(x);u.push(q);u.push(B);u.push(y)};n.recordEnd=function(){var x=this._current.vertStart,q=this._current.writer.vertexCount-
x;if(!q)return!1;this.hasRecords=!0;var B=this._current.indexStart;this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,B,this._current.writer.indexCount-B,x,q,this._current.sortKey);if(!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===d.WGLGeometryType.LABEL)return!0;x=this._current.writer;for(q=0;8>q;q++){var y=1<<q;if(this._current.overlaps&y){this._data.neighbors[q]||(this._data.neighbors[q]={vertexData:new Map,
displayIds:new Set});B=this._data.neighbors[q];var u=this._current.geometryType;if(!B.vertexData.has(u)){var v=b.getStrides(u,this._symbologyType).geometry;v=new a.VertexDataWriter(u,v,g.PATCH_PIXEL_BUFFER_ALLOC_SIZE);B.vertexData.set(u,v)}u=B.vertexData.get(this._current.geometryType);v=4096*-c(y);y=4096*-m(y);u?.copyLastFrom(x,v,y);B.displayIds.add(this._current.id)}}return!0};n._addOverlap=function(x,q,B,y){this._current.overlaps|=255^((x<0+B?148:x>=g.TILE_SIZE-B?41:189)|(q<0+y?224:q>=g.TILE_SIZE-
y?7:231))};n._getVertexWriter=function(x){if(!this._data.self.has(x)){const q=this._data.self,B=b.getStrides(x,this._symbologyType).geometry;q.set(x,new a.VertexDataWriter(x,B,this.hint.records))}return this._data.self.get(x)};h._createClass(k,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}}]);return k}();l.MeshData=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/DisplayId":function(){define(["exports"],
function(l){l.AGGREGATE_VALID_FILTERS_MASK=254;l.DISPLAY_ID_TEXEL_MASK=8388607;l.DISPLAY_ID_TYPE_AGGREGATE=1;l.DISPLAY_ID_TYPE_FEATURE=0;l.DISPLAY_ID_TYPE_MASK=8388608;l.NONAGGREGATE_VALID_FILTERS_MASK=255;l.createDisplayId=function(h,D){return((D?8388608:0)|h)>>>0};l.getDisplayIdFilterMask=h=>1===(h&8388608)>>>23?254:255;l.getDisplayIdTexel=h=>h&8388607;l.getDisplayIdType=h=>(h&8388608)>>>23;l.isAggregateId=function(h){return 1===(h&8388608)>>>23};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/mesh/VertexDataWriter":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../definitions","./heuristics","../util/Writer"],function(l,h,D,E,w){let t=function(){function p(f,d,b){this._start={index:0,vertex:0};b=E.getMeshSizeHint(f,d,b);d/=4;this.geometryType=f;this._records=new w(Int32Array,b.recordBytes);this._indices=new w(Uint32Array,b.indexBytes);this._vertices=new w(Uint32Array,b.vertexBytes);this._metrics=new w(Float32Array,0);this._strideInt=
d}var g=p.prototype;g.serialize=function(f){const d=this._records.buffer(),b=this._indices.buffer(),a=this._vertices.buffer(),e=this._metrics.length?this._metrics.buffer():null,c=4*this._strideInt;f.push(d,b,a);return{stride:c,records:d,indices:b,vertices:a,metrics:e}};g.vertexEnsureSize=function(f){this._vertices.ensureSize(f)};g.indexEnsureSize=function(f){this._indices.ensureSize(f)};g.recordStart=function(){this._start.index=this._indices.length;this._start.vertex=this._vertices.length};g.recordEnd=
function(f,d,b,a,e,c,m,k){this._records.push(f);this._records.push(d??0);this._records.push(b);this._records.push(a);this._records.push(e);this._records.push(c);this._records.push(m);this._records.writeF32(k)};g.writeIndex=function(f){this._indices.push(f)};g.writeVertex=function(f){this._vertices.push(f)};g.writeVertexF32=function(f){this._vertices.writeF32(f)};g.copyLastFrom=function(f,d,b){var a=f._records.length-D.DISPLAY_RECORD_INT_PER_ELEMENT;const e=f._records.getValue(a),c=f._records.getValue(a+
1),m=f._records.getValue(a+2),k=f._records.getValue(a+4),n=f._records.getValue(a+6);a=f._records.getValue(a+7);const x=this._vertices.length;var q=(f._start.vertex-this._vertices.length)/this._strideInt;const B=this._indices.length,y=this.vertexCount;for(var u=f._start.index;u!==f._indices.length;u++){const v=f._indices.getValue(u);this._indices.push(v-q)}for(q=f._start.vertex;q!==f._vertices.length;q++)u=f._vertices.getValue(q),this._vertices.push(u);for(f=x;f<=this._vertices.length;f+=this._strideInt)this._vertices.i1616Add(f,
d,b);this._records.push(e);this._records.push(c);this._records.push(m);this._records.push(B);this._records.push(k);this._records.push(y);this._records.push(n);this._records.push(a)};h._createClass(p,[{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/D.DISPLAY_RECORD_INT_PER_ELEMENT}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",
get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}}]);return p}();l.VertexDataWriter=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/heuristics":function(){define(["exports","../definitions","../enums"],function(l,h,D){const E=new Map;E.set(D.WGLGeometryType.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4});E.set(D.WGLGeometryType.LINE,
{multiplier:1,indicesPerRecord:24,verticesPerRecord:8});E.set(D.WGLGeometryType.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10});E.set(D.WGLGeometryType.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});E.set(D.WGLGeometryType.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});l.getMeshSizeHint=function(w,t,p){const {indicesPerRecord:g,multiplier:f,verticesPerRecord:d}=E.get(w);return{recordBytes:p*h.DISPLAY_RECORD_INT_PER_ELEMENT*Uint32Array.BYTES_PER_ELEMENT,indexBytes:f*
g*p*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:f*d*p*t}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/tileUtils":function(){define(["exports"],function(l){l.getPow2NeighborKey=function(h,D,E,w){h=h.clone();const t=1<<h.level;D=h.col+D;E=h.row+E;w&&0>D?(h.col=D+t,--h.world):D>=t?(h.col=D-t,h.world+=1):h.col=D;h.row=E;return h};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/libtess ../../DisplayId ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(l,h,D,E,w,t,p,g,f,d){D=function(){function b(e,c,m){this._loadPromise=t.loadLibtess();this._geometryType=e;this._idField=c;this._templateStore=m}var a=b.prototype;a.update=function(e,c){E.isSome(e.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(e.mesh.labels,c));this._schema=e};a._createLabelTemplates=function(e,c){const m=new Map;if("simple"===e.type){for(var k of e.classes)e=g.fromLabelClass(k,c),m.set(k.index,e);return m}for(const n in e.classes){k=e.classes[n];for(const x of k)k=
g.fromLabelClass(x,c),m.set(x.index,k)}return m};a.analyze=async function(e,c,m,k,n,x,q){if(!w.isAborted(q)){var B;"dictionary"===m?.type&&(B=await m.analyze(this._idField,e.copy(),c,n,x,q));for(c=0;e.next();){var y=null;y=B?B[c++]:E.isSome(k)&&p.isAggregateId(e.getDisplayId())&&1!==e.readAttribute("cluster_count")?k.match(this._idField,e,this._geometryType,n,x):m.match(this._idField,e,this._geometryType,n,x);e.setGroupId(y);if(d.isDynamicId(y)){y=this._templateStore.getDynamicTemplateGroup(y).templates;
for(const u of y)u&&u.analyze&&u.analyze(this._templateStore,e,n,x)}}await this._loadPromise;return this._templateStore.finalize(q)}};a.analyzeGraphics=async function(e,c,m,k,n,x){if(!w.isAborted(x)){e=e.getCursor();for(m&&await m.analyze(this._idField,e.copy(),c,k,n,x);e.next();){c=e.getGroupId();if(null==c||-1===c)c=m?.match(this._idField,e,e.geometryType,k,n),e.setGroupId(c);if(d.isDynamicId(c)){const q=this._templateStore.getDynamicTemplateGroup(c).templates;for(const B of q)B&&B.analyze&&B.analyze(this._templateStore,
e,k,n)}e.setGroupId(c)}await this._loadPromise;return this._templateStore.finalize(x)}};a.writeGraphic=function(e,c,m,k){const n=c.getGroupId(),x=c.getDisplayId(),q=this._templateStore.getTemplateGroup(n);e.featureStart(c.insertAfter,0);if(null!=x){if(d.isDynamicId(n))for(const B of q.templates)B&&B.bindFeature(c,null,null);if(q){for(const B of q.templates)B&&B.write(e,c,m,k);e.featureEnd()}}};a.writeCursor=function(e,c,m,k,n,x,q){const B=c.getGroupId(),y=c.getDisplayId();var u=this._templateStore.getTemplateGroup(B);
const v=u.templates;u=this._getSortKeyValue(c,u);e.featureStart(0,u);if(null!=y&&v){if(d.isDynamicId(B))for(const r of v)r.bindFeature(c,m,k);for(const r of v)r.write(e,c,n,q);E.isSome(x)&&e.hasRecords&&(m=x&&this._findLabelRef(v),this._writeLabels(e,c,x,m,n,q));e.featureEnd()}};a._getSortKeyValue=function(e,c){const m=this._schema.mesh.sortKey;if(E.isNone(m))return 0;let k=0;k=!0===m.byRenderer&&null!=c.sortKey?c.sortKey:null!=m.fieldIndex?e.getComputedNumericAtIndex(m.fieldIndex):null!=m.field?
e.readAttribute(m.field):e.readAttribute(this._idField);k*="asc"===m.order?1:-1;return null==k||isNaN(k)?0:k};a._findLabelRef=function(e){for(const c of e)if(c instanceof f)return c;return null};a._writeLabels=function(e,c,m,k,n,x){for(const q of m)if(E.isSome(q)&&q){const {glyphs:B,rtl:y,index:u}=q;if(m=this._labelTemplates.get(u))m.setZoomLevel(n),m.bindReferenceTemplate(k),m.bindTextInfo(B,y),m.write(e,c,null,x)}};h._createClass(b,[{key:"templates",get:function(){return this._templateStore}}]);
return b}();l.WGLMeshFactory=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/libtess":function(){define(["require","exports","../assets","../core/has"],function(l,h,D,E){async function w(){p=await (E("esri-csp-restrictions")?await (new Promise((g,f)=>l(["../chunks/libtess-asm"],g,f))).then(g=>g.libtessAsm):await (new Promise((g,f)=>l(["../chunks/libtess"],g,f))).then(g=>g.libtess)).load({locateFile:g=>D.getAssetUrl(`esri/core/libs/libtess/${g}`)})}let t=null,p=null;
h.loadLibtess=async function(){t||(t=w());return t};h.triangulate=function(g,f){return p.triangulate(g,f,Math.max(g.length,128E3))};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./segmentUtils ./WGLTextTemplate".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n){const x=D.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),q=(y,u="mapview-labeling")=>x.error(new h(u,y)),B=function(y){const u=new Map;return v=>{u.has(v)||u.set(v,y(v));return u.get(v)}}(y=>{let u=0;if(0===y)return Infinity;for(;!(y%2);)u++,y/=2;return u});return function(y){function u(r,z,A,C){var F=v.call(this,r,A.font?.size,A.haloSize||0,A.font?.size,A.color&&b.premultiplyAlphaRGBAArray(A.color)||0,A.haloColor&&b.premultiplyAlphaRGBAArray(A.haloColor)||
0,A.horizontalAlignment,A.verticalAlignment,d.isMapAligned(z.labelPlacement)?f.Alignment.MAP:f.Alignment.SCREEN,A.font?.decoration,!1,A.angle||0,A.xoffset,A.yoffset,A.lineWidth,A.lineHeight,null,null,!1,null,null,A.backgroundColor&&b.premultiplyAlphaRGBAArray(A.backgroundColor),A.borderLineColor&&b.premultiplyAlphaRGBAArray(A.borderLineColor),A.borderLineSize);F._outLineLabelAngle=0;F._refPlacementPadding=0;F._refPlacementDirX=0;F._refPlacementDirY=0;F._refOffsetX=0;F._refOffsetY=0;F._zoomLevel=0;
F.geometryType=e.WGLGeometryType.LABEL;F._allowOverrun=z.allowOverrun??!1;F._repeatLabel=z.repeatLabel??!0;F._labelPosition=z.labelPosition??"curved";var G=!!z.minScale&&C.scaleToZoom(z.minScale)||0;G=E.clamp(G,0,25.5);C=!!z.maxScale&&C.scaleToZoom(z.maxScale)||255;C=E.clamp(C,0,25.5);const [H,K]=d.getAlignmentFromPlacement(z.labelPlacement);F._xAlignD=H;F._yAlignD=K;F._minZoom=G;F._maxZoom=C;F._minBackgroundZoom=G;F._maxBackgroundZoom=C;F._refPlacementPadding=t.pt2px(A.haloSize)+a.TEXT_PLACEMENT_PADDING;
F._repeatLabelDistance=z.repeatLabelDistance?t.pt2px(z.repeatLabelDistance):128;r=m.LabelMaterialKey.load(r);r.sdf=!0;F._materialKey=r.data;return F}l._inherits(u,y);var v=l._createSuper(u);u.fromLabelClass=function(r,z){if("esriServerLinePlacementCenterAlong"===r.labelPlacement){const A=r.symbol;A.xoffset=0;A.yoffset=0;A.angle=0;A.font.decoration="none"}return new u(r.materialKey,r,r.symbol,z)};y=u.prototype;y.setZoomLevel=function(r){this._zoomLevel=r};y.bindReferenceTemplate=function(r){let z=
d.getXDirection(this._xAlignD),A=d.getYDirection(this._yAlignD);this._refOffsetY=this._refOffsetX=0;if(w.isNone(r))this._refSymbolAndPlacementOffset=c.i8888to32(0,0,Math.floor(127*z+127),Math.floor(127*A+127));else{if("circle"===r.boundsType&&(z||A)){var C=Math.sqrt(z*z+A*A);z/=C;A/=C}C=Math.max(r.height,r.width);this._refSymbolAndPlacementOffset=c.i8888to32(4*this._refPlacementPadding,C,Math.floor(127*z+127),Math.floor(127*A+127));this._referenceSize=C;this._refPlacementDirX=z;this._refPlacementDirY=
A;this._refOffsetX=r.xOffset;this._refOffsetY=r.yOffset}};y._write=function(r,z){if(!w.isNone(this._shapingInfo)){var A=this._shapingInfo,C=z.getDisplayId(),F="esriGeometryPolygon"===z.geometryType?z.readLegacyCentroid():z.readLegacyGeometry();if(F)switch(this._current={out:r,inId:C,inShaping:A,zoomLevel:this._zoomLevel},"esriGeometryPolyline"===z.geometryType&&"curved"===this._labelPosition&&(this._borderLineColor||this._backgroundColor)&&x.warnOnce("TextSymbol properties 'borderLineColor', 'borderLineSize', and 'backgroundColor' are not supported in curved labels"),
z.geometryType){case "esriGeometryPolyline":this._placeLineLabels(F);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(F);break;default:q(`Geometry of type ${z.geometryType} is not supported`)}}};y._isVisible=function(r,z){const A=Math.floor(10*this._current.zoomLevel);return Math.floor(10*r)<=A&&A<=Math.floor(10*z)};y._placePointLabels=function(r){const {out:z,inId:A,inShaping:C}=this._current;this._writeGlyphs(z,A,r,C)};y._placeLineLabels=function(r){r=k.smoothPaths(r.paths,
this._current.inShaping.bounds.width);const z=this._placeSubdivGlyphs.bind(this),A=(this._shapedBox.width+this._repeatLabelDistance)/2;for(const C of r)k.pathDivide(C,A,z,this._repeatLabel)};y._placeSubdivGlyphs=function(r,z,A,C){var F=B(z),G=this._shapedBox.width/2,H=Math.sqrt(this._repeatLabelDistance)/2;A=Math.min(A,C-A);G=this._current.inShaping.isMultiline?25:Math.log2(A/(H+G/2));F=Math.max(this._minZoom,this._current.zoomLevel+1-(0===z?G:Math.min(F,G)));G=this._current.zoomLevel-F;H=this._shapedBox.width/
2*2**G;this._current.inShaping.isMultiline?0===z&&this._placeStraight(r,F):this._allowOverrun&&0>G?this._placeStraightAlong(r,this._minZoom):"parallel"===this._labelPosition?this._placeStraightAlong(r,F):"curved"===this._labelPosition&&this._placeCurved(r,F,H)};y._placeStraight=function(r,z){const {out:A,inId:C,inShaping:F}=this._current,G=Math.ceil((180/Math.PI*r.angle+180)%360);this._outLineLabelAngle=Math.round(254/360*Math.ceil(180/Math.PI*r.angle%360));this._writeGlyphs(A,C,r,F,z);this._outLineLabelAngle=
Math.round(254/360*G);this._writeGlyphs(A,C,r,F,z)};y._placeCurved=function(r,z,A){const {out:C,inId:F}=this._current;C.metricStart(F,z,r.x,r.y,0,0,0,0);const G=r.clone(),H=(180/Math.PI*r.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*r.angle%360*(254/360));this._placeFirst(G,z,1);this._placeBack(r,G,z,A,1);this._placeForward(r,G,z,A,1);this._outLineLabelAngle=Math.round(254/360*H);this._placeFirst(G,z,0);this._placeBack(r,G,z,A,0);this._placeForward(r,G,z,A,0);C.metricEnd()};y._placeStraightAlong=
function(r,z){const {out:A,inId:C,inShaping:F}=this._current;A.metricStart(C,z,r.x,r.y,0,0,0,0);const G=r.clone(),H=180/Math.PI*r.angle%360,K=(180/Math.PI*r.angle+180)%360;var J=0<F.glyphs.length&&(this._borderLineColor||this._backgroundColor);this._maxBackgroundZoom=25;this._minBackgroundZoom=Math.max(z,0);if(J){J=m.LabelMaterialKey.load(this._materialKey);J.textureBinding=F.glyphs[0].textureBinding;const N=p.fromRotation(g.create(),-r.angle),[P,W]=F.shapeBackground(N);this._outLineLabelAngle=Math.round(254/
360*H);A.recordStart(C,J.data,this.geometryType,!0);this._writeBackgroundGeometry(A,C,r,P,W);A.recordEnd();this._outLineLabelAngle=Math.round(254/360*K);A.recordStart(C,J.data,this.geometryType,!0);this._writeBackgroundGeometry(A,C,r,P,W);A.recordEnd()}this._outLineLabelAngle=Math.round(254/360*H);this._placeFirst(G,z,1,!0);this._outLineLabelAngle=Math.round(254/360*K);this._placeFirst(G,z,0,!0);A.metricEnd()};y._placeBack=function(r,z,A,C,F){const G=r.clone();for(r=r.backwardLength+0;G.prev()&&!(r>=
C);)this._placeOnSegment(G,z,r,A,-1,F),r+=G.length+0};y._placeForward=function(r,z,A,C,F){const G=r.clone();for(r=r.remainingLength+0;G.next()&&!(r>=C);)this._placeOnSegment(G,z,r,A,1,F),r+=G.length+0};y._placeFirst=function(r,z,A,C=!1){const F=this._current.inShaping;var G=F.glyphs;const H=this._current.zoomLevel,{out:K,inId:J}=this._current;for(const N of G)G=N.x>F.bounds.x?A:1-A,G=Math.max(0,H+Math.log2(Math.abs(N.x+N.width/2-F.bounds.x)/(G*r.remainingLength+(1-G)*r.backwardLength))),G=Math.max(z,
C?0:G),N.maxZoom=25,N.angle=r.angle+(1-A)*Math.PI,N.minZoom=G,this._writeGlyph(K,J,r.x,r.y,N),A&&this._isVisible(N.minZoom,N.maxZoom)&&(G=N.bounds,K.metricBoxWrite(G.center[0],G.center[1],G.width,G.height))};y._placeOnSegment=function(r,z,A,C,F,G){var H=this._current.inShaping.glyphs;const {out:K,inId:J}=this._current,N=this._current.inShaping,P=this._current.zoomLevel;var W=r.x+r.dx/r.length*-F*A,X=r.y+r.dy/r.length*-F*A;for(const Z of H)if((H=Z.x>N.bounds.x?G:1-G)&&1===F||!H&&-1===F){var aa=Math.abs(Z.x+
Z.width/2-N.bounds.x);H=Math.max(0,P+Math.log2(aa/A)-.1);aa=Math.max(C,P+Math.log2(aa/(A+r.length+0)));0!==H&&(Z.angle=r.angle+(1-G)*Math.PI,Z.minZoom=aa,Z.maxZoom=H,this._writeGlyph(K,J,W,X,Z),G&&this._isVisible(Z.minZoom,Z.maxZoom)&&(H=Z.bounds,K.metricBoxWrite(H.center[0]+(r.x-z.x),H.center[1]+(r.y-z.y),H.width,H.height)))}};y._writeGlyphs=function(r,z,A,C,F=this._minZoom){if(!(0>A.x||512<=A.x||0>A.y||512<=A.y)){if(0<C.glyphs.length&&(this._borderLineColor||this._backgroundColor)){var G=m.LabelMaterialKey.load(this._materialKey);
G.textureBinding=C.glyphs[0].textureBinding;r.recordStart(z,G.data,this.geometryType,!0);this._writeBackgroundGeometry(r,z,A,C.bounds,C.background);r.recordEnd()}G=A.x+this._refOffsetX;A=A.y-this._refOffsetY;for(const H of C.glyphs)H.minZoom=F,H.maxZoom=this._maxZoom,this._writeGlyph(r,z,G,A,H);C=C.boundsT;r.metricStart(z,F,G,A,this._refPlacementDirX,this._refPlacementDirY,this._referenceSize,this._materialKey);r.metricBoxWrite(C.center[0],C.center[1],C.width,C.height);r.metricEnd()}};y._writeVertexCommon=
function(r,z,A,C){const F=this._color,G=this._haloColor,H=c.i8888to32(0,0,this._size,this._haloSize);C=c.i8888to32(Math.floor(10*Math.max(C.minZoom,this._minZoom)),Math.floor(10*Math.min(C.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);r.vertexWrite(A);r.vertexWrite(z);r.vertexWrite(F);r.vertexWrite(G);r.vertexWrite(H);r.vertexWrite(this._refSymbolAndPlacementOffset);r.vertexWrite(C)};y._writeBackgroundVertex=function(r,z,A,C,F,G){const H=c.i8888to32(0,0,this._size,this._haloSize),K=c.i8888to32(0,
0,0,0),J=c.i8888to32(Math.floor(10*this._minBackgroundZoom),Math.floor(10*this._maxBackgroundZoom),this._outLineLabelAngle,1);r.vertexWrite(A);r.vertexWrite(z);r.vertexWrite(C);r.vertexWrite(K);r.vertexWrite(H);r.vertexWrite(this._refSymbolAndPlacementOffset);r.vertexWrite(J);r.vertexWrite(F);r.vertexWrite(G);r.vertexEnd()};l._createClass(u,[{key:"_shapedBox",get:function(){return w.unwrap(this._shapingInfo).bounds}}]);return u}(n)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports",
"../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],function(l,h,D,E){function w(d){return d.length-1}function t(d){let b=0;for(let a=0;a<w(d);a++)b+=p(d,a);return b}function p(d,b,a=1){const [e,c]=d[b+1];return Math.sqrt(e*e+c*c)*a}function g(d,b,a,e,c){if(!(a<b)){var m=e.clone().seek(a/2);D.isNone(m)||(d(m.clone(),a,c),a=(a-b)/2,m=D.unwrap(m.seek(b/2)),g(d,b,a,e,c+1),g(d,b,a,m,c+1))}}let f=function(){function d(a,e,c,m,k){this._segments=a;this._index=e;
this._distance=c;this._xStart=m;this._yStart=k;this._done=!1}d.create=function(a){return new d(a,0,0,a[0][0],a[0][1])};var b=d.prototype;b.clone=function(){return new d(this._segments,this._index,this._distance,this.xStart,this.yStart)};b.equals=function(a){return this._index===a._index||a._index===this._index-1&&(0===this._distance||1===a._distance)||a._index===this._index+1&&(1===this._distance||0===a._distance)};b.leq=function(a){return this._index<a._index||this._index===a._index&&this._distance<=
a._distance};b.geq=function(a){return this._index>a._index||this._index===a._index&&this._distance>=a._distance};b.hasPrev=function(){return 0<=this._index-1};b.hasNext=function(){return this._index+1<w(this._segments)};b.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};b.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};
b._seekBackwards=function(a,e){var c=this.backwardLength;if(a<=c)return this._distance=(c-a)/this.length,this;for(c=this.backwardLength;this.prev();){if(c+this.length>a)return this._seekBackwards(a-c);c+=this.length}this._distance=0;return e?this:null};b.seek=function(a,e=!1){if(0>a)return this._seekBackwards(Math.abs(a),e);if(a<=this.remainingLength)return this._distance=(this.backwardLength+a)/this.length,this;let c=this.remainingLength;for(;this.next();){if(c+this.length>a)return this.seek(a-c,
e);c+=this.length}this._distance=1;return e?this:null};h._createClass(d,[{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){const a=this.dy;let e=Math.acos((0*a+-1*-this.dx)/(1*this.length));0<a&&(e=2*Math.PI-e);return e}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},
{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:a,dy:e}=this;return Math.sqrt(a*a+e*e)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",
get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);return d}();l.SegmentCursor=f;l.pathDivide=function(d,b,a,e=!0){const c=t(d);d=f.create(d);const m=c/2;if(e){e=Math.floor(Math.max((c-b)/2,0)/b);d.seek(m-e*b);for(let k=-e;k<=e;k++)512>d.x&&0<=d.x&&512>d.y&&0<=d.y&&a(d.clone(),k,m+k*b,c),d.seek(b)}else d.seek(m),a(d.clone(),0,m+0*b,c)};l.pathLength=t;l.pathSubdivide=function(d,b,a){g(a,b,t(d),f.create(d),
0)};l.segmentAt=function(d,b){return d[b+1]};l.segmentCount=w;l.segmentLength=p;l.smoothPaths=function(d,b){for(let C=0;C<d.length;C++){var a=d[C];const F=[];F.push(a[0]);for(var e=1;e<a.length;e++){let [G,H]=F[e-1];G+=a[e][0];H+=a[e][1];F.push([G,H])}a:{a=F;e=b;if(0>=e)break a;const G=a.length;if(3>G)break a;const H=[];var c=0;H.push(0);for(var m=1;m<G;m++)c+=E.dist(a[m],a[m-1]),H.push(c);e=Math.min(e,.2*c);c=[];c.push(a[0][0]);c.push(a[0][1]);m=a[G-1][0];const K=a[G-1][1];var k=E.sub([0,0],a[0],
a[1]);E.normalize(k);a[0][0]+=e*k[0];a[0][1]+=e*k[1];E.sub(k,a[G-1],a[G-2]);E.normalize(k);a[G-1][0]+=e*k[0];a[G-1][1]+=e*k[1];for(k=1;k<G;k++)H[k]+=e;H[G-1]+=e;k=.5*e;for(let J=1;J<G-1;J++){let N=0,P=0,W=0;for(var n=J-1;0<=n&&!(H[n+1]<H[J]-k);n--){var x=k+H[n+1]-H[J],q=H[n+1]-H[n],B=H[J]-H[n]<k?1:x/q;if(1E-6>Math.abs(B))break;var y=B*B,u=B*x-.5*y*q,v=B*q/e,r=a[n+1],z=a[n][0]-r[0],A=a[n][1]-r[1];N+=v/u*(r[0]*B*x+.5*y*(x*z-q*r[0])-y*B*q*z/3);P+=v/u*(r[1]*B*x+.5*y*(x*A-q*r[1])-y*B*q*A/3);W+=v}for(n=
J+1;n<G&&!(H[n-1]>H[J]+k);n++){x=k-H[n-1]+H[J];q=H[n]-H[n-1];B=H[n]-H[J]<k?1:x/q;if(1E-6>Math.abs(B))break;y=B*B;u=B*x-.5*y*q;v=B*q/e;r=a[n-1];z=a[n][0]-r[0];A=a[n][1]-r[1];N+=v/u*(r[0]*B*x+.5*y*(x*z-q*r[0])-y*B*q*z/3);P+=v/u*(r[1]*B*x+.5*y*(x*A-q*r[1])-y*B*q*A/3);W+=v}c.push(N/W);c.push(P/W)}c.push(m);c.push(K);for(let J=0,N=0;J<G;J++)a[J][0]=c[N++],a[J][1]=c[N++]}a=[];a.push(F[0]);for(e=1;e<F.length;e++){const [G,H]=F[e-1],[K,J]=F[e];a.push([Math.round(K-G),Math.round(J-H)])}d[C]=a}return d};Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(l){function h(D,E){return Math.sqrt(D*D+E*E)}l.DEFAULT_MAX_ZOOM=100;l.DEFAULT_MIN_ZOOM=0;l.dist=function(D,E){return h(D[0]-E[0],D[1]-E[1])};l.getLimitCosine=function(D=2){return 1/Math.max(D,1)};l.getMinMaxZoom=function(D,E){const w=!!D?.minScale&&E.scaleToZoom(D.minScale)||0;D=!!D?.maxScale&&E.scaleToZoom(D.maxScale)||100;return[w,D]};l.isExtent=function(D){return void 0!==
D.xmin&&void 0!==D.ymin&&void 0!==D.xmax&&void 0!==D.ymax};l.isFunction=function(D){return"function"===typeof D};l.isMultipoint=function(D){return void 0!==D.points};l.isPoint=function(D){return void 0!==D.x&&void 0!==D.y};l.isPolygon=function(D){return void 0!==D.rings};l.isPolyline=function(D){return void 0!==D.paths};l.len=h;l.normalize=function(D){const E=h(D[0],D[1]);D[0]/=E;D[1]/=E};l.sub=function(D,E,w){D[0]=E[0]-w[0];D[1]=E[1]-w[1];return D};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/BidiText ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),function(l,h,D,E,w,t,p,g,f,d,b,a){return function(e){function c(k,n,x,q,B,y,u,v,r,z,A,C,F,G,H,K,J,N,P,W,X,aa,Z,ea){var T=
m.call(this);T._xOffset=D.pt2px(F);T._yOffset=D.pt2px(G);T._decoration=z||"none";T._backgroundColor=aa;T._borderLineColor=Z;T._borderLineSize=ea;T._color=B;T._haloColor=y;T._haloSize=Math.min(Math.floor(5*D.pt2px(D.toPt(x))),127);T._size=Math.min(Math.round(D.pt2px(n)),127);n=Math.min(Math.round(D.pt2px(q||n)),127);T._referenceSize=Math.round(Math.sqrt(256*n));T._scale=T._size/p.GLYPH_SIZE;T._angle=C;T._justify=w.getJustification(u||"center");T._xAlignD=w.getXAnchorDirection(u||"center");T._yAlignD=
w.getYAnchorDirection(v||"baseline");T._baseline="baseline"===(v||"baseline");T._bitset=(r===E.Alignment.MAP?1:0)|(A?1:0)<<1;k=f.MaterialKeyBase.load(k);k.sdf=!0;T._materialKey=k.data;T._lineWidth=D.pt2px(H)||512;T._lineHeight=K||1;T._textPlacement=J;T._effects=N;T._isCIM=P??!1;T._minMaxZoom=g.i1616to32(Math.round(W*p.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(X*p.MIN_MAX_ZOOM_PRECISION_FACTOR));return T}l._inherits(c,e);var m=l._createSuper(c);c.fromText=function(k,n){const x=k.font?.size,q=new c(k.materialKey,
x,k.haloSize||0,x,k.color&&t.premultiplyAlphaRGBAArray(k.color)||0,k.haloColor&&t.premultiplyAlphaRGBAArray(k.haloColor)||0,k.horizontalAlignment,k.verticalAlignment,E.Alignment.SCREEN,k.font?.decoration,!1,k.angle||0,k.xoffset||0,k.yoffset||0,k.lineWidth||0,k.lineHeight||0,null,null,!1,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM,k.backgroundColor&&t.premultiplyAlphaRGBAArray(k.backgroundColor),k.borderLineColor&&t.premultiplyAlphaRGBAArray(k.borderLineColor),k.borderLineSize),[,B]=h.bidiText(k.text);q.bindTextInfo(n??
[],B);q._vertexBoundsScale=k.maxVVSize&&x?k.maxVVSize/x:1;return q};c.fromCIMText=function(k,n,x){var q=k.scaleFactor||1;const B=k.size*k.sizeRatio*q,[y,u]=d.getMinMaxZoom(k.scaleInfo,x);x=new c(k.materialKey,B,k.outlineSize*k.sizeRatio,k.referenceSize,t.premultiplyAlphaRGBA(k.color),t.premultiplyAlphaRGBA(k.outlineColor),k.horizontalAlignment,k.verticalAlignment,k.alignment,k.decoration,k.colorLocked??!1,k.angle,k.offsetX*k.sizeRatio*q,k.offsetY*k.sizeRatio*q,512,1,k.markerPlacement,k.effects,!0,
y,u,k.backgroundColor?t.premultiplyAlphaRGBA(k.backgroundColor):void 0,k.borderLineColor?t.premultiplyAlphaRGBA(k.borderLineColor):void 0,k.borderLineWidth);[,q]=h.bidiText(k.text);x.bindTextInfo(n,q);x._vertexBoundsScale=k.maxVVSize?k.maxVVSize/B:1;return x};return l._createClass(c)}(b(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../geometry/GeometryCursor ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/CIMCursor ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./shapingUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a){const e=d.i1616to32(4,4),c=d.i1616to32(4,2),m=d.i1616to32(4,6),k=[c,c,m,m],n=[c,m,c,m],x=[m,m,e,e],q=[e,e,m,m],B=[m,e,m,e],y=[e,m,e,m];return u=>function(v){function r(...A){A=z.call(this,...A);A._isCIM=!1;A._vertexBoundsScale=1;A.geometryType=f.WGLGeometryType.TEXT;A._aux=d.i8888to32(0,0,A._referenceSize,A._bitset);return A}l._inherits(r,v);var z=l._createSuper(r);v=r.prototype;v.bindTextInfo=function(A,C){this._shapingInfo=A&&A.length?h.applySome(A,F=>a.shapeGlyphs(F,
C,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:g.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM,hasBackground:!!this._backgroundColor,borderLineSize:this._borderLineSize})):null};v._write=function(A,C,F,G){const H=C.getDisplayId();this._writeGeometry(A,C,H,F,G)};v._writeGeometry=function(A,
C,F,G,H){const K=this._shapingInfo;if(!h.isNone(K)){if(h.isSome(this._textPlacement))return this._writePlacedText(A,F,K,G,C,H);C=H?w.deltaDecodeGeometry(w.convertFromGeometry(H),2):"esriGeometryPolygon"===C.geometryType?C.readCentroid():C.readGeometryForDisplay();if(!h.isNone(C)){if(C.isPoint){const [J,N]=C.coords;return!A.hasAggregates&&A.hasPixelBufferEnabled&&(0>J||512<=J||0>N||512<=N)?void 0:this._writeGlyphs(A,F,{x:J,y:N},K)}C.forEachVertex((J,N)=>this._writeGlyphs(A,F,{x:J,y:N},K))}}};v._writePlacedText=
function(A,C,F,G,H,K){var J=h.unwrap(this._textPlacement);K&&t.deltaDecodeGeometry(K);H=K?E.getJSONCursor(K):E.getOptimizedCursor(H.readGeometryForDisplay(),H.geometryType??null,!0);if(G=p.CIMMarkerPlacementHelper.getPlacement(H,J,D.pt2px(1),A.tileKey,G.geometryEngine))for(K=G.next();null!=K;)J=-K.getAngle(),F.setRotation(J),H=K.tx,K=-K.ty,0>H||512<=H||0>K||512<=K||(this._writeGlyphs(A,C,{x:H,y:K},F),F.setRotation(-J)),K=G.next()};v._writeGlyphs=function(A,C,F,G){const H=b.MaterialKeyBase.load(this._materialKey),
K=d.i1616to32(Math.round(8*F.x),Math.round(8*F.y)),J=this._vertexBoundsScale,{bounds:N,background:P,glyphs:W}=G;0<W.length&&(this._borderLineColor||this._backgroundColor)&&(H.textureBinding=W[0].textureBinding,A.recordStart(C,H.data,this.geometryType,!0),this._writeBackgroundGeometry(A,C,F,N,P),A.recordEnd());const X=2*Math.max(N.width,N.height);for(const aa of G.glyphs)H.textureBinding=aa.textureBinding,A.recordStart(C,H.data,this.geometryType,!0),A.vertexBounds(F.x+N.x+this._xOffset,F.y+N.y-this._yOffset,
X*J,X*J),this._writeVertices(A,C,K,aa),A.recordEnd()};v._writeGlyph=function(A,C,F,G,H){var K=b.MaterialKeyBase.load(this._materialKey);const J=d.i1616to32(Math.round(8*F),Math.round(8*G));K.textureBinding=H.textureBinding;A.recordStart(C,K.data,this.geometryType,!0);K=H.bounds;const N=this._vertexBoundsScale;A.vertexBounds(F+K.x*N,G+K.y*N,K.width*N,K.height*N);this._writeVertices(A,C,J,H);A.recordEnd()};v._writeVertices=function(A,C,F,G){const H=A.vertexCount();this._writeVertexCommon(A,C,F,G);A.vertexWrite(G.offsets.upperLeft);
A.vertexWrite(G.texcoords.upperLeft);A.vertexEnd();this._writeVertexCommon(A,C,F,G);A.vertexWrite(G.offsets.upperRight);A.vertexWrite(G.texcoords.upperRight);A.vertexEnd();this._writeVertexCommon(A,C,F,G);A.vertexWrite(G.offsets.lowerLeft);A.vertexWrite(G.texcoords.lowerLeft);A.vertexEnd();this._writeVertexCommon(A,C,F,G);A.vertexWrite(G.offsets.lowerRight);A.vertexWrite(G.texcoords.lowerRight);A.vertexEnd();A.indexWrite(H+0);A.indexWrite(H+1);A.indexWrite(H+2);A.indexWrite(H+1);A.indexWrite(H+3);
A.indexWrite(H+2)};v._writeVertexCommon=function(A,C,F,G){G=this._color;const H=this._haloColor,K=d.i8888to32(0,0,this._referenceSize,this._bitset),J=d.i8888to32(0,0,this._size,this._haloSize);A.vertexWrite(F);A.vertexWrite(C);A.vertexWrite(G);A.vertexWrite(H);A.vertexWrite(J);A.vertexWrite(K);A.vertexWrite(this._minMaxZoom)};v._writeBackgroundVertex=function(A,C,F,G,H,K){const J=d.i8888to32(0,1,this._referenceSize,this._bitset),N=d.i8888to32(0,0,this._size,this._haloSize),P=d.i8888to32(0,0,0,0);
A.vertexWrite(F);A.vertexWrite(C);A.vertexWrite(G);A.vertexWrite(P);A.vertexWrite(N);A.vertexWrite(J);A.vertexWrite(this._minMaxZoom);A.vertexWrite(H);A.vertexWrite(K);A.vertexEnd()};v._writeBackgroundQuad=function(A,C,F,G,H,K){const J=A.vertexCount();this._writeBackgroundVertex(A,C,F,G,H.upperLeft,K[0]);this._writeBackgroundVertex(A,C,F,G,H.upperRight,K[1]);this._writeBackgroundVertex(A,C,F,G,H.lowerLeft,K[2]);this._writeBackgroundVertex(A,C,F,G,H.lowerRight,K[3]);A.indexWrite(J+0);A.indexWrite(J+
1);A.indexWrite(J+2);A.indexWrite(J+1);A.indexWrite(J+3);A.indexWrite(J+2)};v._writeBackgroundGeometry=function(A,C,F,G,H){const K=d.i1616to32(Math.round(8*F.x),Math.round(8*F.y)),{x:J,y:N,width:P,height:W}=G;G=2*Math.max(P,W);A.vertexBounds(F.x+J+this._xOffset,F.y+N-this._yOffset,G*this._vertexBoundsScale,G*this._vertexBoundsScale);this._backgroundColor&&this._writeBackgroundQuad(A,C,K,this._backgroundColor,H.main,[e,e,e,e]);if(this._borderLineColor||this._backgroundColor){const [X,aa,Z,ea,T]=this._borderLineColor&&
this._borderLineSize&&0<this._borderLineSize?[k,k,n,n,this._borderLineColor]:[x,q,B,y,this._backgroundColor];this._writeBackgroundQuad(A,C,K,T,H.top,X);this._writeBackgroundQuad(A,C,K,T,H.bot,aa);this._writeBackgroundQuad(A,C,K,T,H.left,Z);this._writeBackgroundQuad(A,C,K,T,H.right,ea)}};return l._createClass(r)}(u)})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMOperators"],function(l,h,D){let E=function(){function w(){}
w.getPlacement=function(t,p,g,f,d){const b=D.getPlacementOperator(p);return b?b.execute(t,p,g,f,d):null};return h._createClass(w)}();l.CIMMarkerPlacementHelper=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(l,h,D){return function(){function E(){this._materialKey=
null}var w=E.prototype;w.bindFeature=function(t,p,g){};w.write=function(t,p,g,f){if(h.isNone(this._effects)||0===this._effects?.length)return this._write(t,p,f);g=D.CIMEffectHelper.executeEffects(this._effects,p.readLegacyGeometryForDisplay(),t.tileKey,f.geometryEngine);let d=D.CIMEffectHelper.next(g);for(;d;)this._write(t,p,f,d),d=D.CIMEffectHelper.next(g)};w._write=function(t,p,g,f){};return l._createClass(E)}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/jsonUtils ../CIMCursor ../CIMEffects ../CIMOperators".split(" "),
function(l,h,D,E,w,t){const p=96/72;let g=function(){function f(){}f.executeEffects=function(d,b,a,e){b=E.cloneAndDecodeGeometry(b);b=new w.SimpleGeometryCursor(b);for(const c of d)(d=t.getEffectOperator(c))&&(b=d.execute(b,c,p,a,e));return b};f.next=function(d){d=d.next();E.deltaEncodeGeometry(d);return d};f.applyEffects=function(d,b,a){if(!d)return b;b=new w.SimpleGeometryCursor(b);for(var e of d)(d=t.getEffectOperator(e))&&(b=d.execute(b,e,1,null,a));for(a=null;e=b.next();)a?D.isPolyline(a)?D.isPolyline(e)&&
a.paths.push(...e.paths):D.isPolygon(a)&&D.isPolygon(e)&&a.rings.push(...e.rings):a=e;return a};return h._createClass(f)}();l.CIMEffectHelper=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../enums ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c){return function(m){function k(x,q,B,y,u,v,r,z,A,C,F,G,H,K,J,N,P,W,X,aa,Z,ea,T,I){var M=n.call(this);M.angle=y;M.height=r;M.width=v;M.xOffset=q*X;M.yOffset=B*X;M._markerPlacement=aa;M._effects=Z;M._anchorX=N;M._anchorY=P;M._minMaxZoom=d.i1616to32(Math.round(ea*g.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(T*g.MIN_MAX_ZOOM_PRECISION_FACTOR));q=(K===t.Alignment.MAP?g.BITSET_MARKER_ALIGNMENT_MAP:g.BITSET_MARKER_ALIGNMENT_SCREEN)|(F?g.BITSET_GENERIC_LOCK_COLOR:0)|(H?
g.BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE:0)|(G?g.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);B=J&&J.sdf;x=b.MarkerMaterialKey.load(x);x.sdf=B;x.pattern=!0;x.textureBinding=J.textureBinding;M._materialKey=x.data;M._fillColor=u;M._outlineColor=A;M._sizeOutlineWidth=d.i8888to32(Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*r),255)),Math.round(Math.min(Math.sqrt(128*C),255)),Math.round(Math.min(Math.sqrt(128*z),255)));x.symbologyType===f.WGLSymbologyType.PIE_CHART?
(M._computedWidth=v*W*X,M._computedHeight=r*W*X,M._texUpperLeft=d.i1616to32(0,1),M._texUpperRight=d.i1616to32(1,1),M._texBottomLeft=d.i1616to32(0,0),M._texBottomRight=d.i1616to32(1,0)):M._computeSize(v,r,W,C,X,J,x.hasSizeVV(),I);M._bitestAndDistRatio=d.i1616to32(q,Math.round(64*W));u=w.create();v=E.create();M._applyTransformation(v,u);return M}l._inherits(k,m);var n=l._createSuper(k);k.fromCIMMarker=function(x,q,B){const y=x.size,u=(q&&q.width||1)/(q&&q.height||1)*x.scaleX;var v=x.scaleSymbolsProportionally&&
x.frameHeight?y/x.frameHeight:1;const r=p.premultiplyAlphaRGBA(x.color),z=p.premultiplyAlphaRGBA(x.outlineColor),A=D.pt2px(y),C=A*u,F=D.pt2px(x.offsetX||0),G=D.pt2px(x.offsetY||0);v*=D.pt2px(x.outlineWidth||0);const H=x.alignment||t.Alignment.SCREEN,K=D.pt2px(x.referenceSize),[J,N]=a.getMinMaxZoom(x.scaleInfo,B);B=x.rotation||0;x.rotateClockwise||(B=-B);let P=0,W=0;const X=x.anchorPoint;X&&(x.isAbsoluteAnchorPoint?y&&(P=X.x/(y*u),W=X.y/y):(P=X.x,W=X.y));q=new k(x.materialKey,F,G,B,r,C,A,K,z,v,x.colorLocked,
x.scaleSymbolsProportionally,!1,H,q,P,W,x.sizeRatio,h.unwrapOr(x.scaleFactor,1),x.markerPlacement,x.effects,J,N,!0);q._vertexBoundsScaleX=x.maxVVSize?x.maxVVSize/C:1;q._vertexBoundsScaleY=x.maxVVSize?x.maxVVSize/A:1;return q};k.fromPictureMarker=function(x,q){const B=Math.round(D.pt2px(x.width)),y=Math.round(D.pt2px(x.height)),u=g.PICTURE_FILL_COLOR,v=Math.round(D.pt2px(x.xoffset||0)),r=Math.round(D.pt2px(x.yoffset||0));q=new k(x.materialKey,v,r,x.angle,u,B,y,y,0,0,!1,!1,!1,t.Alignment.SCREEN,q,0,
0,1,1,null,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM,!1);q._vertexBoundsScaleX=x.maxVVSize?x.maxVVSize/x.width:1;q._vertexBoundsScaleY=x.maxVVSize?x.maxVVSize/x.height:1;return q};k.fromSimpleMarker=function(x,q){const B=x.style,y=p.premultiplyAlphaRGBAArray(x.color),u=Math.round(D.pt2px(x.size));let v=u;"esriSMSTriangle"===B&&(v*=q.height/q.width);const r=Math.round(D.pt2px(x.xoffset||0)),z=Math.round(D.pt2px(x.yoffset||0));var A=x.outline;const C=(A?.color&&p.premultiplyAlphaRGBAArray(A.color))|
0;A=(A?.width&&Math.round(D.pt2px(A.width)))|0;q=new k(x.materialKey,r,z,x.angle??0,y,u,v,v,C,A,!1,!1,"esriSMSCross"===B||"esriSMSX"===B,t.Alignment.SCREEN,q,0,0,2,1,null,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM,!1);q.boundsType="esriSMSCircle"===B?"circle":"square";q._vertexBoundsScaleX=x.maxVVSize?x.maxVVSize/x.size:1;q._vertexBoundsScaleY=x.maxVVSize?x.maxVVSize/x.size:1;return q};k.fromLineSymbolMarker=function(x,q){const B=p.premultiplyAlphaRGBAArray(x.color),y=Math.round(D.pt2px(6*x.lineWidth)),
u="cross"===x.style||"x"===x.style;switch(x.placement){case "begin-end":var v=t.ExtremityPlacement.Both;break;case "begin":v=t.ExtremityPlacement.JustBegin;break;case "end":v=t.ExtremityPlacement.JustEnd;break;default:v=t.ExtremityPlacement.None}v={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:v,offsetAlongLine:0};q=new k(x.materialKey,0,0,0,B,y,y,y/6,B,u?Math.round(D.pt2px(x.lineWidth)):0,!1,!1,u,t.Alignment.MAP,q,0,0,2,1,v,null,a.DEFAULT_MIN_ZOOM,a.DEFAULT_MAX_ZOOM,
!1);q.boundsType="circle"===x.style?"circle":"square";return q};return l._createClass(k)}(e(c))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2 ../../../../../../chunks/vec2f32 ../../../../../../geometry/GeometryCursor ../../../../../../layers/graphics/featureConversionUtils ../../../../../../symbols/cim/CIMCursor ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper ../../definitions ../../enums ../../number ../../materialKey/MaterialKey".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m){const k=3.14159265359/180;return n=>function(x){function q(...y){y=B.call(this,...y);y.angle=0;y.xOffset=0;y.yOffset=0;y.width=0;y.height=0;y.boundsType="square";y._anchorX=0;y._anchorY=0;y._computedWidth=0;y._computedHeight=0;y._allowBorrowing=!0;y._vertexBoundsScaleX=1;y._vertexBoundsScaleY=1;y.geometryType=e.WGLGeometryType.MARKER;return y}l._inherits(q,x);var B=l._createSuper(q);x=q.prototype;x._write=function(y,u,v,r){const z=u.getDisplayId();y.recordStart(z,
this._materialKey,this.geometryType,!0);this._writeGeometry(y,u,z,v,r);y.recordEnd()};x._writeGeometry=function(y,u,v,r,z){if(h.isSome(this._markerPlacement))return this._writePlacedMarkers(y,u,r,z);this._allowBorrowing=!0;if(!z&&"esriGeometryPoint"===u.geometryType)return r=u.getX(),u=u.getY(),!y.hasAggregates&&y.hasPixelBufferEnabled&&(0>r||513<=r||0>u||513<=u)?void 0:this._writeVertices(y,v,this._getPos(r,u),r,u);u=z?f.deltaDecodeGeometry(f.convertFromGeometry(z),2):"esriGeometryPolygon"===u.geometryType?
u.readCentroid():u.readGeometryForDisplay();if(!h.isNone(u)){if(u.isPoint){const [A,C]=u.coords;return!y.hasAggregates&&y.hasPixelBufferEnabled&&(0>A||512<=A||0>C||512<=C)?void 0:this._writeVertices(y,v,this._getPos(A,C),A,C)}u.forEachVertex((A,C)=>{const F=2*a.TILE_SIZE;A<-F||A>=F||C<-F||C>=F||this._writeVertices(y,v,this._getPos(A,C),A,C)})}};x._writePlacedMarkers=function(y,u,v,r){r&&d.deltaDecodeGeometry(r);r=r?g.getJSONCursor(r):g.getOptimizedCursor(u.readGeometryForDisplay(),u.geometryType??
null,!0);if(v=b.CIMMarkerPlacementHelper.getPlacement(r,h.unwrap(this._markerPlacement),D.pt2px(1),y.tileKey,v.geometryEngine)){this._allowBorrowing="esriGeometryPolygon"!==u.geometryType;u=u.getDisplayId();r=p.create();for(var z=w.create(),A=v.next();null!=A;){const C=A.tx,F=-A.ty;-128<=C&&640>=C&&-128<=F&&640>=F&&(this._applyTransformation(z,r,-A.getAngle()/k),this._writeVertices(y,u,this._getPos(C,F),C,F));A=v.next()}}};x._writeVertices=function(y,u,v,r,z){const A=m.MarkerMaterialKey.load(this._materialKey);
switch(A.symbologyType){case e.WGLSymbologyType.HEATMAP:return this._writeHeatmapVertices(y,u,v);default:return this._writeMarkerVertices(y,u,A,v,r,z)}};x._writeMarkerVertices=function(y,u,v,r,z,A){var C=v.vvRotation;v=y.vertexCount();let F=this._computedWidth*this._vertexBoundsScaleX;var G=this._computedHeight*this._vertexBoundsScaleY;this.angle&&(F=G=Math.max(F,G));C&&(C=Math.max(this.xOffset,this.yOffset),F+=C,G+=C);this._allowBorrowing&&y.vertexBounds(z+this.xOffset,A-this.yOffset,F,G);y.vertexWrite(r);
y.vertexWrite(this._offsetUpperLeft);y.vertexWrite(this._texUpperLeft);y.vertexWrite(this._bitestAndDistRatio);y.vertexWrite(u);y.vertexWrite(this._fillColor);y.vertexWrite(this._outlineColor);y.vertexWrite(this._sizeOutlineWidth);y.vertexWrite(this._minMaxZoom);y.vertexEnd();y.vertexWrite(r);y.vertexWrite(this._offsetUpperRight);y.vertexWrite(this._texUpperRight);y.vertexWrite(this._bitestAndDistRatio);y.vertexWrite(u);y.vertexWrite(this._fillColor);y.vertexWrite(this._outlineColor);y.vertexWrite(this._sizeOutlineWidth);
y.vertexWrite(this._minMaxZoom);y.vertexEnd();y.vertexWrite(r);y.vertexWrite(this._offsetBottomLeft);y.vertexWrite(this._texBottomLeft);y.vertexWrite(this._bitestAndDistRatio);y.vertexWrite(u);y.vertexWrite(this._fillColor);y.vertexWrite(this._outlineColor);y.vertexWrite(this._sizeOutlineWidth);y.vertexWrite(this._minMaxZoom);y.vertexEnd();y.vertexWrite(r);y.vertexWrite(this._offsetBottomRight);y.vertexWrite(this._texBottomRight);y.vertexWrite(this._bitestAndDistRatio);y.vertexWrite(u);y.vertexWrite(this._fillColor);
y.vertexWrite(this._outlineColor);y.vertexWrite(this._sizeOutlineWidth);y.vertexWrite(this._minMaxZoom);y.vertexEnd();this._writeIndices(y,v)};x._writeHeatmapVertices=function(y,u,v){const r=y.vertexCount();y.vertexWrite(v);y.vertexWrite(this._offsetUpperLeft);y.vertexWrite(u);y.vertexEnd();y.vertexWrite(v);y.vertexWrite(this._offsetUpperRight);y.vertexWrite(u);y.vertexEnd();y.vertexWrite(v);y.vertexWrite(this._offsetBottomLeft);y.vertexWrite(u);y.vertexEnd();y.vertexWrite(v);y.vertexWrite(this._offsetBottomRight);
y.vertexWrite(u);y.vertexEnd();this._writeIndices(y,r)};x._writeIndices=function(y,u){y.indexWrite(u+0);y.indexWrite(u+1);y.indexWrite(u+2);y.indexWrite(u+1);y.indexWrite(u+3);y.indexWrite(u+2)};x._applyTransformation=function(y,u,v=0){E.fromTranslation(y,p.fromValues(this.xOffset,-this.yOffset));null!=this.angle&&0!==this.angle+v&&E.rotate(y,y,k*(this.angle+v));v=this._computedWidth;const r=this._computedHeight,z=-(.5+this._anchorX)*v,A=-(.5-this._anchorY)*r;t.set(u,z,A);t.transformMat2d(u,u,y);
this._offsetUpperLeft=c.i1616to32(16*u[0],16*u[1]);t.set(u,z+v,A);t.transformMat2d(u,u,y);this._offsetUpperRight=c.i1616to32(16*u[0],16*u[1]);t.set(u,z,A+r);t.transformMat2d(u,u,y);this._offsetBottomLeft=c.i1616to32(16*u[0],16*u[1]);t.set(u,z+v,A+r);t.transformMat2d(u,u,y);this._offsetBottomRight=c.i1616to32(16*u[0],16*u[1])};x._computeSize=function(y,u,v,r,z,A,C,F){const G=y*v;v*=u;A.sdf&&!C?(r+=2,y=Math.min((F&&y>u?G:y)+r,G),u=Math.min(u+r,v)):(y=G,u=v);F=a.SDF_TEXTURE_SIZE/Math.max(G,v);C=.5*(G-
y)*F;var H=.5*(v-u)*F;F=A.rect.x+a.SPRITE_PADDING+C;r=A.rect.y+a.SPRITE_PADDING+H;C=F+A.width-2*C;A=r+A.height-2*H;H=Math.floor(F);const K=Math.floor(r),J=Math.ceil(C),N=Math.ceil(A);y*=(J-H)/(C-F);u*=(N-K)/(A-r);this._texUpperLeft=c.i1616to32(H,K);this._texUpperRight=c.i1616to32(J,K);this._texBottomLeft=c.i1616to32(H,N);this._texBottomRight=c.i1616to32(J,N);this._anchorX*=G/y;this._anchorY*=v/u;this._computedWidth=y*z;this._computedHeight=u*z};x._getPos=function(y,u){return c.i1616to32(Math.round(8*
y),Math.round(8*u))};return l._createClass(q)}(n)})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaultsJSON ../../enums ../../materialKey/MaterialKey ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/Lock ../../util/Result ../../../../layers/features/textUtils ../../../../layers/support/cimSymbolUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x,q,B){function y(F,G){const H=F.length;F.push(null);G.then(K=>F[H]=K);return F}function u(F){return null!=F&&!!(F&1)}const v=E.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),r={sortKey:null,templates:[]};E={isOutline:!1,placement:null,symbologyType:p.WGLSymbologyType.DEFAULT,vvFlags:0};const z={...t.errorPointSymbolJSON,hash:JSON.stringify(t.errorPointSymbolJSON),materialKey:g.createMaterialKey(p.WGLGeometryType.MARKER,E)},A={...t.errorPolylineSymbolJSON,
hash:JSON.stringify(t.errorPolylineSymbolJSON),materialKey:g.createMaterialKey(p.WGLGeometryType.LINE,E)},C={...t.errorPolygonSymbolJSON,hash:JSON.stringify(t.errorPolygonSymbolJSON),materialKey:g.createMaterialKey(p.WGLGeometryType.FILL,E)};t=function(){function F(H,K){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new n.Lock;this._fetchResource=
H;this._tileInfo=K}var G=F.prototype;G.createTemplateGroup=function(H,K,J=null){this._initErrorTemplates();const N=H.hash;var P=this._symbolToTemplate.get(N);if(null!=P)return P;P=[];J={sortKey:J,templates:P};K&&this._createMeshTemplates(P,K,!0);this._createMeshTemplates(P,H,!1);K=this._createGroupId;if(P="expanded-cim"===H.type)a:{if(H.layers)for(const W of H.layers)if("function"===typeof W.materialHash){P=!0;break a}P=!1}H=K.call(this,P);this._idToTemplateGroup.set(H,J);this._symbolToTemplate.set(N,
H);return H};G.getTemplateGroup=function(H){return this._idToTemplateGroup.get(H)??r};G.getDynamicTemplateGroup=function(H){if(!this._idToTemplateGroup.has(H))return r;u(H)||v.error("mapview-template-store",`Id ${H} does not refer to a dynamic template`);return this._idToTemplateGroup.get(H)};G.getMosaicItem=function(H,K){const J=this._createTemplateId(),N=new Promise(P=>this._idToResolver.set(J,P));this._fetchQueue.push({symbol:H,id:J,glyphIds:K});return N};G.finalize=function(H){return this._fetchQueue.length||
this._lock.isHeld()?n.withLock(this._lock,this._fetchAllQueuedResources.bind(this),H):Promise.resolve()};G._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],C,!1),marker:this._createMeshTemplates([],z,!1),line:this._createMeshTemplates([],A,!1)})};G._fetchAllQueuedResources=function(H){if(!this._fetchQueue.length)return Promise.resolve();const K=this._fetchQueue,J=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return Promise.all(J).then(()=>
this._fetchResource(K,H).then(N=>{for(const {id:P,mosaicItem:W}of N)this._idToResolver.get(P)(W),this._idToResolver.delete(P)})).catch(N=>{w.isAbortError(N)?this._fetchQueue=this._fetchQueue.concat(K):"worker:port-closed"!==N.name&&v.error(new D("mapview-template-store","Unable to fetch requested texture resources",N))})};G._createGroupId=function(H){return this._idCounter++<<1|(H?1:0)};G._createTemplateId=function(){return this._templateIdCounter++};G._createSMS=async function(H){const {spriteMosaicItem:K}=
await this.getMosaicItem(H);return x.ok(K,v)?m.fromSimpleMarker(H,K):this._markerError};G._createPMS=async function(H){const {spriteMosaicItem:K}=await this.getMosaicItem(H);return x.ok(K,v)?m.fromPictureMarker(H,K):this._markerError};G._createSFS=async function(H,K){const {spriteMosaicItem:J}=await this.getMosaicItem(H);return x.ok(J,v)?e.fromSimpleFill(H,J,K):this._fillError};G._createPFS=async function(H,K){const {spriteMosaicItem:J}=await this.getMosaicItem(H);return x.ok(J,v)?e.fromPictureFill(H,
J,K):this._fillError};G._createSLS=async function(H,K){({spriteMosaicItem:K}=await this.getMosaicItem(H));return x.ok(K,v)?c.fromSimpleLine(H,K):this._lineError};G._createLMS=async function(H){const {spriteMosaicItem:K}=await this.getMosaicItem(H);return x.ok(K,v)?m.fromLineSymbolMarker(H,K):this._markerError};G._createTS=async function(H){const {glyphMosaicItems:K}=await this.getMosaicItem(H);return k.fromText(H,K??[])};G._createCIMText=async function(H){const {glyphMosaicItems:K}=await this.getMosaicItem(B.cimLayerToRasterizationInfo(H),
q.codepoints(H.text));return x.ok(K,v)?k.fromCIMText(H,K,this._tileInfo):this._textError};G._createCIMFill=async function(H){const {spriteMosaicItem:K}=await this.getMosaicItem(B.cimLayerToRasterizationInfo(H));return x.ok(K,v)?e.fromCIMFill(H,K,this._tileInfo):this._fillError};G._createCIMLine=async function(H){const {spriteMosaicItem:K}=await this.getMosaicItem(B.cimLayerToRasterizationInfo(H));return x.ok(K,v)?c.fromCIMLine(H,K,this._tileInfo):this._lineError};G._createCIMMarker=async function(H){const {spriteMosaicItem:K}=
await this.getMosaicItem(B.cimLayerToRasterizationInfo(H));return x.ok(K,v)?m.fromCIMMarker(H,K,this._tileInfo):this._markerError};G._createCIM=async function(H){const K=H.templateHash;let J=this._cimTemplateCache.get(K);if(null!=J)return J;switch(H.type){case "marker":J=await this._createCIMMarker(H);break;case "line":J=await this._createCIMLine(H);break;case "fill":J=await this._createCIMFill(H);break;case "text":J=await this._createCIMText(H)}this._cimTemplateCache.set(K,J);return J};G._createDynamicCIM=
async function(H){const K=H.templateHash;let J=this._cimTemplateCache.get(K);if(null!=J)return J;switch(H.type){case "marker":J=b.fromCIMMarker(H,this._tileInfo);break;case "line":J=d.fromCIMLine(H,this._tileInfo);break;case "fill":J=f.fromCIMFill(H,this._tileInfo);break;case "text":J=a.fromCIMText(H,this._tileInfo)}this._cimTemplateCache.set(K,J);return J};G._createPrimitiveMeshTemplates=function(H,K,J){switch(K.type){case "esriSMS":return y(H,this._createSMS(K));case "esriPMS":return y(H,this._createPMS(K));
case "esriSFS":return y(H,this._createSFS(K,J));case "line-marker":return y(H,this._createLMS(K));case "esriPFS":return y(H,this._createPFS(K,J));case "esriSLS":return y(H,this._createSLS(K,!1));case "esriTS":return y(H,this._createTS(K));default:return v.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),H}};G._createMeshTemplates=function(H,K,J){if(K.type.includes("3d"))return v.error("3D symbols are not supported with MapView"),H;if("expanded-cim"===K.type){for(const N of K.layers)"function"===
typeof N.materialHash?y(H,this._createDynamicCIM(N)):y(H,this._createCIM(N));return H}if("composite-symbol"===K.type){for(const N of K.layers)this._createPrimitiveMeshTemplates(H,N,J);return H}return"cim"===K.type||"label"===K.type||"web-style"===K.type?H:this._createPrimitiveMeshTemplates(H,K,J)};h._createClass(F,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},
{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return F}();l.WGLTemplateStore=t;l.errorPointSchema2D=z;l.errorPolygonSchema2D=C;l.errorPolylineSchema2D=A;l.isDynamicId=u;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a){return function(e){function c(k,n,x){var q=m.call(this,k);q._minMaxZoom=p.i1616to32(Math.round(n*w.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(x*w.MIN_MAX_ZOOM_PRECISION_FACTOR));f.isFunction(k.color)?q._dynamicPropertyMap.set("fillColor",(z,A,C)=>(z=k.color(z,A,C))&&E.premultiplyAlphaRGBA(z)||0):(n=k.color,q.fillColor=n&&E.premultiplyAlphaRGBA(n)||0);const B="CIMMarkerPlacementInsidePolygon"===k.cim.placement?.type&&k.cim.placement.shiftOddRows?2:1,y=k.height;f.isFunction(y)?
q._dynamicPropertyMap.set("_height",(z,A,C)=>y(z,A,C)*B):q._height=(y||0)*B;const u=k.offsetX;f.isFunction(u)?q._dynamicPropertyMap.set("_offsetX",(z,A,C)=>D.pt2px(u(z,A,C))):q._offsetX=D.pt2px(u||0);const v=k.offsetY;f.isFunction(v)?q._dynamicPropertyMap.set("_offsetY",(z,A,C)=>D.pt2px(-v(z,A,C))):q._offsetY=D.pt2px(-v||0);n=k.scaleX;f.isFunction(n)?q._dynamicPropertyMap.set("_scaleX",n):q._scaleX=n||1;const r=k.angle;f.isFunction(r)?q._dynamicPropertyMap.set("_angle",(z,A,C)=>t.degToByte(r(z,A,
C))):q._angle=t.degToByte(r)||0;h.isSome(k.effects)&&(n=k.effects,f.isFunction(n)?q._dynamicPropertyMap.set("_effects",n):q._effects=n);q._cimFillLayer=k;q._bitset=(k.colorLocked?w.BITSET_GENERIC_LOCK_COLOR:0)|(k.applyRandomOffset?w.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(k.sampleAlphaOnly?w.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0)|(k.hasUnresolvedReplacementColor?w.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR:0);q._fillMaterialKey=k.materialKey;return q}l._inherits(c,e);var m=l._createSuper(c);c.fromCIMFill=
function(k,n){const [x,q]=f.getMinMaxZoom(k.scaleInfo,n);return new c(k,x,q)};c.prototype.bindFeature=function(k,n,x){const q=k.readLegacyFeature();this._dynamicPropertyMap.forEach((u,v)=>{this[v]=u(q,n,x)});k=g.FillMaterialKey.load(this._fillMaterialKey);var B=this._materialCache,y=this._cimFillLayer.materialHash;y=y(q,n,x);y=B.get(y);B=null;y&&a.ok(y.spriteMosaicItem)&&(B=y.spriteMosaicItem);if(B){const {rect:u,width:v,height:r}=B;y=u.x+w.SPRITE_PADDING;const z=u.y+w.SPRITE_PADDING,A=y+v,C=z+r;
let F=Math.round(D.pt2px(this._height));0>=F&&(F=C-z);let G=Math.round(D.pt2px(this._height/r*v||0));0>=G&&(G=A-y);const H=this._scaleX;this.tl=p.i1616to32(y,z);this.br=p.i1616to32(A,C);this.aux21=p.i1616to32(G,F);this.aux22=p.i1616to32(this._offsetX,this._offsetY);this.aux3=p.i8888to32(128*H,128,this._angle,0);k.sdf=B.sdf;k.pattern=!0;k.textureBinding=B.textureBinding}else this.aux3=this.aux22=this.aux21=this.br=this.tl=0,k.sdf=!1,k.pattern=!1,k.textureBinding=0;this._materialKey=k.data};return l._createClass(c)}(d(b))})},
"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../layers/graphics/featureConversionUtils ../../enums ../../number ../../Utils ../../materialKey/MaterialKey ./templateUtils ./WGLLineTemplate".split(" "),function(l,h,D,E,w,t,p,g,f){return d=>function(b){function a(...c){c=e.call(this,...c);c.forceLibtess=!1;c._bitset=0;c._lineTemplate=null;c.geometryType=E.WGLGeometryType.FILL;
return c}l._inherits(a,b);var e=l._createSuper(a);b=a.prototype;b._maybeAddLineTemplate=function(c){this._lineTemplate=f.fromFillOutline(c)};b._write=function(c,m,k,n){k="esriGeometryPoint"===m.geometryType;const x=p.FillMaterialKey.load(this._materialKey);c.recordStart(m.getDisplayId(),this._materialKey,this.geometryType,k);this._writeGeometry(c,m,x,n,k);p.hasOutlineFillSymbology(x)&&h.isSome(this._lineTemplate)&&this._lineTemplate.writeGeometry(c,m,n,k);c.recordEnd()};b._writeGeometry=function(c,
m,k,n,x){n=this._getGeometry(m,n,x);h.isNone(n)||(x=[],100<n.maxLength||this.forceLibtess||!g.triangulate(x,n)?(n=g.triangulateLibtess(n),this._writeVertices(c,m,n,[n.length/2],k)):x.length&&this._writeVertices(c,m,n.coords,n.lengths,k,x))};b._writeVertex=function(c,m,k,n,x,q){const B=w.i1616to32(1*n,1*x);c.vertexBounds(n,x,0,0);c.vertexWrite(B);c.vertexWrite(m);k.symbologyType===E.WGLSymbologyType.DOT_DENSITY?c.vertexWriteF32(1/Math.abs(q.readGeometryArea())):(c.vertexWrite(this.fillColor),m=p.hasSimpleSymbology(k),
m||(c.vertexWrite(this.tl),c.vertexWrite(this.br)),c.vertexWrite(this.aux21),c.vertexWrite(this.aux22),c.vertexWrite(this.aux3),m||c.vertexWrite(this._minMaxZoom))};b._writeVertices=function(c,m,k,n,x,q){var B=m.getDisplayId();B|=this._bitset<<24;var y=n.reduce((v,r)=>v+r);const u=t.getStrides(x.geometryType,x.symbologyType).geometry/4;n=c.vertexCount();c.vertexEnsureSize(u*y);y=0;if(q)for(const v of q)this._writeVertex(c,B,x,k[2*v],k[2*v+1],m),y++;else for(q=0;q<k.length;q+=2)this._writeVertex(c,
B,x,Math.round(k[q]),Math.round(k[q+1]),m),y++;c.indexEnsureSize(y);for(m=0;m<y;m++)c.indexWrite(m+n)};b._getGeometry=function(c,m,k){return(c=m?D.deltaDecodeGeometry(D.convertFromGeometry(m),2):c.readGeometryForDisplay())?g.clipMarshall(c,k?256:8):null};return l._createClass(a)}(d)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../chunks/earcut ../../../../../../geometry/libtess ../../../../../../geometry/support/TileClipper ../../../../../../layers/graphics/OptimizedGeometry ../../definitions ../bufcut".split(" "),
function(l,h,D,E,w,t,p,g){function f(e,c,m){let k=0;for(let n=1;n<m;n++)k+=(e[2*(c+n)]-e[2*(c+n-1)])*(e[2*(c+n)+1]+e[2*(c+n-1)+1]);return k}function d(e,c,m,k,n){let x=0;for(;m<k;m+=3){const q=2*(e[m]-n),B=2*(e[m+1]-n),y=2*(e[m+2]-n);x+=Math.abs((c[q]-c[y])*(c[B+1]-c[q+1])-(c[q]-c[B])*(c[y+1]-c[q+1]))}return x}const b=new w.TileClipper(0,0,0,1,0),a=new w.TileClipper(0,0,0,1,0);b.setExtent(p.TILE_SIZE);a.setExtent(p.TILE_SIZE);l.area=f;l.clipLinesMarshall=function(e,c){a.setPixelMargin(c);const m=
-c;c=p.TILE_SIZE+c;let k=[];var n=!1;let x=0;for(;x<e.length;){const q=[],B=e[x];if(!B)return null;a.reset(w.GeometryType.LineString);let [y,u]=B[0];if(n)a.moveTo(y,u);else{if(y<m||y>c||u<m||u>c){n=!0;continue}q.push({x:y,y:u})}let v=!1;const r=B.length;for(let z=1;z<r;++z)if(y+=B[z][0],u+=B[z][1],n)a.lineTo(y,u);else{if(y<m||y>c||u<m||u>c){v=!0;break}q.push({x:y,y:u})}if(v)n=!0;else{if(n){if(n=a.resultWithStarts())for(const z of n)k.push(z)}else k.push({line:q,start:0});x++;n=!1}}k=k.filter(q=>1<
q.line.length);return 0===k.length?null:k};l.clipMarshall=function(e,c){if(h.isNone(e))return null;a:{var m=p.TILE_SIZE+128;var k=0;for(var n=0;n<e.lengths.length;n++){var x=e.lengths[n];for(var q=0;q<x;q++){const B=e.coords[2*(q+k)],y=e.coords[2*(q+k)+1];if(-128>B||B>m||-128>y||y>m){m=!0;break a}}k+=x}m=!1}if(!m)return e;b.setPixelMargin(c);b.reset(w.GeometryType.Polygon);c=0;for(m=0;m<e.lengths.length;m++){k=e.lengths[m];n=e.coords[2*(0+c)];x=e.coords[2*(0+c)+1];b.moveTo(n,x);for(q=1;q<k;q++)n=
e.coords[2*(q+c)],x=e.coords[2*(q+c)+1],b.lineTo(n,x);b.close();c+=k}m=b.result(!1);if(!m)return null;e=[];c=[];for(const B of m){m=0;for(const y of B)c.push(y.x),c.push(y.y),m++;e.push(m)}return new t(e,c)};l.triangleAreaArray=d;l.triangulate=function(e,c){const {coords:m,lengths:k,hasIndeterminateRingOrder:n}=c;if(n)return!1;c=0;for(var x=0;x<k.length;){let y=x,u=k[x];x=f(m,c,u);for(var q=[];++y<k.length;){var B=k[y];const v=f(m,c+u,B);if(!(0<v))break;x+=v;q.push(c+u);u+=B}B=e.length;g.bufcut(e,
m,c,c+u,q,2,0);q=d(e,m,B,e.length,0);x=Math.abs(x);if(1E-5<Math.abs((q-x)/Math.max(1E-7,x)))return e.length=0,!1;x=y;c+=u}return!0};l.triangulateEarcut=function(e,c,m){const {coords:k,lengths:n,hasIndeterminateRingOrder:x}=c;if(x)return!1;let q=0;for(var B=0;B<n.length;){let u=B,v=n[B];for(B=[];++u<n.length;){var y=n[u];if(!(0<f(k,q+v,y)))break;B.push(q+v-q);v+=y}y=c.coords.slice(2*q,2*(q+v));B=D.earcut(y,B,2);for(const r of B)e.push(r+m+q);B=u;q+=v}return!0};l.triangulateLibtess=function(e){const {coords:c,
lengths:m}=e;({buffer:e}=E.triangulate(c,m));return e};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/earcut":function(){define(["exports"],function(l){var h={};(function(D){(function(E){E=E();void 0!==E&&(D.exports=E)})(function(){function E(z,A,C){C=C||2;var F=A&&A.length,G=F?A[0]*C:z.length,H=w(z,0,G,C,!0),K=[];if(!H||H.next===H.prev)return K;var J;if(F){var N=H;var P=C;H=[];var W;F=0;for(W=A.length;F<W;F++){var X=A[F]*P;var aa=F<W-1?A[F+1]*P:z.length;X=w(z,X,aa,P,
!1);X===X.next&&(X.steiner=!0);aa=H;var Z=aa.push,ea=X,T=X;do{if(ea.x<T.x||ea.x===T.x&&ea.y<T.y)T=ea;ea=ea.next}while(ea!==X);Z.call(aa,T)}H.sort(f);for(F=0;F<H.length;F++)P=H[F],A=N,(N=b(P,A))?(W=B(N,P),P=t(N,N.next),W=d(W),t(W,W.next),P=d(P),N=d(A===N?P:A)):N=A,N=t(N,N.next);H=N}if(z.length>80*C){var I=J=z[0];var M=F=z[1];for(P=C;P<G;P+=C)A=z[P],N=z[P+1],A<I&&(I=A),N<M&&(M=N),A>J&&(J=A),N>F&&(F=N);J=Math.max(J-I,F-M);J=0!==J?1/J:0}p(H,K,C,I,M,J);return K}function w(z,A,C,F,G){if(G===0<r(z,A,C,F))for(G=
A;G<C;G+=F)var H=y(G,z[G],z[G+1],H);else for(G=C-F;G>=A;G-=F)H=y(G,z[G],z[G+1],H);H&&m(H,H.next)&&(z=H.next,u(H),H=z);return H}function t(z,A){if(!z)return z;A||(A=z);do{var C=!1;if(z.steiner||!m(z,z.next)&&0!==c(z.prev,z,z.next))z=z.next;else{A=z.prev;u(z);z=A;if(z===z.next)break;C=!0}}while(C||z!==A);return A}function p(z,A,C,F,G,H,K){if(z){if(!K&&H){var J=z,N=J;do null===N.z&&(N.z=a(N.x,N.y,F,G,H)),N.prevZ=N.prev,N=N.nextZ=N.next;while(N!==J);N.prevZ.nextZ=null;N.prevZ=null;J=N;var P,W,X,aa,Z=
1;do{N=J;var ea=J=null;for(W=0;N;){W++;var T=N;for(P=X=0;P<Z&&(X++,T=T.nextZ,T);P++);for(aa=Z;0<X||0<aa&&T;)0!==X&&(0===aa||!T||N.z<=T.z)?(P=N,N=N.nextZ,X--):(P=T,T=T.nextZ,aa--),ea?ea.nextZ=P:J=P,P.prevZ=ea,ea=P;N=T}ea.nextZ=null;Z*=2}while(1<W)}for(J=z;z.prev!==z.next;){N=z.prev;T=z.next;if(H)ea=g(z,F,G,H);else a:if(ea=z,W=ea.prev,X=ea,Z=ea.next,0<=c(W,X,Z))ea=!1;else{for(P=ea.next.next;P!==ea.prev;){if(e(W.x,W.y,X.x,X.y,Z.x,Z.y,P.x,P.y)&&0<=c(P.prev,P,P.next)){ea=!1;break a}P=P.next}ea=!0}if(ea)A.push(N.i/
C),A.push(z.i/C),A.push(T.i/C),u(z),J=z=T.next;else if(z=T,z===J){if(!K)p(t(z),A,C,F,G,H,1);else if(1===K){z=t(z);K=A;J=C;N=z;do T=N.prev,ea=N.next.next,!m(T,ea)&&k(T,N,N.next,ea)&&q(T,ea)&&q(ea,T)&&(K.push(T.i/J),K.push(N.i/J),K.push(ea.i/J),u(N),u(N.next),N=z=ea),N=N.next;while(N!==z);z=t(N);p(z,A,C,F,G,H,2)}else if(2===K)a:{K=z;do{for(J=K.next.next;J!==K.prev;){if(N=K.i!==J.i){ea=ea=ea=ea=void 0;N=K;T=J;if(ea=N.next.i!==T.i&&N.prev.i!==T.i){b:{ea=N;do{if(ea.i!==N.i&&ea.next.i!==N.i&&ea.i!==T.i&&
ea.next.i!==T.i&&k(ea,ea.next,N,T)){ea=!0;break b}ea=ea.next}while(ea!==N);ea=!1}ea=!ea}if(ea){if(ea=q(N,T)&&q(T,N)){ea=N;W=!1;X=(N.x+T.x)/2;Z=(N.y+T.y)/2;do ea.y>Z!==ea.next.y>Z&&ea.next.y!==ea.y&&X<(ea.next.x-ea.x)*(Z-ea.y)/(ea.next.y-ea.y)+ea.x&&(W=!W),ea=ea.next;while(ea!==N);ea=W}ea=ea&&(c(N.prev,N,T.prev)||c(N,T.prev,T))||m(N,T)&&0<c(N.prev,N,N.next)&&0<c(T.prev,T,T.next)}N=ea}if(N){z=B(K,J);K=t(K,K.next);z=t(z,z.next);p(K,A,C,F,G,H);p(z,A,C,F,G,H);break a}J=J.next}K=K.next}while(K!==z)}break}}}}
function g(z,A,C,F){var G=z.prev,H=z.next;if(0<=c(G,z,H))return!1;var K=G.x>z.x?G.x>H.x?G.x:H.x:z.x>H.x?z.x:H.x,J=G.y>z.y?G.y>H.y?G.y:H.y:z.y>H.y?z.y:H.y,N=a(G.x<z.x?G.x<H.x?G.x:H.x:z.x<H.x?z.x:H.x,G.y<z.y?G.y<H.y?G.y:H.y:z.y<H.y?z.y:H.y,A,C,F);A=a(K,J,A,C,F);C=z.prevZ;for(F=z.nextZ;C&&C.z>=N&&F&&F.z<=A;){if(C!==z.prev&&C!==z.next&&e(G.x,G.y,z.x,z.y,H.x,H.y,C.x,C.y)&&0<=c(C.prev,C,C.next))return!1;C=C.prevZ;if(F!==z.prev&&F!==z.next&&e(G.x,G.y,z.x,z.y,H.x,H.y,F.x,F.y)&&0<=c(F.prev,F,F.next))return!1;
F=F.nextZ}for(;C&&C.z>=N;){if(C!==z.prev&&C!==z.next&&e(G.x,G.y,z.x,z.y,H.x,H.y,C.x,C.y)&&0<=c(C.prev,C,C.next))return!1;C=C.prevZ}for(;F&&F.z<=A;){if(F!==z.prev&&F!==z.next&&e(G.x,G.y,z.x,z.y,H.x,H.y,F.x,F.y)&&0<=c(F.prev,F,F.next))return!1;F=F.nextZ}return!0}function f(z,A){return z.x-A.x}function d(z){if(z.next.prev===z)return z;let A=z;do{const C=A.next;if(C.prev===A||C===A||C===z)break;A=C}while(1);return A}function b(z,A){var C=A,F=z.x,G=z.y,H=-Infinity;do{if(G<=C.y&&G>=C.next.y&&C.next.y!==
C.y){var K=C.x+(G-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(K<=F&&K>H){H=K;if(K===F){if(G===C.y)return C;if(G===C.next.y)return C.next}var J=C.x<C.next.x?C:C.next}}C=C.next}while(C!==A);if(!J)return null;if(F===H)return J;A=J;K=J.x;var N=J.y,P=Infinity;C=J;do{if(F>=C.x&&C.x>=K&&F!==C.x&&e(G<N?F:H,G,K,N,G<N?H:F,G,C.x,C.y)){var W=Math.abs(G-C.y)/(F-C.x);var X;if((X=q(C,z))&&!(X=W<P)&&(X=W===P)&&!(X=C.x>J.x)&&(X=C.x===J.x)){X=J;var aa=C;X=0>c(X.prev,X,aa.prev)&&0>c(aa.next,X,X.next)}X&&(J=C,P=W)}C=C.next}while(C!==
A);return J}function a(z,A,C,F,G){z=32767*(z-C)*G;A=32767*(A-F)*G;z=(z|z<<8)&16711935;z=(z|z<<4)&252645135;z=(z|z<<2)&858993459;A=(A|A<<8)&16711935;A=(A|A<<4)&252645135;A=(A|A<<2)&858993459;return(z|z<<1)&1431655765|((A|A<<1)&1431655765)<<1}function e(z,A,C,F,G,H,K,J){return 0<=(G-K)*(A-J)-(z-K)*(H-J)&&0<=(z-K)*(F-J)-(C-K)*(A-J)&&0<=(C-K)*(H-J)-(G-K)*(F-J)}function c(z,A,C){return(A.y-z.y)*(C.x-A.x)-(A.x-z.x)*(C.y-A.y)}function m(z,A){return z.x===A.x&&z.y===A.y}function k(z,A,C,F){var G=x(c(z,A,
C)),H=x(c(z,A,F)),K=x(c(C,F,z)),J=x(c(C,F,A));return G!==H&&K!==J||0===G&&n(z,C,A)||0===H&&n(z,F,A)||0===K&&n(C,z,F)||0===J&&n(C,A,F)?!0:!1}function n(z,A,C){return A.x<=Math.max(z.x,C.x)&&A.x>=Math.min(z.x,C.x)&&A.y<=Math.max(z.y,C.y)&&A.y>=Math.min(z.y,C.y)}function x(z){return 0<z?1:0>z?-1:0}function q(z,A){return 0>c(z.prev,z,z.next)?0<=c(z,A,z.next)&&0<=c(z,z.prev,A):0>c(z,A,z.prev)||0>c(z,z.next,A)}function B(z,A){var C=new v(z.i,z.x,z.y),F=new v(A.i,A.x,A.y),G=z.next,H=A.prev;z.next=A;A.prev=
z;C.next=G;G.prev=C;F.next=C;C.prev=F;H.next=F;F.prev=H;return F}function y(z,A,C,F){z=new v(z,A,C);F?(z.next=F.next,z.prev=F,F.next.prev=z,F.next=z):(z.prev=z,z.next=z);return z}function u(z){z.next.prev=z.prev;z.prev.next=z.next;z.prevZ&&(z.prevZ.nextZ=z.nextZ);z.nextZ&&(z.nextZ.prevZ=z.prevZ)}function v(z,A,C){this.i=z;this.x=A;this.y=C;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function r(z,A,C,F){for(var G=0,H=C-F;A<C;A+=F)G+=(z[H]-z[A])*(z[A+1]+z[H+1]),H=A;return G}
E.deviation=function(z,A,C,F){var G=A&&A.length,H=Math.abs(r(z,0,G?A[0]*C:z.length,C));if(G){G=0;for(var K=A.length;G<K;G++)H-=Math.abs(r(z,A[G]*C,G<K-1?A[G+1]*C:z.length,C))}for(G=A=0;G<F.length;G+=3){K=F[G]*C;var J=F[G+1]*C,N=F[G+2]*C;A+=Math.abs((z[K]-z[N])*(z[J+1]-z[K+1])-(z[K]-z[J])*(z[N+1]-z[K+1]))}return 0===H&&0===A?0:Math.abs((A-H)/H)};E.flatten=function(z){for(var A=z[0][0].length,C={vertices:[],holes:[],dimensions:A},F=0,G=0;G<z.length;G++){for(var H=0;H<z[G].length;H++)for(var K=0;K<A;K++)C.vertices.push(z[G][H][K]);
0<G&&(F+=z[G-1].length,C.holes.push(F))}return C};return E})})({get exports(){return h},set exports(D){h=D}});l.earcut=h})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers"],function(l,h){function D(u,v,r,z,A,C,F){let G;r=0;for(let H=z,K=A-C;H<A;H+=C)r+=(u[K+v*C]-u[H+v*C])*(u[H+1+v*C]+u[K+1+v*C]),K=H;if(F===0<r)for(;z<A;z+=C)G=p(z+v*C,u[z+v*C],u[z+1+v*C],G);else for(A-=C;A>=z;A-=C)G=p(A+v*C,u[A+v*C],u[A+1+v*C],G);G&&k(G,G.next)&&
(g(G),G=G.next);return G}function E(u,v=u){if(!u)return u;let r;do if(r=!1,u.steiner||!k(u,u.next)&&0!==b(u.prev,u,u.next))u=u.next;else{g(u);u=v=u.prev;if(u===u.next)break;r=!0}while(r||u!==v);return v}function w(u,v,r,z,A,C,F,G){if(u){!G&&C&&(u=d(u,z,A,C));for(var H=u;u.prev!==u.next;){var K=u.prev,J=u.next;if(C)var N=t(u,z,A,C);else a:{N=u;var P=N.prev,W=N;const X=N.next;if(0<=b(P,W,X)){N=!1;break a}let aa=N.next.next;const Z=aa;let ea=0;for(;aa!==N.prev&&(0===ea||aa!==Z);){ea++;if(e(P.x,P.y,W.x,
W.y,X.x,X.y,aa.x,aa.y)&&0<=b(aa.prev,aa,aa.next)){N=!1;break a}aa=aa.next}N=!0}if(N)v.push(K.index/r+F),v.push(u.index/r+F),v.push(J.index/r+F),g(u),H=u=J.next;else if(u=J,u===H){if(!G)w(E(u),v,r,z,A,C,F,1);else if(1===G){G=v;H=r;K=F;J=u;do N=J.prev,P=J.next.next,!k(N,P)&&a(N,J,J.next,P)&&c(N,P)&&c(P,N)&&(G.push(N.index/H+K),G.push(J.index/H+K),G.push(P.index/H+K),g(J),g(J.next),J=u=P),J=J.next;while(J!==u);u=J;w(u,v,r,z,A,C,F,2)}else if(2===G)a:{G=u;do{for(H=G.next.next;H!==G.prev;){if(K=G.index!==
H.index){N=N=N=void 0;K=G;J=H;if(N=K.next.index!==J.index&&K.prev.index!==J.index){b:{N=K;do{if(N.index!==K.index&&N.next.index!==K.index&&N.index!==J.index&&N.next.index!==J.index&&a(N,N.next,K,J)){N=!0;break b}N=N.next}while(N!==K);N=!1}N=!N}if(N=N&&c(K,J)&&c(J,K)){N=K;P=!1;W=(K.x+J.x)/2;J=(K.y+J.y)/2;do N.y>J!==N.next.y>J&&N.next.y!==N.y&&W<(N.next.x-N.x)*(J-N.y)/(N.next.y-N.y)+N.x&&(P=!P),N=N.next;while(N!==K);N=P}K=N}if(K){u=x(G,H);G=E(G,G.next);u=E(u,u.next);w(G,v,r,z,A,C,F,0);w(u,v,r,z,A,C,
F,0);break a}H=H.next}G=G.next}while(G!==u)}break}}}}function t(u,v,r,z){const A=u.prev,C=u.next;if(0<=b(A,u,C))return!1;const F=A.x>u.x?A.x>C.x?A.x:C.x:u.x>C.x?u.x:C.x,G=A.y>u.y?A.y>C.y?A.y:C.y:u.y>C.y?u.y:C.y,H=m(A.x<u.x?A.x<C.x?A.x:C.x:u.x<C.x?u.x:C.x,A.y<u.y?A.y<C.y?A.y:C.y:u.y<C.y?u.y:C.y,v,r,z);v=m(F,G,v,r,z);r=u.prevZ;for(z=u.nextZ;r&&r.z>=H&&z&&z.z<=v;){if(r!==u.prev&&r!==u.next&&e(A.x,A.y,u.x,u.y,C.x,C.y,r.x,r.y)&&0<=b(r.prev,r,r.next))return!1;r=r.prevZ;if(z!==u.prev&&z!==u.next&&e(A.x,
A.y,u.x,u.y,C.x,C.y,z.x,z.y)&&0<=b(z.prev,z,z.next))return!1;z=z.nextZ}for(;r&&r.z>=H;){if(r!==u.prev&&r!==u.next&&e(A.x,A.y,u.x,u.y,C.x,C.y,r.x,r.y)&&0<=b(r.prev,r,r.next))return!1;r=r.prevZ}for(;z&&z.z<=v;){if(z!==u.prev&&z!==u.next&&e(A.x,A.y,u.x,u.y,C.x,C.y,z.x,z.y)&&0<=b(z.prev,z,z.next))return!1;z=z.nextZ}return!0}function p(u,v,r,z){u=q.create(u,v,r);z?(u.next=z.next,u.prev=z,z.next.prev=u,z.next=u):(u.prev=u,u.next=u);return u}function g(u){u.next.prev=u.prev;u.prev.next=u.next;u.prevZ&&(u.prevZ.nextZ=
u.nextZ);u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function f(u,v){let r=v;const z=u.x,A=u.y;let C=-Infinity,F;do{if(A<=r.y&&A>=r.next.y&&r.next.y!==r.y){var G=r.x+(A-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(G<=z&&G>C){C=G;if(G===z){if(A===r.y)return r;if(A===r.next.y)return r.next}F=r.x<r.next.x?r:r.next}}r=r.next}while(r!==v);if(!F)return null;if(z===C)return F.prev;v=F;G=F.x;const H=F.y;let K=Infinity,J;for(r=F.next;r!==v;)z>=r.x&&r.x>=G&&z!==r.x&&e(A<H?z:C,A,G,H,A<H?C:z,A,r.x,r.y)&&(J=Math.abs(A-r.y)/(z-
r.x),(J<K||J===K&&r.x>F.x)&&c(r,u)&&(F=r,K=J)),r=r.next;return F}function d(u,v,r,z){for(var A;A!==u;A=A.next){A=A||u;null===A.z&&(A.z=m(A.x,A.y,v,r,z));if(A.prev.next!==A||A.next.prev!==A)return A.prev.next=A,A.next.prev=A,d(u,v,r,z);A.prevZ=A.prev;A.nextZ=A.next}u.prevZ.nextZ=null;u.prevZ=null;a:for(r=1;;){z=u;v=u=null;let C=0;for(;z;){C++;A=z;let F=0;for(;F<r&&A;F++)A=A.nextZ;let G=r;for(;0<F||0<G&&A;){let H;0===F?(H=A,A=A.nextZ,G--):0!==G&&A?z.z<=A.z?(H=z,z=z.nextZ,F--):(H=A,A=A.nextZ,G--):(H=
z,z=z.nextZ,F--);v?v.nextZ=H:u=H;H.prevZ=v;v=H}z=A}v.nextZ=null;r*=2;if(2>C)break a}return u}function b(u,v,r){return(v.y-u.y)*(r.x-v.x)-(v.x-u.x)*(r.y-v.y)}function a(u,v,r,z){return k(u,v)&&k(r,z)||k(u,z)&&k(r,v)?!0:0<b(u,v,r)!==0<b(u,v,z)&&0<b(r,z,u)!==0<b(r,z,v)}function e(u,v,r,z,A,C,F,G){return 0<=(A-F)*(v-G)-(u-F)*(C-G)&&0<=(u-F)*(z-G)-(r-F)*(v-G)&&0<=(r-F)*(C-G)-(A-F)*(z-G)}function c(u,v){return 0>b(u.prev,u,u.next)?0<=b(u,v,u.next)&&0<=b(u,u.prev,v):0>b(u,v,u.prev)||0>b(u,u.next,v)}function m(u,
v,r,z,A){u=32767*(u-r)*A;v=32767*(v-z)*A;u=(u|u<<8)&16711935;u=(u|u<<4)&252645135;u=(u|u<<2)&858993459;v=(v|v<<8)&16711935;v=(v|v<<4)&252645135;v=(v|v<<2)&858993459;return(u|u<<1)&1431655765|((v|v<<1)&1431655765)<<1}function k(u,v){return u.x===v.x&&u.y===v.y}function n(u,v){return u.x-v.x}function x(u,v){const r=q.create(u.index,u.x,u.y),z=q.create(v.index,v.x,v.y),A=u.next,C=v.prev;u.next=v;v.prev=u;r.next=A;A.prev=r;z.next=r;r.prev=z;C.next=z;z.prev=C;return z}let q=function(){function u(){this.y=
this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}u.create=function(v,r,z){const A=y<B.length?B[y++]:new u;A.index=v;A.x=r;A.y=z;A.prev=null;A.next=null;A.z=null;A.prevZ=null;A.nextZ=null;A.steiner=!1;return A};return h._createClass(u)}();const B=[];let y=0;for(let u=0;8096>u;u++)B.push(new q);l.bufcut=function(u,v,r,z,A,C,F){y=0;var G=(z-r)*C,H=A&&A.length;const K=H?(A[0]-r)*C:G;var J=D(v,r,z,0,K,C,!0);if(J&&J.next!==J.prev){var N;if(H){const Z=[];for(let ea=
0,T=A.length;ea<T;ea++){const I=D(v,r,z,A[ea]*C,ea<T-1?A[ea+1]*C:z*C,C,!1);I===I.next&&(I.steiner=!0);H=Z;var P=H.push;let M=I,S=I;do{if(M.x<S.x||M.x===S.x&&M.y<S.y)S=M;M=M.next}while(M!==I);P.call(H,S)}Z.sort(n);for(var W of Z)if(z=W,A=f(z,J))z=x(A,z),E(z,z.next),J=E(A,A.next)}if(G>80*C){var X=G=v[r*C];var aa=N=v[1+r*C];for(W=C;W<K;W+=C)z=v[W+r*C],A=v[W+1+r*C],X=Math.min(X,z),aa=Math.min(aa,A),G=Math.max(G,z),N=Math.max(N,A);N=Math.max(G-X,N-aa);N=0!==N?1/N:0}w(J,u,C,X,aa,N,F,0)}};Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),function(l,h,D,E,w,t,p,g,f,d,b,a){return function(e){function c(k,n,x,q,B,y,u,v,r,z,A,
C,F,G,H,K,J,N,P,W){var X=m.call(this);k=f.LineMaterialKey.load(k);n&&(k.sdf=n.sdf,k.pattern=!0,k.textureBinding=n.textureBinding);X._capType=q;X._joinType=B;X._miterLimitCosine=d.getLimitCosine(y);X.tessellationProperties._fillColor=u;X.tessellationProperties._tl=v;X.tessellationProperties._br=r;X._hasPattern=z;X._isDashed=A;X._zOrder=J;X._effects=N;X._minMaxZoom=p.i1616to32(Math.round(P*t.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(W*t.MIN_MAX_ZOOM_PRECISION_FACTOR));X._materialKey=k.data;X.tessellationProperties._bitset=
(F?t.BITSET_GENERIC_LOCK_COLOR:0)|(G?t.BITSET_TYPE_FILL_OUTLINE:0)|(C?t.BITSET_LINE_SCALE_DASH:0)|(H?t.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);X.tessellationProperties._halfWidth=.5*x;X.tessellationProperties._halfReferenceWidth=.5*K;X.tessellationProperties.offset=0;X._initializeTessellator(!1);return X}l._inherits(c,e);var m=l._createSuper(c);c.fromCIMLine=function(k,n,x){var q=k.color,B=k.scaleFactor||1;const y=!!k.dashTemplate;let u=k.cap;y&&u===E.CapType.ROUND&&(u=E.CapType.SQUARE);const v=k.join;
B*=D.pt2px(k.width);const r=D.pt2px(k.referenceWidth),z=D.pt2px(k.miterLimit);q=q&&w.premultiplyAlphaRGBA(q)||0;const [A,C]=d.getMinMaxZoom(k.scaleInfo,x);if(!n)return new c(k.materialKey,n,B,u,v,z,q,0,0,!1,y,k.scaleDash??!1,k.colorLocked??!1,!1,k.sampleAlphaOnly,r,k.zOrder,k.effects,A,C);const {rect:F,width:G,height:H}=n;var K=F.x+t.SPRITE_PADDING;const J=F.y+t.SPRITE_PADDING;x=K+G;const N=J+H;K=p.i1616to32(K,J);x=p.i1616to32(x,N);return new c(k.materialKey,n,B,u,v,z,q,K,x,!0,y,k.scaleDash??!1,k.colorLocked??
!1,!1,k.sampleAlphaOnly,r,k.zOrder,k.effects,A,C)};c.fromFillOutline=function(k){const n=f.FillMaterialKey.load(k.materialKey);return f.hasOutlineFillSymbology(n)&&k.outline&&"esriSLSSolid"===k.outline?.style?c.fromSimpleLine({hash:"",materialKey:k.materialKey,...k.outline},null,!0):null};c.fromSimpleLine=function(k,n,x=!1){var {color:q}=k;const B="esriSLSSolid"!==k.style&&"esriSLSNull"!==k.style,y=g.getCapType(k.cap||"round"),u=g.getJoinType(k.join||"round");q=q&&"esriSLSNull"!==k.style&&w.premultiplyAlphaRGBAArray(q)||
0;"esriSLSNull"===k.style&&(q=0);const v=D.pt2px(k.width),r=k.miterLimit;if(!n)return new c(k.materialKey,n,v,y,u,r,q,0,0,!1,B,!0,!1,x,!1,v,0,null,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM);const {rect:z,width:A,height:C}=n;var F=z.x+t.SPRITE_PADDING;const G=z.y+t.SPRITE_PADDING;var H=F+A;const K=G+C;F=p.i1616to32(F,G);H=p.i1616to32(H,K);return new c(k.materialKey,n,v,y,u,r,q,F,H,!0,B,!0,!1,x,!1,v,0,null,d.DEFAULT_MIN_ZOOM,d.DEFAULT_MAX_ZOOM)};c.fromPictureLineSymbol=function(k,n,x,q){h.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate").error("PictureLineSymbol support does not exist!");
return null};return l._createClass(c)}(b(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../definitions ../../enums ../../number ../../TurboLine ../../materialKey/MaterialKey ./templateUtils".split(" "),function(l,h,D,E,w,t,p,g){const f=(a,e,c)=>(m,k,n,x,q,B,y,u,v,r,z)=>{n=w.i1616to32(z,Math.ceil(16*a._halfWidth));y=w.i8888to32(Math.round(16*y),Math.round(16*u),Math.round(16*
v),Math.round(16*r));q=w.i8888to32(16*q,16*B,0,a._bitset);B=a.out;B.vertexBounds(m,k,e,c);B.vertexWrite(w.i1616to32(8*m,8*k));B.vertexWrite(a.id);B.vertexWrite(a._fillColor);B.vertexWrite(y);B.vertexWrite(n);B.vertexWrite(a._tl);B.vertexWrite(a._br);B.vertexWrite(q);B.vertexWrite(w.i1616to32(Math.ceil(16*a._halfReferenceWidth),0));B.vertexWrite(a.minMaxZoom);B.vertexEnd();return a.offset+a.vertexCount++},d=(a,e,c)=>(m,k,n,x,q,B,y,u,v,r,z)=>{n=w.i1616to32(16*a._halfWidth,16*a._halfReferenceWidth);
y=w.i8888to32(16*y+128,16*u+128,16*v+128,16*r+128);u=a.out;v=a._bitset<<24|a.id;u.vertexBounds(m,k,e,c);u.vertexWrite(w.i1616to32(8*m,8*k));u.vertexWrite(v);u.vertexWrite(a._fillColor);m=p.hasSimpleSymbology(a.key);m||(u.vertexWrite(0),u.vertexWrite(0));u.vertexWrite(0);u.vertexWrite(n);u.vertexWrite(y);m||u.vertexWrite(a.minMaxZoom);u.vertexEnd();return a.offset+a.vertexCount++},b=a=>(e,c,m)=>{const k=a.out;k.indexWrite(e);k.indexWrite(c);k.indexWrite(m);a.indexCount+=3};return a=>function(e){function c(...k){k=
m.call(this,...k);k.tessellationProperties={};k._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0};k.geometryType=E.WGLGeometryType.LINE;return k}l._inherits(c,e);var m=l._createSuper(c);e=c.prototype;e.writeGeometry=function(k,n,x,q){this._writeGeometry(k,n,x,q)};e._initializeTessellator=function(k){var n=p.LineMaterialKey.load(this._materialKey),x=p.FillMaterialKey.load(this._materialKey),q=this._tessellationOptions;n=n.vvSizeFieldStops||n.vvSizeMinMaxValue||n.vvSizeScaleStops||n.vvSizeUnitValue;
k=this.tessellationProperties._halfWidth<D.THIN_LINE_HALF_WIDTH_THRESHOLD&&!k&&!n;this.tessellationProperties.minMaxZoom=this._minMaxZoom;q.wrapDistance=65535;q.textured=this._isDashed||this._hasPattern;q.offset=this.tessellationProperties.offset;q.halfWidth=this.tessellationProperties._halfWidth;q=k?0:1;x=p.hasOutlineFillSymbology(x)?d:f;this._lineTessellator=new t.LineTessellation(x(this.tessellationProperties,q,q),b(this.tessellationProperties),k)};e._write=function(k,n,x,q){x="esriGeometryPoint"===
n.geometryType;k.recordStart(n.getDisplayId(),this._materialKey,this.geometryType,x);this._writeGeometry(k,n,q,x);k.recordEnd()};e._writeGeometry=function(k,n,x,q){x=x??n.readLegacyGeometryForDisplay();q=this._getLines(x,q);h.isNone(q)||this._writeVertices(k,n,q)};e._getLines=function(k,n){if(h.isNone(k))return null;k=k.paths||k.rings;return h.isNone(k)?null:g.clipLinesMarshall(k,n?256:16)};e._writeVertices=function(k,n,x){const q=n.getDisplayId(),B=k.vertexCount(),y=this.tessellationProperties;n=
this._tessellationOptions;y.out=k;y.id=q;y.indexCount=0;y.vertexCount=0;y.offset=B;n.capType=this._capType;n.joinType=this._joinType;k=p.FillMaterialKey.load(this._materialKey);this.tessellationProperties.key=p.hasOutlineFillSymbology(k)?k:p.LineMaterialKey.load(this._materialKey);for(const {line:u,start:v}of x)n.initialDistance=v%65535,this._lineTessellator.tessellate(u,n)};return l._createClass(c)}(a)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers",
"../../../../symbols/cim/enums","./definitions"],function(l,h,D,E){function w(e,c){return e.x===c.x&&e.y===c.y}function t(e,c){e.x=c.y;e.y=-c.x;return e}function p(e,c){e.x=-c.y;e.y=c.x;return e}function g(e,c){e.x=c.x;e.y=c.y;return e}function f(e,c){e.x=-c.x;e.y=-c.y;return e}function d(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function b(e,c,m,k){e.x=c.x*m+c.y*k;e.y=c.x*k-c.y*m;return e}let a=function(){function e(m,k,n){this._writeVertex=m;this._writeTriangle=k;this._canUseThinTessellation=n;this._prevNormal=
{x:void 0,y:void 0};this._nextNormal={x:void 0,y:void 0};this._textureNormalLeft={x:0,y:1};this._textureNormalRight={x:0,y:-1};this._textureNormal={x:void 0,y:void 0};this._joinNormal={x:void 0,y:void 0};this._inner={x:void 0,y:void 0};this._outer={x:void 0,y:void 0};this._roundStart={x:void 0,y:void 0};this._roundEnd={x:void 0,y:void 0};this._startBreak={x:void 0,y:void 0};this._endBreak={x:void 0,y:void 0};this._innerPrev={x:void 0,y:void 0};this._innerNext={x:void 0,y:void 0};this._bevelStart=
{x:void 0,y:void 0};this._bevelEnd={x:void 0,y:void 0};this._bevelMiddle={x:void 0,y:void 0}}var c=e.prototype;c.tessellate=function(m,k){if(m){var n=m.length;if(!(1>=n)){var x=0;for(let q=1;q<n;q++)w(m[q],m[x])||++x===q||(m[x]=m[q]);m.length=x+1}}this._canUseThinTessellation&&k.halfWidth<E.THIN_LINE_HALF_WIDTH_THRESHOLD&&!k.offset?this._tessellateThin(m,k):this._tessellate(m,k)};c._tessellateThin=function(m,k){if(!(2>m.length)){var n=k.wrapDistance||65535;k=k.initialDistance||0;var x=!1,q=m[0].x,
B=m[0].y,y=m.length;for(let z=1;z<y;++z){x&&(x=!1,k=0);let A=m[z].x,C=m[z].y;var u=A-q;let F=C-B;var v=Math.sqrt(u*u+F*F);u/=v;F/=v;if(k+v>n){x=!0;var r=(n-k)/v;v=n-k;A=(1-r)*q+r*A;C=(1-r)*B+r*C;--z}r=this._writeVertex(q,B,0,0,u,F,F,-u,0,-1,k);q=this._writeVertex(q,B,0,0,u,F,-F,u,0,1,k);k+=v;v=this._writeVertex(A,C,0,0,u,F,F,-u,0,-1,k);u=this._writeVertex(A,C,0,0,u,F,-F,u,0,1,k);this._writeTriangle(r,q,v);this._writeTriangle(q,v,u);q=A;B=C}}};c._tessellate=function(m,k){var n=m[m.length-1];const x=
w(m[0],n);if(!(m.length<(x?3:2))){var q=k.pixelCoordRatio,B=null!=k.capType?k.capType:D.CapType.BUTT,y=null!=k.joinType?k.joinType:D.JoinType.MITER,u=null!=k.miterLimit?Math.min(k.miterLimit,4):2,v=null!=k.roundLimit?Math.min(k.roundLimit,1.05):1.05,r=null!=k.halfWidth?k.halfWidth:2,z=!!k.textured,A=null,C=this._prevNormal,F=this._nextNormal,G=-1,H=-1,K=this._joinNormal,J=this._textureNormalLeft,N=this._textureNormalRight,P=this._textureNormal,W=-1,X=-1,aa=k.wrapDistance||65535,Z=k.initialDistance||
0,ea=this._writeVertex,T=this._writeTriangle;k=(fa,ka,la,ma,na,oa)=>{fa=ea(M,S,Y,L,la,ma,fa,ka,na,oa,Z);0<=W&&0<=X&&0<=fa&&T(W,X,fa);W=X;return X=fa};if(x){var I=m[m.length-2];F.x=n.x-I.x;F.y=n.y-I.y;H=d(F);F.x/=H;F.y/=H}n=!1;for(let fa=0;fa<m.length;++fa){n&&(n=!1,Z=0);I&&(C.x=-F.x,C.y=-F.y,G=H,Z+G>aa&&(n=!0));n?(A=(aa-Z)/G,G=aa-Z,I={x:(1-A)*I.x+A*m[fa].x,y:(1-A)*I.y+A*m[fa].y},--fa):I=m[fa];var M=I.x;var S=I.y;var V=0>=fa&&!n,Q=fa===m.length-1;V||(Z+=G);(A=Q?x?m[1]:null:m[fa+1])?(F.x=A.x-M,F.y=
A.y-S,H=d(F),F.x/=H,F.y/=H):(F.x=void 0,F.y=void 0);if(!x){if(V){p(K,F);var Y=K.x;var L=K.y;B===D.CapType.SQUARE&&(k(-F.y-F.x,F.x-F.y,F.x,F.y,0,-1),k(F.y-F.x,-F.x-F.y,F.x,F.y,0,1));B===D.CapType.ROUND&&(k(-F.y-F.x,F.x-F.y,F.x,F.y,-1,-1),k(F.y-F.x,-F.x-F.y,F.x,F.y,-1,1));if(B===D.CapType.ROUND||B===D.CapType.BUTT)k(-F.y,F.x,F.x,F.y,0,-1),k(F.y,-F.x,F.x,F.y,0,1);continue}if(Q){t(K,C);Y=K.x;L=K.y;if(B===D.CapType.ROUND||B===D.CapType.BUTT)k(C.y,-C.x,-C.x,-C.y,0,-1),k(-C.y,C.x,-C.x,-C.y,0,1);B===D.CapType.SQUARE&&
(k(C.y-C.x,-C.x-C.y,-C.x,-C.y,0,-1),k(-C.y-C.x,C.x-C.y,-C.x,-C.y,0,1));B===D.CapType.ROUND&&(k(C.y-C.x,-C.x-C.y,-C.x,-C.y,1,-1),k(-C.y-C.x,C.x-C.y,-C.x,-C.y,1,1));continue}}var O=void 0;V=-(C.x*F.y-C.y*F.x);.01>Math.abs(V)?0<C.x*F.x+C.y*F.y?(K.x=C.x,K.y=C.y,V=1,O=Number.MAX_VALUE,A=!0):(p(K,F),O=V=1,A=!1):(K.x=(C.x+F.x)/V,K.y=(C.y+F.y)/V,O=d(K),A=(O-1)*r*q,A=4<O||A>G&&A>H);Y=K.x;L=K.y;var R=y;switch(y){case D.JoinType.BEVEL:1.05>O&&(R=D.JoinType.MITER);break;case D.JoinType.ROUND:O<v&&(R=D.JoinType.MITER);
break;case D.JoinType.MITER:O>u&&(R=D.JoinType.BEVEL)}switch(R){case D.JoinType.MITER:k(K.x,K.y,-C.x,-C.y,0,-1);k(-K.x,-K.y,-C.x,-C.y,0,1);if(Q)break;z&&(A=n?0:Z,W=this._writeVertex(M,S,Y,L,F.x,F.y,K.x,K.y,0,-1,A),X=this._writeVertex(M,S,Y,L,F.x,F.y,-K.x,-K.y,0,1,A));break;case D.JoinType.BEVEL:V=0>V;var U=void 0;V?(R=W,W=X,X=R,U=J,R=N):(U=N,R=J);var ba=void 0,ca=void 0;A?(ba=V?p(this._innerPrev,C):t(this._innerPrev,C),ca=V?t(this._innerNext,F):p(this._innerNext,F)):ba=ca=V?f(this._inner,K):g(this._inner,
K);O=V?t(this._bevelStart,C):p(this._bevelStart,C);k(ba.x,ba.y,-C.x,-C.y,U.x,U.y);ba=k(O.x,O.y,-C.x,-C.y,R.x,R.y);if(Q)break;Q=V?p(this._bevelEnd,F):t(this._bevelEnd,F);A?(A=this._writeVertex(M,S,Y,L,-C.x,-C.y,0,0,0,0,Z),W=this._writeVertex(M,S,Y,L,F.x,F.y,ca.x,ca.y,U.x,U.y,Z),X=this._writeVertex(M,S,Y,L,F.x,F.y,Q.x,Q.y,R.x,R.y,Z),this._writeTriangle(ba,A,X)):(z?(A=this._bevelMiddle,A.x=(O.x+Q.x)/2,A.y=(O.y+Q.y)/2,b(P,A,-C.x,-C.y),k(A.x,A.y,-C.x,-C.y,P.x,P.y),b(P,A,F.x,F.y),W=this._writeVertex(M,
S,Y,L,F.x,F.y,A.x,A.y,P.x,P.y,Z),X=this._writeVertex(M,S,Y,L,F.x,F.y,ca.x,ca.y,U.x,U.y,Z)):(A=W,W=X,X=A),k(Q.x,Q.y,F.x,F.y,R.x,R.y));V&&(A=W,W=X,X=A);break;case D.JoinType.ROUND:V=0>V;var da=void 0;V?(R=W,W=X,X=R,R=J,da=N):(R=N,da=J);var ha=V?f(this._inner,K):g(this._inner,K);A?(ca=V?p(this._innerPrev,C):t(this._innerPrev,C),U=V?t(this._innerNext,F):p(this._innerNext,F)):U=ca=ha;ba=V?t(this._roundStart,C):p(this._roundStart,C);var ia=V?p(this._roundEnd,F):t(this._roundEnd,F);ca=k(ca.x,ca.y,-C.x,-C.y,
R.x,R.y);ba=k(ba.x,ba.y,-C.x,-C.y,da.x,da.y);if(Q)break;Q=this._writeVertex(M,S,Y,L,-C.x,-C.y,0,0,0,0,Z);A||this._writeTriangle(W,X,Q);ha=f(this._outer,ha);da=this._writeVertex(M,S,Y,L,F.x,F.y,ia.x,ia.y,da.x,da.y,Z);let ka,la;if(ia=2<O){var ja=void 0;O!==Number.MAX_VALUE?(ha.x/=O,ha.y/=O,ja=C.x*ha.x+C.y*ha.y,ja=(O*(ja*ja-1)+1)/ja):ja=-1;ka=V?t(this._startBreak,C):p(this._startBreak,C);ka.x+=C.x*ja;ka.y+=C.y*ja;la=V?p(this._endBreak,F):t(this._endBreak,F);la.x+=F.x*ja;la.y+=F.y*ja}b(P,ha,-C.x,-C.y);
O=this._writeVertex(M,S,Y,L,-C.x,-C.y,ha.x,ha.y,P.x,P.y,Z);b(P,ha,F.x,F.y);ha=z?this._writeVertex(M,S,Y,L,F.x,F.y,ha.x,ha.y,P.x,P.y,Z):O;ja=Q;const ma=z?this._writeVertex(M,S,Y,L,F.x,F.y,0,0,0,0,Z):Q;let na=-1,oa=-1;ia&&(b(P,ka,-C.x,-C.y),na=this._writeVertex(M,S,Y,L,-C.x,-C.y,ka.x,ka.y,P.x,P.y,Z),b(P,la,F.x,F.y),oa=this._writeVertex(M,S,Y,L,F.x,F.y,la.x,la.y,P.x,P.y,Z));z?ia?(this._writeTriangle(ja,ba,na),this._writeTriangle(ja,na,O),this._writeTriangle(ma,ha,oa),this._writeTriangle(ma,oa,da)):(this._writeTriangle(ja,
ba,O),this._writeTriangle(ma,ha,da)):ia?(this._writeTriangle(Q,ba,na),this._writeTriangle(Q,na,oa),this._writeTriangle(Q,oa,da)):(this._writeTriangle(Q,ba,O),this._writeTriangle(Q,ha,da));A?W=this._writeVertex(M,S,Y,L,F.x,F.y,U.x,U.y,R.x,R.y,Z):(W=z?this._writeVertex(M,S,Y,L,F.x,F.y,U.x,U.y,R.x,R.y,Z):ca,this._writeTriangle(W,ma,da));X=da;V&&(A=W,W=X,X=A)}}}};return h._createClass(e)}();l.LineTessellation=a;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../../core/Logger","../../../../../../symbols/cim/cimAnalyzer","../../../../../../symbols/cim/utils","./WGLMeshTemplate"],function(l,h,D,E,w){const t=h.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(p){function g(d){var b=f.call(this);b._ongoingMaterialRequestMap=new Map;b._materialCache=new Map;b._dynamicPropertyMap=new Map;b._cimLayer=d;return b}l._inherits(g,p);var f=l._createSuper(g);g.prototype.analyze=async function(d,b,a,e,c){if(c&&0===c.length)return null;
const m=c&&0<c.length,k=b.readLegacyFeature();b=b.getObjectId();const n=this._materialCache;var x=this._cimLayer.materialHash;if(!x)return t.error("A Dynamic mesh template must have a material hash value or function!"),null;const q="function"===typeof x?x(k,a,e,b):x;x=n.get(q);if(null!=x||(x=this._ongoingMaterialRequestMap.get(q)))return x;x=this._cimLayer;const B=D.analyzeCIMResource(x.cim,this._cimLayer.materialOverrides);B.mosaicHash=q;const {type:y,url:u}=x;b={cim:B,type:y,mosaicHash:q,url:u,
size:null,dashTemplate:null,text:null,fontName:null,objectId:b,animatedSymbolProperties:null};switch(y){case "marker":b.size=E.evaluateValueOrFunction(x.size,k,a,e);b.animatedSymbolProperties=E.evaluateValueOrFunction(x.animatedSymbolProperties,k,a,e);break;case "line":b.dashTemplate=x.dashTemplate;break;case "text":b.text=E.evaluateValueOrFunction(x.text,k,a,e),b.fontName=E.evaluateValueOrFunction(x.fontName,k,a,e)}d=d.getMosaicItem(b,c).then(v=>{m||(this._ongoingMaterialRequestMap.delete(q),n.set(q,
v));return v}).catch(v=>{this._ongoingMaterialRequestMap.delete(q);t.error(".analyze()",v.message);return null});m||this._ongoingMaterialRequestMap.set(q,d);return d};return l._createClass(g)}(w)})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../Color ../../core/fontUtils ../../core/lang ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./quantizeTime ./SDFHelper ./utils ./effects/CIMEffectHelper ../../views/2d/arcade/callExpressionWithFeature ../../views/2d/engine/webgl/definitions ../../views/2d/engine/webgl/grouping".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x){function q(Q){switch(Q){case "Butt":return b.CapType.BUTT;case "Square":return b.CapType.SQUARE;default:return b.CapType.ROUND}}function B(Q){switch(Q){case "Bevel":return b.JoinType.BEVEL;case "Miter":return b.JoinType.MITER;default:return b.JoinType.ROUND}}function y(Q,Y,L,O){let R;Q[Y]?R=Q[Y]:(R={},Q[Y]=R);R[L]=O}function u(Q){return(Q=Q.markerPlacement)&&Q.angleToLine?b.Alignment.MAP:b.Alignment.SCREEN}function v(Q,Y,L,O,R,U,ba){if(Q){var ca=Q.symbolLayers;
if(ca){var da=Q.effects,ha=b.Alignment.SCREEN,ia=d.CIMSymbolHelper.getSize(Q)??0;"CIMPointSymbol"===Q.type&&"Map"===Q.angleAlignment&&(ha=b.Alignment.MAP);for(var ja=ca.length;ja--;){var fa=ca[ja];if(!fa||!1===fa.enable)continue;let xa;da&&da.length&&(xa=[...da]);var ka=fa.effects;ka&&ka.length&&(da?xa.push(...ka):xa=[...ka]);ka=[];d.OverrideHelper.findEffectOverrides(xa,Y,ka);ka=0<ka.length?ea(xa,ka,L,O):xa;var la=[];d.OverrideHelper.findApplicableOverrides(fa,Y,la);switch(fa.type){case "CIMSolidFill":r(fa,
ka,L,la,O,R);break;case "CIMPictureFill":z(fa,ka,L,la,O,U,R);break;case "CIMHatchFill":A(fa,ka,L,la,O,R);break;case "CIMGradientFill":var ma=L,na=O,oa=R;const [Fa,Ma]=S(la,fa.primitiveName,ka,null,null);var ra=g.numericHash(JSON.stringify(fa)+Ma).toString();oa.push({type:"fill",templateHash:ra,materialHash:Fa?M(ra,ma,la,na):ra,cim:fa,materialOverrides:null,colorLocked:!!fa.colorLocked,effects:ka,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1});
break;case "CIMSolidStroke":C(fa,ka,L,la,O,R,"CIMPolygonSymbol"===Q.type,ia);break;case "CIMPictureStroke":F(fa,ka,L,la,O,R,"CIMPolygonSymbol"===Q.type,ia);break;case "CIMGradientStroke":ma=L;na=O;oa=R;ra="CIMPolygonSymbol"===Q.type;var pa=ia,sa=fa.primitiveName,ta=null!=fa.width?fa.width:4,wa=q(fa.capStyle),va=B(fa.joinStyle),ua=fa.miterLimit;const [za,Ha]=S(la,sa,ka,null,null),Aa=g.numericHash(JSON.stringify(fa)+Ha).toString();oa.push({type:"line",templateHash:Aa,materialHash:za?M(Aa,ma,la,na):
Aa,cim:fa,materialOverrides:null,isOutline:ra,colorLocked:!!fa.colorLocked,effects:ka,color:{r:128,g:128,b:128,a:1},width:aa(sa,ma,"Width",na,ta),cap:aa(sa,ma,"CapStyle",na,wa),join:aa(sa,ma,"JoinStyle",na,va),miterLimit:ua&&aa(sa,ma,"MiterLimit",na,ua),referenceWidth:pa,zOrder:W(fa.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1});break;case "CIMCharacterMarker":G(fa,ka,L,la,O,R);break;case "CIMPictureMarker":if(G(fa,ka,L,la,O,R))break;"CIMLineSymbol"===Q.type&&(ha=u(fa));H(fa,ka,L,la,O,
U,R,ha,ia);break;case "CIMVectorMarker":if(G(fa,ka,L,la,O,R))break;"CIMLineSymbol"===Q.type&&(ha=u(fa));ma=L;na=O;oa=R;ra=U;pa=ha;sa=ia;ta=ba;if(va=fa.markerGraphics){wa=0;fa.scaleSymbolsProportionally&&(ua=fa.frame)&&(wa=ua.ymax-ua.ymin);ua=T(fa.markerPlacement,la,ma,na);for(const Ia of va)if(Ia&&(va=Ia.symbol))switch(va.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":J(fa,ka,ua,null,Ia,la,ma,na,oa,ra,pa,sa,wa,!!ta);break;case "CIMTextSymbol":K(fa,ka,ua,Ia,ma,la,na,oa,pa,
sa,wa)}}break;default:V.error("Cannot analyze CIM layer",fa.type)}}}}}function r(Q,Y,L,O,R,U){const ba=Q.primitiveName,ca=c.fromCIMColor(Q.color),[da,ha]=S(O,ba,Y,null,null),ia=g.numericHash(JSON.stringify(Q)+ha).toString();U.push({type:"fill",templateHash:ia,materialHash:da?()=>ia:ia,cim:Q,materialOverrides:null,colorLocked:!!Q.colorLocked,color:aa(ba,L,"Color",R,ca,X),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:Y,applyRandomOffset:!1,sampleAlphaOnly:!0})}function z(Q,Y,L,O,R,U,ba){const ca=
Q.primitiveName,da=c.getTintColor(Q),[ha,ia]=S(O,ca,Y,null,null);O=g.numericHash(JSON.stringify(Q)+ia).toString();const ja=g.numericHash(`${Q.url}${JSON.stringify(Q.colorSubstitutions)}`).toString();let fa=c.getValue(Q.scaleX);if("width"in Q&&"number"===typeof Q.width){const ka=Q.width;let la=1;U=U.getResource(Q.url);t.isSome(U)&&(la=U.width/U.height);fa/=Q.height/ka*la}ba.push({type:"fill",templateHash:O,materialHash:ha?()=>ja:ja,cim:Q,materialOverrides:null,colorLocked:!!Q.colorLocked,effects:Y,
color:aa(ca,L,"TintColor",R,da,X),height:aa(ca,L,"Height",R,Q.height),scaleX:aa(ca,L,"ScaleX",R,fa),angle:aa(ca,L,"Rotation",R,c.getValue(Q.rotation)),offsetX:aa(ca,L,"OffsetX",R,c.getValue(Q.offsetX)),offsetY:aa(ca,L,"OffsetY",R,c.getValue(Q.offsetY)),url:Q.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}function A(Q,Y,L,O,R,U){const ba=["Rotation","OffsetX","OffsetY"],ca=O.filter(ma=>ma.primitiveName!==Q.primitiveName||!ba.includes(ma.propertyName)),da=Q.primitiveName;let [ha,ia]=S(O,da,Y,null,null);
O=g.numericHash(JSON.stringify(Q)+ia).toString();const ja=g.numericHash(`${Q.separation}${JSON.stringify(Q.lineSymbol)}`).toString();let fa={r:255,g:255,b:255,a:1};var ka=!1;const la=Q.lineSymbol?.symbolLayers?.find(ma=>"CIMSolidStroke"===ma.type&&null!=L[ma.primitiveName]?.Color);la&&(fa=c.fromCIMColor(la.color),fa=aa(la.primitiveName,L,"Color",R,fa,X),ka="function"===typeof fa,ha=ha||ka,ka=null!=la.color||ka);U.push({type:"fill",templateHash:O,materialHash:ha?M(ja,L,ca,R):ja,cim:Q,materialOverrides:ca,
colorLocked:!!Q.colorLocked,effects:Y,color:fa,height:aa(da,L,"Separation",R,Q.separation),scaleX:1,angle:aa(da,L,"Rotation",R,c.getValue(Q.rotation)),offsetX:aa(da,L,"OffsetX",R,c.getValue(Q.offsetX)),offsetY:aa(da,L,"OffsetY",R,c.getValue(Q.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0,hasUnresolvedReplacementColor:!ka})}function C(Q,Y,L,O,R,U,ba,ca){const da=Q.primitiveName,ha=c.fromCIMColor(Q.color),ia=null!=Q.width?Q.width:4,ja=q(Q.capStyle),fa=B(Q.joinStyle),ka=Q.miterLimit,[la,ma]=S(O,
da,Y,null,null),na=g.numericHash(JSON.stringify(Q)+ma).toString();let oa;if(Y&&Y instanceof Array&&0<Y.length&&(O=Y[Y.length-1],"CIMGeometricEffectDashes"===O.type&&"NoConstraint"===O.lineDashEnding&&null===O.offsetAlongLine)){Y=[...Y];var ra=Y.pop();oa=ra.dashTemplate;ra=ra.scaleDash}U.push({type:"line",templateHash:na,materialHash:la?()=>na:na,cim:Q,materialOverrides:null,isOutline:ba,colorLocked:!!Q.colorLocked,effects:Y,color:aa(da,L,"Color",R,ha,X),width:aa(da,L,"Width",R,ia),cap:aa(da,L,"CapStyle",
R,ja),join:aa(da,L,"JoinStyle",R,fa),miterLimit:ka&&aa(da,L,"MiterLimit",R,ka),referenceWidth:ca,zOrder:W(Q.name),dashTemplate:oa,scaleDash:ra,sampleAlphaOnly:!0})}function F(Q,Y,L,O,R,U,ba,ca){const da=g.numericHash(`${Q.url}${JSON.stringify(Q.colorSubstitutions)}`).toString(),ha=Q.primitiveName,ia=c.getTintColor(Q),ja=null!=Q.width?Q.width:4,fa=q(Q.capStyle),ka=B(Q.joinStyle),la=Q.miterLimit,[ma,na]=S(O,ha,Y,null,null);O=g.numericHash(JSON.stringify(Q)+na).toString();U.push({type:"line",templateHash:O,
materialHash:ma?()=>da:da,cim:Q,materialOverrides:null,isOutline:ba,colorLocked:!!Q.colorLocked,effects:Y,color:aa(ha,L,"TintColor",R,ia,X),width:aa(ha,L,"Width",R,ja),cap:aa(ha,L,"CapStyle",R,fa),join:aa(ha,L,"JoinStyle",R,ka),miterLimit:la&&aa(ha,L,"MiterLimit",R,la),referenceWidth:ca,zOrder:W(Q.name),dashTemplate:null,scaleDash:!1,url:Q.url,sampleAlphaOnly:!1})}function G(Q,Y,L,O,R,U){const {markerPlacement:ba,type:ca}=Q;if(!ba||"CIMMarkerPlacementInsidePolygon"!==ba.type)return!1;if("CIMVectorMarker"===
ca||"CIMPictureMarker"===ca){var da=Q.primitiveName;if(da&&([da]=S(O,da,Y,null,null),da))return!1;if(da=ba.primitiveName)if([da]=S(O,da,Y,null,null),da)return!1;if("CIMVectorMarker"===ca){if({markerGraphics:da}=Q,da)for(var ha of da)if({symbol:da}=ha,"CIMPolygonSymbol"===da?.type&&da.symbolLayers){({symbolLayers:da}=da);for(var ia of da)if("CIMSolidStroke"===ia.type)return!1}}else if({animatedSymbolProperties:ha}=Q,ha)return!1}da=Math.abs(ba.stepX);var ja=Math.abs(ba.stepY);if(0===da||0===ja)return!0;
const fa=["Rotation","OffsetX","OffsetY"];ha=O.filter(oa=>oa.primitiveName!==Q.primitiveName||!fa.includes(oa.propertyName));ia="url"in Q&&"string"===typeof Q.url?Q.url:void 0;const [ka,la]=S(O,ba.primitiveName,Y,null,null);O=g.numericHash(JSON.stringify(Q)+la).toString();let ma=null;if("Random"===ba.gridType){var na=p.px2pt(n.RANDOM_INSIDE_POLYGON_TEXTURE_SIZE);const oa=Math.max(Math.floor(na/da),1),ra=Math.max(Math.floor(na/ja),1);na=ja*ra;ma=pa=>pa?pa*ra:0;da=oa*da/na}else ba.shiftOddRows?(na=
2*ja,ma=oa=>oa?2*oa:0,da=da/ja*.5):(na=ja,ma=null,da/=ja);ja=c.getTintColor(Q);U.push({type:"fill",templateHash:O,materialHash:ka?M(O,L,ha,R):O,cim:Q,materialOverrides:ha,colorLocked:!!Q.colorLocked,effects:Y,color:aa(ba.primitiveName,L,"TintColor",R,ja,X),height:aa(ba.primitiveName,L,"StepY",R,na,ma),scaleX:da,angle:aa(ba.primitiveName,L,"GridAngle",R,ba.gridAngle),offsetX:aa(ba.primitiveName,L,"OffsetX",R,c.getValue(ba.offsetX)),offsetY:aa(ba.primitiveName,L,"OffsetY",R,c.getValue(ba.offsetY)),
url:ia,applyRandomOffset:"Random"===ba.gridType,sampleAlphaOnly:!ia,hasUnresolvedReplacementColor:!0});return!0}function H(Q,Y,L,O,R,U,ba,ca,da){function ha(va,ua){return t.isSome(pa)?c.evaluateValueOrFunction(pa,va,ua):null}const ia=Q.primitiveName,ja=c.getValue(Q.size);let fa=c.getValue(Q.scaleX,1);const ka=c.getValue(Q.rotation),la=c.getValue(Q.offsetX),ma=c.getValue(Q.offsetY),na=c.getTintColor(Q),oa=g.numericHash(`${Q.url}${JSON.stringify(Q.colorSubstitutions)}${JSON.stringify(Q.animatedSymbolProperties)}`).toString(),
ra=T(Q.markerPlacement,O,L,R),pa=I(Q.animatedSymbolProperties,O,L,R),[sa,ta]=S(O,ia,Y,ra,pa);O=g.numericHash(JSON.stringify(Q)+ta).toString();const wa=Q.anchorPoint??{x:0,y:0};if("width"in Q&&"number"===typeof Q.width){const va=Q.width;let ua=1;U=U.getResource(Q.url);t.isSome(U)&&(ua=U.width/U.height);fa/=ja/va*ua}ba.push({type:"marker",templateHash:O,materialHash:Q.animatedSymbolProperties&&!0===Q.animatedSymbolProperties.randomizeStartTime?(va,ua,xa,Fa)=>{xa=x.getMaterialGroup(Fa??0);va=ha(va,ua);
return oa+`-MATERIALGROUP(${xa})`+`-ASP(${JSON.stringify(va)})`}:sa?(va,ua)=>{va=ha(va,ua);return oa+`-ASP(${JSON.stringify(va)})`}:oa,cim:Q,materialOverrides:null,colorLocked:!!Q.colorLocked,effects:Y,scaleSymbolsProportionally:!1,alignment:ca,size:aa(ia,L,"Size",R,ja),scaleX:aa(ia,L,"ScaleX",R,fa),rotation:aa(ia,L,"Rotation",R,ka),offsetX:aa(ia,L,"OffsetX",R,la),offsetY:aa(ia,L,"OffsetY",R,ma),color:aa(ia,L,"TintColor",R,na,X),anchorPoint:{x:wa.x,y:-wa.y},isAbsoluteAnchorPoint:"Relative"!==Q.anchorPointUnits,
outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:!!Q.rotateClockwise,referenceSize:da,sizeRatio:1,markerPlacement:ra,url:Q.url,animatedSymbolProperties:pa})}function K(Q,Y,L,O,R,U,ba,ca,da,ha,ia){d.OverrideHelper.findApplicableOverrides(O,U,[]);var ja=O.geometry;if("x"in ja&&"y"in ja){var fa=O.symbol,ka=c.fromCIMFontDecoration(fa),la=c.fromCIMFontStyle(fa.fontStyleName),ma=D.getFontFamily(fa.fontFamilyName);fa.font={family:ma,decoration:ka,...la};var na=Q.frame,oa=ja.x-
.5*(na.xmin+na.xmax),ra=ja.y-.5*(na.ymin+na.ymax),pa=Q.size/ia;ia=Q.primitiveName;ja=c.getValue(fa.height)*pa;na=c.getValue(fa.angle);oa=c.getValue(Q.offsetX)+(c.getValue(fa.offsetX)+oa)*pa;ra=c.getValue(Q.offsetY)+(c.getValue(fa.offsetY)+ra)*pa;var sa=c.fromCIMColor(c.getFillColor(fa)),ta=c.fromCIMColor(c.getStrokeColor(fa)),wa=c.getStrokeWidth(fa)??0;wa||(ta=c.fromCIMColor(c.getFillColor(fa.haloSymbol)),fa.haloSize&&(wa=fa.haloSize*pa));var va=pa=null,ua=0;if(fa.callout&&"CIMBackgroundCallout"===
fa.callout.type){var xa=fa.callout;if(xa.backgroundSymbol&&(xa=xa.backgroundSymbol.symbolLayers))for(const Aa of xa)"CIMSolidFill"===Aa.type?pa=c.fromCIMColor(Aa.color):"CIMSolidStroke"===Aa.type&&(va=c.fromCIMColor(Aa.color),ua=c.getValue(Aa.width))}var [Fa,Ma]=S(U,ia,Y,L,null);U=JSON.stringify(Q.effects)+Number(Q.colorLocked).toString()+JSON.stringify(Q.anchorPoint)+Q.anchorPointUnits+JSON.stringify(Q.markerPlacement)+Q.size.toString();U=g.numericHash(JSON.stringify(O)+U+Ma).toString();var za=aa(O.primitiveName,
R,"TextString",ba,O.textString??"",c.adjustTextCase,fa.textCase);if(null!=za){({fontStyleName:O}=fa);var Ha=ma+(O?"-"+O.toLowerCase():"-regular");"string"===typeof za&&za.includes("[")&&fa.fieldMap&&(za=c.createLabelOverrideFunction(fa.fieldMap,za,fa.textCase));ca.push({type:"text",templateHash:U,materialHash:Fa||"function"===typeof za||za.match(/\[(.*?)\]/)?(Aa,Ia,Ea)=>Ha+"-"+c.evaluateValueOrFunction(za,Aa,Ia,Ea):Ha+"-"+g.numericHash(za),cim:fa,materialOverrides:null,colorLocked:!!Q.colorLocked,
effects:Y,alignment:da,anchorPoint:{x:Q.anchorPoint?Q.anchorPoint.x:0,y:Q.anchorPoint?Q.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==Q.anchorPointUnits,fontName:Ha,decoration:ka,weight:aa(ia,R,"Weight",ba,la.weight),style:aa(ia,R,"Size",ba,la.style),size:aa(ia,R,"Size",ba,ja),angle:aa(ia,R,"Rotation",ba,na),offsetX:aa(ia,R,"OffsetX",ba,oa),offsetY:aa(ia,R,"OffsetY",ba,ra),horizontalAlignment:c.fromCIMHorizontalAlignment(fa.horizontalAlignment),verticalAlignment:c.fromCIMVerticalAlignment(fa.verticalAlignment),
text:za,color:sa,outlineColor:ta,outlineSize:wa,backgroundColor:pa,borderLineColor:va,borderLineWidth:ua,referenceSize:ha,sizeRatio:1,markerPlacement:L})}}}function J(Q,Y,L,O,R,U,ba,ca,da,ha,ia,ja,fa,ka){var la=R.symbol;const ma=la.symbolLayers;if(ma)if(ka)P(Q,Y,L,O,R,ba,U,ca,da,ha,ia,ja,fa);else if(ka=ma.length,ma&&2===ma.length&&ma[0].enable&&ma[1].enable&&"CIMSolidStroke"===ma[0].type&&"CIMSolidFill"===ma[1].type&&!ma[0].effects&&!ma[1].effects)N(Q,Y,L,O,R,ma,U,ba,ca,da,ia,ja,fa);else if(la=m.CIMEffectHelper.applyEffects(la.effects,
R.geometry,ha.geometryEngine))for(;ka--;){var na=ma[ka];if(na&&!1!==na.enable)switch(na.type){case "CIMSolidFill":case "CIMSolidStroke":var oa=m.CIMEffectHelper.applyEffects(na.effects,la,ha.geometryEngine),ra=e.getExtent(oa);if(!ra)continue;const ta="Relative"!==Q.anchorPointUnits,[wa,va,ua]=e.getSDFMetrics(ra,Q.frame,Q.size,Q.anchorPoint,ta);var pa="CIMSolidFill"===na.type;oa={type:"sdf",geom:oa,asFill:pa};var sa=Q.primitiveName;ra=c.getValue(Q.size)??10;const xa=c.getValue(Q.rotation),Fa=c.getValue(Q.offsetX),
Ma=c.getValue(Q.offsetY),za=na.path,Ha=na.primitiveName,Aa=pa?c.fromCIMColor(c.getFillColor(na)):c.fromCIMColor(c.getStrokeColor(na)),Ia=pa?{r:0,g:0,b:0,a:0}:c.fromCIMColor(c.getStrokeColor(na)),Ea=c.getStrokeWidth(na)??0;if(!pa&&!Ea)break;pa=!1;let Ba="";for(const Da of U)if(Da.primitiveName===Ha||Da.primitiveName===sa)void 0!==Da.value?Ba+=`-${Da.primitiveName}-${Da.propertyName}-${JSON.stringify(Da.value)}`:Da.valueExpressionInfo&&(pa=!0);if(t.isSome(Y)&&"function"===typeof Y||t.isSome(L)&&"function"===
typeof L)pa=!0;sa=JSON.stringify({...Q,markerGraphics:null});const Ya=g.numericHash(JSON.stringify(oa)+za).toString();na={type:"marker",templateHash:g.numericHash(JSON.stringify(R)+JSON.stringify(na)+sa+Ba).toString(),materialHash:pa?()=>Ya:Ya,cim:oa,materialOverrides:null,colorLocked:!!Q.colorLocked,effects:Y,scaleSymbolsProportionally:!!Q.scaleSymbolsProportionally,alignment:ia,anchorPoint:{x:va,y:ua},isAbsoluteAnchorPoint:ta,size:aa(Q.primitiveName,ba,"Size",ca,ra),rotation:aa(Q.primitiveName,
ba,"Rotation",ca,xa),offsetX:aa(Q.primitiveName,ba,"OffsetX",ca,Fa),offsetY:aa(Q.primitiveName,ba,"OffsetY",ca,Ma),scaleX:1,frameHeight:fa,rotateClockwise:!!Q.rotateClockwise,referenceSize:ja,sizeRatio:wa,color:aa(Ha,ba,"Color",ca,Aa,X),outlineColor:aa(Ha,ba,"Color",ca,Ia,X),outlineWidth:aa(Ha,ba,"Width",ca,Ea),markerPlacement:L,animatedSymbolProperties:O,path:za};da.push(na);break;default:P(Q,Y,L,O,R,ba,U,ca,da,ha,ia,ja,fa)}}}function N(Q,Y,L,O,R,U,ba,ca,da,ha,ia,ja,fa){var ka=R.geometry;const la=
U[0];U=U[1];var ma=e.getExtent(ka);if(ma){var na="Relative"!==Q.anchorPointUnits,[oa,ra,pa]=e.getSDFMetrics(ma,Q.frame,Q.size,Q.anchorPoint,na);ka={type:"sdf",geom:ka,asFill:!0};var sa=Q.primitiveName;ma=c.getValue(Q.size);var ta=c.getValue(Q.rotation),wa=c.getValue(Q.offsetX),va=c.getValue(Q.offsetY),ua=U.path,xa=U.primitiveName,Fa=la.primitiveName,Ma=c.fromCIMColor(c.getFillColor(U)),za=c.fromCIMColor(c.getStrokeColor(la)),Ha=c.getStrokeWidth(la)??0,Aa=!1,Ia="";for(const Ba of ba)if(Ba.primitiveName===
xa||Ba.primitiveName===Fa||Ba.primitiveName===sa)void 0!==Ba.value?Ia+=`-${Ba.primitiveName}-${Ba.propertyName}-${JSON.stringify(Ba.value)}`:Ba.valueExpressionInfo&&(Aa=!0);t.isSome(L)&&"function"===typeof L&&(Aa=!0);ba=JSON.stringify({...Q,markerGraphics:null});var Ea=g.numericHash(JSON.stringify(ka)+ua).toString();Q={type:"marker",templateHash:g.numericHash(JSON.stringify(R)+JSON.stringify(U)+JSON.stringify(la)+ba+Ia).toString(),materialHash:Aa?()=>Ea:Ea,cim:ka,materialOverrides:null,colorLocked:!!Q.colorLocked,
effects:Y,scaleSymbolsProportionally:!!Q.scaleSymbolsProportionally,alignment:ia,anchorPoint:{x:ra,y:pa},isAbsoluteAnchorPoint:na,size:aa(Q.primitiveName,ca,"Size",da,ma),rotation:aa(Q.primitiveName,ca,"Rotation",da,ta),offsetX:aa(Q.primitiveName,ca,"OffsetX",da,wa),offsetY:aa(Q.primitiveName,ca,"OffsetY",da,va),scaleX:1,frameHeight:fa,rotateClockwise:!!Q.rotateClockwise,referenceSize:ja,sizeRatio:oa,color:aa(xa,ca,"Color",da,Ma,X),outlineColor:aa(Fa,ca,"Color",da,za,X),outlineWidth:aa(Fa,ca,"Width",
da,Ha),markerPlacement:L,path:ua,animatedSymbolProperties:O};ha.push(Q)}}function P(Q,Y,L,O,R,U,ba,ca,da,ha,ia,ja,fa){R={type:Q.type,enable:!0,name:Q.name,colorLocked:Q.colorLocked,primitiveName:Q.primitiveName,anchorPoint:Q.anchorPoint,anchorPointUnits:Q.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:Q.rotateClockwise,rotation:0,size:Q.size,billboardMode3D:Q.billboardMode3D,depth3D:Q.depth3D,frame:Q.frame,markerGraphics:[R],scaleSymbolsProportionally:Q.scaleSymbolsProportionally,respectFrame:Q.respectFrame,
clippingPath:Q.clippingPath};const ka=["Rotation","OffsetX","OffsetY"],la=ba.filter(wa=>wa.primitiveName!==Q.primitiveName||!ka.includes(wa.propertyName));var ma="";for(var na of ba)void 0!==na.value&&(ma+=`-${na.primitiveName}-${na.propertyName}-${JSON.stringify(na.value)}`);const [oa,ra,pa]=d.CIMSymbolHelper.getTextureAnchor(R,ha);ba=Q.primitiveName;ha=c.getValue(Q.rotation);na=c.getValue(Q.offsetX);const sa=c.getValue(Q.offsetY);ma=g.numericHash(JSON.stringify(R)+ma).toString();const ta=0<la.length||
t.isSome(Y)&&"function"===typeof Y;Y={type:"marker",templateHash:ma,materialHash:ta?M(ma,U,la,ca):ma,cim:R,materialOverrides:la,colorLocked:!!Q.colorLocked,effects:Y,scaleSymbolsProportionally:!!Q.scaleSymbolsProportionally,alignment:ia,anchorPoint:{x:oa,y:ra},isAbsoluteAnchorPoint:!1,size:c.getValue(Q.size),rotation:aa(ba,U,"Rotation",ca,ha),offsetX:aa(ba,U,"OffsetX",ca,na),offsetY:aa(ba,U,"OffsetY",ca,sa),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:fa,
rotateClockwise:!!Q.rotateClockwise,referenceSize:ja,sizeRatio:pa/p.pt2px(Q.size),markerPlacement:L,animatedSymbolProperties:O,avoidSDFRasterization:!0};da.push(Y)}function W(Q){return Q&&0===Q.indexOf("Level_")&&(Q=parseInt(Q.substr(6),10),!isNaN(Q))?Q:0}function X(Q){if(!Q||0===Q.length)return null;Q=(new h(Q)).toRgba();return{r:Q[0],g:Q[1],b:Q[2],a:Q[3]}}function aa(Q,Y,L,O,R,U,ba){if(null==Q)return R;if(Q=Y[Q]){const ca=Q[L];if("string"===typeof ca||"number"===typeof ca||ca instanceof Array)return U?
U.call(null,ca,ba):ca;if(null!=ca&&ca instanceof f.ArcadeExpression&&O?.geometryType)return(da,ha,ia)=>{da=k(ca,da,{$view:ia},O.geometryType,ha);null!==da&&U&&(da=U.call(null,da,ba));return null!==da?da:R}}return R}function Z(Q){return Q?Q.charAt(0).toLowerCase()+Q.substr(1):Q}function ea(Q,Y,L,O){for(const R of Y)if(R.valueExpressionInfo&&O?.geometryType){const U=L[R.primitiveName]&&L[R.primitiveName][R.propertyName];U instanceof f.ArcadeExpression&&(R.fn=(ba,ca,da)=>k(U,ba,{$view:da},O.geometryType,
ca))}return(R,U,ba)=>{for(var ca of Y)ca.fn&&(ca.value=ca.fn(R,U,ba));R=[];for(let da of Q){if(U=da?.primitiveName){ba=!1;for(const ha of Y)ha.primitiveName===U&&(ca=Z(ha.propertyName),null!=ha.value&&ha.value!==da[ca]&&(ba||(da=E.clone(da),ba=!0),da[ca]=ha.value))}R.push(da)}return R}}function T(Q,Y,L,O){const R=[];d.OverrideHelper.findApplicableOverrides(Q,Y,R);if(null==Q||0===R.length)return Q;for(const U of R)if(U.valueExpressionInfo&&O?.geometryType){const ba=L[U.primitiveName]&&L[U.primitiveName][U.propertyName];
ba instanceof f.ArcadeExpression&&(U.fn=(ca,da,ha)=>k(ba,ca,{$view:ha},O.geometryType,da))}return(U,ba,ca)=>{for(const da of R)da.fn&&(da.value=da.fn(U,ba,ca));U=E.clone(Q);ba=Q.primitiveName;for(const da of R)da.primitiveName===ba&&(ca=Z(da.propertyName),null!=da.value&&da.value!==U[ca]&&(U[ca]=da.value));return U}}function I(Q,Y,L,O){const R=[];d.OverrideHelper.findApplicableOverrides(Q,Y,R);if(null==Q||0===R.length)return Q;for(const U of R)if(U.valueExpressionInfo&&O?.geometryType){const ba=L[U.primitiveName]&&
L[U.primitiveName][U.propertyName];ba instanceof f.ArcadeExpression&&(U.fn=(ca,da,ha)=>k(ba,ca,{$view:ha},O.geometryType,da))}return(U,ba,ca)=>{for(var da of R)da.fn&&(da.value=da.fn(U,ba,ca));U=E.clone(Q);ba=Q.primitiveName;for(const ha of R)ha.primitiveName===ba&&(ca=Z(ha.propertyName),null!=ha.value&&(da=a.quantizeIfNeeded(ha.value,ha.propertyName),da!==U[ca]&&(U[ca]=da)));return U}}function M(Q,Y,L,O){for(const R of L)if(R.valueExpressionInfo&&O?.geometryType){const U=Y[R.primitiveName]&&Y[R.primitiveName][R.propertyName];
U instanceof f.ArcadeExpression&&(R.fn=(ba,ca,da)=>k(U,ba,{$view:da},O.geometryType,ca))}return(R,U,ba)=>{for(const ca of L)ca.fn&&(ca.value=ca.fn(R,U,ba));return g.numericHash(Q+d.OverrideHelper.buildOverrideKey(L)).toString()}}function S(Q,Y,L,O,R){let U=!1,ba="";for(const ca of Q)ca.primitiveName===Y&&(void 0!==ca.value?ba+=`-${ca.primitiveName}-${ca.propertyName}-${JSON.stringify(ca.value)}`:ca.valueExpressionInfo&&(U=!0));t.isSome(L)&&"function"===typeof L&&(U=!0);t.isSome(O)&&"function"===typeof O&&
(U=!0);t.isSome(R)&&"function"===typeof R&&(U=!0);return[U,ba]}const V=w.getLogger("esri.symbols.cim.cimAnalyzer");l.analyzeCIMResource=function(Q,Y){if(!Y||0===Y.length)return Q;Q=E.clone(Q);d.OverrideHelper.applyOverrides(Q,Y);return Q};l.analyzeCIMSymbol=async function(Q,Y,L,O,R){O=O??[];if(!Q)return O;let U;const ba={};if("CIMSymbolReference"===Q.type){if(U=Q.symbol,Q=Q.primitiveOverrides){var ca=[];for(const ha of Q){var da=ha.valueExpressionInfo;da&&Y?(da=f.createRendererExpression(da.expression,
Y.spatialReference,Y.fields).then(ia=>{t.isNone(ia)||y(ba,ha.primitiveName,ha.propertyName,ia)}),ca.push(da)):null!=ha.value&&y(ba,ha.primitiveName,ha.propertyName,ha.value)}0<ca.length&&await Promise.all(ca)}}else return V.error("Expect cim type to be 'CIMSymbolReference'"),O;ca=[];d.CIMSymbolHelper.fetchResources(U,L,ca);0<ca.length&&await Promise.all(ca);switch(U?.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":v(U,Q,ba,Y,O,L,!!R)}return O};Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/cim/quantizeTime":function(){define(["exports"],function(l){const h=new Set(["StartTimeOffset","Duration","RepeatDelay"]);l.quantizeIfNeeded=function(D,E){return h.has(E)?.05*Math.max(Math.round(D/.05),1):D};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b){return function(a){function e(m,k,n){var x=c.call(this,m);x._minMaxZoom=t.i1616to32(Math.round(k*w.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(n*w.MIN_MAX_ZOOM_PRECISION_FACTOR));x._cimLineLayer=m;let q=0;g.isFunction(m.width)||(q=.5*D.pt2px(m.width));x._dynamicPropertyMap.set("_halfWidth",(u,v,r)=>g.isFunction(m.width)?.5*D.pt2px(m.width(u,v,r)):q);g.isFunction(m.cap)?x._dynamicPropertyMap.set("_capType",m.cap):x._capType=m.cap;g.isFunction(m.join)?x._dynamicPropertyMap.set("_joinType",
m.join):x._joinType=m.join;const B=m.color;g.isFunction(B)?x._dynamicPropertyMap.set("_fillColor",(u,v,r)=>E.premultiplyAlphaRGBA(B(u,v,r))):x._fillColor=B&&E.premultiplyAlphaRGBA(B)||0;const y=m.miterLimit;g.isFunction(y)?x._dynamicPropertyMap.set("_miterLimitCosine",(u,v,r)=>g.getLimitCosine(y(u,v,r))):x._miterLimitCosine=g.getLimitCosine(y);h.isSome(m.effects)&&(k=m.effects,g.isFunction(k)?x._dynamicPropertyMap.set("_effects",k):x._effects=k);x._scaleFactor=m.scaleFactor||1;x._isDashed=null!=m.dashTemplate;
x.tessellationProperties._bitset=(m.colorLocked?w.BITSET_GENERIC_LOCK_COLOR:0)|(m.scaleDash?w.BITSET_LINE_SCALE_DASH:0)|(m.sampleAlphaOnly?w.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0);x._materialKey=m.materialKey;x._initializeTessellator(!0);return x}l._inherits(e,a);var c=l._createSuper(e);e.fromCIMLine=function(m,k){const [n,x]=g.getMinMaxZoom(m.scaleInfo,k);return new e(m,n,x)};e.prototype.bindFeature=function(m,k,n){const x=m.readLegacyFeature();this._dynamicPropertyMap.forEach((B,y)=>{this[y]=B(x,
k,n)});this._halfWidth*=this._scaleFactor;m=this._materialCache;var q=this._cimLineLayer.materialHash;q=q(x,k,n);q=m.get(q);m=null;q&&b.ok(q.spriteMosaicItem)&&(m=q.spriteMosaicItem);if(m){this._hasPattern=!0;const {rect:B,width:y,height:u}=m;q=B.x+w.SPRITE_PADDING;const v=B.y+w.SPRITE_PADDING,r=q+y,z=v+u;this.tessellationProperties._tl=t.i1616to32(q,v);this.tessellationProperties._br=t.i1616to32(r,z)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=
this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties.offset=0;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;q=p.LineMaterialKey.load(this._materialKey);m&&(q.sdf=m.sdf,q.pattern=!0,q.textureBinding=m.textureBinding);this._materialKey=q.data};return l._createClass(e)}(f(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k){const n=p.create(),x=t.create();return function(q){function B(u,v,r){var z=y.call(this,u);z._cimMarkerLayer=u;z._minMaxZoom=b.i1616to32(Math.round(v*d.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(r*d.MIN_MAX_ZOOM_PRECISION_FACTOR));const A=u.color;e.isFunction(A)?z._dynamicPropertyMap.set("_fillColor",(J,N,P)=>f.premultiplyAlphaRGBA(A(J,N,P))):z._fillColor=f.premultiplyAlphaRGBA(A);const C=u.outlineColor;e.isFunction(C)?z._dynamicPropertyMap.set("_outlineColor",
(J,N,P)=>f.premultiplyAlphaRGBA(C(J,N,P))):z._outlineColor=f.premultiplyAlphaRGBA(C);const F=u.size;e.isFunction(F)?z._dynamicPropertyMap.set("_size",(J,N,P)=>w.pt2px(F(J,N,P))):z._size=w.pt2px(F)||0;v=u.scaleX;e.isFunction(v)?z._dynamicPropertyMap.set("_scaleX",v):z._scaleX=v;const G=u.offsetX;e.isFunction(G)?z._dynamicPropertyMap.set("xOffset",(J,N,P)=>w.pt2px(G(J,N,P))):z.xOffset=w.pt2px(G)||0;const H=u.offsetY;e.isFunction(H)?z._dynamicPropertyMap.set("yOffset",(J,N,P)=>w.pt2px(H(J,N,P))):z.yOffset=
w.pt2px(H)||0;const K=u.outlineWidth;e.isFunction(K)?z._dynamicPropertyMap.set("_outlineWidth",(J,N,P)=>w.pt2px(K(J,N,P))):z._outlineWidth=w.pt2px(K)||0;v=u.rotation;e.isFunction(v)?z._dynamicPropertyMap.set("_angle",v):z._angle=v||0;E.isSome(u.effects)&&(v=u.effects,e.isFunction(v)?z._dynamicPropertyMap.set("_effects",v):z._effects=v);E.isSome(u.markerPlacement)&&(v=u.markerPlacement,e.isFunction(v)?z._dynamicPropertyMap.set("_markerPlacement",v):z._markerPlacement=v);z._scaleFactor=E.unwrapOr(u.scaleFactor,
1);z._bitSet=(u.alignment===g.Alignment.MAP?d.BITSET_MARKER_ALIGNMENT_MAP:d.BITSET_MARKER_ALIGNMENT_SCREEN)|(u.colorLocked?d.BITSET_GENERIC_LOCK_COLOR:0)|(u.scaleSymbolsProportionally?d.BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY:0);z._materialKey=u.materialKey;return z}l._inherits(B,q);var y=l._createSuper(B);B.fromCIMMarker=function(u,v){const [r,z]=e.getMinMaxZoom(u.scaleInfo,v);return new B(u,r,z)};B.prototype.bindFeature=function(u,v,r){const z=u.readLegacyFeature();u=u.getObjectId();this._dynamicPropertyMap.forEach((ea,
T)=>{this[T]=ea(z,v,r)});var A=this._cimMarkerLayer.materialHash;u="function"===typeof A?A(z,v,r,u):A;if((u=this._materialCache.get(u))&&k.ok(u.spriteMosaicItem)&&u.spriteMosaicItem){u=u.spriteMosaicItem;A=this._cimMarkerLayer.sizeRatio;var C=u.width/u.height*this._scaleX,F=a.MarkerMaterialKey.load(this._materialKey);F.sdf=u.sdf;F.pattern=!0;F.textureBinding=u.textureBinding;this._materialKey=F.data;var G=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,H=this._size,K=H*C,J=this.xOffset,
N=this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var P=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/w.pt2px(this._cimMarkerLayer.frameHeight):1;P*=this._outlineWidth;var W=w.pt2px(this._cimMarkerLayer.referenceSize),X=0,aa=0,Z=this._cimMarkerLayer.anchorPoint;Z&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(X=w.pt2px(Z.x)/(this._size*C),aa=w.pt2px(Z.y)/this._size):(X=Z.x,aa=Z.y));this._anchorX=X;this._anchorY=
aa;this._sizeOutlineWidth=b.i8888to32(Math.round(Math.min(Math.sqrt(128*K),255)),Math.round(Math.min(Math.sqrt(128*H),255)),Math.round(Math.min(Math.sqrt(128*P),255)),Math.round(Math.min(Math.sqrt(128*W),255)));this.angle=G;this._bitestAndDistRatio=b.i1616to32(this._bitSet,Math.round(64*A));this._computeSize(K,H,A,P,this._scaleFactor,u,F.hasSizeVV(),!0);this._applyTransformation(x,n);this.xOffset=J;this.yOffset=N}else D.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate").error(new h("mapview-cim",
"Encountered an error when binding feature"))};return l._createClass(B)}(c(m))})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../alignmentUtils ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e){return function(c){function m(n,x,q){var B=k.call(this,n);B._horizontalAlignment="center";B._verticalAlignment="middle";B._textToGlyphs=new Map;B._minMaxZoom=g.i1616to32(Math.round(x*p.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(q*p.MIN_MAX_ZOOM_PRECISION_FACTOR));x=n.scaleFactor||1;B._cimTextLayer=n;const y=n.color;d.isFunction(y)?B._dynamicPropertyMap.set("_color",(A,C,F)=>t.premultiplyAlphaRGBA(y(A,C,F))):B._color=t.premultiplyAlphaRGBA(y);const u=n.outlineColor;
d.isFunction(u)?B._dynamicPropertyMap.set("_haloColor",(A,C,F)=>t.premultiplyAlphaRGBA(u(A,C,F))):B._haloColor=t.premultiplyAlphaRGBA(u);let v;d.isFunction(n.size)||(v=Math.min(Math.round(D.pt2px(n.size*n.sizeRatio)),127));B._dynamicPropertyMap.set("_size",(A,C,F)=>d.isFunction(n.size)?Math.min(Math.round(D.pt2px(n.size(A,C,F)*n.sizeRatio)),127):v);d.isFunction(n.outlineSize)?B._dynamicPropertyMap.set("_haloSize",(A,C,F)=>Math.min(Math.floor(5*D.pt2px(n.outlineSize(A,C,F)*n.sizeRatio)),127)):B._haloSize=
Math.min(Math.floor(5*D.pt2px(n.outlineSize*n.sizeRatio)),127);let r;d.isFunction(n.offsetX)||(r=Math.round(D.pt2px(n.offsetX*n.sizeRatio)));B._dynamicPropertyMap.set("_xOffset",(A,C,F)=>d.isFunction(n.offsetX)?Math.round(D.pt2px(n.offsetX(A,C,F)*n.sizeRatio)):r);let z;d.isFunction(n.offsetY)||(z=Math.round(D.pt2px(n.offsetY*n.sizeRatio)));B._dynamicPropertyMap.set("_yOffset",(A,C,F)=>d.isFunction(n.offsetY)?Math.round(D.pt2px(n.offsetY(A,C,F)*n.sizeRatio)):z);d.isFunction(n.angle)?B._dynamicPropertyMap.set("_angle",
n.angle):B._angle=n.angle;d.isFunction(n.horizontalAlignment)?B._dynamicPropertyMap.set("_horizontalAlignment",n.horizontalAlignment):B._horizontalAlignment=n.horizontalAlignment;d.isFunction(n.verticalAlignment)?B._dynamicPropertyMap.set("_verticalAlignment",n.verticalAlignment):B._verticalAlignment=n.verticalAlignment;h.isSome(n.effects)&&(q=n.effects,d.isFunction(q)?B._dynamicPropertyMap.set("_effects",q):B._effects=q);h.isSome(n.markerPlacement)&&(q=n.markerPlacement,d.isFunction(q)?B._dynamicPropertyMap.set("_markerPlacement",
q):B._textPlacement=q);d.isFunction(n.text)?B._dynamicPropertyMap.set("_text",n.text):B._text=n.text;B._backgroundColor=n.backgroundColor&&t.premultiplyAlphaRGBA(n.backgroundColor);B._borderLineColor=n.borderLineColor&&t.premultiplyAlphaRGBA(n.borderLineColor);B._borderLineSize=n.borderLineWidth;B._scaleFactor=x;x=Math.min(Math.round(D.pt2px(n.referenceSize*n.sizeRatio)),127);B._referenceSize=Math.round(Math.sqrt(256*x));B._materialKey=n.materialKey;x=f.TextMaterialKey.load(B._materialKey);x.sdf=
!0;B._bitset=(n.alignment===E.Alignment.MAP?1:0)|(n.colorLocked?1:0)<<1;B._materialKey=x.data;B._decoration="none";B._lineHeight=1;B._lineWidth=512;B._isCIM=!0;return B}l._inherits(m,c);var k=l._createSuper(m);m.fromCIMText=function(n,x){const [q,B]=d.getMinMaxZoom(n.scaleInfo,x);return new m(n,q,B)};c=m.prototype;c.analyze=async function(n,x,q,B){var y=x.readLegacyFeature();var u=this._cimTextLayer;y="string"===typeof u.text?u.text:"function"===typeof u.text?u.text(y,q,B)??"":"";(n=await l._get(l._getPrototypeOf(m.prototype),
"analyze",this).call(this,n,x,q,B,e.codepoints(y)))&&n.glyphMosaicItems&&this._textToGlyphs.set(y,n.glyphMosaicItems);return n};c.bindFeature=function(n,x,q){const B=n.readLegacyFeature();this._dynamicPropertyMap.forEach((y,u)=>{this[u]=y(B,x,q)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/p.GLYPH_SIZE,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=w.getXAnchorDirection(h.unwrapOr(this._horizontalAlignment,"center")),this._yAlignD=
w.getYAnchorDirection(h.unwrapOr(this._verticalAlignment,"baseline")),n=this._textToGlyphs.get(this._text)??[],this.bindTextInfo(n,!1)):this._shapingInfo=null};return l._createClass(m)}(b(a))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],function(l){l.codepoints=function(h){if(null==h)return[];const D=Array(h.length);for(let E=0;E<h.length;E++)D[E]=h.charCodeAt(E);return D};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../color ../../definitions ../../GeometryUtils ../../number ../../materialKey/MaterialKey ./util ./WGLBaseFillTemplate ./WGLMeshTemplate".split(" "),
function(l,h,D,E,w,t,p,g,f,d){return function(b){function a(c,m,k,n,x,q,B,y,u,v,r,z,A,C,F,G){var H=e.call(this);H._effects=C;c=p.FillMaterialKey.load(c);m&&(c.sdf=m.sdf,c.pattern=!0,c.textureBinding=m.textureBinding);H.fillColor=k;H.tl=n;H.br=x;H.aux21=t.i1616to32(q,B);H.aux22=t.i1616to32(y,u);H.aux3=t.i8888to32(v,r,z,0);H._bitset=A;H._minMaxZoom=t.i1616to32(Math.round(F*E.MIN_MAX_ZOOM_PRECISION_FACTOR),Math.round(G*E.MIN_MAX_ZOOM_PRECISION_FACTOR));H._materialKey=c.data;return H}l._inherits(a,b);
var e=l._createSuper(a);a.fromCIMFill=function(c,m,k){var n=c.color;n=n&&D.premultiplyAlphaRGBA(n)||0;const x=c.materialKey,[q,B]=g.getMinMaxZoom(c.scaleInfo,k);k=(c.colorLocked?E.BITSET_GENERIC_LOCK_COLOR:0)|(c.applyRandomOffset?E.BITSET_FILL_RANDOM_PATTERN_OFFSET:0)|(c.sampleAlphaOnly?E.BITSET_GENERIC_CONSIDER_ALPHA_ONLY:0)|(c.hasUnresolvedReplacementColor?E.BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR:0);if(!m)return new a(x,null,n,0,0,0,0,0,0,0,0,0,k,c.effects,q,B);const {rect:y,width:u,height:v}=
m;var r=c.scaleX||1,z=y.x+E.SPRITE_PADDING;const A=y.y+E.SPRITE_PADDING;var C=z+u;const F=A+v;var G=h.pt2px(c.height);r*=G;"CIMHatchFill"===c.cim.type&&(r*=u/v);G=Math.round(G);0>=G&&(G=F-A);r=Math.round(r);0>=r&&(r=C-z);const H=h.pt2px(c.offsetX||0),K=h.pt2px(-c.offsetY||0);z=t.i1616to32(z,A);C=t.i1616to32(C,F);return new a(x,m,n,z,C,r,G,H,K,128,128,w.degToByte(c.angle),k,c.effects,q,B)};a.fromSimpleFill=function(c,m,k=!1){var {color:n}=c;n=n&&"esriSFSNull"!==c.style&&D.premultiplyAlphaRGBAArray(n)||
0;k=k?E.BITSET_GENERIC_LOCK_COLOR:0;const x=c.materialKey;if(m){const {rect:y,width:u,height:v,pixelRatio:r}=m;var q=y.x+E.SPRITE_PADDING;const z=y.y+E.SPRITE_PADDING;var B=q+u;const A=z+v;q=t.i1616to32(q,z);B=t.i1616to32(B,A);m=new a(x,m,n,q,B,u/r,v/r,0,0,128,128,0,k,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM)}else m=new a(x,null,n,0,0,0,0,0,0,0,0,0,k,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM);m._maybeAddLineTemplate(c);return m};a.fromPictureFill=function(c,m,k=!1){const n=E.PICTURE_FILL_COLOR,
{rect:x,width:q,height:B}=m;var y=x.x+E.SPRITE_PADDING,u=x.y+E.SPRITE_PADDING,v=y+q,r=u+B;y=t.i1616to32(y,u);v=t.i1616to32(v,r);r=Math.round(h.pt2px(c.width));u=Math.round(h.pt2px(c.height));const z=h.pt2px(c.xoffset),A=h.pt2px(-c.yoffset);m=new a(c.materialKey,m,n,y,v,r,u,z,A,128*c.xscale,128*c.yscale,0,k?E.BITSET_GENERIC_LOCK_COLOR:0,null,g.DEFAULT_MIN_ZOOM,g.DEFAULT_MAX_ZOOM);m._maybeAddLineTemplate(c);return m};return l._createClass(a)}(f(d))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports",
"../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/promiseUtils"],function(l,h,D){let E=function(){function w(){this._resolver=null}var t=w.prototype;t.isHeld=function(){return!!this._resolver};t.acquire=async function(){this._resolver?(await this._resolver.promise,await this.acquire()):this._resolver=D.createResolver()};t.release=function(){const p=this._resolver;this._resolver=null;p?.resolve()};return h._createClass(w)}();l.Lock=E;l.withLock=async function(w,t,p){try{await w.acquire(),
await t(p),w.release()}catch(g){throw w.release(),g;}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/cimSymbolUtils":function(){define(["exports","../../../../symbols/cim/cimAnalyzer","../../../../symbols/cim/ExpandedCIM","./webStyleUtils"],function(l,h,D,E){const w=async(t,p,g)=>new D.ExpandedCIM(await h.analyzeCIMSymbol(t.data,p,g),t.data,t.rendererKey,t.maxVVSize);l.cimLayerToRasterizationInfo=function(t){if(!t)return null;const {avoidSDFRasterization:p,
type:g,cim:f,url:d,materialHash:b}=t,a={cim:f,type:g,mosaicHash:b,url:d,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:p};switch(g){case "marker":a.size=t.size;a.path=t.path;a.animatedSymbolProperties=t.animatedSymbolProperties;break;case "line":a.dashTemplate=t.dashTemplate;break;case "text":a.text=t.text,a.fontName=t.fontName}return a};l.expandSymbol=async function(t,p,g,f){return t?"cim"===t.type?w(t,p,g):"web-style"===t.type?(t=
{type:"cim",data:await E.fetchCIMSymbolReference(t,null,f)??void 0,rendererKey:t.rendererKey,maxVVSize:t.maxVVSize},w(t,p,g)):t:null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(l,h,D,E){const w={marker:D.WGLGeometryType.MARKER,fill:D.WGLGeometryType.FILL,line:D.WGLGeometryType.LINE,
text:D.WGLGeometryType.TEXT};let t=function(){function p(g,f,d,b){const a={minScale:f?.minScale,maxScale:f?.maxScale};var e=a.minScale||a.maxScale?a.minScale+"-"+a.maxScale:"";this.layers=g;this.data=f;this.hash=this._createHash()+e;this.rendererKey=d;f={isOutline:!1,placement:null,symbologyType:D.WGLSymbologyType.DEFAULT,vvFlags:d};for(const c of g)g=w[c.type],f.isOutline="line"===c.type&&c.isOutline,c.materialKey=E.createMaterialKey(g,f),c.maxVVSize=b,c.scaleInfo=a,c.templateHash+=e}p.prototype._createHash=
function(){let g="";for(const f of this.layers)g+=f.templateHash;return g};h._createClass(p,[{key:"type",get:function(){return"expanded-cim"}}]);return p}();l.ExpandedCIM=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/webStyleUtils":function(){define("exports ../../../../core/devEnvironmentUtils ../../../../core/Error ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../portal/Portal ../../../../chunks/persistableUrlUtils ../../../../symbols/support/styleUtils".split(" "),
function(l,h,D,E,w,t,p,g,f){async function d(a,e){a=f.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,a.name);try{const c=await f.requestJSON(a,e);return f.makeCIMSymbolRef(c.data)}catch(c){return w.throwIfAborted(c),null}}async function b(a,e,c,m){var k=a.data;a={portal:c&&E.isSome(c.portal)?c.portal:p.getDefault(),url:t.urlToObject(a.baseUrl),origin:"portal-item"};k=k.items.find(n=>n.name===e);if(!k)throw new D("symbolstyleutils:symbol-name-not-found",`The symbol name '${e}' could not be found`,{symbolName:e});
k=g.fromJSON(f.symbolUrlFromStyleItem(k,"cimRef"),a);h.isDevEnvironment()&&(k=h.adjustStaticAGOUrl(k));try{const n=await f.requestJSON(k,m);return f.makeCIMSymbolRef(n.data)}catch(n){return w.throwIfAborted(n),null}}l.fetchCIMSymbolReference=async function(a,e,c){if(!a.name)throw new D("style-symbol-reference-name-missing","Missing name in style symbol reference");if(a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName)return d(a,c);try{const m=await f.fetchStyle(a,e,c);return b(m,a.name,e,c)}catch(m){return w.throwIfAborted(m),
null}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/Logger ../../../../../core/LRUCache ../../../../../core/maybe ../../../../../support/arcadeOnDemand ../../../arcade/callExpressionWithFeature ../../../layers/support/cimSymbolUtils".split(" "),function(l,h,D,E,w,t,p,g,f,d){async function b(y,u,v,r){switch(y.type){case "simple":case "heatmap":return m.fromBasicRenderer(y,
u,v,r);case "map":return x.fromUVRenderer(y,u,v,r);case "interval":return n.fromCBRenderer(y,u,v,r);case "dictionary":return B.fromDictionaryRenderer(y,u,v,r);case "pie-chart":return k.fromPieChartRenderer(y,u,v,r);case "subtype":return k.fromSubtypes(y,u,v,r)}}async function a(y,u){const v=y||1;if("number"===typeof v)return(z,A,C)=>v;const r=await g.createRendererExpression(v,u.spatialReference,u.fields);return(z,A,C)=>f(r,z,{$view:C},u.geometryType,A)||1}async function e(){q||(q=new Promise((y,
u)=>l(["../../../layers/features/createSymbolSchema"],y,u)));return q}const c=w.getLogger("esri/views/2d/engine/webgl/util/Matcher");let m=function(){function y(){this.type="feature";this._defaultResult=null}y.fromBasicRenderer=async function(v,r,z,A){const C=new y;v.symbol&&(v=await d.expandSymbol(v.symbol,z,A),r=r.createTemplateGroup(v,null),C.setDefault(r));return C};y.fromPieChartRenderer=async function(v,r,z,A){const C=new y;if(v.markerSymbol){const F=await d.expandSymbol(v.markerSymbol,z,A);
let G;v.fillSymbol&&(G=await d.expandSymbol(v.fillSymbol,z,A));v=r.createTemplateGroup(F,G);C.setDefault(v)}return C};var u=y.prototype;u.size=function(){return 1};u.getDefault=function(){return this._defaultResult};u.setDefault=function(v){this._defaultResult=v};u.match=function(v,r,z,A,C){return this.getDefault()};u.analyze=async function(v,r,z,A,C,F){return null};return D._createClass(y)}(),k=function(y){function u(r,z){var A=v.call(this);A._subMatchers=r;A._subtypeField=z;return A}D._inherits(u,
y);var v=D._createSuper(u);u.fromSubtypes=async function(r,z,A,C){const F=new Map,G=[];for(const H in r.renderers){const K=parseInt(H,10),J=b(r.renderers[H],z,A,C).then(N=>F.set(K,N));G.push(J)}await Promise.all(G);return new u(F,r.subtypeField)};u.prototype.match=function(r,z,A,C,F){var G=z.readAttribute(this._subtypeField);return(G=this._subMatchers.get(G))?G.match(r,z,A,C,F):null};return D._createClass(u)}(m),n=function(y){function u(r,z,A,C){var F=v.call(this);F.type="interval";F._intervals=[];
F._isMaxInclusive=z;F._fieldIndex=C;F._field=r;F._normalizationInfo=A;return F}D._inherits(u,y);var v=D._createSuper(u);u.fromCBRenderer=async function(r,z,A,C){const {isMaxInclusive:F,normalizationField:G,normalizationTotal:H,normalizationType:K}=r,J=new u(r.field,F,{normalizationField:G,normalizationTotal:H,normalizationType:K},r.fieldIndex),N=await d.expandSymbol(r.backgroundFillSymbol,A,C);await Promise.all(r.intervals.map(async P=>{var W=await d.expandSymbol(P.symbol,A,C);W=await z.createTemplateGroup(W,
N);J.add({min:P.min,max:P.max},W)}));if(r=await d.expandSymbol(r.defaultSymbol,A,C))r=await z.createTemplateGroup(r,N),J.setDefault(r);return J};y=u.prototype;y.add=function(r,z){this._intervals.push({interval:r,result:z});this._intervals.sort((A,C)=>A.interval.min-C.interval.min)};y.size=function(){return D._get(D._getPrototypeOf(u.prototype),"size",this).call(this)+this._intervals.length};y.match=function(r,z,A,C,F){if(null==this._fieldIndex&&!this._field)return this.getDefault();r=null!=this._fieldIndex?
z.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(z);if(null===r||void 0===r||isNaN(r)||Infinity===r||-Infinity===r)return this.getDefault();for(z=0;z<this._intervals.length;z++){const {interval:G,result:H}=this._intervals[z];A=this._isMaxInclusive?r<=G.max:r<G.max;if(r>=G.min&&A)return H}return this.getDefault()};y._needsNormalization=function(){const r=this._normalizationInfo;return r&&(r.normalizationField||r.normalizationTotal||r.normalizationType)};y._getValueFromField=function(r){const z=
r.readAttribute(this._field);if(!this._needsNormalization()||null==z)return z;const {normalizationField:A,normalizationTotal:C,normalizationType:F}=this._normalizationInfo;r=r.readAttribute(A)??1;if(F)switch(F){case "esriNormalizeByField":return(r||void 0)&&z/r;case "esriNormalizeByLog":return Math.log(z)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return z/C*100;default:c.error(`Found unknown normalization type: ${F}`)}else c.error("Normalization is required, but no type was set!")};return D._createClass(u)}(m),
x=function(y){function u(r,z,A){var C=v.call(this);C.type="map";C._nullResult=null;C._resultsMap=new Map;C._fields=[];C._fieldsIndex=A;C._fields=r;C._seperator=z||"";return C}D._inherits(u,y);var v=D._createSuper(u);u.fromUVRenderer=async function(r,z,A,C){const F=r.fieldDelimiter,G=[r.field];r.field2&&G.push(r.field2);r.field3&&G.push(r.field3);const H=await d.expandSymbol(r.backgroundFillSymbol,A,C),K=new u(G,F,r.fieldIndex);await Promise.all(r.map.map(async(J,N)=>{const P=await d.expandSymbol(J.symbol,
A,C);N=await z.createTemplateGroup(P,H,N+1);"\x3cNull\x3e"===J.value?K.setNullResult(N):K.add(J.value,N)}));if(r=await d.expandSymbol(r.defaultSymbol,A,C))r=await z.createTemplateGroup(r,H,Number.MAX_SAFE_INTEGER),K.setDefault(r);return K};y=u.prototype;y.setNullResult=function(r){this._nullResult=r};y.add=function(r,z){this._resultsMap.set(r.toString(),z)};y.size=function(){return D._get(D._getPrototypeOf(u.prototype),"size",this).call(this)+this._resultsMap.size};y.match=function(r,z,A,C,F){if(null==
this._fieldsIndex&&!this._fields)return this.getDefault();r=null!=this._fieldsIndex?z.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(z);if(null!==this._nullResult&&(null==r||""===r||"\x3cNull\x3e"===r))return this._nullResult;if(null==r)return this.getDefault();r=r.toString();return this._resultsMap.has(r)?this._resultsMap.get(r):this.getDefault()};y._getValueFromFields=function(r){const z=[];for(const A of this._fields){const C=r.readAttribute(A);null==C||""===C?z.push("\x3cNull\x3e"):
z.push(C)}return z.join(this._seperator)};return D._createClass(u)}(m),q,B=function(y){function u(r,z,A,C,F,G){var H=v.call(this);H.type="dictionary";H._groupIdCache=new t(100);H._loader=r;H._fieldMap=r.fieldMap;H._symbolFields=r.getSymbolFields();H._templates=z;H._info=A;H._scaleFn=C;H._schemaUtilsModule=F;H._symbolOptions=G;return H}D._inherits(u,y);var v=D._createSuper(u);u.fromDictionaryRenderer=async function(r,z,A,C){const [{DictionaryLoader:F},G]=await Promise.all([new Promise((K,J)=>l(["../../../../../renderers/support/DictionaryLoader"],
K,J)),e()]);C=new F(r.url,r.config,r.fieldMap);await C.fetchResources({spatialReference:A.spatialReference,fields:A.fields});const H=await a(r.scaleExpression,A);return new u(C,z,A,H,G,r.symbolOptions)};y=u.prototype;y._analyzeFeature=async function(r,z,A,C,F){r=r.readLegacyFeature();const G=this._scaleFn(r,A,C);A=this._attributeHash(r)+"-"+G;const H=this._groupIdCache.get(A);if(H)return H;C=await this._loader.getSymbolAsync(r,{...C,spatialReference:this._info.spatialReference,abortOptions:F,fields:this._info.fields});
C=this._schemaUtilsModule.createSymbolSchema(C,this._symbolOptions);z=d.expandSymbol(C,this._info,z,F).then(K=>{if("expanded-cim"!==K?.type)return c.error(new E("mapview-bad-type",`Found unexpected type ${K?.type} in dictionary response`)),null;K.hash+="-"+G;for(const J of K.layers)J.scaleFactor=G,J.templateHash+="-"+G;return this._templates.createTemplateGroup(K,null)});this._groupIdCache.put(A,z,1);return z};y.analyze=async function(r,z,A,C,F,G){r=z.getCursor();for(z=[];r.next();)z.push(this._analyzeFeature(r,
A,C,F,G));return Promise.all(z).then(H=>H.filter(p.isSome))};y.match=function(r,z,A,C,F){return null};y._attributeHash=function(r){let z="";for(const A of this._symbolFields){const C=this._fieldMap?.[A];C&&(z+=r.attributes[C]+"-")}return z};return D._createClass(u)}(m);h.DictionaryMatcher=B;h.FeatureMatcher=m;h.IntervalMatcher=n;h.MapMatcher=x;h.SubtypeMatcher=k;h.createMatcher=b;Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/screenUtils ../../../../core/sql ../../../../core/accessorSupport/diffUtils ../../../../layers/support/labelingInfo ../../engine/webgl/enums ../../engine/webgl/Utils ../../engine/webgl/techniques/utils ../../engine/webgl/util/vvFlagUtils ./createSymbolSchema ./support/pixelBuffering ./support/rendererUtils ../support/clusterUtils ../support/util".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x){function q(L,O){let R=0,U=0,ba=d.WGLSymbologyType.DEFAULT;if(w.isSome(L)){U=m.getPtMaxVVSize(L,O);"visualVariables"in L&&(R=e.getVVFlags(L.visualVariables||[]),"dot-density"===L.type&&(ba=d.WGLSymbologyType.DOT_DENSITY));"heatmap"===L.type&&(ba=d.WGLSymbologyType.HEATMAP);if("dictionary"===L.type)return{maxVVSize:U,vvFlags:R,symbologyType:d.WGLSymbologyType.DEFAULT};if("pie-chart"===L.type)return{maxVVSize:U,vvFlags:R,symbologyType:d.WGLSymbologyType.PIE_CHART};
if(ba!==d.WGLSymbologyType.DOT_DENSITY&&ba!==d.WGLSymbologyType.HEATMAP){var ca=L.getSymbols();"backgroundFillSymbol"in L&&L.backgroundFillSymbol&&ca.push(L.backgroundFillSymbol);O=L=!0;for(const ha of ca)if("cim"===ha.type&&(O=!1),"simple-fill"===ha.type||"picture-fill"===ha.type){ca=(ca=ha.outline)&&"none"!==ca.style&&"solid"!==ca.style;var da="simple-fill"===ha.type&&"none"!==ha.style&&"solid"!==ha.style;da="picture-fill"===ha.type||da||ca;ca&&(L=!1);da&&(O=!1)}L?ba=O?d.WGLSymbologyType.OUTLINE_FILL_SIMPLE:
d.WGLSymbologyType.OUTLINE_FILL:O&&(ba=d.WGLSymbologyType.SIMPLE)}}return{vvFlags:R,maxVVSize:U,symbologyType:ba}}function B(L,O=!1){try{const U=H(L,O);var R="heatmap"===L.renderer?.type&&"raster"===k.getSupportedHeatmapRenderer()?{type:"heatmap"}:{type:"symbol"};const ba={};U.map(da=>y(ba,L,da));const ca=w.isSome(L.subtypeCode)?`${L.subtypeField} = ${L.subtypeCode}`:null;return{source:{definitionExpression:w.unwrap(p.sqlAnd(L.definitionExpression,ca)),fields:L.fields.map(da=>da.toJSON()),gdbVersion:L.gdbVersion,
historicMoment:L.historicMoment?.getTime(),outFields:L.availableFields,pixelBuffer:L.pixelBuffer,spatialReference:L.spatialReference.toJSON(),timeExtent:L.timeExtent?.toJSON(),customParameters:L.customParameters},attributes:{fields:{},indexCount:0},processors:U,tileRenderer:R,targets:ba}}catch(U){if("ValidationError"===U.fieldName)return Q.error(U),null;throw U;}}function y(L,O,R){switch(R.target){case "feature":r(L,v(O),R);break;case "aggregate":if("featureReduction"in O){var U=O.featureReduction;
switch(U?.type){case "selection":throw new h("ValidationError","Mapview does not support `selection` reduction type",U);case "binning":r(L,v(O),R);A(L,U,O.fields.map(ba=>ba.toJSON()),R);break;case "cluster":r(L,v(O),R),C(L,U,O.fields.map(ba=>ba.toJSON()),R)}}}}function u(L,O){for(const U in O){const ba=O[U];if(ba.target===L.name){var R=L.attributes[U];R?.context?(R=R.context,R.mesh=R.mesh||ba.context?.mesh,R.storage=R.storage||ba.context?.storage):L.attributes[U]=ba}}return L}function v(L){return[w.unwrap(L.filter)?.toJSON()??
null,w.unwrap(w.unwrap(L.featureEffect)?.filter)?.toJSON()??null]}function r(L,O,R){L.feature||(L.feature={name:"feature",input:"source",filters:O,attributes:{}});u(L.feature,R.attributes.fields);return L}function z(L,O){const {onStatisticExpression:R,onStatisticField:U,statisticType:ba}=L;switch(ba){case "min":case "max":case "avg":case "avg_angle":case "sum":case "count":return"esriFieldTypeDouble";case "mode":if(R)return{returnType:O}=R,O?"string"===O?"esriFieldTypeString":"esriFieldTypeDouble":
(Q.error(new h("ValidationError","Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",L)),"esriFieldTypeString");O=O.find(ca=>ca.name===U);return O?O.type:(Q.error(new h("ValidationError","Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",L)),"esriFieldTypeString")}}function A(L,O,R,U){L.aggregate||(L.aggregate={name:"aggregate",type:"bin",filters:null,input:"feature",params:{fixedBinLevel:O.fixedBinLevel,fields:(O.fields??
[]).map(ba=>({...ba.toJSON(),type:z(ba,R)}))},attributes:{}});u(L.aggregate,U.attributes.fields);return L}function C(L,O,R,U){L.aggregate||(L.aggregate={name:"aggregate",type:"cluster",input:"feature",filters:null,attributes:{},params:{clusterRadius:t.pt2px(O.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(t.pt2px(O.clusterMaxSize)/64),fields:(O.fields??[])?.map(ba=>({...ba.toJSON(),type:z(ba,R)}))}});u(L.aggregate,U.attributes.fields);return L}function F(L,O){return O.field?G(L,{...O,type:"field",
field:O.field}):O.valueExpression?G(L,{...O,type:"expression",valueExpression:O.valueExpression}):{field:void 0,fieldIndex:void 0}}function G(L,O){switch(O.type){case "expression":var R=O.valueExpression;if(!L.fields[R]){var U=L.indexCount++;L.fields[R]={...O,name:R,fieldIndex:U}}return{fieldIndex:L.fields[R].fieldIndex};case "label-expression":return R=JSON.stringify(O.label),L.fields[R]||(U=L.indexCount++,L.fields[R]={...O,name:R,fieldIndex:U}),{fieldIndex:L.fields[R].fieldIndex};case "field":R=
O.field;if("aggregate"===O.target&&L.fields[R])return{field:R};L.fields[R]={...O,name:R};return{field:R};case "statistic":return L.fields[O.name]={...O},{field:O.name}}}function H(L,O=!1){const R=[];let U=0;R.push(N(L,U++,O));return R}function K(L,O,R,U,ba,ca=!1){L=G(L,{type:"label-expression",target:R,context:{mesh:!0},resultType:"string",label:{labelExpression:O.labelExpression,labelExpressionInfo:O.labelExpressionInfo?{expression:O.labelExpressionInfo.expression}:null,symbol:!!O.symbol,where:O.where}});
({fieldIndex:L}=L);return{...c.createSymbolSchema(O,ba,ca),fieldIndex:L,target:R,index:U}}function J(L,O,R){const U="featureReduction"in O&&O.featureReduction;if(!U)return{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};const ba=[];let ca=null,da=x.toJSONGeometryType(O.geometryType),ha=[];var ia=null;if(U)switch(U.type){case "selection":return Q.error(new h("ValidationError","Mapview does not support `selection` reduction type",U)),{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};
case "cluster":case "binning":ba.push(...(U.fields??[])),"cluster"===U.type?da="esriGeometryPoint":"binning"===U.type&&(da="esriGeometryPolygon"),U.renderer&&!U.renderer.authoringInfo?.isAutoGenerated?("cluster"===U.type?{renderer:ia}=n.injectDynamicLevelDependentSizeVisualVariable(U.renderer,U,null):ia=U.renderer,O=q(U.renderer,U),ca=ea(L,"aggregate",U.renderer,O,R),ha=U&&U.labelsVisible&&U.labelingInfo||[]):"cluster"===U.type&&(ia=n.createClusterRenderer(ba,O.renderer,U,null,!0),U.symbol&&(O=q(ia,
U),ca={type:"simple",symbol:c.createSymbolSchema(U.symbol,O,R),symbologyType:O.symbologyType}),ha=U&&U.labelsVisible&&U.labelingInfo||[])}W(L,ba);return{labels:f.validateLabelingInfo(ha,"binning"===U.type?"esriGeometryPolygon":da),matcher:ca,fields:ba,rendererOverride:ia}}function N(L,O,R=!1){const U={indexCount:0,fields:{}};var ba="featureReduction"in L?L.featureReduction??void 0:void 0;O=ba?"aggregate":"feature";if("sublayers"in L){var ca={type:"subtype",subtypeField:L.subtypeField,renderers:{},
symbologyType:d.WGLSymbologyType.DEFAULT},da={type:"subtype",mapping:{},target:"feature",subtypeField:L.subtypeField},ha={type:"subtype",classes:{}},ia={type:"symbol",target:"feature",aggregateFields:[],attributes:U,storage:da,mesh:{matcher:ca,aggregateMatcher:null,labels:ha,sortKey:null}};ba=new Set;let ka=0;for(const {renderer:la,subtypeCode:ma,labelingInfo:na,labelsVisible:oa}of L.sublayers){L=0;"visualVariables"in la&&la.visualVariables&&(la.visualVariables.some(ta=>"rotation"!==ta.type)&&Q.warnOnce("SubtypeGroupLayer currently only supports rotation visualVariables. All other visualVariable types will be ignored."),
L=e.getVVFlags(la.visualVariables.filter(ta=>"size"!==ta.type)));const ra={symbologyType:d.WGLSymbologyType.DEFAULT,vvFlags:L,maxVVSize:0};L=ea(U,O,la,ra,R);const pa=X(U,O,la),sa=oa&&na;if("dictionary"===L.type)throw new h("ValidationError","Dictionary renderer is not supported in subtype layers");if("subtype"===L.type)throw new h("ValidationError","Nested subtype renderers is not supported");if(w.isSome(pa)&&"subtype"===pa.type)throw new h("ValidationError","Nested subtype storage is not supported");
if(w.isSome(pa)&&w.isSome(pa.attributeMapping))throw new h("ValidationError","Non-visual-variable attributes are not supported in subtype layers");if("heatmap"===L.type)throw new h("ValidationError","Heatmaps are not supported in subtype layers");if("pie-chart"===L.type)throw new h("ValidationError","Pie-charts are not supported in subtype layers");if(ba.has(ma))throw new h("ValidationError","Subtype codes for sublayers must be unique");ba.add(ma);ca.renderers[ma]=L;da.mapping[ma]=pa;sa&&(ha.classes[ma]=
sa.map(ta=>K(U,ta,"feature",ka++,ra,R)))}return ia}if("heatmap"===L.renderer?.type&&"raster"===k.getSupportedHeatmapRenderer()){const {radius:ka,fieldOffset:la,field:ma}=L.renderer;return{type:"heatmap",aggregateFields:[],attributes:U,target:O,storage:null,mesh:{radius:ka,fieldOffset:la,field:F(U,{target:O,field:ma,resultType:"numeric"}).field}}}ca=J(U,L,R);ha=x.toJSONGeometryType(L.geometryType);ia=ca.rendererOverride??L.renderer;const ja=q(ia,ba);da=ea(U,O,ia,ja,R);ia=X(U,O,ia);ba=P(U,L.orderBy,
L.renderer,ba);let fa=0;L=[...f.validateLabelingInfo(L.labelsVisible&&L.labelingInfo||[],ha).map(ka=>K(U,ka,"feature",fa++,ja,R)),...ca.labels.map(ka=>K(U,ka,"aggregate",fa++,ja,R))];return{type:"symbol",target:O,attributes:U,aggregateFields:ca.fields,storage:ia,mesh:{matcher:da,labels:{type:"simple",classes:L},aggregateMatcher:ca.matcher,sortKey:ba}}}function P(L,O,R,U){if(w.isSome(U))return null;if(w.isSome(O)&&O.length){1<O.length&&Q.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${O.length}. All but the first will be discarded`);
O=O[0];R="ascending"===O.order?"asc":"desc";if(O.field)return{field:O.field,order:R};if(O.valueExpression)return{fieldIndex:G(L,{type:"expression",target:"feature",valueExpression:O.valueExpression,resultType:"numeric"}).fieldIndex,order:R};Q.error(new h("ValidationError","Expected to find a field or valueExpression for OrderByInfo",O));return null}return w.isSome(R)&&"unique-value"===R.type&&R.orderByClassesEnabled?{byRenderer:!0,order:"asc"}:null}function W(L,O){const R={mesh:!0,storage:!0};for(const U of O){const {name:ba,
onStatisticField:ca,onStatisticExpression:da,statisticType:ha}=U;let ia=O=void 0;da?ia=G(L,{type:"expression",target:"feature",valueExpression:da.expression,resultType:"numeric"}).fieldIndex:O=G(L,{type:"field",target:"feature",field:ca,resultType:"numeric"}).field;G(L,{type:"statistic",target:"aggregate",name:ba,context:R,inField:O,inFieldIndex:ia,statisticType:ha})}}function X(L,O,R){let U;switch(R.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":U={visualVariables:!0,
attributes:null};break;default:U=a.getTechniqueFromRenderer(R).getStorageSpec(R)}return aa(L,O,U,R)}function aa(L,O,R,U){if(w.isNone(R))return null;const {visualVariables:ba,attributes:ca}=R;R=null;ba&&"visualVariables"in U&&(R=Z(L,O,U.visualVariables));const da=w.isSome(R)?4:0;U=null;w.isSome(ca)&&(U=ca.map((ha,ia)=>{const {field:ja,fieldIndex:fa}=F(L,{valueExpression:ha.valueExpression,field:ha.field,resultType:"numeric",target:O});return{binding:ia+da,field:ja,fieldIndex:fa}}));return{type:"simple",
target:O,attributeMapping:U,vvMapping:R}}function Z(L,O,R){if(!R||!R.length)return[];const U={storage:!0};return k.simplifyVisualVariables(R).map(ba=>{const ca=b.getVVType(ba.type),{field:da,fieldIndex:ha}=F(L,{target:O,valueExpression:ba.valueExpression,field:ba.field,context:U,resultType:"numeric"});switch(ba.type){case "size":return"$view.scale"===ba.valueExpression?null:{type:"size",binding:ca,field:da,fieldIndex:ha,normalizationField:F(L,{target:O,field:ba.normalizationField,context:U,resultType:"numeric"}).field,
valueRepresentation:ba.valueRepresentation??null};case "color":return{type:"color",binding:ca,field:da,fieldIndex:ha,normalizationField:F(L,{target:O,field:ba.normalizationField,context:U,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:ca,field:da,fieldIndex:ha,normalizationField:F(L,{target:O,field:ba.normalizationField,context:U,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:ca,field:da,fieldIndex:ha}}}).filter(w.isSome)}function ea(L,O,R,
U,ba=!1){L=w.unwrapOr(L,{indexCount:0,fields:{}});switch(R.type){case "simple":case "dot-density":return T(L,R,U,ba);case "class-breaks":return M(L,O,R,U,ba);case "unique-value":return S(L,O,R,U,ba);case "dictionary":return{type:"dictionary",config:R.config,fieldMap:R.fieldMap,scaleExpression:R.scaleExpression,url:R.url,symbolOptions:U,symbologyType:U.symbologyType};case "heatmap":return V(L,R,U,ba);case "pie-chart":return I(L,R,U,ba)}}function T(L,O,R,U=!1){L=O.getSymbols();return{type:"simple",
symbol:c.createSymbolSchema(L.length?L[0]:null,R,U),symbologyType:R.symbologyType}}function I(L,O,R,U=!1){L=O.getSymbols();O=1<L.length?L[1]:null;return{type:"pie-chart",markerSymbol:c.createSymbolSchema(L[0],R,U),fillSymbol:c.createSymbolSchema(O,R,U),symbologyType:R.symbologyType}}function M(L,O,R,U,ba=!1){const ca=R.backgroundFillSymbol,{field:da,fieldIndex:ha}=F(L,{target:O,field:R.field,valueExpression:R.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});O=R.normalizationType;
O="log"===O?"esriNormalizeByLog":"percent-of-total"===O?"esriNormalizeByPercentOfTotal":"field"===O?"esriNormalizeByField":null;const ia=R.classBreakInfos.map(ja=>({symbol:c.createSymbolSchema(ja.symbol,U,ba),min:ja.minValue,max:ja.maxValue})).sort((ja,fa)=>ja.min-fa.min);return{type:"interval",attributes:L.fields,field:da,fieldIndex:ha,backgroundFillSymbol:c.createSymbolSchema(ca,U,ba),defaultSymbol:c.createSymbolSchema(R.defaultSymbol,U,ba),intervals:ia,normalizationField:R.normalizationField,normalizationTotal:R.normalizationTotal,
normalizationType:O,isMaxInclusive:R.isMaxInclusive,symbologyType:U.symbologyType}}function S(L,O,R,U,ba=!1){const ca=[],da=R.backgroundFillSymbol;O={target:O,context:{mesh:!0},resultType:"string"};if(R.field&&"string"!==typeof R.field)throw new h("ValidationError","Expected renderer.field to be a string",R);const {field:ha,fieldIndex:ia}=F(L,{...O,field:R.field,valueExpression:R.valueExpression});for(const ja of R.uniqueValueInfos??[])ca.push({value:""+ja.value,symbol:c.createSymbolSchema(ja.symbol,
U,ba)});return{type:"map",attributes:L.fields,field:ha,fieldIndex:ia,field2:F(L,{...O,field:R.field2}).field,field3:F(L,{...O,field:R.field3}).field,fieldDelimiter:R.fieldDelimiter??void 0,backgroundFillSymbol:c.createSymbolSchema(da,U),defaultSymbol:c.createSymbolSchema(R.defaultSymbol,U),map:ca,symbologyType:U.symbologyType}}function V(L,O,R,U=!1){L=O.getSymbols();return{type:"heatmap",symbol:c.createSymbolSchema(L.length?L[0]:null,R,U),symbologyType:R.symbologyType}}const Q=E.getLogger("esri.views.2d.layers.features.schemaUtils");
let Y=null;l.createSymbolSchema=c.createSymbolSchema;l.addAggregateFields=W;l.createMatcherSchema=ea;l.createRendererAttributeSchema=F;l.createSchema=function(L){if(D("esri-2d-update-debug")){const O=B(L,!0);console.debug("Created new schema",O);console.debug("Schema diff",g.diff(Y,O));Y=O}return B(L)};l.createSymbolSchemaOptions=q;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],
function(l,h,D){l.getVVFlags=function(E){if(!E)return h.WGLVVFlag.NONE;let w=0;for(const t of E)"size"===t.type?(E=D.getTypeOfSizeVisualVariable(t),w|=E,"outline"===t.target&&(w|=E<<4)):"color"===t.type?w|=h.WGLVVFlag.COLOR:"opacity"===t.type?w|=h.WGLVVFlag.OPACITY:"rotation"===t.type&&(w|=h.WGLVVFlag.ROTATION);return w};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Error","../../../../core/Logger",
"./enums","./Utils"],function(l,h,D,E,w){l.getTypeOfSizeVisualVariable=function(t){if(w.isNumber(t.minDataValue)&&w.isNumber(t.maxDataValue)&&null!=t.minSize&&null!=t.maxSize)return E.WGLVVFlag.SIZE_MINMAX_VALUE;if((t.expression&&"view.scale"===t.expression||t.valueExpression&&"$view.scale"===t.valueExpression)&&Array.isArray(t.stops))return E.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=t.field||t.expression&&"view.scale"!==t.expression||t.valueExpression&&"$view.scale"!==t.valueExpression)&&(Array.isArray(t.stops)||
"levels"in t&&t.levels))return E.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=t.field||t.expression&&"view.scale"!==t.expression||t.valueExpression&&"$view.scale"!==t.valueExpression)&&null!=t.valueUnit)return E.WGLVVFlag.SIZE_UNIT_VALUE;D.getLogger("esri.views.2d.engine.webgl").error(new h("mapview-bad-type","Found invalid size VisualVariable",t));return E.WGLVVFlag.NONE};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/createSymbolSchema":function(){define(["exports",
"../../engine/webgl/enums","../../engine/webgl/materialKey/MaterialKey"],function(l,h,D){function E(p){switch(p.type){case "line-marker":return{type:"line-marker",color:p.color?.toJSON(),placement:p.placement,style:p.style};default:return p.constructor.fromJSON(p.toJSON()).toJSON()}}function w(p,g,f){var d=D.createMaterialKey(h.WGLGeometryType.FILL,g);d=f?D.hydrateMaterialKey(d):d;var b=p.clone();p=b.outline;const a=D.isOutlineFillSymbology(g.symbologyType);a||(b.outline=null);b={materialKey:d,hash:b.hash(),
...E(b)};if(a)return b;d=[];d.push(b);p&&(g=D.createMaterialKey(h.WGLGeometryType.LINE,{...g,isOutline:!0}),f={materialKey:f?D.hydrateMaterialKey(g):g,hash:p.hash(),...E(p)},d.push(f));return{type:"composite-symbol",layers:d,hash:d.reduce((e,c)=>c.hash+e,"")}}function t(p,g,f){var d=D.isOutlineFillSymbology(g.symbologyType)?h.WGLSymbologyType.DEFAULT:g.symbologyType;d=D.createMaterialKey(h.WGLGeometryType.LINE,{...g,symbologyType:d});const b=f?D.hydrateMaterialKey(d):d;p=p.clone();d=p.marker;p.marker=
null;const a=[];a.push({materialKey:b,hash:p.hash(),...E(p)});d&&(g=D.createMaterialKey(h.WGLGeometryType.MARKER,g),f=f?D.hydrateMaterialKey(g):g,d.color=d.color??p.color,a.push({materialKey:f,hash:d.hash(),lineWidth:p.width,...E(d)}));return{type:"composite-symbol",layers:a,hash:a.reduce((e,c)=>c.hash+e,"")}}l.createSymbolSchema=function(p,g,f=!1){if(!p)return null;switch(p.type){case "simple-fill":case "picture-fill":return w(p,g,f);case "simple-marker":case "picture-marker":var d=D.createMaterialKey(h.WGLGeometryType.MARKER,
g);f=f?D.hydrateMaterialKey(d):d;d=E(p);return{materialKey:f,hash:p.hash(),...d,angle:p.angle,maxVVSize:g.maxVVSize};case "simple-line":return t(p,g,f);case "text":return d=D.createMaterialKey(h.WGLGeometryType.TEXT,g),f=f?D.hydrateMaterialKey(d):d,d=E(p),{materialKey:f,hash:p.hash(),...d,angle:p.angle,maxVVSize:g.maxVVSize};case "label":return d=p.toJSON(),g=D.createMaterialKey(h.WGLGeometryType.LABEL,{...g,placement:d.labelPlacement}),{materialKey:f?D.hydrateMaterialKey(g):g,hash:p.hash(),...d,
labelPlacement:d.labelPlacement};case "cim":return{type:"cim",rendererKey:g.vvFlags,data:p.data,maxVVSize:g.maxVVSize};case "CIMSymbolReference":return{type:"cim",rendererKey:g.vvFlags,data:p,maxVVSize:g.maxVVSize};case "web-style":return{...E(p),type:"web-style",hash:p.hash(),rendererKey:g.vvFlags,maxVVSize:g.maxVVSize};default:throw Error(`symbol not supported ${p.type}`);}};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("exports ../../../../../core/screenUtils ../../../../../symbols/cim/CIMSymbolHelper ../../../../../symbols/cim/Rect ../../../engine/webgl/definitions ../../graphics/graphicsUtils ../../support/cimSymbolUtils".split(" "),
function(l,h,D,E,w,t,p){function g(n,x){if(!("visualVariables"in n&&n.hasVisualVariables("size")))return 0;n=n.getVisualVariablesForType("size");if(!n[0])return 0;n=n[0];if(x&&"cluster_count"===n.field&&"cluster"===x.type)return x.clusterMaxSize;if("outline"===n.target)return 0;if("stops"===n.transformationType)return n.stops.map(q=>q.size).reduce(e,0);if("clamped-linear"===n.transformationType){let q=x=-Infinity;x="number"===typeof n.maxSize?n.maxSize:n.maxSize.stops.map(B=>B.size).reduce(e,0);q=
"number"===typeof n.minSize?n.minSize:n.minSize.stops.map(B=>B.size).reduce(e,0);return Math.max(x,q)}if("real-world-size"===n.transformationType)return 30}function f(n,x){return null==n?x:n}async function d(n,x,q,B,y,u){if("simple-marker"===n.type)return x=Math.max(f(n.size,12),x),a(n)+.707*x;if("picture-marker"===n.type)return q=Math.max(f(n.height,12),x),x=f(n.width,12)*(q/f(n.height,12))/2,q/=2,a(n)+Math.sqrt(x*x+q*q);if("text"===n.type){if(q=n.text&&n.text.length){x=[];for(B=0;B<q;B++)x.push({...k,
code:n.text.charCodeAt(B)});x={glyphMosaicItems:x}}else x={glyphMosaicItems:[k]};t.getTextSymbolSize(m,n.toJSON(),x);return Math.max(Math.abs(m[0]),Math.abs(m[1]))+Math.max(m[2],m[3])}return"simple-line"===n.type?(q=Math.max(f(n.width,.75),x)/2,n.marker?Math.max(6*n.width,2*x):q):"simple-fill"===n.type||"picture-fill"===n.type?(q=Math,B=q.max,n=null==n.outline?0:f(n.outline.width,0),B.call(q,n,x)/2):"cim"===n.type?(await p.expandSymbol({type:"cim",rendererKey:0,data:n.data,maxVVSize:x},{geometryType:B,
fields:y,spatialReference:u},q),(n=D.CIMSymbolHelper.getEnvelope(n.data,null,q))?Math.sqrt(n.width*n.width+n.height*n.height):0):"web-style"===n.type?d(await n.fetchCIMSymbol(),x,q,B,y,u):0}async function b(n,x,q,B,y,u){return n.type in c?Math.min(await d(n,x,q,B,y,u),75):0}function a(n){const x=f(n.xoffset,0);n=f(n.yoffset,0);return Math.sqrt(x*x+n*n)}function e(n,x){return Math.max(n,x)}const c={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},
m=[0,0,0,0],k={sdf:!0,code:99,metrics:w.AVERAGE_GLYPH_MOSAIC_ITEM.metrics,rect:new E(0,0,24,24),page:0,textureBinding:2};l.computePxBuffer=async function(n,x,q,B,y,u){if(!n||u&&"cluster"===u.type)return 0;if("heatmap"===n.type)return Math.round(h.pt2px(n.radius));if("dot-density"===n.type)return 0;if("dictionary"===n.type)return"esriGeometryPoint"===x||"esriGeometryMultipoint"===x?100:200;u=n.getSymbols();n=g(n);const v=[];for(const r of u)v.push(b(r,n,q,x,B,y));x=await Promise.all(v);return h.pt2px(x.reduce(e,
0))};l.getPtMaxVVSize=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/BidiText ../../../../core/maybe ../../../../core/screenUtils ../../../../geometry/Polygon ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/spatialReferenceUtils ../../engine/webgl/alignmentUtils ../../engine/webgl/definitions ../../engine/webgl/mesh/templates/shapingUtils".split(" "),function(l,h,D,
E,w,t,p,g,f,d){l.PIXEL_BUFFER=50;l.TILE_SIZE=512;l.getTextSymbolSize=function(b,a,e){if(!e?.glyphMosaicItems?.length)return b;const c=h.bidiText(a.text)[1];a=d.shapeGlyphs(e.glyphMosaicItems,c,{scale:E.pt2px(a.font.size)/f.GLYPH_SIZE,angle:a.angle??0,xOffset:a.xoffset??0,yOffset:a.yoffset??0,hAlign:g.getXAnchorDirection(a.horizontalAlignment||"center"),vAlign:g.getYAnchorDirection(a.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(a.lineWidth||512,512)),lineHeight:f.MAGIC_LABEL_LINE_HEIGHT*
Math.max(.25,Math.min(a.lineHeight||1,4)),decoration:a.font.decoration||"none",isCIM:!1,hasBackground:!!a.backgroundColor,borderLineSize:a.borderLineSize}).bounds;b[0]=E.pt2px(a.x-a.halfWidth);b[1]=E.pt2px(a.y-a.halfHeight);b[2]=E.pt2px(a.width);b[3]=E.pt2px(a.height);return b};l.graphicGeometryToNumber=function(b){switch(D.unwrap(b.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};l.intersectingInternationalDateline=function(b,a){a=p.getInfo(a);if(!a)return null;
const [e,c]=a.valid;return b[2]>c?[t.create([b[0],b[1],c,b[3]]),t.create([e,b[1],e+b[2]-c,b[3]])]:b[0]<e?[t.create([e,b[1],b[2],b[3]]),t.create([c-(e-b[0]),b[1],c,b[3]])]:null};l.isMarkerSymbol=function(b){return"simple-marker"===b||"picture-marker"===b||"esriSMS"===b||"esriPMS"===b};l.isTextSymbol=function(b){return"text"===b||"esriTS"===b};l.polygonFromExtent=function(b){if(!b)return null;const {xmin:a,ymin:e,xmax:c,ymax:m,spatialReference:k}=b;return new w({rings:[[[a,e],[a,m],[c,m],[c,e],[a,e]]],
spatialReference:k})};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define("exports ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/screenUtils ../../../../webgl/capabilities".split(" "),function(l,h,D,E,w,t){function p(b){return("size"===b.type||"color"===b.type||"opacity"===b.type)&&null!=b.stops}function g(b){var a=b.type;var e=b.stops??[];if(8>=e.length)a=e;else if(d.warn(`Found ${e.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),
16<e.length){const [u,...v]=e;var c=v.pop(),m=v[0].value,k=v[v.length-1].value,n=(k-m)/6;const r=[];for(;m<k;m+=n){for(var x=0;m>=v[x].value;)x++;var q=v[x],B=e[x-1],y=m-B.value;q=q.value===B.value?1:y/(q.value-B.value);"color"===a?(B=v[x],x=e[x-1],y=B.color.clone(),y.r=(1-q)*x.color.r+q*y.r,y.g=(1-q)*x.color.g+q*y.g,y.b=(1-q)*x.color.b+q*y.b,y.a=(1-q)*x.color.a+q*y.a,r.push({value:m,color:y,label:B.label})):"size"===a?(B=v[x],y=e[x-1],x=w.toPt(B.size),y=w.toPt(y.size),r.push({value:m,size:(1-q)*
y+q*x,label:B.label})):(B=v[x],r.push({value:m,opacity:(1-q)*e[x-1].opacity+q*B.opacity,label:B.label}))}a=[u,...r,c]}else{const [u,...v]=e;for(a=v.pop();6<v.length;){c=e=0;for(k=1;k<v.length;k++)n=Math.abs(v[k].value-v[k-1].value),n>c&&(c=n,e=k);v.splice(e,1)}a=[u,...v,a]}b.stops=a;return b}function f(){if(D("heatmap-force-raster"))return"raster";const {supportsTextureFloat:b,supportsTextureHalfFloat:a,supportsColorBufferFloat:e,supportsColorBufferFloatBlend:c,supportsColorBufferHalfFloat:m}=t.getWebGLCapabilities("2d");
return b&&e&&c||a&&m?"symbol":D("heatmap-allow-raster-fallback")?"raster":"none"}const d=E.getLogger("esri.views.2d.layers.features.support.rendererUtils");l.getSupportedHeatmapRenderer=f;l.isRendererSupported=function(b){if(!b)return!0;switch(b.type){case "dot-density":if(!t.getWebGLCapabilities("2d").supportsTextureFloat)return d.error(new h("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1;break;case "heatmap":if(b=f(),"none"===b||"raster"===
b&&!D("heatmap-force-raster")){const a=t.getWebGLCapabilities("2d"),e=["supportsTextureFloat","supportsTextureHalfFloat","supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter(c=>!a[c]).join(", ");if("none"===b)return d.errorOnce(new h("webgl-missing-extension",`Missing WebGL${a.type} requirements for Heatmap: ${e}`)),!1;"raster"===b&&d.warnOnce(`Missing WebGL${a.type} requirements for accelerated Heatmap: ${e}. Feature support may be limited.`)}}return!0};
l.simplifyVVRenderer=b=>{if(!("visualVariables"in b&&b.visualVariables&&b.visualVariables.length))return b;b=b.clone();const a=b.visualVariables.map(e=>p(e)?g(e):e);b.visualVariables=a;return b};l.simplifyVisualVariables=function(b){return b.map(a=>p(a)?g(a.clone()):a)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],function(l,h){const D=new h.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",
esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});l.analyzeRings=function(E,w,t){const p=[],g=[];let f=0,d=0;for(const b of E){E=d;let a=b[0][0],e=b[0][1];p[d++]=a;p[d++]=e;let c=0;for(let m=1;m<b.length;++m){const k=a,n=e;a=b[m][0];e=b[m][1];c+=e*k-a*n;p[d++]=a;p[d++]=e}w(c/2);0<c?(0<E-f&&(t(f,E,p,g),f=E),g.length=0):0>c?0<E-f?g.push(.5*(E-f)):d=E:d=E}0<d-f&&t(f,d,p,g)};l.canUseMajorityInterpolationOnDataSource=function(E){const {bandCount:w,
attributeTable:t,colormap:p,pixelType:g}=E.raster.rasterInfo;return 1===w&&(null!=t||null!=p||"u8"===g||"s8"===g)};l.toJSONGeometryType=function(E){return D.toJSON(E)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/diffUtils ../../../../../core/support/WatchUpdatingTracking ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/DisplayId ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils ../../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n){function x(r,z){return A=>z(r(A))}const q=w.getLogger("esri.views.layers.2d.features.support.AttributeStore"),B=m.createDebugLogger(m.DEBUG_ATTR_UPDATES,q);var y=E("esri-shared-array-buffer"),u=E("esri-atomics");let v=function(){function r(A,C,F,G){this.size=0;this.texelSize=4;this.dirtyEnd=this.dirtyStart=0;const {pixelType:H,layout:K,textureOnly:J}=G;this.textureOnly=J||!1;this.pixelType=H;this._ctype=C;this.layout=K;this._resetRange();this._shared=A;
this.size=F;J||(this.data=this._initData(H,F,A,C))}var z=r.prototype;z.unsetComponentAllTexels=function(A,C){const F=p.unwrap(this.data);for(let G=0;G<this.size*this.size;G++)F[G*this.texelSize+A]&=~C;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};z.setComponentAllTexels=function(A,C){const F=p.unwrap(this.data);for(let G=0;G<this.size*this.size;G++)F[G*this.texelSize+A]|=255&C;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};z.setComponent=function(A,C,F){const G=p.unwrap(this.data);
for(const H of F)G[H*this.texelSize+A]|=C,this.dirtyStart=Math.min(this.dirtyStart,H),this.dirtyEnd=Math.max(this.dirtyEnd,H)};z.setComponentTexel=function(A,C,F){p.unwrap(this.data)[F*this.texelSize+A]|=C;this.dirtyStart=Math.min(this.dirtyStart,F);this.dirtyEnd=Math.max(this.dirtyEnd,F)};z.unsetComponentTexel=function(A,C,F){p.unwrap(this.data)[F*this.texelSize+A]&=~C;this.dirtyStart=Math.min(this.dirtyStart,F);this.dirtyEnd=Math.max(this.dirtyEnd,F)};z.getData=function(A,C){A=e.getDisplayIdTexel(A);
return p.unwrap(this.data)[A*this.texelSize+C]};z.setData=function(A,C,F){A=e.getDisplayIdTexel(A);0===(this.layout&1<<C)?q.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):p.isNone(this.data)||(this.data[A*this.texelSize+C]=F,this.dirtyStart=Math.min(this.dirtyStart,A),this.dirtyEnd=Math.max(this.dirtyEnd,A))};z.lock=function(){this.pixelType===n.PixelType.UNSIGNED_BYTE&&this._shared&&u&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};z.unlock=function(){this.pixelType===
n.PixelType.UNSIGNED_BYTE&&this._shared&&u&&"local"!==this._ctype&&Atomics.store(this.data,0,0)};z.expand=function(A){this.size=A;if(!this.textureOnly){A=this._initData(this.pixelType,A,this._shared,this._ctype);const C=p.unwrap(this.data);A.set(C);this.data=A}};z.toMessage=function(){const A=this.dirtyStart,C=this.dirtyEnd;var F=this.texelSize;if(A>C)return null;this._resetRange();const G=!this._shared&&"local"!==this._ctype,H=this.pixelType,K=this.layout,J=p.unwrap(this.data);F=G&&J.slice(A*F,(C+
1)*F)||null;return{start:A,end:C,data:F,pixelType:H,layout:K}};z._initData=function(A,C,F,G){F=F&&"local"!==G?SharedArrayBuffer:ArrayBuffer;A=c.getPixelArrayCtor(A);C=new A(new F(C*C*4*A.BYTES_PER_ELEMENT));for(A=0;A<C.length;A+=4)C[A+1]=255;return C};z._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};h._createClass(r,[{key:"buffer",get:function(){return p.applySome(this.data,A=>A.buffer)}}]);return r}();return function(){function r(A,C){this._client=A;this.config=C;this.updatingHandles=
new d.WatchUpdatingTracking;this._blocks=[];this._filters=Array(a.MAX_FILTERS);this._attributeComputeInfo=null;this._targetType=0;this._abortController=new AbortController;this._hasScaleExpr=!1;this._size=32;this._currUpdate=this._nextUpdate=null;this._idsToHighlight=new Set;A=C.supportsTextureFloat?n.PixelType.FLOAT:n.PixelType.UNSIGNED_BYTE;B(`Creating AttributeStore ${y?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:n.PixelType.UNSIGNED_BYTE,layout:1},{pixelType:n.PixelType.UNSIGNED_BYTE,
layout:15,textureOnly:!0},{pixelType:n.PixelType.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:A,layout:15},{pixelType:A,layout:15},{pixelType:A,layout:15},{pixelType:A,layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var z=r.prototype;z.destroy=function(){this._abortController.abort();this.updatingHandles.destroy()};z.isUpdating=function(){const A=this.updatingHandles.updating||!!this._nextUpdate;E("esri-2d-log-updating")&&console.log(`Updating AttributeStore: ${A}\n  -> updatingHandles ${this.updatingHandles.updating} (currUpdate: ${!!this._currUpdate})\n  -> nextUpdate: ${!!this._nextUpdate}\n`);
return A};z.update=function(A,C){this.config=C;C=C.schema.processors[0].storage;const F=f.diff(this._schema,C);if(A.targets.feature||A.targets.aggregate)A.storage.data=!0;if(F&&(E("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",F),A.storage.data=!0,this._schema=C,this._attributeComputeInfo=null,!p.isNone(C))){switch(C.target){case "feature":this._targetType=e.DISPLAY_ID_TYPE_FEATURE;break;case "aggregate":this._targetType=e.DISPLAY_ID_TYPE_AGGREGATE}if("subtype"===C.type){this._attributeComputeInfo=
{isSubtype:!0,subtypeField:C.subtypeField,map:new Map};for(const G in C.mapping)if(A=C.mapping[G],p.isSome(A)&&p.isSome(A.vvMapping))for(const H of A.vvMapping)this._bindAttribute(H,parseInt(G,10))}else{this._attributeComputeInfo={isSubtype:!1,map:new Map};if(p.isSome(C.vvMapping))for(const G of C.vvMapping)this._bindAttribute(G);if(p.isSome(C.attributeMapping))for(const G of C.attributeMapping)this._bindAttribute(G)}}};z.onTileData=function(A,C){if(!p.isNone(C.addOrUpdate))for(A=C.addOrUpdate.getCursor();A.next();)C=
A.getDisplayId(),this.setAttributeData(C,A)};z.setHighlight=async function(A,C){const F=this._getBlock(0);C=C.map(G=>e.getDisplayIdTexel(G));F.lock();F.unsetComponentAllTexels(0,1);F.setComponent(0,1,C);F.unlock();this._idsToHighlight.clear();for(const G of A)this._idsToHighlight.add(G);await this.sendUpdates()};z.updateFilters=async function(A,C,F){E("esri-2d-update-debug")&&console.debug("AttributeStore::updateFilters");const {service:G,spatialReference:H}=F;({filters:C}=C);C=C.map((K,J)=>this._updateFilter(K,
J,G,H));C=(await Promise.all(C)).some(K=>K);E("esri-2d-update-debug")&&console.debug("AttributeStore::updateFilters - finsihed");C&&(A.storage.filters=!0,E("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))};z.setData=function(A,C,F,G){const H=e.getDisplayIdTexel(A);this._ensureSizeForTexel(H);this._getBlock(C).setData(A,F,G)};z.getData=function(A,C,F){return this._getBlock(C).getData(A,F)};z.getHighlightFlag=function(A){return this._idsToHighlight.has(A)?
a.HIGHLIGHT_FLAG:0};z.unsetAttributeData=function(A){A=e.getDisplayIdTexel(A);this._getBlock(0).setData(A,0,0)};z.setAttributeData=function(A,C){const F=e.getDisplayIdTexel(A);this._ensureSizeForTexel(F);this._getBlock(0).setData(F,0,this.getFilterFlags(C));if(this._targetType===e.getDisplayIdType(A)){A=this._attributeComputeInfo;var G=this.config.supportsTextureFloat?1:2,H=null;A&&(H=A.isSubtype?A.map.get(C.readAttribute(A.subtypeField)):A.map)&&H.size&&H.forEach((K,J)=>{const N=J*G%4;J=this._getBlock(Math.floor(J*
G/4)+a.ATTRIBUTE_DATA_VV);K=K(C);if(this.config.supportsTextureFloat)J.setData(F,N,K);else if(K===a.NAN_MAGIC_NUMBER)J.setData(F,N,255),J.setData(F,N+1,255);else{K=t.clamp(Math.round(K),-32767,32766)+32768;const P=(K&65280)>>8;J.setData(F,N,K&255);J.setData(F,N+1,P)}})}};z.sendUpdates=function(){E("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate");if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=g.createResolver(),this.updatingHandles.addPromise(this._nextUpdate.promise),
this._nextUpdate.promise;const A={blocks:this._blocks.map(C=>p.isSome(C)?C.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var C=()=>{this._currUpdate=null;if(this._nextUpdate){const F=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>F.resolve())}else E("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued")};E("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");C=this.updatingHandles.addPromise(this._client.update(A,
this._signal).then(C).catch(C));this._client.render(this._signal);return C}).catch(C=>{if(g.isAbortError(C))return this._createResourcesPromise=null,this._createResources();q.error(new D("mapview-attribute-store","Encountered an error during client update",C))})};z._ensureSizeForTexel=function(A){for(;A>=this._size*this._size&&!this._expand(););};z._bindAttribute=function(A,C){function F(){const {normalizationField:P}=A;return P?W=>{const X=W.readAttribute(P);return X?W.readAttribute(A.field)/X:null}:
W=>W.readAttribute(A.field)}function G(){A.normalizationField&&q.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return P=>P.getComputedNumericAtIndex(A.fieldIndex)}let H;if(null!=A.fieldIndex)H=G();else if(A.field)H=F();else return;const {valueRepresentation:K}=A;K&&(H=x(H,P=>k.getVisualVariableSizeValueRepresentationRatio(P,K)));const J=P=>null===P||isNaN(P)||Infinity===P||-Infinity===P?a.NAN_MAGIC_NUMBER:P,N=this._attributeComputeInfo;
if(N.isSubtype){const P=N.map.get(C)??new Map;P.set(A.binding,x(H,J));N.map.set(C,P)}else N.map.set(A.binding,x(H,J))};z._createResources=function(){if(p.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(a.ATTRIBUTE_DATA_ANIMATION);this._getBlock(a.ATTRIBUTE_DATA_GPGPU);B("Initializing AttributeStore");var A={shared:y&&"local"!==this._client.type,size:this._size,blocks:p.mapMany(this._blocks,C=>({textureOnly:C.textureOnly,buffer:C.buffer,pixelType:C.pixelType}))};
this._createResourcesPromise=A=this._client.initialize(A,this._signal).catch(C=>{g.isAbortError(C)?this._createResourcesPromise=null:q.error(new D("mapview-attribute-store","Encountered an error during client initialization",C))});A.then(()=>p.isNone(this._createResourcesPromise)?this._createResources():void 0);return A};z._getBlock=function(A){var C=this._blocks[A];if(p.isSome(C))return C;B(`Initializing AttributeBlock at index ${A}`);C=new v(y,this._client.type,this._size,this._blockDescriptors[A]);
this._blocks[A]=C;this._createResourcesPromise=null;return C};z._expand=function(){if(this._size<this.config.maxTextureSize){const A=this._size<<=1;B("Expanding block size to",A,this._blocks);p.forEachSome(this._blocks,C=>C.expand(A));this._createResourcesPromise=null;this._size=A;return 0}q.error(new D("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};z._updateFilter=async function(A,C,F,G){const H=this._filters[C],K=p.isSome(H)&&H.hash;if(!H&&!A||K===JSON.stringify(A))return!1;
if(p.isNone(A)){if(!H)return!1;A=1<<C+1;F=this._getBlock(0);this._filters[C]=null;F.setComponentAllTexels(0,A);this.sendUpdates();return!0}await (await this._getFilter(C,F)).update(A,G);return!0};z._getFilter=async function(A,C){var F=this._filters[A];if(p.isSome(F))return F;({default:F}=await new Promise((G,H)=>l(["./FeatureFilter"],K=>G(Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"}))),H)));C=new F({geometryType:C.geometryType,hasM:!1,hasZ:!1,
timeInfo:C.timeInfo,fieldsIndex:new b(C.fields)});return this._filters[A]=C};z.isVisible=function(A){return!!(this._getBlock(0).getData(A,0)&2)};z.getFilterFlags=function(A){let C=0;var F=e.getDisplayIdFilterMask(A.getDisplayId());for(let H=0;H<this._filters.length;H++){var G=this._filters[H];G=!(F&1<<H)||p.isNone(G)||G.check(A);C|=(G?1:0)<<H}F=0;this._idsToHighlight.size&&(A=A.getObjectId(),F=this.getHighlightFlag(A));return C<<1|F};h._createClass(r,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},
{key:"_signal",get:function(){return this._abortController.signal}},{key:"hasHighlight",get:function(){return 0<this._idsToHighlight.size}}]);return r}()})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(l){l.DEBUG_ATTR_UPDATES=!1;l.createDebugLogger=(h,D)=>h&&((...E)=>D.warn("DEBUG:",...E))||(()=>null);Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/color ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/visualVariablesUtils".split(" "),
function(l,h,D,E,w,t,p){function g(m){return{value:m.value,size:D.toPt(m.size)}}function f(m){return(m??[]).map(k=>g(k))}function d(m){return"string"===typeof m||"number"===typeof m?D.toPt(m):{type:"size",expression:m.expression,stops:f(m.stops)}}function b(m){const k={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof m.field)if(m.stops){if(8<m.stops.length)return null;m=m.stops;for(var n=0;8>n;++n){const x=m[Math.min(n,m.length-1)];k.values[n]=x.value;k.opacities[n]=x.opacity}}else return null;
else if(m.stops&&0<=m.stops.length)for(m=m.stops&&0<=m.stops.length?m.stops[0].opacity:0,n=0;8>n;n++)k.values[n]=Infinity,k.opacities[n]=m;else return null;return k}function a(m,k,n){m[4*k]=n.r/255;m[4*k+1]=n.g/255;m[4*k+2]=n.b/255;m[4*k+3]=n.a}function e(m){if(h.isNone(m)||m.normalizationField)return null;const k={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof m.field)if(m.stops){if(8<m.stops.length)return null;k.field=
m.field;m=m.stops;for(var n=0;8>n;++n){const x=m[Math.min(n,m.length-1)];k.values[n]=x.value;a(k.colors,n,x.color)}}else return null;else if(m.stops&&0<=m.stops.length)for(m=m.stops&&0<=m.stops.length&&m.stops[0].color,n=0;8>n;n++)k.values[n]=Infinity,a(k.colors,n,m);else return null;for(m=0;32>m;m+=4)E.premultiplyAlpha(k.colors,m,!0);return k}const c=m=>{const k=[],n=[];m=f(m);const x=m.length;for(let q=0;6>q;q++){const B=m[Math.min(q,x-1)];k.push(B.value);n.push(null==B.size?w.NAN_MAGIC_NUMBER:
D.pt2px(B.size))}return{values:new Float32Array(k),sizes:new Float32Array(n)}};l.convertColorVariable=e;l.convertVisualVariables=function(m){const k=m&&0<m.length?{}:null,n=k?{}:null;if(!k||!n)return{vvFields:k,vvRanges:n};for(const x of m)if(x.field&&(k[x.type]=x.field),"size"===x.type)switch(n.size||(n.size={}),m=x,p.getTypeOfSizeVisualVariable(m)){case t.WGLVVFlag.SIZE_MINMAX_VALUE:n.size.minMaxValue={minDataValue:m.minDataValue,maxDataValue:m.maxDataValue,minSize:d(m.minSize),maxSize:d(m.maxSize)};
break;case t.WGLVVFlag.SIZE_SCALE_STOPS:n.size.scaleStops={stops:f(m.stops)};break;case t.WGLVVFlag.SIZE_FIELD_STOPS:if(m.levels){const q={};for(const B in m.levels)q[B]=c(m.levels[B]);n.size.fieldStops={type:"level-dependent",levels:q}}else n.size.fieldStops={type:"static",...c(m.stops)};break;case t.WGLVVFlag.SIZE_UNIT_VALUE:n.size.unitValue={unit:m.valueUnit,valueRepresentation:m.valueRepresentation??void 0}}else"color"===x.type?n.color=e(x):"opacity"===x.type?n.opacity=b(x):"rotation"===x.type&&
(n.rotation={type:x.rotationType});return{vvFields:k,vvRanges:n}};l.getVisualVariableSizeValueRepresentationRatio=function(m,k){if(!m||!k)return m;switch(k){case "radius":case "distance":return 2*m;case "area":return Math.sqrt(m)}return m};l.normalizeSizeElement=d;l.normalizeSizeStops=f;l.stopToSizeStop=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers",
"../../../engine/webgl/DisplayId","./DisplayIdGenerator","./StaticBitSet"],function(l,h,D,E,w){function t(g,f,d){if(!(g.length>f))for(;g.length<=f;)g.push(d)}let p=function(){function g(){this._numerics=[];this._strings=[];this._idGenerator=new E.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var f=g.prototype;f.createBitset=function(){const d=this._bitsets.length;this._bitsets.push(w.StaticBitSet.create(this._allocatedSize,D.DISPLAY_ID_TEXEL_MASK));
return d+1};f.getBitset=function(d){return this._bitsets[d-1]};f._expand=function(){this._allocatedSize<<=1;for(const d of this._bitsets)d.resize(this._allocatedSize)};f._ensureNumeric=function(d,b){this._numerics[d]||(this._numerics[d]=[]);t(this._numerics[d],b,0)};f._ensureInstanceId=function(d){t(this._instanceIds,d,0)};f._ensureString=function(d,b){this._strings[d]||(this._strings[d]=[]);t(this._strings[d],b,null)};f.createDisplayId=function(d=!1){const b=this._idGenerator.createId();b>this._allocatedSize&&
this._expand();return D.createDisplayId(b,d)};f.releaseDisplayId=function(d){for(const b of this._bitsets)b.unset(d);return this._idGenerator.releaseId(d&D.DISPLAY_ID_TEXEL_MASK)};f.getComputedNumeric=function(d,b){return this.getComputedNumericAtIndex(d&D.DISPLAY_ID_TEXEL_MASK,0)};f.setComputedNumeric=function(d,b,a){return this.setComputedNumericAtIndex(d&D.DISPLAY_ID_TEXEL_MASK,a,0)};f.getComputedString=function(d,b){return this.getComputedStringAtIndex(d&D.DISPLAY_ID_TEXEL_MASK,0)};f.setComputedString=
function(d,b,a){return this.setComputedStringAtIndex(d&D.DISPLAY_ID_TEXEL_MASK,0,a)};f.getComputedNumericAtIndex=function(d,b){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(b,d);return this._numerics[b][d]};f.setComputedNumericAtIndex=function(d,b,a){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureNumeric(b,d);this._numerics[b][d]=a};f.getInstanceId=function(d){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(d);return this._instanceIds[d]};f.setInstanceId=function(d,b){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureInstanceId(d);
this._instanceIds[d]=b};f.getComputedStringAtIndex=function(d,b){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureString(b,d);return this._strings[b][d]};f.setComputedStringAtIndex=function(d,b,a){d&=D.DISPLAY_ID_TEXEL_MASK;this._ensureString(b,d);this._strings[b][d]=a};f.getXMin=function(d){return this._bounds[4*(d&D.DISPLAY_ID_TEXEL_MASK)]};f.getYMin=function(d){return this._bounds[4*(d&D.DISPLAY_ID_TEXEL_MASK)+1]};f.getXMax=function(d){return this._bounds[4*(d&D.DISPLAY_ID_TEXEL_MASK)+2]};f.getYMax=function(d){return this._bounds[4*
(d&D.DISPLAY_ID_TEXEL_MASK)+3]};f.setBounds=function(d,b){b=b.readHydratedGeometry();if(!b||!b.coords.length)return!1;let a=Infinity,e=Infinity,c=-Infinity,m=-Infinity;b.forEachVertex((k,n)=>{a=Math.min(a,k);e=Math.min(e,n);c=Math.max(c,k);m=Math.max(m,n)});d&=D.DISPLAY_ID_TEXEL_MASK;t(this._bounds,4*d+4,0);this._bounds[4*d]=a;this._bounds[4*d+1]=e;this._bounds[4*d+2]=c;this._bounds[4*d+3]=m;return!0};return h._createClass(g)}();l.ComputedAttributeStorage=p;Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/layers/features/support/DisplayIdGenerator":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../engine/webgl/DisplayId"],function(l,h,D){let E=function(){function w(){this._freeIds=[];this._idCounter=1}var t=w.prototype;t.createId=function(p=!1){return D.createDisplayId(this._getFreeId(),p)};t.releaseId=function(p){this._freeIds.push(p)};t._getFreeId=function(){return this._freeIds.length?this._freeIds.pop():this._idCounter++};
return h._createClass(w)}();l.DisplayIdGenerator=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),function(l,h,D,E,w,t){t=function(p){function g(d,b,a){d=f.call(this,d,b,null);d._transform=a;return d}h._inherits(g,
p);var f=h._createSuper(g);g.from=function(d,b,a){const e=w.FeatureSetReader.createInstance(),c=[];d=d.filter(m=>!!m.geometry);for(const m of d)d=D.getJsonType(m.geometry),E.convertFromGraphics(c,[m],d,!1,!1,b);return new g(e,c,a)};p=g.prototype;p.readGraphic=function(){return this._current};p.getCursor=function(){return this.copy()};p.copy=function(){const d=new g(this.instance,this._features,this._transform);this.copyInto(d);return d};h._createClass(g,[{key:"geometryType",get:function(){const d=
this._current;return d?d.geometryType:null}},{key:"insertAfter",get:function(){return this._current.insertAfter}}]);return g}(t.FeatureSetReaderJSON);l.GraphicsReader=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry ../../../../../arcade/ArcadeDate ../../../../../arcade/arcadeTimeUtils ../../../../../core/has ../../../../../core/maybe ../../../../../layers/graphics/centroid ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedGeometry ./StaticBitSet ../../../../../geometry/support/jsonUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a){let e=0;D=t("featurelayer-simplify-thresholds")??[.5,.5,.5,.5];const c=D[0],m=D[1],k=D[2],n=D[3];D=t("featurelayer-simplify-payload-size-factors")??[1,2,4];const x=D[0],q=D[1],B=D[2],y=t("featurelayer-simplify-mobile-factor")??2,u=t("esri-mobile");t=function(){function v(z,A){this.type="FeatureSetReader";this.arcadeDeclaredClass="esri.arcade.Feature";this.seen=!1;this._ty=this._tx=this.instance=0;this._sy=this._sx=1;this._deleted=null;this._joined=[];this._objectIdToIndex=
null;this._level=0;this.contextTimeReference=this._datetimeMetadata=null;this.instance=z;this._layerSchema=A}v.createInstance=function(){e++;return e=65535<e?0:e};var r=v.prototype;r.getAreaSimplificationThreshold=function(z,A){let C=1;const F=u?y:1;4E6<A?C=B*F:1E6<A?C=q*F:5E5<A?C=x*F:1E5<A&&(C=F);A=0;4E3<z?A=n*C:2E3<z?A=k*C:100<z?A=m:15<z&&(A=c);z=8;4>this._level?z=1:5>this._level?z=2:6>this._level&&(z=4);return A*z};r.createQuantizedExtrudedQuad=function(z,A){return new d([5],[z-1,A,1,-1,1,1,-1,
1,-1,-1])};r.setArcadeSpatialReference=function(z){this._arcadeSpatialReference=z};r.attachStorage=function(z){this._storage=z};r.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};r.getStorage=function(){return this._storage};r.getComputedNumeric=function(z){return this.getComputedNumericAtIndex(0)};r.setComputedNumeric=function(z,A){return this.setComputedNumericAtIndex(A,0)};r.getComputedString=function(z){return this.getComputedStringAtIndex(0)};r.setComputedString=
function(z,A){return this.setComputedStringAtIndex(0,A)};r.getComputedNumericAtIndex=function(z){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),z)};r.setComputedNumericAtIndex=function(z,A){this._storage.setComputedNumericAtIndex(this.getDisplayId(),z,A)};r.getComputedStringAtIndex=function(z){return this._storage.getComputedStringAtIndex(this.getDisplayId(),z)};r.setComputedStringAtIndex=function(z,A){return this._storage.setComputedStringAtIndex(this.getDisplayId(),z,A)};r.transform=
function(z,A,C,F){const G=this.copy();G._tx+=z;G._ty+=A;G._sx*=C;G._sy*=F;return G};r.readAttribute=function(z,A=!1){var C=this._readAttribute(z,A);if(void 0!==C)return C;for(const F of this._joined)if(F.setIndex(this.getIndex()),C=F._readAttribute(z,A),void 0!==C)return C};r.readAttributes=function(){const z=this._readAttributes();for(const A of this._joined){A.setIndex(this.getIndex());const C=A._readAttributes();for(const F of Object.keys(C))z[F]=C[F]}return z};r.joinAttributes=function(z){this._joined.push(z)};
r.readArcadeFeature=function(){return this};r.geometry=function(){var z=this.readHydratedGeometry();z=f.convertToGeometry(z,this.geometryType,this.hasZ,this.hasM);if(z=a.fromJSON(z))z.spatialReference=this._arcadeSpatialReference;return z};r.autocastArcadeDate=function(z,A){return A&&A instanceof Date?this.isUnknownDateTimeField(z)?E.ArcadeDate.unknownDateJSToArcadeDate(A):E.ArcadeDate.dateJSAndZoneToArcadeDate(A,this.contextTimeReference?.timeZone??"system"):A};r.isUnknownDateTimeField=function(z){return"unknown"===
this.dateTimeReferenceFieldIndex?.fieldTimeZone(z)};r.fieldSourceTimeZone=function(z){return this.dateTimeReferenceFieldIndex?.fieldTimeZone(z)??""};r.field=function(z){if(this.hasField(z))return this.autocastArcadeDate(z,this.readAttribute(z,!0));for(var A of this._joined)if(A.setIndex(this.getIndex()),A.hasField(z))return A=A._readAttribute(z,!0),this.autocastArcadeDate(z,A);throw Error(`Field ${z} does not exist`);};r.setField=function(z,A){throw Error("Unable to update feature attribute values, feature is readonly");
};r.keys=function(){return this.getFieldNames()};r.castToText=function(z=!1){if(!z)return JSON.stringify(this.readLegacyFeature());z=this.readLegacyFeature();if(!z)return JSON.stringify(null);z={geometry:z.geometry,attributes:{...(z.attributes??{})}};for(const A in z.attributes){const C=z.attributes[A];C instanceof Date&&(z.attributes[A]=C.getTime())}return JSON.stringify(z)};r.gdbVersion=function(){return null};r.fullSchema=function(){return this._layerSchema};r.castAsJson=function(z=null){return{attributes:this._readAttributes(),
geometry:!0===z?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}};r.castAsJsonAsync=function(z,A=null){return Promise.resolve(this.castAsJson(A))};r.removeIds=function(z){if(p.isNone(this._objectIdToIndex)){var A=new Map;const C=this.getCursor();for(;C.next();){const F=p.unwrapOrThrow(C.getObjectId());A.set(F,C.getIndex())}this._objectIdToIndex=A}A=this._objectIdToIndex;for(const C of z)A.has(C)&&this.removeAtIndex(A.get(C))};r.removeAtIndex=function(z){p.isNone(this._deleted)&&
(this._deleted=b.StaticBitSet.create(this.getSize()));this._deleted.set(z)};r.readGeometryForDisplay=function(){return this.readUnquantizedGeometry(!0)};r.readLegacyGeometryForDisplay=function(){return this.readLegacyGeometry(!0)};r.features=function*(){const z=this.getCursor();for(;z.next();)yield z.readOptimizedFeature()};r._getExists=function(){return p.isNone(this._deleted)||!this._deleted.has(this.getIndex())};r._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;
const z=this.readUnquantizedGeometry();if(!z||z.hasIndeterminateRingOrder)return null;const A=p.unwrapOr(this.getQuantizationTransform(),null);return g.getCentroidOptimizedGeometry(new d,z,this.hasM,this.hasZ,A)};r.copyInto=function(z){z.seen=this.seen;z._storage=this._storage;z._arcadeSpatialReference=this._arcadeSpatialReference;z._joined=this._joined;z._tx=this._tx;z._ty=this._ty;z._sx=this._sx;z._sy=this._sy;z._deleted=this._deleted;z._objectIdToIndex=this._objectIdToIndex};h._createClass(v,[{key:"isEmpty",
get:function(){return p.isSome(this._deleted)&&this._deleted.countSet()===this.getSize()}},{key:"level",set:function(z){this._level=z}},{key:"dateTimeReferenceFieldIndex",get:function(){return this._datetimeMetadata?this._datetimeMetadata:this._datetimeMetadata=w.DateTimeReferenceFieldIndex.create(this._layerSchema.fields,this._layerSchema)}},{key:"layerPreferredTimeZone",get:function(){return this.dateTimeReferenceFieldIndex?.layerPreferredTimeZone??""}}]);return v}();l.FeatureSetReader=t;Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./executionError","../chunks/datetime"],function(l,h,D,E){function w(d){if(d instanceof E.Zone)return d;if("system"===d.toLowerCase())return"system";if("utc"===d.toLowerCase())return"utc";if("unknown"===d.toLowerCase())return t.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(d)){const b=E.FixedOffsetZone.parseSpecifier("UTC"+(d.startsWith("+")||d.startsWith("-")?
"":"+")+d);if(b)return b}d=E.IANAZone.create(d);if(!d.isValid)throw new g(l.ArcadeDateErrorCodes.TimeZoneNotRecognised);return d}let t=h._createClass(function(){});t.instance=new E.IANAZone("Etc/UTC");l.ArcadeDateErrorCodes=void 0;(l.ArcadeDateErrorCodes||(l.ArcadeDateErrorCodes={})).TimeZoneNotRecognised="TimeZoneNotRecognised";const p={[l.ArcadeDateErrorCodes.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};let g=function(d){function b(e,c){e=a.call(this,D.doSubstitutions(p[e],
c));e.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(h._assertThisInitialized(e),b);return e}h._inherits(b,d);var a=h._createSuper(b);return h._createClass(b)}(h._wrapNativeSuper(Error)),f=function(){function d(a){this._date=a;this.declaredRootClass="esri.arcade.arcadedate"}d.fromParts=function(a=0,e=1,c=1,m=0,k=0,n=0,x=0,q){if(isNaN(a)||isNaN(e)||isNaN(c)||isNaN(m)||isNaN(k)||isNaN(n)||isNaN(x))return null;let B=0;var y=E.DateTime.local(a,e).daysInMonth;
1>c&&(B=c-1,c=1);c>y&&(B=c-y,c=y);y=0;12<e?(y=e-12,e=12):1>e&&(y=e-1,e=1);let u=0;59<k?(u=k-59,k=59):0>k&&(u=k,k=0);let v=0;59<n?(v=n-59,n=59):0>n&&(v=n,n=0);let r=0;999<x?(r=x-999,x=999):0>x&&(r=x,x=0);a=E.DateTime.fromObject({day:c,year:a,month:e,hour:m,minute:k,second:n,millisecond:x},{zone:w(q)});0!==y&&(a=a.plus({months:y}));0!==B&&(a=a.plus({days:B}));0!==u&&(a=a.plus({minutes:u}));0!==v&&(a=a.plus({seconds:v}));0!==r&&(a=a.plus({milliseconds:r}));return new d(a)};d.arcadeDateAndZoneToArcadeDate=
function(a,e){const c=w(e);return a.isUnknownTimeZone||c===t.instance?d.fromParts(a.year,a.monthJS+1,a.day,a.hour,a.minute,a.second,a.millisecond,c):new d(a._date.setZone(e))};d.dateJSToArcadeDate=function(a){return new d(E.DateTime.fromJSDate(a,{zone:"system"}))};d.dateJSAndZoneToArcadeDate=function(a,e="system"){return new d(E.DateTime.fromJSDate(a,{zone:e}))};d.unknownEpochToArcadeDate=function(a){return new d(E.DateTime.fromMillis(a,{zone:t.instance}))};d.unknownDateJSToArcadeDate=function(a){return new d(E.DateTime.fromMillis(a.getTime(),
{zone:t.instance}))};d.epochToArcadeDate=function(a,e="system"){return new d(E.DateTime.fromMillis(a,{zone:e}))};d.dateTimeToArcadeDate=function(a){return new d(a)};var b=d.prototype;b.changeTimeZone=function(a){a=w(a);return d.dateTimeToArcadeDate(this._date.setZone(a))};d.dateTimeAndZoneToArcadeDate=function(a,e){e=w(e);return a.zone===t.instance||e===t.instance?d.fromParts(a.year,a.month,a.day,a.hour,a.minute,a.second,a.millisecond,e):new d(a.setZone(e))};d.nowToArcadeDate=function(a){return new d(E.DateTime.fromJSDate(new Date,
{zone:a}))};d.nowUTCToArcadeDate=function(){return new d(E.DateTime.utc())};b.equals=function(a){return this.isSystem&&a.isSystem?this.toNumber()===a.toNumber():this.isUnknownTimeZone!==a.isUnknownTimeZone?!1:this._date.equals(a._date)};b.stringify=function(){return JSON.stringify(this.toJSDate())};b.plus=function(a){return new d(this._date.plus(a))};b.diff=function(a,e="milliseconds"){return this._date.diff(a._date,e)[e]};b.toISOString=function(a){return a?this._date.toISO({suppressMilliseconds:!0,
includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})};b.toFormat=function(a,e){return this._date.toFormat(a,e)};b.toJSDate=function(){return this._date.toJSDate()};b.toSQLString=function(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"};b.toDateTime=function(){return this._date};b.toNumber=function(){return this._date.toMillis()};b.getTime=function(){return this._date.toMillis()};b.toUTC=function(){return new d(this._date.toUTC())};
b.toLocal=function(){return new d(this._date.toLocal())};b.toString=function(){return this.toISOString(!0)};h._createClass(d,[{key:"isSystem",get:function(){return"system"===this.timeZone||this.timeZone===d.systemTimeZoneCanonicalName}},{key:"isUnknownTimeZone",get:function(){return this._date.zone===t.instance}},{key:"isValid",get:function(){return this._date.isValid}},{key:"hour",get:function(){return this._date.hour}},{key:"second",get:function(){return this._date.second}},{key:"day",get:function(){return this._date.day}},
{key:"dayOfWeekISO",get:function(){return this._date.weekday}},{key:"dayOfWeekJS",get:function(){let a=this._date.weekday;6<a&&(a=0);return a}},{key:"millisecond",get:function(){return this._date.millisecond}},{key:"monthISO",get:function(){return this._date.month}},{key:"weekISO",get:function(){return this._date.weekNumber}},{key:"yearISO",get:function(){return this._date.weekYear}},{key:"monthJS",get:function(){return this._date.month-1}},{key:"year",get:function(){return this._date.year}},{key:"minute",
get:function(){return this._date.minute}},{key:"zone",get:function(){return this._date.zone}},{key:"timeZoneOffset",get:function(){return this.isUnknownTimeZone?0:this._date.offset}},{key:"timeZone",get:function(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const a=this.zone;return"fixed"===a.type?0===a.fixed?"utc":a.formatOffset(0,"short"):a.name}}],[{key:"systemTimeZoneCanonicalName",get:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}}]);return d}();l.ArcadeDate=f;l.ArcadeDateError=g;l.ArcadeDateErrorMessages=p;l.UnknownTimeZone=t;l.createDateTimeZone=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/executionError":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],function(l,h){function D(e){return e&&e.loc?`Line : ${e.loc.start?.line}, ${e.loc.start?.column}: `:""}function E(e,c){try{if(!c)return e;for(const m in c){let k=c[m];k||(k="");e=e.replace("{"+m+"}",c[m])}}catch(m){}return e}
l.ExecutionErrorCodes=void 0;(function(e){e.AsyncNotEnabled="AsyncNotEnabled";e.ModulesNotSupported="ModulesNotSupported";e.CircularModules="CircularModules";e.NeverReach="NeverReach";e.UnsupportedHashType="UnsupportedHashType";e.InvalidParameter="InvalidParameter";e.UnexpectedToken="UnexpectedToken";e.Unrecognised="Unrecognised";e.UnrecognisedType="UnrecognisedType";e.MaximumCallDepth="MaximumCallDepth";e.BooleanConditionRequired="BooleanConditionRequired";e.TypeNotAllowedInFeature="TypeNotAllowedInFeature";
e.KeyMustBeString="KeyMustBeString";e.WrongNumberOfParameters="WrongNumberOfParameters";e.CallNonFunction="CallNonFunction";e.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral";e.NoFunctionInDictionary="NoFunctionInDictionary";e.NoFunctionInArray="NoFunctionInArray";e.AssignModuleFunction="AssignModuleFunction";e.LogicExpressionOrAnd="LogicExpressionOrAnd";e.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean";e.FuncionNotFound="FunctionNotFound";e.InvalidMemberAccessKey="InvalidMemberAccessKey";
e.UnsupportedUnaryOperator="UnsupportUnaryOperator";e.InvalidIdentifier="InvalidIdentifier";e.MemberOfNull="MemberOfNull";e.UnsupportedOperator="UnsupportedOperator";e.Cancelled="Cancelled";e.ModuleAccessorMustBeString="ModuleAccessorMustBeString";e.ModuleExportNotFound="ModuleExportNotFound";e.Immutable="Immutable";e.OutOfBounds="OutOfBounds";e.IllegalResult="IllegalResult";e.FieldNotFound="FieldNotFound";e.PortalRequired="PortalRequired";e.LogicError="LogicError";e.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber";
e.KeyAccessorMustBeString="KeyAccessorMustBeString";e.WrongSpatialReference="WrongSpatialReference"})(l.ExecutionErrorCodes||(l.ExecutionErrorCodes={}));const w={[l.ExecutionErrorCodes.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[l.ExecutionErrorCodes.LogicError]:"Logic error - {reason}",[l.ExecutionErrorCodes.NeverReach]:"Encountered unreachable logic",[l.ExecutionErrorCodes.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[l.ExecutionErrorCodes.ModuleAccessorMustBeString]:"Module accessor must be a string",
[l.ExecutionErrorCodes.ModuleExportNotFound]:"Module has no export with provided identifier",[l.ExecutionErrorCodes.ModulesNotSupported]:"Current profile does not support modules",[l.ExecutionErrorCodes.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[l.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[l.ExecutionErrorCodes.FieldNotFound]:"Key not found - {key}",[l.ExecutionErrorCodes.CircularModules]:"Circular module dependencies are not allowed",[l.ExecutionErrorCodes.Cancelled]:"Execution cancelled",
[l.ExecutionErrorCodes.UnsupportedHashType]:"Type not supported in hash function",[l.ExecutionErrorCodes.IllegalResult]:"Value is not a supported return type",[l.ExecutionErrorCodes.PortalRequired]:"Portal is required",[l.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[l.ExecutionErrorCodes.WrongNumberOfParameters]:"Call with wrong number of parameters",[l.ExecutionErrorCodes.Unrecognised]:"Unrecognised code structure",[l.ExecutionErrorCodes.UnrecognisedType]:"Unrecognised type",[l.ExecutionErrorCodes.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",
[l.ExecutionErrorCodes.BooleanConditionRequired]:"Conditions must use booleans",[l.ExecutionErrorCodes.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[l.ExecutionErrorCodes.NoFunctionInArray]:"Arrays cannot contain functions.",[l.ExecutionErrorCodes.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[l.ExecutionErrorCodes.KeyAccessorMustBeString]:"Accessor must be a string",[l.ExecutionErrorCodes.KeyMustBeString]:"Object keys must be a string",[l.ExecutionErrorCodes.Immutable]:"Object is immutable",
[l.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[l.ExecutionErrorCodes.UnexpectedToken]:"Unexpected token",[l.ExecutionErrorCodes.MemberOfNull]:"Cannot access property of null object",[l.ExecutionErrorCodes.MaximumCallDepth]:"Exceeded maximum function depth",[l.ExecutionErrorCodes.OutOfBounds]:"Out of bounds",[l.ExecutionErrorCodes.InvalidIdentifier]:"Identifier not recognised",[l.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[l.ExecutionErrorCodes.CallNonFunction]:"Expression is not a function",
[l.ExecutionErrorCodes.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[l.ExecutionErrorCodes.AssignModuleFunction]:"Cannot assign function to module variable",[l.ExecutionErrorCodes.UnsupportedUnaryOperator]:"Unsupported unary operator",[l.ExecutionErrorCodes.UnsupportedOperator]:"Unsupported operator",[l.ExecutionErrorCodes.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[l.ExecutionErrorCodes.LogicExpressionOrAnd]:"Logical expression can only be combined with || or \x26\x26"};
let t=function(e){function c(...k){return m.call(this,...k)}h._inherits(c,e);var m=h._createSuper(c);return h._createClass(c)}(h._wrapNativeSuper(Error)),p=function(e){function c(k,n){k=m.call(this,D(n)+k.message,{cause:k});k.loc=null;Error.captureStackTrace&&Error.captureStackTrace(h._assertThisInitialized(k),c);n&&n.loc&&(k.loc=n.loc);return k}h._inherits(c,e);var m=h._createSuper(c);return h._createClass(c)}(t),g=function(e){function c(k,n,x,q){k=m.call(this,"Execution error - "+D(x)+E(w[n],q));
k.loc=null;k.declaredRootClass="esri.arcade.arcadeexecutionerror";Error.captureStackTrace&&Error.captureStackTrace(h._assertThisInitialized(k),c);x&&x.loc&&(k.loc=x.loc);return k}h._inherits(c,e);var m=h._createSuper(c);return h._createClass(c)}(h._wrapNativeSuper(Error)),f=function(e){function c(k,n,x,q){k=m.call(this,"Compilation error - "+D(x)+E(w[n],q));k.loc=null;k.declaredRootClass="esri.arcade.arcadecompilationerror";Error.captureStackTrace&&Error.captureStackTrace(h._assertThisInitialized(k),
c);x&&x.loc&&(k.loc=x.loc);return k}h._inherits(c,e);var m=h._createSuper(c);return h._createClass(c)}(h._wrapNativeSuper(Error)),d=function(e){function c(){var k=m.call(this,"Uncompilable code structures");k.declaredRootClass="esri.arcade.arcadeuncompilableerror";Error.captureStackTrace&&Error.captureStackTrace(h._assertThisInitialized(k),c);return k}h._inherits(c,e);var m=h._createSuper(c);return h._createClass(c)}(h._wrapNativeSuper(Error));l.ModuleErrorCodes=void 0;(function(e){e.UnrecognisedUri=
"UnrecognisedUri";e.UnsupportedUriProtocol="UnsupportedUriProtocol"})(l.ModuleErrorCodes||(l.ModuleErrorCodes={}));const b={[l.ModuleErrorCodes.UnrecognisedUri]:"Unrecognised uri - {uri}",[l.ModuleErrorCodes.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let a=function(e){function c(k,n){k=m.call(this,E(b[k],n));k.declaredRootClass="esri.arcade.arcademoduleerror";Error.captureStackTrace&&Error.captureStackTrace(h._assertThisInitialized(k),c);return k}h._inherits(c,e);var m=h._createSuper(c);
return h._createClass(c)}(h._wrapNativeSuper(Error));l.ArcadeCompilationError=f;l.ArcadeExecutionError=g;l.ArcadeUncompilableError=d;l.ErrorWithCause=t;l.ExecutionErrorMessages=w;l.LocatableArcadeExecutionError=p;l.ModuleError=a;l.ModuleErrorMessages=b;l.doSubstitutions=E;l.ensureArcadeExecutionError=function(e,c,m){return"esri.arcade.arcadeexecutionerror"===m.declaredRootClass||"esri.arcade.arcadecompilationerror"===m.declaredRootClass?null===m.loc&&c&&c.loc?new p(m,{cause:m}):m:c&&c.loc?new p(m,
{cause:m}):m};l.parsingValidationMessage=function(e,c,m){return"Parsing error - "+D(e)+E(w[c],m)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/arcadeTimeUtils":function(){define("exports ../chunks/_rollupPluginBabelHelpers ./ArcadeDate ../layers/support/FieldsIndex ../time/TimeReference ../chunks/datetime ../time/timeReferenceUtils".split(" "),function(l,h,D,E,w,t,p){function g(d){return d?.timeZoneIANA?d?.timeZoneIANA:d?.timeZone?p.convertLegacyTimeZone(d,""):""}let f=
function(){function d(){this.dateTimeReferenceMetaData=null;this._fieldTimeZoneIndex={};this._ianaLayerDateFields=this._ianaEditFields=this._ianaTimeInfo=this._ianaPreferred=this._fieldIndex=null}d.create=function(a,e){const c=new d;c.dateTimeReferenceMetaData=e;c._fieldIndex=a instanceof E?a:new E(a);return c};d.createFromLayer=function(a){if(!a)return null;if(!a.fieldsIndex)return!a.declaredClass&&a.fields?d.create(a.fields,a):null;const e=new d;e._fieldIndex=a.fieldsIndex;e.dateTimeReferenceMetaData=
{timeInfo:a?.timeInfo?.toJSON()??null,editFieldsInfo:a?.editFieldsInfo?.toJSON()??null,dateFieldsTimeReference:a?.dateFieldsTimeReference?.toJSON()??null,preferredTimeReference:a?.preferredTimeReference?.toJSON()??null,datesInUnknownTimezone:!0===a?.datesInUnknownTimezone};return e};var b=d.prototype;b.fieldTimeZone=function(a){a=this._fieldIndex?.get(a);if(!a||"date"!==a.type&&"esriFieldTypeDate"!==a.type)return null;var e=this._fieldTimeZoneIndex[a.name];if(void 0!==e)return e;e=[{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.creationDateField,
timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.editDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.startTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,
isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.endTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone}];for(var c of e)if(c.field===a.name)return c=this.convertToIANA(c.timeReference,c.isunknown),this._fieldTimeZoneIndex[a.name]=c;c=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone);
return this._fieldTimeZoneIndex[a.name]=c};b.convertToIANA=function(a,e){return e?"unknown":g(a)};h._createClass(d,[{key:"layerPreferredTimeZone",get:function(){if(null!==this._ianaPreferred)return this._ianaPreferred;this._ianaPreferred="";return this._ianaPreferred=this.convertToIANA(this.dateTimeReferenceMetaData?.preferredTimeReference,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}},{key:"layerTimeInfoTimeZone",get:function(){if(null!==this._ianaTimeInfo)return this._ianaTimeInfo;
this._ianaTimeInfo="";return this._ianaTimeInfo=this.convertToIANA(this.dateTimeReferenceMetaData?.timeInfo?.timeReference,!1)}},{key:"layerEditFieldsTimeZone",get:function(){if(null!==this._ianaEditFields)return this._ianaEditFields;this._ianaEditFields="";return this._ianaEditFields=this.convertToIANA(this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}},{key:"layerDateFieldsTimeZone",get:function(){if(null!==this._ianaLayerDateFields)return this._ianaLayerDateFields;
this._ianaLayerDateFields="";return this._ianaLayerDateFields=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone)}}]);return d}();l.DateTimeReferenceFieldIndex=f;l.convertTimeReference=function(d){if(!d)return null;d instanceof w&&(d=g(d.toJSON()));if(d instanceof t.Zone)return d;if("unknown"===d.toLowerCase())return D.UnknownTimeZone.instance;if("system"===d.toLowerCase())return t.SystemZone.instance;if("utc"===d.toLowerCase())return t.FixedOffsetZone.utcInstance;
if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(d)){const b=t.FixedOffsetZone.parseSpecifier("UTC"+(d.startsWith("+")||d.startsWith("-")?"":"+")+d);if(b)return b}d=t.IANAZone.create(d);if(!d.isValid)throw new D.ArcadeDateError(D.ArcadeDateErrorCodes.TimeZoneNotRecognised);return d};l.convertToIANA=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports","../../core/maybe"],function(l,h){function D(w,t,p,g,f,d,b=1){d=f?d?4:3:d?3:2;let a=
p,e=p+d,c=0,m=0,k=p=0,n=0;for(let x=0,q=g-1;x<q;x++,a+=d,e+=d){g=t[a];const B=t[a+1],y=t[a+2],u=t[e],v=t[e+1],r=t[e+2];let z=g*v-u*B;k+=z;c+=(g+u)*z;m+=(B+v)*z;f&&(z=g*r-u*y,p+=(y+r)*z,n+=z);g<w[0]&&(w[0]=g);g>w[1]&&(w[1]=g);B<w[2]&&(w[2]=B);B>w[3]&&(w[3]=B);f&&(y<w[4]&&(w[4]=y),y>w[5]&&(w[5]=y))}0<k*b&&(k*=-1);0<n*b&&(n*=-1);if(!k)return null;w=[c,m,.5*k];f&&(w[3]=p,w[4]=.5*n);return w}function E(w,t,p,g,f){f=g?f?4:3:f?3:2;let d=t,b=t+f,a=0,e=0,c=0,m=0;for(let q=0,B=p-1;q<B;q++,d+=f,b+=f){var k=
w[d];const y=w[d+1],u=w[d+2],v=w[b],r=w[b+1],z=w[b+2];if(g){var n=v-k;var x=r-y;const A=z-u;n=Math.sqrt(n*n+x*x+A*A)}else n=v-k,x=r-y,n=Math.sqrt(n*n+x*x);n&&(a+=n,g?(k=[k+.5*(v-k),y+.5*(r-y),u+.5*(z-u)],e+=n*k[0],c+=n*k[1],m+=n*k[2]):(k=[k+.5*(v-k),y+.5*(r-y)],e+=n*k[0],c+=n*k[1]))}return 0<a?g?[e/a,c/a,m/a]:[e/a,c/a]:0<p?g?[w[t],w[t+1],w[t+2]]:[w[t],w[t+1]]:null}l.getCentroidOptimizedGeometry=function(w,t,p,g,f){if(h.isNone(t)||!t.lengths.length)return null;const d="upperLeft"===f?.originPosition?
-1:1;w.lengths.length&&(w.lengths.length=0);w.coords.length&&(w.coords.length=0);f=w.coords;const b=[],a=p?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:e,coords:c}=t,m=p?g?4:3:g?3:2;let k=0;for(var n of e){const x=D(a,c,k,n,p,g,d);x&&b.push(x);k+=n*m}b.sort((x,q)=>{let B=d*x[2]-d*q[2];
0===B&&p&&(B=x[4]-q[4]);return B});b.length&&(n=6*b[0][2],f[0]=b[0][0]/n,f[1]=b[0][1]/n,p&&(n=6*b[0][4],f[2]=0!==n?b[0][3]/n:0),f[0]<a[0]||f[0]>a[1]||f[1]<a[2]||f[1]>a[3]||p&&(f[2]<a[4]||f[2]>a[5]))&&(f.length=0);if(!f.length)if(t=t.lengths[0]?E(c,0,e[0],p,g):null)f[0]=t[0],f[1]=t[1],p&&2<t.length&&(f[2]=t[2]);else return null;return w};l.lineCentroid=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/OptimizedFeature ./FeatureSetReader".split(" "),
function(l,h,D,E,w,t){function p({coords:f,lengths:d}){let b=0;for(const a of d){for(d=1;d<a;d++)f[2*(b+d)]+=f[2*(b+d)-2],f[2*(b+d)+1]+=f[2*(b+d)-1];b+=a}}let g=function(f){function d(a,e,c){a=b.call(this,a,c);a._exceededTransferLimit=!1;a._featureIndex=-1;a._dateFields=new Set;a._geometryType=c?.geometryType;a._features=e;return a}h._inherits(d,f);var b=h._createSuper(d);d.fromFeatures=function(a,e){const {objectIdField:c,geometryType:m}=e,k=E.convertFromFeatures([],a,m,!1,!1,c);for(let n=0;n<k.length;n++)k[n].displayId=
a[n].displayId;return d.fromOptimizedFeatures(k,e)};d.fromFeatureSet=function(a,e){a=E.convertFromFeatureSet(a,e.objectIdField);return d.fromOptimizedFeatureSet(a,e)};d.fromOptimizedFeatureSet=function(a,e){const {features:c}=a;e=d.fromOptimizedFeatures(c,e);e._exceededTransferLimit=a.exceededTransferLimit;e._transform=a.transform;for(const m of a.fields)"esriFieldTypeDate"===m.type&&e._dateFields.add(m.name);return e};d.fromOptimizedFeatures=function(a,e,c){const m=t.FeatureSetReader.createInstance();
a=new d(m,a,e);a._transform=c;return a};f=d.prototype;f.removeIds=function(a){const e=new Set(a);this._features=this._features.filter(c=>!(c.objectId&&e.has(c.objectId)))};f.append=function(a){for(const e of a)this._features.push(e)};f.getSize=function(){return this._features.length};f.getCursor=function(){return this.copy()};f.getQuantizationTransform=function(){return this._transform};f.getAttributeHash=function(){let a="";for(const e in this._current.attributes)a+=this._current.attributes[e];return a};
f.getIndex=function(){return this._featureIndex};f.setIndex=function(a){this._featureIndex=a};f.getObjectId=function(){return this._current?.objectId};f.getDisplayId=function(){return this._current.displayId};f.setDisplayId=function(a){this._current.displayId=a};f.getGroupId=function(){return this._current.groupId};f.setGroupId=function(a){this._current.groupId=a};f.copy=function(){const a=new d(this.instance,this._features,this.fullSchema());this.copyInto(a);return a};f.next=function(){for(;++this._featureIndex<
this._features.length&&!this._getExists(););return this._featureIndex<this._features.length};f.readLegacyFeature=function(){return E.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};f.readOptimizedFeature=function(){return this._current};f.readLegacyPointGeometry=function(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null};f.readLegacyGeometry=function(){const a=this.readGeometry();return E.convertToGeometry(a,this.geometryType,this.hasZ,this.hasM)};f.readLegacyCentroid=
function(){const a=this.readCentroid();return D.isNone(a)?null:{x:a.coords[0]*this._sx+this._tx,y:a.coords[1]*this._sy+this._ty}};f.readGeometryArea=function(){return w.hasGeometry(this._current)?E.getQuantizedArea(this._current.geometry,2):0};f.readUnquantizedGeometry=function(){var a=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!a)return a;a=a.clone();p(a);return a};f.readHydratedGeometry=function(){var a=this._current.geometry;if(D.isNone(a))return null;a=a.clone();D.isSome(this._transform)&&
E.unquantizeOptimizedGeometry(a,a,this.hasZ,this.hasM,this._transform);return a};f.getXHydrated=function(){if(!w.hasGeometry(this._current))return 0;const a=this._current.geometry.coords[0],e=this.getQuantizationTransform();return D.isNone(e)?a:a*e.scale[0]+e.translate[0]};f.getYHydrated=function(){if(!w.hasGeometry(this._current))return 0;const a=this._current.geometry.coords[1],e=this.getQuantizationTransform();return D.isNone(e)?a:e.translate[1]-a*e.scale[1]};f.getX=function(){return w.hasGeometry(this._current)?
this._current.geometry.coords[0]*this._sx+this._tx:0};f.getY=function(){return w.hasGeometry(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0};f.readGeometry=function(){if(!w.hasGeometry(this._current)){if(D.isSome(this._current.centroid)){const [c,m]=this._current.centroid.coords;return this.createQuantizedExtrudedQuad(c,m)}return null}const a=this._current.geometry.clone();if(a.isPoint)return a.coords[0]=a.coords[0]*this._sx+this._tx,a.coords[1]=a.coords[1]*this._sy+this._ty,
a;let e=0;for(const c of a.lengths)a.coords[2*e]=a.coords[2*e]*this._sx+this._tx,a.coords[2*e+1]=a.coords[2*e+1]*this._sy+this._ty,e+=c;return a};f.readCentroid=function(){return w.hasGeometry(this._current)?this._computeCentroid():this._current.centroid};f.hasField=function(a){return a in this._current.attributes?!0:this.getFieldNames().map(e=>e.toLowerCase()).includes(a.toLowerCase())};f.getFieldNames=function(){return Object.keys(this._current.attributes)};f._readAttribute=function(a,e){var c=
this._current.attributes[a];if(void 0!==c)return null!=c&&e&&this._dateFields.has(a)?new Date(c):c;c=this.readAttributes();a=a?.toLocaleLowerCase().trim();for(const m in c)if(m.toLocaleLowerCase().trim()===a)return a=this._current.attributes[m],null!=a&&e&&this._dateFields.has(m)?new Date(a):a};f.copyInto=function(a){h._get(h._getPrototypeOf(d.prototype),"copyInto",this).call(this,a);a._featureIndex=this._featureIndex;a._transform=this._transform;a._dateFields=this._dateFields};f._readAttributes=
function(){return this._current.attributes};h._createClass(d,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);
return d}(t.FeatureSetReader);l.FeatureSetReaderJSON=g;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/screenUtils ../../../../chunks/rbush ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../symbols/cim/CIMSymbolDrawHelper ../../../../symbols/cim/CIMSymbolHelper ./GraphicStoreItem ./graphicsUtils".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a){function e(x,q,B,y,u){m.minX=q;m.minY=B;m.maxX=y;m.maxY=u;return x.search(m)}function c(x){return{minX:x.bounds[0],minY:x.bounds[1],maxX:x.bounds[2],maxY:x.bounds[3]}}const m={minX:0,minY:0,maxX:0,maxY:0},k=w.create(),n=(x,q)=>{const B=a.graphicGeometryToNumber(x.graphic),y=a.graphicGeometryToNumber(q.graphic);return B===y?q.zorder-x.zorder:B-y};return function(){function x(B,y,u,v,r,z,A){this._graphics=v;this._onAdd=r;this._onRemove=z;this._hashToCIM=A;this._index=
E.rbush(9,c);this._itemByGraphic=new Map;this._inflatedSizeHelper=new d.CIMSymbolInflatedSizeHelper;this._tileInfoView=B;this._uidFieldName=u;if(B=B.getClosestInfoForScale(y))this._resolution=this._tileInfoView.getTileResolution(B.level)}var q=x.prototype;q.setResourceManager=function(B){this._cimResourceManager=B;this._hittestDrawHelper=new f.HittestDrawHelper(B)};q.hitTest=function(B,y,u,v,r){B=p.normalizeMapX(B,this._tileInfoView.spatialReference);var z=.5*v*window.devicePixelRatio*u;k[0]=B-z;
k[1]=y-z;k[2]=B+z;k[3]=y+z;u=.5*v*(u+a.PIXEL_BUFFER);y=e(this._index,B-u,y-u,B+u,y+u);if(!y||0===y.length)return[];B=[];u=w.create();z=w.create();for(var A of y){const {geometry:C,symbolResource:F}=A;this._getSymbolBounds(u,F,C,z,r);z[3]=z[2]=z[1]=z[0]=0;w.intersects(u,k)&&A.graphic?.visible&&B.push(A)}if(0===B.length)return[];A=this._hittestDrawHelper;y=[];for(const C of B){const {geometry:F,symbolResource:G}=C,{hash:H,textInfo:K}=G;(B=this._hashToCIM.get(H))&&A.hitTest(k,B.symbol,F,K,r,v)&&y.push(C)}y.sort(n);
return y.map(C=>C.graphic)};q.getGraphicsData=function(B,y,u){const v=this._searchForItems(y);if(0===v.length||0===u.length)return[];v.sort((H,K)=>H.zorder-K.zorder);v[0].insertAfter=-1;for(var r=1;r<v.length;r++)v[r].insertAfter=v[r-1].graphic.uid;v.sort((H,K)=>H.graphic.uid-K.graphic.uid);u.sort((H,K)=>H.uid-K.uid);let z=r=0,A;const C=y.resolution,F=[],G={originPosition:"upperLeft",scale:[C,C],translate:[y.bounds[0],y.bounds[3]]};for(const H of u){for(z=-2;r<v.length;)if(A=v[r],r++,H.uid===A.graphic.uid){z=
A.insertAfter;break}if(!A?.geometry||-2===z)continue;u=A.getGeometryQuantized(G,y.bounds,this._tileInfoView.spatialReference,C);const K={...A.graphic.attributes};K[this._uidFieldName]=H.uid;null==A.groupId&&(A.groupId=B.createTemplateGroup(A.symbol,null));F.push({centroid:b.getCentroidQuantized(A,G),geometry:u,attributes:K,symbol:A.symbol,groupId:A.groupId,insertAfter:z,zorder:A.zorder})}F.sort((H,K)=>H.zorder-K.zorder);return F};q.queryTileData=function(B,y){if(0===this._graphics.length)return[];
const {bounds:u,resolution:v}=y,r=this._searchForItems(y),z=[];if(0===r.length)return z;this._createTileGraphics(z,B,r,{originPosition:"upperLeft",scale:[v,v],translate:[u[0],u[3]]},y);return z};q.has=function(B){return this._itemByGraphic.has(B)};q.getBounds=function(B){return(B=this._itemByGraphic.get(B))?B.bounds:null};q.getAllBounds=function(){return Array.from(this._itemByGraphic.values()).filter(B=>B.graphic.visible).map(B=>B.bounds)};q.addOrModify=function(B,y,u){if(B&&!h.isNone(y)){this.has(B)&&
this.remove(B);this._onAdd(B);var v=[0,0,0,0],r=this._getSymbolBounds(null,y,u,v,0);y=b.acquire(B,y,u,h.isSome(r)?r:null,v);this._itemByGraphic.set(B,y);u&&this._index.insert(y);return y.bounds}};q.remove=function(B){if(this._itemByGraphic.has(B)){this._onRemove(B);var y=this._itemByGraphic.get(B);y?.bounds&&this._index.remove(y);this._itemByGraphic.delete(B)}};q.updateZ=function(){const B=this._graphics.items;for(let u=0;u<B.length;u++){var y=B[u];if(y=this._itemByGraphic.get(y))y.zorder=u}};q.update=
function(B,y,u){const v=this._itemByGraphic.get(B);v.groupId=null;const r=w.clone(v.bounds);this._index.remove(v);const z=this._getSymbolBounds(v.bounds,y,u,v.size,0);h.isSome(z)&&v.set(B,y,u,z,v.size);u&&this._index.insert(v);return{oldBounds:r,newBounds:v.bounds}};q.updateLevel=function(B){if(this._resolution!==B){this._resolution=B;this._index.clear();var y=this._itemByGraphic;B=[];for(const [,u]of y)y=this._getSymbolBounds(u.bounds,u.symbolResource,u.geometry,u.size,0),u.geometry&&h.isSome(y)&&
(u.bounds=y,B.push(u));this._index.load(B)}};q.clear=function(){this._itemByGraphic.clear();this._index.clear()};q._createTileGraphics=function(B,y,u,v,r){const z=this._uidFieldName,A=this._tileInfoView.spatialReference,{bounds:C,resolution:F}=r;u.sort((J,N)=>J.zorder-N.zorder);let G,H,K;for(let J=0;J<u.length;J++){H=u[J];r=H.graphic;G=H.getGeometryQuantized(v,C,A,F);K=0===J?-1:u[J-1].graphic.uid;const N={...H.graphic.attributes};N[z]=r.uid;null==H.groupId&&(H.groupId=y.createTemplateGroup(H.symbol,
null));B.push({centroid:b.getCentroidQuantized(H,v),geometry:G,attributes:N,symbol:H.symbol,groupId:H.groupId,insertAfter:K,zorder:H.zorder})}};q._searchForItems=function(B){var y=this._tileInfoView.spatialReference,u=B.bounds,v=g.getInfo(y);if(v&&y.isWrappable){const [r,z]=v.valid;y=1E-5>Math.abs(u[2]-z);v=1E-5>Math.abs(u[0]-r);if(!(y&&v||!y&&!v))return B=B.resolution,B=y?w.create([r,u[1],r+B*a.PIXEL_BUFFER,u[3]]):w.create([z-B*a.PIXEL_BUFFER,u[1],z,u[3]]),u=e(this._index,u[0],u[1],u[2],u[3]),B=
e(this._index,B[0],B[1],B[2],B[3]),[...(new Set([...u,...B]))]}return e(this._index,u[0],u[1],u[2],u[3])};q._getSymbolBounds=function(B,y,u,v,r){if(!y||!y.symbol||!u)return null;B||(B=w.create());t.getBoundsXY(B,u);if(!v||0===v[0]&&0===v[1]&&0===v[2]&&0===v[3]){const {hash:z,textInfo:A}=y;y=this._hashToCIM.get(z);if(!y)return null;v||(v=[0,0,0,0]);r=this._inflatedSizeHelper.getSymbolInflateSize(v,y.symbol,this._cimResourceManager,r,A);v[0]=D.pt2px(r[0]);v[1]=D.pt2px(r[1]);v[2]=D.pt2px(r[2]);v[3]=
D.pt2px(r[3])}r=this._resolution;v=d.CIMSymbolInflatedSizeHelper.safeSize(v);B[0]-=v*r;B[1]-=v*r;B[2]+=v*r;B[3]+=v*r;return B};return l._createClass(x)}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../geometry/support/spatialReferenceUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry".split(" "),
function(l,h,D,E,w,t,p,g,f){function d(e){e.coords.length=0;e.lengths.length=0}const b=new f,a=new f;f=function(){function e(){this.bounds=D.create();this.graphic=null}e.acquire=function(m=null,k,n,x,q){let B;0===e._pool.length?B=new e:(B=e._pool.pop(),this._set.delete(B));B.acquire(m,k,n,x,q);return B};e.release=function(m){m&&!this._set.has(m)&&(m.release(),this._pool.push(m),this._set.add(m))};e.getCentroidQuantized=function(m,k){if(w.isPolygon(m.geometry)){const n=m.symbol;if(h.isNone(n))return null;
if(0<n?.layers.length&&n.layers.some(x=>"text"===x.type||"marker"===x.type))return m=E.polygonCentroid(m.geometry),null!==m?t.quantizePoint(k,{},{x:m[0],y:m[1]},!1,!1):null}return null};var c=e.prototype;c.acquire=function(m=null,k,n,x,q){m&&this.set(m,k,n,x,q)};c.release=function(){this.geometry=this.symbolResource=this.graphic=null};c.set=function(m,k,n,x,q){this.graphic=m;this.geometry=n;this.symbolResource=k;this.bounds=x;q&&(this.size=q)};c.getGeometryQuantized=function(m,k,n,x){var q=this.geometry;
const B=w.getJsonType(q);if(h.isNone(B))return null;switch(B){case "esriGeometryPolygon":({rings:q}=q);if(!q||0===q.length)return null;n=1===q.length&&2===q[0].length?t.quantizeGeometry(m,{paths:[[q[0][0],q[0][1]]]}):t.quantizeGeometry(m,this.geometry);if(!n&&(n=t.quantizeGeometry(m,{x:q[0][0][0],y:q[0][0][1]}))){const {x:u,y:v}=n;return{rings:[[[u-1,v],[1,-1],[1,1],[-1,1],[-1,-1]]]}}return n;case "esriGeometryPolyline":return d(b),d(a),n=q.hasZ??!1,x=q.hasM??!1,g.convertFromPolyline(b,q),g.generalizeOptimizedGeometry(a,
b,n,x,"esriGeometryPolyline",m.scale[0]),g.quantizeOptimizedGeometry(b,a,n,x,"esriGeometryPolyline",m),g.convertToPolyline(b,q.hasZ??!1,q.hasM??!1);case "esriGeometryMultipoint":const y=.5*x*Math.max(Math.abs(this.size[0])+this.size[2]-this.size[0],Math.abs(this.size[1])+this.size[3]-this.size[1]);n=p.getInfo(n);q=q.points;if(n){const [u,v]=n.valid,r=v-u;q=q.filter(z=>{if(z[0]+y>v||z[0]-y<u){const A=[...z];A[0]=z[0]+y>v?A[0]-r:A[0]+r;return D.containsPointWithMargin(k,z,y)||D.containsPointWithMargin(k,
A,y)}return D.containsPointWithMargin(k,z,y)})}return 0===q.length?{points:q}:t.quantizeGeometry(m,{points:q})}return t.quantizeGeometry(m,this.geometry)};l._createClass(e,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return e}();f._pool=[];f._set=new Set;return f})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(l,h,D,E,w,t,p,g,f){l.GraphicsView=d=>{d=function(b){function a(){var c=e.apply(this,arguments);c.graphics=null;c.renderer=null;return c}h._inherits(a,b);var e=h._createSuper(a);return h._createClass(a)}(E.IdentifiableMixin(d));D.__decorate([w.property()],d.prototype,"graphics",void 0);D.__decorate([w.property()],d.prototype,"renderer",void 0);D.__decorate([w.property()],d.prototype,"updating",void 0);D.__decorate([w.property()],d.prototype,"view",void 0);return d=D.__decorate([f.subclass("esri.views.layers.GraphicsView")],
d)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/webgl/enums","./BaseGraphicContainer"],function(l,h,D){return function(E){function w(){return t.apply(this,arguments)}l._inherits(w,E);var t=l._createSuper(w);E=w.prototype;E.renderChildren=function(p){this.attributeView.update();this.children.some(g=>g.hasData)&&(this.attributeView.bindTextures(p.context,
!1),l._get(l._getPrototypeOf(w.prototype),"renderChildren",this).call(this,p),p.drawPhase===h.WGLDrawPhase.MAP&&this._renderChildren(p),this.hasHighlight()&&p.drawPhase===h.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(p),this._boundsRenderer&&this._boundsRenderer.doRender(p))};E._renderHighlight=function(p){var {painter:g}=p;g=g.effects.highlight;g.bind(p);this._renderChildren(p,g.defines);g.draw(p);g.unbind()};return l._createClass(w)}(D)})},"esri/views/2d/layers/graphics/BaseGraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers",
"../../../../core/maybe","../../engine/FeatureContainer","./GraphicBoundsRenderer","../../../webgl/enums"],function(l,h,D,E,w){return function(t){function p(f){f=g.call(this,f);f.hasHighlight=()=>!0;return f}l._inherits(p,t);var g=l._createSuper(p);t=p.prototype;t.destroy=function(){l._get(l._getPrototypeOf(p.prototype),"destroy",this).call(this);this._boundsRenderer=h.destroyMaybe(this._boundsRenderer)};t.enableRenderingBounds=function(f){this._boundsRenderer=new E(f);this.requestRender()};t.onTileData=
function(f,d){f.patch(d);this.contains(f)||this.addChild(f);this.requestRender()};t.onTileError=function(f){f.clear();this.contains(f)||this.addChild(f)};t._renderChildren=function(f,d){for(const b of this.children)b.isReady&&b.hasData&&(b.commit(f),f.context.setStencilFunction(w.CompareFunction.EQUAL,b.stencilRef,255),b.getDisplayList().replay(f,b,d))};l._createClass(p,[{key:"hasLabels",get:function(){return!1}}]);return p}(D.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../core/Queue ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),
function(l,h,D,E,w,t,p){t=function(g){function f(b){var a=d.call(this,b);a._rendererInfo=new p.WGLRendererInfo;a._materialItemsRequestQueue=new E;a.attributeView=new w.AttributeStoreView(()=>a.onAttributeStoreUpdate());return a}h._inherits(f,g);var d=h._createSuper(f);g=f.prototype;g.destroy=function(){this.children.forEach(b=>b.destroy());this.removeAllChildren();this.attributeView.destroy();this._materialItemsRequestQueue.clear()};g.setRendererInfo=function(b,a,e){this._rendererInfo.setInfo(b,a,
e);this.requestRender()};g.getMaterialItems=async function(b,a){if(!b||0===b.length)return[];const e=D.createResolver();this._materialItemsRequestQueue.push({items:b,abortOptions:a,resolver:e});this.requestRender();return e.promise};g.doRender=function(b){b.context.capabilities.enable("textureFloat");b.context.capabilities.enable("vao");if(0<this._materialItemsRequestQueue.length){let a=this._materialItemsRequestQueue.pop();for(;a;)this._processMaterialItemRequest(b,a),a=this._materialItemsRequestQueue.pop()}h._get(h._getPrototypeOf(f.prototype),
"doRender",this).call(this,b)};g.renderChildren=function(b){for(const a of this.children)a.commit(b);this._rendererInfo.update(b.state);h._get(h._getPrototypeOf(f.prototype),"renderChildren",this).call(this,b)};g.updateTransforms=function(b){if(this.children.some(a=>a.hasData))for(const a of this.children)a.setTransform(b)};g.createRenderParams=function(b){b=h._get(h._getPrototypeOf(f.prototype),"createRenderParams",this).call(this,b);b.rendererInfo=this._rendererInfo;b.attributeView=this.attributeView;
return b};g.onAttributeStoreUpdate=function(){};g._processMaterialItemRequest=function(b,{items:a,abortOptions:e,resolver:c}){const {painter:m,pixelRatio:k}=b;b=a.map(n=>m.textureManager.rasterizeItem(n.symbol,k,n.glyphIds,e));Promise.all(b).then(n=>{this.stage?(n=n.map((x,q)=>({id:a[q].id,mosaicItem:x})),c.resolve(n)):c.reject()},c.reject)};return h._createClass(f)}(t);l.FeatureContainer=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ./definitions ./DisplayId ./Utils ./util/debug ../../../webgl/enums ../../../webgl/FramebufferObject ../../../webgl/Texture".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c){const m=w.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),k=b.createDebugLogger(b.DEBUG_ATTR_UPDATES,m);let n=function(){function x(B,y,u){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:v,pixelType:r,textureOnly:z}=B;B=d.getPixelArrayCtor(r);this.shared=u;this.pixelType=r;this.size=y;this.textureOnly=z;z||(this.data=new B(t.unwrap(v)));this._resetRange()}var q=x.prototype;q.destroy=function(){t.applySome(this._texture,
B=>B.dispose());for(const B in this._fbos)t.applySome(this._fbos[B],y=>{"0"===B&&y.detachColorTexture();y.dispose()}),this._fbos[B]=null;this._texture=null};q.setData=function(B,y,u){B=f.getDisplayIdTexel(B);const v=t.unwrap(this.data);y=B*this.texelSize+y;!v||y>=v.length||(v[y]=u,this.dirtyStart=Math.min(this.dirtyStart,B),this.dirtyEnd=Math.max(this.dirtyEnd,B))};q.getData=function(B,y){if(t.isNone(this.data))return null;B=f.getDisplayIdTexel(B)*this.texelSize+y;return!this.data||B>=this.data.length?
null:this.data[B]};q.getTexture=function(B){return t.unwrapOr(this._texture,()=>this._initTexture(B))};q.getFBO=function(B,y=0){if(t.isNone(this._fbos[y])){const u={colorTarget:a.TargetType.TEXTURE,depthStencilTarget:a.DepthStencilTargetType.NONE},v=0===y?this.getTexture(B):this._textureDesc;this._fbos[y]=new e.FramebufferObject(B,u,v)}return this._fbos[y]};q.updateTexture=function(B,y){if(!this.locked){try{const u=this.dirtyStart,v=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const r=
t.unwrap(this.data).buffer,z=this.getTexture(B),A=(u-u%this.size)/this.size,C=(v-v%this.size)/this.size,F=A*this.size*4,G=4*(this.size+C*this.size)-F,H=d.getPixelArrayCtor(this.pixelType),K=new H(r,F*H.BYTES_PER_ELEMENT,G),J=this.size;B=C-A+1;if(B>this.size){m.error(new D("mapview-webgl","Out-of-bounds index when updating AttributeData"));return}z.updateData(0,0,A,J,B,K)}catch(u){}y()}};q.update=function(B){const {data:y,start:u,end:v}=B;if(t.isSome(y)&&t.isSome(this.data)){const r=this.data,z=u*
this.texelSize;for(let A=0;A<y.length;A++)B.layout&1<<A%this.texelSize&&(r[z+A]=y[A])}this.dirtyStart=Math.min(this.dirtyStart,u);this.dirtyEnd=Math.max(this.dirtyEnd,v)};q.resize=function(B,y){const u=this.size;this.size=y;this.textureOnly?u!==this.size&&(this._lastTexture=this._texture,this._texture=null):(y=d.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new y(t.unwrap(B.buffer)))};q._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};q._initTexture=function(B){const y=
new c.Texture(B,this._textureDesc,t.unwrapOr(this.data,void 0));if(t.isSome(this._lastTexture)&&this._fbos[0]){const r=this._lastTexture.descriptor.width,z=this._lastTexture.descriptor.height,A=this._lastTexture.descriptor.dataType,C=this._lastTexture.descriptor.pixelFormat,F=this.getFBO(B);var u=d.getPixelBytes(A),v=d.getPixelArrayCtor(A);u=new ArrayBuffer(r*z*u*this.texelSize);v=new v(u);u=B.getBoundFramebufferObject();const {x:G,y:H,width:K,height:J}=B.getViewport();B.bindFramebuffer(F);F.readPixels(0,
0,r,z,C,A,v);y.updateData(0,0,0,2*r,z/2,v);B.setViewport(G,H,K,J);B.bindFramebuffer(u)}this.destroy();return this._texture=y};h._createClass(x,[{key:"_textureDesc",get:function(){return{target:a.TextureType.TEXTURE_2D,wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:a.PixelFormat.RGBA,dataType:this.pixelType,samplingMode:a.TextureSamplingMode.NEAREST,width:this.size,height:this.size}}},{key:"locked",get:function(){return this.pixelType===a.PixelType.UNSIGNED_BYTE&&this.shared&&!this.textureOnly&&
E("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1}},{key:"hasDirty",get:function(){return this.dirtyEnd>=this.dirtyStart}}]);return x}();w=function(){function x(B){this._onUpdate=B;this._locked=this._forceNextUpload=this._initialized=!1}var q=x.prototype;q.initialize=function(B){const {blocks:y,shared:u,size:v}=B;this.shared=u;this.size=v;k("Initializing AttributeStoreView",B);if(t.isNone(this._data))this._data=t.mapMany(y,r=>new n(r,v,u));else for(B=0;B<this._data.length;B++){const r=
this._data[B],z=y[B];t.isSome(z)&&(t.isNone(r)?this._data[B]=new n(z,v,u):r.resize(z,v))}this._initialized=!0};q.destroy=function(){t.applySome(this._data,B=>t.mapMany(B,y=>y.destroy()));t.applySome(this._defaultTexture,B=>B.dispose())};q.isEmpty=function(){return t.isNone(this._data)};q.isUpdating=function(){const B=t.isSome(this._pendingAttributeUpdate);E("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${B}\n  -> hasPendingUpdate ${B}`);return B};q.getBlock=function(B){return t.isNone(this._data)?
null:this._data[B]};q.setLabelMinZoom=function(B,y){this.setData(B,0,1,y)};q.getLabelMinZoom=function(B){return this.getData(B,0,1,255)};q.getFilterFlags=function(B){return this.getData(B,0,0,0)};q.getVVSize=function(B){return this.getData(B,g.ATTRIBUTE_DATA_VV,0,0)};q.getData=function(B,y,u,v){if(!this._data)return 0;y=t.unwrap(this._data)[y];if(t.isNone(y))return 0;B=y.getData(B,u);return t.isSome(B)?B:v};q.setData=function(B,y,u,v){y=t.unwrap(this._data)[y];t.unwrap(y).setData(B,u,v)};q.lockTextureUpload=
function(){this._locked=!0};q.unlockTextureUpload=function(){this._locked=!1};q.forceTextureUpload=function(){this._forceNextUpload=!0};q.requestUpdate=async function(B){if(this._pendingAttributeUpdate)m.error(new D("mapview-webgl","Tried to update attribute data with a pending update"));else{var y=p.createResolver();k("AttributeStoreView Update Requested",B);this._pendingAttributeUpdate={data:B,resolver:y};this._onUpdate();return y.promise}};q.update=function(){if(this._initialized&&t.isSome(this._pendingAttributeUpdate)){E("esri-2d-update-debug")&&
console.debug("AttributeStoreView::update");const {data:B,resolver:y}=this._pendingAttributeUpdate,u=t.unwrap(this._data);for(let v=0;v<B.blocks.length;v++){const r=B.blocks[v];t.applySome(u[v],z=>t.applySome(r,A=>{k(`Updating block ${v}`,A);z.update(A)}))}this._pendingAttributeUpdate=null;y();this._onUpdate()}};q.bindTextures=function(B,y=!0){const u=this._getDefaultTexture(B);if(this._initialized){var v=t.unwrap(this._data);if(!this._locked||this._forceNextUpload)t.forEachSome(v,r=>r.updateTexture(B,
()=>this._onUpdate())),this._forceNextUpload=!1;B.bindTexture(t.mapOr(v[g.ATTRIBUTE_DATA_FILTER_FLAGS],u,r=>r.getTexture(B)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_0);y&&(B.bindTexture(t.mapOr(v[g.ATTRIBUTE_DATA_GPGPU],u,r=>r.getTexture(B)),g.TEXTURE_BINDING_GPGPU),B.bindTexture(t.mapOr(v[g.ATTRIBUTE_DATA_ANIMATION],u,r=>r.getTexture(B)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_1),B.bindTexture(t.mapOr(v[g.ATTRIBUTE_DATA_VV],u,r=>r.getTexture(B)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_2),B.bindTexture(t.mapOr(v[g.ATTRIBUTE_DATA_DD1],
u,r=>r.getTexture(B)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_3),B.bindTexture(t.mapOr(v[g.TEXTURE_BINDING_ATTRIBUTE_DATA_4],u,r=>r.getTexture(B)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_4),B.bindTexture(t.mapOr(v[g.TEXTURE_BINDING_ATTRIBUTE_DATA_5],u,r=>r.getTexture(B)),g.TEXTURE_BINDING_ATTRIBUTE_DATA_5))}else B.bindTexture(u,g.TEXTURE_BINDING_ATTRIBUTE_DATA_0),y&&(B.bindTexture(u,g.TEXTURE_BINDING_ATTRIBUTE_DATA_1),B.bindTexture(u,g.TEXTURE_BINDING_ATTRIBUTE_DATA_2),B.bindTexture(u,g.TEXTURE_BINDING_ATTRIBUTE_DATA_3),
B.bindTexture(u,g.TEXTURE_BINDING_ATTRIBUTE_DATA_4),B.bindTexture(u,g.TEXTURE_BINDING_ATTRIBUTE_DATA_5),B.bindTexture(u,g.TEXTURE_BINDING_GPGPU))};q._getDefaultTexture=function(B){t.isNone(this._defaultTexture)&&(this._defaultTexture=new c.Texture(B,{wrapMode:a.TextureWrapMode.CLAMP_TO_EDGE,pixelFormat:a.PixelFormat.RGBA,dataType:a.PixelType.UNSIGNED_BYTE,samplingMode:a.TextureSamplingMode.NEAREST,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return h._createClass(x)}();l.AttributeStoreView=
w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(l,h,D,E,w,t){const p=(g,f)=>0!==g.key.level-f.key.level?g.key.level-f.key.level:0!==g.key.row-f.key.row?g.key.row-f.key.row:g.key.col-f.key.col;return function(g){function f(b){var a=d.call(this);a._tileInfoView=b;
return a}l._inherits(f,g);var d=l._createSuper(f);g=f.prototype;g.renderChildren=function(b){this.sortChildren(p);this.setStencilReference(b);l._get(l._getPrototypeOf(f.prototype),"renderChildren",this).call(this,b)};g.createRenderParams=function(b){const {state:a}=b;b=l._get(l._getPrototypeOf(f.prototype),"createRenderParams",this).call(this,b);b.requiredLevel=this._tileInfoView.getClosestInfoForScale(a.scale).level;b.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(a.scale);return b};g.prepareRenderPasses=
function(b){const a=l._get(l._getPrototypeOf(f.prototype),"prepareRenderPasses",this).call(this,b);a.push(b.registerRenderPass({name:"stencil",brushes:[t],drawPhase:D.WGLDrawPhase.DEBUG|D.WGLDrawPhase.MAP|D.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}));h("esri-tiles-debug")&&a.push(b.registerRenderPass({name:"tileInfo",brushes:[w],drawPhase:D.WGLDrawPhase.DEBUG,target:()=>this.children}));return a};g.getStencilTarget=function(){return this.children};g.setStencilReference=function(b){b=
1;for(const a of this.children)a.stencilRef=b++};l._createClass(f,[{key:"requiresDedicatedFBO",get:function(){return!1}}]);return f}(E)})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../chunks/mat3f32 ../brushes ../Container ./ClippingInfo ./enums".split(" "),function(l,h,D,E,w,t,p,g){return function(f){function d(){var a=b.apply(this,arguments);a.name=a.constructor.name;return a}l._inherits(d,
f);var b=l._createSuper(d);f=d.prototype;f.beforeRender=function(a){l._get(l._getPrototypeOf(d.prototype),"beforeRender",this).call(this,a);this.updateTransforms(a.state)};f._createTransforms=function(){return{dvs:E.create()}};f.doRender=function(a){a=this.createRenderParams(a);const {painter:e,globalOpacity:c,profiler:m,drawPhase:k}=a,n=k===g.WGLDrawPhase.LABEL||k===g.WGLDrawPhase.HIGHLIGHT?1:c*this.computedOpacity;m.recordContainerStart(this.name);e.beforeRenderLayer(a,this._clippingInfos?255:0,
n);this.renderChildren(a);e.compositeLayer(a,n);m.recordContainerEnd()};f.renderChildren=function(a){D.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(a.painter));for(const e of this._renderPasses)try{e.render(a)}catch(c){}};f.createRenderParams=function(a){a.requireFBO=this.requiresDedicatedFBO;return a};f.prepareRenderPasses=function(a){return[a.registerRenderPass({name:"clip",brushes:[w.brushes.clip],target:()=>this._clippingInfos,drawPhase:g.WGLDrawPhase.MAP|g.WGLDrawPhase.LABEL|
g.WGLDrawPhase.LABEL_ALPHA|g.WGLDrawPhase.DEBUG|g.WGLDrawPhase.HIGHLIGHT})]};f.updateTransforms=function(a){for(const e of this.children)e.setTransform(a)};f.onAttach=function(){l._get(l._getPrototypeOf(d.prototype),"onAttach",this).call(this);this._updateClippingInfo()};f.onDetach=function(){l._get(l._getPrototypeOf(d.prototype),"onDetach",this).call(this);this._updateClippingInfo()};f._updateClippingInfo=function(){D.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(c=>c.destroy()),this._clippingInfos=
null);const a=this.stage;if(a){var e=this._clips;D.isSome(e)&&e.length&&(this._clippingInfos=e.items.map(c=>p.fromClipArea(a,c)));this.requestRender()}};l._createClass(d,[{key:"clips",set:function(a){this._clips=a;this.children.forEach(e=>e.clips=a);this._updateClippingInfo()}}]);return d}(t.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/reactiveUtils ../../../../chunks/mat3f32 ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),
function(l,h,D,E,w,t,p,g,f){return function(d){function b(e,c){var m=a.call(this);m._clip=c;m._cache={};m.stage=e;m._handle=w.watch(()=>c.version,()=>m._invalidate());m.ready();return m}l._inherits(b,d);var a=l._createSuper(b);b.fromClipArea=function(e,c){return new b(e,c)};d=b.prototype;d._destroyGL=function(){E.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);E.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};d.destroy=function(){this._destroyGL();
this._handle.remove()};d.getVAO=function(e,c,m,k){const [n,x]=c.size;if("geometry"===this._clip.type||this._lastWidth!==n||this._lastHeight!==x)this._lastWidth=n,this._lastHeight=x,this._destroyGL();if(E.isNone(this._cache.vao)){c=this._createMesh(c,this._clip);const q=c.getIndexBuffer(e),B=c.getVertexBuffers(e);this._cache.mesh=c;this._cache.vao=new f.VertexArrayObject(e,m,k,B,q)}return this._cache.vao};d._createTransforms=function(){return{dvs:t.create()}};d._invalidate=function(){this._destroyGL();
this.requestRender()};d._createScreenRect=function(e,c){const [m,k]=e.size;e="string"===typeof c.left?parseFloat(c.left)/100*m:c.left;const n="string"===typeof c.right?parseFloat(c.right)/100*m:c.right,x="string"===typeof c.top?parseFloat(c.top)/100*k:c.top;c="string"===typeof c.bottom?parseFloat(c.bottom)/100*k:c.bottom;return{x:e,y:x,width:Math.max(m-n-e,0),height:Math.max(k-c-x,0)}};d._createMesh=function(e,c){switch(c.type){case "rect":return g.fromRect(this._createScreenRect(e,c));case "path":return g.fromPath(c);
case "geometry":return g.fromGeometry(e,c);default:return D.getLogger("esri.views.2d.engine.webgl.ClippingInfo").error(new h("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),g.fromRect({x:0,y:0,width:1,height:1})}};return l._createClass(b)}(p.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../chunks/earcut ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject ../../../webgl/enums".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a){const e=({coords:c,lengths:m},k)=>{const n=[];for(let B=0,y=0;B<m.length;y+=m[B],B+=1){const u=y;for(var x=[];B<m.length-1;B+=1,y+=m[B]){var q=y+m[B];let v=0;for(let r=1;r<m[B+1];r++)v+=(c[2*(q+r)]-c[2*(q+r-1)])*(c[2*(q+r)+1]+c[2*(q+r-1)+1]);if(!(k?0<v:0>v))break;x.push(y+m[B]-u)}q=c.slice(2*u,2*(y+m[B]));x=w.earcut(q,x,2);for(const v of x)n.push(v+u)}return n};return function(){function c(k,n,x,q=!1){this._cache={};this.vertices=k;this.indices=n;this.primitiveType=
x;this.isMapSpace=q}c.fromRect=function({x:k,y:n,width:x,height:q}){return c.fromScreenExtent({xmin:k,ymin:n,xmax:k+x,ymax:n+q})};c.fromPath=function(k){var n=g.convertFromNestedArray(new f,k.path,!1,!1);k=n.coords;n=new Uint32Array(e(n,!0));const x=new Uint32Array(k.length/2);for(let q=0;q<x.length;q++)x[q]=d.i1616to32(Math.floor(k[2*q]),Math.floor(k[2*q+1]));return new c({geometry:x},n,a.PrimitiveType.TRIANGLES)};c.fromGeometry=function(k,n){const x=n.geometry?.type;switch(x){case "polygon":return c.fromPolygon(k,
n.geometry);case "extent":return c.fromMapExtent(k,n.geometry);default:return D.getLogger("esri.views.2d.engine.webgl.Mesh2D").error(new h("mapview-bad-type",`Unable to create a mesh from type ${x}`,n)),c.fromRect({x:0,y:0,width:1,height:1})}};c.fromPolygon=function(k,n){var x=g.convertFromPolygon(new f,n,!1,!1);n=x.coords;x=new Uint32Array(e(x,!1));const q=new Uint32Array(n.length/2),B=p.create(),y=p.create();for(let u=0;u<q.length;u++)t.set(B,n[2*u],n[2*u+1]),k.toScreen(y,B),q[u]=d.i1616to32(Math.floor(y[0]),
Math.floor(y[1]));return new c({geometry:q},x,a.PrimitiveType.TRIANGLES,!0)};c.fromScreenExtent=function({xmin:k,xmax:n,ymin:x,ymax:q}){k={geometry:new Uint32Array([d.i1616to32(k,x),d.i1616to32(n,x),d.i1616to32(k,q),d.i1616to32(k,q),d.i1616to32(n,x),d.i1616to32(n,q)])};n=new Uint32Array([0,1,2,3,4,5]);return new c(k,n,a.PrimitiveType.TRIANGLES)};c.fromMapExtent=function(k,n){const [x,q]=k.toScreen([0,0],[n.xmin,n.ymin]),[B,y]=k.toScreen([0,0],[n.xmax,n.ymax]);k={geometry:new Uint32Array([d.i1616to32(x,
q),d.i1616to32(B,q),d.i1616to32(x,y),d.i1616to32(x,y),d.i1616to32(B,q),d.i1616to32(B,y)])};n=new Uint32Array([0,1,2,3,4,5]);return new c(k,n,a.PrimitiveType.TRIANGLES)};var m=c.prototype;m.destroy=function(){E.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const k in this._cache.vertexBuffers)E.isSome(this._cache.vertexBuffers[k])&&this._cache.vertexBuffers[k].dispose()};m.getIndexBuffer=function(k,n=a.Usage.STATIC_DRAW){this._cache.indexBuffer||(this._cache.indexBuffer=b.BufferObject.createIndex(k,
n,this.indices));return this._cache.indexBuffer};m.getVertexBuffers=function(k,n=a.Usage.STATIC_DRAW){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((x,q)=>({...x,[q]:b.BufferObject.createVertex(k,n,this.vertices[q])}),{}));return this._cache.vertexBuffers};l._createClass(c,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var k=a.DataType.UNSIGNED_BYTE;break a;case 2:k=a.DataType.UNSIGNED_SHORT;break a;case 4:k=a.DataType.UNSIGNED_INT;
break a;default:throw new h("Cannot get DataType of array");}return k}}]);return c}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./Utils ./techniques/Technique ./techniques/utils ../../../webgl/capabilities".split(" "),function(l,h,D,E,w,t,p,g,f,d){function b(e,c){const m=c.length;if(e<c[0].value||1===
m)return c[0].size;for(let k=1;k<m;k++)if(e<c[k].value)return c[k-1].size+(e-c[k-1].value)/(c[k].value-c[k-1].value)*(c[k].size-c[k-1].size);return c[m-1].size}let a=function(){function e(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.outsideLabelsVisible=!1;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,
vvRotationType:"geographic",vvOpacityEnabled:!1};this._technique=g.Technique}var c=e.prototype;c.getSizeVVFieldStops=function(m){const k=this._vvSizeFieldStops;if(k)switch(k.type){case "static":return k;case "level-dependent":return D.unwrapOr(k.levels[m],()=>{var n=Infinity,x=0;for(var q in k.levels){const B=parseFloat(q),y=Math.abs(m-B);y<n&&(n=y,x=B)}if(Infinity===n)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};n=2**((m-x)/2);x=D.unwrap(k.levels[x]);q=new Float32Array(x.values);
q[2]*=n;q[3]*=n;return{sizes:D.unwrap(x.sizes),values:q}})}};c.update=function(m){D.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,m)};c.setInfo=function(m,k,n){this._updateEffects(n);this._vvInfo=k;this._technique=f.getTechniqueFromRenderer(m);this.rendererSchema=this._technique.createOrUpdateRendererSchema(this.rendererSchema,m)};c.getVariation=function(){return{...this._technique.getVariation(this.rendererSchema),outsideLabelsVisible:this.outsideLabelsVisible,supportsTextureFloat:d.getWebGLCapabilities("2d").supportsTextureFloat}};
c.getVariationHash=function(){return this._technique.getVariationHash(this.rendererSchema)<<1|(this.outsideLabelsVisible?1:0)};c._updateEffects=function(m){D.isSome(m)?this.outsideLabelsVisible=m.excludedLabelsVisible:this.outsideLabelsVisible=!1};c._updateVisualVariables=function(m,k){const n=this._vvMaterialParameters;n.vvOpacityEnabled=!1;n.vvSizeEnabled=!1;n.vvColorEnabled=!1;n.vvRotationEnabled=!1;if(m){var x=m.size;if(x){n.vvSizeEnabled=!0;if(x.minMaxValue){const B=x.minMaxValue;let y;if(p.isDefined(B.minSize)&&
p.isDefined(B.maxSize))if(p.isNumber(B.minSize)&&p.isNumber(B.maxSize)){y=E.pt2px(B.minSize);var q=E.pt2px(B.maxSize)}else q=k.scale,y=E.pt2px(b(q,B.minSize.stops)),q=E.pt2px(b(q,B.maxSize.stops));this.vvSizeMinMaxValue.set([B.minDataValue,B.maxDataValue,y,q])}x.scaleStops&&(this.vvSizeScaleStopsValue=E.pt2px(b(k.scale,x.scaleStops.stops)));x.unitValue&&(this.vvSizeUnitValueToPixelsRatio=w.getMetersPerUnitForSR(k.spatialReference)/t.meterIn[x.unitValue.unit]/k.resolution);x.fieldStops&&(this._vvSizeFieldStops=
x.fieldStops)}if(k=m.color)n.vvColorEnabled=!0,this.vvColorValues.set(k.values),this.vvColors.set(k.colors);if(k=m.opacity)n.vvOpacityEnabled=!0,this.vvOpacityValues.set(k.values),this.vvOpacities.set(k.opacities);if(m=m.rotation)n.vvRotationEnabled=!0,n.vvRotationType=m.type}};h._createClass(e,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);return e}();l.WGLRendererInfo=a;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/graphics/GraphicBoundsRenderer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/mat3 ../../../../chunks/mat3f32 ../../../../chunks/vec2f32 ../../../../chunks/vec3f32 ../../../../geometry/support/normalizeUtils ../../engine/DisplayObject ../../engine/webgl/Utils ../../../webgl/BufferObject ../../../webgl/enums ../../../webgl/VertexArrayObject".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a){const e=Math.PI/180,c=()=>f.createProgramDescriptor("bounds",{geometry:[{location:0,name:"a_position",count:2,type:b.DataType.FLOAT}]});return function(m){function k(x){var q=n.call(this);q._program=null;q._vao=null;q._vertexBuffer=null;q._indexBuffer=null;q._dvsMat3=E.create();q._localOrigin={x:0,y:0};q._getBounds=x;return q}l._inherits(k,m);var n=l._createSuper(k);m=k.prototype;m.destroy=function(){this._vao&&(this._vao.dispose(!0),this._indexBuffer=this._vertexBuffer=
this._vao=null);this._program=h.disposeMaybe(this._program)};m.doRender=function(x){const {context:q}=x,B=this._getBounds();1>B.length||(this._createShaderProgram(q),this._updateMatricesAndLocalOrigin(x),this._updateBufferData(q,B),q.setBlendingEnabled(!0),q.setDepthTestEnabled(!1),q.setStencilWriteMask(0),q.setStencilTestEnabled(!1),q.setBlendFunction(b.BlendFactor.ONE,b.BlendFactor.ONE_MINUS_SRC_ALPHA),q.setColorMask(!0,!0,!0,!0),x=this._program,q.bindVAO(this._vao),q.useProgram(x),x.setUniformMatrix3fv("u_dvsMat3",
this._dvsMat3),q.gl.lineWidth(1),q.drawElements(b.PrimitiveType.LINES,8*B.length,b.DataType.UNSIGNED_INT,0),q.bindVAO())};m._createTransforms=function(){return{dvs:E.create()}};m._createShaderProgram=function(x){this._program||(this._program=x.programCache.acquire("precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos \x3d u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position \x3d vec4(pos.xy, 0.0, 1.0);\n        }",
"precision mediump float;\n      void main() {\n        gl_FragColor \x3d vec4(0.75, 0.0, 0.0, 0.75);\n      }",c().attributes))};m._updateMatricesAndLocalOrigin=function(x){var {state:q}=x;const {displayMat3:B,size:y,resolution:u,pixelRatio:v,rotation:r,viewpoint:z}=q;x=e*r;const {x:A,y:C}=z.targetGeometry;q=p.normalizeMapX(A,q.spatialReference);this._localOrigin.x=q;this._localOrigin.y=C;q=v*y[0];const F=v*y[1],G=u*q,H=u*F,K=D.identity(this._dvsMat3);D.multiply(K,K,B);D.translate(K,K,w.fromValues(q/
2,F/2));D.scale(K,K,t.fromValues(y[0]/G,-F/H,1));D.rotate(K,K,-x)};m._updateBufferData=function(x,q){const {x:B,y}=this._localOrigin,u=new Float32Array(8*q.length),v=new Uint32Array(8*q.length);let r=0,z=0;for(const A of q)A&&(u[2*r]=A[0]-B,u[2*r+1]=A[1]-y,u[2*r+2]=A[0]-B,u[2*r+3]=A[3]-y,u[2*r+4]=A[2]-B,u[2*r+5]=A[3]-y,u[2*r+6]=A[2]-B,u[2*r+7]=A[1]-y,v[z]=r+0,v[z+1]=r+3,v[z+2]=r+3,v[z+3]=r+2,v[z+4]=r+2,v[z+5]=r+1,v[z+6]=r+1,v[z+7]=r+0,r+=4,z+=8);this._vertexBuffer?this._vertexBuffer.setData(u.buffer):
this._vertexBuffer=d.BufferObject.createVertex(x,b.Usage.DYNAMIC_DRAW,u.buffer);this._indexBuffer?this._indexBuffer.setData(v):this._indexBuffer=d.BufferObject.createIndex(x,b.Usage.DYNAMIC_DRAW,v);this._vao||(q=c(),this._vao=new a.VertexArrayObject(x,q.attributes,q.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer))};return l._createClass(k)}(g.DisplayObject)})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Viewpoint ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k){const n=new D({targetGeometry:new b}),x=[0,0];D=function(q){function B(u){u=y.call(this,u);u._endTimer=null;u._lastEventTimestamp=null;u.animationManager=null;u.interacting=!1;return u}l._inherits(B,q);var y=l._createSuper(B);q=B.prototype;q.initialize=function(){this.pan=new c({navigation:this});this.rotate=new k({navigation:this});this.pinch=new m({navigation:this});this.zoomBox=new e({view:this.view,navigation:this})};q.destroy=function(){this.pan=w.destroyMaybe(this.pan);
this.rotate=w.destroyMaybe(this.rotate);this.pinch=w.destroyMaybe(this.pinch);this.zoomBox=w.destroyMaybe(this.zoomBox);this.animationManager=null};q.begin=function(){this._set("interacting",!0)};q.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};q.zoom=async function(u,v=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>u?this.zoomIn(v):this.zoomOut(v);this.setViewpoint(v,u,0,[0,0])};
q.zoomIn=async function(u){var v=this.view;v=v.constraints.snapToNextScale(v.scale);return this._zoomToScale(v,u)};q.zoomOut=async function(u){var v=this.view;v=v.constraints.snapToPreviousScale(v.scale);return this._zoomToScale(v,u)};q.setViewpoint=function(u,v,r,z){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,u,v,r,z);this.end()};q.setViewpointImmediate=function(u,v=0,r=[0,0],z=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,
z,u,v,r)};q.continousRotateClockwise=function(){const u=this.get("view.viewpoint");this.animationManager?.animateContinous(u,v=>{a.rotateBy(v,v,-1)})};q.continousRotateCounterclockwise=function(){const u=this.get("view.viewpoint");this.animationManager?.animateContinous(u,v=>{a.rotateBy(v,v,1)})};q.resetRotation=function(){this.view.rotation=0};q.continousPanLeft=function(){this._continuousPan([-10,0])};q.continousPanRight=function(){this._continuousPan([10,0])};q.continousPanUp=function(){this._continuousPan([0,
10])};q.continousPanDown=function(){this._continuousPan([0,-10])};q.stop=function(){this.pan.stopMomentumNavigation();this.animationManager?.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};q._continuousPan=function(u){const v=this.view.viewpoint;this.animationManager?.animateContinous(v,r=>{a.translateBy(r,r,u);this.view.constraints.constrainByGeometry(r)})};q._startTimer=function(u){return null!==this._endTimer?this._endTimer:
this._endTimer=setTimeout(()=>{this._endTimer=null;const v=performance.now()-(this._lastEventTimestamp??0);250>v?this._endTimer=this._startTimer(v):this._set("interacting",!1)},u)};q._getDefaultAnchor=function(){const {size:u,padding:{left:v,right:r,top:z,bottom:A}}=this.view;x[0]=.5*(u[0]-r+v);x[1]=.5*(u[1]-A+z);return x};q._zoomToScale=async function(u,v=this._getDefaultAnchor()){const {view:r}=this,{constraints:z,scale:A,viewpoint:C,size:F,padding:G}=r,H=z.canZoomInTo(u),K=z.canZoomOutTo(u);if(!(u<
A&&!H||u>A&&!K))return a.padAndScaleAndRotateBy(n,C,u/A,0,v,F,G),z.constrainByGeometry(n),r.goTo(n,{animate:!0})};q._scaleRotateTranslateViewpoint=function(u,v,r,z,A){var {view:C}=this;const {size:F,padding:G,constraints:H,scale:K,viewpoint:J}=C;var N=K*r;C=H.canZoomInTo(N);N=H.canZoomOutTo(N);if(1>r&&!C||1<r&&!N)r=1;a.translateBy(J,J,A);a.padAndScaleAndRotateBy(u,J,r,z,v,F,G);return H.constrainByGeometry(u)};return l._createClass(B)}(E);h.__decorate([t.property()],D.prototype,"animationManager",
void 0);h.__decorate([t.property({type:Boolean,readOnly:!0})],D.prototype,"interacting",void 0);h.__decorate([t.property()],D.prototype,"pan",void 0);h.__decorate([t.property()],D.prototype,"pinch",void 0);h.__decorate([t.property()],D.prototype,"rotate",void 0);h.__decorate([t.property()],D.prototype,"view",void 0);h.__decorate([t.property()],D.prototype,"zoomBox",void 0);return D=h.__decorate([d.subclass("esri.views.2d.navigation.MapViewNavigation")],D)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../input/InputManager".split(" "),
function(l,h,D,E,w,t,p,g,f,d){D=function(b){function a(c){c=e.call(this,c);c._container=null;c._overlay=null;c._backgroundShape=null;c._boxShape=null;c._box={x:0,y:0,width:0,height:0};c._rafId=null;c._handles=null;c._redraw=c._redraw.bind(l._assertThisInitialized(c));return c}l._inherits(a,b);var e=l._createSuper(a);b=a.prototype;b.destroy=function(){this.view=null};b._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};b._update=function(c,m,k,n){this._box.x=c;
this._box.y=m;this._box.width=k;this._box.height=n;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};b._end=function(c,m,k,n,x){const q=this.view;c=q.toMap(E.createScreenPoint(c+.5*k,m+.5*n));k=Math.max(k/q.width,n/q.height);-1===x&&(k=1/k);this._destroyOverlay();this.navigation.end();q.goTo({center:c,scale:q.scale*k})};b._updateBox=function(c,m,k,n){const x=this._boxShape;x.setAttributeNS(null,"x",""+c);x.setAttributeNS(null,"y",""+m);x.setAttributeNS(null,"width",""+k);x.setAttributeNS(null,
"height",""+n);x.setAttributeNS(null,"class","esri-zoom-box__outline")};b._updateBackground=function(c,m,k,n){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(c,m,k,n,this.view.width,this.view.height))};b._createContainer=function(){const c=document.createElement("div");c.className="esri-zoom-box__container";this.view.root.appendChild(c);this._container=c};b._createOverlay=function(){var c=this.view.width,m=this.view.height;const k=document.createElementNS("http://www.w3.org/2000/svg",
"path");k.setAttributeNS(null,"d","M 0 0 L "+c+" 0 L "+c+" "+m+" L 0 "+m+" Z");k.setAttributeNS(null,"class","esri-zoom-box__overlay-background");c=document.createElementNS("http://www.w3.org/2000/svg","rect");m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");m.setAttributeNS(null,"class","esri-zoom-box__overlay");m.appendChild(k);m.appendChild(c);this._container.appendChild(m);this._backgroundShape=
k;this._boxShape=c;this._overlay=m};b._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};b._toSVGPath=function(c,m,k,n,x,q){k=c+k;n=m+n;return"M 0 0 L "+x+" 0 L "+x+" "+q+" L 0 "+q+" ZM "+c+" "+m+" L "+c+" "+n+" L "+k+" "+n+" L "+k+" "+m+" Z"};b._handleDrag=function(c,m){var k=c.x,n=c.y,x=c.origin.x;const q=c.origin.y;let B;k>x?(B=x,x=k-x):(B=k,x-=k);
n>q?(k=q,n-=q):(k=n,n=q-n);switch(c.action){case "start":this._start();break;case "update":this._update(B,k,x,n);break;case "end":this._end(B,k,x,n,m)}c.stopPropagation()};b._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:c,y:m,width:k,height:n}=this._box;this._updateBox(c,m,k,n);this._updateBackground(c,m,k,n);this._rafId=requestAnimationFrame(this._redraw)}};l._createClass(a,[{key:"view",set:function(c){this._handles&&this._handles.forEach(m=>{m.remove()});this._handles=
null;this._destroyOverlay();this._set("view",c);c&&(c.on("drag",["Shift"],m=>this._handleDrag(m,1),d.ViewEventPriorities.INTERNAL),c.on("drag",["Shift","Ctrl"],m=>this._handleDrag(m,-1),d.ViewEventPriorities.INTERNAL))}}]);return a}(D);h.__decorate([w.property()],D.prototype,"navigation",void 0);h.__decorate([w.property()],D.prototype,"view",null);return D=h.__decorate([f.subclass("esri.views.2d.navigation.ZoomBox")],D)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n){D=function(x){function q(y){var u=B.call(this,y);u.animationTime=0;u.momentumEstimator=new k.PanPlanarMomentumEstimator(500,6,.92);u.momentum=null;u.tmpMomentum=c.create();u.momentumFinished=!1;u.viewpoint=new E({targetGeometry:new n,scale:0,rotation:0});u._previousDrag=null;t.when(()=>u.momentumFinished,()=>u.navigation.stop());return u}l._inherits(q,x);var B=l._createSuper(q);x=q.prototype;x.begin=function(y,u){this.navigation.begin();this.momentumEstimator.reset();
this.addToEstimator(u);this._previousDrag=u};x.update=function(y,u){this.addToEstimator(u);let v=u.center.x,r=u.center.y;const z=this._previousDrag;v=z?z.center.x-v:-v;r=z?r-z.center.y:r;y.viewpoint=m.translateBy(this.viewpoint,y.viewpoint,[v||0,r||0]);this._previousDrag=u};x.end=function(y,u){this.addToEstimator(u);this.momentum=y.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(y);this._previousDrag=null;this.navigation.end()};
x.addToEstimator=function(y){var u=y.center.x;const v=y.center.y,r=p.createScreenPointArray(-u,v);u=c.fromValues(-u,v,0);this.momentumEstimator.add(r,u,.001*y.timestamp)};x.onAnimationUpdate=function(y){this.navigation.animationManager?.animateContinous(y.viewpoint,(u,v)=>{const {momentum:r,animationTime:z,tmpMomentum:A}=this;var C=this.momentumFinished=!r||r.isFinished(z);v*=.001;C||(C=r.valueDelta(z,v),e.scale(A,r.direction,C),m.translateBy(u,u,A),y.constraints.constrainByGeometry(u));this.animationTime+=
v})};x.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return l._createClass(q)}(w);h.__decorate([g.property()],D.prototype,"momentumFinished",void 0);h.__decorate([g.property()],D.prototype,"viewpoint",void 0);h.__decorate([g.property()],D.prototype,"navigation",void 0);return D=h.__decorate([a.subclass("esri.views.2d.navigation.actions.Pan")],D)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3 ../../chunks/vec3f64 ./FilteredFiniteDifference ./Momentum".split(" "),
function(l,h,D,E,w,t){let p=function(g){function f(b,a,e,c,m){b=d.call(this,b,a,e);b._sceneVelocity=c;b.direction=m;return b}h._inherits(f,g);var d=h._createSuper(f);f.prototype.value=function(b){return h._get(h._getPrototypeOf(f.prototype),"valueFromInitialVelocity",this).call(this,this._sceneVelocity,b)};return h._createClass(f)}(t.Momentum);t=function(){function g(d=300,b=12,a=.84){this._minimumInitialVelocity=d;this._stopVelocity=b;this._friction=a;this.enabled=!0;this._time=new w.FilteredFiniteDifference(.6);
this._screen=[new w.FilteredFiniteDifference(.4),new w.FilteredFiniteDifference(.4)];this._scene=[new w.FilteredFiniteDifference(.6),new w.FilteredFiniteDifference(.6),new w.FilteredFiniteDifference(.6)];this._tmpDirection=E.create()}var f=g.prototype;f.add=function(d,b,a){!this.enabled||this._time.hasLastValue()&&.015>this._time.computeDelta(a)||(this._screen[0].update(d[0]),this._screen[1].update(d[1]),this._scene[0].update(b[0]),this._scene[1].update(b[1]),this._scene[2].update(b[2]),this._time.update(a))};
f.reset=function(){this._screen[0].reset();this._screen[1].reset();this._scene[0].reset();this._scene[1].reset();this._scene[2].reset();this._time.reset()};f.evaluateMomentum=function(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;var d=this._screen[0].filteredDelta,b=this._screen[1].filteredDelta;d=null==d||null==b?0:Math.sqrt(d*d+b*b);b=this._time.filteredDelta;d=null==b||null==d?0:d/b;return Math.abs(d)<this._minimumInitialVelocity?null:this.createMomentum(d,
this._stopVelocity,this._friction)};f.createMomentum=function(d,b,a){D.set(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);const e=D.length(this._tmpDirection);0<e&&D.scale(this._tmpDirection,this._tmpDirection,1/e);const c=this._time.filteredDelta;return new p(d,b,a,null==c?0:e/c,this._tmpDirection)};return h._createClass(g)}();l.PanPlanarMomentum=p;l.PanPlanarMomentumEstimator=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},
"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(l,h){let D=function(){function E(t){this._gain=t;this.filteredDelta=this.lastValue=void 0}var w=E.prototype;w.update=function(t){if(this.hasLastValue()){const p=this.computeDelta(t);this._updateDelta(p)}this.lastValue=t};w.reset=function(){this.filteredDelta=this.lastValue=void 0};w.hasLastValue=function(){return void 0!==this.lastValue};w.hasFilteredDelta=function(){return void 0!==
this.filteredDelta};w.computeDelta=function(t){return void 0===this.lastValue?NaN:t-this.lastValue};w._updateDelta=function(t){this.filteredDelta=void 0!==this.filteredDelta?(1-this._gain)*this.filteredDelta+this._gain*t:t};return h._createClass(E)}();l.FilteredFiniteDifference=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(l,h){let D=function(){function E(t,p,g){this._initialVelocity=
t;this._stopVelocity=p;this._friction=g;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var w=E.prototype;w.isFinished=function(t){return t>this.duration};w.value=function(t){return this.valueFromInitialVelocity(this._initialVelocity,t)};w.valueDelta=function(t,p){const g=this.value(t);return this.value(t+p)-g};w.valueFromInitialVelocity=function(t,p){p=Math.min(p,this.duration);const g=1-this.friction;return t*(g**p-1)/Math.log(g)};
h._createClass(E,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return E}();l.Momentum=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator ../../../../geometry/Point".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n){D=function(x){function q(y){var u=B.call(this,y);u._animationTime=0;u._momentumFinished=!1;u._previousAngle=0;u._previousRadius=0;u._previousCenter=null;u._rotationMomentumEstimator=new m.RotationMomentumEstimator(.6,.15,.95);u._rotationDirection=1;u._startAngle=0;u._startRadius=0;u._updateTimestamp=null;u._zoomDirection=1;u._zoomMomentumEstimator=new k.ZoomMomentumEstimator;u._zoomOnly=null;u.zoomMomentum=null;u.rotateMomentum=null;u.viewpoint=new E({targetGeometry:new n,
scale:0,rotation:0});u.addHandles(t.when(()=>u._momentumFinished,()=>u.navigation.stop()));return u}l._inherits(q,x);var B=l._createSuper(q);x=q.prototype;x.begin=function(y,u){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=u.angle;this._previousRadius=this._startRadius=u.radius;this._previousCenter=u.center;this._updateTimestamp=null;y.constraints.rotationEnabled&&this.addToRotateEstimator(0,
u.timestamp);this.addToZoomEstimator(u,1)};x.update=function(y,u){null===this._updateTimestamp&&(this._updateTimestamp=u.timestamp);const v=u.angle,r=u.radius,z=u.center,A=Math.abs(180*(v-this._startAngle)/Math.PI),C=Math.abs(r-this._startRadius),F=this._startRadius/r;if(this._previousRadius&&this._previousCenter){const G=r/this._previousRadius;let H=180*(v-this._previousAngle)/Math.PI;this._rotationDirection=0<=H?1:-1;this._zoomDirection=1<=G?1:-1;y.constraints.rotationEnabled?(null===this._zoomOnly&&
200<u.timestamp-this._updateTimestamp&&(this._zoomOnly=0<C-A),null===this._zoomOnly||this._zoomOnly?H=0:this.addToRotateEstimator(v-this._startAngle,u.timestamp)):H=0;this.addToZoomEstimator(u,F);this.navigation.setViewpoint([z.x,z.y],1/G,H,[this._previousCenter.x-z.x,z.y-this._previousCenter.y])}this._previousAngle=v;this._previousRadius=r;this._previousCenter=z};x.end=function(y){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();
this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(y);this.navigation.end()};x.addToRotateEstimator=function(y,u){this._rotationMomentumEstimator.add(y,.001*u)};x.addToZoomEstimator=function(y,u){this._zoomMomentumEstimator.add(u,.001*y.timestamp)};x.canZoomIn=function(y){const u=y.scale;y=y.constraints.effectiveMaxScale;return 0===y||u>y};x.canZoomOut=function(y){const u=y.scale;y=y.constraints.effectiveMinScale;return 0===y||u<y};x.onAnimationUpdate=function(y){this.navigation.animationManager?.animateContinous(y.viewpoint,
(u,v)=>{var r=!this.canZoomIn(y)&&1<this._zoomDirection||!this.canZoomOut(y)&&1>this._zoomDirection,z=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);r=r||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);v*=.001;this._momentumFinished=z&&r;if(!this._momentumFinished){z=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,v))*this._rotationDirection*180/Math.PI:0;r=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,
v)):1;const C=e.create();var A=e.create();if(this._previousCenter){a.set(C,this._previousCenter.x,this._previousCenter.y);c.getPaddingScreenTranslation(A,y.size,y.padding);a.add(C,C,A);const {constraints:F,scale:G}=y;A=G*r;1>r&&!F.canZoomInTo(A)?(r=G/F.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<r&&!F.canZoomOutTo(A)&&(r=G/F.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);c.scaleAndRotateBy(u,y.viewpoint,r,z,C,y.size);y.constraints.constrainByGeometry(u)}}this._animationTime+=
v})};x.stopMomentumNavigation=function(){if(this.rotateMomentum||this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return l._createClass(q)}(w);h.__decorate([p.property()],D.prototype,"_momentumFinished",void 0);h.__decorate([p.property()],D.prototype,"viewpoint",void 0);h.__decorate([p.property()],D.prototype,"navigation",void 0);return D=
h.__decorate([b.subclass("esri.views.2d.navigation.actions.Pinch")],D)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(l,h,D){D=function(E){function w(p=3,g=.01,f=.95,d=12){return t.call(this,p,g,f,d)}h._inherits(w,E);var t=h._createSuper(w);w.prototype.add=function(p,g){const f=this.value.lastValue;if(null!=f){for(p-=f;p>Math.PI;)p-=2*Math.PI;for(;p<-Math.PI;)p+=2*Math.PI;p=f+p}h._get(h._getPrototypeOf(w.prototype),
"add",this).call(this,p,g)};return h._createClass(w)}(D.MomentumEstimator);l.RotationMomentumEstimator=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/navigation/MomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(l,h,D,E,w){let t=function(){function p(f=2.5,d=.01,b=.95,a=12){this._minimumInitialVelocity=f;this._stopVelocity=d;this._friction=b;this._maxVelocity=
a;this.enabled=!0;this.value=new E.FilteredFiniteDifference(.8);this.time=new E.FilteredFiniteDifference(.3)}var g=p.prototype;g.add=function(f,d){if(this.enabled&&null!=d){if(this.time.hasLastValue()){if(.01>this.time.computeDelta(d))return;if(this.value.hasFilteredDelta()){const b=this.value.computeDelta(f);0>this.value.filteredDelta*b&&this.value.reset()}}this.time.update(d);this.value.update(f)}};g.reset=function(){this.value.reset();this.time.reset()};g.evaluateMomentum=function(){if(!this.enabled||
!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let f=this.value.filteredDelta/this.time.filteredDelta;f=D.clamp(f,-this._maxVelocity,this._maxVelocity);return Math.abs(f)<this._minimumInitialVelocity?null:this.createMomentum(f,this._stopVelocity,this._friction)};g.createMomentum=function(f,d,b){return new w.Momentum(f,d,b)};return h._createClass(p)}();l.MomentumEstimator=t;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(l,h,D,E){let w=function(t){function p(f,d,b){return g.call(this,f,d,b)}h._inherits(p,t);var g=h._createSuper(p);t=p.prototype;t.value=function(f){f=h._get(h._getPrototypeOf(p.prototype),"value",this).call(this,f);return Math.exp(f)};t.valueDelta=function(f,d){const b=h._get(h._getPrototypeOf(p.prototype),"value",this).call(this,f);f=h._get(h._getPrototypeOf(p.prototype),"value",this).call(this,f+d);return Math.exp(f-
b)};return h._createClass(p)}(D.Momentum);D=function(t){function p(f=2.5,d=.01,b=.95,a=12){return g.call(this,f,d,b,a)}h._inherits(p,t);var g=h._createSuper(p);t=p.prototype;t.add=function(f,d){h._get(h._getPrototypeOf(p.prototype),"add",this).call(this,Math.log(f),d)};t.createMomentum=function(f,d,b){return new w(f,d,b)};return h._createClass(p)}(E.MomentumEstimator);l.ZoomMomentum=w;l.ZoomMomentumEstimator=D;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../viewpointUtils ../../../../geometry/Point".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c){const m=a.create(),k=a.create();D=function(n){function x(B){B=q.call(this,B);B._previousCenter=a.create();B.viewpoint=new E({targetGeometry:new c,scale:0,rotation:0});return B}l._inherits(x,n);var q=l._createSuper(x);n=x.prototype;n.begin=function(B,y){this.navigation.begin();b.set(this._previousCenter,y.center.x,y.center.y)};n.update=function(B,y){const {state:{size:u,padding:v}}=B;b.set(m,y.center.x,y.center.y);e.getAnchor(k,u,v);B.viewpoint=e.rotateBy(this.viewpoint,
B.state.paddedViewState.viewpoint,e.angleBetween(k,this._previousCenter,m));b.copy(this._previousCenter,m)};n.end=function(){this.navigation.end()};return l._createClass(x)}(w);h.__decorate([t.property()],D.prototype,"viewpoint",void 0);h.__decorate([t.property()],D.prototype,"navigation",void 0);return D=h.__decorate([d.subclass("esri.views.2d.actions.Rotate")],D)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../request ../../../core/asyncUtils ../../../core/Handles ../../../core/mathUtils ../../../core/maybe ../../../core/reactiveUtils ../../../core/urlUtils ../../../chunks/mat3f32 ../engine/DisplayObject ../engine/webgl/DefaultVertexAttributeLayouts ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms ../../magnifier/resources ../../webgl/BufferObject ../../webgl/enums ../../webgl/Texture ../../webgl/VertexArrayObject".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a,e,c,m,k,n,x){return function(q){function B(){var u=y.call(this);u._handles=new E;u._resourcePixelRatio=1;u.visible=!1;return u}l._inherits(B,q);var y=l._createSuper(B);q=B.prototype;q.destroy=function(){this._handles=t.destroyMaybe(this._handles);this._disposeRenderResources();this._resourcesTask=t.abortMaybe(this._resourcesTask)};q._createTransforms=function(){return{dvs:f.create()}};q.doRender=function(u){const v=u.context;if(!this._resourcesTask)this._reloadResources();
else if(u.drawPhase===a.WGLDrawPhase.MAP&&this._canRender()){this._updateResources(u);var r=this._magnifier;if(!t.isNone(r.position)){var z=u.pixelRatio,A=r.size*z,C=Math.ceil(1/r.factor*A);this._readbackTexture.resize(C,C);var {size:F}=u.state;u=z*F[0];F=z*F[1];var G=.5*C,H=.5*C,K=w.clamp(z*r.position.x,G,u-G-1),J=w.clamp(F-z*r.position.y,H,F-H-1);v.setBlendingEnabled(!0);G=K-G;H=J-H;var N=this._readbackTexture;v.bindTexture(N,0);v.gl.copyTexImage2D(N.descriptor.target,0,N.descriptor.pixelFormat,
G,H,C,C,0);C=(C=this.background?.color)?[C.a*C.r/255,C.a*C.g/255,C.a*C.b/255,C.a]:[1,1,1,1];K=-1+(K+r.offset.x*z)/u*2;z=-1+(J-r.offset.y*z)/F*2;u=A/u*2;A=A/F*2;F=this._program;v.bindVAO(this._vertexArrayObject);v.bindTexture(this._overlayTexture,6);v.bindTexture(this._maskTexture,7);v.useProgram(F);F.setUniform4fv("u_background",C);F.setUniform1i("u_readbackTexture",0);F.setUniform1i("u_overlayTexture",6);F.setUniform1i("u_maskTexture",7);F.setUniform4f("u_drawPos",K,z,u,A);F.setUniform1i("u_maskEnabled",
r.maskEnabled?1:0);F.setUniform1i("u_overlayEnabled",r.overlayEnabled?1:0);v.setStencilTestEnabled(!1);v.setColorMask(!0,!0,!0,!0);v.drawArrays(k.PrimitiveType.TRIANGLE_STRIP,0,4);v.bindVAO()}}};q._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};q._reloadResources=function(){this._resourcesTask&&this._resourcesTask.abort();const u=t.isSome(this._magnifier)?this._magnifier.maskUrl:null,v=t.isSome(this._magnifier)?this._magnifier.overlayUrl:null;this._resourcesTask=D.createTask(async r=>
{const z=t.isNone(u)||t.isNone(v)?c.loadMagnifierResources(r):null,A=t.isSome(u)?h(u,{responseType:"image",signal:r}).then(G=>G.data):z.then(G=>G.mask);r=t.isSome(v)?h(v,{responseType:"image",signal:r}).then(G=>G.data):z.then(G=>G.overlay);const [C,F]=await Promise.all([A,r]);this.mask=C;this.overlay=F;this._disposeRenderResources();this.requestRender()})};q._disposeRenderResources=function(){this._readbackTexture=t.disposeMaybe(this._readbackTexture);this._overlayTexture=t.disposeMaybe(this._overlayTexture);
this._maskTexture=t.disposeMaybe(this._maskTexture);this._vertexArrayObject=t.disposeMaybe(this._vertexArrayObject);this._program=t.disposeMaybe(this._program)};q._updateResources=function(u){u.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var v=u.context;this._resourcePixelRatio=u.pixelRatio;var r=Math.ceil(this._magnifier.size*u.pixelRatio);this._program=e.createMagnifierProgram(v);var z=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=
new x.VertexArrayObject(v,e.magnifierProgramTemplate.attributes,b.Pos2us,{geometry:m.BufferObject.createVertex(v,k.Usage.STATIC_DRAW,z)});this.overlay.width=r;this.overlay.height=r;this._overlayTexture=new n.Texture(v,{target:k.TextureType.TEXTURE_2D,pixelFormat:k.PixelFormat.RGBA,internalFormat:k.PixelFormat.RGBA,dataType:k.PixelType.UNSIGNED_BYTE,wrapMode:k.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:k.TextureSamplingMode.NEAREST,flipped:!0,preMultiplyAlpha:!g.isSVG(this.overlay.src)||!u.context.driverTest.svgPremultipliesAlpha.result},
this.overlay);this.mask.width=r;this.mask.height=r;this._maskTexture=new n.Texture(v,{target:k.TextureType.TEXTURE_2D,pixelFormat:k.PixelFormat.ALPHA,internalFormat:k.PixelFormat.ALPHA,dataType:k.PixelType.UNSIGNED_BYTE,wrapMode:k.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:k.TextureSamplingMode.NEAREST,flipped:!0},this.mask);u=1/this._magnifier.factor;this._readbackTexture=new n.Texture(v,{target:k.TextureType.TEXTURE_2D,pixelFormat:k.PixelFormat.RGBA,internalFormat:k.PixelFormat.RGBA,dataType:k.PixelType.UNSIGNED_BYTE,
wrapMode:k.TextureWrapMode.CLAMP_TO_EDGE,samplingMode:k.TextureSamplingMode.LINEAR,flipped:!1,width:Math.ceil(u*r),height:Math.ceil(u*r)})}};l._createClass(B,[{key:"background",get:function(){return this._background},set:function(u){this._background=u;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},set:function(u){this._magnifier=u;this._handles.removeAll();this._handles.add([p.watch(()=>u.version,()=>{this.visible=u.visible&&t.isSome(u.position)&&0<u.size;this.requestRender()},
p.initial),p.watch(()=>[u.maskUrl,u.overlayUrl],()=>this._reloadResources()),p.watch(()=>u.size,()=>{this._disposeRenderResources();this.requestRender()})])}}]);return B}(d.DisplayObject)})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["exports","./sources/resolver","../../../../webgl/ProgramTemplate"],function(l,h,D){const E={shaders:{vertexShader:h.resolveIncludes("magnifier/magnifier.vert"),fragmentShader:h.resolveIncludes("magnifier/magnifier.frag")},attributes:new Map([["a_pos",
0]])};l.createMagnifierProgram=function(w){return D.createProgram(w,E)};l.magnifierProgramTemplate=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/magnifier/resources":function(){define(["require","exports","../../core/promiseUtils","../../support/requestImageUtils"],function(l,h,D,E){const w=t=>Object.freeze(Object.defineProperty({__proto__:null,default:t},Symbol.toStringTag,{value:"Module"}));h.loadMagnifierResources=async function(t){var p=new Promise((f,d)=>l(["./mask-svg"],
b=>f(w(b)),d)),g=new Promise((f,d)=>l(["./overlay-svg"],b=>f(w(b)),d));p=E.requestImage((await p).default,{signal:t});g=E.requestImage((await g).default,{signal:t});g={mask:await p,overlay:await g};D.throwIfAborted(t);return g};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})})},"esri/support/requestImageUtils":function(){define(["exports","../request"],function(l,h){l.requestImage=async function(D,E){({data:D}=await h(D,{responseType:"image",...E}));return D};Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports","../../../chunks/mat4"],function(l,h){l.mat4=h.mat4;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(l,h){l.mat4f32=h.mat4f32;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],
function(l,h){l.vec3f32=h.vec3f32;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports","../../../chunks/vec4f32"],function(l,h){l.vec4f32=h.vec4f32;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/promiseUtils ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ./DisplayObject ./ImageryBitmapSource ../../webgl/context-util ../../webgl/enums ../../webgl/Texture".split(" "),
function(l,h,D,E,w,t,p,g,f,d,b,a){function e(k){return k&&"render"in k}function c(k){const n=document.createElement("canvas");n.width=k.width;n.height=k.height;k.render(n.getContext("2d"));return n}function m(k){return e(k)?k instanceof f?D.applySome(k.getRenderedRasterPixels(),n=>n.renderedRasterPixels):c(k):k}g=function(k){function n(q=null,B){var y=x.call(this);y.blendFunction="standard";y._sourceWidth=0;y._sourceHeight=0;y._textureInvalidated=!1;y._texture=null;y.stencilRef=0;y.coordScale=[1,
1];y._height=void 0;y.pixelRatio=1;y.resolution=0;y.rotation=0;y._source=null;y._width=void 0;y.x=0;y.y=0;y.immutable=B.immutable??!1;y.requestRenderOnSourceChangedEnabled=B.requestRenderOnSourceChangedEnabled??!0;y.source=q;y.requestRender=y.requestRender.bind(h._assertThisInitialized(y));return y}h._inherits(n,k);var x=h._createSuper(n);k=n.prototype;k.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null);D.isSome(this._uploadStatus)&&(this._uploadStatus.controller.abort(),
this._uploadStatus=null)};k.beforeRender=function(q){h._get(h._getPrototypeOf(n.prototype),"beforeRender",this).call(this,q);this.updateTexture(q)};k.setSourceAsync=async function(q,B){D.isSome(this._uploadStatus)&&this._uploadStatus.controller.abort();const y=new AbortController,u=E.createResolver();E.onAbortOrThrow(B,()=>y.abort());E.onAbortOrThrow(y,v=>u.reject(v));this._uploadStatus={controller:y,resolver:u};this.source=q;return u.promise};k.invalidateTexture=function(){this._textureInvalidated||
(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())};k.updateTransitionProperties=function(q,B){64<=q&&(this.inFadeTransition=this.fadeTransitionEnabled=!1);h._get(h._getPrototypeOf(n.prototype),"updateTransitionProperties",this).call(this,q,B)};k.setTransform=function(q){const B=w.identity(this.transforms.dvs),[y,u]=q.toScreenNoRotation([0,0],[this.x,this.y]);var v=this.resolution/this.pixelRatio/q.resolution;const r=v*this.width;v*=this.height;const z=Math.PI*
this.rotation/180;w.translate(B,B,p.fromValues(y,u));w.translate(B,B,p.fromValues(r/2,v/2));w.rotate(B,B,-z);w.translate(B,B,p.fromValues(-r/2,-v/2));w.scaleByVec2(B,B,p.fromValues(r,v));w.multiply(this.transforms.dvs,q.displayViewMat3,B)};k.setSamplingProfile=function(q){this._texture&&(q.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(q.samplingMode))};k.bind=function(q,B){this._texture&&q.bindTexture(this._texture,B)};k.updateTexture=async function({context:q,
painter:B}){if(this._textureInvalidated)if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(q)),this.source){this._texture.resize(this._sourceWidth,this._sourceHeight);q=m(this.source);try{if(D.isSome(this._uploadStatus)){const {controller:y,resolver:u}=this._uploadStatus,v={signal:y.signal},{width:r,height:z}=this;await B.textureUploadManager.enqueueTextureUpdate({data:q,texture:this._texture,width:r,height:z},v);u.resolve();this._uploadStatus=null}else this._texture.setData(q);
this.ready()}catch(y){E.throwIfNotAbortError(y)}}else this._texture.setData(null)};k.onDetach=function(){this.destroy()};k._createTransforms=function(){return{dvs:t.create()}};k._createTexture=function(q){const B=this.immutable&&q.type===d.ContextType.WEBGL2;return new a.Texture(q,{target:b.TextureType.TEXTURE_2D,pixelFormat:b.PixelFormat.RGBA,internalFormat:B?b.SizedPixelFormat.RGBA8:b.PixelFormat.RGBA,dataType:b.PixelType.UNSIGNED_BYTE,wrapMode:b.TextureWrapMode.CLAMP_TO_EDGE,isImmutable:B,width:this._sourceWidth,
height:this._sourceHeight})};h._createClass(n,[{key:"isSourceScaled",get:function(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this._sourceHeight},set:function(q){this._height=q}},{key:"source",get:function(){return this._source},set:function(q){if(null!=q||null!=this._source)this._source=q,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):
this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width),this.invalidateTexture()}},{key:"width",get:function(){return void 0!==this._width?this._width:this._sourceWidth},set:function(q){this._width=q}}]);return n}(g.DisplayObject);l.Bitmap=g;l.isImageSource=e;l.rasterize=c;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe"],
function(l,h){return function(){function D(w,t,p){this.pixelBlock=w;this.extent=t;this.originalPixelBlock=p}var E=D.prototype;E.render=function(w){var t=this.pixelBlock;if(!h.isNone(t)){var p=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??t});h.isNone(p.pixelBlock)||(p.pixelBlock.maskIsAlpha&&(p.pixelBlock.premultiplyAlpha=!0),t=p.pixelBlock.getAsRGBA(),p=w.createImageData(p.pixelBlock.width,p.pixelBlock.height),p.data.set(t),w.putImageData(p,0,0))}};E.getRenderedRasterPixels=
function(){const w=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});if(h.isNone(w.pixelBlock))return null;w.pixelBlock.maskIsAlpha&&(w.pixelBlock.premultiplyAlpha=!0);return{width:w.pixelBlock.width,height:w.pixelBlock.height,renderedRasterPixels:new Uint8Array(w.pixelBlock.getAsRGBA().buffer)}};l._createClass(D,[{key:"width",get:function(){return h.isSome(this.pixelBlock)?this.pixelBlock.width:0}},{key:"height",get:function(){return h.isSome(this.pixelBlock)?this.pixelBlock.height:0}}]);
return D}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./brushes","./webgl/enums","./webgl/WGLContainer"],function(l,h,D,E,w){w=function(t){function p(){var f=g.apply(this,arguments);f._hasCrossfade=!1;return f}h._inherits(p,t);var g=h._createSuper(p);t=p.prototype;t.beforeRender=function(f){h._get(h._getPrototypeOf(p.prototype),"beforeRender",this).call(this,f);this._manageFade()};t.prepareRenderPasses=function(f){const d=f.registerRenderPass({name:"bitmap",
brushes:[D.brushes.bitmap],target:()=>this.children,drawPhase:E.WGLDrawPhase.MAP});return[...h._get(h._getPrototypeOf(p.prototype),"prepareRenderPasses",this).call(this,f),d]};t._manageFade=function(){2<=this.children.reduce((f,d)=>f+(d.inFadeTransition?1:0),0)?(this.children.forEach(f=>f.blendFunction="additive"),this._hasCrossfade=!0):(this.children.forEach(f=>f.blendFunction="standard"),this._hasCrossfade=!1)};h._createClass(p,[{key:"requiresDedicatedFBO",get:function(){return this._hasCrossfade}}]);
return p}(w);l.BitmapContainer=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat3f32","./Bitmap","./webgl/TiledDisplayObject"],function(l,h,D,E,w){w=function(t){function p(f,d,b,a,e,c,m=null){var k=g.call(this,f,d,b,a,e,c);k.bitmap=new E.Bitmap(m,{immutable:!1,requestRenderOnSourceChangedEnabled:!1});k.bitmap.coordScale=[e,c];k.bitmap.once("isReady",()=>k.ready());
return k}h._inherits(p,t);var g=h._createSuper(p);t=p.prototype;t.destroy=function(){h._get(h._getPrototypeOf(p.prototype),"destroy",this).call(this);this.bitmap.destroy()};t.beforeRender=function(f){h._get(h._getPrototypeOf(p.prototype),"beforeRender",this).call(this,f);this.bitmap.beforeRender(f)};t.afterRender=function(f){h._get(h._getPrototypeOf(p.prototype),"afterRender",this).call(this,f);this.bitmap.afterRender(f)};t._createTransforms=function(){return{dvs:D.create(),tileMat3:D.create()}};
t.setTransform=function(f){h._get(h._getPrototypeOf(p.prototype),"setTransform",this).call(this,f);this.bitmap.transforms.dvs=this.transforms.dvs};t.onAttach=function(){this.bitmap.stage=this.stage};t.onDetach=function(){this.bitmap&&(this.bitmap.stage=null)};h._createClass(p,[{key:"stencilRef",get:function(){return this.bitmap.stencilRef},set:function(f){this.bitmap.stencilRef=f}}]);return p}(w.TiledDisplayObject);l.BitmapTile=w;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./BitmapTile ./brushes ./webgl/enums ./webgl/TileContainer".split(" "),
function(l,h,D,E,w,t,p){p=function(g){function f(){return d.apply(this,arguments)}h._inherits(f,g);var d=h._createSuper(f);g=f.prototype;g.createTile=function(b){const a=this._tileInfoView.getTileBounds(D.create(),b),e=this._tileInfoView.getTileResolution(b.level),[c,m]=this._tileInfoView.tileInfo.size;return new E.BitmapTile(b,e,a[0],a[3],c,m)};g.prepareRenderPasses=function(b){const a=b.registerRenderPass({name:"bitmap (tile)",brushes:[w.brushes.bitmap],target:()=>this.children.map(e=>e.bitmap),
drawPhase:t.WGLDrawPhase.MAP});return[...h._get(h._getPrototypeOf(f.prototype),"prepareRenderPasses",this).call(this,b),a]};g.doRender=function(b){this.visible&&b.drawPhase===t.WGLDrawPhase.MAP&&h._get(h._getPrototypeOf(f.prototype),"doRender",this).call(this,b)};h._createClass(f,[{key:"requiresDedicatedFBO",get:function(){return this.children.some(b=>"additive"===b.bitmap.blendFunction)}}]);return f}(p);l.BitmapTileContainer=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("exports ./engine/Stage ./LabelManager ./layers/graphics/GraphicsView2D ./layers/graphics/GraphicContainer ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(l,h,D,E,w,t,p){l.Stage=h.Stage;l.LabelManager=D;l.GraphicsView2D=E;l.GraphicContainer=w;l.MapViewNavigation=t;l.MagnifierView2D=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});