// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/tslib.es6 ../../../../../../core/Accessor ../../../../../../core/maybe ../../../../../../core/reactiveUtils ../../../../../../core/accessorSupport/decorators/property ../../../../../../core/accessorSupport/ensureType ../../../../../../core/arrayUtils ../../../../../../core/has ../../../../../../core/accessorSupport/decorators/subclass ../../../../../../layers/support/TileKey ../../../../../interactive/snapping/featureSources/featureServiceSource/tileUtils ../../../../../support/layerViewUtils".split(" "),
function(a,l,b,t,m,q,d,B,C,D,u,v,r,w){a.FeatureServiceTiles2D=function(g){function e(c){c=x.call(this,c);c.pointOfInterest=null;return c}l._inherits(e,g);var x=l._createSuper(e);g=e.prototype;g._scaleEnabled=function(){return w.scaleBoundsPredicate(this.view.scale,this.layer.minScale||0,this.layer.maxScale||0)};g.initialize=function(){this.addHandles(q.watch(()=>this.view?.state?.viewpoint,()=>this.notifyChange("tilesCoveringView"),q.sync))};l._createClass(e,[{key:"tiles",get:function(){const c=this.tilesCoveringView,
f=m.isSome(this.pointOfInterest)?this.pointOfInterest:this.view.center;c.sort((n,h)=>r.distanceToTile(f,n)-r.distanceToTile(f,h));return c}},{key:"tilesCoveringView",get:function(){if(!this.view.ready||!this.view.featuresTilingScheme||!this.view.state||m.isNone(this.tileInfo)||!this._scaleEnabled)return[];const {spans:c,lodInfo:f}=this.view.featuresTilingScheme.getTileCoverage(this.view.state,0),{level:n}=f,h=[];for(const {row:y,colFrom:z,colTo:A}of c)for(let p=z;p<=A;p++){var k=f.normalizeCol(p);
k=new v.TileKey(null,n,y,k);this.tileInfo.updateTileInfo(k);h.push(k)}return h}},{key:"tileInfo",get:function(){return this.view.featuresTilingScheme?.tileInfo??null}},{key:"tileSize",get:function(){return m.isSome(this.tileInfo)?this.tileInfo.size[0]:256}}]);return e}(t);b.__decorate([d.property({readOnly:!0})],a.FeatureServiceTiles2D.prototype,"tiles",null);b.__decorate([d.property({readOnly:!0})],a.FeatureServiceTiles2D.prototype,"_scaleEnabled",null);b.__decorate([d.property({readOnly:!0})],a.FeatureServiceTiles2D.prototype,
"tilesCoveringView",null);b.__decorate([d.property({readOnly:!0})],a.FeatureServiceTiles2D.prototype,"tileInfo",null);b.__decorate([d.property({readOnly:!0})],a.FeatureServiceTiles2D.prototype,"tileSize",null);b.__decorate([d.property({constructOnly:!0})],a.FeatureServiceTiles2D.prototype,"view",void 0);b.__decorate([d.property({constructOnly:!0})],a.FeatureServiceTiles2D.prototype,"layer",void 0);b.__decorate([d.property()],a.FeatureServiceTiles2D.prototype,"pointOfInterest",void 0);a.FeatureServiceTiles2D=
b.__decorate([u.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles2D")],a.FeatureServiceTiles2D);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});