// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Handles ../../../../../chunks/vec3 ../../../../../chunks/vec3f64 ./Manipulation ./utils ../../../../draw/support/drawUtils ../../../../interactive/dragEventPipeline ../../../../interactive/GraphicManipulator ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/operations/UpdateVertices ../../../../interactive/editGeometry/support/editPlaneUtils".split(" "),function(l,h,t,u,v,m,w,x,n,
y,p,z,A){let E=function(f){function g(c){var a=B.call(this);a._handles=new t;a._originCache=v.create();a._view=c.view;a._tool=c.tool;a._graphic=c.graphic;a._snapRotation=c.snapRotation;a._manipulator=a._createManipulator();a._handles.add([a._manipulator.events.on("grab-changed",d=>w.onGrabChangedHandle(d,a._manipulator))]);a.forEachManipulator(d=>a._tool.manipulators.add(d));return a}h._inherits(g,f);var B=h._createSuper(g);f=g.prototype;f.destroy=function(){this._handles.destroy();this.forEachManipulator(c=>
{this._tool.manipulators.remove(c);c.destroy()});this._originCache=this._handles=this._graphic=this._snapRotation=this._manipulator=this._view=this._tool=null};f.forEachManipulator=function(c){c(this._manipulator,m.ManipulatorType.ROTATE)};f.createDragPipeline=function(c,a){let d=null,k=null;return n.createManipulatorDragEventPipeline(this._manipulator,(q,C)=>{C.next(b=>{if("start"===b.action){q.cursor="grabbing";const e=c();d=e.plane;k=e.editGeometryOperations}return b}).next(n.screenToMap(this._view)).next(b=>
({...b,rotateAngle:x.getRotationAngle(b.mapStart,b.mapEnd,{x:d.origin[0],y:d.origin[1]},!0)})).next(this._snapRotation.createDragEventPipelineStep(),this._snapRotation.next).next(b=>{var e=u.copy(this._originCache,d.origin);const r=[];for(const D of k.data.components)r.push(...D.vertices);e=k.rotateVertices(r,e,b.rotateAngle,"start"===b.action?p.AccumulationBehaviour.NEW_STEP:p.AccumulationBehaviour.ACCUMULATE_STEPS,z.AccumulationType.REPLACE);A.apply(e,d);a(b,e);return b}).next(b=>{"end"===b.action&&
(q.cursor="grab");return b})})};f._createManipulator=function(){return new y.GraphicManipulator({view:this._view,graphic:this._graphic,selectable:!0,cursor:"grab"})};return h._createClass(g)}(m.Manipulation);l.RotateManipulation=E;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});