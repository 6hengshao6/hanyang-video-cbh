// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/has ../../core/mathUtils ../../core/screenUtils ./InputHandler ./InputManager ./IViewEvents".split(" "),function(u,v,w,A,x,B,C,D){function y(h){return!!z[h]}function E(h){for(const p of h)if(!y(p))return!1;return!0}w="click double-click immediate-click immediate-double-click hold drag key-down key-up pointer-down pointer-move pointer-up pointer-drag mouse-wheel pointer-enter pointer-leave gamepad focus blur".split(" ");const z={};w.forEach(h=>
{z[h]=!0});let G=function(){function h(k){this._handlers=new Map;this._counter=0;this._handlerCounts=new Map;this.view=k;this.inputManager=null}var p=h.prototype;p.connect=function(k){k&&this.disconnect();this.inputManager=k;this._handlers.forEach(({handler:a,priority:d},e)=>this.inputManager?.installHandlers(e,[a],d))};p.disconnect=function(){this.inputManager&&this._handlers.forEach((k,a)=>this.inputManager?.uninstallHandlers(a));this.inputManager=null};p.destroy=function(){this.disconnect();this._handlers.clear();
this.view=null};p.on=function(k,a,d,e){const f=Array.isArray(k)?k:k.split(",");if(!E(f))return f.some(y)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;if(Array.isArray(a))k=a;else{var b=a;k=[]}"function"===typeof d?b=d:e=d;e=null!=e?e:C.ViewEventPriorities.DEFAULT;const g=this._createUniqueGroupName();d=new F(this.view,f,k,b);this._handlers.set(g,{handler:d,priority:e});for(const c of f)b=this._handlerCounts.get(c)||0,this._handlerCounts.set(c,
b+1);this.inputManager&&this.inputManager.installHandlers(g,[d],e);return{remove:()=>this._removeHandler(g,f)}};p.hasHandler=function(k){return!!this._handlerCounts.get(k)};p._removeHandler=function(k,a){if(this._handlers.has(k)){this._handlers.delete(k);for(const d of a)a=this._handlerCounts.get(d),void 0===a?console.error("Trying to remove handler for event that has no handlers registered: ",d):1===a?this._handlerCounts.delete(d):this._handlerCounts.set(d,a-1)}this.inputManager&&this.inputManager.uninstallHandlers(k)};
p._createUniqueGroupName=function(){this._counter+=1;return`viewEvents_${this._counter}`};return v._createClass(h)}(),F=function(h){function p(a,d,e,f){var b=k.call(this,!0);b._latestDragStart=void 0;b.view=a;for(const g of d)switch(g){case "click":b.registerIncoming("click",e,c=>f(b._wrapClick(c)));break;case "double-click":b.registerIncoming("double-click",e,c=>f(b._wrapDoubleClick(c)));break;case "immediate-click":b.registerIncoming("immediate-click",e,c=>f(b._wrapImmediateClick(c)));break;case "immediate-double-click":b.registerIncoming("immediate-double-click",
e,c=>f(b._wrapImmediateDoubleClick(c)));break;case "hold":b.registerIncoming("hold",e,c=>f(b._wrapHold(c)));break;case "drag":b.registerIncoming("drag",e,c=>{(c=b._wrapDrag(c))&&f(c)});break;case "key-down":b.registerIncoming("key-down",e,c=>f(b._wrapKeyDown(c)));break;case "key-up":b.registerIncoming("key-up",e,c=>f(b._wrapKeyUp(c)));break;case "pointer-down":b.registerIncoming("pointer-down",e,c=>f(b._wrapPointer(c,"pointer-down")));break;case "pointer-move":b.registerIncoming("pointer-move",e,
c=>f(b._wrapPointer(c,"pointer-move")));break;case "pointer-up":b.registerIncoming("pointer-up",e,c=>f(b._wrapPointer(c,"pointer-up")));break;case "pointer-drag":b.registerIncoming("pointer-drag",e,c=>f(b._wrapPointerDrag(c)));break;case "mouse-wheel":b.registerIncoming("mouse-wheel",e,c=>f(b._wrapMouseWheel(c)));break;case "pointer-enter":b.registerIncoming("pointer-enter",e,c=>f(b._wrapPointer(c,"pointer-enter")));break;case "pointer-leave":b.registerIncoming("pointer-leave",e,c=>f(b._wrapPointer(c,
"pointer-leave")));break;case "gamepad":b.registerIncoming("gamepad",e,c=>{f(b._wrapGamepad(c))});break;case "focus":b.registerIncoming("focus",e,c=>{f(b._wrapFocus(c))});break;case "blur":b.registerIncoming("blur",e,c=>{f(b._wrapBlur(c))})}return b}v._inherits(p,h);var k=v._createSuper(p);h=p.prototype;h._wrapFocus=function(a){return{type:"focus",timestamp:a.timestamp,native:a.data.native,cancelable:a.cancelable,stopPropagation:()=>a.stopPropagation(),async:d=>a.async(d),preventDefault:()=>a.preventDefault()}};
h._wrapBlur=function(a){return{type:"blur",timestamp:a.timestamp,native:a.data.native,cancelable:a.cancelable,stopPropagation:()=>a.stopPropagation(),async:d=>a.async(d),preventDefault:()=>a.preventDefault()}};h._wrapClick=function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c,eventId:l}=a.data,{cancelable:m,timestamp:n}=a,q=x.createScreenPoint(b,g),r=this._getMapPoint(b,g);return{type:"click",pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:n,screenPoint:q,mapPoint:r,eventId:l,
cancelable:m,stopPropagation:()=>a.stopPropagation(),async:t=>a.async(t),preventDefault:()=>a.preventDefault()}};h._wrapDoubleClick=function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c,eventId:l}=a.data,{cancelable:m,timestamp:n}=a;return{type:"double-click",pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:n,mapPoint:this._getMapPoint(b,g),eventId:l,cancelable:m,stopPropagation:()=>a.stopPropagation(),async:q=>a.async(q),preventDefault:()=>a.preventDefault()}};h._wrapImmediateClick=
function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c,eventId:l}=a.data,m=c.pointerId,{cancelable:n,timestamp:q}=a;return{type:"immediate-click",pointerId:m,pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:q,mapPoint:this._getMapPoint(b,g),eventId:l,cancelable:n,stopPropagation:()=>a.stopPropagation(),async:r=>a.async(r),preventDefault:()=>a.preventDefault()}};h._wrapImmediateDoubleClick=function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c,eventId:l}=a.data,
m=c.pointerId,{cancelable:n,timestamp:q}=a;return{type:"immediate-double-click",pointerId:m,pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:q,mapPoint:this._getMapPoint(b,g),eventId:l,cancelable:n,stopPropagation:()=>a.stopPropagation(),async:r=>a.async(r),preventDefault:()=>a.preventDefault()}};h._wrapHold=function(a){const {pointerType:d,button:e,buttons:f,x:b,y:g,native:c}=a.data,{cancelable:l,timestamp:m}=a;return{type:"hold",pointerType:d,button:e,buttons:f,x:b,y:g,native:c,timestamp:m,
mapPoint:this._getMapPoint(b,g),cancelable:l,stopPropagation:()=>a.stopPropagation(),async:n=>a.async(n),preventDefault:()=>a.preventDefault()}};h._getMapPoint=function(a,d){return this.view.toMap(x.createScreenPoint(a,d),{exclude:[]})};h._wrapDrag=function(a){const d=a.data,{x:e,y:f}=d.center,{action:b,pointerType:g,button:c}=d;"start"===b&&(this._latestDragStart=d);if(this._latestDragStart){var l=d.pointer.native,m=d.buttons,{cancelable:n,timestamp:q}=a,r={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};
"end"===b&&(this._latestDragStart=void 0);return{type:"drag",action:b,x:e,y:f,origin:r,pointerType:g,button:c,buttons:m,radius:d.radius,angle:A.rad2deg(d.angle),native:l,timestamp:q,cancelable:n,stopPropagation:()=>a.stopPropagation(),async:t=>a.async(t),preventDefault:()=>a.preventDefault()}}};h._wrapKeyDown=function(a){const {key:d,repeat:e,native:f}=a.data,{cancelable:b,timestamp:g}=a;return{type:"key-down",key:d,repeat:e,native:f,timestamp:g,cancelable:b,stopPropagation:()=>a.stopPropagation(),
async:c=>a.async(c),preventDefault:()=>a.preventDefault()}};h._wrapKeyUp=function(a){const {key:d,native:e}=a.data,{cancelable:f,timestamp:b}=a;return{type:"key-up",key:d,native:e,timestamp:b,cancelable:f,stopPropagation:()=>a.stopPropagation(),async:g=>a.async(g),preventDefault:()=>a.preventDefault()}};h._wrapPointer=function(a,d){const {x:e,y:f,button:b,buttons:g,native:c,eventId:l}=a.data,m=c.pointerId,n=c.pointerType,{cancelable:q,timestamp:r}=a;return{type:d,x:e,y:f,pointerId:m,pointerType:n,
button:b,buttons:g,native:c,timestamp:r,eventId:l,cancelable:q,stopPropagation:()=>a.stopPropagation(),async:t=>a.async(t),preventDefault:()=>a.preventDefault()}};h._wrapPointerDrag=function(a){const {x:d,y:e,buttons:f,native:b,eventId:g}=a.data.currentEvent,{button:c}=a.data.startEvent,l=a.data.startEvent.native.pointerId,m=a.data.startEvent.native.pointerType,n=a.data.action,q={x:a.data.startEvent.x,y:a.data.startEvent.y},{cancelable:r,timestamp:t}=a;return{type:"pointer-drag",x:d,y:e,pointerId:l,
pointerType:m,button:c,buttons:f,action:n,origin:q,native:b,timestamp:t,eventId:g,cancelable:r,stopPropagation:()=>a.stopPropagation(),async:H=>a.async(H),preventDefault:()=>a.preventDefault()}};h._wrapMouseWheel=function(a){const {cancelable:d,data:e,timestamp:f}=a,{x:b,y:g,deltaY:c,native:l}=e;return{type:"mouse-wheel",x:b,y:g,deltaY:c,native:l,timestamp:f,cancelable:d,stopPropagation:()=>a.stopPropagation(),async:m=>a.async(m),preventDefault:()=>a.preventDefault()}};h._wrapGamepad=function(a){const {action:d,
state:e,device:f}=a.data,{cancelable:b,timestamp:g}=a,{buttons:c,axes:l}=e;return{type:"gamepad",device:f,timestamp:g,action:d,buttons:c,axes:l,cancelable:b,stopPropagation:()=>a.stopPropagation(),async:m=>a.async(m),preventDefault:()=>a.preventDefault()}};return v._createClass(p)}(B.InputHandler);Object.defineProperty(u,"MouseButton",{enumerable:!0,get:()=>D.MouseButton});u.ViewEvents=G;u.eventTypes=w;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});