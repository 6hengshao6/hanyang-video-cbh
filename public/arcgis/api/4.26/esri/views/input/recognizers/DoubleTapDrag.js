// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/clock ../../../core/MapUtils ../../../core/maybe ../../../core/screenUtils ../DragEventSeparator ../InputHandler ./SingleAndDoubleClick ./support".split(" "),function(t,p,v,w,u,m,x,q,n,r){q=function(f){function l(a=n.DefaultParameters.maximumDoubleClickDelay,b=n.DefaultParameters.maximumDoubleClickDistance,e=n.DefaultParameters.maximumDoubleTouchDelay,c=n.DefaultParameters.maximumDoubleTouchDistance,h=v.clock){var d=y.call(this,
!1);d._maximumDoubleClickDelay=a;d._maximumDoubleClickDistance=b;d._maximumDoubleTouchDelay=e;d._maximumDoubleTouchDistance=c;d._clock=h;d._doubleTapDragReady=!1;d._doubleTapDragActive=!1;d._dragStartCenter=m.createScreenPoint(0,0);d._pointerState=new Map;d._doubleTapDrag=d.registerOutgoing("double-tap-drag");d._dragEventSeparator=new x.DragEventSeparator({start:(g,k)=>d._dragStart(g,k),update:(g,k)=>d._dragUpdate(k),end:(g,k)=>d._dragEnd(k)});d.registerIncoming("drag",g=>d._dragEventSeparator.handle(g));
d.registerIncoming("pointer-down",g=>d._handlePointerDown(g));d.registerIncoming("pointer-up",()=>d._handlePointerUp());return d}p._inherits(l,f);var y=p._createSuper(l);f=l.prototype;f.onUninstall=function(){this._pointerState.forEach(a=>{a.doubleTapTimeout=u.removeMaybe(a.doubleTapTimeout)})};f._clearPointerDown=function(a){const b=this._pointerState.get(a);b&&(b.doubleTapTimeout=u.removeMaybe(b.doubleTapTimeout),this._pointerState.delete(a),this.refreshHasPendingInputs())};f._createDoubleTapDragData=
function(a,b,e){const {button:c,buttons:h,pointer:d,pointers:g,pointerType:k,timestamp:z}=e;return{action:a,delta:b,button:c,buttons:h,pointer:d,pointers:g,pointerType:k,timestamp:z}};f._dragStart=function(a,b){if(this._doubleTapDragReady&&1===a){this._doubleTapDragReady=!1;this._doubleTapDragActive=!0;var {data:e,modifiers:c}=b;({center:a}=e);this._dragStartCenter=a;a=this._createDoubleTapDragData("begin",m.createScreenPoint(0,0),e);this._doubleTapDrag.emit(a,void 0,c);b.stopPropagation()}};f._dragUpdate=
function(a){if(this._doubleTapDragActive){var {data:b,modifiers:e}=a,{center:c}=b;c=m.createScreenPoint(c.x-this._dragStartCenter.x,c.y-this._dragStartCenter.y);c=this._createDoubleTapDragData("update",c,b);this._doubleTapDrag.emit(c,void 0,e);a.stopPropagation()}};f._dragEnd=function(a){if(this._doubleTapDragActive){var {data:b,modifiers:e}=a,{center:c}=b;c=m.createScreenPoint(c.x-this._dragStartCenter.x,c.y-this._dragStartCenter.y);c=this._createDoubleTapDragData("end",c,b);this._doubleTapDrag.emit(c,
void 0,e);this._doubleTapDragActive=!1;a.stopPropagation()}};f._handlePointerDown=function(a){const {data:b}=a,e=r.getPointerId(b),c=this._pointerState.get(e);var {pointerType:h}=b.native;c?(h="touch"===h?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance,this._clearPointerDown(e),r.manhattanDistance(c.event.data,b)>h?this._storePointerDown(a):this._doubleTapDragReady=!0):this._storePointerDown(a)};f._handlePointerUp=function(){this._doubleTapDragReady=!1};f._storePointerDown=function(a){var {data:b}=
a;const {pointerType:e}=b.native,c=r.getPointerId(b);b=this._clock.setTimeout(()=>this._clearPointerDown(c),"touch"===e?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay);this._pointerState.set(c,{event:a,doubleTapTimeout:b});this.refreshHasPendingInputs()};p._createClass(l,[{key:"hasPendingInputs",get:function(){return w.someMap(this._pointerState,a=>null!=a.doubleTapTimeout)}}]);return l}(q.InputHandler);t.DoubleTapDrag=q;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});