// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../geometry/support/aaBoundingRect ../../../layers/support/layerUtils ../../ViewingMode ./TerrainConst ./terrainUtils".split(" "),function(c,k,e,D,p,m,G,H,
I,t,E,g,F,x,y,z){function A(a,b){return p.isSome(a)&&!a.spatialReference.equals(b)?E.projectWithoutEngine(a,a.spatialReference,b):a}c.ExtentHelper=function(a){function b(d){return q.call(this,d)}k._inherits(b,a);var q=k._createSuper(b);a=b.prototype;a.initialize=function(){this.addHandles([this.layerViews.on("change",()=>this.notifyChange("stencilEnabledExtents"))])};a.destroy=function(){};a._computeStencilEnabledExtents=function(){const d=[];this.layerViews.forEach(f=>{f=f.layer;"IntegratedMeshLayer"===
f.operationalLayerType&&null!=this.viewSpatialReference&&(f=A(f.fullExtent,this.viewSpatialReference),p.isSome(f)&&d.push(g.fromExtent(f)))});return d};k._createClass(b,[{key:"layerViewsExtent",get:function(){return this._computeLayerViewsExtent()}},{key:"tiledLayersExtent",get:function(){return this._computeTiledLayersExtent()}},{key:"stencilEnabledExtents",get:function(){return this._computeStencilEnabledExtents()}}]);return b}(D);e.__decorate([m.property({readOnly:!0})],c.ExtentHelper.prototype,
"layerViewsExtent",null);e.__decorate([m.property({readOnly:!0})],c.ExtentHelper.prototype,"tiledLayersExtent",null);e.__decorate([m.property({readOnly:!0})],c.ExtentHelper.prototype,"stencilEnabledExtents",null);e.__decorate([m.property()],c.ExtentHelper.prototype,"viewSpatialReference",void 0);e.__decorate([m.property()],c.ExtentHelper.prototype,"tilingScheme",void 0);e.__decorate([m.property()],c.ExtentHelper.prototype,"defaultTiledLayersExtent",void 0);e.__decorate([m.property({constructOnly:!0})],
c.ExtentHelper.prototype,"layers",void 0);e.__decorate([m.property({constructOnly:!0})],c.ExtentHelper.prototype,"layerViews",void 0);c.ExtentHelper=e.__decorate([t.subclass("esri.views.3d.terrain.ExtentHelper")],c.ExtentHelper);let u=function(a){function b(){return q.apply(this,arguments)}k._inherits(b,a);var q=k._createSuper(b);a=b.prototype;a._computeLayerViewsExtent=function(){return this._globalExtent};a._computeTiledLayersExtent=function(){return this._globalExtent};k._createClass(b,[{key:"_globalExtent",
get:function(){return this.viewSpatialReference.isWebMercator?y.WEBMERCATOR_WORLD_EXTENT:y.GEOGRAPHIC_WORLD_EXTENT}}]);return b}(c.ExtentHelper);u=e.__decorate([t.subclass("esri.views.3d.terrain.ExtentHelperGlobal")],u);let w=function(a){function b(){return q.apply(this,arguments)}k._inherits(b,a);var q=k._createSuper(b);a=b.prototype;a._computeLayerViewsExtent=function(){const d=g.empty(),f=this.viewSpatialReference;this.layerViews.forEach(h=>{const n=h.layer;!h.isResolved()||"graphics"===n.type&&
n.internal||(h=A("fullExtentInLocalViewSpatialReference"in h&&h.fullExtentInLocalViewSpatialReference||h.layer.fullExtent,f),g.expand(d,h,d))});const l=g.allFinite(d)?d:null,r=this._get("layerViewsExtent");return g.equals(l,r)?r:l};a._computeTiledLayersExtent=function(){const d=this.tilingScheme;if(!d)return null;const f=this.viewSpatialReference,l=g.empty();this.layers.forEach(n=>{if(n.loaded&&F.isTiledLayer(n)){const B=z.getTiledLayerInfo(n,f,x.ViewingMode.Local);if(!p.isNone(B)){var {tileInfo:C,
fullExtent:v}=B;p.isSome(C)&&p.isSome(v)&&(z.isProjectableRasterLayer(n)||d.compatibleWith(C)&&v.spatialReference.equals(d.spatialReference))&&g.expand(l,v,l)}}});g.expand(l,this.defaultTiledLayersExtent,l);const r=g.allFinite(l)?l:null,h=this._get("tiledLayersExtent");return g.equals(r,h)?h:r};return k._createClass(b)}(c.ExtentHelper);w=e.__decorate([t.subclass("esri.views.3d.terrain.ExtentHelperLocal")],w);c.create=function(a,b){return a===x.ViewingMode.Global?new u(b):new w(b)};Object.defineProperty(c,
Symbol.toStringTag,{value:"Module"})});