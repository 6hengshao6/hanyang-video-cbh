// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ./TextureCollection ../webgl-engine/lib/basicInterfaces ../webgl-engine/lib/Texture".split(" "),function(p,k,r,q,t,l,u,v){l=function(g){function h(d,a,b,c){a=w.call(this,a,c);a._streamDataRequester=d;a._parameters=b;return a}k._inherits(h,g);var w=k._createSuper(h);g=h.prototype;g.fromUrl=async function(d,a,b){q.throwIfAborted(b);b=r.isSome(b)?b.signal:null;const c=this.makeUid(d,
a);var e=this._textureRequests.get(c);if(!e){e=new AbortController;const m=this._streamDataRequester.request(d,"image",{uid:c,signal:e.signal}),n=e={referenceCount:0,texture:null,textureAsync:null,abortController:e};this._textureRequests.set(c,e);e.textureAsync=m.then(async f=>{f=this._createTexture(d,f,a);n.texture=f;n.abortController=null;this._stage.add(f);await this._stage.load(f);return{uid:c,texture:f,release:()=>this._release(c)}},f=>{n.abortController=null;throw f;})}e.referenceCount++;try{return await q.whenOrAbort(e.textureAsync,
b)}catch(m){throw this._release(c),m;}};g._createTexture=function(d,a,b){const c={...this._parameters,powerOfTwoResizeMode:u.PowerOfTwoResizeMode.PAD};if(t.isSVG(d)){if(b||0===a.width&&0===a.height)d=a.width?a.height/a.width:1,b=b||64,1<d?(a.width=Math.round(b/d),a.height=b):(a.width=b,a.height=Math.round(b*d));this._stage.renderView?.renderingContext.driverTest.svgPremultipliesAlpha.result&&(c.preMultiplyAlpha=!1)}c.width=a.width;c.height=a.height;return new v.Texture(a,c)};return k._createClass(h)}(l.TextureCollection);
p.StreamTextureCollection=l;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});