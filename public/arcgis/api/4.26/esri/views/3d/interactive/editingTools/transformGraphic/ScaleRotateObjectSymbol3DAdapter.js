// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/HandleOwner ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/accessorSupport/ensureType ../../../../../core/arrayUtils ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass".split(" "),function(g,u,e,B,C,x,d,y,f,E,
F,G,z){function A(l){return-x.deg2rad(l)}g.ScaleRotateObjectSymbol3DAdapter=function(l){function m(a){a=w.call(this,a);a.sizeAxis=null;a._interactionState=null;return a}u._inherits(m,l);var w=u._createSuper(m);l=m.prototype;l.initialize=function(){this.addHandles(y.when(()=>d.isSome(this._interactionState)?this._interactionState.state:null,a=>{this._updateSymbol(a)},y.sync))};l.startInteraction=function(){const a=this._graphicSymbol,b=this.findLayerView();if(d.isSome(this._interactionState)||d.isNone(a)||
d.isNone(b))return D;var c=a.symbolLayers.map(t=>"object"===t.type?b.getSymbolLayerSize(a,t):null).toArray();const p=a.clone();this._interactionState=c=new q({originalSymbol:p,angle:this.angle,initialSizes:c});const k=()=>{this._interactionState=null};return{state:c,done:k,cancel:()=>{this._graphicSymbol=p;k()}}};l.createUndoRecord=function(){let a=this.graphic.symbol,b=null;return{undo:c=>{b=c.symbol;c.symbol=a},redo:c=>{a=c.symbol;c.symbol=b}}};l._updateSymbol=function({scale:a,angle:b,originalSymbol:c,
initialSizes:p}){var k=this._graphicSymbol;if(!d.isNone(k)&&"point-3d"===k.type){k=k.clone();var t=-x.rad2deg(b-this.initialAngle),v=!1;this._forEachObjectSymbolLayerPair(c,k,(n,r,h)=>{n=d.unwrapOr(n.heading,0)+t;r.heading!==n&&(r.heading=n,v=!0);h=p[h];d.isSome(h)&&"width"in h&&(h.width=this.sizeFilter(h.width),h.height=this.sizeFilter(h.height),h.depth=this.sizeFilter(h.depth),n=h.width*a,r.width!==n&&(r.width=n,v=!0),n=h.depth*a,r.depth!==n&&(r.depth=n,v=!0),h=h.height*a,r.height!==h&&(r.height=
h,v=!0))});v&&(this._graphicSymbol=k)}};l._forEachObjectSymbolLayerPair=function(a,b,c){a.symbolLayers.forEach((p,k)=>{const t=b.symbolLayers.getItemAt(k);"object"===p.type&&"object"===t.type&&c(p,t,k)})};u._createClass(m,[{key:"angle",get:function(){return d.isSome(this._interactionState)?this._interactionState.angle:d.isSome(this._orientationReferenceSymbolLayer)?A(this._orientationReferenceSymbolLayer.heading??0):0}},{key:"scale",get:function(){return d.isSome(this._interactionState)?this._interactionState.scale:
1}},{key:"relativeAngle",get:function(){return this.angle-this.initialAngle}},{key:"initialAngle",get:function(){return d.isSome(this._interactionState)?this._interactionState.initialAngle:0}},{key:"size",get:function(){const a=this._sizeReferenceSymbolLayer;if(d.isNone(a))return null;var b=this.findLayerView(),c=this._graphicSymbol;if(d.isNone(b)||d.isNone(c)||"point-3d"!==c.type)return null;b=b.getSymbolLayerSize(c,a);if("size"in b&&d.isSome(b.size))return b.size;c=this.sizeAxis;return"width"in
b&&d.isSome(b.width)&&(d.isNone(c)||"width"===c||"all"===c||"width-and-depth"===c)?b.width:"depth"in b&&d.isSome(a.depth)&&(d.isNone(c)||"depth"===c||"all"===c||"width-and-depth"===c)?b.depth:"height"in b&&d.isSome(a.height)&&(d.isNone(c)||"height"===c||"all"===c)?b.height:null}},{key:"_sizeReferenceSymbolLayer",get:function(){const a=this._graphicSymbol;return d.isNone(a)||0===a.symbolLayers.length?null:a.symbolLayers.find(b=>"object"===b.type)}},{key:"_orientationReferenceSymbolLayer",get:function(){const a=
this._graphicSymbol;return d.isNone(a)||0===a.symbolLayers.length?null:a.symbolLayers.find(b=>"object"===b.type&&d.isSome(b.heading))}},{key:"_graphicSymbol",get:function(){return d.isSome(this.graphic)&&d.isSome(this.graphic.symbol)&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null},set:function(a){this.graphic.symbol=a}}]);return m}(C.HandleOwner);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"angle",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,
"scale",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngle",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"initialAngle",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"size",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeAxis",void 0);e.__decorate([f.property({constructOnly:!0})],g.ScaleRotateObjectSymbol3DAdapter.prototype,"graphic",void 0);e.__decorate([f.property()],
g.ScaleRotateObjectSymbol3DAdapter.prototype,"_interactionState",void 0);e.__decorate([f.property({constructOnly:!0})],g.ScaleRotateObjectSymbol3DAdapter.prototype,"findLayerView",void 0);e.__decorate([f.property({constructOnly:!0})],g.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeFilter",void 0);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"_sizeReferenceSymbolLayer",null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"_orientationReferenceSymbolLayer",
null);e.__decorate([f.property()],g.ScaleRotateObjectSymbol3DAdapter.prototype,"_graphicSymbol",null);g.ScaleRotateObjectSymbol3DAdapter=e.__decorate([z.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],g.ScaleRotateObjectSymbol3DAdapter);const D={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let q=function(l){function m(a){var b=w.call(this,a);b.angle=0;b.initialAngle=0;b.scale=1;b.initialAngle=a.angle;return b}u._inherits(m,l);var w=u._createSuper(m);
u._createClass(m,[{key:"state",get:function(){const {originalSymbol:a,angle:b,initialAngle:c,scale:p,initialSizes:k}=this;return{originalSymbol:a,angle:b,initialAngle:c,scale:p,initialSizes:k}}}]);return m}(B);e.__decorate([f.property()],q.prototype,"originalSymbol",void 0);e.__decorate([f.property()],q.prototype,"angle",void 0);e.__decorate([f.property()],q.prototype,"initialAngle",void 0);e.__decorate([f.property()],q.prototype,"initialSizes",void 0);e.__decorate([f.property()],q.prototype,"scale",
void 0);e.__decorate([f.property()],q.prototype,"state",null);q=e.__decorate([z.subclass("InteractionState")],q);g.headingToAngle=A;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});