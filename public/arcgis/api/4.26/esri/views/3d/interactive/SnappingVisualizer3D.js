// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../Color ../../../core/has ../../../core/handleUtils ../../../core/maybe ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../geometry/projection ../../../support/elevationInfoUtils ./visualElements/ExtendedLineVisualElement ./visualElements/ParallelLineVisualElement ./visualElements/PointVisualElement ./visualElements/RightAngleQuadVisualElement ../layers/interfaces ../webgl-engine/lib/Material ../../interactive/snapping/Settings ../../interactive/snapping/SnappingDomain ../../interactive/snapping/SnappingPoint ../../interactive/snapping/snappingUtils ../../interactive/snapping/SnappingVisualizer ../../interactive/snapping/hints/LineSnappingHint ../../interactive/support/viewUtils".split(" "),
function(A,v,m,B,q,t,F,G,H,u,C,I,D,J,w,l,f,K,x,y,L,E,M){function n(g,p,z,a,b,d=G.create()){b?H.projectVectorToVector(g,p,d,a.basemapTerrain.overlayManager.renderer.spatialReference):M.vectorToRender(g,p,z,a,d);return d}B=function(g){function p(){return z.apply(this,arguments)}v._inherits(p,g);var z=v._createSuper(p);g=p.prototype;g.sortUniqueHints=function(a){return a.sort((b,d)=>(d instanceof E.LineSnappingHint?d.length:0)-(b instanceof E.LineSnappingHint?b.length:0))};g.visualizeIntersectionPoint=
function(a,b){const {spatialReference:d,view:h}=b;return q.destroyHandle(new D.PointVisualElement({view:h,primitive:"circle",geometry:x.snappingPointToDehydratedPoint(a.intersectionPoint,d),elevationInfo:a.isDraped?u.onTheGroundElevationInfo:u.absoluteHeightElevationInfo,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:m.toUnitRGBA(f.defaults.orange),pixelSnappingEnabled:!1}))};g.visualizePoint=function(a,b){const {view:d,spatialReference:h}=b,e=this._alignPoint(a.point,a.domain,b);return q.destroyHandle(new D.PointVisualElement({view:d,
primitive:"circle",geometry:x.snappingPointToDehydratedPoint(e,h),elevationInfo:this._hintElevationInfo(a,b),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:m.toUnitRGBA(f.defaults.orange),pixelSnappingEnabled:!1}))};g.visualizeLine=function(a,b){const {view:d,spatialReference:h}=b,e=this._alignPoint(a.lineStart,a.domain,b),c=this._alignPoint(a.lineEnd,a.domain,b);return q.destroyHandle(this._createLineSegmentHint(a.type,e,c,h,this._hintElevationInfo(a,b),d,a.isDraped,a.fadeLeft,a.fadeRight))};
g.visualizeParallelSign=function(a,b){const {view:d,spatialReference:h}=b;var {isDraped:e}=a,c=this._hintElevationInfo(a,b),k=this._alignPoint(a.lineStart,a.domain,b);a=this._alignPoint(a.lineEnd,a.domain,b);k=n(k,h,c,d,e);c=n(a,h,c,d,e);c=F.lerp(c,k,c,.5);e=new I.ParallelLineVisualElement({view:d,attached:!1,offset:f.defaults.parallelLineHintOffset,length:f.defaults.parallelLineHintLength,width:f.defaults.parallelLineHintWidth,color:m.toUnitRGBA(f.defaults.orange),location:c,renderOccluded:e?l.RenderOccludedFlag.OccludeAndTransparent:
l.RenderOccludedFlag.Opaque,isDraped:e,renderGroup:w.DrapedRenderGroup.SnappingHint});e.setDirectionFromPoints(k,c);e.attached=!0;return q.destroyHandle(e)};g.visualizeRightAngleQuad=function(a,b){const {view:d,spatialReference:h}=b;var e=this._hintElevationInfo(a,b);const {isDraped:c}=a;var k=this._alignPoint(a.previousVertex,a.domain,b),r=this._alignPoint(a.centerVertex,a.domain,b);a=this._alignPoint(a.nextVertex,a.domain,b);k=n(k,h,e,d,c);r=n(r,h,e,d,c);e=n(a,h,e,d,c);return q.destroyHandle(new J.RightAngleQuadVisualElement({view:d,
attached:!0,color:c?m.toUnitRGBA(f.defaults.orangeTransparent):m.toUnitRGBA(f.defaults.orange),renderOccluded:c?l.RenderOccludedFlag.OccludeAndTransparent:l.RenderOccludedFlag.Transparent,outlineRenderOccluded:c?l.RenderOccludedFlag.OccludeAndTransparent:l.RenderOccludedFlag.Opaque,outlineColor:m.toUnitRGBA(f.defaults.orange),outlineSize:f.defaults.rightAngleHintOutlineSize,size:f.defaults.rightAngleHintSize,isDraped:c,geometry:{previous:k,center:r,next:e},renderGroup:w.DrapedRenderGroup.SnappingHint}))};
g._createLineSegmentHint=function(a,b,d,h,e,c,k=!1,r=!0,N=!0){b=n(b,h,e,c,k);d=n(d,h,e,c,k);c=new C.ExtendedLineVisualElement({view:c,extensionType:C.ExtensionType.FADED,start:b,end:d,isDraped:k,color:m.toUnitRGBA(f.defaults.orange),renderOccluded:k?l.RenderOccludedFlag.OccludeAndTransparent:l.RenderOccludedFlag.Opaque,renderGroup:w.DrapedRenderGroup.SnappingHint});switch(a){case y.LineSegmentHintType.TARGET:c.width=f.defaults.lineHintWidthTarget;c.fadedExtensions={start:0,end:f.defaults.lineHintFadedExtensions};
break;case y.LineSegmentHintType.REFERENCE_EXTENSION:c.width=f.defaults.lineHintWidthReference;c.fadedExtensions={start:0,end:0};break;case y.LineSegmentHintType.REFERENCE:c.width=f.defaults.lineHintWidthReference,c.fadedExtensions={start:r?f.defaults.lineHintFadedExtensions:0,end:N?f.defaults.lineHintFadedExtensions:0}}c.attached=!0;return c};g._alignPoint=function(a,b,d){b=this._getSelfSnappingZ(b,d);return t.isNone(b)?a:x.createSnappingPoint(a[0],a[1],b)};g._hintElevationInfo=function(a,b){return t.isSome(this._getSelfSnappingZ(a.domain,
b))?t.unwrap(b.selfSnappingZ).elevationInfo:a.isDraped?u.onTheGroundElevationInfo:u.absoluteHeightElevationInfo};g._getSelfSnappingZ=function(a,{selfSnappingZ:b}){return a===K.SnappingDomain.SELF&&t.isSome(b)?b.value:null};return v._createClass(p)}(L.SnappingVisualizer);A.SnappingVisualizer3D=B;Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})});