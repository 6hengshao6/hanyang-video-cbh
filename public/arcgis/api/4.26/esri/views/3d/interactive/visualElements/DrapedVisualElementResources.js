// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Identifiable ../../../../core/maybe ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../layers/interfaces ../../webgl-engine/lib/ModelDirtyTypes ../../webgl-engine/lib/UpdatePolicy".split(" "),function(m,g,h,r,t,d,k,
n,w,x,u,l,p,v){n=function(){function f(a){this._resourceFactory=a;this._resources=null;this._visible=!0;this._attached=!1;this._renderGroup=l.DrapedRenderGroup.Outline}var b=f.prototype;b.destroy=function(){this._destroyResources()};b.recreate=function(){this.attached&&this._createResources()};b.recreateGeometry=function(){this._resourceFactory.recreateGeometry?d.isNone(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):
this.recreate()};b._createOrDestroyResources=function(){this._attached?d.isNone(this._resources)&&this._createResources():this._destroyResources()};b._createResources=function(){this._destroyResources();const a=this._resourceFactory.createResources(),c=new e({view:this._resourceFactory.view,renderGroup:this._renderGroup}),q=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new e({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:a,geometriesAdded:!1};
q&&(this._resources.drapeSourceRenderer=q.registerGeometryDrapeSource(c));this._syncGeometriesToRenderer()};b._destroyResources=function(){if(!d.isNone(this._resources)){this._ensureRenderGeometriesRemoved();var a=this._resourceFactory.view.basemapTerrain?.overlayManager;a&&a.unregisterDrapeSource(this._resources.layerView);this._resourceFactory.destroyResources(this._resources.external);this._resources=null}};b._syncGeometriesToRenderer=function(){this._visible?this._ensureRenderGeometriesAdded():
this._ensureRenderGeometriesRemoved()};b._ensureRenderGeometriesRemoved=function(){d.isNone(this._resources)||d.isNone(this._resources.drapeSourceRenderer)||!this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,p.DirtyOperation.UPDATE),this._resources.geometriesAdded=!1)};b._ensureRenderGeometriesAdded=function(){d.isNone(this._resources)||d.isNone(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,
p.DirtyOperation.UPDATE),this._resources.geometriesAdded=!0)};g._createClass(f,[{key:"resources",get:function(){return d.isSome(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(a){a!==this._visible&&(this._visible=a,this._syncGeometriesToRenderer())}},{key:"attached",get:function(){return this._attached},set:function(a){a!==this._attached&&(this._attached=a,this._createOrDestroyResources())}},{key:"renderGroup",get:function(){return this._renderGroup},
set:function(a){this._renderGroup=a;const c=d.toNullable(this._resources)?.layerView;c&&(c.renderGroup=a)}}]);return f}();let e=function(f){function b(c){c=a.call(this,c);c.drapeSourceType=l.DrapeSourceType.Features;c.updatePolicy=v.UpdatePolicy.SYNC;c.renderGroup=l.DrapedRenderGroup.Outline;return c}g._inherits(b,f);var a=g._createSuper(b);return g._createClass(b)}(t.IdentifiableMixin(r));h.__decorate([k.property({constructOnly:!0})],e.prototype,"view",void 0);h.__decorate([k.property({readOnly:!0})],
e.prototype,"drapeSourceType",void 0);h.__decorate([k.property()],e.prototype,"renderGroup",void 0);e=h.__decorate([u.subclass("DrapedVisualElementLayerView")],e);m.DrapedVisualElementResources=n;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});