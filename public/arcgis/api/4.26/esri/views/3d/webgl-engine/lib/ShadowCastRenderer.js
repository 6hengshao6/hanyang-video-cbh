// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/maybe ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec4 ./glUtil3D ../../../../chunks/ShadowCastVisualize.glsl ../shaders/ShadowCastVisualizeTechnique ../shaders/ShadowCastVisualizeTechniqueConfiguration ../../../webgl/Util".split(" "),
function(d,g,h,n,p,q,A,B,C,r,k,t,u,v,l,w){const m=1/512;d.ShadowCastRenderer=function(b){function e(a,f,x,y){var c=z.call(this,{});c._techniqueRepository=a;c._rctx=f;c._data=x;c._requestRender=y;c._passParameters=new u.ShadowCastVisualizePassParameters(c._data.shadowCastTexture);c._techniqueConfig=new l.ShadowCastVisualizeTechniqueConfiguration;c._enabled=!1;c._vao=t.createQuadVAO(f);c._techniqueConfig.visualization=l.ShadowCastVisualization.Gradient;return c}g._inherits(e,b);var z=g._createSuper(e);
b=e.prototype;b.normalizeCtorArgs=function(){return{}};b.dispose=function(){this._stop();this._vao=p.disposeMaybe(this._vao);this._techniqueRepository.release(this._technique);this._technique=null};b.render=function(a){if(this._showVisualization){this._passParameters.sampleScale=1/this._data.computedSamples;var f=this._visualizeShadowCastTechnique;this._rctx.bindVAO(this._vao);this._rctx.bindTechnique(f,this._passParameters,a);this._rctx.drawArrays(f.primitiveType,0,w.vertexCount(this._vao,"geometry"))}};
b.setOptions=function(a){void 0!==a.enabled&&this._setEnabled(a.enabled);void 0!==a.color&&this._setColor(a.color);void 0!==a.threshold&&(this._threshold=a.threshold);void 0!==a.visualization&&(this._visualization=a.visualization);void 0!==a.bandSize&&(this._bandSize=a.bandSize);void 0!==a.bandsEnabled&&(this._bandsEnabled=a.bandsEnabled)};b._setColor=function(a){k.exactEquals(a,this._passParameters.color)||(k.copy(this._passParameters.color,a),this._requestRenderIfRunning())};b._setEnabled=function(a){a!==
this._enabled&&(a?this._start():this._stop())};b._requestRenderIfRunning=function(){this._enabled&&this._requestRender()};b._start=function(){this._enabled=!0;this._requestRender()};b._stop=function(){this._enabled=!1;this._requestRender()};g._createClass(e,[{key:"_visualizeShadowCastTechnique",get:function(){return this._technique=this._techniqueRepository.releaseAndAcquire(v.ShadowCastVisualizeTechnique,this._techniqueConfig,this._technique)}},{key:"opacityFromElevation",get:function(){return this._passParameters.opacityFromElevation},
set:function(a){this._passParameters.opacityFromElevation!==a&&(this._passParameters.opacityFromElevation=a,this.notifyChange("opacityFromElevation"))}},{key:"_showVisualization",get:function(){return this._enabled&&0<this._data.computedSamples&&this.opacityFromElevation>m}},{key:"_threshold",get:function(){return this._passParameters.threshold},set:function(a){this._threshold!==a&&(this._passParameters.threshold=a,this._requestRenderIfRunning())}},{key:"_visualization",get:function(){return this._techniqueConfig.visualization},
set:function(a){a!==this._visualization&&(this._techniqueConfig.visualization=a,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}},{key:"_bandSize",get:function(){return this._passParameters.bandSize},set:function(a){a!==this._bandSize&&(this._passParameters.bandSize=a,this._requestRenderIfRunning())}},{key:"_bandsEnabled",get:function(){return this._techniqueConfig.bandsEnabled},set:function(a){a!==this._bandsEnabled&&(this._techniqueConfig.bandsEnabled=
a,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}}]);return e}(n);h.__decorate([q.property()],d.ShadowCastRenderer.prototype,"opacityFromElevation",null);d.ShadowCastRenderer=h.__decorate([r.subclass("esri.views.3d.webgl-engine.lib.ShadowCastRenderer")],d.ShadowCastRenderer);d.shadowCastDisableElevationMax=5E4;d.shadowCastDisableElevationMin=4E4;d.shadowCastDisabledElevationThreshold=m;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});