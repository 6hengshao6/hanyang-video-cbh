// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec2f64 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../../../../chunks/vec4f64 ../../../../geometry/support/FloatArray ../../../../geometry/support/Indices ./Attribute ./VertexAttribute ../materials/internal/MaterialUtil".split(" "),function(B,l,m,G,w,C,P,H,Q,n,c,R){let I=function(){function d(e){this.builder=e}d.prototype.onPathChanged=function(e){this.builder.onPathChanged()};return l._createClass(d)}(),
O=function(d){function e(a){a=J.call(this,a);a.vertexAttributeColor=P.fromValues(255,255,255,255);a.size=[];a.vertexAttributePosition=H.newFloatArray(3*a.builder.numVerticesTotal);a.vertexAttributeNormal=H.newFloatArray(3*a.builder.numVerticesTotal);return a}l._inherits(e,d);var J=l._createSuper(e);d=e.prototype;d.bakeVertexColors=function(a){this.vertexAttributeColor[0]=255*a[0];this.vertexAttributeColor[1]=255*a[1];this.vertexAttributeColor[2]=255*a[2];this.vertexAttributeColor[3]=255*(3<a.length?
a[3]:1)};d.bake=function(a){this.size=a;const {numVerticesTotal:u,pathVertexData:v,path:q,positions:b,profileRightAxes:x,profileUpAxes:y,profileVertexAndNormals:D}=this.builder;for(let z=0;z<u;++z){var k=v[z],f=0===k||k===q.vertices.length-1;k*=3;const p=S;let E=0,F=0;const h=4*z,r=w.set(T,x[h],x[h+1],x[h+2]),t=w.set(U,y[h],y[h+1],y[h+2]);var g=m.set(K,D[h]*a[0],D[h+1]*a[1]);if(f)w.cross(p,t,r),E=x[h+3]*a[0],F=y[h+3];else{f=V;const A=W;m.set(f,x[h+3],y[h+3]);const L=m.length(f);m.normalize(f,f);const M=
m.dot(g,f);if(Math.abs(M)>L){m.set(A,-f[1],f[0]);const X=m.dot(g,A);m.scale(f,f,L*Math.sign(M));m.scale(A,A,X);m.add(g,f,A)}w.set(p,0,0,0)}f=w.set(Y,r[0]*g[0]+t[0]*g[1],r[1]*g[0]+t[1]*g[1],r[2]*g[0]+t[2]*g[1]);g=3*z;this.vertexAttributePosition[g]=b[k]+f[0]+p[0]*E;this.vertexAttributePosition[g+1]=b[k+1]+f[1]+p[1]*E;this.vertexAttributePosition[g+2]=b[k+2]+f[2]+p[2]*E;k=m.set(K,D[h+2],D[h+3]);this.vertexAttributeNormal[g]=r[0]*k[0]+t[0]*k[1]+p[0]*F;this.vertexAttributeNormal[g+1]=r[1]*k[0]+t[1]*k[1]+
p[1]*F;this.vertexAttributeNormal[g+2]=r[2]*k[0]+t[2]*k[1]+p[2]*F}};d.createGeometryData=function(){const a=this.builder.vertexIndices.length;return new N([[c.VertexAttribute.POSITION,new n.Attribute(this.vertexAttributePosition,3,!0)],[c.VertexAttribute.NORMAL,new n.Attribute(this.vertexAttributeNormal,3,!0)],[c.VertexAttribute.COLOR,new n.Attribute(this.vertexAttributeColor,4)]],[[c.VertexAttribute.POSITION,this.builder.vertexIndices],[c.VertexAttribute.NORMAL,this.builder.normalIndices],[c.VertexAttribute.COLOR,
Q.getZeroIndexArray(a)]])};d.onPathChanged=function(a){l._get(l._getPrototypeOf(e.prototype),"onPathChanged",this).call(this,a);this.bake(this.size)};d.intersect=function(a,u,v){const q=this.builder.vertexIndices,b=new n.Attribute(this.vertexAttributePosition,3);R.intersectTriangles(a,u,0,q.length/3,q,b,void 0,void 0,v)};return l._createClass(e)}(I),Z=function(d){function e(a,u,v,q){var b=J.call(this,a);b.sizeAttributeValue=u;b.colorAttributeValue=v;b.opacityAttributeValue=q;b.vvData=null;b.baked=
new O(a);b.vvData=H.newFloatArray(4*b.builder.path.vertices.length);for(a=0;a<b.builder.path.vertices.length;++a)b.vvData[4*a]=u,b.vvData[4*a+1]=v,b.vvData[4*a+2]=q,b.vvData[4*a+3]=0===a||a===b.builder.path.vertices.length-1?1:0;return b}l._inherits(e,d);var J=l._createSuper(e);d=e.prototype;d.createGeometryData=function(){return new N([[c.VertexAttribute.POSITION,new n.Attribute(this.builder.positions,3,!0)],[c.VertexAttribute.PROFILERIGHT,new n.Attribute(this.builder.profileRightAxes,4,!0)],[c.VertexAttribute.PROFILEUP,
new n.Attribute(this.builder.profileUpAxes,4,!0)],[c.VertexAttribute.PROFILEVERTEXANDNORMAL,new n.Attribute(this.builder.profileVertexAndNormals,4,!0)],[c.VertexAttribute.FEATUREVALUE,new n.Attribute(this.vvData,4,!0)]],[[c.VertexAttribute.POSITION,this.builder.pathVertexIndices],[c.VertexAttribute.PROFILERIGHT,this.builder.vertexIndices],[c.VertexAttribute.PROFILEUP,this.builder.vertexIndices],[c.VertexAttribute.PROFILEVERTEXANDNORMAL,this.builder.vertexIndices],[c.VertexAttribute.FEATUREVALUE,this.builder.pathVertexIndices]])};
d.onPathChanged=function(a){l._get(l._getPrototypeOf(e.prototype),"onPathChanged",this).call(this,a);if(a=a.getMutableAttribute(c.VertexAttribute.POSITION))a.data=this.builder.positions};return l._createClass(e)}(I),N=l._createClass(function(d,e){this.vertexAttributes=d;this.indices=e});const K=G.create(),V=G.create(),W=G.create(),Y=C.create(),S=C.create(),T=C.create(),U=C.create();B.FastUpdatePathGeometry=Z;B.PathGeometryData=I;B.StaticPathGeometry=O;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})});