// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/asyncUtils ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ./LayerView3D ../../layers/LayerView".split(" "),function(p,l,g,q,m,d,r,n,h,t,e,u){e=function(c){function k(a){a=v.call(this,a);a.type="line-of-sight-3d";a._analysisModule=null;return a}l._inherits(k,
c);var v=l._createSuper(k);c=k.prototype;c.initialize=function(){this.handles.add(n.watch(()=>this.layer.analysis,a=>{this._destroyAnalysisView();d.isSome(a)&&this._createAnalysisView(a)},n.syncAndInitial),"analysis-view-handles")};c.destroy=function(){this.handles.remove("analysis-view-handles");this._destroyAnalysisView()};c.whenAnalysisView=async function(){if(d.isSome(this.analysisView))return this.analysisView;if(d.isSome(this._createAnalysisViewTask))return this._createAnalysisViewTask.promise;
throw new m("layerview:no-analysisview-for-analysis","The analysis has not been set on the LineOfSightLayer of this layer view");};c.isUpdating=function(){return d.isSome(this._createAnalysisViewTask)||d.isSome(this.analysisView)&&this.analysisView.updating};c._createAnalysisView=function(a){const f=q.createTask(async b=>{this.analysisView=await this._createAnalysisViewPromise(a,b);this._createAnalysisViewTask===f&&(this._createAnalysisViewTask=null);return this.analysisView});this._createAnalysisViewTask=
f};c._destroyAnalysisView=function(){this.analysisView=d.destroyMaybe(this.analysisView);this._createAnalysisViewTask=d.abortMaybe(this._createAnalysisViewTask)};c._createAnalysisViewPromise=async function(a,f){var b=this._analysisModule;d.isNone(b)&&(this._analysisModule=b=await this._loadAnalysisModule());b=new b.default({analysis:a,view:this.view,parent:this});await b.when();if(r.isAborted(f))throw b.destroy(),new m("layerview:no-analysisview-for-analysis","The analysis has not been added to the LineOfSightLayer of this layer view",
{analysis:a});return b};c._loadAnalysisModule=function(){return new Promise((a,f)=>p(["../analysis/LineOfSightAnalysisView3D"],b=>a(Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"}))),f))};return l._createClass(k)}(e.LayerView3D(u));g.__decorate([h.property()],e.prototype,"type",void 0);g.__decorate([h.property()],e.prototype,"layer",void 0);g.__decorate([h.property()],e.prototype,"analysisView",void 0);g.__decorate([h.property()],e.prototype,"_createAnalysisViewTask",
void 0);return e=g.__decorate([t.subclass("esri.views.3d.layers.LineOfSightLayerView3D")],e)});