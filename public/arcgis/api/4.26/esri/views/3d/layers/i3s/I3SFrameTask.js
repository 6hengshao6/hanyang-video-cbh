// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/arrayUtils ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/has ../../../../core/accessorSupport/decorators/subclass ../../../support/Scheduler".split(" "),function(n,k,p,q,r,t,x,y,u,v){let l=function(b){function d(){var a=c.call(this);a.referenceCount=0;a.callbacks=[];a.runIndex=0;return a}k._inherits(d,
b);var c=k._createSuper(d);b=d.prototype;b.runTask=function(a){this._sort();const g=this.callbacks,h={numIndexLoading:0,numNodesLoading:0};for(let e=0;e<g.length&&!a.done;++e)g[e].priority=g[e].runTask(a,h),this.runIndex=e};b._sort=function(){const a=this.callbacks;let g=a.length;for(let h=this.runIndex;0<h;h--){const e=a[h-1];let f=h;for(;f<a.length&&e.priority<=a[f].priority&&(f!==g||e.priority<a[f].priority);)a[f-1]=a[f],f++;a[f-1]=e;g=f-1}this.runIndex=0};b.add=function(a){this._sort();a.priority=
Infinity;this.callbacks.unshift(a);this.notifyChange("running")};b.remove=function(a){r.removeUnordered(this.callbacks,a);this.runIndex=this.callbacks.length;this._sort();this.notifyChange("running")};k._createClass(d,[{key:"running",get:function(){return this.callbacks.some(a=>a.running)}}]);return d}(q);p.__decorate([t.property({readOnly:!0})],l.prototype,"running",null);l=p.__decorate([u.subclass("esri.views.3d.layers.i3s.I3SFrameTask")],l);let w=k._createClass(function(b,d){this.task=b;this.handle=
d});const m=new Map;n.addCallback=function(b,d){let c=m.get(b);if(null==c){const a=new l,g=b.registerTask(v.TaskPriority.I3S_CONTROLLER,a);c=new w(a,g);m.set(b,c)}c.task.add(d);return{remove:()=>{null!=c&&(c.task.remove(d),0<c.task.callbacks.length||(m.delete(b),c.handle.remove(),c.task.destroy()),c=null)}}};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});