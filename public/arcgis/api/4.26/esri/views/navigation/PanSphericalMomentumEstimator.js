// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ../3d/state/utils/navigationUtils ./FilteredFiniteDifference ./FilteredValue ./Momentum".split(" "),function(n,f,w,k,m,t,p,u,q){let v=function(l){function d(a,e,c,g,h,r=0,x){a=b.call(this,a,e,c);a._angularVelocity1=g;a.axis1=h;a.angularVelocity2=r;a.axis2=x;return a}f._inherits(d,l);var b=f._createSuper(d);l=d.prototype;l.value1=function(a){return f._get(f._getPrototypeOf(d.prototype),
"valueFromInitialVelocity",this).call(this,this._angularVelocity1,a)};l.value2=function(a){return f._get(f._getPrototypeOf(d.prototype),"valueFromInitialVelocity",this).call(this,this.angularVelocity2,a)};return f._createClass(d)}(q.Momentum);q=function(){function l(b=300,a=12,e=.84){this._minimumInitialVelocity=b;this._stopVelocity=a;this._friction=e;this.enabled=!0;this._tmpAxis1=m.create();this._tmpAxis2=m.create();this._tmpAngles=w.create();this._time=new p.FilteredFiniteDifference(.3);this._screen=
[new p.FilteredFiniteDifference(.4),new p.FilteredFiniteDifference(.4)];this._angle1=new u.FilteredValue(.6);this._angle2=new u.FilteredValue(.6);this._axis1=m.create();this._axis2=m.create();this._lastScene=m.create()}var d=l.prototype;d.addMomentumDirectRotation=function(b,a,e,c,g,h){if(this.enabled){if(this._time.hasLastValue()){if(.01>this._time.computeDelta(e))return;c=t.rotationAngleAndAxisDirectRotation(this._lastScene,a,this._tmpAxis2,c,g,h);this._angle2.update(0);1E-5>k.squaredLength(this._tmpAxis2)?
c=0:k.normalize(this._axis1,this._tmpAxis2);this._angle1.update(c);k.copy(this._lastScene,a)}this._screen[0].update(b[0]);this._screen[1].update(b[1]);this._time.update(e)}};d.addMomentumPreserveHeading=function(b,a,e,c,g,h,r){if(this.enabled){if(this._time.hasLastValue()){if(.01>this._time.computeDelta(e))return;t.rotationAnglesAndAxesHeadingPreserving(this._lastScene,a,this._tmpAxis2,this._tmpAxis1,this._tmpAngles,c,g,h,r,!1);1E-5>k.squaredLength(this._tmpAxis2)?(this._angle1.update(0),this._angle2.update(0)):
(this._angle1.update(this._tmpAngles[1]),this._angle2.update(this._tmpAngles[0]),k.normalize(this._axis1,this._tmpAxis1),k.normalize(this._axis2,this._tmpAxis2));k.copy(this._lastScene,a)}this._screen[0].update(b[0]);this._screen[1].update(b[1]);this._time.update(e)}};d.reset=function(){this._screen[0].reset();this._screen[1].reset();this._angle1.reset();this._angle2.reset();this._time.reset()};d.evaluateMomentum=function(){if(!this.enabled||!this._screen[0].hasFilteredDelta())return null;var b=this._screen[0].filteredDelta,
a=this._screen[1].filteredDelta;b=null==b||null==a?null:Math.sqrt(b*b+a*a);a=this._time.filteredDelta;b=null==b||null==a?0:b/a;return Math.abs(b)<this._minimumInitialVelocity?null:this.createMomentum(b,this._stopVelocity,this._friction)};d.createMomentum=function(b,a,e){const c=this._time.filteredDelta,g=this._angle1.filteredValue,h=this._angle2.filteredValue;return new v(b,a,e,null==c||null==g?0:g/c,this._axis1,null==c||null==h?0:h/c,this._axis2)};return f._createClass(l)}();n.PanSphericalMomentum=
v;n.PanSphericalMomentumEstimator=q;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});