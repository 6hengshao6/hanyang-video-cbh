// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Viewpoint ../../core/Collection ../../core/Error ../../core/Evented ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../webdoc/support/SlideThumbnail ../../webmap/Bookmark ../support/GoTo".split(" "),function(q,f,A,c,l,B,w,h,C,J,K,D,E,x,F){const y=c.ofType(x),G={width:128,height:128,
format:"png"},n={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},z={time:!0};c=function(g){function m(a){a=H.call(this,a);a.abilities={...z};a.activeBookmark=null;a.view=null;return a}q._inherits(m,g);var H=q._createSuper(m);g=m.prototype;g.destroy=function(){this.view=null;this._set("activeBookmark",null)};g.castAbilities=function(a){return{...z,...a}};g.createBookmark=async function(a){const {view:b,defaultCreateOptions:e,abilities:d}=this;if(!b)throw new l("create-bookmark:invalid-view",
"Cannot create a bookmark without a view.");const {takeScreenshot:k,screenshotSettings:r,captureViewpoint:t,captureRotation:u,captureScale:v,captureTimeExtent:p}={...e,...a};a=k?await this._createThumbnail(r):void 0;const I=d.time&&p&&w.isSome(b.timeExtent)?b.timeExtent.clone():void 0;return new x({...(a&&{thumbnail:a}),...(p&&{timeExtent:I}),...(t&&{viewpoint:this._createViewpoint({view:b,captureScale:v,captureRotation:u})})})};g.editBookmark=async function(a,b){if(!a)return a;const {view:e,defaultEditOptions:d}=
this;if(!e)throw new l("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");const {takeScreenshot:k,screenshotSettings:r,captureViewpoint:t,captureRotation:u,captureScale:v,captureTimeExtent:p}={...d,...b};if(b=k?await this._createThumbnail(r):void 0)a.thumbnail=b;t&&(a.viewpoint=this._createViewpoint({view:e,captureScale:v,captureRotation:u}));p&&w.isSome(e.timeExtent)&&(a.timeExtent=e.timeExtent.clone());this.emit("bookmark-edit",{bookmark:a});return a};g.goTo=function(a){const {abilities:b,
view:e}=this;if(!e)throw new l("go-to:invalid-view","Cannot go to a bookmark without a view");var d=a?.viewpoint;if(!d)throw new l("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:a});this._set("activeBookmark",a);d=this.callGoTo({target:d});const k=a?.timeExtent;b.time&&k&&(e.timeExtent=k);this.emit("bookmark-select",{bookmark:a});d.catch(()=>{}).then(()=>this._set("activeBookmark",null));return d};g._createThumbnail=async function(a){const {view:b}=
this;if(!b)throw new l("bookmark:invalid-view","Cannot create slide thumbnail without a view");a=await b.takeScreenshot({...G,...a});return new E.SlideThumbnail({url:a.dataUrl})};g._createViewpoint=function({view:a,captureRotation:b,captureScale:e}){const d=a.viewpoint?.clone();return new A({targetGeometry:a.extent?.clone(),rotation:(b?d?.rotation:null)??0,scale:(e?d?.scale:null)??0})};q._createClass(m,[{key:"bookmarks",get:function(){return this.view?.map?.bookmarks??new y},set:function(a){this._overrideIfSome("bookmarks",
a)}},{key:"defaultCreateOptions",get:function(){return n},set:function(a){this._set("defaultCreateOptions",{...n,...a})}},{key:"defaultEditOptions",get:function(){return n},set:function(a){this._set("defaultEditOptions",{...n,...a})}},{key:"state",get:function(){const a=this.get("view");return a&&!a.ready?"loading":"ready"}}]);return m}(F.GoToMixin(B.EventedAccessor));f.__decorate([h.property()],c.prototype,"abilities",void 0);f.__decorate([C.cast("abilities")],c.prototype,"castAbilities",null);f.__decorate([h.property({readOnly:!0})],
c.prototype,"activeBookmark",void 0);f.__decorate([h.property({type:y})],c.prototype,"bookmarks",null);f.__decorate([h.property()],c.prototype,"defaultCreateOptions",null);f.__decorate([h.property()],c.prototype,"defaultEditOptions",null);f.__decorate([h.property({readOnly:!0})],c.prototype,"state",null);f.__decorate([h.property()],c.prototype,"view",void 0);return c=f.__decorate([D.subclass("esri.widgets.Bookmarks.BookmarksViewModel")],c)});