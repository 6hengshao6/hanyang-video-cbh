// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/MeshSymbol3D ../../symbols/FillSymbol3DLayer".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p,D,t,E,v,M,B,w,c,m,h,H,q,A,C,P,I,G,r,R,S,T,Z,da,Y,fa,ea,oa){function pa(ka){return"polygon"===ka||"rectangle"===ka||"circle"===ka}function ra(ka,Aa){Ea("undo",ka.history.undo,ka.history.redo,Aa)}function ua(ka,Aa){Ea("redo",ka.history.redo,ka.history.undo,Aa)}function Ea(ka,Aa,Pa,Q){if(Aa=Aa.pop()){var V=Aa.updates,W=[];Q.forEach((U,ba)=>{ba=V[ba];null!=ba&&("geometry"in ba&&e.isSome(ba.geometry)&&(W.push({geometry:U.geometry}),U.geometry=ba.geometry),"symbol"in
ba&&e.isSome(ba.symbol)&&(W.push({symbol:U.symbol}),U.symbol=ba.symbol),"undo"in ba&&(W.push(ba),ba[ka](U)))});Pa.push({updates:W})}}function va(ka){return{updates:ka.map(Aa=>({geometry:Aa.geometry}))}}function xa(ka){return"requireError"in ka&&"aborted"===ka.requireError}const Qa=ka=>Object.freeze(Object.defineProperty({__proto__:null,default:ka},Symbol.toStringTag,{value:"Module"})),ab={defaultZ:0},Wa={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,
enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};O=function(ka){function Aa(Q){Q=Pa.call(this,Q);Q._numUpdating=0;Q._handles=new z;Q._internalGraphicsLayer=new w({listMode:"hide",internal:!0,title:"SVM Internal"});Q._operationHandle=null;Q._viewHandles=new z;Q.activeFillSymbol=null;Q.activeLineSymbol=null;Q.activeVertexSymbol=null;Q.allowDeleteKey=!0;Q.labelOptions=new P;Q.layer=null;Q.pointSymbol=new da({style:"circle",
size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});Q.polygonSymbol=new Y({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});Q.polylineSymbol=new fa({color:[130,130,130,1],width:2});Q.meshSymbol=new ea({symbolLayers:[new oa]});Q._snappingManager=null;Q.tooltipOptions=new I;Q.updateGraphics=new F;Q.updateOnGraphicClick=!0;Q.vertexSymbol=new da({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});Q._moduleLoaderAbortController=null;Q._viewReadyAbortController=
null;Q._originalAutoOpenEnabled=null;Q.defaultCreateOptions=ab;Q.defaultUpdateOptions=Wa;Q.snappingOptions=new r;return Q}u._inherits(Aa,ka);var Pa=u._createSuper(Aa);ka=Aa.prototype;ka.initialize=function(){this._handles.add([K.on(()=>this.view?.map?.layers,"change",Q=>{Q.removed.includes(this.layer)&&this.cancel()}),K.on(()=>this.layer?.graphics,"change",Q=>{if(e.isSome(this._operationHandle))for(const V of Q.removed)this.updateGraphics.includes(V)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(V):
this._operationHandle.cancel())}),K.watch(()=>this.layer?.elevationInfo??null,Q=>{Q!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=Q)},K.syncAndInitial),K.watch(()=>this.view,Q=>{e.destroyMaybe(this._snappingManager);Q&&(this._snappingManager=new G.SnappingManager({view:Q,options:this.snappingOptions}),"2d"===Q.type?new Promise((V,W)=>d(["../../views/2d/interactive/editingTools"],V,W)):"3d"===Q.type&&(new Promise((V,W)=>d(["../../views/3d/interactive/editingTools"],
V,W)),new Promise((V,W)=>d(["../../views/3d/layers/GraphicsLayerView3D"],U=>V(Qa(U)),W))))},K.syncAndInitial),K.watch(()=>this.view?.spatialReference,(Q,V)=>{Q&&V&&!Q.equals(V)&&this.cancel()})]);R.setupSnappingToggleHandles(this)};ka.destroy=function(){this.cancel();this._handles=e.destroyMaybe(this._handles);this._viewHandles=e.destroyMaybe(this._viewHandles);this._removeDefaultLayer();this._snappingManager=e.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};ka.cancel=
function(){this._moduleLoaderAbortController=e.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=e.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};ka.complete=function(){this._operationHandle&&this._operationHandle.complete()};ka.delete=function(){const {state:Q,updateGraphics:V}=this;if("active"===Q&&V.length){const {activeTool:W,layer:U}=this,ba=V.toArray();U.removeMany(ba);this.cancel();this._emitDeleteEvent({graphics:ba,
tool:W})}};ka.duplicate=function(){if("active"===this.state&&this.updateGraphics.length){const Q=this.updateGraphics.map(V=>V.clone()).toArray();this.layer.addMany(Q);this.emit("duplicate",{graphics:Q,type:"duplicate"});return Q}return[]};ka.create=async function(Q,V){this.cancel();await this._waitViewReady();const {view:W,layer:U}=this;if(!W||"disabled"===this.state)throw U||this._logMissingLayer(),g.createAbortError();e.isSome(W.activeTool)&&(W.activeTool=null);if(Q){q.addUniqueLayer(W,this._internalGraphicsLayer);
var ba=await this._setupCreateOperation(Q,V);e.isNone(ba)||this.destroyed?W.map.remove(this._internalGraphicsLayer):(ba.on("complete",()=>{if(ba===this._operationHandle){const la=this.createGraphic,ja=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer);ba.cancelled||null==la||U.add(la);this.emit("create",{graphic:la,state:ja?"cancel":"complete",tool:Q,
toolEventInfo:null,type:"create"})}}),this._operationHandle=ba,W.ready&&W.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")};ka.update=async function(Q,V){this.cancel();await this._waitViewReady();const {layer:W,view:U,state:ba}=this;if(!U||"disabled"===ba)throw W||this._logMissingLayer(),g.createAbortError();e.isSome(U.activeTool)&&(U.activeTool=null);const la=Array.isArray(Q)?Q:[Q];null!=Q&&la&&la.length?la.some(ja=>ja.layer!==W?(this._logError("sketch:invalid-parameter",
"Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):e.isNone(ja.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(Q=await this._setupUpdateOperation(la,V),this.destroyed||e.isNone(Q)||xa(Q)||(q.addUniqueLayer(U,this._internalGraphicsLayer),this._setUpdateOperationHandle(Q,V),this.emit("update",{graphics:la,state:"start",aborted:!1,tool:Q.tool,toolEventInfo:null,
type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")};ka._updateSpatialReference=async function(Q){const V=this.view;if(V){this._beginAsyncOperation();Q=Array.isArray(Q)?Q:[Q];for(const W of Q)e.isSome(W.geometry)&&"mesh"!==W.geometry.type&&!B.equals(W.geometry.spatialReference,V.spatialReference)&&(v.canProjectWithoutEngine(W.geometry.spatialReference,V.spatialReference)||v.isLoaded()||await v.load(),W.geometry=v.project(W.geometry,V.spatialReference));this._endAsyncOperation()}else this._logMissingView()};
ka.undo=function(){this.canUndo()&&this._operationHandle?.undo()};ka.redo=function(){this.canRedo()&&this._operationHandle?.redo()};ka.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};ka.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};ka.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};ka._getFirstHit=async function(Q){var V=this.view;if(!V)return this._logMissingView(),
null;if("2d"===V.type){const U=[];V.map.allLayers.forEach(ba=>{"vector-tile"!==ba.type&&"imagery"!==ba.type||U.push(ba)});V=await V.hitTest(Q,{exclude:U});return S.findFirstGraphicHit(V.results)}const W=[V.map.ground];V.map.allLayers.forEach(U=>{"integrated-mesh"===U.type&&W.push(U)});Q=await V.hitTest(Q,{exclude:W});if(0<Q.results.length){const U=Q.results[0];if(e.isSome(U)&&"graphic"===U.type&&U.graphic&&(!Q.ground.mapPoint||1>V.map.ground.opacity||Q.ground.distance-e.unwrapOr(U.distance,0)>-Math.min(3*
Q.ground.distance,"global"===V.viewingMode?E.getReferenceEllipsoid(V.renderCoordsHelper.spatialReference).radius/V.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return U}return null};ka._generateViewHandles=function(Q){return[Q.on("immediate-click",async V=>{var W="active"===this.state&&"create"===this._operationHandle?.type;if("disabled"!==this.state&&!W&&this.updateOnGraphicClick){this._beginAsyncOperation();var U=await V.async(()=>this._getFirstHit(T.createScreenPointFromEvent(V)));
W=null;e.isSome(U)?(U=U.graphic,this.updateGraphics.includes(U)||U.layer===this.layer?(V.stopPropagation(),W=U):"2d"!==Q.type||this._isComponentGraphic(U)||"active"!==this.state||this.cancel()):"active"===this.state&&this.cancel();e.isSome(W)&&!this.updateGraphics.includes(W)&&await this.update([W],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}});this._endAsyncOperation()}},A.ViewEventPriorities.WIDGET)]};ka._setupCreateOperation=async function(Q,V){const W=
this.view;if(!W)return this._logMissingView(),null;Q=await this._setupDrawGraphicTool(Q,W,{hasZ:"3d"===W.type,...this.defaultCreateOptions,...V});if(e.isNone(Q))return null;W.tools.add(Q);W.activeTool=Q;return this._setupCreateOperationHandle(Q)};ka._setupDrawGraphicTool=async function(Q,V,W){if("multipoint"===Q&&"3d"===V.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!V)return this._logMissingView(),null;const U="rectangle"!==Q,ba="rectangle"!==
Q;Q={view:V,mode:"rectangle"===Q||"circle"===Q?"hybrid":"click",...W,snapToScene:!1,geometryType:Q,graphicSymbol:this._getGraphicSymbolFromTool(Q),snappingManager:this._snappingManager,forceUniformSize:ba,centered:U};return"2d"===V.type?this._makeDrawGraphicTool2D(Q):this._makeDrawGraphicTool3D(Q)};ka._makeDrawGraphicTool2D=async function(Q){const V=await this._requireModule(new Promise((W,U)=>d(["../../views/2d/interactive/editingTools"],W,U)));return xa(V)||this.destroyed?null:new V.module.DrawGraphicTool2D({...Q,
activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:pa(Q.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})};ka._makeDrawGraphicTool3D=async function(Q){const V=await this._requireModule(new Promise((U,ba)=>d(["../../views/3d/interactive/editingTools"],U,ba)));if(xa(V)||this.destroyed)return null;const {elevationInfo:W}=this.layer;return new V.module.DrawGraphicTool3D({...Q,elevationInfo:W,
snapToScene:e.isSome(W)?"absolute-height"===W.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})};ka._setupCreateOperationHandle=function(Q){const V=this.view;if(!V)return this._logMissingView(),null;let W=null;const U=Q.forceUniformSize,ba=Q.centered,la=[V.on("key-down",ha=>{if(ha.key===C.SKETCH_KEYS.pan)ha.stopPropagation(),ha.repeat||(Q.enabled=!1);else if(ha.key===C.SKETCH_KEYS.complete)ha.stopPropagation(),Q.completeCreateOperation();else if(ha.key!==C.SKETCH_KEYS.vertexAdd||
ha.repeat)ha.key===C.SKETCH_KEYS.undo?(ha.stopPropagation(),ja.undo()):ha.key===C.SKETCH_KEYS.redo?(ha.stopPropagation(),ja.redo()):ha.key!==C.SKETCH_KEYS.constraint||"rectangle"!==Q.geometryType&&"circle"!==Q.geometryType||ha.repeat?ha.key!==C.SKETCH_KEYS.center||ha.repeat||(Q.centered=!ba,ha.stopPropagation()):(Q.forceUniformSize=!U,ha.stopPropagation());else{const ia=Q.drawOperation.geometryType;if("polyline"===ia||"polygon"===ia||"multipoint"===ia)ha.stopPropagation(),Q.drawOperation.commitStagedVertex()}},
A.ViewEventPriorities.WIDGET),V.on("key-up",ha=>{ha.key===C.SKETCH_KEYS.pan?Q.enabled=!0:ha.key!==C.SKETCH_KEYS.constraint||"rectangle"!==Q.geometryType&&"circle"!==Q.geometryType?ha.key===C.SKETCH_KEYS.center&&(Q.centered=ba,ha.stopPropagation()):(Q.forceUniformSize=U,ha.stopPropagation())},A.ViewEventPriorities.WIDGET),Q.on("vertex-add",ha=>{W=e.isNone(W)?"start":"active";switch(ha.operation){case "apply":this.emit("create",{graphic:e.unwrap(Q.graphic),state:W,tool:this.activeTool,toolEventInfo:ha,
type:"create"});break;case "undo":this._emitUndoEvent({graphics:[e.unwrap(Q.graphic)],tool:Q.geometryType});break;case "redo":this._emitRedoEvent({graphics:[e.unwrap(Q.graphic)],tool:Q.geometryType})}}),Q.on("cursor-update",ha=>{0<Q.drawOperation.numCommittedVertices&&this.emit("create",{graphic:e.unwrap(Q.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:ha.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),Q.on("vertex-remove",ha=>{switch(ha.operation){case "apply":this.emit("create",
{graphic:e.unwrap(Q.graphic),state:"active",tool:this.activeTool,toolEventInfo:ha,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[e.unwrap(Q.graphic)],tool:Q.geometryType});break;case "redo":this._emitRedoEvent({graphics:[e.unwrap(Q.graphic)],tool:Q.geometryType})}}),Q.on("complete",ha=>{this._set("createGraphic",e.unwrap(ha.graphic));W="complete";ha.aborted?ja&&ja.cancel():ja&&ja.complete()}),K.watch(()=>this._getGraphicSymbolFromTool(Q.geometryType),ha=>{Q.graphicSymbol=ha})],ja=
new Z.CreateOperationHandle({activeComponent:Q,tool:Q.geometryType,type:"create",onEnd:()=>{la.forEach(ha=>ha.remove());la.length=0;V.tools?.remove(Q)},undo:()=>{Q.canUndo&&Q.undo()},redo:()=>{Q.canRedo&&Q.redo()},canUndo:()=>Q.canUndo,canRedo:()=>Q.canRedo});return ja};ka._getGraphicSymbolFromTool=function(Q){switch(Q){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;case "mesh":return this.meshSymbol}};
ka._setupUpdateOperation=async function(Q,V){const {layer:W,view:U}=this;if(!U)return this._logMissingView(),null;V={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...V,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...V?.reshapeOptions}};var ba=V.tool;for(var la of Q)W.remove(la),W.add(la);if("3d"===U.type){if(0===Q.length)return null;switch(ba){case "move":return this._setupMove3DOperation(Q,V,U,ba);case "reshape":if(1<Q.length)return this._logError("sketch:reshape-multiple",
"Reshape operation does not support multiple graphics."),null;ba=h.isSupportedGraphic(Q[0]);if(ba===c.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(Q[0],V,U);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(ba)}).`);return null;case "transform":return this._setupGraphicTransform3DOperation(Q,V,U)}}switch(ba){case "move":return this._setupMove2DOperation(Q,V,U);case "reshape":if(1<Q.length)return this._logError("sketch:reshape-multiple",
"Reshape operation does not support multiple graphics."),null;la=h.isSupportedGraphic(Q[0]);if(la===c.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(Q,ba,V,U);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(la)}).`);return null;case "transform":return 1===Q.length&&(la=e.get(Q[0].geometry,"type"),"point"===la||"multipoint"===la)&&(ba="reshape"),this._setupTransformOrReshape2DOperation(Q,
ba,V,U)}};ka._setupMove3DOperation=async function(Q,V,W,U,ba=!1){for(var la of Q){const ma=m.isSupportedGraphic(la);if(ma!==c.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${c.isSupportedGraphicResultMessage(ma)}).`),null}la=await this._requireModule(new Promise((ma,qa)=>d(["../../views/3d/interactive/editingTools"],ma,qa)));if(xa(la))return la;const ja=new la.module.GraphicMoveTool({view:W,enableZ:V.enableZ,snappingManager:this._snappingManager,
tooltipOptions:this.tooltipOptions});W.tools.add(ja);ja.graphics.addMany(Q);ba||this.updateGraphics.addMany(Q);const ha=[],ia=new Z.UpdateOperationHandle({activeComponent:ja,tool:U,type:"update",onEnd:()=>{ha.forEach(ma=>ma.remove());ha.length=0;W.tools?.remove(ja);ja.destroyed||ja.destroy()},undo:()=>{ra(ia,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:U})},redo:()=>{ua(ia,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),
tool:U})},addToSelection:ma=>{this.updateGraphics.push(ma);ja.graphics.push(ma);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ma],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:ma=>{const qa=this.updateGraphics.indexOf(ma);ia.history.undo.forEach(Da=>Da.updates.splice(qa,1));ia.history.redo.forEach(Da=>Da.updates.splice(qa,1));this.updateGraphics.remove(ma);this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ma],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ia.complete():ja.graphics.remove(ma)},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==V.toggleToolOnClick&&"transform"===U){var ma=this.updateGraphics.getItemAt(0);h.isSupportedGraphic(ma)===c.SupportedGraphicResult.SUPPORTED&&(ma=await this._setupReshape3DOperation(ma,V,W,!0),xa(ma)||(ia.onEnd(),ia.destroy(),this._setUpdateOperationHandle(ma,
V)))}}});ha.push(...this._getHandlesForComponent(ia,V),W.on("immediate-click",ma=>this._getCommonUpdateOperationClickHandlers(ia,ma,V),A.ViewEventPriorities.WIDGET),W.on("key-down",ma=>{this._getCommonUpdateOperationKeyDownHandlers(ia,ma)},A.ViewEventPriorities.WIDGET));return ia};ka._setupGraphicTransform3DOperation=function(Q,V,W,U=!1){if(1===Q.length&&H.isSupportedGraphic(Q[0])===c.SupportedGraphicResult.SUPPORTED){const ba=Q[0],la=ba.geometry;if(e.isSome(la)&&("point"===la.type||"mesh"===la.type))return this._setupPointTransform3DOperation(ba,
V,W);if(e.isSome(la)&&("polygon"===la.type||"polyline"===la.type))return this._setupPolyTransform3DOperation(ba,V,W,U)}return this._setupMove3DOperation(Q,V,W,"transform",U)};ka._setupPointTransform3DOperation=async function(Q,V,W){const {enableRotation:U,enableScaling:ba,enableZ:la}=V,ja=await this._requireModule(new Promise((qa,Da)=>d(["../../views/3d/interactive/editingTools"],qa,Da)));if(xa(ja))return ja;const ha=new ja.module.GraphicTransformTool({graphic:Q,view:W,enableRotation:U,enableScaling:ba,
enableZ:la,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});W.tools.add(ha);this.updateGraphics.add(Q);const ia=[],ma=new Z.UpdateOperationHandle({activeComponent:ha,tool:"transform",type:"update",onEnd:()=>{ia.forEach(qa=>qa.remove());ia.length=0;W.tools?.remove(ha);ha.destroyed||ha.destroy()},undo:()=>{ra(ma,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{ua(ma,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),
tool:"transform"})},addToSelection:async qa=>{this.updateGraphics.add(qa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[qa],removed:[],type:"selection-change"},type:"update"});qa=await this._setupMove3DOperation(this.updateGraphics.toArray(),V,W,"transform",!0);xa(qa)||(ma.onEnd(),ma.destroy(),this._setUpdateOperationHandle(qa,V))},removeFromSelection:qa=>{this.updateGraphics.remove(qa);this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[qa],type:"selection-change"},type:"update"});ma.complete()},toggleTool:()=>{}});ia.push(...this._getHandlesForComponent(ma,V),W.on("immediate-click",qa=>this._getCommonUpdateOperationClickHandlers(ma,qa,V),A.ViewEventPriorities.WIDGET),W.on("key-down",qa=>{this._getCommonUpdateOperationKeyDownHandlers(ma,qa)},A.ViewEventPriorities.WIDGET));return ma};ka._setupPolyTransform3DOperation=async function(Q,V,W,U=!1){const {enableRotation:ba,
enableScaling:la,enableZ:ja,preserveAspectRatio:ha}=V,ia=await this._requireModule(new Promise((wa,Fb)=>d(["../../views/3d/interactive/editingTools"],wa,Fb)));if(xa(ia))return ia;const ma=new ia.module.ExtentTransformTool({graphic:Q,view:W,enableRotation:ba,enableScaling:la,enableZ:ja,preserveAspectRatio:ha,tooltipOptions:this.tooltipOptions});W.tools.add(ma);U||this.updateGraphics.add(Q);const qa=[],Da=new Z.UpdateOperationHandle({activeComponent:ma,tool:"transform",type:"update",onEnd:()=>{qa.forEach(wa=>
wa.remove());qa.length=0;W.tools?.remove(ma);ma.destroyed||ma.destroy()},canUndo:()=>ma.canUndo,undo:()=>{ma.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>ma.canRedo,redo:()=>{ma.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async wa=>{this.updateGraphics.add(wa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[wa],
removed:[],type:"selection-change"},type:"update"});wa=await this._setupMove3DOperation(this.updateGraphics.toArray(),V,W,"transform",!0);xa(wa)||(Da.onEnd(),Da.destroy(),this._setUpdateOperationHandle(wa,V))},removeFromSelection:wa=>{this.updateGraphics.remove(wa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[wa],type:"selection-change"},type:"update"});Da.complete()},toggleTool:async()=>{if(1===this.updateGraphics.length&&
!1!==V.toggleToolOnClick){var wa=this.updateGraphics.getItemAt(0);h.isSupportedGraphic(wa)===c.SupportedGraphicResult.SUPPORTED&&(wa=await this._setupReshape3DOperation(wa,V,W,!0),xa(wa)||(Da.onEnd(),Da.destroy(),this._setUpdateOperationHandle(wa,V)))}}});qa.push(...this._getHandlesForComponent(Da,V),W.on("immediate-click",wa=>this._getCommonUpdateOperationClickHandlers(Da,wa,V),A.ViewEventPriorities.WIDGET),W.on("key-down",wa=>this._getCommonUpdateOperationKeyDownHandlers(Da,wa),A.ViewEventPriorities.WIDGET),
W.on("key-down",wa=>{wa.key!==C.SKETCH_KEYS.constraint||wa.repeat||(ma.preserveAspectRatio=!ma.preserveAspectRatio,wa.stopPropagation())},A.ViewEventPriorities.WIDGET),W.on("key-up",wa=>{wa.key===C.SKETCH_KEYS.constraint&&(ma.preserveAspectRatio=!ma.preserveAspectRatio,wa.stopPropagation())},A.ViewEventPriorities.WIDGET));return Da};ka._setupMove2DOperation=async function(Q,V,W){this.updateGraphics.addMany(Q);await this._updateSpatialReference(Q);const U=await this._getGraphicMover(Q,V,W);if(xa(U))return U;
const ba=new Z.UpdateOperationHandle({activeComponent:U,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();ha.forEach(ia=>ia.remove());ja.forEach(ia=>ia.remove());ha=[];ja=[];U.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const ia=this.updateGraphics.toArray();ra(ba,ia);ba.refreshComponent();this._emitUndoEvent({graphics:ia,tool:"move"})},redo:()=>{const ia=this.updateGraphics.toArray();ua(ba,ia);ba.refreshComponent();this._emitRedoEvent({graphics:ia,
tool:"move"})},addToSelection:async ia=>{await this._updateSpatialReference(ia);this.updateGraphics.push(ia);U.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ia],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:ia=>{const ma=this.updateGraphics.indexOf(ia);ba.history.undo.forEach(Da=>Da.updates.splice(ma,1));ba.history.redo.forEach(Da=>Da.updates.splice(ma,
1));this.updateGraphics.remove(ia);const qa=this.updateGraphics.toArray();this.emit("update",{graphics:qa,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ia],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ba.complete():U.graphics=qa}});let la=!1,ja=[W.on("immediate-click",ia=>this._getCommonUpdateOperationClickHandlers(ba,ia,V),A.ViewEventPriorities.WIDGET),W.on("key-down",ia=>{this._getCommonUpdateOperationKeyDownHandlers(ba,ia);ia.key!==C.SKETCH_KEYS.constraint||
ia.repeat||(la=!0,U.enableMoveAllGraphics=!U.enableMoveAllGraphics)},A.ViewEventPriorities.WIDGET),W.on("key-up",ia=>{ia.key===C.SKETCH_KEYS.constraint&&la&&(la=!1,U.enableMoveAllGraphics=!U.enableMoveAllGraphics)},A.ViewEventPriorities.WIDGET)],ha=this._getHandlesForComponent(ba,V);return ba};ka._setupReshape3DOperation=async function(Q,V,W,U=!1){const ba=await this._requireModule(new Promise((ma,qa)=>d(["../../views/3d/interactive/editingTools"],ma,qa)));if(xa(ba))return ba;const la=V.reshapeOptions,
ja=new ba.module.GraphicReshapeTool({view:W,graphic:Q,enableZVertex:V.enableZ&&"move"===la?.vertexOperation,enableZShape:V.enableZ&&"move"===la?.shapeOperation,enableMoveGraphic:"move"===la?.shapeOperation||"move-xy"===la?.shapeOperation,enableMidpoints:"split"===la?.edgeOperation,enableEdgeOffset:"offset"===la?.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});W.tools.add(ja);U||this.updateGraphics.add(Q);const ha=[],ia=new Z.UpdateOperationHandle({activeComponent:ja,
tool:"reshape",type:"update",onEnd:()=>{ha.forEach(ma=>ma.remove());ha.length=0;W.tools?.remove(ja);ja.destroyed||ja.destroy()},canUndo:()=>ja.canUndo,undo:()=>{ja.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>ja.canRedo,redo:()=>{ja.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:async ma=>{this.updateGraphics.add(ma);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{added:[ma],removed:[],type:"selection-change"},type:"update"});ma=await this._setupMove3DOperation(this.updateGraphics.toArray(),V,W,"transform",!0);xa(ma)||(ia.onEnd(),ia.destroy(),this._setUpdateOperationHandle(ma,V))},removeFromSelection:ma=>{this.updateGraphics.remove(ma);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ma],type:"selection-change"},type:"update"});ia.complete()},
toggleTool:async()=>{if(!1!==V.toggleToolOnClick){var ma=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),V,W,!0);xa(ma)||(ia.onEnd(),ia.destroy(),this._setUpdateOperationHandle(ma,V))}}});ha.push(...this._getHandlesForComponent(ia,V),W.on("immediate-click",ma=>this._getCommonUpdateOperationClickHandlers(ia,ma,V),A.ViewEventPriorities.WIDGET),W.on("key-down",ma=>{this._getCommonUpdateOperationKeyDownHandlers(ia,ma)},A.ViewEventPriorities.WIDGET));return ia};ka._setupTransformOrReshape2DOperation=
async function(Q,V,W,U){this.updateGraphics.addMany(Q);await this._updateSpatialReference(Q);Q="transform"===V?await this._getBox(Q,W,U):await this._getReshape(Q,W,U);if(xa(Q))return Q;const ba=new Z.UpdateOperationHandle({activeComponent:Q,type:"update",onEnd:()=>{ja.forEach(ha=>ha.remove());la.forEach(ha=>ha.remove());ja=[];la=[];ba.activeComponent&&!ba.activeComponent.destroyed&&ba.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{ra(ba,
this.updateGraphics.toArray());ba.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ba.tool})},redo:()=>{ua(ba,this.updateGraphics.toArray());ba.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ba.tool})},addToSelection:async ha=>{var ia=ba.activeComponent;if("reshape"===ia?.type){ia=[...this.updateGraphics,ha];this.updateGraphics.removeAll();ia=await this._setupMove2DOperation(ia,W,U);if(xa(ia))return;ba.onEnd();ba.destroy();this._setUpdateOperationHandle(ia,
W)}else this.updateGraphics.add(ha),ia.graphics=this.updateGraphics.toArray(),ia.refresh(),ba.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ha],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async ha=>{const ia=this.updateGraphics.indexOf(ha);ba.history.undo.forEach(qa=>qa.updates.splice(ia,1));ba.history.redo.forEach(qa=>qa.updates.splice(ia,1));this.updateGraphics.remove(ha);
const ma=this.updateGraphics.toArray();if(0===ma.length)ba.complete();else{const qa=ma[0].geometry;1!==ma.length||!e.isSome(qa)||"point"!==qa.type&&"multipoint"!==qa.type?ba.activeComponent.graphics=ma:ba.toggleTool()}this.emit("update",{graphics:ma,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ha],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var ha=this.updateGraphics.getItemAt(0),ia=ha.geometry;e.isSome(ia)&&
("reshape"===ba.tool&&("point"===ia.type||"multipoint"===ia.type)||"transform"===ba.tool&&"extent"===ia.type)||(ia=null,"transform"===ba.tool?ia=await this._getReshape([ha],W,U):"reshape"===ba.tool&&(ia=await this._getBox([ha],W,U)),xa(ia)||(ba.activeComponent?.destroy(),ba.activeComponent=ia,ba.activeComponent&&(ja.forEach(ma=>ma.remove()),ja=this._getHandlesForComponent(ba,W))))}}});let la=[U.on("immediate-click",ha=>this._getCommonUpdateOperationClickHandlers(ba,ha,W),A.ViewEventPriorities.WIDGET),
U.on("key-down",ha=>{this._getCommonUpdateOperationKeyDownHandlers(ba,ha);ha.key===C.SKETCH_KEYS.constraint&&!ha.repeat&&ba&&(ha=ba.activeComponent)&&"box"===ha.type&&(ha.preserveAspectRatio=!ha.preserveAspectRatio)},A.ViewEventPriorities.WIDGET),U.on("key-up",ha=>{ha.key===C.SKETCH_KEYS.constraint&&ba&&(ha=ba.activeComponent)&&"box"===ha.type&&(ha.preserveAspectRatio=!ha.preserveAspectRatio)},A.ViewEventPriorities.WIDGET)],ja=this._getHandlesForComponent(ba,W);return ba};ka._getGraphicMover=async function(Q,
V,W){({enableMoveAllGraphics:V}=V);const U=await this._requireModule(new Promise((ba,la)=>d(["../../views/draw/support/GraphicMover"],ja=>ba(Qa(ja)),la)));return xa(U)?U:new U.module.default({enableMoveAllGraphics:V,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:Q,view:W,callbacks:{onGraphicMoveStart:({dx:ba,dy:la,graphic:ja})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ba,dy:la,mover:ja,
type:"move-start"},type:"update"})},onGraphicMove:({dx:ba,dy:la,graphic:ja})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ba,dy:la,mover:ja,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ba,dy:la,graphic:ja})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ba,dy:la,mover:ja,type:"move-stop"},type:"update"})},
onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})};ka._getBox=async function(Q,V,W){const {enableRotation:U,enableScaling:ba,preserveAspectRatio:la}=V;V=await this._requireModule(new Promise((ja,ha)=>d(["../../views/draw/support/Box"],ia=>ja(Qa(ia)),ha)));return xa(V)?V:new V.module.default({graphics:Q,enableRotation:U,enableScaling:ba,preserveAspectRatio:la,layer:this._internalGraphicsLayer,view:W,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:ja=>
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onMove:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onMoveStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onScaleStart:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onScale:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onScaleStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onRotateStart:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onRotate:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"}),onRotateStop:ja=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ja},type:"update"})}})};ka._getReshape=async function(Q,V,W){const U="split"===V.reshapeOptions?.edgeOperation;V="move"===V.reshapeOptions?.shapeOperation;
const ba=await this._requireModule(new Promise((la,ja)=>d(["../../views/draw/support/Reshape"],ha=>la(Qa(ha)),ja)));return xa(ba)?ba:new ba.module.default({enableMidpoints:U,enableMovement:V,graphic:Q[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:W,callbacks:{onReshapeStart:la=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...la},type:"update"}),onReshape:la=>
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...la},type:"update"}),onReshapeStop:({mover:la,type:ja})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:la,type:ja},type:"update"}),onMoveStart:({dx:la,dy:ja,mover:ha,type:ia})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,
dy:ja,mover:ha,type:ia},type:"update"}),onMove:({dx:la,dy:ja,mover:ha,type:ia})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,dy:ja,mover:ha,type:ia},type:"update"}),onMoveStop:({dx:la,dy:ja,mover:ha,type:ia})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,dy:ja,mover:ha,type:ia},type:"update"}),onVertexAdd:({added:la,type:ja,vertices:ha})=>
{la=la.map(ia=>M.geometryToCoordinates(ia.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:la,vertices:ha,type:ja},type:"update"})},onVertexRemove:({removed:la,type:ja,vertices:ha})=>{la=la.map(ia=>M.geometryToCoordinates(ia.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:la,vertices:ha,type:ja},type:"update"})}}})};ka._getHandlesForComponent=
function(Q,V){const W=Q.activeComponent;if(!W)return[];switch(W.type){case "graphic-mover":return[W.on("graphic-click",({graphic:U,viewEvent:ba})=>{ba.native?.shiftKey&&(ba.stopPropagation(),Q.removeFromSelection(U))}),W.on("graphic-move-start",U=>Q.addToHistory(va(U.allGraphics)))];case "box":return[W.on("graphic-click",U=>this._onTransformOrReshape2DGraphicClick(Q,V,U)),W.on("move-start",U=>Q.addToHistory(va(U.graphics))),W.on("rotate-start",U=>Q.addToHistory(va(U.graphics))),W.on("scale-start",
U=>Q.addToHistory(va(U.graphics)))];case "reshape":return[W.on("graphic-click",U=>this._onTransformOrReshape2DGraphicClick(Q,V,U)),W.on("move-start",U=>Q.addToHistory(va([U.mover]))),W.on("reshape-start",U=>Q.addToHistory(va([U.graphic]))),W.on("vertex-add",U=>Q.addToHistory(va([U.oldGraphic]))),W.on("vertex-remove",U=>Q.addToHistory(va([U.oldGraphic])))];case "move-3d":return[W.on("graphic-move-start",U=>{Q.addToHistory(va(U.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<U.allGraphics.length?U.allGraphics[0]:null,type:"move-start"},type:"update"})}),W.on("graphic-move",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:U.dx,dy:U.dy,mover:0<U.allGraphics.length?U.allGraphics[0]:null,type:"move"},type:"update"})}),W.on("graphic-move-stop",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<U.allGraphics.length?U.allGraphics[0]:null,type:"move-stop"},type:"update"})}),W.on("immediate-click",U=>{U.shiftKey?this._toggleSelection([U.graphic],Q,V):Q.toggleTool()})];case "transform-3d":return[W.on("record-undo",({record:U})=>{Q.addToHistory({updates:[U]})}),W.on("graphic-translate-start",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,
dx:U.dxScreen,dy:U.dyScreen,type:"move-start"},type:"update"})}),W.on("graphic-translate-stop",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,dx:U.dxScreen,dy:U.dyScreen,type:"move-stop"},type:"update"})}),W.on("graphic-rotate-start",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,angle:U.angle,type:"rotate-start"},
type:"update"})}),W.on("graphic-rotate-stop",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,angle:U.angle,type:"rotate-stop"},type:"update"})}),W.on("graphic-scale-start",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,xScale:U.xScale,yScale:U.yScale,type:"scale-start"},type:"update"})}),W.on("graphic-scale-stop",
U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,xScale:U.xScale,yScale:U.yScale,type:"scale-stop"},type:"update"})}),W.on("graphic-translate",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,dx:U.dxScreen,dy:U.dyScreen,type:"move"},type:"update"})}),W.on("graphic-rotate",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,angle:U.angle,type:"rotate"},type:"update"})}),W.on("graphic-scale",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:U.graphic,xScale:U.xScale,yScale:U.yScale,type:"scale"},type:"update"})}),W.on("immediate-click",U=>{U.shiftKey?this._toggleSelection([U.graphic],Q,V):Q.toggleTool()})];case "reshape-3d":return[W.on("reshape",U=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:U,type:"update"})}),W.on("move",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:U,type:"update"})}),W.on("vertex-add",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:U,type:"update"})}),W.on("vertex-remove",U=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:U,type:"update"})}),W.on("immediate-click",U=>{U.shiftKey?this._toggleSelection([U.graphic],Q,V):Q.toggleTool()})]}};ka._onTransformOrReshape2DGraphicClick=function(Q,V,W){const {graphic:U,viewEvent:ba}=W;if(ba.native?.shiftKey&&U.layer===this.layer)return ba.stopPropagation(),Q.removeFromSelection(U);if(V.toggleToolOnClick)return ba.stopPropagation(),Q.toggleTool()};ka._setUpdateOperationHandle=function(Q,V){this._operationHandle=Q;const W=
this.view?.map;this._disablePopup(V);Q.on("complete",()=>{if(Q===this._operationHandle){const U=this.updateGraphics.toArray(),ba=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();W&&W.remove(this._internalGraphicsLayer);this._restorePopup(V);this.emit("update",{graphics:U,state:"complete",aborted:Q.cancelled,tool:ba,toolEventInfo:null,type:"update"})}})};ka._getCommonUpdateOperationClickHandlers=
async function(Q,V,W){const U=T.createScreenPointFromEvent(V),ba=await V.async(()=>this._getFirstHit(U));e.isNone(ba)?Q.complete():V.native.shiftKey&&this._toggleSelection([ba.graphic],Q,W)?V.stopPropagation():this.updateGraphics.includes(ba.graphic)?V.stopPropagation():Q.complete()};ka._toggleSelection=function(Q,V,W){const U=!!W.multipleSelectionEnabled;return Q.some(ba=>null==ba?!1:U&&ba.layer===this.layer?(this.updateGraphics.includes(ba)?V.removeFromSelection(ba):V.addToSelection(ba),!0):!1)};
ka._getCommonUpdateOperationKeyDownHandlers=function(Q,V){if(Q){var W=V.key;W===C.SKETCH_KEYS.undo&&Q.canUndo()?(V.stopPropagation(),Q.undo()):W===C.SKETCH_KEYS.redo&&Q.canRedo()?(V.stopPropagation(),Q.redo()):W===C.SKETCH_KEYS.cancel?(V.stopPropagation(),Q.cancel()):this.allowDeleteKey&&C.SKETCH_KEYS.delete.includes(W)&&this._onDeleteKey(V)}};ka._onDeleteKey=function(Q){if(this._operationHandle&&"update"===this._operationHandle.type){var V=this.activeComponent,W=this.updateGraphics.toArray();e.isNone(V)||
"reshape-3d"===V.type||"reshape"===V.type&&(1!==W.length||"point"!==e.get(W[0].geometry,"type"))||(Q.stopPropagation(),this.delete())}};ka._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=e.destroyMaybe(this._internalGraphicsLayer))};ka._isComponentGraphic=function(Q){const {activeComponent:V}=this;return!Q||e.isNone(V)?!1:Q.attributes&&Q.attributes.esriSketchTool||"draw-2d"===V.type&&V.graphic===Q||("box"===
V.type||"reshape"===V.type)&&V.isUIGraphic(Q)};ka._displayPointerCursor=function(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};ka._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};ka._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};ka._logError=function(Q,V,W){f.getLogger(this.declaredClass).error(new L(Q,V,
W))};ka._requireModule=async function(Q){const V=new AbortController;this._moduleLoaderAbortController=V;Q=await Q;return this._moduleLoaderAbortController!==V||V.signal.aborted?{requireError:"aborted"}:{module:Q}};ka._emitUndoEvent=function(Q){this.emit("undo",{...Q,type:"undo"})};ka._emitRedoEvent=function(Q){this.emit("redo",{...Q,type:"redo"})};ka._emitDeleteEvent=function(Q){this.emit("delete",{...Q,type:"delete"})};ka.wait=function(){return K.whenOnce(()=>!this.updating)};ka._beginAsyncOperation=
function(){this._numUpdating+=1;this.notifyChange("updating")};ka._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};ka._disablePopupEnabled=function(Q){return"3d"!==this.view?.type||this.updateOnGraphicClick||(e.unwrap(Q)?.toggleToolOnClick??!1)};ka._disablePopup=function(Q){this._disablePopupEnabled(Q)&&(Q=this.view?.popup)&&e.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=Q.autoOpenEnabled,Q.autoOpenEnabled=!1)};ka._restorePopup=function(Q){this._disablePopupEnabled(Q)&&
(Q=this.view?.popup)&&e.isSome(this._originalAutoOpenEnabled)&&(Q.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)};ka._waitViewReady=async function(){const Q=this.view;Q?(e.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await g.whenOrAbort(K.whenOnce(()=>Q?.ready),this._viewReadyAbortController.signal)):this._logMissingView()};ka._logMissingView=function(){this._logError("sketch:missing-property",Ja("view"))};ka._logMissingLayer=
function(){this._logError("sketch:missing-property",Ja("layer"))};u._createClass(Aa,[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view?.type?"move":"transform"}},{key:"updating",get:function(){return 0<this._numUpdating||e.isSome(this._snappingManager)&&this._snappingManager.updating}},{key:"activeTool",get:function(){return this._operationHandle?.tool??null}},{key:"activeComponent",get:function(){return this._operationHandle?.activeComponent??null}},{key:"createGraphic",get:function(){return!e.isSome(this.activeComponent)||
"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):e.unwrap(this.activeComponent.graphic)}},{key:"defaultCreateOptions",get:function(){return this._get("defaultCreateOptions")},set:function(Q){this._set("defaultCreateOptions",{...ab,...Q})}},{key:"defaultUpdateOptions",get:function(){return this._get("defaultUpdateOptions")},set:function(Q){this._set("defaultUpdateOptions",{...Wa,...Q,reshapeOptions:{...Wa.reshapeOptions,...Q?.reshapeOptions}})}},
{key:"snappingOptions",set:function(Q){e.isSome(this._snappingManager)&&(this._snappingManager.options=Q);this._set("snappingOptions",Q)}},{key:"state",get:function(){const Q=!(!this.view?.ready||!this.layer),V=this._operationHandle;return Q&&V?"active":Q?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(Q){const V=this._get("view");if(V){const {container:W,map:U}=V;W&&(V.cursor=null);U&&U.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._handles.remove("view-ready");
Q&&this._handles.add(K.when(()=>Q.ready,W=>{this._viewHandles.removeAll();W&&this._viewHandles.add(this._generateViewHandles(Q))},K.syncAndInitial),"view-ready");this._set("view",Q)}},{key:"test",get:function(){return{operationHandle:this._operationHandle,defaultUpdateOptions:Wa}}}]);return Aa}(O.EventedAccessor);k.__decorate([n.property()],O.prototype,"updating",null);k.__decorate([n.property()],O.prototype,"_operationHandle",void 0);k.__decorate([n.property({readOnly:!0})],O.prototype,"activeTool",
null);k.__decorate([n.property()],O.prototype,"activeFillSymbol",void 0);k.__decorate([n.property()],O.prototype,"activeLineSymbol",void 0);k.__decorate([n.property()],O.prototype,"activeVertexSymbol",void 0);k.__decorate([n.property()],O.prototype,"allowDeleteKey",void 0);k.__decorate([n.property({readOnly:!0})],O.prototype,"createGraphic",null);k.__decorate([n.property()],O.prototype,"defaultCreateOptions",null);k.__decorate([n.property()],O.prototype,"defaultUpdateOptions",null);k.__decorate([n.property({type:P,
nonNullable:!0})],O.prototype,"labelOptions",void 0);k.__decorate([n.property()],O.prototype,"layer",void 0);k.__decorate([n.property({types:J.symbolTypes})],O.prototype,"pointSymbol",void 0);k.__decorate([n.property({types:J.symbolTypes})],O.prototype,"polygonSymbol",void 0);k.__decorate([n.property({types:J.symbolTypes})],O.prototype,"polylineSymbol",void 0);k.__decorate([n.property()],O.prototype,"meshSymbol",void 0);k.__decorate([n.property({type:r,nonNullable:!0})],O.prototype,"snappingOptions",
null);k.__decorate([n.property()],O.prototype,"_snappingManager",void 0);k.__decorate([n.property({readOnly:!0})],O.prototype,"state",null);k.__decorate([n.property({type:I,nonNullable:!0})],O.prototype,"tooltipOptions",void 0);k.__decorate([n.property({readOnly:!0})],O.prototype,"updateGraphics",void 0);k.__decorate([n.property()],O.prototype,"updateOnGraphicClick",void 0);k.__decorate([n.property({types:J.symbolTypes})],O.prototype,"vertexSymbol",void 0);k.__decorate([n.property({value:null})],
O.prototype,"view",null);O=k.__decorate([t.subclass("esri.widgets.Sketch.SketchViewModel")],O);const Ja=ka=>`Property '${ka}' is missing on SketchViewModel.`;return O})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n){J=function(y){function p(t){t=D.call(this,t);t.elevationInfo=null;t.graphics=new K.GraphicsCollection;t.screenSizePerspectiveEnabled=!0;t.type="graphics";t.internal=!1;return t}d._inherits(p,y);var D=d._createSuper(p);y=p.prototype;y.destroy=function(){this.removeAll();this.graphics.destroy()};y.add=function(t){this.graphics.add(t);return this};y.addMany=function(t){this.graphics.addMany(t);return this};y.removeAll=function(){this.graphics.removeAll();return this};
y.remove=function(t){this.graphics.remove(t)};y.removeMany=function(t){this.graphics.removeMany(t)};y.on=function(t,E){return d._get(d._getPrototypeOf(p.prototype),"on",this).call(this,t,E)};y.graphicChanged=function(t){this.emit("graphic-update",t)};return d._createClass(p)}(e.BlendLayer(g.ScaleRangeLayer(f)));u.__decorate([k.property({type:n})],J.prototype,"elevationInfo",void 0);u.__decorate([k.property(z.owningCollectionProperty(K.GraphicsCollection,"graphics"))],J.prototype,"graphics",void 0);
u.__decorate([k.property({type:["show","hide"]})],J.prototype,"listMode",void 0);u.__decorate([k.property()],J.prototype,"screenSizePerspectiveEnabled",void 0);u.__decorate([k.property({readOnly:!0})],J.prototype,"type",void 0);u.__decorate([k.property({constructOnly:!0})],J.prototype,"internal",void 0);return J=u.__decorate([O.subclass("esri.layers.GraphicsLayer")],J)})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports","../../../../core/has"],function(d,
u){d.SupportedGraphicResult=void 0;(function(k){k[k.SUPPORTED=0]="SUPPORTED";k[k.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";k[k.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";k[k.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";k[k.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";k[k.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(d.SupportedGraphicResult||(d.SupportedGraphicResult={}));d.isSupportedGraphicResultMessage=function(k){switch(k){case d.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";
case d.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case d.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case d.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case d.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(d,u,k,J,F){d.isSupportedGraphic=function(L){if("graphics"!==L.layer?.type)return F.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(k.isNone(L.geometry))return F.SupportedGraphicResult.GEOMETRY_MISSING;switch(L.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return F.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;
default:return F.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==J.getGraphicEffectiveElevationMode(L)&&J.hasGraphicFeatureExpressionInfo(L)?F.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:F.SupportedGraphicResult.SUPPORTED};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(d,u,k){function J(n,y){return u.isNone(y)||!y.mode?(n?
g:K).mode:y.mode}function F(n,y){return u.isSome(y)?y:n?g:K}function L(n,y){return J(u.isSome(n)?n.hasZ:!1,y)}function O(n){const y=z(n);return L(n.geometry,y)}function z(n){return n.layer&&"elevationInfo"in n.layer?n.layer.elevationInfo:null}function f(n,y,p,D,t,E,v=null){if(!u.isNone(E)){var M=u.isSome(v)?v.mode:"absolute-height";if("on-the-ground"===M)return 0;({absoluteZ:E}=e(y,p,D,t,n,E));a:{v=u.isSome(v)&&u.isSome(v.offset)?v.offset:0;switch(M){case "absolute-height":n=E-v;break a;case "relative-to-ground":n=
E-(u.unwrapOr(n.elevationProvider.getElevation(y,p,D,t,"ground"),0)+v);break a;case "relative-to-scene":n=E-(u.unwrapOr(n.elevationProvider.getElevation(y,p,D,t,"scene"),0)+v);break a}n=void 0}return n}}function e(n,y,p,D,t,E){const v=u.isSome(E.offset)?E.offset:0;switch(E.mode){case "absolute-height":return{absoluteZ:p+v,elevation:0};case "on-the-ground":return p=u.unwrapOr(t.elevationProvider.getElevation(n,y,0,D,"ground"),0),{absoluteZ:p,elevation:p};case "relative-to-ground":return n=u.unwrapOr(t.elevationProvider.getElevation(n,
y,p,D,"ground"),0),{absoluteZ:p+n+v,elevation:n};case "relative-to-scene":return n=u.unwrapOr(t.elevationProvider.getElevation(n,y,p,D,"scene"),0),{absoluteZ:p+n+v,elevation:n}}}const g={mode:"absolute-height",offset:0},K={mode:"on-the-ground",offset:null};d.absoluteHeightElevationInfo=g;d.elevationContextAffectsAlignment=function(n,y){if(u.isNone(y))return!1;({mode:y}=y);return u.isSome(y)&&("scene"===n&&"relative-to-scene"===y||"ground"===n&&"absolute-height"!==y)};d.elevationInfoLikeEquals=function(n,
y){return n===y||u.isSome(n)&&u.isSome(y)&&n.mode===y.mode&&n.offset===y.offset};d.getConvertedElevation=function(n,y,p,D=null){return f(n,y.x,y.y,y.hasZ?y.z:0,y.spatialReference,p,D)};d.getConvertedElevationFromVector=function(n,y,p,D,t=null){return f(n,y[0],y[1],2<y.length?y[2]:0,p,D,t)};d.getEffectiveElevationInfo=F;d.getEffectiveElevationMode=J;d.getGeometryEffectiveElevationInfo=function(n,y){return F(u.isSome(n)?!!n.hasZ:!1,y)};d.getGeometryEffectiveElevationMode=L;d.getGraphicEffectiveElevationInfo=
function(n){var y=z(n);n=L(n.geometry,y);y=u.isSome(y)&&"on-the-ground"!==n?u.unwrapOr(y.offset,0)*k.getMetersPerUnit(u.unwrapOr(y.unit,"meters")):0;return{mode:n,offset:y}};d.getGraphicEffectiveElevationMode=O;d.getZForElevationMode=function(n,y,p){if(!u.isNone(p)&&p.mode){var D=n.hasZ?n.z:0,t=u.isSome(p.offset)?p.offset:0;switch(p.mode){case "absolute-height":return D-t;case "on-the-ground":return 0;case "relative-to-ground":return n=u.unwrapOr(y.elevationProvider.getElevation(n.x,n.y,D,n.spatialReference,
"ground"),0)+t,D-n;case "relative-to-scene":return n=u.unwrapOr(y.elevationProvider.getElevation(n.x,n.y,D,n.spatialReference,"scene"),0)+t,D-n}}};d.hasGraphicFeatureExpressionInfo=function(n){if("on-the-ground"===O(n))return!1;n=z(n);n=u.isSome(n)&&n.featureExpressionInfo?n.featureExpressionInfo.expression:null;return!(!n||"0"===n)};d.onTheGroundElevationInfo=K;d.zValueInAbsoluteHeightMode=e;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/maybe","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(d,u,k,J,F){function L(O){return"graphics"!==O.layer?.type?{result:F.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null}:u.isNone(O.geometry)?{result:F.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null}:"on-the-ground"!==J.getGraphicEffectiveElevationMode(O)&&J.hasGraphicFeatureExpressionInfo(O)?{result:F.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,
geometry:null}:"point"!==O.geometry.type&&"polyline"!==O.geometry.type&&("polygon"!==O.geometry.type||O.geometry instanceof k)?{result:F.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:F.SupportedGraphicResult.SUPPORTED,geometry:O.geometry}}d.geometryOfSupportedGraphic=function(O){return L(O).geometry};d.isSupportedGraphic=function(O){return L(O).result};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y){var p;F=p=function(D){function t(...v){v=E.call(this,...v);v.center=null;v.geodesic=!1;v.numberOfPoints=60;v.radius=1E3;v.radiusUnit="meters";return v}d._inherits(t,D);var E=d._createSuper(t);D=t.prototype;D.normalizeCtorArgs=function(v,M){if(!v||!v.center){if(v&&v.rings)return d._get(d._getPrototypeOf(t.prototype),"normalizeCtorArgs",this).call(this,v,M);v={center:v}}return{...d._get(d._getPrototypeOf(t.prototype),"normalizeCtorArgs",this).call(this),...v,...M}};
D.initialize=function(){var v=this.center;const M=this.numberOfPoints;this.hasZ=v?.hasZ??!1;if(0===this.rings.length&&v){var B=k.convertUnit(this.radius,this.radiusUnit,"meters"),w=v.spatialReference,c="geographic";if(w.isWebMercator)c="webMercator";else if(null!=(w.wkid&&y[w.wkid])||w.wkt&&0===w.wkt.indexOf("PROJCS"))c="projected";if(this.geodesic){let m;switch(c){case "webMercator":m=n.webMercatorToGeographic(v);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");
break;case "geographic":m=v}v=this._createGeodesicCircle(m,B,M);"webMercator"===c&&(v=n.geographicToWebMercator(v))}else{let m;"webMercator"===c||"projected"===c?m=B/this._convert2Meters(1,v.spatialReference):"geographic"===c&&(m=k.lengthToDegrees(B,"meters",f.getReferenceEllipsoid(v.spatialReference).radius));v=this._createPlanarCircle(v,m,M)}this.spatialReference=v.spatialReference;this.addRing(v.rings[0])}};D.clone=function(){const {center:v,numberOfPoints:M,radius:B,radiusUnit:w,geodesic:c}=this;
return new p({center:v?.clone(),numberOfPoints:M,radius:B,radiusUnit:w,geodesic:c})};D._createGeodesicCircle=function(v,M,B){let w=0;const c=[];for(;360>w;){const m=[0,0];K.directGeodeticSolver(m,[v.x,v.y],w,M);this.hasZ&&m.push(v.z);c.push(m);w+=360/B}c.push(c[0]);return new g(c)};D._createPlanarCircle=function(v,M,B){const w=[],c=2*Math.PI/B;for(let h=0;h<B;++h){var m=c*h;m=[v.x+Math.cos(-m)*M,v.y+Math.sin(-m)*M];this.hasZ&&m.push(v.z);w.push(m)}w.push(w[0]);return new g({spatialReference:v.spatialReference,
rings:[w]})};D._convert2Meters=function(v,M){if(M.wkid&&null!=y[M.wkid])M=y.values[y[M.wkid]];else{M=M.wkt;const B=M.lastIndexOf(",")+1,w=M.lastIndexOf("]]");M=parseFloat(M.substring(B,w))}return v*M};return d._createClass(t)}(g);u.__decorate([J.property({type:e})],F.prototype,"center",void 0);u.__decorate([J.property()],F.prototype,"geodesic",void 0);u.__decorate([J.property()],F.prototype,"numberOfPoints",void 0);u.__decorate([J.property()],F.prototype,"radius",void 0);u.__decorate([J.property()],
F.prototype,"radiusUnit",void 0);return F=p=u.__decorate([z.subclass("esri.geometry.Circle")],F)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(d,u,k,J,F,L,O,z,f,e,g){function K(B){if(!B)return null;if(O.isGeographic(B)&&B.wkid){var w=L.spheroids[B.wkid];if(w)return w}return B.wkt&&
((B=L.WKT_SPHEROID_REGEX.exec(B.wkt))&&2===B.length?(w=B[1].split(","),!w||3>w.length?B=null:(B=parseFloat(w[1]),w=parseFloat(w[2]),B=isNaN(B)||isNaN(w)?null:{a:B,f:0===w?0:1/w})):B=null,B)?B:null}function n(B){B=K(B??g.WGS84);if(null!=B&&"b"in B&&"eSq"in B&&"radius"in B)return B;const w=B.a*(1-B.f);return Object.assign(B,{b:w,eSq:1-(w/B.a)**2,radius:(2*B.a+w)/3,densificationRatio:1E4/((2*B.a+w)/3)})}function y(B){return null!=B&&0>B?B+360:B}function p(B,w,c){const {a:m,eSq:h}=n(c);c=Math.sqrt(h);
const H=Math.sin(w[1]*L.toRadians);w=m*w[0]*L.toRadians;c=0<h?m*(1-h)*(H/(1-h*H*H)-1/(2*c)*Math.log((1-c*H)/(1+c*H)))*.5:m*H;B[0]=w;B[1]=c;return B}function D(B){return null!==K(B)}function t(B,w){if("polyline"!==B.type&&"polygon"!==B.type)throw new J("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:c}=B;if(!D(c))throw new J("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var m="polyline"===
B.type?B.paths:B.rings;const h=[],H=[0,0],q=new M;for(const P of m){m=[];h.push(m);m.push([P[0][0],P[0][1]]);var A=P[0][0],C=P[0][1];let I,G;for(let r=0;r<P.length-1;r++){I=P[r+1][0];G=P[r+1][1];if(A===I&&C===G)continue;const R=[A,C];v(q,[A,C],[I,G],c);const {azimuth:S,distance:T}=q;A=T/w;if(1<A){for(C=1;C<=A-1;C++)E(H,R,S,C*w,c),m.push(H.slice(0));E(H,R,S,(T+Math.floor(A-1)*w)/2,c);m.push(H.slice(0))}E(H,R,S,T,c);m.push(H.slice(0));A=H[0];C=H[1]}}return"polyline"===B.type?new z({paths:h,spatialReference:c}):
new f({rings:h,spatialReference:c})}function E(B,w,c,m,h){const H=w[0]*L.toRadians;w=w[1]*L.toRadians;c=(c??0)*L.toRadians;const {a:q,b:A,f:C}=n(h);h=Math.sin(c);c=Math.cos(c);var P=(1-C)*Math.tan(w);w=1/Math.sqrt(1+P*P);const I=P*w,G=Math.atan2(P,c);P=w*h;const r=P*P;var R=1-r,S=R*(q*q-A*A)/(A*A);const T=1+S/16384*(4096+S*(-768+S*(320-175*S))),Z=S/1024*(256+S*(-128+S*(74-47*S)));S=m/(A*T);let da=2*Math.PI,Y,fa,ea,oa;for(;1E-12<Math.abs(S-da);)ea=Math.cos(2*G+S),Y=Math.sin(S),fa=Math.cos(S),oa=Z*
Y*(ea+Z/4*(fa*(-1+2*ea*ea)-Z/6*ea*(-3+4*Y*Y)*(-3+4*ea*ea))),da=S,S=m/(A*T)+oa;m=I*Y-w*fa*c;R=C/16*R*(4+C*(4-3*R));m=Math.atan2(I*fa+w*Y*c,(1-C)*Math.sqrt(r+m*m))/L.toRadians;B[0]=(H+(Math.atan2(Y*h,w*fa-I*Y*c)-(1-R)*C*P*(S+R*Y*(ea+R*fa*(-1+2*ea*ea)))))/L.toRadians;B[1]=m;return B}function v(B,w,c,m){var h=w[0]*L.toRadians;w=w[1]*L.toRadians;var H=c[0]*L.toRadians;c=c[1]*L.toRadians;const {a:q,b:A,f:C,radius:P}=n(m),I=H-h;var G=Math.atan((1-C)*Math.tan(w)),r=Math.atan((1-C)*Math.tan(c));m=Math.sin(G);
G=Math.cos(G);const R=Math.sin(r);r=Math.cos(r);let S=1E3,T=I,Z,da,Y;let fa,ea,oa;do{var pa=Math.sin(T);var ra=Math.cos(T);Y=Math.sqrt(r*pa*r*pa+(G*R-m*r*ra)*(G*R-m*r*ra));if(0===Y)return B.distance=0,B.azimuth=void 0,B.reverseAzimuth=void 0,B;ra=m*R+G*r*ra;fa=Math.atan2(Y,ra);ea=G*r*pa/Y;da=1-ea*ea;pa=ra-2*m*R/da;isNaN(pa)&&(pa=0);oa=C/16*da*(4+C*(4-3*da));Z=T;T=I+(1-oa)*C*ea*(fa+oa*Y*(pa+oa*ra*(-1+2*pa*pa)))}while(1E-12<Math.abs(T-Z)&&0<--S);if(0===S)return m=Math.acos(Math.sin(w)*Math.sin(c)+Math.cos(w)*
Math.cos(c)*Math.cos(H-h))*P,h=H-h,B.azimuth=Math.atan2(Math.sin(h)*Math.cos(c),Math.cos(w)*Math.sin(c)-Math.sin(w)*Math.cos(c)*Math.cos(h))/L.toRadians,B.distance=m,B.reverseAzimuth=void 0,B;h=da*(q*q-A*A)/(A*A);w=h/1024*(256+h*(-128+h*(74-47*h)));H=Math.atan2(G*Math.sin(T),G*R*Math.cos(T)-m*r);B.azimuth=Math.atan2(r*Math.sin(T),G*R-m*r*Math.cos(T))/L.toRadians;B.distance=A*(1+h/16384*(4096+h*(-768+h*(320-175*h))))*(fa-w*Y*(pa+w/4*(ra*(-1+2*pa*pa)-w/6*pa*(-3+4*Y*Y)*(-3+4*pa*pa))));B.reverseAzimuth=
H/L.toRadians;return B}let M=u._createClass(function(B=0,w,c){this.distance=B;this.azimuth=w;this.reverseAzimuth=c});d.InverseGeodeticSolverResult=M;d.directGeodeticSolver=E;d.geodesicAreas=function(B,w="square-meters"){if(B.some(H=>!D(H.spatialReference)))throw new J("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const c=[];for(var m=0;m<B.length;m++){var h=B[m];const {radius:H,densificationRatio:q}=n(h.spatialReference);c.push(t(h,H*q))}B=[];
m=[0,0];h=[0,0];for(let H=0;H<c.length;H++){const {rings:q,spatialReference:A}=c[H];let C=0;for(let P=0;P<q.length;P++){const I=q[P];p(m,I[0],A);p(h,I[I.length-1],A);let G=h[0]*m[1]-m[0]*h[1];for(let r=0;r<I.length-1;r++)p(m,I[r+1],A),p(h,I[r],A),G+=h[0]*m[1]-m[0]*h[1];C+=G}C=F.convertUnit(C,"square-meters",w);B.push(C/-2)}return B};d.geodesicDensify=t;d.geodesicDistance=function(B,w,c="meters"){if(!B||!w)throw new J("geodesic-distance:missing-parameters","one or both input parameters are missing");
if(!B.spatialReference||!w.spatialReference)throw new J("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!O.equals(B.spatialReference,w.spatialReference))throw new J("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:m}=B;if(!D(m))throw new J("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(B.x===w.x&&B.y===w.y)return new M(0,0,0);const h=
new M;v(h,[B.x,B.y],[w.x,w.y],m);h.distance=F.convertUnit(h.distance,"meters",c);h.azimuth=y(h.azimuth);h.reverseAzimuth=y(h.reverseAzimuth);return h};d.geodesicLengths=function(B,w="meters"){if(!B)throw new J("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(B.some(h=>!D(h.spatialReference)))throw new J("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const c=[];for(let h=0;h<B.length;h++){var m=B[h];const {spatialReference:H}=
m;m="polyline"===m.type?m.paths:m.rings;let q=0;for(let A=0;A<m.length;A++){const C=m[A];let P=0;for(let I=1;I<C.length;I++){const G=C[I-1][0],r=C[I][0],R=C[I-1][1],S=C[I][1];if(R!==S||G!==r){const T=new M;v(T,[G,R],[r,S],H);P+=T.distance}}q+=P}q=F.convertUnit(q,"meters",w);c.push(q)}return c};d.inverseGeodeticSolver=v;d.isSupported=D;d.pointFromDistance=function(B,w,c){if(!B||null==w||null==c)throw new J("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");
if(0>c||360<c)throw new J("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!B.spatialReference)throw new J("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:m}=B;if(!D(m))throw new J("geodesic-distance:not-supported","input geometry spatial reference is not supported");const h=[0,0];E(h,[B.x,B.y],c,w,m);return new e({x:h[0],y:h[1],spatialReference:m})};
Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(d,u,k,J,F){d.isSupportedGraphic=function(L){if("graphics"!==L.layer?.type)return F.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(k.isNone(L.geometry))return F.SupportedGraphicResult.GEOMETRY_MISSING;
switch(L.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return F.SupportedGraphicResult.SUPPORTED;default:return F.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const O=k.isSome(L.symbol)&&"point-3d"===L.symbol.type&&L.symbol.symbolLayers;return O&&0<O.length&&O.some(z=>"object"===z.type)?"on-the-ground"!==J.getGraphicEffectiveElevationMode(L)&&J.hasGraphicFeatureExpressionInfo(L)?F.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:
F.SupportedGraphicResult.SUPPORTED:F.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/layerUtils":function(){define(["exports","../../../core/maybe"],function(d,u){d.addUniqueLayer=function(k,J,F){if(J&&k&&k.map){({map:k}=k);var L=k.layers.find(O=>O===J);L||k.add(J,F);L&&void 0!==F&&null!==F&&k.layers.reorder(L,F)}};d.findLayerView=function(k,J){return k.allLayerViews.find(F=>{F=F.layer;return F===J||"sublayers"in
F&&u.isSome(F.sublayers)&&F.sublayers.includes(J)})};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(d){d.SKETCH_KEYS={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};d.SNAPPING_KEYS={toggle:"Control"};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,u,k,J,F,L,O,z){k=function(f){function e(K){K=g.call(this,K);K.enabled=!1;return K}d._inherits(e,f);var g=d._createSuper(e);return d._createClass(e)}(k);u.__decorate([J.property({type:Boolean,nonNullable:!0})],k.prototype,"enabled",void 0);return k=u.__decorate([z.subclass("esri.views.interactive.sketch.SketchLabelOptions")],k)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(d,u,k,J,F,L,O,z,f,e){k=function(g){function K(y){y=n.call(this,y);y.enabled=!1;y.elevation=new f.SketchTooltipElevationOptions;y.visibleElements=new e.SketchTooltipVisibleElements;y.visualVariables=null;return y}d._inherits(K,g);var n=d._createSuper(K);K.prototype.toJSON=function(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}};return d._createClass(K)}(k);u.__decorate([J.property({type:Boolean,nonNullable:!0})],k.prototype,"enabled",void 0);u.__decorate([J.property({type:f.SketchTooltipElevationOptions,
nonNullable:!0})],k.prototype,"elevation",void 0);u.__decorate([J.property({type:e.SketchTooltipVisibleElements,nonNullable:!0})],k.prototype,"visibleElements",void 0);u.__decorate([J.property()],k.prototype,"visualVariables",void 0);return k=u.__decorate([z.subclass("esri.widgets.Sketch.SketchTooltipOptions")],k)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,u,k,J,F,L,O,z,f){d.SketchTooltipElevationOptions=function(e){function g(n){n=K.call(this,n);n.mode="absolute-height";return n}u._inherits(g,e);var K=u._createSuper(g);g.prototype.toJSON=function(){return{mode:this.mode}};return u._createClass(g)}(J);k.__decorate([F.property({type:String,nonNullable:!0})],d.SketchTooltipElevationOptions.prototype,"mode",void 0);d.SketchTooltipElevationOptions=k.__decorate([f.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],d.SketchTooltipElevationOptions);
Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(d,u,k,J,F,L,O,z,f){d.SketchTooltipVisibleElements=function(e){function g(){var n=
K.apply(this,arguments);n.distance=!0;n.elevation=!0;n.size=!0;n.scale=!0;n.rotation=!0;n.orientation=!0;n.totalLength=!0;n.area=!0;n.radius=!0;n.helpMessage=!1;return n}u._inherits(g,e);var K=u._createSuper(g);g.prototype.toJSON=function(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}};return u._createClass(g)}(J);k.__decorate([F.property({type:Boolean,nonNullable:!0})],
d.SketchTooltipVisibleElements.prototype,"distance",void 0);k.__decorate([F.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"elevation",void 0);k.__decorate([F.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"size",void 0);k.__decorate([F.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"scale",void 0);k.__decorate([F.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,
"rotation",void 0);k.__decorate([F.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"orientation",void 0);k.__decorate([F.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"totalLength",void 0);k.__decorate([F.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"area",void 0);k.__decorate([F.property({type:Boolean,nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"radius",void 0);k.__decorate([F.property({type:Boolean,
nonNullable:!0})],d.SketchTooltipVisibleElements.prototype,"helpMessage",void 0);d.SketchTooltipVisibleElements=k.__decorate([f.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],d.SketchTooltipVisibleElements);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ./Settings ./SnappingDomain ./snappingFactory ./SnappingOptions ./SnappingPoint ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p,D,t,E,v,M,B,w,c){function m({coordinateHelper:H,elevationInfo:q}){return H.hasZ()?p.absoluteHeightElevationInfo:q}d.SnappingManager=function(H){function q(C){C=A.call(this,C);C.options=new v;C.snappingEnginesFactory=E.defaultSnappingEnginesFactory;C._engines=[];C._currentMainCandidate=null;C._currentOtherActiveCandidates=[];C._currentSnappedType=h.MAIN;return C}u._inherits(q,H);var A=u._createSuper(q);H=q.prototype;H.initialize=function(){this.handles.add([z.watch(()=>
{const {effectiveFeatureEnabled:C,effectiveSelfEnabled:P,touchSensitivityMultiplier:I,distance:G}=this.options;return{effectiveFeatureEnabled:C,effectiveSelfEnabled:P,touchSensitivityMultiplier:I,distance:G}},()=>{this.doneSnapping();this.emit("changed")},z.sync),z.watch(()=>this.options,C=>{for(const P of this._engines)P.options=C},z.sync),z.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:C,snappingEnginesFactory:P})=>
this._recreateEngines(C,P),z.syncAndInitial)])};H.destroy=function(){this._destroyEngines()};H._recreateEngines=function(C,P){this._destroyEngines();if(C){var {view:I,options:G}=this;this._engines=P(I,G)}};H._destroyEngines=function(){for(const C of this._engines)C.destroy();this._engines=[]};H.snap=async function(C){return L.isSome(C.scenePoint)?this._snapMultiPoint(C):this._snapSinglePoint(C)};H.update=function(C){const {point:P,context:I}=C;this._removeVisualization();const G=this._currentMainCandidate;
if(L.isNone(G))return P;var r=this._selectUpdateInput(C);if(L.isNone(r))return P;({spatialReference:C}=I);var R=y.project(r,C);if(L.isNone(R))return P;({view:r}=this);const {elevationInfo:S,visualizer:T}=I,Z=[];R=M.pointToSnappingPoint(R,r,I);const da=G.constraint.closestTo(R);if(!this._arePointsWithinScreenThreshold(R,da,I))return this._resetSnappingState(),P;G.targetPoint=da;Z.push(...G.hints);for(const Y of this._currentOtherActiveCandidates)Y.targetPoint=da,Z.push(...Y.hints);L.isSome(T)&&this.handles.add(T.draw(Z,
{spatialReference:C,elevationInfo:m(I),view:r,selfSnappingZ:I.selfSnappingZ}),"visualization-handle");return M.snappingPointToSnappingOutput(da,r,{z:P.z,m:P.m,spatialReference:P.spatialReference,elevationInfo:S})};H.doneSnapping=function(){this._removeVisualization();this._resetSnappingState()};H._selectUpdateInput=function({point:C,scenePoint:P}){switch(this._currentSnappedType){case h.MAIN:return C;case h.SCENE:return P}};H._resetSnappingState=function(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=
[];this._currentSnappedType=h.MAIN};H._removeVisualization=function(){this.handles.remove("visualization-handle")};H._snapSinglePoint=async function({point:C,context:P,signal:I}){const {view:G}=this,r=M.pointToSnappingPoint(C,G,P),R=await this._fetchCandidates(r,t.SnappingDomain.ALL,P,I);return this._createSnapResult(r,h.MAIN,R,G,P,{z:C.z,m:C.m,spatialReference:C.spatialReference,elevationInfo:P.elevationInfo},I)};H._snapMultiPoint=async function({point:C,scenePoint:P,context:I,signal:G}){const {view:r}=
this,{coordinateHelper:R,spatialReference:S}=I;await y.initializeProjection(P.spatialReference,S);P=y.project(P,S);var T=M.pointToSnappingPoint(P,r,I);const Z=await this._fetchCandidates(T,t.SnappingDomain.FEATURE,I,G);if(0<Z.length)return C=await this._fetchCandidates(T,t.SnappingDomain.SELF,I,G),this._createSnapResult(T,h.SCENE,[...Z,...C],r,I,{z:P.z,m:P.m,spatialReference:P.spatialReference,elevationInfo:I.elevationInfo},G);P=M.pointToSnappingPoint(C,r,I);T=await this._fetchCandidates(P,t.SnappingDomain.SELF,
I,G);return this._createSnapResult(P,h.MAIN,T,r,I,{z:R.hasZ()&&C.hasZ?C.z??0:void 0,m:R.hasM()&&C.hasM?C.m??0:void 0,spatialReference:C.spatialReference,elevationInfo:I.elevationInfo},G)};H._fetchCandidates=async function(C,P,I,G){return(await Promise.all(this._engines.map(r=>r.fetchCandidates(C,P,I,G)))).flat()};H._createSnapResult=function(C,P,I,G,r,R,S){return{get valid(){return!O.isAborted(S)},apply:()=>{const {spatialReference:T}=r,{snappedPoint:Z,hints:da}=this._processCandidates(C,P,I,r);this._removeVisualization();
L.isSome(r.visualizer)&&this.handles.add(r.visualizer.draw(da,{spatialReference:T,elevationInfo:p.absoluteHeightElevationInfo,view:G,selfSnappingZ:r.selfSnappingZ}),"visualization-handle");return M.snappingPointToSnappingOutput(Z,G,R)}}};H._processCandidates=function(C,P,I,G){if(1>I.length)return this.doneSnapping(),{snappedPoint:C,hints:[]};this._currentSnappedType!==P&&this._resetSnappingState();B.sortCandidatesInPlace(C,I);const r=this._currentMainCandidate;if(L.isSome(r)){const R=this._findOldConstraintInNewCandidates(r,
I);if(0<=R)if(I[R]instanceof w.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(C,r.targetPoint,G))return this._updateSnappingCandidate(r,P,I,G)}else return this._intersectWithOtherCandidates(R,I,C,P,G)}return this._intersectWithOtherCandidates(0,I,C,P,G)};H._findOldConstraintInNewCandidates=function(C,P){return C instanceof w.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(P,C.first)&&0<=this._findOldCandidateIndex(P,C.second)?0:-1:this._findOldCandidateIndex(P,
C)};H._intersectWithOtherCandidates=function(C,P,I,G,r){const {coordinateHelper:R}=r,S=P[C],T=[];for(let Z=0;Z<P.length;++Z){if(Z===C)continue;const da=P[Z];for(const Y of S.constraint.intersect(da.constraint)){const fa=Y.closestTo(S.targetPoint);T.push([new w.IntersectionSnappingCandidate(fa,S,da,da.isDraped),this._squaredScreenDistance(I,fa,R)])}}return 0<T.length&&(T.sort((Z,da)=>Z[1]-da[1]),T[0][1]<this._squaredPointProximityThreshold(r.pointer))?this._updateSnappingCandidate(T[0][0],G,P,r):this._updateSnappingCandidate(S,
G,P,r)};H._updateSnappingCandidate=function(C,P,I,G){this.doneSnapping();this._currentMainCandidate=C;this._currentSnappedType=P;P=this._currentMainCandidate.targetPoint;const r=[];r.push(...C.hints);for(const R of I){if(C instanceof w.IntersectionSnappingCandidate){if(R.constraint.equals(C.first.constraint)||R.constraint.equals(C.second.constraint))continue}else if(R.constraint.equals(C.constraint))continue;I=R.constraint.closestTo(P);this._squaredScreenDistance(I,P,G.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&
(R.targetPoint=P,this._currentOtherActiveCandidates.push(R),r.push(...R.hints))}return{snappedPoint:P,hints:r}};H._squaredPointProximityThreshold=function(C){return"touch"===C?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};H._arePointsWithinScreenThreshold=function(C,P,I){return this._squaredScreenDistance(C,P,I.coordinateHelper)<this._squaredPointProximityThreshold(I.pointer)};H._squaredScreenDistance=function(C,P,I){return B.squaredScreenDistance(this._toScreen(C,I),this._toScreen(P,
I))};H._toScreen=function(C,P){return c.vectorToScreenPoint(C,P.spatialReference,p.absoluteHeightElevationInfo,this.view)};H._findOldCandidateIndex=function(C,P){let I=-1;for(let G=0;G<C.length;++G)if(P.constraint.equals(C[G].constraint)){I=G;break}return I};u._createClass(q,[{key:"updating",get:function(){return this._engines.some(C=>C.updating)}},{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:C,
touchSensitivityMultiplier:P}=this.options,I=C*P;return I*I}},{key:"_squaredSatisfiesConstraintThreshold",get:function(){return D.defaults.satisfiesConstraintScreenThreshold*D.defaults.satisfiesConstraintScreenThreshold}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this._engines}}}]);return q}(J.EventedMixin(F.HandleOwner));k.__decorate([f.property({constructOnly:!0})],d.SnappingManager.prototype,"view",void 0);k.__decorate([f.property()],
d.SnappingManager.prototype,"options",void 0);k.__decorate([f.property({readOnly:!0})],d.SnappingManager.prototype,"updating",null);k.__decorate([f.property()],d.SnappingManager.prototype,"snappingEnginesFactory",void 0);k.__decorate([f.property()],d.SnappingManager.prototype,"_engines",void 0);k.__decorate([f.property()],d.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);k.__decorate([f.property()],d.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);k.__decorate([f.property()],
d.SnappingManager.prototype,"_squaredSatisfiesConstraintThreshold",null);d.SnappingManager=k.__decorate([n.subclass("esri.views.interactive.snapping.SnappingManager")],d.SnappingManager);var h;(function(H){H[H.MAIN=0]="MAIN";H[H.SCENE=1]="SCENE"})(h||(h={}));Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,u,k,J,F,L,O){let z=function(f){function e(){var K=g.apply(this,arguments);K.enabled=!0;return K}u._inherits(e,f);var g=u._createSuper(e);return u._createClass(e)}(F.JSONSupport);k.__decorate([L.property({type:Boolean})],z.prototype,"enabled",void 0);z=k.__decorate([O.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],z);F=function(f){function e(K){K=g.call(this,K);K.lineSnapper=new z;K.parallelLineSnapper=new z;K.rightAngleSnapper=new z;K.rightAngleTriangleSnapper=
new z;K.shortLineThreshold=15;K.distance=5;K.pointThreshold=1E-6;K.intersectionParallelLineThreshold=1E-6;K.parallelLineThreshold=1E-6;K.verticalLineThreshold=.1;K.touchSensitivityMultiplier=1.5;K.pointOnLineThreshold=1E-6;K.orange=new J([255,127,0]);K.orangeTransparent=new J([255,127,0,.5]);K.lineHintWidthReference=3;K.lineHintWidthTarget=3;K.lineHintFadedExtensions=.3;K.parallelLineHintWidth=2;K.parallelLineHintLength=24;K.parallelLineHintOffset=1.5;K.rightAngleHintSize=24;K.rightAngleHintOutlineSize=
1.5;K.satisfiesConstraintScreenThreshold=1;return K}u._inherits(e,f);var g=u._createSuper(e);return u._createClass(e)}(F.JSONSupport);k.__decorate([L.property({type:z,constructOnly:!0,nonNullable:!0,json:{write:!0}})],F.prototype,"lineSnapper",void 0);k.__decorate([L.property({type:z,constructOnly:!0,nonNullable:!0,json:{write:!0}})],F.prototype,"parallelLineSnapper",void 0);k.__decorate([L.property({type:z,constructOnly:!0,nonNullable:!0,json:{write:!0}})],F.prototype,"rightAngleSnapper",void 0);
k.__decorate([L.property({type:z,constructOnly:!0,nonNullable:!0,json:{write:!0}})],F.prototype,"rightAngleTriangleSnapper",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],F.prototype,"shortLineThreshold",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],F.prototype,"distance",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],
F.prototype,"pointThreshold",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],F.prototype,"intersectionParallelLineThreshold",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],F.prototype,"parallelLineThreshold",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],F.prototype,"verticalLineThreshold",void 0);k.__decorate([L.property({type:Number,
nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],F.prototype,"touchSensitivityMultiplier",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],F.prototype,"pointOnLineThreshold",void 0);k.__decorate([L.property({type:J,nonNullable:!0})],F.prototype,"orange",void 0);k.__decorate([L.property({type:J,nonNullable:!0})],F.prototype,"orangeTransparent",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
F.prototype,"lineHintWidthReference",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],F.prototype,"lineHintWidthTarget",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],F.prototype,"lineHintFadedExtensions",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],F.prototype,"parallelLineHintWidth",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,
range:{min:0,max:50},json:{write:!0}})],F.prototype,"parallelLineHintLength",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],F.prototype,"parallelLineHintOffset",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],F.prototype,"rightAngleHintSize",void 0);k.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],F.prototype,"rightAngleHintOutlineSize",void 0);k.__decorate([L.property({type:Number,
nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],F.prototype,"satisfiesConstraintScreenThreshold",void 0);F=k.__decorate([O.subclass("esri.views.interactive.snapping.Settings.Defaults")],F);k=new F;d.defaults=k;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(d){d.SnappingDomain=void 0;var u=d.SnappingDomain||(d.SnappingDomain={});u[u.FEATURE=1]="FEATURE";u[u.SELF=2]="SELF";u[u.ALL=3]="ALL";
Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingFactory":function(){define(["exports","./FeatureSnappingEngine","./SelfSnappingEngine"],function(d,u,k){d.defaultSnappingEnginesFactory=function(J,F){return[new k.SelfSnappingEngine({view:J,options:F}),new u.FeatureSnappingEngine({view:J,options:F,spatialReference:J.spatialReference})]};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/common ../../../layers/graphics/data/QueryEngineResult ../../../support/elevationInfoUtils ./SnappingConstraint ./SnappingDomain ./SnappingPoint ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p,D,t,E,v,M,B,w,c,m,h,H,q,A,C,P){function I({constraint:{start:T,end:Z}}){const da=t.squaredDistance(T,Z);T=D.squaredDistance(T,Z);return da<v.getEpsilon()||1E-4>T/da}function G(T,Z,da,Y,fa,ea,{spatialReference:oa}){Z=t.copy(S,Z);Z[0]+=da;Z[1]+=Y;Z[2]+=fa;return(da=P.vectorToScreenPoint(Z,oa,B.absoluteHeightElevationInfo,ea))?h.screenDistance(da,T):Infinity}u.FeatureSnappingEngine=function(T){function Z(Y){Y=da.call(this,Y);Y.options=null;Y._domain=c.SnappingDomain.FEATURE;
Y._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}};return Y}k._inherits(Z,T);var da=k._createSuper(Z);T=Z.prototype;T.initialize=function(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),e.sync);z.isSome(this.view)&&this.handles.add([this.view.on("layerview-create",Y=>this._updateLayerView(Y.layer,Y.layerView)),
this.view.on("layerview-destroy",Y=>this._updateLayerView(Y.layer,null))])};T._updateLayerView=function(Y,fa){for(const [,ea]of this.snappingSources)ea.snappingSource.layerSource.layer===Y&&(ea.layerView=fa)};T.destroy=function(){this._set("options",null);for(const [,Y]of this.snappingSources)Y.destroy()};T.fetchCandidates=async function(Y,fa,ea,oa){if(!(fa&this._domain)||z.isNone(this.options)||!this.options.effectiveFeatureEnabled)return[];var pa=[];fa=this._computeScreenSizeDistanceParameters(Y,
ea);const ra={distance:fa,mode:z.unwrap(this.view)?.type??"2d",point:Y,coordinateHelper:ea.coordinateHelper,types:this._types};for(const [,{snappingSource:ua,layerView:Ea}]of this.snappingSources)!ua.layerSource.enabled||z.isSome(Ea)&&Ea.suspended||pa.push(ua.fetchCandidates(ra,oa).then(va=>va.filter(xa=>!this._candidateIsExcluded(ua,xa,ea.excludeFeature))));pa=(await f.eachAlwaysValues(pa)).flat();this._addRightAngleCandidates(pa,Y,fa,ea);f.throwIfAborted(oa);h.sortCandidatesInPlace(Y,pa);return pa};
T._addRightAngleCandidates=function(Y,fa,ea,oa){var pa=z.isSome(oa.vertexHandle)?oa.vertexHandle.rightEdge?.rightVertex?.pos:z.isSome(oa.editGeometryOperations)&&"polygon"===oa.editGeometryOperations.data.type?z.unwrap(oa.editGeometryOperations.data.components[0]?.getFirstVertex())?.pos:null,ra=z.isSome(oa.vertexHandle)?oa.vertexHandle.leftEdge?.leftVertex?.pos:z.isSome(oa.editGeometryOperations)?z.unwrap(oa.editGeometryOperations.data.components[0]?.getLastVertex())?.pos:null,{view:ua}=this;pa=m.anyMapPointToSnappingPoint(pa,
ua,oa);oa=m.anyMapPointToSnappingPoint(ra,ua,oa);ra=Y.length;for(ua=0;ua<ra;ua++)this._addRightAngleCandidate(Y[ua],oa,fa,ea,Y),this._addRightAngleCandidate(Y[ua],pa,fa,ea,Y)};T._addRightAngleCandidate=function(Y,fa,ea,oa,pa){var ra;(ra=z.isNone(fa))||(ra=!((Y instanceof q.EdgeSnappingCandidate||Y instanceof H.DrapedEdgeSnappingCandidate)&&!I(Y)));if(!ra){ra=Y.constraint.closestTo(fa);var ua=(ra[0]-ea[0])/oa.x;ea=(ra[1]-ea[1])/oa.y;var {start:Ea,end:va}=Y.constraint;1>=ua*ua+ea*ea&&(Y=new C.RightAngleSnappingCandidate({targetPoint:ra,
otherVertex:fa,otherVertexType:C.OtherVertexType.NEXT,previousVertex:D.squaredDistance(ra,Ea)>D.squaredDistance(ra,va)?Ea:va,constraint:new w.VerticalHalfPlaneConstraint(fa,ra),objectId:Y.objectId,isDraped:Y.isDraped}),pa.push(Y))}};T._computeScreenSizeDistanceParameters=function(Y,fa){let ea=z.isSome(this.options)?this.options.distance*("touch"===fa.pointer?this.options.touchSensitivityMultiplier:1):0;return z.isNone(this.view)?{x:ea,y:ea,z:ea,distance:ea}:"2d"===this.view.type?(ea*=this.view.resolution,
{x:ea,y:ea,z:ea,distance:ea}):this._computeScreenSizeDistanceParameters3D(Y,ea,this.view,fa)};T._computeScreenSizeDistanceParameters3D=function(Y,fa,ea,oa){var {spatialReference:pa}=oa;ea.renderCoordsHelper.toRenderCoords(Y,pa,R);const ra=ea.state.camera.computeScreenPixelSizeAt(R),ua=ra*ea.renderCoordsHelper.unitInMeters/ea.mapCoordsHelper.unitInMeters,Ea=fa*ua,va=P.vectorToScreenPoint(Y,pa,B.absoluteHeightElevationInfo,ea);pa=va?G(va,Y,ua,0,0,ea,oa):0;const xa=va?G(va,Y,0,ua,0,ea,oa):0;Y=va?G(va,
Y,0,0,ua,ea,oa):0;return{x:0===pa?0:Ea/pa,y:0===xa?0:Ea/xa,z:0===Y?0:Ea/Y,distance:ra*fa}};T._candidateIsExcluded=function(Y,fa,ea){if(z.isNone(ea))return!1;fa=this._getCandidateObjectId(fa);if(z.isNone(fa))return!1;Y=Y.layerSource.layer;return"graphics"===Y.type?ea.uid===fa:ea.sourceLayer===Y&&ea.attributes&&"objectIdField"in Y?ea.attributes[Y.objectIdField]===fa:!1};T._getCandidateObjectId=function(Y){return Y instanceof A.FeatureSnappingCandidate?Y.objectId:null};T._createSourceInfo=function(Y){const fa=
this._createFeatureSnappingSourceType(Y);if(z.isNone(fa))return null;if("loading"in fa)return this.updatingHandles.addPromise(fa.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const ea=z.isSome(this.view)?this.view.allLayerViews.find(oa=>oa.layer===Y.layer):null;return new r(fa.source,ea)};T._createFeatureSnappingSourceType=function(Y){switch(Y.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(Y);
case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(Y);case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(Y);case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(Y)}return null};T._createFeatureSnappingSourceSceneLayer=function(Y){const {view:fa}=this;if(z.isNone(fa)||"3d"!==fa.type)return null;const ea=this._getSourceModule("scene");return z.isSome(ea.module)?{source:new ea.module.SceneLayerSnappingSource({layerSource:Y,view:fa})}:
{loading:ea.loader}};T._createFeatureSnappingSourceFeatureLayer=function(Y){switch(Y.layer.source?.type){case "feature-layer":case "oriented-imagery":var fa=this._getSourceModule("featureService");return z.isSome(fa.module)?{source:new fa.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:Y})}:{loading:fa.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==Y.layer.geometryType)return fa=this._getSourceModule("featureCollection"),
z.isSome(fa.module)?{source:new fa.module.FeatureCollectionSnappingSource({layerSource:Y,view:this.view})}:{loading:fa.loader}}return null};T._createFeatureSnappingSourceGraphicsLayer=function(Y){const fa=this._getSourceModule("graphics");return z.isSome(fa.module)?{source:new fa.module.GraphicsSnappingSource({getGraphicsLayers:()=>[Y.layer],spatialReference:this.spatialReference,view:this.view,layerSource:Y})}:{loading:fa.loader}};T._createFeatureSnappingSourceMapNotesLayer=function(Y){const fa=
this._getSourceModule("notes");return z.isSome(fa.module)?{source:new fa.module.GraphicsSnappingSource({getGraphicsLayers:()=>z.isSome(Y.layer.sublayers)?Y.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:Y})}:{loading:fa.loader}};T._getSourceModule=function(Y){const fa=this._sourceModules[Y];return z.isNone(fa.loader)?(Y=this._loadSourceModule(Y).then(ea=>{fa.module=ea}),fa.loader=Y,{module:fa.module,loader:Y}):{module:fa.module,loader:fa.loader}};T._loadSourceModule=
function(Y){const fa=this.updatingHandles;switch(Y){case "featureService":return fa.addPromise(new Promise((ea,oa)=>d(["./featureSources/FeatureServiceSnappingSource"],ea,oa)));case "featureCollection":return fa.addPromise(new Promise((ea,oa)=>d(["./featureSources/FeatureCollectionSnappingSource"],ea,oa)));case "graphics":return fa.addPromise(new Promise((ea,oa)=>d(["./featureSources/GraphicsSnappingSource"],ea,oa)));case "notes":return fa.addPromise(new Promise((ea,oa)=>d(["./featureSources/GraphicsSnappingSource"],
ea,oa)));case "scene":return fa.addPromise(new Promise((ea,oa)=>d(["./featureSources/SceneLayerSnappingSource"],ea,oa)))}};k._createClass(Z,[{key:"updating",get:function(){return O.someMap(this.snappingSources,({snappingSource:Y})=>Y.updating)||this.updatingHandles.updating}},{key:"snappingSources",get:function(){const Y=this._get("snappingSources")||new Map,fa=new Map;if(z.isSome(this.options)&&z.isSome(this.options.featureSources))for(const oa of this.options.featureSources.items){const pa=oa.layer.uid;
var ea=Y.get(pa);ea?(Y.delete(pa),fa.set(pa,ea)):oa.layer.loaded?(ea=this._createSourceInfo(oa),z.isSome(ea)&&fa.set(pa,ea)):this.updatingHandles.addPromise(oa.layer.load())}for(const [,oa]of Y)oa.destroy();return fa}},{key:"_types",get:function(){return M.SnappingTypes.EDGE|M.SnappingTypes.VERTEX}}]);return Z}(F.HandleOwner);J.__decorate([g.property({constructOnly:!0})],u.FeatureSnappingEngine.prototype,"spatialReference",void 0);J.__decorate([g.property({constructOnly:!0})],u.FeatureSnappingEngine.prototype,
"view",void 0);J.__decorate([g.property()],u.FeatureSnappingEngine.prototype,"options",void 0);J.__decorate([g.property({readOnly:!0})],u.FeatureSnappingEngine.prototype,"updating",null);J.__decorate([g.property({readOnly:!0})],u.FeatureSnappingEngine.prototype,"snappingSources",null);u.FeatureSnappingEngine=J.__decorate([p.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],u.FeatureSnappingEngine);let r=function(){function T(Z,da){this.snappingSource=Z;this.layerView=da;this.handles=
new L;da=this.snappingSource.layerSource.layer;"refresh"in da&&this.handles.add(da.on("refresh",()=>Z.refresh()));this.handles.add([e.watch(()=>Z.updating,Y=>Z.layerSource.updating=Y,e.syncAndInitial),e.watch(()=>Z.availability,Y=>Z.layerSource.availability=Y,e.syncAndInitial)])}T.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return k._createClass(T)}();const R=E.create(),S=E.create();Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./SnappingCandidate ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p){function D(M,B,w,c){const m=c.x-w.x;c=c.y-w.y;B=Math.min(1,Math.max(0,((B.x-w.x)*m+(B.y-w.y)*c)/(m*m+c*c)));M.x=w.x+m*B;M.y=w.y+c*B}function t(M,B){return M?B?4:3:B?3:2}let E=function(){function M(w,c,m){this.items=w;this.query=c;this.geometryType=m.geometryType;this.hasM=m.hasM;this.hasZ=m.hasZ;this.fieldsIndex=m.fieldsIndex;this.objectIdField=m.objectIdField;this.spatialReference=m.spatialReference;this.featureAdapter=m.featureAdapter}var B=M.prototype;B.createQueryResponseForCount=
function(){const w=new f(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return w.countDistinctValues(this.items);const {groupByFieldsForStatistics:c,having:m,outStatistics:h}=this.query;if(!c?.length)return 1;const H=new Map,q=new Map,A=new Set;for(const I of h){var {statisticType:C}=I;C="exceedslimit"!==C?I.onStatisticField:void 0;if(!q.has(C)){var P=[];for(const G of c){const r=this._getAttributeValues(w,G,H);P.push(r)}q.set(C,this._calculateUniqueValues(P,w.returnDistinctValues))}C=
q.get(C);for(const G in C){const {data:r,items:R}=C[G];P=r.join(",");m&&!w.validateItems(R,m)||A.add(P)}}return A.size};B.createQueryResponse=async function(){let w;w=this.query.outStatistics?this.query.outStatistics.some(c=>"exceedslimit"===c.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const c=this.query.geometry;z.isValid(this.query.outSR)&&!z.equals(c.spatialReference,
this.query.outSR)?w.queryGeometry=K.cleanFromGeometryEngine({spatialReference:this.query.outSR,...e.project(c,c.spatialReference,this.query.outSR)}):w.queryGeometry=K.cleanFromGeometryEngine({spatialReference:this.query.outSR,...c})}return w};B.createSnappingResponse=function(w,c){const m=this.featureAdapter,h=t(this.hasZ,this.hasM),{point:H,mode:q}=w,A="number"===typeof w.distance?w.distance:w.distance.x,C="number"===typeof w.distance?w.distance:w.distance.y,P={candidates:[]},I="esriGeometryPolygon"===
this.geometryType;c=this._getPointCreator(q,this.spatialReference,c);const G=new v(null,0),r=new v(null,0),R={x:0,y:0,z:0};for(const ea of this.items){var S=m.getGeometry(ea);if(J.isNone(S))continue;const {coords:oa,lengths:pa}=S;G.coords=oa;r.coords=oa;if(w.types&u.SnappingTypes.EDGE){S=0;for(var T=0;T<pa.length;T++){var Z=pa[T];for(var da=0;da<Z;da++,S+=h){var Y=G;Y.coordsIndex=S;if(da!==Z-1){const ra=r;ra.coordsIndex=S+h;const ua=R;D(R,H,Y,ra);var fa=(H.x-ua.x)/A;const Ea=(H.y-ua.y)/C;fa=fa*fa+
Ea*Ea;1>=fa&&P.candidates.push(g.makeEdgeCandidate(m.getObjectId(ea),c(ua),Math.sqrt(fa),c(Y),c(ra)))}}}}if(w.types&u.SnappingTypes.VERTEX)for(S=I?oa.length-h:oa.length,T=0;T<S;T+=h)Z=G,Z.coordsIndex=T,da=(H.x-Z.x)/A,Y=(H.y-Z.y)/C,da=da*da+Y*Y,1>=da&&P.candidates.push(g.makeVertexCandidate(m.getObjectId(ea),c(Z),Math.sqrt(da)))}P.candidates.sort((ea,oa)=>ea.distance-oa.distance);return P};B._getPointCreator=function(w,c,m){const h=J.isSome(m)&&!z.equals(c,m)?q=>e.project(q,c,m):q=>q,{hasZ:H}=this;
return"3d"===w?H?({x:q,y:A,z:C})=>h({x:q,y:A,z:C}):({x:q,y:A})=>h({x:q,y:A,z:0}):({x:q,y:A})=>h({x:q,y:A})};B.createSummaryStatisticsResponse=async function(w){const {field:c,valueExpression:m,normalizationField:h,normalizationType:H,normalizationTotal:q,minValue:A,maxValue:C,scale:P}=w;w=this.fieldsIndex.isDateField(c);var I=await this._getDataValues({field:c,valueExpression:m,normalizationField:h,normalizationType:H,normalizationTotal:q,scale:P});const G=y.isNullCountSupported({normalizationType:H,
normalizationField:h,minValue:A,maxValue:C}),r=this.fieldsIndex.get(c),R={value:.5,fieldType:r?.type};I=n.isStringField(r)?y.calculateStringStatistics({values:I,supportsNullCount:G,percentileParams:R}):y.calculateStatistics({values:I,minValue:A,maxValue:C,useSampleStdDev:!H,supportsNullCount:G,percentileParams:R});return y.processSummaryStatisticsResult(I,w)};B.createUniqueValuesResponse=async function(w){const {field:c,valueExpression:m,domains:h,returnAllCodedValues:H,scale:q}=w;var A=await this._getDataValues({field:c,
field2:w.field2,field3:w.field3,fieldDelimiter:w.fieldDelimiter,valueExpression:m,scale:q});A=y.calculateUniqueValuesCount(A);return y.createUVResult(A,h,H,w.fieldDelimiter)};B.createClassBreaksResponse=async function(w){const {field:c,valueExpression:m,normalizationField:h,normalizationType:H,normalizationTotal:q,classificationMethod:A,standardDeviationInterval:C,minValue:P,maxValue:I,numClasses:G,scale:r}=w;w=await this._getDataValues({field:c,valueExpression:m,normalizationField:h,normalizationType:H,
normalizationTotal:q,scale:r});w=y.calculateClassBreaks(w,{field:c,normalizationField:h,normalizationType:H,normalizationTotal:q,classificationMethod:A,standardDeviationInterval:C,minValue:P,maxValue:I,numClasses:G});return y.resolveCBResult(w,A)};B.createHistogramResponse=async function(w){const {field:c,valueExpression:m,normalizationField:h,normalizationType:H,normalizationTotal:q,classificationMethod:A,standardDeviationInterval:C,minValue:P,maxValue:I,numBins:G,scale:r}=w;w=await this._getDataValues({field:c,
valueExpression:m,normalizationField:h,normalizationType:H,normalizationTotal:q,scale:r});return y.calculateHistogram(w,{field:c,normalizationField:h,normalizationType:H,normalizationTotal:q,classificationMethod:A,standardDeviationInterval:C,minValue:P,maxValue:I,numBins:G})};B._sortFeatures=function(w,c,m){if(1<w.length&&c&&c.length)for(const h of c.reverse()){c=h.split(" ");const H=c[0],q=this.fieldsIndex.get(H);c=c[1]?"desc"===c[1].toLowerCase():!1;const A=y.getAttributeComparator(q?.type,c);w.sort((C,
P)=>{C=m(C,H,q);P=m(P,H,q);return A(C,P)})}};B._createFeatureQueryResponse=function(w){const c=this.items,{geometryType:m,hasM:h,hasZ:H,objectIdField:q,spatialReference:A}=this,{outFields:C,outSR:P,quantizationParameters:I,resultRecordCount:G,resultOffset:r,returnZ:R,returnM:S}=w,T=null!=G?c.length>(r||0)+G:!1,Z=C&&(C.includes("*")?[...this.fieldsIndex.fields]:C.map(da=>this.fieldsIndex.get(da)));return{exceededTransferLimit:T,features:this._createFeatures(w,c),fields:Z,geometryType:m,hasM:h&&S,hasZ:H&&
R,objectIdFieldName:q,spatialReference:K.cleanFromGeometryEngine(P||A),transform:I&&O.toQuantizationTransform(I)||null}};B._createFeatures=function(w,c){const m=new f(w,this.featureAdapter,this.fieldsIndex),{hasM:h,hasZ:H}=this,{orderByFields:q,quantizationParameters:A,returnGeometry:C,returnCentroid:P,maxAllowableOffset:I,resultOffset:G,resultRecordCount:r,returnZ:R=!1,returnM:S=!1}=w,T=H&&R,Z=h&&S;w=[];var da=0;c=[...c];this._sortFeatures(c,q,(ea,oa,pa)=>m.getFieldValue(ea,oa,pa));if(C||P){var Y=
O.toQuantizationTransform(A)??void 0;if(C&&!P)for(var fa of c)w[da++]={attributes:m.getAttributes(fa),geometry:K.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(fa),I,Y,T,Z)};else if(!C&&P)for(const ea of c)w[da++]={attributes:m.getAttributes(ea),centroid:K.transformCentroid(this,this.featureAdapter.getCentroid(ea,this),Y)};else for(const ea of c)w[da++]={attributes:m.getAttributes(ea),centroid:K.transformCentroid(this,this.featureAdapter.getCentroid(ea,this),Y),
geometry:K.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(ea),I,Y,T,Z)}}else for(Y of c)(fa=m.getAttributes(Y))&&(w[da++]={attributes:fa});da=G||0;null!=r&&(w=w.slice(da,Math.min(w.length,da+r)));return w};B._createExceedsLimitQueryResponse=function(w){var c=!1;let m=Number.POSITIVE_INFINITY,h=Number.POSITIVE_INFINITY;c=Number.POSITIVE_INFINITY;for(const H of w.outStatistics??[])if("exceedslimit"===H.statisticType){m=null!=H.maxPointCount?H.maxPointCount:Number.POSITIVE_INFINITY;
h=null!=H.maxRecordCount?H.maxRecordCount:Number.POSITIVE_INFINITY;c=null!=H.maxVertexCount?H.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)c=this.items.length>m;else if(this.items.length>h)c=!0;else{w=t(this.hasZ,this.hasM);const H=this.featureAdapter;c=this.items.reduce((q,A)=>{A=H.getGeometry(A);return q+(J.isSome(A)&&A.coords.length||0)},0)/w>c}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",
domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(c)}}]}};B._createStatisticsQueryResponse=async function(w){var c={attributes:{}};const m=[],h=new Map,H=new Map,q=new Map,A=new Map,C=new f(w,this.featureAdapter,this.fieldsIndex);var P=w.outStatistics;const {groupByFieldsForStatistics:I,having:G,orderByFields:r}=w;w=I&&I.length;const R=!!w,S=R?I[0]:null,T=R&&!this.fieldsIndex.get(S);for(const ea of P??[]){const {outStatisticFieldName:oa,statisticType:pa}=ea;P=ea;var Z="exceedslimit"!==
pa?ea.onStatisticField:void 0;const ra="percentile_disc"===pa||"percentile_cont"===pa,ua="EnvelopeAggregate"===pa||"CentroidAggregate"===pa||"ConvexHullAggregate"===pa,Ea=R&&1===w&&(Z===S||T)&&"count"===pa;if(R){if(!q.has(Z)){var da=[];for(const va of I){var Y=this._getAttributeValues(C,va,h);da.push(Y)}q.set(Z,this._calculateUniqueValues(da,ua?!1:C.returnDistinctValues))}da=q.get(Z);for(const va in da){const {count:xa,data:Qa,items:ab,itemPositions:Wa}=da[va];Y=Qa.join(",");if(!G||C.validateItems(ab,
G)){const Ja=A.get(Y)||{attributes:{}};if(ua){Ja.aggregateGeometries||(Ja.aggregateGeometries={});const {aggregateGeometries:Aa,outStatisticFieldName:Pa}=await this._getAggregateGeometry(P,ab);Ja.aggregateGeometries[Pa]=Aa}else{var fa=null;if(Ea)fa=xa;else{const Aa=this._getAttributeValues(C,Z,h);fa=Wa.map(Pa=>Aa[Pa]);fa=ra&&"statisticParameters"in P?this._getPercentileValue(P,fa):this._getStatisticValue(P,fa,null,C.returnDistinctValues)}Ja.attributes[oa]=fa}let ka=0;I.forEach((Aa,Pa)=>Ja.attributes[this.fieldsIndex.get(Aa)?
Aa:`EXPR_${++ka}`]=Qa[Pa]);A.set(Y,Ja)}}}else if(ua){c.aggregateGeometries||(c.aggregateGeometries={});const {aggregateGeometries:va,outStatisticFieldName:xa}=await this._getAggregateGeometry(P,this.items);c.aggregateGeometries[xa]=va}else Z=this._getAttributeValues(C,Z,h),c.attributes[oa]=ra&&"statisticParameters"in P?this._getPercentileValue(P,Z):this._getStatisticValue(P,Z,H,C.returnDistinctValues);m.push({name:oa,alias:oa,type:"esriFieldTypeDouble"})}c=R?Array.from(A.values()):[c];this._sortFeatures(c,
r,(ea,oa)=>ea.attributes[oa]);return{fields:m,features:c}};B._getAggregateGeometry=async function(w,c){var m=await new Promise((r,R)=>d(["../../../geometry/geometryEngineJSON"],r,R));const {statisticType:h,outStatisticFieldName:H}=w,{featureAdapter:q,spatialReference:A,geometryType:C,hasZ:P,hasM:I}=this;c=c.map(r=>K.getGeometry(C,P,I,q.getGeometry(r)));const G=m.convexHull(A,c,!0)[0];w={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===h?(m=G?L.getPolygonExtent(G):L.getGeometryExtent(m.union(A,
c)),w.aggregateGeometries={...m,spatialReference:A},w.outStatisticFieldName=H||"extent"):"CentroidAggregate"===h?(m=G?F.polygonCentroid(G):F.extentCentroid(L.getGeometryExtent(m.union(A,c))),w.aggregateGeometries={x:m[0],y:m[1],spatialReference:A},w.outStatisticFieldName=H||"centroid"):"ConvexHullAggregate"===h&&(w.aggregateGeometries=G,w.outStatisticFieldName=H||"convexHull");return w};B._getStatisticValue=function(w,c,m,h){const {onStatisticField:H,statisticType:q}=w;w=null;w=m?.has(H)?m.get(H):
n.isStringField(this.fieldsIndex.get(H))?y.calculateStringStatistics({values:c,returnDistinct:h}):y.calculateStatistics({values:h?[...(new Set(c))]:c,minValue:null,maxValue:null,useSampleStdDev:!0});m&&m.set(H,w);return w["var"===q?"variance":q]};B._getPercentileValue=function(w,c){const {onStatisticField:m,statisticParameters:h,statisticType:H}=w,{value:q,orderBy:A}=h;w=this.fieldsIndex.get(m);return y.calculatePercentile(c,{value:q,orderBy:A,fieldType:w?.type,isDiscrete:"percentile_disc"===H})};
B._getAttributeValues=function(w,c,m){if(m.has(c))return m.get(c);const h=this.fieldsIndex.get(c),H=this.items.map(q=>w.getFieldValue(q,c,h));m.set(c,H);return H};B._getAttributeDataValues=function(w,c){return this.items.map(m=>w.getDataValue(m,{field:c.field,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,normalizationField:c.normalizationField,normalizationType:c.normalizationType,normalizationTotal:c.normalizationTotal}))};B._getAttributeExpressionValues=async function(w,c,m){const {arcadeUtils:h}=
await p.loadArcade();c=h.createFunction(c);m=m&&h.getViewInfo(m);return w.getExpressionValues(this.items,c,m,h)};B._calculateUniqueValues=function(w,c){const m={},h=this.items,H=h.length;for(let q=0;q<H;q++){const A=h[q],C=[];for(const I of w)C.push(I[q]);const P=C.join(",");null==m[P]?m[P]={count:1,data:C,items:[A],itemPositions:[q]}:(c||m[P].count++,m[P].items.push(A),m[P].itemPositions.push(q))}return m};B._getDataValues=async function(w){const c=new f(this.query,this.featureAdapter,this.fieldsIndex),
{valueExpression:m,field:h,normalizationField:H,normalizationType:q,normalizationTotal:A,scale:C}=w,P=m?{viewingMode:"map",scale:C,spatialReference:this.query.outSR||this.spatialReference}:null;return m?this._getAttributeExpressionValues(c,m,P):this._getAttributeDataValues(c,{field:h,field2:w.field2,field3:w.field3,fieldDelimiter:w.fieldDelimiter,normalizationField:H,normalizationType:q,normalizationTotal:A})};k._createClass(M,[{key:"size",get:function(){return this.items.length}}]);return M}();u.SnappingTypes=
void 0;(function(M){M[M.NONE=0]="NONE";M[M.EDGE=1]="EDGE";M[M.VERTEX=2]="VERTEX"})(u.SnappingTypes||(u.SnappingTypes={}));let v=function(){function M(B,w){this.coords=B;this.coordsIndex=w}k._createClass(M,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]);return M}();u.QueryEngineResult=E;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports",
"../../core/maybe","./jsonUtils"],function(d,u,k){function J({scale:q,translate:A},C){return Math.round((C-A[0])/q[0])}function F({scale:q,translate:A},C){return Math.round((A[1]-C)/q[1])}function L(q,A,C){const P=[];let I,G,r,R;for(let S=0;S<C.length;S++){const T=C[S];if(0<S){if(r=J(q,T[0]),R=F(q,T[1]),r!==I||R!==G)P.push(A(T,r-I,R-G)),I=r,G=R}else I=J(q,T[0]),G=F(q,T[1]),P.push(A(T,I,G))}return 0<P.length?P:null}function O(q,A,C,P){return L(q,C?P?H:h:P?h:m,A)}function z(q,A,C,P){const I=[];C=C?
P?H:h:P?h:m;for(P=0;P<A.length;P++){const G=L(q,C,A[P]);G&&3<=G.length&&I.push(G)}return I.length?I:null}function f(q,A,C,P){const I=[];C=C?P?H:h:P?h:m;for(P=0;P<A.length;P++){const G=L(q,C,A[P]);G&&2<=G.length&&I.push(G)}return I.length?I:null}function e({scale:q,translate:A},C){return C*q[0]+A[0]}function g({scale:q,translate:A},C){return A[1]-C*q[1]}function K(q,A,C){const P=Array(C.length);if(!C.length)return P;const [I,G]=q.scale;let r=e(q,C[0][0]);q=g(q,C[0][1]);P[0]=A(C[0],r,q);for(let R=1;R<
C.length;R++){const S=C[R];r+=S[0]*I;q-=S[1]*G;P[R]=A(S,r,q)}return P}function n(q,A,C){const P=Array(C.length);for(let I=0;I<C.length;I++)P[I]=K(q,A,C[I]);return P}function y(q,A,C,P){return K(q,C?P?H:h:P?h:m,A)}function p(q,A,C,P){return n(q,C?P?H:h:P?h:m,A)}function D(q,A,C,P){return n(q,C?P?H:h:P?h:m,A)}function t(q,A,C){let [P,I]=C[0],G=Math.min(P,A[0]),r=Math.min(I,A[1]),R=Math.max(P,A[2]);A=Math.max(I,A[3]);for(let S=1;S<C.length;S++){const [T,Z]=C[S];P+=T;I+=Z;0>T&&(G=Math.min(G,P));0<T&&
(R=Math.max(R,P));0>Z?r=Math.min(r,I):0<Z&&(A=Math.max(A,I))}q[0]=G;q[1]=r;q[2]=R;q[3]=A;return q}function E(q,A){if(!A.length)return null;q[0]=q[1]=Number.POSITIVE_INFINITY;q[2]=q[3]=Number.NEGATIVE_INFINITY;for(let C=0;C<A.length;C++)t(q,q,A[C]);return q}function v(q,A,C,P,I){A.xmin=J(q,C.xmin);A.ymin=F(q,C.ymin);A.xmax=J(q,C.xmax);A.ymax=F(q,C.ymax);A!==C&&(P&&(A.zmin=C.zmin,A.zmax=C.zmax),I&&(A.mmin=C.mmin,A.mmax=C.mmax));return A}function M(q,A,C,P,I){A.points=O(q,C.points,P,I)??[];return A}
function B(q,A,C,P,I){A.x=J(q,C.x);A.y=F(q,C.y);A!==C&&(P&&(A.z=C.z),I&&(A.m=C.m));return A}function w(q,A,C,P,I){q=z(q,C.rings,P,I);if(!q)return null;A.rings=q;return A}function c(q,A,C,P,I){q=f(q,C.paths,P,I);if(!q)return null;A.paths=q;return A}const m=(q,A,C)=>[A,C],h=(q,A,C)=>[A,C,q[2]],H=(q,A,C)=>[A,C,q[2],q[3]];d.equals=function(q,A){if(q===A||null==q&&null==A)return!0;if(null==q||null==A)return!1;let C,P,I,G;q&&"upperLeft"===q.originPosition?(C=q.translate[0],P=q.translate[1],q=q.scale[0]):
(C=u.isSome(q.extent)?q.extent.xmin:0,P=u.isSome(q.extent)?q.extent.ymax:0,q=q.tolerance);A&&"upperLeft"===A.originPosition?(I=A.translate[0],G=A.translate[1],A=A.scale[0]):(I=u.isSome(A.extent)?A.extent.xmin:0,G=u.isSome(A.extent)?A.extent.ymax:0,A=A.tolerance);return C===I&&P===G&&q===A};d.getQuantizedBoundsCoordsArray=t;d.getQuantizedBoundsCoordsArrayArray=E;d.getQuantizedBoundsPaths=function(q){return E([0,0,0,0],q)};d.getQuantizedBoundsPoints=function(q){const A=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return t(A,A,q)};d.getQuantizedBoundsRings=function(q){return E([0,0,0,0],q)};d.quantizeBounds=function(q,A,C){A[0]=J(q,C[0]);A[3]=F(q,C[1]);A[2]=J(q,C[2]);A[1]=F(q,C[3]);return A};d.quantizeExtent=v;d.quantizeGeometry=function(q,A){return q&&A?k.isPoint(A)?B(q,{},A,!1,!1):k.isPolyline(A)?c(q,{},A,!1,!1):k.isPolygon(A)?w(q,{},A,!1,!1):k.isMultipoint(A)?M(q,{},A,!1,!1):k.isExtent(A)?v(q,{},A,!1,!1):null:null};d.quantizeMultipoint=M;d.quantizePaths=
f;d.quantizePoint=B;d.quantizePoints=O;d.quantizePolygon=w;d.quantizePolyline=c;d.quantizeRings=z;d.quantizeX=J;d.quantizeY=F;d.toQuantizationTransform=function(q){return q?{originPosition:"upper-left"===q.originPosition?"upperLeft":"lower-left"===q.originPosition?"lowerLeft":q.originPosition,scale:q.tolerance?[q.tolerance,q.tolerance]:[1,1],translate:u.isSome(q.extent)?[q.extent.xmin,q.extent.ymax]:[0,0]}:null};d.unquantizeBounds=function(q,A,C){return C?(A[0]=e(q,C[0]),A[1]=g(q,C[3]),A[2]=e(q,C[2]),
A[3]=g(q,C[1]),A):[e(q,A[0]),g(q,A[3]),e(q,A[2]),g(q,A[1])]};d.unquantizeCoordsArray=K;d.unquantizeCoordsArrayArray=n;d.unquantizeExtent=function(q,A,C,P,I){A.xmin=e(q,C.xmin);A.ymin=g(q,C.ymin);A.xmax=e(q,C.xmax);A.ymax=g(q,C.ymax);A!==C&&(P&&(A.zmin=C.zmin,A.zmax=C.zmax),I&&(A.mmin=C.mmin,A.mmax=C.mmax));return A};d.unquantizeMultipoint=function(q,A,C,P,I){u.isSome(C)&&(A.points=y(q,C.points,P,I));return A};d.unquantizePaths=p;d.unquantizePoint=function(q,A,C,P,I){if(u.isNone(C))return A;A.x=e(q,
C.x);A.y=g(q,C.y);A!==C&&(P&&(A.z=C.z),I&&(A.m=C.m));return A};d.unquantizePoints=y;d.unquantizePolygon=function(q,A,C,P,I){u.isSome(C)&&(A.rings=D(q,C.rings,P,I));return A};d.unquantizePolyline=function(q,A,C,P,I){u.isSome(C)&&(A.paths=p(q,C.paths,P,I));return A};d.unquantizeRings=D;d.unquantizeX=e;d.unquantizeY=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe",
"./attributeSupport","../../../statistics/utils"],function(d,u,k,J){return function(){function F(O,z,f){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=O.returnDistinctValues??!1;this.fieldsIndex=f;this.featureAdapter=z;if((z=O.outFields)&&!z.includes("*")){this.outFields=z;O=0;for(const g of z){var e=k.getExpressionFromFieldName(g);e=(z=this.fieldsIndex.get(e))?null:k.getWhereClause(e,f);z=z?z.name:k.getAliasFromFieldName(g)||`FIELD_EXP_${O++}`;this._fieldDataCache.set(g,
{alias:z,clause:e})}}}var L=F.prototype;L.countDistinctValues=function(O){if(!this.returnDistinctValues)return O.length;O.forEach(z=>this.getAttributes(z));return this._returnDistinctMap.size};L.getAttributes=function(O){O=this._processAttributesForOutFields(O);return this._processAttributesForDistinctValues(O)};L.getFieldValue=function(O,z,f){const e=f?f.name:z;let g=null;this._fieldDataCache.has(e)?g=this._fieldDataCache.get(e)?.clause:f||(g=k.getWhereClause(z,this.fieldsIndex),this._fieldDataCache.set(e,
{alias:e,clause:g}));return f?this.featureAdapter.getAttribute(O,e):g?.calculateValue(O,this.featureAdapter)};L.getDataValue=function(O,z){const f=z.normalizationType,e=z.normalizationTotal;let g=z.field&&this.getFieldValue(O,z.field,this.fieldsIndex.get(z.field));z.field2&&(g=`${J.processNullValue(g)}${z.fieldDelimiter}${J.processNullValue(this.getFieldValue(O,z.field2,this.fieldsIndex.get(z.field2)))}`,z.field3&&(g=`${g}${z.fieldDelimiter}${J.processNullValue(this.getFieldValue(O,z.field3,this.fieldsIndex.get(z.field3)))}`));
f&&Number.isFinite(g)&&(O="field"===f&&z.normalizationField?this.getFieldValue(O,z.normalizationField,this.fieldsIndex.get(z.normalizationField)):null,g=J.getNormalizedValue(g,f,O,e));return g};L.getExpressionValue=function(O,z,f,e){O={attributes:this.featureAdapter.getAttributes(O),layer:{fields:this.fieldsIndex.fields}};f=e.createExecContext(O,f);return e.executeFunction(z,f)};L.getExpressionValues=function(O,z,f,e){const g={fields:this.fieldsIndex.fields};return O.map(K=>{K={attributes:this.featureAdapter.getAttributes(K),
layer:g};K=e.createExecContext(K,f);return e.executeFunction(z,K)})};L.validateItem=function(O,z){this._fieldDataCache.has(z)||this._fieldDataCache.set(z,{alias:z,clause:k.getWhereClause(z,this.fieldsIndex)});return this._fieldDataCache.get(z)?.clause?.testFeature(O,this.featureAdapter)??!1};L.validateItems=function(O,z){this._fieldDataCache.has(z)||this._fieldDataCache.set(z,{alias:z,clause:k.getWhereClause(z,this.fieldsIndex)});return this._fieldDataCache.get(z)?.clause?.testSet(O,this.featureAdapter)??
!1};L._processAttributesForOutFields=function(O){const z=this.outFields;if(!z||!z.length)return this.featureAdapter.getAttributes(O);const f={};for(const e of z){const {alias:g,clause:K}=this._fieldDataCache.get(e);f[g]=K?K.calculateValue(O,this.featureAdapter):this.featureAdapter.getAttribute(O,g)}return f};L._processAttributesForDistinctValues=function(O){if(u.isNone(O)||!this.returnDistinctValues)return O;var z=this.outFields,f=[];if(z)for(const g of z){var {alias:e}=this._fieldDataCache.get(g);
f.push(O[e])}else for(e in O)f.push(O[e]);z=`${(z||["*"]).join(",")}=${f.join(",")}`;f=this._returnDistinctMap.get(z)||0;this._returnDistinctMap.set(z,++f);return 1<f?null:O};return d._createClass(F)}()})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],function(d,u,k){function J(f,e){return f?O.get(f,e):null}function F(f,e,g,K=!0){const n=[];for(const y of e)if("*"!==y&&!f.has(y))if(K){e=L(y);try{const p=J(e,f);
if(!p)throw new u("feature-store:unsupported-query","invalid SQL expression",{where:e});if(!p.isStandardized)throw new u("feature-store:unsupported-query","expression is not standard",{clause:p});F(f,p.fieldNames,"expression contains missing fields")}catch(p){if((e=p&&p.details)&&(e.clause||e.where))throw p;e&&e.missingFields?n.push(...e.missingFields):n.push(y)}}else n.push(y);if(n.length)throw new u("feature-store:unsupported-query",g,{missingFields:n});}function L(f){return f.split(" as ")[0]}
const O=new k.WhereClauseCache(50,500),z=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));d.getAliasFromFieldName=function(f){return f.split(" as ")[1]};d.getExpressionFromFieldName=L;d.getWhereClause=J;d.hasInvalidFieldType=function(f,e){return(f=e.get(f))?!z.has(f.type):!1};d.validateFields=F;d.validateHaving=function(f,e,g){if(!e)return!0;const K=O.get(e,f);if(!K)throw new u("feature-store:unsupported-query",
"invalid SQL expression",{having:e});if(!K.isAggregate)throw new u("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:e});F(f,K.fieldNames,"having contains missing fields");if(!K.getExpressions().every(n=>{const {aggregateType:y,field:p}=n,D=f.get(p)?.name;return g.some(t=>{const {onStatisticField:E,statisticType:v}=t;return f.get(E)?.name===D&&v.toLowerCase().trim()===y})}))throw new u("feature-store:unsupported-query","expressions in having should also exist in outStatistics",
{having:e});return!0};d.validateWhere=function(f,e){if(!e)return!0;const g=O.get(e,f);if(!g)throw new u("feature-store:unsupported-query","invalid SQL expression",{where:e});if(!g.isStandardized)throw new u("feature-store:unsupported-query","where clause is not standard",{where:e});F(f,g.fieldNames,"where clause contains missing fields");return!0};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers",
"../ItemCache","./WhereClause"],function(d,u,k,J){let F=function(){function L(O,z){this._cache=new k(O);this._invalidCache=new k(z)}L.prototype.get=function(O,z){const f=`${z.uid}:${O}`,e=this._cache.get(f);if(e)return e;if(void 0!==this._invalidCache.get(f))return null;try{const g=J.WhereClause.create(O,z);this._cache.put(f,g);return g}catch{return this._invalidCache.put(f,null),null}};return u._createClass(L)}();d.WhereClauseCache=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/core/ItemCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(d,u){return function(){function k(F,L){this._storage=new u.MemCacheStorage;this._storage.maxSize=F;L&&this._storage.registerRemoveFunc("",L)}var J=k.prototype;J.put=function(F,L){this._storage.put(F,L,1,1)};J.pop=function(F){return this._storage.pop(F)};J.get=function(F){return this._storage.get(F)};J.clear=function(){this._storage.clearAll()};J.destroy=function(){this._storage.destroy()};return d._createClass(k)}()})},
"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(d,u,k,J,F,L){function O(I,G){I+="";return I.length>=G?I:Array(G-I.length+1).join("0")+I}function z(I,G,r="0",R="0",S="0",T="0",Z="",da="0",Y="0"){return"+"===Z||"-"===Z?(I=`${O(parseInt(I,10),4)}-${O(parseInt(G,10),2)}-${O(parseInt(r,10),2)}`,G="",10>parseFloat(T)&&(G="0"),R=`${O(parseInt(R,10),2)}:${O(parseInt(S,10),
2)}:${G+parseFloat(T).toString()}`,Z=`${Z}${O(parseInt(da,10),2)}:${O(parseInt(Y,10),2)}`,new Date(I+"T"+R+Z)):new Date(parseInt(I,10),parseInt(G,10)-1,parseInt(r,10),parseInt(R,10),parseInt(S,10),parseFloat(T))}function f(I){let G=w.exec(I);if(null!==G){const [,r,R,S,T,Z,da]=G;return z(r,R,S,T,Z,da)}G=c.exec(I);if(null!==G){const [,r,R,S,T,Z,da,Y,fa,ea]=G;return z(r,R,S,T,Z,da,Y,fa,ea)}G=m.exec(I);if(null!==G){const [,r,R,S,T,Z,da,Y,fa]=G;return z(r,R,S,T,Z,"0",da,Y,fa)}G=h.exec(I);if(null!==G){const [,
r,R,S,T,Z]=G;return z(r,R,S,T,Z)}G=B.exec(I);if(null!==G){const [,r,R,S]=G;return z(r,R,S)}throw Error("SQL Invalid Timestamp");}function e(I){const G=B.exec(I);if(null===G)try{return f(I)}catch{throw Error("SQL Invalid Date");}const [,r,R,S]=G;return new Date(parseInt(r,10),parseInt(R,10)-1,parseInt(S,10))}function g(I){return Array.isArray(I)?I:[I]}function K(I){return null!==I?!0!==I:null}function n(I,G){return null!=I&&null!=G?!0===I&&!0===G:!1===I||!1===G?!1:null}function y(I,G){return null!=
I&&null!=G?!0===I||!0===G:!0===I||!0===G?!0:null}function p(I,G){if(null==I)return null;let r=!1;for(const R of G)if(null==R)r=null;else if(I===R){r=!0;break}return r}function D(I,G,r){if(null==I)return null;let R="",S=C.Normal;for(let T=0;T<G.length;T++){const Z=G.charAt(T);switch(S){case C.Normal:Z===r?S=C.Escaped:R="-[]/{}()*+?.\\^$|".includes(Z)?R+("\\"+Z):"%"===Z?R+".*":"_"===Z?R+".":R+Z;break;case C.Escaped:R="-[]/{}()*+?.\\^$|".includes(Z)?R+("\\"+Z):R+Z,S=C.Normal}}return(new RegExp("^"+R+
"$","m")).test(I)}function t(I){return I instanceof Date?I.valueOf():I}function E(I,G,r){if(null==G||null==r)return null;G=t(G);r=t(r);switch(I){case "\x3c\x3e":return G!==r;case "\x3d":return G===r;case "\x3e":return G>r;case "\x3c":return G<r;case "\x3e\x3d":return G>=r;case "\x3c\x3d":return G<=r}}function v(I,G,r){if("||"===I)return F.evaluateFunction("concat",[G,r]);if(G instanceof F.SqlInterval)if(r instanceof Date)switch(I){case "+":return new Date(G.valueInMilliseconds()+r.getTime());case "-":return G.valueInMilliseconds()-
r.getTime();case "*":return G.valueInMilliseconds()*r.getTime();case "/":return G.valueInMilliseconds()/r.getTime()}else if(r instanceof F.SqlInterval)switch(I){case "+":return F.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()+r.valueInMilliseconds());case "-":return F.SqlInterval.createFromMilliseconds(G.valueInMilliseconds()-r.valueInMilliseconds());case "*":return G.valueInMilliseconds()*r.valueInMilliseconds();case "/":return G.valueInMilliseconds()/r.valueInMilliseconds()}else G=G.valueInMilliseconds();
else if(r instanceof F.SqlInterval)if(G instanceof Date)switch(I){case "+":return new Date(r.valueInMilliseconds()+G.getTime());case "-":return new Date(G.getTime()-r.valueInMilliseconds());case "*":return G.getTime()*r.valueInMilliseconds();case "/":return G.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(G instanceof Date&&"number"===typeof r)switch(r*=864E5,G=G.getTime(),I){case "+":return new Date(G+r);case "-":return new Date(G-r);case "*":return new Date(G*r);case "/":return new Date(G/
r)}else if(r instanceof Date&&"number"===typeof G)switch(G*=864E5,r=r.getTime(),I){case "+":return new Date(G+r);case "-":return new Date(G-r);case "*":return new Date(G*r);case "/":return new Date(G/r)}switch(I){case "+":return G+r;case "-":return G-r;case "*":return G*r;case "/":return G/r}}function M(I,G,r,R){I=R.getAttribute(I,G);return null!=I&&1===r[G]?new Date(I):I}const B=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,c=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,h=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,H=new Set(["current_timestamp","current_date","current_time"]);let q=function(){function I(){}I.makeBool=function(G){return!0===G};I.featureValue=function(G,r,R,S){return M(G,r,R,S)};I.equalsNull=function(G){return null===G};I.applyLike=function(G,r,R){return D(G,r,R)};I.ensureArray=function(G){return g(G)};I.applyIn=function(G,r){return p(G,r)};I.currentDate=function(){const G=
new Date;G.setHours(0,0,0,0);return G};I.makeSqlInterval=function(G,r,R){return F.SqlInterval.createFromValueAndQualifer(G,r,R)};I.convertInterval=function(G){return G instanceof F.SqlInterval?G.valueInMilliseconds():G};I.currentTimestamp=function(){return new Date};I.compare=function(G,r,R){return E(G,r,R)};I.calculate=function(G,r,R){return v(G,r,R)};I.makeComparable=function(G){return t(G)};I.evaluateFunction=function(G,r){return F.evaluateFunction(G,r)};I.lookup=function(G,r){G=r[G];return void 0===
G?null:G};I.between=function(G,r){return null==G||null==r[0]||null==r[1]?null:G>=r[0]&&G<=r[1]};I.notbetween=function(G,r){return null==G||null==r[0]||null==r[1]?null:G<r[0]||G>r[1]};I.ternaryNot=function(G){return K(G)};I.ternaryAnd=function(G,r){return n(G,r)};I.ternaryOr=function(G,r){return y(G,r)};return u._createClass(I)}(),A=function(){function I(r,R){this.fieldsIndex=R;this._datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=L.WhereGrammar.parse(r);const {isStandardized:S,
isAggregate:T,referencedFieldNames:Z}=this._extractExpressionInfo(R);this._referencedFieldNames=Z;this.isStandardized=S;this.isAggregate=T}I.create=function(r,R){return new I(r,R)};var G=I.prototype;G.testSet=function(r,R=P){const S={};for(const T of this.fieldNames)S[T]=r.map(Z=>R.getAttribute(Z,T));return!!this._evaluateNode(this.parseTree,{attributes:S},P)};G.calculateValue=function(r,R=P){r=this._evaluateNode(this.parseTree,r,R);return r instanceof F.SqlInterval?r.valueInMilliseconds()/864E5:
r};G.calculateValueCompiled=function(r,R=P){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(r,this.parameters,R,this._datefields);if(k("esri-csp-restrictions"))return this.calculateValue(r,R);this._compileMe();return this.parseTree._compiledVersion(r,this.parameters,R,this._datefields)};G.testFeature=function(r,R=P){return!!this._evaluateNode(this.parseTree,r,R)};G.testFeatureCompiled=function(r,R=P){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(r,
this.parameters,R,this._datefields);if(k("esri-csp-restrictions"))return this.testFeature(r,R);this._compileMe();return!!this.parseTree._compiledVersion(r,this.parameters,R,this._datefields)};G.getFunctions=function(){const r=new Set;this._visitAll(this.parseTree,R=>{"function"===R.type&&r.add(R.name.toLowerCase())});return Array.from(r)};G.getExpressions=function(){const r=new Map;this._visitAll(this.parseTree,R=>{if("function"===R.type){const S=R.name.toLowerCase();R=R.args.value[0];if("column-reference"===
R.type){R=R.column;const T=`${S}-${R}`;r.has(T)||r.set(T,{aggregateType:S,field:R})}}});return[...r.values()]};G.getVariables=function(){const r=new Set;this._visitAll(this.parseTree,R=>{"parameter"===R.type&&r.add(R.value.toLowerCase())});return Array.from(r)};G._compileMe=function(){const r="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",r)).bind(q)};G._extractExpressionInfo=
function(r){const R=[],S=new Set;let T=!0,Z=!0;this._visitAll(this.parseTree,da=>{switch(da.type){case "column-reference":const Y=r?.get(da.column);let fa,ea;Y?fa=ea=Y.name??"":(ea=da.column,fa=ea.toLowerCase());Y&&Y.name&&("date"===Y.type||"esriFieldTypeDate"===Y.type)&&(this._datefields[Y.name]=1);S.has(fa)||(S.add(fa),R.push(ea));da.column=ea;break;case "function":const {name:oa,args:pa}=da;da=pa.value.length;T&&(T=F.isStandardized(oa,da));Z&&(Z=J.isAggregate(oa,da))}});return{referencedFieldNames:Array.from(R),
isStandardized:T,isAggregate:Z}};G._visitAll=function(r,R){if(null!=r)switch(R(r),r.type){case "when-clause":this._visitAll(r.operand,R);this._visitAll(r.value,R);break;case "case-expression":for(const S of r.clauses)this._visitAll(S,R);"simple"===r.format&&this._visitAll(r.operand,R);null!==r.else&&this._visitAll(r.else,R);break;case "expression-list":for(const S of r.value)this._visitAll(S,R);break;case "unary-expression":this._visitAll(r.expr,R);break;case "binary-expression":this._visitAll(r.left,
R);this._visitAll(r.right,R);break;case "function":this._visitAll(r.args,R)}};G.evaluateNodeToJavaScript=function(r){switch(r.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(r.value)+", "+JSON.stringify(r.qualifier)+","+JSON.stringify(r.op)+")";case "case-expression":var R="";if("simple"===r.format){var S="this.makeComparable("+this.evaluateNodeToJavaScript(r.operand)+")";R="( ";for(let T=0;T<r.clauses.length;T++)R+=" ("+S+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(r.clauses[T].operand)+
")) ? ("+this.evaluateNodeToJavaScript(r.clauses[T].value)+") : "}else for(R="( ",S=0;S<r.clauses.length;S++)R+=" this.makeBool("+this.evaluateNodeToJavaScript(r.clauses[S].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(r.clauses[S].value)+") : ";R=null!==r.else?R+this.evaluateNodeToJavaScript(r.else):R+"null";return R+" )";case "parameter":return"this.lookup("+JSON.stringify(r.value.toLowerCase())+",lookups)";case "expression-list":R="[";for(S of r.value)"["!==R&&(R+=","),R+=this.evaluateNodeToJavaScript(S);
return R+"]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(r.expr)+")";case "binary-expression":switch(r.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+" )";case "IS":if("null"!==r.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(r.left)+
")";case "ISNOT":if("null"!==r.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(r.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(r.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(r.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(r.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(r.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(r.left)+
","+this.evaluateNodeToJavaScript(r.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+","+JSON.stringify(r.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+","+JSON.stringify(r.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+
JSON.stringify(r.operator)+","+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+")";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(r.operator)+","+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+")"}throw Error("Not Supported Operator "+r.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(r.value);case "date":return"(new Date("+e(r.value).getTime().toString()+
"))";case "timestamp":return"(new Date("+f(r.value).getTime().toString()+"))";case "current-time":return"date"===r.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(r.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(r.name)+","+this.evaluateNodeToJavaScript(r.args)+")"}throw Error("Unsupported sql syntax "+r.type);};G._evaluateNode=function(r,R,S){switch(r.type){case "interval":return R=
this._evaluateNode(r.value,R,S),F.SqlInterval.createFromValueAndQualifer(R,r.qualifier,r.op);case "case-expression":if("simple"===r.format){var T=t(this._evaluateNode(r.operand,R,S));for(var Z=0;Z<r.clauses.length;Z++)if(T===t(this._evaluateNode(r.clauses[Z].operand,R,S)))return this._evaluateNode(r.clauses[Z].value,R,S)}else for(T=0;T<r.clauses.length;T++)if(!0===this._evaluateNode(r.clauses[T].operand,R,S))return this._evaluateNode(r.clauses[T].value,R,S);return null!==r.else?this._evaluateNode(r.else,
R,S):null;case "parameter":return this.parameters[r.value.toLowerCase()];case "expression-list":T=[];for(Z of r.value)T.push(this._evaluateNode(Z,R,S));return T;case "unary-expression":return K(this._evaluateNode(r.expr,R,S));case "binary-expression":switch(r.operator){case "AND":return n(this._evaluateNode(r.left,R,S),this._evaluateNode(r.right,R,S));case "OR":return y(this._evaluateNode(r.left,R,S),this._evaluateNode(r.right,R,S));case "IS":if("null"!==r.right.type)throw Error("Unsupported RHS for IS");
return null===this._evaluateNode(r.left,R,S);case "ISNOT":if("null"!==r.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(r.left,R,S);case "IN":return T=g(this._evaluateNode(r.right,R,S)),p(this._evaluateNode(r.left,R,S),T);case "NOT IN":return T=g(this._evaluateNode(r.right,R,S)),K(p(this._evaluateNode(r.left,R,S),T));case "BETWEEN":return T=this._evaluateNode(r.left,R,S),r=this._evaluateNode(r.right,R,S),null==T||null==r[0]||null==r[1]?null:T>=t(r[0])&&T<=t(r[1]);
case "NOTBETWEEN":return T=this._evaluateNode(r.left,R,S),r=this._evaluateNode(r.right,R,S),null==T||null==r[0]||null==r[1]?null:T<t(r[0])||T>t(r[1]);case "LIKE":return D(this._evaluateNode(r.left,R,S),this._evaluateNode(r.right,R,S),r.escape);case "NOT LIKE":return K(D(this._evaluateNode(r.left,R,S),this._evaluateNode(r.right,R,S),r.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return E(r.operator,this._evaluateNode(r.left,R,S),this._evaluateNode(r.right,
R,S));case "-":case "+":case "*":case "/":case "||":return v(r.operator,this._evaluateNode(r.left,R,S),this._evaluateNode(r.right,R,S))}case "null":case "boolean":case "string":case "number":return r.value;case "date":return e(r.value);case "timestamp":return f(r.value);case "current-time":return R=new Date,"date"===r.mode&&R.setHours(0,0,0,0),R;case "column-reference":return M(R,r.column,this._datefields,S);case "data-type":return r.value;case "function":return R=this._evaluateNode(r.args,R,S),this.isAggregate?
J.aggregateFunction(r.name,R):F.evaluateFunction(r.name,R)}throw Error("Unsupported sql syntax "+r.type);};u._createClass(I,[{key:"fieldNames",get:function(){return this._referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,r=>{"current-time"===r.type?this._hasDateFunctions=!0:"function"===r.type&&(this._hasDateFunctions=this._hasDateFunctions||H.has(r.name.toLowerCase()))});
return this._hasDateFunctions}}]);return I}();var C;(function(I){I[I.Normal=0]="Normal";I[I.Escaped=1]="Escaped"})(C||(C={}));const P={getAttribute(I,G){return(I&&"object"===typeof I.attributes?I.attributes:I)[G]}};d.WhereClause=A;d.defaultAttributeAdapter=P;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(d){function u(F){let L=0;for(let O=0;O<F.length;O++)L+=F[O];return L/F.length}function k(F){const L=u(F),
O=F.length;let z=0;for(const f of F)z+=(f-L)**2;return 1<O?z/(O-1):0}const J={min:{minParams:1,maxParams:1,evaluate:F=>null==F[0]?null:Math.min.apply(Math,F[0])},max:{minParams:1,maxParams:1,evaluate:F=>null==F[0]?null:Math.max.apply(Math,F[0])},avg:{minParams:1,maxParams:1,evaluate:F=>null==F[0]?null:u(F[0])},sum:{minParams:1,maxParams:1,evaluate:F=>{if(null==F[0])F=null;else{F=F[0];let L=0;for(let O=0;O<F.length;O++)L+=F[O];F=L}return F}},stddev:{minParams:1,maxParams:1,evaluate:F=>null==F[0]?null:
Math.sqrt(k(F[0]))},count:{minParams:1,maxParams:1,evaluate:F=>null==F[0]?null:F[0].length},var:{minParams:1,maxParams:1,evaluate:F=>null==F[0]?null:k(F[0])}};d.aggregateFunction=function(F,L){const O=J[F.toLowerCase()];if(null==O)throw Error("Function Not Recognised");if(L.length<O.minParams||L.length>O.maxParams)throw Error(`Invalid Parameter count for call to ${F.toUpperCase()}`);return O.evaluate(L)};d.isAggregate=function(F,L){F=J[F.toLowerCase()];return null!=F&&L>=F.minParams&&L<=F.maxParams};
Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../arcade/featureset/support/errorsupport","../string","../../chunks/datetime"],function(d,u,k,J,F){function L(e){e=new Date(e.getTime());e.setHours(0,0,0,0);return e}function O(e,g){if(e instanceof Date)return g?L(e):e;if("string"===typeof e||e instanceof String)if(e=F.DateTime.fromSQL(e),e.isValid)return g?L(e.toJSDate()):
e.toJSDate();throw new k.SqlError(k.SqlErrorCodes.CannotCastValue);}let z=function(){function e(){this.op="+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}e._fixDefaults=function(g){if(null!==g.precision||null!==g.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};e._parseSecondsComponent=function(g,K){K.includes(".")?(K=K.split("."),g.second=parseFloat(K[0]),g.millis=parseInt(K[1],10)):g.second=parseFloat(K)};e.createFromMilliseconds=
function(g){const K=new e;K.second=g/1E3;return K};e.createFromValueAndQualifer=function(g,K,n){let y=null;const p=new e;p.op="-"===n?"-":"+";if("interval-period"===K.type){e._fixDefaults(K);n=RegExp("^[0-9]{1,}$");if("year"===K.period||"month"===K.period)throw Error("Year-Month Intervals not supported");if("second"===K.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(g))e._parseSecondsComponent(p,g);else throw Error("Illegal Interval");else if(n.test(g))p[K.period]=parseFloat(g);else throw Error("Illegal Interval");
}else{e._fixDefaults(K.start);e._fixDefaults(K.end);if("year"===K.start.period||"month"===K.start.period)throw Error("Year-Month Intervals not supported");if("year"===K.end.period||"month"===K.end.period)throw Error("Year-Month Intervals not supported");switch(K.start.period){case "day":switch(K.end.period){case "hour":y=RegExp("^[0-9]{1,} [0-9]{1,}$");if(y.test(g))p[K.start.period]=parseFloat(g.split(" ")[0]),p[K.end.period]=parseFloat(g.split(" ")[1]);else throw Error("Illegal Interval");break;
case "minute":y=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(y.test(g))p[K.start.period]=parseFloat(g.split(" ")[0]),g=g.split(" ")[1].split(":"),p.hour=parseFloat(g[0]),p.minute=parseFloat(g[1]);else throw Error("Illegal Interval");break;case "second":y=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(y.test(g))p[K.start.period]=parseFloat(g.split(" ")[0]),g=g.split(" ")[1].split(":"),p.hour=parseFloat(g[0]),p.minute=parseFloat(g[1]),e._parseSecondsComponent(p,g[2]);
else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(K.end.period){case "minute":y=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(y.test(g))p.hour=parseFloat(g.split(":")[0]),p.minute=parseFloat(g.split(":")[1]);else throw Error("Illegal Interval");break;case "second":y=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(y.test(g))g=g.split(":"),p.hour=parseFloat(g[0]),p.minute=parseFloat(g[1]),e._parseSecondsComponent(p,g[2]);else throw Error("Illegal Interval");
break;default:throw Error("Invalid Interval.");}break;case "minute":switch(K.end.period){case "second":y=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(y.test(g))g=g.split(":"),p.minute=parseFloat(g[0]),e._parseSecondsComponent(p,g[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return p};e.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+
36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return u._createClass(e)}();const f={extract:{minParams:2,maxParams:2,evaluate:([e,g])=>{if(null==g)return null;if(g instanceof Date)switch(e.toUpperCase()){case "SECOND":return g.getSeconds();case "MINUTE":return g.getMinutes();case "HOUR":return g.getHours();case "DAY":return g.getDate();case "MONTH":return g.getMonth()+1;case "YEAR":return g.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,
maxParams:3,evaluate:e=>{if(2===e.length){const [g,K]=e;return null==g||null==K?null:g.toString().substring(K-1)}if(3===e.length){const [g,K,n]=e;return null==g||null==K||null==n?null:0>=n?"":g.toString().substring(K-1,K+n-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,g])=>null==e||null==g?null:g.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{var g=3===e.length,K=g?e[1]:" ";g=g?e[2]:e[1];if(null==K||null==g)return null;K=`(${J.escapeRegExpString(K)})`;switch(e[0]){case "BOTH":return g.replace(new RegExp(`^${K}*|${K}*$`,
"g"),"");case "LEADING":return g.replace(new RegExp(`^${K}*`,"g"),"");case "TRAILING":return g.replace(new RegExp(`${K}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,
maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},
sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:0<e[0]?1:0>e[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{const g=e[0];e=2===e.length?10**e[1]:1;return null==g?null:Math.round(g*e)/e}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))},
char_length:{minParams:1,maxParams:1,evaluate:e=>"string"===typeof e[0]||e[0]instanceof String?e[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:e=>{let g="";for(let K=0;K<e.length;K++){if(null==e[K])return null;g+=e[K].toString()}return g}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:e=>{for(const g of e)if(null!==
g)return g;return null}},cosh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cosh(e[0])},sinh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sinh(e[0])},tanh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tanh(e[0])},nullif:{minParams:2,maxParams:2,evaluate:e=>{const g=e[0];e=e[1];return(g instanceof Date?g.valueOf():g)===(e instanceof Date?e.valueOf():e)?null:g}},cast:{minParams:2,maxParams:2,evaluate:e=>{var g=e[0];e=e[1];if(null===g)return null;switch(e.type){case "integer":g=
parseInt(g,10);if(isNaN(g))throw new k.SqlError(k.SqlErrorCodes.CannotCastValue);return g;case "smallint":g=parseInt(g,10);if(isNaN(g))throw new k.SqlError(k.SqlErrorCodes.CannotCastValue);if(32767<g||-32767>g)throw new k.SqlError(k.SqlErrorCodes.CannotCastValue);return g;case "float":case "real":g=parseFloat(g);if(isNaN(g))throw new k.SqlError(k.SqlErrorCodes.CannotCastValue);return g;case "date":return O(g,!0);case "timestamp":return O(g,!1);case "varchar":g=g.toString();if(g.length>e.size)throw new k.SqlError(k.SqlErrorCodes.CannotCastValue);
return g;default:throw new k.SqlError(k.SqlErrorCodes.InvalidDataType);}}}};d.SqlInterval=z;d.evaluateFunction=function(e,g){const K=f[e.toLowerCase()];if(null==K)throw Error("Function Not Recognised");if(g.length<K.minParams||g.length>K.maxParams)throw Error(`Invalid Parameter count for call to ${e.toUpperCase()}`);return K.evaluate(g)};d.isStandardized=function(e,g){e=f[e.toLowerCase()];return null!=e&&g>=e.minParams&&g<=e.maxParams};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../executionError"],function(d,u,k){d.SqlErrorCodes=void 0;(function(z){z.InvalidFunctionParameters="InvalidFunctionParameters";z.UnsupportedSqlFunction="UnsupportedSqlFunction";z.UnsupportedOperator="UnsupportedOperator";z.UnsupportedSyntax="UnsupportedSyntax";z.UnsupportedIsRhs="UnsupportedIsRhs";z.UnsupportedIsLhs="UnsupportedIsLhs";z.InvalidDataType="InvalidDataType";z.CannotCastValue=
"CannotCastValue";z.MissingStatisticParameters="MissingStatisticParameters"})(d.SqlErrorCodes||(d.SqlErrorCodes={}));const J={[d.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[d.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",
[d.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[d.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[d.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};let F=function(z){function f(g,K){g=e.call(this,k.doSubstitutions(J[g],K));g.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(u._assertThisInitialized(g),
f);return g}u._inherits(f,z);var e=u._createSuper(f);return u._createClass(f)}(u._wrapNativeSuper(Error));d.FeatureSetErrorCodes=void 0;(function(z){z.NeverReach="NeverReach";z.NotImplemented="NotImplemented";z.Cancelled="Cancelled";z.InvalidStatResponse="InvalidStatResponse";z.InvalidRequest="InvalidRequest";z.RequestFailed="RequestFailed";z.MissingFeatures="MissingFeatures";z.AggregationFieldNotFound="AggregationFieldNotFound";z.DataElementsNotFound="DataElementsNotFound"})(d.FeatureSetErrorCodes||
(d.FeatureSetErrorCodes={}));const L={[d.FeatureSetErrorCodes.Cancelled]:"Cancelled",[d.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[d.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[d.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[d.FeatureSetErrorCodes.MissingFeatures]:"Missing features",[d.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[d.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",
[d.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[d.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};let O=function(z){function f(g,K){g=e.call(this,k.doSubstitutions(L[g],K));g.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(u._assertThisInitialized(g),f);return g}u._inherits(f,z);var e=u._createSuper(f);return u._createClass(f)}(u._wrapNativeSuper(Error));d.FeatureSetError=O;d.FeatureSetErrorMessages=L;
d.SqlError=F;d.SqlErrorMessages=J;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/executionError":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],function(d,u){function k(n){return n&&n.loc?`Line : ${n.loc.start?.line}, ${n.loc.start?.column}: `:""}function J(n,y){try{if(!y)return n;for(const p in y){let D=y[p];D||(D="");n=n.replace("{"+p+"}",y[p])}}catch(p){}return n}d.ExecutionErrorCodes=void 0;(function(n){n.AsyncNotEnabled="AsyncNotEnabled";n.ModulesNotSupported=
"ModulesNotSupported";n.CircularModules="CircularModules";n.NeverReach="NeverReach";n.UnsupportedHashType="UnsupportedHashType";n.InvalidParameter="InvalidParameter";n.UnexpectedToken="UnexpectedToken";n.Unrecognised="Unrecognised";n.UnrecognisedType="UnrecognisedType";n.MaximumCallDepth="MaximumCallDepth";n.BooleanConditionRequired="BooleanConditionRequired";n.TypeNotAllowedInFeature="TypeNotAllowedInFeature";n.KeyMustBeString="KeyMustBeString";n.WrongNumberOfParameters="WrongNumberOfParameters";
n.CallNonFunction="CallNonFunction";n.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral";n.NoFunctionInDictionary="NoFunctionInDictionary";n.NoFunctionInArray="NoFunctionInArray";n.AssignModuleFunction="AssignModuleFunction";n.LogicExpressionOrAnd="LogicExpressionOrAnd";n.LogicalExpressionOnlyBoolean="LogicalExpressionOnlyBoolean";n.FuncionNotFound="FunctionNotFound";n.InvalidMemberAccessKey="InvalidMemberAccessKey";n.UnsupportedUnaryOperator="UnsupportUnaryOperator";n.InvalidIdentifier="InvalidIdentifier";
n.MemberOfNull="MemberOfNull";n.UnsupportedOperator="UnsupportedOperator";n.Cancelled="Cancelled";n.ModuleAccessorMustBeString="ModuleAccessorMustBeString";n.ModuleExportNotFound="ModuleExportNotFound";n.Immutable="Immutable";n.OutOfBounds="OutOfBounds";n.IllegalResult="IllegalResult";n.FieldNotFound="FieldNotFound";n.PortalRequired="PortalRequired";n.LogicError="LogicError";n.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber";n.KeyAccessorMustBeString="KeyAccessorMustBeString";n.WrongSpatialReference=
"WrongSpatialReference"})(d.ExecutionErrorCodes||(d.ExecutionErrorCodes={}));const F={[d.ExecutionErrorCodes.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[d.ExecutionErrorCodes.LogicError]:"Logic error - {reason}",[d.ExecutionErrorCodes.NeverReach]:"Encountered unreachable logic",[d.ExecutionErrorCodes.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[d.ExecutionErrorCodes.ModuleAccessorMustBeString]:"Module accessor must be a string",[d.ExecutionErrorCodes.ModuleExportNotFound]:"Module has no export with provided identifier",
[d.ExecutionErrorCodes.ModulesNotSupported]:"Current profile does not support modules",[d.ExecutionErrorCodes.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[d.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[d.ExecutionErrorCodes.FieldNotFound]:"Key not found - {key}",[d.ExecutionErrorCodes.CircularModules]:"Circular module dependencies are not allowed",[d.ExecutionErrorCodes.Cancelled]:"Execution cancelled",[d.ExecutionErrorCodes.UnsupportedHashType]:"Type not supported in hash function",
[d.ExecutionErrorCodes.IllegalResult]:"Value is not a supported return type",[d.ExecutionErrorCodes.PortalRequired]:"Portal is required",[d.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[d.ExecutionErrorCodes.WrongNumberOfParameters]:"Call with wrong number of parameters",[d.ExecutionErrorCodes.Unrecognised]:"Unrecognised code structure",[d.ExecutionErrorCodes.UnrecognisedType]:"Unrecognised type",[d.ExecutionErrorCodes.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",
[d.ExecutionErrorCodes.BooleanConditionRequired]:"Conditions must use booleans",[d.ExecutionErrorCodes.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[d.ExecutionErrorCodes.NoFunctionInArray]:"Arrays cannot contain functions.",[d.ExecutionErrorCodes.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[d.ExecutionErrorCodes.KeyAccessorMustBeString]:"Accessor must be a string",[d.ExecutionErrorCodes.KeyMustBeString]:"Object keys must be a string",[d.ExecutionErrorCodes.Immutable]:"Object is immutable",
[d.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[d.ExecutionErrorCodes.UnexpectedToken]:"Unexpected token",[d.ExecutionErrorCodes.MemberOfNull]:"Cannot access property of null object",[d.ExecutionErrorCodes.MaximumCallDepth]:"Exceeded maximum function depth",[d.ExecutionErrorCodes.OutOfBounds]:"Out of bounds",[d.ExecutionErrorCodes.InvalidIdentifier]:"Identifier not recognised",[d.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[d.ExecutionErrorCodes.CallNonFunction]:"Expression is not a function",
[d.ExecutionErrorCodes.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[d.ExecutionErrorCodes.AssignModuleFunction]:"Cannot assign function to module variable",[d.ExecutionErrorCodes.UnsupportedUnaryOperator]:"Unsupported unary operator",[d.ExecutionErrorCodes.UnsupportedOperator]:"Unsupported operator",[d.ExecutionErrorCodes.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[d.ExecutionErrorCodes.LogicExpressionOrAnd]:"Logical expression can only be combined with || or \x26\x26"};
let L=function(n){function y(...D){return p.call(this,...D)}u._inherits(y,n);var p=u._createSuper(y);return u._createClass(y)}(u._wrapNativeSuper(Error)),O=function(n){function y(D,t){D=p.call(this,k(t)+D.message,{cause:D});D.loc=null;Error.captureStackTrace&&Error.captureStackTrace(u._assertThisInitialized(D),y);t&&t.loc&&(D.loc=t.loc);return D}u._inherits(y,n);var p=u._createSuper(y);return u._createClass(y)}(L),z=function(n){function y(D,t,E,v){D=p.call(this,"Execution error - "+k(E)+J(F[t],v));
D.loc=null;D.declaredRootClass="esri.arcade.arcadeexecutionerror";Error.captureStackTrace&&Error.captureStackTrace(u._assertThisInitialized(D),y);E&&E.loc&&(D.loc=E.loc);return D}u._inherits(y,n);var p=u._createSuper(y);return u._createClass(y)}(u._wrapNativeSuper(Error)),f=function(n){function y(D,t,E,v){D=p.call(this,"Compilation error - "+k(E)+J(F[t],v));D.loc=null;D.declaredRootClass="esri.arcade.arcadecompilationerror";Error.captureStackTrace&&Error.captureStackTrace(u._assertThisInitialized(D),
y);E&&E.loc&&(D.loc=E.loc);return D}u._inherits(y,n);var p=u._createSuper(y);return u._createClass(y)}(u._wrapNativeSuper(Error)),e=function(n){function y(){var D=p.call(this,"Uncompilable code structures");D.declaredRootClass="esri.arcade.arcadeuncompilableerror";Error.captureStackTrace&&Error.captureStackTrace(u._assertThisInitialized(D),y);return D}u._inherits(y,n);var p=u._createSuper(y);return u._createClass(y)}(u._wrapNativeSuper(Error));d.ModuleErrorCodes=void 0;(function(n){n.UnrecognisedUri=
"UnrecognisedUri";n.UnsupportedUriProtocol="UnsupportedUriProtocol"})(d.ModuleErrorCodes||(d.ModuleErrorCodes={}));const g={[d.ModuleErrorCodes.UnrecognisedUri]:"Unrecognised uri - {uri}",[d.ModuleErrorCodes.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let K=function(n){function y(D,t){D=p.call(this,J(g[D],t));D.declaredRootClass="esri.arcade.arcademoduleerror";Error.captureStackTrace&&Error.captureStackTrace(u._assertThisInitialized(D),y);return D}u._inherits(y,n);var p=u._createSuper(y);
return u._createClass(y)}(u._wrapNativeSuper(Error));d.ArcadeCompilationError=f;d.ArcadeExecutionError=z;d.ArcadeUncompilableError=e;d.ErrorWithCause=L;d.ExecutionErrorMessages=F;d.LocatableArcadeExecutionError=O;d.ModuleError=K;d.ModuleErrorMessages=g;d.doSubstitutions=J;d.ensureArcadeExecutionError=function(n,y,p){return"esri.arcade.arcadeexecutionerror"===p.declaredRootClass||"esri.arcade.arcadecompilationerror"===p.declaredRootClass?null===p.loc&&y&&y.loc?new O(p,{cause:p}):p:y&&y.loc?new O(p,
{cause:p}):p};d.parsingValidationMessage=function(n,y,p){return"Parsing error - "+k(n)+J(F[y],p)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/_commonjsHelpers"],function(d,u,k){var J={};(function(L){(function(O,z){L.exports&&(L.exports=z())})(k.commonjsGlobal,function(){function O(f,e,g,K){f=Error.call(this,f);Object.setPrototypeOf&&Object.setPrototypeOf(f,O.prototype);
f.expected=e;f.found=g;f.location=K;f.name="SyntaxError";return f}function z(f,e,g){g=g||" ";if(f.length>e)return f;e-=f.length;g+=g.repeat(e);return f+g.slice(0,e)}(function(f,e){function g(){this.constructor=f}g.prototype=e.prototype;f.prototype=new g})(O,Error);O.prototype.format=function(f){var e="Error: "+this.message;if(this.location){var g=null,K;for(K=0;K<f.length;K++)if(f[K].source===this.location.source){g=f[K].text.split(/\r\n|\n|\r/g);break}f=this.location.start;K=this.location.source&&
"function"===typeof this.location.source.offset?this.location.source.offset(f):f;var n=this.location.source+":"+K.line+":"+K.column;if(g){var y=this.location.end,p=z("",K.line.toString().length," ");g=g[f.line-1];y=(f.line===y.line?y.column:g.length+1)-f.column||1;e+="\n --\x3e "+n+"\n"+p+" |\n"+K.line+" | "+g+"\n"+p+" | "+z("",f.column-1," ")+z("",y,"^")}else e+="\n at "+n}return e};O.buildMessage=function(f,e){function g(D){return D.charCodeAt(0).toString(16).toUpperCase()}function K(D){return D.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+g(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+g(t)})}function n(D){return D.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+g(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(t){return"\\x"+g(t)})}function y(D){return p[D.type](D)}var p={literal:function(D){return'"'+K(D.text)+'"'},class:function(D){var t=D.parts.map(function(E){return Array.isArray(E)?n(E[0])+"-"+n(E[1]):n(E)});return"["+(D.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(D){return D.description}};return"Expected "+function(D){D=D.map(y);var t,E;D.sort();if(0<D.length){for(E=t=1;t<D.length;t++)D[t-1]!==D[t]&&(D[E]=D[t],
E++);D.length=E}switch(D.length){case 1:return D[0];case 2:return D[0]+" or "+D[1];default:return D.slice(0,-1).join(", ")+", or "+D[D.length-1]}}(f)+" but "+(e?'"'+K(e)+'"':"end of input")+" found."};return{SyntaxError:O,parse:function(f,e){function g(l,x){return{type:"literal",text:l,ignoreCase:x}}function K(l,x,N){return{type:"class",parts:l,inverted:x,ignoreCase:N}}function n(l){var x=Gb[l],N;if(!x){for(N=l-1;!Gb[N];)N--;x=Gb[N];for(x={line:x.line,column:x.column};N<l;)10===f.charCodeAt(N)?(x.line++,
x.column=1):x.column++,N++;Gb[l]=x}return x}function y(l,x,N){var aa=n(l),na=n(x);l={source:tb,start:{offset:l,line:aa.line,column:aa.column},end:{offset:x,line:na.line,column:na.column}};N&&tb&&"function"===typeof tb.offset&&(l.start=tb.offset(l.start),l.end=tb.offset(l.end));return l}function p(l){b<Ta||(b>Ta&&(Ta=b,fc=[]),fc.push(l))}function D(){var l=b;ca();var x=E();x!==a?(ca(),l=x):(b=l,l=a);return l}function t(){var l=b;var x=E();if(x!==a){l=[];var N=b;var aa=ca();var na=Hb();if(na!==a){var sa=
ca();var ta=E();ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)l.push(N),N=b,aa=ca(),na=Hb(),na!==a?(sa=ca(),ta=E(),ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)):(b=N,N=a);N={type:"expression-list"};x=[x];for(aa=0;aa<l.length;aa++)x.push(l[aa][3]);N.value=x;l=N}else b=l,l=a;return l}function E(){var l=b;var x=v();if(x!==a){l=[];var N=b;var aa=ca();var na=Aa();if(na!==a){var sa=ca();var ta=v();ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)l.push(N),N=b,aa=ca(),na=Aa(),na!==a?(sa=
ca(),ta=v(),ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)):(b=N,N=a);l=ub(x,l)}else b=l,l=a;return l}function v(){var l=b;var x=M();if(x!==a){l=[];var N=b;var aa=ca();var na=ka();if(na!==a){var sa=ca();var ta=M();ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)l.push(N),N=b,aa=ca(),na=ka(),na!==a?(sa=ca(),ta=M(),ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)):(b=N,N=a);l=ub(x,l)}else b=l,l=a;return l}function M(){var l=b;var x=Ja();if(x===a){x=b;if(33===f.charCodeAt(b)){var N=sd;b++}else N=a,0===X&&p(td);
if(N!==a){var aa=b;X++;if(61===f.charCodeAt(b)){var na=xc;b++}else na=a,0===X&&p(yc);X--;na===a?aa=void 0:(b=aa,aa=a);aa!==a?x=N=[N,aa]:(b=x,x=a)}else b=x,x=a}x!==a?(N=ca(),aa=M(),aa!==a?l={type:"unary-expression",operator:"NOT",expr:aa}:(b=l,l=a)):(b=l,l=a);if(l===a){x=b;l=m();if(l!==a){ca();x=[];N=b;aa=ca();na=B();if(na!==a){var sa=ca();var ta=m();ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)}else b=N,N=a;if(N!==a)for(;N!==a;)x.push(N),N=b,aa=ca(),na=B(),na!==a?(sa=ca(),ta=m(),ta!==a?N=aa=[aa,na,sa,ta]:(b=
N,N=a)):(b=N,N=a);else x=a;x!==a&&(x={type:"arithmetic",tail:x});x===a&&(x=b,N=c(),N!==a?(ca(),aa=Ha(),aa!==a?(ca(),aa=t(),aa!==a?(ca(),na=Ia(),na!==a?x={op:N,right:aa}:(b=x,x=a)):(b=x,x=a)):(b=x,x=a)):(b=x,x=a),x===a&&(x=b,N=c(),N!==a?(ca(),aa=Ha(),aa!==a?(ca(),aa=Ia(),aa!==a?x={op:N,right:{type:"expression-list",value:[]}}:(b=x,x=a)):(b=x,x=a)):(b=x,x=a),x===a&&(x=b,N=c(),N!==a?(ca(),aa=r(),aa!==a?x={op:N,right:aa}:(b=x,x=a)):(b=x,x=a))),x===a&&(x=b,na=Ja(),na!==a?(ca(),N=Pa(),N!==a?(ca(),aa=m(),
aa!==a?(ca(),sa=ka(),sa!==a?(ca(),na=m(),na!==a?x={op:"NOT"+N,right:{type:"expression-list",value:[aa,na]}}:(b=x,x=a)):(b=x,x=a)):(b=x,x=a)):(b=x,x=a)):(b=x,x=a),x===a&&(x=b,na=Pa(),na!==a?(ca(),N=m(),N!==a?(ca(),aa=ka(),aa!==a?(ca(),sa=m(),sa!==a?x={op:na,right:{type:"expression-list",value:[N,sa]}}:(b=x,x=a)):(b=x,x=a)):(b=x,x=a)):(b=x,x=a)),x===a&&(x=b,N=ab(),N!==a?(ca(),aa=Ja(),aa!==a?(ca(),aa=m(),aa!==a?x={op:N+"NOT",right:aa}:(b=x,x=a)):(b=x,x=a)):(b=x,x=a),x===a&&(x=b,N=ab(),N!==a?(ca(),aa=
m(),aa!==a?x={op:N,right:aa}:(b=x,x=a)):(b=x,x=a)),x===a&&(x=b,N=w(),N!==a?(ca(),aa=Y(),aa!==a?(ca(),na=b,f.substr(b,6).toLowerCase()===ud?(sa=f.substr(b,6),b+=6):(sa=a,0===X&&p(vd)),sa!==a?(sa=b,X++,ta=I(),X--,ta===a?sa=void 0:(b=sa,sa=a),sa!==a?na="ESCAPE":(b=na,na=a)):(b=na,na=a),na!==a?(ca(),na=fa(),na!==a?x={op:N,right:aa,escape:na.value}:(b=x,x=a)):(b=x,x=a)):(b=x,x=a)):(b=x,x=a),x===a&&(x=b,N=w(),N!==a?(ca(),aa=Y(),aa!==a?x={op:N,right:aa,escape:""}:(b=x,x=a)):(b=x,x=a))))));x===a&&(x=null);
""==x||void 0==x||null==x?x=l:(N=null,x=N="arithmetic"==x.type?ub(l,x.tail):zc(x.op,l,x.right,x.escape))}else b=x,x=a;l=x}return l}function B(){if(f.substr(b,2)===Ac){var l=Ac;b+=2}else l=a,0===X&&p(wd);l===a&&(62===f.charCodeAt(b)?(l=xd,b++):(l=a,0===X&&p(yd)),l===a&&(f.substr(b,2)===Bc?(l=Bc,b+=2):(l=a,0===X&&p(zd)),l===a&&(f.substr(b,2)===Cc?(l=Cc,b+=2):(l=a,0===X&&p(Ad)),l===a&&(60===f.charCodeAt(b)?(l=Bd,b++):(l=a,0===X&&p(Cd)),l===a&&(61===f.charCodeAt(b)?(l=xc,b++):(l=a,0===X&&p(yc)),l===a&&
(f.substr(b,2)===Dc?(l=Dc,b+=2):(l=a,0===X&&p(Dd))))))));return l}function w(){var l=l=b;var x=Ja();if(x!==a){var N=ca();var aa=Wa();aa!==a?l=x=[x,N,aa]:(b=l,l=a)}else b=l,l=a;l!==a&&(l=l[0]+" "+l[2]);l===a&&(l=Wa());return l}function c(){var l=l=b;var x=Ja();if(x!==a){var N=ca();var aa=Qa();aa!==a?l=x=[x,N,aa]:(b=l,l=a)}else b=l,l=a;l!==a&&(l=l[0]+" "+l[2]);l===a&&(l=Qa());return l}function m(){var l=b;var x=H();if(x!==a){l=[];var N=b;var aa=ca();var na=h();if(na!==a){var sa=ca();var ta=H();ta!==
a?N=aa=[aa,na,sa,ta]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)l.push(N),N=b,aa=ca(),na=h(),na!==a?(sa=ca(),ta=H(),ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)):(b=N,N=a);l=ub(x,l)}else b=l,l=a;return l}function h(){if(43===f.charCodeAt(b)){var l=gc;b++}else l=a,0===X&&p(hc);l===a&&(45===f.charCodeAt(b)?(l=ic,b++):(l=a,0===X&&p(jc)),l===a&&(f.substr(b,2)===Ec?(l=Ec,b+=2):(l=a,0===X&&p(Ed))));return l}function H(){var l=b;var x=A();if(x!==a){l=[];var N=b;var aa=ca();var na=q();if(na!==a){var sa=ca();var ta=A();ta!==
a?N=aa=[aa,na,sa,ta]:(b=N,N=a)}else b=N,N=a;for(;N!==a;)l.push(N),N=b,aa=ca(),na=q(),na!==a?(sa=ca(),ta=A(),ta!==a?N=aa=[aa,na,sa,ta]:(b=N,N=a)):(b=N,N=a);l=ub(x,l)}else b=l,l=a;return l}function q(){if(42===f.charCodeAt(b)){var l=Fd;b++}else l=a,0===X&&p(Gd);l===a&&(47===f.charCodeAt(b)?(l=Hd,b++):(l=a,0===X&&p(Id)));return l}function A(){var l=fa();if(l===a){var x=b;var N=b;var aa=ra();if(aa!==a){var na=ua();if(na!==a){var sa=Ea();sa!==a?N=parseFloat(aa+na+sa):(b=N,N=a)}else b=N,N=a}else b=N,N=
a;N===a&&(N=b,aa=ra(),aa!==a?(na=ua(),na!==a?N=parseFloat(aa+na):(b=N,N=a)):(b=N,N=a),N===a&&(N=b,aa=ra(),aa!==a?(na=Ea(),na!==a?N=parseFloat(aa+na):(b=N,N=a)):(b=N,N=a),N===a&&(N=b,aa=ra(),aa!==a&&(aa=parseFloat(aa)),N=aa)));var ta=N;if(ta!==a){var Ib=b;X++;var Jd=P();X--;Jd===a?Ib=void 0:(b=Ib,Ib=a);Ib!==a?x={type:"number",value:ta}:(b=x,x=a)}else b=x,x=a;l=x;if(l===a){var vb=b;var db=b;if(f.substr(b,4).toLowerCase()===Kd){var Jb=f.substr(b,4);b+=4}else Jb=a,0===X&&p(Ld);if(Jb!==a){var wb=b;X++;
var Md=I();X--;Md===a?wb=void 0:(b=wb,wb=a);wb!==a?db=Jb=[Jb,wb]:(b=db,db=a)}else b=db,db=a;var cb=db;cb!==a&&(cb={type:"boolean",value:!0});vb=cb;if(vb===a){vb=b;var eb=b;if(f.substr(b,5).toLowerCase()===Nd){var Kb=f.substr(b,5);b+=5}else Kb=a,0===X&&p(Od);if(Kb!==a){var xb=b;X++;var Pd=I();X--;Pd===a?xb=void 0:(b=xb,xb=a);xb!==a?eb=Kb=[Kb,xb]:(b=eb,eb=a)}else b=eb,eb=a;cb=eb;cb!==a&&(cb={type:"boolean",value:!1});vb=cb}l=vb;if(l===a){var fb=b;if(f.substr(b,4).toLowerCase()===Qd){var Lb=f.substr(b,
4);b+=4}else Lb=a,0===X&&p(Rd);if(Lb!==a){var yb=b;X++;var Sd=I();X--;Sd===a?yb=void 0:(b=yb,yb=a);yb!==a?fb=Lb=[Lb,yb]:(b=fb,fb=a)}else b=fb,fb=a;var kc=fb;kc!==a&&(kc={type:"null",value:null});l=kc;if(l===a){var gb=b;if(U()!==a){ca();var Fc=Y();Fc!==a?gb={type:"date",value:Fc.value}:(b=gb,gb=a)}else b=gb,gb=a;l=gb;if(l===a){var hb=b;if(W()!==a){ca();var Gc=Y();Gc!==a?hb={type:"timestamp",value:Gc.value}:(b=hb,hb=a)}else b=hb,hb=a;l=hb;if(l===a){var Fa=b;var lc=ba();if(lc!==a){ca();if(45===f.charCodeAt(b)){var Xa=
ic;b++}else Xa=a,0===X&&p(jc);Xa===a&&(43===f.charCodeAt(b)?(Xa=gc,b++):(Xa=a,0===X&&p(hc)));if(Xa!==a){ca();var zb=Y();if(zb!==a){ca();var Hc=S();Hc!==a?Fa={type:"interval",value:zb,qualifier:Hc,op:Xa}:(b=Fa,Fa=a)}else b=Fa,Fa=a}else b=Fa,Fa=a}else b=Fa,Fa=a;Fa===a&&(Fa=b,lc=ba(),lc!==a?(ca(),Xa=Y(),Xa!==a?(ca(),zb=S(),zb!==a?Fa={type:"interval",value:Xa,qualifier:zb,op:""}:(b=Fa,Fa=a)):(b=Fa,Fa=a)):(b=Fa,Fa=a));l=Fa}}}}}}var ya=l;if(ya===a){var La=b;var ib=b;if(f.substr(b,7).toLowerCase()===Td){var Ic=
f.substr(b,7);b+=7}else Ic=a,0===X&&p(Ud);if(Ic!==a){var Mb=b;X++;var Vd=I();X--;Vd===a?Mb=void 0:(b=Mb,Mb=a);Mb!==a?ib="EXTRACT":(b=ib,ib=a)}else b=ib,ib=a;if(ib!==a){ca();var Wd=Ha();if(Wd!==a){ca();var Ra=la();Ra===a&&(Ra=ja(),Ra===a&&(Ra=ha(),Ra===a&&(Ra=ia(),Ra===a&&(Ra=ma(),Ra===a&&(Ra=qa())))));var Jc=Ra;if(Jc!==a){ca();var Xd=Q();if(Xd!==a){ca();var Kc=E();if(Kc!==a){ca();var Yd=Ia();Yd!==a?La={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:Jc},Kc]}}:
(b=La,La=a)}else b=La,La=a}else b=La,La=a}else b=La,La=a}else b=La,La=a}else b=La,La=a;ya=La;if(ya===a){var Ma=b;var jb=b;if(f.substr(b,9).toLowerCase()===Zd){var Lc=f.substr(b,9);b+=9}else Lc=a,0===X&&p($d);if(Lc!==a){var Nb=b;X++;var ae=I();X--;ae===a?Nb=void 0:(b=Nb,Nb=a);Nb!==a?jb="SUBSTRING":(b=jb,jb=a)}else b=jb,jb=a;if(jb!==a){ca();var be=Ha();if(be!==a){ca();var mc=E();if(mc!==a){ca();var ce=Q();if(ce!==a){ca();var nc=E();if(nc!==a){ca();var Ya=b;var kb=b;if(f.substr(b,3).toLowerCase()===
de){var Mc=f.substr(b,3);b+=3}else Mc=a,0===X&&p(ee);if(Mc!==a){var Ob=b;X++;var fe=I();X--;fe===a?Ob=void 0:(b=Ob,Ob=a);Ob!==a?kb="FOR":(b=kb,kb=a)}else b=kb,kb=a;var Ab=kb;if(Ab!==a){var ge=ca();var Nc=E();if(Nc!==a){var he=ca();Ya=Ab=[Ab,ge,Nc,he]}else b=Ya,Ya=a}else b=Ya,Ya=a;Ya===a&&(Ya=null);Ab=Ia();Ab!==a?Ma={type:"function",name:"substring",args:{type:"expression-list",value:Ya?[mc,nc,Ya[2]]:[mc,nc]}}:(b=Ma,Ma=a)}else b=Ma,Ma=a}else b=Ma,Ma=a}else b=Ma,Ma=a}else b=Ma,Ma=a}else b=Ma,Ma=a;ya=
Ma;if(ya===a){var Ba=b;var oc=V();if(oc!==a){ca();var pc=Ha();if(pc!==a){ca();var Za=R();Za===a&&(Za=null);ca();var Bb=E();if(Bb!==a){ca();var qc=Q();if(qc!==a){ca();var Oc=E();if(Oc!==a){ca();var ie=Ia();ie!==a?Ba={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Za?"BOTH":Za},Bb,Oc]}}:(b=Ba,Ba=a)}else b=Ba,Ba=a}else b=Ba,Ba=a}else b=Ba,Ba=a}else b=Ba,Ba=a}else b=Ba,Ba=a;Ba===a&&(Ba=b,oc=V(),oc!==a?(ca(),pc=Ha(),pc!==a?(ca(),Za=R(),Za===a&&(Za=null),ca(),
Bb=E(),Bb!==a?(ca(),qc=Ia(),qc!==a?Ba={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==Za?"BOTH":Za},Bb]}}:(b=Ba,Ba=a)):(b=Ba,Ba=a)):(b=Ba,Ba=a)):(b=Ba,Ba=a));ya=Ba;if(ya===a){var Na=b;var lb=b;if(f.substr(b,8).toLowerCase()===je){var Pc=f.substr(b,8);b+=8}else Pc=a,0===X&&p(ke);if(Pc!==a){var Pb=b;X++;var le=I();X--;le===a?Pb=void 0:(b=Pb,Pb=a);Pb!==a?lb="POSITION":(b=lb,lb=a)}else b=lb,lb=a;if(lb!==a){ca();var me=Ha();if(me!==a){ca();var Qc=E();if(Qc!==
a){ca();var ne=Qa();if(ne!==a){ca();var Rc=E();if(Rc!==a){ca();var oe=Ia();oe!==a?Na={type:"function",name:"position",args:{type:"expression-list",value:[Qc,Rc]}}:(b=Na,Na=a)}else b=Na,Na=a}else b=Na,Na=a}else b=Na,Na=a}else b=Na,Na=a}else b=Na,Na=a;ya=Na;if(ya===a){var Oa=b;var mb=b;if(f.substr(b,4).toLowerCase()===pe){var Sc=f.substr(b,4);b+=4}else Sc=a,0===X&&p(qe);if(Sc!==a){var Qb=b;X++;var re=I();X--;re===a?Qb=void 0:(b=Qb,Qb=a);Qb!==a?mb="CAST":(b=mb,mb=a)}else b=mb,mb=a;if(mb!==a){ca();var se=
Ha();if(se!==a){ca();var Tc=E();if(Tc!==a){ca();var nb=b;if(f.substr(b,2).toLowerCase()===te){var Uc=f.substr(b,2);b+=2}else Uc=a,0===X&&p(ue);if(Uc!==a){var Rb=b;X++;var ve=I();X--;ve===a?Rb=void 0:(b=Rb,Rb=a);Rb!==a?nb="AS":(b=nb,nb=a)}else b=nb,nb=a;var we=nb;if(we!==a){ca();var za=b;var ob=b;if(f.substr(b,7).toLowerCase()===xe){var Vc=f.substr(b,7);b+=7}else Vc=a,0===X&&p(ye);if(Vc!==a){var Sb=b;X++;var ze=I();X--;ze===a?Sb=void 0:(b=Sb,Sb=a);Sb!==a?ob="INTEGER":(b=ob,ob=a)}else b=ob,ob=a;var Ca=
ob;Ca!==a&&(Ca={type:"data-type",value:{type:"integer"}});za=Ca;if(za===a){za=b;var pb=b;if(f.substr(b,8).toLowerCase()===Ae){var Wc=f.substr(b,8);b+=8}else Wc=a,0===X&&p(Be);if(Wc!==a){var Tb=b;X++;var Ce=I();X--;Ce===a?Tb=void 0:(b=Tb,Tb=a);Tb!==a?pb="SMALLINT":(b=pb,pb=a)}else b=pb,pb=a;Ca=pb;Ca!==a&&(Ca={type:"data-type",value:{type:"smallint"}});za=Ca;if(za===a){za=b;var qb=b;if(f.substr(b,5).toLowerCase()===De){var Xc=f.substr(b,5);b+=5}else Xc=a,0===X&&p(Ee);if(Xc!==a){var Ub=b;X++;var Fe=
I();X--;Fe===a?Ub=void 0:(b=Ub,Ub=a);Ub!==a?qb="FLOAT":(b=qb,qb=a)}else b=qb,qb=a;Ca=qb;Ca!==a&&(Ca={type:"data-type",value:{type:"float"}});za=Ca;if(za===a){za=b;var rb=b;if(f.substr(b,4).toLowerCase()===Ge){var Yc=f.substr(b,4);b+=4}else Yc=a,0===X&&p(He);if(Yc!==a){var Vb=b;X++;var Ie=I();X--;Ie===a?Vb=void 0:(b=Vb,Vb=a);Vb!==a?rb="REAL":(b=rb,rb=a)}else b=rb,rb=a;Ca=rb;Ca!==a&&(Ca={type:"data-type",value:{type:"real"}});za=Ca;if(za===a&&(za=b,Ca=U(),Ca!==a&&(Ca={type:"data-type",value:{type:"date"}}),
za=Ca,za===a&&(za=b,Ca=W(),Ca!==a&&(Ca={type:"data-type",value:{type:"timestamp"}}),za=Ca,za===a))){za=b;var sb=b;if(f.substr(b,7).toLowerCase()===Je){var Zc=f.substr(b,7);b+=7}else Zc=a,0===X&&p(Ke);if(Zc!==a){var Wb=b;X++;var Le=I();X--;Le===a?Wb=void 0:(b=Wb,Wb=a);Wb!==a?sb="VARCHAR":(b=sb,sb=a)}else b=sb,sb=a;Ca=sb;if(Ca!==a){ca();var Me=Ha();if(Me!==a){ca();var $c=va();if($c!==a){ca();var Ne=Ia();Ne!==a?za={type:"data-type",value:{type:"varchar",size:parseInt($c)}}:(b=za,za=a)}else b=za,za=a}else b=
za,za=a}else b=za,za=a}}}}var ad=za;if(ad!==a){ca();var Oe=Ia();Oe!==a?Oa={type:"function",name:"cast",args:{type:"expression-list",value:[Tc,ad]}}:(b=Oa,Oa=a)}else b=Oa,Oa=a}else b=Oa,Oa=a}else b=Oa,Oa=a}else b=Oa,Oa=a}else b=Oa,Oa=a;ya=Oa;if(ya===a){var bb=b;var Xb;var Sa=b;Sa=Xb=C();if(Sa===a)if(Sa=b,96===f.charCodeAt(b)?(Xb=bd,b++):(Xb=a,0===X&&p(cd)),Xb!==a){var Yb=[];if(dd.test(f.charAt(b))){var $a=f.charAt(b);b++}else $a=a,0===X&&p(ed);if($a!==a)for(;$a!==a;)Yb.push($a),dd.test(f.charAt(b))?
($a=f.charAt(b),b++):($a=a,0===X&&p(ed));else Yb=a;Yb!==a?(96===f.charCodeAt(b)?($a=bd,b++):($a=a,0===X&&p(cd)),$a!==a?Sa=Yb.join(""):(b=Sa,Sa=a)):(b=Sa,Sa=a)}else b=Sa,Sa=a;var fd=Sa;if(fd!==a){ca();var Pe=Ha();if(Pe!==a){ca();var Zb=t();Zb===a&&(Zb=null);ca();var Qe=Ia();Qe!==a?bb={type:"function",name:fd,args:Zb?Zb:{type:"expression-list",value:[]}}:(b=bb,bb=a)}else b=bb,bb=a}else b=bb,bb=a;ya=bb;if(ya===a){var Ua;var Ga=b;var rc=Da();if(rc!==a){ca();var Cb=E();if(Cb!==a){ca();var Db=[];for(Ua=
oa();Ua!==a;)Db.push(Ua),Ua=oa();Ua=ca();var $b=wa();$b!==a?Ga={type:"case-expression",format:"simple",operand:Cb,clauses:Db,else:null}:(b=Ga,Ga=a)}else b=Ga,Ga=a}else b=Ga,Ga=a;if(Ga===a)if(Ga=b,rc=Da(),rc!==a)if(ca(),Cb=E(),Cb!==a){ca();Db=[];for(Ua=oa();Ua!==a;)Db.push(Ua),Ua=oa();Ua=ca();$b=pa();if($b!==a){ca();var Re=wa();Re!==a?Ga={type:"case-expression",format:"simple",operand:Cb,clauses:Db,else:$b.value}:(b=Ga,Ga=a)}else b=Ga,Ga=a}else b=Ga,Ga=a;else b=Ga,Ga=a;var sc=Ga;if(sc===a){var Va;
var Ka=b;var tc=Da();if(tc!==a){ca();var Eb=[];for(Va=ea();Va!==a;)Eb.push(Va),Va=ea();Va=ca();var ac=wa();ac!==a?Ka={type:"case-expression",format:"searched",clauses:Eb,else:null}:(b=Ka,Ka=a)}else b=Ka,Ka=a;if(Ka===a)if(Ka=b,tc=Da(),tc!==a){ca();Eb=[];for(Va=ea();Va!==a;)Eb.push(Va),Va=ea();Va=ca();ac=pa();if(ac!==a){ca();var Se=wa();Se!==a?Ka={type:"case-expression",format:"searched",clauses:Eb,else:ac.value}:(b=Ka,Ka=a)}else b=Ka,Ka=a}else b=Ka,Ka=a;sc=Ka}ya=sc;if(ya===a){var bc;var cc=b;var gd=
P();if(gd!==a){var hd=[];for(bc=G();bc!==a;)hd.push(bc),bc=G();cc=gd+hd.join("")}else b=cc,cc=a;var dc=cc;if(dc!==a){var uc=dc;dc=/^CURRENT_DATE$/i.test(uc)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(uc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:uc}}ya=dc;if(ya===a&&(ya=r(),ya===a)){ya=b;var Te=Ha();if(Te!==a){ca();var vc=E();if(vc!==a){ca();var Ue=Ia();Ue!==a?(vc.paren=!0,ya=vc):(b=ya,ya=a)}else b=ya,ya=a}else b=ya,ya=a}}}}}}}}}return ya}function C(){var l;
var x=b;var N=P();if(N!==a){x=[];for(l=I();l!==a;)x.push(l),l=I();x=N+x.join("")}else b=x,x=a;return x}function P(){if(Ve.test(f.charAt(b))){var l=f.charAt(b);b++}else l=a,0===X&&p(We);return l}function I(){if(Xe.test(f.charAt(b))){var l=f.charAt(b);b++}else l=a,0===X&&p(Ye);return l}function G(){if(Ze.test(f.charAt(b))){var l=f.charAt(b);b++}else l=a,0===X&&p($e);return l}function r(){var l=b;if(64===f.charCodeAt(b)){var x=af;b++}else x=a,0===X&&p(bf);if(x!==a){var N=C();N!==a?l=x=[x,N]:(b=l,l=a)}else b=
l,l=a;l!==a&&(l={type:"parameter",value:l[1]});return l}function R(){var l=b;if(f.substr(b,7).toLowerCase()===cf){var x=f.substr(b,7);b+=7}else x=a,0===X&&p(df);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="LEADING":(b=l,l=a)}else b=l,l=a;l===a&&(l=b,f.substr(b,8).toLowerCase()===ef?(x=f.substr(b,8),b+=8):(x=a,0===X&&p(ff)),x!==a?(x=b,X++,N=I(),X--,N===a?x=void 0:(b=x,x=a),x!==a?l="TRAILING":(b=l,l=a)):(b=l,l=a),l===a&&(l=b,f.substr(b,4).toLowerCase()===gf?(x=f.substr(b,4),b+=
4):(x=a,0===X&&p(hf)),x!==a?(x=b,X++,N=I(),X--,N===a?x=void 0:(b=x,x=a),x!==a?l="BOTH":(b=l,l=a)):(b=l,l=a)));return l}function S(){var l=b;var x=b;var N=T();if(N!==a){ca();var aa=Ha();if(aa!==a)if(ca(),aa=da(),aa!==a){ca();var na=Ia();na!==a?x={type:"interval-period",period:N.value,precision:aa,secondary:null}:(b=x,x=a)}else b=x,x=a;else b=x,x=a}else b=x,x=a;x===a&&(x=b,N=T(),N!==a&&(N={type:"interval-period",period:N.value,precision:null,secondary:null}),x=N);if(x!==a)if(ca(),N=b,f.substr(b,2).toLowerCase()===
jf?(aa=f.substr(b,2),b+=2):(aa=a,0===X&&p(kf)),aa!==a?(aa=b,X++,na=I(),X--,na===a?aa=void 0:(b=aa,aa=a),aa!==a?N="TO":(b=N,N=a)):(b=N,N=a),N!==a){ca();N=b;aa=T();aa!==a&&(aa={type:"interval-period",period:aa.value,precision:null,secondary:null});N=aa;if(N===a){N=b;aa=qa();if(aa!==a)if(ca(),aa=Ha(),aa!==a)if(ca(),aa=da(),aa!==a)if(ca(),na=Hb(),na!==a)if(ca(),na=Z(),na!==a){ca();var sa=Ia();sa!==a?N={type:"interval-period",period:"second",precision:aa,secondary:na}:(b=N,N=a)}else b=N,N=a;else b=N,N=
a;else b=N,N=a;else b=N,N=a;else b=N,N=a;N===a&&(N=b,aa=qa(),aa!==a?(ca(),aa=Ha(),aa!==a?(ca(),aa=da(),aa!==a?(ca(),na=Ia(),na!==a?N={type:"interval-period",period:"second",precision:aa,secondary:null}:(b=N,N=a)):(b=N,N=a)):(b=N,N=a)):(b=N,N=a),N===a&&(N=b,aa=qa(),aa!==a&&(aa={type:"interval-period",period:"second",precision:null,secondary:null}),N=aa))}N!==a?l={type:"interval-qualifier",start:x,end:N}:(b=l,l=a)}else b=l,l=a;else b=l,l=a;l===a&&(l=b,N=T(),N!==a?(ca(),x=Ha(),x!==a?(ca(),x=Z(),x!==
a?(ca(),aa=Ia(),aa!==a?l={type:"interval-period",period:N.value,precision:x,secondary:null}:(b=l,l=a)):(b=l,l=a)):(b=l,l=a)):(b=l,l=a),l===a&&(l=b,N=T(),N!==a&&(N={type:"interval-period",period:N.value,precision:null,secondary:null}),l=N,l===a&&(l=b,N=qa(),N!==a?(ca(),x=Ha(),x!==a?(ca(),x=da(),x!==a?(ca(),aa=Hb(),aa!==a?(ca(),N=Z(),N!==a?(ca(),aa=Ia(),aa!==a?l={type:"interval-period",period:"second",precision:x,secondary:N}:(b=l,l=a)):(b=l,l=a)):(b=l,l=a)):(b=l,l=a)):(b=l,l=a)):(b=l,l=a),l===a&&(l=
b,N=qa(),N!==a?(ca(),x=Ha(),x!==a?(ca(),x=Z(),x!==a?(ca(),aa=Ia(),aa!==a?l={type:"interval-period",period:"second",precision:x,secondary:null}:(b=l,l=a)):(b=l,l=a)):(b=l,l=a)):(b=l,l=a),l===a&&(l=b,N=qa(),N!==a&&(N={type:"interval-period",period:"second",precision:null,secondary:null}),l=N)))));return l}function T(){var l=b;l=ha();l!==a&&(l={type:"string",value:"day"});l===a&&(l=b,l=ia(),l!==a&&(l={type:"string",value:"hour"}),l===a&&(l=b,l=ma(),l!==a&&(l={type:"string",value:"minute"}),l===a&&(l=
b,l=ja(),l!==a&&(l={type:"string",value:"month"}),l===a&&(l=b,l=la(),l!==a&&(l={type:"string",value:"year"})))));return l}function Z(){var l=va();l!==a&&(l=parseFloat(l));return l}function da(){var l=va();l!==a&&(l=parseFloat(l));return l}function Y(){var l=fa();l===a&&(l=r());return l}function fa(){var l=b;if(39===f.charCodeAt(b)){var x=id;b++}else x=a,0===X&&p(jd);x===a&&(f.substr(b,2)===kd?(x=kd,b+=2):(x=a,0===X&&p(lf)));if(x!==a){x=[];var N=b;f.substr(b,2)===ec?(N=ec,b+=2):(N=a,0===X&&p(ld));
N!==a&&(N="'");N===a&&(md.test(f.charAt(b))?(N=f.charAt(b),b++):(N=a,0===X&&p(nd)));for(;N!==a;)x.push(N),N=b,f.substr(b,2)===ec?(N=ec,b+=2):(N=a,0===X&&p(ld)),N!==a&&(N="'"),N===a&&(md.test(f.charAt(b))?(N=f.charAt(b),b++):(N=a,0===X&&p(nd)));39===f.charCodeAt(b)?(N=id,b++):(N=a,0===X&&p(jd));N!==a?l={type:"string",value:x.join("")}:(b=l,l=a)}else b=l,l=a;return l}function ea(){var l=b;if(Fb()!==a){ca();var x=E();if(x!==a){ca();var N=od();N!==a?(ca(),N=E(),N!==a?l={type:"when-clause",operand:x,value:N}:
(b=l,l=a)):(b=l,l=a)}else b=l,l=a}else b=l,l=a;return l}function oa(){var l=b;if(Fb()!==a){ca();var x=E();if(x!==a){ca();var N=od();N!==a?(ca(),N=E(),N!==a?l={type:"when-clause",operand:x,value:N}:(b=l,l=a)):(b=l,l=a)}else b=l,l=a}else b=l,l=a;return l}function pa(){var l=b;var x=b;if(f.substr(b,4).toLowerCase()===mf){var N=f.substr(b,4);b+=4}else N=a,0===X&&p(nf);if(N!==a){N=b;X++;var aa=I();X--;aa===a?N=void 0:(b=N,N=a);N!==a?x="ELSE":(b=x,x=a)}else b=x,x=a;x!==a?(ca(),x=E(),x!==a?l={type:"else-clause",
value:x}:(b=l,l=a)):(b=l,l=a);return l}function ra(){var l=va();if(l===a){l=b;if(45===f.charCodeAt(b)){var x=ic;b++}else x=a,0===X&&p(jc);x===a&&(43===f.charCodeAt(b)?(x=gc,b++):(x=a,0===X&&p(hc)));if(x!==a){var N=va();N!==a?l=x[0]+N:(b=l,l=a)}else b=l,l=a}return l}function ua(){var l=b;if(46===f.charCodeAt(b)){var x=of;b++}else x=a,0===X&&p(pf);x!==a?(l=va(),l===a&&(l=null),l="."+(null!=l?l:"")):(b=l,l=a);return l}function Ea(){var l;var x=l=b;if(qf.test(f.charAt(b))){var N=f.charAt(b);b++}else N=
a,0===X&&p(rf);N!==a?(sf.test(f.charAt(b))?(x=f.charAt(b),b++):(x=a,0===X&&p(tf)),x===a&&(x=null),x="e"+(null===x?"":x)):(b=x,x=a);x!==a?(N=va(),N!==a?l=x+N:(b=l,l=a)):(b=l,l=a);return l}function va(){var l=[];var x=xa();if(x!==a)for(;x!==a;)l.push(x),x=xa();else l=a;l!==a&&(l=l.join(""));return l}function xa(){if(uf.test(f.charAt(b))){var l=f.charAt(b);b++}else l=a,0===X&&p(vf);return l}function Qa(){var l=b;if(f.substr(b,2).toLowerCase()===wf){var x=f.substr(b,2);b+=2}else x=a,0===X&&p(xf);if(x!==
a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="IN":(b=l,l=a)}else b=l,l=a;return l}function ab(){var l=b;if(f.substr(b,2).toLowerCase()===yf){var x=f.substr(b,2);b+=2}else x=a,0===X&&p(zf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="IS":(b=l,l=a)}else b=l,l=a;return l}function Wa(){var l=b;if(f.substr(b,4).toLowerCase()===Af){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(Bf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="LIKE":(b=l,l=a)}else b=l,l=
a;return l}function Ja(){var l=b;if(f.substr(b,3).toLowerCase()===Cf){var x=f.substr(b,3);b+=3}else x=a,0===X&&p(Df);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="NOT":(b=l,l=a)}else b=l,l=a;return l}function ka(){var l=b;if(f.substr(b,3).toLowerCase()===Ef){var x=f.substr(b,3);b+=3}else x=a,0===X&&p(Ff);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="AND":(b=l,l=a)}else b=l,l=a;return l}function Aa(){var l=b;if(f.substr(b,2).toLowerCase()===Gf){var x=f.substr(b,
2);b+=2}else x=a,0===X&&p(Hf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="OR":(b=l,l=a)}else b=l,l=a;return l}function Pa(){var l=b;if(f.substr(b,7).toLowerCase()===If){var x=f.substr(b,7);b+=7}else x=a,0===X&&p(Jf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="BETWEEN":(b=l,l=a)}else b=l,l=a;return l}function Q(){var l=b;if(f.substr(b,4).toLowerCase()===Kf){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(Lf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,
x=a);x!==a?l="FROM":(b=l,l=a)}else b=l,l=a;return l}function V(){var l=b;if(f.substr(b,4).toLowerCase()===Mf){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(Nf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="TRIM":(b=l,l=a)}else b=l,l=a;return l}function W(){var l=b;if(f.substr(b,9).toLowerCase()===Of){var x=f.substr(b,9);b+=9}else x=a,0===X&&p(Pf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="TIMESTAMP":(b=l,l=a)}else b=l,l=a;return l}function U(){var l=b;if(f.substr(b,
4).toLowerCase()===Qf){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(Rf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="DATE":(b=l,l=a)}else b=l,l=a;return l}function ba(){var l=b;if(f.substr(b,8).toLowerCase()===Sf){var x=f.substr(b,8);b+=8}else x=a,0===X&&p(Tf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="INTERVAL":(b=l,l=a)}else b=l,l=a;return l}function la(){var l=b;if(f.substr(b,4).toLowerCase()===Uf){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(Vf);if(x!==
a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="YEAR":(b=l,l=a)}else b=l,l=a;return l}function ja(){var l=b;if(f.substr(b,5).toLowerCase()===Wf){var x=f.substr(b,5);b+=5}else x=a,0===X&&p(Xf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="MONTH":(b=l,l=a)}else b=l,l=a;return l}function ha(){var l=b;if(f.substr(b,3).toLowerCase()===Yf){var x=f.substr(b,3);b+=3}else x=a,0===X&&p(Zf);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="DAY":(b=l,l=a)}else b=
l,l=a;return l}function ia(){var l=b;if(f.substr(b,4).toLowerCase()===$f){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(ag);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="HOUR":(b=l,l=a)}else b=l,l=a;return l}function ma(){var l=b;if(f.substr(b,6).toLowerCase()===bg){var x=f.substr(b,6);b+=6}else x=a,0===X&&p(cg);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="MINUTE":(b=l,l=a)}else b=l,l=a;return l}function qa(){var l=b;if(f.substr(b,6).toLowerCase()===dg){var x=
f.substr(b,6);b+=6}else x=a,0===X&&p(eg);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="SECOND":(b=l,l=a)}else b=l,l=a;return l}function Da(){var l=b;if(f.substr(b,4).toLowerCase()===fg){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(gg);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="CASE":(b=l,l=a)}else b=l,l=a;return l}function wa(){var l=b;if(f.substr(b,3).toLowerCase()===hg){var x=f.substr(b,3);b+=3}else x=a,0===X&&p(ig);if(x!==a){x=b;X++;var N=I();X--;N===a?
x=void 0:(b=x,x=a);x!==a?l="END":(b=l,l=a)}else b=l,l=a;return l}function Fb(){var l=b;if(f.substr(b,4).toLowerCase()===jg){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(kg);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="WHEN":(b=l,l=a)}else b=l,l=a;return l}function od(){var l=b;if(f.substr(b,4).toLowerCase()===lg){var x=f.substr(b,4);b+=4}else x=a,0===X&&p(mg);if(x!==a){x=b;X++;var N=I();X--;N===a?x=void 0:(b=x,x=a);x!==a?l="THEN":(b=l,l=a)}else b=l,l=a;return l}function Hb(){if(44===
f.charCodeAt(b)){var l=ng;b++}else l=a,0===X&&p(og);return l}function Ha(){if(40===f.charCodeAt(b)){var l=pg;b++}else l=a,0===X&&p(qg);return l}function Ia(){if(41===f.charCodeAt(b)){var l=rg;b++}else l=a,0===X&&p(sg);return l}function ca(){var l;var x=[];for(l=pd();l!==a;)x.push(l),l=pd();return x}function pd(){if(tg.test(f.charAt(b))){var l=f.charAt(b);b++}else l=a,0===X&&p(ug);return l}function zc(l,x,N,aa){l={type:"binary-expression",operator:l,left:x,right:N};void 0!==aa&&(l.escape=aa);return l}
function ub(l,x){for(var N=0;N<x.length;N++)l=zc(x[N][1],l,x[N][3]);return l}e=void 0!==e?e:{};var a={},tb=e.grammarSource,qd={start:D},rd=D,sd="!",xc="\x3d",Ac="\x3e\x3d",xd="\x3e",Bc="\x3c\x3d",Cc="\x3c\x3e",Bd="\x3c",Dc="!\x3d",gc="+",ic="-",Ec="||",Fd="*",Hd="/",af="@",id="'",kd="N'",ec="''",of=".",Qd="null",Kd="true",Nd="false",wf="in",yf="is",Af="like",ud="escape",Cf="not",Ef="and",Gf="or",If="between",Kf="from",de="for",Zd="substring",Td="extract",Mf="trim",je="position",Of="timestamp",Qf=
"date",cf="leading",ef="trailing",gf="both",pe="cast",te="as",xe="integer",Ae="smallint",De="float",Ge="real",Je="varchar",jf="to",Sf="interval",Uf="year",Wf="month",Yf="day",$f="hour",bg="minute",dg="second",fg="case",hg="end",jg="when",lg="then",mf="else",ng=",",pg="(",rg=")",bd="`",Ve=/^[A-Za-z_\x80-\uFFFF]/,Xe=/^[A-Za-z0-9_]/,Ze=/^[A-Za-z0-9_.\x80-\uFFFF]/,md=/^[^']/,uf=/^[0-9]/,qf=/^[eE]/,sf=/^[+\-]/,tg=/^[ \t\n\r]/,dd=/^[^`]/,td=g("!",!1),yc=g("\x3d",!1),wd=g("\x3e\x3d",!1),yd=g("\x3e",!1),
zd=g("\x3c\x3d",!1),Ad=g("\x3c\x3e",!1),Cd=g("\x3c",!1),Dd=g("!\x3d",!1),hc=g("+",!1),jc=g("-",!1),Ed=g("||",!1),Gd=g("*",!1),Id=g("/",!1),We=K([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Ye=K([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),$e=K([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),bf=g("@",!1),jd=g("'",!1),lf=g("N'",!1),ld=g("''",!1),nd=K(["'"],!0,!1),pf=g(".",!1),vf=K([["0","9"]],!1,!1),rf=K(["e","E"],!1,!1),tf=K(["+","-"],!1,!1),Rd=g("NULL",!0),Ld=g("TRUE",!0),
Od=g("FALSE",!0),xf=g("IN",!0),zf=g("IS",!0),Bf=g("LIKE",!0),vd=g("ESCAPE",!0),Df=g("NOT",!0),Ff=g("AND",!0),Hf=g("OR",!0),Jf=g("BETWEEN",!0),Lf=g("FROM",!0),ee=g("FOR",!0),$d=g("SUBSTRING",!0),Ud=g("EXTRACT",!0),Nf=g("TRIM",!0),ke=g("POSITION",!0),Pf=g("TIMESTAMP",!0),Rf=g("DATE",!0),df=g("LEADING",!0),ff=g("TRAILING",!0),hf=g("BOTH",!0),qe=g("CAST",!0),ue=g("AS",!0),ye=g("INTEGER",!0),Be=g("SMALLINT",!0),Ee=g("FLOAT",!0),He=g("REAL",!0),Ke=g("VARCHAR",!0),kf=g("TO",!0),Tf=g("INTERVAL",!0),Vf=g("YEAR",
!0),Xf=g("MONTH",!0),Zf=g("DAY",!0),ag=g("HOUR",!0),cg=g("MINUTE",!0),eg=g("SECOND",!0),gg=g("CASE",!0),ig=g("END",!0),kg=g("WHEN",!0),mg=g("THEN",!0),nf=g("ELSE",!0),og=g(",",!1),qg=g("(",!1),sg=g(")",!1),ug=K([" ","\t","\n","\r"],!1,!1),cd=g("`",!1),ed=K(["`"],!0,!1),b=0,Gb=[{line:1,column:1}],Ta=0,fc=[],X=0;if("startRule"in e){if(!(e.startRule in qd))throw Error("Can't start parsing from rule \""+e.startRule+'".');rd=qd[e.startRule]}var wc=rd();if(wc!==a&&b===f.length)return wc;wc!==a&&b<f.length&&
p({type:"end"});throw function(l,x,N){return new O(O.buildMessage(l,x),l,x,N)}(fc,Ta<f.length?f.charAt(Ta):null,Ta<f.length?y(Ta,Ta+1):y(Ta,Ta));}}})})({get exports(){return J},set exports(L){J=L}});let F=function(){function L(){}L.parse=function(O){return J.parse(O)};return u._createClass(L)}();d.WhereGrammar=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],
function(d,u,k){function J(c){return null==c||"string"===typeof c&&!c?"\x3cNull\x3e":c}function F(c){const m=null!=c.minValue||null!=c.maxValue,h=!!c.sqlExpression&&c.supportsSQLExpression;return!(null!=c.normalizationField||null!=c.normalizationType)&&!m&&!h}function L(c){const {values:m,useSampleStdDev:h,supportsNullCount:H}=c;var q=Number.POSITIVE_INFINITY;let A=Number.NEGATIVE_INFINITY,C=null,P=null;var I=null;let G=null,r=0;const R=null==c.minValue?-Infinity:c.minValue,S=null==c.maxValue?Infinity:
c.maxValue;for(const T of m)Number.isFinite(T)?T>=R&&T<=S&&(C=null===C?T:C+T,q=Math.min(q,T),A=Math.max(A,T),r++):"string"===typeof T&&r++;if(r&&null!=C){P=C/r;I=0;for(const T of m)Number.isFinite(T)&&T>=R&&T<=S&&(I+=(T-P)**2);G=h?1<r?I/(r-1):0:0<r?I/r:0;I=Math.sqrt(G)}else A=q=null;q={avg:P,count:r,max:A,min:q,stddev:I,sum:C,variance:G};H&&(q.nullcount=m.length-r);c.percentileParams&&(q.median=O(m,c.percentileParams));return q}function O(c,m){const {fieldType:h,value:H,orderBy:q,isDiscrete:A}=m,
C=z(h,"desc"===q);c=[...c].filter(r=>null!=r).sort((r,R)=>C(r,R));if(0===c.length)return null;if(0>=H)return c[0];if(1<=H)return c[c.length-1];var P=(c.length-1)*H,I=Math.floor(P);m=I+1;P%=1;I=c[I];const G=c[m];return m>=c.length||A||"string"===typeof I||"string"===typeof G?I:I*(1-P)+G*P}function z(c,m){const h=m?1:-1,H=g(m),q=e(m);if(!c||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...B].includes(c))return(A,C)=>"number"===typeof A&&"number"===typeof C?
H(A,C):"string"===typeof A&&"string"===typeof C?q(A,C):h;if("esriFieldTypeDate"===c)return(A,C)=>{A=(new Date(A)).getTime();C=(new Date(C)).getTime();return isNaN(A)||isNaN(C)?h:H(A,C)};if(B.has(c))return(A,C)=>H(A,C);if("esriFieldTypeString"===c)return(A,C)=>q(A,C);if("esriFieldTypeGUID"===c||"esriFieldTypeGlobalID"===c){const A=e(m);return(C,P)=>A(K(C),K(P))}return m?(A,C)=>1:(A,C)=>-1}function f(c,m,h){if(h){if(null==c)return null==m?0:1;if(null==m)return-1}else{if(null==c)return null==m?0:-1;
if(null==m)return 1}return null}function e(c){return c?(m,h)=>{const H=f(m,h,!0);if(null!=H)return H;m=m.toUpperCase();h=h.toUpperCase();return m>h?-1:m<h?1:0}:(m,h)=>{const H=f(m,h,!1);if(null!=H)return H;m=m.toUpperCase();h=h.toUpperCase();return m<h?-1:m>h?1:0}}function g(c){return c?(m,h)=>{const H=f(m,h,!0);return null!=H?H:h-m}:(m,h)=>{const H=f(m,h,!1);return null!=H?H:m-h}}function K(c){return c.substr(24,12)+c.substr(19,4)+c.substr(16,2)+c.substr(14,2)+c.substr(11,2)+c.substr(9,2)+c.substr(6,
2)+c.substr(4,2)+c.substr(2,2)+c.substr(0,2)}function n(c){return"coded-value"!==c?.type?[]:c.codedValues.map(m=>m.code)}function y(c,m){const h=D({field:m.field,normalizationType:m.normalizationType,normalizationField:m.normalizationField,classificationMethod:m.classificationMethod,standardDeviationInterval:m.standardDeviationInterval,breakCount:m.numClasses||5});c=p(c,m.minValue,m.maxValue);return k.createGenerateRendererClassBreaks({definition:h,values:c,normalizationTotal:m.normalizationTotal})}
function p(c,m,h){const H=null==m?-Infinity:m,q=null==h?Infinity:h;return c.filter(A=>Number.isFinite(A)&&A>=H&&A<=q)}function D(c){const {breakCount:m,field:h,normalizationField:H,normalizationType:q}=c,A=c.classificationMethod||"equal-interval";return new u({breakCount:m,classificationField:h,classificationMethod:A,normalizationField:"field"===q?H:void 0,normalizationType:q,standardDeviationInterval:"standard-deviation"===A?c.standardDeviationInterval||1:void 0})}function t(c,m){const {field:h,
classificationMethod:H,standardDeviationInterval:q,normalizationType:A,normalizationField:C,normalizationTotal:P,minValue:I,maxValue:G}=m,r=m.numBins||10;let R=m=null,S=null;H&&"equal-interval"!==H||A?({classBreaks:c}=y(c,{field:h,normalizationType:A,normalizationField:C,normalizationTotal:P,classificationMethod:H,standardDeviationInterval:q,minValue:I,maxValue:G,numClasses:r}),m=c[0].minValue,R=c[c.length-1].maxValue,S=c.map(T=>[T.minValue,T.maxValue])):(null!=I&&null!=G?(m=I,R=G):(c=L({values:c,
minValue:I,maxValue:G,useSampleStdDev:!A,supportsNullCount:F({normalizationType:A,normalizationField:C,minValue:I,maxValue:G})}),m=c.min??null,R=c.max??null),S=v(m??0,R??0,r));return{min:m,max:R,intervals:S}}function E(c,m){let h=-1;for(let H=c.length-1;0<=H;H--)if(m>=c[H][0]){h=H;break}return h}function v(c,m,h){const H=(m-c)/h,q=[];let A;for(let C=1;C<=h;C++)A=c+H,A=Number(A.toFixed(16)),q.push([c,C===h?m:A]),c=A;return q}const M=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,B=new Set(["esriFieldTypeInteger",
"esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),w="min max avg stddev count sum variance nullcount median".split(" ");d.calculateClassBreaks=y;d.calculateHistogram=function(c,m){var h=t(c,m);const H=h.intervals,q=h.min??0;h=h.max??0;const A=H.map((C,P)=>({minValue:H[P][0],maxValue:H[P][1],count:0}));for(const C of c)null!=C&&C>=q&&C<=h&&(c=E(H,C),-1<c&&A[c].count++);return{bins:A,minValue:q,maxValue:h,normalizationTotal:m.normalizationTotal}};d.calculatePercentile=O;d.calculateStatistics=
L;d.calculateStringStatistics=function(c){const m=c.returnDistinct?[...(new Set(c.values))]:c.values,h=m.filter(q=>null!=q).length,H={count:h};c.supportsNullCount&&(H.nullcount=m.length-h);c.percentileParams&&(H.median=O(m,c.percentileParams));return H};d.calculateUniqueValuesCount=function(c){const m={};for(let h of c){if(null==h||"string"===typeof h&&""===h.trim())h=null;null==m[h]?m[h]={count:1,data:h}:m[h].count++}return{count:m}};d.createClassBreaksDefinition=D;d.createUVResult=function(c,m,
h,H){c=c.count;const q=[];if(h&&m){h=[];var A=n(m[0]);for(const C of A)if(m[1]){A=n(m[1]);for(const P of A)if(m[2]){A=n(m[2]);for(const I of A)h.push(`${J(C)}${H}${J(P)}${H}${J(I)}`)}else h.push(`${J(C)}${H}${J(P)}`)}else h.push(C);for(const C of h)c.hasOwnProperty(C)||(c[C]={data:C,count:0})}for(const C in c)m=c[C],q.push({value:m.data,count:m.count,label:m.label});return{uniqueValueInfos:q}};d.getAttributeComparator=z;d.getEqualIntervalBins=v;d.getNormalizedValue=function(c,m,h,H){let q=null;switch(m){case "log":0!==
c&&(q=Math.log(c)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(H)&&0!==H&&(q=c/H*100);break;case "field":Number.isFinite(h)&&0!==h&&(q=c/h);break;case "natural-log":0<c&&(q=Math.log(c));break;case "square-root":0<c&&(q=c**.5)}return q};d.isNullCountSupported=F;d.processNullValue=J;d.processSummaryStatisticsResult=function(c,m){let h;for(h in c)w.includes(h)&&(Number.isFinite(c[h])||(c[h]=null));if(!m)return c;["avg","stddev","variance"].forEach(H=>{null!=c[H]&&(c[H]=Math.ceil(c[H]))});
return c};d.resolveCBResult=function(c,m){let h=c.classBreaks;const H=h[0].minValue,q=h[h.length-1].maxValue,A="standard-deviation"===m;h=h.map(C=>{const P=C.label;C={minValue:C.minValue,maxValue:C.maxValue,label:P};if(A&&P){const I=P.match(M)?.map(G=>+G.trim())??[];2===I.length?(C.minStdDev=I[0],C.maxStdDev=I[1],0>I[0]&&0<I[1]&&(C.hasAvg=!0)):1===I.length&&(P.includes("\x3c")?(C.minStdDev=null,C.maxStdDev=I[0]):P.includes("\x3e")&&(C.minStdDev=I[0],C.maxStdDev=null))}return C});return{minValue:H,
maxValue:q,classBreakInfos:h,normalizationTotal:c.normalizationTotal}};d.statisticTypes=w;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,u,k,J,F,L,O,z,f,e){L=new k.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});k=new k.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});J=function(g){function K(y){y=n.call(this,y);y.type="class-breaks-definition";y.breakCount=
null;y.classificationField=null;y.classificationMethod=null;y.normalizationField=null;y.normalizationType=null;return y}d._inherits(K,g);var n=d._createSuper(K);d._createClass(K,[{key:"standardDeviationInterval",set:function(y){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",y)}},{key:"definedInterval",set:function(y){"defined-interval"===this.classificationMethod&&this._set("definedInterval",y)}}]);return K}(J.JSONSupport);u.__decorate([f.enumeration({classBreaksDef:"class-breaks-definition"})],
J.prototype,"type",void 0);u.__decorate([F.property({json:{write:!0}})],J.prototype,"breakCount",void 0);u.__decorate([F.property({json:{write:!0}})],J.prototype,"classificationField",void 0);u.__decorate([F.property({type:String,json:{read:L.read,write:L.write}})],J.prototype,"classificationMethod",void 0);u.__decorate([F.property({json:{write:!0}})],J.prototype,"normalizationField",void 0);u.__decorate([F.property({json:{read:k.read,write:k.write}})],J.prototype,"normalizationType",void 0);u.__decorate([F.property({value:null,
json:{write:!0}})],J.prototype,"standardDeviationInterval",null);u.__decorate([F.property({value:null,json:{write:!0}})],J.prototype,"definedInterval",null);return J=u.__decorate([e.subclass("esri.rest.support.ClassBreaksDefinition")],J)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(d,u){function k(n){var y=n.definition;const {classificationMethod:p,normalizationType:D,definedInterval:t}=y;y=y.breakCount??1;const E=[];var v=n.values;if(0===
v.length)return[];v=v.sort((h,H)=>h-H);var M=v[0],B=v[v.length-1];if("equal-interval"===p)if(v.length>=y){v=(B-M)/y;n=M;for(var w=1;w<y;w++){var c=Number((M+w*v).toFixed(6));E.push({minValue:n,maxValue:c,label:J(n,c,D)});n=c}E.push({minValue:n,maxValue:B,label:J(n,B,D)})}else v.forEach(h=>{E.push({minValue:h,maxValue:h,label:J(h,h,D)})});else if("natural-breaks"===p){v=F(v);n=L(v.uniqueValues,n.valueFrequency||v.valueFrequency,y);for(w=1;w<y;w++)v.uniqueValues.length>w&&(c=Number(v.uniqueValues[n[w]].toFixed(6)),
E.push({minValue:M,maxValue:c,label:J(M,c,D)}),M=c);E.push({minValue:M,maxValue:B,label:J(M,B,D)})}else if("quantile"===p)if(v.length>=y&&M!==B){n=Math.ceil(v.length/y);w=0;for(c=1;c<y;c++){var m=n+w-1;m>v.length&&(m=v.length-1);0>m&&(m=0);E.push({minValue:M,maxValue:v[m],label:J(M,v[m],D)});M=v[m];w+=n;n=Math.ceil((v.length-w)/(y-c))}E.push({minValue:M,maxValue:B,label:J(M,B,D)})}else for(y=-1,B=0;B<v.length;B++)M=v[B],M!==y&&(y=M,E.push({minValue:y,maxValue:M,label:J(y,M,D)}),y=M);else if("standard-deviation"===
p)if(n=f(v),w=e(v,n),0===w)E.push({minValue:v[0],maxValue:v[0],label:J(v[0],v[0],D)});else{v=z(M,B,y,n,w)*w;w=0;for(c=y;1<=c;c--)m=Number((n-(c-.5)*v).toFixed(6)),E.push({minValue:M,maxValue:m,label:J(M,m,D)}),M=m,w++;c=Number((n+.5*v).toFixed(6));E.push({minValue:M,maxValue:c,label:J(M,c,D)});M=c;w++;for(m=1;m<=y;m++)c=w===2*y?B:Number((n+(m+.5)*v).toFixed(6)),E.push({minValue:M,maxValue:c,label:J(M,c,D)}),M=c,w++}else if("defined-interval"===p){if(!t)return E;y=v[0];B=v[v.length-1];v=Math.ceil((B-
y)/t);M=y;for(n=1;n<v;n++)w=Number((y+n*t).toFixed(6)),E.push({minValue:M,maxValue:w,label:J(M,w,D)}),M=w;E.push({minValue:M,maxValue:B,label:J(M,B,D)})}return E}function J(n,y,p){let D=null;return D=n===y?p&&"percent-of-total"===p?n+"%":n.toString():p&&"percent-of-total"===p?n+"% - "+y+"%":n+" - "+y}function F(n){const y=[],p=[];let D=Number.MIN_VALUE,t=1,E=-1;for(let v=0;v<n.length;v++){const M=n[v];M===D?(t++,p[E]=t):null!==M&&(y.push(M),D=M,t=1,p.push(t),E++)}return{uniqueValues:y,valueFrequency:p}}
function L(n,y,p){var D=n.length;const t=[];p>D&&(p=D);for(var E=0;E<p;E++)t.push(Math.round(E*D/p-1));t.push(D-1);E=O(t,n,y,p);D=E.mean;E=E.sdcm;var v=p,M=0,B=0;let w=0,c=0,m=!0;for(let H=0;2>H&&m;H++){0===H&&(m=!1);for(var h=0;h<v-1;h++)for(;t[h+1]+1!==t[h+2];)if(t[h+1]+=1,M=g(h,t,n,y),w=M.sbMean,M=M.sbSdcm,B=g(h+1,t,n,y),c=B.sbMean,B=B.sbSdcm,M+B<E[h]+E[h+1])E[h]=M,E[h+1]=B,D[h]=w,D[h+1]=c,m=!0;else{--t[h+1];break}for(h=v-1;0<h;h--)for(;t[h]!==t[h-1]+1;)if(--t[h],M=g(h-1,t,n,y),w=M.sbMean,M=M.sbSdcm,
B=g(h,t,n,y),c=B.sbMean,B=B.sbSdcm,M+B<E[h-1]+E[h])E[h-1]=M,E[h]=B,D[h-1]=w,D[h]=c,m=!0;else{t[h]+=1;break}}m&&(E=O(t,n,y,p));return t}function O(n,y,p,D){let t=[];var E=[],v=[];let M=0;const B=[],w=[];for(var c=0;c<D;c++){var m=g(c,n,y,p);B.push(m.sbMean);w.push(m.sbSdcm);M+=w[c]}m=M;for(c=!0;c||M<m;){c=!1;t=[];for(E=0;E<D;E++)t.push(n[E]);for(v=0;v<D;v++)for(m=n[v]+1;m<=n[v+1];m++)if(E=y[m],0<v&&m!==n[v+1]&&Math.abs(E-B[v])>Math.abs(E-B[v-1]))n[v]=m;else if(v<D-1&&n[v]!==m-1&&Math.abs(E-B[v])>Math.abs(E-
B[v+1])){n[v+1]=m-1;break}m=M;M=0;E=[];v=[];for(let h=0;h<D;h++){E.push(B[h]);v.push(w[h]);const H=g(h,n,y,p);B[h]=H.sbMean;w[h]=H.sbSdcm;M+=w[h]}}if(M>m){for(y=0;y<D;y++)n[y]=t[y],B[y]=E[y],w[y]=v[y];M=m}return{mean:B,sdcm:w}}function z(n,y,p,D,t){n=Math.max(D-n,y-D)/t/p;return 1<=n?1:.5<=n?.5:.25}function f(n){let y=0;for(let p=0;p<n.length;p++)y+=n[p];return y/=n.length}function e(n,y){let p=0;for(let D=0;D<n.length;D++){const t=n[D];p+=(t-y)*(t-y)}p/=n.length;return Math.sqrt(p)}function g(n,
y,p,D){var t=0,E=0;for(var v=y[n]+1;v<=y[n+1];v++){const M=D[v];t+=p[v]*M;E+=M}0>=E&&K.warn("Exception in Natural Breaks calculation");t/=E;E=0;for(v=y[n]+1;v<=y[n+1];v++)E+=D[v]*(p[v]-t)**2;return{sbMean:t,sbSdcm:E}}const K=u.getLogger("esri.rest.support.generateRendererUtils");d.createGenerateRendererClassBreaks=function(n){const {normalizationTotal:y}=n;return{classBreaks:k(n),normalizationTotal:y}};d.createGenerateRendererUniqueValues=function(n){n=F(n);const y=[],p=n.uniqueValues.length;for(let D=
0;D<p;D++){const t=n.uniqueValues[D];y.push({value:t,count:n.valueFrequency[D],label:t.toString()})}return{uniqueValues:y}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(d,
u,k,J,F,L,O){function z(p,D){if(!D)return null;if("x"in D){var t={x:0,y:0};[t.x,t.y]=p(D.x,D.y,g);null!=D.z&&(t.z=D.z);null!=D.m&&(t.m=D.m);return t}return"xmin"in D?(t={xmin:0,ymin:0,xmax:0,ymax:0},[t.xmin,t.ymin]=p(D.xmin,D.ymin,g),[t.xmax,t.ymax]=p(D.xmax,D.ymax,g),D.hasZ&&(t.zmin=D.zmin,t.zmax=D.zmax,t.hasZ=!0),D.hasM&&(t.mmin=D.mmin,t.mmax=D.mmax,t.hasM=!0),t):"rings"in D?{rings:f(D.rings,p),hasM:D.hasM,hasZ:D.hasZ}:"paths"in D?{paths:f(D.paths,p),hasM:D.hasM,hasZ:D.hasZ}:"points"in D?{points:e(D.points,
p),hasM:D.hasM,hasZ:D.hasZ}:null}function f(p,D){const t=[];for(const E of p)t.push(e(E,D));return t}function e(p,D){const t=[];for(const E of p)p=D(E[0],E[1],[0,0]),t.push(p),2<E.length&&p.push(E[2]),3<E.length&&p.push(E[3]);return t}const g=[0,0],K=z.bind(null,O.lngLatToXY),n=z.bind(null,O.xyToLngLat),y=new (function(){function p(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var D=p.prototype;D.push=async function(t,E,v){if(!(t&&t.length&&E&&v)||L.equals(E,v))return t;
const M={geometries:t,inSpatialReference:E,outSpatialReference:v,resolve:null};this._jobs.push(M);return new Promise(B=>{M.resolve=B;null===this._timer&&(this._timer=setTimeout(this._process,10))})};D._process=function(){this._timer=null;const t=this._jobs.shift();if(t){var {geometries:E,inSpatialReference:v,outSpatialReference:M,resolve:B}=t;O.canProject(v,M)?L.isWebMercator(M)?B(E.map(K)):B(E.map(n)):B(J.projectMany(F.jsonAdapter,E,v,M,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}};return u._createClass(p)}());d.checkProjectionSupport=async function(p,D){p&&D&&(p=Array.isArray(p)?p.map(t=>k.isSome(t.geometry)?t.geometry.spatialReference:null).filter(k.isSome):[p],await J.initializeProjection(p.map(t=>({source:t,dest:D}))))};d.project=function(p,D,t,E){if(!p)return p;t||(t=D,D=p.spatialReference);return L.isValid(D)&&L.isValid(t)&&!L.equals(D,t)?O.canProject(D,t)?(p=L.isWebMercator(t)?K(p):n(p),p.spatialReference=t,p):J.projectMany(F.jsonAdapter,[p],D,t,null,E)[0]:p};
d.projectMany=function(p,D,t){return y.push(p,D,t)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(d,u){let k=u._createClass(function(z,f,e){this.x=z;this.y=f;this.spatialReference=e;this.m=this.z=void 0}),J=u._createClass(function(z,f,e,g){this.rings=z;this.spatialReference=f;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);g&&(this.hasM=g)}),F=u._createClass(function(z,
f,e,g){this.paths=z;this.spatialReference=f;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);g&&(this.hasM=g)}),L=u._createClass(function(z,f,e,g){this.points=z;this.spatialReference=f;this.hasM=this.hasZ=void 0;e&&(this.hasZ=e);g&&(this.hasM=g)}),O=u._createClass(function(z,f,e,g,K){this.xmin=z;this.ymin=f;this.xmax=e;this.ymax=g;this.spatialReference=K;this.mmax=this.mmin=this.zmax=this.zmin=void 0});d.jsonAdapter={convertToGEGeometry:function(z,f){return null==f?null:z.convertJSONToGeometry(f)},exportPoint:function(z,
f,e){e=new k(z.getPointX(f),z.getPointY(f),e);const g=z.hasZ(f),K=z.hasM(f);g&&(e.z=z.getPointZ(f));K&&(e.m=z.getPointM(f));return e},exportPolygon:function(z,f,e){return new J(z.exportPaths(f),e,z.hasZ(f),z.hasM(f))},exportPolyline:function(z,f,e){return new F(z.exportPaths(f),e,z.hasZ(f),z.hasM(f))},exportMultipoint:function(z,f,e){return new L(z.exportPoints(f),e,z.hasZ(f),z.hasM(f))},exportExtent:function(z,f,e){var g=z.hasZ(f);const K=z.hasM(f);e=new O(z.getXMin(f),z.getYMin(f),z.getXMax(f),
z.getYMax(f),e);g&&(g=z.getZExtent(f),e.zmin=g.vmin,e.zmax=g.vmax);K&&(z=z.getMExtent(f),e.mmin=z.vmin,e.mmax=z.vmax);return e}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(d){d.makeEdgeCandidate=function(u,k,J,F,L,O=!1){return{objectId:u,target:k,distance:J,type:"edge",start:F,end:L,draped:O}};d.makeVertexCandidate=function(u,k,J){return{objectId:u,target:k,distance:J,type:"vertex"}};Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),function(d,u,k,J,F,L,O,z,f,e,g,K,n){async function y(h,
H,q){if(!h)return null;var {where:A}=h;h.where=A=A&&A.trim();if(!A||/^1 *= *1$/.test(A)||H&&H===A)h.where=null;if(!h.geometry)return h;H=await D(h);h.distance=0;h.units=null;"esriSpatialRelEnvelopeIntersects"===h.spatialRel&&({spatialReference:A}=h.geometry,H=O.getGeometryExtent(H),H.spatialReference=A);if(H){await n.checkProjectionSupport(H.spatialReference,q);A=H.spatialReference;H=p(H,q)&&z.isExtent(H)?{spatialReference:A,rings:[[[H.xmin,H.ymin],[H.xmin,H.ymax],[H.xmax,H.ymax],[H.xmax,H.ymin],
[H.xmin,H.ymin]]]}:H;A=(await f.normalizeCentralMeridian(z.fromJSON(H)))[0];if(J.isNone(A))throw v;const C="quantizationParameters"in h&&h.quantizationParameters?.tolerance||"maxAllowableOffset"in h&&h.maxAllowableOffset||0;H=C&&p(H,q)?{densificationStep:8*C}:void 0;A=A.toJSON();H=await n.project(A,A.spatialReference,q,H);if(!H)throw v;H.spatialReference=q;h.geometry=H}return h}function p(h,H){if(!h)return!1;const q=h.spatialReference;return(z.isExtent(h)||z.isPolygon(h)||z.isPolyline(h))&&!e.equals(q,
H)&&!L.canProjectWithoutEngine(q,H)}async function D(h){const {distance:H,units:q}=h,A=h.geometry;if(null==H||"vertexAttributes"in A)return A;var C=A.spatialReference;h=q?E.fromJSON(q):F.getUnitString(C);C=C&&(e.isGeographic(C)||e.isWebMercator(C))?A:await n.checkProjectionSupport(C,e.WGS84).then(()=>n.project(A,e.WGS84));return(await t())(C.spatialReference,C,H,h)}async function t(){return(await new Promise((h,H)=>d(["../../../geometry/geometryEngineJSON"],h,H))).geodesicBuffer}const E=new k.JSONMap({esriSRUnit_Meter:"meters",
esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),v=Object.freeze({}),M=new K,B=new K,w=new K,c={esriGeometryPoint:g.convertToPoint,esriGeometryPolyline:g.convertToPolyline,esriGeometryPolygon:g.convertToPolygon,esriGeometryMultipoint:g.convertToMultipoint},m=(h,H)=>"_geVersion"!==h?H:void 0;u.QUERY_ENGINE_EMPTY_RESULT=v;u.cleanFromGeometryEngine=function(h){return h&&"_geVersion"in
h?JSON.parse(JSON.stringify(h,m)):h};u.getGeometry=function(h,H,q,A,C,P,I=H,G=q){const r=H&&I,R=q&&G;A=J.isSome(A)?"coords"in A?A:A.geometry:null;if(J.isNone(A))return null;if(C)return H=g.generalizeOptimizedGeometry(B,A,H,q,h,C,I,G),P&&(H=g.quantizeOptimizedGeometry(w,H,r,R,h,P)),c[h]?.(H,r,R)??null;if(P)return P=g.quantizeOptimizedGeometry(w,A,H,q,h,P,I,G),c[h]?.(P,r,R)??null;g.removeZMValues(M,A,H,q,I,G);return c[h]?.(M,r,R)??null};u.normalizeQuery=async function(h,H,q){const {outFields:A,orderByFields:C,
groupByFieldsForStatistics:P,outStatistics:I}=h;if(A)for(var G=0;G<A.length;G++)A[G]=A[G].trim();if(C)for(G=0;G<C.length;G++)C[G]=C[G].trim();if(P)for(G=0;G<P.length;G++)P[G]=P[G].trim();if(I)for(G=0;G<I.length;G++)I[G].onStatisticField&&(I[G].onStatisticField=I[G].onStatisticField.trim());h.geometry&&!h.outSR&&(h.outSR=h.geometry.spatialReference);return y(h,H,q)};u.normalizeQueryLike=y;u.transformCentroid=function(h,H,q,A=h.hasZ,C=h.hasM){if(J.isNone(H))return null;const P=h.hasZ&&A,I=h.hasM&&C;
return q?(h=g.quantizeOptimizedGeometry(w,H,h.hasZ,h.hasM,"esriGeometryPoint",q,A,C),g.convertToPoint(h,P,I)):g.convertToPoint(H,P,I)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ./SnappingPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e){function g(G,r){let R=[];if(y(G)){var {point:S}=G;p(r)?R=f.intersectLineAndPoint(r.lineLike,S):D(r)?R=f.intersectVerticalCylinderAndPoint(r.center,r.radius,S):t(r)?R=f.intersectVerticalPlaneAndPoint(r.planeLike,S):E(r)&&(R=K(r,G))}else if(p(G))({lineLike:S}=G),y(r)?R=f.intersectLineAndPoint(S,r.point):p(r)?R=f.intersectLineLike(S,r.lineLike):D(r)?R=f.intersectLineLikeAndVerticalCylinder(S,r.center,r.radius):t(r)?R=f.intersectVerticalPlaneAndLineLike(r.planeLike,S):E(r)&&
(R=K(r,G));else if(D(G)){const {center:T,radius:Z}=G;if(p(r))R=f.intersectLineLikeAndVerticalCylinder(r.lineLike,T,Z);else if(y(r))R=f.intersectVerticalCylinderAndPoint(T,Z,r.point);else{if(t(r))return f.intersectVerticalPlaneAndVerticalCylinder(r.planeLike,T,Z).map(da=>new m(da,G,r));E(r)&&(R=K(r,G))}}else if(t(G)){({planeLike:S}=G);if(t(r))return f.intersectVerticalPlane(S,r.planeLike).map(T=>new m(T,G,r));if(y(r))R=f.intersectVerticalPlaneAndPoint(S,r.point);else if(p(r))R=f.intersectVerticalPlaneAndLineLike(S,
r.lineLike);else{if(D(r))return f.intersectVerticalPlaneAndVerticalCylinder(S,r.center,r.radius).map(T=>new m(T,G,r));E(r)&&(R=K(r,G))}}else E(G)&&(R=K(G,r));return n(R,G,r)}function K(G,r){const {planeLike:R,getZ:S}=G,T=[];if(y(r))G.addIfOnTheGround(T,f.intersectVerticalPlaneAndPoint(R,r.point));else if(p(r))G.addIfOnTheGround(T,f.intersectVerticalPlaneAndLineLike(R,r.lineLike));else if(D(r))for(const [Z,da]of f.intersectVerticalPlaneAndVerticalCylinder(R,r.center,r.radius))G=S(Z,da,0),k.isSome(G)&&
T.push(O.fromValues(Z,da,G));else if(t(r)||E(r))for(const [Z,da]of f.intersectVerticalPlane(R,r.planeLike))G=k.toNullable(S(Z,da,0))??0,T.push(O.fromValues(Z,da,G));return T}function n(G,r,R){return G.map(S=>new c(z.asSnappingPoint(S),r,R))}function y(G){return G instanceof M}function p(G){return G instanceof B}function D(G){return G instanceof h}function t(G){return G instanceof H}function E(G){return G instanceof C}let v=function(){function G(){}G.prototype.intersect=function(r){return g(this,r)};
return u._createClass(G)}(),M=function(G){function r(S){var T=R.call(this);T.point=S;return T}u._inherits(r,G);var R=u._createSuper(r);G=r.prototype;G.equals=function(S){return y(S)&&L.exactEquals(this.point,S.point)};G.closestTo=function(){return z.cloneSnappingPoint(this.point)};return u._createClass(r)}(v),B=function(G){function r(S,T,Z){var da=R.call(this);da.start=S;da.end=T;da.type=Z;da.lineLike={start:da.start,end:da.end,type:da.type};return da}u._inherits(r,G);var R=u._createSuper(r);G=r.prototype;
G.equals=function(S){return p(S)&&this.type===S.type&&L.exactEquals(this.start,S.start)&&L.exactEquals(this.end,S.end)};G.closestTo=function(S){S=f.projectPointToLineLike(S,this.lineLike);return z.asSnappingPoint(S)};return u._createClass(r)}(v),w=function(G){function r(S,T){return R.call(this,S,T,e.LineType.LINE)}u._inherits(r,G);var R=u._createSuper(r);return u._createClass(r)}(B),c=function(G){function r(S,T,Z){var da=R.call(this);da.intersection=S;da.first=T;da.second=Z;return da}u._inherits(r,
G);var R=u._createSuper(r);G=r.prototype;G.equals=function(S){return S instanceof r&&this.first.equals(S.first)&&this.second.equals(S.second)};G.closestTo=function(){return z.cloneSnappingPoint(this.intersection)};return u._createClass(r)}(v),m=function(G){function r(S,T,Z){var da=R.call(this);da.basePoint=S;da.first=T;da.second=Z;return da}u._inherits(r,G);var R=u._createSuper(r);G=r.prototype;G.equals=function(S){return S instanceof r&&this.first.equals(S.first)&&this.second.equals(S.second)};G.closestTo=
function(S){const T=this.basePoint;return z.asSnappingPoint(O.fromValues(T[0],T[1],S[2]))};return u._createClass(r)}(v),h=function(G){function r(S,T){var Z=R.call(this);Z.center=S;Z.radius=T;return Z}u._inherits(r,G);var R=u._createSuper(r);G=r.prototype;G.equals=function(S){return D(S)&&this.center[0]===S.center[0]&&this.center[1]===S.center[1]&&this.radius===S.radius};G.closestTo=function(S){S=f.projectPointToVerticalCylinder(S,this.center,this.radius);return z.asSnappingPoint(S)};return u._createClass(r)}(v),
H=function(G){function r(S,T,Z){var da=R.call(this);da.start=S;da.end=T;da.type=Z;da.planeLike={start:S,end:T,type:Z};return da}u._inherits(r,G);var R=u._createSuper(r);G=r.prototype;G.equals=function(S){return t(S)&&this.type===S.type&&L.exactEquals(this.start,S.start)&&L.exactEquals(this.end,S.end)};G.closestTo=function(S){return z.asSnappingPoint(f.projectPointToVerticalPlane(S,this.planeLike))};G.closestEndTo=function(S){const {start:T,end:Z}=this;return 0<Math.sign(J.dot(J.subtract(P,Z,T),J.subtract(I,
S,T)))?Z:T};return u._createClass(r)}(v),q=function(G){function r(S,T){return R.call(this,S,T,f.VerticalPlaneType.HALF_PLANE)}u._inherits(r,G);var R=u._createSuper(r);return u._createClass(r)}(H),A=function(G){function r(S,T){return R.call(this,S,T,f.VerticalPlaneType.PLANE)}u._inherits(r,G);var R=u._createSuper(r);return u._createClass(r)}(H),C=function(G){function r(S,T,Z){var da=R.call(this);da.start=S;da.end=T;da.getZ=Z;da.planeLike={start:S,end:T,type:f.VerticalPlaneType.PLANE};return da}u._inherits(r,
G);var R=u._createSuper(r);G=r.prototype;G.equals=function(S){return E(S)&&L.exactEquals(this.start,S.start)&&L.exactEquals(this.end,S.end)&&this.getZ===S.getZ};G.closestTo=function(S){const T=f.projectPointToVerticalPlane(S,this.planeLike);T[2]=k.toNullable(this.getZ(S[0],S[1],S[2]))??0;return z.asSnappingPoint(T)};G.addIfOnTheGround=function(S,T){for(const Z of T)T=k.unwrapOr(this.getZ(Z[0],Z[1],Z[2]),0),Math.abs(Z[2]-T)<f.epsilon&&(Z[2]=T,S.push(Z))};return u._createClass(r)}(v);const P=F.create(),
I=F.create();d.DrapedLineConstraint=C;d.IntersectionConstraint=c;d.LineConstraint=w;d.LineLikeConstraint=B;d.PointConstraint=M;d.SnappingConstraint=v;d.VerticalCylinderConstraint=h;d.VerticalHalfPlaneConstraint=q;d.VerticalLineIntersectionConstraint=m;d.VerticalPlaneConstraint=A;d.VerticalPlaneLikeConstraint=H;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingPoint":function(){define(["exports","../../../core/maybe","../../../chunks/vec3f64",
"../../../layers/graphics/dehydratedFeatures","../../../support/elevationInfoUtils"],function(d,u,k,J,F){function L(z,f,e){if(u.isNone(z))return null;if(u.isNone(f))return k.fromValues(z.x,z.y,z.z??0);if("2d"===f.type)return k.fromValues(z.x,z.y,0);({elevationInfo:e}=e);f=F.getConvertedElevation(f,z,e,F.absoluteHeightElevationInfo)??0;return k.fromValues(z.x,z.y,f)}const O=J.makeDehydratedPoint(0,0,0,null);d.anyMapPointToSnappingPoint=function(z,f,e){return u.isNone(z)?null:L(e.coordinateHelper.vectorToDehydratedPoint(z,
O),f,e)};d.asSnappingPoint=function(z){return z};d.cloneSnappingPoint=function(z){return k.clone(z)};d.createSnappingPoint=function(z,f,e){return k.fromValues(z,f,e)};d.pointToSnappingPoint=L;d.snappingPointToDehydratedPoint=function(z,f){return J.makeDehydratedPoint(z[0],z[1],z[2],f)};d.snappingPointToSnappingOutput=function(z,f,{z:e,m:g,spatialReference:K,elevationInfo:n}){if(null==e&&null==g)return z=J.makeDehydratedPoint(z[0],z[1],void 0,K),null!=g&&(z.m=g,z.hasM=!0),z;if(u.isNone(f)||"2d"===
f.type)return z=J.makeDehydratedPoint(z[0],z[1],e,K),null!=g&&(z.m=g,z.hasM=!0),z;f=F.getConvertedElevationFromVector(f,z,K,F.absoluteHeightElevationInfo,n)??0;z=J.makeDehydratedPoint(z[0],z[1],f,K);null!=g&&(z.m=g,z.hasM=!0);return z};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatures":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/byteSizeEstimations ../../core/has ../../core/maybe ../../core/typedArrayUtil ../../core/uid ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/quantizationUtils ../../geometry/support/typeUtils ../support/Field ./dehydratedFeatureComparison".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y){function p(t,E,v){if(F.isNone(t))return null;switch(E){case "point":return{x:t.x,y:t.y,z:t.z,m:t.m,hasZ:null!=t.z,hasM:null!=t.m,type:"point",spatialReference:v};case "polyline":return{paths:t.paths,hasZ:!!t.hasZ,hasM:!!t.hasM,type:"polyline",spatialReference:v};case "polygon":return{rings:t.rings,hasZ:!!t.hasZ,hasM:!!t.hasM,type:"polygon",spatialReference:v};case "multipoint":return{points:t.points,hasZ:!!t.hasZ,hasM:!!t.hasM,type:"multipoint",spatialReference:v}}}
function D(t){if(F.isNone(t))return 0;let E=32;switch(t.type){case "point":E+=42;break;case "polyline":case "polygon":var v=0;const M=2+(t.hasZ?1:0)+(t.hasM?1:0);t="polyline"===t.type?t.paths:t.rings;for(const B of t)v+=B.length;E+=8*v*M+64;E+=128*v;E=E+34+32*(t.length+1);break;case "multipoint":v=t.points.length;E+=8*v*(2+(t.hasZ?1:0)+(t.hasM?1:0))+64;E+=128*v;E=E+34+32;break;case "extent":E+=98;t.hasM&&(E+=32);t.hasZ&&(E+=32);break;case "mesh":E+=L.estimateSize(t.vertexAttributes.position),E+=L.estimateSize(t.vertexAttributes.normal),
E+=L.estimateSize(t.vertexAttributes.uv),E+=L.estimateSize(t.vertexAttributes.tangent)}return E}J=u._createClass(function(t,E,v){this.uid=t;this.geometry=E;this.attributes=v;this.visible=!0;this.centroid=this.objectId=null});u=u._createClass(function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null});d.equals=
y.equals;d.DehydratedFeatureClass=J;d.DehydratedFeatureSetClass=u;d.computeAABB=function(t,E){f.empty(E);"mesh"===t.type&&(t=t.extent);switch(t.type){case "point":E[0]=E[3]=t.x;E[1]=E[4]=t.y;t.hasZ&&(E[2]=E[5]=t.z);break;case "polyline":for(var v=0;v<t.paths.length;v++)f.expandWithNestedArray(E,t.paths[v],!!t.hasZ);break;case "polygon":for(v=0;v<t.rings.length;v++)f.expandWithNestedArray(E,t.rings[v],!!t.hasZ);break;case "multipoint":f.expandWithNestedArray(E,t.points,!!t.hasZ);break;case "extent":E[0]=
t.xmin,E[1]=t.ymin,E[3]=t.xmax,E[4]=t.ymax,null!=t.zmin&&(E[2]=t.zmin),null!=t.zmax&&(E[5]=t.zmax)}};d.computeAABR=function(t,E){e.empty(E);"mesh"===t.type&&(t=t.extent);switch(t.type){case "point":E[0]=E[2]=t.x;E[1]=E[3]=t.y;break;case "polyline":for(var v=0;v<t.paths.length;v++)e.expandWithNestedArray(E,t.paths[v]);break;case "polygon":for(v=0;v<t.rings.length;v++)e.expandWithNestedArray(E,t.rings[v]);break;case "multipoint":e.expandWithNestedArray(E,t.points);break;case "extent":E[0]=t.xmin,E[1]=
t.ymin,E[2]=t.xmax,E[3]=t.ymax}};d.estimateGeometryObjectSize=D;d.estimateSize=function(t){let E;E=32+k.estimateAttributesObjectSize(t.attributes);return E=E+3+(8+D(t.geometry))};d.fromFeatureSetJSON=function(t){const E=K.featureGeometryTypeKebabDictionary.fromJSON(t.geometryType),v=z.fromJSON(t.spatialReference),M=t.transform,B=t.features.map(w=>{var c=t.objectIdFieldName;w={uid:O.generateUID(),objectId:c&&w.attributes?w.attributes[c]:null,attributes:w.attributes,geometry:p(w.geometry,E,v),visible:!0};
c=w.geometry;if(F.isSome(c)&&M)switch(c.type){case "point":w.geometry=g.unquantizePoint(M,c,c,c.hasZ,c.hasM);break;case "multipoint":w.geometry=g.unquantizeMultipoint(M,c,c,!!c.hasZ,!!c.hasM);break;case "polygon":w.geometry=g.unquantizePolygon(M,c,c,!!c.hasZ,!!c.hasM);break;case "polyline":w.geometry=g.unquantizePolyline(M,c,c,!!c.hasZ,!!c.hasM);break;case "extent":w.geometry=c;break;case "mesh":w.geometry=c}return w});return{geometryType:E,features:B,spatialReference:v,fields:t.fields?.map(w=>n.fromJSON(w))??
[],objectIdFieldName:t.objectIdFieldName,globalIdFieldName:t.globalIdFieldName,geohashFieldName:t.geohashFieldName,geometryProperties:t.geometryProperties,hasZ:t.hasZ,hasM:t.hasM,exceededTransferLimit:t.exceededTransferLimit,transform:null}};d.fromJSONGeometry=p;d.getObjectId=function(t,E){return null!=t.objectId?t.objectId:t.attributes&&E?t.attributes[E]:null};d.hasGeometry=function(t){return F.isSome(t.geometry)};d.hasVertices=function(t){if(F.isNone(t))return!1;switch(t.type){case "extent":case "point":return!0;
case "polyline":for(const E of t.paths)if(0<E.length)return!0;return!1;case "polygon":for(const E of t.rings)if(0<E.length)return!0;return!1;case "multipoint":return 0<t.points.length;case "mesh":return!t.loaded||0<t.vertexAttributes.position.length}};d.makeDehydratedPoint=function(t,E,v,M){return{x:t,y:E,z:v,hasZ:null!=v,hasM:!1,spatialReference:M,type:"point"}};d.numVertices=function(t){if(F.isNone(t))return 0;switch(t.type){case "point":return 1;case "polyline":var E=0;for(var v of t.paths)E+=
v.length;return E;case "polygon":v=0;for(E of t.rings)v+=E.length;return v;case "multipoint":return t.points.length;case "extent":return 2;case "mesh":return(t=t.vertexAttributes&&t.vertexAttributes.position)?t.length/3:0}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["exports","../../core/has","../../core/maybe","../../geometry/support/spatialReferenceUtils"],function(d,u,k,J){function F(e,g){if(e===g)return!0;
if(null==e||null==g||e.length!==g.length)return!1;for(let K=0;K<e.length;K++){const n=e[K],y=g[K];if(n.length!==y.length)return!1;for(let p=0;p<n.length;p++)if(n[p]!==y[p])return!1}return!0}function L(e,g){if(e===g)return!0;if(null==e||null==g||e.length!==g.length)return!1;for(let K=0;K<e.length;K++)if(!F(e[K],g[K]))return!1;return!0}function O(e,g){return e===g||k.isSome(e)&&k.isSome(g)&&J.equals(e.spatialReference,g.spatialReference)&&e.x===g.x&&e.y===g.y&&e.z===g.z&&e.m===g.m}function z(e,g){if(e===
g)return!0;if(k.isNone(e)||k.isNone(g)||e.type!==g.type)return!1;switch(e.type){case "point":return O(e,g);case "extent":return e=e.hasZ!==g.hasZ||e.hasM!==g.hasM?!1:J.equals(e.spatialReference,g.spatialReference)?e.xmin===g.xmin&&e.ymin===g.ymin&&e.zmin===g.zmin&&e.xmax===g.xmax&&e.ymax===g.ymax&&e.zmax===g.zmax:!1,e;case "polyline":return e=e.hasZ!==g.hasZ||e.hasM!==g.hasM?!1:J.equals(e.spatialReference,g.spatialReference)?L(e.paths,g.paths):!1,e;case "polygon":return e=e.hasZ!==g.hasZ||e.hasM!==
g.hasM?!1:J.equals(e.spatialReference,g.spatialReference)?L(e.rings,g.rings):!1,e;case "multipoint":return e=e.hasZ!==g.hasZ||e.hasM!==g.hasM?!1:J.equals(e.spatialReference,g.spatialReference)?F(e.points,g.points):!1,e;case "mesh":return!1}}function f(e,g){if(e===g)return!0;if(!e||!g)return!1;const K=Object.keys(e),n=Object.keys(g);if(K.length!==n.length)return!1;for(const y of K)if(e[y]!==g[y])return!1;return!0}d.equals=function(e,g){return e===g?!0:null!=e&&null!=g&&e.objectId===g.objectId&&z(e.geometry,
g.geometry)&&f(e.attributes,g.attributes)?!0:!1};d.pointEquals=O;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ./geometry2dUtils".split(" "),function(d,u,k,J,F,L,O){function z(c,{start:m,end:h,type:H}){c=F.sub(y,c,m);h=F.sub(p,h,m);c=F.dot(c,h)/F.dot(h,h);return F.scaleAndAdd(L.create(),m,h,H===O.LineType.RAY?Math.max(c,
0):c)}function f({start:c,end:m,type:h},H){const q=F.sub(y,H,c);m=F.sub(p,m,c);if(h===O.LineType.RAY&&-1E-6>F.dot(m,q))return F.distance(c,H);c=F.cross(D,m,q);return F.len(c)/F.len(m)}function e(c,m){const h=c.start,H=m.start;var q=m.end;const A=F.sub(y,c.end,h);q=F.sub(p,q,H);var C=F.sub(D,H,h),P=F.cross(t,A,q),I=F.dot(C,P);if(!u.floatEqualAbsolute(I,0,1E-6))return[];I=F.sqrLen(P);if(u.floatEqualAbsolute(I,0,1E-6))return[];C=F.cross(E,C,q);P=F.dot(C,P)/I;P=F.scaleAndAdd(v,h,A,P);return c.type===
O.LineType.RAY&&(c=F.sub(M,P,h),-1E-6>F.dot(A,c))||m.type===O.LineType.RAY&&(m=F.sub(M,P,H),-1E-6>F.dot(q,m))?[]:[L.clone(P)]}function g({start:c,end:m,type:h},H){const q=F.sub(y,H,c);c=F.sub(p,m,c);m=F.cross(D,c,q);if(1E-6>F.sqrLen(m)/F.sqrLen(c))switch(h){case O.LineType.LINE:return[L.clone(H)];case O.LineType.RAY:return-1E-6>F.dot(c,q)?[]:[L.clone(H)]}return[]}function K(c,m,{start:h,end:H,type:q}){F.set(c.start,h[0],h[1],m);F.set(c.end,H[0],H[1],m);c.type=n[q];return c}d.VerticalPlaneType=void 0;
(function(c){c[c.PLANE=0]="PLANE";c[c.HALF_PLANE=1]="HALF_PLANE"})(d.VerticalPlaneType||(d.VerticalPlaneType={}));const n={[d.VerticalPlaneType.PLANE]:O.LineType.LINE,[d.VerticalPlaneType.HALF_PLANE]:O.LineType.RAY},y=L.create(),p=L.create(),D=L.create(),t=L.create(),E=L.create(),v=L.create(),M=L.create(),B={start:L.create(),end:L.create(),type:O.LineType.LINE},w={start:L.create(),end:L.create(),type:O.LineType.LINE};Object.defineProperty(d,"LineType",{enumerable:!0,get:()=>O.LineType});d.epsilon=
1E-6;d.intersectLineAndPoint=g;d.intersectLineLike=e;d.intersectLineLikeAndVerticalCylinder=function({start:c,end:m,type:h},H,q){const A=[];m=F.subtract(y,m,c);var C=k.subtract(p,c,H);H=k.squaredLength(m);const P=2*k.dot(m,C);q=k.squaredLength(C)-q*q;q=P*P-4*H*q;0===q?(H=-P/(2*H),(h===O.LineType.LINE||0<=H)&&A.push(F.scaleAndAdd(L.create(),c,m,H))):0<q&&(q=Math.sqrt(q),C=(-P+q)/(2*H),(h===O.LineType.LINE||0<=C)&&A.push(F.scaleAndAdd(L.create(),c,m,C)),H=(-P-q)/(2*H),(h===O.LineType.LINE||0<=H)&&A.push(F.scaleAndAdd(L.create(),
c,m,H)));return A};d.intersectVerticalCylinderAndPoint=function(c,m,h){return u.floatEqualAbsolute(k.squaredDistance(h,c),m*m,1E-6)?[L.clone(h)]:[]};d.intersectVerticalPlane=function(c,m){c=K(B,0,c);m=K(w,0,m);m=e(c,m);c=[];for(const h of m)c.push(J.clone(h));return c};d.intersectVerticalPlaneAndLineLike=function(c,m){const h=c.start,H=k.subtract(y,c.end,h);var q=F.set(p,-H[1],H[0],0);const A=m.start,C=F.sub(D,m.end,A);var P=F.dot(C,q),I=F.set(t,h[0],h[1],0);I=F.sub(E,I,A);q=F.dot(I,q);if(1E-6>Math.abs(P))return[];
P=F.scaleAndAdd(v,A,C,q/P);return m.type===O.LineType.RAY&&(m=F.sub(M,P,A),-1E-6>F.dot(m,C))||c.type===d.VerticalPlaneType.HALF_PLANE&&(c=k.sub(M,P,h),-1E-6>k.dot(c,H))?[]:[L.clone(P)]};d.intersectVerticalPlaneAndPoint=function(c,m){return g(K(B,m[2],c),m)};d.intersectVerticalPlaneAndVerticalCylinder=function({start:c,end:m,type:h},H,q){const A=[];m=k.subtract(y,m,c);var C=k.subtract(p,c,H);H=k.squaredLength(m);const P=2*k.dot(m,C);q=k.squaredLength(C)-q*q;q=P*P-4*H*q;0===q?(H=-P/(2*H),(h===d.VerticalPlaneType.PLANE||
0<=H)&&A.push(k.scaleAndAdd(J.create(),c,m,H))):0<q&&(q=Math.sqrt(q),C=(-P+q)/(2*H),(h===d.VerticalPlaneType.PLANE||0<=C)&&A.push(k.scaleAndAdd(J.create(),c,m,C)),H=(-P-q)/(2*H),(h===d.VerticalPlaneType.PLANE||0<=H)&&A.push(k.scaleAndAdd(J.create(),c,m,H)));return A};d.pointToLineLikeDistance=f;d.pointToVerticalCylinderDistance=function(c,m,h){return k.distance(c,m)-h};d.pointToVerticalPlaneDistance=function(c,m){return f(K(B,c[2],m),c)};d.projectPointToLineLike=z;d.projectPointToVerticalCylinder=
function(c,m,h){const H=k.subtract(y,c,m);h/=k.length(H);m=k.scaleAndAdd(L.create(),m,H,h);m[2]=c[2];return m};d.projectPointToVerticalPlane=function(c,m){return z(c,K(B,c[2],m))};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(d,u,k,J){function F(n,y){return n[0]*y[1]-n[1]*y[0]}function L(n,y,p){y=k.dot(p,y)/k.squaredLength(p);return k.scale(n,
p,y)}function O(n,y,p,D,t=p){k.subtract(f,D,p);k.subtract(g,y,t);L(K,g,f);return k.add(n,t,K)}function z(n,y,p,D){k.subtract(f,y,p);y=D/k.length(f);return k.scaleAndAdd(n,p,f,y)}d.LineType=void 0;(function(n){n[n.RAY=0]="RAY";n[n.LINE=1]="LINE"})(d.LineType||(d.LineType={}));const f=J.create(),e=J.create(),g=J.create(),K=J.create();d.cross=F;d.intersectCircleAndPoint=function(n,y,p){z(g,p,n,y);return u.floatEqualAbsolute(g[0],p[0])&&u.floatEqualAbsolute(g[1],p[1])?[J.clone(p)]:[]};d.intersectLineAndPoint=
function(n,y){O(g,y,n.start,n.end);return u.floatEqualAbsolute(g[0],y[0])&&u.floatEqualAbsolute(g[1],y[1])?[J.clone(y)]:[]};d.intersectLineAndRay=function(n,y){const p=n.start;var D=y.start,t=y.end;const E=k.subtract(f,n.end,p);var v=k.subtract(e,t,D);t=F(E,v);if(1E-6>=Math.abs(t))return[];D=k.subtract(g,p,D);v=F(v,D)/t;t=F(E,D)/t;if(0<=v){if(0<=t||y.type===d.LineType.LINE)return[k.scaleAndAdd(K,p,E,v)]}else if(n.type===d.LineType.LINE&&(0<=t||y.type===d.LineType.LINE))return[k.scaleAndAdd(K,p,E,
v)];return[]};d.intersectLineLikeAndCircle=function(n,y,p){const D=[],t=k.subtract(f,n.end,n.start);var E=k.subtract(e,n.start,y);y=k.squaredLength(t);const v=2*k.dot(t,E);p=k.squaredLength(E)-p*p;p=v*v-4*y*p;0===p?(y=-v/(2*y),(n.type===d.LineType.LINE||0<=y)&&D.push(k.scaleAndAdd(K,n.start,t,y))):0<p&&(p=Math.sqrt(p),E=(-v+p)/(2*y),(n.type===d.LineType.LINE||0<=E)&&D.push(k.scaleAndAdd(K,n.start,t,E)),y=(-v-p)/(2*y),(n.type===d.LineType.LINE||0<=y)&&D.push(k.scaleAndAdd(g,n.start,t,y)));return D};
d.pointToLineDistance=function(n,y,p){return Math.abs((y[0]-n[0])*(p[1]-n[1])-(y[1]-n[1])*(p[0]-n[0]))/k.distance(y,p)};d.projectPoint=L;d.projectPointToCircle=z;d.projectPointToLine=O;d.projectPointToRay=function(n,y,p,D){k.subtract(f,D,p);k.subtract(g,y,p);y=k.dot(f,g)/k.squaredLength(f);return 0<y?k.scaleAndAdd(n,p,f,y):k.copy(n,p)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/maybe ../../../core/reactiveUtils ../../../chunks/vec3 ../../../layers/graphics/dehydratedFeatures ../../input/InputManager ../keybindings ./SnappingPoint".split(" "),
function(d,u,k,J,F,L,O,z){function f(e,g){const K=e.x-g.x;e=e.y-g.y;return K*K+e*e}d.LineSegmentHintType=void 0;(function(e){e[e.TARGET=0]="TARGET";e[e.REFERENCE=1]="REFERENCE";e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(d.LineSegmentHintType||(d.LineSegmentHintType={}));d.editEdgeToSnappingEdge=function(e,g,K){return{left:z.anyMapPointToSnappingPoint(e.leftVertex.pos,g,K),right:z.anyMapPointToSnappingPoint(e.rightVertex.pos,g,K)}};d.makeFilter=function(e){return e.createQuery()};d.makeSnappingQuery=
function({point:e,distance:g,types:K,coordinateHelper:{spatialReference:n}},y,p){return{point:F.makeDehydratedPoint(e[0],e[1],e[2],n.toJSON()),mode:y,distance:g,types:K,query:u.isSome(p)?p.toJSON():{where:"1\x3d1"}}};d.objectEqual=function(e,g){const K=e.length===g.length&&e[0]===g[0]&&e[1]===g[1];switch(e.length){case 2:return K;case 3:return K&&e[2]===g[2];case 4:return K&&e[2]===g[2]&&e[3]===g[3]}return!1};d.screenDistance=function(e,g){return Math.sqrt(f(e,g))};d.setupSnappingToggleHandles=function(e,
g=()=>{}){const K=k.watch(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:n,snappingOptions:y})=>{const p=L.ViewEventPriorities.TOOL;e.removeHandles("snapping-toggle");n&&u.isSome(y)&&(n=[n.on("key-down",D=>{D.key!==O.SNAPPING_KEYS.toggle||D.repeat||(y.enabledToggled=!0,g())},p),n.on("key-up",D=>{D.key===O.SNAPPING_KEYS.toggle&&(y.enabledToggled=!1,g())},p),n.on("pointer-move",D=>{D=D.native.ctrlKey;y.enabledToggled!==D&&(y.enabledToggled=D,g())},p)],e.addHandles(n,"snapping-toggle"))},
k.syncAndInitial);e.addHandles(K)};d.sortCandidatesInPlace=function(e,g){g.sort((K,n)=>{K=J.squaredDistance(K.targetPoint,e);n=J.squaredDistance(n.targetPoint,e);return K-n})};d.squaredScreenDistance=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(d,u,k,J,F,L){F=function(O){function z(e){return f.call(this,{...e,isDraped:!0,constraint:new k.DrapedLineConstraint(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}u._inherits(z,O);var f=u._createSuper(z);u._createClass(z,[{key:"hints",get:function(){return[new L.LineSnappingHint(J.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return z}(F.FeatureSnappingCandidate);d.DrapedEdgeSnappingCandidate=F;Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingDomain","./SnappingCandidate"],function(d,u,k,J){J=function(F){function L({targetPoint:z,objectId:f,constraint:e,isDraped:g}){z=O.call(this,z,e,g,k.SnappingDomain.FEATURE);z.objectId=f;return z}u._inherits(L,F);var O=u._createSuper(L);return u._createClass(L)}(J.SnappingCandidate);d.FeatureSnappingCandidate=J;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(d,u){u=u._createClass(function(k,J,F,L){this.targetPoint=k;this.constraint=J;this.isDraped=F;this.domain=L});d.SnappingCandidate=u;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(d,u,k,J,F,L,O){k=function(z){function f(g,K,n,y,p=L.SnappingDomain.ALL,D=!0,t=!0){y=e.call(this,y,p);y.type=g;y.lineStart=K;y.lineEnd=n;y.fadeLeft=D;y.fadeRight=t;return y}u._inherits(f,z);var e=u._createSuper(f);f.prototype.equals=function(g){return g instanceof f?this.type===g.type&&F.exactEquals(this.lineStart,g.lineStart)&&F.exactEquals(this.lineEnd,g.lineEnd)&&this.fadeLeft===g.fadeLeft&&this.fadeRight===g.fadeRight:!1};u._createClass(f,[{key:"length",get:function(){return F.distance(this.lineStart,
this.lineEnd)}}]);return f}(O.SnappingHint);d.LineSnappingHint=k;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(d,u){u=u._createClass(function(k,J){this.isDraped=k;this.domain=J});d.SnappingHint=u;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(d,u,k,J,F,L){F=function(O){function z(e){return f.call(this,{...e,constraint:new k.LineConstraint(e.edgeStart,e.edgeEnd)})}u._inherits(z,O);var f=u._createSuper(z);u._createClass(z,[{key:"hints",get:function(){return[new L.LineSnappingHint(J.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return z}(F.FeatureSnappingCandidate);d.EdgeSnappingCandidate=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(d,u,k,J,F,L,O){F=function(z){function f({targetPoint:g,constraint:K,previousVertex:n,otherVertex:y,otherVertexType:p,objectId:D,isDraped:t}){g=e.call(this,g,K,t,k.SnappingDomain.SELF);g.previousVertex=n;g.otherVertex=y;g.otherVertexType=p;g.objectId=D;return g}u._inherits(f,z);var e=u._createSuper(f);u._createClass(f,[{key:"hints",get:function(){const g=this.previousVertex,K=this.otherVertexType===d.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===d.OtherVertexType.CENTER?
this.targetPoint:this.otherVertex;return[new L.LineSnappingHint(J.LineSegmentHintType.TARGET,K,n,this.isDraped,this.domain),new L.LineSnappingHint(J.LineSegmentHintType.REFERENCE,g,K,this.isDraped,this.domain),new O.RightAngleSnappingHint(this.previousVertex,K,n,this.isDraped,this.domain)]}}]);return f}(F.SnappingCandidate);d.OtherVertexType=void 0;(function(z){z[z.NEXT=0]="NEXT";z[z.CENTER=1]="CENTER"})(d.OtherVertexType||(d.OtherVertexType={}));d.RightAngleSnappingCandidate=F;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(d,u,k,J,F,L,O){k=function(z){function f(g,K,n,y,p=L.SnappingDomain.ALL){y=e.call(this,y,p);y.previousVertex=g;y.centerVertex=K;y.nextVertex=n;return y}u._inherits(f,z);var e=u._createSuper(f);f.prototype.equals=
function(g){return g instanceof f?F.exactEquals(this.previousVertex,g.previousVertex)&&F.exactEquals(this.centerVertex,g.centerVertex)&&F.exactEquals(this.nextVertex,g.nextVertex):!1};return u._createClass(f)}(O.SnappingHint);d.RightAngleSnappingHint=k;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/dehydratedFeatures ../../../support/elevationInfoUtils".split(" "),
function(d,u,k,J,F,L,O){function z(D,t,E,v,M=F.create()){D=t.toXYZ(D);D[2]=O.getConvertedElevationFromVector(v,D,t.spatialReference,E)||0;v.renderCoordsHelper.toRenderCoords(D,t.spatialReference,M);return M}function f(D,t,E,v,M=F.create()){D=J.copy(K,D);D[2]=O.getConvertedElevationFromVector(v,D,t,E)||0;v.renderCoordsHelper.toRenderCoords(D,t,M);return M}function e(D,t,E,v){if("2d"===v.type)return g.x=D[0],g.y=D[1],g.spatialReference=t,v.toScreen(g);f(D,t,E,v,K);v.state.camera.projectToScreen(K,p);
return u.createScreenPoint(p[0],p[1])}const g=L.makeDehydratedPoint(0,0,0,null),K=F.create(),n=u.createRenderScreenPointArray3(),y=u.createRenderScreenPointArray3(),p=u.createScreenPointArray();d.anyMapPointToRender=z;d.anyMapPointToScreenPoint=function(D,t,E,v){return e(t.toXYZ(D),t.spatialReference,E,v)};d.anyMapPointsToRenderWithEqualRelativeZ=function(D,t,E,v,M,B,w){if("absolute-height"===v.mode)z(D,E,v,M,B),z(t,E,v,M,w);else{D=E.toXYZ(D);t=E.toXYZ(t);var c=O.getConvertedElevationFromVector(M,
D,E.spatialReference,v);v=O.getConvertedElevationFromVector(M,t,E.spatialReference,v);v=(null==c?v:null==v?c:Math.min(c,v))||0;D[2]=v;t[2]=v;M.renderCoordsHelper.toRenderCoords(D,E.spatialReference,B);M.renderCoordsHelper.toRenderCoords(t,E.spatialReference,w)}};d.renderScreenSpaceTangent=function(D,t,E,v){E.projectToRenderScreen(D,n);E.projectToRenderScreen(t,y);k.subtract(v,y,n);k.normalize(v,v)};d.vectorToRender=f;d.vectorToScreenPoint=e;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p,D){d.SelfSnappingEngine=function(t){function E(M){M=v.call(this,M);M.updating=!1;M._snappers=new F;M._domain=p.SnappingDomain.SELF;return M}u._inherits(E,t);var v=u._createSuper(E);t=E.prototype;t.initialize=function(){this._snappers.push(new K.ParallelLineSnapper(this.view,this.options),new g.LineSnapper(this.view,this.options),new n.RightAngleSnapper(this.view,this.options),new y.RightAngleTriangleSnapper(this.view,this.options))};t.fetchCandidates=async function(M,
B,w){if(!(B&this._domain&&this.options.effectiveSelfEnabled))return[];B=[];for(const c of this._snappers.items)for(const m of c.snap(M,w))B.push(m);D.sortCandidatesInPlace(M,B);return B};u._createClass(E,[{key:"options",set:function(M){this._set("options",M);for(const B of this._snappers)B.options=M}}]);return E}(J);k.__decorate([L.property({readOnly:!0})],d.SelfSnappingEngine.prototype,"updating",void 0);k.__decorate([L.property({constructOnly:!0})],d.SelfSnappingEngine.prototype,"view",void 0);
k.__decorate([L.property()],d.SelfSnappingEngine.prototype,"options",null);d.SelfSnappingEngine=k.__decorate([e.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],d.SelfSnappingEngine);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g){F=function(K){function n(){return y.apply(this,arguments)}u._inherits(n,K);var y=u._createSuper(n);K=n.prototype;K.snapNewVertex=function(p,D){var t=D.editGeometryOperations.data.components[0],E=t.edges.length;const v=[];if(1>E)return v;var {spatialReference:M}=D;M=f.vectorToScreenPoint(p,M,J.absoluteHeightElevationInfo,this.view);const {view:B}=this;E=t=t.edges[E-1];do{if(this.edgeExceedsShortLineThreshold(E,D)){const w=O.editEdgeToSnappingEdge(E,B,D);this._processCandidateProposal(w.left,
w.right,p,M,D,v)}E=E.leftVertex.leftEdge}while(E&&E!==t);return v};K.snapExistingVertex=function(p,D){const t=[],E=k.unwrap(D.vertexHandle);var v=E.component;if(2>v.edges.length)return t;const {view:M}=this;var {spatialReference:B}=D;B=f.vectorToScreenPoint(p,B,J.absoluteHeightElevationInfo,M);var w=E.leftEdge,c=E.rightEdge;w&&c&&this.edgeExceedsShortLineThreshold(w,D)&&this.edgeExceedsShortLineThreshold(c,D)&&this._processCandidateProposal(L.anyMapPointToSnappingPoint(w.leftVertex.pos,M,D),L.anyMapPointToSnappingPoint(c.rightVertex.pos,
M,D),p,B,D,t);w=v=v.edges[0];do w!==E.leftEdge&&w!==E.rightEdge&&this.edgeExceedsShortLineThreshold(w,D)&&(c=O.editEdgeToSnappingEdge(w,M,D),this._processCandidateProposal(c.left,c.right,p,B,D,t)),w=w.rightVertex.rightEdge;while(w&&w!==v);return t};K._processCandidateProposal=function(p,D,t,E,v,M){const {spatialReference:B,pointer:w}=v;t=L.asSnappingPoint(e.projectPointToLineLike(t,{start:p,end:D,type:g.LineType.LINE}));O.squaredScreenDistance(E,f.vectorToScreenPoint(t,B,J.absoluteHeightElevationInfo,
this.view))<this.squaredProximityThreshold(w)&&M.push(new z.LineSnappingCandidate({lineStart:p,lineEnd:D,targetPoint:t,isDraped:"on-the-ground"===v.elevationInfo?.mode}))};return u._createClass(n)}(F.SnappingAlgorithm);d.LineSnapper=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../support/elevationInfoUtils ./Settings ./SnappingPoint ./snappingUtils ../support/viewUtils".split(" "),
function(d,u,k,J,F,L,O,z,f){let e=function(){function g(n,y){this.view=n;this.options=y;this.squaredShortLineThreshold=L.defaults.shortLineThreshold*L.defaults.shortLineThreshold}var K=g.prototype;K.snap=function(n,y){return k.isSome(y.vertexHandle)?"vertex"!==y.vertexHandle.type?[]:this.snapExistingVertex(n,y):this.snapNewVertex(n,y)};K.edgeExceedsShortLineThreshold=function(n,y){return this.exceedsShortLineThreshold(O.anyMapPointToSnappingPoint(n.leftVertex.pos,this.view,y),O.anyMapPointToSnappingPoint(n.rightVertex.pos,
this.view,y),y)};K.exceedsShortLineThreshold=function(n,y,{spatialReference:p}){return 0===this.squaredShortLineThreshold||z.squaredScreenDistance(f.vectorToScreenPoint(y,p,F.absoluteHeightElevationInfo,this.view),f.vectorToScreenPoint(n,p,F.absoluteHeightElevationInfo,this.view))>this.squaredShortLineThreshold};K.isVertical=function(n,y){return J.squaredDistance(n,y)<L.defaults.verticalLineThreshold};K.squaredProximityThreshold=function(n){return"touch"===n?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold};
u._createClass(g,[{key:"_squaredMouseProximityThreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:n,touchSensitivityMultiplier:y}=this.options,p=n*y;return p*p}}]);return g}();d.SnappingAlgorithm=e;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),
function(d,u,k,J,F,L,O){L=function(z){function f({lineStart:g,lineEnd:K,targetPoint:n,isDraped:y}){n=e.call(this,n,new k.VerticalPlaneConstraint(g,K),y,J.SnappingDomain.SELF);n._referenceLineHint=new O.LineSnappingHint(F.LineSegmentHintType.REFERENCE_EXTENSION,g,K,y,n.domain);return n}u._inherits(f,z);var e=u._createSuper(f);f.prototype._lineEndClosestToTarget=function(){return this.constraint.closestEndTo(this.targetPoint)};u._createClass(f,[{key:"hints",get:function(){return[this._referenceLineHint,
new O.LineSnappingHint(F.LineSegmentHintType.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}}]);return f}(L.SnappingCandidate);d.LineSnappingCandidate=L;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./Settings ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y){f=function(D){function t(){return E.apply(this,arguments)}u._inherits(t,D);var E=u._createSuper(t);D=t.prototype;D.snapNewVertex=function(v,M){var B=M.editGeometryOperations.data.components[0],w=B.edges.length,c=B.vertices.length;const m=[];if(2>w)return m;const {view:h}=this,H=n.vectorToScreenPoint(v,M.spatialReference,O.absoluteHeightElevationInfo,h);c=e.anyMapPointToSnappingPoint(B.vertices[c-1].pos,h,M);const q=e.anyMapPointToSnappingPoint(B.vertices[0].pos,
h,M);w=B=B.edges[w-1];do{if(this.edgeExceedsShortLineThreshold(w,M)){const A=g.editEdgeToSnappingEdge(w,h,M);this._checkEdgeForParallelLines(A,c,v,H,M,m);this._checkEdgeForParallelLines(A,q,v,H,M,m)}w=w.leftVertex.leftEdge}while(w&&w!==B);return m};D.snapExistingVertex=function(v,M){const B=[],w=k.unwrap(M.vertexHandle);var c=w.component;if(3>c.edges.length)return B;const {view:m}=this,h=n.vectorToScreenPoint(v,M.spatialReference,O.absoluteHeightElevationInfo,m),H=w.leftEdge,q=w.rightEdge,A=c.vertices[0],
C=e.anyMapPointToSnappingPoint(A.pos,m,M),P=c.vertices[c.vertices.length-1],I=e.anyMapPointToSnappingPoint(P.pos,m,M);let G=c=c.edges[0];do{if(G!==H&&G!==q&&this.edgeExceedsShortLineThreshold(G,M)){const r=g.editEdgeToSnappingEdge(G,m,M);H&&this._checkEdgeForParallelLines(r,e.anyMapPointToSnappingPoint(H.leftVertex.pos,m,M),v,h,M,B);q&&this._checkEdgeForParallelLines(r,e.anyMapPointToSnappingPoint(q.rightVertex.pos,m,M),v,h,M,B);w===A?this._checkEdgeForParallelLines(r,I,v,h,M,B):w===P&&this._checkEdgeForParallelLines(r,
C,v,h,M,B)}G=G.rightVertex.rightEdge}while(G&&G!==c);return B};D._checkEdgeForParallelLines=function(v,M,B,w,c,m){const h=v.left,H=v.right;y.projectPointToLine(p,M,h,H);if(!(J.squaredDistance(p,M)<z.defaults.parallelLineThreshold)){y.projectPointToLine(p,B,h,H,M);var {spatialReference:q,pointer:A}=c;B=e.asSnappingPoint(L.fromValues(p[0],p[1],B[2]));g.squaredScreenDistance(w,n.vectorToScreenPoint(B,q,O.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(A)&&!(this.isVertical(B,M)||
this.isVertical(h,H)||this._parallelToPreviousCandidate(v,m))&&m.push(new K.ParallelLineSnappingCandidate({referenceLine:v,lineStart:M,targetPoint:B,isDraped:"on-the-ground"===c.elevationInfo?.mode}))}};D._parallelToPreviousCandidate=function(v,M){const B=v.left,w=v.right;for(const c of M)if(y.projectPointToLine(p,w,c.constraint.start,c.constraint.end,B),J.squaredDistance(p,w)<z.defaults.parallelLineThreshold)return c.addReferenceLine(v),!0;return!1};return u._createClass(t)}(f.SnappingAlgorithm);
const p=F.create();d.ParallelLineSnapper=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(d,u,k,J,F,L,O,z,f,e,g){f=
function(K){function n({referenceLine:p,lineStart:D,targetPoint:t,isDraped:E}){const v=J.clone(D),{left:M,right:B}=p;k.subtract(v,k.add(v,v,B),M);D=y.call(this,t,new F.VerticalPlaneConstraint(D,O.asSnappingPoint(v)),E,L.SnappingDomain.SELF);D._referenceLines=[{edge:p,fadeLeft:!0,fadeRight:!0}];return D}u._inherits(n,K);var y=u._createSuper(n);n.prototype.addReferenceLine=function(p){const D={edge:p,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(t=>{k.exactEquals(p.right,t.edge.left)&&(t.fadeLeft=
!1,D.fadeRight=!1);k.exactEquals(p.right,t.edge.right)&&(t.fadeRight=!1,D.fadeRight=!1);k.exactEquals(p.left,t.edge.right)&&(t.fadeRight=!1,D.fadeLeft=!1);k.exactEquals(p.left,t.edge.left)&&(t.fadeLeft=!1,D.fadeLeft=!1)});this._referenceLines.push(D)};u._createClass(n,[{key:"hints",get:function(){return[new e.LineSnappingHint(z.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new g.ParallelSnappingHint(this.constraint.start,this.targetPoint,this.isDraped,
this.domain),...this._referenceLines.map(p=>new e.LineSnappingHint(z.LineSegmentHintType.REFERENCE,p.edge.left,p.edge.right,this.isDraped,this.domain,p.fadeLeft,p.fadeRight))]}}]);return n}(f.SnappingCandidate);d.ParallelLineSnappingCandidate=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(d,u,k,J,F,L,O){k=function(z){function f(g,K,n,y=L.SnappingDomain.ALL){n=e.call(this,n,y);n.lineStart=g;n.lineEnd=K;return n}u._inherits(f,z);var e=u._createSuper(f);f.prototype.equals=function(g){return g instanceof f?F.exactEquals(this.lineStart,g.lineStart)&&F.exactEquals(this.lineEnd,g.lineEnd):!1};return u._createClass(f)}(O.SnappingHint);d.ParallelSnappingHint=k;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./SnappingPoint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y){f=function(t){function E(){return v.apply(this,arguments)}u._inherits(E,t);var v=u._createSuper(E);t=E.prototype;t.snapNewVertex=function(M,B){var w=B.editGeometryOperations.data.components[0],c=w.vertices.length;const m=[];if(2>c)return m;var {view:h}=this;const H=y.vectorToScreenPoint(M,B.spatialReference,z.absoluteHeightElevationInfo,h);var q=w.vertices[c-1];this.edgeExceedsShortLineThreshold(q.leftEdge,B)&&(c=g.anyMapPointToSnappingPoint(q.pos,h,B),q=g.anyMapPointToSnappingPoint(q.leftEdge.leftVertex.pos,
h,B),this._checkForSnappingCandidate(m,q,c,M,H,B));c=w.vertices[0];this.edgeExceedsShortLineThreshold(c.rightEdge,B)&&(w=g.anyMapPointToSnappingPoint(c.pos,h,B),h=g.anyMapPointToSnappingPoint(c.rightEdge.rightVertex.pos,h,B),this._checkForSnappingCandidate(m,h,w,M,H,B));return m};t.snapExistingVertex=function(M,B){const w=[];var c=k.unwrap(B.vertexHandle);if(3>c.component.vertices.length)return w;var {view:m}=this;const h=y.vectorToScreenPoint(M,B.spatialReference,z.absoluteHeightElevationInfo,m);
var H=c.leftEdge;c=c.rightEdge;if(H&&H.leftVertex.leftEdge){var q=H.leftVertex.leftEdge;this.edgeExceedsShortLineThreshold(q,B)&&(H=g.anyMapPointToSnappingPoint(q.rightVertex.pos,m,B),q=g.anyMapPointToSnappingPoint(q.leftVertex.pos,m,B),this._checkForSnappingCandidate(w,q,H,M,h,B))}c&&c.rightVertex.rightEdge&&(H=c.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(H,B)&&(c=g.anyMapPointToSnappingPoint(H.leftVertex.pos,m,B),m=g.anyMapPointToSnappingPoint(H.rightVertex.pos,m,B),this._checkForSnappingCandidate(w,
m,c,M,h,B)));return w};t._checkForSnappingCandidate=function(M,B,w,c,m,h){const {spatialReference:H,pointer:q}=h;J.subtract(p,w,B);const A=L.set(D,p[1],-p[0],0),C=J.dot(A,J.subtract(p,c,w))/J.squaredLength(A);c=g.asSnappingPoint(J.scaleAndAdd(O.clone(c),w,A,C));K.squaredScreenDistance(m,y.vectorToScreenPoint(c,H,z.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(q)&&!this.isVertical(c,w)&&!this.isVertical(w,B)&&(m=L.scaleAndAdd(O.create(),w,A,Math.sign(C)),M.push(new n.RightAngleSnappingCandidate({targetPoint:c,
constraint:new e.VerticalHalfPlaneConstraint(w,g.asSnappingPoint(m)),previousVertex:B,otherVertex:w,otherVertexType:n.OtherVertexType.CENTER,isDraped:"on-the-ground"===h.elevationInfo?.mode})))};return u._createClass(E)}(f.SnappingAlgorithm);const p=F.create(),D=O.create();d.RightAngleSnapper=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n){z=function(p){function D(){return t.apply(this,arguments)}u._inherits(D,p);var t=u._createSuper(D);p=D.prototype;p.snapNewVertex=function(E,v){var M=v.editGeometryOperations.data.components[0];const B=[];var w=M.vertices.length;if("polygon"!==v.editGeometryOperations.data.type||2>w)return B;var {view:c}=this;w=M.vertices[w-1];M=f.anyMapPointToSnappingPoint(M.vertices[0].pos,c,v);c=f.anyMapPointToSnappingPoint(w.pos,c,v);this._processCandidateProposal(M,c,E,v,B);
return B};p.snapExistingVertex=function(E,v){const M=[];var B=k.unwrap(v.vertexHandle),w=B.component;if(2>w.edges.length||"polyline"===v.editGeometryOperations.data.type&&(0===B.index||B.index===w.vertices.length-1))return M;const {view:c}=this;w=f.anyMapPointToSnappingPoint(B.leftEdge.leftVertex.pos,c,v);B=f.anyMapPointToSnappingPoint(B.rightEdge.rightVertex.pos,c,v);this._processCandidateProposal(w,B,E,v,M);return M};p._processCandidateProposal=function(E,v,M,B,w){if(this.exceedsShortLineThreshold(E,
v,B)){var c=J.lerp(y,E,v,.5),m=.5*J.distance(E,v),h=L.create();n.projectPointToCircle(h,M,c,m);h[2]=M[2];c=f.asSnappingPoint(h);var {spatialReference:H,pointer:q}=B;M=K.vectorToScreenPoint(M,H,O.absoluteHeightElevationInfo,this.view);e.squaredScreenDistance(M,K.vectorToScreenPoint(c,H,O.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(q)&&!this.isVertical(E,c)&&!this.isVertical(c,v)&&w.push(new g.RightAngleTriangleSnappingCandidate({targetPoint:c,point1:E,point2:v,isDraped:"on-the-ground"===
B.elevationInfo?.mode}))}};return u._createClass(D)}(z.SnappingAlgorithm);const y=F.create();d.RightAngleTriangleSnapper=z;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K){e=function(n){function y({targetPoint:D,point1:t,point2:E,isDraped:v}){D=p.call(this,D,new L.VerticalCylinderConstraint(z.asSnappingPoint(J.lerp(F.create(),t,E,.5)),.5*k.distance(t,E)),v,O.SnappingDomain.SELF);D._p1=t;D._p2=E;return D}u._inherits(y,n);var p=u._createSuper(y);u._createClass(y,[{key:"hints",get:function(){return[new g.LineSnappingHint(f.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new g.LineSnappingHint(f.LineSegmentHintType.REFERENCE,
this.targetPoint,this._p2,this.isDraped,this.domain),new K.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}]);return y}(e.SnappingCandidate);d.RightAngleTriangleSnappingCandidate=e;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g){k=function(K){function n(p){p=y.call(this,p);p.enabled=!1;p.enabledToggled=!1;p.selfEnabled=!0;p.featureEnabled=!0;p.featureSources=new J;p.distance=g.defaults.distance;p.touchSensitivityMultiplier=g.defaults.touchSensitivityMultiplier;return p}d._inherits(n,K);var y=d._createSuper(n);d._createClass(n,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&
this.selfEnabled}},{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}}]);return n}(k);u.__decorate([F.property()],k.prototype,"enabled",void 0);u.__decorate([F.property()],k.prototype,"enabledToggled",void 0);u.__decorate([F.property()],k.prototype,"selfEnabled",void 0);u.__decorate([F.property()],k.prototype,"featureEnabled",void 0);u.__decorate([F.property({type:J.ofType(e)})],k.prototype,"featureSources",void 0);u.__decorate([F.property()],k.prototype,
"distance",void 0);u.__decorate([F.property()],k.prototype,"touchSensitivityMultiplier",void 0);u.__decorate([F.property({readOnly:!0})],k.prototype,"effectiveEnabled",null);u.__decorate([F.property({readOnly:!0})],k.prototype,"effectiveSelfEnabled",null);u.__decorate([F.property({readOnly:!0})],k.prototype,"effectiveFeatureEnabled",null);return k=u.__decorate([f.subclass("esri.views.interactive.snapping.SnappingOptions")],k)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(d,u,k,J,F,L,O,z){k=function(f){function e(K){K=g.call(this,K);K.layer=null;K.enabled=!0;K.updating=!1;K.availability=1;return K}d._inherits(e,f);var g=d._createSuper(e);return d._createClass(e)}(k);u.__decorate([J.property({constructOnly:!0})],k.prototype,"layer",void 0);u.__decorate([J.property()],k.prototype,"enabled",void 0);u.__decorate([J.property()],k.prototype,"updating",void 0);u.__decorate([J.property()],k.prototype,"availability",void 0);return k=u.__decorate([z.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],
k)})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ./SnappingCandidate ../hints/IntersectionSnappingHint".split(" "),function(d,u,k,J,F,L){F=function(O){function z(e,g,K,n){e=f.call(this,e,new k.IntersectionConstraint(e,g.constraint,K.constraint),n,J.SnappingDomain.ALL);e.first=g;e.second=K;return e}u._inherits(z,O);var f=u._createSuper(z);u._createClass(z,
[{key:"hints",get:function(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new L.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}]);return z}(F.SnappingCandidate);d.IntersectionSnappingCandidate=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers",
"../../../../chunks/vec3","../SnappingDomain","./SnappingHint"],function(d,u,k,J,F){F=function(L){function O(f,e,g=J.SnappingDomain.ALL){e=z.call(this,e,g);e.intersectionPoint=f;return e}u._inherits(O,L);var z=u._createSuper(O);O.prototype.equals=function(f){return f instanceof O?k.exactEquals(this.intersectionPoint,f.intersectionPoint):!1};return u._createClass(O)}(F.SnappingHint);d.IntersectionSnappingHint=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports",
"../../core/maybe"],function(d,u){function k(J){return u.isSome(J)&&"graphic"===J.type}d.filterGraphicHits=function(J){return J.filter(k)};d.findFirstGraphicHit=function(J){return J.find(k)??null};d.hitTestSelectSimilarDistance=async function(J,F){if("2d"===J.type)return J.hitTest(F);J=await J.hitTest(F);if(0===J.results.length)return J;const L=1.05*(u.unwrap(J.results[0].distance)??0);F=J.results.findIndex(O=>(O.distance??0)>L);-1!==F&&(J.results=J.results.slice(0,F));return J};Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),function(d,u,k,J,F,L,O,z,f){d.OperationHandle=function(e){function g(n){n=K.call(this,n);n.cancelled=
!1;n.history={undo:[],redo:[]};n.type=null;return n}u._inherits(g,e);var K=u._createSuper(g);e=g.prototype;e.addToHistory=function(n){this.history.redo=[];this.history.undo.push(n)};e.resetHistory=function(){this.history.redo=[];this.history.undo=[]};e.canUndo=function(){return 0<this.history.undo.length};e.canRedo=function(){return 0<this.history.redo.length};e.complete=function(){this._reset();this.onEnd();this.emit("complete")};e.cancel=function(){this.cancelled=!0;this.complete()};e._reset=function(){this.activeComponent?.reset()};
e.refreshComponent=function(){const n=this.activeComponent;n&&("box"!==n.type&&"reshape"!==n.type&&"graphic-mover"!==n.type||n.refresh())};u._createClass(g,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:J.neverReached(this.activeComponent)}return null}},
{key:"undo",set:function(n){this._set("undo",()=>{this.canUndo()&&n()})}},{key:"redo",set:function(n){this._set("redo",()=>{this.canRedo()&&n()})}}]);return g}(F.EventedAccessor);k.__decorate([L.property()],d.OperationHandle.prototype,"activeComponent",void 0);k.__decorate([L.property()],d.OperationHandle.prototype,"cancelled",void 0);k.__decorate([L.property()],d.OperationHandle.prototype,"history",void 0);k.__decorate([L.property()],d.OperationHandle.prototype,"tool",null);k.__decorate([L.property()],
d.OperationHandle.prototype,"type",void 0);k.__decorate([L.property()],d.OperationHandle.prototype,"canUndo",null);k.__decorate([L.property()],d.OperationHandle.prototype,"canRedo",null);k.__decorate([L.property()],d.OperationHandle.prototype,"onEnd",void 0);k.__decorate([L.property()],d.OperationHandle.prototype,"undo",null);k.__decorate([L.property()],d.OperationHandle.prototype,"redo",null);k.__decorate([L.property()],d.OperationHandle.prototype,"toggleTool",void 0);k.__decorate([L.property()],
d.OperationHandle.prototype,"addToSelection",void 0);k.__decorate([L.property()],d.OperationHandle.prototype,"removeFromSelection",void 0);d.OperationHandle=k.__decorate([f.subclass("esri.widgets.Sketch.support.OperationHandle")],d.OperationHandle);d.CreateOperationHandle=function(e){function g(){return K.apply(this,arguments)}u._inherits(g,e);var K=u._createSuper(g);return u._createClass(g)}(d.OperationHandle);k.__decorate([L.property()],d.CreateOperationHandle.prototype,"activeComponent",void 0);
d.CreateOperationHandle=k.__decorate([f.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],d.CreateOperationHandle);d.UpdateOperationHandle=function(e){function g(){return K.apply(this,arguments)}u._inherits(g,e);var K=u._createSuper(g);return u._createClass(g)}(d.OperationHandle);k.__decorate([L.property()],d.UpdateOperationHandle.prototype,"activeComponent",void 0);d.UpdateOperationHandle=k.__decorate([f.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],d.UpdateOperationHandle);
Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SelectionToolbar":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/handleUtils ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SelectionToolbar/SelectionToolbarViewModel".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p,D){const t={lassoTool:!0,rectangleTool:!0},E={createTool:"polygon",createOptions:{mode:"freehand"}},v={createTool:"rectangle"};z=function(M){function B(c,m){var h=w.call(this,c,m);h._viewModelHandlesGroup=null;h.activeToolInfo=null;h.messages=null;h.toolConfigs=[];h.viewModel=new D;h.visibleElements={...t};h._viewModelHandlesGroup=J.handlesGroup([h.viewModel.on("selection-change",H=>h.emit("selection-change",H)),h.viewModel.on("complete",H=>{h._set("activeToolInfo",
null);h.emit("complete",H)})]);return h}u._inherits(B,M);var w=u._createSuper(B);M=B.prototype;M.destroy=function(){this._viewModelHandlesGroup=F.removeMaybe(this._viewModelHandlesGroup)};M.loadDependencies=function(){return K.loadCalciteComponents({action:()=>new Promise((c,m)=>d(["../../chunks/calcite-action"],c,m)),icon:()=>new Promise((c,m)=>d(["../../chunks/calcite-icon"],c,m))})};M.castVisibleElements=function(c){return{...t,...c}};M.activate=function(c){this.cancel();switch(c){case "lasso":this._activateTool("lasso");
break;case "rectangle":this._activateTool("rectangle");break;default:this._activateTool(c)}};M.cancel=function(){this.viewModel.cancel();this._set("activeToolInfo",null)};M.render=function(){return p.tsx("div",{"aria-label":this.label,class:this.classes("esri-selection-toolbar","esri-widget")},p.tsx("div",{class:"esri-selection-toolbar__container"},this.renderDefaultTools(),this.renderCustomTools()))};M.renderDefaultTools=function(){if("2d"===this.view?.type)return[this.renderRectangleTool(),this.renderLassoTool()]};
M.renderCustomTools=function(){if(this.toolConfigs&&this.toolConfigs.length)return this.toolConfigs.map(c=>p.tsx("calcite-action",{active:this.activeToolInfo?.toolName===c.toolName,bind:this,class:"esri-selection-toolbar__tool-button",label:c.toolName,onclick:()=>this._onCustomToolClick(c.toolName),scale:"s",text:c.toolName,title:c.toolName},p.tsx("calcite-icon",{scale:"s",icon:c.icon||"selection"})))};M.renderLassoTool=function(){const {activeToolInfo:c,messages:m,visibleElements:h}=this;if(h.lassoTool)return p.tsx("calcite-action",
{active:"lasso"===c?.toolName,bind:this,label:m.selectByLasso,onclick:this._onLassoToolClick,scale:"s",text:m.selectByLasso,title:m.selectByLasso},p.tsx("calcite-icon",{scale:"s",icon:"lasso-select"}))};M.renderRectangleTool=function(){const {activeToolInfo:c,messages:m,visibleElements:h}=this;if(h.rectangleTool)return p.tsx("calcite-action",{active:"rectangle"===c?.toolName,bind:this,label:m.selectByRectangle,onclick:this._onRectangleToolClick,scale:"s",text:m.selectByRectangle,title:m.selectByRectangle},
p.tsx("calcite-icon",{scale:"s",icon:"cursor-marquee"}))};M._onCustomToolClick=function(c){this._toggleTool(c)};M._onLassoToolClick=function(){this._toggleTool("lasso")};M._onRectangleToolClick=function(){this._toggleTool("rectangle")};M._activateTool=function(c){var m=this._getToolOptions(c);m&&(m=this.viewModel.activate(m))&&this._set("activeToolInfo",{toolName:c,operation:m})};M._toggleTool=function(c){if(this.activeToolInfo){const m=this.activeToolInfo.toolName;this.cancel();if(m===c)return}this._activateTool(c)};
M._getToolOptions=function(c){if("lasso"===c)return E;if("rectangle"===c)return v;const m=this.toolConfigs.find(A=>A.toolName===c);if(m){var {createTool:h,createOptions:H,selectionOptions:q}=m;return{createTool:h,createOptions:H,selectionOptions:q}}};u._createClass(B,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(c){this._overrideIfSome("label",c)}},{key:"layers",get:function(){return this.viewModel.layers},set:function(c){this.viewModel.layers=c}},{key:"view",get:function(){return this.viewModel.view},
set:function(c){this.viewModel.view=c}}]);return B}(g);k.__decorate([L.property({readOnly:!0})],z.prototype,"activeToolInfo",void 0);k.__decorate([L.property()],z.prototype,"label",null);k.__decorate([L.property()],z.prototype,"layers",null);k.__decorate([L.property(),y.messageBundle("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],z.prototype,"messages",void 0);k.__decorate([L.property()],z.prototype,"toolConfigs",void 0);k.__decorate([L.property()],z.prototype,"view",null);k.__decorate([L.property()],
z.prototype,"viewModel",void 0);k.__decorate([L.property()],z.prototype,"visibleElements",void 0);k.__decorate([O.cast("visibleElements")],z.prototype,"castVisibleElements",null);return z=k.__decorate([e.subclass("esri.widgets.support.SelectionToolbar")],z)})},"esri/widgets/support/SelectionToolbar/SelectionToolbarViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/handleUtils ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../Selector2D".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g){k=function(K){function n(p){p=y.call(this,p);p._operationHandlesGroup=null;p.activeOperation=null;p.layers=null;p.selector=new g;return p}d._inherits(n,K);var y=d._createSuper(n);K=n.prototype;K.destroy=function(){this._operationHandlesGroup=F.removeMaybe(this._operationHandlesGroup);this.selector.destroy()};K.cancel=function(){"active"===this.state&&(this.activeOperation?.cancel(),this.activeOperation=null);this.selector.candidates=null};K.activate=function(p){const {state:D}=
this;if("disabled"!==D)return"active"===D&&this.cancel(),this.selector.candidates=this._candidates,p=this.selector.draw(p),this._operationHandlesGroup=J.handlesGroup([p.once("complete",t=>this._onOperationComplete(t)),p.on("selection-change",t=>this._onOperationSelectionChange(t))]),this.activeOperation=p};K._onOperationSelectionChange=function(p){this.emit("selection-change",p)};K._onOperationComplete=function(p){this._operationHandlesGroup=F.removeMaybe(this._operationHandlesGroup);this.activeOperation=
null;this.emit("complete",p)};d._createClass(n,[{key:"_candidates",get:function(){return this.layers?.flatMap(p=>p.graphics.toArray())??[]}},{key:"state",get:function(){return this.activeOperation?"active":this.view?.ready&&this.layers?.length?"ready":"disabled"}},{key:"view",set:function(p){this.selector.view=p;this._set("view",p)}}]);return n}(k.EventedAccessor);u.__decorate([L.property()],k.prototype,"_candidates",null);u.__decorate([L.property()],k.prototype,"activeOperation",void 0);u.__decorate([L.property()],
k.prototype,"layers",void 0);u.__decorate([L.property({readOnly:!0})],k.prototype,"selector",void 0);u.__decorate([L.property({readOnly:!0})],k.prototype,"state",null);u.__decorate([L.property()],k.prototype,"view",null);return k=u.__decorate([e.subclass("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],k)})},"esri/widgets/support/Selector2D":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./Selector2D/SelectionOperation2D ./Selector2D/selectorUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K){k=function(n){function y(D){D=p.call(this,D);D._defaultSelectionOptions={intersects:!0,overlaps:!0,contains:!0};D.candidates=null;D.options=null;D.view=null;return D}d._inherits(y,n);var p=d._createSuper(y);n=y.prototype;n.draw=function(D){const {_defaultSelectionOptions:t,candidates:E,options:v,view:M}=this;return new g({candidates:E,options:{...D,selectionOptions:{...t,...v,...D?.selectionOptions}},view:M})};n.selectionFrom=async function(D,t){const {_defaultSelectionOptions:E,
candidates:v,options:M,view:B}=this,w=new J;await K.updateSelection({selector:D,candidates:v,currentSelection:w,options:{...E,...M,...t},view:B});return w.toArray()};return d._createClass(y)}(F.HandleOwnerMixin(k));u.__decorate([L.property()],k.prototype,"candidates",void 0);u.__decorate([L.property()],k.prototype,"options",void 0);u.__decorate([L.property({value:null})],k.prototype,"view",void 0);return k=u.__decorate([e.subclass("esri.widgets.support.Selector2D")],k)})},"esri/widgets/support/Selector2D/SelectionOperation2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../symbols ../../../core/Collection ../../../core/Evented ../../../core/Handles ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/GraphicsLayer ../../Sketch/SketchViewModel ./selectorUtils ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleMarkerSymbol".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p,D,t,E){k=function(v){function M({candidates:w,options:c,view:m}){var h=B.call(this);h._activeOptions=null;h._dashedFillSymbol=new D({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}});h._dashedLineSymbol=new t({style:"dash",color:[12,207,255],width:2});h._defaultOptions={createTool:"rectangle",createOptions:void 0,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}};h._completed=!1;h._handles=new L;h._sketchViewModel=new y;h._sketchGraphicsLayer=
new n({listMode:"hide",internal:!0});h._transparentPointSymbol=new E({color:[0,0,0,0],outline:{style:"none",width:0}});h.candidates=null;h.geometry=null;h.options=null;h.selection=new J;h.view=null;h.candidates=w;h.options=c;h.view=m;const {_dashedFillSymbol:H,_dashedLineSymbol:q,_sketchViewModel:A,_sketchGraphicsLayer:C,_transparentPointSymbol:P}=d._assertThisInitialized(h);A.set({layer:C,view:h.view,activePointSymbol:P,activeLineSymbol:q,activeVertexSymbol:P,activeFillSymbol:H,pointSymbol:P,polygonSymbol:H,
polylineSymbol:q,vertexSymbol:P});h._handles.add([A.on("create",I=>h._onSketchEvent(I)),A.on(["undo","redo"],I=>h._onSketchEvent(I))]);return h}d._inherits(M,v);var B=d._createSuper(M);v=M.prototype;v.initialize=function(){this._load()};v.destroy=function(){this._handles=O.destroyMaybe(this._handles)};v.cancel=function(){return this._sketchViewModel.cancel()};v._load=async function(){await this.view?.whenReady();const {options:w}=this,{createTool:c,createOptions:m}=this._activeOptions={...this._defaultOptions,
...w};this._sketchViewModel.create(c,m)};v._onSketchEvent=function(w){this._processSelectionGeometry(("create"===w.type?w.graphic:w.graphics[0])?.geometry||null,"create"===w.type&&"complete"===w.state,"create"===w.type&&"cancel"===w.state)};v._processSelectionGeometry=function(w,c,m){this._set("geometry",w);if(c||m)this._completed=!0;if(m)this._onComplete([],!0);else{var {_activeOptions:h,candidates:H,selection:q,view:A}=this;p.updateSelection({selector:w,candidates:H,currentSelection:q,options:h.selectionOptions,
view:A}).then(({added:C,removed:P})=>{c?this._onComplete(this.selection.toArray(),!1):(C.length||P.length)&&this.emit("selection-change",{added:C,removed:P,type:"selection-change"})})}};v._onComplete=function(w,c){this._handles.removeAll();this.notifyChange("state");this.emit("complete",{aborted:c,selection:w,type:"complete"})};d._createClass(M,[{key:"state",get:function(){const {_completed:w,_sketchViewModel:{state:c}}=this;return w?"complete":"active"===c?"active":"disabled"}}]);return M}(F.EventedAccessor);
u.__decorate([z.property()],k.prototype,"_completed",void 0);u.__decorate([z.property()],k.prototype,"candidates",void 0);u.__decorate([z.property({readOnly:!0})],k.prototype,"geometry",void 0);u.__decorate([z.property()],k.prototype,"options",void 0);u.__decorate([z.property({readOnly:!0})],k.prototype,"selection",void 0);u.__decorate([z.property({readOnly:!0})],k.prototype,"state",null);u.__decorate([z.property({value:null})],k.prototype,"view",void 0);return k=u.__decorate([K.subclass("esri.widgets.support.Selector2D.SelectionOperation2D")],
k)})},"esri/widgets/support/Selector2D/selectorUtils":function(){define(["require","exports"],function(d,u){async function k(){return new Promise((F,L)=>d(["../../../geometry/geometryEngineJSON"],F,L))}async function J(){return k().then(({contains:F,intersects:L,overlaps:O,simplify:z})=>({contains:F,intersects:L,overlaps:O,simplify:z}))}u.getGeometryEngineOperations=J;u.importGeometryEngine=k;u.updateSelection=async function(F){const {selector:L,candidates:O,currentSelection:z,options:f,view:e}=F;
if(!(O&&O.length&&z&&e&&f))return{added:[],removed:[]};const {overlaps:g,intersects:K,contains:n}=f,{spatialReference:y}=e;if(!L)return{added:[],removed:z.removeAll()};const p=await J(),D=[],t=[];O.forEach(E=>{var v=E.geometry;const M=g&&!!p.overlaps(y,L,v),B=K&&!!p.intersects(y,L,v);v=n&&!!p.contains(y,L,v);const w=z.includes(E);M||B||v?!w&&D.push(E):w&&t.push(E)});z.removeMany(t);z.addMany(D);return{added:D,removed:t}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p,D){const t={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0};z=function(E){function v(B,w){var c=M,m=c.call;const {view:h,viewModel:H,snappingOptions:q,...A}=B;w=m.call(c,this,A,w);w._layerListFilter=null;w.iconClass="esri-icon-vertex-gps";w.layerListOpen=!0;w.messages=null;w.visibleElements={...t};w._defaultViewModel=null;B?.viewModel?w.viewModel=B.viewModel:(w._defaultViewModel=new D({snappingOptions:B.snappingOptions,view:B.view}),
w.viewModel=w._defaultViewModel);return w}u._inherits(v,E);var M=u._createSuper(v);E=v.prototype;E.destroy=function(){this._defaultViewModel=J.destroyMaybe(this._defaultViewModel)};E.loadDependencies=function(){return K.loadCalciteComponents({accordion:()=>new Promise((B,w)=>d(["../../chunks/calcite-accordion"],B,w)),"accordion-item":()=>new Promise((B,w)=>d(["../../chunks/calcite-accordion-item"],B,w)),block:()=>new Promise((B,w)=>d(["../../chunks/calcite-block"],B,w)),checkbox:()=>new Promise((B,
w)=>d(["../../chunks/calcite-checkbox"],B,w)),input:()=>new Promise((B,w)=>d(["../../chunks/calcite-input"],B,w)),label:()=>new Promise((B,w)=>d(["../../chunks/calcite-label"],B,w)),list:()=>new Promise((B,w)=>d(["../../chunks/calcite-list"],B,w)),"list-item":()=>new Promise((B,w)=>d(["../../chunks/calcite-list-item"],B,w)),panel:()=>new Promise((B,w)=>d(["../../chunks/calcite-panel"],B,w)),switch:()=>new Promise((B,w)=>d(["../../chunks/calcite-switch"],B,w))})};E.castVisibleElements=function(B){return{...t,
...B}};E.render=function(){const {label:B,visibleElements:{header:w}}=this;return p.tsx("div",{"aria-label":B,class:this.classes("esri-snapping-controls","esri-widget")},p.tsx("div",{class:"esri-snapping-controls__container"},w?this.renderHeaderView():this.renderContent()))};E.renderHeaderView=function(){return p.tsx("calcite-panel",{heading:this.label,class:"esri-snapping-controls__panel"},this.renderContent())};E.renderContent=function(){return[this.renderToggles(),this.renderLayerList()]};E.renderToggles=
function(){const {visibleElements:{enabledToggle:B,selfEnabledToggle:w,featureEnabledToggle:c}}=this;return B||w||c?p.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",key:"toggle-block",heading:"",open:!0},this.renderEnabledToggle(),p.tsx("div",{class:"esri-snapping-controls__nested-container"},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle())):null};E.renderEnabledToggle=function(){if(!this.visibleElements.enabledToggle)return null;const {messages:{enableSnapping:B},
viewModel:{snappingOptions:{enabled:w,enabledToggled:c}}}=this;return p.tsx("calcite-label",{layout:"inline-space-between"},B,p.tsx("calcite-switch",{checked:w,disabled:c,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))};E.renderSelfEnabledToggle=function(){if(!this.visibleElements.selfEnabledToggle)return null;const {messages:{geometryGuides:B},viewModel:{snappingOptions:{enabled:w,selfEnabled:c,enabledToggled:m}}}=this;return p.tsx("calcite-label",{layout:"inline-space-between",
key:"self-enabled-toggle"},B,p.tsx("calcite-switch",{checked:c,disabled:m||!w,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))};E.renderFeatureEnabledToggle=function(){if(!this.visibleElements.featureEnabledToggle)return null;const {messages:{featureToFeature:B},viewModel:{snappingOptions:{enabled:w,featureEnabled:c,enabledToggled:m}}}=this;return p.tsx("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},B,p.tsx("calcite-switch",{checked:c,disabled:m||!w,bind:this,
onCalciteSwitchChange:this._featureEnabledSwitchChange}))};E.renderLayerList=function(){if(!this.visibleElements.layerList)return null;const {messages:B}=this;var w=({target:{value:c}})=>this._layerListFilter=""===c?null:new RegExp(c,"i");w=9<this.viewModel.layerListViewModel.operationalItems.length?p.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:B?.searchLayers,onCalciteInputInput:w}):null;return p.tsx("calcite-block",{key:"list-block",heading:B.snappingLayers,
class:"esri-snapping-controls__layer-list-block",collapsible:!0,open:this.layerListOpen,onCalciteBlockToggle:c=>this.layerListOpen=c.target.open},w,p.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems,J.unwrap(this._layerListFilter))))};E.renderLayerListItemCollection=function(B,w){return B.map(c=>{if(w?this._itemTitleMatchesFilter(c,w):1)return 0<c.children.length?this.renderLayerListItemGroup(c):this.renderLayerListItem(c);
const m=c.children.filter(h=>this._itemTitleMatchesFilter(h,w));return 0<m.length?this.renderLayerListItemGroup(c,m):null}).toArray().filter(J.isSome)};E.renderLayerListItem=function(B){var {messages:{untitledLayer:w}}=this;w=B.title||w;const c=p.tsx("calcite-checkbox",{value:B.layer.id,checked:B.enabled,bind:this,onCalciteCheckboxChange:m=>this._handleLayerListItemChange(m.target)});return p.tsx("calcite-list-item",{key:`${this.id}-list-item-${B.uid}`,onCalciteListItemSelect:()=>{this._handleLayerListItemChange({checked:!c.properties.checked,
value:c.properties.value})}},p.tsx("calcite-label",{class:"esri-snapping-controls__layer-list__item",slot:"content-start",tabIndex:-1,layout:"inline"},p.tsx("div",{class:"esri-snapping-controls__layer-list__item__checkbox"},c),p.tsx("div",{class:"esri-snapping-controls__layer-list__item__label"},w)))};E.renderLayerListItemGroup=function(B,w){const c=B.title||this.messages.untitledLayer,m=B.title&&""!==B.title?B.title:F.generateUID();return p.tsx("calcite-list-item",{key:m},p.tsx("calcite-accordion",
{iconPosition:"start",appearance:"transparent",afterCreate:h=>{h.append(...Array.from(h.children).map(H=>{H.remove();return H}))}},p.tsx("calcite-accordion-item",{expanded:!!w,heading:c,key:B.uid},p.tsx("calcite-list",null,[...this.renderLayerListItemCollection(w??B.children)]))))};E._enableSnappingSwitchChange=function(B){this.snappingOptions.enabled=B.target.checked};E._featureEnabledSwitchChange=function(B){this.snappingOptions.featureEnabled=B.target.checked};E._itemTitleMatchesFilter=function(B,
w){return null!=w&&w.test(B.title)};E._selfEnabledSwitchChange=function(B){this.snappingOptions.selfEnabled=B.target.checked};E._handleLayerListItemChange=async function(B){B.checked?this.viewModel.enableSnappingForLayer(B.value):this.viewModel.disableSnappingForLayer(B.value)};u._createClass(v,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(B){this._overrideIfSome("label",B)}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(B){this.viewModel.snappingOptions=
B}},{key:"view",get:function(){return this.viewModel.view},set:function(B){this.viewModel.view=B}},{key:"viewModel",set:function(B){if(B!==this._get("viewModel")){if(J.isNone(this._defaultViewModel)||this._defaultViewModel!==B)this._defaultViewModel=J.destroyMaybe(this._defaultViewModel);this._set("viewModel",B)}}}]);return v}(g);k.__decorate([L.property()],z.prototype,"_layerListFilter",void 0);k.__decorate([L.property()],z.prototype,"iconClass",void 0);k.__decorate([L.property()],z.prototype,"label",
null);k.__decorate([L.property()],z.prototype,"layerListOpen",void 0);k.__decorate([L.property(),y.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],z.prototype,"messages",void 0);k.__decorate([L.property()],z.prototype,"snappingOptions",null);k.__decorate([L.property()],z.prototype,"view",null);k.__decorate([L.property()],z.prototype,"viewModel",null);k.__decorate([L.property()],z.prototype,"visibleElements",void 0);k.__decorate([O.cast("visibleElements")],z.prototype,
"castVisibleElements",null);return z=k.__decorate([e.subclass("esri.widgets.support.SnappingControls")],z)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y){k=function(p){function D(E){E=t.call(this,E);E.layerListViewModel=new y.SnappingLayerListViewModel;E.snappingOptions=null;E.view=null;return E}d._inherits(D,p);var t=d._createSuper(D);p=D.prototype;p.initialize=function(){this.handles.add([L.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:E,view:v})=>{E.view=v},L.initial),L.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:E,sources:v})=>
{E.featureSnappingSources=v},L.initial)])};p.enableSnappingForLayer=function(E){(this._findSnappingSourceForLayer(E)??this._makeSnappingSourceForLayer(E)).enabled=!0};p.disableSnappingForLayer=function(E){if(E=this._findSnappingSourceForLayer(E))E.enabled=!1};p.updateEnabledFeatureSources=function(E){for(const v of this.snappingOptions.featureSources)n.canDisplayLayer(v.layer)&&(v.enabled=E.includes(v.layer.id))};p._findSnappingSourceForLayer=function(E){return this.snappingOptions.featureSources.find(v=>
v.layer.id===E)};p._makeSnappingSourceForLayer=function(E){var v=this.layerListViewModel.operationalItemsFlat.find(M=>M.layer.id===E)?.layer;if(!v)throw new J("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${E} because no such layer was found in the view`);v=new K({layer:v});this.snappingOptions.featureSources.add(v);return v};d._createClass(D,[{key:"state",get:function(){return this.get("snappingOptions")?"ready":"disabled"}}]);return D}(F.HandleOwnerMixin(k));u.__decorate([O.property({constructOnly:!0})],
k.prototype,"layerListViewModel",void 0);u.__decorate([O.property()],k.prototype,"snappingOptions",void 0);u.__decorate([O.property()],k.prototype,"state",null);u.__decorate([O.property()],k.prototype,"view",void 0);return k=u.__decorate([g.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],k)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(d){function u(f){if(f)return null!=f.listMode?f.listMode:void 0}function k(f){if(f)return null!=
f.minScale?f.minScale:void 0}function J(f){if(f)return null!=f.maxScale?f.maxScale:void 0}function F(f){if(f&&!("type"in f&&"wmts"===f.type)&&f.listMode!==z.hideChildren)return"sublayers"in f?"sublayers":"layers"in f?"layers":void 0}function L(f,e){f&&f.sort((g,K)=>{g=e.indexOf(g.uid);K=e.indexOf(K.uid);return g>K?-1:g<K?1:0})}function O(f){return!!f?.layer}const z={hide:"hide",hideChildren:"hide-children"};d.canDisplayLayer=function(f){return u(f)!==z.hide};d.canSortSublayers=function(f){f=f&&(f.get("layer.layer")||
f.layer);if(!f)return!1;f=f.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof f?f:!0};d.findLayerListMode=u;d.findLayerMaxScale=J;d.findLayerMinScale=k;d.findLayerVisibilityMode=function(f){if(!f)return"inherited";var e=f.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof e)return e?"independent":"inherited";e=f.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===typeof e?e?"independent":"inherited":null!=f.visibilityMode?
f.visibilityMode:"independent"};d.findSelectedItem=function(f,e){const g=f.layer?.uid;return null!=g?e.find(K=>K.layer?.uid===g):null};d.getItemLayers=function(f){return(f=f?.layer)&&"layers"in f?f.layers:null};d.getLegendLayerInfo=function(f){var e=O(f)?f:null;const g=f?.parent;return(e="map-image"===g?.type?e?.source:null)&&g?{layer:g,title:"",sublayerIds:[e.mapLayerId]}:{layer:f,title:""}};d.getNormalizedChildLayerProperty=F;d.isLayerOutsideScaleRange=function(f,e){if(!f||isNaN(e))return!1;var g=
k(f);f=J(f);g=null!=g&&!isNaN(g)&&0<g&&e>g;e=null!=f&&!isNaN(f)&&0<f&&e<f;return g||e};d.isSublayer=O;d.sortChildLayersToIds=function(f,e){if(f=f?.layer){var g=F(f);g&&(f=f.get(g),L(f,e))}};d.sortLayersToIds=L;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K){d.SnappingLayerListViewModel=function(n){function y(){var D=p.apply(this,arguments);D.featureSnappingSources=new J;return D}u._inherits(y,n);var p=u._createSuper(y);n=y.prototype;n._compileList=function(){var D=this.get("view.map.layers");D&&(D=D.filter(g.isValidSnappingLayer),this._watchLayersListMode(D),(D=this._getViewableLayers(D))&&D.length?(this._createNewItems(D),this._removeItems(D),this._sortItems(D)):this._removeAllItems())};n._createListItem=function(D){return new K.SnappingListItem({layer:D,
view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})};u._createClass(y,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten(D=>D.children)}}]);return y}(e);k.__decorate([F.property()],d.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);k.__decorate([F.property()],d.SnappingLayerListViewModel.prototype,"operationalItems",void 0);d.SnappingLayerListViewModel=k.__decorate([f.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],
d.SnappingLayerListViewModel);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K){const n=k.ofType(g);k=function(y){function p(t){t=D.call(this,t);t.checkPublishStatusEnabled=!1;t.listItemCreatedFunction=null;t.operationalItems=new n;t.view=null;return t}d._inherits(p,y);var D=d._createSuper(p);y=p.prototype;y.initialize=function(){this.addHandles([F.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),F.initial),F.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")};y.destroy=function(){this.removeAllHandles();
this.view=null;this.operationalItems.removeAll()};y.triggerAction=function(t,E){t&&!t.disabled&&this.emit("trigger-action",{action:t,item:E})};y.moveListItem=function(t,E,v,M){const B=t?.layer;if(B){var w=this.view?.map?.layers,c=E?K.getItemLayers(E):w;w=v?K.getItemLayers(v):w;if(c&&w){var {operationalItems:m}=this;E=E?.children||m;m=v?.children||m;M=w.length-M;t.parent=v||null;E.includes(t)&&E.remove(t);c.includes(B)&&c.remove(B);m.includes(t)||m.add(t,M);w.includes(B)||w.add(B,M)}}};y._createLayerViewHandles=
function(t){this.removeHandles("layer-views");this._compileList();t&&this.addHandles(t.on("change",()=>this._compileList()),"layer-views")};y._createMapLayerHandles=function(t){this.removeHandles("map-layers");this._compileList();t&&this.addHandles(t.on("change",()=>this._compileList()),"map-layers")};y._createListItem=function(t){const {view:E,listItemCreatedFunction:v,checkPublishStatusEnabled:M}=this;return new g({checkPublishStatusEnabled:M,layer:t,listItemCreatedFunction:v,view:E})};y._removeAllItems=
function(){this.operationalItems.removeAll()};y._getViewableLayers=function(t){if(t)return t.filter(E=>"hide"!==K.findLayerListMode(E))};y._watchLayersListMode=function(t){this.removeHandles("layer-list-mode");t&&t.forEach(E=>{"listMode"in E&&this.addHandles(F.watch(()=>E.listMode,()=>this._compileList()),"layer-list-mode")})};y._compileList=function(){var t=this.get("view.map.layers");this._watchLayersListMode(t);(t=this._getViewableLayers(t))&&t.length?(this._createNewItems(t),this._removeItems(t),
this._sortItems(t)):this._removeAllItems()};y._createNewItems=function(t){const {operationalItems:E}=this;t.forEach(v=>{E.find(M=>M.layer===v)||E.add(this._createListItem(v))})};y._removeItems=function(t){const {operationalItems:E}=this,v=[];E.forEach(M=>{M&&t&&t.includes(M.layer)||v.push(M)});E.removeMany(v)};y._sortItems=function(t){const {operationalItems:E}=this;E.sort((v,M)=>{v=t.indexOf(v.layer);M=t.indexOf(M.layer);return v>M?-1:v<M?1:0})};y._recompileList=function(){this._removeAllItems();
this._compileList()};y._viewHandles=function(){const {view:t}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);this._compileList();t&&t.ready&&this.addHandles([F.watch(()=>this.view?.map?.allLayers,E=>this._createMapLayerHandles(E),F.initial),F.watch(()=>this.view?.allLayerViews,E=>this._createLayerViewHandles(E),F.initial)],"view-layers")};d._createClass(p,[{key:"state",get:function(){const t=this.get("view");return this.get("view.ready")?"ready":t?"loading":"disabled"}}]);return p}(J.EventedAccessor);
u.__decorate([L.property()],k.prototype,"checkPublishStatusEnabled",void 0);u.__decorate([L.property()],k.prototype,"listItemCreatedFunction",void 0);u.__decorate([L.property({type:n})],k.prototype,"operationalItems",void 0);u.__decorate([L.property({readOnly:!0})],k.prototype,"state",null);u.__decorate([L.property()],k.prototype,"view",void 0);return k=u.__decorate([e.subclass("esri.widgets.LayerList.LayerListViewModel")],k)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p,D,t,E,v){var M;g=J.ofType({key:"type",defaultKeyValue:"button",base:y,typeMap:{button:p,toggle:t,slider:D}});const B=J.ofType(g);k=M=function(w){function c(h){h=m.call(this,h);h.actionsSections=new B;h.actionsOpen=!1;h.checkPublishStatusEnabled=!1;h.children=new (J.ofType(M));h.childrenSortable=!0;h.hidden=!1;h.layer=null;h.layerView=null;h.listItemCreatedFunction=null;h.open=!1;h.panel=null;h.parent=null;h.sortable=!0;h.view=null;return h}d._inherits(c,w);var m=
d._createSuper(c);w=c.prototype;w.initialize=function(){this.handles.add([z.watch(()=>this.layer,h=>this._watchLayerProperties(h),z.initial),z.watch(()=>this.checkPublishStatusEnabled,h=>this._updateChildrenPublishing(h),z.initial),z.watch(()=>this.view,h=>this._updateChildrenView(h),z.initial),z.watch(()=>this.panel,h=>this._setListItemOnPanel(h),z.initial),z.watch(()=>[this.layer,this.view],()=>this._getLayerView(),z.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,
{item:this})};w.destroy=function(){this.view=null};w.castPanel=function(h){this.get("panel.open")&&!h.hasOwnProperty("open")&&(h.open=!0);return h?new E(h):null};w.clone=function(){return new M({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};
w._setListItemOnPanel=function(h){h&&(h.listItem=this)};w._updateChildrenPublishing=function(h){const H=this.children;H&&H.forEach(q=>q.checkPublishStatusEnabled=h)};w._updateChildrenView=function(h){const H=this.children;H&&H.forEach(q=>q.view=h)};w._addChildren=function(h){this.handles.remove("child-list-mode");this.children.removeAll();if(h){h.forEach(q=>{this.handles.add(z.watch(()=>q.listMode,()=>this._addChildren(h)),"child-list-mode")});var H=h.filter(q=>"hide"!==v.findLayerListMode(q));this.children.addMany(this._makeChildren(H))}};
w._watchSublayerChanges=function(h){h&&this.handles.add(h.on("change",()=>{this._addChildren(h)}),"layer")};w._initializeChildLayers=function(h){this._addChildren(h);this._watchSublayerChanges(h)};w._makeChildren=function(h){return h.map(H=>v.canDisplayLayer(H)?new M({layer:H,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(O.isSome).reverse()};w._watchLayerProperties=function(h){if(this.handles&&
(this.handles.remove("layer"),this.handles.remove("child-list-mode"),h))if(this.handles.add(z.watch(()=>h.listMode,()=>this._watchLayerProperties(h)),"layer"),"hide-children"===v.findLayerListMode(h))this.children.removeAll();else{var H=v.getNormalizedChildLayerProperty(h);H&&this.handles.add(z.watch(()=>h[H],()=>{h.hasOwnProperty(H)&&this._initializeChildLayers(h[H])},z.initial),"layer")}};w._getLayerView=async function(){const {layer:h,view:H}=this;if(h&&H)try{const q=await H.whenLayerView(h);q.layer===
this.layer&&this._set("layerView",q)}catch{}};d._createClass(c,[{key:"connectionStatus",get:function(){const {layerView:h,publishing:H}=this;if(!H&&h&&"connectionStatus"in h)return h.connectionStatus}},{key:"error",get:function(){return this.layer?.loadError}},{key:"incompatible",get:function(){const {layerView:h}=this;return h&&"spatialReferenceSupported"in h?!h.spatialReferenceSupported:!1}},{key:"title",get:function(){const h=this.get("layer.layer");return(!h||h&&this.get("layer.layer.loaded"))&&
this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(h){this._override("title",h)}},{key:"publishing",get:function(){const {layer:h,checkPublishStatusEnabled:H}=this;return H&&h&&"publishingInfo"in h&&"publishing"===h.publishingInfo?.status}},{key:"updating",get:function(){const {layerView:h,connectionStatus:H,layer:q,publishing:A}=this;return A||H?!1:h?h.updating:"loading"===q?.loadStatus||!1}},{key:"visible",get:function(){return this.layer?.visible},set:function(h){const H=
this.layer;H&&(H.visible=h)}},{key:"visibleAtCurrentScale",get:function(){return!v.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},{key:"visibilityMode",get:function(){return v.findLayerVisibilityMode(this.layer)}}]);return c}(L.IdentifiableMixin(F.HandleOwnerMixin(k)));u.__decorate([f.property({type:B})],k.prototype,"actionsSections",void 0);u.__decorate([f.property()],k.prototype,"actionsOpen",void 0);u.__decorate([f.property()],k.prototype,"checkPublishStatusEnabled",void 0);u.__decorate([f.property({type:J})],
k.prototype,"children",void 0);u.__decorate([f.property()],k.prototype,"childrenSortable",void 0);u.__decorate([f.property({readOnly:!0})],k.prototype,"connectionStatus",null);u.__decorate([f.property({readOnly:!0})],k.prototype,"error",null);u.__decorate([f.property()],k.prototype,"hidden",void 0);u.__decorate([f.property({readOnly:!0})],k.prototype,"incompatible",null);u.__decorate([f.property()],k.prototype,"layer",void 0);u.__decorate([f.property({readOnly:!0})],k.prototype,"layerView",void 0);
u.__decorate([f.property()],k.prototype,"listItemCreatedFunction",void 0);u.__decorate([f.property()],k.prototype,"open",void 0);u.__decorate([f.property({type:E})],k.prototype,"panel",void 0);u.__decorate([e.cast("panel")],k.prototype,"castPanel",null);u.__decorate([f.property()],k.prototype,"parent",void 0);u.__decorate([f.property()],k.prototype,"sortable",void 0);u.__decorate([f.property()],k.prototype,"title",null);u.__decorate([f.property({readOnly:!0})],k.prototype,"publishing",null);u.__decorate([f.property({readOnly:!0})],
k.prototype,"updating",null);u.__decorate([f.property()],k.prototype,"view",void 0);u.__decorate([f.property()],k.prototype,"visible",null);u.__decorate([f.property({readOnly:!0})],k.prototype,"visibleAtCurrentScale",null);u.__decorate([f.property({readOnly:!0})],k.prototype,"visibilityMode",null);return k=M=u.__decorate([n.subclass("esri.widgets.LayerList.ListItem")],k)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(d,u,k,J,F,L,O,z){var f;J=f=function(e){function g(n){n=K.call(this,n);n.displayValueEnabled=!1;n.max=1;n.min=0;n.step=.1;n.type="slider";n.value=null;return n}d._inherits(g,e);var K=d._createSuper(g);g.prototype.clone=function(){return new f({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return d._createClass(g)}(z);
u.__decorate([k.property()],J.prototype,"displayValueEnabled",void 0);u.__decorate([k.property()],J.prototype,"max",void 0);u.__decorate([k.property()],J.prototype,"min",void 0);u.__decorate([k.property()],J.prototype,"step",void 0);u.__decorate([k.property()],J.prototype,"value",void 0);return J=f=u.__decorate([O.subclass("esri.support.Action.ActionSlider")],J)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n,y,p){J=function(D){function t(v,M){v=E.call(this,v,M);v._legend=null;v.content=null;v.image=null;v.listItem=null;v.open=!1;v.visible=!0;return v}u._inherits(t,D);var E=u._createSuper(t);D=t.prototype;D.initialize=function(){this.addHandles(L.watch(()=>this.content,v=>this._createLegend(v),L.initial))};D.destroy=function(){this._legend=F.destroyMaybe(this._legend)};D.render=function(){return p.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};D._renderContent=
function(v){const {_legend:M,disabled:B}=this;return!v||B?null:"legend"===v&&M?p.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:M},M.render()):"string"===typeof v?p.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:v,innerHTML:v}):y.isWidget(v)?p.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:v},v.render()):v instanceof
HTMLElement?p.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:v,bind:v,afterCreate:this._attachToNode}):null};D._renderContents=function(){const {content:v}=this;return Array.isArray(v)?v.map(M=>this._renderContent(M)):this._renderContent(v)};D._getLegendOptions=function(){const {listItem:v}=this;if(!v)return{};const {layer:M,view:B}=v;return M&&B?{view:B,layerInfos:[n.getLegendLayerInfo(M)]}:{}};D._createLegend=async function(v){if(this._hasLegend(v)&&
!this._legend){({default:v}=await new Promise((w,c)=>d(["../Legend"],m=>w(Object.freeze(Object.defineProperty({__proto__:null,default:m},Symbol.toStringTag,{value:"Module"}))),c)));var {listItem:M}=this,B=new v(this._getLegendOptions());this._legend=B;this.notifyChange("className");this.notifyChange("title");v=L.watch(()=>[M?.view,M?.layer,M?.layer?.source,M?.layer?.parent],()=>this._updateLegend(B),L.initial);this.addHandles(v,"legends");this.scheduleRender()}};D._hasLegend=function(v){return"legend"===
v?!0:null!=v&&(Array.isArray(v)?v.includes("legend"):!1)};D._attachToNode=function(v){v.appendChild(this)};D._updateLegend=function(v){v.set(this._getLegendOptions());this.scheduleRender()};D._getWidget=function(v){return"legend"===v?this._legend:y.isWidget(v)?v:null};D._getFirstWidget=function(){const {content:v}=this;if(Array.isArray(v)){let M=null;v.some(B=>{(B=this._getWidget(B))&&(M=B);return!!B});return M}return this._getWidget(v)};u._createClass(t,[{key:"className",get:function(){const {image:v}=
this,M=this._getFirstWidget();return this._get("className")||(!v&&M?M.iconClass:"")},set:function(v){this._override("className",v)}},{key:"disabled",get:function(){const {listItem:v,_legend:M,content:B}=this;return v?Array.isArray(B)&&1<B.length?!1:M?!M.activeLayerInfos?.length||!v.visibleAtCurrentScale:!1:!0},set:function(v){this._overrideIfSome("disabled",v)}},{key:"title",get:function(){const v=this._getFirstWidget();return this._get("title")||(v?.label??"")},set:function(v){this._override("title",
v)}}]);return t}(J.IdentifiableMixin(K));k.__decorate([O.property()],J.prototype,"_legend",void 0);k.__decorate([O.property()],J.prototype,"className",null);k.__decorate([O.property()],J.prototype,"content",void 0);k.__decorate([O.property()],J.prototype,"disabled",null);k.__decorate([O.property()],J.prototype,"image",void 0);k.__decorate([O.property()],J.prototype,"listItem",void 0);k.__decorate([O.property()],J.prototype,"title",null);k.__decorate([O.property()],J.prototype,"open",void 0);k.__decorate([O.property()],
J.prototype,"visible",void 0);return J=k.__decorate([g.subclass("esri.widgets.LayerList.ListItemPanel")],J)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../../core/maybe","../../LayerList/support/layerListUtils"],function(d,u,k){const J=O=>F(O)||L(O),F=O=>{if(!("type"in O))return!1;switch(O.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;
default:return!1}},L=O=>{const z=k.getNormalizedChildLayerProperty(O);if(null!=z&&O.hasOwnProperty(z)&&u.isSome(O[z]))for(const f of O[z])if(J(f))return!0;return!1};d.isValidSnappingLayer=J;d.isValidSnappingLayerGroup=L;d.isValidSnappingLayerSource=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(d,u,k,J,F,L,O,z,f,e,g,K,n){var y;d.SnappingListItem=y=function(p){function D(E){E=t.call(this,E);E.children=new J;E.parent=null;return E}u._inherits(D,p);var t=u._createSuper(D);p=D.prototype;p._initializeChildLayers=function(E){E&&(E=E.filter(n.isValidSnappingLayer),u._get(u._getPrototypeOf(D.prototype),"_initializeChildLayers",this).call(this,E))};p._makeChildren=function(E){return E.map(v=>K.canDisplayLayer(v)?new y({layer:v,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):
null).filter(F.isSome).reverse()};u._createClass(D,[{key:"enabled",get:function(){return F.isSome(this.featureSource)?this.featureSource.enabled:!1}},{key:"featureSource",get:function(){const {layer:E,getFeatureSnappingSources:v}=this;return v().find(M=>M.layer===E)}}]);return D}(g);k.__decorate([L.property()],d.SnappingListItem.prototype,"children",void 0);k.__decorate([L.property()],d.SnappingListItem.prototype,"enabled",null);k.__decorate([L.property({constructOnly:!0})],d.SnappingListItem.prototype,
"getFeatureSnappingSources",void 0);k.__decorate([L.property()],d.SnappingListItem.prototype,"featureSource",null);k.__decorate([L.property()],d.SnappingListItem.prototype,"parent",void 0);d.SnappingListItem=y=k.__decorate([e.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],d.SnappingListItem);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/handleUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Sketch/SketchViewModel ./support/componentsUtils ./support/SelectionToolbar ./support/SnappingControls ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(d,
u,k,J,F,L,O,z,f,e,g,K,n,y,p,D,t,E,v,M,B,w){const c={createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{"rectangle-selection":!0,"lasso-selection":!0},undoRedoMenu:!0,settingsMenu:!0,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0}};J=function(m){function h(q,A){A=H.call(this,q,A);A._activeCreateOptions=null;A._menuOpen=!1;A._selectionToolbar=null;A._snappingControls=null;A._viewModelHandlesGroup=
null;A.availableCreateTools=["point","polyline","polygon","rectangle","circle"];A.creationMode="continuous";A.iconClass="esri-icon-edit";A.layout="horizontal";A.messages=null;A.visibleElements={...c};A._activateCreateTool=A._activateCreateTool.bind(u._assertThisInitialized(A));A.viewModel=q?.viewModel||new y;return A}u._inherits(h,m);var H=u._createSuper(h);m=h.prototype;m.initialize=function(){const {layer:q,view:A}=this,C=new D({view:"2d"===A?.type?A:null,layers:q?[q]:null});this.addHandles([O.watch(()=>
this.viewModel,P=>{this._viewModelHandlesGroup=L.removeMaybe(this._viewModelHandlesGroup);P&&(this._viewModelHandlesGroup=F.handlesGroup([P.on("create",I=>{this.scheduleRender();this._onCreateOperation(I)}),P.on("update",()=>this.scheduleRender()),P.on("delete",I=>this.emit("delete",I)),P.on("undo",()=>this.scheduleRender()),P.on("redo",()=>this.scheduleRender()),O.watch(()=>P.layer,I=>{this._selectionToolbar&&(this._selectionToolbar.layers=I?[I]:null)}),O.watch(()=>P.view,I=>{this._selectionToolbar&&
(this._selectionToolbar.view="2d"===I?.type?I:null);this._setUpSnappingControls()}),O.watch(()=>P.state,()=>this.notifyChange("state"))]))},O.syncAndInitial),O.when(()=>C.activeToolInfo,()=>this.viewModel.cancel()),C.on("complete",P=>this._onSelectionOperationComplete(P))]);this._selectionToolbar=C;this._setUpSnappingControls()};m.loadDependencies=function(){return p.loadCalciteComponents({action:()=>new Promise((q,A)=>d(["../chunks/calcite-action"],q,A)),icon:()=>new Promise((q,A)=>d(["../chunks/calcite-icon"],
q,A))})};m.destroy=function(){this._selectionToolbar?.destroy();this._viewModelHandlesGroup=L.removeMaybe(this._viewModelHandlesGroup);this._snappingControls=L.destroyMaybe(this._snappingControls)};m.castVisibleElements=function(q){q={...c,...q,createTools:{...c.createTools,...q?.createTools},selectionTools:{...c.selectionTools,...q?.selectionTools},snappingControlsElements:{...c.snappingControlsElements,...q?.snappingControlsElements}};L.isSome(this._snappingControls)&&(this._snappingControls.visibleElements=
q.snappingControlsElements);return q};m.create=function(q,A){this._activeCreateOptions=A||null;this.viewModel.create(q,A)};m.update=function(q,A){return this.viewModel.update(q,A)};m.complete=function(){this.viewModel.complete()};m.cancel=function(){this._selectionToolbar?.cancel();this.viewModel.cancel()};m.undo=function(){this.viewModel.undo();this.view?.focus()};m.redo=function(){this.viewModel.redo();this.view?.focus()};m.delete=function(){this.viewModel.delete()};m.duplicate=function(){return this.viewModel.duplicate()};
m.render=function(){const {label:q,layout:A,viewModel:{state:C}}=this;return B.tsx("div",{"aria-label":q,class:this.classes("esri-sketch","esri-widget",{["esri-disabled"]:"disabled"===C,["esri-sketch--vertical"]:"vertical"===A})},B.tsx("div",{role:"toolbar",class:"esri-sketch__panel"},this.renderTopPanelContents()),B.tsx("div",{class:this.classes("esri-sketch__panel","esri-sketch__info-panel")},this.renderInfoPanelContents()))};m.renderTopPanelContents=function(){const q=this.classes("esri-sketch__section",
"esri-sketch__tool-section"),{availableCreateTools:A,visibleElements:C}=this;return[B.tsx("div",{role:"menu",key:"selection-button-container",class:q},this.renderDefaultSelectionButton(),this.renderSelectionToolbar()),A&&A.length?B.tsx("div",{role:"menu",class:q},this.renderDrawButtons()):null,C.undoRedoMenu?B.tsx("div",{role:"menu",key:"undo-redo-menu-button-container",class:q},this.renderUndoRedoMenuButtons()):null,C.settingsMenu?B.tsx("div",{key:"settings-menu-button-container",class:"esri-sketch__section"},
this.renderSettingsMenuButton()):null]};m.renderInfoPanelContents=function(){if(this._menuOpen)return this.renderSettingsMenu();if(this.updateGraphics.length)return[B.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section","esri-sketch__info-count-section"),key:"feature-count-container"},this.renderFeatureCount()),B.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section"),key:"delete-button-container"},this.renderDuplicateButton(),this.renderDeleteButton())]};
m.renderSettingsMenu=function(){const {settings:q}=this.messages;return[B.tsx("div",{role:"menu",class:"esri-sketch__menu-container",key:"settings-menu-container"},B.tsx("header",{class:"esri-sketch__menu-header",key:"settings-menu-header"},B.tsx("span",{class:"esri-sketch__menu-title"},q)),this.renderSnappingControls())]};m.renderSnappingControls=function(){const {snappingControls:q}=this.visibleElements;if(L.isSome(this._snappingControls)&&q)return this._snappingControls.render()};m.renderFeatureCount=
function(){const {layout:q,messages:A,updateGraphics:{length:C}}=this,P=w.substitute(1===C?A.featureCount:A.featuresCount,{count:C});return B.tsx("div",{class:"esri-sketch__feature-count-badge","aria-label":P},B.tsx("span",{class:"esri-sketch__feature-count-number"},"vertical"===q?C:P))};m.renderDuplicateButton=function(){var q=this.messages;q=1<this.updateGraphics.length?q.duplicateFeatures:q.duplicateFeature;return B.tsx("calcite-action",{bind:this,label:q,onclick:this._onDuplicateSelect,scale:"s",
text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:"copy"}))};m.renderDeleteButton=function(){var q=this.messages;q=1<this.updateGraphics.length?q.deleteFeatures:q.deleteFeature;return B.tsx("calcite-action",{bind:this,label:q,onclick:this.delete,scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:"trash"}))};m.renderDefaultSelectionButton=function(){if(this.viewModel.updateOnGraphicClick){var q=this.messages.selectFeature;return B.tsx("calcite-action",{active:"ready"===this.state,bind:this,
label:q,onclick:this._activateDefaultSelectTool,scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:"cursor"}))}};m.renderSelectionToolbar=function(){if("2d"===this.view?.type&&this._selectionToolbar){var q=this.visibleElements.selectionTools;this._selectionToolbar.visibleElements={lassoTool:!!q?.["lasso-selection"],rectangleTool:!!q?.["rectangle-selection"]};return this._selectionToolbar.render()}};m.renderDrawButtons=function(){const q=this.visibleElements.createTools??{};return this.availableCreateTools?.map(A=>
{if("point"===A&&q.point)return this.renderPointButton();if("polyline"===A&&q.polyline)return this.renderPolylineButton();if("polygon"===A&&q.polygon)return this.renderPolygonButton();if("rectangle"===A&&q.rectangle)return this.renderRectangleButton();if("circle"===A&&q.circle)return this.renderCircleButton()})};m.renderPointButton=function(){const q=this.messages.drawPoint;return B.tsx("calcite-action",{active:"point"===this.activeTool,bind:this,label:q,onclick:()=>this._activateCreateTool("point"),
scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:"pin"}))};m.renderPolygonButton=function(){const q=this.messages.drawPolygon;return B.tsx("calcite-action",{active:"polygon"===this.activeTool,bind:this,label:q,onclick:()=>this._activateCreateTool("polygon"),scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:"polygon"}))};m.renderPolylineButton=function(){const q=this.messages.drawPolyline;return B.tsx("calcite-action",{active:"polyline"===this.activeTool,bind:this,label:q,
onclick:()=>this._activateCreateTool("polyline"),scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:"line"}))};m.renderCircleButton=function(){const q=this.messages.drawCircle;return B.tsx("calcite-action",{active:"circle"===this.activeTool,bind:this,label:q,onclick:()=>this._activateCreateTool("circle"),scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:"circle"}))};m.renderRectangleButton=function(){const q=this.messages.drawRectangle;return B.tsx("calcite-action",{active:"rectangle"===
this.activeTool,bind:this,label:q,onclick:()=>this._activateCreateTool("rectangle"),scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:"rectangle"}))};m.renderUndoRedoMenuButtons=function(){return[this.renderUndoButton(),this.renderRedoButton()]};m.renderUndoButton=function(){const q=this.messages.undo;return B.tsx("calcite-action",{disabled:!this.viewModel.canUndo(),bind:this,label:q,onclick:this.undo,scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:E.isRTL(this.container)?
"redo":"undo"}))};m.renderRedoButton=function(){const q=this.messages.redo;return B.tsx("calcite-action",{disabled:!this.viewModel.canRedo(),bind:this,label:q,onclick:this.redo,scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",icon:E.isRTL(this.container)?"undo":"redo"}))};m.renderSettingsMenuButton=function(){const q=this.messages.settings;return B.tsx("calcite-action",{active:this._menuOpen,bind:this,label:q,onclick:this._toggleMenu,scale:"s",text:q,title:q},B.tsx("calcite-icon",{scale:"s",
icon:"gear"}))};m._activateCreateTool=function(q){this.activeTool===q?this.cancel():(this._selectionToolbar?.cancel(),this.create(q))};m._onCreateOperation=function(q){if("complete"===q.state){var {creationMode:A}=this,{type:C}=q;if("create"===C){const {tool:P,graphic:I}=q;q=this._activeCreateOptions;this._activeCreateOptions=null;"continuous"===A?this.create(P,q):"update"===A&&this.update([I])}}};m._toggleMenu=function(){this._menuOpen=!this._menuOpen;this.scheduleRender()};m._onDuplicateSelect=
function(){const q=this.duplicate(),A=this.viewModel.activeTool;"transform"!==A&&"reshape"!==A||this.update(q,{tool:A})};m._onSelectionOperationComplete=function(q){const {viewModel:{defaultUpdateOptions:A}}=this,{selection:C}=q;!q.aborted&&C.length&&(q=A.tool,this.update(C,{...A,tool:1<C.length&&"reshape"===q?"transform":q}));this.notifyChange("state")};m._activateDefaultSelectTool=function(){this.cancel();this.view?.focus()};m._setUpSnappingControls=function(){const {snappingOptions:q,view:A}=this;
this._snappingControls=L.destroyMaybe(this._snappingControls);q&&A&&(this._snappingControls=new t({snappingOptions:q,view:A,visibleElements:this.visibleElements.snappingControlsElements}))};u._createClass(h,[{key:"activeTool",get:function(){const q=this._selectionToolbar?.activeToolInfo;if(q)switch(q.toolName){case "lasso":return"lasso-selection";case "rectangle":return"rectangle-selection";case "default":return"custom-selection"}return this.viewModel.activeTool}},{key:"createGraphic",get:function(){return this.viewModel.createGraphic}},
{key:"defaultCreateOptions",get:function(){return this.viewModel.defaultCreateOptions},set:function(q){this.viewModel.defaultCreateOptions=q}},{key:"defaultUpdateOptions",get:function(){return this.viewModel.defaultUpdateOptions},set:function(q){this.viewModel.defaultUpdateOptions=q}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(q){this._overrideIfSome("label",q)}},{key:"labelOptions",get:function(){return this.viewModel.labelOptions},set:function(q){this.viewModel.labelOptions=
q}},{key:"layer",get:function(){return this.viewModel.layer},set:function(q){this.viewModel.layer=q}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(q){this.viewModel.snappingOptions=q}},{key:"state",get:function(){return this._selectionToolbar?.activeToolInfo?"active":this.viewModel.state}},{key:"tooltipOptions",get:function(){return this.viewModel.tooltipOptions},set:function(q){this.viewModel.tooltipOptions=q}},{key:"updateGraphics",get:function(){return this.viewModel.updateGraphics}},
{key:"view",get:function(){return this.viewModel.view},set:function(q){this.viewModel.view=q}},{key:"viewModel",set:function(q){const A=this._get("viewModel");q!==A&&(A&&L.destroyMaybe(A),this._set("viewModel",q))}}]);return h}(n);k.__decorate([z.property()],J.prototype,"activeTool",null);k.__decorate([z.property({cast:m=>{if(!m||!m.length)return null;const h=new Set(["point","polyline","polygon","rectangle","circle"]);return m.filter(H=>h.has(H))}})],J.prototype,"availableCreateTools",void 0);k.__decorate([z.property({readOnly:!0})],
J.prototype,"createGraphic",null);k.__decorate([z.property()],J.prototype,"creationMode",void 0);k.__decorate([z.property()],J.prototype,"defaultCreateOptions",null);k.__decorate([z.property()],J.prototype,"defaultUpdateOptions",null);k.__decorate([z.property()],J.prototype,"iconClass",void 0);k.__decorate([z.property()],J.prototype,"label",null);k.__decorate([z.property()],J.prototype,"labelOptions",null);k.__decorate([z.property()],J.prototype,"layer",null);k.__decorate([z.property({type:["horizontal",
"vertical"]})],J.prototype,"layout",void 0);k.__decorate([z.property(),v.messageBundle("esri/widgets/Sketch/t9n/Sketch")],J.prototype,"messages",void 0);k.__decorate([z.property()],J.prototype,"snappingOptions",null);k.__decorate([z.property()],J.prototype,"state",null);k.__decorate([z.property()],J.prototype,"tooltipOptions",null);k.__decorate([z.property({readOnly:!0})],J.prototype,"updateGraphics",null);k.__decorate([z.property()],J.prototype,"view",null);k.__decorate([z.property(),M.vmEvent(["create",
"update","undo","redo"])],J.prototype,"viewModel",null);k.__decorate([z.property()],J.prototype,"visibleElements",void 0);k.__decorate([f.cast("visibleElements")],J.prototype,"castVisibleElements",null);return J=k.__decorate([K.subclass("esri.widgets.Sketch")],J)});