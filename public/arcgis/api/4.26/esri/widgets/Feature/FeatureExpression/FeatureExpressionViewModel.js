// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils".split(" "),
function(h,d,u,c,v,l,w,f,J,K,L,x,M,N,O,P,y,z,Q,A,B,C,D,E,n){c=function(F){function k(g){var a=G.call(this,g);a._abortController=null;a.expressionInfo=null;a.graphic=null;a.contentElement=null;a.contentElementViewModel=null;a.interceptor=null;a.view=null;a._cancelQuery=()=>{const {_abortController:b}=h._assertThisInitialized(a);b&&b.abort();a._abortController=null};a._createVM=()=>{var b=a.contentElement?.type;a.contentElementViewModel?.destroy();b="fields"===b?new D:"media"===b?new E:"text"===b?new C:
null;a._set("contentElementViewModel",b)};a._compile=async()=>{a._cancelQuery();const b=new AbortController;a._abortController=b;await a._compileExpression();a._abortController===b&&(a._abortController=null)};a._compileThrottled=w.throttle(a._compile,1,h._assertThisInitialized(a));a._compileExpression=async()=>{const {expressionInfo:b,graphic:p,interceptor:H,spatialReference:q,map:r,view:I,_abortController:t}=h._assertThisInitialized(a);if(b&&p&&q&&r){var e=await n.loadArcadeUtils();if(t===a._abortController)if((e=
await n.createCompiledExpression({arcadeUtils:e,expressionInfo:b,graphic:p,interceptor:H,map:r,spatialReference:q,view:I}))&&"esri.arcade.Dictionary"===e.declaredClass){e=await e.castAsJsonAsync(t?.signal);var m=e?.type;e="media"===m?z.fromJSON(e):"text"===m?A.fromJSON(e):"fields"===m?y.fromJSON(e):null;a._set("contentElement",e)}else a._set("contentElement",null)}else a._set("contentElement",null)};a.handles.add([l.watch(()=>[a.expressionInfo,a.graphic,a.map,a.spatialReference,a.view],()=>a._compileThrottled(),
l.initial),l.watch(()=>[a.contentElement],()=>a._createVM(),l.initial)]);return a}h._inherits(k,F);var G=h._createSuper(k);k.prototype.destroy=function(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)};h._createClass(k,[{key:"spatialReference",get:function(){return this.view?.spatialReference??null},set:function(g){this._override("spatialReference",g)}},{key:"state",get:function(){const {_abortController:g,contentElement:a,
contentElementViewModel:b}=this;return g?"loading":a||b?"ready":"disabled"}},{key:"map",get:function(){return this.view?.map??null},set:function(g){this._override("map",g)}}]);return k}(v.HandleOwnerMixin(c));d.__decorate([f.property()],c.prototype,"_abortController",void 0);d.__decorate([f.property({type:B})],c.prototype,"expressionInfo",void 0);d.__decorate([f.property({type:u})],c.prototype,"graphic",void 0);d.__decorate([f.property({readOnly:!0})],c.prototype,"contentElement",void 0);d.__decorate([f.property({readOnly:!0})],
c.prototype,"contentElementViewModel",void 0);d.__decorate([f.property()],c.prototype,"interceptor",void 0);d.__decorate([f.property()],c.prototype,"spatialReference",null);d.__decorate([f.property({readOnly:!0})],c.prototype,"state",null);d.__decorate([f.property()],c.prototype,"map",null);d.__decorate([f.property()],c.prototype,"view",void 0);return c=d.__decorate([x.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],c)});