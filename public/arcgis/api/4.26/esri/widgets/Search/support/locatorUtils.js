// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../Graphic ../../../core/maybe ../../../geometry/Polygon ../../../rest/locator/addressToLocations ../../../rest/locator/locationToAddress ../../../rest/locator/suggestLocations ../../../rest/support/AddressToLocationsParameters ../../../rest/support/LocationToAddressParameters ../../../rest/support/SuggestLocationsParameters ./geometryUtils".split(" "),function(r,B,w,C,D,E,F,G,H,I,v){function x(a,c){if(c.localSearchDisabled)return null;c=a?.scale;return"number"===typeof c&&3E5>=
c?a?.extent?.center:null}async function J(a,c){const {source:b,spatialReference:f,location:n,sourceIndex:h,view:k}=a,{apiKey:p,url:l,zoomScale:t,defaultZoomScale:d}=b;if(null==l)return[];a=k?.scale;c=c?.signal;const e=new H;e.location=n;p&&(e.apiKey=p);f&&(e.outSpatialReference=f);try{const q=await E.locationToAddress(l,e,{signal:c});return y([q],{sourceIndex:h,scale:a,view:k,zoomScale:t,defaultZoomScale:d})}catch(q){return[]}}function z(a,c){const {filter:b,withinViewEnabled:f}=a;a=c&&c.extent;return(c=
v.createExtentFromGeometry(b&&b.geometry,c,c&&c.scale))||(f&&a?a:void 0)}async function K(a,c){const {source:b,suggestResult:f,spatialReference:n,view:h,maxResults:k,sourceIndex:p}=a,l=b&&b.zoomScale,t=b&&b.defaultZoomScale;if(!f.text?.trim())return null;a=`${!f.key&&b.prefix?b.prefix:""}${f.text}${!f.key&&b.suffix?b.suffix:""}`;const d=new G,{apiKey:e,url:q}=b,m=h&&h.scale;var g=z(b,h);c=c&&c.signal;e&&(d.apiKey=e);if(!q)return null;b.categories&&(d.categories=b.categories);b.locationType&&(d.locationType=
b.locationType);n&&(d.outSpatialReference=n);const u=x(h,b);u&&(d.location=u);d.maxLocations=k;g&&(d.searchExtent=w.unwrap(g));b.countryCode&&(d.countryCode=b.countryCode);({key:g}=f);const A=`${g}`;g&&(d.magicKey=A);d.address={};d.address[b.singleLineFieldName||"Single Line Input"]=a;b.outFields&&(d.outFields=b.outFields);return D.addressToLocations(q,d,{signal:c}).then(L=>y(L,{key:A,scale:m,sourceIndex:p,view:h,zoomScale:l,defaultZoomScale:t}))}function M(a,c){return a.map(b=>({text:b.text,key:b.magicKey,
sourceIndex:c}))}function y(a,c){return a.filter(Boolean).map(b=>{const {key:f,scale:n,sourceIndex:h,view:k,zoomScale:p,defaultZoomScale:l}=c,{attributes:t,extent:d,location:e,address:q}=b;b=new B({geometry:e,attributes:t});var m=d||e,g=v.createExtentFromGeometry(m,k,n);m="number"===typeof p?v.scaleExtent(g,k,p):"number"===typeof l&&"point"===m?.type?v.scaleExtent(g,k,l):g;g=e?`${e.x},${e.y}`:"";g=q||g;const u=b.clone();w.isSome(m)&&(u.geometry=C.fromExtent(m));return{extent:m,feature:b,target:u,
key:f,name:g,sourceIndex:h}})}r.getLocation=x;r.getResults=function(a,c){return a.location?J(a,c):K(a,c)};r.getSuggestions=async function(a,c){const {source:b,spatialReference:f,view:n,suggestTerm:h,maxSuggestions:k,sourceIndex:p}=a;a=new I;const {apiKey:l,url:t}=b,d=z(b,n);c=c&&c.signal;if(!t)return null;l&&(a.apiKey=l);b.categories&&(a.categories=b.categories);f&&(a.outSpatialReference=f);const e=x(n,b);e&&(a.location=e);if(!h.trim())return null;const {prefix:q="",suffix:m=""}=b;a.text=`${q}${h}${m}`;
d&&(a.searchExtent=w.unwrap(d));a.maxSuggestions=k;b.countryCode&&(a.countryCode=b.countryCode);return F.suggestLocations(t,a,{signal:c}).then(g=>M(g,p))};r.isArcGISWorldGeocoder=function(a){return a?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(a):!1};r.isMeteredArcGISWorldGeocoder=function(a){return a?/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(a):!1};r.isProxiedArcGISWorldGeocoder=function(a){return a?/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(a):
!1};r.meteredArcGISLocatorUrl="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});