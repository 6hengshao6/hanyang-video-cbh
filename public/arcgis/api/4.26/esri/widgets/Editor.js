// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Attachments":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/maybe ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/componentsUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r){const Q={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},O=window.CSS;f=function(A){function b(a,p){a=c.call(this,a,p);a.displayType="auto";a.messages=null;a.messagesUnits=null;a.selectedFile=null;a.submitting=!1;a.viewModel=null;a.visibleElements={...Q};a._supportsImageOrientation=O&&O.supports&&O.supports("image-orientation","from-image");a._addAttachmentForm=
null;a._updateAttachmentForm=null;return a}l._inherits(b,A);var c=l._createSuper(b);A=b.prototype;A.initialize=function(){this.viewModel||(this.viewModel=new z);this.addHandles([L.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),L.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),L.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),L.initial)])};A.loadDependencies=function(){return E.loadCalciteComponents({icon:()=>new Promise((a,p)=>e(["../chunks/calcite-icon"],
a,p))})};A.castVisibleElements=function(a){return{...Q,...a}};A.addAttachment=function(){const {_addAttachmentForm:a,viewModel:p}=this;this._set("submitting",!0);this._set("error",null);return p.addAttachment(a).then(D=>{this._set("submitting",!1);this._set("error",null);p.mode="view";return D}).catch(D=>{this._set("submitting",!1);this._set("error",new w("attachments:add-attachment",this.messages.addErrorMessage,D));throw D;})};A.deleteAttachment=function(a){const {viewModel:p}=this;this._set("submitting",
!0);this._set("error",null);return p.deleteAttachment(a).then(D=>{this._set("submitting",!1);this._set("error",null);p.mode="view";return D}).catch(D=>{this._set("submitting",!1);this._set("error",new w("attachments:delete-attachment",this.messages.deleteErrorMessage,D));throw D;})};A.updateAttachment=function(){const {viewModel:a}=this,{_updateAttachmentForm:p}=this;this._set("submitting",!0);this._set("error",null);return a.updateAttachment(p).then(D=>{this._set("submitting",!1);this._set("error",
null);a.mode="view";return D}).catch(D=>{this._set("submitting",!1);this._set("error",new w("attachments:update-attachment",this.messages.updateErrorMessage,D));throw D;})};A.addFile=function(){const a=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);this.viewModel.mode="view";return a};A.updateFile=function(){const {viewModel:a}=this,p=a.updateFile(this.selectedFile,this._updateAttachmentForm,a.activeFileInfo);a.mode="view";return p};A.deleteFile=function(a){a=this.viewModel.deleteFile(a||
this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return a};A.render=function(){const {submitting:a,viewModel:p}=this,{state:D}=p;return r.tsx("div",{class:this.classes("esri-attachments","esri-widget")},a?this.renderProgressBar():null,"loading"===D?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())};A.renderErrorMessage=function(){const {error:a,visibleElements:p}=this;return a&&p.errorMessage?r.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},
a.message):null};A.renderAttachments=function(){const {activeFileInfo:a,mode:p,activeAttachmentInfo:D}=this.viewModel;return"add"===p?this.renderAddForm():"edit"===p?this.renderDetailsForm(D||a):this.renderAttachmentContainer()};A.renderLoading=function(){return r.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},r.tsx("div",{class:"esri-attachments__loader"}))};A.renderProgressBar=function(){return this.visibleElements.progressBar?r.tsx("div",{class:"esri-attachments__progress-bar",
key:"progress-bar"}):null};A.renderAddForm=function(){const {submitting:a,selectedFile:p}=this;var D=a||!p,P=this.visibleElements.cancelAddButton?r.tsx("button",{type:"button",bind:this,disabled:a,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",a&&"esri-button--disabled")},this.messages.cancel):null;D=this.visibleElements.addSubmitButton?r.tsx("button",{type:"submit",disabled:D,class:this.classes("esri-button","esri-button--secondary",
"esri-button--small","esri-button--half",{["esri-button--disabled"]:D})},this.messages.add):null;const m=p?r.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},p.name):null;P=r.tsx("form",{bind:this,afterCreate:v.storeNode,afterRemoved:v.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},r.tsx("fieldset",{class:"esri-attachments__file-fieldset"},m,r.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},
p?this.messages.changeFile:this.messages.selectFile,r.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),D,P);return r.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},P)};A.renderDetailsForm=function(a){const {visibleElements:p,viewModel:D,selectedFile:P,submitting:m}=this;var {abilities:I}=D,H=m||!P;let S;if(P){var F=P.type;S=P.name;var T=P.size}else if(a&&"file"in a)F=a.file.type,S=a.file.name,
T=a.file.size;else if(a&&"contentType"in a){F=a.contentType;S=a.name;T=a.size;var M=a.url}var J=I.editing&&I.operations?.delete&&p.deleteButton?r.tsx("button",{key:"delete-button",type:"button",disabled:m,bind:this,onclick:C=>this._submitDeleteAttachment(C,a),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",{["esri-button--disabled"]:m})},this.messages.delete):void 0;H=I.editing&&I.operations?.update&&p.updateButton?r.tsx("button",{disabled:H,
key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",{["esri-button--disabled"]:H})},this.messages.update):void 0;const u=this.visibleElements.cancelUpdateButton?r.tsx("button",{disabled:m,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",{["esri-button--disabled"]:m})},this.messages.cancel):void 0;I=I.editing&&I.operations?.update?
r.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},r.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},S),r.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,r.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0;T=r.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},r.tsx("label",
null,N.formatFileSize(this.messagesUnits,T??0)));F=r.tsx("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},r.tsx("label",null,F));M=x.isSome(M)?r.tsx("a",{class:"esri-attachments__item-link",href:M,rel:"noreferrer",target:"_blank"},this.renderImageMask(a,400),r.tsx("div",{class:"esri-attachments__item-link-overlay"},r.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},r.tsx("calcite-icon",{icon:"launch"})))):this.renderImageMask(a,400);J=r.tsx("form",{bind:this,
afterCreate:v.storeNode,afterRemoved:v.discardNode,"data-node-ref":"_updateAttachmentForm",onsubmit:C=>this._submitUpdateAttachment(C,a)},r.tsx("div",{class:"esri-attachments__metadata"},T,F),I,r.tsx("div",{class:"esri-attachments__actions"},J,u,H));return r.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},M,J)};A.renderImageMask=function(a,p){return a?"file"in a?this.renderGenericImageMask(a.file.name,a.file.type):this.renderImageMaskForAttachment(a,p):null};A.renderGenericImageMask=
function(a,p){var {supportsResizeAttachments:D}=this.viewModel;p=k.getIconPath(p);D={["esri-attachments__image--resizable"]:D};return r.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask")},r.tsx("img",{title:a,alt:a,src:p,class:this.classes(D,"esri-attachments__image")}))};A.renderImageMaskForAttachment=function(a,p){var {supportsResizeAttachments:D}=this.viewModel;if(!a)return null;const {contentType:P,name:m,url:I}=a;if(!D||!k.isSupportedImage(P))return this.renderGenericImageMask(m,
P);a=(a=this._getCSSTransform(a))?{transform:a,"image-orientation":"none"}:{};p=`${I}${I?.includes("?")?"\x26":"?"}w=${p}`;D={["esri-attachments__image--resizable"]:D};return r.tsx("div",{class:this.classes("esri-attachments__item-mask")},r.tsx("img",{styles:a,alt:m,title:m,src:p,class:this.classes(D,"esri-attachments__image")}))};A.renderFile=function(a){const {file:p}=a;return r.tsx("li",{class:"esri-attachments__item",key:p},r.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",
title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(a),type:"button"},this.renderImageMask(a),r.tsx("label",{class:"esri-attachments__label"},r.tsx("span",{class:"esri-attachments__filename"},p.name||this.messages.noTitle),r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",v.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}))))};A.renderAttachmentInfo=function({attachmentInfo:a,displayType:p}){const {viewModel:D,
effectiveDisplayType:P}=this,{abilities:m,supportsResizeAttachments:I}=D,{contentType:H,name:S,url:F}=a;p=this.renderImageMask(a,"list"===p?48:400);var T=m.editing?r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",v.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}):null;T="preview"===P&&I&&k.isSupportedImage(H)?null:r.tsx("label",{class:"esri-attachments__label"},r.tsx("span",{class:"esri-attachments__filename"},S||this.messages.noTitle),T);p=[p,
T];p=m.editing?r.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":a.id,onclick:()=>this._startEditAttachment(a),type:"button"},p):r.tsx("a",{key:"details-link",class:"esri-attachments__item-button",href:F??void 0,target:"_blank"},p);return r.tsx("li",{class:"esri-attachments__item",key:a},p)};A.renderAttachmentContainer=function(){const {effectiveDisplayType:a,
viewModel:p,visibleElements:D}=this,{attachmentInfos:P,abilities:m,fileInfos:I}=p;var H=!!P?.length;const S=!!I?.length,F={["esri-attachments__container--list"]:"preview"!==a,["esri-attachments__container--preview"]:"preview"===a},T=m.editing&&m.operations?.add&&D.addButton?r.tsx("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button","esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",
"esri-icon-plus")}),this.messages.add):void 0,M=H?r.tsx("ul",{key:"attachments-list",class:"esri-attachments__items"},P.toArray().map(u=>this.renderAttachmentInfo({attachmentInfo:u,displayType:a}))):void 0,J=S?r.tsx("ul",{key:"file-list",class:"esri-attachments__items"},I.toArray().map(u=>this.renderFile(u))):void 0;H=S||H?void 0:r.tsx("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return r.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",
F)},M,J,H,T)};A._modeChanged=function(){this._set("error",null);this._set("selectedFile",null)};A._handleFileInputChange=function(a){a=(a=a.target)&&a.files&&a.files.item(0);this._set("selectedFile",a)};A._submitDeleteAttachment=function(a,p){a.preventDefault();p&&("file"in p?this.deleteFile(p.file):p&&this.deleteAttachment(p))};A._submitAddAttachment=function(a){a.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()};A._submitUpdateAttachment=function(a,p){a.preventDefault();
p&&"file"in p?this.updateFile():this.updateAttachment()};A._startEditAttachment=function(a){const {viewModel:p}=this;p.activeFileInfo=null;p.activeAttachmentInfo=a;p.mode="edit"};A._startEditFile=function(a){const {viewModel:p}=this;p.activeAttachmentInfo=null;p.activeFileInfo=a;p.mode="edit"};A._startAddAttachment=function(){this.viewModel.mode="add"};A._cancelForm=function(a){a.preventDefault();this.viewModel.mode="view"};A._getCSSTransform=function(a){({orientationInfo:a}=a);return!this._supportsImageOrientation&&
a?[a.rotation?`rotate(${a.rotation}deg)`:"",a.mirrored?"scaleX(-1)":""].join(" "):""};l._createClass(b,[{key:"abilities",get:function(){return this.viewModel.abilities},set:function(a){this.viewModel.abilities=a}},{key:"effectiveDisplayType",get:function(){const {displayType:a}=this;return a&&"auto"!==a?a:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(a){this.viewModel.graphic=a}},{key:"label",get:function(){return this.messages?.widgetLabel??
""},set:function(a){this._overrideIfSome("label",a)}}]);return b}(n);g.__decorate([B.property()],f.prototype,"abilities",null);g.__decorate([B.property()],f.prototype,"displayType",void 0);g.__decorate([B.property({readOnly:!0})],f.prototype,"effectiveDisplayType",null);g.__decorate([B.property()],f.prototype,"graphic",null);g.__decorate([B.property()],f.prototype,"label",null);g.__decorate([B.property(),y.messageBundle("esri/widgets/Attachments/t9n/Attachments")],f.prototype,"messages",void 0);g.__decorate([B.property(),
y.messageBundle("esri/core/t9n/Units")],f.prototype,"messagesUnits",void 0);g.__decorate([B.property({readOnly:!0})],f.prototype,"selectedFile",void 0);g.__decorate([B.property({readOnly:!0})],f.prototype,"submitting",void 0);g.__decorate([B.property({readOnly:!0})],f.prototype,"error",void 0);g.__decorate([B.property({type:z})],f.prototype,"viewModel",void 0);g.__decorate([B.property()],f.prototype,"visibleElements",void 0);g.__decorate([t.cast("visibleElements")],f.prototype,"castVisibleElements",
null);return f=g.__decorate([h.subclass("esri.widgets.Attachments")],f)})},"esri/core/unitFormatUtils":function(){define("exports ./byteSizeEstimations ./Cyclical ./mathUtils ./maybe ./string ./unitUtils ../intl/number".split(" "),function(e,l,g,w,x,L,N,B){function t(k,E,v){return k.units[E][v]}function f(k,E,v,y=2,r="abbr"){return`${B.formatNumber(E,{minimumFractionDigits:y,maximumFractionDigits:y,signDisplay:0<E?"never":"exceptZero"})} ${t(k,v,r)}`}function d(k,E,v,y=2,r="abbr"){return`${B.formatNumber(E,
{minimumFractionDigits:y,maximumFractionDigits:y,signDisplay:"exceptZero"})} ${t(k,v,r)}`}function h(k,E){const v=JSON.stringify(E);let y=n.get(v);y||(y=new Intl.NumberFormat("en-US",E),n.set(v,y));return/\-?\+?360/.test(y.format(k))?0:k}const n=new Map,z=["B","kB","MB","GB","TB"];e.formatAngleDegrees=function(k,E,v,y,r){r=x.unwrapOr(r,2);var Q=g.cyclicalDegrees,O=Q.normalize;a:if(k=N.convertUnit(k,E,"degrees"),v===y)v=k;else{switch(y){case "arithmetic":v=-k+90;break a;case "geographic":v=-k-90;break a}v=
void 0}Q=O.call(Q,v,0,!0);r={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,minimumFractionDigits:r,signDisplay:0<Q?"never":"exceptZero"};Q=h(Q,r);return B.formatNumber(Q,r)};e.formatDMS=function(k,E,v=2){k=N.convertUnit(k,E,"degrees");E=k-Math.floor(k);k-=E;E*=60;let y=E-Math.floor(E);E-=y;y*=60;return`${k.toFixed()}\u00b0 ${E.toFixed()}' ${y.toFixed(v)}"`};e.formatDecimal=f;e.formatFileSize=function(k,E){let v=0===E?0:Math.floor(Math.log(E)/Math.log(l.ByteSizeUnit.KILOBYTES));
v=w.clamp(v,0,z.length-1);E=B.formatNumber(E/l.ByteSizeUnit.KILOBYTES**v,{maximumFractionDigits:2});return L.replace(k.units.bytes[z[v]],{fileSize:E})};e.formatImperialArea=function(k,E,v,y=2,r="abbr"){const Q=N.preferredImperialAreaUnit(E,v);return f(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatImperialLength=function(k,E,v,y=2,r="abbr"){const Q=N.preferredImperialLengthUnit(E,v);return f(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatImperialRelativeLength=function(k,E,v,y=2,r="abbr"){const Q=N.preferredImperialLengthUnit(E,
v);return d(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatImperialRelativeVerticalLength=function(k,E,v,y=2,r="abbr"){const Q=N.preferredImperialVerticalLengthUnit(E,v);return d(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatImperialVerticalLength=function(k,E,v,y=2,r="abbr"){const Q=N.preferredImperialVerticalLengthUnit(E,v);return f(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatMetricArea=function(k,E,v,y=2,r="abbr"){const Q=N.preferredMetricAreaUnit(E,v);return f(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatMetricLength=
function(k,E,v,y=2,r="abbr"){const Q=N.preferredMetricLengthUnit(E,v);return f(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatMetricRelativeLength=function(k,E,v,y=2,r="abbr"){const Q=N.preferredMetricLengthUnit(E,v);return d(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatMetricRelativeVerticalLength=function(k,E,v,y=2,r="abbr"){const Q=N.preferredMetricVerticalLengthUnit(E,v);return d(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatMetricVerticalLength=function(k,E,v,y=2,r="abbr"){const Q=N.preferredMetricVerticalLengthUnit(E,
v);return f(k,N.convertUnit(E,v,Q),Q,y,r)};e.formatRelativeAngleDegrees=function(k,E,v,y,r){v!==y&&(k=-k);r=x.unwrapOr(r,2);v={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,minimumFractionDigits:r,signDisplay:"exceptZero"};k=N.convertUnit(k,E,"degrees")%360;k=h(k,v);return B.formatNumber(k,v)};e.formatRelativeDecimal=d;e.unitName=t;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E){const v={editing:!1,operations:{add:!0,update:!0,delete:!0}},y=x.ofType(z);w=function(r){function Q(A){var b=O.call(this,A);b._getAttachmentsPromise=null;b._attachmentLayer=null;b.abilities={...v};b.activeAttachmentInfo=null;b.activeFileInfo=null;b.attachmentInfos=new y;b.fileInfos=new x;b.graphic=null;b.mode="view";b.filesEnabled=!1;b.addHandles(B.watch(()=>b.graphic,()=>b._graphicChanged(),B.initial));return b}e._inherits(Q,r);var O=e._createSuper(Q);r=
Q.prototype;r.destroy=function(){this.graphic=this._attachmentLayer=null};r.castAbilities=function(A){return{...v,...A}};r.getAttachments=async function(){const {_attachmentLayer:A,attachmentInfos:b}=this;if(!A||"function"!==typeof A.queryAttachments)throw new L("invalid-layer","getAttachments(): A valid layer is required.");const c=this._getObjectId();var a=new k({objectIds:[c],returnMetadata:!0});const p=[];this._getAttachmentsPromise=a=A.queryAttachments(a).then(D=>D[c]||p).catch(()=>p);this.notifyChange("state");
a=await a;b.removeAll();a.length&&b.addMany(a);this._getAttachmentsPromise=null;this.notifyChange("state");return a};r.addAttachment=async function(A,b=this.graphic){const {_attachmentLayer:c,attachmentInfos:a,abilities:p}=this;if(!b)throw new L("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:b});if(!A)throw new L("invalid-attachment","addAttachment(): An attachment is required.",{attachment:A});if(!p.operations?.add)throw new L("invalid-abilities","addAttachment(): add abilities are required.");
if(!c||"function"!==typeof c.addAttachment)throw new L("invalid-layer","addAttachment(): A valid layer is required.");A=await c.addAttachment(b,A).then(D=>this._queryAttachment(D.objectId,b));a.add(A);return A};r.deleteAttachment=async function(A){const {_attachmentLayer:b,attachmentInfos:c,graphic:a,abilities:p}=this;if(!A)throw new L("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:A});if(!p.operations?.delete)throw new L("invalid-abilities","deleteAttachment(): delete abilities are required.");
if(!b||"function"!==typeof b.deleteAttachments)throw new L("invalid-layer","deleteAttachment(): A valid layer is required.");if(!a)throw new L("invalid-graphic","deleteAttachment(): A graphic is required.");const D=await b.deleteAttachments(a,[A.id]).then(()=>A);c.remove(D);return D};r.updateAttachment=async function(A,b=this.activeAttachmentInfo){const {_attachmentLayer:c,attachmentInfos:a,graphic:p,abilities:D}=this;if(!A)throw new L("invalid-attachment","updateAttachment(): An attachment is required.",
{attachment:A});if(!b)throw new L("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:b});if(!D.operations?.update)throw new L("invalid-abilities","updateAttachment(): Update abilities are required.");const P=a.findIndex(m=>m===b);if(!c||"function"!==typeof c.updateAttachment)throw new L("invalid-layer","updateAttachment(): A valid layer is required.");if(!p)throw new L("invalid-graphic","updateAttachment(): A graphic is required.");A=await c.updateAttachment(p,
b.id,A).then(m=>this._queryAttachment(m.objectId));a.splice(P,1,A);return A};r.commitFiles=async function(){await Promise.all(this.fileInfos.items.map(A=>this.addAttachment(A.form)));this.fileInfos.removeAll();return this.getAttachments()};r.addFile=function(A,b){if(!A||!b)return null;A={file:A,form:b};this.fileInfos.add(A);return A};r.updateFile=function(A,b,c=this.activeFileInfo){if(!A||!b||!c)return null;const a=this.fileInfos.findIndex(p=>c===p);-1<a&&this.fileInfos.splice(a,1,{file:A,form:b});
return this.fileInfos.items[a]};r.deleteFile=function(A){const b=this.fileInfos.find(c=>c.file===A);return b?(this.fileInfos.remove(b),b):null};r._queryAttachment=async function(A,b){const {_attachmentLayer:c}=this;if(!A||!c?.queryAttachments)throw new L("invalid-attachment-id","Could not query attachment.");const a=this._getObjectId(b);A=new k({objectIds:[a],attachmentsWhere:`AttachmentId=${A}`,returnMetadata:!0});return c.queryAttachments(A).then(p=>p[a][0])};r._getObjectId=function(A=this.graphic){return A?.getObjectId()??
null};r._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))};r._setAttachmentLayer=function(){var {graphic:A}=this;this._attachmentLayer=(A=E.getSourceLayer(A))?"scene"===A.type&&N.isSome(A.associatedLayer)?A.associatedLayer:A:null};e._createClass(Q,[{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){var {graphic:A}=this;if(!A)return!1;A=A.layer||
A.sourceLayer;return A?.loaded&&"capabilities"in A&&A.capabilities&&"operations"in A.capabilities&&"supportsResizeAttachments"in A.capabilities.operations&&A.capabilities.operations.supportsResizeAttachments||!1}}]);return Q}(w);l.__decorate([t.property()],w.prototype,"abilities",void 0);l.__decorate([f.cast("abilities")],w.prototype,"castAbilities",null);l.__decorate([t.property()],w.prototype,"activeAttachmentInfo",void 0);l.__decorate([t.property()],w.prototype,"activeFileInfo",void 0);l.__decorate([t.property({readOnly:!0,
type:y})],w.prototype,"attachmentInfos",void 0);l.__decorate([t.property()],w.prototype,"fileInfos",void 0);l.__decorate([t.property({type:g})],w.prototype,"graphic",void 0);l.__decorate([t.property()],w.prototype,"mode",void 0);l.__decorate([t.property({readOnly:!0})],w.prototype,"state",null);l.__decorate([t.property()],w.prototype,"filesEnabled",void 0);l.__decorate([t.property({readOnly:!0})],w.prototype,"supportsResizeAttachments",null);return w=l.__decorate([n.subclass("esri.widgets.Attachments.AttachmentsViewModel")],
w)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),function(e,l,g,w,x,L,N,B,t){var f;const d={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,
rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};g=f=function(h){function n(k){k=z.call(this,k);k.contentType=null;k.exifInfo=null;k.id=null;k.globalId=null;k.keywords=null;k.name=null;k.parentGlobalId=null;k.parentObjectId=null;k.size=null;k.url=null;return k}e._inherits(n,h);var z=e._createSuper(n);n.prototype.clone=function(){return new f({contentType:this.contentType,
exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})};e._createClass(n,[{key:"orientationInfo",get:function(){var {exifInfo:k}=this;k=t.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:k});return d[k]||null}}]);return n}(g.JSONSupport);l.__decorate([w.property({type:String})],g.prototype,"contentType",void 0);l.__decorate([w.property()],g.prototype,
"exifInfo",void 0);l.__decorate([w.property({readOnly:!0})],g.prototype,"orientationInfo",null);l.__decorate([w.property({type:x.Integer})],g.prototype,"id",void 0);l.__decorate([w.property({type:String})],g.prototype,"globalId",void 0);l.__decorate([w.property({type:String})],g.prototype,"keywords",void 0);l.__decorate([w.property({type:String})],g.prototype,"name",void 0);l.__decorate([w.property({json:{read:!1}})],g.prototype,"parentGlobalId",void 0);l.__decorate([w.property({json:{read:!1}})],
g.prototype,"parentObjectId",void 0);l.__decorate([w.property({type:x.Integer})],g.prototype,"size",void 0);l.__decorate([w.property({json:{read:!1}})],g.prototype,"url",void 0);return g=f=l.__decorate([B.subclass("esri.layers.support.AttachmentInfo")],g)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(e){function l(g){const {tagName:w,tags:x}=g;return x&&w?(g=x.find(L=>L.name===w))&&g.value||null:null}e.getExifValue=function(g){const {exifInfo:w,exifName:x,tagName:L}=g;
return w&&x&&L?(g=w.find(N=>N.name===x))?l({tagName:L,tags:g.tags}):null:null};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../intl ../../../core/Logger ../../../core/maybe ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../popup/support/FieldInfoFormat ../../../support/arcadeOnDemand".split(" "),function(e,l,g,w,x,
L,N,B,t,f,d){function h(Y){return Y?u.test(Y):!1}function n(Y,ca){if(!h(ca)||!Y)return null;const da=ca.replace(u,"").toLowerCase();let ja=null;Y.some(pa=>pa.name.toLowerCase()===da?(ja=pa,!0):!1);return ja}function z(Y,ca){return(ca=k(ca,Y))?ca.name:Y}function k(Y,ca){return Y&&"function"===typeof Y.getField&&ca?Y.getField(ca)??null:null}function E({formattedAttributes:Y,template:ca,fieldInfoMap:da}){return`${x.replace(x.replace(ca,ja=>{const pa=da.get(ja.toLowerCase());return`{${pa&&pa.fieldName||
ja}}`}),Y).replace(T,"")}`.trim()}function v(Y,ca,da=!1){const ja=ca[Y];"string"===typeof ja&&(da=(da?encodeURIComponent(ja):ja).replace(J,"%27"),ca[Y]=da)}function y(Y,ca=!1){const da={...Y};Object.keys(da).forEach(ja=>v(ja,da,ca));return da}function r(Y,ca){return Y.replace(M,(da,ja,pa)=>(da=k(ca,pa))?`{${da.name}}`:ja)}function Q(Y,ca,da){return(Y=r(Y,da))?Y.replace(R,(ja,pa,sa)=>{pa=`${pa||sa}`.trim();return x.replace(ja,y(ca,pa&&"{"!==pa[0]||!1))}):Y}function O(Y,ca){var da=ca.fieldName,ja=A(ca.fieldInfos,
da)?.clone();const pa=ca.preventPlacesFormatting;ca=ca.layer;var sa=k(ca,da);ja&&"date"===sa?.type&&(sa=ja.format||new f,sa.dateFormat=sa.dateFormat||"short-date-short-time",sa.dateTimeFormatOptions=!ca?.layer&&"feature"===ca?.type&&ca.datesInUnknownTimezone||ca?.layer&&"map-image"===ca.layer?.type&&ca.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,ja.format=sa);ja=ja&&ja.format;if("string"===typeof Y&&B.isRasterPixelValueField(da)&&ja)return ja.formatRasterPixelValue(Y);"string"!==typeof Y||
!ja||null!=ja.dateFormat||null==ja.places&&null==ja.digitSeparator||(da=Number(Y),isNaN(da)||(Y=da));return"string"===typeof Y||null==Y||null==ja?a(Y):pa?N.formatNumber(Y,{...N.convertNumberFormatToIntlOptions(ja),minimumFractionDigits:0,maximumFractionDigits:20}):ja.format(Y)}function A(Y,ca){if(Y&&Y.length&&ca){var da=ca.toLowerCase(),ja=void 0;Y.some(pa=>pa.fieldName&&pa.fieldName.toLowerCase()===da?(ja=pa,!0):!1);return ja}}function b({fieldName:Y,graphic:ca,layer:da}){if(m(Y)||!da||"function"!==
typeof da.getFeatureType)return null;const {typeIdField:ja}=da;return ja&&Y===ja?(Y=da.getFeatureType(ca))?Y.name:null:null}function c({fieldName:Y,value:ca,graphic:da,layer:ja}){return m(Y)||!ja||"function"!==typeof ja.getFieldDomain?null:(Y=da&&ja.getFieldDomain(Y,{feature:da}))&&"coded-value"===Y.type?Y.getName(ca):null}function a(Y){return"string"===typeof Y?Y.replace(C,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):Y}function p(Y){const {value:ca,fieldName:da,fieldInfos:ja,fieldInfoMap:pa,layer:sa,
graphic:xa}=Y;return null==ca?"":(Y=c({fieldName:da,value:ca,graphic:xa,layer:sa}))||(Y=b({fieldName:da,graphic:xa,layer:sa}))?Y:pa.get(da.toLowerCase())?O(ca,{fieldInfos:ja||Array.from(pa.values()),fieldName:da,layer:sa}):(Y=sa&&sa.fieldsIndex)&&Y.isDateField(da)?L.formatDate(ca,X):a(ca)}async function D(Y,ca){const {layer:da,graphic:ja,outFields:pa,objectIds:sa,returnGeometry:xa,spatialReference:ya}=Y;Y=sa[0];if("number"!==typeof Y&&"string"!==typeof Y)return F.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",
{layer:da,graphic:ja,objectId:Y,requiredFields:pa}),null;if(!t.getEffectiveLayerCapabilities(da)?.operations?.supportsQuery)return F.warn("The specified layer cannot be queried. The following fields will not be available.",{layer:da,graphic:ja,requiredFields:pa,returnGeometry:xa}),null;Y=da.createQuery();Y.objectIds=sa;Y.outFields=pa?.length?pa:[da.objectIdField];Y.returnGeometry=!!xa;Y.returnZ=!!xa;Y.returnM=!!xa;Y.outSpatialReference=ya;return(await da.queryFeatures(Y,ca)).features[0]}async function P(Y){if(!Y.expressionInfos?.length)return!1;
var ca=await d.loadArcade();({arcadeUtils:{hasGeometryFunctions:ca}}=ca);return ca(Y)}function m(Y=""){return Y?Y.includes("relationships/"):!1}function I({attributes:Y,graphic:ca,relatedInfo:da,fieldInfos:ja,fieldInfoMap:pa,layer:sa}){Y&&ca&&da&&Object.keys(ca.attributes).forEach(xa=>{var ya=(ya={layerId:da.relation.id.toString(),fieldName:xa},`${"relationships/"}${ya.layerId}/${ya.fieldName}`);Y[ya]=p({fieldName:ya,fieldInfos:ja,fieldInfoMap:pa,layer:sa,value:ca.attributes[xa],graphic:ca})})}function H({attributes:Y,
relatedInfo:ca,fieldInfoMap:da,fieldInfos:ja,layer:pa}){Y&&ca&&(ca.relatedFeatures&&ca.relatedFeatures&&ca.relatedFeatures.forEach(sa=>I({attributes:Y,graphic:sa,relatedInfo:ca,fieldInfoMap:da,fieldInfos:ja,layer:pa})),ca.relatedStatsFeatures&&ca.relatedStatsFeatures&&ca.relatedStatsFeatures.forEach(sa=>I({attributes:Y,graphic:sa,relatedInfo:ca,fieldInfoMap:da,fieldInfos:ja,layer:pa})))}function S(Y,ca,da){return Y.find(ja=>ja!==ca&&"feature"===ja.type&&ja.url===ca.url&&ja.layerId===da.relatedTableId)}
const F=g.getLogger("esri.widgets.Feature.support.featureUtils"),T=/href=(""|'')/gi,M=/(\{([^\{\r\n]+)\})/g,J=/'/g,u=/^\s*expression\//i,C=/(\n)/gi,K=/[\u00A0-\u9999<>&]/gim,R=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,V=/^(?:mailto:|tel:)/,X=L.convertDateFormatToIntlOptions("short-date-short-time"),ba=Y=>{if(!Y)return!1;Y=Y.toUpperCase();return Y.includes("CURRENT_TIMESTAMP")||Y.includes("CURRENT_DATE")||Y.includes("CURRENT_TIME")},ea=({layer:Y,method:ca,query:da,definitionExpression:ja})=>{Y.capabilities?.query?.supportsCacheHint&&
"attachments"!==ca&&(Y=w.isSome(da.where)?da.where:null,ca=w.isSome(da.geometry)?da.geometry:null,ba(ja)||ba(Y)||"extent"===ca?.type||"tile"===da.resultType||(da.cacheHint=!0))};e.applyTextFormattingHTML=a;e.createfieldInfoMap=function(Y,ca){const da=new Map;if(!Y)return da;Y.forEach(ja=>{const pa=z(ja.fieldName,ca);ja.fieldName=pa;da.set(pa.toLowerCase(),ja)});return da};e.findRelatedLayer=function(Y,ca,da){return Y&&ca&&da?S(Y.allLayers,ca,da)||S(Y.allTables,ca,da):null};e.fixTokens=r;e.formatAttributes=
function({fieldInfos:Y,attributes:ca,layer:da,graphic:ja,fieldInfoMap:pa,relatedInfos:sa}){const xa={};sa?.forEach(ya=>H({attributes:xa,relatedInfo:ya,fieldInfoMap:pa,fieldInfos:Y,layer:da}));ca&&Object.keys(ca).forEach(ya=>{xa[ya]=p({fieldName:ya,fieldInfos:Y,fieldInfoMap:pa,layer:da,value:ca[ya],graphic:ja})});return xa};e.formatEditInfo=function(Y,ca){const {creatorField:da,creationDateField:ja,editorField:pa,editDateField:sa}=Y;if(ca){Y=ca[sa];if("number"===typeof Y)return ca=ca[pa],{type:"edit",
date:L.formatDate(Y,X),user:ca};Y=ca[ja];return"number"===typeof Y?(ca=ca[da],{type:"create",date:L.formatDate(Y,X),user:ca}):null}};e.formatValueToFieldInfo=O;e.getAllFieldInfos=function(Y){const ca=[];if(!Y)return ca;const {fieldInfos:da,content:ja}=Y;da&&ca.push(...da);if(!ja||!Array.isArray(ja))return ca;ja.forEach(pa=>{"fields"===pa.type&&(pa=pa&&pa.fieldInfos)&&ca.push(...pa)});return ca};e.getFieldInfo=A;e.getFieldInfoLabel=function(Y,ca){return(ca=n(ca,Y?.fieldName))?ca.title||null:Y?Y.label||
Y.fieldName:null};e.getFixedFieldName=z;e.getFixedFieldNames=function(Y,ca){return Y&&Y.map(da=>z(da,ca))};e.getSourceLayer=function(Y){if(!w.isNone(Y))return Y.get("sourceLayer")||Y.get("layer")};e.graphicCallback=async function(Y,ca){return"function"===typeof Y?Y.call(null,ca):Y};e.htmlEntities=function(Y){return Y.replace(K,ca=>`&#${ca.charCodeAt(0)};`)};e.isExpressionField=h;e.isRelatedField=m;e.preLayerQueryCallback=({query:Y,layer:ca,method:da})=>{ea({layer:ca,method:da,query:Y,definitionExpression:`${ca.definitionExpression} ${ca.serviceDefinitionExpression}`})};
e.preRequestCallback=({queryPayload:Y,layer:ca,method:da})=>{ea({layer:ca,method:da,query:Y,definitionExpression:`${ca.definitionExpression} ${ca.serviceDefinitionExpression}`})};e.querySourceLayer=D;e.queryUpdatedFeature=async function({graphic:Y,popupTemplate:ca,layer:da,spatialReference:ja},pa){if(da&&ca&&("function"===typeof da.load&&await da.load(pa),Y.attributes)){var sa=Y.attributes[da.objectIdField];if(null!=sa){sa=[sa];var xa=await ca.getRequiredFields(da.fieldsIndex),ya=B.featureHasFields(xa,
Y);xa=ya?[]:xa;ca=ca.returnGeometry||await P(ca);if(!ya||ca)if(da=await D({layer:da,graphic:Y,outFields:xa,objectIds:sa,returnGeometry:ca,spatialReference:ja},pa))da.geometry&&(Y.geometry=da.geometry),da.attributes&&(Y.attributes={...Y.attributes,...da.attributes})}}};e.shouldOpenInNewTab=function(Y=""){if(Y)return!V.test(Y.trim().toLowerCase())};e.substituteAttributes=E;e.substituteFieldsInLinksAndAttributes=function({attributes:Y,globalAttributes:ca,layer:da,text:ja,expressionAttributes:pa,fieldInfoMap:sa}){return ja?
E({formattedAttributes:ca,template:Q(ja,{...ca,...pa,...Y},da),fieldInfoMap:sa}):""};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(e,l){e.getIconPath=function(g){const w=l.getAssetUrl("esri/themes/base/images/files/");return g?"text/plain"===g?`${w}text-32.svg`:"application/pdf"===g?`${w}pdf-32.svg`:"text/csv"===g?`${w}csv-32.svg`:"application/gpx+xml"===g?`${w}gpx-32.svg`:
"application/x-dwf"===g?`${w}cad-32.svg`:"application/postscript"===g||"application/json"===g||"text/xml"===g||"model/vrml"===g?`${w}code-32.svg`:"application/x-zip-compressed"===g||"application/x-7z-compressed"===g||"application/x-gzip"===g||"application/x-tar"===g||"application/x-gtar"===g||"application/x-bzip2"===g||"application/gzip"===g||"application/x-compress"===g||"application/x-apple-diskimage"===g||"application/x-rar-compressed"===g||"application/zip"===g?`${w}zip-32.svg`:g.includes("image/")?
`${w}image-32.svg`:g.includes("audio/")?`${w}sound-32.svg`:g.includes("video/")?`${w}video-32.svg`:g.includes("msexcel")||g.includes("ms-excel")||g.includes("spreadsheetml")?`${w}excel-32.svg`:g.includes("msword")||g.includes("ms-word")||g.includes("wordprocessingml")?`${w}word-32.svg`:g.includes("powerpoint")||g.includes("presentationml")?`${w}report-32.svg`:`${w}generic-32.svg`:`${w}generic-32.svg`};e.isSupportedImage=function(g){g=g.toLowerCase();return"image/bmp"===g||"image/emf"===g||"image/exif"===
g||"image/gif"===g||"image/x-icon"===g||"image/jpeg"===g||"image/png"===g||"image/tiff"===g||"image/x-wmf"===g};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/compilerUtils ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/accessorSupport/decorators/subclass ../layers/support/domainUtils ../layers/support/fieldUtils ./Widget ./FeatureForm/css ./FeatureForm/featureFormUtils ./FeatureForm/FeatureFormViewModel ./support/componentsUtils ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../chunks/datetime ../intl/locale".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q,O,A,b,c,a){w=function(p){function D(m,I){var H=P.call(this,m,I);H._dateInputFieldMap=new Map;H._activeInputName="";H._activeNumberFieldEdit=null;H._fieldFocusNeeded=!1;H._fieldToInitialIncompatibleDomainValue=new Map;H._switchFieldsWithInitialIncompatibleValue=new Set;H._userUpdatedInputFieldNames=new Set;H.disabled=!1;H.groupDisplay="all";H.headingLevel=2;H.messages=null;H.messagesTemplates=null;H.viewModel=new v;H._handleInputInput=S=>{H._commitInputValue(S.currentTarget)};
H._handleFormKeyDown=H._handleFormKeyDown.bind(l._assertThisInitialized(H));H._handleInputBlur=H._handleInputBlur.bind(l._assertThisInitialized(H));H._handleInputFocus=H._handleInputFocus.bind(l._assertThisInitialized(H));H._handleNumberInputMouseDown=H._handleNumberInputMouseDown.bind(l._assertThisInitialized(H));H._handleInputKeyDown=H._handleInputKeyDown.bind(l._assertThisInitialized(H));H._handleOptionChange=H._handleOptionChange.bind(l._assertThisInitialized(H));H._handleGroupClick=H._handleGroupClick.bind(l._assertThisInitialized(H));
H._handleSubmit=H._handleSubmit.bind(l._assertThisInitialized(H));H._afterInputCreateOrUpdate=H._afterInputCreateOrUpdate.bind(l._assertThisInitialized(H));H._afterDateInputCreateOrUpdate=H._afterDateInputCreateOrUpdate.bind(l._assertThisInitialized(H));return H}l._inherits(D,p);var P=l._createSuper(D);p=D.prototype;p.initialize=function(){this.addHandles([N.watch(()=>this.feature,()=>{this._activeInputName=this._getFocusableInput("forward")?.name||"";this._userUpdatedInputFieldNames.clear();this._fieldToInitialIncompatibleDomainValue.clear();
this._switchFieldsWithInitialIncompatibleValue.clear();this._dateInputFieldMap.clear();this._fieldFocusNeeded=!0}),this.on("submit",m=>{if(0<m.invalid.length){const [I]=m.invalid;m.invalid.forEach(H=>this._userUpdatedInputFieldNames.add(H));this._activeInputName=I;this._fieldFocusNeeded=!0;this.scheduleRender()}})])};p.loadDependencies=function(){return y.loadCalciteComponents({combobox:()=>new Promise((m,I)=>e(["../chunks/calcite-combobox"],m,I)),"combobox-item":()=>new Promise((m,I)=>e(["../chunks/calcite-combobox-item"],
m,I)),"combobox-item-group":()=>new Promise((m,I)=>e(["../chunks/calcite-combobox-item-group"],m,I)),"input-date-picker":()=>new Promise((m,I)=>e(["../chunks/calcite-input-date-picker"],m,I)),"input-message":()=>new Promise((m,I)=>e(["../chunks/calcite-input-message"],m,I)),"input-time-picker":()=>new Promise((m,I)=>e(["../chunks/calcite-input-time-picker"],m,I)),progress:()=>new Promise((m,I)=>e(["../chunks/calcite-progress"],m,I)),switch:()=>new Promise((m,I)=>e(["../chunks/calcite-switch"],m,I))})};
p.getValues=function(){return this.viewModel.getValues()};p.submit=function(){return this.viewModel.submit()};p.render=function(){const {state:m}=this.viewModel;return b.tsx("div",{class:this.classes(k.CSS.base,k.CSS.widget,k.CSS.panel)},"ready"===m?this.renderForm():null)};p.renderForm=function(){var m=this.viewModel,I=L.isSome(m.formTitle)&&b.tsx(r.Heading,{key:"title",level:this.headingLevel},m.formTitle);m=L.isSome(m.formDescription)&&b.tsx("p",{class:k.CSS.description,key:"description"},m.formDescription);
I=I||m?b.tsx("div",{class:k.CSS.formHeader},I,m):null;return b.tsx("form",{class:k.CSS.form,novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},I,this.renderFields())};p.renderFields=function(){const {viewModel:{inputFields:m}}=this;return m.filter(I=>I.visible).map((I,H)=>E.isGroupField(I)?this.renderGroup(I,H):this.renderLabeledField(I))};p.renderGroup=function(m,I){const {formTemplate:H,disabled:S}=this,{description:F,inputFields:T,label:M,state:J}=m,u=T.filter(ca=>ca.visible);
var C=this.viewModel.findField(this._activeInputName);C=!(!C||C.group!==m);const K=`${this.id}_group_${I}`,R=`${this.id}_group-label_${I}`,V=`${this.id}_group-description_${I}`,X=F?b.tsx("p",{class:this.classes(k.CSS.groupDescription,k.CSS.description),id:V},F):null,ba="sequential"===this.groupDisplay,ea=ba?C:"expanded"===J,Y=ea?k.CSS.collapseIcon:k.CSS.expandIcon;return b.tsx("fieldset",{"aria-expanded":ea.toString(),"aria-labelledby":R,"aria-describedby":F?V:"",class:this.classes(k.CSS.group,ba?
k.CSS.groupSequential:null,ea?null:k.CSS.groupCollapsed,C?k.CSS.groupActive:null,S?k.CSS.inputDisabled:null),disabled:S,"data-group":m,id:K,key:I,onclick:this._handleGroupClick},b.tsx("button",{role:ba?"presentation":void 0,class:k.CSS.groupHeader,type:"button",tabIndex:ba?-1:0},b.tsx("div",{class:k.CSS.groupTitle},b.tsx(r.Heading,{class:k.CSS.groupLabel,id:R,level:L.isSome(H)&&H.title?r.incrementHeadingLevel(this.headingLevel):this.headingLevel},M),X),ba?null:b.tsx("span",{class:this.classes(Y,k.CSS.groupToggleIcon)})),
u.map(ca=>this.renderLabeledField(ca)))};p._getFocusableInput=function(m,I){var H=this.viewModel.allInputFields;H="forward"===m?H:H.slice().reverse();I?E.isGroupField(I)?m=H.indexOf(I.inputFields[0]):(this._isInputFieldInGroup(I)&&"collapsed"===I.group.state?({inputFields:I}=I.group,m="forward"===m?I[I.length-1]:I[0]):m=I,m=H.indexOf(m)+1):m=0;for(;m<H.length;m++)if(I=H[m],I.visible)return I;return null};p.renderLabeledField=function(m){const {feature:I,label:H,layer:S,type:F}=m;return b.tsx("label",
{key:`${S.id}-${I.uid}-${m.name}`,class:k.CSS.label},[H,"unsupported"!==F?this.renderInputField(m):this.renderUnsupportedField(m),this.renderAuxiliaryText(m)])};p.renderInputField=function(m){const {domain:I,name:H,type:S,updating:F,value:T}=m,M=this.getCommonInputProps(m);if("coded-value"===I?.type){if(E.isFieldElementWithInputType(m.fieldElement,"switch")){const {fieldElement:J}=m;if(this._switchFieldsWithInitialIncompatibleValue.has(H)||null==T||J.input.onValue!==T&&J.input.offValue!==T)this._switchFieldsWithInitialIncompatibleValue.add(H);
else return this.renderSwitchInputField(m,M)}return"radio-buttons"===m.inputType?this.renderRadioButtonsInputField(m,I.codedValues.map(({code:J,name:u})=>({value:J,name:u})),M):this.renderSelectInputField(m,this._getFieldValueOptions(H,I),M)}if("datetime-picker"===m.inputType||"date"===S)return this.renderDateInputField(m,M);m="number"===S?b.tsx("input",{type:"number",...M,value:L.isSome(this._activeNumberFieldEdit)&&this._activeNumberFieldEdit.fieldName===m.name?this._activeNumberFieldEdit.value:
`${M.value}`}):"text-area"===m.inputType?b.tsx("textarea",{...M}):b.tsx("input",{type:"text",...M});return F?b.tsx("div",{class:k.CSS.inputFieldWrapper},m,b.tsx("div",{class:k.CSS.inputFieldLoader},b.tsx("calcite-progress",{type:"indeterminate"}))):m};p.renderDateInputField=function(m,I){const {includeTime:H,label:S,name:F,valid:T,value:M}=m,{readOnly:J,required:u}=I,{date:C,time:K}=this._formatValueForDateInputs(M);m=L.isSome(I.max)?this._formatValueForDateInputs(I.max):void 0;var R=L.isSome(I.min)?
this._formatValueForDateInputs(I.min):void 0;m=m?.date??void 0;R=R?.date??void 0;const V={afterCreate:this._afterDateInputCreate,afterUpdate:this._afterDateInputCreateOrUpdate,"aria-invalid":!T,label:S,numberingSystem:"latn",overlayPositioning:"fixed",readOnly:J,required:u,tabIndex:0,["data-field-name"]:F};return b.tsx("div",{key:`${I.key}-date-time-container`,class:k.CSS.dateInputContainer},b.tsx("calcite-input-date-picker",{bind:this,...V,class:this.classes(I.class,k.CSS.inputDate),"data-date-part":"date",
key:`${I.key}-date-input`,valueAsDate:C??void 0,maxAsDate:m,minAsDate:R,onCalciteInputDatePickerChange:X=>this._commitDateChanges(X.target),onblur:X=>this._commitDateChanges(X.target,!0)}),H?b.tsx("calcite-input-time-picker",{bind:this,...V,class:this.classes(I.class,k.CSS.inputTime),"data-date-part":"time",key:`${I.key}-time-input`,value:K??void 0,step:1,onCalciteInputTimePickerChange:X=>this._commitDateChanges(X.target),onfocus:X=>{X.target.calciteTimePickerEl&&(X.target.calciteTimePickerEl.showSecond=
!0)},onblur:X=>this._commitDateChanges(X.target,!0)}):null)};p.renderUnsupportedField=function(m){m=this.getCommonInputProps(m);return b.tsx("input",{afterCreate:m.afterCreate,afterUpdate:m.afterUpdate,class:this.classes(k.CSS.input,k.CSS.inputField,k.CSS.inputDisabled),onfocus:m.onfocus,readOnly:!0,tabIndex:m.tabIndex,type:"text",value:m.value,["data-field-name"]:m["data-field-name"]})};p.renderSelectInputField=function(m,I,H){const {value:S}=m,{messages:F,messagesTemplates:T}=this;var M=I.map(C=>
C.map(K=>b.tsx("calcite-combobox-item",{value:`${K.value}`,textLabel:K.name,key:`#${K.value}`,selected:S===K.value})));const [J,u]=M;this._registerIncompatibleValue(S,I.flat(),m,C=>{u.unshift(b.tsx("calcite-combobox-item",{value:`${C}`,textLabel:`${C}`,key:"incompatible-option",readOnly:!0}))});I=0<u.length?[b.tsx("calcite-combobox-item-group",{key:"recommended",label:F.recommended},J),b.tsx("calcite-combobox-item-group",{key:"other",label:T.other},u)]:J;M=L.isNone(m.fieldElement)||E.isFieldElementWithInputType(m.fieldElement,
"combo-box")&&m.fieldElement.input.showNoValueOption;!m.required&&M&&(m=E.isFieldElementWithInputType(m.fieldElement,"combo-box")&&m.fieldElement.input.noValueOptionLabel||this.messages.empty,I.unshift(b.tsx("calcite-combobox-item",{value:"",textLabel:this.messages.empty,key:"empty-option"},m)));return b.tsx("calcite-combobox",{...H,selectionMode:"single",disabled:H.readOnly,allowCustomValues:!1,onCalciteComboboxChange:C=>this._handleOptionChange(C.target)},I)};p._registerIncompatibleValue=function(m,
I,H,S){const F=this._fieldToInitialIncompatibleDomainValue,T=F.has(H.name);if(T||null!=m&&""!==m&&!I.some(M=>M.value===m))T||F.set(H.name,m),S?.(m)};p.renderRadioButtonsInputField=function(m,I,H){const {value:S}=m,F=I.map(T=>this.renderRadioButton({key:T.name,label:T.name,name:m.name,value:T.value,selected:T.value===S,props:H}));this._registerIncompatibleValue(S,I,m);I=L.isNone(m.fieldElement)||E.isFieldElementWithInputType(m.fieldElement,"radio-buttons")&&m.fieldElement.input.showNoValueOption;!m.required&&
I&&(I=E.isFieldElementWithInputType(m.fieldElement,"radio-buttons")&&m.fieldElement.input.noValueOptionLabel||this.messages.empty,F.unshift(this.renderRadioButton({key:"empty-option",label:I,name:m.name,value:"",selected:""===S||null===S,props:H})));return b.tsx("div",{key:`${H.key}-radio`,class:k.CSS.inputRadioGroup},F)};p.renderSwitchInputField=function(m,I){const {value:H}=m;m=E.isFieldElementWithInputType(m.fieldElement,"switch")?H===m.fieldElement.input.onValue:!1;return b.tsx("calcite-switch",
{...I,class:k.CSS.inputSwitch,onCalciteSwitchChange:S=>this._commitInputValue(S.target),checked:m,disabled:I.readOnly})};p.renderRadioButton=function({key:m,name:I,value:H,selected:S,label:F,props:T}){return b.tsx("label",{key:m,class:k.CSS.inputRadioLabel},b.tsx("input",{...T,class:k.CSS.inputRadio,name:I,type:"radio",value:H,checked:S,disabled:T.readOnly,onchange:M=>this._commitInputValue(M.target)}),F)};p.renderAuxiliaryText=function(m){const I=this._userUpdatedInputFieldNames.has(m.name)&&!m.valid?
m.errorMessage:L.isSome(this.viewModel.contingencyConstraintViolations.get(m.name))?this.messages.validationErrors.valuesIncompatible:L.isSome(m.valueExpressionExecutor)&&m.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return L.isSome(I)?b.tsx("calcite-input-message",{status:"invalid",icon:!0},I):m.description?b.tsx("div",{key:"description",class:k.CSS.description},m.description):null};p.getCommonInputProps=function(m){const {disabled:I,groupDisplay:H}=this,{editable:S,group:F,
hint:T,label:M,maxLength:J,minLength:u,name:C,required:K,type:R,valid:V,value:X}=m,ba=this._userUpdatedInputFieldNames.has(C),ea=!S||I,Y="all"===H&&L.isSome(F)&&"collapsed"===F.state;return{afterCreate:this._afterInputCreateOrUpdate,afterUpdate:this._afterInputCreateOrUpdate,"aria-invalid":V?"false":"true",class:this.classes(k.CSS.input,k.CSS.inputField,ea?k.CSS.inputDisabled:null,ba&&!V?k.CSS.inputInvalid:null),key:C,label:M,minlength:-1<u?`${u}`:"",maxlength:-1<J?`${J}`:"",...this._getNumberFieldConstraints(m),
readOnly:ea,value:null==X?"":`${X}`,["data-field-name"]:C,onfocus:this._handleInputFocus,oninput:this._handleInputInput,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:"number"===R?this._handleNumberInputMouseDown:void 0,placeholder:"number"===R||"text"===R?T??void 0:"",required:K,tabIndex:Y?-1:0}};p._isInputFieldInGroup=function(m){return!E.isGroupField(m)&&L.isSome(m.group)};p._handleNumberInputMouseDown=function({target:m}){m.focus();this.scheduleRender()};p._getFieldValueOptions=
function(m,I){I=I.codedValues.map(({code:H,name:S})=>({value:H,name:S}));m=this.viewModel.fieldsWithContingentValues.has(m)?this._getContingentValueOptions(m):[];if(0<m.length){const H=new Set(m.map(S=>S.value));I=I.filter(S=>!H.has(S.value));return[m,I]}return[I,[]]};p._getContingentValueOptions=function(m){const I={};for(var H of this.viewModel.allInputFields){const {name:F,value:T}=H;!L.isNone(T)&&F!==m&&this.viewModel.fieldsWithContingentValues.has(F)&&(I[F]=T)}var S=this.viewModel.joinedContingentValues.slice();
H=new Map;for(const F of S){S=F.values[m];if(L.isNone(S)||"code"!==S.objectType&&"null"!==S.objectType)continue;const {code:T,name:M}=S.codedValue&&"null"!==S.objectType?S.codedValue:{code:"",name:this.messages.empty};H.has(T)||Object.entries(I).every(([J,u])=>!F.values.hasOwnProperty(J)||this._valueIsValidContingentValue(u,F.values[J]))&&H.set(T,{name:M,value:T})}return[...H.values()]};p._getInputFieldFromInput=function(m){return this.viewModel.findField(m.getAttribute("data-field-name"))};p._getNumberFieldConstraints=
function(m){return(m=h.getDomainRange(m.domain)||n.getFieldRange(m.field))&&m.max!==Number.MAX_VALUE&&m.min!==Number.MIN_VALUE?m:{min:null,max:null}};p._afterDateInputCreate=async function(m){!("valueAsDate"in m)&&L.isSome(m.value)&&"setValue"in m&&m.setValue({value:m.value,origin:"external"});this._afterDateInputCreateOrUpdate(m)};p._afterDateInputCreateOrUpdate=function(m){const {name:I}=this._getInputFieldFromInput(m),H=this._dateInputFieldMap.get(I),S="valueAsDate"in m;L.isSome(H)?S?H.date=m:
H.time=m:this._dateInputFieldMap.set(I,{[S?"date":"time"]:m});this._afterInputCreateOrUpdate(m)};p._afterInputCreateOrUpdate=function(m){var {viewModel:I}=this;const H=this._getInputFieldFromInput(m);I=I.findField(this._activeInputName);const S=this._fieldToInitialIncompatibleDomainValue.get(H.name)===H.value;this._fieldFocusNeeded&&I===H&&("radio-buttons"!==H.inputType||S||m.checked)&&(this._fieldFocusNeeded=!1,this._isInputFieldInGroup(H)&&(H.group.state="expanded"),m.focus())};p._handleInputFocus=
function(m){m=m.target;const I=this._getInputFieldFromInput(m);this._activeInputName=I.name;this._isNumberInputField(I)&&(this._activeNumberFieldEdit={fieldName:I.name,input:m,value:m.value})};p._isNumberInputField=function({domain:m,inputType:I="text-box",type:H}){return"number"===H&&"text-box"===I&&(!m||"coded-value"!==m.type)};p._handleInputBlur=function(m){m=m.target;const I=this._getInputFieldFromInput(m);"number"===I.type&&L.isSome(this._activeNumberFieldEdit)&&(this._activeNumberFieldEdit.input.value=
`${I.value}`,this._activeNumberFieldEdit=null);this._commitInputValue(m);this.scheduleRender()};p._commitDateChanges=function(m,I=!1){const {name:H}=this._getInputFieldFromInput(m);if(this._dateInputFieldMap.has(H)){var S=this._dateInputFieldMap.get(H);S&&S.date&&(m=this._getFieldValueFromDateInput(m),S=this._getFieldValueFromDateInputs(S.date,S.time),this.viewModel.getValue(H)!==S&&(null===m||null===S?I&&this._updateFieldValue(H,null):this._updateFieldValue(H,S)))}};p._commitInputValue=function(m){const I=
this._getInputFieldFromInput(m);L.isSome(this._activeNumberFieldEdit)&&this._isNumberInputField(I)&&(this._activeNumberFieldEdit.value=m.value);this._updateFieldValue(I.name,this._parseValue(m))};p._handleInputKeyDown=function(m){const {key:I,altKey:H,ctrlKey:S,metaKey:F}=m;var T=this._getInputFieldFromInput(m.target);if("Enter"!==I){var {type:M}=T.field;T="single"===M||"double"===M;if(!("integer"!==M&&"small-integer"!==M&&!T||H||S||F)&&1===I.length){M=Number(I);const J=["-","+"],u=["e","."];T=T?
[...J,...u]:J;isNaN(M)&&!T.includes(I)&&m.preventDefault()}}else this._isInputFieldInGroup(T)&&"collapsed"===T.group.state&&(T.group.state="expanded")};p._updateFieldValue=function(m,I){this.viewModel.setValue(m,I);this._userUpdatedInputFieldNames.add(m);this.viewModel.fieldsWithContingentValues.has(m)&&(m=Object.fromEntries(Object.entries(this.getValues()).filter(([,H])=>L.isSome(H))),this.viewModel.validateContingencyConstraints(m))};p._parseValue=function(m){const I=this._getInputFieldFromInput(m),
H=m.value;if(E.isFieldElementWithInputType(I.fieldElement,"switch")&&"CALCITE-COMBOBOX"!==m.tagName)return m.checked?I.fieldElement.input.onValue:I.fieldElement.input.offValue;if("radio-buttons"===I.inputType&&"radio"===m.type&&!m.checked)return I.value;({type:m}=I);return"number"===m?H?parseFloat(H):null:H};p._handleOptionChange=function(m){this._commitInputValue(m);this.scheduleRender()};p._handleGroupClick=function(m){const I=m.currentTarget["data-group"],H="expanded"===I.state,S="sequential"===
this.groupDisplay,F=`.${k.CSS.groupHeader}`;if(!H||m.target.closest(F)){this._activeInputName=this._getFocusableInput("forward",I)?.name||"";if(S){m=m.target.closest(F);if(H&&!m)return;this.viewModel.inputFields.forEach(T=>{E.isGroupField(T)&&T!==I&&(T.state="collapsed")})}I.state=H?"collapsed":"expanded";this._fieldFocusNeeded=S;this.scheduleRender()}};p._handleSubmit=function(m){m.preventDefault()};p._handleFormKeyDown=function(m){"Enter"===m.key&&this.viewModel.submit()};p._getDefaultLocaleOptions=
function(){return{locale:a.getLocale(),numberingSystem:"latn"}};p._getFieldValueFromDateInputs=function(m,I){var H=this._getDateTimeFromInput(m);I=this._getDateTimeFromInput(I);if(!H&&!I)return null;m=this._getInputFieldFromInput(m);m=this._getNumberFieldConstraints(m);const S=Date.now();m=L.isSome(m.max)&&m.max<S?m.max:S;m=c.DateTime.fromMillis(m,this._getDefaultLocaleOptions());H=H||m;const {year:F,month:T,day:M}=H,{hour:J,minute:u,second:C}=I||m;H=H.set({year:F,month:T,day:M,hour:J,minute:u,second:C});
return H.isValid?H.toMillis():null};p._getDateTimeFromInput=function(m){if(!m)return null;let I=null;if("valueAsDate"in m){m=m.valueAsDate;if(!m||Array.isArray(m))return null;I=c.DateTime.fromJSDate(m)}else{if(!m.value)return null;I=c.DateTime.fromFormat(m.value,"TT",this._getDefaultLocaleOptions())}return I??null};p._getFieldValueFromDateInput=function(m){return this._dateTimeToFieldValue(this._getDateTimeFromInput(m))};p._dateTimeToFieldValue=function(m){return m?.isValid?m.toMillis():null};p._dateTimeFromFieldValue=
function(m){return null===m?null:c.DateTime.fromMillis(m,this._getDefaultLocaleOptions())};p._formatValueForDateInputs=function(m){return null==m||isNaN(m)?{date:null,time:null}:(m=this._dateTimeFromFieldValue(m))?{date:m.toJSDate(),time:m.toFormat("TT",this._getDefaultLocaleOptions())}:{date:null,time:null}};p._valueIsValidContingentValue=function(m,I){switch(I.objectType){case "any":return!0;case "null":return null==m;case "code":return m===I.codedValue?.code;case "range":return L.isSome(m)&&L.isSome(I.minValue)&&
L.isSome(I.maxValue)&&m>=I.minValue&&m<=I.maxValue;default:return x.neverReached(I.objectType),!1}};l._createClass(D,[{key:"feature",get:function(){return this.viewModel.feature},set:function(m){this.viewModel.feature=m}},{key:"formTemplate",get:function(){return this.viewModel.formTemplate},set:function(m){this.viewModel.formTemplate=m}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(m){this._overrideIfSome("label",m)}},{key:"layer",get:function(){return this.viewModel.layer},
set:function(m){this.viewModel.layer=m}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(m){this.viewModel.spatialReference=m}},{key:"strict",get:function(){return this.viewModel.strict},set:function(m){this.viewModel.strict=m}},{key:"view",get:function(){return this.viewModel.view},set:function(m){this.viewModel.view=m}}]);return D}(z);g.__decorate([B.property()],w.prototype,"disabled",void 0);g.__decorate([B.property()],w.prototype,"feature",null);g.__decorate([B.property()],
w.prototype,"formTemplate",null);g.__decorate([B.property()],w.prototype,"groupDisplay",void 0);g.__decorate([B.property()],w.prototype,"headingLevel",void 0);g.__decorate([B.property()],w.prototype,"label",null);g.__decorate([B.property()],w.prototype,"layer",null);g.__decorate([B.property(),O.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],w.prototype,"messages",void 0);g.__decorate([B.property(),O.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],w.prototype,"messagesTemplates",
void 0);g.__decorate([B.property()],w.prototype,"spatialReference",null);g.__decorate([B.property()],w.prototype,"strict",null);g.__decorate([B.property()],w.prototype,"view",null);g.__decorate([B.property(),A.vmEvent(["value-change","submit"])],w.prototype,"viewModel",void 0);return w=g.__decorate([d.subclass("esri.widgets.FeatureForm")],w)})},"esri/widgets/FeatureForm/css":function(){define(["exports"],function(e){e.CSS={base:"esri-feature-form",form:"esri-feature-form__form",formHeader:"esri-feature-form__form-header",
label:"esri-feature-form__label",inputFieldWrapper:"esri-feature-form__input-wrapper",inputFieldLoader:"esri-feature-form__input-loader",inputField:"esri-feature-form__input",inputDate:"esri-feature-form__input--date",inputTime:"esri-feature-form__input--time",inputRadioGroup:"esri-feature-form__input--radio-group",inputRadio:"esri-feature-form__input--radio",inputRadioLabel:"esri-feature-form__input--radio-label",inputDisabled:"esri-feature-form__input--disabled",inputSwitch:"esri-feature-form__input--switch",
inputInvalid:"esri-feature-form__input--invalid",inputIconInvalid:"esri-feature-form__input-icon--invalid",errorMessage:"esri-feature-form__field-error-message",description:"esri-feature-form__description-text",dateInputPart:"esri-feature-form__date-input-part",loneDateInputPart:"esri-feature-form__date-input-part--lone",dateInputContainer:"esri-feature-form__date-input-container",dateFormatHint:"esri-feature-form__date-format-hint",group:"esri-feature-form__group",groupLabel:"esri-feature-form__group-label",
groupHeader:"esri-feature-form__group-header",groupHeading:"esri-feature-form__group-header",groupTitle:"esri-feature-form__group-title",groupDescription:"esri-feature-form__group-description",groupToggleIcon:"esri-feature-form__group-toggle-icon",groupCollapsed:"esri-feature-form__group--collapsed",groupSequential:"esri-feature-form__group--sequential",groupActive:"esri-feature-form__group--active",collapseIcon:"esri-icon-up",errorIcon:"esri-icon-notice-triangle",expandIcon:"esri-icon-down",widget:"esri-widget",
panel:"esri-widget--panel",input:"esri-input",select:"esri-select"};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/featureFormUtils":function(){define(["exports","../../core/maybe","../../core/string"],function(e,l,g){function w(N,B){B=B.map((t,f)=>{let d=N[f];t.domain&&"coded-value"===t.domain.type&&(f=t.domain.codedValues.find(h=>h.code===d),f?.name&&(d=f.name));return[t.name,d]});return Object.fromEntries(B)}function x(N,B){return g.replace(g.replace(N,
t=>`{${t.toLowerCase()}}`),Object.fromEntries(Object.entries(B).map(([t,f])=>[t.toLowerCase(),f])))}const L={typeFieldName:null,types:[]};e.getComputedAttributes=w;e.getNormalizedFeatureTypeInfo=N=>N?"subtype-sublayer"===N.type?{typeFieldName:N.parent?.subtypeField,types:N.parent?.subtypes??[]}:"types"in N&&N.types?{typeFieldName:N.typeIdField,types:N.types.map(({id:B,name:t,domains:f})=>({code:B,name:t,domains:f}))}:L:L;e.isFieldElementWithInputType=(N,B)=>l.isSome(N)&&N.input?.type===B;e.isGroupField=
N=>!!N.inputFields;e.parseFormTemplateString=function(N,B,t){var f=Object.keys(B).filter(h=>g.templateHasKey(N,h));const d=f.map(h=>B[h]);f=f.map(h=>t.get(h)).filter(l.isSome);return x(N,w(d,f))};e.substituteFieldTemplatesInString=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../intl ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/maybe ../../core/Promise ../../core/reactiveUtils ../../core/string ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../form/FormTemplate ../../layers/support/ContingentValue ../../layers/support/editableLayers ../../layers/support/LayerContingentValuesCache ./featureFormUtils ./FormExpressionArcadeExecutor ./FormExpressionsManager ./InputField ./InputFieldGroup ../../intl/locale ../../intl/messages".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q,O,A,b,c,a,p,D){const P=new g({attributes:{}}),m=["editableExpression","requiredExpression","valueExpression","visibilityExpression"],I=["visibilityExpression"];g=function(F){function T(J){J=M.call(this,J);J._expressionExecutorLookup=new Map;J._expressionLookup=new Map;J._expressionsManager=null;J._contingentValuesCache=null;J._featureClone=P.clone();J._initialFeature=P.clone();J.arcadeEditType="NA";J.contingencyConstraintViolations=new Map;J.inputFields=
[];J.messages=null;J.strict=!1;J._isSupportedElement=J._isSupportedElement.bind(e._assertThisInitialized(J));return J}e._inherits(T,F);var M=e._createSuper(T);F=T.prototype;F.initialize=function(){const J=async()=>{const R=await D.fetchMessageBundle("esri/widgets/FeatureForm/t9n/FeatureForm");this.messages=R;for(const V of this.allInputFields)V.messages=R};J();const u=f.watch(()=>[this.layer,!!this.layer?.loaded,this.formTemplate],([R,V])=>{B.isSome(R)&&(V?this._updateInputFields():R.load().catch(()=>
N.getLogger(this.declaredClass).error("Failed to load layer",R.loadError)))},{equals:([R,V,X],[ba,ea,Y])=>R===ba&&V===ea&&X===Y,initial:!0}),C=f.watch(()=>this._arcadeContextInfo,R=>{B.isSome(this._expressionsManager)&&(this._expressionsManager.arcadeContextInfo=R)}),K=f.watch(()=>this.layer,R=>{(R="subtype-sublayer"===R?.type?R.parent:"feature"===R?.type?R:null)&&this.addResolvingPromise(Q.createLoadedLayerContingentValuesCache(R).then(V=>{this._contingentValuesCache=V;this.notifyChange("fieldsWithContingentValues")}))},
{initial:!0});this.handles.add([p.onLocaleChange(J),u,C,K])};F.destroy=function(){this.layer=this.feature=null;this._contingentValuesCache=B.destroyMaybe(this._contingentValuesCache)};F.findField=function(J){return this.allInputFields.find(u=>u.name===J)};F.getValue=function(J){const {_featureClone:u,layer:C}=this,K=!!C?.getField(J);return u.getAttribute(J)??(K?null:void 0)};F.setValue=function(J,u){const {_featureClone:C,strict:K}=this,R=this.findField(J);u=""===u?null:u;R&&C.getAttribute(J)!==u&&
(R.value=u,!K||R.valid)&&(this._afterValueChange(R),B.isSome(this._expressionsManager)&&this.updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([R.name]).finally(()=>this._afterExpressionsEvaluated())))};F.getValues=function(){return{...this._featureClone.attributes}};F.submit=function(){var J=this.allInputFields;const u=new Set(J.filter(K=>K.valid).map(({name:K})=>K));J=J.filter(K=>!K.valid).map(({name:K})=>K);const C=this.getValues();if(0<this.validateContingencyConstraints(C,
{includeIncompleteViolations:!0}).length)for(const [K,R]of this.contingencyConstraintViolations.entries())"error"===R.type&&(u.delete(K),J.push(K));this.emit("submit",{valid:[...u],invalid:J,values:C})};F.validateContingencyConstraints=function(J,u){const {_contingentValuesCache:C}=this,K=new Map;this.contingencyConstraintViolations=K;if(B.isNone(C))return[];const {invalid:R,incomplete:V}=C.validateContingencyConstraints(J);J=[...R,...(u?.includeIncompleteViolations?V:[])];for(const X of J)for(const ba of X.fieldGroup.fields)K.set(ba,
X);return J};F.notifyFeatureGeometryChanged=function(){const {_expressionsManager:J,feature:u,_featureClone:C}=this;C.geometry=u.geometry;B.isSome(J)&&this.updatingHandles.addPromise(J.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated()))};F._emitChangeEvent=function({name:J,valid:u,value:C}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:J,value:C,valid:u})};F._updateInputFields=function(){const {_featureClone:J,_initialFeature:u,arcadeEditType:C,
formTemplate:K,inputFields:R,messages:V,layer:X}=this,ba={arcadeEditType:C,feature:J,initialFeature:u,layer:X,messages:V},ea=R.slice();this.inputFields=B.isSome(K)&&K.elements&&0<K.elements.length?this._updateInputFieldsFromElements(ea,K.elements,ba):this._updateInputFieldsFromLayerFields(ea,X?.fields,ba)};F._updateInputFieldsFromElements=function(J,u,C){const K=new Map;for(const V of J)if(O.isGroupField(V)){S(K,V.groupElement,V);for(const X of V.inputFields)S(K,X.fieldElement,X)}else S(K,V.fieldElement,
V);J=new Map;const R=this._updateInputFieldsRecursive({existingInputFieldsByElement:K,updatedElements:u.filter(this._isSupportedElement),sharedInitializationProperties:C,group:null,newExpressionExecutorPromises:J});this.updatingHandles.addPromise(Promise.all(Array.from(J.values())).then(()=>{const V=Array.from(this._expressionExecutorLookup.values()),X=H(R);this._createExpressionsManager(V,X);return B.unwrap(this._expressionsManager).evaluateAll().finally(()=>this._afterExpressionsEvaluated())}));
for(const [V,X]of K.entries())K.delete(V),X.destroy();return R};F._updateInputFieldsRecursive=function(J){const {existingInputFieldsByElement:u,updatedElements:C,sharedInitializationProperties:K,group:R,newExpressionExecutorPromises:V}=J;J=[];for(const ba of C){var X=u.has(ba);const ea=X?u.get(ba):"group"===ba.type?this._makeInputFieldGroupFromGroupElement(ba,K):this._makeInputFieldFromFieldElement(ba,K,R);J.push(ea);X?(u.delete(ba),O.isGroupField(ea)?({feature:X}=K,ea.set({feature:X})):ea.set(K)):
this._assignExpressionExecutors(ea,ba,V);"group"===ba.type&&(X=ba.elements.filter(Y=>this._isSupportedElement(Y)),ea.inputFields=this._updateInputFieldsRecursive({existingInputFieldsByElement:u,updatedElements:X,sharedInitializationProperties:K,group:ea,newExpressionExecutorPromises:V}))}return J};F._updateInputFieldsFromLayerFields=function(J,u,C){if(!Array.isArray(u))return N.getLogger(this.declaredClass).warn(this.declaredClass,"No attribute fields found."),[];const K=new Map;for(const Y of J)if(O.isGroupField(Y)){for(const ca of Y.inputFields)ca.destroy();
Y.inputFields.length=0;Y.destroy()}else B.isSome(Y.fieldElement)?Y.destroy():K.set(Y.field,Y);J=[];const {arcadeEditType:R,feature:V,initialFeature:X,layer:ba,messages:ea}=C;for(const Y of u)u=K.get(Y)??new c({arcadeEditType:R,field:Y,feature:V,initialFeature:X,layer:ba,messages:ea,value:V.getAttribute(Y.name)??null}),J.push(u),K.delete(Y);for(const [Y,ca]of K.entries())K.delete(Y),ca.destroy();return J};F._resetInputFieldValues=function(J){for(const u of this.allInputFields)u.value=J.getAttribute(u.name)};
F._makeInputFieldFromFieldElement=function(J,u,C){const {arcadeEditType:K,feature:R,initialFeature:V,layer:X,messages:ba}=u;return new c({arcadeEditType:K,fieldElement:J,field:this._layerFieldsByName.get(J.fieldName),value:R.getAttribute(J.fieldName)??null,feature:R,initialFeature:V,layer:X,group:C,messages:ba})};F._makeInputFieldGroupFromGroupElement=function(J,u){const {feature:C,initialFeature:K}=u;return new a({groupElement:J,inputFields:[],feature:C,initialFeature:K})};F._assignExpressionExecutors=
function(J,u,C){var K="group"===u.type?I:m;for(const R of K){K=u[R];const {_expressionExecutorLookup:V}=this;if(B.isSome(K)&&""!==K){const X=`${R}Executor`,ba=this._expressionLookup.get(K)??this._addToExpressionLookup(K);V.has(ba)?J[X]=V.get(ba):C.has(ba)?(K=C.get(ba).then(ea=>J[X]=ea),C.set(ba,K)):(K=A.createFormExpressionArcadeExecutor(ba,this.layer).then(ea=>{J[X]=ea;V.set(ba,ea);return ea}),C.set(ba,K))}}return[]};F._createExpressionsManager=function(J,u){const {_arcadeContextInfo:C,_featureClone:K}=
this;this._expressionsManager=new b.FormExpressionsManager({executors:J,feature:K,arcadeContextInfo:C,inputFields:u})};F._afterValueChange=function(J){const {name:u,value:C}=J,{_featureClone:K,formTemplate:R,layer:V}=this;if(V){var X=K.getAttribute(u);K.setAttribute(u,C);var {typeFieldName:ba,types:ea}=O.getNormalizedFeatureTypeInfo(V);if(u===ba&&C!==X){"subtype-sublayer"===V.type&&(X=V.parent?.findSublayerForFeature(K),K.sourceLayer=this.feature.sourceLayer=X);X=new Set;for(var Y of ea)if(Y.domains&&
"object"===typeof Y.domains)for(const ca of Object.keys(Y.domains))X.add(ca);for(const ca of X)(Y=this.findField(ca))&&Y.notifyChange("domain")}if(B.isSome(R)){const {description:ca,title:da}=R;da&&d.templateHasKey(da,u)&&this.notifyChange("formTitle");ca&&d.templateHasKey(ca,u)&&this.notifyChange("formDescription")}this._emitChangeEvent(J)}};F._afterExpressionsEvaluated=function(){const {_featureClone:J}=this;for(const u of this.allInputFields)u.value!==J.getAttribute(u.name)&&this._afterValueChange(u)};
F._addToExpressionLookup=function(J){const {_expressionLookup:u,formTemplate:C}=this,K=(B.isSome(C)&&B.isSome(C.expressionInfos)?Object.values(C.expressionInfos).find(R=>R.name===J):null)?.expression??J;u.set(J,K);J!==K&&u.set(K,K);return K};F._isSupportedElement=function(J){if("field"===J.type||"group"===J.type)return!0;N.getLogger(this.declaredClass).warn("form-info::unsupported-element-type","Only element types 'field' and 'group' are supported",`Element ${J.label} has unsupported type '${J.type}'`);
return!1};F._joinContingentValues=function(){var J=this._contingentValuesCache;if(B.isNone(J))return[];var {typeFieldName:u}=O.getNormalizedFeatureTypeInfo(this.layer);u=u?this.getValue(u):null;const C=[];for(var K of J.fieldGroups){const {contingencies:ba,fields:ea,name:Y}=K;J=[];for(var R of ba)R.isRetired||B.isSome(R.subtype)&&R.subtype.code!==u||J.push({values:R.values});0<J.length&&C.push({name:Y,fields:ea,contingencies:J})}const [V,X]=this._generateJoinPlan(C);K=V.flatMap(ba=>this._joinFieldGroupContingencies(ba));
R=X.flatMap(ba=>ba.contingencies);return[...K,...R]};F._generateJoinPlan=function(J){var u=new Map,C=[],K=new Set;for(var R of J)for(const ea of R.fields)if(u.has(ea)){const Y=u.get(ea),ca=R,da=[Y.name,ca.name].sort().join("|");K.has(da)||(C.push([Y,ca]),K.add(da),u.set(ea,ca))}else u.set(ea,R);u=new Set(C.flat());J=new Set(J);for(var V of u)J.delete(V);V=new Map;u=new Map;for(var X of new Set(C.flat()))K=Symbol(X.name),V.set(K,new Set([X])),u.set(X,K);for(const [ea,Y]of C)if(C=u.get(ea),X=u.get(Y),
C!==X){K=V.get(C);R=V.get(X);for(var ba of R)K.add(ba),u.set(ba,C);V.delete(X)}ba=[...V.values()].map(ea=>[...ea]);C=[...J];return[ba,C]};F._joinFieldGroupContingencies=function(J){const u=J.slice();var C=u.shift(),K=u.shift();J=this._generateJoinKey(C.fields,K.fields);let R=new Set([...C.fields,...K.fields]),V=new Map;for(var X of C.contingencies)[C]=this._hashContingency(X,J.codedValueFields,!0),V.has(C)?V.get(C)?.push(X):V.set(C,[X]);for(;0<u.length;){X=new Map;C=u.shift();const Y=this._generateJoinKey(R,
C.fields);for(var ba of K.contingencies){const [ca,da]=this._hashContingency(ba,J.codedValueFields);K=da?this._findMatchingContingenciesWithAnyHashMask(V,ca):V.get(ca);V.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&K?.push(...this._findMatchingContingenciesContainingAny(ba,V.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),J.codedValueFields));if(!B.isNone(K))for(var ea of K){K=0<J.rangeFields.length?this._joinContingenciesWithRangeDomains(ea,ba,J.rangeFields):this._joinContingencies(ea,ba);if(B.isNone(K))break;
const [ja]=this._hashContingency(K,Y.codedValueFields,!0);X.has(ja)?X.get(ja)?.push(K):X.set(ja,[K])}}V=X;K=C;J=Y;R=new Set([...R,...K.fields])}ba=[];for(const Y of K.contingencies){const [ca,da]=this._hashContingency(Y,J.codedValueFields);ea=da?this._findMatchingContingenciesWithAnyHashMask(V,ca):V.get(ca);V.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&ea.push(...this._findMatchingContingenciesContainingAny(Y,V.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),J.codedValueFields));if(!B.isNone(ea))for(const ja of ea)ea=
0<J.rangeFields.length?this._joinContingenciesWithRangeDomains(ja,Y,J.rangeFields):this._joinContingencies(ja,Y),B.isSome(ea)&&ba.push(ea)}return ba};F._joinContingencies=function(J,u){u={values:{...J.values,...u.values}};for(const [C,K]of Object.entries(u.values))"any"===K.objectType&&B.isSome(J.values[C])&&(u.values[C]=J.values[C]);return u};F._joinContingenciesWithRangeDomains=function(J,u,C){const K=this._joinContingencies(J,u);for(const V of C){var R=J.values[V];const X=u.values[V],{leftIsNull:ba,
rightIsNull:ea,bothAreNull:Y,leftIsAny:ca,rightIsAny:da,bothAreAny:ja,leftIsRange:pa,rightIsRange:sa}=this._compareObjectTypes(R.objectType,X.objectType);if(!Y&&!ja)if(ba&&da||ea&&ca)K.values[V]=new y({objectType:"null"});else{if(ba&&sa||ea&&pa)return null;ca?(R.minValue=-Infinity,R.maxValue=Infinity):da&&(X.minValue=-Infinity,X.maxValue=Infinity);C=Math.max(R.minValue,X.minValue);R=Math.min(R.maxValue,X.maxValue);if(C>R)return null;K.values[V]=new y({objectType:"range",minValue:C,maxValue:R})}}return K};
F._findMatchingContingenciesContainingAny=function(J,u,C){return u.filter(K=>C.every(R=>{const V=K.values[R];R=J.values[R];return"any"===V.objectType||"any"===R.objectType||V.codedValue?.code===R.codedValue?.code}))};F._findMatchingContingenciesWithAnyHashMask=function(J,u){u=RegExp(`${u}$`);const C=[];for(const [K,R]of J){if("#JSAPI_CONTINGENT_VALUE_ANY_HASH"===K)break;u.test(K)&&C.push(...R)}return C};F._generateJoinKey=function(J,u){J=Array.isArray(J)?new Set(J):J;var C=Array.isArray(u)?new Set(u):
u;u=J.size<C.size?J:C;J=u===J?C:J;C=new Set;const K=new Set;for(const R of u)if(J.has(R)&&(u=this.layer?.getFieldDomain(R,{feature:this.feature}),!B.isNone(u)))switch(u.type){case "coded-value":C.add(R);break;case "range":K.add(R)}return{codedValueFields:[...C],rangeFields:[...K]}};F._hashContingency=function(J,u,C=!1){if(1>u.length)return["#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",!1];const K=[];let R=!1;for(const V of u)if(u=J.values[V],"any"===u.objectType){if(C)return["#JSAPI_CONTINGENT_VALUE_ANY_HASH",
!0];R=!0;K.push(`${V}:.*`)}else"null"===u.objectType?K.push(`${V}:${"#JSAPI_CONTINGENT_VALUE_NULL_HASH"}`):K.push(`${V}:${u.codedValue?.code}`);return[K.sort().join("\x26"),R]};F._compareObjectTypes=function(J,u){return{leftIsNull:"null"===J,rightIsNull:"null"===u,bothAreNull:"null"===J&&"null"===u,leftIsAny:"any"===J,rightIsAny:"any"===u,bothAreAny:"any"===J&&"any"===u,leftIsRange:"range"===J,rightIsRange:"range"===u}};e._createClass(T,[{key:"_arcadeContextInfo",get:function(){const {_initialFeature:J,
arcadeEditType:u,layer:C,spatialReference:K,view:R}=this;return{layer:r.isEditableLayer(C)?C:null,originalFeature:J,editType:u,spatialReference:K,map:R?.map}}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"allInputFields",get:function(){return H(this.inputFields)}},{key:"_layerFieldsByName",get:function(){return new Map(this.layer?.fields.map(J=>[J.name,J]))}},{key:"feature",get:function(){return this._get("feature")},set:function(J){this._featureClone=J?J.clone():P.clone();
this._initialFeature=this._featureClone.clone();this._resetInputFieldValues(this._featureClone);this.contingencyConstraintViolations.clear();B.isSome(this._expressionsManager)&&(this._expressionsManager.resetExecutors(),this._expressionsManager.feature=this._featureClone,this.updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())));this._set("feature",J)}},{key:"fieldsWithContingentValues",get:function(){if(B.isNone(this._contingentValuesCache))return new Set;
const J=this._contingentValuesCache.fieldGroups.flatMap(u=>u.fields);return new Set(J)}},{key:"formTemplate",get:function(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null},set:function(J){void 0===J?this._clearOverride("formTemplate"):this._override("formTemplate",J)}},{key:"formDescription",get:function(){const {formTemplate:J,layer:u}=this;return!B.isNone(J)&&J.description&&u?O.parseFormTemplateString(J.description,this.getValues(),u.fieldsIndex):null}},{key:"formTitle",
get:function(){const {formTemplate:J,layer:u}=this;return!B.isNone(J)&&J.title&&u?O.parseFormTemplateString(J.title,this.getValues(),u.fieldsIndex):null}},{key:"joinedContingentValues",get:function(){return this._joinContingentValues()}},{key:"layer",get:function(){return this.feature?.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null},set:function(J){this._override("layer",J)}},{key:"spatialReference",get:function(){return this.layer?.spatialReference??null},set:function(J){this._override("spatialReference",
J)}},{key:"state",get:function(){return this.messages&&this.get("layer.loaded")?"ready":"disabled"}},{key:"submittable",get:function(){return this.valid?!0:this.allInputFields.filter(J=>!J.valid).every(({submittable:J})=>J)}},{key:"valid",get:function(){const J=this.allInputFields;return 0<J.length&&J.every(({valid:u})=>u)}}]);return T}(L.HandleOwnerMixin(t.EsriPromiseMixin(x.EventedAccessor)));l.__decorate([h.property()],g.prototype,"_featureClone",void 0);l.__decorate([h.property()],g.prototype,
"_arcadeContextInfo",null);l.__decorate([h.property()],g.prototype,"updating",null);l.__decorate([h.property({readOnly:!0})],g.prototype,"allInputFields",null);l.__decorate([h.property()],g.prototype,"_layerFieldsByName",null);l.__decorate([h.property()],g.prototype,"arcadeEditType",void 0);l.__decorate([h.property()],g.prototype,"contingencyConstraintViolations",void 0);l.__decorate([h.property()],g.prototype,"feature",null);l.__decorate([h.property()],g.prototype,"fieldsWithContingentValues",null);
l.__decorate([h.property({type:v})],g.prototype,"formTemplate",null);l.__decorate([h.property()],g.prototype,"formDescription",null);l.__decorate([h.property()],g.prototype,"formTitle",null);l.__decorate([h.property()],g.prototype,"inputFields",void 0);l.__decorate([h.property()],g.prototype,"joinedContingentValues",null);l.__decorate([h.property()],g.prototype,"layer",null);l.__decorate([h.property()],g.prototype,"messages",void 0);l.__decorate([h.property()],g.prototype,"spatialReference",null);
l.__decorate([h.property()],g.prototype,"state",null);l.__decorate([h.property()],g.prototype,"strict",void 0);l.__decorate([h.property()],g.prototype,"submittable",null);l.__decorate([h.property()],g.prototype,"valid",null);l.__decorate([h.property()],g.prototype,"view",void 0);l.__decorate([h.property()],g.prototype,"getValues",null);l.__decorate([h.property()],g.prototype,"submit",null);g=l.__decorate([E.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],g);const H=F=>F.reduce((T,M)=>O.isGroupField(M)?
[...T,...M.inputFields]:[...T,M],[]),S=(F,T,M)=>{B.isSome(T)&&F.set(T,M)};return g})},"esri/layers/support/ContingentValue":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(e,l,g,w,x,L,N,B){g=function(t){function f(h){h=d.call(this,h);h.maxValue=null;h.minValue=
null;h.codedValue=null;return h}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);l.__decorate([w.property()],g.prototype,"objectType",void 0);l.__decorate([w.property()],g.prototype,"maxValue",void 0);l.__decorate([w.property()],g.prototype,"minValue",void 0);l.__decorate([w.property()],g.prototype,"codedValue",void 0);return g=l.__decorate([B.subclass("esri.layers.support.ContingentValue")],g)})},"esri/layers/support/LayerContingentValuesCache":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/JSONSupport ../../core/Loadable ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./arcgisLayerUrl ./Contingency ./ContingencyConstraintViolation ./ContingentValue ./ContingentValuesResult ./FieldGroup ./Subtype".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y){var r;w=r=function(Q){function O(b){b=A.call(this,b);b.request=g;b.fieldGroups=null;b.fieldGroupDefinitions=null;return b}e._inherits(O,Q);var A=e._createSuper(O);Q=O.prototype;Q.initialize=function(){};O.createLoadedLayerContingentValuesCache=async function(b){await b.load();if(void 0===b.layerId)return null;var c=b.sourceJSON.hasContingentValuesDefinition;if(c)return(new r({layer:b})).load();if(void 0===c){c=h.parse(b.url);if(L.isNone(c))return null;
c=c.url.path;if((await r._staticFetchEnterpriseFeatureRoot(c)).supportsQueryDataElements&&(c=await r._staticFetchEnterpriseFieldGroup(c,b.layerId.toString())))return c=c.map(a=>({name:a.name,isEditingRestrictive:a.isEditingRestrictive,fields:a.fieldNames.names})),(new r({layer:b,fieldGroupDefinitions:c})).load()}return null};Q.load=async function(b){const c=this.layer.load(b).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,b));this.addResolvingPromise(c);return this};Q.validateContingencyConstraints=
function(b,c){const a=Object.keys(b),p=[],D=[];for(const m of this.fieldGroups){const I=m.isEditingRestrictive?"error":"warning";if(c&&!m.fields.some(F=>c.includes(F)))continue;if(!m.fields.every(F=>a.includes(F))){D.push(new z({fieldGroup:m,type:I}));continue}let H=!1;const S=b[this.subtypeFieldName];var P=m.contingencies.filter(F=>!F.isRetired&&F.subtype?F.subtype.code===S:!0);for(const F of P){P=!0;for(const T in F.values){const M=F.values[T];if("any"!==M.objectType)if("null"===M.objectType){if(null!=
b[T]){P=!1;break}}else if("code"===M.objectType){if(b[T]!==M.codedValue.code){P=!1;break}}else if("range"===M.objectType){const J=b[T];if(J<M.minValue||J>M.maxValue){P=!1;break}}}if(P){H=!0;break}}H||p.push(new z({fieldGroup:m,type:I}))}return{invalid:p,incomplete:D}};Q.getContingentValues=function(b,c,a=!1){const p=b[this.subtypeFieldName],D=void 0!==p&&null!==p,P={};let m=[];const I=this.fieldGroups.filter(S=>S.fields.includes(c));m.push(new k({objectType:"any"}));for(const S of I){let F=[];var H=
S.contingencies.filter(J=>!J.isRetired&&(J.subtype&&D?J.subtype.code===p:!0));let T=!1;const M={};for(const J of H){let u;H=!0;for(const C in J.values){const K=J.values[C];if(c===C)u=K,T=T||"range"===K.objectType;else if(void 0!==b[C]&&"any"!==K.objectType)if("null"===K.objectType)null!==b[C]&&(H=!1);else if("code"===K.objectType)b[C]!==K.codedValue.code&&(H=!1);else if("range"===K.objectType){const R=b[C];if(R<K.minValue||R>K.maxValue)H=!1}}if(u&&H){if("any"===u.objectType){F.length=0;F.push(u);
break}H=this._generateKey(u);M[H]||F.push(u);M[H]=!0}}T&&(F=this._joinRange(F));P[S.name]=F;m=a?this._filterIntersection(m,F):[]}1===I.length&&a&&(m=[]);return new E({contingentValuesAllGroups:m,contingentValuesByFieldGroup:P})};Q._generateKey=function(b){switch(b.objectType){case "any":return"@any@";case "null":return"@null@";case "code":return b.codedValue.name+b.codedValue.code.toString();case "range":return b.minValue.toString()+"-"+b.maxValue.toString()}};Q._joinRange=function(b){b.sort((D,P)=>
"null"===D.objectType?-1:"null"===P.objectType?1:D.minValue-P.minValue);let c,a;const p=[];for(const D of b)"null"===D.objectType?p.push(D):null==c||null==a?(c=D.minValue,a=D.maxValue):a<D.minValue?(p.push(new k({objectType:"range",minValue:c,maxValue:a})),c=D.minValue,a=D.maxValue):a<D.maxValue&&(a=D.maxValue);p.push(new k({objectType:"range",minValue:c,maxValue:a}));return p};Q._filterIntersection=function(b,c){if(0===b.length||0===c.length)return[];if("any"===b[0].objectType)return c;if("any"===
c[0].objectType)return b;const a="range"===c[0].objectType||"range"===c[1]?.objectType;return"range"===b[0].objectType||"range"===b[1]?.objectType||a?this._intersectRanges(b,c):this._intersectValues(b,c)};Q._intersectRanges=function(b,c){const a=[];let p=0;for(const D of b)for(;p<c.length;p++){const P=c[p];if("null"===D.objectType&&"null"===P.objectType)a.push(new k({objectType:"null"}));else if("null"===D.objectType)break;else if("null"===P.objectType)continue;if(D.maxValue<P.minValue)break;if(D.maxValue===
P.minValue){a.push(new k({objectType:"range",minValue:D.maxValue,maxValue:P.minValue}));break}if(!(D.minValue>P.maxValue))if(D.minValue===P.maxValue)a.push(new k({objectType:"range",minValue:D.minValue,maxValue:P.maxValue}));else{b=D.minValue>P.minValue?D.minValue:P.minValue;if(D.maxValue<P.maxValue){a.push(new k({objectType:"range",minValue:b,maxValue:D.maxValue}));break}a.push(new k({objectType:"range",minValue:b,maxValue:P.maxValue}))}}return a};Q._intersectValues=function(b,c){const a=[];for(const p of b)c.some(D=>
{if(p.objectType===D.objectType)switch(p.objectType){case "any":case "null":return!0;case "code":return p.codedValue.code===D.codedValue.code&&p.codedValue.name===D.codedValue.name}return!1})&&a.push(p);return a};O._staticFetchEnterpriseFeatureRoot=async function(b,c){return g(b,{responseType:"json",query:{f:"json"},...c}).then(a=>a.data)};O._staticFetchEnterpriseFieldGroup=async function(b,c,a){return g(`${b}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([c]),f:"json"},...a}).then(p=>
p.data.layerDataElements?.[0].dataElement.fieldGroups)};Q._initializeContingentValues=async function(b,c){b=b??await this._fetchFieldGroupDefs(c);this.fieldGroups=0===b.length?[]:await this._fetchContingentValues(b,c)};Q._fetchFieldGroupDefs=async function(b){if(void 0===this.layer.layerId)return[];const c=this.layer.sourceJSON,a=this.layer.layerId.toString(),p=L.unwrap(h.parse(this.layer.url)).url.path;return c.hasContingentValuesDefinition?(await this._fetchAGOLFieldGroup(p,a,b)).map(D=>({name:D.name,
isEditingRestrictive:D.restrictive,fields:D.fields.map(P=>this.layer.fieldsIndex.normalizeFieldName(P))})):void 0!==c.hasContingentValuesDefinition?[]:this._fetchEnterpriseFeatureRoot(p,b).then(async D=>D.supportsQueryDataElements?(await this._fetchEnterpriseFieldGroup(p,a,b)).map(P=>({name:P.name,isEditingRestrictive:P.isEditingRestrictive,fields:P.fieldNames.names.map(m=>this.layer.fieldsIndex.normalizeFieldName(m))})):[])};Q._fetchAGOLFieldGroup=async function(b,c,a){return g(`${b}/${c}/fieldgroups`,
{responseType:"json",query:{f:"json"},...a}).then(p=>p.data.fieldGroups)};Q._fetchEnterpriseFieldGroup=async function(b,c,a){return r._staticFetchEnterpriseFieldGroup(b,c,a)};Q._fetchEnterpriseFeatureRoot=async function(b,c){return r._staticFetchEnterpriseFeatureRoot(b,c)};Q._fetchContingentValues=async function(b,c){if(void 0===this.layer.layerId)return[];const a=this.layer.sourceJSON,p=this.layer.layerId.toString(),D=L.unwrap(h.parse(this.layer.url)).url.path;if(a.hasContingentValuesDefinition)return c=
await this._fetchAGOLContingentValues(D,p,c),this._constructFieldGroupsAGOL(b,c);c=await this._fetchEnterpriseContingentValues(D,p,c);return this._constructFieldGroupsEnterprise(b,c)};Q._constructFieldGroupsAGOL=function(b,c){return b.map(a=>{const p=c.contingentValuesDefinition.fieldGroups.find(D=>D.name===a.name);if(p){let D=[];D=c.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(a,c,p.subTypes):this._parseAGOLFieldGroup(a,c,p.contingentValues);return new v({name:a.name,isEditingRestrictive:a.isEditingRestrictive,
fields:a.fields,contingencies:D})}return null}).filter(L.isSome)};Q._parseAGOLFieldGroupSubtype=function(b,c,a){let p=[];a?.forEach(D=>{const P=this._getSubtypeAGOL(D.name);p=p.concat(this._parseAGOLFieldGroup(b,c,D.contingentValues,P))});return p};Q._parseAGOLFieldGroup=function(b,c,a,p=null){const D=[];for(const P of a??[])a=this._parseAGOLContingency(P,b,c,p),D.push(a);return D};Q._parseAGOLContingency=function(b,c,a,p){const D=b.id,P=b.retired?1===b.retired:!1,m={};for(let H=0,S=0;H<c.fields.length;H++){const F=
c.fields[H];var I=a.typeCodes[b.types[H]];if("Code"===I){let T=b.values[S];S++;const M=this._getDomain(p,F);"string"===this.layer.getField(F)?.type&&(I=a.stringDicts.find(J=>J.domain===M.name))&&(T=I.entries[T]);I=M.codedValues.find(J=>J.code===T);I=new k({codedValue:I,objectType:"code"});m[F]=I}else"Range"===I?(I=b.values[S],S++,I=new k({minValue:I.range[0],maxValue:I.range[1],objectType:"range"}),m[F]=I):"Any"===I?(I=new k({objectType:"any"}),m[F]=I):(I=new k({objectType:"null"}),m[F]=I)}return new n({id:D,
isRetired:P,subtype:p,values:m})};Q._constructFieldGroupsEnterprise=function(b,c){const a=c.fieldGroups;return b.map(p=>{var D=a.find(P=>P.name===p.name);return D?(D=D.contingencies.map(P=>{const m=P.id,I=P.isRetired||!1,H=this._getSubtypeEnterprise(P.subtypeCode),S={};for(let T=0;T<p.fields.length;T++){const M=p.fields[T];let J=P.values[T];if("number"===typeof J||"string"===typeof J){var F=this._getDomain(H,M);const u=this.layer.getField(M);"string"===u?.type?J=c.stringDictionary[J]:"date"===u?.type&&
(J=(new Date(`${J}+00:00`)).getTime());F=F.codedValues.find(C=>C.code===J);F=new k({codedValue:F,objectType:"code"});S[M]=F}else"object"===typeof J?(F=new k({minValue:J.minValue,maxValue:J.maxValue,objectType:"range"}),S[M]=F):J?(F=new k({objectType:"any"}),S[M]=F):(F=new k({objectType:"null"}),S[M]=F)}return new n({id:m,isRetired:I,subtype:H,values:S})}),new v({name:p.name,isEditingRestrictive:p.isEditingRestrictive,fields:p.fields,contingencies:D})):null}).filter(L.isSome)};Q._fetchEnterpriseContingentValues=
async function(b,c,a){return g(`${b}/queryContingentValues`,{responseType:"json",query:{layers:JSON.stringify([c]),f:"json"},...a}).then(p=>p.data.contingentValueSets?.[0])};Q._fetchAGOLContingentValues=async function(b,c,a){return g(`${b}/${c}/contingentValues`,{responseType:"json",query:{f:"json"},...a}).then(p=>p.data)};Q._getSubtypeEnterprise=function(b){var c=this.layer.sourceJSON;let a;c.subtypes&&(c=c.subtypes.find(p=>p.code===b),a=y.fromJSON(c));return a||null};Q._getSubtypeAGOL=function(b){var c=
this.layer.sourceJSON;let a;c.subtypes&&(c=c.subtypes.find(p=>p.name===b),a=y.fromJSON(c));return a||null};Q._getDomain=function(b,c){b=b?b.domains?.[c]:this.layer.getFieldDomain(c);return"inherited"===b?.type?this.layer.getFieldDomain(c):b};e._createClass(O,[{key:"subtypeFieldName",get:function(){const {layer:b}=this;return"subtype-group"===b.type?b.subtypeField:b.typeIdField}}]);return O}(w.JSONSupportMixin(x));l.__decorate([N.property({constructOnly:!0})],w.prototype,"layer",void 0);l.__decorate([N.property({constructOnly:!0})],
w.prototype,"request",void 0);l.__decorate([N.property({type:[v]})],w.prototype,"fieldGroups",void 0);l.__decorate([N.property({constructOnly:!0})],w.prototype,"fieldGroupDefinitions",void 0);l.__decorate([N.property()],w.prototype,"subtypeFieldName",null);return w=r=l.__decorate([d.subclass("esri.layers.support.LayerContingentValuesCache")],w)})},"esri/layers/support/Contingency":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B){g=function(t){function f(h){h=d.call(this,h);h.isRetired=!1;return h}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);l.__decorate([w.property()],g.prototype,"id",void 0);l.__decorate([w.property()],g.prototype,"isRetired",void 0);l.__decorate([w.property()],g.prototype,"subtype",void 0);l.__decorate([w.property()],g.prototype,"values",void 0);return g=l.__decorate([B.subclass("esri.layers.support.Contingency")],g)})},"esri/layers/support/ContingencyConstraintViolation":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B){g=function(t){function f(h){return d.call(this,h)}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);l.__decorate([w.property()],g.prototype,"fieldGroup",void 0);l.__decorate([w.property()],g.prototype,"type",void 0);return g=l.__decorate([B.subclass("esri.layers.support.ContingencyConstraintViolation")],g)})},"esri/layers/support/ContingentValuesResult":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B){g=function(t){function f(h){return d.call(this,h)}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);l.__decorate([w.property()],g.prototype,"contingentValuesAllGroups",void 0);l.__decorate([w.property()],g.prototype,"contingentValuesByFieldGroup",void 0);return g=l.__decorate([B.subclass("esri.layers.support.ContingentValuesResult")],g)})},"esri/layers/support/FieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B){g=function(t){function f(h){h=d.call(this,h);h.fields=null;h.isEditingRestrictive=!1;return h}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);l.__decorate([w.property()],g.prototype,"name",void 0);l.__decorate([w.property()],g.prototype,"fields",void 0);l.__decorate([w.property()],g.prototype,"isEditingRestrictive",void 0);l.__decorate([w.property()],g.prototype,"contingencies",void 0);return g=l.__decorate([B.subclass("esri.layers.support.FieldGroup")],
g)})},"esri/layers/support/Subtype":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./domains".split(" "),function(e,l,g,w,x,L,N,B,t,f,d){g=function(h){function n(){var k=z.apply(this,arguments);
k.code=null;k.defaultValues={};k.domains=null;k.name=null;return k}e._inherits(n,h);var z=e._createSuper(n);h=n.prototype;h.readDomains=function(k){if(!k)return null;const E={};for(const v of Object.keys(k))E[v]=d.fromJSON(k[v]);return E};h.writeDomains=function(k,E){if(k){var v={};for(const y of Object.keys(k))k[y]&&(v[y]=k[y]?.toJSON());E.domains=v}};return e._createClass(n)}(g.JSONSupport);l.__decorate([w.property({type:Number,json:{write:!0}})],g.prototype,"code",void 0);l.__decorate([w.property({type:Object,
json:{write:!0}})],g.prototype,"defaultValues",void 0);l.__decorate([w.property({json:{write:!0}})],g.prototype,"domains",void 0);l.__decorate([B.reader("domains")],g.prototype,"readDomains",null);l.__decorate([f.writer("domains")],g.prototype,"writeDomains",null);l.__decorate([w.property({type:String,json:{write:!0}})],g.prototype,"name",void 0);return g=l.__decorate([t.subclass("esri.layers.support.Subtype")],g)})},"esri/widgets/FeatureForm/FormExpressionArcadeExecutor":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../arcade ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/support/WatchUpdatingTracking ../../layers/support/fieldUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n){B=Symbol("FormExpressionArcadeExecutor");e.FormExpressionArcadeExecutor=function(k){function E(y){var r=v.call(this,y);r[z]=!0;r._lastEvaluatedValue=null;r._abortController=new AbortController;r._stale=!1;r._updatingTracking=new h.WatchUpdatingTracking;r._executeAsyncDebounced=L.debounce(async(Q,O,A)=>{Q=await r.executor.executeAsync(Q,{...O,abortSignal:A});if(A.aborted)return r._lastEvaluatedValue;r._lastEvaluatedValue=Q;r._stale=!1;return Q});return r}l._inherits(E,
k);var v=l._createSuper(E);k=E.prototype;k.abort=function(){this._abortController.abort()};k.execute=function(y,r){this._abortController=new AbortController;return this._lastEvaluatedValue=y=this.executor.execute(y,{...r,abortSignal:this._abortController.signal})};k.executeAsync=async function(y,r){this._abortController=new AbortController;return this._updatingTracking.addPromise(this._executeAsyncDebounced(y,r??{},this._abortController.signal))};k.markStale=function(){this._stale=!0};k.reset=function(){this.abort();
this._lastEvaluatedValue=null;this._stale=!1};l._createClass(E,[{key:"isAsync",get:function(){return this.executor.isAsync}},{key:"fieldsUsed",get:function(){return this.executor.fieldsUsed}},{key:"syntaxTree",get:function(){return this.executor.syntaxTree}},{key:"updating",get:function(){return this._updatingTracking.updating}},{key:"stale",get:function(){return this._stale}},{key:"geometryUsed",get:function(){return this.executor.geometryUsed}},{key:"variablesUsed",get:function(){return this.executor.variablesUsed}},
{key:"lastEvaluatedValue",get:function(){return this._lastEvaluatedValue}}]);return E}(x);var z=B;g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"_lastEvaluatedValue",void 0);g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"_stale",void 0);g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"_updatingTracking",void 0);g.__decorate([N.property({constructOnly:!0})],e.FormExpressionArcadeExecutor.prototype,"executor",void 0);g.__decorate([N.property()],
e.FormExpressionArcadeExecutor.prototype,"isAsync",null);g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"fieldsUsed",null);g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"syntaxTree",null);g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"updating",null);g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"stale",null);g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"geometryUsed",null);g.__decorate([N.property()],
e.FormExpressionArcadeExecutor.prototype,"variablesUsed",null);g.__decorate([N.property()],e.FormExpressionArcadeExecutor.prototype,"lastEvaluatedValue",null);e.FormExpressionArcadeExecutor=g.__decorate([d.subclass("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],e.FormExpressionArcadeExecutor);e.createFormExpressionArcadeExecutor=async(k,E)=>{const v=w.createArcadeProfile("form-calculation");k=await w.createArcadeExecutor(k,v,{});E?.fieldsIndex&&(k.fieldsUsed=n.fixFields(E.fieldsIndex,k.fieldsUsed));
return new e.FormExpressionArcadeExecutor({executor:k})};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/arcade":function(){define("exports ./Graphic ./arcade/ArcadeDate ./arcade/ImmutableArray ./core/Error ./core/lang ./layers/FeatureLayer ./portal/Portal ./rest/support/FeatureSet ./support/arcadeOnDemand".split(" "),function(e,l,g,w,x,L,N,B,t,f){function d(b,c,a,p={}){c=c.elementType;const D="array"===c.type?[{name:"value",type:c.type,elementType:c.elementType}]:"dictionary"===
c.type?[{name:"value",type:c.type,properties:c.properties}]:[{name:"value",type:c.type}];return new w(b.map(P=>{const m={};k(m,D,{value:P},a,p);return m.value}))}function h(b,c,a={}){b=b instanceof t?new N({source:b.features,geometryType:b.geometryType,fields:b.fields,spatialReference:b.spatialReference}):b;return c.constructFeatureSet(b,a.spatialReference,null,!0,a.lruCache,a.interceptor)}function n(b,c,a={}){const {spatialReference:p,interceptor:D,lruCache:P}=a;return"string"===typeof b?c.createFeatureSetCollectionFromService(b,
p,P,D):c.createFeatureSetCollectionFromMap(b,p,P,D)}function z(b,c,a,p={}){const D={};k(D,c.properties,b,a,p);return new r.Dictionary(D)}function k(b,c,a,p,D={}){const P={};for(const m of Object.keys(a))P[m.toLowerCase()]=a[m];for(const m of c)if(c=m.name.toLowerCase(),D.variablesPreProcessed)b[c]=P[c];else switch(m.type){case "array":b[c]=d(P[c],m,p,D);break;case "feature":a=P[c];b[c]=null==a?null:r.Feature.createFromGraphic(a,D?.timeReference);break;case "featureSet":a=P[c];b[c]=p?h(a,p,D):null;
break;case "featureSetCollection":a=P[c];b[c]=p?n(a,p,D):null;break;case "dictionary":b[c]=z(P[c],m,p,D);break;case "date":a=P[c];b[c]=a?a instanceof g.ArcadeDate?a:D?.timeReference?.timeZone?g.ArcadeDate.dateJSAndZoneToArcadeDate(a,D?.timeReference?.timeZone):g.ArcadeDate.dateJSToArcadeDate(a):null;break;case "geometry":case "boolean":case "text":case "number":b[c]=P[c]}}function E(b,c){for(const a of b)c.push(a),"dictionary"===a.type&&E(a.properties,c);return c}function v(b,c,a,p,D){const {spatialReference:P,
interceptor:m,lruCache:I,console:H,abortSignal:S,timeReference:F,services:T={portal:B.getDefault()}}=a;D={vars:{},spatialReference:P,interceptor:m,timeReference:F,lrucache:I,useAsync:D,services:T,console:H,abortSignal:S};if(!c)return D;k(D.vars,b.variables,c,p,a);return D}function y(b,c){switch(c.getArcadeType(b)){case "date":return b.toJSDate();case "feature":var a="geometry"in b?b.geometry():null;b="readAttributes"in b?b.readAttributes():b.attributes;return new l({geometry:a,attributes:b});case "dictionary":a=
b.attributes;const p={};for(const D of Object.keys(a))p[D]=y(b.field(D),c);return p;case "array":return("toArray"in b?b.toArray():b).map(D=>y(D,c))}return b}let r=null;const Q={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"}]},O={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},A=new Map([["form-constraint",{variables:[{name:"$feature",
type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$editContext",type:"dictionary",
properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",Q],["popup-element",Q],["feature-reduction-popup",O],["feature-reduction-popup-element",O],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);e.createArcadeExecutor=async function(b,c,a={}){r||(r=await f.loadArcade());const {arcade:p,arcadeUtils:D}=r,{loadScriptDependencies:P,referencesMember:m,
scriptIsAsync:I}=p;var H=E(c.variables,[]),S=H.filter(K=>"featureSet"===K.type||"featureSetCollection"===K.type).map(K=>K.name.toLowerCase());const F=p.parseScript(b,S);if(!F)throw new x("arcade:invalid-script","Unable to create SyntaxTree");b=D.extractFieldNames(F);const T=p.scriptTouchesGeometry(F);H=H.map(K=>K.name.toLowerCase()).filter(K=>m(F,K));const M=I(F,S);await P(F,M,S);S={vars:{},spatialReference:null,useAsync:M};for(const K of H)S.vars[K]="any";const {lruCache:J}=a,u=p.compileScript(F,
S),C=p.featureSetUtils();return{execute:(K,R={})=>{if(M)throw new x("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");K=u(v(c,K,{lruCache:J,...R},C,M));return R.rawOutput?K:y(K,D)},executeAsync:async(K,R={})=>{K=await u(v(c,K,{lruCache:J,...R},C,M));return R.rawOutput?K:y(K,D)},isAsync:M,variablesUsed:H,fieldsUsed:b,geometryUsed:T,syntaxTree:F}};e.createArcadeProfile=function(b){var c=A.get(b);if(!c)throw c=Array.from(A.keys()).map(a=>`'${a}'`).join(", "),new x("createArcadeProfile:invalid-profile-name",
`Invalid profile name '${b}'. You must specify one of the following values: ${c}`);return L.clone(c)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../chunks/_rollupPluginBabelHelpers","./executionError","../chunks/datetime"],function(e,l,g,w){function x(f){if(f instanceof w.Zone)return f;if("system"===f.toLowerCase())return"system";if("utc"===f.toLowerCase())return"utc";if("unknown"===f.toLowerCase())return L.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(f)){const d=
w.FixedOffsetZone.parseSpecifier("UTC"+(f.startsWith("+")||f.startsWith("-")?"":"+")+f);if(d)return d}f=w.IANAZone.create(f);if(!f.isValid)throw new B(e.ArcadeDateErrorCodes.TimeZoneNotRecognised);return f}let L=l._createClass(function(){});L.instance=new w.IANAZone("Etc/UTC");e.ArcadeDateErrorCodes=void 0;(e.ArcadeDateErrorCodes||(e.ArcadeDateErrorCodes={})).TimeZoneNotRecognised="TimeZoneNotRecognised";const N={[e.ArcadeDateErrorCodes.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};
let B=function(f){function d(n,z){n=h.call(this,g.doSubstitutions(N[n],z));n.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(l._assertThisInitialized(n),d);return n}l._inherits(d,f);var h=l._createSuper(d);return l._createClass(d)}(l._wrapNativeSuper(Error)),t=function(){function f(h){this._date=h;this.declaredRootClass="esri.arcade.arcadedate"}f.fromParts=function(h=0,n=1,z=1,k=0,E=0,v=0,y=0,r){if(isNaN(h)||isNaN(n)||isNaN(z)||isNaN(k)||isNaN(E)||
isNaN(v)||isNaN(y))return null;let Q=0;var O=w.DateTime.local(h,n).daysInMonth;1>z&&(Q=z-1,z=1);z>O&&(Q=z-O,z=O);O=0;12<n?(O=n-12,n=12):1>n&&(O=n-1,n=1);let A=0;59<E?(A=E-59,E=59):0>E&&(A=E,E=0);let b=0;59<v?(b=v-59,v=59):0>v&&(b=v,v=0);let c=0;999<y?(c=y-999,y=999):0>y&&(c=y,y=0);h=w.DateTime.fromObject({day:z,year:h,month:n,hour:k,minute:E,second:v,millisecond:y},{zone:x(r)});0!==O&&(h=h.plus({months:O}));0!==Q&&(h=h.plus({days:Q}));0!==A&&(h=h.plus({minutes:A}));0!==b&&(h=h.plus({seconds:b}));
0!==c&&(h=h.plus({milliseconds:c}));return new f(h)};f.arcadeDateAndZoneToArcadeDate=function(h,n){const z=x(n);return h.isUnknownTimeZone||z===L.instance?f.fromParts(h.year,h.monthJS+1,h.day,h.hour,h.minute,h.second,h.millisecond,z):new f(h._date.setZone(n))};f.dateJSToArcadeDate=function(h){return new f(w.DateTime.fromJSDate(h,{zone:"system"}))};f.dateJSAndZoneToArcadeDate=function(h,n="system"){return new f(w.DateTime.fromJSDate(h,{zone:n}))};f.unknownEpochToArcadeDate=function(h){return new f(w.DateTime.fromMillis(h,
{zone:L.instance}))};f.unknownDateJSToArcadeDate=function(h){return new f(w.DateTime.fromMillis(h.getTime(),{zone:L.instance}))};f.epochToArcadeDate=function(h,n="system"){return new f(w.DateTime.fromMillis(h,{zone:n}))};f.dateTimeToArcadeDate=function(h){return new f(h)};var d=f.prototype;d.changeTimeZone=function(h){h=x(h);return f.dateTimeToArcadeDate(this._date.setZone(h))};f.dateTimeAndZoneToArcadeDate=function(h,n){n=x(n);return h.zone===L.instance||n===L.instance?f.fromParts(h.year,h.month,
h.day,h.hour,h.minute,h.second,h.millisecond,n):new f(h.setZone(n))};f.nowToArcadeDate=function(h){return new f(w.DateTime.fromJSDate(new Date,{zone:h}))};f.nowUTCToArcadeDate=function(){return new f(w.DateTime.utc())};d.equals=function(h){return this.isSystem&&h.isSystem?this.toNumber()===h.toNumber():this.isUnknownTimeZone!==h.isUnknownTimeZone?!1:this._date.equals(h._date)};d.stringify=function(){return JSON.stringify(this.toJSDate())};d.plus=function(h){return new f(this._date.plus(h))};d.diff=
function(h,n="milliseconds"){return this._date.diff(h._date,n)[n]};d.toISOString=function(h){return h?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})};d.toFormat=function(h,n){return this._date.toFormat(h,n)};d.toJSDate=function(){return this._date.toJSDate()};d.toSQLString=function(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"};d.toDateTime=function(){return this._date};d.toNumber=function(){return this._date.toMillis()};
d.getTime=function(){return this._date.toMillis()};d.toUTC=function(){return new f(this._date.toUTC())};d.toLocal=function(){return new f(this._date.toLocal())};d.toString=function(){return this.toISOString(!0)};l._createClass(f,[{key:"isSystem",get:function(){return"system"===this.timeZone||this.timeZone===f.systemTimeZoneCanonicalName}},{key:"isUnknownTimeZone",get:function(){return this._date.zone===L.instance}},{key:"isValid",get:function(){return this._date.isValid}},{key:"hour",get:function(){return this._date.hour}},
{key:"second",get:function(){return this._date.second}},{key:"day",get:function(){return this._date.day}},{key:"dayOfWeekISO",get:function(){return this._date.weekday}},{key:"dayOfWeekJS",get:function(){let h=this._date.weekday;6<h&&(h=0);return h}},{key:"millisecond",get:function(){return this._date.millisecond}},{key:"monthISO",get:function(){return this._date.month}},{key:"weekISO",get:function(){return this._date.weekNumber}},{key:"yearISO",get:function(){return this._date.weekYear}},{key:"monthJS",
get:function(){return this._date.month-1}},{key:"year",get:function(){return this._date.year}},{key:"minute",get:function(){return this._date.minute}},{key:"zone",get:function(){return this._date.zone}},{key:"timeZoneOffset",get:function(){return this.isUnknownTimeZone?0:this._date.offset}},{key:"timeZone",get:function(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const h=this.zone;return"fixed"===h.type?0===h.fixed?"utc":h.formatOffset(0,"short"):h.name}}],
[{key:"systemTimeZoneCanonicalName",get:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}}]);return f}();e.ArcadeDate=t;e.ArcadeDateError=B;e.ArcadeDateErrorMessages=N;e.UnknownTimeZone=L;e.createDateTimeZone=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/executionError":function(){define(["exports","../chunks/_rollupPluginBabelHelpers"],function(e,l){function g(n){return n&&n.loc?`Line : ${n.loc.start?.line}, ${n.loc.start?.column}: `:""}
function w(n,z){try{if(!z)return n;for(const k in z){let E=z[k];E||(E="");n=n.replace("{"+k+"}",z[k])}}catch(k){}return n}e.ExecutionErrorCodes=void 0;(function(n){n.AsyncNotEnabled="AsyncNotEnabled";n.ModulesNotSupported="ModulesNotSupported";n.CircularModules="CircularModules";n.NeverReach="NeverReach";n.UnsupportedHashType="UnsupportedHashType";n.InvalidParameter="InvalidParameter";n.UnexpectedToken="UnexpectedToken";n.Unrecognised="Unrecognised";n.UnrecognisedType="UnrecognisedType";n.MaximumCallDepth=
"MaximumCallDepth";n.BooleanConditionRequired="BooleanConditionRequired";n.TypeNotAllowedInFeature="TypeNotAllowedInFeature";n.KeyMustBeString="KeyMustBeString";n.WrongNumberOfParameters="WrongNumberOfParameters";n.CallNonFunction="CallNonFunction";n.NoFunctionInTemplateLiteral="NoFunctionInTemplateLiteral";n.NoFunctionInDictionary="NoFunctionInDictionary";n.NoFunctionInArray="NoFunctionInArray";n.AssignModuleFunction="AssignModuleFunction";n.LogicExpressionOrAnd="LogicExpressionOrAnd";n.LogicalExpressionOnlyBoolean=
"LogicalExpressionOnlyBoolean";n.FuncionNotFound="FunctionNotFound";n.InvalidMemberAccessKey="InvalidMemberAccessKey";n.UnsupportedUnaryOperator="UnsupportUnaryOperator";n.InvalidIdentifier="InvalidIdentifier";n.MemberOfNull="MemberOfNull";n.UnsupportedOperator="UnsupportedOperator";n.Cancelled="Cancelled";n.ModuleAccessorMustBeString="ModuleAccessorMustBeString";n.ModuleExportNotFound="ModuleExportNotFound";n.Immutable="Immutable";n.OutOfBounds="OutOfBounds";n.IllegalResult="IllegalResult";n.FieldNotFound=
"FieldNotFound";n.PortalRequired="PortalRequired";n.LogicError="LogicError";n.ArrayAccessorMustBeNumber="ArrayAccessMustBeNumber";n.KeyAccessorMustBeString="KeyAccessorMustBeString";n.WrongSpatialReference="WrongSpatialReference"})(e.ExecutionErrorCodes||(e.ExecutionErrorCodes={}));const x={[e.ExecutionErrorCodes.TypeNotAllowedInFeature]:"Feature attributes only support dates, numbers, strings, guids.",[e.ExecutionErrorCodes.LogicError]:"Logic error - {reason}",[e.ExecutionErrorCodes.NeverReach]:"Encountered unreachable logic",
[e.ExecutionErrorCodes.AsyncNotEnabled]:"Async Arcade must be enabled for this script",[e.ExecutionErrorCodes.ModuleAccessorMustBeString]:"Module accessor must be a string",[e.ExecutionErrorCodes.ModuleExportNotFound]:"Module has no export with provided identifier",[e.ExecutionErrorCodes.ModulesNotSupported]:"Current profile does not support modules",[e.ExecutionErrorCodes.ArrayAccessorMustBeNumber]:"Array accessor must be a number",[e.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[e.ExecutionErrorCodes.FieldNotFound]:"Key not found - {key}",
[e.ExecutionErrorCodes.CircularModules]:"Circular module dependencies are not allowed",[e.ExecutionErrorCodes.Cancelled]:"Execution cancelled",[e.ExecutionErrorCodes.UnsupportedHashType]:"Type not supported in hash function",[e.ExecutionErrorCodes.IllegalResult]:"Value is not a supported return type",[e.ExecutionErrorCodes.PortalRequired]:"Portal is required",[e.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[e.ExecutionErrorCodes.WrongNumberOfParameters]:"Call with wrong number of parameters",
[e.ExecutionErrorCodes.Unrecognised]:"Unrecognised code structure",[e.ExecutionErrorCodes.UnrecognisedType]:"Unrecognised type",[e.ExecutionErrorCodes.WrongSpatialReference]:"Cannot work with geometry in this spatial reference. It is different to the execution spatial reference",[e.ExecutionErrorCodes.BooleanConditionRequired]:"Conditions must use booleans",[e.ExecutionErrorCodes.NoFunctionInDictionary]:"Dictionaries cannot contain functions.",[e.ExecutionErrorCodes.NoFunctionInArray]:"Arrays cannot contain functions.",
[e.ExecutionErrorCodes.NoFunctionInTemplateLiteral]:"Template Literals do not expect functions by value.",[e.ExecutionErrorCodes.KeyAccessorMustBeString]:"Accessor must be a string",[e.ExecutionErrorCodes.KeyMustBeString]:"Object keys must be a string",[e.ExecutionErrorCodes.Immutable]:"Object is immutable",[e.ExecutionErrorCodes.InvalidParameter]:"Invalid parameter",[e.ExecutionErrorCodes.UnexpectedToken]:"Unexpected token",[e.ExecutionErrorCodes.MemberOfNull]:"Cannot access property of null object",
[e.ExecutionErrorCodes.MaximumCallDepth]:"Exceeded maximum function depth",[e.ExecutionErrorCodes.OutOfBounds]:"Out of bounds",[e.ExecutionErrorCodes.InvalidIdentifier]:"Identifier not recognised",[e.ExecutionErrorCodes.FuncionNotFound]:"Function not found",[e.ExecutionErrorCodes.CallNonFunction]:"Expression is not a function",[e.ExecutionErrorCodes.InvalidMemberAccessKey]:"Cannot access value using a key of this type",[e.ExecutionErrorCodes.AssignModuleFunction]:"Cannot assign function to module variable",
[e.ExecutionErrorCodes.UnsupportedUnaryOperator]:"Unsupported unary operator",[e.ExecutionErrorCodes.UnsupportedOperator]:"Unsupported operator",[e.ExecutionErrorCodes.LogicalExpressionOnlyBoolean]:"Logical expressions must be boolean",[e.ExecutionErrorCodes.LogicExpressionOrAnd]:"Logical expression can only be combined with || or \x26\x26"};let L=function(n){function z(...E){return k.call(this,...E)}l._inherits(z,n);var k=l._createSuper(z);return l._createClass(z)}(l._wrapNativeSuper(Error)),N=function(n){function z(E,
v){E=k.call(this,g(v)+E.message,{cause:E});E.loc=null;Error.captureStackTrace&&Error.captureStackTrace(l._assertThisInitialized(E),z);v&&v.loc&&(E.loc=v.loc);return E}l._inherits(z,n);var k=l._createSuper(z);return l._createClass(z)}(L),B=function(n){function z(E,v,y,r){E=k.call(this,"Execution error - "+g(y)+w(x[v],r));E.loc=null;E.declaredRootClass="esri.arcade.arcadeexecutionerror";Error.captureStackTrace&&Error.captureStackTrace(l._assertThisInitialized(E),z);y&&y.loc&&(E.loc=y.loc);return E}
l._inherits(z,n);var k=l._createSuper(z);return l._createClass(z)}(l._wrapNativeSuper(Error)),t=function(n){function z(E,v,y,r){E=k.call(this,"Compilation error - "+g(y)+w(x[v],r));E.loc=null;E.declaredRootClass="esri.arcade.arcadecompilationerror";Error.captureStackTrace&&Error.captureStackTrace(l._assertThisInitialized(E),z);y&&y.loc&&(E.loc=y.loc);return E}l._inherits(z,n);var k=l._createSuper(z);return l._createClass(z)}(l._wrapNativeSuper(Error)),f=function(n){function z(){var E=k.call(this,
"Uncompilable code structures");E.declaredRootClass="esri.arcade.arcadeuncompilableerror";Error.captureStackTrace&&Error.captureStackTrace(l._assertThisInitialized(E),z);return E}l._inherits(z,n);var k=l._createSuper(z);return l._createClass(z)}(l._wrapNativeSuper(Error));e.ModuleErrorCodes=void 0;(function(n){n.UnrecognisedUri="UnrecognisedUri";n.UnsupportedUriProtocol="UnsupportedUriProtocol"})(e.ModuleErrorCodes||(e.ModuleErrorCodes={}));const d={[e.ModuleErrorCodes.UnrecognisedUri]:"Unrecognised uri - {uri}",
[e.ModuleErrorCodes.UnsupportedUriProtocol]:"Unrecognised uri protocol"};let h=function(n){function z(E,v){E=k.call(this,w(d[E],v));E.declaredRootClass="esri.arcade.arcademoduleerror";Error.captureStackTrace&&Error.captureStackTrace(l._assertThisInitialized(E),z);return E}l._inherits(z,n);var k=l._createSuper(z);return l._createClass(z)}(l._wrapNativeSuper(Error));e.ArcadeCompilationError=t;e.ArcadeExecutionError=B;e.ArcadeUncompilableError=f;e.ErrorWithCause=L;e.ExecutionErrorMessages=x;e.LocatableArcadeExecutionError=
N;e.ModuleError=h;e.ModuleErrorMessages=d;e.doSubstitutions=w;e.ensureArcadeExecutionError=function(n,z,k){return"esri.arcade.arcadeexecutionerror"===k.declaredRootClass||"esri.arcade.arcadecompilationerror"===k.declaredRootClass?null===k.loc&&z&&z.loc?new N(k,{cause:k}):k:z&&z.loc?new N(k,{cause:k}):k};e.parsingValidationMessage=function(n,z,k){return"Parsing error - "+g(n)+w(x[z],k)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ImmutableArray":function(){define(["../chunks/_rollupPluginBabelHelpers"],
function(e){return function(){function l(w=[]){this._elements=w}var g=l.prototype;g.length=function(){return this._elements.length};g.get=function(w){return this._elements[w]};g.toArray=function(){const w=[];for(let x=0;x<this.length();x++)w.push(this.get(x));return w};return e._createClass(l)}()})},"esri/widgets/FeatureForm/FormExpressionsManager":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/MapUtils ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h){e.FormExpressionsManager=function(k){function E(y){var r=v.call(this,y);r._fieldReferencesLookup=new Map;r._fieldsAffectedLookup=new Map;r._latestFieldValues={...y.feature.attributes};return r}l._inherits(E,k);var v=l._createSuper(E);k=E.prototype;k.initialize=function(){this._dependencyGraph=this._buildDependencyGraph()};k.evaluateAll=function(){return this._evaluate(this.executors)};k.evaluateExpressions=function(y){return this._evaluate(y)};k.evaluateInvalidated=
function(y){const {_fieldReferencesLookup:r,_latestFieldValues:Q,feature:O}=this,A=new Set;for(const b of y)if(Q[b]=O.getAttribute(b),r.has(b))for(const c of r.get(b))A.add(c);return this._evaluate([...A])};k.evaluateInvalidatedByGeometry=async function(){if(this._fieldReferencesLookup.has("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY"))return this._evaluate([...this._fieldReferencesLookup.get("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY")])};k.resetExecutors=function(){for(const y of this.executors)y.reset()};
k._buildDependencyGraph=function(){const {_fieldReferencesLookup:y,_fieldsAffectedLookup:r,executors:Q}=this,O=new Map(this.inputFields.map(b=>[b.name,b])),A=new Map(Q.map(b=>[b,[]]));for(const b of Q){for(const c of b.fieldsUsed){x.getOrCreateMapValue(y,c,()=>new Set).add(b);const a=O.get(c),{valueExpressionExecutor:p,editableExpressionExecutor:D}=a;L.isSome(p)&&p!==b&&(A.get(p).push(b),x.getOrCreateMapValue(r,p,()=>new Set).add(a));L.isSome(D)&&D!==b&&(A.get(D).push(b),x.getOrCreateMapValue(r,D,
()=>new Set).add(a))}b.geometryUsed&&x.getOrCreateMapValue(y,"#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY",()=>new Set).add(b)}return A};k._evaluate=async function(y){const r=new Map,{_dependencyGraph:Q,_fieldsAffectedLookup:O,_latestFieldValues:A}=this;for(const b of y)n(b,r,Q);for(const [b,{resolver:c,dependencyPromises:a}]of r)Promise.all(a).then(async()=>{const [p,D]=this._makeContext(A);return b.executeAsync(p,D)}).then(()=>{if(O.has(b))for(const p of O.get(b))this._latestFieldValues[p.name]=p.value;
c.resolve()},p=>{!p||N.isAbortError(p)||z(p)||b.markStale();c.reject(p)});y=(await Promise.allSettled(Array.from(r.values(),({resolver:b})=>b.promise))).filter(b=>"rejected"===b.status&&!(N.isAbortError(b.reason)||z(b.reason)));if(0<y.length)throw new AggregateError(y,"One or more expression executions failed");};k._makeContext=function(y){const [r,Q]=this._baseContext,O=this.feature.clone();O.attributes=y;return[{...r,$feature:O},Q]};l._createClass(E,[{key:"_baseContext",get:function(){const {editType:y,
layer:r,map:Q,originalFeature:O,spatialReference:A}=this.arcadeContextInfo,b="feature"===r?.type?r:"scene"===r?.type&&L.isSome(r.associatedLayer)?r.associatedLayer:void 0;return[{$originalfeature:O,$editcontext:{editType:y},$layer:b,$featureset:b,$datastore:r?.url,$map:Q},{spatialReference:A??void 0}]}},{key:"feature",set:function(y){this._latestFieldValues={...y?.attributes};this._set("feature",y)}}]);return E}(w);g.__decorate([B.property()],e.FormExpressionsManager.prototype,"_baseContext",null);
g.__decorate([B.property()],e.FormExpressionsManager.prototype,"feature",null);g.__decorate([B.property()],e.FormExpressionsManager.prototype,"executors",void 0);g.__decorate([B.property()],e.FormExpressionsManager.prototype,"inputFields",void 0);g.__decorate([B.property()],e.FormExpressionsManager.prototype,"arcadeContextInfo",void 0);e.FormExpressionsManager=g.__decorate([h.subclass("esri.widgets.FeatureForm.FormExpressionsManager")],e.FormExpressionsManager);const n=(k,E,v)=>{if(!E.has(k)){var y=
N.createResolver();E.set(k,{resolver:y,dependencyPromises:[]});k.abort();k=v.get(k);for(const r of k)n(r,E,v),E.get(r).dependencyPromises.push(y.promise)}},z=k=>k&&"object"===typeof k&&"message"in k&&"Cancelled"===k.message;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/InputField":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/CodedValue ../../layers/support/CodedValueDomain ../../layers/support/Domain ../../layers/support/InheritedDomain ../../layers/support/RangeDomain ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../layers/support/layerUtils ./featureFormUtils ../../intl/substitute".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q,O,A){function b(H){return 1E7<=H||-1E7>=H}var c;(function(H){H.Text="text";H.Number="number";H.Date="date";H.Unsupported="unsupported"})(c||(c={}));var a;(a||(a={})).TOO_SHORT="length-validation-error::too-short";const p={type:"number"},D={type:"number",intlOptions:{notation:"scientific"}},P={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};g=function(H){function S(T){T=F.call(this,
T);T._storedValue=null;T.arcadeEditType="NA";T.editableExpressionExecutor=null;T.id=N.generateUID().toString();T.requiredExpressionExecutor=null;T.valueExpressionExecutor=null;T.visibilityExpressionExecutor=null;T.feature=null;T.field=null;T.fieldElement=null;T.layer=null;T.error=null;T.group=null;T.messages=null;return T}e._inherits(S,H);var F=e._createSuper(S);H=S.prototype;H._isDomainCompatible=function(T){const {field:M}=this;if("coded-value"===T?.type){const J=typeof T.codedValues[0].code;if("string"===
J&&r.isStringField(M)||"number"===J&&r.isNumericField(M))return!0}return"range"===T?.type&&r.isNumericField(M)||r.isDateField(M)?!0:!1};H._validate=function(){const {domain:T,field:M,initialFeature:J,minLength:u,required:C,type:K,valid:R,value:V}=this,X=C&&null===V,ba=void 0!==R;return!X&&J.getAttribute(M.name)===V&&ba?null:X?r.TypeValidationError.INVALID_TYPE:"text"===K&&-1<u&&"string"===typeof V&&V.length<u?a.TOO_SHORT:T?null!==V||C?y.validateDomainValue(T,V):null:r.validateFieldValue(M,V)};H._isVisibleByDefault=
function(){const T=this.field?.type;return this.field?.visible&&"oid"!==T&&"global-id"!==T&&!this._isGeometryField()};H._isEditorField=function(){return r.getFeatureEditFields(this.layer).includes(this.name)};H._isGeometryField=function(){return r.getFeatureGeometryFields(this.layer).includes(this.name)};H._shouldUseValueExpression=function(){return this._layerFieldAllowsEdits&&!this._configAllowsEdits&&L.isSome(this.valueExpressionExecutor)};H._toErrorMessage=function(){const {domain:T,field:M,messages:J,
minLength:u,value:C,required:K,type:R}=this;var V=this.error;return J?K&&null===C?J.validationErrors.cannotBeNull:V===y.DomainValidationError.VALUE_OUT_OF_RANGE||V===r.NumericRangeValidationError.OUT_OF_RANGE?(V=y.getDomainRange(T)||r.getFieldRange(M),A.substitute(J.validationErrors.outsideRange,V,{format:{max:"date"===R?P:b(V.max)?D:p,min:"date"===R?P:b(V.min)?D:p}})):V===y.DomainValidationError.INVALID_CODED_VALUE?J.validationErrors.invalidCodedValue:V===r.TypeValidationError.INVALID_TYPE?J.validationErrors.invalidType:
V===a.TOO_SHORT?A.substitute(J.validationErrors.tooShort,{min:u}):null:null};e._createClass(S,[{key:"_configAllowsEdits",get:function(){const {fieldElement:T,layer:M,name:J}=this;return L.isSome(T)?T.editableExpression?!!this.evaluatedEditableExpression:!1!==T.editable:M?.userHasUpdateItemPrivileges?!0:(M&&"popupTemplate"in M?M?.popupTemplate?.fieldInfos?.find(({fieldName:u})=>u===J):null)?.isEditable??!0}},{key:"_layerFieldAllowsEdits",get:function(){const {field:T,layer:M}=this;if(!M||!T)return!1;
var J=Q.getEffectiveLayerCapabilities(M);const u=J?.operations.supportsEditing,C=T.editable;J=m(J,this.arcadeEditType);return!!(u&&C&&J)}},{key:"isUsingValueExpression",get:function(){return this._shouldUseValueExpression()}},{key:"evaluatedEditableExpression",get:function(){const {editableExpressionExecutor:T}=this;return L.isSome(T)?!!T.lastEvaluatedValue:null}},{key:"evaluatedRequiredExpression",get:function(){const {requiredExpressionExecutor:T}=this;return L.isSome(T)?!!T.lastEvaluatedValue:
null}},{key:"evaluatedVisibilityExpression",get:function(){const {visibilityExpressionExecutor:T}=this;return L.isSome(T)?!!T.lastEvaluatedValue:null}},{key:"evaluatedValueExpression",get:function(){const {valueExpressionExecutor:T}=this;return L.isSome(T)?T.lastEvaluatedValue:null}},{key:"initialFeature",set:function(T){this._set("initialFeature",T);this.notifyChange("valid")}},{key:"description",get:function(){return L.unwrap(this.fieldElement)?.description}},{key:"domain",get:function(){var {layer:T}=
this;const {typeFieldName:M,types:J}=O.getNormalizedFeatureTypeInfo(T);if(M===this.name&&L.isNone(this.field.domain))return new z({name:"__internal-type-based-coded-value-domain__",codedValues:J.map(({code:C,name:K})=>new n.CodedValue({code:C,name:K}))});var {feature:u}=this;T=T?.getFieldDomain(this.name,{feature:u});u=L.get(this.fieldElement,"domain");return L.isSome(u)&&this._isDomainCompatible(u)?u:T}},{key:"editable",get:function(){return this._layerFieldAllowsEdits?this.evaluatedEditableExpression??
this._configAllowsEdits:!1}},{key:"inputType",get:function(){return L.unwrap(this.fieldElement)?.input?.type}},{key:"errorMessage",get:function(){return this._toErrorMessage()}},{key:"hint",get:function(){return L.unwrap(this.fieldElement)?.hint}},{key:"includeTime",get:function(){var {fieldElement:T}=this;T=L.isSome(T)&&"datetime-picker"===T.input?.type?T.input.includeTime:void 0;return void 0===T||T}},{key:"label",get:function(){return L.isSome(this.fieldElement)&&this.fieldElement.label||this.field.alias||
this.field.name}},{key:"maxLength",get:function(){if(this.type===c.Date)return-1;const {field:T,fieldElement:M}=this,J=T?.length,u=I(M)?M.input.maxLength:NaN;return null!=u&&!isNaN(u)&&-1<=u&&(-1===J||u<=J)?u:J}},{key:"minLength",get:function(){if(this.type===c.Date)return-1;const {field:T,fieldElement:M}=this,J=T?.length,u=I(M)?M.input.minLength:NaN;return null!=u&&!isNaN(u)&&-1<=u&&(-1===J||u<=J)?u:-1}},{key:"name",get:function(){return this.field?.name}},{key:"required",get:function(){const {editable:T,
evaluatedRequiredExpression:M,field:J,visible:u}=this;return T?!1===J?.nullable?!0:u&&L.isSome(M)?M:!1:!1},set:function(T){this._overrideIfSome("required",T)}},{key:"submittable",get:function(){const {field:T,required:M,valid:J,value:u}=this;return M&&L.isNone(u)?!1:J?!0:this.initialFeature.getAttribute(T.name)===u}},{key:"type",get:function(){const {field:T}=this;return r.isNumericField(T)?c.Number:r.isStringField(T)?c.Text:r.isDateField(T)?c.Date:c.Unsupported}},{key:"updating",get:function(){const {editableExpressionExecutor:T,
valueExpressionExecutor:M}=this;return L.isSome(M)&&M.updating||L.isSome(T)&&T.updating}},{key:"valid",get:function(){const T=this.editable?this._validate():null;this._set("error",T);return null===T}},{key:"value",get:function(){if(this._shouldUseValueExpression()){const T=this.evaluatedValueExpression;if(this.type===c.Date){if(T instanceof Date)return T.getTime();if("number"!==typeof T)return parseInt(T,10)}return L.isSome(T)&&"object"===typeof T?T.toString():T}return this.get("_storedValue")},set:function(T){this.notifyChange("evaluatedVisibilityExpression");
this.set("_storedValue",T)}},{key:"visible",get:function(){return this._isEditorField()?!1:L.isSome(this.evaluatedVisibilityExpression)?this.evaluatedVisibilityExpression:L.isSome(this.fieldElement)?!0:this._isVisibleByDefault()}}]);return S}(x.HandleOwnerMixin(w));l.__decorate([B.property()],g.prototype,"_storedValue",void 0);l.__decorate([B.property()],g.prototype,"_configAllowsEdits",null);l.__decorate([B.property()],g.prototype,"_layerFieldAllowsEdits",null);l.__decorate([B.property()],g.prototype,
"arcadeEditType",void 0);l.__decorate([B.property()],g.prototype,"editableExpressionExecutor",void 0);l.__decorate([B.property()],g.prototype,"requiredExpressionExecutor",void 0);l.__decorate([B.property()],g.prototype,"valueExpressionExecutor",void 0);l.__decorate([B.property()],g.prototype,"isUsingValueExpression",null);l.__decorate([B.property()],g.prototype,"visibilityExpressionExecutor",void 0);l.__decorate([B.property()],g.prototype,"evaluatedEditableExpression",null);l.__decorate([B.property()],
g.prototype,"evaluatedRequiredExpression",null);l.__decorate([B.property()],g.prototype,"evaluatedVisibilityExpression",null);l.__decorate([B.property()],g.prototype,"evaluatedValueExpression",null);l.__decorate([B.property()],g.prototype,"feature",void 0);l.__decorate([B.property()],g.prototype,"field",void 0);l.__decorate([B.property({constructOnly:!0})],g.prototype,"fieldElement",void 0);l.__decorate([B.property()],g.prototype,"initialFeature",null);l.__decorate([B.property()],g.prototype,"layer",
void 0);l.__decorate([B.property({readOnly:!0})],g.prototype,"description",null);l.__decorate([B.property()],g.prototype,"domain",null);l.__decorate([B.property()],g.prototype,"editable",null);l.__decorate([B.property({readOnly:!0})],g.prototype,"inputType",null);l.__decorate([B.property({readOnly:!0})],g.prototype,"error",void 0);l.__decorate([B.property({dependsOn:["error","messages","value"]})],g.prototype,"errorMessage",null);l.__decorate([B.property()],g.prototype,"group",void 0);l.__decorate([B.property({readOnly:!0})],
g.prototype,"hint",null);l.__decorate([B.property()],g.prototype,"includeTime",null);l.__decorate([B.property()],g.prototype,"label",null);l.__decorate([B.property()],g.prototype,"maxLength",null);l.__decorate([B.property()],g.prototype,"minLength",null);l.__decorate([B.property()],g.prototype,"messages",void 0);l.__decorate([B.property({readOnly:!0})],g.prototype,"name",null);l.__decorate([B.property()],g.prototype,"required",null);l.__decorate([B.property()],g.prototype,"submittable",null);l.__decorate([B.property()],
g.prototype,"type",null);l.__decorate([B.property()],g.prototype,"updating",null);l.__decorate([B.property()],g.prototype,"valid",null);l.__decorate([B.property({value:null})],g.prototype,"value",null);l.__decorate([B.property()],g.prototype,"visible",null);g=l.__decorate([h.subclass("esri.widgets.FeatureForm.InputField")],g);const m=(H,S)=>{if(!H)return!0;({operations:H}=H);switch(S){case "INSERT":return H.supportsAdd;case "UPDATE":case "DELETE":return H.supportsUpdate;default:return!0}},I=H=>L.isSome(H)&&
(O.isFieldElementWithInputType(H,"text-box")||O.isFieldElementWithInputType(H,"text-area"));return g})},"esri/widgets/FeatureForm/InputFieldGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(e,
l,g,w,x,L,N,B,t,f,d){g=function(h){function n(k){k=z.call(this,k);k._expressionTrackingHandles=new Map;k.visibilityExpressionExecutor=null;k.feature=null;k.groupElement=null;return k}e._inherits(n,h);var z=e._createSuper(n);h=n.prototype;h.initialize=function(){this.addHandles([L.watch(()=>[this.visible,this.inputFields],([k])=>{const {inputFields:E}=this;k=k?void 0:!1;for(const v of E)v.required=k},{initial:!0,equals:(k,E)=>E[0]===k[0]&&E[1]===k[1]})])};h.destroy=function(){for(const k of this._expressionTrackingHandles.values())k.remove()};
h._dirtyEvaluatedVisibilityExpression=function(){const {groupElement:k}=this;x.isSome(k)&&k.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")};e._createClass(n,[{key:"visibilityExpression",get:function(){return x.unwrap(this.groupElement)?.visibilityExpression},set:function(k){x.applySome(this.groupElement,E=>{E.visibilityExpression=k})}},{key:"evaluatedVisibilityExpression",get:function(){const {visibilityExpressionExecutor:k}=this;return x.isSome(k)?!!k.lastEvaluatedValue:
null}},{key:"description",get:function(){return x.unwrap(this.groupElement)?.description},set:function(k){x.applySome(this.groupElement,E=>{E.description=k})}},{key:"inputFields",get:function(){return this._get("inputFields")},set:function(k){this.handles.removeAll();k&&this.handles.add(k.map(E=>L.watch(()=>E.visible,()=>this._dirtyEvaluatedVisibilityExpression())));this._set("inputFields",k)}},{key:"label",get:function(){return x.unwrap(this.groupElement)?.label},set:function(k){x.applySome(this.groupElement,
E=>{E.label=k})}},{key:"state",get:function(){return x.isSome(this.groupElement)&&this.groupElement.initialState||"expanded"},set:function(k){this._overrideIfSome("state",k)}},{key:"visible",get:function(){return!1!==this.evaluatedVisibilityExpression&&this.inputFields&&this.inputFields.some(k=>k.visible)}}]);return n}(w.HandleOwnerMixin(g));l.__decorate([N.property()],g.prototype,"visibilityExpression",null);l.__decorate([N.property()],g.prototype,"visibilityExpressionExecutor",void 0);l.__decorate([N.property()],
g.prototype,"evaluatedVisibilityExpression",null);l.__decorate([N.property()],g.prototype,"description",null);l.__decorate([N.property()],g.prototype,"feature",void 0);l.__decorate([N.property()],g.prototype,"groupElement",void 0);l.__decorate([N.property()],g.prototype,"initialFeature",void 0);l.__decorate([N.property()],g.prototype,"inputFields",null);l.__decorate([N.property()],g.prototype,"label",null);l.__decorate([N.property()],g.prototype,"state",null);l.__decorate([N.property()],g.prototype,
"visible",null);return g=l.__decorate([d.subclass("esri.widgets.FeatureForm.InputFieldGroup")],g)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./widgetUtils","./jsxFactory"],function(e,l,g,w){const x={heading:"esri-widget__heading"};e.CSS=x;e.Heading=function({level:L,class:N,...B},t){L=l.clamp(Math.ceil(L),1,6);return w.tsx(`h${L}`,{...B,class:g.classes(x.heading,N),role:"heading","aria-level":String(L)},t)};e.incrementHeadingLevel=function(L,N=1){return l.clamp(Math.ceil(L+
N),1,6)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/HandleOwner ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./support/componentsUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q){function O(b){return b.id}const A={filter:!0};w=function(b){function c(p,D){p=a.call(this,p,D);p._iconIntersectionObserver=new IntersectionObserver((P,m)=>{P.forEach(async I=>{if(I.isIntersecting){const F=I.target;if(F["data-has-icon"])m.unobserve(F);else{var {layer:H,template:S}=F["data-item"];F["data-has-icon"]=!0;I=await k.fetchThumbnail(H,S).catch(()=>{F["data-has-icon"]=!1;return null});x.isNone(I)||F.appendChild(I)}}})});p.enableListScroll=!0;
p.filterText="";p.headingLevel=4;p.messages=null;p.viewModel=new n;p.visibleElements={...A};p.renderItemIcon=p.renderItemIcon.bind(l._assertThisInitialized(p));p._afterItemCreateOrUpdate=p._afterItemCreateOrUpdate.bind(l._assertThisInitialized(p));p._afterItemRemoved=p._afterItemRemoved.bind(l._assertThisInitialized(p));return p}l._inherits(c,b);var a=l._createSuper(c);b=c.prototype;b.initialize=function(){const p=({label:D})=>!this.filterText||!!D?.toLowerCase().includes(this.filterText.toLowerCase());
this.addHandles(L.watch(()=>this.viewModel,(D,P)=>{D&&!D.filterFunction&&(this.filterFunction=p);P&&P!==D&&P.filterFunction===p&&(P.filterFunction=null)},L.initial))};b.destroy=function(){this._iconIntersectionObserver?.disconnect();this._iconIntersectionObserver=null};b.loadDependencies=function(){return E.loadCalciteComponents({input:()=>new Promise((p,D)=>e(["../chunks/calcite-input"],p,D)),"list-item":()=>new Promise((p,D)=>e(["../chunks/calcite-list-item"],p,D))})};b.castVisibleElements=function(p){return{...A,
...p}};b.select=function(p,D){return this.viewModel.select(p,D)};b.render=function(){const {enableListScroll:p,filterText:D,headingLevel:P,messages:m,viewModel:{items:I,numberOfFeatureTemplates:H,selectedItem:S,state:F}}=this,T=this.visibleElements.filter&&1<H;if(0<I.length&&"items"in I[0]){const M=I.find(J=>J.label===n.nullGroupBy.label);M&&(M.label=m.other)}return Q.tsx("div",{class:this.classes("esri-feature-templates","esri-widget"),"aria-label":m.widgetLabel},"loading"===F?this.renderLoader():
"ready"===F?Q.tsx(z.ItemList,{id:this.id,identify:O,filterText:D,items:I,headingLevel:P,selectionMode:"single",messages:{filterPlaceholder:m.filterPlaceholder,noItems:m.noItems,noMatches:m.noMatches},filterEnabled:T,onItemSelect:M=>this.viewModel.select(M),onFilterChange:M=>{this.filterText=M;this.viewModel.refresh()},renderIcon:this.renderItemIcon,selectedItem:S??void 0,enableListScroll:p}):null)};b.renderItemIcon=function({item:p}){return Q.tsx("span",{key:"icon",afterCreate:this._afterItemCreateOrUpdate,
afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":p,"data-has-icon":!1})};b.renderLoader=function(){return Q.tsx("div",{class:"esri-feature-templates__loader",key:"loader"})};b._afterItemCreateOrUpdate=function(p){this._iconIntersectionObserver?.observe(p)};b._afterItemRemoved=function(p){this._iconIntersectionObserver?.unobserve(p)};l._createClass(c,[{key:"filterFunction",get:function(){return this.viewModel.filterFunction},set:function(p){this.viewModel.filterFunction=
p}},{key:"groupBy",get:function(){return this.viewModel.groupBy},set:function(p){this.viewModel.groupBy=p}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(p){this._overrideIfSome("label",p)}},{key:"layers",get:function(){return this.viewModel.layers},set:function(p){this.viewModel.layers=p}},{key:"selectedItem",get:function(){return this.viewModel.selectedItem}}]);return c}(w.HandleOwnerMixin(h));g.__decorate([N.property()],w.prototype,"enableListScroll",void 0);g.__decorate([N.property()],
w.prototype,"filterFunction",null);g.__decorate([N.property()],w.prototype,"filterText",void 0);g.__decorate([N.property()],w.prototype,"groupBy",null);g.__decorate([N.property()],w.prototype,"headingLevel",void 0);g.__decorate([N.property()],w.prototype,"label",null);g.__decorate([N.property()],w.prototype,"layers",null);g.__decorate([N.property(),y.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],w.prototype,"messages",void 0);g.__decorate([N.property({readOnly:!0})],w.prototype,
"selectedItem",null);g.__decorate([N.property(),r.vmEvent("select")],w.prototype,"viewModel",void 0);g.__decorate([N.property()],w.prototype,"visibleElements",void 0);g.__decorate([B.cast("visibleElements")],w.prototype,"castVisibleElements",null);return w=g.__decorate([d.subclass("esri.widgets.FeatureTemplates")],w)})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/HandleOwner ../../core/maybe ../../core/ObjectPool ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ./TemplateItem ./TemplateItemGroup".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k){var E;const v=({layer:Q})=>({key:Q,label:Q.title??""}),y=({layer:Q})=>({key:Q.geometryType,label:Q.geometryType??""});g=E=function(Q){function O(b){b=A.call(this,b);b._itemPool=new L(z);b._groupPool=new L(k);b.filterFunction=null;b.selectedItem=null;return b}e._inherits(O,Q);var A=e._createSuper(O);Q=O.prototype;Q.initialize=function(){this._get("groupBy")||(this.groupBy="layer")};Q.refresh=function(){this.notifyChange("items")};Q.select=function(b,c=!0){const a=
this.selectedItem;b=b?.clone()||null;this._set("selectedItem",b);c&&this.emit("select",{item:b,oldItem:a,template:b?.template??null})};Q._createItem=function(b,c){const a=this._itemPool.acquire();a.set({template:b,layer:c});return a};Q._createGroup=function(b,c){const a=this._groupPool.acquire();a.set("label",b);a.items=c;return a};Q._releasePreviousItems=function(){this._destroyItems(this._get("items"))};Q._destroyItems=function(b){b&&(b[0]instanceof z?b.forEach(c=>this._destroyItem(c)):b.forEach(c=>
this._destroyGroup(c)))};Q._destroyGroup=function(b){b.items.forEach(c=>this._destroyItem(c));b.items.length=0;this._groupPool.release(b)};Q._destroyItem=function(b){b.layer=null;b.template=null;this._itemPool.release(b)};Q._ensureGroupByObject=function(b){return"string"===typeof b?{key:b,label:b}:b};e._createClass(O,[{key:"groupBy",set:function(b){this._set("groupBy",b);if("function"===typeof b)this._groupByFunction=c=>this._ensureGroupByObject(b(c));else switch(b){case "layer":this._groupByFunction=
v;break;case "geometry":this._groupByFunction=y;break;default:this._groupByFunction=null}}},{key:"layers",get:function(){return this._get("layers")},set:function(b){this.handles.remove("layers");if(b){const c=()=>this.notifyChange("state");this.handles.add(b.map(a=>N.when(()=>a.loadStatus,c)),"layers")}this._set("layers",b)}},{key:"state",get:function(){const {layers:b}=this;return b&&0!==b.length?b.some(c=>"loading"===c.loadStatus||"not-loaded"===c.loadStatus)?"loading":"ready":"disabled"}},{key:"_featureTemplatesByLayer",
get:function(){if(!this.layers)return new Map;const b=[];for(const c of this.layers)if("subtype-group"===c.type)for(const a of c.sublayers){const p=r(a);b.push([a,p])}else b.push([c,r(c)]);return new Map(b)}},{key:"numberOfFeatureTemplates",get:function(){return Array.from(this._featureTemplatesByLayer.values()).reduce((b,c)=>b+c.length,0)}},{key:"items",get:function(){if(0===this.numberOfFeatureTemplates)return this._releasePreviousItems(),[];var b=this._featureTemplatesByLayer,c=[],a=x.isSome(this.filterFunction)?
this.filterFunction:E._nullFilterFunction;for(const [P,m]of b)if(P.loaded||"subtype-sublayer"===P.type&&P.parent?.loaded)if(b=n.getEffectiveLayerCapabilities(P)?.operations,b?.supportsEditing&&b?.supportsAdd)for(var p of m)c.push({layer:P,template:p,matchesFilter:a({label:p.name})});if(x.isNone(this._groupByFunction))return a=c.filter(({matchesFilter:P})=>P).map(({template:P,layer:m})=>this._createItem(P,m)),this._releasePreviousItems(),a;p=new Map;for(var D of c){const {template:P,layer:m}=D;c=this._groupByFunction({template:P,
layer:m});const {key:I,label:H}=x.isSome(c.key)?c:E.nullGroupBy;p.has(I)||p.set(I,{label:H,templateItemInfos:[]});p.get(I)?.templateItemInfos.push(D)}D=[];for(const P of p.values()){const {label:m,templateItemInfos:I}=P;c=I.filter(({matchesFilter:H})=>H);c=a({label:m})?I:0<I.length?c:[];0<c.length&&(c=c.map(({template:H,layer:S})=>this._createItem(H,S)),D.push(this._createGroup(m,c)))}if(1===D.length&&D[0].label===E.nullGroupBy.label)return this._releasePreviousItems(),D[0].items;this._releasePreviousItems();
return D}}]);return O}(w.HandleOwnerMixin(g.EventedAccessor));g.nullGroupBy={key:Symbol(),label:"Other\u200b"};g._nullFilterFunction=Q=>!0;l.__decorate([B.property()],g.prototype,"_groupByFunction",void 0);l.__decorate([B.property()],g.prototype,"filterFunction",void 0);l.__decorate([B.property()],g.prototype,"groupBy",null);l.__decorate([B.property()],g.prototype,"layers",null);l.__decorate([B.property()],g.prototype,"state",null);l.__decorate([B.property({readOnly:!0})],g.prototype,"_featureTemplatesByLayer",
null);l.__decorate([B.property({readOnly:!0})],g.prototype,"numberOfFeatureTemplates",null);l.__decorate([B.property({readOnly:!0})],g.prototype,"items",null);l.__decorate([B.property({readOnly:!0})],g.prototype,"selectedItem",void 0);l.__decorate([B.property()],g.prototype,"select",null);g=E=l.__decorate([h.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],g);const r=Q=>{const O="templates"in Q&&Array.isArray(Q.templates)?Q.templates:[];Q="types"in Q&&Array.isArray(Q.types)?Q.types.flatMap(A=>
A.templates):[];return[...O,...Q]};return g})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../symbols/support/symbolUtils".split(" "),function(e,
l,g,w,x,L,N,B,t,f,d,h,n,z){async function k(r,Q){var {renderer:O}=r;return O&&(Q=new w({attributes:Q.prototype.attributes}),O=await O.getSymbolAsync(Q))?O:E(r)}async function E(r){({geometryType:r}=r);return(r="point"===r||"multipoint"===r?await new Promise((Q,O)=>e(["../../symbols/SimpleMarkerSymbol"],A=>Q(v(A)),O)):"polyline"===r?await new Promise((Q,O)=>e(["../../symbols/SimpleLineSymbol"],A=>Q(v(A)),O)):"polygon"===r||"mesh"===r||"multipatch"===r?await new Promise((Q,O)=>e(["../../symbols/SimpleFillSymbol"],
A=>Q(v(A)),O)):null)?new r.default:null}const v=r=>Object.freeze(Object.defineProperty({__proto__:null,default:r},Symbol.toStringTag,{value:"Module"}));var y;x=y=function(r){function Q(A){A=O.call(this,A);A._activeFetchInfo={id:null,request:null};A.layer=null;A.template=null;A.thumbnail=null;return A}l._inherits(Q,r);var O=l._createSuper(Q);r=Q.prototype;r.initialize=function(){this.handles.add(B.watch(()=>{const {layer:A}=this;return[A&&"renderer"in A?A.renderer:null,this.template]},()=>{this._activeFetchInfo.id=
null;this._activeFetchInfo.request=null;this._set("thumbnail",null)},B.initial))};r.clone=function(){const A=N.isSome(this.thumbnail)?this.thumbnail.cloneNode(!0):null,b=new y({layer:this.layer,template:this.template});b._set("thumbnail",A);return b};Q.fetchThumbnail=async function(A,b){const c=await k(A,b);if(N.isNone(c))return null;const a={maxSize:36};"dictionary"===A.renderer?.type&&(a.fieldMap=A.renderer.fieldMap??void 0,a.feature={attributes:b.prototype.attributes??{}});return await z.renderPreviewHTML(c,
a)};l._createClass(Q,[{key:"description",get:function(){return this.template?.description},set:function(A){this.template&&(this.template.description=A)}},{key:"label",get:function(){return this.template?.name},set:function(A){this.template&&(this.template.name=A)}},{key:"id",get:function(){return`${this.label??""}\u2013${this.layer?.id}`}}]);return Q}(L.HandleOwnerMixin(x));g.__decorate([t.property()],x.prototype,"description",null);g.__decorate([t.property()],x.prototype,"label",null);g.__decorate([t.property()],
x.prototype,"layer",void 0);g.__decorate([t.property()],x.prototype,"template",void 0);g.__decorate([t.property({readOnly:!0})],x.prototype,"thumbnail",void 0);g.__decorate([t.property()],x.prototype,"id",null);return x=y=g.__decorate([n.subclass("esri.widgets.FeatureTemplates.TemplateItem")],x)})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d){function h(v,y){if(y&&(v.style.filter=t.getCSSFilterFromEffectList(y),y=y.effects))for(const r of y)if("drop-shadow"===r?.type){0>r.offsetX?v.style.marginLeft=`${Math.abs(r.offsetX)}px`:v.style.marginRight=`${r.offsetX}px`;break}}async function n(v,y){switch(v.type){case "web-style":var {previewWebStyleSymbol:r}=await new Promise((Q,O)=>e(["./previewWebStyleSymbol"],Q,O));return r(v,n,y);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:r}=
await new Promise((Q,O)=>e(["./previewSymbol3D"],Q,O)),r(v,y);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:r}=await new Promise((Q,O)=>e(["./previewSymbol2D"],Q,O)),r(v,y);case "cim":return{previewCIMSymbol:r}=await new Promise((Q,O)=>e(["./previewCIMSymbol"],Q,O)),r(v,y)}}function z(v){return v&&"opacity"in v?v.opacity*z(v.parent):1}let k=null;const E=[255,255,255];l.getDisplayedColor=async function(v,y){if(v){var r=
z(v.layer||v.sourceLayer);if(w.isSome(v.symbol)&&(!w.isSome(y)||!0!==y.ignoreGraphicSymbol))return v="web-style"===v.symbol.type?await t.fetchWebStyleSymbol(v.symbol,y):v.symbol.clone(),t.getColorFromSymbol(v,r);var Q=w.isSome(y)&&y.renderer||v.get("layer.renderer")||v.get("sourceLayer.renderer"),O=await Q.getSymbolAsync(v,y);if(O){O="web-style"===O.type?await t.fetchWebStyleSymbol(O,y):O.clone();var A=t.getColorFromSymbol(O,r);if(!("visualVariables"in Q)||"visualVariables"in Q&&!Q.visualVariables||
"visualVariables"in Q&&!Q.visualVariables?.length)return A;Q.arcadeRequiredForVisualVariables&&(w.isNone(y)||w.isNone(y.arcade))&&(y={...w.unwrap(y)},y.arcade=await x.loadArcade());O=await new Promise((a,p)=>e(["../../renderers/visualVariables/support/visualVariableUtils"],a,p));var b=[],c=[];for(const a of Q.visualVariables)switch(a.type){case "color":b.push(a);break;case "opacity":c.push(a)}Q=(Q=0<b.length?b[b.length-1]:null)?O.getColor(Q,v,y):A;v=(A=0<c.length?c[c.length-1]:null)?O.getOpacity(A,
v,y):null;null!=r&&(v=null!=v?v*r:r);return Q?t.applyOpacityToColor(Q,v):null}}};l.getDisplayedSymbol=async function(v,y){if(v){var r=v.sourceLayer,Q=(w.isSome(y)&&(y.useSourceLayer??!1)?r:v.layer)??r;r=z(Q);if(w.isSome(v.symbol)&&(!w.isSome(y)||!0!==y.ignoreGraphicSymbol))return v="web-style"===v.symbol.type?await t.fetchWebStyleSymbol(v.symbol,{...y,cache:w.isSome(y)?y.webStyleCache:null}):v.symbol.clone(),t.applyColorToSymbol(v,null,r),v;var O=(w.isSome(y)?y.renderer:null)??(Q&&"renderer"in Q?
Q.renderer:null);if(Q=O&&"getSymbolAsync"in O?await O.getSymbolAsync(v,y):null){Q="web-style"===Q.type?await Q.fetchSymbol({...y,cache:w.isSome(y)?y.webStyleCache:null}):Q.clone();if(!(O&&"visualVariables"in O&&O.visualVariables&&O.visualVariables.length))return t.applyColorToSymbol(Q,null,r),Q;"arcadeRequiredForVisualVariables"in O&&O.arcadeRequiredForVisualVariables&&(w.isNone(y)||w.isNone(y.arcade))&&(y={...w.unwrap(y)},y.arcade=await x.loadArcade());var A=await new Promise((P,m)=>e(["../../renderers/visualVariables/support/visualVariableUtils"],
P,m)),b=[],c=[],a=[],p=[];for(var D of O.visualVariables)switch(D.type){case "color":b.push(D);break;case "opacity":c.push(D);break;case "rotation":p.push(D);break;case "size":D.target||a.push(D)}D=(D=!!b.length&&b[b.length-1])?A.getColor(D,v,y):null;c=(c=!!c.length&&c[c.length-1])?A.getOpacity(c,v,y):null;null!=r&&(c=null!=c?c*r:r);t.applyColorToSymbol(Q,D,c);a.length&&(r=A.getAllSizes(a,v,y),await t.applySizesToSymbol(Q,r));for(const P of p)t.applyRotationToSymbol(Q,A.getRotationAngle(P,v,y),P.axis);
return Q}}};l.renderColorRampPreviewHTML=function(v,y={}){var r="horizontal"===y.align;const Q=y.width??(r?75:24),O=y.height??(r?24:75);var A=y.gradient??!0,b=window.devicePixelRatio,c=Q*b,a=O*b;b=document.createElement("canvas");b.width=c;b.height=a;b.style.width=`${Q}px`;b.style.height=`${O}px`;const p=b.getContext("2d");var D=r?c:0;const P=r?0:a;if(A){const m=p.createLinearGradient(0,0,D,P);r=v.length;const I=1===r?0:1/(r-1);v.forEach((H,S)=>m.addColorStop(S*I,H.toString()));p.fillStyle=m;p.fillRect(0,
0,c,a)}else{c=r?c/v.length:c;a=r?a:a/v.length;D=A=0;for(const m of v)p.fillStyle=m.toString(),p.fillRect(A,D,c,a),A=r?A+c:0,D=r?0:D+a}v=document.createElement("div");v.style.width=`${Q}px`;v.style.height=`${O}px`;h(v,y?.effectList);v.appendChild(b);return v};l.renderDotDensityPreviewHTML=function(v,y,r){const {backgroundColor:Q,outline:O,dotSize:A}=v;r=r&&r.swatchSize||N.SymbolSizeDefaults.size;const b=Math.round(r*r/A**2*.8),c=window.devicePixelRatio;v=document.createElement("canvas");const a=r*
c;v.width=a;v.height=a;v.style.width=`${v.width/c}px`;v.style.height=`${v.height/c}px`;const p=v.getContext("2d");Q&&(p.fillStyle=Q.toCss(!0),p.fillRect(0,0,a,a),p.fill());p.fillStyle=y.toCss(!0);if(k&&k.length/2===b)for(y=0;y<2*b;y+=2)p.fillRect(k[y],k[y+1],A*c,A*c),p.fill();else for(k=[],y=0;y<2*b;y+=2){const D=Math.floor(Math.random()*(a-0+1)),P=Math.floor(Math.random()*(a-0+1));k.push(D,P);p.fillRect(D,P,A*c,A*c);p.fill()}O&&(O.color&&(p.strokeStyle=O.color.toCss(!0)),p.lineWidth=O.width,p.strokeRect(0,
0,a,a));r=new Image(r,r);r.src=v.toDataURL();return r};l.renderPieChartPreviewHTML=function(v,y={}){const r=y.radius||40;var Q=2*Math.PI*r,O=v.length;const A=Q/O,b=[],c=L.getStroke(y.outline);null!=c?.width&&(c.width*=2);(c||y.backgroundColor)&&b.push({shape:{type:"circle",cx:r,cy:r,r},fill:y.backgroundColor,stroke:c,offset:[0,0]});const a=y.values,p=a&&a.length===O&&100===a.reduce((P,m)=>P+m,0),D=[0];for(let P=0;P<O;P++){let m=null;p&&(m=a[P]*Q/100,D.push(m+D[P]));b.push({shape:{type:"circle",cx:r,
cy:r,r:r/2},fill:[0,0,0,0],stroke:{width:r,dashArray:`${(m??A)/2} ${Q}`,dashoffset:`-${p?D[P]/2:A/2*P}`,color:v[P]},offset:[0,0]})}O=null;v=2*r+(c?.width||0);if(Q=y.holePercentage)c&&b.push({shape:{type:"circle",cx:r,cy:r,r:r*Q},fill:null,stroke:c,offset:[0,0]}),O=v/2,O=[[{shape:{type:"circle",cx:O,cy:O,r:O},fill:E,stroke:c?{...c,color:E}:null,offset:[0,0]},{shape:{type:"circle",cx:O,cy:O,r:r*Q},fill:[0,0,0],stroke:null,offset:[0,0]}]];return B.renderSymbol([b],[v,v],{effectView:y.effectList,ignoreStrokeWidth:!0,
masking:O,rotation:-90})};l.renderPreviewHTML=n;l.renderRelationshipRampPreviewHTML=function(v,y={}){const r=v?.authoringInfo;if("relationship"!==r?.type||!r?.numClasses||!v.uniqueValueInfos)return null;const {focus:Q,numClasses:O}=r,A=d.getRelationshipRampElement({focus:Q,numClasses:O,infos:v.uniqueValueInfos});v=y&&y.node||document.createElement("div");B.renderOnce(v,()=>f.renderRelationshipRamp(A,y.id||"relationship",y.opacity||1,y.effectList));return v};Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(e,l,g,w,x,L,N){function B(d){if(!d)return null;let h=null;switch(d.type){case "simple-fill":case "picture-fill":case "simple-marker":h=B(d.outline);break;case "simple-line":const n=L.pt2px(d.width);null!=d.style&&"none"!==d.style&&0!==n&&(h={color:d.color,style:f(d.style),width:n,cap:d.cap,join:"miter"===
d.join?L.pt2px(d.miterLimit):d.join});break;default:h=null}return h}const t=new x(1E3),f=(()=>{const d={};return h=>{if(d[h])return d[h];const n=h.replace(/-/g,"");return d[h]=n}})();g=new g([128,128,128]);e.defaultThematicColor=g;e.dekebabifyLineStyle=f;e.getFill=function(d){const h=d.style;let n=null;if(d)switch(d.type){case "simple-marker":"cross"!==h&&"x"!==h&&(n=d.color);break;case "simple-fill":"solid"===h?n=d.color:"none"!==h&&(n={type:"pattern",x:0,y:0,src:l.getAssetUrl(`esri/symbols/patterns/${h}.png`),
width:5,height:5});break;case "picture-fill":n={type:"pattern",src:d.url,width:L.pt2px(d.width)*d.xscale,height:L.pt2px(d.height)*d.yscale,x:L.pt2px(d.xoffset),y:L.pt2px(d.yoffset)};break;case "text":n=d.color;break;case "cim":n=N.getCIMSymbolColor(d)}return n};e.getPatternUrlWithColor=function(d,h){const n=d+"-"+h;return void 0!==t.get(n)?Promise.resolve(t.get(n)):w(d,{responseType:"image"}).then(z=>{z=z.data;const k=z.naturalWidth,E=z.naturalHeight,v=document.createElement("canvas");v.width=k;v.height=
E;const y=v.getContext("2d");y.fillStyle=h;y.fillRect(0,0,k,E);y.globalCompositeOperation="destination-in";y.drawImage(z,0,0);z=v.toDataURL();t.put(n,z);return z})};e.getStroke=B;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(e,l){return function(){function g(x,L){this._storage=new l.MemCacheStorage;this._storage.maxSize=x;L&&this._storage.registerRemoveFunc("",L)}var w=g.prototype;
w.put=function(x,L){this._storage.put(x,L,1,1)};w.pop=function(x){return this._storage.pop(x)};w.get=function(x){return this._storage.get(x)};w.clear=function(){this._storage.clearAll()};w.destroy=function(){this._storage.destroy()};return e._createClass(g)}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(e,l,g){function w(h){h=g.toCIMSymbolJSON(h);if("CIMTextSymbol"===h?.type)return h.height??0;let n=0;if(h?.symbolLayers)for(const z of h.symbolLayers)g.isCIMMarker(z)&&
null!=z.size&&z.size>n?n=z.size:g.isCIMStroke(z)&&null!=z.width&&z.width>n?n=z.width:g.isCIMFill(z);return n}function x(h,n,z,k){if(h)if("CIMTextSymbol"===h.type)null!=h.height&&(h.height*=n);else{if(z&&h.effects)for(const E of h.effects)B(E,n);if(h.symbolLayers)for(const E of h.symbolLayers)switch(E.type){case "CIMPictureMarker":case "CIMVectorMarker":L(E,n,k);break;case "CIMPictureStroke":case "CIMSolidStroke":!k?.preserveOutlineWidth&&E.width&&(E.width*=n);break;case "CIMPictureFill":E.height&&
(E.height*=n);E.offsetX&&(E.offsetX*=n);E.offsetY&&(E.offsetY*=n);break;case "CIMHatchFill":x(E.lineSymbol,n,!0,{...k,preserveOutlineWidth:!1}),E.offsetX&&(E.offsetX*=n),E.offsetY&&(E.offsetY*=n),E.separation&&(E.separation*=n)}}}function L(h,n,z){if(h&&(h.markerPlacement&&N(h.markerPlacement,n),h.offsetX&&(h.offsetX*=n),h.offsetY&&(h.offsetY*=n),h.anchorPoint&&"Absolute"===h.anchorPointUnits&&(h.anchorPoint={x:h.anchorPoint.x*n,y:h.anchorPoint.y*n}),h.size=null!=h.size?h.size*n:0,"CIMVectorMarker"===
h.type&&h.markerGraphics))for(const k of h.markerGraphics)h.scaleSymbolsProportionally||x(k.symbol,n,!0,z)}function N(h,n){g.isCIMMarkerStrokePlacement(h)&&h.offset&&(h.offset*=n);switch(h.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":h.customEndingOffset&&(h.customEndingOffset*=n);h.offsetAlongLine&&(h.offsetAlongLine*=n);if(h.placementTemplate&&h.placementTemplate.length){var z=h.placementTemplate.map(k=>k*n);h.placementTemplate=z}break;case "CIMMarkerPlacementAlongLineVariableSize":h.maxRandomOffset&&
(h.maxRandomOffset*=n);h.placementTemplate&&h.placementTemplate.length&&(z=h.placementTemplate.map(k=>k*n),h.placementTemplate=z);break;case "CIMMarkerPlacementOnLine":h.startPointOffset&&(h.startPointOffset*=n);break;case "CIMMarkerPlacementAtExtremities":h.offsetAlongLine&&(h.offsetAlongLine*=n);break;case "CIMMarkerPlacementAtRatioPositions":h.beginPosition&&(h.beginPosition*=n);h.endPosition&&(h.endPosition*=n);break;case "CIMMarkerPlacementPolygonCenter":h.offsetX&&(h.offsetX*=n);h.offsetY&&
(h.offsetY*=n);break;case "CIMMarkerPlacementInsidePolygon":h.offsetX&&(h.offsetX*=n),h.offsetY&&(h.offsetY*=n),h.stepX&&(h.stepX*=n),h.stepY&&(h.stepY*=n)}}function B(h,n){switch(h.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":h.width&&(h.width*=n);break;case "CIMGeometricEffectBuffer":h.size&&(h.size*=n);break;case "CIMGeometricEffectCut":h.beginCut&&(h.beginCut*=n);h.endCut&&(h.endCut*=n);h.middleCut&&(h.middleCut*=n);break;case "CIMGeometricEffectDashes":h.customEndingOffset&&
(h.customEndingOffset*=n);h.offsetAlongLine&&(h.offsetAlongLine*=n);if(h.dashTemplate&&h.dashTemplate.length){const z=h.dashTemplate.map(k=>k*n);h.dashTemplate=z}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":h.length&&(h.length*=n);break;case "CIMGeometricEffectMove":h.offsetX&&(h.offsetX*=n);h.offsetY&&(h.offsetY*=n);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":h.offset&&(h.offset*=n);break;case "CIMGeometricEffectRegularPolygon":h.radius&&
(h.radius*=n);break;case "CIMGeometricEffectTaperedPolygon":h.fromWidth&&(h.fromWidth*=n);h.length&&(h.length*=n);h.toWidth&&(h.toWidth*=n);break;case "CIMGeometricEffectWave":h.amplitude&&(h.amplitude*=n),h.period&&(h.period*=n)}}function t(h,n){if(h){var z="CIMTextSymbol"===h.type?h.symbol:h;h="CIMPolygonSymbol"===h.type;if(z?.symbolLayers)for(const k of z.symbolLayers)if(!(k.colorLocked||h&&(g.isCIMStroke(k)||g.isCIMMarker(k)&&k.markerPlacement&&g.isCIMMarkerStrokePlacement(k.markerPlacement))))switch(k.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":k.tintColor&&
f(n,k.tintColor);break;case "CIMVectorMarker":k.markerGraphics?.forEach(E=>{t(E.symbol,n)});break;case "CIMSolidStroke":case "CIMSolidFill":f(n,k.color);break;case "CIMHatchFill":t(k.lineSymbol,n)}}}function f(h,n){for(const z of h)if(z.join(".")===n.join("."))return;h.push(n)}function d(h,n,z){if(h){var k="CIMTextSymbol"===h.type?h.symbol:h;h="CIMPolygonSymbol"===k?.type;if(k?.symbolLayers)for(const E of k.symbolLayers)if(!E.colorLocked){if(h)if(z){if({layersToColor:k}=z,(g.isCIMStroke(E)||g.isCIMMarker(E)&&
E.markerPlacement&&g.isCIMMarkerStrokePlacement(E.markerPlacement))&&"fill"===k||g.isCIMFill(E)&&"outline"===k)continue}else if(g.isCIMStroke(E)||g.isCIMMarker(E)&&E.markerPlacement&&g.isCIMMarkerStrokePlacement(E.markerPlacement))continue;k=n.toArray();switch(E.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":E.tintColor=k;break;case "CIMVectorMarker":E.markerGraphics?.forEach(v=>{d(v.symbol,n,z)});break;case "CIMSolidStroke":case "CIMSolidFill":E.color=k;break;case "CIMHatchFill":d(E.lineSymbol,
n,z)}}}}e.applyCIMSymbolColor=function(h,n,z){n instanceof l||(n=new l(n));(h=g.toCIMSymbolJSON(h))&&d(h,n,z)};e.applyCIMSymbolRotation=function(h,n,z=!1){h=g.toCIMSymbolJSON(h);z&&0!==n&&(n=360-n);if("CIMTextSymbol"===h?.type)h.angle=n;else if("CIMPointSymbol"===h?.type&&h.symbolLayers){z=n-(h.angle||0);for(const k of h.symbolLayers)if(g.isCIMMarker(k)){let E=k.rotation||0;E=k.rotateClockwise?E-z:E+z;k.rotation=E}h.angle=n}};e.getCIMSymbolColor=function(h){h=g.toCIMSymbolJSON(h);const n=[];t(h,n);
return n.length?new l(g.fromCIMColor(n[0])):null};e.getCIMSymbolRotation=function(h,n=!1){h=g.toCIMSymbolJSON(h);return"CIMTextSymbol"===h?.type||"CIMPointSymbol"===h?.type?(h=h.angle,null!=h&&0!==h&&n?360-h:h??0):0};e.getCIMSymbolSize=w;e.getCIMSymbolType=function(h){h=g.toCIMSymbolJSON(h);if(!h)return null;switch(h.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};e.scaleCIMMarker=L;e.scaleCIMSymbol=x;e.scaleCIMSymbolTo=function(h,n,z){if(h){var k=g.toCIMSymbolJSON(h);h=w(h);if(0===h){if(k)if("CIMTextSymbol"===k.type)k.height=n;else if(k.symbolLayers)for(const E of k.symbolLayers)switch(E.type){case "CIMPictureMarker":case "CIMVectorMarker":E.size=n;break;case "CIMPictureStroke":case "CIMSolidStroke":E.width=n}}else x(k,n/h,!1,z)}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(e,l){function g(d){let h=d.length;for(;h--;)if(!" /-,\n".includes(d.charAt(h)))return!1;return!0}function w(d,h){const n=[];var z=0;let k=-1;do k=d.indexOf("[",z),k>=z&&(k>z&&(z=d.substr(z,k-z),n.push([z,null,g(z)])),z=k+1,k=d.indexOf("]",z),k>=z&&(k>z&&(z=d.substr(z,k-z),(z=h[z])&&n.push([null,z,!1])),z=k+1));while(-1!==k);z<d.length-1&&(d=d.substr(z),n.push([d,null,g(d)]));return n}function x(d,h,n){let z="",k=null;for(const E of h){const [v,
y,r]=E;if(v)r?k=v:(k&&(z+=k,k=null),z+=v);else if(h=d.attributes[y])k&&(z+=k,k=null),z+=h}return L(z,n)}function L(d,h){"string"!==typeof d&&(d=String(d));switch(h){case "LowerCase":return d.toLowerCase();case "Allcaps":return d.toUpperCase();default:return d}}function N(d){return d?{r:d[0],g:d[1],b:d[2],a:d[3]/255}:{r:0,g:0,b:0,a:0}}function B(d){if(!d)return null;switch(d.type){case "CIMPolygonSymbol":if(d.symbolLayers)for(const h of d.symbolLayers)if(d=B(h),null!=d)return d;break;case "CIMTextSymbol":return B(d.symbol);
case "CIMSolidFill":return d.color}}function t(d){if(d)switch(d.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(d=d.symbolLayers)for(const h of d)if(d=t(h),null!=d)return d;break;case "CIMTextSymbol":return t(d.symbol);case "CIMSolidStroke":case "CIMSolidFill":return d.color}}function f(d){if(d)switch(d.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(d.symbolLayers)for(const h of d.symbolLayers)if(d=f(h),void 0!==d)return d;break;case "CIMTextSymbol":return f(d.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return d.width}}
l.adjustTextCase=L;l.analyzeTextParts=w;l.assignTextValuesFromFeature=x;l.attributesToFields=function(d){return(d?Object.keys(d):[]).map(h=>({name:h,alias:h,type:"string"===typeof d[h]?"esriFieldTypeString":"esriFieldTypeDouble"}))};l.colorToArray=function(d){return[d.r,d.g,d.b,d.a]};l.createLabelOverrideFunction=function(d,h,n){const z=w(h,d);return k=>x(k,z,n)};l.evaluateValueOrFunction=function(d,h,n,z){return"function"===typeof d?d(h,n,z):d};l.fromCIMColor=N;l.fromCIMFontDecoration=function(d){return d.underline?
"underline":d.strikethrough?"line-through":"none"};l.fromCIMFontStyle=function(d){let h="",n="";d&&(d=d.toLowerCase(),d.includes("italic")?h="italic":d.includes("oblique")&&(h="oblique"),d.includes("bold")?n="bold":d.includes("light")&&(n="lighter"));return{style:h,weight:n}};l.fromCIMHorizontalAlignment=function(d){switch(d){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};l.fromCIMVerticalAlignment=function(d){switch(d){default:return"top";
case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};l.getFillColor=B;l.getFontStyle=function(d){if(!d)return"normal";switch(d.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};l.getFontWeight=function(d){if(!d)return"normal";switch(d.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};l.getStrokeColor=t;l.getStrokeWidth=f;l.getTintColor=
d=>d.tintColor?N(d.tintColor):{r:255,g:255,b:255,a:1};l.getValue=(d,h=0)=>null==d||isNaN(d)?h:d;l.importGeometryEngine=function(){return new Promise((d,h)=>e(["../../geometry/geometryEngineJSON"],d,h))};l.isCIMFill=function(d){return null!=d&&("CIMGradientFill"===d.type||"CIMHatchFill"===d.type||"CIMPictureFill"===d.type||"CIMSolidFill"===d.type||"CIMWaterFill"===d.type)};l.isCIMMarker=function(d){return"CIMVectorMarker"===d.type||"CIMPictureMarker"===d.type||"CIMBarChartMarker"===d.type||"CIMCharacterMarker"===
d.type||"CIMPieChartMarker"===d.type||"CIMStackedBarChartMarker"===d.type};l.isCIMMarkerStrokePlacement=function(d){return null!=d&&("CIMMarkerPlacementAlongLineRandomSize"===d.type||"CIMMarkerPlacementAlongLineSameSize"===d.type||"CIMMarkerPlacementAlongLineVariableSize"===d.type||"CIMMarkerPlacementAtExtremities"===d.type||"CIMMarkerPlacementAtMeasuredUnits"===d.type||"CIMMarkerPlacementAtRatioPositions"===d.type||"CIMMarkerPlacementOnLine"===d.type||"CIMMarkerPlacementOnVertices"===d.type)};l.isCIMStroke=
function(d){return"CIMGradientStroke"===d.type||"CIMPictureStroke"===d.type||"CIMSolidStroke"===d.type};l.isGeometryEngineRequired=d=>{if(!d)return!1;for(const h of d)switch(h.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};l.isSVGImage=d=>d.includes("data:image/svg+xml");l.mapCIMSymbolToGeometryType=function(d){if(!d)return null;switch(d.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";
case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};l.resampleHermite=function(d,h,n,z,k,E,v=!0){const y=h/k;n/=E;const r=Math.ceil(y/2),Q=Math.ceil(n/2);for(let b=0;b<E;b++)for(let c=0;c<k;c++){const a=4*(c+(v?E-b-1:b)*k);var O=0;let p=0,D=0,P=0,m=0,I=0,H=0;const S=(b+.5)*n;for(let F=Math.floor(b*n);F<(b+1)*n;F++){var A=Math.abs(S-(F+.5))/Q;const T=(c+.5)*y;A*=A;for(let M=Math.floor(c*y);M<(c+1)*y;M++){let J=Math.abs(T-(M+.5))/r;O=Math.sqrt(A+J*J);-1<=O&&1>=O&&(O=2*O*O*O-3*
O*O+1,0<O&&(J=4*(M+F*h),H+=O*d[J+3],D+=O,255>d[J+3]&&(O=O*d[J+3]/250),P+=O*d[J],m+=O*d[J+1],I+=O*d[J+2],p+=O))}}z[a]=P/p;z[a+1]=m/p;z[a+2]=I/p;z[a+3]=H/D}};l.toCIMSymbolJSON=function(d){return d.data?.symbol??null};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(e,l){function g(w,x){return Math.round(Math.min(Math.max(w+191.25*x,0),255))}e.SymbolSizeDefaults=void 0;(function(w){w[w.size=22]="size";
w[w.lineWidth=50]="lineWidth";w[w.maxSize=120]="maxSize";w[w.maxOutlineSize=80]="maxOutlineSize";w[w.tallSymbolWidth=20]="tallSymbolWidth"})(e.SymbolSizeDefaults||(e.SymbolSizeDefaults={}));e.adjustColorBrightness=function(w,x){if(null==w)return new l;if("type"in w&&("linear"===w.type||"pattern"===w.type))return w;w=new l(w);return new l([g(w.r,x),g(w.g,x),g(w.b,x),w.a])};e.adjustColorComponentBrightness=g;e.getConeShapes=function(w,x){let L=x?e.SymbolSizeDefaults.tallSymbolWidth:w;x=x?4:6;L=L<=e.SymbolSizeDefaults.size?
L-.5*x:L-x;x=.15*L;const N=L;w-=x;return[{type:"ellipse",cx:.5*L,cy:w,rx:.5*L,ry:x},{type:"path",path:[{command:"M",values:[.5*N,0]},{command:"L",values:[N,w]},{command:"L",values:[0,w]},{command:"Z",values:[]}]}]};e.getCubeShapes=function(w,x){let L=x?e.SymbolSizeDefaults.tallSymbolWidth:w;var N=x?4:6;N=L=L<=e.SymbolSizeDefaults.size?L-.5*N:L-N;x=x?.35*L:.5*L;return[{type:"path",path:[{command:"M",values:[.5*N,0]},{command:"L",values:[N,.5*x]},{command:"L",values:[.5*N,x]},{command:"L",values:[0,
.5*x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[.5*N,x]},{command:"L",values:[.5*N,w]},{command:"L",values:[0,w-.5*x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*N,x]},{command:"L",values:[.5*N,w]},{command:"L",values:[N,w-.5*x]},{command:"L",values:[N,.5*x]},{command:"Z",values:[]}]}]};e.getCylinderShapes=function(w,x){var L=x?e.SymbolSizeDefaults.tallSymbolWidth:w;x=x?4:6;L=L<=e.SymbolSizeDefaults.size?L-.5*x:L-x;x=
.5*L;const N=.15*L;w-=N;return[{type:"ellipse",cx:.5*L,cy:w,rx:x,ry:N},{type:"path",path:[{command:"M",values:[0,N]},{command:"L",values:[0,w]},{command:"L",values:[L,w]},{command:"L",values:[L,N]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*L,cy:N,rx:x,ry:N}]};e.getDiamondShapes=function(w){var x=w;x=x<e.SymbolSizeDefaults.size?x-2:x-4;const L=Math.floor(w/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*x,0]},{command:"L",values:[x,.5*w-L]},{command:"L",values:[.45*x-L,.5*w+L]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.45*x,0]},{command:"L",values:[.45*x-L,.5*w+L]},{command:"L",values:[0,.5*w-L]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*w-L]},{command:"L",values:[.45*x-L,.5*w+L]},{command:"L",values:[.45*x,w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*x,w]},{command:"L",values:[x,.5*w-L]},{command:"L",values:[.45*x-L,.5*w+L]},{command:"Z",values:[]}]}]};e.getExtrudeSymbolShapes=function(w){const x=e.SymbolSizeDefaults.size;
w*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*x]},{command:"L",values:[.3*x,.7*x]},{command:"L",values:[.3*x,.7*x+w]},{command:"L",values:[0,.7*x+w-.35*x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*x,.7*x]},{command:"L",values:[.3*x,.7*x+w]},{command:"L",values:[x,w]},{command:"L",values:[x,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*x,0]},{command:"L",values:[x,0]},{command:"L",values:[.3*x,.7*x]},{command:"L",values:[0,.35*x]},
{command:"Z",values:[]}]}]};e.getInvertedConeShapes=function(w){let x=w;x=x<e.SymbolSizeDefaults.size?x-3:x-6;const L=.15*x,N=x;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[N,0]},{command:"L",values:[.5*N,w-L]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*x,cy:0,rx:.5*x,ry:L}]};e.getPathSymbolShapes=function(w,x,L){var N=e.SymbolSizeDefaults.size;let B=N,t=N;1>w?B*=.75:1<w&&(t*=1.25);w=N;x&&L&&(B=t=w=N=0);return[{type:"path",path:[{command:"M",values:[w,0]},{command:"L",
values:[L?w:.875*w,0]},{command:"L",values:[L?B-.5*w:0,t-.5*N]},{command:"L",values:[B-.5*w,t-.5*N]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[w,0]},{command:"L",values:[w,x?0:.125*N]},{command:"L",values:[B-.5*w,x?t-.5*N:N]},{command:"L",values:[B-.5*w,t-.5*N]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[B-.5*w,t-.5*N]},{command:"L",values:[L?B-.5*w:0,t-.5*N]},{command:"L",values:[L?B-.5*w:0,x?t-.5*N:N]},{command:"L",values:[B-.5*w,x?t-.5*N:N]},{command:"Z",
values:[]}]}]};e.getTetrahedronShapes=function(w){var x=w;x=x<e.SymbolSizeDefaults.size?x-1:x-2;return[{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[w,x]},{command:"L",values:[.45*w,.6*x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[.45*w,.6*x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,x]},{command:"L",values:[.45*w,.6*x]},{command:"L",values:[w,x]},{command:"Z",values:[]}]}]};
e.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
e.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(e,l,g,w,x,L,N,B,t,f){function d(z,k){n.append(z,k);n.detach(k)}function h(z,k,E){return z?g(z,{responseType:"image"}).then(v=>{v=v.data;const y=v.width,r=v.height,Q=y/r;let O=k;E&&(O=Math.min(O,Math.max(y,r)));return{image:v,width:1>=Q?Math.ceil(O*Q):O,height:1>=Q?O:Math.ceil(O/Q)}}):Promise.reject(new x("renderUtils: imageDataSize","href not provided."))}const n=B.createProjector();e.renderOnce=d;e.renderSymbol=function(z,k,E){const v=Math.ceil(k[0]),y=Math.ceil(k[1]);if(!z.some(r=>!!r.length))return null;
k=E&&E.node||document.createElement("div");null!=E.opacity&&(k.style.opacity=E.opacity.toString());null!=E.effectView&&(k.style.filter=f.getCSSFilterFromEffectList(E.effectView));d(k,()=>t.renderSVG(z,v,y,E));return k};e.tintImageWithColor=function(z,k,E,v,y){return h(z,k,y).then(r=>{const Q=r.width??k,O=r.height??k;var A;if(A=r.image)A=E&&"ignore"!==v?"multiply"===v&&255===E.r&&255===E.g&&255===E.b&&1===E.a?!1:!0:!1;if(A){var b=r.image.width,c=r.image.height;L("edge")&&/\.svg$/i.test(z)&&(--b,--c);
A=Math.ceil(Q);var a=Math.ceil(O);var p=document.createElement("canvas");p.width=A;p.height=a;p.style.width=A+"px";p.style.height=a+"px";p=p.getContext("2d");p.clearRect(0,0,A,a);A=p;A.drawImage(r.image,0,0,b,c,0,0,Q,O);a=A.getImageData(0,0,Q,O);p=[E.r/255,E.g/255,E.b/255,E.a];const P=w.toHSV(E);for(let m=0;m<a.data.length;m+=4){r=a.data;b=m;c=p;var D=P;switch(v){case "multiply":r[b]*=c[0];r[b+1]*=c[1];r[b+2]*=c[2];r[b+3]*=c[3];break;default:const I=w.toHSV({r:r[b],g:r[b+1],b:r[b+2]});I.h=D.h;I.s=
D.s;I.v=I.v/100*D.v;D=w.toRGB(I);r[b]=D.r;r[b+1]=D.g;r[b+2]=D.b;r[b+3]*=c[3]}}A.putImageData(a,0,0);z=A.canvas.toDataURL("image/png")}else(A=l.id&&l.id.findCredential(z))&&A.token&&(r=z.includes("?")?"\x26":"?",z=`${z}${r}token=${A.token}`);return{url:z,width:Q,height:O}}).catch(()=>({url:z,width:k,height:k}))};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(e){function l(f,d){const h=[];let n,z;if(f[0].length!==d.length)throw Error("dimensions do not match");
const k=f.length,E=f[0].length;let v=0;for(n=0;n<k;n++){for(z=v=0;z<E;z++)v+=f[n][z]*d[z];h.push(v)}return h}function g(f){f=[f.r/255,f.g/255,f.b/255].map(d=>.04045>=d?d/12.92:((d+.055)/1.055)**2.4);f=l(B,f);return{x:100*f[0],y:100*f[1],z:100*f[2]}}function w(f){f=l(t,[f.x/100,f.y/100,f.z/100]).map(d=>Math.min(1,Math.max(.0031308>=d?12.92*d:1.055*d**(1/2.4)-.055,0)));return{r:Math.round(255*f[0]),g:Math.round(255*f[1]),b:Math.round(255*f[2])}}function x(f){f=[f.x/95.047,f.y/100,f.z/108.883].map(d=>
d>(6/29)**3?d**(1/3):1/3*(29/6)**2*d+4/29);return{l:116*f[1]-16,a:500*(f[0]-f[1]),b:200*(f[1]-f[2])}}function L(f){const d=f.l;f=[(d+16)/116+f.a/500,(d+16)/116,(d+16)/116-f.b/200].map(h=>h>6/29?h**3:3*(6/29)**2*(h-4/29));return{x:95.047*f[0],y:100*f[1],z:108.883*f[2]}}function N(f){if("r"in f&&"g"in f&&"b"in f)return f;if("l"in f&&"c"in f&&"h"in f){var d=f.c,h=f.h;return w(L({l:f.l,a:d*Math.cos(h),b:d*Math.sin(h)}))}if("l"in f&&"a"in f&&"b"in f)return w(L(f));if("x"in f&&"y"in f&&"z"in f)return w(f);
if("h"in f&&"s"in f&&"v"in f){h=(f.h+360)%360/60;d=f.v/100*255;f=f.s/100*d;const n=f*(1-Math.abs(h%2-1));switch(Math.floor(h)){case 0:h={r:f,g:n,b:0};break;case 1:h={r:n,g:f,b:0};break;case 2:h={r:0,g:f,b:n};break;case 3:h={r:0,g:n,b:f};break;case 4:h={r:n,g:0,b:f};break;case 5:case 6:h={r:f,g:0,b:n};break;default:h={r:0,g:0,b:0}}h.r=Math.round(h.r+d-f);h.g=Math.round(h.g+d-f);h.b=Math.round(h.b+d-f);return h}return f}const B=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],t=[[3.2406,
-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];e.darken=function(f,d){f=x(g(f));f.l*=1-d;return w(L(f))};e.toHSV=function(f){if("h"in f&&"s"in f&&"v"in f)return f;var d=N(f);f=d.r;const h=d.g,n=d.b;d=Math.max(f,h,n);const z=d-Math.min(f,h,n);f=0===z?0:d===f?(h-n)/z%6:d===h?(n-f)/z+2:(f-h)/z+4;0>f&&(f+=6);return{h:60*f,s:100*(0===z?0:z/d),v:100/255*d}};e.toLAB=function(f){return"l"in f&&"a"in f&&"b"in f?f:x(g(N(f)))};e.toLCH=function(f){if(!("l"in f&&"c"in f&&"h"in f)){var d=x(g(N(f)));
f=d.l;var h=d.a;const n=d.b;d=Math.sqrt(h*h+n*n);h=Math.atan2(n,h);h=0<h?h:h+2*Math.PI;f={l:f,c:d,h}}return f};e.toRGB=N;e.toXYZ=function(f){return"x"in f&&"y"in f&&"z"in f?f:g(N(f))};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(e,l,g,w,x,L,N,B){function t(M,
J){M*=F/180;return Math.abs(J*Math.sin(M))+Math.abs(J*Math.cos(M))}function f(M){return M.map(J=>`${J.command} ${J.values.join(" ")}`).join(" ").trim()}function d(M,J,u,C){if(M){if("circle"===M.type)return B.tsx("circle",{fill:J,"fill-rule":"evenodd",stroke:u.color,"stroke-width":u.width,"stroke-linecap":u.cap,"stroke-linejoin":u.join,"stroke-dasharray":u.dashArray,"stroke-dashoffset":u.dashOffset,"stroke-miterlimit":"4",cx:M.cx,cy:M.cy,r:M.r});if("ellipse"===M.type)return B.tsx("ellipse",{fill:J,
"fill-rule":"evenodd",stroke:u.color,"stroke-width":u.width,"stroke-linecap":u.cap,"stroke-linejoin":u.join,"stroke-dasharray":u.dashArray,"stroke-miterlimit":"4",cx:M.cx,cy:M.cy,rx:M.rx,ry:M.ry});if("rect"===M.type)return B.tsx("rect",{fill:J,"fill-rule":"evenodd",stroke:u.color,"stroke-width":u.width,"stroke-linecap":u.cap,"stroke-linejoin":u.join,"stroke-dasharray":u.dashArray,"stroke-miterlimit":"4",x:M.x,y:M.y,width:M.width,height:M.height});if("image"===M.type)return B.tsx("image",{href:M.src,
x:M.x,y:M.y,width:M.width,height:M.height,preserveAspectRatio:"none"});if("path"===M.type)return M="string"!==typeof M.path?f(M.path):M.path,B.tsx("path",{fill:J,"fill-rule":"evenodd",stroke:u.color,"stroke-width":u.width,"stroke-linecap":u.cap,"stroke-linejoin":u.join,"stroke-dasharray":u.dashArray,"stroke-miterlimit":"4",d:M});if("text"===M.type)return w.assertIsSome(C),B.tsx("text",{"dominant-baseline":C.dominantBaseline,fill:J,"fill-rule":"evenodd",stroke:u.color,"stroke-width":u.width,"stroke-linecap":u.cap,
"stroke-linejoin":u.join,"stroke-dasharray":u.dashArray,"stroke-miterlimit":"4","text-anchor":C.align,"text-decoration":C.decoration,kerning:C.kerning,rotate:C.rotate,"text-rendering":D,"font-style":C.font.style,"font-variant":C.font.variant,"font-weight":C.font.weight,"font-size":C.font.size,"font-family":C.font.family,x:M.x,y:M.y},M.text)}return null}function h(M){const J={fill:"none",pattern:null,linearGradient:null};if(M)if("type"in M&&"pattern"===M.type){var u=`patternId-${++a}`;J.fill=`url(#${u})`;
J.pattern={id:u,x:M.x,y:M.y,width:M.width,height:M.height,image:{x:0,y:0,width:M.width,height:M.height,href:M.src}}}else"type"in M&&"linear"===M.type?(u=`linearGradientId-${++p}`,J.fill=`url(#${u})`,J.linearGradient={id:u,x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,stops:M.colors.map(C=>({offset:C.offset,color:C.color&&(new l(C.color)).toString()}))}):M&&(M=new l(M),J.fill=M.toString());return J}function n(M){const J={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(M&&(null!=M.width&&
(J.width=M.width),M.cap&&(J.cap=M.cap),M.join&&(J.join=M.join.toString()),M.color&&(J.color=(new l(M.color)).toString()),M.dashArray&&(J.dashArray=M.dashArray),M.dashArray&&(J.dashOffset=M.dashoffset),M.style)){let u=null;M.style in S&&(u=S[M.style]);if(Array.isArray(u)){u=u.slice(0);const C=M.width??0;for(let K=0;K<u.length;++K)u[K]*=C;if("butt"!==M.cap){for(M=0;M<u.length;M+=2)u[M]-=C,1>u[M]&&(u[M]=1);for(M=1;M<u.length;M+=2)u[M]+=C}u=u.join(",")}J.dashArray=u}return J}function z(M,J){const u={align:null,
decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(M){const C=M.alignBaseline;u.align=M.align;u.dominantBaseline="baseline"===C?"auto":"top"===C?"text-top":"bottom"===C?"hanging":C;u.decoration=M.decoration;u.kerning=M.kerning?"auto":"0";u.rotate=M.rotated?"90":"0";w.assertIsSome(J);u.font.style=J.style||"normal";u.font.variant=J.variant||"normal";u.font.weight=J.weight||"normal";u.font.size=J.size&&J.size.toString()||"10pt";u.font.family=
J.family||"serif"}return u}function k(M){const {pattern:J,linearGradient:u}=M;return J?B.tsx("pattern",{id:J.id,patternUnits:"userSpaceOnUse",x:J.x,y:J.y,width:J.width,height:J.height},B.tsx("image",{x:J.image.x,y:J.image.y,width:J.image.width,height:J.image.height,href:J.image.href})):u?(M=u.stops.map((C,K)=>B.tsx("stop",{key:`${K}-stop`,offset:C.offset,"stop-color":C.color})),B.tsx("linearGradient",{id:u.id,gradientUnits:"userSpaceOnUse",x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2},M)):null}function E(M,J){if(!M)return null;
const u=[];for(const C of M){const {shape:K,fill:R,stroke:V,font:X}=C;M=h(R);const ba=n(V),ea="text"===K.type?z(K,X):null;(M=d(K,M.fill,ba,ea))&&u.push(M)}return B.tsx("mask",{id:J,maskUnits:"userSpaceOnUse"},B.tsx("g",null,u))}function v(M,J,u,C,K){L.scale(M,L.identity(M),[J,u]);M[4]=M[4]*J-C*J+C;M[5]=M[5]*u-K*u+K;return M}function y(M,J){if(I&&"left"in I){null!=I.left&&I.left>M&&(I.left=M);if(null==I.right||I.right<M)I.right=M;if(null==I.top||I.top>J)I.top=J;if(null==I.bottom||I.bottom<J)I.bottom=
J}else I={left:M,bottom:J,right:M,top:J}}function r(M){const J=M.args,u=J.length;switch(M.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(M=0;M<u;M+=2)y(J[M],J[M+1]);H.x=J[u-2];H.y=J[u-1];break;case "H":for(M=0;M<u;++M)y(J[M],H.y);H.x=J[u-1];break;case "V":for(M=0;M<u;++M)y(H.x,J[M]);H.y=J[u-1];break;case "m":M=0;"x"in H||(y(H.x=J[0],H.y=J[1]),M=2);for(;M<u;M+=2)y(H.x+=J[M],H.y+=J[M+1]);break;case "l":case "t":for(M=0;M<u;M+=2)y(H.x+=J[M],H.y+=J[M+1]);break;case "h":for(M=0;M<u;++M)y(H.x+=
J[M],H.y);break;case "v":for(M=0;M<u;++M)y(H.x,H.y+=J[M]);break;case "c":for(M=0;M<u;M+=6)y(H.x+J[M],H.y+J[M+1]),y(H.x+J[M+2],H.y+J[M+3]),y(H.x+=J[M+4],H.y+=J[M+5]);break;case "s":case "q":for(M=0;M<u;M+=4)y(H.x+J[M],H.y+J[M+1]),y(H.x+=J[M+2],H.y+=J[M+3]);break;case "A":for(M=0;M<u;M+=7)y(J[M+5],J[M+6]);H.x=J[u-2];H.y=J[u-1];break;case "a":for(M=0;M<u;M+=7)y(H.x+=J[M+5],H.y+=J[M+6])}}function Q(M,J,u){const C=P[M.toLowerCase()];"number"===typeof C&&(C?J.length>=C&&(M={action:M,args:J.slice(0,J.length-
J.length%C)},u.push(M),r(M)):(M={action:M,args:[]},u.push(M),r(M)))}function O(M){const J={x:0,y:0,width:0,height:0};if("circle"===M.type)J.x=M.cx-M.r,J.y=M.cy-M.r,J.width=2*M.r,J.height=2*M.r;else if("ellipse"===M.type)J.x=M.cx-M.rx,J.y=M.cy-M.ry,J.width=2*M.rx,J.height=2*M.ry;else if("image"===M.type||"rect"===M.type)J.x=M.x,J.y=M.y,J.width=M.width,J.height=M.height;else if("path"===M.type){var u=w.unwrapOrThrow;{const R=("string"!==typeof M.path?f(M.path):M.path).match(m),V=[];I={};H={};if(R){M=
"";var C=[],K=R.length;for(let X=0;X<K;++X){const ba=R[X],ea=parseFloat(ba);isNaN(ea)?(M&&Q(M,C,V),C=[],M=ba):C.push(ea)}Q(M,C,V);M={x:0,y:0,width:0,height:0};I&&"left"in I&&(M.x=I.left,M.y=I.top,M.width=I.right-I.left,M.height=I.bottom-I.top)}else M=null}u=u.call(w,M);J.x=u.x;J.y=u.y;J.width=u.width;J.height=u.height}return J}function A(M){const J={x:0,y:0,width:0,height:0};let u=null,C=Number.NEGATIVE_INFINITY,K=Number.NEGATIVE_INFINITY;for(const R of M)u?(u.x=Math.min(u.x,R.x),u.y=Math.min(u.y,
R.y),C=Math.max(C,R.x+R.width),K=Math.max(K,R.y+R.height)):(u=J,u.x=R.x,u.y=R.y,C=R.x+R.width,K=R.y+R.height);u&&(u.width=C-u.x,u.height=K-u.y);return u}function b(M,J,u,C,K,R,V,X,ba){var ea=(V&&R?t(R,J):J)/2,Y=(V&&R?t(R,u):u)/2;if(ba){var ca=ba[0];ba=ba[1];ea=(V&&R?t(R,ca):ca)/2;Y=(V&&R?t(R,ba):ba)/2}ca=M.width+C;var da=M.height+C;ba=x.create();V=x.create();var ja=!1;if(K&&0!==ca&&0!==da){K=J!==u?J/u:ca/da;ja=J>u?J:u;let pa=1,sa=1;isNaN(ja)||(1<K?(pa=ja/ca,sa=ja/K/da):(sa=ja/da,pa=ja*K/ca));L.multiply(V,
V,v(ba,pa,sa,ea,Y));ja=!0}K=M.x+(ca-C)/2;M=M.y+(da-C)/2;C=L.multiply;ea-=K;Y-=M;ea=L.translate(ba,L.identity(ba),[ea,Y]);C.call(L,V,V,ea);!ja&&(ca>J||da>u)&&(ea=ca/J>da/u,J=(ea?J:u)/(ea?ca:da),L.multiply(V,V,v(ba,J,J,K,M)));R&&(J=L.multiply,u=R%360*Math.PI/180,L.rotate(ba,L.identity(ba),u),R=Math.cos(u),u=Math.sin(u),ca=ba[4],da=ba[5],ba[4]=ca*R-da*u+M*u-K*R+K,ba[5]=da*R+ca*u-K*u-M*R+M,J.call(L,V,V,ba));X&&(R=L.multiply,J=X[0],X=X[1],X=L.translate(ba,L.identity(ba),[J,X]),R.call(L,V,V,X));return`matrix(${V[0]},${V[1]},${V[2]},${V[3]},${V[4]},${V[5]})`}
function c(M,J,u){M=M?.effects.find(X=>"bloom"===X.type);if(!M)return null;const {strength:C,radius:K}=M;M=0<C?K:0;const R=(C+M)*J,V=4*C+1;return B.tsx("filter",{id:`bloom${u}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},B.tsx("feMorphology",{operator:"dilate",radius:(C+.5*M)*5**(J/100)*(.4+J/100),in:"SourceGraphic",result:"dilate"}),B.tsx("feGaussianBlur",{in:"dilate",stdDeviation:R/25,result:"blur"}),B.tsx("feGaussianBlur",{in:"blur",stdDeviation:R/50,result:"intensityBlur"}),
B.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},B.tsx("feFuncR",{type:"linear",slope:V}),B.tsx("feFuncG",{type:"linear",slope:V}),B.tsx("feFuncB",{type:"linear",slope:V})),B.tsx("feMerge",null,B.tsx("feMergeNode",{in:"intensityBlur"}),B.tsx("feMergeNode",{in:"intensityBrightness"}),B.tsx("feGaussianBlur",{stdDeviation:C/10})))}let a=0,p=0;N=g("android");const D=g("chrome")||N&&4<=N?"auto":"optimizeLegibility",P={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},m=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;
let I={},H={};const S={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},F=Math.PI;let T=1;e.computeBBox=A;e.generateFillAttributes=h;e.generateStrokeAttributes=n;e.generateTextAttributes=z;e.getBoundingBox=O;e.getTransformMatrix=b;e.renderDef=k;e.renderSVG=function(M,J,u,C={}){const K=[],R=[],V=++T,X=c(C.effectView,J,V);var ba=null;X&&(ba=C.effectView?.effects.find(ja=>
"bloom"===ja.type),ba=(ba.strength?ba.strength+ba.radius/2:0)/3,ba=[Math.max(J+J*ba,10),Math.max(u+u*ba,10)]);for(let ja=0;ja<M.length;ja++){var ea=M[ja];const pa=[];var Y=[],ca=0,da=0;let sa=0;for(const xa of ea){const {shape:ya,fill:oa,stroke:za,font:Ga,offset:aa}=xa;C.ignoreStrokeWidth||(ca+=za&&za.width||0);ea=h(oa);const ha=n(za),ia="text"===ya.type?z(ya,Ga):null;K.push(k(ea));pa.push(d(ya,ea.fill,ha,ia));Y.push(O(ya));aa&&(da+=aa[0],sa+=aa[1])}Y=w.unwrapOrThrow(A(Y));ca=b(Y,J,u,ca,C.scale??
!1,C.rotation,C.useRotationSize??!1,[da,sa],ba);da=null;C.masking&&(da=`mask-${ja}`,K.push(E(C.masking[ja],da)),da=`url(#${da})`);R.push(da?B.tsx("g",{mask:da},B.tsx("g",{transform:ca},pa)):B.tsx("g",{transform:ca},pa))}C.useRotationSize&&C.rotation&&(J=t(C.rotation,J),u=t(C.rotation,u));X&&(w.assertIsSome(ba),J=ba[0],u=ba[1]);return B.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:J,height:u,style:"display: block;"},X,B.tsx("defs",null,K),X?B.tsx("g",{filter:`url(#bloom${V})`},R):R)};e.renderShape=
d;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(e){function l(){const t=new Float32Array(6);t[0]=1;t[3]=1;return t}function g(t){const f=new Float32Array(6);f[0]=t[0];f[1]=t[1];f[2]=t[2];f[3]=t[3];f[4]=t[4];f[5]=t[5];return f}function w(t,f,d,h,n,z){const k=new Float32Array(6);k[0]=t;k[1]=f;k[2]=d;k[3]=h;k[4]=n;k[5]=z;return k}function x(t,f){return new Float32Array(t,f,6)}function L(t,f,d,h){const n=f[h];f=f[h+1];t[h]=
d[0]*n+d[2]*f+d[4];t[h+1]=d[1]*n+d[3]*f+d[5]}function N(t,f,d,h=0,n=0,z=2){for(n=n||f.length/z;h<n;h++)L(t,f,d,h*z)}const B=Object.freeze(Object.defineProperty({__proto__:null,clone:g,create:l,createView:x,fromValues:w,transform:L,transformMany:N},Symbol.toStringTag,{value:"Module"}));e.clone=g;e.create=l;e.createView=x;e.fromValues=w;e.mat2df32=B;e.transform=L;e.transformMany=N})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(e,l){function g(c,a){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];return c}function w(c){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=0;c[5]=0;return c}function x(c,a,p,D,P,m,I){c[0]=a;c[1]=p;c[2]=D;c[3]=P;c[4]=m;c[5]=I;return c}function L(c,a){const p=a[0],D=a[1],P=a[2],m=a[3],I=a[4];a=a[5];let H=p*m-D*P;if(!H)return null;H=1/H;c[0]=m*H;c[1]=-D*H;c[2]=-P*H;c[3]=p*H;c[4]=(P*a-m*I)*H;c[5]=(D*I-p*a)*H;return c}function N(c){return c[0]*c[3]-c[1]*c[2]}function B(c,a,p){const D=a[0],P=a[1],m=a[2],I=a[3],H=a[4];a=a[5];const S=p[0],F=p[1],T=p[2],
M=p[3],J=p[4];p=p[5];c[0]=D*S+m*F;c[1]=P*S+I*F;c[2]=D*T+m*M;c[3]=P*T+I*M;c[4]=D*J+m*p+H;c[5]=P*J+I*p+a;return c}function t(c,a,p){const D=a[0],P=a[1],m=a[2],I=a[3],H=a[4];a=a[5];const S=Math.sin(p);p=Math.cos(p);c[0]=D*p+m*S;c[1]=P*p+I*S;c[2]=D*-S+m*p;c[3]=P*-S+I*p;c[4]=H;c[5]=a;return c}function f(c,a,p){const D=a[1],P=a[2],m=a[3],I=a[4],H=a[5],S=p[0];p=p[1];c[0]=a[0]*S;c[1]=D*S;c[2]=P*p;c[3]=m*p;c[4]=I;c[5]=H;return c}function d(c,a,p){const D=a[0],P=a[1],m=a[2],I=a[3],H=a[4];a=a[5];const S=p[0];
p=p[1];c[0]=D;c[1]=P;c[2]=m;c[3]=I;c[4]=D*S+m*p+H;c[5]=P*S+I*p+a;return c}function h(c,a){const p=Math.sin(a);a=Math.cos(a);c[0]=a;c[1]=p;c[2]=-p;c[3]=a;c[4]=0;c[5]=0;return c}function n(c,a){c[0]=a[0];c[1]=0;c[2]=0;c[3]=a[1];c[4]=0;c[5]=0;return c}function z(c,a){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=a[0];c[5]=a[1];return c}function k(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"}function E(c){return Math.sqrt(c[0]**2+c[1]**2+c[2]**2+c[3]**2+c[4]**2+c[5]**2+1)}function v(c,
a,p){c[0]=a[0]+p[0];c[1]=a[1]+p[1];c[2]=a[2]+p[2];c[3]=a[3]+p[3];c[4]=a[4]+p[4];c[5]=a[5]+p[5];return c}function y(c,a,p){c[0]=a[0]-p[0];c[1]=a[1]-p[1];c[2]=a[2]-p[2];c[3]=a[3]-p[3];c[4]=a[4]-p[4];c[5]=a[5]-p[5];return c}function r(c,a,p){c[0]=a[0]*p;c[1]=a[1]*p;c[2]=a[2]*p;c[3]=a[3]*p;c[4]=a[4]*p;c[5]=a[5]*p;return c}function Q(c,a,p,D){c[0]=a[0]+p[0]*D;c[1]=a[1]+p[1]*D;c[2]=a[2]+p[2]*D;c[3]=a[3]+p[3]*D;c[4]=a[4]+p[4]*D;c[5]=a[5]+p[5]*D;return c}function O(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===
a[2]&&c[3]===a[3]&&c[4]===a[4]&&c[5]===a[5]}function A(c,a){const p=c[0],D=c[1],P=c[2],m=c[3],I=c[4];c=c[5];const H=a[0],S=a[1],F=a[2],T=a[3],M=a[4];a=a[5];const J=l.getEpsilon();return Math.abs(p-H)<=J*Math.max(1,Math.abs(p),Math.abs(H))&&Math.abs(D-S)<=J*Math.max(1,Math.abs(D),Math.abs(S))&&Math.abs(P-F)<=J*Math.max(1,Math.abs(P),Math.abs(F))&&Math.abs(m-T)<=J*Math.max(1,Math.abs(m),Math.abs(T))&&Math.abs(I-M)<=J*Math.max(1,Math.abs(I),Math.abs(M))&&Math.abs(c-a)<=J*Math.max(1,Math.abs(c),Math.abs(a))}
const b=Object.freeze(Object.defineProperty({__proto__:null,add:v,copy:g,determinant:N,equals:A,exactEquals:O,frob:E,fromRotation:h,fromScaling:n,fromTranslation:z,identity:w,invert:L,mul:B,multiply:B,multiplyScalar:r,multiplyScalarAndAdd:Q,rotate:t,scale:f,set:x,str:k,sub:y,subtract:y,translate:d},Symbol.toStringTag,{value:"Module"}));e.add=v;e.copy=g;e.determinant=N;e.equals=A;e.exactEquals=O;e.frob=E;e.fromRotation=h;e.fromScaling=n;e.fromTranslation=z;e.identity=w;e.invert=L;e.mat2d=b;e.mul=B;
e.multiply=B;e.multiplyScalar=r;e.multiplyScalarAndAdd=Q;e.rotate=t;e.scale=f;e.set=x;e.str=k;e.sub=y;e.subtract=y;e.translate=d})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(e,l,g,w,x,L,N,B,t,f,d,h){function n(c){c=c.symbolLayers;if(!c)return null;let a=null;c.forEach(p=>{if("object"!==
p.type||null==p.resource?.href)a="water"===p.type?N.unwrap(p.color):N.isSome(p.material)?N.unwrap(p.material.color):null});return a?new g(a):null}function z(c,a){if(null==a||null==c)return c;c=c.toRgba();c[3]*=a;return new g(c)}function k(c,a,p){if(c=c.symbolLayers){var D=P=>{P=N.isSome(P)?P:null;a=a??P??(null!=p?b:null);return z(a,p)};c.forEach(P=>{if("object"!==P.type||null==P.resource?.href||a)if("water"===P.type)P.color=D(P.color);else{var m=N.isSome(P.material)?P.material.color:null;m=D(m);N.isNone(P.material)?
P.material=new h.Symbol3DMaterial({color:m}):P.material.color=m;null!=p&&"outline"in P&&N.isSome(P.outline)&&N.isSome(P.outline.color)&&(P.outline.color=z(P.outline.color,p))}})}}async function E(c,a){(c=c.symbolLayers)&&await x.forEach(c,async p=>v(p,a))}async function v(c,a){switch(c.type){case "extrude":c.size="number"===typeof a[2]?a[2]:0;break;case "icon":case "line":case "text":a=y(a);N.isSome(a)&&(c.size=a);break;case "path":const p=Q(a,t.ONES,[c.width,void 0,c.height]);c.width=A(a[0],c.width,
1,p);c.height=A(a[2],c.height,1,p);break;case "object":await r(c,a)}}function y(c){for(const a of c)if("number"===typeof a)return a;return null}async function r(c,a){const {resourceSize:p,symbolSize:D}=await O(c),P=Q(a,p,D);c.width=A(a[0],D[0],p[0],P);c.depth=A(a[1],D[1],p[1],P);c.height=A(a[2],D[2],p[2],P)}function Q(c,a,p){for(let D=0;3>D;D++){const P=c[D];switch(P){case "symbol-value":return c=p[D],null!=c?c/a[D]:1;case "proportional":break;default:if(P&&a[D])return P/a[D]}}return 1}async function O(c){const a=
await (await new Promise((H,S)=>e(["./symbolLayerUtils"],H,S))).computeObjectLayerResourceSize(c,10),{width:p,height:D,depth:P}=c;c=[p,P,D];let m=1;for(var I=0;3>I;I++){const H=c[I];if(null!=H){m=H/a[I];break}}for(I=0;3>I;I++)null==c[I]&&(c[I]=a[I]*m);return{resourceSize:a,symbolSize:c}}function A(c,a,p,D){switch(c){case "proportional":return p*D;case "symbol-value":return null!=a?a:p;default:return c}}const b=new g("white");l.applyColorToSymbol=function(c,a,p){if(c&&(a||null!=p))if(a&&(a=new g(a)),
w.isSymbol3D(c))k(c,a,p);else if(w.isSymbol2D(c)){if(a=a??c.color)c.color=z(a,p);null!=p&&"outline"in c&&c.outline&&c.outline.color&&(c.outline.color=z(c.outline.color,p))}};l.applyOpacityToColor=z;l.applyRotationToSymbol=function(c,a,p){c&&null!=a&&(w.isSymbol3D(c)?(c=c.symbolLayers)&&c.forEach(D=>{if(D&&"object"===D.type)switch(p){case "tilt":D.tilt=a;break;case "roll":D.roll=a;break;default:D.heading=a}}):!w.isSymbol2D(c)||"simple-marker"!==c.type&&"picture-marker"!==c.type&&"text"!==c.type||(c.angle=
a))};l.applySizesToSymbol=async function(c,a){if(c&&a){if(w.isSymbol3D(c))return E(c,a);if(w.isSymbol2D(c)&&(a=y(a),!N.isNone(a)))switch(c.type){case "simple-marker":c.size=a;break;case "picture-marker":const p=c.width/c.height;1<p?(c.width=a,c.height=a*p):(c.width=a*p,c.height=a);break;case "simple-line":c.width=a;break;case "text":c.font.size=a}}};l.fetchWebStyleSymbol=async function(c,a){const p=await c.fetchSymbol(a);return p?p:c.fetchCIMSymbol(a)};l.getCSSFilterFromEffectList=function(c){if(!c)return null;
c=c.effects.filter(a=>"bloom"!==a.type).map(a=>a.toJSON());return f.effectFunctionsFromJSON(c)};l.getColorFromSymbol=function(c,a){if(!c)return null;let p=null;w.isSymbol3D(c)?p=n(c):w.isSymbol2D(c)&&(p=c.color?new g(c.color):null);return p?z(p,a):null};l.getIconHref=function(c){return N.unwrapOrThrow(c.resource).href};l.getSymbolOutlineSize=function(c){if(!c)return 0;if(w.isSymbol3D(c)){{const a=c.symbolLayers&&c.symbolLayers.length;a?(c=c.symbolLayers.getItemAt(a-1),c="outline"in c?N.get(c,"outline",
"size"):void 0):c=void 0}return N.isSome(c)?c:0}return B.px2pt(d.getStroke(c)?.width)};l.isVolumetricSymbol=function(c){if(N.isNone(c)||!("symbolLayers"in c)||N.isNone(c.symbolLayers))return!1;switch(c.type){case "point-3d":return c.symbolLayers.some(a=>"object"===a.type);case "line-3d":return c.symbolLayers.some(a=>"path"===a.type);case "polygon-3d":return c.symbolLayers.some(a=>"object"===a.type||"extrude"===a.type);default:return!1}};l.symbolHasExtrudeSymbolLayer=function(c){return N.isSome(c)&&
"polygon-3d"===c.type&&c.symbolLayers.some(a=>"extrude"===a.type)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(e,l,g,w,x){function L(t,f,d){const h=`${d}_arrowStart`;d=`${d}_arrowEnd`;t="left"===t;const n={markerStart:null,markerEnd:null};switch(f){case "HL":t?
n.markerStart=`url(#${d})`:n.markerEnd=`url(#${h})`;break;case "LL":n.markerStart=`url(#${d})`;break;case "LH":t?n.markerEnd=`url(#${h})`:n.markerStart=`url(#${d})`;break;default:n.markerEnd=`url(#${h})`}return n}function N(t,f,d,h,n=60){const {focus:z,numClasses:k,colors:E,rotation:v}=t;t=!!z;const y=Math.sqrt(n**2+n**2)+(t?0:5),r=[],Q=[];var O=[],A=(n||75)/k;for(var b=0;b<k;b++){var c=b*A;for(var a=0;a<k;a++){var p=a*A,D=l.generateFillAttributes(E[b][a]);const P=l.generateStrokeAttributes(null);
p={type:"rect",x:p,y:c,width:A,height:A};const m=l.renderDef(D);m&&r.push(m);(D=l.renderShape(p,D.fill,P,null))&&Q.push(D);O.push(l.getBoundingBox(p))}}A=null;t||(A="margin: -15px -15px -18px -15px");b=L("left",z,f);c=L("right",z,f);a=l.computeBBox(O);O=l.getTransformMatrix(a,y,y,0,!1,v,!1);a=l.getTransformMatrix(a,y,y,0,!1,t?-45:null,!1);d={filter:g.getCSSFilterFromEffectList(h)??void 0,opacity:null==d?"":`${d}`};return x.tsx("div",{styles:d,class:t?B.diamondMidColRamp:B.squareTableCell},x.tsx("svg",
{xmlns:"http://www.w3.org/2000/svg",width:y,height:y,style:A},x.tsx("defs",null,x.tsx("marker",{id:`${f}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},x.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),x.tsx("marker",{id:`${f}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},x.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),
r),x.tsx("g",{transform:O},Q),x.tsx("g",{transform:a},x.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":b.markerStart,"marker-end":b.markerEnd,x1:-10,y1:n-15,x2:-10,y2:15}),x.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":c.markerStart,"marker-end":c.markerEnd,x1:15,y1:n+10,x2:n-15,y2:n+10}))))}const B={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",
diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",
squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};e.renderRelationshipRamp=function(t,f,d,h){const {focus:n,labels:z}=t,k=!!n;t=N(t,f,d,h);f={justifyContent:"center"};d=w.isRTL();return k?x.tsx("div",{class:B.diamondContainer,styles:f},x.tsx("div",{class:B.diamondLeftCol},d?z.right:z.left),x.tsx("div",
{class:B.diamondMidCol},x.tsx("div",{class:B.diamondMidColLabel},z.top),t,x.tsx("div",{class:B.diamondMidColLabel},z.bottom)),x.tsx("div",{class:B.diamondRightCol},d?z.left:z.right)):x.tsx("div",{class:B.squareTable},x.tsx("div",{class:B.squareTableRow},x.tsx("div",{class:w.classes(B.squareTableCell,B.squareTableLabel,B.squareTableLabelRightBottom)},d?z.top:z.left),x.tsx("div",{class:B.squareTableCell}),x.tsx("div",{class:w.classes(B.squareTableCell,B.squareTableLabel,B.squareTableLabelLeftBottom)},
d?z.left:z.top)),x.tsx("div",{class:B.squareTableRow},x.tsx("div",{class:B.squareTableCell}),t,x.tsx("div",{class:B.squareTableCell})),x.tsx("div",{class:B.squareTableRow},x.tsx("div",{class:w.classes(B.squareTableCell,B.squareTableLabel,B.squareTableLabelRightTop)},d?z.right:z.bottom),x.tsx("div",{class:B.squareTableCell}),x.tsx("div",{class:w.classes(B.squareTableCell,B.squareTableLabel,B.squareTableLabelLeftTop)},d?z.bottom:z.right)))};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(e,l,g,w){function x(f){if(f){var {type:d}=f;return d.includes("3d")?w.getSymbolLayerFill(f.symbolLayers.getItemAt(0)):"simple-line"===d||"simple-marker"===f.type&&("x"===f.style||"cross"===f.style)?(f=g.getStroke(f))&&f.color:g.getFill(f)}}function L(f,d){const h=d.HH.label,n=d.LL.label,z=d.HL.label;d=d.LH.label;
switch(f){case "HH":return{top:h,bottom:n,left:z,right:d};case "HL":return{top:z,bottom:d,left:n,right:h};case "LL":return{top:n,bottom:h,left:d,right:z};case "LH":return{top:d,bottom:z,left:h,right:n};default:return{top:h,bottom:n,left:z,right:d}}}function N(f){let d=B[f];f&&null==d&&(d=B.HH);return d||0}const B={HH:315,HL:45,LL:135,LH:225},t={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2",
"M1H"],["LL","LM1","LM2","LH"]]};e.getRelationshipRampColors2D=function(f,d){const h=[],n=f.length**.5;f=l.clone(f);var z=(d||"HH").split("");d=z[0];for(z="H"===z[1];f.length;){const k=[];for(;k.length<n;)k.push(f.shift());z&&k.reverse();h.push(k)}"L"===d&&h.reverse();return h};e.getRelationshipRampElement=function(f){const {focus:d,infos:h,numClasses:n}=f;var z=t[n];const k={};h.forEach(E=>{k[E.value]={label:E.label,fill:x(E.symbol)}});f=[];for(let E=0;E<n;E++){const v=[];for(let y=0;y<n;y++)v.push(k[z[E][y]].fill);
f.push(v)}z=L(d,k);return{type:"relationship-ramp",numClasses:n,focus:d,colors:f,labels:z,rotation:N(d)}};e.getRotationAngleForFocus=N;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E){function v(C){const K=C.outline;var R=N.isSome(C.material)?C.material.color:null;R=N.isSome(R)?R.toHex():null;if(N.isNone(K)||"pattern"in K&&N.isSome(K.pattern)&&"style"===K.pattern.type&&"none"===K.pattern.style)return"fill"===C.type&&"#ffffff"===R?{color:"#bdc3c7",width:.75}:null;C=t.pt2px(K.size)||0;return{color:"rgba("+(N.isSome(K.color)?K.color.toRgba():"255,255,255,1")+")",width:Math.min(C,M),style:"pattern"in K&&N.isSome(K.pattern)&&"style"===K.pattern.type?
f.dekebabifyLineStyle(K.pattern.style):null,join:"butt",cap:"patternCap"in K?K.patternCap:"butt"}}function y(C,K){var R=K&&K.resource;R=R&&R.href;if(C.thumbnail&&C.thumbnail.url)return Promise.resolve(C.thumbnail.url);if(R&&"object"!==K.type)return Promise.resolve(k.getIconHref(K));const V=l.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return C.styleOrigin&&(C.styleOrigin.styleName||C.styleOrigin.styleUrl)?E.resolveWebStyleSymbol(C.styleOrigin,{portal:C.styleOrigin.portal},"webRef").catch(X=>
X).then(X=>X?.thumbnail?.url||V):Promise.resolve(V)}function r(C,K=1){const R=C.a;C=g.toHSV(C);const {r:V,g:X,b:ba}=g.toRGB({h:C.h,s:C.s/K,v:100-(100-C.v)/K});return[V,X,ba,R]}function Q(C){return"water"===C.type?N.isNone(C.color)?null:C.color:N.isNone(C.material)||N.isNone(C.material.color)?null:C.material.color}function O(C,K=0){var R=Q(C);if(!R){if("fill"===C.type)return null;K=n.adjustColorComponentBrightness(f.defaultThematicColor.r,K);return[K,K,K,100]}C=R.toRgba();for(R=0;3>R;R++)C[R]=n.adjustColorComponentBrightness(C[R],
K);return C}async function A(C,K){C=C.style;return"none"===C?null:{type:"pattern",x:0,y:0,src:await f.getPatternUrlWithColor(l.getAssetUrl(`esri/symbols/patterns/${C}.png`),K.toCss(!0)),width:5,height:5}}function b(C){return C.outline?v(C):{color:"rgba(0, 0, 0, 1)",width:1.5}}function c(C,K){C=Q(C);if(!C)return null;let R;R="rgba("+(n.adjustColorComponentBrightness(C.r,K)+",");R+=n.adjustColorComponentBrightness(C.g,K)+",";R+=n.adjustColorComponentBrightness(C.b,K)+",";return R+C.a+");"}function a(C,
K){K=c(C,K);if(!K)return{};if("pattern"in C&&N.isSome(C.pattern)&&"style"===C.pattern.type&&"none"===C.pattern.style)return null;const R=Math.min(C.size?t.pt2px(C.size):.75,M);return{color:K,width:R,style:"pattern"in C&&N.isSome(C.pattern)&&"style"===C.pattern.type?f.dekebabifyLineStyle(C.pattern.style):null,cap:"cap"in C?C.cap:null,join:"join"in C?"miter"===C.join?t.pt2px(2):C.join:null}}function p(C,K,R){R=null!=R?.75*R:0;return{type:"linear",x1:R?.25*R:0,y1:R?.5*R:0,x2:R||4,y2:R?.5*R:4,colors:[{color:C,
offset:0},{color:K,offset:1}]}}function D(C){const K=C.depth,R=C.height;C=C.width;return 0!==C&&0!==K&&0!==R&&C===K&&null!=C&&null!=R&&C<R}function P(C,K,R){const V=[];if(!C)return V;switch(C.type){case "icon":switch(C.resource&&C.resource.primitive||d.defaultPrimitive){case "circle":V.push({shape:{type:"circle",cx:0,cy:0,r:.5*K},fill:O(C,0),stroke:v(C)});break;case "square":V.push({shape:{type:"path",path:[{command:"M",values:[0,K]},{command:"L",values:[0,0]},{command:"L",values:[K,0]},{command:"L",
values:[K,K]},{command:"Z",values:[]}]},fill:O(C,0),stroke:v(C)});break;case "triangle":V.push({shape:{type:"path",path:[{command:"M",values:[0,K]},{command:"L",values:[.5*K,0]},{command:"L",values:[K,K]},{command:"Z",values:[]}]},fill:O(C,0),stroke:v(C)});break;case "cross":V.push({shape:{type:"path",path:[{command:"M",values:[.5*K,0]},{command:"L",values:[.5*K,K]},{command:"M",values:[0,.5*K]},{command:"L",values:[K,.5*K]}]},stroke:b(C)});break;case "x":V.push({shape:{type:"path",path:[{command:"M",
values:[0,0]},{command:"L",values:[K,K]},{command:"M",values:[K,0]},{command:"L",values:[0,K]}]},stroke:b(C)});break;case "kite":V.push({shape:{type:"path",path:[{command:"M",values:[0,.5*K]},{command:"L",values:[.5*K,0]},{command:"L",values:[K,.5*K]},{command:"L",values:[.5*K,K]},{command:"Z",values:[]}]},fill:O(C,0),stroke:v(C)})}break;case "object":switch(C.resource&&C.resource.primitive||h.defaultPrimitive){case "cone":var X=O(C,0);C=O(C,-.6);C=p(X,C,R?u:K);K=n.getConeShapes(K,R);V.push({shape:K[0],
fill:C});V.push({shape:K[1],fill:C});break;case "inverted-cone":R=O(C,0);C=O(C,-.6);C=p(R,C,K);K=n.getInvertedConeShapes(K);V.push({shape:K[0],fill:C});V.push({shape:K[1],fill:R});break;case "cube":K=n.getCubeShapes(K,R);V.push({shape:K[0],fill:O(C,0)});V.push({shape:K[1],fill:O(C,-.3)});V.push({shape:K[2],fill:O(C,-.5)});break;case "cylinder":X=O(C,0);const ba=O(C,-.6);X=p(X,ba,R?u:K);K=n.getCylinderShapes(K,R);V.push({shape:K[0],fill:X});V.push({shape:K[1],fill:X});V.push({shape:K[2],fill:O(C,0)});
break;case "diamond":K=n.getDiamondShapes(K);V.push({shape:K[0],fill:O(C,-.3)});V.push({shape:K[1],fill:O(C,0)});V.push({shape:K[2],fill:O(C,-.3)});V.push({shape:K[3],fill:O(C,-.7)});break;case "sphere":R=O(C,0);C=O(C,-.6);C=p(R,C);C.x1=0;C.y1=0;C.x2=.25*K;C.y2=.25*K;V.push({shape:{type:"circle",cx:0,cy:0,r:.5*K},fill:C});break;case "tetrahedron":K=n.getTetrahedronShapes(K),V.push({shape:K[0],fill:O(C,-.3)}),V.push({shape:K[1],fill:O(C,0)}),V.push({shape:K[2],fill:O(C,-.6)})}}return V}function m(C){return(C=
"number"===typeof C?.size?C?.size:null)?t.pt2px(C):null}function I(C,K){const R=m(K),V=K?.maxSize?t.pt2px(K.maxSize):null,X=K?.disableUpsampling??!1,ba=C.symbolLayers,ea=[];let Y=0,ca=0;const da=ba.getItemAt(ba.length-1);let ja;da&&"icon"===da.type&&(ja=da.size&&t.pt2px(da.size));ba.forEach(pa=>{if("icon"===pa.type||"object"===pa.type){var sa="icon"===pa.type?pa.size&&t.pt2px(pa.size):0,xa=R||sa?Math.ceil(Math.min(R||sa,V||T)):F;if(pa&&pa.resource&&pa.resource.href){var ya=y(C,pa).then(oa=>{const za=
pa.get("material.color");var Ga="icon"===pa.type?"multiply":"tint";return z.tintImageWithColor(oa,xa,za,Ga,X)}).then(oa=>{const za=oa.width,Ga=oa.height;Y=Math.max(Y,za);ca=Math.max(ca,Ga);return[{shape:{type:"image",x:0,y:0,width:za,height:Ga,src:oa.url},fill:null,stroke:null}]});ea.push(ya)}else ya=xa,"icon"===pa.type&&ja&&R&&(ya=sa/ja*xa),sa="tall"===K?.symbolConfig||K?.symbolConfig?.isTall||("object"===pa.type?D(pa):!1),Y=Math.max(Y,sa?u:ya),ca=Math.max(ca,ya),ea.push(Promise.resolve(P(pa,ya,
sa)))}});return B.eachAlways(ea).then(pa=>{const sa=[];pa.forEach(xa=>{xa.value?sa.push(xa.value):xa.error&&L.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",xa.error)});return z.renderSymbol(sa,[Y,ca],{node:K&&K.node,scale:!1,opacity:K&&K.opacity})})}function H(C,K){const R=C.symbolLayers,V=[];C=k.isVolumetricSymbol(C);const X=m(K),ba=(K&&K.maxSize?t.pt2px(K.maxSize):null)||M;let ea=0,Y=0,ca;R.forEach((da,ja)=>{if(da&&("line"===da.type||"path"===da.type)){var pa=
[];switch(da.type){case "line":var sa=a(da,0);if(N.isNone(sa))break;var xa=sa&&sa.width||0;0===ja&&(ca=xa);da=Math.min(X||xa,ba);ja=0===ja?da:X?xa/ca*da:da;xa=ja>J/2?2*ja:J;Y=Math.max(Y,ja);ea=Math.max(ea,xa);sa.width=ja;pa.push({shape:{type:"path",path:[{command:"M",values:[0,.5*Y]},{command:"L",values:[ea,.5*Y]}]},stroke:sa});break;case "path":sa=Math.min(X||F,ba);ja=O(da,0);xa=O(da,-.2);var ya=c(da,-.4);ya=ya?{color:ya,width:1}:{};if("quad"===da.profile){const oa=da.width;da=da.height;da=n.getPathSymbolShapes(oa&&
da?oa/da:1,0===da,0===oa);ya={...ya,join:"bevel"};pa.push({shape:da[0],fill:xa,stroke:ya});pa.push({shape:da[1],fill:xa,stroke:ya});pa.push({shape:da[2],fill:ja,stroke:ya})}else pa.push({shape:n.shapes.pathSymbol3DLayer[0],fill:xa,stroke:ya}),pa.push({shape:n.shapes.pathSymbol3DLayer[1],fill:ja,stroke:ya});ea=Y=Math.max(Y,sa)}V.push(pa)}});return Promise.resolve(z.renderSymbol(V,[ea,Y],{node:K&&K.node,scale:C,opacity:K&&K.opacity}))}async function S(C,K){const R="mesh-3d"===C.type;C=C.symbolLayers;
var V=m(K);const X=K&&K.maxSize?t.pt2px(K.maxSize):null;V=V||F;const ba=[];let ea=0,Y=0;var ca=!1;for(let ya=0;ya<C.length;ya++){var da=C.getItemAt(ya);const oa=[];if(!R||"fill"===da.type){var ja=n.shapes.fill[0];switch(da.type){case "fill":var pa=v(da);ca=Math.min(V,X||T);ea=Math.max(ea,ca);Y=Math.max(Y,ca);ca=!0;var sa=O(da,0),xa="pattern"in da?da.pattern:null;da=Q(da);!R&&N.isSome(xa)&&"style"===xa.type&&"solid"!==xa.style&&da&&(sa=await A(xa,da));oa.push({shape:ja,fill:sa,stroke:pa});break;case "line":da=
a(da,0);if(N.isNone(da))break;da={stroke:da,shape:ja};ea=Math.max(ea,F);Y=Math.max(Y,F);oa.push(da);break;case "extrude":ja={join:"round",width:1,...a(da,-.4)};pa=O(da,0);da=O(da,-.2);sa=Math.min(V,X||T);xa=n.getExtrudeSymbolShapes(sa);ja.width=1;oa.push({shape:xa[0],fill:da,stroke:ja});oa.push({shape:xa[1],fill:da,stroke:ja});oa.push({shape:xa[2],fill:pa,stroke:ja});da=.7*F+.5*sa;ea=Math.max(ea,F);Y=Math.max(Y,da);break;case "water":ca=N.unwrapOrThrow(Q(da)),da=r(ca),ja=r(ca,2),pa=r(ca,3),sa=n.getWaterSymbolShapes(),
ca=!0,oa.push({shape:sa[0],fill:da}),oa.push({shape:sa[1],fill:ja}),oa.push({shape:sa[2],fill:pa}),da=Math.min(V,X||T),ea=Math.max(ea,da),Y=Math.max(Y,da)}ba.push(oa)}}return z.renderSymbol(ba,[ea,Y],{node:K&&K.node,scale:ca,opacity:K&&K.opacity})}const F=n.SymbolSizeDefaults.size,T=n.SymbolSizeDefaults.maxSize,M=n.SymbolSizeDefaults.maxOutlineSize,J=n.SymbolSizeDefaults.lineWidth,u=n.SymbolSizeDefaults.tallSymbolWidth;e.getPatternDescriptor=A;e.getSizeFromOptions=m;e.getSymbolLayerFill=O;e.previewSymbol3D=
function(C,K){if(0===C.symbolLayers.length)return Promise.reject(new x("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(C.type){case "point-3d":return I(C,K);case "line-3d":return H(C,K);case "polygon-3d":case "mesh-3d":return S(C,K)}return Promise.reject(new x("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h){function n(k,E,v,y,r){var Q=k.data;const O=v&&x.isSome(v.portal)?v.portal:N.getDefault(),A={portal:O,url:L.urlToObject(k.baseUrl),origin:"portal-item"};Q=Q.items.find(D=>D.name===E);if(!Q)return Promise.reject(new w("symbolstyleutils:symbol-name-not-found",`The symbol name '${E}' could not be found`,{symbolName:E}));let b=B.fromJSON(d.symbolUrlFromStyleItem(Q,y),A),c=Q.thumbnail?.href??null;const a=Q.thumbnail&&Q.thumbnail.imageData;g.isDevEnvironment()&&(b=g.adjustStaticAGOUrl(b)??
"",c=g.adjustStaticAGOUrl(c));const p={portal:O,url:L.urlToObject(L.removeFile(b)),origin:"portal-item"};return d.requestJSON(b,r).then(D=>{D="cimRef"===y?d.makeCIMSymbolRef(D.data):D.data;if((D=t.fromJSON(D,p))&&l.isSymbol3D(D)){if(c){const P=B.fromJSON(c,A);D.thumbnail=new h.Thumbnail({url:P})}else a&&(D.thumbnail=new h.Thumbnail({url:`data:image/png;base64,${a}`}));k.styleUrl?D.styleOrigin=new f({portal:v.portal,styleUrl:k.styleUrl,name:E}):k.styleName&&(D.styleOrigin=new f({portal:v.portal,styleName:k.styleName,
name:E}))}return D})}function z(k,E,v){const y=d.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,k),r=x.isSome(E.portal)?E.portal:N.getDefault();return d.requestJSON(y,v).then(Q=>{Q=d.makeCIMSymbolRef(Q.data);return t.fromJSON(Q,{portal:r,url:L.urlToObject(L.removeFile(y)),origin:"portal-item"})})}e.fetchSymbolFromStyle=n;e.resolveWebStyleSymbol=function(k,E,v,y){const r=k.name;return x.isNone(r)?Promise.reject(new w("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
k.styleName&&"Esri2DPointSymbolsStyle"===k.styleName?z(r,E,y):d.fetchStyle(k,E,y).then(Q=>n(x.unwrapOrThrow(Q),r,E,v,y))};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(e){const l=/^devext.arcgis.com$/,g=/^qaext.arcgis.com$/,w=/^[\w-]*\.mapsdevext.arcgis.com$/,x=/^[\w-]*\.mapsqa.arcgis.com$/,L=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,l,g,/^jsapps.esri.com$/,w,x];e.adjustStaticAGOUrl=function(N,B){return N?
(B=B||globalThis.location.hostname)?null!=B.match(l)||null!=B.match(w)?N.replace("static.arcgis.com","staticdev.arcgis.com"):null!=B.match(g)||null!=B.match(x)?N.replace("static.arcgis.com","staticqa.arcgis.com"):N:N:N};e.isDevEnvironment=function(N){N=N||globalThis.location.hostname;return L.some(B=>null!=N?.match(B))};e.isTelemetryDevEnvironment=function(N){N=N||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(L).some(B=>null!=N?.match(B))};Object.defineProperty(e,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(e,l,g,w,x,L,N,B,t){g=function(f){function d(n){n=h.call(this,n);n.items=null;n.label=null;return n}e._inherits(d,f);
var h=e._createSuper(d);d.prototype.findByTemplate=function(n){return this.items.find(z=>z.template===n)};e._createClass(d,[{key:"id",get:function(){return this.label}}]);return d}(w.IdentifiableMixin(g));l.__decorate([x.property()],g.prototype,"items",void 0);l.__decorate([x.property()],g.prototype,"label",void 0);l.__decorate([x.property()],g.prototype,"id",null);return g=l.__decorate([t.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],g)})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["exports",
"../support/Heading","../support/widgetUtils","../support/jsxFactory"],function(e,l,g,w){function x(d){const {headingLevel:h,identify:n,items:z,renderIcon:k,filterText:E,onItemMouseLeave:v,onItemMouseEnter:y,onItemSelect:r,selectedItem:Q}=d,O=d.enableListScroll?f.scroller:void 0;return 0===z.length?w.tsx("div",{class:f.noMatchesMessage,key:"no-matches"},d.messages.noMatches):w.tsx("div",{class:O,key:"item-container"},z.map(A=>A.items?t({group:A,filterText:E,headingLevel:h,identify:n,onItemMouseLeave:v,
onItemMouseEnter:y,onItemSelect:r,renderIcon:k,selectedItem:Q}):N({item:A,identify:n,grouped:!0,onItemMouseLeave:v,onItemMouseEnter:y,onItemSelect:r,renderIcon:k,filterText:E,selectedItem:Q})))}function L(d){const {messages:h,filterText:n,enableListScroll:z}=d;return w.tsx("div",{key:"filter",class:z?void 0:f.filterContainerSticky},w.tsx("calcite-input",{onCalciteInputInput:k=>{k=k.currentTarget;d.onFilterChange&&d.onFilterChange(k.value)},placeholder:h.filterPlaceholder,value:n,type:"search"}))}
function N({grouped:d,identify:h,item:n,onItemMouseEnter:z,onItemMouseLeave:k,onItemSelect:E,renderIcon:v,selectedItem:y}){const r=n?`${h?.(n)||n.id}__${n.label}`:"";h=y?`${h?.(y)||y.id}__${y.label}`:"";h=r===h;return w.tsx("calcite-list-item",{"aria-level":d?"2":"",class:g.classes(f.item,h?f.itemSelected:""),"data-item":n,key:r,label:n.label??void 0,selected:h,tabIndex:0,onCalciteListItemSelect:Q=>E?.(B(Q)),onmouseenter:Q=>z?.(B(Q)),onkeydown:Q=>g.isActivationKey(Q.key)&&E?.(B(Q)),onmouseleave:Q=>
k?.(B(Q))},w.tsx("div",{class:f.itemIcon,slot:"content-start"},v?.({item:n})))}function B(d){return d.currentTarget["data-item"]}function t(d){const {group:h,headingLevel:n=4,...z}=d;return w.tsx("div",{class:f.group,key:h.label??void 0},w.tsx(l.Heading,{level:n,class:f.groupHeader},h.label),h.items.map(k=>N({...z,item:k,grouped:!0})))}const f={base:"esri-item-list",list:"esri-item-list__list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",groupHeader:"esri-item-list__group__header",
item:"esri-item-list__list-item",itemSelected:"esri-item-list__list-item--selected",itemContainer:"esri-item-list__list-item-container",itemLabel:"esri-item-list__list-item-label",itemIcon:"esri-item-list__list-item-icon",noMatchesMessage:"esri-item-list__no-matches-message",noItemsMessage:"esri-item-list__no-items-message",filterContainer:"esri-item-list__filter-container",filterContainerSticky:"esri-item-list__filter-container--sticky",filterPlaceholder:"esri-item-list__filter-placeholder",filterInput:"esri-item-list__filter-input",
filterPlaceholderText:"esri-item-list__filter-placeholder-text",searchIcon:"esri-icon-search",widget:"esri-widget",input:"esri-input"};e.ItemList=function(d){const {filterEnabled:h=!0,filterText:n="",headingLevel:z=4,id:k,identify:E,items:v,messages:y,onFilterChange:r,onItemMouseEnter:Q,onItemMouseLeave:O,onItemSelect:A,renderIcon:b,selectedItem:c,selectionMode:a="none"}=d;d=d.enableListScroll??!0;return w.tsx("div",{key:k},w.tsx("calcite-list",{selectionMode:a,selectionAppearance:"border"},h?L({filterText:n,
messages:y,onFilterChange:r,id:k}):null,x({enableListScroll:d,identify:E,items:v,selectedItem:c,messages:y,filterText:n,headingLevel:z,renderIcon:b,onItemMouseLeave:O,onItemMouseEnter:Q,onItemSelect:A})))};e.renderGroup=t;e.renderItem=N;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Spinner":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z){N=function(k){function E(y,r){y=v.call(this,y,r);y._animationDelay=500;y._animationPromise=null;y.viewModel=new h;return y}e._inherits(E,k);var v=e._createSuper(E);k=E.prototype;k.initialize=function(){this.addHandles(x.watch(()=>this.visible,y=>this._visibleChange(y)))};k.destroy=function(){this._animationPromise=null};k.show=function(y){const {location:r,promise:Q}=y??{};r&&(this.viewModel.location=r);this.visible=!0;y=()=>this.hide();Q&&Q.catch(()=>{}).then(y)};
k.hide=function(){this.visible=!1};k.render=function(){var {visible:y}=this,{screenLocation:r}=this.viewModel;r=!!r;y={["esri-spinner--start"]:y&&r,["esri-spinner--finish"]:!y&&r};r=this._getPositionStyles();return z.tsx("div",{class:this.classes("esri-spinner",y),styles:r})};k._visibleChange=function(y){if(y)this.viewModel.screenLocationEnabled=!0;else{var r=w.after(this._animationDelay);this._animationPromise=r;r.catch(()=>{}).then(()=>{this._animationPromise===r&&(this.viewModel.screenLocationEnabled=
!1,this._animationPromise=null)})}};k._getPositionStyles=function(){const {screenLocation:y,view:r}=this.viewModel;if(g.isNone(r)||g.isNone(y))return{};const {padding:Q}=r;return{left:`${y.x-Q.left}px`,top:`${y.y-Q.top}px`}};e._createClass(E,[{key:"location",get:function(){return this.viewModel.location},set:function(y){this.viewModel.location=y}},{key:"view",get:function(){return this.viewModel.view},set:function(y){this.viewModel.view=y}},{key:"visible",get:function(){return this.viewModel.visible},
set:function(y){this.viewModel.visible=y}}]);return E}(d);l.__decorate([L.property()],N.prototype,"location",null);l.__decorate([L.property()],N.prototype,"view",null);l.__decorate([L.property({type:h})],N.prototype,"viewModel",void 0);l.__decorate([L.property()],N.prototype,"visible",null);return N=l.__decorate([f.subclass("esri.widgets.Spinner")],N)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),
function(e,l,g,w,x,L,N,B){w=function(t){function f(h){h=d.call(this,h);h.visible=!1;return h}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(B);l.__decorate([g.property()],w.prototype,"visible",void 0);return w=l.__decorate([N.subclass("esri.widgets.CompassViewModel")],w)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Evented ../../core/Handles ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d){const h=Symbol("anchorHandles");g=function(z){function k(v){var y=E.call(this,v);y[n]=new w;y.location=null;y.screenLocationEnabled=!1;y.view=null;y[h].add([L.when(()=>x.applySome(y.screenLocationEnabled?y.view:null,r=>[r.size,"3d"===r.type?r.camera:r.viewpoint]),()=>y.notifyChange("screenLocation")),L.watch(()=>y.screenLocation,(r,Q)=>{x.isSome(r)&&x.isSome(Q)&&y.emit("view-change")})]);return y}e._inherits(k,z);var E=e._createSuper(k);k.prototype.destroy=function(){this.view=
null;this[h]=x.destroyMaybe(this[h])};e._createClass(k,[{key:"screenLocation",get:function(){const {location:v,view:y,screenLocationEnabled:r}=this;return r&&x.isSome(v)&&x.isSome(y)&&y.ready?y.toScreen?.(v):null}}]);return k}(g.EventedAccessor);var n=h;l.__decorate([N.property()],g.prototype,"location",void 0);l.__decorate([N.property()],g.prototype,"screenLocation",null);l.__decorate([N.property()],g.prototype,"screenLocationEnabled",void 0);l.__decorate([N.property()],g.prototype,"view",void 0);
return g=l.__decorate([d.subclass("esri.widgets.support.AnchorElementViewModel")],g)})},"esri/widgets/Editor/deprecationUtils":function(){define(["exports","../../core/deprecate"],function(e,l){e.workflowDeprecation=function(g,w,x){l.deprecated(g,"`"+w+"` is deprecated, because it instantiates the deprecated class 'esri.widgets.Editor.CreateWorkflow'",{replacement:x,version:"4.23",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-Editor-CreateFeaturesWorkflow.html"})};
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/EditorViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/asyncUtils ../../core/Collection ../../core/deprecate ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/Logger ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../layers/support/layerUtils ../../portal/support/urlUtils ../Attachments/AttachmentsViewModel ./CreateFeaturesWorkflow ./CreateWorkflow ./deprecationUtils ./UpdateWorkflow ./workflowUtils ../FeatureForm/FeatureFormViewModel ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q,O,A,b,c,a,p,D,P,m){function I(T,M,J){S.error(new L(T,M,J))}function H(T,M){return T?T.find(J=>J.layer===M):void 0}const S=t.getLogger("esri.widgets.Editor.EditorViewModel"),F=["create","create-features","update"];N=function(T){function M(u){var C=J.call(this,u);C._sketchGraphicsLayer=new v({listMode:"hide",internal:!0});C._updateEditableItemsTask=null;C.activeWorkflow=null;C._activityQueue=[];C.editableItems=new w;C.failures=[];C.attachmentsViewModel=
new Q({abilities:{editing:!0}});C.featureFormViewModel=new p;C.featureTemplatesViewModel=new D;C.sketchViewModel=new P({layer:C._sketchGraphicsLayer});C.spinnerViewModel=new m;C.pageStack=[];C.showDiscardPrompt=()=>Promise.resolve();C._candidateCommitted=!1;C.back=async()=>{const K=C.activeWorkflow;if(K&&C.canGoBack){if(C.hasPendingEdits)try{await C.showDiscardPrompt()}catch(R){return}K.hasPreviousStep?await K.previous({cancelCurrentStep:!0}):await C.cancelWorkflow({force:!0})}};C.save=()=>{const {featureFormViewModel:K}=
e._assertThisInitialized(C);K.submit();!K.submittable||0<K.validateContingencyConstraints(K.getValues(),{includeIncompleteViolations:!0}).length||C.activeWorkflow?.commit()};C.selectFeature=(K,R=!1)=>{const V=C.activeWorkflow;C._candidateCommitted||"update"!==V?.type||(V.data.edits.feature=K,R&&(V.next(),C._candidateCommitted=!0))};return C}e._inherits(M,T);var J=e._createSuper(M);T=M.prototype;T.initialize=function(){this.handles.add([d.watch(()=>{const u=this.view?.map?.editableLayers.filter(({parent:K,
visible:R})=>K&&"visible"in K?R&&K.visible:R),C=this.view?.allLayerViews?.filter(K=>!!u?.includes(K.layer)&&!K.suspended);return[u,C,this.layerInfos,this.allowedWorkflows]},()=>this._updateEditableItems(),d.initial),d.on(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),d.on(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),d.when(()=>this.view?.map,u=>{u.add(this._sketchGraphicsLayer)},d.initial),d.watch(()=>this.editableItems.toArray(),()=>{const {activeWorkflow:u}=
this;this.refreshCreationTemplates();if(u){var {stepId:C}=u;"create"===u.type?"awaiting-feature-creation-info"!==C||this.canCreate||this._cancelWorkflow():"update"===u.type&&("awaiting-feature-to-update"===C&&!this.canUpdate||"awaiting-update-feature-candidate"===C&&!u.data.candidates.some(K=>{const R=this.editableItems.find(V=>V.layer===K.layer);return R&&R.supports.includes("update")}))&&this._cancelWorkflow()}}),d.watch(()=>this.page,(u,C)=>{const K=this.pageStack.slice();u=K.indexOf(u);-1===u&&
C?K.push(C):K.splice(u);this.pageStack=K}),d.when(()=>"awaiting-update-feature-candidate"===this.state,()=>this._candidateCommitted=!1)])};T.destroy=function(){this._cancelWorkflow().then(()=>{this.view?.map&&this.view.map.remove(this._sketchGraphicsLayer);this.view=null});this._updateEditableItemsTask=f.abortMaybe(this._updateEditableItemsTask)};T.startCreateWorkflowAtFeatureTypeSelection=async function(){b.workflowDeprecation(S,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection");
await d.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var u=this._createCreateWorkflow();await u.start();this._set("activeWorkflow",u)}else I("editing:unsupported-workflow","Create workflow is unsupported or disabled.")};T.startCreateFeaturesWorkflowAtFeatureTypeSelection=async function(){return this.startCreateFeaturesWorkflow()};T.startCreateWorkflowAtFeatureCreation=async function(u){b.workflowDeprecation(S,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");
await d.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var C=this._createCreateWorkflow("awaiting-feature-to-create");C.data.creationInfo=u;await C.start();this._set("activeWorkflow",C)}else I("editing:unsupported-workflow","Create workflow is unsupported or disabled.")};T.startCreateFeaturesWorkflowAtFeatureCreation=async function(u){return this.startCreateFeaturesWorkflow(u,"creating-features")};T.startCreateFeaturesWorkflow=async function(u,C="awaiting-feature-creation-info"){await d.whenOnce(()=>
!this.updating);if(!this.canCreate)throw new L("editing:unsupported-workflow","Creating features is unsupported or disabled.");await this._cancelWorkflow();u=this._createCreateFeaturesWorkflow(u,C);await u.start();this._set("activeWorkflow",u)};T.startCreateWorkflowAtFeatureEdit=async function(u){b.workflowDeprecation(S,"startCreateWorkflowAtFeatureEdit");await d.whenOnce(()=>!this.updating);if(this.canCreate){await this._cancelWorkflow();var C=this._createCreateWorkflow("editing-new-feature");C.data.edits.feature=
u;await C.start();this._set("activeWorkflow",C)}else I("editing:unsupported-workflow","Create workflow is unsupported or disabled.")};T.startUpdateWorkflowAtFeatureSelection=async function(){await d.whenOnce(()=>!this.updating);if(this.canUpdate){await this._cancelWorkflow();var u=this._createUpdateWorkflow();await u.start();this._set("activeWorkflow",u)}else I("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};T.startUpdateWorkflowAtMultipleFeatureSelection=async function(u){await d.whenOnce(()=>
!this.updating);if(this.canUpdate){await this._cancelWorkflow();var C=this._createUpdateWorkflow("awaiting-update-feature-candidate");C.data.candidates=u;await C.start();this._set("activeWorkflow",C)}else I("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};T.startUpdateWorkflowAtFeatureEdit=async function(u){await d.whenOnce(()=>!this.updating);if(this.canUpdate){await this._cancelWorkflow();var C=this._createUpdateWorkflow("editing-existing-feature");C.data.edits.feature=
u;await C.start();this._set("activeWorkflow",C)}else I("editing:unsupported-workflow","Update workflow is unsupported or disabled.")};T.deleteFeatureFromWorkflow=async function(){const {activeWorkflow:u}=this;u&&"update"===u.type?(await this._delete(u.data.edits.feature),await u.reset()):I("editing:unsupported-workflow","Deleting requires an active update workflow.")};T.cancelWorkflow=async function(u){return this._cancelWorkflow({warn:!0,...u})};T.findEditableItemForLayer=function(u){const C="subtype-sublayer"===
u.type?u.parent:u;return this.editableItems.find(K=>K.layer===C)};T.refreshCreationTemplates=function(){const u=[];for(const {layer:C,supports:K}of this.editableItems)C.loaded&&K.includes("create")&&u.push(C);this.featureTemplatesViewModel.layers=u};T._updateEditableItems=async function(){f.abortMaybe(this._updateEditableItemsTask);const u=g.createTask(async C=>{var K=this.view?.allLayerViews,R=this.view?.map?.editableLayers;if(K&&R){var V=new Set(R);R=R?.filter(ba=>{const ea=y.getEffectiveLayerCapabilities(ba)?.operations;
return!(!ba.visible||!ea?.supportsAdd||ea?.supportsQuery)});var X=K.filter(ba=>V.has(ba.layer));K=[];for(const ba of X.reverse()){const {layer:ea,suspended:Y}=ba;"subtype-group"===ea.type?(await ea.loadAll(),K.push(...ea.sublayers.slice().reverse().map(ca=>this._makeEditableItemForLayer(ca,Y)))):K.push(this._makeEditableItemForLayer(ea,Y))}for(const ba of R.reverse())"subtype-group"===ba.type?(await ba.loadAll(),K.push(...ba.sublayers.map(ea=>this._makeEditableItemForLayer(ea,!1)))):K.push(this._makeEditableItemForLayer(ba,
!1));C.aborted||(C=this.editableItems,this.editableItems=new w(K),C.destroy())}});this.updatingHandles.addPromise(u.promise);this._updateEditableItemsTask=u};T._cancelWorkflow=async function(u){const C=this.activeWorkflow;C?u&&!1===u.force?(await C.cancel(u),this._set("activeWorkflow",null)):(this.emit("workflow-cancel"),this._set("activeWorkflow",null),await C.cancel(u)):u&&u.warn&&I("editing:no-active-workflow","There is no active workflow to cancel.")};T._createCreateFeaturesWorkflow=function(u,
C){return O.create(this,u,C,(K,R,V)=>this._applyEdits(K,R,V),(K,R)=>this._addAttachments(K,R))};T._createCreateWorkflow=function(u){return A.create(this,u,(C,K,R)=>this._applyEdits(C,K,R))};T._createUpdateWorkflow=function(u){return c.create(this,u,(C,K)=>this._applyEdits(C,K))};T._delete=async function(u){const C=u?.sourceLayer;C&&"applyEdits"in C&&await this._applyEdits(C,{deleteFeatures:[u]})};T._addAttachments=function(u,C){const K=[];C?.forEach(R=>K.push(this._addAttachment(u,R.feature,R.attachment)));
return Promise.all(K)};T._addAttachment=async function(u,C,K){let R=null;if("geojson"===u.type||"scene"===u.type||"oriented-imagery"===u.type)throw new L("editor:attachments-not-supported","Adding attachments is not supported for this layer type");await this._queueOperation(async()=>R=await u.addAttachment?.(C,K).catch(V=>{throw V?.error||V;})??null);return R};T._applyEdits=async function(u,C,K){let R=null;const V=u.url?await y.getOwningPortalUrl(u.url):null,X={returnServiceEditsOption:V&&r.parseKnownArcGISOnlineDomain(V)||
RegExp("/hosted/","i").test(u.url)?void 0:"original-and-current-features",...K};await this._queueOperation(async()=>{if(y.getEffectiveLayerCapabilities(u)?.operations.supportsQuery){const ba=await a.whenEditorLayerView(this.view,u);R=await u.applyEdits(C,X);await d.whenOnce(()=>!ba.updating);return R}return R=await u.applyEdits(C,X)});return R};T._queueOperation=function(u){this._activityQueue.push(u);this.notifyChange("syncing");const C=(K,R)=>{K=R.indexOf(K);-1<K&&R.splice(K,1)};return u().then(K=>
{if("error"in K&&K.error)throw K.error;if("addFeatureResults"in K){const {addFeatureResults:R,deleteFeatureResults:V,updateFeatureResults:X}=K,ba=R.find(ea=>!!ea.error)||X.find(ea=>!!ea.error)||V.find(ea=>!!ea.error);if(ba)throw ba.error;}return K}).catch(K=>{I("editing:operation-error","An error occurred.",{error:K});const R={error:K,retry:()=>{C(R,this.failures);return this._queueOperation(u)},cancel:()=>{C(R,this.failures)}};this._set("failures",[...this.failures,R])}).then(()=>{C(u,this._activityQueue);
this.notifyChange("syncing")})};T._makeEditableItemForLayer=function(u,C=!0){const K=y.getEffectiveLayerCapabilities(u);var R=K?.operations;const V=H(this.layerInfos,u);var X=this.allowedWorkflows;const ba=X.includes("create")||X.includes("create-features");var ea=X.includes("update");const Y=ba&&!!R?.supportsAdd&&(!V||!1!==V.enabled&&!1!==V.addEnabled);X=ea&&!!R?.supportsUpdate&&(!V||!1!==V.enabled&&!1!==V.updateEnabled);ea=ea&&!!R?.supportsDelete&&(!V||!1!==V.enabled&&!1!==V.deleteEnabled);R=[];
C||(Y&&R.push("create"),X&&R.push("update"),ea&&R.push("delete"));C=!!K?.data?.supportsAttachment&&(!V||!1!==V.allowAttachments);return{layer:u,supports:R,attributeUpdatesEnabled:X&&(!V||!1!==V.attributeUpdatesEnabled),geometryUpdatesEnabled:X&&!!K?.editing?.supportsGeometryUpdate&&(!V||!1!==V.geometryUpdatesEnabled),hasAttachments:C,attachmentsOnCreateEnabled:C&&ba&&(!V||!1!==V.attachmentsOnCreateEnabled),attachmentsOnUpdateEnabled:C&&(!V||!1!==V.attachmentsOnUpdateEnabled)}};e._createClass(M,[{key:"allowedWorkflows",
get:function(){return this._get("allowedWorkflows")},set:function(u){u&&0!==u.length||(u=[...F]);this._set("allowedWorkflows",u)}},{key:"canCreate",get:function(){return this.editableItems.some(u=>u.supports.includes("create"))}},{key:"canUpdate",get:function(){return this.editableItems.some(u=>u.supports.includes("update")||u.supports.includes("delete")||u.attachmentsOnUpdateEnabled)}},{key:"labelOptions",get:function(){return this.sketchViewModel.labelOptions},set:function(u){this.sketchViewModel.labelOptions=
u}},{key:"layerInfos",set:function(u){u?.some(C=>{"allowAttachments"in C&&x.deprecated(S,"Property: layerInfo.allowAttachments",{replacement:"layerInfo.attachmentsOnCreateEnabled or layerInfo.attachmentsOnUpdateEnabled",version:"4.26"});return!0});this._set("layerInfos",u)}},{key:"snappingOptions",get:function(){return this.sketchViewModel.snappingOptions},set:function(u){this.sketchViewModel.snappingOptions=u}},{key:"state",get:function(){if(!this.get("view.ready")||0===this.editableItems.length)return"disabled";
var u=this.attachmentsViewModel.mode;if("add"===u)return"adding-attachment";if("edit"===u)return"editing-attachment";({activeWorkflow:u}=this);return u?u.stepId:"ready"}},{key:"syncing",get:function(){return 0<this._activityQueue.length}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"tooltipOptions",get:function(){return this.sketchViewModel.tooltipOptions},set:function(u){this.sketchViewModel.tooltipOptions=u}},{key:"view",set:function(u){this.sketchViewModel.view=u;
this.spinnerViewModel.view=u;this._set("view",u)}},{key:"page",get:function(){const {activeWorkflow:u,state:C}=this;return"awaiting-feature-to-update"===C||"awaiting-feature-to-create"===C||"create-features"===u?.type&&0===u.pendingFeatures.length?"ready":C??"disabled"}},{key:"selectedTemplateItem",get:function(){var {activeWorkflow:u}=this;if("create-features"===u?.type&&0===u.pendingFeatures.length){({template:u}=u.data.creationInfo);for(const C of this.featureTemplatesViewModel.items)if("findByTemplate"in
C){const K=C.findByTemplate(u);if(K)return K}else if(C.template===u)return C}}},{key:"featureFormDisabled",get:function(){const {activeWorkflow:u}=this;return"update"===u?.type&&!1===u?.data.editableItem?.attributeUpdatesEnabled}},{key:"canGoBack",get:function(){return f.isSome(this.activeWorkflow)&&!this.syncing}},{key:"shouldShowDeleteButton",get:function(){const {activeWorkflow:u}=this;return!!u&&"update"===u.type&&u.data.editableItem.supports.includes("delete")}},{key:"hasPendingEdits",get:function(){const {activeWorkflow:u}=
this;return u?"create"===u.type||"create-features"===u.type&&0<u.numPendingFeatures||"editing-existing-feature"===u.stepId&&u.data.edits.modified:!1}}]);return M}(B.HandleOwnerMixin(N.EventedAccessor));l.__decorate([h.property({readOnly:!0})],N.prototype,"activeWorkflow",void 0);l.__decorate([h.property({readOnly:!0})],N.prototype,"_activityQueue",void 0);l.__decorate([h.property({value:[...F]})],N.prototype,"allowedWorkflows",null);l.__decorate([h.property({readOnly:!0})],N.prototype,"canCreate",
null);l.__decorate([h.property({readOnly:!0})],N.prototype,"canUpdate",null);l.__decorate([h.property()],N.prototype,"editableItems",void 0);l.__decorate([h.property({readOnly:!0})],N.prototype,"failures",void 0);l.__decorate([h.property()],N.prototype,"attachmentsViewModel",void 0);l.__decorate([h.property()],N.prototype,"featureFormViewModel",void 0);l.__decorate([h.property()],N.prototype,"featureTemplatesViewModel",void 0);l.__decorate([h.property()],N.prototype,"labelOptions",null);l.__decorate([h.property()],
N.prototype,"layerInfos",null);l.__decorate([h.property()],N.prototype,"sketchViewModel",void 0);l.__decorate([h.property()],N.prototype,"snappingOptions",null);l.__decorate([h.property()],N.prototype,"spinnerViewModel",void 0);l.__decorate([h.property()],N.prototype,"state",null);l.__decorate([h.property({readOnly:!0})],N.prototype,"syncing",null);l.__decorate([h.property()],N.prototype,"updating",null);l.__decorate([h.property()],N.prototype,"tooltipOptions",null);l.__decorate([h.property()],N.prototype,
"view",null);l.__decorate([h.property()],N.prototype,"pageStack",void 0);l.__decorate([h.property()],N.prototype,"showDiscardPrompt",void 0);l.__decorate([h.property()],N.prototype,"_candidateCommitted",void 0);l.__decorate([h.property()],N.prototype,"page",null);l.__decorate([h.property()],N.prototype,"selectedTemplateItem",null);l.__decorate([h.property()],N.prototype,"featureFormDisabled",null);l.__decorate([h.property()],N.prototype,"canGoBack",null);l.__decorate([h.property()],N.prototype,"shouldShowDeleteButton",
null);l.__decorate([h.property()],N.prototype,"hasPendingEdits",null);return N=l.__decorate([E.subclass("esri.widgets.Editor.EditorViewModel")],N)})},"esri/layers/GraphicsLayer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n){w=function(z){function k(v){v=E.call(this,v);v.elevationInfo=null;v.graphics=new h.GraphicsCollection;v.screenSizePerspectiveEnabled=!0;v.type="graphics";v.internal=!1;return v}e._inherits(k,z);var E=e._createSuper(k);z=k.prototype;z.destroy=function(){this.removeAll();this.graphics.destroy()};z.add=function(v){this.graphics.add(v);return this};z.addMany=function(v){this.graphics.addMany(v);return this};z.removeAll=function(){this.graphics.removeAll();return this};
z.remove=function(v){this.graphics.remove(v)};z.removeMany=function(v){this.graphics.removeMany(v)};z.on=function(v,y){return e._get(e._getPrototypeOf(k.prototype),"on",this).call(this,v,y)};z.graphicChanged=function(v){this.emit("graphic-update",v)};return e._createClass(k)}(f.BlendLayer(d.ScaleRangeLayer(t)));l.__decorate([g.property({type:n})],w.prototype,"elevationInfo",void 0);l.__decorate([g.property(B.owningCollectionProperty(h.GraphicsCollection,"graphics"))],w.prototype,"graphics",void 0);
l.__decorate([g.property({type:["show","hide"]})],w.prototype,"listMode",void 0);l.__decorate([g.property()],w.prototype,"screenSizePerspectiveEnabled",void 0);l.__decorate([g.property({readOnly:!0})],w.prototype,"type",void 0);l.__decorate([g.property({constructOnly:!0})],w.prototype,"internal",void 0);return w=l.__decorate([N.subclass("esri.layers.GraphicsLayer")],w)})},"esri/widgets/Editor/CreateFeaturesWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/handleUtils ../../core/maybe ../../core/reactiveUtils ../../core/uuid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ../../views/interactive/snapping/FeatureSnappingLayerSource ./CreateFeaturesWorkflowData ./Workflow ./workflowUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v){var y;const r=Symbol();t=y=function(Q){function O(b){b=A.call(this,b);b.type="create-features";b.createFeatureState="create-new";b._featureFormHandle=null;b._visualVariableAttributes={rotation:null,size:null};b._attachmentFileInfos=new Map;b._highlightHandles=new Map;b._preventDefaultActionOnCancel=!1;b._lastActiveGraphics=[];return b}e._inherits(O,Q);var A=e._createSuper(O);Q=O.prototype;Q.updatePendingFeature=async function(b,c){this._preventDefaultActionOnCancel=
!0;this.data.viewModel.sketchViewModel.cancel();g.remove(this._lastActiveGraphics,b);return this._startUpdating(b,c)};O.create=function(b,c,a,p,D){const P=new y({data:new k.CreateFeaturesWorkflowData({creationInfo:x.unwrap(c),viewModel:b}),onCommit:async m=>{var I=m.viewModel.sketchViewModel.layer.graphics.toArray();m=m.creationInfo.layer;var H=m.capabilities?.editing.supportsGlobalId&&"globalIdField"in m;const S=P._attachmentFileInfos;0===S.size?await p(m,{addFeatures:I}):H?(I=P._getAttachmentEditsWithGlobalIds(I,
m,S),await p(m,I,"addAttachments"in I?{globalIdUsed:!0}:void 0)):({addFeatureResults:H}=await p(m,{addFeatures:I}),I=P._getAddAttachmentsData(I,H,m,S),await D(m,I))}});P._set("steps",this._createWorkflowSteps(P,a));return P};Q._fadeExistingFeatures=function(b){if("effect"in b){const a=b.effect;b.effect="saturate(0.6) opacity(0.8)";return w.makeHandle(()=>b.effect=a)}const c=b.opacity;b.opacity=.7;return w.makeHandle(()=>b.opacity=c)};Q._highlight=function(b){const c=this.data.viewModel.view;"3d"===
c?.type&&this._highlightHandles.set(b,c.highlight(b))};Q._removeHighlight=function(b){x.removeMaybe(this._highlightHandles.get(b));this._highlightHandles.delete(b)};Q._startCreating=async function(b){this.createFeatureState="create-new";return v.startCreatingNewFeature(this.data.viewModel.sketchViewModel,this.data.creationInfo,b)};Q._startUpdating=async function(b,c){const {featureFormViewModel:a,layerInfos:p,sketchViewModel:D,view:P}=this.data.viewModel;if(P){var m=this.data.creationInfo.layer,I=
v.findLayerInfo(p,m);a.set({arcadeEditType:"INSERT",feature:b,formTemplate:I?.formTemplate,spatialReference:P.spatialReference,view:P});x.removeMaybe(this._featureFormHandle);this._featureFormHandle=w.handlesGroup([a.on("value-change",async()=>{b.attributes=a.getValues();await v.updateGraphicSymbolWhenRequired(b,c)}),D.on(["update","undo","redo"],H=>{("undo"===H.type||"redo"===H.type||"update"===H.type&&x.isSome(H.toolEventInfo)&&v.isTerminalUpdateEventType(H.toolEventInfo.type))&&a.notifyFeatureGeometryChanged()})]);
this._removeHighlight(b);this.createFeatureState="update-pending";this._visualVariableAttributes=v.getVisualVariableAttributes(b);return v.startUpdatingFeature(D,b,m,this._visualVariableAttributes,c)}};O._createWorkflowSteps=function(b,c="awaiting-feature-creation-info"){const {data:a,handles:p}=b;let D=null,P=!0;const m=new Map;c=v.createWorkflowSteps(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],c,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",
async setUp(){a.creationInfo=null;p.add(a.viewModel.featureTemplatesViewModel.on("select",({item:I})=>{I&&(a.creationInfo=I,a.viewModel.activeWorkflow?.next())}),this.id)},async tearDown(){p.remove(this.id)}}),"creating-features":()=>({id:"creating-features",async setUp(){if(!p.has(this.id)){var I=a.viewModel.view;if(I){var H=a.viewModel.sketchViewModel;P=H.updateOnGraphicClick;H.updateOnGraphicClick=!1;b._lastActiveGraphics=[];b._featureFormHandle=x.removeMaybe(b._featureFormHandle);b._visualVariableAttributes=
{rotation:null,size:null};v.prepareAttachmentsForCreateWorkflow(a.viewModel.attachmentsViewModel);var S="2d"===I.type?b._fadeExistingFeatures(a.creationInfo.layer):null,F=H.on("create",async R=>{if("cancel"===R.state){if(b._preventDefaultActionOnCancel){b._preventDefaultActionOnCancel=!1;return}if(1>b._lastActiveGraphics.length)return b._startCreating(m);R=b._lastActiveGraphics.pop();return b._startUpdating(R,m)}if("complete"===R.state&&R.graphic)return b._startUpdating(R.graphic,m)}),T=H.on("update",
async R=>{var V=R.graphics[0];if("complete"===R.state){V!==D&&(b._lastActiveGraphics.push(V),b._highlight(V));D=null;"add"!==a.viewModel.attachmentsViewModel.mode&&"edit"!==a.viewModel.attachmentsViewModel.mode||a.viewModel.activeWorkflow?.previous();if(R.aborted&&b._preventDefaultActionOnCancel){b._preventDefaultActionOnCancel=!1;return}const X=I.cursor;I.cursor="progress";p.add([w.makeHandle(()=>I.cursor=X),I.on("click",ba=>ba.preventDefault())],r);return L.whenOnce(()=>!a.viewModel.featureFormViewModel.updating).then(()=>
{p.remove(r);b._startCreating(m)})}if("start"===R.state){b._removeHighlight(V);const X=a.viewModel.attachmentsViewModel;"add"!==X.mode&&"edit"!==X.mode||a.viewModel.activeWorkflow?.previous();X.fileInfos.removeAll();X.graphic=V;X.mode="view";(b._attachmentFileInfos.get(V)||[]).forEach(({file:ba,form:ea})=>X.addFile(ba,ea))}await v.visualVariableInteractiveUpdate(I,V,R,b._visualVariableAttributes,m);R=V.attributes;x.isSome(b._visualVariableAttributes.rotation)&&({field:V}=b._visualVariableAttributes.rotation,
a.viewModel.featureFormViewModel.setValue(V,R[V]));x.isSome(b._visualVariableAttributes.size)&&({field:V}=b._visualVariableAttributes.size,a.viewModel.featureFormViewModel.setValue(V,R[V]))}),M=H.on("delete",async R=>{R=R.graphics[0];g.remove(b._lastActiveGraphics,R);D=R}),J=null,u=L.watch(()=>{const R=H.snappingOptions.featureSources.find(V=>V.layer===a.creationInfo.layer);return{hasFeatureLayerSource:!!R,enabled:R?.enabled??!1}},({hasFeatureLayerSource:R,enabled:V})=>{const X=H.snappingOptions.featureSources;
R?(x.isNone(J)&&(J=new z({layer:H.layer,enabled:V}),X.add(J)),J.enabled=V):(x.isSome(J)&&X.remove(J),J=x.destroyMaybe(J))},L.syncAndInitial),C=I.on("immediate-click",async R=>{({results:R}=await I.hitTest(R,{include:H.layer}));if(R=R.find(V=>"graphic"===V.type))R=R.graphic,"transform"!==H.activeTool&&"reshape"!==H.activeTool||H.updateGraphics.getItemAt(0)===R||await b.updatePendingFeature(R,m)}),K=L.watch(()=>a.viewModel.attachmentsViewModel.mode,R=>{"add"===R&&a.viewModel.activeWorkflow.go("adding-attachment");
"edit"===R&&a.viewModel.activeWorkflow.go("editing-attachment")});await b._startCreating(m);p.add({remove:()=>{x.removeMaybe(b._featureFormHandle);F.remove();T.remove();M.remove();u.remove();x.isSome(J)&&H.snappingOptions.featureSources.remove(J);J=x.destroyMaybe(J);H.cancel();C.remove();K.remove();x.removeMaybe(S)}},this.id)}}},async tearDown(I){I.cancelled&&(a.viewModel.sketchViewModel.layer.removeAll(),p.remove([this.id,r]),a.viewModel.attachmentsViewModel.fileInfos.removeAll(),b._attachmentFileInfos.clear(),
a.viewModel.sketchViewModel.updateOnGraphicClick=P)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",async setUp(){},async tearDown(){const {graphic:I,fileInfos:H}=a.viewModel.attachmentsViewModel;b._attachmentFileInfos.set(I,H.toArray());a.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const {graphic:I,fileInfos:H}=a.viewModel.attachmentsViewModel;b._attachmentFileInfos.set(I,
H.toArray());a.viewModel.attachmentsViewModel.mode="view"}})});return v.avoidFeatureTemplateSelectionWithOnlyOneItem(a,c)};Q._getAddAttachmentsData=function(b,c,a,p){const D=[];c.forEach((P,m)=>{if(!P.error){const I=b[m];m=p.get(I)||[];I.attributes[a.objectIdField]=P.objectId;m.forEach(({form:H})=>D.push({feature:I,attachment:H}))}});return D};Q._getAttachmentEditsWithGlobalIds=function(b,c,a){const p=[],D=c.globalIdField;b.forEach((P,m)=>{const I=a.get(P)||[];let H=P.attributes[D];x.isNone(H)&&(H=
N.generateUUID(),b[m].attributes[D]=H);I.forEach(({file:S})=>p.push({feature:P,attachment:{globalId:N.generateUUID(),data:S}}))});return p.length?{addFeatures:b,addAttachments:p}:{addFeatures:b}};e._createClass(O,[{key:"numPendingFeatures",get:function(){return this.data.viewModel.sketchViewModel.layer.graphics.length}},{key:"pendingFeatures",get:function(){return this.data.viewModel.sketchViewModel.layer.graphics}},{key:"reliesOnOwnerAdminPrivileges",get:function(){const {layer:b}=this.data.creationInfo,
c=b.capabilities?.operations.supportsAdd,a=h.getEffectiveLayerCapabilities(b)?.operations.supportsAdd;return h.getEffectiveEditingEnabled(b)&&!b.editingEnabled||!!a&&!c}},{key:"shouldShowAttachments",get:function(){return this.data&&this.data.creationInfo&&this.data.viewModel?v.shouldShowAttachmentsForCreateWorkflow(this.data):!1}},{key:"shouldAllowAttachmentEditing",get:function(){return this.shouldShowAttachments}},{key:"helpMessage",get:function(){if("creating-features"===this.stepId){var {creationInfo:b,
viewModel:c}=this.data;return n.getDrawHelpMessage(b.layer.geometryType,c.sketchViewModel.createGraphic?.geometry)}}}]);return O}(E);l.__decorate([B.property()],t.prototype,"reliesOnOwnerAdminPrivileges",null);l.__decorate([B.property()],t.prototype,"shouldShowAttachments",null);l.__decorate([B.property()],t.prototype,"shouldAllowAttachmentEditing",null);l.__decorate([B.property()],t.prototype,"helpMessage",null);return t=y=l.__decorate([d.subclass("esri.widgets.Editor.CreateFeaturesWorkflow")],t)})},
"esri/views/draw/support/helpMessageUtils":function(){define(["exports","../../../core/maybe"],function(e,l){e.getDrawHelpMessage=function(g,w){switch(g){case "point":case "multipoint":return"point";case "polyline":return 2>(l.isSome(w)&&"polyline"===w.type&&w.paths.length?w.paths[0].length:0)?"polylineZeroVertices":"polylineOneVertex";case "polygon":return g=l.isSome(w)&&"polygon"===w.type&&w.rings.length?w.rings[0].length:0,3>g?"polylineZeroVertices":4>g?"polygonOneVertex":"polygonTwoVertices"}};
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(e,l,g,w,x,L,N,B){g=function(t){function f(h){h=d.call(this,h);
h.layer=null;h.enabled=!0;h.updating=!1;h.availability=1;return h}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);l.__decorate([w.property({constructOnly:!0})],g.prototype,"layer",void 0);l.__decorate([w.property()],g.prototype,"enabled",void 0);l.__decorate([w.property()],g.prototype,"updating",void 0);l.__decorate([w.property()],g.prototype,"availability",void 0);return g=l.__decorate([B.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],g)})},"esri/widgets/Editor/CreateFeaturesWorkflowData":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B,t){e.CreateFeaturesWorkflowData=function(f){function d(n){n=h.call(this,n);n.creationInfo=null;n.viewModel=null;return n}l._inherits(d,f);var h=l._createSuper(d);return l._createClass(d)}(w);g.__decorate([x.property()],e.CreateFeaturesWorkflowData.prototype,"creationInfo",void 0);g.__decorate([x.property()],e.CreateFeaturesWorkflowData.prototype,"viewModel",void 0);e.CreateFeaturesWorkflowData=g.__decorate([t.subclass("esri.widgets.Editor.CreateFeaturesWorkflowData")],e.CreateFeaturesWorkflowData);
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/Workflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/HandleOwner ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(e,l,g,w,x,L,N,B,t,f){w=function(d){function h(z){z=n.call(this,z);z._indexHistory=
[];z._lastStepIndex=-1;z._stepIndex=-1;z._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};z.data=void 0;z.started=!1;z.steps=[];z.type=null;return z}e._inherits(h,d);var n=e._createSuper(h);d=h.prototype;d.cancel=async function(z={force:!0}){return!1!==z.force?this._cancel():new Promise((k,E)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel().then(k)},deny:()=>E(new g("workflow:cancel-denied","Request to cancel workflow was denied."))}})})};d.commit=async function(){this.handles.remove(this._handleKeys.beforeCommit);
await this.onCommit(this.data);this.handles.remove(this._handleKeys.afterCommit);this.emit("commit");this.started&&await this.reset()};d.go=async function(z){var {steps:k}=this;k=k.findIndex(E=>E.id===z);this._indexHistory.push(this._stepIndex);await this._go(k)};d.next=async function(){this._indexHistory.push(this._stepIndex);await this._go(this._stepIndex+1)};d.previous=async function(z={cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),z.cancelCurrentStep)};d.reset=async function(){await this._cancel(!1);
await this.start()};d.start=async function(){this._set("started",!0);await this._go(-1===this._stepIndex?0:this._stepIndex)};d._cancel=async function(z=!0){this.started&&(this._set("started",!1),await this.steps[this._stepIndex].tearDown({cancelled:!0}),this.data&&this.data.viewModel.sketchViewModel.layer.removeAll());this.handles.remove([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]);this._resetIndexing(z);z&&this.emit("cancel")};d._go=async function(z=-1,k=!1){-1>=z||z>=this.steps.length||
(this.started&&(-1<this._lastStepIndex&&await this.steps[this._lastStepIndex].tearDown({cancelled:k}),await this.steps[z].setUp(),this._lastStepIndex=z),this._stepIndex=z,this._notifyStepProps())};d._resetIndexing=function(z=!0){this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;z&&this._notifyStepProps()};d._notifyStepProps=function(){this.notifyChange("stepId");this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")};e._createClass(h,[{key:"hasNextStep",get:function(){const {steps:z}=
this;return!!(z&&this._stepIndex<z.filter(k=>!k.parent).length-1)}},{key:"hasPreviousStep",get:function(){return 0<this._stepIndex}},{key:"reliesOnOwnerAdminPrivileges",get:function(){return!1}},{key:"shouldShowAttachments",get:function(){return!1}},{key:"shouldAllowAttachmentEditing",get:function(){return!1}},{key:"stepId",get:function(){var {steps:z}=this;return(z=z&&z[this._stepIndex])&&z.id}},{key:"helpMessage",get:function(){}}]);return h}(x.HandleOwnerMixin(w.EventedAccessor));l.__decorate([L.property()],
w.prototype,"data",void 0);l.__decorate([L.property()],w.prototype,"hasNextStep",null);l.__decorate([L.property()],w.prototype,"hasPreviousStep",null);l.__decorate([L.property()],w.prototype,"onCommit",void 0);l.__decorate([L.property()],w.prototype,"reliesOnOwnerAdminPrivileges",null);l.__decorate([L.property()],w.prototype,"shouldShowAttachments",null);l.__decorate([L.property()],w.prototype,"shouldAllowAttachmentEditing",null);l.__decorate([L.property()],w.prototype,"started",void 0);l.__decorate([L.property({readOnly:!0})],
w.prototype,"stepId",null);l.__decorate([L.property()],w.prototype,"steps",void 0);l.__decorate([L.property({readOnly:!0})],w.prototype,"type",void 0);l.__decorate([L.property()],w.prototype,"helpMessage",null);l.__decorate([L.property()],w.prototype,"commit",null);return w=l.__decorate([f.subclass("esri.widgets.Editor.Workflow")],w)})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../Graphic ../../core/has ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/diffUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/lengthUtils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../symbols/support/symbolConversion ../../symbols/support/symbolUtils ../../views/3d/layers/graphics/GraphicState ../../views/support/drapedUtils ../../views/support/hitTestSelectUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r){function Q(u){const C=u.sourceLayer;var K;if(!(K=!C||"feature"!==C.type)){a:switch(C.renderer?.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":case "pie-chart":K=!0;break a;default:K=!1}K=!K}if(K)return{rotation:null,size:null};let R=K=null;var V=C.renderer.getVisualVariablesForType("rotation").filter(X=>(!X.axis||"heading"===X.axis)&&X.field&&!X.valueExpression&&L.isSome(z.getRotationAngle(X,u)));1===
V.length&&(K=O(V[0],C));V=C.renderer.getVisualVariablesForType("size").filter(X=>X.field&&!X.useSymbolValue&&!X.valueExpression&&n.getTransformationType(X)===n.TransformationType.RealWorldSize&&L.isSome(z.getSize(X,u)));1===V.length&&(R=c(V[0],C));return{rotation:K,size:R}}function O(u,C){const K="heading"===(u.axis||"heading")&&"arithmetic"===u.rotationType?-1:1,R=u.field,V=(C=C.fields&&C.fields.filter(ea=>ea.name===R))&&1===C.length?C[0].type:"double";var X=0,ba=0;return{field:R,fieldType:V,getDefault:()=>
Promise.resolve(0),getValue:ea=>{ba=X-K*ea;return a((ba+360)%360,V)},initValue:ea=>{X=null!=ea?ea:ba;ba=0},isUpdatingInteractively:!1,rotationType:u.rotationType??"geographic"}}function A(u,C){switch(C){case "width":return u[0];case "depth":return u[1];case "height":return u[2];default:return u[2]||u[1]||u[0]}}async function b(u,C,K){if(L.isNone(C))return 0;({symbol:C}=k.to3D(C));if(L.isNone(C)||"web-style"===C.type||"cim"===C.type)return 0;C=C.symbolLayers.getItemAt(0);if(!C)return 0;switch(C.type){case "icon":return{computeIconLayerResourceSize:K}=
await new Promise((V,X)=>e(["../../symbols/support/symbolLayerUtils"],V,X)),C.size||Math.min(M.icon,(await K(C,M.icon))[0])||M.icon;case "text":return C.size||M.text;case "line":return C.size||M.line;case "object":const {computeObjectLayerResourceSize:R}=await new Promise((V,X)=>e(["../../symbols/support/symbolLayerUtils"],V,X));u=await R(C,u.scale/M.viewScaleSizeFactor);return A(u,K);case "path":return(null!=C.width?C.width:C.height)||u.scale/M.viewScaleSizeFactor;case "extrude":return C.size||u.scale/
M.viewScaleSizeFactor;case "fill":case "water":return 0;default:return 0}}function c(u,C){const K=u.field,R=u.axis,V=(C=C.fields&&C.fields.filter(ca=>ca.name===K))&&1===C.length?C[0].type:"double";var X=0,ba=0;const ea=h.meterIn[u.valueUnit]??1;let Y;Y="area"===u.valueRepresentation?ca=>(ca*ea/2)**2*Math.PI:"radius"===u.valueRepresentation||"distance"===u.valueRepresentation?ca=>ca*ea/2:ca=>ca*ea;return{field:K,fieldType:V,getDefault:async(ca,da)=>a(Y(await b(da,ca,R)),V),getValue:(ca,da)=>{X||(X=
da.pixelSizeAt(da.center));ba=X*ca;return a(ba,V)},initValue:ca=>{X=null!=ca?ca:ba;ba=0},isUpdatingInteractively:!1,displayUnit:T(u.valueUnit),axis:u.axis}}function a(u,C){switch(C){case "small-integer":case "integer":case "long":return Math.round(u);case "double":case "single":return u;default:return 0}}async function p(u,C){C=await E.getDisplayedSymbol(u,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:C});const K=f.diff(u.symbol,C);L.isSome(K)&&(u.symbol=C)}async function D(u,C,K){var R=
C.layer;C={...C.template.prototype.attributes};await P(u,R,C,K);K={graphicProperties:{attributes:C,sourceLayer:R},hasZ:R.capabilities.data.supportsZ};u.layer.elevationInfo=R.elevationInfo;C=u.create;R=R.geometryType;if(!R)throw Error("no geometry type");if("mesh"===R||"multipatch"===R)throw Error("Mesh and Multipatch not supported");return C.call(u,R,K)}async function P(u,C,K,R){C=new g({sourceLayer:C,attributes:K});const {rotation:V,size:X}=Q(C);let ba=await E.getDisplayedSymbol(C,{useSourceLayer:!0,
webStyleCache:R}),ea=!1;for(const Y of[X,V])L.isNone(Y)||null!=K[Y.field]||(K[Y.field]=await Y.getDefault(ba,u.view),ea=!0);ea&&(ba=await E.getDisplayedSymbol(C,{useSourceLayer:!0,webStyleCache:R}));switch(ba?.type){case "simple-fill":case "polygon-3d":u.polygonSymbol=ba;break;case "simple-line":case "line-3d":u.polylineSymbol=ba;break;case "simple-marker":case "picture-marker":case "point-3d":case "cim":u.pointSymbol=ba}m(u.tooltipOptions,X,V)}function m(u,C,K){L.isSome(C)||L.isSome(K)?u.visualVariables=
{size:L.isSome(C)?{unit:C.displayUnit,axis:C.axis,valueType:C.fieldType}:null,rotation:L.isSome(K)?{valueType:K.fieldType,rotationType:K.rotationType??"geographic"}:null}:u.visualVariables=null}async function I(u,C,K,R){if(0===u.length)return[];const {updatable:V,graphicsByLayer:X}=await K.async(async()=>{var {results:ba}=await N.whenOrAbort(r.hitTestSelectSimilarDistance(C,K),R);const ea=new Map;r.filterGraphicHits(ba).forEach(({graphic:Y})=>{var ca=Y.layer;var da=ea.get(ca);da?ca=da:(da=[],ea.set(ca,
da),ca=da);return ca.push(Y)});ba=u.filter(({supports:Y,layer:ca})=>Y.includes("update")&&ea.has(ca));0!==ba.length&&K.stopPropagation();return{updatable:ba,graphicsByLayer:ea}});return N.whenOrAbort(N.eachAlways(V.map(async({layer:ba})=>{var {objectIdField:ea}=ba,Y="displayField"in ba?ba.displayField:null;const ca=[ea];null!=Y&&ba.fieldsIndex.has(Y)&&ca.push(Y);ea=X.get(ba);return ea.some(da=>ca.some(ja=>!(ja in da.attributes)))?(Y=ba.createQuery(),Y.outFields=ca,Y.returnGeometry=!1,Y.objectIds=
ea.map(da=>da.getObjectId()),ba.queryFeatures(Y,{signal:R}).then(({features:da})=>da)):ea})),R)}async function H(u,C,K,R){if(0===u.length)return[];let V=null;const X=await K.async(async()=>{var {results:ba}=await N.whenOrAbort(C.hitTest(K),R);if(0===ba.length)return[];const ea=new Set;V=r.filterGraphicHits(ba);V.forEach(({graphic:Y})=>Y&&ea.add(Y.layer));ba=u.items.filter(({layer:Y,supports:ca,attachmentsOnUpdateEnabled:da})=>ea.has(Y)&&(ca.includes("update")||ca.includes("delete")||da));0<ba.length&&
K.stopPropagation();return ba});return N.whenOrAbort(N.eachAlways(X.map(({layer:ba})=>{var ea="displayField"in ba?ba.displayField:null,Y=[ba.objectIdField];null!=ea&&ba.fieldsIndex.has(ea)&&Y.push(ea);ea=ba.createQuery();ea.outFields=Y;ea.returnGeometry=!1;Y="renderer"in ba?d.calculateTolerance({renderer:ba.renderer,event:K}):0;ea.geometry=y.createQueryGeometry(K.mapPoint,Y,C);ea.outSpatialReference=C.spatialReference;return ba.queryFeatures(ea,{signal:R}).then(({features:ca})=>{V?.forEach(({graphic:da})=>
{da.layer!==ba||ca.some(ja=>ja.getObjectId()===da.getObjectId())||ca.push(da)});return ca})})),R)}async function S(u,C,K,R,V){let X=!1;const {rotation:ba,size:ea}=R;[ba,ea].forEach(async Y=>{if(!L.isNone(Y)){var ca=C.attributes[Y.field];L.isSome(ca)?Y.initValue(ca):(ca=await Y.getDefault(C.symbol,u.view),Y.initValue(ca),C.setAttribute(Y.field,ca),X=!0)}});X&&await p(C,V);R={multipleSelectionEnabled:!1};"point"===K.geometryType&&(R.enableRotation=L.isSome(ba),R.enableScaling=L.isSome(ea));m(u.tooltipOptions,
ea,ba);u.layer.elevationInfo=K.elevationInfo;return u.update(C,R)}async function F(u,C,K,R,V){if(L.isSome(C.geometry)&&"point"===C.geometry?.type){var X=R.rotation;var ba=K.toolEventInfo;ba=!L.isSome(ba)||"rotate-start"!==ba.type&&"rotate"!==ba.type&&"rotate-stop"!==ba.type?null:ba;if(L.isSome(X)&&L.isSome(ba))if("rotate-stop"===ba.type)X.isUpdatingInteractively=!1,X.initValue();else{X.isUpdatingInteractively=!0;const {field:ea,getValue:Y}=X;C.attributes[ea]=Y(ba.angle,u)}R=R.size;K=K.toolEventInfo;
K=!L.isSome(K)||"scale-start"!==K.type&&"scale"!==K.type&&"scale-stop"!==K.type?null:K;if(L.isSome(R)&&L.isSome(K))if("scale-stop"===K.type)R.isUpdatingInteractively=!1,R.initValue();else{R.isUpdatingInteractively=!0;const {field:ea,getValue:Y}=R;C.attributes[ea]=Y(K.xScale,u)}await p(C,V)}}function T(u){switch(u){case "unknown":case "decimal-degrees":return null;default:return u}}const M={icon:t.px2pt(24),text:t.px2pt(12),line:t.px2pt(1),viewScaleSizeFactor:100},J=(u,C)=>u.whenLayerView("subtype-sublayer"===
C.type?C.parent:C);l.avoidFeatureTemplateSelectionWithOnlyOneItem=function(u,C){u.viewModel.refreshCreationTemplates();if("awaiting-feature-creation-info"===C[0].id){var K=u.viewModel.featureTemplatesViewModel.items;1!==K.length?K=null:(K=K[0],K="items"in K?1===K.items.length?K.items[0]:null:K);L.isSome(K)&&(u.creationInfo=K,C.shift())}return C};l.createWorkflowSteps=function(u,C,K){let R=!1;return u.filter(V=>R?!0:R=V===C).map(V=>K[V]())};l.fetchCandidates=async function(u,C,K,R){switch(C.type){case "3d":return I(u,
C,K,R);case "2d":return H(u,C,K,R)}};l.fetchFullFeature=async function(u,C,K){const {sourceLayer:R}=u,V=R.createQuery();V.objectIds=[u.getAttribute(R.objectIdField)];V.outFields=["*"];V.outSpatialReference=C.spatialReference;V.returnM=R.capabilities.data.supportsM;V.returnZ=R.capabilities.data.supportsZ;return(await R.queryFeatures(V,{signal:K})).features[0]};l.findLayerInfo=function(u,C){return u?u.find(K=>K.layer===C):void 0};l.getVisualVariableAttributes=Q;l.isTerminalUpdateEventType=u=>/-stop/.test(u)||
/vertex-/.test(u);l.prepareAttachmentsForCreateWorkflow=function(u){u.set({abilities:{editing:!0,operations:{add:!0,update:!0,delete:!0}},filesEnabled:!0,mode:"view"})};l.setUpFeatureAdd=async function(u,C,K,R){await D(u,C,R);const V=u.on("create",async X=>{if("cancel"===X.state)return D(u,C,R);"complete"===X.state&&(X=X.graphic,X.sourceLayer||(X.sourceLayer=C.layer),X.attributes||(X.attributes={...C.template.prototype.attributes}),await p(X,R),K(X))});return{remove:()=>{V.remove();u.cancel()}}};
l.setUpGeometryUpdate=async function(u,C,K,R,V,X){const ba=u.clone();await p(ba,X);R.map.add(K.layer);K.layer.add(ba);const ea=u.sourceLayer,Y=J(R,ea),ca=()=>{const aa=u.attributes[u.layer.objectIdField];Y.then(ha=>ha.setVisibility?.(aa,!1),()=>{});return{remove(){Y.then(ha=>ha.setVisibility?.(aa,!0),()=>{})}}};let da=null,ja=null;if("3d"===R.type){const aa=new v.GraphicState({graphic:ba});da=x.handlesGroup([R.trackGraphicState(aa),B.watch(()=>aa.displaying,ha=>{ja=ha?ca():L.removeMaybe(ja)},B.initial)])}else ja=
ca();await S(K,ba,ea,C,X);let pa=null;Y.then(aa=>pa=aa,()=>{});const sa=C.size,xa=C.rotation,ya=B.watch(()=>u.attributes,async aa=>{let ha=!1;for(const ia in aa){const fa=aa[ia];fa!==ba.attributes[ia]&&(ba.setAttribute(ia,fa),L.isSome(sa)&&!sa.isUpdatingInteractively&&sa.field===ia&&sa.initValue(fa),L.isSome(xa)&&!xa.isUpdatingInteractively&&xa.field===ia&&xa.initValue(fa),L.isNone(pa)||pa.requiredFields.includes(ia))&&(ha=!0)}ha&&await p(ba,X)}),oa=K.on("update",async aa=>{const ha=aa.graphics[0];
if("complete"===aa.state)return S(K,ha,ea,C,X);await F(R,ha,aa,C,X);V(ha.clone(),aa)}),za=K.on(["undo","redo"],async aa=>{V(aa.graphics[0].clone(),aa)}),Ga=()=>{};return{interactive:{remove(){za.remove();oa.remove();K.cancel();ya&&ya.remove();this.remove=Ga}},visual:{remove(){L.removeMaybe(ja);J(R,ea).then(aa=>B.whenOnce(()=>!aa.updating)).then(()=>{L.removeMaybe(da);K.layer.remove(ba);this.remove=Ga})}}}};l.shouldShowAttachmentsForCreateWorkflow=function(u){const {creationInfo:{layer:C},viewModel:K}=
u;if(u=K.editableItems.find(V=>V.layer===C))return u.attachmentsOnCreateEnabled;u=C.capabilities?.data;const R=K.layerInfos?.find(V=>V.layer===C);return!(!(u&&"supportsAttachment"in u&&u.supportsAttachment)||R&&(!1===R.allowAttachments||!1===R.attachmentsOnUpdateEnabled))};l.sizeDefaults=M;l.sizeVariableUnitToLengthUnit=T;l.startCreatingNewFeature=D;l.startUpdatingFeature=S;l.updateGraphicSymbolWhenRequired=p;l.visualVariableInteractiveUpdate=F;l.whenEditorLayerView=J;Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(e){function l(x,L){return L?"xoffset"in L&&L.xoffset?Math.max(x,Math.abs(L.xoffset)):"yoffset"in L&&L.yoffset?Math.max(x,Math.abs(L.yoffset||0)):x:x}function g(x,L){if("number"===typeof x)return x;if(x&&x.stops&&x.stops.length){x=x.stops;let N=L=0;for(let B=0;B<x.length;B++){const t=x[B].size;"number"===typeof t&&(L+=t,N++)}return L/N}return L}function w(x,L){if(!L)return x;L=L.filter(t=>"size"===
t.type).map(t=>{const {maxSize:f,minSize:d}=t;return(g(f,x)+g(d,x))/2});let N=0;const B=L.length;if(0===B)return x;for(let t=0;t<B;t++)N+=L[t];return Math.max(Math.floor(N/B),x)}e.calculateTolerance=function(x){const L=x&&x.renderer;x="touch"===(x&&x.event&&x.event.pointerType)?9:6;if(!L)return x;x="visualVariables"in L?w(x,L.visualVariables):x;if("simple"===L.type)return l(x,L.symbol);if("unique-value"===L.type){let N=x;L.uniqueValueInfos?.forEach(B=>{N=l(N,B.symbol)});return N}if("class-breaks"===
L.type){let N=x;L.classBreakInfos.forEach(B=>{N=l(N,B.symbol)});return N}return x};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/accessorSupport/ensureType ../../../../core/arrayUtils ../../../../core/has ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B,t){e.GraphicState=function(f){function d(n){n=h.call(this,n);n.tracking=!1;n.displaying=!1;n.isDraped=!1;return n}l._inherits(d,f);var h=l._createSuper(d);return l._createClass(d)}(w.EventedAccessor);g.__decorate([x.property({constructOnly:!0})],e.GraphicState.prototype,"graphic",void 0);g.__decorate([x.property()],e.GraphicState.prototype,"tracking",void 0);g.__decorate([x.property()],e.GraphicState.prototype,"displaying",void 0);g.__decorate([x.property()],e.GraphicState.prototype,
"isDraped",void 0);e.GraphicState=g.__decorate([t.subclass("esri.views.3d.layers.graphics.GraphicState")],e.GraphicState);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define("exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils ../../geometry/Extent".split(" "),function(e,l,g,w,x,L){function N(t,f,d,h=new L){let n=0;if("2d"===d.type)n=f*(d.resolution??0);else if("3d"===d.type){var z=
d.overlayPixelSizeInMapUnits(t),k=d.basemapSpatialReference;n=g.isSome(k)&&!k.equals(d.spatialReference)?w.getMetersPerUnitForSR(k)/w.getMetersPerUnitForSR(d.spatialReference):f*z}f=t.x-n;z=t.y-n;k=t.x+n;t=t.y+n;({spatialReference:d}=d);h.xmin=Math.min(f,k);h.ymin=Math.min(z,t);h.xmax=Math.max(f,k);h.ymax=Math.max(z,t);h.spatialReference=d;return h}const B=new L;e.createQueryGeometry=N;e.intersectsDrapedGeometry=function(t,f,d){t=d.toMap(t);if(g.isNone(t))return!1;const h=x.calculateTolerance();return N(t,
h,d,B).intersects(f)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports","../../core/maybe"],function(e,l){function g(w){return l.isSome(w)&&"graphic"===w.type}e.filterGraphicHits=function(w){return w.filter(g)};e.findFirstGraphicHit=function(w){return w.find(g)??null};e.hitTestSelectSimilarDistance=async function(w,x){if("2d"===w.type)return w.hitTest(x);w=await w.hitTest(x);if(0===w.results.length)return w;const L=
1.05*(l.unwrap(w.results[0].distance)??0);x=w.results.findIndex(N=>(N.distance??0)>L);-1!==x&&(w.results=w.results.slice(0,x));return w};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/CreateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ./CreateWorkflowData ./Edits ./Workflow ./workflowUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k){var E;L=E=function(v){function y(Q){Q=r.call(this,Q);Q.type="create";return Q}e._inherits(y,v);var r=e._createSuper(y);y.create=function(Q,O,A){Q=new E({data:new h({edits:new n.Edits,viewModel:Q}),onCommit:async b=>{await A(b.creationInfo.layer,{addFeatures:[b.edits.feature]})}});Q._set("steps",this._createWorkflowSteps(Q,O));return Q};y._createWorkflowSteps=function(Q,O="awaiting-feature-creation-info"){const {data:A,handles:b}=Q,c=new Map;Q=k.createWorkflowSteps(["awaiting-feature-creation-info",
"awaiting-feature-to-create","editing-new-feature","adding-attachment","editing-attachment"],O,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){A.creationInfo=null;A.edits.feature=null;A.viewModel.featureTemplatesViewModel.select(null);b.add(A.viewModel.featureTemplatesViewModel.on("select",({item:a})=>{a&&(A.creationInfo=a,A.viewModel.activeWorkflow?.next())}),this.id)},async tearDown(){b.remove(this.id)}}),"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",
async setUp(){b.add(await k.setUpFeatureAdd(A.viewModel.sketchViewModel,A.creationInfo,a=>{A.edits.feature=a;A.viewModel.activeWorkflow?.next()},c),this.id)},async tearDown(){b.remove(this.id)}}),"editing-new-feature":()=>({id:"editing-new-feature",async setUp(){const a=A.edits.feature,p=a.sourceLayer,D=A.viewModel,P=D.sketchViewModel;var m=k.findLayerInfo(D.layerInfos,p);const {spatialReference:I}=D.view;D.featureFormViewModel.set({arcadeEditType:"INSERT",feature:a,formTemplate:m?.formTemplate,spatialReference:I});
P.allowDeleteKey=!1;k.prepareAttachmentsForCreateWorkflow(D.attachmentsViewModel);const H=k.getVisualVariableAttributes(a);await k.startUpdatingFeature(P,a,p,H,c);m=P.on("update",async S=>{var F=S.graphics[0];if("complete"===S.state)return k.startUpdatingFeature(P,F,p,H,c);await k.visualVariableInteractiveUpdate(P.view,F,S,H,c);S=F.attributes;g.isSome(H.rotation)&&({field:F}=H.rotation,D.featureFormViewModel.setValue(F,S[F]));g.isSome(H.size)&&({field:F}=H.size,D.featureFormViewModel.setValue(F,S[F]))});
b.add([A.viewModel.featureFormViewModel.on("value-change",async()=>{A.edits.updateAttributes(A.viewModel.featureFormViewModel.getValues());a.attributes=A.edits.feature.attributes;"3d"===P.view.type&&await k.updateGraphicSymbolWhenRequired(a,c)}),m,w.watch(()=>A.viewModel.attachmentsViewModel.mode,S=>{"add"===S&&A.viewModel.activeWorkflow.go("adding-attachment");"edit"===S&&A.viewModel.activeWorkflow.go("editing-attachment")})],this.id)},async tearDown(a){a.cancelled&&A.viewModel.sketchViewModel.layer.removeAll();
b.remove(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){A.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){A.viewModel.attachmentsViewModel.mode="view"}})});return k.avoidFeatureTemplateSelectionWithOnlyOneItem(A,Q)};e._createClass(y,[{key:"shouldShowAttachments",get:function(){return this.data&&this.data.creationInfo&&
this.data.viewModel?k.shouldShowAttachmentsForCreateWorkflow(this.data):!1}},{key:"shouldAllowAttachmentEditing",get:function(){return this.shouldShowAttachments}},{key:"helpMessage",get:function(){if("editing-new-feature"===this.stepId){var {creationInfo:Q,viewModel:O}=this.data;return d.getDrawHelpMessage(Q.layer.geometryType,O.sketchViewModel.createGraphic?.geometry)}}},{key:"reliesOnOwnerAdminPrivileges",get:function(){const {layer:Q}=this.data.creationInfo,O=Q.capabilities?.operations.supportsAdd,
A=f.getEffectiveLayerCapabilities(Q)?.operations.supportsAdd;return f.getEffectiveEditingEnabled(Q)&&!Q.editingEnabled||!!A&&!O}}]);return y}(z);l.__decorate([x.property()],L.prototype,"shouldShowAttachments",null);l.__decorate([x.property()],L.prototype,"shouldAllowAttachmentEditing",null);l.__decorate([x.property()],L.prototype,"helpMessage",null);l.__decorate([x.property()],L.prototype,"reliesOnOwnerAdminPrivileges",null);return L=E=l.__decorate([t.subclass("esri.widgets.Editor.CreateWorkflow")],
L)})},"esri/widgets/Editor/CreateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(e,l,g,w,x,L,N,B){g=function(t){function f(h){h=d.call(this,h);h.creationInfo=null;h.edits=null;h.viewModel=null;return h}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);
l.__decorate([w.property()],g.prototype,"creationInfo",void 0);l.__decorate([w.property()],g.prototype,"edits",void 0);l.__decorate([w.property()],g.prototype,"viewModel",void 0);return g=l.__decorate([B.subclass("esri.widgets.Editor.CreateWorkflowData")],g)})},"esri/widgets/Editor/Edits":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d){function h(n){return L.isNone(n)?null:JSON.stringify(n)}e.Edits=function(n){function z(E){E=k.call(this,E);E._baselineAttributesJSON=null;E._baselineGeometryJSON=null;E.feature=null;return E}l._inherits(z,n);var k=l._createSuper(z);n=z.prototype;n.trackChanges=function(){this.feature&&(this._baselineAttributesJSON=h(this.feature.attributes),this._baselineGeometryJSON=h(this.feature.geometry),this.notifyChange("attributesModified"),this.notifyChange("geometryModified"))};
n.updateAttributes=function(E){const {feature:v}=this;v&&(v.attributes=E,this.notifyChange("attributesModified"))};n.updateGeometry=function(E){const {feature:v}=this;v&&(v.geometry=E,this.notifyChange("geometryModified"))};l._createClass(z,[{key:"attributesModified",get:function(){const {_baselineAttributesJSON:E,feature:v}=this;return!(!v||E===h(v.attributes))}},{key:"geometryModified",get:function(){const {_baselineGeometryJSON:E,feature:v}=this;return!(!v||E===h(v.geometry))}},{key:"modified",
get:function(){return this.attributesModified||this.geometryModified}}]);return z}(x.HandleOwnerMixin(w));g.__decorate([N.property()],e.Edits.prototype,"attributesModified",null);g.__decorate([N.property()],e.Edits.prototype,"feature",void 0);g.__decorate([N.property()],e.Edits.prototype,"geometryModified",null);g.__decorate([N.property()],e.Edits.prototype,"modified",null);e.Edits=g.__decorate([d.subclass("esri.widgets.Editor.Edits")],e.Edits);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Editor/UpdateWorkflow":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/handleUtils ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../../views/support/layerViewUtils ./Edits ./UpdateWorkflowData ./Workflow ./workflowUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v){var y;B=y=function(r){function Q(A){A=O.call(this,A);A.type="update";return A}e._inherits(Q,r);var O=e._createSuper(Q);Q.create=function(A,b,c){A=new y({data:new k({edits:new z.Edits,viewModel:A}),onCommit:async a=>{const p=a.edits.feature;if(p){var D=p.sourceLayer,P=p.clone();if(!a.edits.attributesModified){const m=D.objectIdField;P.attributes={[m]:p.getAttribute(m)}}a.edits.geometryModified||(P.geometry=null);await c(D,{updateFeatures:[P]})}}});A._set("steps",
this._createWorkflowSteps(A,b));return A};r=Q.prototype;r.highlight=function(A){var b=this.data.viewModel.view;b&&A&&(b=A&&b.allLayerViews.items.find(({layer:c})=>c===A.layer||"subtype-sublayer"===A.layer.type&&A.layer.parent===c),n.highlightsSupported(b)&&this.handles.add(b.highlight(A),"candidate-highlight"))};r.unhighlight=function(){this.handles.remove("candidate-highlight")};Q._createWorkflowSteps=function(A,b="awaiting-feature-to-update"){const {data:c,handles:a}=A,p=new Map;return v.createWorkflowSteps(["awaiting-feature-to-update",
"awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],b,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const {spinnerViewModel:D}=c.viewModel,P=c.viewModel.view;let m=null;a.add({remove(){m&&(m.abort(),m=null)}},this.id);c.edits.feature=null;const I=P.on("immediate-click",H=>{D.location=H.mapPoint;D.visible=!0;m?.abort();const {editableItems:S}=c.viewModel;m=new AbortController;(new Promise((F,T)=>{x.onAbort(m?.signal,
()=>T(x.createAbortError()));F(v.fetchCandidates(S,P,H,m?.signal))})).then(F=>{x.throwIfAborted(m);c.candidates=F.reduce((T,M)=>M.error?T:[...T,...M.value],[]);c.viewModel.spinnerViewModel.visible=1===c.candidates.length;0!==c.candidates.length&&(F=c.viewModel.activeWorkflow,1===c.candidates.length?(c.edits.feature=c.candidates[0],F.go("editing-existing-feature").catch(()=>{}).then(()=>c.viewModel.spinnerViewModel.visible=!1)):F.next())})});P.focus();a.add(I,this.id)},async tearDown(){a.remove(this.id)}}),
"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",async setUp(){const {edits:D}=c;D.feature=null;a.add(L.watch(()=>D.feature,P=>{A.unhighlight();A.highlight(P)}),this.id)},async tearDown(){A.unhighlight();a.remove(this.id)}}),"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){if(!a.has("editing-existing-feature")){var D=c.edits.feature,P=c.viewModel.view,{attachmentsViewModel:m,editableItems:I,featureFormViewModel:H,layerInfos:S,sketchViewModel:F}=
c.viewModel;c.editableItem=I.find(R=>R.layer===D.layer);var T=new AbortController;a.add({remove:()=>T.abort()},this.id);var M=v.whenEditorLayerView(P,D.layer),J=v.fetchFullFeature(D,P,T.signal);M=await M;var u=await J;if(!x.isAborted(T)){c.edits.updateGeometry(u.geometry);c.edits.updateAttributes(u.attributes);c.edits.trackChanges();var C=c.editableItem.supports;J=C.includes("create");C=C.includes("update");m.set({abilities:{editing:!0,operations:{add:J||C,update:C,delete:C}},graphic:u,filesEnabled:!1,
mode:"view"});J=v.findLayerInfo(S,u.sourceLayer);H.set({arcadeEditType:"UPDATE",feature:u,formTemplate:J?.formTemplate,spatialReference:P.spatialReference,view:P});var K="createInteractiveEditSession"in M?M.createInteractiveEditSession(D):null;M=[H.on("value-change",R=>{c.edits.updateAttributes(H.getValues());u.attributes=c.edits.feature.attributes;K&&K.setAttribute(R.fieldName,R.value)}),L.watch(()=>m.mode,R=>{"add"===R&&c.viewModel.activeWorkflow.go("adding-attachment");"edit"===R&&c.viewModel.activeWorkflow.go("editing-attachment")})];
K&&(M.push(g.makeHandle(()=>K.rollback())),a.add(g.makeHandle(()=>K.commit()),A._handleKeys.afterCommit));if(c.editableItem.geometryUpdatesEnabled){F.allowDeleteKey=!1;const R=v.getVisualVariableAttributes(u),{interactive:V,visual:X}=await v.setUpGeometryUpdate(u,R,F,P,({geometry:ba,attributes:ea},Y)=>{if(w.isSome(R.rotation)){var {field:ca}=R.rotation;H.setValue(ca,ea[ca])}w.isSome(R.size)&&({field:ca}=R.size,H.setValue(ca,ea[ca]));c.edits.updateAttributes(ea);c.edits.updateGeometry(ba);H.feature.geometry=
ba;("undo"===Y.type||"redo"===Y.type||"update"===Y.type&&w.isSome(Y.toolEventInfo)&&v.isTerminalUpdateEventType(Y.toolEventInfo.type))&&H.notifyFeatureGeometryChanged()},p);M.push(V,X);a.add(V,A._handleKeys.beforeCommit);a.add(X,A._handleKeys.afterCommit)}else A.highlight(u);a.add(M,this.id)}}},async tearDown({cancelled:D}){D&&(A.unhighlight(),a.remove(this.id))}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){c.viewModel.attachmentsViewModel.mode=
"view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){c.viewModel.attachmentsViewModel.mode="view"}})})};e._createClass(Q,[{key:"shouldShowAttachments",get:function(){return!!this.data?.editableItem.attachmentsOnUpdateEnabled}},{key:"shouldAllowAttachmentEditing",get:function(){return!!this.data?.editableItem.supports.includes("update")}},{key:"helpMessage",get:function(){return"awaiting-feature-to-update"===this.stepId?"select":
void 0}},{key:"reliesOnOwnerAdminPrivileges",get:function(){const {layer:A}=this.data.editableItem,b=A.capabilities?.operations.supportsUpdate,c=h.getEffectiveLayerCapabilities(A)?.operations.supportsUpdate;return h.getEffectiveEditingEnabled(A)&&!A.editingEnabled||!!c&&!b}}]);return Q}(E);l.__decorate([N.property()],B.prototype,"shouldShowAttachments",null);l.__decorate([N.property()],B.prototype,"shouldAllowAttachmentEditing",null);l.__decorate([N.property()],B.prototype,"helpMessage",null);l.__decorate([N.property()],
B.prototype,"reliesOnOwnerAdminPrivileges",null);return B=y=l.__decorate([d.subclass("esri.widgets.Editor.UpdateWorkflow")],B)})},"esri/views/support/layerViewUtils":function(){define(["exports","../../core/maybe"],function(e,l){e.extractSafeScaleBounds=function(g){g=g.effectiveScaleRange;return{minScale:g?.minScale??0,maxScale:g?.maxScale??0}};e.highlightsSupported=function(g){return g&&"function"===typeof g.highlight};e.isScaleRangeActive=function(g,w){return l.isSome(g)&&0<g||l.isSome(w)&&0<w};
e.occludeesSupported=function(g){return g&&"function"===typeof g.maskOccludee};e.scaleBoundsPredicate=function(g,w,x){return l.isNone(g)||g>x&&(0===w||g<w)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B){g=function(t){function f(h){h=d.call(this,h);h.candidates=null;h.editableItem=null;h.edits=null;h.viewModel=null;return h}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);l.__decorate([w.property()],g.prototype,"candidates",void 0);l.__decorate([w.property()],g.prototype,"editableItem",void 0);l.__decorate([w.property()],g.prototype,"edits",void 0);l.__decorate([w.property()],g.prototype,"viewModel",void 0);return g=l.__decorate([B.subclass("esri.widgets.Editor.UpdateWorkflowData")],
g)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/Handles ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/MeshSymbol3D ../../symbols/FillSymbol3DLayer".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q,O,A,b,c,a,p,D,P,m,I,H,S,F,T,M,J,u,C,K,R,V,X){function ba(oa){return"polygon"===oa||"rectangle"===oa||"circle"===oa}function ea(oa,za){ca("undo",oa.history.undo,oa.history.redo,za)}function Y(oa,za){ca("redo",oa.history.redo,oa.history.undo,za)}function ca(oa,za,Ga,aa){if(za=za.pop()){var ha=za.updates,ia=[];aa.forEach((fa,ma)=>{ma=ha[ma];null!=ma&&("geometry"in ma&&f.isSome(ma.geometry)&&(ia.push({geometry:fa.geometry}),fa.geometry=ma.geometry),"symbol"in
ma&&f.isSome(ma.symbol)&&(ia.push({symbol:fa.symbol}),fa.symbol=ma.symbol),"undo"in ma&&(ia.push(ma),ma[oa](fa)))});Ga.push({updates:ia})}}function da(oa){return{updates:oa.map(za=>({geometry:za.geometry}))}}function ja(oa){return"requireError"in oa&&"aborted"===oa.requireError}const pa=oa=>Object.freeze(Object.defineProperty({__proto__:null,default:oa},Symbol.toStringTag,{value:"Module"})),sa={defaultZ:0},xa={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,
enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};N=function(oa){function za(aa){aa=Ga.call(this,aa);aa._numUpdating=0;aa._handles=new B;aa._internalGraphicsLayer=new A({listMode:"hide",internal:!0,title:"SVM Internal"});aa._operationHandle=null;aa._viewHandles=new B;aa.activeFillSymbol=null;aa.activeLineSymbol=null;aa.activeVertexSymbol=null;aa.allowDeleteKey=!0;aa.labelOptions=new I;aa.layer=null;aa.pointSymbol=
new C({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});aa.polygonSymbol=new K({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});aa.polylineSymbol=new R({color:[130,130,130,1],width:2});aa.meshSymbol=new V({symbolLayers:[new X]});aa._snappingManager=null;aa.tooltipOptions=new H;aa.updateGraphics=new x;aa.updateOnGraphicClick=!0;aa.vertexSymbol=new C({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});aa._moduleLoaderAbortController=
null;aa._viewReadyAbortController=null;aa._originalAutoOpenEnabled=null;aa.defaultCreateOptions=sa;aa.defaultUpdateOptions=xa;aa.snappingOptions=new F;return aa}l._inherits(za,oa);var Ga=l._createSuper(za);oa=za.prototype;oa.initialize=function(){this._handles.add([h.on(()=>this.view?.map?.layers,"change",aa=>{aa.removed.includes(this.layer)&&this.cancel()}),h.on(()=>this.layer?.graphics,"change",aa=>{if(f.isSome(this._operationHandle))for(const ha of aa.removed)this.updateGraphics.includes(ha)&&
(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(ha):this._operationHandle.cancel())}),h.watch(()=>this.layer?.elevationInfo??null,aa=>{aa!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=aa)},h.syncAndInitial),h.watch(()=>this.view,aa=>{f.destroyMaybe(this._snappingManager);aa&&(this._snappingManager=new S.SnappingManager({view:aa,options:this.snappingOptions}),"2d"===aa.type?new Promise((ha,ia)=>e(["../../views/2d/interactive/editingTools"],
ha,ia)):"3d"===aa.type&&(new Promise((ha,ia)=>e(["../../views/3d/interactive/editingTools"],ha,ia)),new Promise((ha,ia)=>e(["../../views/3d/layers/GraphicsLayerView3D"],fa=>ha(pa(fa)),ia))))},h.syncAndInitial),h.watch(()=>this.view?.spatialReference,(aa,ha)=>{aa&&ha&&!aa.equals(ha)&&this.cancel()})]);T.setupSnappingToggleHandles(this)};oa.destroy=function(){this.cancel();this._handles=f.destroyMaybe(this._handles);this._viewHandles=f.destroyMaybe(this._viewHandles);this._removeDefaultLayer();this._snappingManager=
f.destroyMaybe(this._snappingManager);this._set("view",null);this.emit("destroy")};oa.cancel=function(){this._moduleLoaderAbortController=f.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=f.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()};oa.complete=function(){this._operationHandle&&this._operationHandle.complete()};oa.delete=function(){const {state:aa,updateGraphics:ha}=this;if("active"===aa&&ha.length){const {activeTool:ia,
layer:fa}=this,ma=ha.toArray();fa.removeMany(ma);this.cancel();this._emitDeleteEvent({graphics:ma,tool:ia})}};oa.duplicate=function(){if("active"===this.state&&this.updateGraphics.length){const aa=this.updateGraphics.map(ha=>ha.clone()).toArray();this.layer.addMany(aa);this.emit("duplicate",{graphics:aa,type:"duplicate"});return aa}return[]};oa.create=async function(aa,ha){this.cancel();await this._waitViewReady();const {view:ia,layer:fa}=this;if(!ia||"disabled"===this.state)throw fa||this._logMissingLayer(),
d.createAbortError();f.isSome(ia.activeTool)&&(ia.activeTool=null);if(aa){D.addUniqueLayer(ia,this._internalGraphicsLayer);var ma=await this._setupCreateOperation(aa,ha);f.isNone(ma)||this.destroyed?ia.map.remove(this._internalGraphicsLayer):(ma.on("complete",()=>{if(ma===this._operationHandle){const ua=this.createGraphic,ta=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer);
ma.cancelled||null==ua||fa.add(ua);this.emit("create",{graphic:ua,state:ta?"cancel":"complete",tool:aa,toolEventInfo:null,type:"create"})}}),this._operationHandle=ma,ia.ready&&ia.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")};oa.update=async function(aa,ha){this.cancel();await this._waitViewReady();const {layer:ia,view:fa,state:ma}=this;if(!fa||"disabled"===ma)throw ia||this._logMissingLayer(),d.createAbortError();f.isSome(fa.activeTool)&&(fa.activeTool=null);
const ua=Array.isArray(aa)?aa:[aa];null!=aa&&ua&&ua.length?ua.some(ta=>ta.layer!==ia?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):f.isNone(ta.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(aa=await this._setupUpdateOperation(ua,ha),this.destroyed||f.isNone(aa)||ja(aa)||(D.addUniqueLayer(fa,this._internalGraphicsLayer),
this._setUpdateOperationHandle(aa,ha),this.emit("update",{graphics:ua,state:"start",aborted:!1,tool:aa.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")};oa._updateSpatialReference=async function(aa){const ha=this.view;if(ha){this._beginAsyncOperation();aa=Array.isArray(aa)?aa:[aa];for(const ia of aa)f.isSome(ia.geometry)&&"mesh"!==ia.geometry.type&&!O.equals(ia.geometry.spatialReference,ha.spatialReference)&&(r.canProjectWithoutEngine(ia.geometry.spatialReference,
ha.spatialReference)||r.isLoaded()||await r.load(),ia.geometry=r.project(ia.geometry,ha.spatialReference));this._endAsyncOperation()}else this._logMissingView()};oa.undo=function(){this.canUndo()&&this._operationHandle?.undo()};oa.redo=function(){this.canRedo()&&this._operationHandle?.redo()};oa.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};oa.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};oa.toggleUpdateTool=function(){this._operationHandle&&
this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};oa._getFirstHit=async function(aa){var ha=this.view;if(!ha)return this._logMissingView(),null;if("2d"===ha.type){const fa=[];ha.map.allLayers.forEach(ma=>{"vector-tile"!==ma.type&&"imagery"!==ma.type||fa.push(ma)});ha=await ha.hitTest(aa,{exclude:fa});return M.findFirstGraphicHit(ha.results)}const ia=[ha.map.ground];ha.map.allLayers.forEach(fa=>{"integrated-mesh"===fa.type&&ia.push(fa)});aa=await ha.hitTest(aa,{exclude:ia});if(0<
aa.results.length){const fa=aa.results[0];if(f.isSome(fa)&&"graphic"===fa.type&&fa.graphic&&(!aa.ground.mapPoint||1>ha.map.ground.opacity||aa.ground.distance-f.unwrapOr(fa.distance,0)>-Math.min(3*aa.ground.distance,"global"===ha.viewingMode?y.getReferenceEllipsoid(ha.renderCoordsHelper.spatialReference).radius/ha.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return fa}return null};oa._generateViewHandles=function(aa){return[aa.on("immediate-click",async ha=>{var ia="active"===this.state&&
"create"===this._operationHandle?.type;if("disabled"!==this.state&&!ia&&this.updateOnGraphicClick){this._beginAsyncOperation();var fa=await ha.async(()=>this._getFirstHit(J.createScreenPointFromEvent(ha)));ia=null;f.isSome(fa)?(fa=fa.graphic,this.updateGraphics.includes(fa)||fa.layer===this.layer?(ha.stopPropagation(),ia=fa):"2d"!==aa.type||this._isComponentGraphic(fa)||"active"!==this.state||this.cancel()):"active"===this.state&&this.cancel();f.isSome(ia)&&!this.updateGraphics.includes(ia)&&await this.update([ia],
{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}});this._endAsyncOperation()}},P.ViewEventPriorities.WIDGET)]};oa._setupCreateOperation=async function(aa,ha){const ia=this.view;if(!ia)return this._logMissingView(),null;aa=await this._setupDrawGraphicTool(aa,ia,{hasZ:"3d"===ia.type,...this.defaultCreateOptions,...ha});if(f.isNone(aa))return null;ia.tools.add(aa);ia.activeTool=aa;return this._setupCreateOperationHandle(aa)};oa._setupDrawGraphicTool=async function(aa,
ha,ia){if("multipoint"===aa&&"3d"===ha.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!ha)return this._logMissingView(),null;const fa="rectangle"!==aa,ma="rectangle"!==aa;aa={view:ha,mode:"rectangle"===aa||"circle"===aa?"hybrid":"click",...ia,snapToScene:!1,geometryType:aa,graphicSymbol:this._getGraphicSymbolFromTool(aa),snappingManager:this._snappingManager,forceUniformSize:ma,centered:fa};return"2d"===ha.type?this._makeDrawGraphicTool2D(aa):
this._makeDrawGraphicTool3D(aa)};oa._makeDrawGraphicTool2D=async function(aa){const ha=await this._requireModule(new Promise((ia,fa)=>e(["../../views/2d/interactive/editingTools"],ia,fa)));return ja(ha)||this.destroyed?null:new ha.module.DrawGraphicTool2D({...aa,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:ba(aa.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})};oa._makeDrawGraphicTool3D=
async function(aa){const ha=await this._requireModule(new Promise((fa,ma)=>e(["../../views/3d/interactive/editingTools"],fa,ma)));if(ja(ha)||this.destroyed)return null;const {elevationInfo:ia}=this.layer;return new ha.module.DrawGraphicTool3D({...aa,elevationInfo:ia,snapToScene:f.isSome(ia)?"absolute-height"===ia.mode:!0,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})};oa._setupCreateOperationHandle=function(aa){const ha=this.view;if(!ha)return this._logMissingView(),null;let ia=
null;const fa=aa.forceUniformSize,ma=aa.centered,ua=[ha.on("key-down",qa=>{if(qa.key===m.SKETCH_KEYS.pan)qa.stopPropagation(),qa.repeat||(aa.enabled=!1);else if(qa.key===m.SKETCH_KEYS.complete)qa.stopPropagation(),aa.completeCreateOperation();else if(qa.key!==m.SKETCH_KEYS.vertexAdd||qa.repeat)qa.key===m.SKETCH_KEYS.undo?(qa.stopPropagation(),ta.undo()):qa.key===m.SKETCH_KEYS.redo?(qa.stopPropagation(),ta.redo()):qa.key!==m.SKETCH_KEYS.constraint||"rectangle"!==aa.geometryType&&"circle"!==aa.geometryType||
qa.repeat?qa.key!==m.SKETCH_KEYS.center||qa.repeat||(aa.centered=!ma,qa.stopPropagation()):(aa.forceUniformSize=!fa,qa.stopPropagation());else{const ra=aa.drawOperation.geometryType;if("polyline"===ra||"polygon"===ra||"multipoint"===ra)qa.stopPropagation(),aa.drawOperation.commitStagedVertex()}},P.ViewEventPriorities.WIDGET),ha.on("key-up",qa=>{qa.key===m.SKETCH_KEYS.pan?aa.enabled=!0:qa.key!==m.SKETCH_KEYS.constraint||"rectangle"!==aa.geometryType&&"circle"!==aa.geometryType?qa.key===m.SKETCH_KEYS.center&&
(aa.centered=ma,qa.stopPropagation()):(aa.forceUniformSize=fa,qa.stopPropagation())},P.ViewEventPriorities.WIDGET),aa.on("vertex-add",qa=>{ia=f.isNone(ia)?"start":"active";switch(qa.operation){case "apply":this.emit("create",{graphic:f.unwrap(aa.graphic),state:ia,tool:this.activeTool,toolEventInfo:qa,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[f.unwrap(aa.graphic)],tool:aa.geometryType});break;case "redo":this._emitRedoEvent({graphics:[f.unwrap(aa.graphic)],tool:aa.geometryType})}}),
aa.on("cursor-update",qa=>{0<aa.drawOperation.numCommittedVertices&&this.emit("create",{graphic:f.unwrap(aa.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:qa.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),aa.on("vertex-remove",qa=>{switch(qa.operation){case "apply":this.emit("create",{graphic:f.unwrap(aa.graphic),state:"active",tool:this.activeTool,toolEventInfo:qa,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[f.unwrap(aa.graphic)],tool:aa.geometryType});
break;case "redo":this._emitRedoEvent({graphics:[f.unwrap(aa.graphic)],tool:aa.geometryType})}}),aa.on("complete",qa=>{this._set("createGraphic",f.unwrap(qa.graphic));ia="complete";qa.aborted?ta&&ta.cancel():ta&&ta.complete()}),h.watch(()=>this._getGraphicSymbolFromTool(aa.geometryType),qa=>{aa.graphicSymbol=qa})],ta=new u.CreateOperationHandle({activeComponent:aa,tool:aa.geometryType,type:"create",onEnd:()=>{ua.forEach(qa=>qa.remove());ua.length=0;ha.tools?.remove(aa)},undo:()=>{aa.canUndo&&aa.undo()},
redo:()=>{aa.canRedo&&aa.redo()},canUndo:()=>aa.canUndo,canRedo:()=>aa.canRedo});return ta};oa._getGraphicSymbolFromTool=function(aa){switch(aa){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;case "mesh":return this.meshSymbol}};oa._setupUpdateOperation=async function(aa,ha){const {layer:ia,view:fa}=this;if(!fa)return this._logMissingView(),null;ha={tool:this._defaultUpdateTool,
...this.defaultUpdateOptions,...ha,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...ha?.reshapeOptions}};var ma=ha.tool;for(var ua of aa)ia.remove(ua),ia.add(ua);if("3d"===fa.type){if(0===aa.length)return null;switch(ma){case "move":return this._setupMove3DOperation(aa,ha,fa,ma);case "reshape":if(1<aa.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ma=a.isSupportedGraphic(aa[0]);if(ma===b.SupportedGraphicResult.SUPPORTED)return this._setupReshape3DOperation(aa[0],
ha,fa);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${b.isSupportedGraphicResultMessage(ma)}).`);return null;case "transform":return this._setupGraphicTransform3DOperation(aa,ha,fa)}}switch(ma){case "move":return this._setupMove2DOperation(aa,ha,fa);case "reshape":if(1<aa.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;ua=a.isSupportedGraphic(aa[0]);if(ua===b.SupportedGraphicResult.SUPPORTED)return this._setupTransformOrReshape2DOperation(aa,
ma,ha,fa);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${b.isSupportedGraphicResultMessage(ua)}).`);return null;case "transform":return 1===aa.length&&(ua=f.get(aa[0].geometry,"type"),"point"===ua||"multipoint"===ua)&&(ma="reshape"),this._setupTransformOrReshape2DOperation(aa,ma,ha,fa)}};oa._setupMove3DOperation=async function(aa,ha,ia,fa,ma=!1){for(var ua of aa){const va=c.isSupportedGraphic(ua);if(va!==b.SupportedGraphicResult.SUPPORTED)return this._logError("sketch:move",
`Move operation not supported for provided graphic(s) (${b.isSupportedGraphicResultMessage(va)}).`),null}ua=await this._requireModule(new Promise((va,Aa)=>e(["../../views/3d/interactive/editingTools"],va,Aa)));if(ja(ua))return ua;const ta=new ua.module.GraphicMoveTool({view:ia,enableZ:ha.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});ia.tools.add(ta);ta.graphics.addMany(aa);ma||this.updateGraphics.addMany(aa);const qa=[],ra=new u.UpdateOperationHandle({activeComponent:ta,
tool:fa,type:"update",onEnd:()=>{qa.forEach(va=>va.remove());qa.length=0;ia.tools?.remove(ta);ta.destroyed||ta.destroy()},undo:()=>{ea(ra,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:fa})},redo:()=>{Y(ra,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:fa})},addToSelection:va=>{this.updateGraphics.push(va);ta.graphics.push(va);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{added:[va],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:va=>{const Aa=this.updateGraphics.indexOf(va);ra.history.undo.forEach(Ja=>Ja.updates.splice(Aa,1));ra.history.redo.forEach(Ja=>Ja.updates.splice(Aa,1));this.updateGraphics.remove(va);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[va],type:"selection-change"},type:"update"});0===
this.updateGraphics.length?ra.complete():ta.graphics.remove(va)},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==ha.toggleToolOnClick&&"transform"===fa){var va=this.updateGraphics.getItemAt(0);a.isSupportedGraphic(va)===b.SupportedGraphicResult.SUPPORTED&&(va=await this._setupReshape3DOperation(va,ha,ia,!0),ja(va)||(ra.onEnd(),ra.destroy(),this._setUpdateOperationHandle(va,ha)))}}});qa.push(...this._getHandlesForComponent(ra,ha),ia.on("immediate-click",va=>this._getCommonUpdateOperationClickHandlers(ra,
va,ha),P.ViewEventPriorities.WIDGET),ia.on("key-down",va=>{this._getCommonUpdateOperationKeyDownHandlers(ra,va)},P.ViewEventPriorities.WIDGET));return ra};oa._setupGraphicTransform3DOperation=function(aa,ha,ia,fa=!1){if(1===aa.length&&p.isSupportedGraphic(aa[0])===b.SupportedGraphicResult.SUPPORTED){const ma=aa[0],ua=ma.geometry;if(f.isSome(ua)&&("point"===ua.type||"mesh"===ua.type))return this._setupPointTransform3DOperation(ma,ha,ia);if(f.isSome(ua)&&("polygon"===ua.type||"polyline"===ua.type))return this._setupPolyTransform3DOperation(ma,
ha,ia,fa)}return this._setupMove3DOperation(aa,ha,ia,"transform",fa)};oa._setupPointTransform3DOperation=async function(aa,ha,ia){const {enableRotation:fa,enableScaling:ma,enableZ:ua}=ha,ta=await this._requireModule(new Promise((Aa,Ja)=>e(["../../views/3d/interactive/editingTools"],Aa,Ja)));if(ja(ta))return ta;const qa=new ta.module.GraphicTransformTool({graphic:aa,view:ia,enableRotation:fa,enableScaling:ma,enableZ:ua,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});ia.tools.add(qa);
this.updateGraphics.add(aa);const ra=[],va=new u.UpdateOperationHandle({activeComponent:qa,tool:"transform",type:"update",onEnd:()=>{ra.forEach(Aa=>Aa.remove());ra.length=0;ia.tools?.remove(qa);qa.destroyed||qa.destroy()},undo:()=>{ea(va,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{Y(va,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async Aa=>{this.updateGraphics.add(Aa);
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[Aa],removed:[],type:"selection-change"},type:"update"});Aa=await this._setupMove3DOperation(this.updateGraphics.toArray(),ha,ia,"transform",!0);ja(Aa)||(va.onEnd(),va.destroy(),this._setUpdateOperationHandle(Aa,ha))},removeFromSelection:Aa=>{this.updateGraphics.remove(Aa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{added:[],removed:[Aa],type:"selection-change"},type:"update"});va.complete()},toggleTool:()=>{}});ra.push(...this._getHandlesForComponent(va,ha),ia.on("immediate-click",Aa=>this._getCommonUpdateOperationClickHandlers(va,Aa,ha),P.ViewEventPriorities.WIDGET),ia.on("key-down",Aa=>{this._getCommonUpdateOperationKeyDownHandlers(va,Aa)},P.ViewEventPriorities.WIDGET));return va};oa._setupPolyTransform3DOperation=async function(aa,ha,ia,fa=!1){const {enableRotation:ma,enableScaling:ua,enableZ:ta,
preserveAspectRatio:qa}=ha,ra=await this._requireModule(new Promise((Da,Fb)=>e(["../../views/3d/interactive/editingTools"],Da,Fb)));if(ja(ra))return ra;const va=new ra.module.ExtentTransformTool({graphic:aa,view:ia,enableRotation:ma,enableScaling:ua,enableZ:ta,preserveAspectRatio:qa,tooltipOptions:this.tooltipOptions});ia.tools.add(va);fa||this.updateGraphics.add(aa);const Aa=[],Ja=new u.UpdateOperationHandle({activeComponent:va,tool:"transform",type:"update",onEnd:()=>{Aa.forEach(Da=>Da.remove());
Aa.length=0;ia.tools?.remove(va);va.destroyed||va.destroy()},canUndo:()=>va.canUndo,undo:()=>{va.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},canRedo:()=>va.canRedo,redo:()=>{va.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async Da=>{this.updateGraphics.add(Da);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[Da],removed:[],
type:"selection-change"},type:"update"});Da=await this._setupMove3DOperation(this.updateGraphics.toArray(),ha,ia,"transform",!0);ja(Da)||(Ja.onEnd(),Ja.destroy(),this._setUpdateOperationHandle(Da,ha))},removeFromSelection:Da=>{this.updateGraphics.remove(Da);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[Da],type:"selection-change"},type:"update"});Ja.complete()},toggleTool:async()=>{if(1===this.updateGraphics.length&&
!1!==ha.toggleToolOnClick){var Da=this.updateGraphics.getItemAt(0);a.isSupportedGraphic(Da)===b.SupportedGraphicResult.SUPPORTED&&(Da=await this._setupReshape3DOperation(Da,ha,ia,!0),ja(Da)||(Ja.onEnd(),Ja.destroy(),this._setUpdateOperationHandle(Da,ha)))}}});Aa.push(...this._getHandlesForComponent(Ja,ha),ia.on("immediate-click",Da=>this._getCommonUpdateOperationClickHandlers(Ja,Da,ha),P.ViewEventPriorities.WIDGET),ia.on("key-down",Da=>this._getCommonUpdateOperationKeyDownHandlers(Ja,Da),P.ViewEventPriorities.WIDGET),
ia.on("key-down",Da=>{Da.key!==m.SKETCH_KEYS.constraint||Da.repeat||(va.preserveAspectRatio=!va.preserveAspectRatio,Da.stopPropagation())},P.ViewEventPriorities.WIDGET),ia.on("key-up",Da=>{Da.key===m.SKETCH_KEYS.constraint&&(va.preserveAspectRatio=!va.preserveAspectRatio,Da.stopPropagation())},P.ViewEventPriorities.WIDGET));return Ja};oa._setupMove2DOperation=async function(aa,ha,ia){this.updateGraphics.addMany(aa);await this._updateSpatialReference(aa);const fa=await this._getGraphicMover(aa,ha,
ia);if(ja(fa))return fa;const ma=new u.UpdateOperationHandle({activeComponent:fa,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();qa.forEach(ra=>ra.remove());ta.forEach(ra=>ra.remove());qa=[];ta=[];fa.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const ra=this.updateGraphics.toArray();ea(ma,ra);ma.refreshComponent();this._emitUndoEvent({graphics:ra,tool:"move"})},redo:()=>{const ra=this.updateGraphics.toArray();Y(ma,ra);ma.refreshComponent();
this._emitRedoEvent({graphics:ra,tool:"move"})},addToSelection:async ra=>{await this._updateSpatialReference(ra);this.updateGraphics.push(ra);fa.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ra],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:ra=>{const va=this.updateGraphics.indexOf(ra);ma.history.undo.forEach(Ja=>Ja.updates.splice(va,1));ma.history.redo.forEach(Ja=>
Ja.updates.splice(va,1));this.updateGraphics.remove(ra);const Aa=this.updateGraphics.toArray();this.emit("update",{graphics:Aa,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ra],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ma.complete():fa.graphics=Aa}});let ua=!1,ta=[ia.on("immediate-click",ra=>this._getCommonUpdateOperationClickHandlers(ma,ra,ha),P.ViewEventPriorities.WIDGET),ia.on("key-down",ra=>{this._getCommonUpdateOperationKeyDownHandlers(ma,
ra);ra.key!==m.SKETCH_KEYS.constraint||ra.repeat||(ua=!0,fa.enableMoveAllGraphics=!fa.enableMoveAllGraphics)},P.ViewEventPriorities.WIDGET),ia.on("key-up",ra=>{ra.key===m.SKETCH_KEYS.constraint&&ua&&(ua=!1,fa.enableMoveAllGraphics=!fa.enableMoveAllGraphics)},P.ViewEventPriorities.WIDGET)],qa=this._getHandlesForComponent(ma,ha);return ma};oa._setupReshape3DOperation=async function(aa,ha,ia,fa=!1){const ma=await this._requireModule(new Promise((va,Aa)=>e(["../../views/3d/interactive/editingTools"],
va,Aa)));if(ja(ma))return ma;const ua=ha.reshapeOptions,ta=new ma.module.GraphicReshapeTool({view:ia,graphic:aa,enableZVertex:ha.enableZ&&"move"===ua?.vertexOperation,enableZShape:ha.enableZ&&"move"===ua?.shapeOperation,enableMoveGraphic:"move"===ua?.shapeOperation||"move-xy"===ua?.shapeOperation,enableMidpoints:"split"===ua?.edgeOperation,enableEdgeOffset:"offset"===ua?.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});ia.tools.add(ta);
fa||this.updateGraphics.add(aa);const qa=[],ra=new u.UpdateOperationHandle({activeComponent:ta,tool:"reshape",type:"update",onEnd:()=>{qa.forEach(va=>va.remove());qa.length=0;ia.tools?.remove(ta);ta.destroyed||ta.destroy()},canUndo:()=>ta.canUndo,undo:()=>{ta.undo();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},canRedo:()=>ta.canRedo,redo:()=>{ta.redo();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:async va=>{this.updateGraphics.add(va);
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[va],removed:[],type:"selection-change"},type:"update"});va=await this._setupMove3DOperation(this.updateGraphics.toArray(),ha,ia,"transform",!0);ja(va)||(ra.onEnd(),ra.destroy(),this._setUpdateOperationHandle(va,ha))},removeFromSelection:va=>{this.updateGraphics.remove(va);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{added:[],removed:[va],type:"selection-change"},type:"update"});ra.complete()},toggleTool:async()=>{if(!1!==ha.toggleToolOnClick){var va=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),ha,ia,!0);ja(va)||(ra.onEnd(),ra.destroy(),this._setUpdateOperationHandle(va,ha))}}});qa.push(...this._getHandlesForComponent(ra,ha),ia.on("immediate-click",va=>this._getCommonUpdateOperationClickHandlers(ra,va,ha),P.ViewEventPriorities.WIDGET),ia.on("key-down",va=>{this._getCommonUpdateOperationKeyDownHandlers(ra,
va)},P.ViewEventPriorities.WIDGET));return ra};oa._setupTransformOrReshape2DOperation=async function(aa,ha,ia,fa){this.updateGraphics.addMany(aa);await this._updateSpatialReference(aa);aa="transform"===ha?await this._getBox(aa,ia,fa):await this._getReshape(aa,ia,fa);if(ja(aa))return aa;const ma=new u.UpdateOperationHandle({activeComponent:aa,type:"update",onEnd:()=>{ta.forEach(qa=>qa.remove());ua.forEach(qa=>qa.remove());ta=[];ua=[];ma.activeComponent&&!ma.activeComponent.destroyed&&ma.activeComponent.destroy();
this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{ea(ma,this.updateGraphics.toArray());ma.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ma.tool})},redo:()=>{Y(ma,this.updateGraphics.toArray());ma.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ma.tool})},addToSelection:async qa=>{var ra=ma.activeComponent;if("reshape"===ra?.type){ra=[...this.updateGraphics,qa];this.updateGraphics.removeAll();ra=
await this._setupMove2DOperation(ra,ia,fa);if(ja(ra))return;ma.onEnd();ma.destroy();this._setUpdateOperationHandle(ra,ia)}else this.updateGraphics.add(qa),ra.graphics=this.updateGraphics.toArray(),ra.refresh(),ma.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[qa],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async qa=>{const ra=this.updateGraphics.indexOf(qa);ma.history.undo.forEach(Aa=>
Aa.updates.splice(ra,1));ma.history.redo.forEach(Aa=>Aa.updates.splice(ra,1));this.updateGraphics.remove(qa);const va=this.updateGraphics.toArray();if(0===va.length)ma.complete();else{const Aa=va[0].geometry;1!==va.length||!f.isSome(Aa)||"point"!==Aa.type&&"multipoint"!==Aa.type?ma.activeComponent.graphics=va:ma.toggleTool()}this.emit("update",{graphics:va,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[qa],type:"selection-change"},type:"update"})},toggleTool:async()=>
{if(!(1<this.updateGraphics.length)){var qa=this.updateGraphics.getItemAt(0),ra=qa.geometry;f.isSome(ra)&&("reshape"===ma.tool&&("point"===ra.type||"multipoint"===ra.type)||"transform"===ma.tool&&"extent"===ra.type)||(ra=null,"transform"===ma.tool?ra=await this._getReshape([qa],ia,fa):"reshape"===ma.tool&&(ra=await this._getBox([qa],ia,fa)),ja(ra)||(ma.activeComponent?.destroy(),ma.activeComponent=ra,ma.activeComponent&&(ta.forEach(va=>va.remove()),ta=this._getHandlesForComponent(ma,ia))))}}});let ua=
[fa.on("immediate-click",qa=>this._getCommonUpdateOperationClickHandlers(ma,qa,ia),P.ViewEventPriorities.WIDGET),fa.on("key-down",qa=>{this._getCommonUpdateOperationKeyDownHandlers(ma,qa);qa.key===m.SKETCH_KEYS.constraint&&!qa.repeat&&ma&&(qa=ma.activeComponent)&&"box"===qa.type&&(qa.preserveAspectRatio=!qa.preserveAspectRatio)},P.ViewEventPriorities.WIDGET),fa.on("key-up",qa=>{qa.key===m.SKETCH_KEYS.constraint&&ma&&(qa=ma.activeComponent)&&"box"===qa.type&&(qa.preserveAspectRatio=!qa.preserveAspectRatio)},
P.ViewEventPriorities.WIDGET)],ta=this._getHandlesForComponent(ma,ia);return ma};oa._getGraphicMover=async function(aa,ha,ia){({enableMoveAllGraphics:ha}=ha);const fa=await this._requireModule(new Promise((ma,ua)=>e(["../../views/draw/support/GraphicMover"],ta=>ma(pa(ta)),ua)));return ja(fa)?fa:new fa.module.default({enableMoveAllGraphics:ha,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:aa,view:ia,callbacks:{onGraphicMoveStart:({dx:ma,dy:ua,graphic:ta})=>{this._displayGrabbingCursor();this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:ua,mover:ta,type:"move-start"},type:"update"})},onGraphicMove:({dx:ma,dy:ua,graphic:ta})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:ua,mover:ta,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ma,dy:ua,graphic:ta})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:ua,mover:ta,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})};oa._getBox=async function(aa,ha,ia){const {enableRotation:fa,enableScaling:ma,preserveAspectRatio:ua}=ha;ha=await this._requireModule(new Promise((ta,qa)=>e(["../../views/draw/support/Box"],ra=>ta(pa(ra)),qa)));return ja(ha)?ha:new ha.module.default({graphics:aa,enableRotation:fa,
enableScaling:ma,preserveAspectRatio:ua,layer:this._internalGraphicsLayer,view:ia,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onMove:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onMoveStop:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onScaleStart:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onScale:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onScaleStop:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onRotateStart:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onRotate:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onRotateStop:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...ta},type:"update"})}})};oa._getReshape=async function(aa,ha,ia){const fa="split"===ha.reshapeOptions?.edgeOperation;ha="move"===ha.reshapeOptions?.shapeOperation;const ma=await this._requireModule(new Promise((ua,ta)=>e(["../../views/draw/support/Reshape"],qa=>ua(pa(qa)),ta)));return ja(ma)?ma:new ma.module.default({enableMidpoints:fa,enableMovement:ha,graphic:aa[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:ia,
callbacks:{onReshapeStart:ua=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ua},type:"update"}),onReshape:ua=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ua},type:"update"}),onReshapeStop:({mover:ua,type:ta})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ua,type:ta},
type:"update"}),onMoveStart:({dx:ua,dy:ta,mover:qa,type:ra})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ua,dy:ta,mover:qa,type:ra},type:"update"}),onMove:({dx:ua,dy:ta,mover:qa,type:ra})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ua,dy:ta,mover:qa,type:ra},type:"update"}),onMoveStop:({dx:ua,dy:ta,mover:qa,type:ra})=>this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ua,dy:ta,mover:qa,type:ra},type:"update"}),onVertexAdd:({added:ua,type:ta,vertices:qa})=>{ua=ua.map(ra=>Q.geometryToCoordinates(ra.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:ua,vertices:qa,type:ta},type:"update"})},onVertexRemove:({removed:ua,type:ta,vertices:qa})=>{ua=ua.map(ra=>Q.geometryToCoordinates(ra.geometry));
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:ua,vertices:qa,type:ta},type:"update"})}}})};oa._getHandlesForComponent=function(aa,ha){const ia=aa.activeComponent;if(!ia)return[];switch(ia.type){case "graphic-mover":return[ia.on("graphic-click",({graphic:fa,viewEvent:ma})=>{ma.native?.shiftKey&&(ma.stopPropagation(),aa.removeFromSelection(fa))}),ia.on("graphic-move-start",fa=>aa.addToHistory(da(fa.allGraphics)))];case "box":return[ia.on("graphic-click",
fa=>this._onTransformOrReshape2DGraphicClick(aa,ha,fa)),ia.on("move-start",fa=>aa.addToHistory(da(fa.graphics))),ia.on("rotate-start",fa=>aa.addToHistory(da(fa.graphics))),ia.on("scale-start",fa=>aa.addToHistory(da(fa.graphics)))];case "reshape":return[ia.on("graphic-click",fa=>this._onTransformOrReshape2DGraphicClick(aa,ha,fa)),ia.on("move-start",fa=>aa.addToHistory(da([fa.mover]))),ia.on("reshape-start",fa=>aa.addToHistory(da([fa.graphic]))),ia.on("vertex-add",fa=>aa.addToHistory(da([fa.oldGraphic]))),
ia.on("vertex-remove",fa=>aa.addToHistory(da([fa.oldGraphic])))];case "move-3d":return[ia.on("graphic-move-start",fa=>{aa.addToHistory(da(fa.allGraphics));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<fa.allGraphics.length?fa.allGraphics[0]:null,type:"move-start"},type:"update"})}),ia.on("graphic-move",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{dx:fa.dx,dy:fa.dy,mover:0<fa.allGraphics.length?fa.allGraphics[0]:null,type:"move"},type:"update"})}),ia.on("graphic-move-stop",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<fa.allGraphics.length?fa.allGraphics[0]:null,type:"move-stop"},type:"update"})}),ia.on("immediate-click",fa=>{fa.shiftKey?this._toggleSelection([fa.graphic],aa,ha):aa.toggleTool()})];case "transform-3d":return[ia.on("record-undo",
({record:fa})=>{aa.addToHistory({updates:[fa]})}),ia.on("graphic-translate-start",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,dx:fa.dxScreen,dy:fa.dyScreen,type:"move-start"},type:"update"})}),ia.on("graphic-translate-stop",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,dx:fa.dxScreen,dy:fa.dyScreen,type:"move-stop"},
type:"update"})}),ia.on("graphic-rotate-start",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,angle:fa.angle,type:"rotate-start"},type:"update"})}),ia.on("graphic-rotate-stop",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,angle:fa.angle,type:"rotate-stop"},type:"update"})}),ia.on("graphic-scale-start",fa=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,xScale:fa.xScale,yScale:fa.yScale,type:"scale-start"},type:"update"})}),ia.on("graphic-scale-stop",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,xScale:fa.xScale,yScale:fa.yScale,type:"scale-stop"},type:"update"})}),ia.on("graphic-translate",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,dx:fa.dxScreen,dy:fa.dyScreen,type:"move"},type:"update"})}),ia.on("graphic-rotate",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,angle:fa.angle,type:"rotate"},type:"update"})}),ia.on("graphic-scale",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:fa.graphic,
xScale:fa.xScale,yScale:fa.yScale,type:"scale"},type:"update"})}),ia.on("immediate-click",fa=>{fa.shiftKey?this._toggleSelection([fa.graphic],aa,ha):aa.toggleTool()})];case "reshape-3d":return[ia.on("reshape",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:fa,type:"update"})}),ia.on("move",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:fa,type:"update"})}),
ia.on("vertex-add",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:fa,type:"update"})}),ia.on("vertex-remove",fa=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:fa,type:"update"})}),ia.on("immediate-click",fa=>{fa.shiftKey?this._toggleSelection([fa.graphic],aa,ha):aa.toggleTool()})]}};oa._onTransformOrReshape2DGraphicClick=function(aa,ha,ia){const {graphic:fa,
viewEvent:ma}=ia;if(ma.native?.shiftKey&&fa.layer===this.layer)return ma.stopPropagation(),aa.removeFromSelection(fa);if(ha.toggleToolOnClick)return ma.stopPropagation(),aa.toggleTool()};oa._setUpdateOperationHandle=function(aa,ha){this._operationHandle=aa;const ia=this.view?.map;this._disablePopup(ha);aa.on("complete",()=>{if(aa===this._operationHandle){const fa=this.updateGraphics.toArray(),ma=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());
this.updateGraphics.removeAll();ia&&ia.remove(this._internalGraphicsLayer);this._restorePopup(ha);this.emit("update",{graphics:fa,state:"complete",aborted:aa.cancelled,tool:ma,toolEventInfo:null,type:"update"})}})};oa._getCommonUpdateOperationClickHandlers=async function(aa,ha,ia){const fa=J.createScreenPointFromEvent(ha),ma=await ha.async(()=>this._getFirstHit(fa));f.isNone(ma)?aa.complete():ha.native.shiftKey&&this._toggleSelection([ma.graphic],aa,ia)?ha.stopPropagation():this.updateGraphics.includes(ma.graphic)?
ha.stopPropagation():aa.complete()};oa._toggleSelection=function(aa,ha,ia){const fa=!!ia.multipleSelectionEnabled;return aa.some(ma=>null==ma?!1:fa&&ma.layer===this.layer?(this.updateGraphics.includes(ma)?ha.removeFromSelection(ma):ha.addToSelection(ma),!0):!1)};oa._getCommonUpdateOperationKeyDownHandlers=function(aa,ha){if(aa){var ia=ha.key;ia===m.SKETCH_KEYS.undo&&aa.canUndo()?(ha.stopPropagation(),aa.undo()):ia===m.SKETCH_KEYS.redo&&aa.canRedo()?(ha.stopPropagation(),aa.redo()):ia===m.SKETCH_KEYS.cancel?
(ha.stopPropagation(),aa.cancel()):this.allowDeleteKey&&m.SKETCH_KEYS.delete.includes(ia)&&this._onDeleteKey(ha)}};oa._onDeleteKey=function(aa){if(this._operationHandle&&"update"===this._operationHandle.type){var ha=this.activeComponent,ia=this.updateGraphics.toArray();f.isNone(ha)||"reshape-3d"===ha.type||"reshape"===ha.type&&(1!==ia.length||"point"!==f.get(ia[0].geometry,"type"))||(aa.stopPropagation(),this.delete())}};oa._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),
this._internalGraphicsLayer=f.destroyMaybe(this._internalGraphicsLayer))};oa._isComponentGraphic=function(aa){const {activeComponent:ha}=this;return!aa||f.isNone(ha)?!1:aa.attributes&&aa.attributes.esriSketchTool||"draw-2d"===ha.type&&ha.graphic===aa||("box"===ha.type||"reshape"===ha.type)&&ha.isUIGraphic(aa)};oa._displayPointerCursor=function(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};oa._displayGrabbingCursor=function(){this.view&&this.view.container&&
"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};oa._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};oa._logError=function(aa,ha,ia){t.getLogger(this.declaredClass).error(new L(aa,ha,ia))};oa._requireModule=async function(aa){const ha=new AbortController;this._moduleLoaderAbortController=ha;aa=await aa;return this._moduleLoaderAbortController!==ha||ha.signal.aborted?{requireError:"aborted"}:{module:aa}};oa._emitUndoEvent=
function(aa){this.emit("undo",{...aa,type:"undo"})};oa._emitRedoEvent=function(aa){this.emit("redo",{...aa,type:"redo"})};oa._emitDeleteEvent=function(aa){this.emit("delete",{...aa,type:"delete"})};oa.wait=function(){return h.whenOnce(()=>!this.updating)};oa._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};oa._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};oa._disablePopupEnabled=function(aa){return"3d"!==this.view?.type||this.updateOnGraphicClick||
(f.unwrap(aa)?.toggleToolOnClick??!1)};oa._disablePopup=function(aa){this._disablePopupEnabled(aa)&&(aa=this.view?.popup)&&f.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=aa.autoOpenEnabled,aa.autoOpenEnabled=!1)};oa._restorePopup=function(aa){this._disablePopupEnabled(aa)&&(aa=this.view?.popup)&&f.isSome(this._originalAutoOpenEnabled)&&(aa.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)};oa._waitViewReady=async function(){const aa=this.view;
aa?(f.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await d.whenOrAbort(h.whenOnce(()=>aa?.ready),this._viewReadyAbortController.signal)):this._logMissingView()};oa._logMissingView=function(){this._logError("sketch:missing-property",ya("view"))};oa._logMissingLayer=function(){this._logError("sketch:missing-property",ya("layer"))};l._createClass(za,[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view?.type?"move":"transform"}},{key:"updating",
get:function(){return 0<this._numUpdating||f.isSome(this._snappingManager)&&this._snappingManager.updating}},{key:"activeTool",get:function(){return this._operationHandle?.tool??null}},{key:"activeComponent",get:function(){return this._operationHandle?.activeComponent??null}},{key:"createGraphic",get:function(){return!f.isSome(this.activeComponent)||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):f.unwrap(this.activeComponent.graphic)}},{key:"defaultCreateOptions",
get:function(){return this._get("defaultCreateOptions")},set:function(aa){this._set("defaultCreateOptions",{...sa,...aa})}},{key:"defaultUpdateOptions",get:function(){return this._get("defaultUpdateOptions")},set:function(aa){this._set("defaultUpdateOptions",{...xa,...aa,reshapeOptions:{...xa.reshapeOptions,...aa?.reshapeOptions}})}},{key:"snappingOptions",set:function(aa){f.isSome(this._snappingManager)&&(this._snappingManager.options=aa);this._set("snappingOptions",aa)}},{key:"state",get:function(){const aa=
!(!this.view?.ready||!this.layer),ha=this._operationHandle;return aa&&ha?"active":aa?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(aa){const ha=this._get("view");if(ha){const {container:ia,map:fa}=ha;ia&&(ha.cursor=null);fa&&fa.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._handles.remove("view-ready");aa&&this._handles.add(h.when(()=>aa.ready,ia=>{this._viewHandles.removeAll();ia&&this._viewHandles.add(this._generateViewHandles(aa))},
h.syncAndInitial),"view-ready");this._set("view",aa)}},{key:"test",get:function(){return{operationHandle:this._operationHandle,defaultUpdateOptions:xa}}}]);return za}(N.EventedAccessor);g.__decorate([n.property()],N.prototype,"updating",null);g.__decorate([n.property()],N.prototype,"_operationHandle",void 0);g.__decorate([n.property({readOnly:!0})],N.prototype,"activeTool",null);g.__decorate([n.property()],N.prototype,"activeFillSymbol",void 0);g.__decorate([n.property()],N.prototype,"activeLineSymbol",
void 0);g.__decorate([n.property()],N.prototype,"activeVertexSymbol",void 0);g.__decorate([n.property()],N.prototype,"allowDeleteKey",void 0);g.__decorate([n.property({readOnly:!0})],N.prototype,"createGraphic",null);g.__decorate([n.property()],N.prototype,"defaultCreateOptions",null);g.__decorate([n.property()],N.prototype,"defaultUpdateOptions",null);g.__decorate([n.property({type:I,nonNullable:!0})],N.prototype,"labelOptions",void 0);g.__decorate([n.property()],N.prototype,"layer",void 0);g.__decorate([n.property({types:w.symbolTypes})],
N.prototype,"pointSymbol",void 0);g.__decorate([n.property({types:w.symbolTypes})],N.prototype,"polygonSymbol",void 0);g.__decorate([n.property({types:w.symbolTypes})],N.prototype,"polylineSymbol",void 0);g.__decorate([n.property()],N.prototype,"meshSymbol",void 0);g.__decorate([n.property({type:F,nonNullable:!0})],N.prototype,"snappingOptions",null);g.__decorate([n.property()],N.prototype,"_snappingManager",void 0);g.__decorate([n.property({readOnly:!0})],N.prototype,"state",null);g.__decorate([n.property({type:H,
nonNullable:!0})],N.prototype,"tooltipOptions",void 0);g.__decorate([n.property({readOnly:!0})],N.prototype,"updateGraphics",void 0);g.__decorate([n.property()],N.prototype,"updateOnGraphicClick",void 0);g.__decorate([n.property({types:w.symbolTypes})],N.prototype,"vertexSymbol",void 0);g.__decorate([n.property({value:null})],N.prototype,"view",null);N=g.__decorate([v.subclass("esri.widgets.Sketch.SketchViewModel")],N);const ya=oa=>`Property '${oa}' is missing on SketchViewModel.`;return N})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports",
"../../../../core/has"],function(e,l){e.SupportedGraphicResult=void 0;(function(g){g[g.SUPPORTED=0]="SUPPORTED";g[g.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";g[g.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";g[g.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";g[g.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";g[g.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(e.SupportedGraphicResult||(e.SupportedGraphicResult={}));e.isSupportedGraphicResultMessage=function(g){switch(g){case e.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";
case e.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case e.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case e.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case e.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(e,l,g,w,x){e.isSupportedGraphic=function(L){if("graphics"!==L.layer?.type)return x.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(g.isNone(L.geometry))return x.SupportedGraphicResult.GEOMETRY_MISSING;switch(L.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return x.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;
default:return x.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==w.getGraphicEffectiveElevationMode(L)&&w.hasGraphicFeatureExpressionInfo(L)?x.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:x.SupportedGraphicResult.SUPPORTED};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/maybe","../symbols/support/unitConversionUtils"],function(e,l,g){function w(n,z){return l.isNone(z)||!z.mode?(n?
d:h).mode:z.mode}function x(n,z){return l.isSome(z)?z:n?d:h}function L(n,z){return w(l.isSome(n)?n.hasZ:!1,z)}function N(n){const z=B(n);return L(n.geometry,z)}function B(n){return n.layer&&"elevationInfo"in n.layer?n.layer.elevationInfo:null}function t(n,z,k,E,v,y,r=null){if(!l.isNone(y)){var Q=l.isSome(r)?r.mode:"absolute-height";if("on-the-ground"===Q)return 0;({absoluteZ:y}=f(z,k,E,v,n,y));a:{r=l.isSome(r)&&l.isSome(r.offset)?r.offset:0;switch(Q){case "absolute-height":n=y-r;break a;case "relative-to-ground":n=
y-(l.unwrapOr(n.elevationProvider.getElevation(z,k,E,v,"ground"),0)+r);break a;case "relative-to-scene":n=y-(l.unwrapOr(n.elevationProvider.getElevation(z,k,E,v,"scene"),0)+r);break a}n=void 0}return n}}function f(n,z,k,E,v,y){const r=l.isSome(y.offset)?y.offset:0;switch(y.mode){case "absolute-height":return{absoluteZ:k+r,elevation:0};case "on-the-ground":return k=l.unwrapOr(v.elevationProvider.getElevation(n,z,0,E,"ground"),0),{absoluteZ:k,elevation:k};case "relative-to-ground":return n=l.unwrapOr(v.elevationProvider.getElevation(n,
z,k,E,"ground"),0),{absoluteZ:k+n+r,elevation:n};case "relative-to-scene":return n=l.unwrapOr(v.elevationProvider.getElevation(n,z,k,E,"scene"),0),{absoluteZ:k+n+r,elevation:n}}}const d={mode:"absolute-height",offset:0},h={mode:"on-the-ground",offset:null};e.absoluteHeightElevationInfo=d;e.elevationContextAffectsAlignment=function(n,z){if(l.isNone(z))return!1;({mode:z}=z);return l.isSome(z)&&("scene"===n&&"relative-to-scene"===z||"ground"===n&&"absolute-height"!==z)};e.elevationInfoLikeEquals=function(n,
z){return n===z||l.isSome(n)&&l.isSome(z)&&n.mode===z.mode&&n.offset===z.offset};e.getConvertedElevation=function(n,z,k,E=null){return t(n,z.x,z.y,z.hasZ?z.z:0,z.spatialReference,k,E)};e.getConvertedElevationFromVector=function(n,z,k,E,v=null){return t(n,z[0],z[1],2<z.length?z[2]:0,k,E,v)};e.getEffectiveElevationInfo=x;e.getEffectiveElevationMode=w;e.getGeometryEffectiveElevationInfo=function(n,z){return x(l.isSome(n)?!!n.hasZ:!1,z)};e.getGeometryEffectiveElevationMode=L;e.getGraphicEffectiveElevationInfo=
function(n){var z=B(n);n=L(n.geometry,z);z=l.isSome(z)&&"on-the-ground"!==n?l.unwrapOr(z.offset,0)*g.getMetersPerUnit(l.unwrapOr(z.unit,"meters")):0;return{mode:n,offset:z}};e.getGraphicEffectiveElevationMode=N;e.getZForElevationMode=function(n,z,k){if(!l.isNone(k)&&k.mode){var E=n.hasZ?n.z:0,v=l.isSome(k.offset)?k.offset:0;switch(k.mode){case "absolute-height":return E-v;case "on-the-ground":return 0;case "relative-to-ground":return n=l.unwrapOr(z.elevationProvider.getElevation(n.x,n.y,E,n.spatialReference,
"ground"),0)+v,E-n;case "relative-to-scene":return n=l.unwrapOr(z.elevationProvider.getElevation(n.x,n.y,E,n.spatialReference,"scene"),0)+v,E-n}}};e.hasGraphicFeatureExpressionInfo=function(n){if("on-the-ground"===N(n))return!1;n=B(n);n=l.isSome(n)&&n.featureExpressionInfo?n.featureExpressionInfo.expression:null;return!(!n||"0"===n)};e.onTheGroundElevationInfo=h;e.zValueInAbsoluteHeightMode=f;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/maybe","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(e,l,g,w,x){function L(N){return"graphics"!==N.layer?.type?{result:x.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null}:l.isNone(N.geometry)?{result:x.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null}:"on-the-ground"!==w.getGraphicEffectiveElevationMode(N)&&w.hasGraphicFeatureExpressionInfo(N)?{result:x.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,
geometry:null}:"point"!==N.geometry.type&&"polyline"!==N.geometry.type&&("polygon"!==N.geometry.type||N.geometry instanceof g)?{result:x.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:x.SupportedGraphicResult.SUPPORTED,geometry:N.geometry}}e.geometryOfSupportedGraphic=function(N){return L(N).geometry};e.isSupportedGraphic=function(N){return L(N).result};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z){var k;x=k=function(E){function v(...r){r=y.call(this,...r);r.center=null;r.geodesic=!1;r.numberOfPoints=60;r.radius=1E3;r.radiusUnit="meters";return r}e._inherits(v,E);var y=e._createSuper(v);E=v.prototype;E.normalizeCtorArgs=function(r,Q){if(!r||!r.center){if(r&&r.rings)return e._get(e._getPrototypeOf(v.prototype),"normalizeCtorArgs",this).call(this,r,Q);r={center:r}}return{...e._get(e._getPrototypeOf(v.prototype),"normalizeCtorArgs",this).call(this),...r,...Q}};
E.initialize=function(){var r=this.center;const Q=this.numberOfPoints;this.hasZ=r?.hasZ??!1;if(0===this.rings.length&&r){var O=g.convertUnit(this.radius,this.radiusUnit,"meters"),A=r.spatialReference,b="geographic";if(A.isWebMercator)b="webMercator";else if(null!=(A.wkid&&z[A.wkid])||A.wkt&&0===A.wkt.indexOf("PROJCS"))b="projected";if(this.geodesic){let c;switch(b){case "webMercator":c=n.webMercatorToGeographic(r);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");
break;case "geographic":c=r}r=this._createGeodesicCircle(c,O,Q);"webMercator"===b&&(r=n.geographicToWebMercator(r))}else{let c;"webMercator"===b||"projected"===b?c=O/this._convert2Meters(1,r.spatialReference):"geographic"===b&&(c=g.lengthToDegrees(O,"meters",t.getReferenceEllipsoid(r.spatialReference).radius));r=this._createPlanarCircle(r,c,Q)}this.spatialReference=r.spatialReference;this.addRing(r.rings[0])}};E.clone=function(){const {center:r,numberOfPoints:Q,radius:O,radiusUnit:A,geodesic:b}=this;
return new k({center:r?.clone(),numberOfPoints:Q,radius:O,radiusUnit:A,geodesic:b})};E._createGeodesicCircle=function(r,Q,O){let A=0;const b=[];for(;360>A;){const c=[0,0];h.directGeodeticSolver(c,[r.x,r.y],A,Q);this.hasZ&&c.push(r.z);b.push(c);A+=360/O}b.push(b[0]);return new d(b)};E._createPlanarCircle=function(r,Q,O){const A=[],b=2*Math.PI/O;for(let a=0;a<O;++a){var c=b*a;c=[r.x+Math.cos(-c)*Q,r.y+Math.sin(-c)*Q];this.hasZ&&c.push(r.z);A.push(c)}A.push(A[0]);return new d({spatialReference:r.spatialReference,
rings:[A]})};E._convert2Meters=function(r,Q){if(Q.wkid&&null!=z[Q.wkid])Q=z.values[z[Q.wkid]];else{Q=Q.wkt;const O=Q.lastIndexOf(",")+1,A=Q.lastIndexOf("]]");Q=parseFloat(Q.substring(O,A))}return r*Q};return e._createClass(v)}(d);l.__decorate([w.property({type:f})],x.prototype,"center",void 0);l.__decorate([w.property()],x.prototype,"geodesic",void 0);l.__decorate([w.property()],x.prototype,"numberOfPoints",void 0);l.__decorate([w.property()],x.prototype,"radius",void 0);l.__decorate([w.property()],
x.prototype,"radiusUnit",void 0);return x=k=l.__decorate([B.subclass("esri.geometry.Circle")],x)})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),function(e,l,g,w,x,L,N,B,t,f,d){function h(O){if(!O)return null;if(N.isGeographic(O)&&O.wkid){var A=L.spheroids[O.wkid];if(A)return A}return O.wkt&&
((O=L.WKT_SPHEROID_REGEX.exec(O.wkt))&&2===O.length?(A=O[1].split(","),!A||3>A.length?O=null:(O=parseFloat(A[1]),A=parseFloat(A[2]),O=isNaN(O)||isNaN(A)?null:{a:O,f:0===A?0:1/A})):O=null,O)?O:null}function n(O){O=h(O??d.WGS84);if(null!=O&&"b"in O&&"eSq"in O&&"radius"in O)return O;const A=O.a*(1-O.f);return Object.assign(O,{b:A,eSq:1-(A/O.a)**2,radius:(2*O.a+A)/3,densificationRatio:1E4/((2*O.a+A)/3)})}function z(O){return null!=O&&0>O?O+360:O}function k(O,A,b){const {a:c,eSq:a}=n(b);b=Math.sqrt(a);
const p=Math.sin(A[1]*L.toRadians);A=c*A[0]*L.toRadians;b=0<a?c*(1-a)*(p/(1-a*p*p)-1/(2*b)*Math.log((1-b*p)/(1+b*p)))*.5:c*p;O[0]=A;O[1]=b;return O}function E(O){return null!==h(O)}function v(O,A){if("polyline"!==O.type&&"polygon"!==O.type)throw new w("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:b}=O;if(!E(b))throw new w("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var c="polyline"===
O.type?O.paths:O.rings;const a=[],p=[0,0],D=new Q;for(const I of c){c=[];a.push(c);c.push([I[0][0],I[0][1]]);var P=I[0][0],m=I[0][1];let H,S;for(let F=0;F<I.length-1;F++){H=I[F+1][0];S=I[F+1][1];if(P===H&&m===S)continue;const T=[P,m];r(D,[P,m],[H,S],b);const {azimuth:M,distance:J}=D;P=J/A;if(1<P){for(m=1;m<=P-1;m++)y(p,T,M,m*A,b),c.push(p.slice(0));y(p,T,M,(J+Math.floor(P-1)*A)/2,b);c.push(p.slice(0))}y(p,T,M,J,b);c.push(p.slice(0));P=p[0];m=p[1]}}return"polyline"===O.type?new B({paths:a,spatialReference:b}):
new t({rings:a,spatialReference:b})}function y(O,A,b,c,a){const p=A[0]*L.toRadians;A=A[1]*L.toRadians;b=(b??0)*L.toRadians;const {a:D,b:P,f:m}=n(a);a=Math.sin(b);b=Math.cos(b);var I=(1-m)*Math.tan(A);A=1/Math.sqrt(1+I*I);const H=I*A,S=Math.atan2(I,b);I=A*a;const F=I*I;var T=1-F,M=T*(D*D-P*P)/(P*P);const J=1+M/16384*(4096+M*(-768+M*(320-175*M))),u=M/1024*(256+M*(-128+M*(74-47*M)));M=c/(P*J);let C=2*Math.PI,K,R,V,X;for(;1E-12<Math.abs(M-C);)V=Math.cos(2*S+M),K=Math.sin(M),R=Math.cos(M),X=u*K*(V+u/4*
(R*(-1+2*V*V)-u/6*V*(-3+4*K*K)*(-3+4*V*V))),C=M,M=c/(P*J)+X;c=H*K-A*R*b;T=m/16*T*(4+m*(4-3*T));c=Math.atan2(H*R+A*K*b,(1-m)*Math.sqrt(F+c*c))/L.toRadians;O[0]=(p+(Math.atan2(K*a,A*R-H*K*b)-(1-T)*m*I*(M+T*K*(V+T*R*(-1+2*V*V)))))/L.toRadians;O[1]=c;return O}function r(O,A,b,c){var a=A[0]*L.toRadians;A=A[1]*L.toRadians;var p=b[0]*L.toRadians;b=b[1]*L.toRadians;const {a:D,b:P,f:m,radius:I}=n(c),H=p-a;var S=Math.atan((1-m)*Math.tan(A)),F=Math.atan((1-m)*Math.tan(b));c=Math.sin(S);S=Math.cos(S);const T=
Math.sin(F);F=Math.cos(F);let M=1E3,J=H,u,C,K;let R,V,X;do{var ba=Math.sin(J);var ea=Math.cos(J);K=Math.sqrt(F*ba*F*ba+(S*T-c*F*ea)*(S*T-c*F*ea));if(0===K)return O.distance=0,O.azimuth=void 0,O.reverseAzimuth=void 0,O;ea=c*T+S*F*ea;R=Math.atan2(K,ea);V=S*F*ba/K;C=1-V*V;ba=ea-2*c*T/C;isNaN(ba)&&(ba=0);X=m/16*C*(4+m*(4-3*C));u=J;J=H+(1-X)*m*V*(R+X*K*(ba+X*ea*(-1+2*ba*ba)))}while(1E-12<Math.abs(J-u)&&0<--M);if(0===M)return c=Math.acos(Math.sin(A)*Math.sin(b)+Math.cos(A)*Math.cos(b)*Math.cos(p-a))*I,
a=p-a,O.azimuth=Math.atan2(Math.sin(a)*Math.cos(b),Math.cos(A)*Math.sin(b)-Math.sin(A)*Math.cos(b)*Math.cos(a))/L.toRadians,O.distance=c,O.reverseAzimuth=void 0,O;a=C*(D*D-P*P)/(P*P);A=a/1024*(256+a*(-128+a*(74-47*a)));p=Math.atan2(S*Math.sin(J),S*T*Math.cos(J)-c*F);O.azimuth=Math.atan2(F*Math.sin(J),S*T-c*F*Math.cos(J))/L.toRadians;O.distance=P*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(R-A*K*(ba+A/4*(ea*(-1+2*ba*ba)-A/6*ba*(-3+4*K*K)*(-3+4*ba*ba))));O.reverseAzimuth=p/L.toRadians;return O}let Q=
l._createClass(function(O=0,A,b){this.distance=O;this.azimuth=A;this.reverseAzimuth=b});e.InverseGeodeticSolverResult=Q;e.directGeodeticSolver=y;e.geodesicAreas=function(O,A="square-meters"){if(O.some(p=>!E(p.spatialReference)))throw new w("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const b=[];for(var c=0;c<O.length;c++){var a=O[c];const {radius:p,densificationRatio:D}=n(a.spatialReference);b.push(v(a,p*D))}O=[];c=[0,0];a=[0,0];for(let p=0;p<
b.length;p++){const {rings:D,spatialReference:P}=b[p];let m=0;for(let I=0;I<D.length;I++){const H=D[I];k(c,H[0],P);k(a,H[H.length-1],P);let S=a[0]*c[1]-c[0]*a[1];for(let F=0;F<H.length-1;F++)k(c,H[F+1],P),k(a,H[F],P),S+=a[0]*c[1]-c[0]*a[1];m+=S}m=x.convertUnit(m,"square-meters",A);O.push(m/-2)}return O};e.geodesicDensify=v;e.geodesicDistance=function(O,A,b="meters"){if(!O||!A)throw new w("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!O.spatialReference||!A.spatialReference)throw new w("geodesic-distance:invalid-parameters",
"one or both input points do not have a spatial reference");if(!N.equals(O.spatialReference,A.spatialReference))throw new w("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:c}=O;if(!E(c))throw new w("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(O.x===A.x&&O.y===A.y)return new Q(0,0,0);const a=new Q;r(a,[O.x,O.y],[A.x,A.y],c);a.distance=x.convertUnit(a.distance,"meters",b);a.azimuth=z(a.azimuth);
a.reverseAzimuth=z(a.reverseAzimuth);return a};e.geodesicLengths=function(O,A="meters"){if(!O)throw new w("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(O.some(a=>!E(a.spatialReference)))throw new w("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const b=[];for(let a=0;a<O.length;a++){var c=O[a];const {spatialReference:p}=c;c="polyline"===c.type?c.paths:c.rings;let D=0;for(let P=0;P<c.length;P++){const m=
c[P];let I=0;for(let H=1;H<m.length;H++){const S=m[H-1][0],F=m[H][0],T=m[H-1][1],M=m[H][1];if(T!==M||S!==F){const J=new Q;r(J,[S,T],[F,M],p);I+=J.distance}}D+=I}D=x.convertUnit(D,"meters",A);b.push(D)}return b};e.inverseGeodeticSolver=r;e.isSupported=E;e.pointFromDistance=function(O,A,b){if(!O||null==A||null==b)throw new w("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>b||360<b)throw new w("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");
if(!O.spatialReference)throw new w("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:c}=O;if(!E(c))throw new w("geodesic-distance:not-supported","input geometry spatial reference is not supported");const a=[0,0];y(a,[O.x,O.y],b,A,c);return new f({x:a[0],y:a[1],spatialReference:c})};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../core/maybe","../../../../../support/elevationInfoUtils","../isSupportedGraphicUtils"],function(e,l,g,w,x){e.isSupportedGraphic=function(L){if("graphics"!==L.layer?.type)return x.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(g.isNone(L.geometry))return x.SupportedGraphicResult.GEOMETRY_MISSING;switch(L.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return x.SupportedGraphicResult.SUPPORTED;default:return x.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}const N=
g.isSome(L.symbol)&&"point-3d"===L.symbol.type&&L.symbol.symbolLayers;return N&&0<N.length&&N.some(B=>"object"===B.type)?"on-the-ground"!==w.getGraphicEffectiveElevationMode(L)&&w.hasGraphicFeatureExpressionInfo(L)?x.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:x.SupportedGraphicResult.SUPPORTED:x.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/layerUtils":function(){define(["exports","../../../core/maybe"],
function(e,l){e.addUniqueLayer=function(g,w,x){if(w&&g&&g.map){({map:g}=g);var L=g.layers.find(N=>N===w);L||g.add(w,x);L&&void 0!==x&&null!==x&&g.layers.reorder(L,x)}};e.findLayerView=function(g,w){return g.allLayerViews.find(x=>{x=x.layer;return x===w||"sublayers"in x&&l.isSome(x.sublayers)&&x.sublayers.includes(w)})};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(e){e.SKETCH_KEYS={redo:"r",undo:"z",center:"Alt",
constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};e.SNAPPING_KEYS={toggle:"Control"};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B){g=function(t){function f(h){h=d.call(this,h);h.enabled=!1;return h}e._inherits(f,t);var d=e._createSuper(f);return e._createClass(f)}(g);l.__decorate([w.property({type:Boolean,nonNullable:!0})],g.prototype,"enabled",void 0);return g=l.__decorate([B.subclass("esri.views.interactive.sketch.SketchLabelOptions")],g)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(e,l,g,w,x,L,N,B,t,f){g=function(d){function h(z){z=n.call(this,z);z.enabled=!1;z.elevation=new t.SketchTooltipElevationOptions;z.visibleElements=new f.SketchTooltipVisibleElements;z.visualVariables=null;return z}e._inherits(h,d);var n=e._createSuper(h);h.prototype.toJSON=function(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}};return e._createClass(h)}(g);l.__decorate([w.property({type:Boolean,nonNullable:!0})],g.prototype,"enabled",void 0);l.__decorate([w.property({type:t.SketchTooltipElevationOptions,
nonNullable:!0})],g.prototype,"elevation",void 0);l.__decorate([w.property({type:f.SketchTooltipVisibleElements,nonNullable:!0})],g.prototype,"visibleElements",void 0);l.__decorate([w.property()],g.prototype,"visualVariables",void 0);return g=l.__decorate([B.subclass("esri.widgets.Sketch.SketchTooltipOptions")],g)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B,t){e.SketchTooltipElevationOptions=function(f){function d(n){n=h.call(this,n);n.mode="absolute-height";return n}l._inherits(d,f);var h=l._createSuper(d);d.prototype.toJSON=function(){return{mode:this.mode}};return l._createClass(d)}(w);g.__decorate([x.property({type:String,nonNullable:!0})],e.SketchTooltipElevationOptions.prototype,"mode",void 0);e.SketchTooltipElevationOptions=g.__decorate([t.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],e.SketchTooltipElevationOptions);
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),function(e,l,g,w,x,L,N,B,t){e.SketchTooltipVisibleElements=function(f){function d(){var n=
h.apply(this,arguments);n.distance=!0;n.elevation=!0;n.size=!0;n.scale=!0;n.rotation=!0;n.orientation=!0;n.totalLength=!0;n.area=!0;n.radius=!0;n.helpMessage=!1;return n}l._inherits(d,f);var h=l._createSuper(d);d.prototype.toJSON=function(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}};return l._createClass(d)}(w);g.__decorate([x.property({type:Boolean,nonNullable:!0})],
e.SketchTooltipVisibleElements.prototype,"distance",void 0);g.__decorate([x.property({type:Boolean,nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,"elevation",void 0);g.__decorate([x.property({type:Boolean,nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,"size",void 0);g.__decorate([x.property({type:Boolean,nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,"scale",void 0);g.__decorate([x.property({type:Boolean,nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,
"rotation",void 0);g.__decorate([x.property({type:Boolean,nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,"orientation",void 0);g.__decorate([x.property({type:Boolean,nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,"totalLength",void 0);g.__decorate([x.property({type:Boolean,nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,"area",void 0);g.__decorate([x.property({type:Boolean,nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,"radius",void 0);g.__decorate([x.property({type:Boolean,
nonNullable:!0})],e.SketchTooltipVisibleElements.prototype,"helpMessage",void 0);e.SketchTooltipVisibleElements=g.__decorate([t.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],e.SketchTooltipVisibleElements);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingManager":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Evented ../../../core/HandleOwner ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ./Settings ./SnappingDomain ./snappingFactory ./SnappingOptions ./SnappingPoint ./snappingUtils ./candidates/IntersectionSnappingCandidate ../support/viewUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q,O,A,b){function c({coordinateHelper:p,elevationInfo:D}){return p.hasZ()?k.absoluteHeightElevationInfo:D}e.SnappingManager=function(p){function D(m){m=P.call(this,m);m.options=new r;m.snappingEnginesFactory=y.defaultSnappingEnginesFactory;m._engines=[];m._currentMainCandidate=null;m._currentOtherActiveCandidates=[];m._currentSnappedType=a.MAIN;return m}l._inherits(D,p);var P=l._createSuper(D);p=D.prototype;p.initialize=function(){this.handles.add([B.watch(()=>
{const {effectiveFeatureEnabled:m,effectiveSelfEnabled:I,touchSensitivityMultiplier:H,distance:S}=this.options;return{effectiveFeatureEnabled:m,effectiveSelfEnabled:I,touchSensitivityMultiplier:H,distance:S}},()=>{this.doneSnapping();this.emit("changed")},B.sync),B.watch(()=>this.options,m=>{for(const I of this._engines)I.options=m},B.sync),B.watch(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:m,snappingEnginesFactory:I})=>
this._recreateEngines(m,I),B.syncAndInitial)])};p.destroy=function(){this._destroyEngines()};p._recreateEngines=function(m,I){this._destroyEngines();if(m){var {view:H,options:S}=this;this._engines=I(H,S)}};p._destroyEngines=function(){for(const m of this._engines)m.destroy();this._engines=[]};p.snap=async function(m){return L.isSome(m.scenePoint)?this._snapMultiPoint(m):this._snapSinglePoint(m)};p.update=function(m){const {point:I,context:H}=m;this._removeVisualization();const S=this._currentMainCandidate;
if(L.isNone(S))return I;var F=this._selectUpdateInput(m);if(L.isNone(F))return I;({spatialReference:m}=H);var T=z.project(F,m);if(L.isNone(T))return I;({view:F}=this);const {elevationInfo:M,visualizer:J}=H,u=[];T=Q.pointToSnappingPoint(T,F,H);const C=S.constraint.closestTo(T);if(!this._arePointsWithinScreenThreshold(T,C,H))return this._resetSnappingState(),I;S.targetPoint=C;u.push(...S.hints);for(const K of this._currentOtherActiveCandidates)K.targetPoint=C,u.push(...K.hints);L.isSome(J)&&this.handles.add(J.draw(u,
{spatialReference:m,elevationInfo:c(H),view:F,selfSnappingZ:H.selfSnappingZ}),"visualization-handle");return Q.snappingPointToSnappingOutput(C,F,{z:I.z,m:I.m,spatialReference:I.spatialReference,elevationInfo:M})};p.doneSnapping=function(){this._removeVisualization();this._resetSnappingState()};p._selectUpdateInput=function({point:m,scenePoint:I}){switch(this._currentSnappedType){case a.MAIN:return m;case a.SCENE:return I}};p._resetSnappingState=function(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=
[];this._currentSnappedType=a.MAIN};p._removeVisualization=function(){this.handles.remove("visualization-handle")};p._snapSinglePoint=async function({point:m,context:I,signal:H}){const {view:S}=this,F=Q.pointToSnappingPoint(m,S,I),T=await this._fetchCandidates(F,v.SnappingDomain.ALL,I,H);return this._createSnapResult(F,a.MAIN,T,S,I,{z:m.z,m:m.m,spatialReference:m.spatialReference,elevationInfo:I.elevationInfo},H)};p._snapMultiPoint=async function({point:m,scenePoint:I,context:H,signal:S}){const {view:F}=
this,{coordinateHelper:T,spatialReference:M}=H;await z.initializeProjection(I.spatialReference,M);I=z.project(I,M);var J=Q.pointToSnappingPoint(I,F,H);const u=await this._fetchCandidates(J,v.SnappingDomain.FEATURE,H,S);if(0<u.length)return m=await this._fetchCandidates(J,v.SnappingDomain.SELF,H,S),this._createSnapResult(J,a.SCENE,[...u,...m],F,H,{z:I.z,m:I.m,spatialReference:I.spatialReference,elevationInfo:H.elevationInfo},S);I=Q.pointToSnappingPoint(m,F,H);J=await this._fetchCandidates(I,v.SnappingDomain.SELF,
H,S);return this._createSnapResult(I,a.MAIN,J,F,H,{z:T.hasZ()&&m.hasZ?m.z??0:void 0,m:T.hasM()&&m.hasM?m.m??0:void 0,spatialReference:m.spatialReference,elevationInfo:H.elevationInfo},S)};p._fetchCandidates=async function(m,I,H,S){return(await Promise.all(this._engines.map(F=>F.fetchCandidates(m,I,H,S)))).flat()};p._createSnapResult=function(m,I,H,S,F,T,M){return{get valid(){return!N.isAborted(M)},apply:()=>{const {spatialReference:J}=F,{snappedPoint:u,hints:C}=this._processCandidates(m,I,H,F);this._removeVisualization();
L.isSome(F.visualizer)&&this.handles.add(F.visualizer.draw(C,{spatialReference:J,elevationInfo:k.absoluteHeightElevationInfo,view:S,selfSnappingZ:F.selfSnappingZ}),"visualization-handle");return Q.snappingPointToSnappingOutput(u,S,T)}}};p._processCandidates=function(m,I,H,S){if(1>H.length)return this.doneSnapping(),{snappedPoint:m,hints:[]};this._currentSnappedType!==I&&this._resetSnappingState();O.sortCandidatesInPlace(m,H);const F=this._currentMainCandidate;if(L.isSome(F)){const T=this._findOldConstraintInNewCandidates(F,
H);if(0<=T)if(H[T]instanceof A.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(m,F.targetPoint,S))return this._updateSnappingCandidate(F,I,H,S)}else return this._intersectWithOtherCandidates(T,H,m,I,S)}return this._intersectWithOtherCandidates(0,H,m,I,S)};p._findOldConstraintInNewCandidates=function(m,I){return m instanceof A.IntersectionSnappingCandidate?0<=this._findOldCandidateIndex(I,m.first)&&0<=this._findOldCandidateIndex(I,m.second)?0:-1:this._findOldCandidateIndex(I,
m)};p._intersectWithOtherCandidates=function(m,I,H,S,F){const {coordinateHelper:T}=F,M=I[m],J=[];for(let u=0;u<I.length;++u){if(u===m)continue;const C=I[u];for(const K of M.constraint.intersect(C.constraint)){const R=K.closestTo(M.targetPoint);J.push([new A.IntersectionSnappingCandidate(R,M,C,C.isDraped),this._squaredScreenDistance(H,R,T)])}}return 0<J.length&&(J.sort((u,C)=>u[1]-C[1]),J[0][1]<this._squaredPointProximityThreshold(F.pointer))?this._updateSnappingCandidate(J[0][0],S,I,F):this._updateSnappingCandidate(M,
S,I,F)};p._updateSnappingCandidate=function(m,I,H,S){this.doneSnapping();this._currentMainCandidate=m;this._currentSnappedType=I;I=this._currentMainCandidate.targetPoint;const F=[];F.push(...m.hints);for(const T of H){if(m instanceof A.IntersectionSnappingCandidate){if(T.constraint.equals(m.first.constraint)||T.constraint.equals(m.second.constraint))continue}else if(T.constraint.equals(m.constraint))continue;H=T.constraint.closestTo(I);this._squaredScreenDistance(H,I,S.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&
(T.targetPoint=I,this._currentOtherActiveCandidates.push(T),F.push(...T.hints))}return{snappedPoint:I,hints:F}};p._squaredPointProximityThreshold=function(m){return"touch"===m?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold};p._arePointsWithinScreenThreshold=function(m,I,H){return this._squaredScreenDistance(m,I,H.coordinateHelper)<this._squaredPointProximityThreshold(H.pointer)};p._squaredScreenDistance=function(m,I,H){return O.squaredScreenDistance(this._toScreen(m,H),this._toScreen(I,
H))};p._toScreen=function(m,I){return b.vectorToScreenPoint(m,I.spatialReference,k.absoluteHeightElevationInfo,this.view)};p._findOldCandidateIndex=function(m,I){let H=-1;for(let S=0;S<m.length;++S)if(I.constraint.equals(m[S].constraint)){H=S;break}return H};l._createClass(D,[{key:"updating",get:function(){return this._engines.some(m=>m.updating)}},{key:"_squaredMouseProximityTreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:m,
touchSensitivityMultiplier:I}=this.options,H=m*I;return H*H}},{key:"_squaredSatisfiesConstraintThreshold",get:function(){return E.defaults.satisfiesConstraintScreenThreshold*E.defaults.satisfiesConstraintScreenThreshold}},{key:"test",get:function(){return{visualizationsActive:this.handles.has("visualization-handle"),engines:this._engines}}}]);return D}(w.EventedMixin(x.HandleOwner));g.__decorate([t.property({constructOnly:!0})],e.SnappingManager.prototype,"view",void 0);g.__decorate([t.property()],
e.SnappingManager.prototype,"options",void 0);g.__decorate([t.property({readOnly:!0})],e.SnappingManager.prototype,"updating",null);g.__decorate([t.property()],e.SnappingManager.prototype,"snappingEnginesFactory",void 0);g.__decorate([t.property()],e.SnappingManager.prototype,"_engines",void 0);g.__decorate([t.property()],e.SnappingManager.prototype,"_squaredMouseProximityTreshold",null);g.__decorate([t.property()],e.SnappingManager.prototype,"_squaredTouchProximityThreshold",null);g.__decorate([t.property()],
e.SnappingManager.prototype,"_squaredSatisfiesConstraintThreshold",null);e.SnappingManager=g.__decorate([n.subclass("esri.views.interactive.snapping.SnappingManager")],e.SnappingManager);var a;(function(p){p[p.MAIN=0]="MAIN";p[p.SCENE=1]="SCENE"})(a||(a={}));Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N){let B=function(t){function f(){var h=d.apply(this,arguments);h.enabled=!0;return h}l._inherits(f,t);var d=l._createSuper(f);return l._createClass(f)}(x.JSONSupport);g.__decorate([L.property({type:Boolean})],B.prototype,"enabled",void 0);B=g.__decorate([N.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],B);x=function(t){function f(h){h=d.call(this,h);h.lineSnapper=new B;h.parallelLineSnapper=new B;h.rightAngleSnapper=new B;h.rightAngleTriangleSnapper=
new B;h.shortLineThreshold=15;h.distance=5;h.pointThreshold=1E-6;h.intersectionParallelLineThreshold=1E-6;h.parallelLineThreshold=1E-6;h.verticalLineThreshold=.1;h.touchSensitivityMultiplier=1.5;h.pointOnLineThreshold=1E-6;h.orange=new w([255,127,0]);h.orangeTransparent=new w([255,127,0,.5]);h.lineHintWidthReference=3;h.lineHintWidthTarget=3;h.lineHintFadedExtensions=.3;h.parallelLineHintWidth=2;h.parallelLineHintLength=24;h.parallelLineHintOffset=1.5;h.rightAngleHintSize=24;h.rightAngleHintOutlineSize=
1.5;h.satisfiesConstraintScreenThreshold=1;return h}l._inherits(f,t);var d=l._createSuper(f);return l._createClass(f)}(x.JSONSupport);g.__decorate([L.property({type:B,constructOnly:!0,nonNullable:!0,json:{write:!0}})],x.prototype,"lineSnapper",void 0);g.__decorate([L.property({type:B,constructOnly:!0,nonNullable:!0,json:{write:!0}})],x.prototype,"parallelLineSnapper",void 0);g.__decorate([L.property({type:B,constructOnly:!0,nonNullable:!0,json:{write:!0}})],x.prototype,"rightAngleSnapper",void 0);
g.__decorate([L.property({type:B,constructOnly:!0,nonNullable:!0,json:{write:!0}})],x.prototype,"rightAngleTriangleSnapper",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],x.prototype,"shortLineThreshold",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],x.prototype,"distance",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],
x.prototype,"pointThreshold",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],x.prototype,"intersectionParallelLineThreshold",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],x.prototype,"parallelLineThreshold",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],x.prototype,"verticalLineThreshold",void 0);g.__decorate([L.property({type:Number,
nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],x.prototype,"touchSensitivityMultiplier",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],x.prototype,"pointOnLineThreshold",void 0);g.__decorate([L.property({type:w,nonNullable:!0})],x.prototype,"orange",void 0);g.__decorate([L.property({type:w,nonNullable:!0})],x.prototype,"orangeTransparent",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
x.prototype,"lineHintWidthReference",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],x.prototype,"lineHintWidthTarget",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],x.prototype,"lineHintFadedExtensions",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],x.prototype,"parallelLineHintWidth",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,
range:{min:0,max:50},json:{write:!0}})],x.prototype,"parallelLineHintLength",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],x.prototype,"parallelLineHintOffset",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],x.prototype,"rightAngleHintSize",void 0);g.__decorate([L.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],x.prototype,"rightAngleHintOutlineSize",void 0);g.__decorate([L.property({type:Number,
nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],x.prototype,"satisfiesConstraintScreenThreshold",void 0);x=g.__decorate([N.subclass("esri.views.interactive.snapping.Settings.Defaults")],x);g=new x;e.defaults=g;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(e){e.SnappingDomain=void 0;var l=e.SnappingDomain||(e.SnappingDomain={});l[l.FEATURE=1]="FEATURE";l[l.SELF=2]="SELF";l[l.ALL=3]="ALL";
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingFactory":function(){define(["exports","./FeatureSnappingEngine","./SelfSnappingEngine"],function(e,l,g){e.defaultSnappingEnginesFactory=function(w,x){return[new g.SelfSnappingEngine({view:w,options:x}),new l.FeatureSnappingEngine({view:w,options:x,spatialReference:w.spatialReference})]};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/FeatureSnappingEngine":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/HandleOwner ../../../core/Handles ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../chunks/common ../../../layers/graphics/data/QueryEngineResult ../../../support/elevationInfoUtils ./SnappingConstraint ./SnappingDomain ./SnappingPoint ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/FeatureSnappingCandidate ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q,O,A,b,c,a,p,D,P,m,I){function H({constraint:{start:J,end:u}}){const C=v.squaredDistance(J,u);J=E.squaredDistance(J,u);return C<r.getEpsilon()||1E-4>J/C}function S(J,u,C,K,R,V,{spatialReference:X}){u=v.copy(M,u);u[0]+=C;u[1]+=K;u[2]+=R;return(C=I.vectorToScreenPoint(u,X,O.absoluteHeightElevationInfo,V))?a.screenDistance(C,J):Infinity}l.FeatureSnappingEngine=function(J){function u(K){K=C.call(this,K);K.options=null;K._domain=b.SnappingDomain.FEATURE;
K._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}};return K}g._inherits(u,J);var C=g._createSuper(u);J=u.prototype;J.initialize=function(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),f.sync);B.isSome(this.view)&&this.handles.add([this.view.on("layerview-create",K=>this._updateLayerView(K.layer,K.layerView)),
this.view.on("layerview-destroy",K=>this._updateLayerView(K.layer,null))])};J._updateLayerView=function(K,R){for(const [,V]of this.snappingSources)V.snappingSource.layerSource.layer===K&&(V.layerView=R)};J.destroy=function(){this._set("options",null);for(const [,K]of this.snappingSources)K.destroy()};J.fetchCandidates=async function(K,R,V,X){if(!(R&this._domain)||B.isNone(this.options)||!this.options.effectiveFeatureEnabled)return[];var ba=[];R=this._computeScreenSizeDistanceParameters(K,V);const ea=
{distance:R,mode:B.unwrap(this.view)?.type??"2d",point:K,coordinateHelper:V.coordinateHelper,types:this._types};for(const [,{snappingSource:Y,layerView:ca}]of this.snappingSources)!Y.layerSource.enabled||B.isSome(ca)&&ca.suspended||ba.push(Y.fetchCandidates(ea,X).then(da=>da.filter(ja=>!this._candidateIsExcluded(Y,ja,V.excludeFeature))));ba=(await t.eachAlwaysValues(ba)).flat();this._addRightAngleCandidates(ba,K,R,V);t.throwIfAborted(X);a.sortCandidatesInPlace(K,ba);return ba};J._addRightAngleCandidates=
function(K,R,V,X){var ba=B.isSome(X.vertexHandle)?X.vertexHandle.rightEdge?.rightVertex?.pos:B.isSome(X.editGeometryOperations)&&"polygon"===X.editGeometryOperations.data.type?B.unwrap(X.editGeometryOperations.data.components[0]?.getFirstVertex())?.pos:null,ea=B.isSome(X.vertexHandle)?X.vertexHandle.leftEdge?.leftVertex?.pos:B.isSome(X.editGeometryOperations)?B.unwrap(X.editGeometryOperations.data.components[0]?.getLastVertex())?.pos:null,{view:Y}=this;ba=c.anyMapPointToSnappingPoint(ba,Y,X);X=c.anyMapPointToSnappingPoint(ea,
Y,X);ea=K.length;for(Y=0;Y<ea;Y++)this._addRightAngleCandidate(K[Y],X,R,V,K),this._addRightAngleCandidate(K[Y],ba,R,V,K)};J._addRightAngleCandidate=function(K,R,V,X,ba){var ea;(ea=B.isNone(R))||(ea=!((K instanceof D.EdgeSnappingCandidate||K instanceof p.DrapedEdgeSnappingCandidate)&&!H(K)));if(!ea){ea=K.constraint.closestTo(R);var Y=(ea[0]-V[0])/X.x;V=(ea[1]-V[1])/X.y;var {start:ca,end:da}=K.constraint;1>=Y*Y+V*V&&(K=new m.RightAngleSnappingCandidate({targetPoint:ea,otherVertex:R,otherVertexType:m.OtherVertexType.NEXT,
previousVertex:E.squaredDistance(ea,ca)>E.squaredDistance(ea,da)?ca:da,constraint:new A.VerticalHalfPlaneConstraint(R,ea),objectId:K.objectId,isDraped:K.isDraped}),ba.push(K))}};J._computeScreenSizeDistanceParameters=function(K,R){let V=B.isSome(this.options)?this.options.distance*("touch"===R.pointer?this.options.touchSensitivityMultiplier:1):0;return B.isNone(this.view)?{x:V,y:V,z:V,distance:V}:"2d"===this.view.type?(V*=this.view.resolution,{x:V,y:V,z:V,distance:V}):this._computeScreenSizeDistanceParameters3D(K,
V,this.view,R)};J._computeScreenSizeDistanceParameters3D=function(K,R,V,X){var {spatialReference:ba}=X;V.renderCoordsHelper.toRenderCoords(K,ba,T);const ea=V.state.camera.computeScreenPixelSizeAt(T),Y=ea*V.renderCoordsHelper.unitInMeters/V.mapCoordsHelper.unitInMeters,ca=R*Y,da=I.vectorToScreenPoint(K,ba,O.absoluteHeightElevationInfo,V);ba=da?S(da,K,Y,0,0,V,X):0;const ja=da?S(da,K,0,Y,0,V,X):0;K=da?S(da,K,0,0,Y,V,X):0;return{x:0===ba?0:ca/ba,y:0===ja?0:ca/ja,z:0===K?0:ca/K,distance:ea*R}};J._candidateIsExcluded=
function(K,R,V){if(B.isNone(V))return!1;R=this._getCandidateObjectId(R);if(B.isNone(R))return!1;K=K.layerSource.layer;return"graphics"===K.type?V.uid===R:V.sourceLayer===K&&V.attributes&&"objectIdField"in K?V.attributes[K.objectIdField]===R:!1};J._getCandidateObjectId=function(K){return K instanceof P.FeatureSnappingCandidate?K.objectId:null};J._createSourceInfo=function(K){const R=this._createFeatureSnappingSourceType(K);if(B.isNone(R))return null;if("loading"in R)return this.updatingHandles.addPromise(R.loading.then(()=>
{this.destroyed||this.notifyChange("snappingSources")})),null;const V=B.isSome(this.view)?this.view.allLayerViews.find(X=>X.layer===K.layer):null;return new F(R.source,V)};J._createFeatureSnappingSourceType=function(K){switch(K.layer.type){case "feature":case "geojson":case "csv":case "oriented-imagery":case "subtype-group":case "wfs":return this._createFeatureSnappingSourceFeatureLayer(K);case "graphics":return this._createFeatureSnappingSourceGraphicsLayer(K);case "map-notes":return this._createFeatureSnappingSourceMapNotesLayer(K);
case "scene":case "building-scene":return this._createFeatureSnappingSourceSceneLayer(K)}return null};J._createFeatureSnappingSourceSceneLayer=function(K){const {view:R}=this;if(B.isNone(R)||"3d"!==R.type)return null;const V=this._getSourceModule("scene");return B.isSome(V.module)?{source:new V.module.SceneLayerSnappingSource({layerSource:K,view:R})}:{loading:V.loader}};J._createFeatureSnappingSourceFeatureLayer=function(K){switch(K.layer.source?.type){case "feature-layer":case "oriented-imagery":var R=
this._getSourceModule("featureService");return B.isSome(R.module)?{source:new R.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:K})}:{loading:R.loader};case "memory":case "csv":case "geojson":case "wfs":if("mesh"!==K.layer.geometryType)return R=this._getSourceModule("featureCollection"),B.isSome(R.module)?{source:new R.module.FeatureCollectionSnappingSource({layerSource:K,view:this.view})}:{loading:R.loader}}return null};J._createFeatureSnappingSourceGraphicsLayer=
function(K){const R=this._getSourceModule("graphics");return B.isSome(R.module)?{source:new R.module.GraphicsSnappingSource({getGraphicsLayers:()=>[K.layer],spatialReference:this.spatialReference,view:this.view,layerSource:K})}:{loading:R.loader}};J._createFeatureSnappingSourceMapNotesLayer=function(K){const R=this._getSourceModule("notes");return B.isSome(R.module)?{source:new R.module.GraphicsSnappingSource({getGraphicsLayers:()=>B.isSome(K.layer.sublayers)?K.layer.sublayers.toArray():[],spatialReference:this.spatialReference,
view:this.view,layerSource:K})}:{loading:R.loader}};J._getSourceModule=function(K){const R=this._sourceModules[K];return B.isNone(R.loader)?(K=this._loadSourceModule(K).then(V=>{R.module=V}),R.loader=K,{module:R.module,loader:K}):{module:R.module,loader:R.loader}};J._loadSourceModule=function(K){const R=this.updatingHandles;switch(K){case "featureService":return R.addPromise(new Promise((V,X)=>e(["./featureSources/FeatureServiceSnappingSource"],V,X)));case "featureCollection":return R.addPromise(new Promise((V,
X)=>e(["./featureSources/FeatureCollectionSnappingSource"],V,X)));case "graphics":return R.addPromise(new Promise((V,X)=>e(["./featureSources/GraphicsSnappingSource"],V,X)));case "notes":return R.addPromise(new Promise((V,X)=>e(["./featureSources/GraphicsSnappingSource"],V,X)));case "scene":return R.addPromise(new Promise((V,X)=>e(["./featureSources/SceneLayerSnappingSource"],V,X)))}};g._createClass(u,[{key:"updating",get:function(){return N.someMap(this.snappingSources,({snappingSource:K})=>K.updating)||
this.updatingHandles.updating}},{key:"snappingSources",get:function(){const K=this._get("snappingSources")||new Map,R=new Map;if(B.isSome(this.options)&&B.isSome(this.options.featureSources))for(const X of this.options.featureSources.items){const ba=X.layer.uid;var V=K.get(ba);V?(K.delete(ba),R.set(ba,V)):X.layer.loaded?(V=this._createSourceInfo(X),B.isSome(V)&&R.set(ba,V)):this.updatingHandles.addPromise(X.layer.load())}for(const [,X]of K)X.destroy();return R}},{key:"_types",get:function(){return Q.SnappingTypes.EDGE|
Q.SnappingTypes.VERTEX}}]);return u}(x.HandleOwner);w.__decorate([d.property({constructOnly:!0})],l.FeatureSnappingEngine.prototype,"spatialReference",void 0);w.__decorate([d.property({constructOnly:!0})],l.FeatureSnappingEngine.prototype,"view",void 0);w.__decorate([d.property()],l.FeatureSnappingEngine.prototype,"options",void 0);w.__decorate([d.property({readOnly:!0})],l.FeatureSnappingEngine.prototype,"updating",null);w.__decorate([d.property({readOnly:!0})],l.FeatureSnappingEngine.prototype,
"snappingSources",null);l.FeatureSnappingEngine=w.__decorate([k.subclass("esri.views.interactive.snapping.FeatureSnappingEngine")],l.FeatureSnappingEngine);let F=function(){function J(u,C){this.snappingSource=u;this.layerView=C;this.handles=new L;C=this.snappingSource.layerSource.layer;"refresh"in C&&this.handles.add(C.on("refresh",()=>u.refresh()));this.handles.add([f.watch(()=>u.updating,K=>u.layerSource.updating=K,f.syncAndInitial),f.watch(()=>u.availability,K=>u.layerSource.availability=K,f.syncAndInitial)])}
J.prototype.destroy=function(){this.snappingSource.destroy();this.handles.destroy()};return g._createClass(J)}();const T=y.create(),M=y.create();Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./projectionSupport ./SnappingCandidate ./utils ../../support/fieldUtils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k){function E(Q,O,A,b){const c=b.x-A.x;b=b.y-A.y;O=Math.min(1,Math.max(0,((O.x-A.x)*c+(O.y-A.y)*b)/(c*c+b*b)));Q.x=A.x+c*O;Q.y=A.y+b*O}function v(Q,O){return Q?O?4:3:O?3:2}let y=function(){function Q(A,b,c){this.items=A;this.query=b;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.fieldsIndex=c.fieldsIndex;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.featureAdapter=c.featureAdapter}var O=Q.prototype;O.createQueryResponseForCount=
function(){const A=new t(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return A.countDistinctValues(this.items);const {groupByFieldsForStatistics:b,having:c,outStatistics:a}=this.query;if(!b?.length)return 1;const p=new Map,D=new Map,P=new Set;for(const H of a){var {statisticType:m}=H;m="exceedslimit"!==m?H.onStatisticField:void 0;if(!D.has(m)){var I=[];for(const S of b){const F=this._getAttributeValues(A,S,p);I.push(F)}D.set(m,this._calculateUniqueValues(I,A.returnDistinctValues))}m=
D.get(m);for(const S in m){const {data:F,items:T}=m[S];I=F.join(",");c&&!A.validateItems(T,c)||P.add(I)}}return P.size};O.createQueryResponse=async function(){let A;A=this.query.outStatistics?this.query.outStatistics.some(b=>"exceedslimit"===b.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const b=this.query.geometry;B.isValid(this.query.outSR)&&!B.equals(b.spatialReference,
this.query.outSR)?A.queryGeometry=h.cleanFromGeometryEngine({spatialReference:this.query.outSR,...f.project(b,b.spatialReference,this.query.outSR)}):A.queryGeometry=h.cleanFromGeometryEngine({spatialReference:this.query.outSR,...b})}return A};O.createSnappingResponse=function(A,b){const c=this.featureAdapter,a=v(this.hasZ,this.hasM),{point:p,mode:D}=A,P="number"===typeof A.distance?A.distance:A.distance.x,m="number"===typeof A.distance?A.distance:A.distance.y,I={candidates:[]},H="esriGeometryPolygon"===
this.geometryType;b=this._getPointCreator(D,this.spatialReference,b);const S=new r(null,0),F=new r(null,0),T={x:0,y:0,z:0};for(const V of this.items){var M=c.getGeometry(V);if(w.isNone(M))continue;const {coords:X,lengths:ba}=M;S.coords=X;F.coords=X;if(A.types&l.SnappingTypes.EDGE){M=0;for(var J=0;J<ba.length;J++){var u=ba[J];for(var C=0;C<u;C++,M+=a){var K=S;K.coordsIndex=M;if(C!==u-1){const ea=F;ea.coordsIndex=M+a;const Y=T;E(T,p,K,ea);var R=(p.x-Y.x)/P;const ca=(p.y-Y.y)/m;R=R*R+ca*ca;1>=R&&I.candidates.push(d.makeEdgeCandidate(c.getObjectId(V),
b(Y),Math.sqrt(R),b(K),b(ea)))}}}}if(A.types&l.SnappingTypes.VERTEX)for(M=H?X.length-a:X.length,J=0;J<M;J+=a)u=S,u.coordsIndex=J,C=(p.x-u.x)/P,K=(p.y-u.y)/m,C=C*C+K*K,1>=C&&I.candidates.push(d.makeVertexCandidate(c.getObjectId(V),b(u),Math.sqrt(C)))}I.candidates.sort((V,X)=>V.distance-X.distance);return I};O._getPointCreator=function(A,b,c){const a=w.isSome(c)&&!B.equals(b,c)?D=>f.project(D,b,c):D=>D,{hasZ:p}=this;return"3d"===A?p?({x:D,y:P,z:m})=>a({x:D,y:P,z:m}):({x:D,y:P})=>a({x:D,y:P,z:0}):({x:D,
y:P})=>a({x:D,y:P})};O.createSummaryStatisticsResponse=async function(A){const {field:b,valueExpression:c,normalizationField:a,normalizationType:p,normalizationTotal:D,minValue:P,maxValue:m,scale:I}=A;A=this.fieldsIndex.isDateField(b);var H=await this._getDataValues({field:b,valueExpression:c,normalizationField:a,normalizationType:p,normalizationTotal:D,scale:I});const S=z.isNullCountSupported({normalizationType:p,normalizationField:a,minValue:P,maxValue:m}),F=this.fieldsIndex.get(b),T={value:.5,
fieldType:F?.type};H=n.isStringField(F)?z.calculateStringStatistics({values:H,supportsNullCount:S,percentileParams:T}):z.calculateStatistics({values:H,minValue:P,maxValue:m,useSampleStdDev:!p,supportsNullCount:S,percentileParams:T});return z.processSummaryStatisticsResult(H,A)};O.createUniqueValuesResponse=async function(A){const {field:b,valueExpression:c,domains:a,returnAllCodedValues:p,scale:D}=A;var P=await this._getDataValues({field:b,field2:A.field2,field3:A.field3,fieldDelimiter:A.fieldDelimiter,
valueExpression:c,scale:D});P=z.calculateUniqueValuesCount(P);return z.createUVResult(P,a,p,A.fieldDelimiter)};O.createClassBreaksResponse=async function(A){const {field:b,valueExpression:c,normalizationField:a,normalizationType:p,normalizationTotal:D,classificationMethod:P,standardDeviationInterval:m,minValue:I,maxValue:H,numClasses:S,scale:F}=A;A=await this._getDataValues({field:b,valueExpression:c,normalizationField:a,normalizationType:p,normalizationTotal:D,scale:F});A=z.calculateClassBreaks(A,
{field:b,normalizationField:a,normalizationType:p,normalizationTotal:D,classificationMethod:P,standardDeviationInterval:m,minValue:I,maxValue:H,numClasses:S});return z.resolveCBResult(A,P)};O.createHistogramResponse=async function(A){const {field:b,valueExpression:c,normalizationField:a,normalizationType:p,normalizationTotal:D,classificationMethod:P,standardDeviationInterval:m,minValue:I,maxValue:H,numBins:S,scale:F}=A;A=await this._getDataValues({field:b,valueExpression:c,normalizationField:a,normalizationType:p,
normalizationTotal:D,scale:F});return z.calculateHistogram(A,{field:b,normalizationField:a,normalizationType:p,normalizationTotal:D,classificationMethod:P,standardDeviationInterval:m,minValue:I,maxValue:H,numBins:S})};O._sortFeatures=function(A,b,c){if(1<A.length&&b&&b.length)for(const a of b.reverse()){b=a.split(" ");const p=b[0],D=this.fieldsIndex.get(p);b=b[1]?"desc"===b[1].toLowerCase():!1;const P=z.getAttributeComparator(D?.type,b);A.sort((m,I)=>{m=c(m,p,D);I=c(I,p,D);return P(m,I)})}};O._createFeatureQueryResponse=
function(A){const b=this.items,{geometryType:c,hasM:a,hasZ:p,objectIdField:D,spatialReference:P}=this,{outFields:m,outSR:I,quantizationParameters:H,resultRecordCount:S,resultOffset:F,returnZ:T,returnM:M}=A,J=null!=S?b.length>(F||0)+S:!1,u=m&&(m.includes("*")?[...this.fieldsIndex.fields]:m.map(C=>this.fieldsIndex.get(C)));return{exceededTransferLimit:J,features:this._createFeatures(A,b),fields:u,geometryType:c,hasM:a&&M,hasZ:p&&T,objectIdFieldName:D,spatialReference:h.cleanFromGeometryEngine(I||P),
transform:H&&N.toQuantizationTransform(H)||null}};O._createFeatures=function(A,b){const c=new t(A,this.featureAdapter,this.fieldsIndex),{hasM:a,hasZ:p}=this,{orderByFields:D,quantizationParameters:P,returnGeometry:m,returnCentroid:I,maxAllowableOffset:H,resultOffset:S,resultRecordCount:F,returnZ:T=!1,returnM:M=!1}=A,J=p&&T,u=a&&M;A=[];var C=0;b=[...b];this._sortFeatures(b,D,(V,X,ba)=>c.getFieldValue(V,X,ba));if(m||I){var K=N.toQuantizationTransform(P)??void 0;if(m&&!I)for(var R of b)A[C++]={attributes:c.getAttributes(R),
geometry:h.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(R),H,K,J,u)};else if(!m&&I)for(const V of b)A[C++]={attributes:c.getAttributes(V),centroid:h.transformCentroid(this,this.featureAdapter.getCentroid(V,this),K)};else for(const V of b)A[C++]={attributes:c.getAttributes(V),centroid:h.transformCentroid(this,this.featureAdapter.getCentroid(V,this),K),geometry:h.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(V),H,K,J,u)}}else for(K of b)(R=
c.getAttributes(K))&&(A[C++]={attributes:R});C=S||0;null!=F&&(A=A.slice(C,Math.min(A.length,C+F)));return A};O._createExceedsLimitQueryResponse=function(A){var b=!1;let c=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;b=Number.POSITIVE_INFINITY;for(const p of A.outStatistics??[])if("exceedslimit"===p.statisticType){c=null!=p.maxPointCount?p.maxPointCount:Number.POSITIVE_INFINITY;a=null!=p.maxRecordCount?p.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=p.maxVertexCount?p.maxVertexCount:Number.POSITIVE_INFINITY;
break}if("esriGeometryPoint"===this.geometryType)b=this.items.length>c;else if(this.items.length>a)b=!0;else{A=v(this.hasZ,this.hasM);const p=this.featureAdapter;b=this.items.reduce((D,P)=>{P=p.getGeometry(P);return D+(w.isSome(P)&&P.coords.length||0)},0)/A>b}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};O._createStatisticsQueryResponse=async function(A){var b=
{attributes:{}};const c=[],a=new Map,p=new Map,D=new Map,P=new Map,m=new t(A,this.featureAdapter,this.fieldsIndex);var I=A.outStatistics;const {groupByFieldsForStatistics:H,having:S,orderByFields:F}=A;A=H&&H.length;const T=!!A,M=T?H[0]:null,J=T&&!this.fieldsIndex.get(M);for(const V of I??[]){const {outStatisticFieldName:X,statisticType:ba}=V;I=V;var u="exceedslimit"!==ba?V.onStatisticField:void 0;const ea="percentile_disc"===ba||"percentile_cont"===ba,Y="EnvelopeAggregate"===ba||"CentroidAggregate"===
ba||"ConvexHullAggregate"===ba,ca=T&&1===A&&(u===M||J)&&"count"===ba;if(T){if(!D.has(u)){var C=[];for(const da of H){var K=this._getAttributeValues(m,da,a);C.push(K)}D.set(u,this._calculateUniqueValues(C,Y?!1:m.returnDistinctValues))}C=D.get(u);for(const da in C){const {count:ja,data:pa,items:sa,itemPositions:xa}=C[da];K=pa.join(",");if(!S||m.validateItems(sa,S)){const ya=P.get(K)||{attributes:{}};if(Y){ya.aggregateGeometries||(ya.aggregateGeometries={});const {aggregateGeometries:za,outStatisticFieldName:Ga}=
await this._getAggregateGeometry(I,sa);ya.aggregateGeometries[Ga]=za}else{var R=null;if(ca)R=ja;else{const za=this._getAttributeValues(m,u,a);R=xa.map(Ga=>za[Ga]);R=ea&&"statisticParameters"in I?this._getPercentileValue(I,R):this._getStatisticValue(I,R,null,m.returnDistinctValues)}ya.attributes[X]=R}let oa=0;H.forEach((za,Ga)=>ya.attributes[this.fieldsIndex.get(za)?za:`EXPR_${++oa}`]=pa[Ga]);P.set(K,ya)}}}else if(Y){b.aggregateGeometries||(b.aggregateGeometries={});const {aggregateGeometries:da,outStatisticFieldName:ja}=
await this._getAggregateGeometry(I,this.items);b.aggregateGeometries[ja]=da}else u=this._getAttributeValues(m,u,a),b.attributes[X]=ea&&"statisticParameters"in I?this._getPercentileValue(I,u):this._getStatisticValue(I,u,p,m.returnDistinctValues);c.push({name:X,alias:X,type:"esriFieldTypeDouble"})}b=T?Array.from(P.values()):[b];this._sortFeatures(b,F,(V,X)=>V.attributes[X]);return{fields:c,features:b}};O._getAggregateGeometry=async function(A,b){var c=await new Promise((F,T)=>e(["../../../geometry/geometryEngineJSON"],
F,T));const {statisticType:a,outStatisticFieldName:p}=A,{featureAdapter:D,spatialReference:P,geometryType:m,hasZ:I,hasM:H}=this;b=b.map(F=>h.getGeometry(m,I,H,D.getGeometry(F)));const S=c.convexHull(P,b,!0)[0];A={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===a?(c=S?L.getPolygonExtent(S):L.getGeometryExtent(c.union(P,b)),A.aggregateGeometries={...c,spatialReference:P},A.outStatisticFieldName=p||"extent"):"CentroidAggregate"===a?(c=S?x.polygonCentroid(S):x.extentCentroid(L.getGeometryExtent(c.union(P,
b))),A.aggregateGeometries={x:c[0],y:c[1],spatialReference:P},A.outStatisticFieldName=p||"centroid"):"ConvexHullAggregate"===a&&(A.aggregateGeometries=S,A.outStatisticFieldName=p||"convexHull");return A};O._getStatisticValue=function(A,b,c,a){const {onStatisticField:p,statisticType:D}=A;A=null;A=c?.has(p)?c.get(p):n.isStringField(this.fieldsIndex.get(p))?z.calculateStringStatistics({values:b,returnDistinct:a}):z.calculateStatistics({values:a?[...(new Set(b))]:b,minValue:null,maxValue:null,useSampleStdDev:!0});
c&&c.set(p,A);return A["var"===D?"variance":D]};O._getPercentileValue=function(A,b){const {onStatisticField:c,statisticParameters:a,statisticType:p}=A,{value:D,orderBy:P}=a;A=this.fieldsIndex.get(c);return z.calculatePercentile(b,{value:D,orderBy:P,fieldType:A?.type,isDiscrete:"percentile_disc"===p})};O._getAttributeValues=function(A,b,c){if(c.has(b))return c.get(b);const a=this.fieldsIndex.get(b),p=this.items.map(D=>A.getFieldValue(D,b,a));c.set(b,p);return p};O._getAttributeDataValues=function(A,
b){return this.items.map(c=>A.getDataValue(c,{field:b.field,field2:b.field2,field3:b.field3,fieldDelimiter:b.fieldDelimiter,normalizationField:b.normalizationField,normalizationType:b.normalizationType,normalizationTotal:b.normalizationTotal}))};O._getAttributeExpressionValues=async function(A,b,c){const {arcadeUtils:a}=await k.loadArcade();b=a.createFunction(b);c=c&&a.getViewInfo(c);return A.getExpressionValues(this.items,b,c,a)};O._calculateUniqueValues=function(A,b){const c={},a=this.items,p=a.length;
for(let D=0;D<p;D++){const P=a[D],m=[];for(const H of A)m.push(H[D]);const I=m.join(",");null==c[I]?c[I]={count:1,data:m,items:[P],itemPositions:[D]}:(b||c[I].count++,c[I].items.push(P),c[I].itemPositions.push(D))}return c};O._getDataValues=async function(A){const b=new t(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:c,field:a,normalizationField:p,normalizationType:D,normalizationTotal:P,scale:m}=A,I=c?{viewingMode:"map",scale:m,spatialReference:this.query.outSR||this.spatialReference}:
null;return c?this._getAttributeExpressionValues(b,c,I):this._getAttributeDataValues(b,{field:a,field2:A.field2,field3:A.field3,fieldDelimiter:A.fieldDelimiter,normalizationField:p,normalizationType:D,normalizationTotal:P})};g._createClass(Q,[{key:"size",get:function(){return this.items.length}}]);return Q}();l.SnappingTypes=void 0;(function(Q){Q[Q.NONE=0]="NONE";Q[Q.EDGE=1]="EDGE";Q[Q.VERTEX=2]="VERTEX"})(l.SnappingTypes||(l.SnappingTypes={}));let r=function(){function Q(O,A){this.coords=O;this.coordsIndex=
A}g._createClass(Q,[{key:"x",get:function(){return this.coords[this.coordsIndex]}},{key:"y",get:function(){return this.coords[this.coordsIndex+1]}},{key:"z",get:function(){return this.coords[this.coordsIndex+2]}}]);return Q}();l.QueryEngineResult=y;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","../../core/maybe","./jsonUtils"],function(e,l,g){function w({scale:D,translate:P},m){return Math.round((m-P[0])/D[0])}
function x({scale:D,translate:P},m){return Math.round((P[1]-m)/D[1])}function L(D,P,m){const I=[];let H,S,F,T;for(let M=0;M<m.length;M++){const J=m[M];if(0<M){if(F=w(D,J[0]),T=x(D,J[1]),F!==H||T!==S)I.push(P(J,F-H,T-S)),H=F,S=T}else H=w(D,J[0]),S=x(D,J[1]),I.push(P(J,H,S))}return 0<I.length?I:null}function N(D,P,m,I){return L(D,m?I?p:a:I?a:c,P)}function B(D,P,m,I){const H=[];m=m?I?p:a:I?a:c;for(I=0;I<P.length;I++){const S=L(D,m,P[I]);S&&3<=S.length&&H.push(S)}return H.length?H:null}function t(D,P,
m,I){const H=[];m=m?I?p:a:I?a:c;for(I=0;I<P.length;I++){const S=L(D,m,P[I]);S&&2<=S.length&&H.push(S)}return H.length?H:null}function f({scale:D,translate:P},m){return m*D[0]+P[0]}function d({scale:D,translate:P},m){return P[1]-m*D[1]}function h(D,P,m){const I=Array(m.length);if(!m.length)return I;const [H,S]=D.scale;let F=f(D,m[0][0]);D=d(D,m[0][1]);I[0]=P(m[0],F,D);for(let T=1;T<m.length;T++){const M=m[T];F+=M[0]*H;D-=M[1]*S;I[T]=P(M,F,D)}return I}function n(D,P,m){const I=Array(m.length);for(let H=
0;H<m.length;H++)I[H]=h(D,P,m[H]);return I}function z(D,P,m,I){return h(D,m?I?p:a:I?a:c,P)}function k(D,P,m,I){return n(D,m?I?p:a:I?a:c,P)}function E(D,P,m,I){return n(D,m?I?p:a:I?a:c,P)}function v(D,P,m){let [I,H]=m[0],S=Math.min(I,P[0]),F=Math.min(H,P[1]),T=Math.max(I,P[2]);P=Math.max(H,P[3]);for(let M=1;M<m.length;M++){const [J,u]=m[M];I+=J;H+=u;0>J&&(S=Math.min(S,I));0<J&&(T=Math.max(T,I));0>u?F=Math.min(F,H):0<u&&(P=Math.max(P,H))}D[0]=S;D[1]=F;D[2]=T;D[3]=P;return D}function y(D,P){if(!P.length)return null;
D[0]=D[1]=Number.POSITIVE_INFINITY;D[2]=D[3]=Number.NEGATIVE_INFINITY;for(let m=0;m<P.length;m++)v(D,D,P[m]);return D}function r(D,P,m,I,H){P.xmin=w(D,m.xmin);P.ymin=x(D,m.ymin);P.xmax=w(D,m.xmax);P.ymax=x(D,m.ymax);P!==m&&(I&&(P.zmin=m.zmin,P.zmax=m.zmax),H&&(P.mmin=m.mmin,P.mmax=m.mmax));return P}function Q(D,P,m,I,H){P.points=N(D,m.points,I,H)??[];return P}function O(D,P,m,I,H){P.x=w(D,m.x);P.y=x(D,m.y);P!==m&&(I&&(P.z=m.z),H&&(P.m=m.m));return P}function A(D,P,m,I,H){D=B(D,m.rings,I,H);if(!D)return null;
P.rings=D;return P}function b(D,P,m,I,H){D=t(D,m.paths,I,H);if(!D)return null;P.paths=D;return P}const c=(D,P,m)=>[P,m],a=(D,P,m)=>[P,m,D[2]],p=(D,P,m)=>[P,m,D[2],D[3]];e.equals=function(D,P){if(D===P||null==D&&null==P)return!0;if(null==D||null==P)return!1;let m,I,H,S;D&&"upperLeft"===D.originPosition?(m=D.translate[0],I=D.translate[1],D=D.scale[0]):(m=l.isSome(D.extent)?D.extent.xmin:0,I=l.isSome(D.extent)?D.extent.ymax:0,D=D.tolerance);P&&"upperLeft"===P.originPosition?(H=P.translate[0],S=P.translate[1],
P=P.scale[0]):(H=l.isSome(P.extent)?P.extent.xmin:0,S=l.isSome(P.extent)?P.extent.ymax:0,P=P.tolerance);return m===H&&I===S&&D===P};e.getQuantizedBoundsCoordsArray=v;e.getQuantizedBoundsCoordsArrayArray=y;e.getQuantizedBoundsPaths=function(D){return y([0,0,0,0],D)};e.getQuantizedBoundsPoints=function(D){const P=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return v(P,P,D)};e.getQuantizedBoundsRings=function(D){return y([0,0,0,0],D)};e.quantizeBounds=
function(D,P,m){P[0]=w(D,m[0]);P[3]=x(D,m[1]);P[2]=w(D,m[2]);P[1]=x(D,m[3]);return P};e.quantizeExtent=r;e.quantizeGeometry=function(D,P){return D&&P?g.isPoint(P)?O(D,{},P,!1,!1):g.isPolyline(P)?b(D,{},P,!1,!1):g.isPolygon(P)?A(D,{},P,!1,!1):g.isMultipoint(P)?Q(D,{},P,!1,!1):g.isExtent(P)?r(D,{},P,!1,!1):null:null};e.quantizeMultipoint=Q;e.quantizePaths=t;e.quantizePoint=O;e.quantizePoints=N;e.quantizePolygon=A;e.quantizePolyline=b;e.quantizeRings=B;e.quantizeX=w;e.quantizeY=x;e.toQuantizationTransform=
function(D){return D?{originPosition:"upper-left"===D.originPosition?"upperLeft":"lower-left"===D.originPosition?"lowerLeft":D.originPosition,scale:D.tolerance?[D.tolerance,D.tolerance]:[1,1],translate:l.isSome(D.extent)?[D.extent.xmin,D.extent.ymax]:[0,0]}:null};e.unquantizeBounds=function(D,P,m){return m?(P[0]=f(D,m[0]),P[1]=d(D,m[3]),P[2]=f(D,m[2]),P[3]=d(D,m[1]),P):[f(D,P[0]),d(D,P[3]),f(D,P[2]),d(D,P[1])]};e.unquantizeCoordsArray=h;e.unquantizeCoordsArrayArray=n;e.unquantizeExtent=function(D,
P,m,I,H){P.xmin=f(D,m.xmin);P.ymin=d(D,m.ymin);P.xmax=f(D,m.xmax);P.ymax=d(D,m.ymax);P!==m&&(I&&(P.zmin=m.zmin,P.zmax=m.zmax),H&&(P.mmin=m.mmin,P.mmax=m.mmax));return P};e.unquantizeMultipoint=function(D,P,m,I,H){l.isSome(m)&&(P.points=z(D,m.points,I,H));return P};e.unquantizePaths=k;e.unquantizePoint=function(D,P,m,I,H){if(l.isNone(m))return P;P.x=f(D,m.x);P.y=d(D,m.y);P!==m&&(I&&(P.z=m.z),H&&(P.m=m.m));return P};e.unquantizePoints=z;e.unquantizePolygon=function(D,P,m,I,H){l.isSome(m)&&(P.rings=
E(D,m.rings,I,H));return P};e.unquantizePolyline=function(D,P,m,I,H){l.isSome(m)&&(P.paths=k(D,m.paths,I,H));return P};e.unquantizeRings=E;e.unquantizeX=f;e.unquantizeY=d;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/maybe","./attributeSupport","../../../statistics/utils"],function(e,l,g,w){return function(){function x(N,B,t){this._fieldDataCache=new Map;this._returnDistinctMap=
new Map;this.returnDistinctValues=N.returnDistinctValues??!1;this.fieldsIndex=t;this.featureAdapter=B;if((B=N.outFields)&&!B.includes("*")){this.outFields=B;N=0;for(const d of B){var f=g.getExpressionFromFieldName(d);f=(B=this.fieldsIndex.get(f))?null:g.getWhereClause(f,t);B=B?B.name:g.getAliasFromFieldName(d)||`FIELD_EXP_${N++}`;this._fieldDataCache.set(d,{alias:B,clause:f})}}}var L=x.prototype;L.countDistinctValues=function(N){if(!this.returnDistinctValues)return N.length;N.forEach(B=>this.getAttributes(B));
return this._returnDistinctMap.size};L.getAttributes=function(N){N=this._processAttributesForOutFields(N);return this._processAttributesForDistinctValues(N)};L.getFieldValue=function(N,B,t){const f=t?t.name:B;let d=null;this._fieldDataCache.has(f)?d=this._fieldDataCache.get(f)?.clause:t||(d=g.getWhereClause(B,this.fieldsIndex),this._fieldDataCache.set(f,{alias:f,clause:d}));return t?this.featureAdapter.getAttribute(N,f):d?.calculateValue(N,this.featureAdapter)};L.getDataValue=function(N,B){const t=
B.normalizationType,f=B.normalizationTotal;let d=B.field&&this.getFieldValue(N,B.field,this.fieldsIndex.get(B.field));B.field2&&(d=`${w.processNullValue(d)}${B.fieldDelimiter}${w.processNullValue(this.getFieldValue(N,B.field2,this.fieldsIndex.get(B.field2)))}`,B.field3&&(d=`${d}${B.fieldDelimiter}${w.processNullValue(this.getFieldValue(N,B.field3,this.fieldsIndex.get(B.field3)))}`));t&&Number.isFinite(d)&&(N="field"===t&&B.normalizationField?this.getFieldValue(N,B.normalizationField,this.fieldsIndex.get(B.normalizationField)):
null,d=w.getNormalizedValue(d,t,N,f));return d};L.getExpressionValue=function(N,B,t,f){N={attributes:this.featureAdapter.getAttributes(N),layer:{fields:this.fieldsIndex.fields}};t=f.createExecContext(N,t);return f.executeFunction(B,t)};L.getExpressionValues=function(N,B,t,f){const d={fields:this.fieldsIndex.fields};return N.map(h=>{h={attributes:this.featureAdapter.getAttributes(h),layer:d};h=f.createExecContext(h,t);return f.executeFunction(B,h)})};L.validateItem=function(N,B){this._fieldDataCache.has(B)||
this._fieldDataCache.set(B,{alias:B,clause:g.getWhereClause(B,this.fieldsIndex)});return this._fieldDataCache.get(B)?.clause?.testFeature(N,this.featureAdapter)??!1};L.validateItems=function(N,B){this._fieldDataCache.has(B)||this._fieldDataCache.set(B,{alias:B,clause:g.getWhereClause(B,this.fieldsIndex)});return this._fieldDataCache.get(B)?.clause?.testSet(N,this.featureAdapter)??!1};L._processAttributesForOutFields=function(N){const B=this.outFields;if(!B||!B.length)return this.featureAdapter.getAttributes(N);
const t={};for(const f of B){const {alias:d,clause:h}=this._fieldDataCache.get(f);t[d]=h?h.calculateValue(N,this.featureAdapter):this.featureAdapter.getAttribute(N,d)}return t};L._processAttributesForDistinctValues=function(N){if(l.isNone(N)||!this.returnDistinctValues)return N;var B=this.outFields,t=[];if(B)for(const d of B){var {alias:f}=this._fieldDataCache.get(d);t.push(N[f])}else for(f in N)t.push(N[f]);B=`${(B||["*"]).join(",")}=${t.join(",")}`;t=this._returnDistinctMap.get(B)||0;this._returnDistinctMap.set(B,
++t);return 1<t?null:N};return e._createClass(x)}()})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache"],function(e,l,g){function w(t,f){return t?N.get(t,f):null}function x(t,f,d,h=!0){const n=[];for(const z of f)if("*"!==z&&!t.has(z))if(h){f=L(z);try{const k=w(f,t);if(!k)throw new l("feature-store:unsupported-query","invalid SQL expression",{where:f});if(!k.isStandardized)throw new l("feature-store:unsupported-query",
"expression is not standard",{clause:k});x(t,k.fieldNames,"expression contains missing fields")}catch(k){if((f=k&&k.details)&&(f.clause||f.where))throw k;f&&f.missingFields?n.push(...f.missingFields):n.push(z)}}else n.push(z);if(n.length)throw new l("feature-store:unsupported-query",d,{missingFields:n});}function L(t){return t.split(" as ")[0]}const N=new g.WhereClauseCache(50,500),B=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));
e.getAliasFromFieldName=function(t){return t.split(" as ")[1]};e.getExpressionFromFieldName=L;e.getWhereClause=w;e.hasInvalidFieldType=function(t,f){return(t=f.get(t))?!B.has(t.type):!1};e.validateFields=x;e.validateHaving=function(t,f,d){if(!f)return!0;const h=N.get(f,t);if(!h)throw new l("feature-store:unsupported-query","invalid SQL expression",{having:f});if(!h.isAggregate)throw new l("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:f});x(t,h.fieldNames,
"having contains missing fields");if(!h.getExpressions().every(n=>{const {aggregateType:z,field:k}=n,E=t.get(k)?.name;return d.some(v=>{const {onStatisticField:y,statisticType:r}=v;return t.get(y)?.name===E&&r.toLowerCase().trim()===z})}))throw new l("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:f});return!0};e.validateWhere=function(t,f){if(!f)return!0;const d=N.get(f,t);if(!d)throw new l("feature-store:unsupported-query","invalid SQL expression",
{where:f});if(!d.isStandardized)throw new l("feature-store:unsupported-query","where clause is not standard",{where:f});x(t,d.fieldNames,"where clause contains missing fields");return!0};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../ItemCache","./WhereClause"],function(e,l,g,w){let x=function(){function L(N,B){this._cache=new g(N);this._invalidCache=new g(B)}L.prototype.get=
function(N,B){const t=`${B.uid}:${N}`,f=this._cache.get(t);if(f)return f;if(void 0!==this._invalidCache.get(t))return null;try{const d=w.WhereClause.create(N,B);this._cache.put(t,d);return d}catch{return this._invalidCache.put(t,null),null}};return l._createClass(L)}();e.WhereClauseCache=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(e,l,g,w,x,L){function N(H,S){H+="";return H.length>=S?H:Array(S-H.length+1).join("0")+H}function B(H,S,F="0",T="0",M="0",J="0",u="",C="0",K="0"){return"+"===u||"-"===u?(H=`${N(parseInt(H,10),4)}-${N(parseInt(S,10),2)}-${N(parseInt(F,10),2)}`,S="",10>parseFloat(J)&&(S="0"),T=`${N(parseInt(T,10),2)}:${N(parseInt(M,10),2)}:${S+parseFloat(J).toString()}`,u=`${u}${N(parseInt(C,10),2)}:${N(parseInt(K,10),2)}`,new Date(H+"T"+T+u)):new Date(parseInt(H,10),parseInt(S,10)-1,parseInt(F,10),parseInt(T,
10),parseInt(M,10),parseFloat(J))}function t(H){let S=A.exec(H);if(null!==S){const [,F,T,M,J,u,C]=S;return B(F,T,M,J,u,C)}S=b.exec(H);if(null!==S){const [,F,T,M,J,u,C,K,R,V]=S;return B(F,T,M,J,u,C,K,R,V)}S=c.exec(H);if(null!==S){const [,F,T,M,J,u,C,K,R]=S;return B(F,T,M,J,u,"0",C,K,R)}S=a.exec(H);if(null!==S){const [,F,T,M,J,u]=S;return B(F,T,M,J,u)}S=O.exec(H);if(null!==S){const [,F,T,M]=S;return B(F,T,M)}throw Error("SQL Invalid Timestamp");}function f(H){const S=O.exec(H);if(null===S)try{return t(H)}catch{throw Error("SQL Invalid Date");
}const [,F,T,M]=S;return new Date(parseInt(F,10),parseInt(T,10)-1,parseInt(M,10))}function d(H){return Array.isArray(H)?H:[H]}function h(H){return null!==H?!0!==H:null}function n(H,S){return null!=H&&null!=S?!0===H&&!0===S:!1===H||!1===S?!1:null}function z(H,S){return null!=H&&null!=S?!0===H||!0===S:!0===H||!0===S?!0:null}function k(H,S){if(null==H)return null;let F=!1;for(const T of S)if(null==T)F=null;else if(H===T){F=!0;break}return F}function E(H,S,F){if(null==H)return null;let T="",M=m.Normal;
for(let J=0;J<S.length;J++){const u=S.charAt(J);switch(M){case m.Normal:u===F?M=m.Escaped:T="-[]/{}()*+?.\\^$|".includes(u)?T+("\\"+u):"%"===u?T+".*":"_"===u?T+".":T+u;break;case m.Escaped:T="-[]/{}()*+?.\\^$|".includes(u)?T+("\\"+u):T+u,M=m.Normal}}return(new RegExp("^"+T+"$","m")).test(H)}function v(H){return H instanceof Date?H.valueOf():H}function y(H,S,F){if(null==S||null==F)return null;S=v(S);F=v(F);switch(H){case "\x3c\x3e":return S!==F;case "\x3d":return S===F;case "\x3e":return S>F;case "\x3c":return S<
F;case "\x3e\x3d":return S>=F;case "\x3c\x3d":return S<=F}}function r(H,S,F){if("||"===H)return x.evaluateFunction("concat",[S,F]);if(S instanceof x.SqlInterval)if(F instanceof Date)switch(H){case "+":return new Date(S.valueInMilliseconds()+F.getTime());case "-":return S.valueInMilliseconds()-F.getTime();case "*":return S.valueInMilliseconds()*F.getTime();case "/":return S.valueInMilliseconds()/F.getTime()}else if(F instanceof x.SqlInterval)switch(H){case "+":return x.SqlInterval.createFromMilliseconds(S.valueInMilliseconds()+
F.valueInMilliseconds());case "-":return x.SqlInterval.createFromMilliseconds(S.valueInMilliseconds()-F.valueInMilliseconds());case "*":return S.valueInMilliseconds()*F.valueInMilliseconds();case "/":return S.valueInMilliseconds()/F.valueInMilliseconds()}else S=S.valueInMilliseconds();else if(F instanceof x.SqlInterval)if(S instanceof Date)switch(H){case "+":return new Date(F.valueInMilliseconds()+S.getTime());case "-":return new Date(S.getTime()-F.valueInMilliseconds());case "*":return S.getTime()*
F.valueInMilliseconds();case "/":return S.getTime()/F.valueInMilliseconds()}else F=F.valueInMilliseconds();else if(S instanceof Date&&"number"===typeof F)switch(F*=864E5,S=S.getTime(),H){case "+":return new Date(S+F);case "-":return new Date(S-F);case "*":return new Date(S*F);case "/":return new Date(S/F)}else if(F instanceof Date&&"number"===typeof S)switch(S*=864E5,F=F.getTime(),H){case "+":return new Date(S+F);case "-":return new Date(S-F);case "*":return new Date(S*F);case "/":return new Date(S/
F)}switch(H){case "+":return S+F;case "-":return S-F;case "*":return S*F;case "/":return S/F}}function Q(H,S,F,T){H=T.getAttribute(H,S);return null!=H&&1===F[S]?new Date(H):H}const O=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,A=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,c=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,a=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,
p=new Set(["current_timestamp","current_date","current_time"]);let D=function(){function H(){}H.makeBool=function(S){return!0===S};H.featureValue=function(S,F,T,M){return Q(S,F,T,M)};H.equalsNull=function(S){return null===S};H.applyLike=function(S,F,T){return E(S,F,T)};H.ensureArray=function(S){return d(S)};H.applyIn=function(S,F){return k(S,F)};H.currentDate=function(){const S=new Date;S.setHours(0,0,0,0);return S};H.makeSqlInterval=function(S,F,T){return x.SqlInterval.createFromValueAndQualifer(S,
F,T)};H.convertInterval=function(S){return S instanceof x.SqlInterval?S.valueInMilliseconds():S};H.currentTimestamp=function(){return new Date};H.compare=function(S,F,T){return y(S,F,T)};H.calculate=function(S,F,T){return r(S,F,T)};H.makeComparable=function(S){return v(S)};H.evaluateFunction=function(S,F){return x.evaluateFunction(S,F)};H.lookup=function(S,F){S=F[S];return void 0===S?null:S};H.between=function(S,F){return null==S||null==F[0]||null==F[1]?null:S>=F[0]&&S<=F[1]};H.notbetween=function(S,
F){return null==S||null==F[0]||null==F[1]?null:S<F[0]||S>F[1]};H.ternaryNot=function(S){return h(S)};H.ternaryAnd=function(S,F){return n(S,F)};H.ternaryOr=function(S,F){return z(S,F)};return l._createClass(H)}(),P=function(){function H(F,T){this.fieldsIndex=T;this._datefields={};this.parameters={};this._hasDateFunctions=void 0;this.parseTree=L.WhereGrammar.parse(F);const {isStandardized:M,isAggregate:J,referencedFieldNames:u}=this._extractExpressionInfo(T);this._referencedFieldNames=u;this.isStandardized=
M;this.isAggregate=J}H.create=function(F,T){return new H(F,T)};var S=H.prototype;S.testSet=function(F,T=I){const M={};for(const J of this.fieldNames)M[J]=F.map(u=>T.getAttribute(u,J));return!!this._evaluateNode(this.parseTree,{attributes:M},I)};S.calculateValue=function(F,T=I){F=this._evaluateNode(this.parseTree,F,T);return F instanceof x.SqlInterval?F.valueInMilliseconds()/864E5:F};S.calculateValueCompiled=function(F,T=I){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(F,
this.parameters,T,this._datefields);if(g("esri-csp-restrictions"))return this.calculateValue(F,T);this._compileMe();return this.parseTree._compiledVersion(F,this.parameters,T,this._datefields)};S.testFeature=function(F,T=I){return!!this._evaluateNode(this.parseTree,F,T)};S.testFeatureCompiled=function(F,T=I){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(F,this.parameters,T,this._datefields);if(g("esri-csp-restrictions"))return this.testFeature(F,T);this._compileMe();
return!!this.parseTree._compiledVersion(F,this.parameters,T,this._datefields)};S.getFunctions=function(){const F=new Set;this._visitAll(this.parseTree,T=>{"function"===T.type&&F.add(T.name.toLowerCase())});return Array.from(F)};S.getExpressions=function(){const F=new Map;this._visitAll(this.parseTree,T=>{if("function"===T.type){const M=T.name.toLowerCase();T=T.args.value[0];if("column-reference"===T.type){T=T.column;const J=`${M}-${T}`;F.has(J)||F.set(J,{aggregateType:M,field:T})}}});return[...F.values()]};
S.getVariables=function(){const F=new Set;this._visitAll(this.parseTree,T=>{"parameter"===T.type&&F.add(T.value.toLowerCase())});return Array.from(F)};S._compileMe=function(){const F="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",F)).bind(D)};S._extractExpressionInfo=function(F){const T=[],M=new Set;let J=!0,u=!0;this._visitAll(this.parseTree,C=>{switch(C.type){case "column-reference":const K=
F?.get(C.column);let R,V;K?R=V=K.name??"":(V=C.column,R=V.toLowerCase());K&&K.name&&("date"===K.type||"esriFieldTypeDate"===K.type)&&(this._datefields[K.name]=1);M.has(R)||(M.add(R),T.push(V));C.column=V;break;case "function":const {name:X,args:ba}=C;C=ba.value.length;J&&(J=x.isStandardized(X,C));u&&(u=w.isAggregate(X,C))}});return{referencedFieldNames:Array.from(T),isStandardized:J,isAggregate:u}};S._visitAll=function(F,T){if(null!=F)switch(T(F),F.type){case "when-clause":this._visitAll(F.operand,
T);this._visitAll(F.value,T);break;case "case-expression":for(const M of F.clauses)this._visitAll(M,T);"simple"===F.format&&this._visitAll(F.operand,T);null!==F.else&&this._visitAll(F.else,T);break;case "expression-list":for(const M of F.value)this._visitAll(M,T);break;case "unary-expression":this._visitAll(F.expr,T);break;case "binary-expression":this._visitAll(F.left,T);this._visitAll(F.right,T);break;case "function":this._visitAll(F.args,T)}};S.evaluateNodeToJavaScript=function(F){switch(F.type){case "interval":return"this.makeSqlInterval("+
this.evaluateNodeToJavaScript(F.value)+", "+JSON.stringify(F.qualifier)+","+JSON.stringify(F.op)+")";case "case-expression":var T="";if("simple"===F.format){var M="this.makeComparable("+this.evaluateNodeToJavaScript(F.operand)+")";T="( ";for(let J=0;J<F.clauses.length;J++)T+=" ("+M+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(F.clauses[J].operand)+")) ? ("+this.evaluateNodeToJavaScript(F.clauses[J].value)+") : "}else for(T="( ",M=0;M<F.clauses.length;M++)T+=" this.makeBool("+
this.evaluateNodeToJavaScript(F.clauses[M].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(F.clauses[M].value)+") : ";T=null!==F.else?T+this.evaluateNodeToJavaScript(F.else):T+"null";return T+" )";case "parameter":return"this.lookup("+JSON.stringify(F.value.toLowerCase())+",lookups)";case "expression-list":T="[";for(M of F.value)"["!==T&&(T+=","),T+=this.evaluateNodeToJavaScript(M);return T+"]";case "unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(F.expr)+")";
case "binary-expression":switch(F.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+" )";case "IS":if("null"!==F.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(F.left)+")";case "ISNOT":if("null"!==F.right.type)throw Error("Unsupported RHS for IS");
return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(F.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(F.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(F.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(F.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(F.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+")";case "NOTBETWEEN":return"this.notbetween("+
this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+","+JSON.stringify(F.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+","+JSON.stringify(F.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+
JSON.stringify(F.operator)+","+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+")";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(F.operator)+","+this.evaluateNodeToJavaScript(F.left)+","+this.evaluateNodeToJavaScript(F.right)+")"}throw Error("Not Supported Operator "+F.operator);case "null":case "boolean":case "string":case "number":return JSON.stringify(F.value);case "date":return"(new Date("+f(F.value).getTime().toString()+
"))";case "timestamp":return"(new Date("+t(F.value).getTime().toString()+"))";case "current-time":return"date"===F.mode?"this.currentDate()":"this.currentTimestamp()";case "column-reference":return"this.featureValue(feature,"+JSON.stringify(F.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(F.name)+","+this.evaluateNodeToJavaScript(F.args)+")"}throw Error("Unsupported sql syntax "+F.type);};S._evaluateNode=function(F,T,M){switch(F.type){case "interval":return T=
this._evaluateNode(F.value,T,M),x.SqlInterval.createFromValueAndQualifer(T,F.qualifier,F.op);case "case-expression":if("simple"===F.format){var J=v(this._evaluateNode(F.operand,T,M));for(var u=0;u<F.clauses.length;u++)if(J===v(this._evaluateNode(F.clauses[u].operand,T,M)))return this._evaluateNode(F.clauses[u].value,T,M)}else for(J=0;J<F.clauses.length;J++)if(!0===this._evaluateNode(F.clauses[J].operand,T,M))return this._evaluateNode(F.clauses[J].value,T,M);return null!==F.else?this._evaluateNode(F.else,
T,M):null;case "parameter":return this.parameters[F.value.toLowerCase()];case "expression-list":J=[];for(u of F.value)J.push(this._evaluateNode(u,T,M));return J;case "unary-expression":return h(this._evaluateNode(F.expr,T,M));case "binary-expression":switch(F.operator){case "AND":return n(this._evaluateNode(F.left,T,M),this._evaluateNode(F.right,T,M));case "OR":return z(this._evaluateNode(F.left,T,M),this._evaluateNode(F.right,T,M));case "IS":if("null"!==F.right.type)throw Error("Unsupported RHS for IS");
return null===this._evaluateNode(F.left,T,M);case "ISNOT":if("null"!==F.right.type)throw Error("Unsupported RHS for IS");return null!==this._evaluateNode(F.left,T,M);case "IN":return J=d(this._evaluateNode(F.right,T,M)),k(this._evaluateNode(F.left,T,M),J);case "NOT IN":return J=d(this._evaluateNode(F.right,T,M)),h(k(this._evaluateNode(F.left,T,M),J));case "BETWEEN":return J=this._evaluateNode(F.left,T,M),F=this._evaluateNode(F.right,T,M),null==J||null==F[0]||null==F[1]?null:J>=v(F[0])&&J<=v(F[1]);
case "NOTBETWEEN":return J=this._evaluateNode(F.left,T,M),F=this._evaluateNode(F.right,T,M),null==J||null==F[0]||null==F[1]?null:J<v(F[0])||J>v(F[1]);case "LIKE":return E(this._evaluateNode(F.left,T,M),this._evaluateNode(F.right,T,M),F.escape);case "NOT LIKE":return h(E(this._evaluateNode(F.left,T,M),this._evaluateNode(F.right,T,M),F.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return y(F.operator,this._evaluateNode(F.left,T,M),this._evaluateNode(F.right,
T,M));case "-":case "+":case "*":case "/":case "||":return r(F.operator,this._evaluateNode(F.left,T,M),this._evaluateNode(F.right,T,M))}case "null":case "boolean":case "string":case "number":return F.value;case "date":return f(F.value);case "timestamp":return t(F.value);case "current-time":return T=new Date,"date"===F.mode&&T.setHours(0,0,0,0),T;case "column-reference":return Q(T,F.column,this._datefields,M);case "data-type":return F.value;case "function":return T=this._evaluateNode(F.args,T,M),this.isAggregate?
w.aggregateFunction(F.name,T):x.evaluateFunction(F.name,T)}throw Error("Unsupported sql syntax "+F.type);};l._createClass(H,[{key:"fieldNames",get:function(){return this._referencedFieldNames}},{key:"hasDateFunctions",get:function(){if(null!=this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;this._visitAll(this.parseTree,F=>{"current-time"===F.type?this._hasDateFunctions=!0:"function"===F.type&&(this._hasDateFunctions=this._hasDateFunctions||p.has(F.name.toLowerCase()))});
return this._hasDateFunctions}}]);return H}();var m;(function(H){H[H.Normal=0]="Normal";H[H.Escaped=1]="Escaped"})(m||(m={}));const I={getAttribute(H,S){return(H&&"object"===typeof H.attributes?H.attributes:H)[S]}};e.WhereClause=P;e.defaultAttributeAdapter=I;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define(["exports"],function(e){function l(x){let L=0;for(let N=0;N<x.length;N++)L+=x[N];return L/x.length}function g(x){const L=l(x),
N=x.length;let B=0;for(const t of x)B+=(t-L)**2;return 1<N?B/(N-1):0}const w={min:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.min.apply(Math,x[0])},max:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:Math.max.apply(Math,x[0])},avg:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:l(x[0])},sum:{minParams:1,maxParams:1,evaluate:x=>{if(null==x[0])x=null;else{x=x[0];let L=0;for(let N=0;N<x.length;N++)L+=x[N];x=L}return x}},stddev:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:
Math.sqrt(g(x[0]))},count:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:x[0].length},var:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:g(x[0])}};e.aggregateFunction=function(x,L){const N=w[x.toLowerCase()];if(null==N)throw Error("Function Not Recognised");if(L.length<N.minParams||L.length>N.maxParams)throw Error(`Invalid Parameter count for call to ${x.toUpperCase()}`);return N.evaluate(L)};e.isAggregate=function(x,L){x=w[x.toLowerCase()];return null!=x&&L>=x.minParams&&L<=x.maxParams};
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../arcade/featureset/support/errorsupport","../string","../../chunks/datetime"],function(e,l,g,w,x){function L(f){f=new Date(f.getTime());f.setHours(0,0,0,0);return f}function N(f,d){if(f instanceof Date)return d?L(f):f;if("string"===typeof f||f instanceof String)if(f=x.DateTime.fromSQL(f),f.isValid)return d?L(f.toJSDate()):
f.toJSDate();throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);}let B=function(){function f(){this.op="+";this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}f._fixDefaults=function(d){if(null!==d.precision||null!==d.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};f._parseSecondsComponent=function(d,h){h.includes(".")?(h=h.split("."),d.second=parseFloat(h[0]),d.millis=parseInt(h[1],10)):d.second=parseFloat(h)};f.createFromMilliseconds=
function(d){const h=new f;h.second=d/1E3;return h};f.createFromValueAndQualifer=function(d,h,n){let z=null;const k=new f;k.op="-"===n?"-":"+";if("interval-period"===h.type){f._fixDefaults(h);n=RegExp("^[0-9]{1,}$");if("year"===h.period||"month"===h.period)throw Error("Year-Month Intervals not supported");if("second"===h.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(d))f._parseSecondsComponent(k,d);else throw Error("Illegal Interval");else if(n.test(d))k[h.period]=parseFloat(d);else throw Error("Illegal Interval");
}else{f._fixDefaults(h.start);f._fixDefaults(h.end);if("year"===h.start.period||"month"===h.start.period)throw Error("Year-Month Intervals not supported");if("year"===h.end.period||"month"===h.end.period)throw Error("Year-Month Intervals not supported");switch(h.start.period){case "day":switch(h.end.period){case "hour":z=RegExp("^[0-9]{1,} [0-9]{1,}$");if(z.test(d))k[h.start.period]=parseFloat(d.split(" ")[0]),k[h.end.period]=parseFloat(d.split(" ")[1]);else throw Error("Illegal Interval");break;
case "minute":z=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(z.test(d))k[h.start.period]=parseFloat(d.split(" ")[0]),d=d.split(" ")[1].split(":"),k.hour=parseFloat(d[0]),k.minute=parseFloat(d[1]);else throw Error("Illegal Interval");break;case "second":z=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(z.test(d))k[h.start.period]=parseFloat(d.split(" ")[0]),d=d.split(" ")[1].split(":"),k.hour=parseFloat(d[0]),k.minute=parseFloat(d[1]),f._parseSecondsComponent(k,d[2]);
else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;case "hour":switch(h.end.period){case "minute":z=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(z.test(d))k.hour=parseFloat(d.split(":")[0]),k.minute=parseFloat(d.split(":")[1]);else throw Error("Illegal Interval");break;case "second":z=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(z.test(d))d=d.split(":"),k.hour=parseFloat(d[0]),k.minute=parseFloat(d[1]),f._parseSecondsComponent(k,d[2]);else throw Error("Illegal Interval");
break;default:throw Error("Invalid Interval.");}break;case "minute":switch(h.end.period){case "second":z=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(z.test(d))d=d.split(":"),k.minute=parseFloat(d[0]),f._parseSecondsComponent(k,d[1]);else throw Error("Illegal Interval");break;default:throw Error("Invalid Interval.");}break;default:throw Error("Invalid Interval.");}}return k};f.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+
36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return l._createClass(f)}();const t={extract:{minParams:2,maxParams:2,evaluate:([f,d])=>{if(null==d)return null;if(d instanceof Date)switch(f.toUpperCase()){case "SECOND":return d.getSeconds();case "MINUTE":return d.getMinutes();case "HOUR":return d.getHours();case "DAY":return d.getDate();case "MONTH":return d.getMonth()+1;case "YEAR":return d.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,
maxParams:3,evaluate:f=>{if(2===f.length){const [d,h]=f;return null==d||null==h?null:d.toString().substring(h-1)}if(3===f.length){const [d,h,n]=f;return null==d||null==h||null==n?null:0>=n?"":d.toString().substring(h-1,h+n-1)}}},position:{minParams:2,maxParams:2,evaluate:([f,d])=>null==f||null==d?null:d.indexOf(f)+1},trim:{minParams:2,maxParams:3,evaluate:f=>{var d=3===f.length,h=d?f[1]:" ";d=d?f[2]:f[1];if(null==h||null==d)return null;h=`(${w.escapeRegExpString(h)})`;switch(f[0]){case "BOTH":return d.replace(new RegExp(`^${h}*|${h}*$`,
"g"),"");case "LEADING":return d.replace(new RegExp(`^${h}*`,"g"),"");case "TRAILING":return d.replace(new RegExp(`${h}*$`,"g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.abs(f[0])},ceiling:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.ceil(f[0])},floor:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.floor(f[0])},log:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.log(f[0])},log10:{minParams:1,
maxParams:1,evaluate:f=>null==f[0]?null:Math.log(f[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.sin(f[0])},cos:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.cos(f[0])},tan:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.tan(f[0])},asin:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.asin(f[0])},acos:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.acos(f[0])},atan:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.atan(f[0])},
sign:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:0<f[0]?1:0>f[1]?-1:0},power:{minParams:2,maxParams:2,evaluate:f=>null==f[0]||null==f[1]?null:f[0]**f[1]},mod:{minParams:2,maxParams:2,evaluate:f=>null==f[0]||null==f[1]?null:f[0]%f[1]},round:{minParams:1,maxParams:2,evaluate:f=>{const d=f[0];f=2===f.length?10**f[1]:1;return null==d?null:Math.round(d*f)/f}},truncate:{minParams:1,maxParams:2,evaluate:f=>null==f[0]?null:1===f.length?parseInt(f[0].toFixed(0),10):parseFloat(f[0].toFixed(f[1]))},
char_length:{minParams:1,maxParams:1,evaluate:f=>"string"===typeof f[0]||f[0]instanceof String?f[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:f=>{let d="";for(let h=0;h<f.length;h++){if(null==f[h])return null;d+=f[h].toString()}return d}},lower:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:f[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:f[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:f=>{for(const d of f)if(null!==
d)return d;return null}},cosh:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.cosh(f[0])},sinh:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.sinh(f[0])},tanh:{minParams:1,maxParams:1,evaluate:f=>null==f[0]?null:Math.tanh(f[0])},nullif:{minParams:2,maxParams:2,evaluate:f=>{const d=f[0];f=f[1];return(d instanceof Date?d.valueOf():d)===(f instanceof Date?f.valueOf():f)?null:d}},cast:{minParams:2,maxParams:2,evaluate:f=>{var d=f[0];f=f[1];if(null===d)return null;switch(f.type){case "integer":d=
parseInt(d,10);if(isNaN(d))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);return d;case "smallint":d=parseInt(d,10);if(isNaN(d))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);if(32767<d||-32767>d)throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);return d;case "float":case "real":d=parseFloat(d);if(isNaN(d))throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);return d;case "date":return N(d,!0);case "timestamp":return N(d,!1);case "varchar":d=d.toString();if(d.length>f.size)throw new g.SqlError(g.SqlErrorCodes.CannotCastValue);
return d;default:throw new g.SqlError(g.SqlErrorCodes.InvalidDataType);}}}};e.SqlInterval=B;e.evaluateFunction=function(f,d){const h=t[f.toLowerCase()];if(null==h)throw Error("Function Not Recognised");if(d.length<h.minParams||d.length>h.maxParams)throw Error(`Invalid Parameter count for call to ${f.toUpperCase()}`);return h.evaluate(d)};e.isStandardized=function(f,d){f=t[f.toLowerCase()];return null!=f&&d>=f.minParams&&d<=f.maxParams};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/arcade/featureset/support/errorsupport":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../executionError"],function(e,l,g){e.SqlErrorCodes=void 0;(function(B){B.InvalidFunctionParameters="InvalidFunctionParameters";B.UnsupportedSqlFunction="UnsupportedSqlFunction";B.UnsupportedOperator="UnsupportedOperator";B.UnsupportedSyntax="UnsupportedSyntax";B.UnsupportedIsRhs="UnsupportedIsRhs";B.UnsupportedIsLhs="UnsupportedIsLhs";B.InvalidDataType="InvalidDataType";B.CannotCastValue=
"CannotCastValue";B.MissingStatisticParameters="MissingStatisticParameters"})(e.SqlErrorCodes||(e.SqlErrorCodes={}));const w={[e.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[e.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[e.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[e.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[e.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",
[e.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[e.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[e.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",[e.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};let x=function(B){function t(d,h){d=f.call(this,g.doSubstitutions(w[d],h));d.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(l._assertThisInitialized(d),
t);return d}l._inherits(t,B);var f=l._createSuper(t);return l._createClass(t)}(l._wrapNativeSuper(Error));e.FeatureSetErrorCodes=void 0;(function(B){B.NeverReach="NeverReach";B.NotImplemented="NotImplemented";B.Cancelled="Cancelled";B.InvalidStatResponse="InvalidStatResponse";B.InvalidRequest="InvalidRequest";B.RequestFailed="RequestFailed";B.MissingFeatures="MissingFeatures";B.AggregationFieldNotFound="AggregationFieldNotFound";B.DataElementsNotFound="DataElementsNotFound"})(e.FeatureSetErrorCodes||
(e.FeatureSetErrorCodes={}));const L={[e.FeatureSetErrorCodes.Cancelled]:"Cancelled",[e.FeatureSetErrorCodes.InvalidStatResponse]:"Invalid statistics response from service",[e.FeatureSetErrorCodes.InvalidRequest]:"Invalid request",[e.FeatureSetErrorCodes.RequestFailed]:"Request failed - {reason}",[e.FeatureSetErrorCodes.MissingFeatures]:"Missing features",[e.FeatureSetErrorCodes.AggregationFieldNotFound]:"Aggregation field not found",[e.FeatureSetErrorCodes.DataElementsNotFound]:"Data elements not found on service",
[e.FeatureSetErrorCodes.NeverReach]:"Encountered unreachable logic",[e.FeatureSetErrorCodes.NotImplemented]:"Not implemented"};let N=function(B){function t(d,h){d=f.call(this,g.doSubstitutions(L[d],h));d.declaredRootClass="esri.arcade.featureset.support.featureseterror";Error.captureStackTrace&&Error.captureStackTrace(l._assertThisInitialized(d),t);return d}l._inherits(t,B);var f=l._createSuper(t);return l._createClass(t)}(l._wrapNativeSuper(Error));e.FeatureSetError=N;e.FeatureSetErrorMessages=L;
e.SqlError=x;e.SqlErrorMessages=w;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../chunks/_commonjsHelpers"],function(e,l,g){var w={};(function(L){(function(N,B){L.exports&&(L.exports=B())})(g.commonjsGlobal,function(){function N(t,f,d,h){t=Error.call(this,t);Object.setPrototypeOf&&Object.setPrototypeOf(t,N.prototype);t.expected=f;t.found=d;t.location=h;t.name="SyntaxError";return t}
function B(t,f,d){d=d||" ";if(t.length>f)return t;f-=t.length;d+=d.repeat(f);return t+d.slice(0,f)}(function(t,f){function d(){this.constructor=t}d.prototype=f.prototype;t.prototype=new d})(N,Error);N.prototype.format=function(t){var f="Error: "+this.message;if(this.location){var d=null,h;for(h=0;h<t.length;h++)if(t[h].source===this.location.source){d=t[h].text.split(/\r\n|\n|\r/g);break}t=this.location.start;h=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(t):
t;var n=this.location.source+":"+h.line+":"+h.column;if(d){var z=this.location.end,k=B("",h.line.toString().length," ");d=d[t.line-1];z=(t.line===z.line?z.column:d.length+1)-t.column||1;f+="\n --\x3e "+n+"\n"+k+" |\n"+h.line+" | "+d+"\n"+k+" | "+B("",t.column-1," ")+B("",z,"^")}else f+="\n at "+n}return f};N.buildMessage=function(t,f){function d(E){return E.charCodeAt(0).toString(16).toUpperCase()}function h(E){return E.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,
"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(v){return"\\x0"+d(v)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(v){return"\\x"+d(v)})}function n(E){return E.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(v){return"\\x0"+d(v)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(v){return"\\x"+d(v)})}function z(E){return k[E.type](E)}
var k={literal:function(E){return'"'+h(E.text)+'"'},class:function(E){var v=E.parts.map(function(y){return Array.isArray(y)?n(y[0])+"-"+n(y[1]):n(y)});return"["+(E.inverted?"^":"")+v.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(E){return E.description}};return"Expected "+function(E){E=E.map(z);var v,y;E.sort();if(0<E.length){for(y=v=1;v<E.length;v++)E[v-1]!==E[v]&&(E[y]=E[v],y++);E.length=y}switch(E.length){case 1:return E[0];case 2:return E[0]+
" or "+E[1];default:return E.slice(0,-1).join(", ")+", or "+E[E.length-1]}}(t)+" but "+(f?'"'+h(f)+'"':"end of input")+" found."};return{SyntaxError:N,parse:function(t,f){function d(U,W){return{type:"literal",text:U,ignoreCase:W}}function h(U,W,Z){return{type:"class",parts:U,inverted:W,ignoreCase:Z}}function n(U){var W=Gb[U],Z;if(!W){for(Z=U-1;!Gb[Z];)Z--;W=Gb[Z];for(W={line:W.line,column:W.column};Z<U;)10===t.charCodeAt(Z)?(W.line++,W.column=1):W.column++,Z++;Gb[U]=W}return W}function z(U,W,Z){var la=
n(U),wa=n(W);U={source:tb,start:{offset:U,line:la.line,column:la.column},end:{offset:W,line:wa.line,column:wa.column}};Z&&tb&&"function"===typeof tb.offset&&(U.start=tb.offset(U.start),U.end=tb.offset(U.end));return U}function k(U){G<Va||(G>Va&&(Va=G,fc=[]),fc.push(U))}function E(){var U=G;na();var W=y();W!==q?(na(),U=W):(G=U,U=q);return U}function v(){var U=G;var W=y();if(W!==q){U=[];var Z=G;var la=na();var wa=Hb();if(wa!==q){var Ba=na();var Ca=y();Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)}else G=Z,Z=
q;for(;Z!==q;)U.push(Z),Z=G,la=na(),wa=Hb(),wa!==q?(Ba=na(),Ca=y(),Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)):(G=Z,Z=q);Z={type:"expression-list"};W=[W];for(la=0;la<U.length;la++)W.push(U[la][3]);Z.value=W;U=Z}else G=U,U=q;return U}function y(){var U=G;var W=r();if(W!==q){U=[];var Z=G;var la=na();var wa=za();if(wa!==q){var Ba=na();var Ca=r();Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)}else G=Z,Z=q;for(;Z!==q;)U.push(Z),Z=G,la=na(),wa=za(),wa!==q?(Ba=na(),Ca=r(),Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)):(G=Z,Z=q);U=
ub(W,U)}else G=U,U=q;return U}function r(){var U=G;var W=Q();if(W!==q){U=[];var Z=G;var la=na();var wa=oa();if(wa!==q){var Ba=na();var Ca=Q();Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)}else G=Z,Z=q;for(;Z!==q;)U.push(Z),Z=G,la=na(),wa=oa(),wa!==q?(Ba=na(),Ca=Q(),Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)):(G=Z,Z=q);U=ub(W,U)}else G=U,U=q;return U}function Q(){var U=G;var W=ya();if(W===q){W=G;if(33===t.charCodeAt(G)){var Z=sd;G++}else Z=q,0===ka&&k(td);if(Z!==q){var la=G;ka++;if(61===t.charCodeAt(G)){var wa=xc;
G++}else wa=q,0===ka&&k(yc);ka--;wa===q?la=void 0:(G=la,la=q);la!==q?W=Z=[Z,la]:(G=W,W=q)}else G=W,W=q}W!==q?(Z=na(),la=Q(),la!==q?U={type:"unary-expression",operator:"NOT",expr:la}:(G=U,U=q)):(G=U,U=q);if(U===q){W=G;U=c();if(U!==q){na();W=[];Z=G;la=na();wa=O();if(wa!==q){var Ba=na();var Ca=c();Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)}else G=Z,Z=q;if(Z!==q)for(;Z!==q;)W.push(Z),Z=G,la=na(),wa=O(),wa!==q?(Ba=na(),Ca=c(),Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)):(G=Z,Z=q);else W=q;W!==q&&(W={type:"arithmetic",
tail:W});W===q&&(W=G,Z=b(),Z!==q?(na(),la=Ma(),la!==q?(na(),la=v(),la!==q?(na(),wa=Na(),wa!==q?W={op:Z,right:la}:(G=W,W=q)):(G=W,W=q)):(G=W,W=q)):(G=W,W=q),W===q&&(W=G,Z=b(),Z!==q?(na(),la=Ma(),la!==q?(na(),la=Na(),la!==q?W={op:Z,right:{type:"expression-list",value:[]}}:(G=W,W=q)):(G=W,W=q)):(G=W,W=q),W===q&&(W=G,Z=b(),Z!==q?(na(),la=F(),la!==q?W={op:Z,right:la}:(G=W,W=q)):(G=W,W=q))),W===q&&(W=G,wa=ya(),wa!==q?(na(),Z=Ga(),Z!==q?(na(),la=c(),la!==q?(na(),Ba=oa(),Ba!==q?(na(),wa=c(),wa!==q?W={op:"NOT"+
Z,right:{type:"expression-list",value:[la,wa]}}:(G=W,W=q)):(G=W,W=q)):(G=W,W=q)):(G=W,W=q)):(G=W,W=q),W===q&&(W=G,wa=Ga(),wa!==q?(na(),Z=c(),Z!==q?(na(),la=oa(),la!==q?(na(),Ba=c(),Ba!==q?W={op:wa,right:{type:"expression-list",value:[Z,Ba]}}:(G=W,W=q)):(G=W,W=q)):(G=W,W=q)):(G=W,W=q)),W===q&&(W=G,Z=sa(),Z!==q?(na(),la=ya(),la!==q?(na(),la=c(),la!==q?W={op:Z+"NOT",right:la}:(G=W,W=q)):(G=W,W=q)):(G=W,W=q),W===q&&(W=G,Z=sa(),Z!==q?(na(),la=c(),la!==q?W={op:Z,right:la}:(G=W,W=q)):(G=W,W=q)),W===q&&(W=
G,Z=A(),Z!==q?(na(),la=K(),la!==q?(na(),wa=G,t.substr(G,6).toLowerCase()===ud?(Ba=t.substr(G,6),G+=6):(Ba=q,0===ka&&k(vd)),Ba!==q?(Ba=G,ka++,Ca=H(),ka--,Ca===q?Ba=void 0:(G=Ba,Ba=q),Ba!==q?wa="ESCAPE":(G=wa,wa=q)):(G=wa,wa=q),wa!==q?(na(),wa=R(),wa!==q?W={op:Z,right:la,escape:wa.value}:(G=W,W=q)):(G=W,W=q)):(G=W,W=q)):(G=W,W=q),W===q&&(W=G,Z=A(),Z!==q?(na(),la=K(),la!==q?W={op:Z,right:la,escape:""}:(G=W,W=q)):(G=W,W=q))))));W===q&&(W=null);""==W||void 0==W||null==W?W=U:(Z=null,W=Z="arithmetic"==W.type?
ub(U,W.tail):zc(W.op,U,W.right,W.escape))}else G=W,W=q;U=W}return U}function O(){if(t.substr(G,2)===Ac){var U=Ac;G+=2}else U=q,0===ka&&k(wd);U===q&&(62===t.charCodeAt(G)?(U=xd,G++):(U=q,0===ka&&k(yd)),U===q&&(t.substr(G,2)===Bc?(U=Bc,G+=2):(U=q,0===ka&&k(zd)),U===q&&(t.substr(G,2)===Cc?(U=Cc,G+=2):(U=q,0===ka&&k(Ad)),U===q&&(60===t.charCodeAt(G)?(U=Bd,G++):(U=q,0===ka&&k(Cd)),U===q&&(61===t.charCodeAt(G)?(U=xc,G++):(U=q,0===ka&&k(yc)),U===q&&(t.substr(G,2)===Dc?(U=Dc,G+=2):(U=q,0===ka&&k(Dd))))))));
return U}function A(){var U=U=G;var W=ya();if(W!==q){var Z=na();var la=xa();la!==q?U=W=[W,Z,la]:(G=U,U=q)}else G=U,U=q;U!==q&&(U=U[0]+" "+U[2]);U===q&&(U=xa());return U}function b(){var U=U=G;var W=ya();if(W!==q){var Z=na();var la=pa();la!==q?U=W=[W,Z,la]:(G=U,U=q)}else G=U,U=q;U!==q&&(U=U[0]+" "+U[2]);U===q&&(U=pa());return U}function c(){var U=G;var W=p();if(W!==q){U=[];var Z=G;var la=na();var wa=a();if(wa!==q){var Ba=na();var Ca=p();Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)}else G=Z,Z=q;for(;Z!==q;)U.push(Z),
Z=G,la=na(),wa=a(),wa!==q?(Ba=na(),Ca=p(),Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)):(G=Z,Z=q);U=ub(W,U)}else G=U,U=q;return U}function a(){if(43===t.charCodeAt(G)){var U=gc;G++}else U=q,0===ka&&k(hc);U===q&&(45===t.charCodeAt(G)?(U=ic,G++):(U=q,0===ka&&k(jc)),U===q&&(t.substr(G,2)===Ec?(U=Ec,G+=2):(U=q,0===ka&&k(Ed))));return U}function p(){var U=G;var W=P();if(W!==q){U=[];var Z=G;var la=na();var wa=D();if(wa!==q){var Ba=na();var Ca=P();Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)}else G=Z,Z=q;for(;Z!==q;)U.push(Z),
Z=G,la=na(),wa=D(),wa!==q?(Ba=na(),Ca=P(),Ca!==q?Z=la=[la,wa,Ba,Ca]:(G=Z,Z=q)):(G=Z,Z=q);U=ub(W,U)}else G=U,U=q;return U}function D(){if(42===t.charCodeAt(G)){var U=Fd;G++}else U=q,0===ka&&k(Gd);U===q&&(47===t.charCodeAt(G)?(U=Hd,G++):(U=q,0===ka&&k(Id)));return U}function P(){var U=R();if(U===q){var W=G;var Z=G;var la=ea();if(la!==q){var wa=Y();if(wa!==q){var Ba=ca();Ba!==q?Z=parseFloat(la+wa+Ba):(G=Z,Z=q)}else G=Z,Z=q}else G=Z,Z=q;Z===q&&(Z=G,la=ea(),la!==q?(wa=Y(),wa!==q?Z=parseFloat(la+wa):(G=
Z,Z=q)):(G=Z,Z=q),Z===q&&(Z=G,la=ea(),la!==q?(wa=ca(),wa!==q?Z=parseFloat(la+wa):(G=Z,Z=q)):(G=Z,Z=q),Z===q&&(Z=G,la=ea(),la!==q&&(la=parseFloat(la)),Z=la)));var Ca=Z;if(Ca!==q){var Ib=G;ka++;var Jd=I();ka--;Jd===q?Ib=void 0:(G=Ib,Ib=q);Ib!==q?W={type:"number",value:Ca}:(G=W,W=q)}else G=W,W=q;U=W;if(U===q){var vb=G;var db=G;if(t.substr(G,4).toLowerCase()===Kd){var Jb=t.substr(G,4);G+=4}else Jb=q,0===ka&&k(Ld);if(Jb!==q){var wb=G;ka++;var Md=H();ka--;Md===q?wb=void 0:(G=wb,wb=q);wb!==q?db=Jb=[Jb,wb]:
(G=db,db=q)}else G=db,db=q;var cb=db;cb!==q&&(cb={type:"boolean",value:!0});vb=cb;if(vb===q){vb=G;var eb=G;if(t.substr(G,5).toLowerCase()===Nd){var Kb=t.substr(G,5);G+=5}else Kb=q,0===ka&&k(Od);if(Kb!==q){var xb=G;ka++;var Pd=H();ka--;Pd===q?xb=void 0:(G=xb,xb=q);xb!==q?eb=Kb=[Kb,xb]:(G=eb,eb=q)}else G=eb,eb=q;cb=eb;cb!==q&&(cb={type:"boolean",value:!1});vb=cb}U=vb;if(U===q){var fb=G;if(t.substr(G,4).toLowerCase()===Qd){var Lb=t.substr(G,4);G+=4}else Lb=q,0===ka&&k(Rd);if(Lb!==q){var yb=G;ka++;var Sd=
H();ka--;Sd===q?yb=void 0:(G=yb,yb=q);yb!==q?fb=Lb=[Lb,yb]:(G=fb,fb=q)}else G=fb,fb=q;var kc=fb;kc!==q&&(kc={type:"null",value:null});U=kc;if(U===q){var gb=G;if(fa()!==q){na();var Fc=K();Fc!==q?gb={type:"date",value:Fc.value}:(G=gb,gb=q)}else G=gb,gb=q;U=gb;if(U===q){var hb=G;if(ia()!==q){na();var Gc=K();Gc!==q?hb={type:"timestamp",value:Gc.value}:(G=hb,hb=q)}else G=hb,hb=q;U=hb;if(U===q){var Ka=G;var lc=ma();if(lc!==q){na();if(45===t.charCodeAt(G)){var Ya=ic;G++}else Ya=q,0===ka&&k(jc);Ya===q&&(43===
t.charCodeAt(G)?(Ya=gc,G++):(Ya=q,0===ka&&k(hc)));if(Ya!==q){na();var zb=K();if(zb!==q){na();var Hc=M();Hc!==q?Ka={type:"interval",value:zb,qualifier:Hc,op:Ya}:(G=Ka,Ka=q)}else G=Ka,Ka=q}else G=Ka,Ka=q}else G=Ka,Ka=q;Ka===q&&(Ka=G,lc=ma(),lc!==q?(na(),Ya=K(),Ya!==q?(na(),zb=M(),zb!==q?Ka={type:"interval",value:Ya,qualifier:zb,op:""}:(G=Ka,Ka=q)):(G=Ka,Ka=q)):(G=Ka,Ka=q));U=Ka}}}}}}var Ea=U;if(Ea===q){var Pa=G;var ib=G;if(t.substr(G,7).toLowerCase()===Td){var Ic=t.substr(G,7);G+=7}else Ic=q,0===ka&&
k(Ud);if(Ic!==q){var Mb=G;ka++;var Vd=H();ka--;Vd===q?Mb=void 0:(G=Mb,Mb=q);Mb!==q?ib="EXTRACT":(G=ib,ib=q)}else G=ib,ib=q;if(ib!==q){na();var Wd=Ma();if(Wd!==q){na();var Ta=ua();Ta===q&&(Ta=ta(),Ta===q&&(Ta=qa(),Ta===q&&(Ta=ra(),Ta===q&&(Ta=va(),Ta===q&&(Ta=Aa())))));var Jc=Ta;if(Jc!==q){na();var Xd=aa();if(Xd!==q){na();var Kc=y();if(Kc!==q){na();var Yd=Na();Yd!==q?Pa={type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:Jc},Kc]}}:(G=Pa,Pa=q)}else G=Pa,Pa=q}else G=
Pa,Pa=q}else G=Pa,Pa=q}else G=Pa,Pa=q}else G=Pa,Pa=q;Ea=Pa;if(Ea===q){var Qa=G;var jb=G;if(t.substr(G,9).toLowerCase()===Zd){var Lc=t.substr(G,9);G+=9}else Lc=q,0===ka&&k($d);if(Lc!==q){var Nb=G;ka++;var ae=H();ka--;ae===q?Nb=void 0:(G=Nb,Nb=q);Nb!==q?jb="SUBSTRING":(G=jb,jb=q)}else G=jb,jb=q;if(jb!==q){na();var be=Ma();if(be!==q){na();var mc=y();if(mc!==q){na();var ce=aa();if(ce!==q){na();var nc=y();if(nc!==q){na();var Za=G;var kb=G;if(t.substr(G,3).toLowerCase()===de){var Mc=t.substr(G,3);G+=3}else Mc=
q,0===ka&&k(ee);if(Mc!==q){var Ob=G;ka++;var fe=H();ka--;fe===q?Ob=void 0:(G=Ob,Ob=q);Ob!==q?kb="FOR":(G=kb,kb=q)}else G=kb,kb=q;var Ab=kb;if(Ab!==q){var ge=na();var Nc=y();if(Nc!==q){var he=na();Za=Ab=[Ab,ge,Nc,he]}else G=Za,Za=q}else G=Za,Za=q;Za===q&&(Za=null);Ab=Na();Ab!==q?Qa={type:"function",name:"substring",args:{type:"expression-list",value:Za?[mc,nc,Za[2]]:[mc,nc]}}:(G=Qa,Qa=q)}else G=Qa,Qa=q}else G=Qa,Qa=q}else G=Qa,Qa=q}else G=Qa,Qa=q}else G=Qa,Qa=q;Ea=Qa;if(Ea===q){var Ha=G;var oc=ha();
if(oc!==q){na();var pc=Ma();if(pc!==q){na();var $a=T();$a===q&&($a=null);na();var Bb=y();if(Bb!==q){na();var qc=aa();if(qc!==q){na();var Oc=y();if(Oc!==q){na();var ie=Na();ie!==q?Ha={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==$a?"BOTH":$a},Bb,Oc]}}:(G=Ha,Ha=q)}else G=Ha,Ha=q}else G=Ha,Ha=q}else G=Ha,Ha=q}else G=Ha,Ha=q}else G=Ha,Ha=q;Ha===q&&(Ha=G,oc=ha(),oc!==q?(na(),pc=Ma(),pc!==q?(na(),$a=T(),$a===q&&($a=null),na(),Bb=y(),Bb!==q?(na(),qc=Na(),qc!==
q?Ha={type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:null==$a?"BOTH":$a},Bb]}}:(G=Ha,Ha=q)):(G=Ha,Ha=q)):(G=Ha,Ha=q)):(G=Ha,Ha=q));Ea=Ha;if(Ea===q){var Ra=G;var lb=G;if(t.substr(G,8).toLowerCase()===je){var Pc=t.substr(G,8);G+=8}else Pc=q,0===ka&&k(ke);if(Pc!==q){var Pb=G;ka++;var le=H();ka--;le===q?Pb=void 0:(G=Pb,Pb=q);Pb!==q?lb="POSITION":(G=lb,lb=q)}else G=lb,lb=q;if(lb!==q){na();var me=Ma();if(me!==q){na();var Qc=y();if(Qc!==q){na();var ne=pa();if(ne!==q){na();
var Rc=y();if(Rc!==q){na();var oe=Na();oe!==q?Ra={type:"function",name:"position",args:{type:"expression-list",value:[Qc,Rc]}}:(G=Ra,Ra=q)}else G=Ra,Ra=q}else G=Ra,Ra=q}else G=Ra,Ra=q}else G=Ra,Ra=q}else G=Ra,Ra=q;Ea=Ra;if(Ea===q){var Sa=G;var mb=G;if(t.substr(G,4).toLowerCase()===pe){var Sc=t.substr(G,4);G+=4}else Sc=q,0===ka&&k(qe);if(Sc!==q){var Qb=G;ka++;var re=H();ka--;re===q?Qb=void 0:(G=Qb,Qb=q);Qb!==q?mb="CAST":(G=mb,mb=q)}else G=mb,mb=q;if(mb!==q){na();var se=Ma();if(se!==q){na();var Tc=
y();if(Tc!==q){na();var nb=G;if(t.substr(G,2).toLowerCase()===te){var Uc=t.substr(G,2);G+=2}else Uc=q,0===ka&&k(ue);if(Uc!==q){var Rb=G;ka++;var ve=H();ka--;ve===q?Rb=void 0:(G=Rb,Rb=q);Rb!==q?nb="AS":(G=nb,nb=q)}else G=nb,nb=q;var we=nb;if(we!==q){na();var Fa=G;var ob=G;if(t.substr(G,7).toLowerCase()===xe){var Vc=t.substr(G,7);G+=7}else Vc=q,0===ka&&k(ye);if(Vc!==q){var Sb=G;ka++;var ze=H();ka--;ze===q?Sb=void 0:(G=Sb,Sb=q);Sb!==q?ob="INTEGER":(G=ob,ob=q)}else G=ob,ob=q;var Ia=ob;Ia!==q&&(Ia={type:"data-type",
value:{type:"integer"}});Fa=Ia;if(Fa===q){Fa=G;var pb=G;if(t.substr(G,8).toLowerCase()===Ae){var Wc=t.substr(G,8);G+=8}else Wc=q,0===ka&&k(Be);if(Wc!==q){var Tb=G;ka++;var Ce=H();ka--;Ce===q?Tb=void 0:(G=Tb,Tb=q);Tb!==q?pb="SMALLINT":(G=pb,pb=q)}else G=pb,pb=q;Ia=pb;Ia!==q&&(Ia={type:"data-type",value:{type:"smallint"}});Fa=Ia;if(Fa===q){Fa=G;var qb=G;if(t.substr(G,5).toLowerCase()===De){var Xc=t.substr(G,5);G+=5}else Xc=q,0===ka&&k(Ee);if(Xc!==q){var Ub=G;ka++;var Fe=H();ka--;Fe===q?Ub=void 0:(G=
Ub,Ub=q);Ub!==q?qb="FLOAT":(G=qb,qb=q)}else G=qb,qb=q;Ia=qb;Ia!==q&&(Ia={type:"data-type",value:{type:"float"}});Fa=Ia;if(Fa===q){Fa=G;var rb=G;if(t.substr(G,4).toLowerCase()===Ge){var Yc=t.substr(G,4);G+=4}else Yc=q,0===ka&&k(He);if(Yc!==q){var Vb=G;ka++;var Ie=H();ka--;Ie===q?Vb=void 0:(G=Vb,Vb=q);Vb!==q?rb="REAL":(G=rb,rb=q)}else G=rb,rb=q;Ia=rb;Ia!==q&&(Ia={type:"data-type",value:{type:"real"}});Fa=Ia;if(Fa===q&&(Fa=G,Ia=fa(),Ia!==q&&(Ia={type:"data-type",value:{type:"date"}}),Fa=Ia,Fa===q&&(Fa=
G,Ia=ia(),Ia!==q&&(Ia={type:"data-type",value:{type:"timestamp"}}),Fa=Ia,Fa===q))){Fa=G;var sb=G;if(t.substr(G,7).toLowerCase()===Je){var Zc=t.substr(G,7);G+=7}else Zc=q,0===ka&&k(Ke);if(Zc!==q){var Wb=G;ka++;var Le=H();ka--;Le===q?Wb=void 0:(G=Wb,Wb=q);Wb!==q?sb="VARCHAR":(G=sb,sb=q)}else G=sb,sb=q;Ia=sb;if(Ia!==q){na();var Me=Ma();if(Me!==q){na();var $c=da();if($c!==q){na();var Ne=Na();Ne!==q?Fa={type:"data-type",value:{type:"varchar",size:parseInt($c)}}:(G=Fa,Fa=q)}else G=Fa,Fa=q}else G=Fa,Fa=
q}else G=Fa,Fa=q}}}}var ad=Fa;if(ad!==q){na();var Oe=Na();Oe!==q?Sa={type:"function",name:"cast",args:{type:"expression-list",value:[Tc,ad]}}:(G=Sa,Sa=q)}else G=Sa,Sa=q}else G=Sa,Sa=q}else G=Sa,Sa=q}else G=Sa,Sa=q}else G=Sa,Sa=q;Ea=Sa;if(Ea===q){var bb=G;var Xb;var Ua=G;Ua=Xb=m();if(Ua===q)if(Ua=G,96===t.charCodeAt(G)?(Xb=bd,G++):(Xb=q,0===ka&&k(cd)),Xb!==q){var Yb=[];if(dd.test(t.charAt(G))){var ab=t.charAt(G);G++}else ab=q,0===ka&&k(ed);if(ab!==q)for(;ab!==q;)Yb.push(ab),dd.test(t.charAt(G))?(ab=
t.charAt(G),G++):(ab=q,0===ka&&k(ed));else Yb=q;Yb!==q?(96===t.charCodeAt(G)?(ab=bd,G++):(ab=q,0===ka&&k(cd)),ab!==q?Ua=Yb.join(""):(G=Ua,Ua=q)):(G=Ua,Ua=q)}else G=Ua,Ua=q;var fd=Ua;if(fd!==q){na();var Pe=Ma();if(Pe!==q){na();var Zb=v();Zb===q&&(Zb=null);na();var Qe=Na();Qe!==q?bb={type:"function",name:fd,args:Zb?Zb:{type:"expression-list",value:[]}}:(G=bb,bb=q)}else G=bb,bb=q}else G=bb,bb=q;Ea=bb;if(Ea===q){var Wa;var La=G;var rc=Ja();if(rc!==q){na();var Cb=y();if(Cb!==q){na();var Db=[];for(Wa=X();Wa!==
q;)Db.push(Wa),Wa=X();Wa=na();var $b=Da();$b!==q?La={type:"case-expression",format:"simple",operand:Cb,clauses:Db,else:null}:(G=La,La=q)}else G=La,La=q}else G=La,La=q;if(La===q)if(La=G,rc=Ja(),rc!==q)if(na(),Cb=y(),Cb!==q){na();Db=[];for(Wa=X();Wa!==q;)Db.push(Wa),Wa=X();Wa=na();$b=ba();if($b!==q){na();var Re=Da();Re!==q?La={type:"case-expression",format:"simple",operand:Cb,clauses:Db,else:$b.value}:(G=La,La=q)}else G=La,La=q}else G=La,La=q;else G=La,La=q;var sc=La;if(sc===q){var Xa;var Oa=G;var tc=
Ja();if(tc!==q){na();var Eb=[];for(Xa=V();Xa!==q;)Eb.push(Xa),Xa=V();Xa=na();var ac=Da();ac!==q?Oa={type:"case-expression",format:"searched",clauses:Eb,else:null}:(G=Oa,Oa=q)}else G=Oa,Oa=q;if(Oa===q)if(Oa=G,tc=Ja(),tc!==q){na();Eb=[];for(Xa=V();Xa!==q;)Eb.push(Xa),Xa=V();Xa=na();ac=ba();if(ac!==q){na();var Se=Da();Se!==q?Oa={type:"case-expression",format:"searched",clauses:Eb,else:ac.value}:(G=Oa,Oa=q)}else G=Oa,Oa=q}else G=Oa,Oa=q;sc=Oa}Ea=sc;if(Ea===q){var bc;var cc=G;var gd=I();if(gd!==q){var hd=
[];for(bc=S();bc!==q;)hd.push(bc),bc=S();cc=gd+hd.join("")}else G=cc,cc=q;var dc=cc;if(dc!==q){var uc=dc;dc=/^CURRENT_DATE$/i.test(uc)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(uc)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:uc}}Ea=dc;if(Ea===q&&(Ea=F(),Ea===q)){Ea=G;var Te=Ma();if(Te!==q){na();var vc=y();if(vc!==q){na();var Ue=Na();Ue!==q?(vc.paren=!0,Ea=vc):(G=Ea,Ea=q)}else G=Ea,Ea=q}else G=Ea,Ea=q}}}}}}}}}return Ea}function m(){var U;var W=
G;var Z=I();if(Z!==q){W=[];for(U=H();U!==q;)W.push(U),U=H();W=Z+W.join("")}else G=W,W=q;return W}function I(){if(Ve.test(t.charAt(G))){var U=t.charAt(G);G++}else U=q,0===ka&&k(We);return U}function H(){if(Xe.test(t.charAt(G))){var U=t.charAt(G);G++}else U=q,0===ka&&k(Ye);return U}function S(){if(Ze.test(t.charAt(G))){var U=t.charAt(G);G++}else U=q,0===ka&&k($e);return U}function F(){var U=G;if(64===t.charCodeAt(G)){var W=af;G++}else W=q,0===ka&&k(bf);if(W!==q){var Z=m();Z!==q?U=W=[W,Z]:(G=U,U=q)}else G=
U,U=q;U!==q&&(U={type:"parameter",value:U[1]});return U}function T(){var U=G;if(t.substr(G,7).toLowerCase()===cf){var W=t.substr(G,7);G+=7}else W=q,0===ka&&k(df);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="LEADING":(G=U,U=q)}else G=U,U=q;U===q&&(U=G,t.substr(G,8).toLowerCase()===ef?(W=t.substr(G,8),G+=8):(W=q,0===ka&&k(ff)),W!==q?(W=G,ka++,Z=H(),ka--,Z===q?W=void 0:(G=W,W=q),W!==q?U="TRAILING":(G=U,U=q)):(G=U,U=q),U===q&&(U=G,t.substr(G,4).toLowerCase()===gf?(W=t.substr(G,
4),G+=4):(W=q,0===ka&&k(hf)),W!==q?(W=G,ka++,Z=H(),ka--,Z===q?W=void 0:(G=W,W=q),W!==q?U="BOTH":(G=U,U=q)):(G=U,U=q)));return U}function M(){var U=G;var W=G;var Z=J();if(Z!==q){na();var la=Ma();if(la!==q)if(na(),la=C(),la!==q){na();var wa=Na();wa!==q?W={type:"interval-period",period:Z.value,precision:la,secondary:null}:(G=W,W=q)}else G=W,W=q;else G=W,W=q}else G=W,W=q;W===q&&(W=G,Z=J(),Z!==q&&(Z={type:"interval-period",period:Z.value,precision:null,secondary:null}),W=Z);if(W!==q)if(na(),Z=G,t.substr(G,
2).toLowerCase()===jf?(la=t.substr(G,2),G+=2):(la=q,0===ka&&k(kf)),la!==q?(la=G,ka++,wa=H(),ka--,wa===q?la=void 0:(G=la,la=q),la!==q?Z="TO":(G=Z,Z=q)):(G=Z,Z=q),Z!==q){na();Z=G;la=J();la!==q&&(la={type:"interval-period",period:la.value,precision:null,secondary:null});Z=la;if(Z===q){Z=G;la=Aa();if(la!==q)if(na(),la=Ma(),la!==q)if(na(),la=C(),la!==q)if(na(),wa=Hb(),wa!==q)if(na(),wa=u(),wa!==q){na();var Ba=Na();Ba!==q?Z={type:"interval-period",period:"second",precision:la,secondary:wa}:(G=Z,Z=q)}else G=
Z,Z=q;else G=Z,Z=q;else G=Z,Z=q;else G=Z,Z=q;else G=Z,Z=q;Z===q&&(Z=G,la=Aa(),la!==q?(na(),la=Ma(),la!==q?(na(),la=C(),la!==q?(na(),wa=Na(),wa!==q?Z={type:"interval-period",period:"second",precision:la,secondary:null}:(G=Z,Z=q)):(G=Z,Z=q)):(G=Z,Z=q)):(G=Z,Z=q),Z===q&&(Z=G,la=Aa(),la!==q&&(la={type:"interval-period",period:"second",precision:null,secondary:null}),Z=la))}Z!==q?U={type:"interval-qualifier",start:W,end:Z}:(G=U,U=q)}else G=U,U=q;else G=U,U=q;U===q&&(U=G,Z=J(),Z!==q?(na(),W=Ma(),W!==q?
(na(),W=u(),W!==q?(na(),la=Na(),la!==q?U={type:"interval-period",period:Z.value,precision:W,secondary:null}:(G=U,U=q)):(G=U,U=q)):(G=U,U=q)):(G=U,U=q),U===q&&(U=G,Z=J(),Z!==q&&(Z={type:"interval-period",period:Z.value,precision:null,secondary:null}),U=Z,U===q&&(U=G,Z=Aa(),Z!==q?(na(),W=Ma(),W!==q?(na(),W=C(),W!==q?(na(),la=Hb(),la!==q?(na(),Z=u(),Z!==q?(na(),la=Na(),la!==q?U={type:"interval-period",period:"second",precision:W,secondary:Z}:(G=U,U=q)):(G=U,U=q)):(G=U,U=q)):(G=U,U=q)):(G=U,U=q)):(G=
U,U=q),U===q&&(U=G,Z=Aa(),Z!==q?(na(),W=Ma(),W!==q?(na(),W=u(),W!==q?(na(),la=Na(),la!==q?U={type:"interval-period",period:"second",precision:W,secondary:null}:(G=U,U=q)):(G=U,U=q)):(G=U,U=q)):(G=U,U=q),U===q&&(U=G,Z=Aa(),Z!==q&&(Z={type:"interval-period",period:"second",precision:null,secondary:null}),U=Z)))));return U}function J(){var U=G;U=qa();U!==q&&(U={type:"string",value:"day"});U===q&&(U=G,U=ra(),U!==q&&(U={type:"string",value:"hour"}),U===q&&(U=G,U=va(),U!==q&&(U={type:"string",value:"minute"}),
U===q&&(U=G,U=ta(),U!==q&&(U={type:"string",value:"month"}),U===q&&(U=G,U=ua(),U!==q&&(U={type:"string",value:"year"})))));return U}function u(){var U=da();U!==q&&(U=parseFloat(U));return U}function C(){var U=da();U!==q&&(U=parseFloat(U));return U}function K(){var U=R();U===q&&(U=F());return U}function R(){var U=G;if(39===t.charCodeAt(G)){var W=id;G++}else W=q,0===ka&&k(jd);W===q&&(t.substr(G,2)===kd?(W=kd,G+=2):(W=q,0===ka&&k(lf)));if(W!==q){W=[];var Z=G;t.substr(G,2)===ec?(Z=ec,G+=2):(Z=q,0===ka&&
k(ld));Z!==q&&(Z="'");Z===q&&(md.test(t.charAt(G))?(Z=t.charAt(G),G++):(Z=q,0===ka&&k(nd)));for(;Z!==q;)W.push(Z),Z=G,t.substr(G,2)===ec?(Z=ec,G+=2):(Z=q,0===ka&&k(ld)),Z!==q&&(Z="'"),Z===q&&(md.test(t.charAt(G))?(Z=t.charAt(G),G++):(Z=q,0===ka&&k(nd)));39===t.charCodeAt(G)?(Z=id,G++):(Z=q,0===ka&&k(jd));Z!==q?U={type:"string",value:W.join("")}:(G=U,U=q)}else G=U,U=q;return U}function V(){var U=G;if(Fb()!==q){na();var W=y();if(W!==q){na();var Z=od();Z!==q?(na(),Z=y(),Z!==q?U={type:"when-clause",operand:W,
value:Z}:(G=U,U=q)):(G=U,U=q)}else G=U,U=q}else G=U,U=q;return U}function X(){var U=G;if(Fb()!==q){na();var W=y();if(W!==q){na();var Z=od();Z!==q?(na(),Z=y(),Z!==q?U={type:"when-clause",operand:W,value:Z}:(G=U,U=q)):(G=U,U=q)}else G=U,U=q}else G=U,U=q;return U}function ba(){var U=G;var W=G;if(t.substr(G,4).toLowerCase()===mf){var Z=t.substr(G,4);G+=4}else Z=q,0===ka&&k(nf);if(Z!==q){Z=G;ka++;var la=H();ka--;la===q?Z=void 0:(G=Z,Z=q);Z!==q?W="ELSE":(G=W,W=q)}else G=W,W=q;W!==q?(na(),W=y(),W!==q?U=
{type:"else-clause",value:W}:(G=U,U=q)):(G=U,U=q);return U}function ea(){var U=da();if(U===q){U=G;if(45===t.charCodeAt(G)){var W=ic;G++}else W=q,0===ka&&k(jc);W===q&&(43===t.charCodeAt(G)?(W=gc,G++):(W=q,0===ka&&k(hc)));if(W!==q){var Z=da();Z!==q?U=W[0]+Z:(G=U,U=q)}else G=U,U=q}return U}function Y(){var U=G;if(46===t.charCodeAt(G)){var W=of;G++}else W=q,0===ka&&k(pf);W!==q?(U=da(),U===q&&(U=null),U="."+(null!=U?U:"")):(G=U,U=q);return U}function ca(){var U;var W=U=G;if(qf.test(t.charAt(G))){var Z=
t.charAt(G);G++}else Z=q,0===ka&&k(rf);Z!==q?(sf.test(t.charAt(G))?(W=t.charAt(G),G++):(W=q,0===ka&&k(tf)),W===q&&(W=null),W="e"+(null===W?"":W)):(G=W,W=q);W!==q?(Z=da(),Z!==q?U=W+Z:(G=U,U=q)):(G=U,U=q);return U}function da(){var U=[];var W=ja();if(W!==q)for(;W!==q;)U.push(W),W=ja();else U=q;U!==q&&(U=U.join(""));return U}function ja(){if(uf.test(t.charAt(G))){var U=t.charAt(G);G++}else U=q,0===ka&&k(vf);return U}function pa(){var U=G;if(t.substr(G,2).toLowerCase()===wf){var W=t.substr(G,2);G+=2}else W=
q,0===ka&&k(xf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="IN":(G=U,U=q)}else G=U,U=q;return U}function sa(){var U=G;if(t.substr(G,2).toLowerCase()===yf){var W=t.substr(G,2);G+=2}else W=q,0===ka&&k(zf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="IS":(G=U,U=q)}else G=U,U=q;return U}function xa(){var U=G;if(t.substr(G,4).toLowerCase()===Af){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(Bf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==
q?U="LIKE":(G=U,U=q)}else G=U,U=q;return U}function ya(){var U=G;if(t.substr(G,3).toLowerCase()===Cf){var W=t.substr(G,3);G+=3}else W=q,0===ka&&k(Df);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="NOT":(G=U,U=q)}else G=U,U=q;return U}function oa(){var U=G;if(t.substr(G,3).toLowerCase()===Ef){var W=t.substr(G,3);G+=3}else W=q,0===ka&&k(Ff);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="AND":(G=U,U=q)}else G=U,U=q;return U}function za(){var U=G;if(t.substr(G,
2).toLowerCase()===Gf){var W=t.substr(G,2);G+=2}else W=q,0===ka&&k(Hf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="OR":(G=U,U=q)}else G=U,U=q;return U}function Ga(){var U=G;if(t.substr(G,7).toLowerCase()===If){var W=t.substr(G,7);G+=7}else W=q,0===ka&&k(Jf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="BETWEEN":(G=U,U=q)}else G=U,U=q;return U}function aa(){var U=G;if(t.substr(G,4).toLowerCase()===Kf){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(Lf);if(W!==
q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="FROM":(G=U,U=q)}else G=U,U=q;return U}function ha(){var U=G;if(t.substr(G,4).toLowerCase()===Mf){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(Nf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="TRIM":(G=U,U=q)}else G=U,U=q;return U}function ia(){var U=G;if(t.substr(G,9).toLowerCase()===Of){var W=t.substr(G,9);G+=9}else W=q,0===ka&&k(Pf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="TIMESTAMP":(G=
U,U=q)}else G=U,U=q;return U}function fa(){var U=G;if(t.substr(G,4).toLowerCase()===Qf){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(Rf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="DATE":(G=U,U=q)}else G=U,U=q;return U}function ma(){var U=G;if(t.substr(G,8).toLowerCase()===Sf){var W=t.substr(G,8);G+=8}else W=q,0===ka&&k(Tf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="INTERVAL":(G=U,U=q)}else G=U,U=q;return U}function ua(){var U=G;if(t.substr(G,4).toLowerCase()===
Uf){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(Vf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="YEAR":(G=U,U=q)}else G=U,U=q;return U}function ta(){var U=G;if(t.substr(G,5).toLowerCase()===Wf){var W=t.substr(G,5);G+=5}else W=q,0===ka&&k(Xf);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="MONTH":(G=U,U=q)}else G=U,U=q;return U}function qa(){var U=G;if(t.substr(G,3).toLowerCase()===Yf){var W=t.substr(G,3);G+=3}else W=q,0===ka&&k(Zf);if(W!==q){W=G;ka++;var Z=
H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="DAY":(G=U,U=q)}else G=U,U=q;return U}function ra(){var U=G;if(t.substr(G,4).toLowerCase()===$f){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(ag);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="HOUR":(G=U,U=q)}else G=U,U=q;return U}function va(){var U=G;if(t.substr(G,6).toLowerCase()===bg){var W=t.substr(G,6);G+=6}else W=q,0===ka&&k(cg);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="MINUTE":(G=U,U=q)}else G=U,U=q;return U}
function Aa(){var U=G;if(t.substr(G,6).toLowerCase()===dg){var W=t.substr(G,6);G+=6}else W=q,0===ka&&k(eg);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="SECOND":(G=U,U=q)}else G=U,U=q;return U}function Ja(){var U=G;if(t.substr(G,4).toLowerCase()===fg){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(gg);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="CASE":(G=U,U=q)}else G=U,U=q;return U}function Da(){var U=G;if(t.substr(G,3).toLowerCase()===hg){var W=t.substr(G,
3);G+=3}else W=q,0===ka&&k(ig);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="END":(G=U,U=q)}else G=U,U=q;return U}function Fb(){var U=G;if(t.substr(G,4).toLowerCase()===jg){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(kg);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:(G=W,W=q);W!==q?U="WHEN":(G=U,U=q)}else G=U,U=q;return U}function od(){var U=G;if(t.substr(G,4).toLowerCase()===lg){var W=t.substr(G,4);G+=4}else W=q,0===ka&&k(mg);if(W!==q){W=G;ka++;var Z=H();ka--;Z===q?W=void 0:
(G=W,W=q);W!==q?U="THEN":(G=U,U=q)}else G=U,U=q;return U}function Hb(){if(44===t.charCodeAt(G)){var U=ng;G++}else U=q,0===ka&&k(og);return U}function Ma(){if(40===t.charCodeAt(G)){var U=pg;G++}else U=q,0===ka&&k(qg);return U}function Na(){if(41===t.charCodeAt(G)){var U=rg;G++}else U=q,0===ka&&k(sg);return U}function na(){var U;var W=[];for(U=pd();U!==q;)W.push(U),U=pd();return W}function pd(){if(tg.test(t.charAt(G))){var U=t.charAt(G);G++}else U=q,0===ka&&k(ug);return U}function zc(U,W,Z,la){U={type:"binary-expression",
operator:U,left:W,right:Z};void 0!==la&&(U.escape=la);return U}function ub(U,W){for(var Z=0;Z<W.length;Z++)U=zc(W[Z][1],U,W[Z][3]);return U}f=void 0!==f?f:{};var q={},tb=f.grammarSource,qd={start:E},rd=E,sd="!",xc="\x3d",Ac="\x3e\x3d",xd="\x3e",Bc="\x3c\x3d",Cc="\x3c\x3e",Bd="\x3c",Dc="!\x3d",gc="+",ic="-",Ec="||",Fd="*",Hd="/",af="@",id="'",kd="N'",ec="''",of=".",Qd="null",Kd="true",Nd="false",wf="in",yf="is",Af="like",ud="escape",Cf="not",Ef="and",Gf="or",If="between",Kf="from",de="for",Zd="substring",
Td="extract",Mf="trim",je="position",Of="timestamp",Qf="date",cf="leading",ef="trailing",gf="both",pe="cast",te="as",xe="integer",Ae="smallint",De="float",Ge="real",Je="varchar",jf="to",Sf="interval",Uf="year",Wf="month",Yf="day",$f="hour",bg="minute",dg="second",fg="case",hg="end",jg="when",lg="then",mf="else",ng=",",pg="(",rg=")",bd="`",Ve=/^[A-Za-z_\x80-\uFFFF]/,Xe=/^[A-Za-z0-9_]/,Ze=/^[A-Za-z0-9_.\x80-\uFFFF]/,md=/^[^']/,uf=/^[0-9]/,qf=/^[eE]/,sf=/^[+\-]/,tg=/^[ \t\n\r]/,dd=/^[^`]/,td=d("!",!1),
yc=d("\x3d",!1),wd=d("\x3e\x3d",!1),yd=d("\x3e",!1),zd=d("\x3c\x3d",!1),Ad=d("\x3c\x3e",!1),Cd=d("\x3c",!1),Dd=d("!\x3d",!1),hc=d("+",!1),jc=d("-",!1),Ed=d("||",!1),Gd=d("*",!1),Id=d("/",!1),We=h([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Ye=h([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),$e=h([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),bf=d("@",!1),jd=d("'",!1),lf=d("N'",!1),ld=d("''",!1),nd=h(["'"],!0,!1),pf=d(".",!1),vf=h([["0","9"]],!1,!1),rf=h(["e","E"],!1,!1),tf=
h(["+","-"],!1,!1),Rd=d("NULL",!0),Ld=d("TRUE",!0),Od=d("FALSE",!0),xf=d("IN",!0),zf=d("IS",!0),Bf=d("LIKE",!0),vd=d("ESCAPE",!0),Df=d("NOT",!0),Ff=d("AND",!0),Hf=d("OR",!0),Jf=d("BETWEEN",!0),Lf=d("FROM",!0),ee=d("FOR",!0),$d=d("SUBSTRING",!0),Ud=d("EXTRACT",!0),Nf=d("TRIM",!0),ke=d("POSITION",!0),Pf=d("TIMESTAMP",!0),Rf=d("DATE",!0),df=d("LEADING",!0),ff=d("TRAILING",!0),hf=d("BOTH",!0),qe=d("CAST",!0),ue=d("AS",!0),ye=d("INTEGER",!0),Be=d("SMALLINT",!0),Ee=d("FLOAT",!0),He=d("REAL",!0),Ke=d("VARCHAR",
!0),kf=d("TO",!0),Tf=d("INTERVAL",!0),Vf=d("YEAR",!0),Xf=d("MONTH",!0),Zf=d("DAY",!0),ag=d("HOUR",!0),cg=d("MINUTE",!0),eg=d("SECOND",!0),gg=d("CASE",!0),ig=d("END",!0),kg=d("WHEN",!0),mg=d("THEN",!0),nf=d("ELSE",!0),og=d(",",!1),qg=d("(",!1),sg=d(")",!1),ug=h([" ","\t","\n","\r"],!1,!1),cd=d("`",!1),ed=h(["`"],!0,!1),G=0,Gb=[{line:1,column:1}],Va=0,fc=[],ka=0;if("startRule"in f){if(!(f.startRule in qd))throw Error("Can't start parsing from rule \""+f.startRule+'".');rd=qd[f.startRule]}var wc=rd();
if(wc!==q&&G===t.length)return wc;wc!==q&&G<t.length&&k({type:"end"});throw function(U,W,Z){return new N(N.buildMessage(U,W),U,W,Z)}(fc,Va<t.length?t.charAt(Va):null,Va<t.length?z(Va,Va+1):z(Va,Va));}}})})({get exports(){return w},set exports(L){w=L}});let x=function(){function L(){}L.parse=function(N){return w.parse(N)};return l._createClass(L)}();e.WhereGrammar=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition",
"../rest/support/generateRendererUtils"],function(e,l,g){function w(b){return null==b||"string"===typeof b&&!b?"\x3cNull\x3e":b}function x(b){const c=null!=b.minValue||null!=b.maxValue,a=!!b.sqlExpression&&b.supportsSQLExpression;return!(null!=b.normalizationField||null!=b.normalizationType)&&!c&&!a}function L(b){const {values:c,useSampleStdDev:a,supportsNullCount:p}=b;var D=Number.POSITIVE_INFINITY;let P=Number.NEGATIVE_INFINITY,m=null,I=null;var H=null;let S=null,F=0;const T=null==b.minValue?-Infinity:
b.minValue,M=null==b.maxValue?Infinity:b.maxValue;for(const J of c)Number.isFinite(J)?J>=T&&J<=M&&(m=null===m?J:m+J,D=Math.min(D,J),P=Math.max(P,J),F++):"string"===typeof J&&F++;if(F&&null!=m){I=m/F;H=0;for(const J of c)Number.isFinite(J)&&J>=T&&J<=M&&(H+=(J-I)**2);S=a?1<F?H/(F-1):0:0<F?H/F:0;H=Math.sqrt(S)}else P=D=null;D={avg:I,count:F,max:P,min:D,stddev:H,sum:m,variance:S};p&&(D.nullcount=c.length-F);b.percentileParams&&(D.median=N(c,b.percentileParams));return D}function N(b,c){const {fieldType:a,
value:p,orderBy:D,isDiscrete:P}=c,m=B(a,"desc"===D);b=[...b].filter(F=>null!=F).sort((F,T)=>m(F,T));if(0===b.length)return null;if(0>=p)return b[0];if(1<=p)return b[b.length-1];var I=(b.length-1)*p,H=Math.floor(I);c=H+1;I%=1;H=b[H];const S=b[c];return c>=b.length||P||"string"===typeof H||"string"===typeof S?H:H*(1-I)+S*I}function B(b,c){const a=c?1:-1,p=d(c),D=f(c);if(!b||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...O].includes(b))return(P,m)=>"number"===
typeof P&&"number"===typeof m?p(P,m):"string"===typeof P&&"string"===typeof m?D(P,m):a;if("esriFieldTypeDate"===b)return(P,m)=>{P=(new Date(P)).getTime();m=(new Date(m)).getTime();return isNaN(P)||isNaN(m)?a:p(P,m)};if(O.has(b))return(P,m)=>p(P,m);if("esriFieldTypeString"===b)return(P,m)=>D(P,m);if("esriFieldTypeGUID"===b||"esriFieldTypeGlobalID"===b){const P=f(c);return(m,I)=>P(h(m),h(I))}return c?(P,m)=>1:(P,m)=>-1}function t(b,c,a){if(a){if(null==b)return null==c?0:1;if(null==c)return-1}else{if(null==
b)return null==c?0:-1;if(null==c)return 1}return null}function f(b){return b?(c,a)=>{const p=t(c,a,!0);if(null!=p)return p;c=c.toUpperCase();a=a.toUpperCase();return c>a?-1:c<a?1:0}:(c,a)=>{const p=t(c,a,!1);if(null!=p)return p;c=c.toUpperCase();a=a.toUpperCase();return c<a?-1:c>a?1:0}}function d(b){return b?(c,a)=>{const p=t(c,a,!0);return null!=p?p:a-c}:(c,a)=>{const p=t(c,a,!1);return null!=p?p:c-a}}function h(b){return b.substr(24,12)+b.substr(19,4)+b.substr(16,2)+b.substr(14,2)+b.substr(11,2)+
b.substr(9,2)+b.substr(6,2)+b.substr(4,2)+b.substr(2,2)+b.substr(0,2)}function n(b){return"coded-value"!==b?.type?[]:b.codedValues.map(c=>c.code)}function z(b,c){const a=E({field:c.field,normalizationType:c.normalizationType,normalizationField:c.normalizationField,classificationMethod:c.classificationMethod,standardDeviationInterval:c.standardDeviationInterval,breakCount:c.numClasses||5});b=k(b,c.minValue,c.maxValue);return g.createGenerateRendererClassBreaks({definition:a,values:b,normalizationTotal:c.normalizationTotal})}
function k(b,c,a){const p=null==c?-Infinity:c,D=null==a?Infinity:a;return b.filter(P=>Number.isFinite(P)&&P>=p&&P<=D)}function E(b){const {breakCount:c,field:a,normalizationField:p,normalizationType:D}=b,P=b.classificationMethod||"equal-interval";return new l({breakCount:c,classificationField:a,classificationMethod:P,normalizationField:"field"===D?p:void 0,normalizationType:D,standardDeviationInterval:"standard-deviation"===P?b.standardDeviationInterval||1:void 0})}function v(b,c){const {field:a,
classificationMethod:p,standardDeviationInterval:D,normalizationType:P,normalizationField:m,normalizationTotal:I,minValue:H,maxValue:S}=c,F=c.numBins||10;let T=c=null,M=null;p&&"equal-interval"!==p||P?({classBreaks:b}=z(b,{field:a,normalizationType:P,normalizationField:m,normalizationTotal:I,classificationMethod:p,standardDeviationInterval:D,minValue:H,maxValue:S,numClasses:F}),c=b[0].minValue,T=b[b.length-1].maxValue,M=b.map(J=>[J.minValue,J.maxValue])):(null!=H&&null!=S?(c=H,T=S):(b=L({values:b,
minValue:H,maxValue:S,useSampleStdDev:!P,supportsNullCount:x({normalizationType:P,normalizationField:m,minValue:H,maxValue:S})}),c=b.min??null,T=b.max??null),M=r(c??0,T??0,F));return{min:c,max:T,intervals:M}}function y(b,c){let a=-1;for(let p=b.length-1;0<=p;p--)if(c>=b[p][0]){a=p;break}return a}function r(b,c,a){const p=(c-b)/a,D=[];let P;for(let m=1;m<=a;m++)P=b+p,P=Number(P.toFixed(16)),D.push([b,m===a?c:P]),b=P;return D}const Q=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,O=new Set(["esriFieldTypeInteger",
"esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),A="min max avg stddev count sum variance nullcount median".split(" ");e.calculateClassBreaks=z;e.calculateHistogram=function(b,c){var a=v(b,c);const p=a.intervals,D=a.min??0;a=a.max??0;const P=p.map((m,I)=>({minValue:p[I][0],maxValue:p[I][1],count:0}));for(const m of b)null!=m&&m>=D&&m<=a&&(b=y(p,m),-1<b&&P[b].count++);return{bins:P,minValue:D,maxValue:a,normalizationTotal:c.normalizationTotal}};e.calculatePercentile=N;e.calculateStatistics=
L;e.calculateStringStatistics=function(b){const c=b.returnDistinct?[...(new Set(b.values))]:b.values,a=c.filter(D=>null!=D).length,p={count:a};b.supportsNullCount&&(p.nullcount=c.length-a);b.percentileParams&&(p.median=N(c,b.percentileParams));return p};e.calculateUniqueValuesCount=function(b){const c={};for(let a of b){if(null==a||"string"===typeof a&&""===a.trim())a=null;null==c[a]?c[a]={count:1,data:a}:c[a].count++}return{count:c}};e.createClassBreaksDefinition=E;e.createUVResult=function(b,c,
a,p){b=b.count;const D=[];if(a&&c){a=[];var P=n(c[0]);for(const m of P)if(c[1]){P=n(c[1]);for(const I of P)if(c[2]){P=n(c[2]);for(const H of P)a.push(`${w(m)}${p}${w(I)}${p}${w(H)}`)}else a.push(`${w(m)}${p}${w(I)}`)}else a.push(m);for(const m of a)b.hasOwnProperty(m)||(b[m]={data:m,count:0})}for(const m in b)c=b[m],D.push({value:c.data,count:c.count,label:c.label});return{uniqueValueInfos:D}};e.getAttributeComparator=B;e.getEqualIntervalBins=r;e.getNormalizedValue=function(b,c,a,p){let D=null;switch(c){case "log":0!==
b&&(D=Math.log(b)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(p)&&0!==p&&(D=b/p*100);break;case "field":Number.isFinite(a)&&0!==a&&(D=b/a);break;case "natural-log":0<b&&(D=Math.log(b));break;case "square-root":0<b&&(D=b**.5)}return D};e.isNullCountSupported=x;e.processNullValue=w;e.processSummaryStatisticsResult=function(b,c){let a;for(a in b)A.includes(a)&&(Number.isFinite(b[a])||(b[a]=null));if(!c)return b;["avg","stddev","variance"].forEach(p=>{null!=b[p]&&(b[p]=Math.ceil(b[p]))});
return b};e.resolveCBResult=function(b,c){let a=b.classBreaks;const p=a[0].minValue,D=a[a.length-1].maxValue,P="standard-deviation"===c;a=a.map(m=>{const I=m.label;m={minValue:m.minValue,maxValue:m.maxValue,label:I};if(P&&I){const H=I.match(Q)?.map(S=>+S.trim())??[];2===H.length?(m.minStdDev=H[0],m.maxStdDev=H[1],0>H[0]&&0<H[1]&&(m.hasAvg=!0)):1===H.length&&(I.includes("\x3c")?(m.minStdDev=null,m.maxStdDev=H[0]):I.includes("\x3e")&&(m.minStdDev=H[0],m.maxStdDev=null))}return m});return{minValue:p,
maxValue:D,classBreakInfos:a,normalizationTotal:b.normalizationTotal}};e.statisticTypes=A;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B,t,f){L=new g.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});g=new g.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});w=function(d){function h(z){z=n.call(this,z);z.type="class-breaks-definition";z.breakCount=
null;z.classificationField=null;z.classificationMethod=null;z.normalizationField=null;z.normalizationType=null;return z}e._inherits(h,d);var n=e._createSuper(h);e._createClass(h,[{key:"standardDeviationInterval",set:function(z){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",z)}},{key:"definedInterval",set:function(z){"defined-interval"===this.classificationMethod&&this._set("definedInterval",z)}}]);return h}(w.JSONSupport);l.__decorate([t.enumeration({classBreaksDef:"class-breaks-definition"})],
w.prototype,"type",void 0);l.__decorate([x.property({json:{write:!0}})],w.prototype,"breakCount",void 0);l.__decorate([x.property({json:{write:!0}})],w.prototype,"classificationField",void 0);l.__decorate([x.property({type:String,json:{read:L.read,write:L.write}})],w.prototype,"classificationMethod",void 0);l.__decorate([x.property({json:{write:!0}})],w.prototype,"normalizationField",void 0);l.__decorate([x.property({json:{read:g.read,write:g.write}})],w.prototype,"normalizationType",void 0);l.__decorate([x.property({value:null,
json:{write:!0}})],w.prototype,"standardDeviationInterval",null);l.__decorate([x.property({value:null,json:{write:!0}})],w.prototype,"definedInterval",null);return w=l.__decorate([f.subclass("esri.rest.support.ClassBreaksDefinition")],w)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(e,l){function g(n){var z=n.definition;const {classificationMethod:k,normalizationType:E,definedInterval:v}=z;z=z.breakCount??1;const y=[];var r=n.values;if(0===
r.length)return[];r=r.sort((a,p)=>a-p);var Q=r[0],O=r[r.length-1];if("equal-interval"===k)if(r.length>=z){r=(O-Q)/z;n=Q;for(var A=1;A<z;A++){var b=Number((Q+A*r).toFixed(6));y.push({minValue:n,maxValue:b,label:w(n,b,E)});n=b}y.push({minValue:n,maxValue:O,label:w(n,O,E)})}else r.forEach(a=>{y.push({minValue:a,maxValue:a,label:w(a,a,E)})});else if("natural-breaks"===k){r=x(r);n=L(r.uniqueValues,n.valueFrequency||r.valueFrequency,z);for(A=1;A<z;A++)r.uniqueValues.length>A&&(b=Number(r.uniqueValues[n[A]].toFixed(6)),
y.push({minValue:Q,maxValue:b,label:w(Q,b,E)}),Q=b);y.push({minValue:Q,maxValue:O,label:w(Q,O,E)})}else if("quantile"===k)if(r.length>=z&&Q!==O){n=Math.ceil(r.length/z);A=0;for(b=1;b<z;b++){var c=n+A-1;c>r.length&&(c=r.length-1);0>c&&(c=0);y.push({minValue:Q,maxValue:r[c],label:w(Q,r[c],E)});Q=r[c];A+=n;n=Math.ceil((r.length-A)/(z-b))}y.push({minValue:Q,maxValue:O,label:w(Q,O,E)})}else for(z=-1,O=0;O<r.length;O++)Q=r[O],Q!==z&&(z=Q,y.push({minValue:z,maxValue:Q,label:w(z,Q,E)}),z=Q);else if("standard-deviation"===
k)if(n=t(r),A=f(r,n),0===A)y.push({minValue:r[0],maxValue:r[0],label:w(r[0],r[0],E)});else{r=B(Q,O,z,n,A)*A;A=0;for(b=z;1<=b;b--)c=Number((n-(b-.5)*r).toFixed(6)),y.push({minValue:Q,maxValue:c,label:w(Q,c,E)}),Q=c,A++;b=Number((n+.5*r).toFixed(6));y.push({minValue:Q,maxValue:b,label:w(Q,b,E)});Q=b;A++;for(c=1;c<=z;c++)b=A===2*z?O:Number((n+(c+.5)*r).toFixed(6)),y.push({minValue:Q,maxValue:b,label:w(Q,b,E)}),Q=b,A++}else if("defined-interval"===k){if(!v)return y;z=r[0];O=r[r.length-1];r=Math.ceil((O-
z)/v);Q=z;for(n=1;n<r;n++)A=Number((z+n*v).toFixed(6)),y.push({minValue:Q,maxValue:A,label:w(Q,A,E)}),Q=A;y.push({minValue:Q,maxValue:O,label:w(Q,O,E)})}return y}function w(n,z,k){let E=null;return E=n===z?k&&"percent-of-total"===k?n+"%":n.toString():k&&"percent-of-total"===k?n+"% - "+z+"%":n+" - "+z}function x(n){const z=[],k=[];let E=Number.MIN_VALUE,v=1,y=-1;for(let r=0;r<n.length;r++){const Q=n[r];Q===E?(v++,k[y]=v):null!==Q&&(z.push(Q),E=Q,v=1,k.push(v),y++)}return{uniqueValues:z,valueFrequency:k}}
function L(n,z,k){var E=n.length;const v=[];k>E&&(k=E);for(var y=0;y<k;y++)v.push(Math.round(y*E/k-1));v.push(E-1);y=N(v,n,z,k);E=y.mean;y=y.sdcm;var r=k,Q=0,O=0;let A=0,b=0,c=!0;for(let p=0;2>p&&c;p++){0===p&&(c=!1);for(var a=0;a<r-1;a++)for(;v[a+1]+1!==v[a+2];)if(v[a+1]+=1,Q=d(a,v,n,z),A=Q.sbMean,Q=Q.sbSdcm,O=d(a+1,v,n,z),b=O.sbMean,O=O.sbSdcm,Q+O<y[a]+y[a+1])y[a]=Q,y[a+1]=O,E[a]=A,E[a+1]=b,c=!0;else{--v[a+1];break}for(a=r-1;0<a;a--)for(;v[a]!==v[a-1]+1;)if(--v[a],Q=d(a-1,v,n,z),A=Q.sbMean,Q=Q.sbSdcm,
O=d(a,v,n,z),b=O.sbMean,O=O.sbSdcm,Q+O<y[a-1]+y[a])y[a-1]=Q,y[a]=O,E[a-1]=A,E[a]=b,c=!0;else{v[a]+=1;break}}c&&(y=N(v,n,z,k));return v}function N(n,z,k,E){let v=[];var y=[],r=[];let Q=0;const O=[],A=[];for(var b=0;b<E;b++){var c=d(b,n,z,k);O.push(c.sbMean);A.push(c.sbSdcm);Q+=A[b]}c=Q;for(b=!0;b||Q<c;){b=!1;v=[];for(y=0;y<E;y++)v.push(n[y]);for(r=0;r<E;r++)for(c=n[r]+1;c<=n[r+1];c++)if(y=z[c],0<r&&c!==n[r+1]&&Math.abs(y-O[r])>Math.abs(y-O[r-1]))n[r]=c;else if(r<E-1&&n[r]!==c-1&&Math.abs(y-O[r])>Math.abs(y-
O[r+1])){n[r+1]=c-1;break}c=Q;Q=0;y=[];r=[];for(let a=0;a<E;a++){y.push(O[a]);r.push(A[a]);const p=d(a,n,z,k);O[a]=p.sbMean;A[a]=p.sbSdcm;Q+=A[a]}}if(Q>c){for(z=0;z<E;z++)n[z]=v[z],O[z]=y[z],A[z]=r[z];Q=c}return{mean:O,sdcm:A}}function B(n,z,k,E,v){n=Math.max(E-n,z-E)/v/k;return 1<=n?1:.5<=n?.5:.25}function t(n){let z=0;for(let k=0;k<n.length;k++)z+=n[k];return z/=n.length}function f(n,z){let k=0;for(let E=0;E<n.length;E++){const v=n[E];k+=(v-z)*(v-z)}k/=n.length;return Math.sqrt(k)}function d(n,
z,k,E){var v=0,y=0;for(var r=z[n]+1;r<=z[n+1];r++){const Q=E[r];v+=k[r]*Q;y+=Q}0>=y&&h.warn("Exception in Natural Breaks calculation");v/=y;y=0;for(r=z[n]+1;r<=z[n+1];r++)y+=E[r]*(k[r]-v)**2;return{sbMean:v,sbSdcm:y}}const h=l.getLogger("esri.rest.support.generateRendererUtils");e.createGenerateRendererClassBreaks=function(n){const {normalizationTotal:z}=n;return{classBreaks:g(n),normalizationTotal:z}};e.createGenerateRendererUniqueValues=function(n){n=x(n);const z=[],k=n.uniqueValues.length;for(let E=
0;E<k;E++){const v=n.uniqueValues[E];z.push({value:v,count:n.valueFrequency[E],label:v.toString()})}return{uniqueValues:z}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(e,
l,g,w,x,L,N){function B(k,E){if(!E)return null;if("x"in E){var v={x:0,y:0};[v.x,v.y]=k(E.x,E.y,d);null!=E.z&&(v.z=E.z);null!=E.m&&(v.m=E.m);return v}return"xmin"in E?(v={xmin:0,ymin:0,xmax:0,ymax:0},[v.xmin,v.ymin]=k(E.xmin,E.ymin,d),[v.xmax,v.ymax]=k(E.xmax,E.ymax,d),E.hasZ&&(v.zmin=E.zmin,v.zmax=E.zmax,v.hasZ=!0),E.hasM&&(v.mmin=E.mmin,v.mmax=E.mmax,v.hasM=!0),v):"rings"in E?{rings:t(E.rings,k),hasM:E.hasM,hasZ:E.hasZ}:"paths"in E?{paths:t(E.paths,k),hasM:E.hasM,hasZ:E.hasZ}:"points"in E?{points:f(E.points,
k),hasM:E.hasM,hasZ:E.hasZ}:null}function t(k,E){const v=[];for(const y of k)v.push(f(y,E));return v}function f(k,E){const v=[];for(const y of k)k=E(y[0],y[1],[0,0]),v.push(k),2<y.length&&k.push(y[2]),3<y.length&&k.push(y[3]);return v}const d=[0,0],h=B.bind(null,N.lngLatToXY),n=B.bind(null,N.xyToLngLat),z=new (function(){function k(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var E=k.prototype;E.push=async function(v,y,r){if(!(v&&v.length&&y&&r)||L.equals(y,r))return v;
const Q={geometries:v,inSpatialReference:y,outSpatialReference:r,resolve:null};this._jobs.push(Q);return new Promise(O=>{Q.resolve=O;null===this._timer&&(this._timer=setTimeout(this._process,10))})};E._process=function(){this._timer=null;const v=this._jobs.shift();if(v){var {geometries:y,inSpatialReference:r,outSpatialReference:Q,resolve:O}=v;N.canProject(r,Q)?L.isWebMercator(Q)?O(y.map(h)):O(y.map(n)):O(w.projectMany(x.jsonAdapter,y,r,Q,null,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}};return l._createClass(k)}());e.checkProjectionSupport=async function(k,E){k&&E&&(k=Array.isArray(k)?k.map(v=>g.isSome(v.geometry)?v.geometry.spatialReference:null).filter(g.isSome):[k],await w.initializeProjection(k.map(v=>({source:v,dest:E}))))};e.project=function(k,E,v,y){if(!k)return k;v||(v=E,E=k.spatialReference);return L.isValid(E)&&L.isValid(v)&&!L.equals(E,v)?N.canProject(E,v)?(k=L.isWebMercator(v)?h(k):n(k),k.spatialReference=v,k):w.projectMany(x.jsonAdapter,[k],E,v,null,y)[0]:k};
e.projectMany=function(k,E,v){return z.push(k,E,v)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(e,l){let g=l._createClass(function(B,t,f){this.x=B;this.y=t;this.spatialReference=f;this.m=this.z=void 0}),w=l._createClass(function(B,t,f,d){this.rings=B;this.spatialReference=t;this.hasM=this.hasZ=void 0;f&&(this.hasZ=f);d&&(this.hasM=d)}),x=l._createClass(function(B,
t,f,d){this.paths=B;this.spatialReference=t;this.hasM=this.hasZ=void 0;f&&(this.hasZ=f);d&&(this.hasM=d)}),L=l._createClass(function(B,t,f,d){this.points=B;this.spatialReference=t;this.hasM=this.hasZ=void 0;f&&(this.hasZ=f);d&&(this.hasM=d)}),N=l._createClass(function(B,t,f,d,h){this.xmin=B;this.ymin=t;this.xmax=f;this.ymax=d;this.spatialReference=h;this.mmax=this.mmin=this.zmax=this.zmin=void 0});e.jsonAdapter={convertToGEGeometry:function(B,t){return null==t?null:B.convertJSONToGeometry(t)},exportPoint:function(B,
t,f){f=new g(B.getPointX(t),B.getPointY(t),f);const d=B.hasZ(t),h=B.hasM(t);d&&(f.z=B.getPointZ(t));h&&(f.m=B.getPointM(t));return f},exportPolygon:function(B,t,f){return new w(B.exportPaths(t),f,B.hasZ(t),B.hasM(t))},exportPolyline:function(B,t,f){return new x(B.exportPaths(t),f,B.hasZ(t),B.hasM(t))},exportMultipoint:function(B,t,f){return new L(B.exportPoints(t),f,B.hasZ(t),B.hasM(t))},exportExtent:function(B,t,f){var d=B.hasZ(t);const h=B.hasM(t);f=new N(B.getXMin(t),B.getYMin(t),B.getXMax(t),
B.getYMax(t),f);d&&(d=B.getZExtent(t),f.zmin=d.vmin,f.zmax=d.vmax);h&&(B=B.getMExtent(t),f.mmin=B.vmin,f.mmax=B.vmax);return f}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(e){e.makeEdgeCandidate=function(l,g,w,x,L,N=!1){return{objectId:l,target:g,distance:w,type:"edge",start:x,end:L,draped:N}};e.makeVertexCandidate=function(l,g,w){return{objectId:l,target:g,distance:w,type:"vertex"}};Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/jsonMap ../../../core/maybe ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../OptimizedGeometry ./projectionSupport".split(" "),function(e,l,g,w,x,L,N,B,t,f,d,h,n){async function z(a,
p,D){if(!a)return null;var {where:P}=a;a.where=P=P&&P.trim();if(!P||/^1 *= *1$/.test(P)||p&&p===P)a.where=null;if(!a.geometry)return a;p=await E(a);a.distance=0;a.units=null;"esriSpatialRelEnvelopeIntersects"===a.spatialRel&&({spatialReference:P}=a.geometry,p=N.getGeometryExtent(p),p.spatialReference=P);if(p){await n.checkProjectionSupport(p.spatialReference,D);P=p.spatialReference;p=k(p,D)&&B.isExtent(p)?{spatialReference:P,rings:[[[p.xmin,p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],
[p.xmin,p.ymin]]]}:p;P=(await t.normalizeCentralMeridian(B.fromJSON(p)))[0];if(w.isNone(P))throw r;const m="quantizationParameters"in a&&a.quantizationParameters?.tolerance||"maxAllowableOffset"in a&&a.maxAllowableOffset||0;p=m&&k(p,D)?{densificationStep:8*m}:void 0;P=P.toJSON();p=await n.project(P,P.spatialReference,D,p);if(!p)throw r;p.spatialReference=D;a.geometry=p}return a}function k(a,p){if(!a)return!1;const D=a.spatialReference;return(B.isExtent(a)||B.isPolygon(a)||B.isPolyline(a))&&!f.equals(D,
p)&&!L.canProjectWithoutEngine(D,p)}async function E(a){const {distance:p,units:D}=a,P=a.geometry;if(null==p||"vertexAttributes"in P)return P;var m=P.spatialReference;a=D?y.fromJSON(D):x.getUnitString(m);m=m&&(f.isGeographic(m)||f.isWebMercator(m))?P:await n.checkProjectionSupport(m,f.WGS84).then(()=>n.project(P,f.WGS84));return(await v())(m.spatialReference,m,p,a)}async function v(){return(await new Promise((a,p)=>e(["../../../geometry/geometryEngineJSON"],a,p))).geodesicBuffer}const y=new g.JSONMap({esriSRUnit_Meter:"meters",
esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),r=Object.freeze({}),Q=new h,O=new h,A=new h,b={esriGeometryPoint:d.convertToPoint,esriGeometryPolyline:d.convertToPolyline,esriGeometryPolygon:d.convertToPolygon,esriGeometryMultipoint:d.convertToMultipoint},c=(a,p)=>"_geVersion"!==a?p:void 0;l.QUERY_ENGINE_EMPTY_RESULT=r;l.cleanFromGeometryEngine=function(a){return a&&"_geVersion"in
a?JSON.parse(JSON.stringify(a,c)):a};l.getGeometry=function(a,p,D,P,m,I,H=p,S=D){const F=p&&H,T=D&&S;P=w.isSome(P)?"coords"in P?P:P.geometry:null;if(w.isNone(P))return null;if(m)return p=d.generalizeOptimizedGeometry(O,P,p,D,a,m,H,S),I&&(p=d.quantizeOptimizedGeometry(A,p,F,T,a,I)),b[a]?.(p,F,T)??null;if(I)return I=d.quantizeOptimizedGeometry(A,P,p,D,a,I,H,S),b[a]?.(I,F,T)??null;d.removeZMValues(Q,P,p,D,H,S);return b[a]?.(Q,F,T)??null};l.normalizeQuery=async function(a,p,D){const {outFields:P,orderByFields:m,
groupByFieldsForStatistics:I,outStatistics:H}=a;if(P)for(var S=0;S<P.length;S++)P[S]=P[S].trim();if(m)for(S=0;S<m.length;S++)m[S]=m[S].trim();if(I)for(S=0;S<I.length;S++)I[S]=I[S].trim();if(H)for(S=0;S<H.length;S++)H[S].onStatisticField&&(H[S].onStatisticField=H[S].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return z(a,p,D)};l.normalizeQueryLike=z;l.transformCentroid=function(a,p,D,P=a.hasZ,m=a.hasM){if(w.isNone(p))return null;const I=a.hasZ&&P,H=a.hasM&&m;
return D?(a=d.quantizeOptimizedGeometry(A,p,a.hasZ,a.hasM,"esriGeometryPoint",D,P,m),d.convertToPoint(a,I,H)):d.convertToPoint(p,I,H)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingConstraint":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ./SnappingPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f){function d(S,F){let T=[];if(z(S)){var {point:M}=S;k(F)?T=t.intersectLineAndPoint(F.lineLike,M):E(F)?T=t.intersectVerticalCylinderAndPoint(F.center,F.radius,M):v(F)?T=t.intersectVerticalPlaneAndPoint(F.planeLike,M):y(F)&&(T=h(F,S))}else if(k(S))({lineLike:M}=S),z(F)?T=t.intersectLineAndPoint(M,F.point):k(F)?T=t.intersectLineLike(M,F.lineLike):E(F)?T=t.intersectLineLikeAndVerticalCylinder(M,F.center,F.radius):v(F)?T=t.intersectVerticalPlaneAndLineLike(F.planeLike,M):y(F)&&
(T=h(F,S));else if(E(S)){const {center:J,radius:u}=S;if(k(F))T=t.intersectLineLikeAndVerticalCylinder(F.lineLike,J,u);else if(z(F))T=t.intersectVerticalCylinderAndPoint(J,u,F.point);else{if(v(F))return t.intersectVerticalPlaneAndVerticalCylinder(F.planeLike,J,u).map(C=>new c(C,S,F));y(F)&&(T=h(F,S))}}else if(v(S)){({planeLike:M}=S);if(v(F))return t.intersectVerticalPlane(M,F.planeLike).map(J=>new c(J,S,F));if(z(F))T=t.intersectVerticalPlaneAndPoint(M,F.point);else if(k(F))T=t.intersectVerticalPlaneAndLineLike(M,
F.lineLike);else{if(E(F))return t.intersectVerticalPlaneAndVerticalCylinder(M,F.center,F.radius).map(J=>new c(J,S,F));y(F)&&(T=h(F,S))}}else y(S)&&(T=h(S,F));return n(T,S,F)}function h(S,F){const {planeLike:T,getZ:M}=S,J=[];if(z(F))S.addIfOnTheGround(J,t.intersectVerticalPlaneAndPoint(T,F.point));else if(k(F))S.addIfOnTheGround(J,t.intersectVerticalPlaneAndLineLike(T,F.lineLike));else if(E(F))for(const [u,C]of t.intersectVerticalPlaneAndVerticalCylinder(T,F.center,F.radius))S=M(u,C,0),g.isSome(S)&&
J.push(N.fromValues(u,C,S));else if(v(F)||y(F))for(const [u,C]of t.intersectVerticalPlane(T,F.planeLike))S=g.toNullable(M(u,C,0))??0,J.push(N.fromValues(u,C,S));return J}function n(S,F,T){return S.map(M=>new b(B.asSnappingPoint(M),F,T))}function z(S){return S instanceof Q}function k(S){return S instanceof O}function E(S){return S instanceof a}function v(S){return S instanceof p}function y(S){return S instanceof m}let r=function(){function S(){}S.prototype.intersect=function(F){return d(this,F)};return l._createClass(S)}(),
Q=function(S){function F(M){var J=T.call(this);J.point=M;return J}l._inherits(F,S);var T=l._createSuper(F);S=F.prototype;S.equals=function(M){return z(M)&&L.exactEquals(this.point,M.point)};S.closestTo=function(){return B.cloneSnappingPoint(this.point)};return l._createClass(F)}(r),O=function(S){function F(M,J,u){var C=T.call(this);C.start=M;C.end=J;C.type=u;C.lineLike={start:C.start,end:C.end,type:C.type};return C}l._inherits(F,S);var T=l._createSuper(F);S=F.prototype;S.equals=function(M){return k(M)&&
this.type===M.type&&L.exactEquals(this.start,M.start)&&L.exactEquals(this.end,M.end)};S.closestTo=function(M){M=t.projectPointToLineLike(M,this.lineLike);return B.asSnappingPoint(M)};return l._createClass(F)}(r),A=function(S){function F(M,J){return T.call(this,M,J,f.LineType.LINE)}l._inherits(F,S);var T=l._createSuper(F);return l._createClass(F)}(O),b=function(S){function F(M,J,u){var C=T.call(this);C.intersection=M;C.first=J;C.second=u;return C}l._inherits(F,S);var T=l._createSuper(F);S=F.prototype;
S.equals=function(M){return M instanceof F&&this.first.equals(M.first)&&this.second.equals(M.second)};S.closestTo=function(){return B.cloneSnappingPoint(this.intersection)};return l._createClass(F)}(r),c=function(S){function F(M,J,u){var C=T.call(this);C.basePoint=M;C.first=J;C.second=u;return C}l._inherits(F,S);var T=l._createSuper(F);S=F.prototype;S.equals=function(M){return M instanceof F&&this.first.equals(M.first)&&this.second.equals(M.second)};S.closestTo=function(M){const J=this.basePoint;
return B.asSnappingPoint(N.fromValues(J[0],J[1],M[2]))};return l._createClass(F)}(r),a=function(S){function F(M,J){var u=T.call(this);u.center=M;u.radius=J;return u}l._inherits(F,S);var T=l._createSuper(F);S=F.prototype;S.equals=function(M){return E(M)&&this.center[0]===M.center[0]&&this.center[1]===M.center[1]&&this.radius===M.radius};S.closestTo=function(M){M=t.projectPointToVerticalCylinder(M,this.center,this.radius);return B.asSnappingPoint(M)};return l._createClass(F)}(r),p=function(S){function F(M,
J,u){var C=T.call(this);C.start=M;C.end=J;C.type=u;C.planeLike={start:M,end:J,type:u};return C}l._inherits(F,S);var T=l._createSuper(F);S=F.prototype;S.equals=function(M){return v(M)&&this.type===M.type&&L.exactEquals(this.start,M.start)&&L.exactEquals(this.end,M.end)};S.closestTo=function(M){return B.asSnappingPoint(t.projectPointToVerticalPlane(M,this.planeLike))};S.closestEndTo=function(M){const {start:J,end:u}=this;return 0<Math.sign(w.dot(w.subtract(I,u,J),w.subtract(H,M,J)))?u:J};return l._createClass(F)}(r),
D=function(S){function F(M,J){return T.call(this,M,J,t.VerticalPlaneType.HALF_PLANE)}l._inherits(F,S);var T=l._createSuper(F);return l._createClass(F)}(p),P=function(S){function F(M,J){return T.call(this,M,J,t.VerticalPlaneType.PLANE)}l._inherits(F,S);var T=l._createSuper(F);return l._createClass(F)}(p),m=function(S){function F(M,J,u){var C=T.call(this);C.start=M;C.end=J;C.getZ=u;C.planeLike={start:M,end:J,type:t.VerticalPlaneType.PLANE};return C}l._inherits(F,S);var T=l._createSuper(F);S=F.prototype;
S.equals=function(M){return y(M)&&L.exactEquals(this.start,M.start)&&L.exactEquals(this.end,M.end)&&this.getZ===M.getZ};S.closestTo=function(M){const J=t.projectPointToVerticalPlane(M,this.planeLike);J[2]=g.toNullable(this.getZ(M[0],M[1],M[2]))??0;return B.asSnappingPoint(J)};S.addIfOnTheGround=function(M,J){for(const u of J)J=g.unwrapOr(this.getZ(u[0],u[1],u[2]),0),Math.abs(u[2]-J)<t.epsilon&&(u[2]=J,M.push(u))};return l._createClass(F)}(r);const I=x.create(),H=x.create();e.DrapedLineConstraint=
m;e.IntersectionConstraint=b;e.LineConstraint=A;e.LineLikeConstraint=O;e.PointConstraint=Q;e.SnappingConstraint=r;e.VerticalCylinderConstraint=a;e.VerticalHalfPlaneConstraint=D;e.VerticalLineIntersectionConstraint=c;e.VerticalPlaneConstraint=P;e.VerticalPlaneLikeConstraint=p;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingPoint":function(){define(["exports","../../../core/maybe","../../../chunks/vec3f64","../../../layers/graphics/dehydratedFeatures",
"../../../support/elevationInfoUtils"],function(e,l,g,w,x){function L(B,t,f){if(l.isNone(B))return null;if(l.isNone(t))return g.fromValues(B.x,B.y,B.z??0);if("2d"===t.type)return g.fromValues(B.x,B.y,0);({elevationInfo:f}=f);t=x.getConvertedElevation(t,B,f,x.absoluteHeightElevationInfo)??0;return g.fromValues(B.x,B.y,t)}const N=w.makeDehydratedPoint(0,0,0,null);e.anyMapPointToSnappingPoint=function(B,t,f){return l.isNone(B)?null:L(f.coordinateHelper.vectorToDehydratedPoint(B,N),t,f)};e.asSnappingPoint=
function(B){return B};e.cloneSnappingPoint=function(B){return g.clone(B)};e.createSnappingPoint=function(B,t,f){return g.fromValues(B,t,f)};e.pointToSnappingPoint=L;e.snappingPointToDehydratedPoint=function(B,t){return w.makeDehydratedPoint(B[0],B[1],B[2],t)};e.snappingPointToSnappingOutput=function(B,t,{z:f,m:d,spatialReference:h,elevationInfo:n}){if(null==f&&null==d)return B=w.makeDehydratedPoint(B[0],B[1],void 0,h),null!=d&&(B.m=d,B.hasM=!0),B;if(l.isNone(t)||"2d"===t.type)return B=w.makeDehydratedPoint(B[0],
B[1],f,h),null!=d&&(B.m=d,B.hasM=!0),B;t=x.getConvertedElevationFromVector(t,B,h,x.absoluteHeightElevationInfo,n)??0;B=w.makeDehydratedPoint(B[0],B[1],t,h);null!=d&&(B.m=d,B.hasM=!0);return B};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatures":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/byteSizeEstimations ../../core/has ../../core/maybe ../../core/typedArrayUtil ../../core/uid ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/quantizationUtils ../../geometry/support/typeUtils ../support/Field ./dehydratedFeatureComparison".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z){function k(v,y,r){if(x.isNone(v))return null;switch(y){case "point":return{x:v.x,y:v.y,z:v.z,m:v.m,hasZ:null!=v.z,hasM:null!=v.m,type:"point",spatialReference:r};case "polyline":return{paths:v.paths,hasZ:!!v.hasZ,hasM:!!v.hasM,type:"polyline",spatialReference:r};case "polygon":return{rings:v.rings,hasZ:!!v.hasZ,hasM:!!v.hasM,type:"polygon",spatialReference:r};case "multipoint":return{points:v.points,hasZ:!!v.hasZ,hasM:!!v.hasM,type:"multipoint",spatialReference:r}}}
function E(v){if(x.isNone(v))return 0;let y=32;switch(v.type){case "point":y+=42;break;case "polyline":case "polygon":var r=0;const Q=2+(v.hasZ?1:0)+(v.hasM?1:0);v="polyline"===v.type?v.paths:v.rings;for(const O of v)r+=O.length;y+=8*r*Q+64;y+=128*r;y=y+34+32*(v.length+1);break;case "multipoint":r=v.points.length;y+=8*r*(2+(v.hasZ?1:0)+(v.hasM?1:0))+64;y+=128*r;y=y+34+32;break;case "extent":y+=98;v.hasM&&(y+=32);v.hasZ&&(y+=32);break;case "mesh":y+=L.estimateSize(v.vertexAttributes.position),y+=L.estimateSize(v.vertexAttributes.normal),
y+=L.estimateSize(v.vertexAttributes.uv),y+=L.estimateSize(v.vertexAttributes.tangent)}return y}w=l._createClass(function(v,y,r){this.uid=v;this.geometry=y;this.attributes=r;this.visible=!0;this.centroid=this.objectId=null});l=l._createClass(function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null});e.equals=
z.equals;e.DehydratedFeatureClass=w;e.DehydratedFeatureSetClass=l;e.computeAABB=function(v,y){t.empty(y);"mesh"===v.type&&(v=v.extent);switch(v.type){case "point":y[0]=y[3]=v.x;y[1]=y[4]=v.y;v.hasZ&&(y[2]=y[5]=v.z);break;case "polyline":for(var r=0;r<v.paths.length;r++)t.expandWithNestedArray(y,v.paths[r],!!v.hasZ);break;case "polygon":for(r=0;r<v.rings.length;r++)t.expandWithNestedArray(y,v.rings[r],!!v.hasZ);break;case "multipoint":t.expandWithNestedArray(y,v.points,!!v.hasZ);break;case "extent":y[0]=
v.xmin,y[1]=v.ymin,y[3]=v.xmax,y[4]=v.ymax,null!=v.zmin&&(y[2]=v.zmin),null!=v.zmax&&(y[5]=v.zmax)}};e.computeAABR=function(v,y){f.empty(y);"mesh"===v.type&&(v=v.extent);switch(v.type){case "point":y[0]=y[2]=v.x;y[1]=y[3]=v.y;break;case "polyline":for(var r=0;r<v.paths.length;r++)f.expandWithNestedArray(y,v.paths[r]);break;case "polygon":for(r=0;r<v.rings.length;r++)f.expandWithNestedArray(y,v.rings[r]);break;case "multipoint":f.expandWithNestedArray(y,v.points);break;case "extent":y[0]=v.xmin,y[1]=
v.ymin,y[2]=v.xmax,y[3]=v.ymax}};e.estimateGeometryObjectSize=E;e.estimateSize=function(v){let y;y=32+g.estimateAttributesObjectSize(v.attributes);return y=y+3+(8+E(v.geometry))};e.fromFeatureSetJSON=function(v){const y=h.featureGeometryTypeKebabDictionary.fromJSON(v.geometryType),r=B.fromJSON(v.spatialReference),Q=v.transform,O=v.features.map(A=>{var b=v.objectIdFieldName;A={uid:N.generateUID(),objectId:b&&A.attributes?A.attributes[b]:null,attributes:A.attributes,geometry:k(A.geometry,y,r),visible:!0};
b=A.geometry;if(x.isSome(b)&&Q)switch(b.type){case "point":A.geometry=d.unquantizePoint(Q,b,b,b.hasZ,b.hasM);break;case "multipoint":A.geometry=d.unquantizeMultipoint(Q,b,b,!!b.hasZ,!!b.hasM);break;case "polygon":A.geometry=d.unquantizePolygon(Q,b,b,!!b.hasZ,!!b.hasM);break;case "polyline":A.geometry=d.unquantizePolyline(Q,b,b,!!b.hasZ,!!b.hasM);break;case "extent":A.geometry=b;break;case "mesh":A.geometry=b}return A});return{geometryType:y,features:O,spatialReference:r,fields:v.fields?.map(A=>n.fromJSON(A))??
[],objectIdFieldName:v.objectIdFieldName,globalIdFieldName:v.globalIdFieldName,geohashFieldName:v.geohashFieldName,geometryProperties:v.geometryProperties,hasZ:v.hasZ,hasM:v.hasM,exceededTransferLimit:v.exceededTransferLimit,transform:null}};e.fromJSONGeometry=k;e.getObjectId=function(v,y){return null!=v.objectId?v.objectId:v.attributes&&y?v.attributes[y]:null};e.hasGeometry=function(v){return x.isSome(v.geometry)};e.hasVertices=function(v){if(x.isNone(v))return!1;switch(v.type){case "extent":case "point":return!0;
case "polyline":for(const y of v.paths)if(0<y.length)return!0;return!1;case "polygon":for(const y of v.rings)if(0<y.length)return!0;return!1;case "multipoint":return 0<v.points.length;case "mesh":return!v.loaded||0<v.vertexAttributes.position.length}};e.makeDehydratedPoint=function(v,y,r,Q){return{x:v,y,z:r,hasZ:null!=r,hasM:!1,spatialReference:Q,type:"point"}};e.numVertices=function(v){if(x.isNone(v))return 0;switch(v.type){case "point":return 1;case "polyline":var y=0;for(var r of v.paths)y+=r.length;
return y;case "polygon":r=0;for(y of v.rings)r+=y.length;return r;case "multipoint":return v.points.length;case "extent":return 2;case "mesh":return(v=v.vertexAttributes&&v.vertexAttributes.position)?v.length/3:0}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["exports","../../core/has","../../core/maybe","../../geometry/support/spatialReferenceUtils"],function(e,l,g,w){function x(f,d){if(f===d)return!0;if(null==
f||null==d||f.length!==d.length)return!1;for(let h=0;h<f.length;h++){const n=f[h],z=d[h];if(n.length!==z.length)return!1;for(let k=0;k<n.length;k++)if(n[k]!==z[k])return!1}return!0}function L(f,d){if(f===d)return!0;if(null==f||null==d||f.length!==d.length)return!1;for(let h=0;h<f.length;h++)if(!x(f[h],d[h]))return!1;return!0}function N(f,d){return f===d||g.isSome(f)&&g.isSome(d)&&w.equals(f.spatialReference,d.spatialReference)&&f.x===d.x&&f.y===d.y&&f.z===d.z&&f.m===d.m}function B(f,d){if(f===d)return!0;
if(g.isNone(f)||g.isNone(d)||f.type!==d.type)return!1;switch(f.type){case "point":return N(f,d);case "extent":return f=f.hasZ!==d.hasZ||f.hasM!==d.hasM?!1:w.equals(f.spatialReference,d.spatialReference)?f.xmin===d.xmin&&f.ymin===d.ymin&&f.zmin===d.zmin&&f.xmax===d.xmax&&f.ymax===d.ymax&&f.zmax===d.zmax:!1,f;case "polyline":return f=f.hasZ!==d.hasZ||f.hasM!==d.hasM?!1:w.equals(f.spatialReference,d.spatialReference)?L(f.paths,d.paths):!1,f;case "polygon":return f=f.hasZ!==d.hasZ||f.hasM!==d.hasM?!1:
w.equals(f.spatialReference,d.spatialReference)?L(f.rings,d.rings):!1,f;case "multipoint":return f=f.hasZ!==d.hasZ||f.hasM!==d.hasM?!1:w.equals(f.spatialReference,d.spatialReference)?x(f.points,d.points):!1,f;case "mesh":return!1}}function t(f,d){if(f===d)return!0;if(!f||!d)return!1;const h=Object.keys(f),n=Object.keys(d);if(h.length!==n.length)return!1;for(const z of h)if(f[z]!==d[z])return!1;return!0}e.equals=function(f,d){return f===d?!0:null!=f&&null!=d&&f.objectId===d.objectId&&B(f.geometry,
d.geometry)&&t(f.attributes,d.attributes)?!0:!1};e.pointEquals=N;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../chunks/vec2 ../../chunks/vec2f64 ../../chunks/vec3 ../../chunks/vec3f64 ./geometry2dUtils".split(" "),function(e,l,g,w,x,L,N){function B(b,{start:c,end:a,type:p}){b=x.sub(z,b,c);a=x.sub(k,a,c);b=x.dot(b,a)/x.dot(a,a);return x.scaleAndAdd(L.create(),c,a,p===N.LineType.RAY?Math.max(b,
0):b)}function t({start:b,end:c,type:a},p){const D=x.sub(z,p,b);c=x.sub(k,c,b);if(a===N.LineType.RAY&&-1E-6>x.dot(c,D))return x.distance(b,p);b=x.cross(E,c,D);return x.len(b)/x.len(c)}function f(b,c){const a=b.start,p=c.start;var D=c.end;const P=x.sub(z,b.end,a);D=x.sub(k,D,p);var m=x.sub(E,p,a),I=x.cross(v,P,D),H=x.dot(m,I);if(!l.floatEqualAbsolute(H,0,1E-6))return[];H=x.sqrLen(I);if(l.floatEqualAbsolute(H,0,1E-6))return[];m=x.cross(y,m,D);I=x.dot(m,I)/H;I=x.scaleAndAdd(r,a,P,I);return b.type===
N.LineType.RAY&&(b=x.sub(Q,I,a),-1E-6>x.dot(P,b))||c.type===N.LineType.RAY&&(c=x.sub(Q,I,p),-1E-6>x.dot(D,c))?[]:[L.clone(I)]}function d({start:b,end:c,type:a},p){const D=x.sub(z,p,b);b=x.sub(k,c,b);c=x.cross(E,b,D);if(1E-6>x.sqrLen(c)/x.sqrLen(b))switch(a){case N.LineType.LINE:return[L.clone(p)];case N.LineType.RAY:return-1E-6>x.dot(b,D)?[]:[L.clone(p)]}return[]}function h(b,c,{start:a,end:p,type:D}){x.set(b.start,a[0],a[1],c);x.set(b.end,p[0],p[1],c);b.type=n[D];return b}e.VerticalPlaneType=void 0;
(function(b){b[b.PLANE=0]="PLANE";b[b.HALF_PLANE=1]="HALF_PLANE"})(e.VerticalPlaneType||(e.VerticalPlaneType={}));const n={[e.VerticalPlaneType.PLANE]:N.LineType.LINE,[e.VerticalPlaneType.HALF_PLANE]:N.LineType.RAY},z=L.create(),k=L.create(),E=L.create(),v=L.create(),y=L.create(),r=L.create(),Q=L.create(),O={start:L.create(),end:L.create(),type:N.LineType.LINE},A={start:L.create(),end:L.create(),type:N.LineType.LINE};Object.defineProperty(e,"LineType",{enumerable:!0,get:()=>N.LineType});e.epsilon=
1E-6;e.intersectLineAndPoint=d;e.intersectLineLike=f;e.intersectLineLikeAndVerticalCylinder=function({start:b,end:c,type:a},p,D){const P=[];c=x.subtract(z,c,b);var m=g.subtract(k,b,p);p=g.squaredLength(c);const I=2*g.dot(c,m);D=g.squaredLength(m)-D*D;D=I*I-4*p*D;0===D?(p=-I/(2*p),(a===N.LineType.LINE||0<=p)&&P.push(x.scaleAndAdd(L.create(),b,c,p))):0<D&&(D=Math.sqrt(D),m=(-I+D)/(2*p),(a===N.LineType.LINE||0<=m)&&P.push(x.scaleAndAdd(L.create(),b,c,m)),p=(-I-D)/(2*p),(a===N.LineType.LINE||0<=p)&&P.push(x.scaleAndAdd(L.create(),
b,c,p)));return P};e.intersectVerticalCylinderAndPoint=function(b,c,a){return l.floatEqualAbsolute(g.squaredDistance(a,b),c*c,1E-6)?[L.clone(a)]:[]};e.intersectVerticalPlane=function(b,c){b=h(O,0,b);c=h(A,0,c);c=f(b,c);b=[];for(const a of c)b.push(w.clone(a));return b};e.intersectVerticalPlaneAndLineLike=function(b,c){const a=b.start,p=g.subtract(z,b.end,a);var D=x.set(k,-p[1],p[0],0);const P=c.start,m=x.sub(E,c.end,P);var I=x.dot(m,D),H=x.set(v,a[0],a[1],0);H=x.sub(y,H,P);D=x.dot(H,D);if(1E-6>Math.abs(I))return[];
I=x.scaleAndAdd(r,P,m,D/I);return c.type===N.LineType.RAY&&(c=x.sub(Q,I,P),-1E-6>x.dot(c,m))||b.type===e.VerticalPlaneType.HALF_PLANE&&(b=g.sub(Q,I,a),-1E-6>g.dot(b,p))?[]:[L.clone(I)]};e.intersectVerticalPlaneAndPoint=function(b,c){return d(h(O,c[2],b),c)};e.intersectVerticalPlaneAndVerticalCylinder=function({start:b,end:c,type:a},p,D){const P=[];c=g.subtract(z,c,b);var m=g.subtract(k,b,p);p=g.squaredLength(c);const I=2*g.dot(c,m);D=g.squaredLength(m)-D*D;D=I*I-4*p*D;0===D?(p=-I/(2*p),(a===e.VerticalPlaneType.PLANE||
0<=p)&&P.push(g.scaleAndAdd(w.create(),b,c,p))):0<D&&(D=Math.sqrt(D),m=(-I+D)/(2*p),(a===e.VerticalPlaneType.PLANE||0<=m)&&P.push(g.scaleAndAdd(w.create(),b,c,m)),p=(-I-D)/(2*p),(a===e.VerticalPlaneType.PLANE||0<=p)&&P.push(g.scaleAndAdd(w.create(),b,c,p)));return P};e.pointToLineLikeDistance=t;e.pointToVerticalCylinderDistance=function(b,c,a){return g.distance(b,c)-a};e.pointToVerticalPlaneDistance=function(b,c){return t(h(O,b[2],c),b)};e.projectPointToLineLike=B;e.projectPointToVerticalCylinder=
function(b,c,a){const p=g.subtract(z,b,c);a/=g.length(p);c=g.scaleAndAdd(L.create(),c,p,a);c[2]=b[2];return c};e.projectPointToVerticalPlane=function(b,c){return B(b,h(O,b[2],c))};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec2","../../chunks/vec2f64"],function(e,l,g,w){function x(n,z){return n[0]*z[1]-n[1]*z[0]}function L(n,z,k){z=g.dot(k,z)/g.squaredLength(k);return g.scale(n,
k,z)}function N(n,z,k,E,v=k){g.subtract(t,E,k);g.subtract(d,z,v);L(h,d,t);return g.add(n,v,h)}function B(n,z,k,E){g.subtract(t,z,k);z=E/g.length(t);return g.scaleAndAdd(n,k,t,z)}e.LineType=void 0;(function(n){n[n.RAY=0]="RAY";n[n.LINE=1]="LINE"})(e.LineType||(e.LineType={}));const t=w.create(),f=w.create(),d=w.create(),h=w.create();e.cross=x;e.intersectCircleAndPoint=function(n,z,k){B(d,k,n,z);return l.floatEqualAbsolute(d[0],k[0])&&l.floatEqualAbsolute(d[1],k[1])?[w.clone(k)]:[]};e.intersectLineAndPoint=
function(n,z){N(d,z,n.start,n.end);return l.floatEqualAbsolute(d[0],z[0])&&l.floatEqualAbsolute(d[1],z[1])?[w.clone(z)]:[]};e.intersectLineAndRay=function(n,z){const k=n.start;var E=z.start,v=z.end;const y=g.subtract(t,n.end,k);var r=g.subtract(f,v,E);v=x(y,r);if(1E-6>=Math.abs(v))return[];E=g.subtract(d,k,E);r=x(r,E)/v;v=x(y,E)/v;if(0<=r){if(0<=v||z.type===e.LineType.LINE)return[g.scaleAndAdd(h,k,y,r)]}else if(n.type===e.LineType.LINE&&(0<=v||z.type===e.LineType.LINE))return[g.scaleAndAdd(h,k,y,
r)];return[]};e.intersectLineLikeAndCircle=function(n,z,k){const E=[],v=g.subtract(t,n.end,n.start);var y=g.subtract(f,n.start,z);z=g.squaredLength(v);const r=2*g.dot(v,y);k=g.squaredLength(y)-k*k;k=r*r-4*z*k;0===k?(z=-r/(2*z),(n.type===e.LineType.LINE||0<=z)&&E.push(g.scaleAndAdd(h,n.start,v,z))):0<k&&(k=Math.sqrt(k),y=(-r+k)/(2*z),(n.type===e.LineType.LINE||0<=y)&&E.push(g.scaleAndAdd(h,n.start,v,y)),z=(-r-k)/(2*z),(n.type===e.LineType.LINE||0<=z)&&E.push(g.scaleAndAdd(d,n.start,v,z)));return E};
e.pointToLineDistance=function(n,z,k){return Math.abs((z[0]-n[0])*(k[1]-n[1])-(z[1]-n[1])*(k[0]-n[0]))/g.distance(z,k)};e.projectPoint=L;e.projectPointToCircle=B;e.projectPointToLine=N;e.projectPointToRay=function(n,z,k,E){g.subtract(t,E,k);g.subtract(d,z,k);z=g.dot(t,d)/g.squaredLength(t);return 0<z?g.scaleAndAdd(n,k,t,z):g.copy(n,k)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/maybe ../../../core/reactiveUtils ../../../chunks/vec3 ../../../layers/graphics/dehydratedFeatures ../../input/InputManager ../keybindings ./SnappingPoint".split(" "),
function(e,l,g,w,x,L,N,B){function t(f,d){const h=f.x-d.x;f=f.y-d.y;return h*h+f*f}e.LineSegmentHintType=void 0;(function(f){f[f.TARGET=0]="TARGET";f[f.REFERENCE=1]="REFERENCE";f[f.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(e.LineSegmentHintType||(e.LineSegmentHintType={}));e.editEdgeToSnappingEdge=function(f,d,h){return{left:B.anyMapPointToSnappingPoint(f.leftVertex.pos,d,h),right:B.anyMapPointToSnappingPoint(f.rightVertex.pos,d,h)}};e.makeFilter=function(f){return f.createQuery()};e.makeSnappingQuery=
function({point:f,distance:d,types:h,coordinateHelper:{spatialReference:n}},z,k){return{point:x.makeDehydratedPoint(f[0],f[1],f[2],n.toJSON()),mode:z,distance:d,types:h,query:l.isSome(k)?k.toJSON():{where:"1\x3d1"}}};e.objectEqual=function(f,d){const h=f.length===d.length&&f[0]===d[0]&&f[1]===d[1];switch(f.length){case 2:return h;case 3:return h&&f[2]===d[2];case 4:return h&&f[2]===d[2]&&f[3]===d[3]}return!1};e.screenDistance=function(f,d){return Math.sqrt(t(f,d))};e.setupSnappingToggleHandles=function(f,
d=()=>{}){const h=g.watch(()=>({view:f.view,snappingOptions:f.snappingOptions}),({view:n,snappingOptions:z})=>{const k=L.ViewEventPriorities.TOOL;f.removeHandles("snapping-toggle");n&&l.isSome(z)&&(n=[n.on("key-down",E=>{E.key!==N.SNAPPING_KEYS.toggle||E.repeat||(z.enabledToggled=!0,d())},k),n.on("key-up",E=>{E.key===N.SNAPPING_KEYS.toggle&&(z.enabledToggled=!1,d())},k),n.on("pointer-move",E=>{E=E.native.ctrlKey;z.enabledToggled!==E&&(z.enabledToggled=E,d())},k)],f.addHandles(n,"snapping-toggle"))},
g.syncAndInitial);f.addHandles(h)};e.sortCandidatesInPlace=function(f,d){d.sort((h,n)=>{h=w.squaredDistance(h.targetPoint,f);n=w.squaredDistance(n.targetPoint,f);return h-n})};e.squaredScreenDistance=t;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(e,l,g,w,x,L){x=function(N){function B(f){return t.call(this,{...f,isDraped:!0,constraint:new g.DrapedLineConstraint(f.edgeStart,f.edgeEnd,f.getGroundElevation)})}l._inherits(B,N);var t=l._createSuper(B);l._createClass(B,[{key:"hints",get:function(){return[new L.LineSnappingHint(w.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return B}(x.FeatureSnappingCandidate);e.DrapedEdgeSnappingCandidate=x;Object.defineProperty(e,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../SnappingDomain","./SnappingCandidate"],function(e,l,g,w){w=function(x){function L({targetPoint:B,objectId:t,constraint:f,isDraped:d}){B=N.call(this,B,f,d,g.SnappingDomain.FEATURE);B.objectId=t;return B}l._inherits(L,x);var N=l._createSuper(L);return l._createClass(L)}(w.SnappingCandidate);e.FeatureSnappingCandidate=w;Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(e,l){l=l._createClass(function(g,w,x,L){this.targetPoint=g;this.constraint=w;this.isDraped=x;this.domain=L});e.SnappingCandidate=l;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(e,l,g,w,x,L,N){g=function(B){function t(d,h,n,z,k=L.SnappingDomain.ALL,E=!0,v=!0){z=f.call(this,z,k);z.type=d;z.lineStart=h;z.lineEnd=n;z.fadeLeft=E;z.fadeRight=v;return z}l._inherits(t,B);var f=l._createSuper(t);t.prototype.equals=function(d){return d instanceof t?this.type===d.type&&x.exactEquals(this.lineStart,d.lineStart)&&x.exactEquals(this.lineEnd,d.lineEnd)&&this.fadeLeft===d.fadeLeft&&this.fadeRight===d.fadeRight:!1};l._createClass(t,[{key:"length",get:function(){return x.distance(this.lineStart,
this.lineEnd)}}]);return t}(N.SnappingHint);e.LineSnappingHint=g;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(e,l){l=l._createClass(function(g,w){this.isDraped=g;this.domain=w});e.SnappingHint=l;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../snappingUtils ./FeatureSnappingCandidate ../hints/LineSnappingHint".split(" "),
function(e,l,g,w,x,L){x=function(N){function B(f){return t.call(this,{...f,constraint:new g.LineConstraint(f.edgeStart,f.edgeEnd)})}l._inherits(B,N);var t=l._createSuper(B);l._createClass(B,[{key:"hints",get:function(){return[new L.LineSnappingHint(w.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}]);return B}(x.FeatureSnappingCandidate);e.EdgeSnappingCandidate=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(e,l,g,w,x,L,N){x=function(B){function t({targetPoint:d,constraint:h,previousVertex:n,otherVertex:z,otherVertexType:k,objectId:E,isDraped:v}){d=f.call(this,d,h,v,g.SnappingDomain.SELF);d.previousVertex=n;d.otherVertex=z;d.otherVertexType=k;d.objectId=E;return d}l._inherits(t,B);var f=l._createSuper(t);l._createClass(t,[{key:"hints",get:function(){const d=this.previousVertex,h=this.otherVertexType===e.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===e.OtherVertexType.CENTER?
this.targetPoint:this.otherVertex;return[new L.LineSnappingHint(w.LineSegmentHintType.TARGET,h,n,this.isDraped,this.domain),new L.LineSnappingHint(w.LineSegmentHintType.REFERENCE,d,h,this.isDraped,this.domain),new N.RightAngleSnappingHint(this.previousVertex,h,n,this.isDraped,this.domain)]}}]);return t}(x.SnappingCandidate);e.OtherVertexType=void 0;(function(B){B[B.NEXT=0]="NEXT";B[B.CENTER=1]="CENTER"})(e.OtherVertexType||(e.OtherVertexType={}));e.RightAngleSnappingCandidate=x;Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),function(e,l,g,w,x,L,N){g=function(B){function t(d,h,n,z,k=L.SnappingDomain.ALL){z=f.call(this,z,k);z.previousVertex=d;z.centerVertex=h;z.nextVertex=n;return z}l._inherits(t,B);var f=l._createSuper(t);t.prototype.equals=
function(d){return d instanceof t?x.exactEquals(this.previousVertex,d.previousVertex)&&x.exactEquals(this.centerVertex,d.centerVertex)&&x.exactEquals(this.nextVertex,d.nextVertex):!1};return l._createClass(t)}(N.SnappingHint);e.RightAngleSnappingHint=g;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../chunks/vec2 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../layers/graphics/dehydratedFeatures ../../../support/elevationInfoUtils".split(" "),
function(e,l,g,w,x,L,N){function B(E,v,y,r,Q=x.create()){E=v.toXYZ(E);E[2]=N.getConvertedElevationFromVector(r,E,v.spatialReference,y)||0;r.renderCoordsHelper.toRenderCoords(E,v.spatialReference,Q);return Q}function t(E,v,y,r,Q=x.create()){E=w.copy(h,E);E[2]=N.getConvertedElevationFromVector(r,E,v,y)||0;r.renderCoordsHelper.toRenderCoords(E,v,Q);return Q}function f(E,v,y,r){if("2d"===r.type)return d.x=E[0],d.y=E[1],d.spatialReference=v,r.toScreen(d);t(E,v,y,r,h);r.state.camera.projectToScreen(h,k);
return l.createScreenPoint(k[0],k[1])}const d=L.makeDehydratedPoint(0,0,0,null),h=x.create(),n=l.createRenderScreenPointArray3(),z=l.createRenderScreenPointArray3(),k=l.createScreenPointArray();e.anyMapPointToRender=B;e.anyMapPointToScreenPoint=function(E,v,y,r){return f(v.toXYZ(E),v.spatialReference,y,r)};e.anyMapPointsToRenderWithEqualRelativeZ=function(E,v,y,r,Q,O,A){if("absolute-height"===r.mode)B(E,y,r,Q,O),B(v,y,r,Q,A);else{E=y.toXYZ(E);v=y.toXYZ(v);var b=N.getConvertedElevationFromVector(Q,
E,y.spatialReference,r);r=N.getConvertedElevationFromVector(Q,v,y.spatialReference,r);r=(null==b?r:null==r?b:Math.min(b,r))||0;E[2]=r;v[2]=r;Q.renderCoordsHelper.toRenderCoords(E,y.spatialReference,O);Q.renderCoordsHelper.toRenderCoords(v,y.spatialReference,A)}};e.renderScreenSpaceTangent=function(E,v,y,r){y.projectToRenderScreen(E,n);y.projectToRenderScreen(v,z);g.subtract(r,z,n);g.normalize(r,r)};e.vectorToRender=t;e.vectorToScreenPoint=f;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/SelfSnappingEngine":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./LineSnapper ./ParallelLineSnapper ./RightAngleSnapper ./RightAngleTriangleSnapper ./SnappingDomain ./snappingUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E){e.SelfSnappingEngine=function(v){function y(Q){Q=r.call(this,Q);Q.updating=!1;Q._snappers=new x;Q._domain=k.SnappingDomain.SELF;return Q}l._inherits(y,v);var r=l._createSuper(y);v=y.prototype;v.initialize=function(){this._snappers.push(new h.ParallelLineSnapper(this.view,this.options),new d.LineSnapper(this.view,this.options),new n.RightAngleSnapper(this.view,this.options),new z.RightAngleTriangleSnapper(this.view,this.options))};v.fetchCandidates=async function(Q,
O,A){if(!(O&this._domain&&this.options.effectiveSelfEnabled))return[];O=[];for(const b of this._snappers.items)for(const c of b.snap(Q,A))O.push(c);E.sortCandidatesInPlace(Q,O);return O};l._createClass(y,[{key:"options",set:function(Q){this._set("options",Q);for(const O of this._snappers)O.options=Q}}]);return y}(w);g.__decorate([L.property({readOnly:!0})],e.SelfSnappingEngine.prototype,"updating",void 0);g.__decorate([L.property({constructOnly:!0})],e.SelfSnappingEngine.prototype,"view",void 0);
g.__decorate([L.property()],e.SelfSnappingEngine.prototype,"options",null);e.SelfSnappingEngine=g.__decorate([f.subclass("esri.views.interactive.snapping.SelfSnappingEngine")],e.SelfSnappingEngine);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/LineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/LineSnappingCandidate ../support/viewUtils ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d){x=function(h){function n(){return z.apply(this,arguments)}l._inherits(n,h);var z=l._createSuper(n);h=n.prototype;h.snapNewVertex=function(k,E){var v=E.editGeometryOperations.data.components[0],y=v.edges.length;const r=[];if(1>y)return r;var {spatialReference:Q}=E;Q=t.vectorToScreenPoint(k,Q,w.absoluteHeightElevationInfo,this.view);const {view:O}=this;y=v=v.edges[y-1];do{if(this.edgeExceedsShortLineThreshold(y,E)){const A=N.editEdgeToSnappingEdge(y,O,E);this._processCandidateProposal(A.left,
A.right,k,Q,E,r)}y=y.leftVertex.leftEdge}while(y&&y!==v);return r};h.snapExistingVertex=function(k,E){const v=[],y=g.unwrap(E.vertexHandle);var r=y.component;if(2>r.edges.length)return v;const {view:Q}=this;var {spatialReference:O}=E;O=t.vectorToScreenPoint(k,O,w.absoluteHeightElevationInfo,Q);var A=y.leftEdge,b=y.rightEdge;A&&b&&this.edgeExceedsShortLineThreshold(A,E)&&this.edgeExceedsShortLineThreshold(b,E)&&this._processCandidateProposal(L.anyMapPointToSnappingPoint(A.leftVertex.pos,Q,E),L.anyMapPointToSnappingPoint(b.rightVertex.pos,
Q,E),k,O,E,v);A=r=r.edges[0];do A!==y.leftEdge&&A!==y.rightEdge&&this.edgeExceedsShortLineThreshold(A,E)&&(b=N.editEdgeToSnappingEdge(A,Q,E),this._processCandidateProposal(b.left,b.right,k,O,E,v)),A=A.rightVertex.rightEdge;while(A&&A!==r);return v};h._processCandidateProposal=function(k,E,v,y,r,Q){const {spatialReference:O,pointer:A}=r;v=L.asSnappingPoint(f.projectPointToLineLike(v,{start:k,end:E,type:d.LineType.LINE}));N.squaredScreenDistance(y,t.vectorToScreenPoint(v,O,w.absoluteHeightElevationInfo,
this.view))<this.squaredProximityThreshold(A)&&Q.push(new B.LineSnappingCandidate({lineStart:k,lineEnd:E,targetPoint:v,isDraped:"on-the-ground"===r.elevationInfo?.mode}))};return l._createClass(n)}(x.SnappingAlgorithm);e.LineSnapper=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingAlgorithm":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../support/elevationInfoUtils ./Settings ./SnappingPoint ./snappingUtils ../support/viewUtils".split(" "),
function(e,l,g,w,x,L,N,B,t){let f=function(){function d(n,z){this.view=n;this.options=z;this.squaredShortLineThreshold=L.defaults.shortLineThreshold*L.defaults.shortLineThreshold}var h=d.prototype;h.snap=function(n,z){return g.isSome(z.vertexHandle)?"vertex"!==z.vertexHandle.type?[]:this.snapExistingVertex(n,z):this.snapNewVertex(n,z)};h.edgeExceedsShortLineThreshold=function(n,z){return this.exceedsShortLineThreshold(N.anyMapPointToSnappingPoint(n.leftVertex.pos,this.view,z),N.anyMapPointToSnappingPoint(n.rightVertex.pos,
this.view,z),z)};h.exceedsShortLineThreshold=function(n,z,{spatialReference:k}){return 0===this.squaredShortLineThreshold||B.squaredScreenDistance(t.vectorToScreenPoint(z,k,x.absoluteHeightElevationInfo,this.view),t.vectorToScreenPoint(n,k,x.absoluteHeightElevationInfo,this.view))>this.squaredShortLineThreshold};h.isVertical=function(n,z){return w.squaredDistance(n,z)<L.defaults.verticalLineThreshold};h.squaredProximityThreshold=function(n){return"touch"===n?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold};
l._createClass(d,[{key:"_squaredMouseProximityThreshold",get:function(){return this.options.distance*this.options.distance}},{key:"_squaredTouchProximityThreshold",get:function(){const {distance:n,touchSensitivityMultiplier:z}=this.options,k=n*z;return k*k}}]);return d}();e.SnappingAlgorithm=f;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),
function(e,l,g,w,x,L,N){L=function(B){function t({lineStart:d,lineEnd:h,targetPoint:n,isDraped:z}){n=f.call(this,n,new g.VerticalPlaneConstraint(d,h),z,w.SnappingDomain.SELF);n._referenceLineHint=new N.LineSnappingHint(x.LineSegmentHintType.REFERENCE_EXTENSION,d,h,z,n.domain);return n}l._inherits(t,B);var f=l._createSuper(t);t.prototype._lineEndClosestToTarget=function(){return this.constraint.closestEndTo(this.targetPoint)};l._createClass(t,[{key:"hints",get:function(){return[this._referenceLineHint,
new N.LineSnappingHint(x.LineSegmentHintType.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}}]);return t}(L.SnappingCandidate);e.LineSnappingCandidate=L;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/ParallelLineSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./Settings ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/ParallelLineSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z){t=function(E){function v(){return y.apply(this,arguments)}l._inherits(v,E);var y=l._createSuper(v);E=v.prototype;E.snapNewVertex=function(r,Q){var O=Q.editGeometryOperations.data.components[0],A=O.edges.length,b=O.vertices.length;const c=[];if(2>A)return c;const {view:a}=this,p=n.vectorToScreenPoint(r,Q.spatialReference,N.absoluteHeightElevationInfo,a);b=f.anyMapPointToSnappingPoint(O.vertices[b-1].pos,a,Q);const D=f.anyMapPointToSnappingPoint(O.vertices[0].pos,
a,Q);A=O=O.edges[A-1];do{if(this.edgeExceedsShortLineThreshold(A,Q)){const P=d.editEdgeToSnappingEdge(A,a,Q);this._checkEdgeForParallelLines(P,b,r,p,Q,c);this._checkEdgeForParallelLines(P,D,r,p,Q,c)}A=A.leftVertex.leftEdge}while(A&&A!==O);return c};E.snapExistingVertex=function(r,Q){const O=[],A=g.unwrap(Q.vertexHandle);var b=A.component;if(3>b.edges.length)return O;const {view:c}=this,a=n.vectorToScreenPoint(r,Q.spatialReference,N.absoluteHeightElevationInfo,c),p=A.leftEdge,D=A.rightEdge,P=b.vertices[0],
m=f.anyMapPointToSnappingPoint(P.pos,c,Q),I=b.vertices[b.vertices.length-1],H=f.anyMapPointToSnappingPoint(I.pos,c,Q);let S=b=b.edges[0];do{if(S!==p&&S!==D&&this.edgeExceedsShortLineThreshold(S,Q)){const F=d.editEdgeToSnappingEdge(S,c,Q);p&&this._checkEdgeForParallelLines(F,f.anyMapPointToSnappingPoint(p.leftVertex.pos,c,Q),r,a,Q,O);D&&this._checkEdgeForParallelLines(F,f.anyMapPointToSnappingPoint(D.rightVertex.pos,c,Q),r,a,Q,O);A===P?this._checkEdgeForParallelLines(F,H,r,a,Q,O):A===I&&this._checkEdgeForParallelLines(F,
m,r,a,Q,O)}S=S.rightVertex.rightEdge}while(S&&S!==b);return O};E._checkEdgeForParallelLines=function(r,Q,O,A,b,c){const a=r.left,p=r.right;z.projectPointToLine(k,Q,a,p);if(!(w.squaredDistance(k,Q)<B.defaults.parallelLineThreshold)){z.projectPointToLine(k,O,a,p,Q);var {spatialReference:D,pointer:P}=b;O=f.asSnappingPoint(L.fromValues(k[0],k[1],O[2]));d.squaredScreenDistance(A,n.vectorToScreenPoint(O,D,N.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(P)&&!(this.isVertical(O,Q)||
this.isVertical(a,p)||this._parallelToPreviousCandidate(r,c))&&c.push(new h.ParallelLineSnappingCandidate({referenceLine:r,lineStart:Q,targetPoint:O,isDraped:"on-the-ground"===b.elevationInfo?.mode}))}};E._parallelToPreviousCandidate=function(r,Q){const O=r.left,A=r.right;for(const b of Q)if(z.projectPointToLine(k,A,b.constraint.start,b.constraint.end,O),w.squaredDistance(k,A)<B.defaults.parallelLineThreshold)return b.addReferenceLine(r),!0;return!1};return l._createClass(v)}(t.SnappingAlgorithm);
const k=x.create();e.ParallelLineSnapper=t;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(e,l,g,w,x,L,N,B,t,f,d){t=
function(h){function n({referenceLine:k,lineStart:E,targetPoint:v,isDraped:y}){const r=w.clone(E),{left:Q,right:O}=k;g.subtract(r,g.add(r,r,O),Q);E=z.call(this,v,new x.VerticalPlaneConstraint(E,N.asSnappingPoint(r)),y,L.SnappingDomain.SELF);E._referenceLines=[{edge:k,fadeLeft:!0,fadeRight:!0}];return E}l._inherits(n,h);var z=l._createSuper(n);n.prototype.addReferenceLine=function(k){const E={edge:k,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(v=>{g.exactEquals(k.right,v.edge.left)&&(v.fadeLeft=
!1,E.fadeRight=!1);g.exactEquals(k.right,v.edge.right)&&(v.fadeRight=!1,E.fadeRight=!1);g.exactEquals(k.left,v.edge.right)&&(v.fadeRight=!1,E.fadeLeft=!1);g.exactEquals(k.left,v.edge.left)&&(v.fadeLeft=!1,E.fadeLeft=!1)});this._referenceLines.push(E)};l._createClass(n,[{key:"hints",get:function(){return[new f.LineSnappingHint(B.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new d.ParallelSnappingHint(this.constraint.start,this.targetPoint,this.isDraped,
this.domain),...this._referenceLines.map(k=>new f.LineSnappingHint(B.LineSegmentHintType.REFERENCE,k.edge.left,k.edge.right,this.isDraped,this.domain,k.fadeLeft,k.fadeRight))]}}]);return n}(t.SnappingCandidate);e.ParallelLineSnappingCandidate=t;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/Logger ../../../../chunks/vec3 ../SnappingDomain ./SnappingHint".split(" "),
function(e,l,g,w,x,L,N){g=function(B){function t(d,h,n,z=L.SnappingDomain.ALL){n=f.call(this,n,z);n.lineStart=d;n.lineEnd=h;return n}l._inherits(t,B);var f=l._createSuper(t);t.prototype.equals=function(d){return d instanceof t?x.exactEquals(this.lineStart,d.lineStart)&&x.exactEquals(this.lineEnd,d.lineEnd):!1};return l._createClass(t)}(N.SnappingHint);e.ParallelSnappingHint=g;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingConstraint ./SnappingPoint ./snappingUtils ./candidates/RightAngleSnappingCandidate ../support/viewUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z){t=function(v){function y(){return r.apply(this,arguments)}l._inherits(y,v);var r=l._createSuper(y);v=y.prototype;v.snapNewVertex=function(Q,O){var A=O.editGeometryOperations.data.components[0],b=A.vertices.length;const c=[];if(2>b)return c;var {view:a}=this;const p=z.vectorToScreenPoint(Q,O.spatialReference,B.absoluteHeightElevationInfo,a);var D=A.vertices[b-1];this.edgeExceedsShortLineThreshold(D.leftEdge,O)&&(b=d.anyMapPointToSnappingPoint(D.pos,a,O),D=d.anyMapPointToSnappingPoint(D.leftEdge.leftVertex.pos,
a,O),this._checkForSnappingCandidate(c,D,b,Q,p,O));b=A.vertices[0];this.edgeExceedsShortLineThreshold(b.rightEdge,O)&&(A=d.anyMapPointToSnappingPoint(b.pos,a,O),a=d.anyMapPointToSnappingPoint(b.rightEdge.rightVertex.pos,a,O),this._checkForSnappingCandidate(c,a,A,Q,p,O));return c};v.snapExistingVertex=function(Q,O){const A=[];var b=g.unwrap(O.vertexHandle);if(3>b.component.vertices.length)return A;var {view:c}=this;const a=z.vectorToScreenPoint(Q,O.spatialReference,B.absoluteHeightElevationInfo,c);
var p=b.leftEdge;b=b.rightEdge;if(p&&p.leftVertex.leftEdge){var D=p.leftVertex.leftEdge;this.edgeExceedsShortLineThreshold(D,O)&&(p=d.anyMapPointToSnappingPoint(D.rightVertex.pos,c,O),D=d.anyMapPointToSnappingPoint(D.leftVertex.pos,c,O),this._checkForSnappingCandidate(A,D,p,Q,a,O))}b&&b.rightVertex.rightEdge&&(p=b.rightVertex.rightEdge,this.edgeExceedsShortLineThreshold(p,O)&&(b=d.anyMapPointToSnappingPoint(p.leftVertex.pos,c,O),c=d.anyMapPointToSnappingPoint(p.rightVertex.pos,c,O),this._checkForSnappingCandidate(A,
c,b,Q,a,O)));return A};v._checkForSnappingCandidate=function(Q,O,A,b,c,a){const {spatialReference:p,pointer:D}=a;w.subtract(k,A,O);const P=L.set(E,k[1],-k[0],0),m=w.dot(P,w.subtract(k,b,A))/w.squaredLength(P);b=d.asSnappingPoint(w.scaleAndAdd(N.clone(b),A,P,m));h.squaredScreenDistance(c,z.vectorToScreenPoint(b,p,B.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(D)&&!this.isVertical(b,A)&&!this.isVertical(A,O)&&(c=L.scaleAndAdd(N.create(),A,P,Math.sign(m)),Q.push(new n.RightAngleSnappingCandidate({targetPoint:b,
constraint:new f.VerticalHalfPlaneConstraint(A,d.asSnappingPoint(c)),previousVertex:O,otherVertex:A,otherVertexType:n.OtherVertexType.CENTER,isDraped:"on-the-ground"===a.elevationInfo?.mode})))};return l._createClass(y)}(t.SnappingAlgorithm);const k=x.create(),E=N.create();e.RightAngleSnapper=t;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/RightAngleTriangleSnapper":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../chunks/vec2 ../../../chunks/vec2f64 ../../../chunks/vec3f64 ../../../support/elevationInfoUtils ./SnappingAlgorithm ./SnappingPoint ./snappingUtils ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils ../../support/geometry2dUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n){B=function(k){function E(){return v.apply(this,arguments)}l._inherits(E,k);var v=l._createSuper(E);k=E.prototype;k.snapNewVertex=function(y,r){var Q=r.editGeometryOperations.data.components[0];const O=[];var A=Q.vertices.length;if("polygon"!==r.editGeometryOperations.data.type||2>A)return O;var {view:b}=this;A=Q.vertices[A-1];Q=t.anyMapPointToSnappingPoint(Q.vertices[0].pos,b,r);b=t.anyMapPointToSnappingPoint(A.pos,b,r);this._processCandidateProposal(Q,b,y,r,O);
return O};k.snapExistingVertex=function(y,r){const Q=[];var O=g.unwrap(r.vertexHandle),A=O.component;if(2>A.edges.length||"polyline"===r.editGeometryOperations.data.type&&(0===O.index||O.index===A.vertices.length-1))return Q;const {view:b}=this;A=t.anyMapPointToSnappingPoint(O.leftEdge.leftVertex.pos,b,r);O=t.anyMapPointToSnappingPoint(O.rightEdge.rightVertex.pos,b,r);this._processCandidateProposal(A,O,y,r,Q);return Q};k._processCandidateProposal=function(y,r,Q,O,A){if(this.exceedsShortLineThreshold(y,
r,O)){var b=w.lerp(z,y,r,.5),c=.5*w.distance(y,r),a=L.create();n.projectPointToCircle(a,Q,b,c);a[2]=Q[2];b=t.asSnappingPoint(a);var {spatialReference:p,pointer:D}=O;Q=h.vectorToScreenPoint(Q,p,N.absoluteHeightElevationInfo,this.view);f.squaredScreenDistance(Q,h.vectorToScreenPoint(b,p,N.absoluteHeightElevationInfo,this.view))<this.squaredProximityThreshold(D)&&!this.isVertical(y,b)&&!this.isVertical(b,r)&&A.push(new d.RightAngleTriangleSnappingCandidate({targetPoint:b,point1:y,point2:r,isDraped:"on-the-ground"===
O.elevationInfo?.mode}))}};return l._createClass(E)}(B.SnappingAlgorithm);const z=x.create();e.RightAngleTriangleSnapper=B;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/vec2 ../../../../chunks/vec3 ../../../../chunks/vec3f64 ../SnappingConstraint ../SnappingDomain ../SnappingPoint ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h){f=function(n){function z({targetPoint:E,point1:v,point2:y,isDraped:r}){E=k.call(this,E,new L.VerticalCylinderConstraint(B.asSnappingPoint(w.lerp(x.create(),v,y,.5)),.5*g.distance(v,y)),r,N.SnappingDomain.SELF);E._p1=v;E._p2=y;return E}l._inherits(z,n);var k=l._createSuper(z);l._createClass(z,[{key:"hints",get:function(){return[new d.LineSnappingHint(t.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new d.LineSnappingHint(t.LineSegmentHintType.REFERENCE,
this.targetPoint,this._p2,this.isDraped,this.domain),new h.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}]);return z}(f.SnappingCandidate);e.RightAngleTriangleSnappingCandidate=f;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d){g=function(h){function n(k){k=z.call(this,k);k.enabled=!1;k.enabledToggled=!1;k.selfEnabled=!0;k.featureEnabled=!0;k.featureSources=new w;k.distance=d.defaults.distance;k.touchSensitivityMultiplier=d.defaults.touchSensitivityMultiplier;return k}e._inherits(n,h);var z=e._createSuper(n);e._createClass(n,[{key:"effectiveEnabled",get:function(){return this.enabledToggled?!this.enabled:this.enabled}},{key:"effectiveSelfEnabled",get:function(){return this.effectiveEnabled&&
this.selfEnabled}},{key:"effectiveFeatureEnabled",get:function(){return this.effectiveEnabled&&this.featureEnabled}}]);return n}(g);l.__decorate([x.property()],g.prototype,"enabled",void 0);l.__decorate([x.property()],g.prototype,"enabledToggled",void 0);l.__decorate([x.property()],g.prototype,"selfEnabled",void 0);l.__decorate([x.property()],g.prototype,"featureEnabled",void 0);l.__decorate([x.property({type:w.ofType(f)})],g.prototype,"featureSources",void 0);l.__decorate([x.property()],g.prototype,
"distance",void 0);l.__decorate([x.property()],g.prototype,"touchSensitivityMultiplier",void 0);l.__decorate([x.property({readOnly:!0})],g.prototype,"effectiveEnabled",null);l.__decorate([x.property({readOnly:!0})],g.prototype,"effectiveSelfEnabled",null);l.__decorate([x.property({readOnly:!0})],g.prototype,"effectiveFeatureEnabled",null);return g=l.__decorate([t.subclass("esri.views.interactive.snapping.SnappingOptions")],g)})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../SnappingConstraint ../SnappingDomain ./SnappingCandidate ../hints/IntersectionSnappingHint".split(" "),
function(e,l,g,w,x,L){x=function(N){function B(f,d,h,n){f=t.call(this,f,new g.IntersectionConstraint(f,d.constraint,h.constraint),n,w.SnappingDomain.ALL);f.first=d;f.second=h;return f}l._inherits(B,N);var t=l._createSuper(B);l._createClass(B,[{key:"hints",get:function(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new L.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}]);return B}(x.SnappingCandidate);
e.IntersectionSnappingCandidate=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","../../../../chunks/vec3","../SnappingDomain","./SnappingHint"],function(e,l,g,w,x){x=function(L){function N(t,f,d=w.SnappingDomain.ALL){f=B.call(this,f,d);f.intersectionPoint=t;return f}l._inherits(N,L);var B=l._createSuper(N);N.prototype.equals=function(t){return t instanceof
N?g.exactEquals(this.intersectionPoint,t.intersectionPoint):!1};return l._createClass(N)}(x.SnappingHint);e.IntersectionSnappingHint=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,g,w,x,L,N,B,t){e.OperationHandle=function(f){function d(n){n=h.call(this,n);n.cancelled=!1;n.history={undo:[],redo:[]};n.type=null;return n}l._inherits(d,f);var h=l._createSuper(d);f=d.prototype;f.addToHistory=function(n){this.history.redo=[];this.history.undo.push(n)};f.resetHistory=function(){this.history.redo=[];this.history.undo=[]};f.canUndo=function(){return 0<this.history.undo.length};f.canRedo=function(){return 0<this.history.redo.length};f.complete=function(){this._reset();this.onEnd();
this.emit("complete")};f.cancel=function(){this.cancelled=!0;this.complete()};f._reset=function(){this.activeComponent?.reset()};f.refreshComponent=function(){const n=this.activeComponent;n&&("box"!==n.type&&"reshape"!==n.type&&"graphic-mover"!==n.type||n.refresh())};l._createClass(d,[{key:"tool",get:function(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";
case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:w.neverReached(this.activeComponent)}return null}},{key:"undo",set:function(n){this._set("undo",()=>{this.canUndo()&&n()})}},{key:"redo",set:function(n){this._set("redo",()=>{this.canRedo()&&n()})}}]);return d}(x.EventedAccessor);g.__decorate([L.property()],e.OperationHandle.prototype,"activeComponent",void 0);g.__decorate([L.property()],e.OperationHandle.prototype,"cancelled",void 0);g.__decorate([L.property()],e.OperationHandle.prototype,
"history",void 0);g.__decorate([L.property()],e.OperationHandle.prototype,"tool",null);g.__decorate([L.property()],e.OperationHandle.prototype,"type",void 0);g.__decorate([L.property()],e.OperationHandle.prototype,"canUndo",null);g.__decorate([L.property()],e.OperationHandle.prototype,"canRedo",null);g.__decorate([L.property()],e.OperationHandle.prototype,"onEnd",void 0);g.__decorate([L.property()],e.OperationHandle.prototype,"undo",null);g.__decorate([L.property()],e.OperationHandle.prototype,"redo",
null);g.__decorate([L.property()],e.OperationHandle.prototype,"toggleTool",void 0);g.__decorate([L.property()],e.OperationHandle.prototype,"addToSelection",void 0);g.__decorate([L.property()],e.OperationHandle.prototype,"removeFromSelection",void 0);e.OperationHandle=g.__decorate([t.subclass("esri.widgets.Sketch.support.OperationHandle")],e.OperationHandle);e.CreateOperationHandle=function(f){function d(){return h.apply(this,arguments)}l._inherits(d,f);var h=l._createSuper(d);return l._createClass(d)}(e.OperationHandle);
g.__decorate([L.property()],e.CreateOperationHandle.prototype,"activeComponent",void 0);e.CreateOperationHandle=g.__decorate([t.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],e.CreateOperationHandle);e.UpdateOperationHandle=function(f){function d(){return h.apply(this,arguments)}l._inherits(d,f);var h=l._createSuper(d);return l._createClass(d)}(e.OperationHandle);g.__decorate([L.property()],e.UpdateOperationHandle.prototype,"activeComponent",void 0);e.UpdateOperationHandle=g.__decorate([t.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],
e.UpdateOperationHandle);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/maybe ../../core/uid ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./componentsUtils ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E){const v={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0};B=function(y){function r(O,A){var b=Q,c=b.call;const {view:a,viewModel:p,snappingOptions:D,...P}=O;A=c.call(b,this,P,A);A._layerListFilter=null;A.iconClass="esri-icon-vertex-gps";A.layerListOpen=!0;A.messages=null;A.visibleElements={...v};A._defaultViewModel=null;O?.viewModel?A.viewModel=O.viewModel:(A._defaultViewModel=new E({snappingOptions:O.snappingOptions,view:O.view}),
A.viewModel=A._defaultViewModel);return A}l._inherits(r,y);var Q=l._createSuper(r);y=r.prototype;y.destroy=function(){this._defaultViewModel=w.destroyMaybe(this._defaultViewModel)};y.loadDependencies=function(){return h.loadCalciteComponents({accordion:()=>new Promise((O,A)=>e(["../../chunks/calcite-accordion"],O,A)),"accordion-item":()=>new Promise((O,A)=>e(["../../chunks/calcite-accordion-item"],O,A)),block:()=>new Promise((O,A)=>e(["../../chunks/calcite-block"],O,A)),checkbox:()=>new Promise((O,
A)=>e(["../../chunks/calcite-checkbox"],O,A)),input:()=>new Promise((O,A)=>e(["../../chunks/calcite-input"],O,A)),label:()=>new Promise((O,A)=>e(["../../chunks/calcite-label"],O,A)),list:()=>new Promise((O,A)=>e(["../../chunks/calcite-list"],O,A)),"list-item":()=>new Promise((O,A)=>e(["../../chunks/calcite-list-item"],O,A)),panel:()=>new Promise((O,A)=>e(["../../chunks/calcite-panel"],O,A)),switch:()=>new Promise((O,A)=>e(["../../chunks/calcite-switch"],O,A))})};y.castVisibleElements=function(O){return{...v,
...O}};y.render=function(){const {label:O,visibleElements:{header:A}}=this;return k.tsx("div",{"aria-label":O,class:this.classes("esri-snapping-controls","esri-widget")},k.tsx("div",{class:"esri-snapping-controls__container"},A?this.renderHeaderView():this.renderContent()))};y.renderHeaderView=function(){return k.tsx("calcite-panel",{heading:this.label,class:"esri-snapping-controls__panel"},this.renderContent())};y.renderContent=function(){return[this.renderToggles(),this.renderLayerList()]};y.renderToggles=
function(){const {visibleElements:{enabledToggle:O,selfEnabledToggle:A,featureEnabledToggle:b}}=this;return O||A||b?k.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",key:"toggle-block",heading:"",open:!0},this.renderEnabledToggle(),k.tsx("div",{class:"esri-snapping-controls__nested-container"},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle())):null};y.renderEnabledToggle=function(){if(!this.visibleElements.enabledToggle)return null;const {messages:{enableSnapping:O},
viewModel:{snappingOptions:{enabled:A,enabledToggled:b}}}=this;return k.tsx("calcite-label",{layout:"inline-space-between"},O,k.tsx("calcite-switch",{checked:A,disabled:b,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))};y.renderSelfEnabledToggle=function(){if(!this.visibleElements.selfEnabledToggle)return null;const {messages:{geometryGuides:O},viewModel:{snappingOptions:{enabled:A,selfEnabled:b,enabledToggled:c}}}=this;return k.tsx("calcite-label",{layout:"inline-space-between",
key:"self-enabled-toggle"},O,k.tsx("calcite-switch",{checked:b,disabled:c||!A,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))};y.renderFeatureEnabledToggle=function(){if(!this.visibleElements.featureEnabledToggle)return null;const {messages:{featureToFeature:O},viewModel:{snappingOptions:{enabled:A,featureEnabled:b,enabledToggled:c}}}=this;return k.tsx("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},O,k.tsx("calcite-switch",{checked:b,disabled:c||!A,bind:this,
onCalciteSwitchChange:this._featureEnabledSwitchChange}))};y.renderLayerList=function(){if(!this.visibleElements.layerList)return null;const {messages:O}=this;var A=({target:{value:b}})=>this._layerListFilter=""===b?null:new RegExp(b,"i");A=9<this.viewModel.layerListViewModel.operationalItems.length?k.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:O?.searchLayers,onCalciteInputInput:A}):null;return k.tsx("calcite-block",{key:"list-block",heading:O.snappingLayers,
class:"esri-snapping-controls__layer-list-block",collapsible:!0,open:this.layerListOpen,onCalciteBlockToggle:b=>this.layerListOpen=b.target.open},A,k.tsx("calcite-list",{class:"esri-snapping-controls__layer-list"},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems,w.unwrap(this._layerListFilter))))};y.renderLayerListItemCollection=function(O,A){return O.map(b=>{if(A?this._itemTitleMatchesFilter(b,A):1)return 0<b.children.length?this.renderLayerListItemGroup(b):this.renderLayerListItem(b);
const c=b.children.filter(a=>this._itemTitleMatchesFilter(a,A));return 0<c.length?this.renderLayerListItemGroup(b,c):null}).toArray().filter(w.isSome)};y.renderLayerListItem=function(O){var {messages:{untitledLayer:A}}=this;A=O.title||A;const b=k.tsx("calcite-checkbox",{value:O.layer.id,checked:O.enabled,bind:this,onCalciteCheckboxChange:c=>this._handleLayerListItemChange(c.target)});return k.tsx("calcite-list-item",{key:`${this.id}-list-item-${O.uid}`,onCalciteListItemSelect:()=>{this._handleLayerListItemChange({checked:!b.properties.checked,
value:b.properties.value})}},k.tsx("calcite-label",{class:"esri-snapping-controls__layer-list__item",slot:"content-start",tabIndex:-1,layout:"inline"},k.tsx("div",{class:"esri-snapping-controls__layer-list__item__checkbox"},b),k.tsx("div",{class:"esri-snapping-controls__layer-list__item__label"},A)))};y.renderLayerListItemGroup=function(O,A){const b=O.title||this.messages.untitledLayer,c=O.title&&""!==O.title?O.title:x.generateUID();return k.tsx("calcite-list-item",{key:c},k.tsx("calcite-accordion",
{iconPosition:"start",appearance:"transparent",afterCreate:a=>{a.append(...Array.from(a.children).map(p=>{p.remove();return p}))}},k.tsx("calcite-accordion-item",{expanded:!!A,heading:b,key:O.uid},k.tsx("calcite-list",null,[...this.renderLayerListItemCollection(A??O.children)]))))};y._enableSnappingSwitchChange=function(O){this.snappingOptions.enabled=O.target.checked};y._featureEnabledSwitchChange=function(O){this.snappingOptions.featureEnabled=O.target.checked};y._itemTitleMatchesFilter=function(O,
A){return null!=A&&A.test(O.title)};y._selfEnabledSwitchChange=function(O){this.snappingOptions.selfEnabled=O.target.checked};y._handleLayerListItemChange=async function(O){O.checked?this.viewModel.enableSnappingForLayer(O.value):this.viewModel.disableSnappingForLayer(O.value)};l._createClass(r,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(O){this._overrideIfSome("label",O)}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(O){this.viewModel.snappingOptions=
O}},{key:"view",get:function(){return this.viewModel.view},set:function(O){this.viewModel.view=O}},{key:"viewModel",set:function(O){if(O!==this._get("viewModel")){if(w.isNone(this._defaultViewModel)||this._defaultViewModel!==O)this._defaultViewModel=w.destroyMaybe(this._defaultViewModel);this._set("viewModel",O)}}}]);return r}(d);g.__decorate([L.property()],B.prototype,"_layerListFilter",void 0);g.__decorate([L.property()],B.prototype,"iconClass",void 0);g.__decorate([L.property()],B.prototype,"label",
null);g.__decorate([L.property()],B.prototype,"layerListOpen",void 0);g.__decorate([L.property(),z.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],B.prototype,"messages",void 0);g.__decorate([L.property()],B.prototype,"snappingOptions",null);g.__decorate([L.property()],B.prototype,"view",null);g.__decorate([L.property()],B.prototype,"viewModel",null);g.__decorate([L.property()],B.prototype,"visibleElements",void 0);g.__decorate([N.cast("visibleElements")],B.prototype,
"castVisibleElements",null);return B=g.__decorate([f.subclass("esri.widgets.support.SnappingControls")],B)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z){g=function(k){function E(y){y=v.call(this,y);y.layerListViewModel=new z.SnappingLayerListViewModel;y.snappingOptions=null;y.view=null;return y}e._inherits(E,k);var v=e._createSuper(E);k=E.prototype;k.initialize=function(){this.handles.add([L.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:y,view:r})=>{y.view=r},L.initial),L.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:y,sources:r})=>
{y.featureSnappingSources=r},L.initial)])};k.enableSnappingForLayer=function(y){(this._findSnappingSourceForLayer(y)??this._makeSnappingSourceForLayer(y)).enabled=!0};k.disableSnappingForLayer=function(y){if(y=this._findSnappingSourceForLayer(y))y.enabled=!1};k.updateEnabledFeatureSources=function(y){for(const r of this.snappingOptions.featureSources)n.canDisplayLayer(r.layer)&&(r.enabled=y.includes(r.layer.id))};k._findSnappingSourceForLayer=function(y){return this.snappingOptions.featureSources.find(r=>
r.layer.id===y)};k._makeSnappingSourceForLayer=function(y){var r=this.layerListViewModel.operationalItemsFlat.find(Q=>Q.layer.id===y)?.layer;if(!r)throw new w("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${y} because no such layer was found in the view`);r=new h({layer:r});this.snappingOptions.featureSources.add(r);return r};e._createClass(E,[{key:"state",get:function(){return this.get("snappingOptions")?"ready":"disabled"}}]);return E}(x.HandleOwnerMixin(g));l.__decorate([N.property({constructOnly:!0})],
g.prototype,"layerListViewModel",void 0);l.__decorate([N.property()],g.prototype,"snappingOptions",void 0);l.__decorate([N.property()],g.prototype,"state",null);l.__decorate([N.property()],g.prototype,"view",void 0);return g=l.__decorate([d.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],g)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(e){function l(t){if(t)return null!=t.listMode?t.listMode:void 0}function g(t){if(t)return null!=
t.minScale?t.minScale:void 0}function w(t){if(t)return null!=t.maxScale?t.maxScale:void 0}function x(t){if(t&&!("type"in t&&"wmts"===t.type)&&t.listMode!==B.hideChildren)return"sublayers"in t?"sublayers":"layers"in t?"layers":void 0}function L(t,f){t&&t.sort((d,h)=>{d=f.indexOf(d.uid);h=f.indexOf(h.uid);return d>h?-1:d<h?1:0})}function N(t){return!!t?.layer}const B={hide:"hide",hideChildren:"hide-children"};e.canDisplayLayer=function(t){return l(t)!==B.hide};e.canSortSublayers=function(t){t=t&&(t.get("layer.layer")||
t.layer);if(!t)return!1;t=t.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"===typeof t?t:!0};e.findLayerListMode=l;e.findLayerMaxScale=w;e.findLayerMinScale=g;e.findLayerVisibilityMode=function(t){if(!t)return"inherited";var f=t.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"===typeof f)return f?"independent":"inherited";f=t.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"===typeof f?f?"independent":"inherited":null!=t.visibilityMode?
t.visibilityMode:"independent"};e.findSelectedItem=function(t,f){const d=t.layer?.uid;return null!=d?f.find(h=>h.layer?.uid===d):null};e.getItemLayers=function(t){return(t=t?.layer)&&"layers"in t?t.layers:null};e.getLegendLayerInfo=function(t){var f=N(t)?t:null;const d=t?.parent;return(f="map-image"===d?.type?f?.source:null)&&d?{layer:d,title:"",sublayerIds:[f.mapLayerId]}:{layer:t,title:""}};e.getNormalizedChildLayerProperty=x;e.isLayerOutsideScaleRange=function(t,f){if(!t||isNaN(f))return!1;var d=
g(t);t=w(t);d=null!=d&&!isNaN(d)&&0<d&&f>d;f=null!=t&&!isNaN(t)&&0<t&&f<t;return d||f};e.isSublayer=N;e.sortChildLayersToIds=function(t,f){if(t=t?.layer){var d=x(t);d&&(t=t.get(d),L(t,f))}};e.sortLayersToIds=L;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h){e.SnappingLayerListViewModel=function(n){function z(){var E=k.apply(this,arguments);E.featureSnappingSources=new w;return E}l._inherits(z,n);var k=l._createSuper(z);n=z.prototype;n._compileList=function(){var E=this.get("view.map.layers");E&&(E=E.filter(d.isValidSnappingLayer),this._watchLayersListMode(E),(E=this._getViewableLayers(E))&&E.length?(this._createNewItems(E),this._removeItems(E),this._sortItems(E)):this._removeAllItems())};n._createListItem=function(E){return new h.SnappingListItem({layer:E,
view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})};l._createClass(z,[{key:"operationalItemsFlat",get:function(){return this.operationalItems.flatten(E=>E.children)}}]);return z}(f);g.__decorate([x.property()],e.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);g.__decorate([x.property()],e.SnappingLayerListViewModel.prototype,"operationalItems",void 0);e.SnappingLayerListViewModel=g.__decorate([t.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],
e.SnappingLayerListViewModel);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ListItem ./support/layerListUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h){const n=g.ofType(d);g=function(z){function k(v){v=E.call(this,v);v.checkPublishStatusEnabled=!1;v.listItemCreatedFunction=null;v.operationalItems=new n;v.view=null;return v}e._inherits(k,z);var E=e._createSuper(k);z=k.prototype;z.initialize=function(){this.addHandles([x.watch(()=>[this.view,this.view?.ready],()=>this._viewHandles(),x.initial),x.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],"view")};z.destroy=function(){this.removeAllHandles();
this.view=null;this.operationalItems.removeAll()};z.triggerAction=function(v,y){v&&!v.disabled&&this.emit("trigger-action",{action:v,item:y})};z.moveListItem=function(v,y,r,Q){const O=v?.layer;if(O){var A=this.view?.map?.layers,b=y?h.getItemLayers(y):A;A=r?h.getItemLayers(r):A;if(b&&A){var {operationalItems:c}=this;y=y?.children||c;c=r?.children||c;Q=A.length-Q;v.parent=r||null;y.includes(v)&&y.remove(v);b.includes(O)&&b.remove(O);c.includes(v)||c.add(v,Q);A.includes(O)||A.add(O,Q)}}};z._createLayerViewHandles=
function(v){this.removeHandles("layer-views");this._compileList();v&&this.addHandles(v.on("change",()=>this._compileList()),"layer-views")};z._createMapLayerHandles=function(v){this.removeHandles("map-layers");this._compileList();v&&this.addHandles(v.on("change",()=>this._compileList()),"map-layers")};z._createListItem=function(v){const {view:y,listItemCreatedFunction:r,checkPublishStatusEnabled:Q}=this;return new d({checkPublishStatusEnabled:Q,layer:v,listItemCreatedFunction:r,view:y})};z._removeAllItems=
function(){this.operationalItems.removeAll()};z._getViewableLayers=function(v){if(v)return v.filter(y=>"hide"!==h.findLayerListMode(y))};z._watchLayersListMode=function(v){this.removeHandles("layer-list-mode");v&&v.forEach(y=>{"listMode"in y&&this.addHandles(x.watch(()=>y.listMode,()=>this._compileList()),"layer-list-mode")})};z._compileList=function(){var v=this.get("view.map.layers");this._watchLayersListMode(v);(v=this._getViewableLayers(v))&&v.length?(this._createNewItems(v),this._removeItems(v),
this._sortItems(v)):this._removeAllItems()};z._createNewItems=function(v){const {operationalItems:y}=this;v.forEach(r=>{y.find(Q=>Q.layer===r)||y.add(this._createListItem(r))})};z._removeItems=function(v){const {operationalItems:y}=this,r=[];y.forEach(Q=>{Q&&v&&v.includes(Q.layer)||r.push(Q)});y.removeMany(r)};z._sortItems=function(v){const {operationalItems:y}=this;y.sort((r,Q)=>{r=v.indexOf(r.layer);Q=v.indexOf(Q.layer);return r>Q?-1:r<Q?1:0})};z._recompileList=function(){this._removeAllItems();
this._compileList()};z._viewHandles=function(){const {view:v}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);this._compileList();v&&v.ready&&this.addHandles([x.watch(()=>this.view?.map?.allLayers,y=>this._createMapLayerHandles(y),x.initial),x.watch(()=>this.view?.allLayerViews,y=>this._createLayerViewHandles(y),x.initial)],"view-layers")};e._createClass(k,[{key:"state",get:function(){const v=this.get("view");return this.get("view.ready")?"ready":v?"loading":"disabled"}}]);return k}(w.EventedAccessor);
l.__decorate([L.property()],g.prototype,"checkPublishStatusEnabled",void 0);l.__decorate([L.property()],g.prototype,"listItemCreatedFunction",void 0);l.__decorate([L.property({type:n})],g.prototype,"operationalItems",void 0);l.__decorate([L.property({readOnly:!0})],g.prototype,"state",null);l.__decorate([L.property()],g.prototype,"view",void 0);return g=l.__decorate([f.subclass("esri.widgets.LayerList.LayerListViewModel")],g)})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/HandleOwner ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r){var Q;d=w.ofType({key:"type",defaultKeyValue:"button",base:z,typeMap:{button:k,toggle:v,slider:E}});const O=w.ofType(d);g=Q=function(A){function b(a){a=c.call(this,a);a.actionsSections=new O;a.actionsOpen=!1;a.checkPublishStatusEnabled=!1;a.children=new (w.ofType(Q));a.childrenSortable=!0;a.hidden=!1;a.layer=null;a.layerView=null;a.listItemCreatedFunction=null;a.open=!1;a.panel=null;a.parent=null;a.sortable=!0;a.view=null;return a}e._inherits(b,A);var c=
e._createSuper(b);A=b.prototype;A.initialize=function(){this.handles.add([B.watch(()=>this.layer,a=>this._watchLayerProperties(a),B.initial),B.watch(()=>this.checkPublishStatusEnabled,a=>this._updateChildrenPublishing(a),B.initial),B.watch(()=>this.view,a=>this._updateChildrenView(a),B.initial),B.watch(()=>this.panel,a=>this._setListItemOnPanel(a),B.initial),B.watch(()=>[this.layer,this.view],()=>this._getLayerView(),B.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,
{item:this})};A.destroy=function(){this.view=null};A.castPanel=function(a){this.get("panel.open")&&!a.hasOwnProperty("open")&&(a.open=!0);return a?new y(a):null};A.clone=function(){return new Q({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})};
A._setListItemOnPanel=function(a){a&&(a.listItem=this)};A._updateChildrenPublishing=function(a){const p=this.children;p&&p.forEach(D=>D.checkPublishStatusEnabled=a)};A._updateChildrenView=function(a){const p=this.children;p&&p.forEach(D=>D.view=a)};A._addChildren=function(a){this.handles.remove("child-list-mode");this.children.removeAll();if(a){a.forEach(D=>{this.handles.add(B.watch(()=>D.listMode,()=>this._addChildren(a)),"child-list-mode")});var p=a.filter(D=>"hide"!==r.findLayerListMode(D));this.children.addMany(this._makeChildren(p))}};
A._watchSublayerChanges=function(a){a&&this.handles.add(a.on("change",()=>{this._addChildren(a)}),"layer")};A._initializeChildLayers=function(a){this._addChildren(a);this._watchSublayerChanges(a)};A._makeChildren=function(a){return a.map(p=>r.canDisplayLayer(p)?new Q({layer:p,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).filter(N.isSome).reverse()};A._watchLayerProperties=function(a){if(this.handles&&
(this.handles.remove("layer"),this.handles.remove("child-list-mode"),a))if(this.handles.add(B.watch(()=>a.listMode,()=>this._watchLayerProperties(a)),"layer"),"hide-children"===r.findLayerListMode(a))this.children.removeAll();else{var p=r.getNormalizedChildLayerProperty(a);p&&this.handles.add(B.watch(()=>a[p],()=>{a.hasOwnProperty(p)&&this._initializeChildLayers(a[p])},B.initial),"layer")}};A._getLayerView=async function(){const {layer:a,view:p}=this;if(a&&p)try{const D=await p.whenLayerView(a);D.layer===
this.layer&&this._set("layerView",D)}catch{}};e._createClass(b,[{key:"connectionStatus",get:function(){const {layerView:a,publishing:p}=this;if(!p&&a&&"connectionStatus"in a)return a.connectionStatus}},{key:"error",get:function(){return this.layer?.loadError}},{key:"incompatible",get:function(){const {layerView:a}=this;return a&&"spatialReferenceSupported"in a?!a.spatialReferenceSupported:!1}},{key:"title",get:function(){const a=this.get("layer.layer");return(!a||a&&this.get("layer.layer.loaded"))&&
this.get("layer.title")||this.get("layer.attributes.title")||""},set:function(a){this._override("title",a)}},{key:"publishing",get:function(){const {layer:a,checkPublishStatusEnabled:p}=this;return p&&a&&"publishingInfo"in a&&"publishing"===a.publishingInfo?.status}},{key:"updating",get:function(){const {layerView:a,connectionStatus:p,layer:D,publishing:P}=this;return P||p?!1:a?a.updating:"loading"===D?.loadStatus||!1}},{key:"visible",get:function(){return this.layer?.visible},set:function(a){const p=
this.layer;p&&(p.visible=a)}},{key:"visibleAtCurrentScale",get:function(){return!r.isLayerOutsideScaleRange(this.layer,this.get("view.scale"))}},{key:"visibilityMode",get:function(){return r.findLayerVisibilityMode(this.layer)}}]);return b}(L.IdentifiableMixin(x.HandleOwnerMixin(g)));l.__decorate([t.property({type:O})],g.prototype,"actionsSections",void 0);l.__decorate([t.property()],g.prototype,"actionsOpen",void 0);l.__decorate([t.property()],g.prototype,"checkPublishStatusEnabled",void 0);l.__decorate([t.property({type:w})],
g.prototype,"children",void 0);l.__decorate([t.property()],g.prototype,"childrenSortable",void 0);l.__decorate([t.property({readOnly:!0})],g.prototype,"connectionStatus",null);l.__decorate([t.property({readOnly:!0})],g.prototype,"error",null);l.__decorate([t.property()],g.prototype,"hidden",void 0);l.__decorate([t.property({readOnly:!0})],g.prototype,"incompatible",null);l.__decorate([t.property()],g.prototype,"layer",void 0);l.__decorate([t.property({readOnly:!0})],g.prototype,"layerView",void 0);
l.__decorate([t.property()],g.prototype,"listItemCreatedFunction",void 0);l.__decorate([t.property()],g.prototype,"open",void 0);l.__decorate([t.property({type:y})],g.prototype,"panel",void 0);l.__decorate([f.cast("panel")],g.prototype,"castPanel",null);l.__decorate([t.property()],g.prototype,"parent",void 0);l.__decorate([t.property()],g.prototype,"sortable",void 0);l.__decorate([t.property()],g.prototype,"title",null);l.__decorate([t.property({readOnly:!0})],g.prototype,"publishing",null);l.__decorate([t.property({readOnly:!0})],
g.prototype,"updating",null);l.__decorate([t.property()],g.prototype,"view",void 0);l.__decorate([t.property()],g.prototype,"visible",null);l.__decorate([t.property({readOnly:!0})],g.prototype,"visibleAtCurrentScale",null);l.__decorate([t.property({readOnly:!0})],g.prototype,"visibilityMode",null);return g=Q=l.__decorate([n.subclass("esri.widgets.LayerList.ListItem")],g)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(e,l,g,w,x,L,N,B){var t;w=t=function(f){function d(n){n=h.call(this,n);n.displayValueEnabled=!1;n.max=1;n.min=0;n.step=.1;n.type="slider";n.value=null;return n}e._inherits(d,f);var h=e._createSuper(d);d.prototype.clone=function(){return new t({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})};return e._createClass(d)}(B);
l.__decorate([g.property()],w.prototype,"displayValueEnabled",void 0);l.__decorate([g.property()],w.prototype,"max",void 0);l.__decorate([g.property()],w.prototype,"min",void 0);l.__decorate([g.property()],w.prototype,"step",void 0);l.__decorate([g.property()],w.prototype,"value",void 0);return w=t=l.__decorate([N.subclass("esri.support.Action.ActionSlider")],w)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z,k){w=function(E){function v(r,Q){r=y.call(this,r,Q);r._legend=null;r.content=null;r.image=null;r.listItem=null;r.open=!1;r.visible=!0;return r}l._inherits(v,E);var y=l._createSuper(v);E=v.prototype;E.initialize=function(){this.addHandles(L.watch(()=>this.content,r=>this._createLegend(r),L.initial))};E.destroy=function(){this._legend=x.destroyMaybe(this._legend)};E.render=function(){return k.tsx("div",{class:"esri-layer-list-panel"},this._renderContents())};E._renderContent=
function(r){const {_legend:Q,disabled:O}=this;return!r||O?null:"legend"===r&&Q?k.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--legend"),key:Q},Q.render()):"string"===typeof r?k.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--string"),key:r,innerHTML:r}):z.isWidget(r)?k.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--widget"),key:r},r.render()):r instanceof
HTMLElement?k.tsx("div",{class:this.classes("esri-layer-list-panel__content","esri-layer-list-panel__content--html-element"),key:r,bind:r,afterCreate:this._attachToNode}):null};E._renderContents=function(){const {content:r}=this;return Array.isArray(r)?r.map(Q=>this._renderContent(Q)):this._renderContent(r)};E._getLegendOptions=function(){const {listItem:r}=this;if(!r)return{};const {layer:Q,view:O}=r;return Q&&O?{view:O,layerInfos:[n.getLegendLayerInfo(Q)]}:{}};E._createLegend=async function(r){if(this._hasLegend(r)&&
!this._legend){({default:r}=await new Promise((A,b)=>e(["../Legend"],c=>A(Object.freeze(Object.defineProperty({__proto__:null,default:c},Symbol.toStringTag,{value:"Module"}))),b)));var {listItem:Q}=this,O=new r(this._getLegendOptions());this._legend=O;this.notifyChange("className");this.notifyChange("title");r=L.watch(()=>[Q?.view,Q?.layer,Q?.layer?.source,Q?.layer?.parent],()=>this._updateLegend(O),L.initial);this.addHandles(r,"legends");this.scheduleRender()}};E._hasLegend=function(r){return"legend"===
r?!0:null!=r&&(Array.isArray(r)?r.includes("legend"):!1)};E._attachToNode=function(r){r.appendChild(this)};E._updateLegend=function(r){r.set(this._getLegendOptions());this.scheduleRender()};E._getWidget=function(r){return"legend"===r?this._legend:z.isWidget(r)?r:null};E._getFirstWidget=function(){const {content:r}=this;if(Array.isArray(r)){let Q=null;r.some(O=>{(O=this._getWidget(O))&&(Q=O);return!!O});return Q}return this._getWidget(r)};l._createClass(v,[{key:"className",get:function(){const {image:r}=
this,Q=this._getFirstWidget();return this._get("className")||(!r&&Q?Q.iconClass:"")},set:function(r){this._override("className",r)}},{key:"disabled",get:function(){const {listItem:r,_legend:Q,content:O}=this;return r?Array.isArray(O)&&1<O.length?!1:Q?!Q.activeLayerInfos?.length||!r.visibleAtCurrentScale:!1:!0},set:function(r){this._overrideIfSome("disabled",r)}},{key:"title",get:function(){const r=this._getFirstWidget();return this._get("title")||(r?.label??"")},set:function(r){this._override("title",
r)}}]);return v}(w.IdentifiableMixin(h));g.__decorate([N.property()],w.prototype,"_legend",void 0);g.__decorate([N.property()],w.prototype,"className",null);g.__decorate([N.property()],w.prototype,"content",void 0);g.__decorate([N.property()],w.prototype,"disabled",null);g.__decorate([N.property()],w.prototype,"image",void 0);g.__decorate([N.property()],w.prototype,"listItem",void 0);g.__decorate([N.property()],w.prototype,"title",null);g.__decorate([N.property()],w.prototype,"open",void 0);g.__decorate([N.property()],
w.prototype,"visible",void 0);return w=g.__decorate([d.subclass("esri.widgets.LayerList.ListItemPanel")],w)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports","../../../core/maybe","../../LayerList/support/layerListUtils"],function(e,l,g){const w=N=>x(N)||L(N),x=N=>{if(!("type"in N))return!1;switch(N.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":return!0;
default:return!1}},L=N=>{const B=g.getNormalizedChildLayerProperty(N);if(null!=B&&N.hasOwnProperty(B)&&l.isSome(N[B]))for(const t of N[B])if(w(t))return!0;return!1};e.isValidSnappingLayer=w;e.isValidSnappingLayerGroup=L;e.isValidSnappingLayerSource=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n){var z;e.SnappingListItem=z=function(k){function E(y){y=v.call(this,y);y.children=new w;y.parent=null;return y}l._inherits(E,k);var v=l._createSuper(E);k=E.prototype;k._initializeChildLayers=function(y){y&&(y=y.filter(n.isValidSnappingLayer),l._get(l._getPrototypeOf(E.prototype),"_initializeChildLayers",this).call(this,y))};k._makeChildren=function(y){return y.map(r=>h.canDisplayLayer(r)?new z({layer:r,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):
null).filter(x.isSome).reverse()};l._createClass(E,[{key:"enabled",get:function(){return x.isSome(this.featureSource)?this.featureSource.enabled:!1}},{key:"featureSource",get:function(){const {layer:y,getFeatureSnappingSources:r}=this;return r().find(Q=>Q.layer===y)}}]);return E}(d);g.__decorate([L.property()],e.SnappingListItem.prototype,"children",void 0);g.__decorate([L.property()],e.SnappingListItem.prototype,"enabled",null);g.__decorate([L.property({constructOnly:!0})],e.SnappingListItem.prototype,
"getFeatureSnappingSources",void 0);g.__decorate([L.property()],e.SnappingListItem.prototype,"featureSource",null);g.__decorate([L.property()],e.SnappingListItem.prototype,"parent",void 0);e.SnappingListItem=z=g.__decorate([f.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],e.SnappingListItem);Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls/SketchTooltipControls":function(){define("require exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ../componentsUtils ../widgetUtils ../decorators/messageBundle ../jsxFactory".split(" "),
function(e,l,g,w,x,L,N,B,t,f,d,h,n,z){l.SketchTooltipControls=function(k){function E(y){var r=v.call(this,y);r.viewModel=null;r.iconClass="esri-icon-gear";r._onEnabledChange=Q=>{r.tooltipOptions.enabled=Q.target.checked};return r}g._inherits(E,k);var v=g._createSuper(E);k=E.prototype;k.loadDependencies=function(){return d.loadCalciteComponents({block:()=>new Promise((y,r)=>e(["../../../chunks/calcite-block"],y,r)),label:()=>new Promise((y,r)=>e(["../../../chunks/calcite-label"],y,r)),switch:()=>new Promise((y,
r)=>e(["../../../chunks/calcite-switch"],y,r))})};k.render=function(){return z.tsx("div",{class:"esri-sketch-tooltip-controls"},z.tsx("calcite-block",{heading:"",open:!0},z.tsx("calcite-label",{layout:"inline-space-between"},this.messages?.enabledToggle,z.tsx("calcite-switch",{checked:this.tooltipOptions.enabled,onCalciteSwitchChange:this._onEnabledChange}))))};g._createClass(E,[{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(y){this._overrideIfSome("label",y)}}]);
return E}(f);w.__decorate([x.property()],l.SketchTooltipControls.prototype,"viewModel",void 0);w.__decorate([x.property()],l.SketchTooltipControls.prototype,"iconClass",void 0);w.__decorate([x.property()],l.SketchTooltipControls.prototype,"label",null);w.__decorate([x.property(),n.messageBundle("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],l.SketchTooltipControls.prototype,"messages",void 0);w.__decorate([x.property()],l.SketchTooltipControls.prototype,"tooltipOptions",
void 0);l.SketchTooltipControls=w.__decorate([t.subclass("esri.widgets.Editor.components.SketchTooltipControls")],l.SketchTooltipControls);Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/HandleOwner ../core/Logger ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ../layers/support/fieldUtils ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/deprecationUtils ./Editor/EditorViewModel ./FeatureTemplates/ItemList ./support/componentsUtils ./support/Heading ./support/SnappingControls ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./support/widgetUtils ./support/SketchTooltipControls/SketchTooltipControls ../intl/substitute".split(" "),function(e,
l,g,w,x,L,N,B,t,f,d,h,n,z,k,E,v,y,r,Q,O,A,b,c,a,p,D,P,m,I,H,S,F){function T(u){u.focus()}const M={undoRedoButtons:!1,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},sketchTooltipControls:!0},J=L.getLogger("esri.widgets.Editor");w=function(u){function C(R,V){var X=K.call(this,R,V);X._featureForm=new v;X._attachments=new E({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,
errorMessage:!1,progressBar:!1,updateButton:!1}});X._featureTemplates=new y({enableListScroll:!1});X._filterText="";X._prompt=null;X._spinner=new r;X.useDeprecatedCreateWorkflow=!1;X.headingLevel=4;X.iconClass="esri-icon-edit";X.messages=null;X.messagesCommon=null;X.messagesTemplates=null;X.supportingWidgetDefaults=null;X.viewModel=new A;X.visibleElements={...M};X.EditorPanel=({handleBack:ba,heading:ea,headingLevel:Y,key:ca},...da)=>{const {messagesCommon:ja,viewModel:pa,visibleElements:sa}=l._assertThisInitialized(X),
xa=pa.sketchViewModel;return I.tsx("calcite-flow-item",{closable:!1,heading:ea,headingLevel:Y,key:ca,loading:pa.syncing||X._attachments.submitting,onCalciteFlowItemBack:ba??void 0},I.tsx("div",{key:"panel-toolbar",class:"esri-editor__panel-toolbar"},X._renderSettings(),sa.undoRedoButtons&&[I.tsx("calcite-button",{key:"undo-button",label:ja.undo,appearance:"transparent",kind:"neutral",alignment:"center",iconStart:"undo",scale:"l",disabled:!xa.canUndo(),onclick:xa.undo.bind(xa)},ja.undo),I.tsx("calcite-button",
{key:"redo-button",label:ja.redo,appearance:"transparent",kind:"neutral",alignment:"center",iconStart:"redo",scale:"l",disabled:!xa.canRedo(),onclick:xa.redo.bind(xa)},ja.redo)]),...da)};X._showDiscardWarning=()=>{const {messages:ba}=l._assertThisInitialized(X),ea="create"===X.activeWorkflow?.type,Y=B.createDeferred();X._prompt={title:ba[ea?"cancelAddTitle":"cancelEditTitle"],message:ba[ea?"cancelAddWarningMessage":"cancelEditWarningMessage"],context:"danger",actions:{primary:{label:ba[ea?"discardFeature":
"discardEdits"],action:()=>{Y.resolve();X._clearPrompt()}},secondary:{label:ba[ea?"continueAdding":"continueEditing"],action:()=>{Y.reject();X._clearPrompt()}}}};return Y.promise};X._onAttachmentDeleteConfirm=async()=>{const ba=X._attachments,{activeWorkflow:ea}=X.viewModel;ea&&("create-features"===ea.type?ba.deleteFile():(await ba.deleteAttachment(ba.viewModel.activeAttachmentInfo),X._clearPrompt()),await ea.previous(),X._clearPrompt())};X._onAttachmentsError=ba=>{X._prompt={title:X.messages.errorWarningTitle,
message:ba.message,context:"warning",actions:{primary:{label:X.messagesCommon.form.ok,action:X._clearPrompt}}}};X._clearPrompt=()=>{X._prompt=null};X._onBack=X._onBack.bind(l._assertThisInitialized(X));X._onSave=X._onSave.bind(l._assertThisInitialized(X));X._onDelete=X._onDelete.bind(l._assertThisInitialized(X));X._onToggleUpdateWorkflow=X._onToggleUpdateWorkflow.bind(l._assertThisInitialized(X));X._onAttachmentAdd=X._onAttachmentAdd.bind(l._assertThisInitialized(X));X._onAttachmentUpdate=X._onAttachmentUpdate.bind(l._assertThisInitialized(X));
X._onAttachmentDelete=X._onAttachmentDelete.bind(l._assertThisInitialized(X));return X}l._inherits(C,u);var K=l._createSuper(C);u=C.prototype;u.initialize=function(){const R=()=>this.scheduleRender();this.addHandles([t.watch(()=>a.incrementHeadingLevel(this.headingLevel),V=>{this._featureForm.headingLevel=V;this._featureTemplates.headingLevel=V},t.initial),t.on(()=>this.viewModel.featureTemplatesViewModel,"select",async({item:V,oldItem:X})=>{this.viewModel.activeWorkflow&&await this.viewModel.cancelWorkflow();
V&&V.id!==X?.id&&(this.useDeprecatedCreateWorkflow?this.startCreateWorkflowAtFeatureCreation(V):this.startCreateFeaturesWorkflowAtFeatureCreation(V))}),t.watch(()=>this.viewModel.selectedTemplateItem,V=>this._featureTemplates.select(V,!1)),t.on(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:V})=>{const {messages:X,messagesCommon:ba}=this;this._prompt={title:X.cancelRequestTitle,message:X.cancelRequestWarningMessage,context:"danger",actions:{primary:{label:ba.form.yes,action:()=>{V.allow();
this._clearPrompt()}},secondary:{label:ba.form.no,action:()=>{V.deny();this._clearPrompt()}}}}}),t.watch(()=>this.viewModel,V=>{this._featureForm.viewModel=V?.featureFormViewModel??null;this._attachments.viewModel=V?.attachmentsViewModel??null;this._featureTemplates.viewModel=V?.featureTemplatesViewModel??null;this._spinner.viewModel=V?.spinnerViewModel??null;V.showDiscardPrompt=this._showDiscardWarning},t.initial),t.watch(()=>this.view,(V,X)=>{const ba=`editor-${this.id}-spinner`;X?.ui.remove(this._spinner,
ba);V?.ui.add(this._spinner,{key:ba,position:"manual"})},t.initial),t.on(()=>this.viewModel?.sketchViewModel,"create",R),t.when(()=>this.supportingWidgetDefaults,V=>{this._featureForm.set(V.featureForm);this._attachments.set(V.attachments);this._featureTemplates.set(V.featureTemplates);this.viewModel.sketchViewModel.set(V.sketch)},t.initial),t.when(()=>this._attachments?.error,V=>this._onAttachmentsError(V)),t.when(()=>this.viewModel?.failures,V=>{const {messages:X}=this,[{error:ba,retry:ea,cancel:Y}]=
V;this._prompt={title:X.errorWarningTitle,message:F.substitute(X.errorWarningMessageTemplate,{errorMessage:ba.message}),context:"warning",actions:{primary:{label:X.retry,action:()=>{ea();this._clearPrompt()}},secondary:{label:X.ignore,action:()=>{Y();this._clearPrompt()}}}}}),t.watch(()=>this.viewModel?.state,V=>{switch(V){case "awaiting-feature-to-update":case "ready":case "disabled":this._filterText="",this._featureTemplates.filterText=""}}),t.watch(()=>[this._attachments?.selectedFile,this._attachments?.submitting],
R),t.watch(()=>this.viewModel.featureFormDisabled,V=>this._featureForm.disabled=V),t.on(()=>this.view,"key-down",V=>{"Escape"===V.key&&this.viewModel.back()})])};u.destroy=function(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()};u.loadDependencies=function(){return c.loadCalciteComponents({accordion:()=>new Promise((R,V)=>e(["../chunks/calcite-accordion"],R,V)),"accordion-item":()=>new Promise((R,V)=>e(["../chunks/calcite-accordion-item"],R,V)),button:()=>
new Promise((R,V)=>e(["../chunks/calcite-button"],R,V)),flow:()=>new Promise((R,V)=>e(["../chunks/calcite-flow"],R,V)),"flow-item":()=>new Promise((R,V)=>e(["../chunks/calcite-flow-item"],R,V)),icon:()=>new Promise((R,V)=>e(["../chunks/calcite-icon"],R,V)),list:()=>new Promise((R,V)=>e(["../chunks/calcite-list"],R,V)),"list-item":()=>new Promise((R,V)=>e(["../chunks/calcite-list-item"],R,V)),notice:()=>new Promise((R,V)=>e(["../chunks/calcite-notice"],R,V)),scrim:()=>new Promise((R,V)=>e(["../chunks/calcite-scrim"],
R,V))})};u.castVisibleElements=function(R){return{...M,...R,snappingControlsElements:{...M.snappingControlsElements,...R?.snappingControlsElements}}};u.startCreateWorkflowAtFeatureTypeSelection=function(){O.workflowDeprecation(J,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection");return this.viewModel.startCreateWorkflowAtFeatureTypeSelection()};u.startCreateFeaturesWorkflowAtFeatureTypeSelection=function(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()};
u.startCreateWorkflowAtFeatureCreation=function(R){O.workflowDeprecation(J,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation");return this.viewModel.startCreateWorkflowAtFeatureCreation(R)};u.startCreateFeaturesWorkflowAtFeatureCreation=function(R){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(R)};u.startCreateWorkflowAtFeatureEdit=function(R){O.workflowDeprecation(J,"startCreateWorkflowAtFeatureEdit");return this.viewModel.startCreateWorkflowAtFeatureEdit(R)};
u.startUpdateWorkflowAtFeatureSelection=function(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()};u.startUpdateWorkflowAtMultipleFeatureSelection=function(R){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(R)};u.startUpdateWorkflowAtFeatureEdit=function(R){return this.viewModel.startUpdateWorkflowAtFeatureEdit(R)};u.deleteFeatureFromWorkflow=function(){return this.viewModel.deleteFeatureFromWorkflow()};u.cancelWorkflow=function(R){return this.viewModel.cancelWorkflow(R)};
u.render=function(){const {viewModel:R}=this;if(!R)return I.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"});const {state:V}=R;return I.tsx("div",{class:"esri-editor esri-widget esri-widget--panel"},I.tsx("calcite-flow",null,R.pageStack.map(X=>this._renderPage(X,V)),this._renderPage(R.page,V)),this._renderPrompt())};u._renderPage=function(R,V){switch(R){case "ready":return this._renderLanding(V);case "awaiting-feature-creation-info":return this._renderTemplates(V);case "creating-features":return this._renderAttributeEditing(V);
case "editing-new-feature":case "editing-existing-feature":return this._renderAttributeEditing(V);case "awaiting-update-feature-candidate":return this._renderFeatureList(V);case "adding-attachment":return this._renderAttachmentAdding(V);case "editing-attachment":return this._renderAttachmentEditing(V)}return I.tsx("div",null)};u._renderTemplates=function(R){const {EditorPanel:V,headingLevel:X,messages:ba,_onBack:ea}=this;return I.tsx(V,{active:this._isPanelActive(R),key:"templates-panel",handleBack:ea,
heading:ba.selectTemplate,headingLevel:X},I.tsx("div",{class:"esri-editor__panel-content"},this._featureTemplates.render()))};u._renderAttributeEditing=function(R){const {activeWorkflow:V,EditorPanel:X,messages:ba,messagesCommon:ea,headingLevel:Y,_onBack:ca,viewModel:da}=this;if(!V)return null;var ja=V.type,pa=da.featureFormViewModel;const sa="update"===ja&&!V.data.edits.modified||da.syncing||pa.updating,xa="update"===ja?ba.editFeature:ba.createFeatures,ya="update"===ja?ea.update:ea.create,oa="create-features"===
ja&&"create-new"===V.createFeatureState;ja="create-features"===ja?V.numPendingFeatures:0;ja=1<ja?F.substitute(ba.createFeaturesTemplate,{numFeatures:ja}):ya;const za=V.shouldShowAttachments;pa=pa.inputFields.every(Ga=>!Ga.visible)&&!za?this._renderMessage(F.substitute(ba.clickToFinishTemplate,{button:ya})):I.tsx("div",{key:"panel-content-section",class:"esri-editor__panel-content__section"},this._renderOwnerAdminNoticeIfApplicable(V),I.tsx("div",{class:"esri-editor__panel-content__section__group"},
this._featureForm.render(),za&&I.tsx("div",{key:"attachments"},I.tsx(a.Heading,{level:a.incrementHeadingLevel(Y)},ba.attachments),this._attachments.render())));return I.tsx(X,{active:this._isPanelActive(R),key:"attribute-editing-panel",heading:xa,headingLevel:Y,handleBack:ca},I.tsx("div",{key:"panel-content",class:this.classes("esri-editor__panel-content",{["esri-editor__panel-content__scrim-container"]:oa})},pa,oa&&I.tsx("calcite-scrim",null)),this._renderFooterActions([{clickHandler:this._onSave,
disabled:sa,label:ja,type:"primary"},da.shouldShowDeleteButton?{...this._deleteButtonCommonInfo,clickHandler:this._onDelete,disabled:da.syncing,label:ea.delete}:null]))};u._renderOwnerAdminNoticeIfApplicable=function(R){if(R?.reliesOnOwnerAdminPrivileges)return I.tsx("calcite-notice",{open:!0,kind:"info",scale:"s",class:"esri-editor__owner-admin-notice"},I.tsx("div",{slot:"message"},this.messages.ownerAdminNotice))};u._renderAttachmentAdding=function(R){const {_attachments:V,EditorPanel:X,_onBack:ba,
headingLevel:ea,messages:Y,messagesCommon:ca}=this;return I.tsx(X,{active:this._isPanelActive(R),key:"attachment-adding-panel",heading:Y.addAttachment,headingLevel:ea,handleBack:ba},I.tsx("div",{class:"esri-editor__panel-content"},V.render()),this._renderFooterActions([{label:V.submitting?ca.cancel:ca.add,disabled:V.submitting||!V.selectedFile,type:"primary",clickHandler:this._onAttachmentAdd}]))};u._renderAttachmentEditing=function(R){const {_attachments:V,EditorPanel:X,_onBack:ba,activeWorkflow:ea,
headingLevel:Y,messages:ca,messagesCommon:da}=this;return ea?I.tsx(X,{active:this._isPanelActive(R),key:"attachment-editing-panel",heading:ca.editAttachment,headingLevel:Y,handleBack:ba},I.tsx("div",{class:"esri-editor__panel-content"},V.render()),ea.shouldAllowAttachmentEditing?this._renderFooterActions([{label:da.update,disabled:V.submitting||!V.selectedFile,type:"primary",clickHandler:this._onAttachmentUpdate},{...this._deleteButtonCommonInfo,clickHandler:this._onAttachmentDelete,disabled:V.submitting,
label:da.delete}]):void 0):null};u._renderMessage=function(R){return I.tsx("div",{key:"panel-content-message",class:"esri-editor__panel-content__message"},R)};u._renderFooterActions=function(R){return I.tsx("div",{key:"footer-actions",slot:"footer",class:"esri-editor__actions"},R.filter(N.isSome).map(({type:V,disabled:X,class:ba,clickHandler:ea,label:Y,...ca},da)=>I.tsx("calcite-button",{key:`action-${da}`,slot:"footer-actions",class:ba,disabled:X??!1,onclick:ea,width:"full",...ca},Y)))};u._renderPrompt=
function(){var R=this._prompt;if(!R)return null;const {title:V,message:X,context:ba,actions:ea}=R;var Y=ea.secondary;let ca;switch(ba){case "danger":ca="danger";break;case "info":ca="brand";break;default:ca="neutral"}R=I.tsx("calcite-button",{afterCreate:T,appearance:"solid",key:"prompt-primary-button",kind:ca,onclick:ea.primary.action,scale:"m",width:Y?"half":"full"},ea.primary.label);Y=Y&&I.tsx("calcite-button",{appearance:"outline",key:"prompt-secondary-button",kind:ca,onclick:Y.action,scale:"m",
width:"half"},Y.label);return I.tsx("calcite-scrim",null,I.tsx("div",{class:`${"esri-editor__prompt"}--${ba}`},I.tsx("div",{class:"esri-editor__prompt__header"},I.tsx("calcite-icon",{icon:"exclamation-mark-triangle"}),I.tsx(a.Heading,{class:"esri-editor__prompt__header__heading",level:this.headingLevel},V)),I.tsx("div",{class:"esri-editor__prompt__message"},X),I.tsx("div",{class:"esri-editor__prompt__divider"}),I.tsx("div",{class:"esri-editor__prompt__actions"},Y,R)))};u._renderLanding=function(R){const {EditorPanel:V,
headingLevel:X,messages:ba,viewModel:ea}=this,{canUpdate:Y}=ea,ca=this._featureTemplates.viewModel.numberOfFeatureTemplates,da=!Y&&0===ca;return I.tsx(V,{active:this._isPanelActive(R),key:"landing-panel",heading:ba.widgetLabel,headingLevel:X},I.tsx("div",{class:"esri-editor__panel-content"},Y&&I.tsx("div",{key:"edit-actions",class:"esri-editor__panel-content__section"},this._renderUpdateActions(R)),0<ca&&I.tsx("div",{key:"create-actions",class:"esri-editor__panel-content__section"},this._renderCreateActions()),
da&&I.tsx("div",{key:"no-content",class:"esri-editor__panel-content__message"},ba.noEditableLayers)),this._renderFooterHelpMessages())};u._renderFooterHelpMessages=function(){const {activeWorkflow:R,messages:V,view:X}=this;var ba=R?.helpMessage;return(ba=ba?V["3d"===X?.type?"helpMessages3d":"helpMessages2d"]?.[ba]:null)?I.tsx("div",{key:"footer-actions",slot:"footer",class:"esri-editor__help-message"},ba):null};u._renderUpdateActions=function(R){const {messages:V,messagesCommon:X}=this;return I.tsx("div",
{key:"update-actions"},I.tsx(a.Heading,{level:a.incrementHeadingLevel(this.headingLevel)},V.editFeatures),I.tsx("calcite-list",{selectionMode:"single",selectionAppearance:"border"},I.tsx("calcite-list-item",{selected:"awaiting-feature-to-update"===R,label:X.select,onCalciteListItemSelect:this._onToggleUpdateWorkflow},I.tsx("calcite-icon",{icon:"cursor",slot:"content-start"}))))};u._renderCreateActions=function(){const {_featureTemplates:R,headingLevel:V,messages:X}=this;return I.tsx("div",{key:"create-actions"},
I.tsx(a.Heading,{level:a.incrementHeadingLevel(V)},X.createFeatures),I.tsx("div",{key:"templates",class:"esri-editor__feature-templates-container"},R.render()))};u._renderFeatureList=function(R){const {EditorPanel:V,_onBack:X,headingLevel:ba,messages:ea,messagesTemplates:Y,viewModel:{activeWorkflow:ca,editableItems:da}}=this;if("update"!==ca?.type)return null;var ja=ca.data.candidates;const pa=F.substitute(ea.multipleFeaturesTemplate,{total:ja.length}),sa=new Map;let xa=0;ja.map(oa=>({label:this._getLabel(oa),
id:oa.attributes[oa.layer.objectIdField],data:oa})).filter(oa=>{const {label:za,data:Ga}=oa;oa=this._filterText.toLowerCase();const {title:aa}=Ga.layer,ha=da.find(ma=>ma.layer===Ga.layer);if(!ha)return null;const {attachmentsOnUpdateEnabled:ia,supports:fa}=ha;return(fa.includes("update")||fa.includes("delete")||ia)&&(!oa||za?.toLowerCase().includes(oa)||aa?.toLowerCase().includes(oa))}).filter(N.isSome).forEach(oa=>{xa++;const za=oa.data.layer;sa.has(za)?sa.get(za)?.items.push(oa):sa.set(za,{id:`${za.id}`,
label:za.title??"",items:[oa]})});ja=da.toArray().map(({layer:oa})=>sa.get(oa)).filter(N.isSome);const ya=10<xa||0<this._filterText.length;return I.tsx(V,{active:this._isPanelActive(R),key:"feature-list",heading:pa,headingLevel:ba,handleBack:X},I.tsx("div",{class:"esri-editor__panel-content"},I.tsx("div",{class:"esri-editor__panel-content__section"},b.ItemList({id:this.id,enableListScroll:!1,filterEnabled:ya,filterText:this._filterText,items:ja,messages:{filterPlaceholder:Y.filterPlaceholder,noItems:Y.noItems,
noMatches:Y.noMatches},onItemMouseEnter:oa=>this.viewModel.selectFeature(oa.data),onItemMouseLeave:()=>this.viewModel.selectFeature(null),onItemSelect:oa=>this.viewModel.selectFeature(oa.data,!0),onFilterChange:oa=>this._filterText=oa}))))};u._isPanelActive=function(R){return this.viewModel.state===R};u._renderSettings=function(){const R=this.visibleElements,V=R.snappingControls,X=R.sketchTooltipControls;return V||X?I.tsx("calcite-accordion",{class:"esri-editor__settings",appearance:"transparent"},
I.tsx("calcite-accordion-item",{heading:this.messagesCommon?.settings,iconStart:"gear"},X&&I.tsx(S.SketchTooltipControls,{tooltipOptions:this.tooltipOptions}),V&&I.tsx(p,{snappingOptions:this.snappingOptions,view:this.view,visibleElements:R.snappingControlsElements,afterCreate:ba=>ba.layerListOpen=!1}))):null};u._getLabel=function(R){var V=R.layer;if(!V)return null;const {objectIdField:X}=V;({attributes:R}=R);return(V=k.getDisplayFieldName(V))&&R[V]&&`${R[V]}`||F.substitute(this.messages.untitledFeatureTemplate,
{id:R[X]})};u._onSave=function(){this.viewModel.save()};u._onDelete=function(){const {messages:R,messagesCommon:V}=this;this._prompt={title:R.deleteWarningTitle,message:R.deleteWarningMessage,context:"danger",actions:{primary:{label:V.delete,action:()=>{this.deleteFeatureFromWorkflow();this._clearPrompt()}},secondary:{label:R.keepFeature,action:this._clearPrompt}}}};u._onToggleUpdateWorkflow=async function(){const {viewModel:R}=this;R.canUpdate&&(R.activeWorkflow&&"awaiting-feature-to-update"===R.state?
await R.cancelWorkflow():await R.startUpdateWorkflowAtFeatureSelection())};u._onBack=async function(R){R?.stopPropagation();return this.viewModel.back()};u._onAttachmentAdd=function(){const {activeWorkflow:R}=this.viewModel;R&&("create-features"===R.type?(this._attachments.addFile(),R.previous()):this._attachments.addAttachment().then(()=>R.previous()))};u._onAttachmentUpdate=function(){const {activeWorkflow:R}=this.viewModel;R&&("create-features"===R.type?(this._attachments.updateFile(),R.previous()):
this._attachments.updateAttachment().then(()=>R.previous()))};u._onAttachmentDelete=function(){const {messages:R,messagesCommon:V}=this;this._prompt={title:R.deleteAttachmentWarningTitle,message:R.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:V.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:R.keepAttachment,action:this._clearPrompt}}}};l._createClass(C,[{key:"_deleteButtonCommonInfo",get:function(){return{appearance:"outline",kind:"danger",type:"primary"}}},
{key:"activeWorkflow",get:function(){return this.viewModel.activeWorkflow}},{key:"allowedWorkflows",get:function(){return this.viewModel.allowedWorkflows},set:function(R){this.viewModel.allowedWorkflows=R}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(R){this._overrideIfSome("label",R)}},{key:"labelOptions",get:function(){return this.viewModel.labelOptions},set:function(R){this.viewModel.labelOptions=R}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},
set:function(R){this.viewModel.layerInfos=R}},{key:"snappingOptions",get:function(){return this.viewModel.snappingOptions},set:function(R){this.viewModel.snappingOptions=R}},{key:"tooltipOptions",get:function(){return this.viewModel.tooltipOptions},set:function(R){this.viewModel.tooltipOptions=R}},{key:"view",get:function(){return this.viewModel.view},set:function(R){this.viewModel.view=R}}]);return C}(x.HandleOwnerMixin(Q));g.__decorate([f.property()],w.prototype,"_featureForm",void 0);g.__decorate([f.property()],
w.prototype,"_attachments",void 0);g.__decorate([f.property()],w.prototype,"_featureTemplates",void 0);g.__decorate([f.property()],w.prototype,"_filterText",void 0);g.__decorate([f.property()],w.prototype,"_prompt",void 0);g.__decorate([f.property()],w.prototype,"_spinner",void 0);g.__decorate([f.property()],w.prototype,"_deleteButtonCommonInfo",null);g.__decorate([f.property({readOnly:!0})],w.prototype,"activeWorkflow",null);g.__decorate([f.property()],w.prototype,"allowedWorkflows",null);g.__decorate([f.property()],
w.prototype,"useDeprecatedCreateWorkflow",void 0);g.__decorate([f.property()],w.prototype,"headingLevel",void 0);g.__decorate([f.property()],w.prototype,"iconClass",void 0);g.__decorate([f.property()],w.prototype,"label",null);g.__decorate([f.property()],w.prototype,"labelOptions",null);g.__decorate([f.property()],w.prototype,"layerInfos",null);g.__decorate([f.property(),P.messageBundle("esri/widgets/Editor/t9n/Editor")],w.prototype,"messages",void 0);g.__decorate([f.property(),P.messageBundle("esri/t9n/common")],
w.prototype,"messagesCommon",void 0);g.__decorate([f.property(),P.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],w.prototype,"messagesTemplates",void 0);g.__decorate([f.property()],w.prototype,"snappingOptions",null);g.__decorate([f.property()],w.prototype,"tooltipOptions",null);g.__decorate([f.property()],w.prototype,"supportingWidgetDefaults",void 0);g.__decorate([f.property()],w.prototype,"view",null);g.__decorate([f.property(),m.vmEvent(["workflow-cancel","workflow-commit"])],
w.prototype,"viewModel",void 0);g.__decorate([f.property()],w.prototype,"visibleElements",void 0);g.__decorate([d.cast("visibleElements")],w.prototype,"castVisibleElements",null);g.__decorate([D.accessibleHandler()],w.prototype,"_onSave",null);g.__decorate([D.accessibleHandler()],w.prototype,"_onDelete",null);g.__decorate([D.accessibleHandler()],w.prototype,"_onToggleUpdateWorkflow",null);g.__decorate([D.accessibleHandler()],w.prototype,"_onBack",null);g.__decorate([D.accessibleHandler()],w.prototype,
"_onAttachmentAdd",null);g.__decorate([D.accessibleHandler()],w.prototype,"_onAttachmentUpdate",null);g.__decorate([D.accessibleHandler()],w.prototype,"_onAttachmentDelete",null);return w=g.__decorate([z.subclass("esri.widgets.Editor")],w)});