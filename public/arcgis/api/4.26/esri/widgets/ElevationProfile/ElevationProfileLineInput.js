// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/handleUtils ../../core/maybe ../../core/memoize ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/ElevationQuery ../../support/elevationInfoUtils ./ElevationProfileLine".split(" "),function(k,e,t,v,f,w,u,g,c,D,E,x,y,z,A){c=function(m){function h(a){a=
B.call(this,a);a.type="input";a.color=new t("#00c8c8");a.viewVisualizationEnabled=!1;a.numSamplesForPreview=50;a.numSamplesPerChunk=500;a.chartFillEnabled=!1;a.chartStrokeOffsetY=-1;a._getQueryElevationDependencies=w.memoize((b,d,n,p,q)=>f.applySome(b,l=>({elevationInfo:l,visibleLayers:d,view:n,stationary:p,spatialReference:q})));return a}k._inherits(h,m);var B=k._createSuper(h);m=h.prototype;m.queryElevation=async function(a,{noDataValue:b,signal:d}){const n=this.queryElevationDependencies;if(f.isNone(n))throw Error("ElevationProfileLineInput: no dependencies");
const {view:p,elevationInfo:q,spatialReference:l}=n;if("on-the-ground"===q.mode&&"3d"===p.type&&l){d=await y.GeometryDescriptor.fromGeometry(a).project(l,d);if(!d)return{geometry:a,noDataValue:b};const C=p.elevationProvider;d.coordinates.forEach(r=>{r.z=f.unwrapOr(C.getElevation(r.x,r.y,0,l,"ground"),0)});return{geometry:d.export(),noDataValue:b}}return{geometry:a,noDataValue:b}};m.attach=function(a){const b=()=>this._onChange();return v.handlesGroup([k._get(k._getPrototypeOf(h.prototype),"attach",
this).call(this,a),u.watch(()=>this.queryElevationDependencies,b),u.on(()=>a.elevationProvider,"elevation-change",b,{onListenerAdd:b,onListenerRemove:b})])};k._createClass(h,[{key:"queryElevationDependencies",get:function(){const a=this._viewModel?.view;return f.isNone(a)?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,a,a.stationary,a.spatialReference)}},{key:"available",get:function(){return!this._viewModel?.inputIsSketched}},{key:"_elevationInfo",get:function(){return f.applySome(this._viewModel?.input,
z.getGraphicEffectiveElevationInfo)}},{key:"_visibleLayers",get:function(){const a=f.applySome(this._viewModel?.view,b=>b.map?.allLayers?.filter(d=>d.visible).toArray());return f.unwrapOr(a,[])}}]);return h}(A);e.__decorate([g.property({type:t,nonNullable:!0})],c.prototype,"color",void 0);e.__decorate([g.property()],c.prototype,"viewVisualizationEnabled",void 0);e.__decorate([g.property()],c.prototype,"queryElevationDependencies",null);e.__decorate([g.property()],c.prototype,"available",null);e.__decorate([g.property()],
c.prototype,"_elevationInfo",null);e.__decorate([g.property()],c.prototype,"_visibleLayers",null);return c=e.__decorate([x.subclass("esri.widgets.ElevationProfile.ElevationProfileLineInput")],c)});