// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),function(q,
h,m,p,B,D,K,N,M,H,b,a,g,y){B=function(k){function l(t,e){t=z.call(this,t,e);t._featureElementInfo=null;t.attachmentsWidget=new M;t.headingLevel=2;t.viewModel=new b;return t}q._inherits(l,k);var z=q._createSuper(l);k=l.prototype;k.initialize=function(){this._featureElementInfo=new a;this.addHandles([m.watch(()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel],()=>this._setupFeatureElementInfo(),m.initial),m.watch(()=>this.viewModel,t=>this.attachmentsWidget.viewModel=t,m.initial)])};
k.destroy=function(){this.attachmentsWidget.destroy();this._featureElementInfo?.destroy()};k.render=function(){const {attachmentsWidget:t}=this;return y.tsx("div",{class:"esri-feature-attachments"},this._featureElementInfo?.render(),t?.render())};k._setupFeatureElementInfo=function(){const {description:t,title:e,headingLevel:v}=this;this._featureElementInfo?.set({description:t,title:e,headingLevel:v})};q._createClass(l,[{key:"description",get:function(){return this.viewModel.description},set:function(t){this.viewModel.description=
t}},{key:"displayType",get:function(){return this.attachmentsWidget.displayType},set:function(t){this.attachmentsWidget.displayType=t}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(t){this.viewModel.graphic=t}},{key:"title",get:function(){return this.viewModel.title},set:function(t){this.viewModel.title=t}}]);return l}(H);h.__decorate([p.property({readOnly:!0})],B.prototype,"attachmentsWidget",void 0);h.__decorate([p.property()],B.prototype,"description",null);h.__decorate([p.property()],
B.prototype,"displayType",null);h.__decorate([p.property()],B.prototype,"graphic",null);h.__decorate([p.property()],B.prototype,"headingLevel",void 0);h.__decorate([p.property()],B.prototype,"title",null);h.__decorate([p.property({type:b})],B.prototype,"viewModel",void 0);return B=h.__decorate([N.subclass("esri.widgets.Feature.FeatureAttachments")],B)})},"esri/widgets/Attachments":function(){define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Error ../core/maybe ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ./support/componentsUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k,l,z,t,e){const v={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},I=window.CSS;H=function(u){function f(c,n){c=d.call(this,c,n);c.displayType="auto";c.messages=null;c.messagesUnits=null;c.selectedFile=null;c.submitting=!1;c.viewModel=null;c.visibleElements={...v};c._supportsImageOrientation=I&&I.supports&&I.supports("image-orientation","from-image");c._addAttachmentForm=
null;c._updateAttachmentForm=null;return c}h._inherits(f,u);var d=h._createSuper(f);u=f.prototype;u.initialize=function(){this.viewModel||(this.viewModel=new y);this.addHandles([D.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),D.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),D.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),D.initial)])};u.loadDependencies=function(){return l.loadCalciteComponents({icon:()=>new Promise((c,n)=>q(["../chunks/calcite-icon"],
c,n))})};u.castVisibleElements=function(c){return{...v,...c}};u.addAttachment=function(){const {_addAttachmentForm:c,viewModel:n}=this;this._set("submitting",!0);this._set("error",null);return n.addAttachment(c).then(A=>{this._set("submitting",!1);this._set("error",null);n.mode="view";return A}).catch(A=>{this._set("submitting",!1);this._set("error",new p("attachments:add-attachment",this.messages.addErrorMessage,A));throw A;})};u.deleteAttachment=function(c){const {viewModel:n}=this;this._set("submitting",
!0);this._set("error",null);return n.deleteAttachment(c).then(A=>{this._set("submitting",!1);this._set("error",null);n.mode="view";return A}).catch(A=>{this._set("submitting",!1);this._set("error",new p("attachments:delete-attachment",this.messages.deleteErrorMessage,A));throw A;})};u.updateAttachment=function(){const {viewModel:c}=this,{_updateAttachmentForm:n}=this;this._set("submitting",!0);this._set("error",null);return c.updateAttachment(n).then(A=>{this._set("submitting",!1);this._set("error",
null);c.mode="view";return A}).catch(A=>{this._set("submitting",!1);this._set("error",new p("attachments:update-attachment",this.messages.updateErrorMessage,A));throw A;})};u.addFile=function(){const c=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);this.viewModel.mode="view";return c};u.updateFile=function(){const {viewModel:c}=this,n=c.updateFile(this.selectedFile,this._updateAttachmentForm,c.activeFileInfo);c.mode="view";return n};u.deleteFile=function(c){c=this.viewModel.deleteFile(c||
this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return c};u.render=function(){const {submitting:c,viewModel:n}=this,{state:A}=n;return e.tsx("div",{class:this.classes("esri-attachments","esri-widget")},c?this.renderProgressBar():null,"loading"===A?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())};u.renderErrorMessage=function(){const {error:c,visibleElements:n}=this;return c&&n.errorMessage?e.tsx("div",{key:"error-message",class:"esri-attachments__error-message"},
c.message):null};u.renderAttachments=function(){const {activeFileInfo:c,mode:n,activeAttachmentInfo:A}=this.viewModel;return"add"===n?this.renderAddForm():"edit"===n?this.renderDetailsForm(A||c):this.renderAttachmentContainer()};u.renderLoading=function(){return e.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},e.tsx("div",{class:"esri-attachments__loader"}))};u.renderProgressBar=function(){return this.visibleElements.progressBar?e.tsx("div",{class:"esri-attachments__progress-bar",
key:"progress-bar"}):null};u.renderAddForm=function(){const {submitting:c,selectedFile:n}=this;var A=c||!n,L=this.visibleElements.cancelAddButton?e.tsx("button",{type:"button",bind:this,disabled:c,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",c&&"esri-button--disabled")},this.messages.cancel):null;A=this.visibleElements.addSubmitButton?e.tsx("button",{type:"submit",disabled:A,class:this.classes("esri-button","esri-button--secondary",
"esri-button--small","esri-button--half",{["esri-button--disabled"]:A})},this.messages.add):null;const F=n?e.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},n.name):null;L=e.tsx("form",{bind:this,afterCreate:z.storeNode,afterRemoved:z.discardNode,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},e.tsx("fieldset",{class:"esri-attachments__file-fieldset"},F,e.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},
n?this.messages.changeFile:this.messages.selectFile,e.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),A,L);return e.tsx("div",{key:"add-form-container",class:"esri-attachments__form-node"},L)};u.renderDetailsForm=function(c){const {visibleElements:n,viewModel:A,selectedFile:L,submitting:F}=this;var {abilities:x}=A,R=F||!L;let G;if(L){var r=L.type;G=L.name;var C=L.size}else if(c&&"file"in c)r=c.file.type,G=c.file.name,
C=c.file.size;else if(c&&"contentType"in c){r=c.contentType;G=c.name;C=c.size;var O=c.url}var P=x.editing&&x.operations?.delete&&n.deleteButton?e.tsx("button",{key:"delete-button",type:"button",disabled:F,bind:this,onclick:W=>this._submitDeleteAttachment(W,c),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",{["esri-button--disabled"]:F})},this.messages.delete):void 0;R=x.editing&&x.operations?.update&&n.updateButton?e.tsx("button",{disabled:R,
key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",{["esri-button--disabled"]:R})},this.messages.update):void 0;const S=this.visibleElements.cancelUpdateButton?e.tsx("button",{disabled:F,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",{["esri-button--disabled"]:F})},this.messages.cancel):void 0;x=x.editing&&x.operations?.update?
e.tsx("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},e.tsx("span",{key:"file-name",class:"esri-attachments__file-name"},G),e.tsx("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,e.tsx("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0;C=e.tsx("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},e.tsx("label",
null,K.formatFileSize(this.messagesUnits,C??0)));r=e.tsx("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},e.tsx("label",null,r));O=B.isSome(O)?e.tsx("a",{class:"esri-attachments__item-link",href:O,rel:"noreferrer",target:"_blank"},this.renderImageMask(c,400),e.tsx("div",{class:"esri-attachments__item-link-overlay"},e.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},e.tsx("calcite-icon",{icon:"launch"})))):this.renderImageMask(c,400);P=e.tsx("form",{bind:this,
afterCreate:z.storeNode,afterRemoved:z.discardNode,"data-node-ref":"_updateAttachmentForm",onsubmit:W=>this._submitUpdateAttachment(W,c)},e.tsx("div",{class:"esri-attachments__metadata"},C,r),x,e.tsx("div",{class:"esri-attachments__actions"},P,S,R));return e.tsx("div",{key:"edit-form-container",class:"esri-attachments__form-node"},O,P)};u.renderImageMask=function(c,n){return c?"file"in c?this.renderGenericImageMask(c.file.name,c.file.type):this.renderImageMaskForAttachment(c,n):null};u.renderGenericImageMask=
function(c,n){var {supportsResizeAttachments:A}=this.viewModel;n=k.getIconPath(n);A={["esri-attachments__image--resizable"]:A};return e.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask")},e.tsx("img",{title:c,alt:c,src:n,class:this.classes(A,"esri-attachments__image")}))};u.renderImageMaskForAttachment=function(c,n){var {supportsResizeAttachments:A}=this.viewModel;if(!c)return null;const {contentType:L,name:F,url:x}=c;if(!A||!k.isSupportedImage(L))return this.renderGenericImageMask(F,
L);c=(c=this._getCSSTransform(c))?{transform:c,"image-orientation":"none"}:{};n=`${x}${x?.includes("?")?"\x26":"?"}w=${n}`;A={["esri-attachments__image--resizable"]:A};return e.tsx("div",{class:this.classes("esri-attachments__item-mask")},e.tsx("img",{styles:c,alt:F,title:F,src:n,class:this.classes(A,"esri-attachments__image")}))};u.renderFile=function(c){const {file:n}=c;return e.tsx("li",{class:"esri-attachments__item",key:n},e.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",
title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(c),type:"button"},this.renderImageMask(c),e.tsx("label",{class:"esri-attachments__label"},e.tsx("span",{class:"esri-attachments__filename"},n.name||this.messages.noTitle),e.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",z.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}))))};u.renderAttachmentInfo=function({attachmentInfo:c,displayType:n}){const {viewModel:A,
effectiveDisplayType:L}=this,{abilities:F,supportsResizeAttachments:x}=A,{contentType:R,name:G,url:r}=c;n=this.renderImageMask(c,"list"===n?48:400);var C=F.editing?e.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",z.isRTL(this.container)?"esri-icon-left":"esri-icon-right")}):null;C="preview"===L&&x&&k.isSupportedImage(R)?null:e.tsx("label",{class:"esri-attachments__label"},e.tsx("span",{class:"esri-attachments__filename"},G||this.messages.noTitle),C);n=[n,
C];n=F.editing?e.tsx("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":c.id,onclick:()=>this._startEditAttachment(c),type:"button"},n):e.tsx("a",{key:"details-link",class:"esri-attachments__item-button",href:r??void 0,target:"_blank"},n);return e.tsx("li",{class:"esri-attachments__item",key:c},n)};u.renderAttachmentContainer=function(){const {effectiveDisplayType:c,
viewModel:n,visibleElements:A}=this,{attachmentInfos:L,abilities:F,fileInfos:x}=n;var R=!!L?.length;const G=!!x?.length,r={["esri-attachments__container--list"]:"preview"!==c,["esri-attachments__container--preview"]:"preview"===c},C=F.editing&&F.operations?.add&&A.addButton?e.tsx("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button","esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},e.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",
"esri-icon-plus")}),this.messages.add):void 0,O=R?e.tsx("ul",{key:"attachments-list",class:"esri-attachments__items"},L.toArray().map(S=>this.renderAttachmentInfo({attachmentInfo:S,displayType:c}))):void 0,P=G?e.tsx("ul",{key:"file-list",class:"esri-attachments__items"},x.toArray().map(S=>this.renderFile(S))):void 0;R=G||R?void 0:e.tsx("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return e.tsx("div",{key:"attachments-container",class:this.classes("esri-attachments__container",
r)},O,P,R,C)};u._modeChanged=function(){this._set("error",null);this._set("selectedFile",null)};u._handleFileInputChange=function(c){c=(c=c.target)&&c.files&&c.files.item(0);this._set("selectedFile",c)};u._submitDeleteAttachment=function(c,n){c.preventDefault();n&&("file"in n?this.deleteFile(n.file):n&&this.deleteAttachment(n))};u._submitAddAttachment=function(c){c.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()};u._submitUpdateAttachment=function(c,n){c.preventDefault();
n&&"file"in n?this.updateFile():this.updateAttachment()};u._startEditAttachment=function(c){const {viewModel:n}=this;n.activeFileInfo=null;n.activeAttachmentInfo=c;n.mode="edit"};u._startEditFile=function(c){const {viewModel:n}=this;n.activeAttachmentInfo=null;n.activeFileInfo=c;n.mode="edit"};u._startAddAttachment=function(){this.viewModel.mode="add"};u._cancelForm=function(c){c.preventDefault();this.viewModel.mode="view"};u._getCSSTransform=function(c){({orientationInfo:c}=c);return!this._supportsImageOrientation&&
c?[c.rotation?`rotate(${c.rotation}deg)`:"",c.mirrored?"scaleX(-1)":""].join(" "):""};h._createClass(f,[{key:"abilities",get:function(){return this.viewModel.abilities},set:function(c){this.viewModel.abilities=c}},{key:"effectiveDisplayType",get:function(){const {displayType:c}=this;return c&&"auto"!==c?c:this.viewModel.supportsResizeAttachments?"preview":"list"}},{key:"graphic",get:function(){return this.viewModel.graphic},set:function(c){this.viewModel.graphic=c}},{key:"label",get:function(){return this.messages?.widgetLabel??
""},set:function(c){this._overrideIfSome("label",c)}}]);return f}(g);m.__decorate([N.property()],H.prototype,"abilities",null);m.__decorate([N.property()],H.prototype,"displayType",void 0);m.__decorate([N.property({readOnly:!0})],H.prototype,"effectiveDisplayType",null);m.__decorate([N.property()],H.prototype,"graphic",null);m.__decorate([N.property()],H.prototype,"label",null);m.__decorate([N.property(),t.messageBundle("esri/widgets/Attachments/t9n/Attachments")],H.prototype,"messages",void 0);m.__decorate([N.property(),
t.messageBundle("esri/core/t9n/Units")],H.prototype,"messagesUnits",void 0);m.__decorate([N.property({readOnly:!0})],H.prototype,"selectedFile",void 0);m.__decorate([N.property({readOnly:!0})],H.prototype,"submitting",void 0);m.__decorate([N.property({readOnly:!0})],H.prototype,"error",void 0);m.__decorate([N.property({type:y})],H.prototype,"viewModel",void 0);m.__decorate([N.property()],H.prototype,"visibleElements",void 0);m.__decorate([M.cast("visibleElements")],H.prototype,"castVisibleElements",
null);return H=m.__decorate([a.subclass("esri.widgets.Attachments")],H)})},"esri/core/unitFormatUtils":function(){define("exports ./byteSizeEstimations ./Cyclical ./mathUtils ./maybe ./string ./unitUtils ../intl/number".split(" "),function(q,h,m,p,B,D,K,N){function M(k,l,z){return k.units[l][z]}function H(k,l,z,t=2,e="abbr"){return`${N.formatNumber(l,{minimumFractionDigits:t,maximumFractionDigits:t,signDisplay:0<l?"never":"exceptZero"})} ${M(k,z,e)}`}function b(k,l,z,t=2,e="abbr"){return`${N.formatNumber(l,
{minimumFractionDigits:t,maximumFractionDigits:t,signDisplay:"exceptZero"})} ${M(k,z,e)}`}function a(k,l){const z=JSON.stringify(l);let t=g.get(z);t||(t=new Intl.NumberFormat("en-US",l),g.set(z,t));return/\-?\+?360/.test(t.format(k))?0:k}const g=new Map,y=["B","kB","MB","GB","TB"];q.formatAngleDegrees=function(k,l,z,t,e){e=B.unwrapOr(e,2);var v=m.cyclicalDegrees,I=v.normalize;a:if(k=K.convertUnit(k,l,"degrees"),z===t)z=k;else{switch(t){case "arithmetic":z=-k+90;break a;case "geographic":z=-k-90;break a}z=
void 0}v=I.call(v,z,0,!0);e={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:e,minimumFractionDigits:e,signDisplay:0<v?"never":"exceptZero"};v=a(v,e);return N.formatNumber(v,e)};q.formatDMS=function(k,l,z=2){k=K.convertUnit(k,l,"degrees");l=k-Math.floor(k);k-=l;l*=60;let t=l-Math.floor(l);l-=t;t*=60;return`${k.toFixed()}\u00b0 ${l.toFixed()}' ${t.toFixed(z)}"`};q.formatDecimal=H;q.formatFileSize=function(k,l){let z=0===l?0:Math.floor(Math.log(l)/Math.log(h.ByteSizeUnit.KILOBYTES));
z=p.clamp(z,0,y.length-1);l=N.formatNumber(l/h.ByteSizeUnit.KILOBYTES**z,{maximumFractionDigits:2});return D.replace(k.units.bytes[y[z]],{fileSize:l})};q.formatImperialArea=function(k,l,z,t=2,e="abbr"){const v=K.preferredImperialAreaUnit(l,z);return H(k,K.convertUnit(l,z,v),v,t,e)};q.formatImperialLength=function(k,l,z,t=2,e="abbr"){const v=K.preferredImperialLengthUnit(l,z);return H(k,K.convertUnit(l,z,v),v,t,e)};q.formatImperialRelativeLength=function(k,l,z,t=2,e="abbr"){const v=K.preferredImperialLengthUnit(l,
z);return b(k,K.convertUnit(l,z,v),v,t,e)};q.formatImperialRelativeVerticalLength=function(k,l,z,t=2,e="abbr"){const v=K.preferredImperialVerticalLengthUnit(l,z);return b(k,K.convertUnit(l,z,v),v,t,e)};q.formatImperialVerticalLength=function(k,l,z,t=2,e="abbr"){const v=K.preferredImperialVerticalLengthUnit(l,z);return H(k,K.convertUnit(l,z,v),v,t,e)};q.formatMetricArea=function(k,l,z,t=2,e="abbr"){const v=K.preferredMetricAreaUnit(l,z);return H(k,K.convertUnit(l,z,v),v,t,e)};q.formatMetricLength=
function(k,l,z,t=2,e="abbr"){const v=K.preferredMetricLengthUnit(l,z);return H(k,K.convertUnit(l,z,v),v,t,e)};q.formatMetricRelativeLength=function(k,l,z,t=2,e="abbr"){const v=K.preferredMetricLengthUnit(l,z);return b(k,K.convertUnit(l,z,v),v,t,e)};q.formatMetricRelativeVerticalLength=function(k,l,z,t=2,e="abbr"){const v=K.preferredMetricVerticalLengthUnit(l,z);return b(k,K.convertUnit(l,z,v),v,t,e)};q.formatMetricVerticalLength=function(k,l,z,t=2,e="abbr"){const v=K.preferredMetricVerticalLengthUnit(l,
z);return H(k,K.convertUnit(l,z,v),v,t,e)};q.formatRelativeAngleDegrees=function(k,l,z,t,e){z!==t&&(k=-k);e=B.unwrapOr(e,2);z={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:e,minimumFractionDigits:e,signDisplay:"exceptZero"};k=K.convertUnit(k,l,"degrees")%360;k=a(k,z);return N.formatNumber(k,z)};q.formatRelativeDecimal=b;q.unitName=M;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k,l){const z={editing:!1,operations:{add:!0,update:!0,delete:!0}},t=B.ofType(y);p=function(e){function v(u){var f=I.call(this,u);f._getAttachmentsPromise=null;f._attachmentLayer=null;f.abilities={...z};f.activeAttachmentInfo=null;f.activeFileInfo=null;f.attachmentInfos=new t;f.fileInfos=new B;f.graphic=null;f.mode="view";f.filesEnabled=!1;f.addHandles(N.watch(()=>f.graphic,()=>f._graphicChanged(),N.initial));return f}q._inherits(v,e);var I=q._createSuper(v);e=
v.prototype;e.destroy=function(){this.graphic=this._attachmentLayer=null};e.castAbilities=function(u){return{...z,...u}};e.getAttachments=async function(){const {_attachmentLayer:u,attachmentInfos:f}=this;if(!u||"function"!==typeof u.queryAttachments)throw new D("invalid-layer","getAttachments(): A valid layer is required.");const d=this._getObjectId();var c=new k({objectIds:[d],returnMetadata:!0});const n=[];this._getAttachmentsPromise=c=u.queryAttachments(c).then(A=>A[d]||n).catch(()=>n);this.notifyChange("state");
c=await c;f.removeAll();c.length&&f.addMany(c);this._getAttachmentsPromise=null;this.notifyChange("state");return c};e.addAttachment=async function(u,f=this.graphic){const {_attachmentLayer:d,attachmentInfos:c,abilities:n}=this;if(!f)throw new D("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:f});if(!u)throw new D("invalid-attachment","addAttachment(): An attachment is required.",{attachment:u});if(!n.operations?.add)throw new D("invalid-abilities","addAttachment(): add abilities are required.");
if(!d||"function"!==typeof d.addAttachment)throw new D("invalid-layer","addAttachment(): A valid layer is required.");u=await d.addAttachment(f,u).then(A=>this._queryAttachment(A.objectId,f));c.add(u);return u};e.deleteAttachment=async function(u){const {_attachmentLayer:f,attachmentInfos:d,graphic:c,abilities:n}=this;if(!u)throw new D("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:u});if(!n.operations?.delete)throw new D("invalid-abilities","deleteAttachment(): delete abilities are required.");
if(!f||"function"!==typeof f.deleteAttachments)throw new D("invalid-layer","deleteAttachment(): A valid layer is required.");if(!c)throw new D("invalid-graphic","deleteAttachment(): A graphic is required.");const A=await f.deleteAttachments(c,[u.id]).then(()=>u);d.remove(A);return A};e.updateAttachment=async function(u,f=this.activeAttachmentInfo){const {_attachmentLayer:d,attachmentInfos:c,graphic:n,abilities:A}=this;if(!u)throw new D("invalid-attachment","updateAttachment(): An attachment is required.",
{attachment:u});if(!f)throw new D("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:f});if(!A.operations?.update)throw new D("invalid-abilities","updateAttachment(): Update abilities are required.");const L=c.findIndex(F=>F===f);if(!d||"function"!==typeof d.updateAttachment)throw new D("invalid-layer","updateAttachment(): A valid layer is required.");if(!n)throw new D("invalid-graphic","updateAttachment(): A graphic is required.");u=await d.updateAttachment(n,
f.id,u).then(F=>this._queryAttachment(F.objectId));c.splice(L,1,u);return u};e.commitFiles=async function(){await Promise.all(this.fileInfos.items.map(u=>this.addAttachment(u.form)));this.fileInfos.removeAll();return this.getAttachments()};e.addFile=function(u,f){if(!u||!f)return null;u={file:u,form:f};this.fileInfos.add(u);return u};e.updateFile=function(u,f,d=this.activeFileInfo){if(!u||!f||!d)return null;const c=this.fileInfos.findIndex(n=>d===n);-1<c&&this.fileInfos.splice(c,1,{file:u,form:f});
return this.fileInfos.items[c]};e.deleteFile=function(u){const f=this.fileInfos.find(d=>d.file===u);return f?(this.fileInfos.remove(f),f):null};e._queryAttachment=async function(u,f){const {_attachmentLayer:d}=this;if(!u||!d?.queryAttachments)throw new D("invalid-attachment-id","Could not query attachment.");const c=this._getObjectId(f);u=new k({objectIds:[c],attachmentsWhere:`AttachmentId=${u}`,returnMetadata:!0});return d.queryAttachments(u).then(n=>n[c][0])};e._getObjectId=function(u=this.graphic){return u?.getObjectId()??
null};e._graphicChanged=function(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))};e._setAttachmentLayer=function(){var {graphic:u}=this;this._attachmentLayer=(u=l.getSourceLayer(u))?"scene"===u.type&&K.isSome(u.associatedLayer)?u.associatedLayer:u:null};q._createClass(v,[{key:"state",get:function(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}},{key:"supportsResizeAttachments",get:function(){var {graphic:u}=this;if(!u)return!1;u=u.layer||
u.sourceLayer;return u?.loaded&&"capabilities"in u&&u.capabilities&&"operations"in u.capabilities&&"supportsResizeAttachments"in u.capabilities.operations&&u.capabilities.operations.supportsResizeAttachments||!1}}]);return v}(p);h.__decorate([M.property()],p.prototype,"abilities",void 0);h.__decorate([H.cast("abilities")],p.prototype,"castAbilities",null);h.__decorate([M.property()],p.prototype,"activeAttachmentInfo",void 0);h.__decorate([M.property()],p.prototype,"activeFileInfo",void 0);h.__decorate([M.property({readOnly:!0,
type:t})],p.prototype,"attachmentInfos",void 0);h.__decorate([M.property()],p.prototype,"fileInfos",void 0);h.__decorate([M.property({type:m})],p.prototype,"graphic",void 0);h.__decorate([M.property()],p.prototype,"mode",void 0);h.__decorate([M.property({readOnly:!0})],p.prototype,"state",null);h.__decorate([M.property()],p.prototype,"filesEnabled",void 0);h.__decorate([M.property({readOnly:!0})],p.prototype,"supportsResizeAttachments",null);return p=h.__decorate([g.subclass("esri.widgets.Attachments.AttachmentsViewModel")],
p)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),function(q,h,m,p,B,D,K,N,M){var H;const b={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,
rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};m=H=function(a){function g(k){k=y.call(this,k);k.contentType=null;k.exifInfo=null;k.id=null;k.globalId=null;k.keywords=null;k.name=null;k.parentGlobalId=null;k.parentObjectId=null;k.size=null;k.url=null;return k}q._inherits(g,a);var y=q._createSuper(g);g.prototype.clone=function(){return new H({contentType:this.contentType,
exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})};q._createClass(g,[{key:"orientationInfo",get:function(){var {exifInfo:k}=this;k=M.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:k});return b[k]||null}}]);return g}(m.JSONSupport);h.__decorate([p.property({type:String})],m.prototype,"contentType",void 0);h.__decorate([p.property()],m.prototype,
"exifInfo",void 0);h.__decorate([p.property({readOnly:!0})],m.prototype,"orientationInfo",null);h.__decorate([p.property({type:B.Integer})],m.prototype,"id",void 0);h.__decorate([p.property({type:String})],m.prototype,"globalId",void 0);h.__decorate([p.property({type:String})],m.prototype,"keywords",void 0);h.__decorate([p.property({type:String})],m.prototype,"name",void 0);h.__decorate([p.property({json:{read:!1}})],m.prototype,"parentGlobalId",void 0);h.__decorate([p.property({json:{read:!1}})],
m.prototype,"parentObjectId",void 0);h.__decorate([p.property({type:B.Integer})],m.prototype,"size",void 0);h.__decorate([p.property({json:{read:!1}})],m.prototype,"url",void 0);return m=H=h.__decorate([N.subclass("esri.layers.support.AttachmentInfo")],m)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(q){function h(m){const {tagName:p,tags:B}=m;return B&&p?(m=B.find(D=>D.name===p))&&m.value||null:null}q.getExifValue=function(m){const {exifInfo:p,exifName:B,tagName:D}=m;
return p&&B&&D?(m=p.find(K=>K.name===B))?h({tagName:D,tags:m.tags}):null:null};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../intl ../../../core/Logger ../../../core/maybe ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../popup/support/FieldInfoFormat ../../../support/arcadeOnDemand".split(" "),function(q,h,m,p,B,
D,K,N,M,H,b){function a(w){return w?S.test(w):!1}function g(w,E){if(!a(E)||!w)return null;const J=E.replace(S,"").toLowerCase();let Q=null;w.some(U=>U.name.toLowerCase()===J?(Q=U,!0):!1);return Q}function y(w,E){return(E=k(E,w))?E.name:w}function k(w,E){return w&&"function"===typeof w.getField&&E?w.getField(E)??null:null}function l({formattedAttributes:w,template:E,fieldInfoMap:J}){return`${B.replace(B.replace(E,Q=>{const U=J.get(Q.toLowerCase());return`{${U&&U.fieldName||Q}}`}),w).replace(C,"")}`.trim()}
function z(w,E,J=!1){const Q=E[w];"string"===typeof Q&&(J=(J?encodeURIComponent(Q):Q).replace(P,"%27"),E[w]=J)}function t(w,E=!1){const J={...w};Object.keys(J).forEach(Q=>z(Q,J,E));return J}function e(w,E){return w.replace(O,(J,Q,U)=>(J=k(E,U))?`{${J.name}}`:Q)}function v(w,E,J){return(w=e(w,J))?w.replace(Z,(Q,U,X)=>{U=`${U||X}`.trim();return B.replace(Q,t(E,U&&"{"!==U[0]||!1))}):w}function I(w,E){var J=E.fieldName,Q=u(E.fieldInfos,J)?.clone();const U=E.preventPlacesFormatting;E=E.layer;var X=k(E,
J);Q&&"date"===X?.type&&(X=Q.format||new H,X.dateFormat=X.dateFormat||"short-date-short-time",X.dateTimeFormatOptions=!E?.layer&&"feature"===E?.type&&E.datesInUnknownTimezone||E?.layer&&"map-image"===E.layer?.type&&E.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,Q.format=X);Q=Q&&Q.format;if("string"===typeof w&&N.isRasterPixelValueField(J)&&Q)return Q.formatRasterPixelValue(w);"string"!==typeof w||!Q||null!=Q.dateFormat||null==Q.places&&null==Q.digitSeparator||(J=Number(w),isNaN(J)||(w=J));return"string"===
typeof w||null==w||null==Q?c(w):U?K.formatNumber(w,{...K.convertNumberFormatToIntlOptions(Q),minimumFractionDigits:0,maximumFractionDigits:20}):Q.format(w)}function u(w,E){if(w&&w.length&&E){var J=E.toLowerCase(),Q=void 0;w.some(U=>U.fieldName&&U.fieldName.toLowerCase()===J?(Q=U,!0):!1);return Q}}function f({fieldName:w,graphic:E,layer:J}){if(F(w)||!J||"function"!==typeof J.getFeatureType)return null;const {typeIdField:Q}=J;return Q&&w===Q?(w=J.getFeatureType(E))?w.name:null:null}function d({fieldName:w,
value:E,graphic:J,layer:Q}){return F(w)||!Q||"function"!==typeof Q.getFieldDomain?null:(w=J&&Q.getFieldDomain(w,{feature:J}))&&"coded-value"===w.type?w.getName(E):null}function c(w){return"string"===typeof w?w.replace(W,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):w}function n(w){const {value:E,fieldName:J,fieldInfos:Q,fieldInfoMap:U,layer:X,graphic:ca}=w;return null==E?"":(w=d({fieldName:J,value:E,graphic:ca,layer:X}))||(w=f({fieldName:J,graphic:ca,layer:X}))?w:U.get(J.toLowerCase())?I(E,{fieldInfos:Q||
Array.from(U.values()),fieldName:J,layer:X}):(w=X&&X.fieldsIndex)&&w.isDateField(J)?D.formatDate(E,ba):c(E)}async function A(w,E){const {layer:J,graphic:Q,outFields:U,objectIds:X,returnGeometry:ca,spatialReference:da}=w;w=X[0];if("number"!==typeof w&&"string"!==typeof w)return r.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:J,graphic:Q,objectId:w,requiredFields:U}),null;if(!M.getEffectiveLayerCapabilities(J)?.operations?.supportsQuery)return r.warn("The specified layer cannot be queried. The following fields will not be available.",
{layer:J,graphic:Q,requiredFields:U,returnGeometry:ca}),null;w=J.createQuery();w.objectIds=X;w.outFields=U?.length?U:[J.objectIdField];w.returnGeometry=!!ca;w.returnZ=!!ca;w.returnM=!!ca;w.outSpatialReference=da;return(await J.queryFeatures(w,E)).features[0]}async function L(w){if(!w.expressionInfos?.length)return!1;var E=await b.loadArcade();({arcadeUtils:{hasGeometryFunctions:E}}=E);return E(w)}function F(w=""){return w?w.includes("relationships/"):!1}function x({attributes:w,graphic:E,relatedInfo:J,
fieldInfos:Q,fieldInfoMap:U,layer:X}){w&&E&&J&&Object.keys(E.attributes).forEach(ca=>{var da=(da={layerId:J.relation.id.toString(),fieldName:ca},`${"relationships/"}${da.layerId}/${da.fieldName}`);w[da]=n({fieldName:da,fieldInfos:Q,fieldInfoMap:U,layer:X,value:E.attributes[ca],graphic:E})})}function R({attributes:w,relatedInfo:E,fieldInfoMap:J,fieldInfos:Q,layer:U}){w&&E&&(E.relatedFeatures&&E.relatedFeatures&&E.relatedFeatures.forEach(X=>x({attributes:w,graphic:X,relatedInfo:E,fieldInfoMap:J,fieldInfos:Q,
layer:U})),E.relatedStatsFeatures&&E.relatedStatsFeatures&&E.relatedStatsFeatures.forEach(X=>x({attributes:w,graphic:X,relatedInfo:E,fieldInfoMap:J,fieldInfos:Q,layer:U})))}function G(w,E,J){return w.find(Q=>Q!==E&&"feature"===Q.type&&Q.url===E.url&&Q.layerId===J.relatedTableId)}const r=m.getLogger("esri.widgets.Feature.support.featureUtils"),C=/href=(""|'')/gi,O=/(\{([^\{\r\n]+)\})/g,P=/'/g,S=/^\s*expression\//i,W=/(\n)/gi,Y=/[\u00A0-\u9999<>&]/gim,Z=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,aa=/^(?:mailto:|tel:)/,
ba=D.convertDateFormatToIntlOptions("short-date-short-time"),V=w=>{if(!w)return!1;w=w.toUpperCase();return w.includes("CURRENT_TIMESTAMP")||w.includes("CURRENT_DATE")||w.includes("CURRENT_TIME")},T=({layer:w,method:E,query:J,definitionExpression:Q})=>{w.capabilities?.query?.supportsCacheHint&&"attachments"!==E&&(w=p.isSome(J.where)?J.where:null,E=p.isSome(J.geometry)?J.geometry:null,V(Q)||V(w)||"extent"===E?.type||"tile"===J.resultType||(J.cacheHint=!0))};q.applyTextFormattingHTML=c;q.createfieldInfoMap=
function(w,E){const J=new Map;if(!w)return J;w.forEach(Q=>{const U=y(Q.fieldName,E);Q.fieldName=U;J.set(U.toLowerCase(),Q)});return J};q.findRelatedLayer=function(w,E,J){return w&&E&&J?G(w.allLayers,E,J)||G(w.allTables,E,J):null};q.fixTokens=e;q.formatAttributes=function({fieldInfos:w,attributes:E,layer:J,graphic:Q,fieldInfoMap:U,relatedInfos:X}){const ca={};X?.forEach(da=>R({attributes:ca,relatedInfo:da,fieldInfoMap:U,fieldInfos:w,layer:J}));E&&Object.keys(E).forEach(da=>{ca[da]=n({fieldName:da,
fieldInfos:w,fieldInfoMap:U,layer:J,value:E[da],graphic:Q})});return ca};q.formatEditInfo=function(w,E){const {creatorField:J,creationDateField:Q,editorField:U,editDateField:X}=w;if(E){w=E[X];if("number"===typeof w)return E=E[U],{type:"edit",date:D.formatDate(w,ba),user:E};w=E[Q];return"number"===typeof w?(E=E[J],{type:"create",date:D.formatDate(w,ba),user:E}):null}};q.formatValueToFieldInfo=I;q.getAllFieldInfos=function(w){const E=[];if(!w)return E;const {fieldInfos:J,content:Q}=w;J&&E.push(...J);
if(!Q||!Array.isArray(Q))return E;Q.forEach(U=>{"fields"===U.type&&(U=U&&U.fieldInfos)&&E.push(...U)});return E};q.getFieldInfo=u;q.getFieldInfoLabel=function(w,E){return(E=g(E,w?.fieldName))?E.title||null:w?w.label||w.fieldName:null};q.getFixedFieldName=y;q.getFixedFieldNames=function(w,E){return w&&w.map(J=>y(J,E))};q.getSourceLayer=function(w){if(!p.isNone(w))return w.get("sourceLayer")||w.get("layer")};q.graphicCallback=async function(w,E){return"function"===typeof w?w.call(null,E):w};q.htmlEntities=
function(w){return w.replace(Y,E=>`&#${E.charCodeAt(0)};`)};q.isExpressionField=a;q.isRelatedField=F;q.preLayerQueryCallback=({query:w,layer:E,method:J})=>{T({layer:E,method:J,query:w,definitionExpression:`${E.definitionExpression} ${E.serviceDefinitionExpression}`})};q.preRequestCallback=({queryPayload:w,layer:E,method:J})=>{T({layer:E,method:J,query:w,definitionExpression:`${E.definitionExpression} ${E.serviceDefinitionExpression}`})};q.querySourceLayer=A;q.queryUpdatedFeature=async function({graphic:w,
popupTemplate:E,layer:J,spatialReference:Q},U){if(J&&E&&("function"===typeof J.load&&await J.load(U),w.attributes)){var X=w.attributes[J.objectIdField];if(null!=X){X=[X];var ca=await E.getRequiredFields(J.fieldsIndex),da=N.featureHasFields(ca,w);ca=da?[]:ca;E=E.returnGeometry||await L(E);if(!da||E)if(J=await A({layer:J,graphic:w,outFields:ca,objectIds:X,returnGeometry:E,spatialReference:Q},U))J.geometry&&(w.geometry=J.geometry),J.attributes&&(w.attributes={...w.attributes,...J.attributes})}}};q.shouldOpenInNewTab=
function(w=""){if(w)return!aa.test(w.trim().toLowerCase())};q.substituteAttributes=l;q.substituteFieldsInLinksAndAttributes=function({attributes:w,globalAttributes:E,layer:J,text:Q,expressionAttributes:U,fieldInfoMap:X}){return Q?l({formattedAttributes:E,template:v(Q,{...E,...U,...w},J),fieldInfoMap:X}):""};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(q,h){q.getIconPath=function(m){const p=
h.getAssetUrl("esri/themes/base/images/files/");return m?"text/plain"===m?`${p}text-32.svg`:"application/pdf"===m?`${p}pdf-32.svg`:"text/csv"===m?`${p}csv-32.svg`:"application/gpx+xml"===m?`${p}gpx-32.svg`:"application/x-dwf"===m?`${p}cad-32.svg`:"application/postscript"===m||"application/json"===m||"text/xml"===m||"model/vrml"===m?`${p}code-32.svg`:"application/x-zip-compressed"===m||"application/x-7z-compressed"===m||"application/x-gzip"===m||"application/x-tar"===m||"application/x-gtar"===m||"application/x-bzip2"===
m||"application/gzip"===m||"application/x-compress"===m||"application/x-apple-diskimage"===m||"application/x-rar-compressed"===m||"application/zip"===m?`${p}zip-32.svg`:m.includes("image/")?`${p}image-32.svg`:m.includes("audio/")?`${p}sound-32.svg`:m.includes("video/")?`${p}video-32.svg`:m.includes("msexcel")||m.includes("ms-excel")||m.includes("spreadsheetml")?`${p}excel-32.svg`:m.includes("msword")||m.includes("ms-word")||m.includes("wordprocessingml")?`${p}word-32.svg`:m.includes("powerpoint")||
m.includes("presentationml")?`${p}report-32.svg`:`${p}generic-32.svg`:`${p}generic-32.svg`};q.isSupportedImage=function(m){m=m.toLowerCase();return"image/bmp"===m||"image/emf"===m||"image/exif"===m||"image/gif"===m||"image/x-icon"===m||"image/jpeg"===m||"image/png"===m||"image/tiff"===m||"image/x-wmf"===m};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(q,h,m,p,B,D,K,N){p=function(M){function H(a){a=b.call(this,a);a.description=null;a.title=null;return a}q._inherits(H,M);var b=q._createSuper(H);return q._createClass(H)}(N);h.__decorate([m.property()],p.prototype,"description",void 0);h.__decorate([m.property()],p.prototype,"title",void 0);return p=h.__decorate([K.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],p)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b){p=function(a){function g(k,l){k=y.call(this,k,l);k.description=null;k.headingLevel=2;k.title=null;return k}q._inherits(g,a);var y=q._createSuper(g);a=g.prototype;a.render=function(){return b.tsx("div",{class:"esri-feature-element-info"},this.renderTitle(),this.renderDescription())};a.renderTitle=function(){const {title:k}=this;return k?b.tsx(M.Heading,{level:this.headingLevel,class:"esri-feature-element-info__title"},k):null};a.renderDescription=function(){const {description:k}=
this;return k?b.tsx("div",{key:"description",class:"esri-feature-element-info__description"},k):null};return q._createClass(g)}(N);h.__decorate([m.property()],p.prototype,"description",void 0);h.__decorate([m.property()],p.prototype,"headingLevel",void 0);h.__decorate([m.property()],p.prototype,"title",void 0);return p=h.__decorate([K.subclass("esri.widgets.Feature.support.FeatureElementInfo")],p)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./widgetUtils",
"./jsxFactory"],function(q,h,m,p){const B={heading:"esri-widget__heading"};q.CSS=B;q.Heading=function({level:D,class:K,...N},M){D=h.clamp(Math.ceil(D),1,6);return p.tsx(`h${D}`,{...N,class:m.classes(B.heading,K),role:"heading","aria-level":String(D)},M)};q.incrementHeadingLevel=function(D,K=1){return h.clamp(Math.ceil(D+K),1,6)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a){p=function(g){function y(l,z){l=k.call(this,l,z);l.viewModel=null;l._addTargetToAnchors=t=>{Array.from(t.querySelectorAll("a")).forEach(e=>{H.shouldOpenInNewTab(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")})};return l}q._inherits(y,g);var k=q._createSuper(y);g=y.prototype;g.renderLoading=function(){return a.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},a.tsx("div",{class:"esri-feature-content__loader"}))};g.renderCreated=
function(){const l=this.viewModel?.created;return l?l instanceof HTMLElement?a.tsx("div",{key:l,bind:l,afterCreate:this._attachToNode}):b.isWidget(l)?a.tsx("div",{key:l},!l.destroyed&&l.render()):a.tsx("div",{key:l,innerHTML:l,afterCreate:this._addTargetToAnchors}):null};g.render=function(){return a.tsx("div",{class:"esri-feature-content"},"loading"===this.viewModel?.state?this.renderLoading():this.renderCreated())};g._attachToNode=function(l){l.appendChild(this)};q._createClass(y,[{key:"creator",
get:function(){return this.viewModel?.creator},set:function(l){this.viewModel&&(this.viewModel.creator=l)}},{key:"graphic",get:function(){return this.viewModel?.graphic},set:function(l){this.viewModel&&(this.viewModel.graphic=l)}}]);return y}(N);h.__decorate([m.property()],p.prototype,"creator",null);h.__decorate([m.property()],p.prototype,"graphic",null);h.__decorate([m.property({type:M})],p.prototype,"viewModel",void 0);return p=h.__decorate([K.subclass("esri.widgets.Feature.FeatureContent")],p)})},
"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),function(q,h,m,p,B,D,K,N,M,H,b,a){p=function(g){function y(l){var z=
k.call(this,l);z._loadingPromise=null;z.created=null;z.creator=null;z.destroyer=null;z.graphic=null;z.handles.add(D.watch(()=>z.creator,t=>{z._destroyContent();z._createContent(t)},D.initial));return z}q._inherits(y,g);var k=q._createSuper(y);g=y.prototype;g.destroy=function(){this._destroyContent()};g._destroyContent=function(){const {created:l,graphic:z,destroyer:t}=this;l&&z&&(a.graphicCallback(t,{graphic:z}).catch(()=>null),this._set("created",null))};g._createContent=async function(l){var z=
this.graphic;z&&l&&(this._loadingPromise=l=a.graphicCallback(l,{graphic:z}).catch(()=>null),this.notifyChange("state"),z=await l,l===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",z)))};q._createClass(y,[{key:"state",get:function(){return this._loadingPromise?"loading":"ready"}}]);return y}(B.HandleOwnerMixin(p));h.__decorate([K.property({readOnly:!0})],p.prototype,"created",void 0);h.__decorate([K.property()],p.prototype,"creator",void 0);h.__decorate([K.property()],
p.prototype,"destroyer",void 0);h.__decorate([K.property({type:m})],p.prototype,"graphic",void 0);h.__decorate([K.property({readOnly:!0})],p.prototype,"state",null);return p=h.__decorate([b.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],p)})},"esri/widgets/Feature/FeatureExpression":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent ./FeatureFields ./FeatureMedia ./FeatureExpression/FeatureExpressionViewModel ../support/widgetUtils ../support/jsxFactory".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k){B=function(l){function z(e,v){e=t.call(this,e,v);e._contentWidget=null;e.viewModel=new g;return e}q._inherits(z,l);var t=q._createSuper(z);l=z.prototype;l.initialize=function(){this.addHandles(m.watch(()=>this.viewModel?.contentElementViewModel,()=>this._setupExpressionWidget(),m.initial))};l.destroy=function(){this._destroyContentWidget()};l.renderLoading=function(){return k.tsx("div",{key:"loading-container",class:"esri-feature__loading-container"},k.tsx("span",
{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))};l.render=function(){const {state:e}=this.viewModel;return k.tsx("div",{class:"esri-feature-expression"},"loading"===e?this.renderLoading():"disabled"===e?null:this._contentWidget?.render())};l._destroyContentWidget=function(){const {_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy());this._contentWidget=null};l._setupExpressionWidget=function(){const {contentElementViewModel:e,contentElement:v}=
this.viewModel,I=v?.type;this._destroyContentWidget();this._contentWidget=e?"fields"===I?new b({viewModel:e}):"media"===I?new a({viewModel:e}):"text"===I?new H({viewModel:e}):null:null;this.scheduleRender()};return q._createClass(z)}(M);h.__decorate([p.property({type:g})],B.prototype,"viewModel",void 0);return B=h.__decorate([N.subclass("esri.widgets.Feature.FeatureExpression")],B)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k){B=function(l){function z(e,v){e=t.call(this,e,v);e._featureElementInfo=null;e.viewModel=new H;e.messages=null;e.messagesURIUtils=null;return e}q._inherits(z,l);var t=q._createSuper(z);l=z.prototype;l.initialize=function(){this._featureElementInfo=new b;this.addHandles(m.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),m.initial))};l.destroy=function(){this._featureElementInfo?.destroy()};l.renderFieldInfo=function(e,
v){var {attributes:I}=this.viewModel;const u=e.fieldName,f=e.label||u;I=I?null==I[u]?"":I[u]:"";e=!(!e.format||!e.format.dateFormat);I="number"!==typeof I||e?a.autoLink(this.messagesURIUtils,I):this._forceLTR(I);e={["esri-feature-fields__field-data--date"]:e};return k.tsx("tr",{key:`fields-element-info-row-${u}-${v}`},k.tsx("th",{key:`fields-element-info-row-header-${u}-${v}`,class:"esri-feature-fields__field-header",innerHTML:f}),k.tsx("td",{key:`fields-element-info-row-data-${u}-${v}`,class:this.classes("esri-feature-fields__field-data",
e),innerHTML:I}))};l.renderFields=function(){const {formattedFieldInfos:e}=this.viewModel;return e?.length?k.tsx("table",{class:"esri-widget__table",summary:this.messages.fieldsSummary},k.tsx("tbody",null,e.map((v,I)=>this.renderFieldInfo(v,I)))):null};l.render=function(){return k.tsx("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this.renderFields())};l._setupFeatureElementInfo=function(){const {description:e,title:v}=this;this._featureElementInfo?.set({description:e,title:v})};
l._forceLTR=function(e){return`&lrm;${e}`};q._createClass(z,[{key:"attributes",get:function(){return this.viewModel.attributes},set:function(e){this.viewModel.attributes=e}},{key:"description",get:function(){return this.viewModel.description},set:function(e){this.viewModel.description=e}},{key:"expressionInfos",get:function(){return this.viewModel.expressionInfos},set:function(e){this.viewModel.expressionInfos=e}},{key:"fieldInfos",get:function(){return this.viewModel.fieldInfos},set:function(e){this.viewModel.fieldInfos=
e}},{key:"title",get:function(){return this.viewModel.title},set:function(e){this.viewModel.title=e}}]);return z}(M);h.__decorate([p.property()],B.prototype,"attributes",null);h.__decorate([p.property()],B.prototype,"description",null);h.__decorate([p.property()],B.prototype,"expressionInfos",null);h.__decorate([p.property()],B.prototype,"fieldInfos",null);h.__decorate([p.property()],B.prototype,"title",null);h.__decorate([p.property({type:H,nonNullable:!0})],B.prototype,"viewModel",void 0);h.__decorate([p.property(),
y.messageBundle("esri/widgets/Feature/t9n/Feature")],B.prototype,"messages",void 0);h.__decorate([p.property(),y.messageBundle("esri/widgets/support/t9n/uriUtils")],B.prototype,"messagesURIUtils",void 0);return B=h.__decorate([N.subclass("esri.widgets.Feature.FeatureFields")],B)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b){m=function(a){function g(k){k=y.call(this,k);k.attributes=null;k.expressionInfos=null;k.description=null;k.fieldInfos=null;k.title=null;return k}q._inherits(g,a);var y=q._createSuper(g);q._createClass(g,[{key:"formattedFieldInfos",get:function(){const {expressionInfos:k,fieldInfos:l}=this,z=[];l?.forEach(t=>{if(!t.hasOwnProperty("visible")||t.visible)t=t.clone(),t.label=b.getFieldInfoLabel(t,k),z.push(t)});return z}}]);return g}(m);h.__decorate([p.property()],m.prototype,
"attributes",void 0);h.__decorate([p.property({type:[M]})],m.prototype,"expressionInfos",void 0);h.__decorate([p.property()],m.prototype,"description",void 0);h.__decorate([p.property({type:[H]})],m.prototype,"fieldInfos",void 0);h.__decorate([p.property({readOnly:!0})],m.prototype,"formattedFieldInfos",null);h.__decorate([p.property()],m.prototype,"title",void 0);return m=h.__decorate([N.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],m)})},"esri/widgets/support/uriUtils":function(){define(["exports",
"../../core/string"],function(q,h){function m(B){let D=null;p.some(K=>{K.pattern.test(B)&&(D=K);return!!D});return D}const p=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];q.autoLink=function(B,D){if("string"!==typeof D||!D)return D;const K=m(D);if(!K)return D;const N=D.match(K.pattern);
B=h.replace(h.replace(K.label,{messages:B,hierPart:N&&N[2]}),{appName:K.appName});return D.replace(K.pattern,`<a${K.target?` target="${K.target}"`:""} href="$1"${"_blank"===K.target?' rel\x3d"noreferrer"':""}>${B}</a>`)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/events ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../renderers/support/utils ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../support/chartUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../support/themeUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k,l,z,t,e){D=function(v){function I(f,d){var c=u.call(this,f,d);c._refreshTimer=null;c._refreshIntervalInfo=null;c._featureElementInfo=null;c.viewModel=new a;c.messages=null;c._getChartDependencies=async n=>{const A=await k.loadChartsModule(),{destroyed:L,viewModel:F}=q._assertThisInitialized(c);if(!L&&F&&n){var {activeMediaInfo:x}=F,R=await c._getRendererColors(A);c._renderChart({chartDiv:n,mediaInfo:x,chartsModule:A,colorMap:R})}};return c}q._inherits(I,v);var u=
q._createSuper(I);v=I.prototype;v.initialize=function(){this._featureElementInfo=new g;this.addHandles([p.watch(()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex],()=>this._setupMediaRefreshTimer(),p.initial),p.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),p.initial)])};v.destroy=function(){this._clearMediaRefreshTimer();this._featureElementInfo?.destroy()};v.render=function(){return t.tsx("div",{bind:this,class:"esri-feature-media",
onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this.renderMedia())};v.renderMedia=function(){const {formattedMediaInfoCount:f}=this.viewModel;return f?t.tsx("div",{key:"media-element-container",class:"esri-feature-media__container"},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null};v.renderImageMediaInfo=function(f){var {_refreshIntervalInfo:d}=this;const {activeMediaInfoIndex:c,formattedMediaInfoCount:n}=this.viewModel,{value:A,
refreshInterval:L,altText:F,title:x,type:R}=f,{sourceURL:G,linkURL:r}=A;f=y.shouldOpenInNewTab(r??void 0)?"_blank":"_self";const C="_blank"===f?"noreferrer":"";d=L?d:null;d=t.tsx("img",{alt:F||x,key:`media-${R}-${c}-${n}-${d?d.timestamp:0}`,src:(d?d.sourceURL:G)??void 0});return(r?t.tsx("a",{title:x,href:r,rel:C,target:f},d):null)??d};v.renderChartMediaInfo=function(f){const {activeMediaInfoIndex:d,formattedMediaInfoCount:c}=this.viewModel;return t.tsx("div",{key:`media-${f.type}-${d}-${c}`,bind:this,
class:"esri-feature-media__chart",afterCreate:this._getChartDependencies})};v.renderMediaInfoType=function(){const {activeMediaInfo:f}=this.viewModel;return f?"image"===f.type?this.renderImageMediaInfo(f):f.type.includes("chart")?this.renderChartMediaInfo(f):null:null};v.renderMediaInfo=function(){var {activeMediaInfo:f}=this.viewModel;if(!f)return null;const d=f.title?t.tsx("div",{key:"media-title",class:"esri-feature-media__item-title",innerHTML:f.title}):null;f=f.caption?t.tsx("div",{key:"media-caption",
class:"esri-feature-media__item-caption",innerHTML:f.caption}):null;return t.tsx("div",{key:"media-container",class:"esri-feature-media__item-container"},t.tsx("div",{key:"media-item-container",class:"esri-feature-media__item"},this.renderMediaInfoType()),d,f)};v.renderMediaPageButton=function(f){if(2>this.viewModel.formattedMediaInfoCount)return null;const d=(f="previous"===f)?this.messages.previous:this.messages.next,c=f?this.classes("esri-feature-media__button","esri-feature-media__previous"):
this.classes("esri-feature-media__button","esri-feature-media__next"),n=f?this.classes("esri-feature-media__icon","esri-feature-media__previous-icon","esri-icon-left-triangle-arrow"):this.classes("esri-feature-media__icon","esri-feature-media__next-icon","esri-icon-right-triangle-arrow"),A=f?this.classes("esri-feature-media__icon","esri-feature-media__previous-icon--rtl","esri-icon-right-triangle-arrow"):this.classes("esri-feature-media__icon","esri-feature-media__next-icon--rtl","esri-icon-left-triangle-arrow");
return t.tsx("button",{type:"button",key:f?"media-previous":"media-next",title:d,"aria-label":d,tabIndex:0,class:c,bind:this,onclick:f?this._previous:this._next},t.tsx("span",{"aria-hidden":"true",class:n}),t.tsx("span",{"aria-hidden":"true",class:A}))};v._setupFeatureElementInfo=function(){const {description:f,title:d}=this;this._featureElementInfo?.set({description:f,title:d})};v._next=function(){this.viewModel.next()};v._previous=function(){this.viewModel.previous()};v._getRenderer=function(){const {isAggregate:f,
layer:d}=this.viewModel;return f&&d?.featureReduction&&"renderer"in d.featureReduction?d.featureReduction.renderer:d?.renderer};v._getRendererColors=async function(f){const {am4core:d}=f,c=new Map;f=this._getRenderer();if(!f)return c;const n=await H.getColorsFromRenderer(f);n.delete("default");if(!Array.from(n.values()).every(A=>1===A?.length))return c;c.set("default-line-value",d.color({r:50,g:50,b:50,a:1}));Array.from(n.keys()).forEach(A=>{A&&c.set(A,d.color(n.get(A)?.[0].toCss(!0)))});return c};
v._handleMediaKeyup=function(f){const d=m.eventKey(f);"ArrowLeft"===d&&(f.stopPropagation(),this.viewModel.previous());"ArrowRight"===d&&(f.stopPropagation(),this.viewModel.next())};v._renderChart=function(f){const {abilities:d}=this.viewModel,{chartsModule:c,chartDiv:n,mediaInfo:A,colorMap:L}=f,{value:F,type:x}=A,{am4core:R}=c,G=k.getColorSet(R);e.isDarkTheme()&&R.useTheme(c.am4themes_dark);const r=window.matchMedia("(prefers-reduced-motion: reduce)");d.chartAnimation&&!r.matches?R.useTheme(c.am4themes_animated):
R.unuseTheme(c.am4themes_animated);R.useTheme(function(C){C instanceof R.ColorSet&&G&&(C.list=G)});f="pie-chart"===x?this._createPieChart(f):this._createXYChart(f);n.setAttribute("aria-label",A.altText||A.title);f.data=F.series.map(C=>({tooltip:C.tooltip,value:C.value,color:L.get(C.fieldName)})).filter(C=>"pie-chart"===x?null!=C.value&&0<C.value:!0)};v._customizeChartTooltip=function(f,d){f&&(f.label.wrap=!0,f.label.maxWidth=200,f.autoTextColor=!1,f.getFillFromObject=!1,f.label.fill=d.color("#ffffff"),
f.background.fill=d.color({r:0,g:0,b:0,a:.7}))};v._createPieChart=function(f){const {chartDiv:d,chartsModule:c}=f,{am4core:n,am4charts:A}=c;f=n.create(d,A.PieChart);f.rtl=l.isRTL(this.container);const L=f.series.push(new A.PieSeries);L.labels.template.disabled=!0;L.ticks.template.disabled=!0;L.dataFields.value="value";L.dataFields.category="tooltip";this._customizeChartTooltip(L.tooltip,n);L.slices.template.propertyFields.fill="color";L.slices.template.propertyFields.stroke="color";return f};v._getMinSeriesValue=
function(f){let d=0;f.forEach(c=>d=Math.min(c.value,d));return d};v._createColumnChart=function(f,d){const {chartsModule:c,mediaInfo:n}=d;({value:d}=n);const {am4core:A,am4charts:L}=c;var F=f.xAxes.push(new L.CategoryAxis);F.dataFields.category="tooltip";F.renderer.labels.template.disabled=!0;const x=F.tooltip;this._customizeChartTooltip(x,A);x.events.on("sizechanged",()=>{x.dy=-x.contentHeight});F=f.yAxes.push(new L.ValueAxis);const R=F.renderer.labels.template;F.renderer.minLabelPosition=.05;F.renderer.maxLabelPosition=
.95;F.min=this._getMinSeriesValue(d.series);this._customizeChartTooltip(F.tooltip,A);R.wrap=!0;F=f.series.push(new L.ColumnSeries);F.dataFields.valueY="value";F.dataFields.categoryX="tooltip";F.columns.template.propertyFields.fill="color";F.columns.template.propertyFields.stroke="color";f.cursor=new L.XYCursor;15<d.series.length&&(f.scrollbarX=new A.Scrollbar)};v._createBarChart=function(f,d){const {chartsModule:c,mediaInfo:n}=d;({value:d}=n);const {am4core:A,am4charts:L}=c;var F=f.yAxes.push(new L.CategoryAxis);
F.dataFields.category="tooltip";F.renderer.inversed=!0;F.renderer.labels.template.disabled=!0;const x=F.tooltip;this._customizeChartTooltip(x,A);x.events.on("sizechanged",()=>{x.dx=x.contentWidth});F=f.xAxes.push(new L.ValueAxis);const R=F.renderer.labels.template;F.renderer.minLabelPosition=.05;F.renderer.maxLabelPosition=.95;F.min=this._getMinSeriesValue(d.series);this._customizeChartTooltip(F.tooltip,A);R.wrap=!0;F=f.series.push(new L.ColumnSeries);F.dataFields.valueX="value";F.dataFields.categoryY=
"tooltip";F.columns.template.propertyFields.fill="color";F.columns.template.propertyFields.stroke="color";f.cursor=new L.XYCursor;15<d.series.length&&(f.scrollbarY=new A.Scrollbar)};v._createLineChart=function(f,d){const {chartsModule:c,mediaInfo:n,colorMap:A}=d;({value:d}=n);const {am4core:L,am4charts:F}=c;var x=f.xAxes.push(new F.CategoryAxis);x.dataFields.category="tooltip";x.renderer.labels.template.disabled=!0;const R=x.tooltip;this._customizeChartTooltip(R,L);R.events.on("sizechanged",()=>{R.dy=
-R.contentHeight});x=f.yAxes.push(new F.ValueAxis);var G=x.renderer.labels.template;x.renderer.minLabelPosition=.05;x.renderer.maxLabelPosition=.95;x.min=this._getMinSeriesValue(d.series);this._customizeChartTooltip(x.tooltip,L);G.wrap=!0;x=f.series.push(new F.LineSeries);x.dataFields.categoryX="tooltip";x.dataFields.valueY="value";x.strokeWidth=1;if(G=A.get("default-line-value"))x.stroke=G;x=x.bullets.push(new F.CircleBullet);x.propertyFields.fill="color";x.propertyFields.stroke="color";f.cursor=
new F.XYCursor;15<d.series.length&&(f.scrollbarX=new L.Scrollbar)};v._createXYChart=function(f){const {chartDiv:d,chartsModule:c,mediaInfo:n}=f,{type:A}=n,{am4core:L,am4charts:F}=c,x=L.create(d,F.XYChart);x.rtl=l.isRTL(this.container);"column-chart"===A&&this._createColumnChart(x,f);"bar-chart"===A&&this._createBarChart(x,f);"line-chart"===A&&this._createLineChart(x,f);return x};v._clearMediaRefreshTimer=function(){const {_refreshTimer:f}=this;f&&(clearTimeout(f),this._refreshTimer=null)};v._updateMediaInfoTimestamp=
function(f){const d=Date.now();this._refreshIntervalInfo={timestamp:d,sourceURL:f&&this._getImageSource(f,d)};this.scheduleRender()};v._setupMediaRefreshTimer=function(){this._clearMediaRefreshTimer();const {activeMediaInfo:f}=this.viewModel;f&&"image"===f.type&&f.refreshInterval&&this._setRefreshTimeout(f)};v._setRefreshTimeout=function(f){const {refreshInterval:d,value:c}=f;d&&(f=6E4*d,this._updateMediaInfoTimestamp(c.sourceURL),this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(c.sourceURL)},
f))};v._getImageSource=function(f,d){const c=f.includes("?")?"\x26":"?",[n,A=""]=f.split("#");return`${n}${c}timestamp=${d}${A?"#":""}${A}`};q._createClass(I,[{key:"attributes",get:function(){return this.viewModel.attributes},set:function(f){this.viewModel.attributes=f}},{key:"activeMediaInfoIndex",get:function(){return this.viewModel.activeMediaInfoIndex},set:function(f){this.viewModel.activeMediaInfoIndex=f}},{key:"description",get:function(){return this.viewModel.description},set:function(f){this.viewModel.description=
f}},{key:"fieldInfoMap",get:function(){return this.viewModel.fieldInfoMap},set:function(f){this.viewModel.fieldInfoMap=f}},{key:"layer",get:function(){return this.viewModel.layer},set:function(f){this.viewModel.layer=f}},{key:"mediaInfos",get:function(){return this.viewModel.mediaInfos},set:function(f){this.viewModel.mediaInfos=f}},{key:"popupTemplate",get:function(){return this.viewModel.popupTemplate},set:function(f){this.viewModel.popupTemplate=f}},{key:"relatedInfos",get:function(){return this.viewModel.relatedInfos},
set:function(f){this.viewModel.relatedInfos=f}},{key:"title",get:function(){return this.viewModel.title},set:function(f){this.viewModel.title=f}}]);return I}(b);h.__decorate([B.property()],D.prototype,"attributes",null);h.__decorate([B.property()],D.prototype,"activeMediaInfoIndex",null);h.__decorate([B.property()],D.prototype,"description",null);h.__decorate([B.property()],D.prototype,"fieldInfoMap",null);h.__decorate([B.property()],D.prototype,"layer",null);h.__decorate([B.property()],D.prototype,
"mediaInfos",null);h.__decorate([B.property()],D.prototype,"popupTemplate",null);h.__decorate([B.property()],D.prototype,"relatedInfos",null);h.__decorate([B.property()],D.prototype,"title",null);h.__decorate([B.property({type:a})],D.prototype,"viewModel",void 0);h.__decorate([B.property(),z.messageBundle("esri/widgets/Feature/t9n/Feature")],D.prototype,"messages",void 0);return D=h.__decorate([M.subclass("esri.widgets.Feature.FeatureMedia")],D)})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../core/maybe ../../intl/date ./numberUtils ../visualVariables/support/ColorStop ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b){async function a(e,v,I){p.getOrCreateMapValue(e,v,()=>[]).push(...I)}function g(e){let v=e.minValue,I=e.maxValue;const u=e.isFirstBreak?"":l.gt+" ";e="percent-of-total"===e.normalizationType?l.pct:"";v=null==v?"":K.format(v);I=null==I?"":K.format(I);return u+v+e+" "+l.ld+" "+I+e}function y(e,v){return"normalizationField"in e&&e.normalizationField?{type:"normalized-field",field:e.field,normalizationField:e.normalizationField}:"field"in e&&e.field?{type:"field",field:e.field}:
"valueExpression"in e&&e.valueExpression?{type:"expression",expression:e.valueExpression,title:e.valueExpressionTitle,returnType:v}:null}const k=m.getLogger("esri.renderers.support.utils"),l={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},z={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},t={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",
month:"long-month-day-year",year:"year"};m=D.convertDateFormatToIntlOptions("short-date");q.calculateDateFormatInterval=function(e){e=e.map(d=>new Date(d));const v=e.length;let I=Infinity,u=null;for(let d=0;d<v-1;d++){const c=e[d];let n=Infinity,A=null;for(let L=d+1;L<v;L++){var f=e[L];f=c.getFullYear()!==f.getFullYear()&&"year"||c.getMonth()!==f.getMonth()&&"month"||c.getDate()!==f.getDate()&&"day"||c.getHours()!==f.getHours()&&"hour"||c.getMinutes()!==f.getMinutes()&&"minute"||c.getSeconds()!==
f.getSeconds()&&"second"||"millisecond";const F=z[f];F<n&&(n=F,A=f)}n<I&&(I=n,u=A)}return u};q.createClassBreakLabel=g;q.createColorStops=function(e){const {values:v,colors:I,labelIndexes:u,isDate:f,dateFormatOptions:d}=e;return v.map((c,n)=>{var A=null;if(!u||u.includes(n)){let L;if(L=f?D.formatDate(c,d):K.format(c))A="",0===n?A=l.lt+" ":n===v.length-1&&(A=l.gt+" "),A+=L}return new N({value:c,color:I[n],label:A})})};q.createUniqueValueLabel=function(e){const {value:v,domain:I,fieldInfo:u,dateFormatInterval:f}=
e;e=String(v);const d=I&&"codedValues"in I&&I.codedValues?I.getName(v):null;d?e=d:"number"===typeof v&&(e=u&&"date"===u.type?D.formatDate(v,f&&D.convertDateFormatToIntlOptions(t[f])):K.format(v));return e};q.getAttribute=y;q.getAttributes=function(e,v){const I=[];if("class-breaks"===e.type||"heatmap"===e.type)I.push(y(e,"number"));else if("unique-value"===e.type){var u=e.authoringInfo;if(u&&"relationship"===u.type){if(u.field1&&u.field2){var f=u.field2.field;const d=u.field2.normalizationField;I.push(y({field:u.field1.field,
normalizationField:u.field1.normalizationField}));I.push(y({field:f,normalizationField:d}))}}else f=e.uniqueValueInfos?.[0],u=null,f&&f.value&&(f=typeof e.uniqueValueInfos[0].value,"string"===f||"number"===f)&&(u=f),I.push(y(e,u)),[e.field2,e.field3].forEach(d=>d&&I.push({type:"field",field:d}))}else"attributes"in e&&e.attributes?.forEach(d=>I.push(y(d,"number")));(e=v?v(e):"visualVariables"in e?e.visualVariables:null)&&e.forEach(d=>I.push(y(d,"number")));return h.unique(I.filter(B.isSome),(d,c)=>
"field"===d.type&&"field"===c.type?d.field===c.field:"normalized-field"===d.type&&"normalized-field"===c.type?d.field===c.field&&d.normalizationField===c.normalizationField:"expression"===d.type&&"expression"===c.type?d.expression===c.expression:!1)};q.getColorsFromRenderer=async function(e){const v=new Map;if(!e)return v;if("visualVariables"in e&&e.visualVariables){var I=e.visualVariables.filter(f=>"color"===f.type);for(var u of I)I=(await H.getRampStops(u)??[]).map(f=>f.color),await a(v,u.field||
u.valueExpression,I)}if("heatmap"===e.type)u=b.getHeatmapRampStops(e).map(f=>f.color),await a(v,e.field||e.valueExpression,u);else if("pie-chart"===e.type){for(const f of e.attributes)await a(v,f.field||f.valueExpression,[f.color]);await a(v,"default",[e?.othersCategory?.color,M.getColorFromSymbol(e.backgroundFillSymbol,null)])}else if("dot-density"===e.type){for(const f of e.attributes)await a(v,f.field||f.valueExpression,[f.color]);await a(v,"default",[e.backgroundColor])}else if("unique-value"===
e.type)if("predominance"===e.authoringInfo?.type)for(const f of e.uniqueValueInfos??[])await a(v,f.value.toString(),[M.getColorFromSymbol(f.symbol,null)]);else{u=(e.uniqueValueInfos??[]).map(A=>M.getColorFromSymbol(A.symbol,null));const {field:f,field2:d,field3:c,valueExpression:n}=e;(f||n)&&await a(v,f||n,u);d&&await a(v,d,u);c&&await a(v,c,u)}else if("class-breaks"===e.type){u=e.classBreakInfos.map(c=>M.getColorFromSymbol(c.symbol,null));const {field:f,valueExpression:d}=e;await a(v,f??d,u)}else"simple"===
e.type&&await a(v,"default",[M.getColorFromSymbol(e.symbol,null)]);"defaultSymbol"in e&&e.defaultSymbol&&await a(v,"default",[M.getColorFromSymbol(e.defaultSymbol,null)]);v.forEach((f,d)=>{f=h.unique(f.filter(Boolean),(c,n)=>JSON.stringify(c)===JSON.stringify(n));v.set(d,f)});return v};q.setLabelsForClassBreaks=function(e){const v=e.classBreakInfos,I=e.normalizationType;let u=[];if(v&&v.length)if("standard-deviation"===e.classificationMethod)k.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(e.round){u.push(v[0].minValue);for(const f of v)u.push(f.maxValue);u=K.round(u);v.forEach((f,d)=>{f.label=g({minValue:0===d?u[0]:u[d],maxValue:u[d+1],isFirstBreak:0===d,normalizationType:I})})}else v.forEach((f,d)=>{f.label=g({minValue:f.minValue,maxValue:f.maxValue,isFirstBreak:0===d,normalizationType:I})})};q.timelineDateFormatOptions=m;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],
function(q,h,m){function p(b,a){return b-a}function B(b,a){let g;g=Number(b.toFixed(a));g<b?b=g+1/10**a:(b=g,g-=1/10**a);g=Number(g.toFixed(a));b=Number(b.toFixed(a));return[g,b]}function D(b,a,g,y,k){b=N(b,a,g,y);a=null==b.next||b.next<=k;return(null==b.previous||b.previous<=k)&&a||b.previous+b.next<=2*k}function K(b){b=String(b);var a=b.match(M);if(a&&a[1])return{integer:a[1].split("").length,fractional:a[3]?a[3].split("").length:0};if(b.toLowerCase().includes("e")&&(a=b.split("e"),b=a[0],a=a[1],
b&&a)){b=Number(b);a=Number(a);const g=0<a;g||(a=Math.abs(a));b=K(b);g?(b.integer+=a,b.fractional=a>b.fractional?0:b.fractional-a):(b.fractional+=a,b.integer=a>b.integer?1:b.integer-a);return b}return{integer:0,fractional:0}}function N(b,a,g,y){const k={previous:null,next:null};if(null!=g){const l=b-g;k.previous=Math.floor(Math.abs(100*(a-g-l)/l))}null!=y&&(b=y-b,k.next=Math.floor(Math.abs(100*(y-a-b)/b)));return k}const M=/^-?(\d+)(\.(\d+))?$/i,H={maximumFractionDigits:20};q.format=function(b){return m.formatNumber(b,
H)};q.numDigits=K;q.percentChange=N;q.round=function(b,a={}){b=b.slice(0);const {tolerance:g=2,strictBounds:y=!1,indexes:k=b.map((z,t)=>t)}=a;k.sort(p);for(a=0;a<k.length;a++){const z=k[a],t=b[z],e=0===z?null:b[z-1],v=z===b.length-1?null:b[z+1],I=K(t).fractional;if(I){let u=0,f=!1;for(var l=void 0;u<=I&&!f;)l=B(t,u),l=y&&0===a?l[1]:l[0],f=D(t,l,e,v,g),u++;f&&(b[z]=l)}}return b};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a){function g(d){d=d.symbolLayers;if(!d)return null;let c=null;d.forEach(n=>{if("object"!==n.type||null==n.resource?.href)c="water"===n.type?K.unwrap(n.color):K.isSome(n.material)?K.unwrap(n.material.color):null});return c?new m(c):null}function y(d,c){if(null==c||null==d)return d;d=d.toRgba();d[3]*=c;return new m(d)}function k(d,c,n){if(d=d.symbolLayers){var A=L=>{L=K.isSome(L)?L:null;c=c??L??(null!=n?f:null);return y(c,n)};d.forEach(L=>{if("object"!==L.type||null==
L.resource?.href||c)if("water"===L.type)L.color=A(L.color);else{var F=K.isSome(L.material)?L.material.color:null;F=A(F);K.isNone(L.material)?L.material=new a.Symbol3DMaterial({color:F}):L.material.color=F;null!=n&&"outline"in L&&K.isSome(L.outline)&&K.isSome(L.outline.color)&&(L.outline.color=y(L.outline.color,n))}})}}async function l(d,c){(d=d.symbolLayers)&&await B.forEach(d,async n=>z(n,c))}async function z(d,c){switch(d.type){case "extrude":d.size="number"===typeof c[2]?c[2]:0;break;case "icon":case "line":case "text":c=
t(c);K.isSome(c)&&(d.size=c);break;case "path":const n=v(c,M.ONES,[d.width,void 0,d.height]);d.width=u(c[0],d.width,1,n);d.height=u(c[2],d.height,1,n);break;case "object":await e(d,c)}}function t(d){for(const c of d)if("number"===typeof c)return c;return null}async function e(d,c){const {resourceSize:n,symbolSize:A}=await I(d),L=v(c,n,A);d.width=u(c[0],A[0],n[0],L);d.depth=u(c[1],A[1],n[1],L);d.height=u(c[2],A[2],n[2],L)}function v(d,c,n){for(let A=0;3>A;A++){const L=d[A];switch(L){case "symbol-value":return d=
n[A],null!=d?d/c[A]:1;case "proportional":break;default:if(L&&c[A])return L/c[A]}}return 1}async function I(d){const c=await (await new Promise((R,G)=>q(["./symbolLayerUtils"],R,G))).computeObjectLayerResourceSize(d,10),{width:n,height:A,depth:L}=d;d=[n,L,A];let F=1;for(var x=0;3>x;x++){const R=d[x];if(null!=R){F=R/c[x];break}}for(x=0;3>x;x++)null==d[x]&&(d[x]=c[x]*F);return{resourceSize:c,symbolSize:d}}function u(d,c,n,A){switch(d){case "proportional":return n*A;case "symbol-value":return null!=
c?c:n;default:return d}}const f=new m("white");h.applyColorToSymbol=function(d,c,n){if(d&&(c||null!=n))if(c&&(c=new m(c)),p.isSymbol3D(d))k(d,c,n);else if(p.isSymbol2D(d)){if(c=c??d.color)d.color=y(c,n);null!=n&&"outline"in d&&d.outline&&d.outline.color&&(d.outline.color=y(d.outline.color,n))}};h.applyOpacityToColor=y;h.applyRotationToSymbol=function(d,c,n){d&&null!=c&&(p.isSymbol3D(d)?(d=d.symbolLayers)&&d.forEach(A=>{if(A&&"object"===A.type)switch(n){case "tilt":A.tilt=c;break;case "roll":A.roll=
c;break;default:A.heading=c}}):!p.isSymbol2D(d)||"simple-marker"!==d.type&&"picture-marker"!==d.type&&"text"!==d.type||(d.angle=c))};h.applySizesToSymbol=async function(d,c){if(d&&c){if(p.isSymbol3D(d))return l(d,c);if(p.isSymbol2D(d)&&(c=t(c),!K.isNone(c)))switch(d.type){case "simple-marker":d.size=c;break;case "picture-marker":const n=d.width/d.height;1<n?(d.width=c,d.height=c*n):(d.width=c*n,d.height=c);break;case "simple-line":d.width=c;break;case "text":d.font.size=c}}};h.fetchWebStyleSymbol=
async function(d,c){const n=await d.fetchSymbol(c);return n?n:d.fetchCIMSymbol(c)};h.getCSSFilterFromEffectList=function(d){if(!d)return null;d=d.effects.filter(c=>"bloom"!==c.type).map(c=>c.toJSON());return H.effectFunctionsFromJSON(d)};h.getColorFromSymbol=function(d,c){if(!d)return null;let n=null;p.isSymbol3D(d)?n=g(d):p.isSymbol2D(d)&&(n=d.color?new m(d.color):null);return n?y(n,c):null};h.getIconHref=function(d){return K.unwrapOrThrow(d.resource).href};h.getSymbolOutlineSize=function(d){if(!d)return 0;
if(p.isSymbol3D(d)){{const c=d.symbolLayers&&d.symbolLayers.length;c?(d=d.symbolLayers.getItemAt(c-1),d="outline"in d?K.get(d,"outline","size"):void 0):d=void 0}return K.isSome(d)?d:0}return N.px2pt(b.getStroke(d)?.width)};h.isVolumetricSymbol=function(d){if(K.isNone(d)||!("symbolLayers"in d)||K.isNone(d.symbolLayers))return!1;switch(d.type){case "point-3d":return d.symbolLayers.some(c=>"object"===c.type);case "line-3d":return d.symbolLayers.some(c=>"path"===c.type);case "polygon-3d":return d.symbolLayers.some(c=>
"object"===c.type||"extrude"===c.type);default:return!1}};h.symbolHasExtrudeSymbolLayer=function(d){return K.isSome(d)&&"polygon-3d"===d.type&&d.symbolLayers.some(c=>"extrude"===c.type)};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(q,h,m,p,B,D,K){function N(b){if(!b)return null;let a=null;switch(b.type){case "simple-fill":case "picture-fill":case "simple-marker":a=
N(b.outline);break;case "simple-line":const g=D.pt2px(b.width);null!=b.style&&"none"!==b.style&&0!==g&&(a={color:b.color,style:H(b.style),width:g,cap:b.cap,join:"miter"===b.join?D.pt2px(b.miterLimit):b.join});break;default:a=null}return a}const M=new B(1E3),H=(()=>{const b={};return a=>{if(b[a])return b[a];const g=a.replace(/-/g,"");return b[a]=g}})();m=new m([128,128,128]);q.defaultThematicColor=m;q.dekebabifyLineStyle=H;q.getFill=function(b){const a=b.style;let g=null;if(b)switch(b.type){case "simple-marker":"cross"!==
a&&"x"!==a&&(g=b.color);break;case "simple-fill":"solid"===a?g=b.color:"none"!==a&&(g={type:"pattern",x:0,y:0,src:h.getAssetUrl(`esri/symbols/patterns/${a}.png`),width:5,height:5});break;case "picture-fill":g={type:"pattern",src:b.url,width:D.pt2px(b.width)*b.xscale,height:D.pt2px(b.height)*b.yscale,x:D.pt2px(b.xoffset),y:D.pt2px(b.yoffset)};break;case "text":g=b.color;break;case "cim":g=K.getCIMSymbolColor(b)}return g};q.getPatternUrlWithColor=function(b,a){const g=b+"-"+a;return void 0!==M.get(g)?
Promise.resolve(M.get(g)):p(b,{responseType:"image"}).then(y=>{y=y.data;const k=y.naturalWidth,l=y.naturalHeight,z=document.createElement("canvas");z.width=k;z.height=l;const t=z.getContext("2d");t.fillStyle=a;t.fillRect(0,0,k,l);t.globalCompositeOperation="destination-in";t.drawImage(y,0,0);y=z.toDataURL();M.put(g,y);return y})};q.getStroke=N;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],
function(q,h){return function(){function m(B,D){this._storage=new h.MemCacheStorage;this._storage.maxSize=B;D&&this._storage.registerRemoveFunc("",D)}var p=m.prototype;p.put=function(B,D){this._storage.put(B,D,1,1)};p.pop=function(B){return this._storage.pop(B)};p.get=function(B){return this._storage.get(B)};p.clear=function(){this._storage.clearAll()};p.destroy=function(){this._storage.destroy()};return q._createClass(m)}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color",
"../cim/utils"],function(q,h,m){function p(a){a=m.toCIMSymbolJSON(a);if("CIMTextSymbol"===a?.type)return a.height??0;let g=0;if(a?.symbolLayers)for(const y of a.symbolLayers)m.isCIMMarker(y)&&null!=y.size&&y.size>g?g=y.size:m.isCIMStroke(y)&&null!=y.width&&y.width>g?g=y.width:m.isCIMFill(y);return g}function B(a,g,y,k){if(a)if("CIMTextSymbol"===a.type)null!=a.height&&(a.height*=g);else{if(y&&a.effects)for(const l of a.effects)N(l,g);if(a.symbolLayers)for(const l of a.symbolLayers)switch(l.type){case "CIMPictureMarker":case "CIMVectorMarker":D(l,
g,k);break;case "CIMPictureStroke":case "CIMSolidStroke":!k?.preserveOutlineWidth&&l.width&&(l.width*=g);break;case "CIMPictureFill":l.height&&(l.height*=g);l.offsetX&&(l.offsetX*=g);l.offsetY&&(l.offsetY*=g);break;case "CIMHatchFill":B(l.lineSymbol,g,!0,{...k,preserveOutlineWidth:!1}),l.offsetX&&(l.offsetX*=g),l.offsetY&&(l.offsetY*=g),l.separation&&(l.separation*=g)}}}function D(a,g,y){if(a&&(a.markerPlacement&&K(a.markerPlacement,g),a.offsetX&&(a.offsetX*=g),a.offsetY&&(a.offsetY*=g),a.anchorPoint&&
"Absolute"===a.anchorPointUnits&&(a.anchorPoint={x:a.anchorPoint.x*g,y:a.anchorPoint.y*g}),a.size=null!=a.size?a.size*g:0,"CIMVectorMarker"===a.type&&a.markerGraphics))for(const k of a.markerGraphics)a.scaleSymbolsProportionally||B(k.symbol,g,!0,y)}function K(a,g){m.isCIMMarkerStrokePlacement(a)&&a.offset&&(a.offset*=g);switch(a.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":a.customEndingOffset&&(a.customEndingOffset*=g);a.offsetAlongLine&&(a.offsetAlongLine*=
g);if(a.placementTemplate&&a.placementTemplate.length){var y=a.placementTemplate.map(k=>k*g);a.placementTemplate=y}break;case "CIMMarkerPlacementAlongLineVariableSize":a.maxRandomOffset&&(a.maxRandomOffset*=g);a.placementTemplate&&a.placementTemplate.length&&(y=a.placementTemplate.map(k=>k*g),a.placementTemplate=y);break;case "CIMMarkerPlacementOnLine":a.startPointOffset&&(a.startPointOffset*=g);break;case "CIMMarkerPlacementAtExtremities":a.offsetAlongLine&&(a.offsetAlongLine*=g);break;case "CIMMarkerPlacementAtRatioPositions":a.beginPosition&&
(a.beginPosition*=g);a.endPosition&&(a.endPosition*=g);break;case "CIMMarkerPlacementPolygonCenter":a.offsetX&&(a.offsetX*=g);a.offsetY&&(a.offsetY*=g);break;case "CIMMarkerPlacementInsidePolygon":a.offsetX&&(a.offsetX*=g),a.offsetY&&(a.offsetY*=g),a.stepX&&(a.stepX*=g),a.stepY&&(a.stepY*=g)}}function N(a,g){switch(a.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":a.width&&(a.width*=g);break;case "CIMGeometricEffectBuffer":a.size&&(a.size*=g);break;case "CIMGeometricEffectCut":a.beginCut&&
(a.beginCut*=g);a.endCut&&(a.endCut*=g);a.middleCut&&(a.middleCut*=g);break;case "CIMGeometricEffectDashes":a.customEndingOffset&&(a.customEndingOffset*=g);a.offsetAlongLine&&(a.offsetAlongLine*=g);if(a.dashTemplate&&a.dashTemplate.length){const y=a.dashTemplate.map(k=>k*g);a.dashTemplate=y}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":a.length&&(a.length*=g);break;case "CIMGeometricEffectMove":a.offsetX&&(a.offsetX*=g);a.offsetY&&(a.offsetY*=
g);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":a.offset&&(a.offset*=g);break;case "CIMGeometricEffectRegularPolygon":a.radius&&(a.radius*=g);break;case "CIMGeometricEffectTaperedPolygon":a.fromWidth&&(a.fromWidth*=g);a.length&&(a.length*=g);a.toWidth&&(a.toWidth*=g);break;case "CIMGeometricEffectWave":a.amplitude&&(a.amplitude*=g),a.period&&(a.period*=g)}}function M(a,g){if(a){var y="CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===a.type;if(y?.symbolLayers)for(const k of y.symbolLayers)if(!(k.colorLocked||
a&&(m.isCIMStroke(k)||m.isCIMMarker(k)&&k.markerPlacement&&m.isCIMMarkerStrokePlacement(k.markerPlacement))))switch(k.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":k.tintColor&&H(g,k.tintColor);break;case "CIMVectorMarker":k.markerGraphics?.forEach(l=>{M(l.symbol,g)});break;case "CIMSolidStroke":case "CIMSolidFill":H(g,k.color);break;case "CIMHatchFill":M(k.lineSymbol,g)}}}function H(a,g){for(const y of a)if(y.join(".")===g.join("."))return;a.push(g)}function b(a,g,y){if(a){var k=
"CIMTextSymbol"===a.type?a.symbol:a;a="CIMPolygonSymbol"===k?.type;if(k?.symbolLayers)for(const l of k.symbolLayers)if(!l.colorLocked){if(a)if(y){if({layersToColor:k}=y,(m.isCIMStroke(l)||m.isCIMMarker(l)&&l.markerPlacement&&m.isCIMMarkerStrokePlacement(l.markerPlacement))&&"fill"===k||m.isCIMFill(l)&&"outline"===k)continue}else if(m.isCIMStroke(l)||m.isCIMMarker(l)&&l.markerPlacement&&m.isCIMMarkerStrokePlacement(l.markerPlacement))continue;k=g.toArray();switch(l.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":l.tintColor=
k;break;case "CIMVectorMarker":l.markerGraphics?.forEach(z=>{b(z.symbol,g,y)});break;case "CIMSolidStroke":case "CIMSolidFill":l.color=k;break;case "CIMHatchFill":b(l.lineSymbol,g,y)}}}}q.applyCIMSymbolColor=function(a,g,y){g instanceof h||(g=new h(g));(a=m.toCIMSymbolJSON(a))&&b(a,g,y)};q.applyCIMSymbolRotation=function(a,g,y=!1){a=m.toCIMSymbolJSON(a);y&&0!==g&&(g=360-g);if("CIMTextSymbol"===a?.type)a.angle=g;else if("CIMPointSymbol"===a?.type&&a.symbolLayers){y=g-(a.angle||0);for(const k of a.symbolLayers)if(m.isCIMMarker(k)){let l=
k.rotation||0;l=k.rotateClockwise?l-y:l+y;k.rotation=l}a.angle=g}};q.getCIMSymbolColor=function(a){a=m.toCIMSymbolJSON(a);const g=[];M(a,g);return g.length?new h(m.fromCIMColor(g[0])):null};q.getCIMSymbolRotation=function(a,g=!1){a=m.toCIMSymbolJSON(a);return"CIMTextSymbol"===a?.type||"CIMPointSymbol"===a?.type?(a=a.angle,null!=a&&0!==a&&g?360-a:a??0):0};q.getCIMSymbolSize=p;q.getCIMSymbolType=function(a){a=m.toCIMSymbolJSON(a);if(!a)return null;switch(a.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};q.scaleCIMMarker=D;q.scaleCIMSymbol=B;q.scaleCIMSymbolTo=function(a,g,y){if(a){var k=m.toCIMSymbolJSON(a);a=p(a);if(0===a){if(k)if("CIMTextSymbol"===k.type)k.height=g;else if(k.symbolLayers)for(const l of k.symbolLayers)switch(l.type){case "CIMPictureMarker":case "CIMVectorMarker":l.size=g;break;case "CIMPictureStroke":case "CIMSolidStroke":l.width=
g}}else B(k,g/a,!1,y)}};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(q,h){function m(b){let a=b.length;for(;a--;)if(!" /-,\n".includes(b.charAt(a)))return!1;return!0}function p(b,a){const g=[];var y=0;let k=-1;do k=b.indexOf("[",y),k>=y&&(k>y&&(y=b.substr(y,k-y),g.push([y,null,m(y)])),y=k+1,k=b.indexOf("]",y),k>=y&&(k>y&&(y=b.substr(y,k-y),(y=a[y])&&g.push([null,y,!1])),y=k+1));while(-1!==k);y<b.length-1&&
(b=b.substr(y),g.push([b,null,m(b)]));return g}function B(b,a,g){let y="",k=null;for(const l of a){const [z,t,e]=l;if(z)e?k=z:(k&&(y+=k,k=null),y+=z);else if(a=b.attributes[t])k&&(y+=k,k=null),y+=a}return D(y,g)}function D(b,a){"string"!==typeof b&&(b=String(b));switch(a){case "LowerCase":return b.toLowerCase();case "Allcaps":return b.toUpperCase();default:return b}}function K(b){return b?{r:b[0],g:b[1],b:b[2],a:b[3]/255}:{r:0,g:0,b:0,a:0}}function N(b){if(!b)return null;switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers)for(const a of b.symbolLayers)if(b=
N(a),null!=b)return b;break;case "CIMTextSymbol":return N(b.symbol);case "CIMSolidFill":return b.color}}function M(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b=b.symbolLayers)for(const a of b)if(b=M(a),null!=b)return b;break;case "CIMTextSymbol":return M(b.symbol);case "CIMSolidStroke":case "CIMSolidFill":return b.color}}function H(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers)for(const a of b.symbolLayers)if(b=H(a),void 0!==b)return b;
break;case "CIMTextSymbol":return H(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}}h.adjustTextCase=D;h.analyzeTextParts=p;h.assignTextValuesFromFeature=B;h.attributesToFields=function(b){return(b?Object.keys(b):[]).map(a=>({name:a,alias:a,type:"string"===typeof b[a]?"esriFieldTypeString":"esriFieldTypeDouble"}))};h.colorToArray=function(b){return[b.r,b.g,b.b,b.a]};h.createLabelOverrideFunction=function(b,a,g){const y=p(a,b);return k=>B(k,y,g)};h.evaluateValueOrFunction=
function(b,a,g,y){return"function"===typeof b?b(a,g,y):b};h.fromCIMColor=K;h.fromCIMFontDecoration=function(b){return b.underline?"underline":b.strikethrough?"line-through":"none"};h.fromCIMFontStyle=function(b){let a="",g="";b&&(b=b.toLowerCase(),b.includes("italic")?a="italic":b.includes("oblique")&&(a="oblique"),b.includes("bold")?g="bold":b.includes("light")&&(g="lighter"));return{style:a,weight:g}};h.fromCIMHorizontalAlignment=function(b){switch(b){default:return"left";case "Right":return"right";
case "Center":return"center";case "Justify":return"center"}};h.fromCIMVerticalAlignment=function(b){switch(b){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};h.getFillColor=N;h.getFontStyle=function(b){if(!b)return"normal";switch(b.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};h.getFontWeight=function(b){if(!b)return"normal";switch(b.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";
case "lighter":return"lighter";default:return"normal"}};h.getStrokeColor=M;h.getStrokeWidth=H;h.getTintColor=b=>b.tintColor?K(b.tintColor):{r:255,g:255,b:255,a:1};h.getValue=(b,a=0)=>null==b||isNaN(b)?a:b;h.importGeometryEngine=function(){return new Promise((b,a)=>q(["../../geometry/geometryEngineJSON"],b,a))};h.isCIMFill=function(b){return null!=b&&("CIMGradientFill"===b.type||"CIMHatchFill"===b.type||"CIMPictureFill"===b.type||"CIMSolidFill"===b.type||"CIMWaterFill"===b.type)};h.isCIMMarker=function(b){return"CIMVectorMarker"===
b.type||"CIMPictureMarker"===b.type||"CIMBarChartMarker"===b.type||"CIMCharacterMarker"===b.type||"CIMPieChartMarker"===b.type||"CIMStackedBarChartMarker"===b.type};h.isCIMMarkerStrokePlacement=function(b){return null!=b&&("CIMMarkerPlacementAlongLineRandomSize"===b.type||"CIMMarkerPlacementAlongLineSameSize"===b.type||"CIMMarkerPlacementAlongLineVariableSize"===b.type||"CIMMarkerPlacementAtExtremities"===b.type||"CIMMarkerPlacementAtMeasuredUnits"===b.type||"CIMMarkerPlacementAtRatioPositions"===
b.type||"CIMMarkerPlacementOnLine"===b.type||"CIMMarkerPlacementOnVertices"===b.type)};h.isCIMStroke=function(b){return"CIMGradientStroke"===b.type||"CIMPictureStroke"===b.type||"CIMSolidStroke"===b.type};h.isGeometryEngineRequired=b=>{if(!b)return!1;for(const a of b)switch(a.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};h.isSVGImage=b=>b.includes("data:image/svg+xml");h.mapCIMSymbolToGeometryType=function(b){if(!b)return null;
switch(b.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};h.resampleHermite=function(b,a,g,y,k,l,z=!0){const t=a/k;g/=l;const e=Math.ceil(t/2),v=Math.ceil(g/2);for(let f=0;f<l;f++)for(let d=0;d<k;d++){const c=4*(d+(z?l-f-1:f)*k);var I=0;let n=0,A=0,L=0,F=0,x=0,R=0;const G=(f+.5)*g;for(let r=Math.floor(f*g);r<(f+1)*g;r++){var u=Math.abs(G-(r+.5))/v;const C=
(d+.5)*t;u*=u;for(let O=Math.floor(d*t);O<(d+1)*t;O++){let P=Math.abs(C-(O+.5))/e;I=Math.sqrt(u+P*P);-1<=I&&1>=I&&(I=2*I*I*I-3*I*I+1,0<I&&(P=4*(O+r*a),R+=I*b[P+3],A+=I,255>b[P+3]&&(I=I*b[P+3]/250),L+=I*b[P],F+=I*b[P+1],x+=I*b[P+2],n+=I))}}y[c]=L/n;y[c+1]=F/n;y[c+2]=x/n;y[c+3]=R/A}};h.toCIMSymbolJSON=function(b){return b.data?.symbol??null};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color",
"./utils"],function(q,h,m,p){function B(H,b){const a=[],g=H.length-1;5===H.length?a.push(0,2,4):a.push(0,g);return H.map((y,k)=>a.includes(k)?p.createStopLabel(y,k,g,b):null)}async function D(H,b,a){a=new m(a??M);H=(await new Promise((g,y)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],g,y))).getOpacity(b,H);null!=H&&(a.a=H);return a}function K(H,b){const {startIndex:a,endIndex:g,weight:y}=N(H,b);if(a===g)return b[a].color;H=m.blendColors(b[a].color,b[g].color,y);return new m(H)}
function N(H,b){let a=0,g=b.length-1;b.some((y,k)=>{if(H<y.value)return g=k,!0;a=k;return!1});return{startIndex:a,endIndex:g,weight:(H-b[a].value)/(b[g].value-b[a].value)}}const M=new m([64,64,64]);h.getColorFromPointCloudStops=K;h.getRampStops=async function(H,b,a){let g=!1,y=[],k=[];if(H.stops){var l=H.stops;y=l.map(t=>t.value);(g=l.some(t=>!!t.label))&&(k=l.map(t=>t.label))}l=y[y.length-1];if(null==y[0]&&null==l)return null;const z=g?null:B(y,a??!1);return(await Promise.all(y.map(async(t,e)=>{const v=
"opacity"===H.type?await D(t,H,b):(await new Promise((I,u)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],I,u))).getColor(H,t);return{value:t,color:v,label:g?k[e]:z?.[e]??""}}))).reverse()};h.getRampStopsForPointCloud=function(H){let b=!1,a=[],g=[];a=H.map(l=>l.value);(b=H.some(l=>!!l.label))&&(g=H.map(l=>l.label??""));const y=a[a.length-1];if(null==a[0]&&null==y)return null;const k=b?null:B(a,!1);return a.map((l,z)=>{const t=K(l,H);return{value:l,color:t,label:b?g[z]:k?.[z]??
""}}).reverse()};h.getStrectchRampStops=function(H,b){let a=[];if(H&&"multipart"===H.type)H.colorRamps.reverse().forEach((g,y)=>{0===y?a.push({value:b.max,color:new m(g.toColor),label:"high"}):a.push({value:null,color:new m(g.toColor),label:""});y===H.colorRamps.length-1?a.push({value:b.min,color:new m(g.fromColor),label:"low"}):a.push({value:null,color:new m(g.fromColor),label:""})});else{let g,y;H&&"algorithmic"===H.type?(g=H.fromColor,y=H.toColor):(g=[0,0,0,1],y=[255,255,255,1]);a=[{value:b.max,
color:new m(y),label:"high"},{value:b.min,color:new m(g),label:"low"}]}return a};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../intl/date ../../../renderers/support/numberUtils ../../../symbols/SimpleLineSymbol".split(" "),function(q,h,m,p,B,D){async function K(M){if(!("visualVariables"in M&&M.visualVariables))return null;M=M.visualVariables.find(a=>"color"===a.type);if(!M)return null;
var H=null,b=null;if(M.stops){if(1===M.stops.length)return M.stops[0].color;H=M.stops[0].value;b=M.stops[M.stops.length-1].value}H=null!=H&&null!=b?H+(b-H)/2:0;({getColor:b}=await new Promise((a,g)=>q(["../../../renderers/visualVariables/support/visualVariableUtils"],a,g)));return b(M,H)??null}const N=p.convertDateFormatToIntlOptions("short-date");h.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];h.SPECIAL_CHARS_GREATER_THAN="\x3e";h.SPECIAL_CHARS_LESS_THAN="\x3c";h.createStopLabel=function(M,
H,b,a){let g="";0===H?g="\x3c ":H===b&&(g="\x3e ");H=null;H=a?p.formatDate(M,N):B.format(M);return g+H};h.getMedianColor=K;h.getSymbolForFlowRenderer=async function(M,H){const b=M.trailCap,a=M.trailWidth||1;M=H||await K(M)||M.color;return new D({cap:b,color:M,width:a})};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(q,h){q.getHeatmapRampStops=function(m){if(!m.colorStops)return[];
const p=[...m.colorStops].filter(D=>0<D.color?.a);let B=p.length-1;if(p&&p[0]){const D=p[B];D&&1!==D.ratio&&(p.push(new h({ratio:1,color:D.color})),B++)}return p.map((D,K)=>{let N="";0===K?N=m.legendOptions?.minLabel||"low":K===B&&(N=m.legendOptions?.maxLabel||"high");return{color:D.color,label:N,ratio:D.ratio}}).reverse()};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g){const y={chartAnimation:!0};m=function(k){function l(t){t=z.call(this,t);t.abilities={...y};t.activeMediaInfoIndex=0;t.attributes=null;t.description=null;t.fieldInfoMap=null;t.formattedAttributes=null;t.expressionAttributes=null;t.isAggregate=!1;t.layer=null;t.mediaInfos=null;t.popupTemplate=null;t.relatedInfos=null;t.title=null;return t}q._inherits(l,k);var z=q._createSuper(l);k=l.prototype;k.castAbilities=function(t){return{...y,...t}};k.setActiveMedia=function(t){this._setContentElementMedia(t)};
k.next=function(){this._pageContentElementMedia(1)};k.previous=function(){this._pageContentElementMedia(-1)};k._setContentElementMedia=function(t){const {formattedMediaInfoCount:e}=this;this.activeMediaInfoIndex=(t+e)%e};k._pageContentElementMedia=function(t){const {activeMediaInfoIndex:e}=this;this._setContentElementMedia(e+t)};k._formatMediaInfos=function(){const {mediaInfos:t,layer:e}=this,v=this.attributes??{},I=this.formattedAttributes??{},u=this.expressionAttributes??{},f=this.fieldInfoMap??
new Map;return t?.map(d=>{d=d?.clone();if(!d)return null;d.title=a.substituteFieldsInLinksAndAttributes({attributes:v,fieldInfoMap:f,globalAttributes:I,expressionAttributes:u,layer:e,text:d.title});d.caption=a.substituteFieldsInLinksAndAttributes({attributes:v,fieldInfoMap:f,globalAttributes:I,expressionAttributes:u,layer:e,text:d.caption});d.altText=a.substituteFieldsInLinksAndAttributes({attributes:v,fieldInfoMap:f,globalAttributes:I,expressionAttributes:u,layer:e,text:d.altText});if("image"===
d.type){var {value:c}=d;this._setImageValue({value:c,formattedAttributes:I,layer:e});return d.value.sourceURL?d:void 0}return"pie-chart"===d.type||"line-chart"===d.type||"column-chart"===d.type||"bar-chart"===d.type?({value:c}=d,this._setChartValue({value:c,chartType:d.type,attributes:v,formattedAttributes:I,layer:e,expressionAttributes:u}),d):null}).filter(p.isSome)??[]};k._setImageValue=function(t){const e=this.fieldInfoMap??new Map,{value:v,formattedAttributes:I,layer:u}=t,{linkURL:f,sourceURL:d}=
v;d&&(t=a.fixTokens(d,u),v.sourceURL=a.substituteAttributes({formattedAttributes:I,template:t,fieldInfoMap:e}));f&&(t=a.fixTokens(f,u),v.linkURL=a.substituteAttributes({formattedAttributes:I,template:t,fieldInfoMap:e}))};k._setChartValue=function(t){const {value:e,attributes:v,formattedAttributes:I,chartType:u,layer:f,expressionAttributes:d}=t,{popupTemplate:c,relatedInfos:n}=this,{fields:A,normalizeField:L}=e;e.fields=a.getFixedFieldNames(A,f);L&&(e.normalizeField=a.getFixedFieldName(L,f));if(A.some(x=>
!!(null!=I[x]||a.isRelatedField(x)&&n?.size))){var F=c?.fieldInfos??[];A.forEach(x=>{a.isRelatedField(x)?e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:F,fieldName:x,formattedAttributes:I,chartType:u,value:e})]:(x=this._getChartOption({value:e,attributes:v,chartType:u,formattedAttributes:I,expressionAttributes:d,fieldName:x,fieldInfos:F}),e.series.push(x))})}};k._getRelatedChartInfos=function(t){const {fieldInfos:e,fieldName:v,formattedAttributes:I,chartType:u,value:f}=t,d=[],c=g.getRelatedFieldInfo(v);
t=c&&this.relatedInfos?.get(c.layerId.toString());if(!t)return d;const {relatedFeatures:n,relation:A}=t;if(!A||!n)return d;({cardinality:t}=A);n.forEach(L=>{const {attributes:F}=L;F&&Object.keys(F).forEach(x=>{x===c.fieldName&&d.push(this._getChartOption({value:f,attributes:F,formattedAttributes:I,fieldName:v,chartType:u,relatedFieldName:x,hasMultipleRelatedFeatures:1<n?.length,fieldInfos:e}))})});return"one-to-many"===t||"many-to-many"===t?d:[d[0]]};k._getTooltip=function({label:t,value:e,chartType:v}){return"pie-chart"===
v?`${t}`:`${t}: ${e}`};k._getChartOption=function(t){const {value:e,attributes:v,formattedAttributes:I,expressionAttributes:u,fieldName:f,relatedFieldName:d,fieldInfos:c,chartType:n,hasMultipleRelatedFeatures:A}=t;var L=this.layer,F=this.fieldInfoMap??new Map;const {normalizeField:x,tooltipField:R}=e;t=x?a.isRelatedField(x)?v[g.getRelatedFieldInfo(x).fieldName]:v[x]:null;var G=a.isExpressionField(f)&&u&&void 0!==u[f]?u[f]:d&&void 0!==v[d]?v[d]:void 0!==v[f]?v[f]:I[f];t=new b({fieldName:f,value:void 0===
G?null:G&&t?G/t:G});if(a.isRelatedField(f))return L=F.get(f.toLowerCase()),G=R&&F.get(R.toLowerCase()),F=L?.fieldName??f,G=A&&R?g.getRelatedFieldInfo(R).fieldName:G?.fieldName??R,t.tooltip=this._getTooltip({label:A&&G?v[G]:I[G]??L?.label??L?.fieldName??d,value:A&&d?v[d]:I[F],chartType:n}),t;F=a.getFieldInfo(c,f);L=a.getFixedFieldName(f,L);F=R&&void 0!==I[R]?I[R]:a.getFieldInfoLabel(F||new H({fieldName:L}),this.popupTemplate?.expressionInfos);t.tooltip=this._getTooltip({label:F,value:I[L],chartType:n});
return t};q._createClass(l,[{key:"activeMediaInfo",get:function(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}},{key:"formattedMediaInfos",get:function(){return this._formatMediaInfos()||[]}},{key:"formattedMediaInfoCount",get:function(){return this.formattedMediaInfos.length}}]);return l}(m);h.__decorate([B.property()],m.prototype,"abilities",void 0);h.__decorate([D.cast("abilities")],m.prototype,"castAbilities",null);h.__decorate([B.property()],m.prototype,"activeMediaInfoIndex",
void 0);h.__decorate([B.property({readOnly:!0})],m.prototype,"activeMediaInfo",null);h.__decorate([B.property()],m.prototype,"attributes",void 0);h.__decorate([B.property()],m.prototype,"description",void 0);h.__decorate([B.property()],m.prototype,"fieldInfoMap",void 0);h.__decorate([B.property()],m.prototype,"formattedAttributes",void 0);h.__decorate([B.property()],m.prototype,"expressionAttributes",void 0);h.__decorate([B.property({readOnly:!0})],m.prototype,"formattedMediaInfos",null);h.__decorate([B.property()],
m.prototype,"isAggregate",void 0);h.__decorate([B.property()],m.prototype,"layer",void 0);h.__decorate([B.property({readOnly:!0})],m.prototype,"formattedMediaInfoCount",null);h.__decorate([B.property()],m.prototype,"mediaInfos",void 0);h.__decorate([B.property()],m.prototype,"popupTemplate",void 0);h.__decorate([B.property()],m.prototype,"relatedInfos",void 0);h.__decorate([B.property()],m.prototype,"title",void 0);return m=h.__decorate([M.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],
m)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../request ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../core/has ../../../layers/support/source/DataLayerSource ../../../rest/query/executeQueryJSON ../../../config ../../../kernel ../../../core/arrayUtils ../../../core/urlUtils ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/featureConversionUtils ../../../geometry/Extent ../../../geometry/Geometry ../../../geometry/Multipoint ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/Polyline ../../../geometry/support/normalizeUtils ../../../core/pbf ../../../rest/support/FeatureSet ../../../rest/support/Query ../../../rest/query/support/AttachmentInfo ../../../rest/support/AttachmentQuery ../../../geometry ../../../rest/support/RelationshipQuery ../../../rest/support/TopFeaturesQuery ../../../rest/support/StatisticDefinition ./featureUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k,l,z,t,e,v,I,u,f,d,c,n,A,L,F,x,R,G,r){function C(V,T){if(!T.relationships)return null;let w=null;({relationships:T}=T);T.some(E=>E.id===parseInt(V,10)?(w=E,!0):!1);return w}function O({originRelationship:V,relationships:T,layerId:w}){let E=null;T&&T.some(J=>{`${J.relatedTableId}`===w&&J.id===V?.id&&(E=J);return!!E});return E}function P(V,T){T=T.toLowerCase();for(const w in V)if(w.toLowerCase()===T)return V[w];return null}function S(V,T,w,E){const J=new x;J.outFields=
["*"];J.relationshipId="number"===typeof T.id?T.id:parseInt(T.id,10);J.objectIds=[V.attributes[w.objectIdField]];return w.queryRelatedFeatures?.(J,E)??Promise.resolve({})}function W(V,T,w){let E=0;const J=[];for(;E<T.length;)J.push(`${V} IN (${T.slice(E,w+E)})`),E+=w;return J.join(" OR ")}async function Y(V,T,w,E){var J=w.layerId.toString();const {layerInfo:Q,relation:U,relatedFields:X,outStatistics:ca,url:da,sourceSpatialReference:ea}=T;if(!Q||!U)return null;J=O({originRelationship:U,relationships:Q.relationships,
layerId:J});if(J?.relationshipTableId&&J.keyFieldInRelationshipTable){w=(await S(V,J,w,E))[V.attributes[w.objectIdField]];if(!w)return null;const ha=w.features.map(fa=>fa.attributes[Q.objectIdField]);if(ca?.length&&Q.supportsStatistics)return T=new n,T.where=W(Q.objectIdField,ha,1E3),T.outFields=X,T.outStatistics=ca,T.sourceSpatialReference=ea,T={features:Promise.resolve(w),statsFeatures:M.executeQueryJSON(da,T)},B.eachAlways(T)}return(J=J?.keyField)?(w=D.isNumericField(Z(Q.fields,J)),V=P(V.attributes,
U.keyField),J=w?`${J}=${V}`:`${J}='${V}'`,V=M.executeQueryJSON(da,new n({where:J,outFields:T.relatedFields,sourceSpatialReference:ea}),E),T=T.outStatistics&&0<T.outStatistics.length&&Q.supportsStatistics?M.executeQueryJSON(da,new n({where:J,outFields:T.relatedFields,outStatistics:T.outStatistics,sourceSpatialReference:ea}),E):null,E={features:V},T&&(E.statsFeatures=T),B.eachAlways(E)):null}function Z(V,T){if(null!=V){T=T.toLowerCase();for(const w of V)if(w&&w.name.toLowerCase()===T)return w}return null}
const aa=p.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),ba=new Map;q.createRelatedInfo=function(V,T){if(V=C(V,T))return{url:`${T.url}/${V.relatedTableId}`,sourceSpatialReference:T.spatialReference,relation:V,relatedFields:[],outStatistics:[]}};q.getDestinationRelation=O;q.getRelatedFieldInfo=function(V){if(!r.isRelatedField(V))return null;const [T,w]=V.split("/").slice(1);return{layerId:T,fieldName:w}};q.queryLayerInfos=function({relatedInfos:V,layer:T},w){const E={};V.forEach((J,
Q)=>{({relation:J}=J);if(!J)throw Q=new m("relation-required","A relation is required on a layer to retrieve related records."),aa.error(Q),Q;({relatedTableId:J}=J);if("number"!==typeof J)throw Q=new m("A related table ID is required on a layer to retrieve related records."),aa.error(Q),Q;J=`${T.url}/${J}`;const U=ba.get(J),X=U??h(J,{query:{f:"json"},signal:w&&w.signal});U||ba.set(J,X);E[Q]=X});return B.whenOrAbort(B.eachAlways(E),w)};q.queryRelatedFeatures=function({graphic:V,relatedInfos:T,layer:w},
E){const J={};T.forEach((Q,U)=>{Q.layerInfo&&(J[U]=Y(V,Q,w,E))});return B.eachAlways(J)};q.setRelatedFeatures=function(V,T){if(T&&V){var {features:w,statsFeatures:E}=V;V=w&&w.value;T.relatedFeatures=V?V.features:[];V=E&&E.value;T.relatedStatsFeatures=V?V.features:[]}};q.updateRelatedInfo=function({relatedInfo:V,fieldName:T,fieldInfo:w}){V.relatedFields?.push(T);w.statisticType&&(T=new G({statisticType:w.statisticType,onStatisticField:T,outStatisticFieldName:T}),V.outStatistics?.push(T))};Object.defineProperty(q,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/chartUtils":function(){define(["require","exports","../../intl","../../core/has","../../intl/locale"],function(q,h,m,p,B){function D(b){if(!b)return"en-us";if(N.has(b.toLowerCase()))return b.toLowerCase();b=b.split("-")[0].toLowerCase();let a=null;for(const g of N.keys())if(g.startsWith(b)){a=g;break}return a||"en-us"}m="#ffffff #858585 #ffbebe #ffebbe #ffebaf #ffffbe #e9ffbe #d3ffbe #beffe8 #bee8ff #bed2ff #e8beff #ffbee8 #ebebeb #707070 #ff7f7f #ffa77f #ffd37f #ffff73 #d1ff73 #a3ff73 #73ffdf #73dfff #73b2ff #df73ff #ff73df #d6d6d6 #5c5c5c #ff0000 #ff5500 #ffaa00 #ffff00 #aaff00 #55ff00 #00ffc5 #00c5ff #0070ff #c500ff #ff00c5 #c2c2c2 #474747 #e60000 #e64c00 #e69800 #e6e600 #98e600 #4ce600 #00e6a9 #00a9e6 #005ce6 #a900e6 #e600a9 #adadad #242424 #a80000 #a83800 #a87000 #a8a800 #70a800 #38a800 #00a884 #0084a8 #004da8 #8400a8 #a80084 #999999 #1a1a1a #730000 #732600 #734c00 #737300 #4c7300 #267300 #00734c #004c73 #002673 #4c0073 #73004".split(" ");
var K=[{name:"default",colors:[].concat(m.slice(30,39),m.slice(28,30).reverse())},{name:"cat-dark",colors:"#ed5151 #149ece #a7c636 #9e559c #fc921f #ffde3e #f789d8 #b7814a #3caf99 #6b6bd6 #b54779 #7f7f7f".split(" ")},{name:"tropical-bliss",colors:"#fce138 #ff9399 #fcd27e #f1983c #a553b7 #b1a9d0 #6ecffc #4c81cd #fc6f84 #fc3e5a #6af689 #48885c".split(" ")},{name:"desert-blooms",colors:"#102432 #144d59 #ffc730 #ed9310 #a64f1b #661510 #d9351a #b31515 #4a0932 #8c213f #18382e #2c6954".split(" ")},{name:"under-the-sea",
colors:"#bf9727 #607100 #00734c #704489 #01acca #024e76 #f09100 #ea311f #c6004b #7570b3 #666666 #333333".split(" ")},{name:"vibrant-rainbow",colors:"#fffb00 #f5cb11 #9fd40c #46e39c #32b8a6 #7ff2fa #ac08cc #dd33ff #eb7200 #e8a784 #bf2e2e #6c7000".split(" ")},{name:"ocean-bay",colors:"#191921 #11495c #78b1c2 #454f4b #8f8f82 #9be0c0 #87b051 #f7ec88 #ebdcc1 #dbb658 #c43541 #75351e".split(" ")},{name:"prairie-summer",colors:"#332424 #751555 #d47013 #d68989 #211173 #82aad6 #7bfaeb #6ec9a8 #6b6408 #eada40 #ccc54a #1fc235".split(" ")},
{name:"pastel-chalk",colors:"#fffd99 #f5e6a4 #c1d48c #b8e3d0 #a0b8b5 #cbf7fa #d791f2 #dfc1eb #f2b983 #e8c4b2 #bf8e8e #94995c".split(" ")},{name:"seq-yellow-orange-red-bright",colors:"#910000 #b1260b #c0370f #e05919 #ef6a1d #ff7b22 #ffa143 #ffb454 #ffda74 #ffed85".split(" ")},{name:"seq-reds-bright",colors:"#57453b #7b4238 #9f4036 #c23d33 #d7483c #ec5244 #f3696c #f9816c #ffc4ae #fff0dc".split(" ")},{name:"seq-purples-bright",colors:"#4e465c #5a4a78 #695291 #775baa #8663c3 #946bdc #aa89e8 #c1a6f3 #d7c4ff #e6e1ff".split(" ")},
{name:"seq-blues-bright",colors:"#404d54 #435c6c #48799d #4b88b6 #4d96ce #50a5e7 #74bbed #98d0f3 #bce6f9 #e6faff".split(" ")},{name:"seq-greens-bright",colors:"#39544c #386757 #368165 #359b73 #33b581 #4bc392 #64d2a2 #7ce0b3 #cbf6d9 #f4ffea".split(" ")},{name:"seq-browns-bright",colors:"#524834 #715b38 #8f6e3c #ae8140 #cc9444 #eba748 #eeb664 #f0c47f #f9e0b7 #fff8eb".split(" ")}];const N=new Map([["ar",()=>(new Promise((b,a)=>q(["../../chunks/ar"],b,a))).then(b=>b.ar)],["bg-bg",()=>(new Promise((b,
a)=>q(["../../chunks/bg_BG"],b,a))).then(b=>b.bg_BG)],["bs-ba",()=>(new Promise((b,a)=>q(["../../chunks/bs_BA"],b,a))).then(b=>b.bs_BA)],["ca-es",()=>(new Promise((b,a)=>q(["../../chunks/ca_ES"],b,a))).then(b=>b.ca_ES)],["cs-cz",()=>(new Promise((b,a)=>q(["../../chunks/cs_CZ"],b,a))).then(b=>b.cs_CZ)],["da-dk",()=>(new Promise((b,a)=>q(["../../chunks/da_DK"],b,a))).then(b=>b.da_DK)],["de-de",()=>(new Promise((b,a)=>q(["../../chunks/de_DE"],b,a))).then(b=>b.de_DE)],["de-ch",()=>(new Promise((b,a)=>
q(["../../chunks/de_CH"],b,a))).then(b=>b.de_CH)],["el-gr",()=>(new Promise((b,a)=>q(["../../chunks/el_GR"],b,a))).then(b=>b.el_GR)],["en-us",()=>(new Promise((b,a)=>q(["../../chunks/en_US"],b,a))).then(b=>b.en_US)],["en-ca",()=>(new Promise((b,a)=>q(["../../chunks/en_CA"],b,a))).then(b=>b.en_CA)],["es-es",()=>(new Promise((b,a)=>q(["../../chunks/es_ES"],b,a))).then(b=>b.es_ES)],["et-ee",()=>(new Promise((b,a)=>q(["../../chunks/et_EE"],b,a))).then(b=>b.et_EE)],["fi-fi",()=>(new Promise((b,a)=>q(["../../chunks/fi_FI"],
b,a))).then(b=>b.fi_FI)],["fr-fr",()=>(new Promise((b,a)=>q(["../../chunks/fr_FR"],b,a))).then(b=>b.fr_FR)],["he-il",()=>(new Promise((b,a)=>q(["../../chunks/he_IL"],b,a))).then(b=>b.he_IL)],["hr-hr",()=>(new Promise((b,a)=>q(["../../chunks/hr_HR"],b,a))).then(b=>b.hr_HR)],["hu-hu",()=>(new Promise((b,a)=>q(["../../chunks/hu_HU"],b,a))).then(b=>b.hu_HU)],["id-id",()=>(new Promise((b,a)=>q(["../../chunks/id_ID"],b,a))).then(b=>b.id_ID)],["it-it",()=>(new Promise((b,a)=>q(["../../chunks/it_IT"],b,a))).then(b=>
b.it_IT)],["ja-jp",()=>(new Promise((b,a)=>q(["../../chunks/ja_JP"],b,a))).then(b=>b.ja_JP)],["ko-kr",()=>(new Promise((b,a)=>q(["../../chunks/ko_KR"],b,a))).then(b=>b.ko_KR)],["lt-lt",()=>(new Promise((b,a)=>q(["../../chunks/lt_LT"],b,a))).then(b=>b.lt_LT)],["lv-lv",()=>(new Promise((b,a)=>q(["../../chunks/lv_LV"],b,a))).then(b=>b.lv_LV)],["nb-no",()=>(new Promise((b,a)=>q(["../../chunks/nb_NO"],b,a))).then(b=>b.nb_NO)],["nl-nl",()=>(new Promise((b,a)=>q(["../../chunks/nl_NL"],b,a))).then(b=>b.nl_NL)],
["pl-pl",()=>(new Promise((b,a)=>q(["../../chunks/pl_PL"],b,a))).then(b=>b.pl_PL)],["pt-br",()=>(new Promise((b,a)=>q(["../../chunks/pt_BR"],b,a))).then(b=>b.pt_BR)],["pt-pt",()=>(new Promise((b,a)=>q(["../../chunks/pt_PT"],b,a))).then(b=>b.pt_PT)],["ro-ro",()=>(new Promise((b,a)=>q(["../../chunks/ro_RO"],b,a))).then(b=>b.ro_RO)],["ru-ru",()=>(new Promise((b,a)=>q(["../../chunks/ru_RU"],b,a))).then(b=>b.ru_RU)],["sk-sk",()=>(new Promise((b,a)=>q(["../../chunks/sk_SK"],b,a))).then(b=>b.sk_SK)],["sl-sl",
()=>(new Promise((b,a)=>q(["../../chunks/sl_SL"],b,a))).then(b=>b.sl_SL)],["sr-rs",()=>(new Promise((b,a)=>q(["../../chunks/sr_RS"],b,a))).then(b=>b.sr_RS)],["sv-se",()=>(new Promise((b,a)=>q(["../../chunks/sv_SE"],b,a))).then(b=>b.sv_SE)],["th-th",()=>(new Promise((b,a)=>q(["../../chunks/th_TH"],b,a))).then(b=>b.th_TH)],["tr-tr",()=>(new Promise((b,a)=>q(["../../chunks/tr_TR"],b,a))).then(b=>b.tr_TR)],["uk-ua",()=>(new Promise((b,a)=>q(["../../chunks/uk_UA"],b,a))).then(b=>b.uk_UA)],["vi-vn",()=>
(new Promise((b,a)=>q(["../../chunks/vi_VN"],b,a))).then(b=>b.vi_VN)],["zh-cn",()=>(new Promise((b,a)=>q(["../../chunks/zh_Hans"],b,a))).then(b=>b.zh_Hans)],["zh-hk",()=>(new Promise((b,a)=>q(["../../chunks/zh_Hant"],b,a))).then(b=>b.zh_Hant)],["zh-tw",()=>(new Promise((b,a)=>q(["../../chunks/zh_Hant"],b,a))).then(b=>b.zh_Hant)]]);let M=null,H=null;h.getChartLocale=D;h.getColorSet=function(b,a="default"){const g=K.find(y=>y.name===a);return g?g.colors.map(y=>b.color(y)):null};h.loadChartsModule=async function(b=
B.getLocale()){b=D(b);if(M&&b===H)return M;M=(new Promise((a,g)=>q(["../../chunks/index2"],a,g))).then(a=>a.index);H=b;try{const [a,g]=await Promise.all([M,N.get(H)()]);H===b&&(a.am4core.options.defaultLocale=g.default);a.am4core.options.suppressWarnings=!0;a.am4core.options.autoDispose=!0}catch{return H=M=null}return M};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureExpression/FeatureExpressionViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k,l,z,t,e,v,I,u,f,d,c){p=function(n){function A(F){var x=L.call(this,F);x._abortController=null;x.expressionInfo=null;x.graphic=null;x.contentElement=null;x.contentElementViewModel=null;x.interceptor=null;x.view=null;x._cancelQuery=()=>{const {_abortController:R}=q._assertThisInitialized(x);R&&R.abort();x._abortController=null};x._createVM=()=>{var R=x.contentElement?.type;x.contentElementViewModel?.destroy();R="fields"===R?new f:"media"===R?new d:"text"===R?new u:
null;x._set("contentElementViewModel",R)};x._compile=async()=>{x._cancelQuery();const R=new AbortController;x._abortController=R;await x._compileExpression();x._abortController===R&&(x._abortController=null)};x._compileThrottled=K.throttle(x._compile,1,q._assertThisInitialized(x));x._compileExpression=async()=>{const {expressionInfo:R,graphic:G,interceptor:r,spatialReference:C,map:O,view:P,_abortController:S}=q._assertThisInitialized(x);if(R&&G&&C&&O){var W=await c.loadArcadeUtils();if(S===x._abortController)if((W=
await c.createCompiledExpression({arcadeUtils:W,expressionInfo:R,graphic:G,interceptor:r,map:O,spatialReference:C,view:P}))&&"esri.arcade.Dictionary"===W.declaredClass){W=await W.castAsJsonAsync(S?.signal);var Y=W?.type;W="media"===Y?t.fromJSON(W):"text"===Y?v.fromJSON(W):"fields"===Y?z.fromJSON(W):null;x._set("contentElement",W)}else x._set("contentElement",null)}else x._set("contentElement",null)};x.handles.add([D.watch(()=>[x.expressionInfo,x.graphic,x.map,x.spatialReference,x.view],()=>x._compileThrottled(),
D.initial),D.watch(()=>[x.contentElement],()=>x._createVM(),D.initial)]);return x}q._inherits(A,n);var L=q._createSuper(A);A.prototype.destroy=function(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)};q._createClass(A,[{key:"spatialReference",get:function(){return this.view?.spatialReference??null},set:function(F){this._override("spatialReference",F)}},{key:"state",get:function(){const {_abortController:F,contentElement:x,
contentElementViewModel:R}=this;return F?"loading":x||R?"ready":"disabled"}},{key:"map",get:function(){return this.view?.map??null},set:function(F){this._override("map",F)}}]);return A}(B.HandleOwnerMixin(p));h.__decorate([N.property()],p.prototype,"_abortController",void 0);h.__decorate([N.property({type:I})],p.prototype,"expressionInfo",void 0);h.__decorate([N.property({type:m})],p.prototype,"graphic",void 0);h.__decorate([N.property({readOnly:!0})],p.prototype,"contentElement",void 0);h.__decorate([N.property({readOnly:!0})],
p.prototype,"contentElementViewModel",void 0);h.__decorate([N.property()],p.prototype,"interceptor",void 0);h.__decorate([N.property()],p.prototype,"spatialReference",null);h.__decorate([N.property({readOnly:!0})],p.prototype,"state",null);h.__decorate([N.property()],p.prototype,"map",null);h.__decorate([N.property()],p.prototype,"view",void 0);return p=h.__decorate([a.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],p)})},"esri/core/throttle":function(){define(["exports"],
function(q){q.throttle=function(h,m,p,B){let D=null,K=1E3;"number"===typeof m?(K=m,B=p):(D=m??null,K=p);let N=0,M;const H=()=>{N=0;h.apply(B,M)};m=(...b)=>{D&&D.apply(B,b);M=b;K?N||(N=setTimeout(H,K)):H()};m.remove=()=>{N&&(clearTimeout(N),N=0)};m.forceUpdate=()=>{N&&(clearTimeout(N),H())};m.hasPendingUpdates=()=>!!N;return m};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils".split(" "),
function(q,h,m,p,B,D){function K(k){return`<ul class="esri-widget__list">${k.map(l=>`<li>${"string"===typeof l?D.applyTextFormattingHTML(D.htmlEntities(l)):l}</li>`).join("")}</ul>`}function N(k){return`<table class="esri-widget__table">${k.keys().map(l=>{var z=k.field(l);z="string"===typeof z?D.applyTextFormattingHTML(D.htmlEntities(z)):z;return`<tr><th>${l}</th><td>${z}</td></tr>`}).join("")}</table>`}function M({aggregatedFeatures:k,arcadeUtils:l,featureSetVars:z,context:t,viewInfo:e,map:v,graphic:I,
interceptor:u}){z.forEach(f=>{f=f.toLowerCase();var d=e.sr;const c={map:v,spatialReference:d,interceptor:u};"$map"===f&&(t.vars[f]=l.convertMapToFeatureSetCollection(c));"$layer"===f&&(t.vars[f]=l.convertFeatureLayerToFeatureSet({layer:I.sourceLayer,spatialReference:d,interceptor:u}));"$datastore"===f&&(t.vars[f]=l.convertServiceUrlToWorkspace({url:I.sourceLayer.url,spatialReference:d,interceptor:u}));if("$aggregatedfeatures"===f){d=I.layer;const {fields:n,objectIdField:A,geometryType:L,spatialReference:F,
displayField:x}=d;d=new B({fields:n,objectIdField:A,geometryType:L,spatialReference:F,displayField:x,...("feature"===d.type?{templates:d.templates,typeIdField:d.typeIdField,types:d.types}:null),source:k});t.vars[f]=l.convertFeatureLayerToFeatureSet({layer:d,spatialReference:F,interceptor:u})}})}function H(){return new Promise((k,l)=>q(["../../../support/arcadeUtils"],k,l))}async function b({graphic:k,view:l}){const {isAggregate:z,layer:t}=k;if(!z||!t||"2d"!==l?.type)return[];l=await l.whenLayerView(t);
if(!("createQuery"in l&&"queryFeatures"in l))return[];const e=l.createQuery();k=k.getObjectId();e.aggregateIds=null!=k?[k]:[];({features:k}=await l.queryFeatures(e));return k}async function a({expressionInfo:k,arcadeUtils:l,interceptor:z,spatialReference:t,map:e,graphic:v,view:I}){if(!k||!k.expression)return null;const u=l.createSyntaxTree(k.expression),f=g.filter(c=>l.hasVariable(u,c));[I]=await Promise.all([b({graphic:v,view:I}),l.loadScriptDependencies(u,!0,f)]);const d=l.getViewInfo({spatialReference:t});
t=l.createExecContext(v,d);t.interceptor=z;t.useAsync=!0;M({aggregatedFeatures:I,arcadeUtils:l,featureSetVars:f,context:t,viewInfo:d,map:e,graphic:v,interceptor:z});z=l.createFunction(u,t);return l.executeAsyncFunction(z,t).catch(c=>y.error("arcade-execution-error",{error:c,graphic:v,expressionInfo:k}))}const g=["$datastore","$map","$layer","$aggregatedfeatures"],y=m.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");h.createCompiledExpression=a;h.createCompiledExpressions=async function({expressionInfos:k,
spatialReference:l,graphic:z,interceptor:t,map:e,view:v}){if(!k||!k.length)return{};const I=await H(),u={};for(const f of k)u[`expression/${f.name}`]=a({expressionInfo:f,arcadeUtils:I,interceptor:t,spatialReference:l,map:e,graphic:z,view:v});k=await p.eachAlways(u);l={};for(const f in k)z=k[f].value,z="string"===typeof z?D.applyTextFormattingHTML(D.htmlEntities(z)):Array.isArray(z)?K(z):"esri.arcade.Dictionary"===z?.declaredClass?N(z):z,l[f]=z;return l};h.loadArcadeUtils=H;Object.defineProperty(h,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureRelationship":function(){define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureRelationship/FeatureRelationshipViewModel ./support/FeatureElementInfo ../support/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k,l,z,t,e,v){const I={title:!0,description:!0};p=function(u){function f(c,n){var A=d.call(this,c,n);A._featureElementInfo=null;A._relatedFeatureIntersectionObserverNode=null;A._relatedFeatureIntersectionObserver=new IntersectionObserver(([L])=>{L?.isIntersecting&&A._increaseFeaturePage()},{root:window.document});A.headingLevel=2;A.viewModel=new y;A.messages=null;A.messagesCommon=null;A.visibleElements={...I};A._increaseFeaturePage=()=>{const {state:L,showAllEnabled:F,
relatedFeatures:x,featuresPerPage:R,featurePage:G}=A.viewModel;"ready"===L&&F&&x.length>=R*G&&A.viewModel.featurePage++};return A}h._inherits(f,u);var d=h._createSuper(f);u=f.prototype;u.initialize=function(){this._featureElementInfo=new k;this.addHandles([K.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),K.initial),K.watch(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),
K.on(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])};u.loadDependencies=function(){return l.loadCalciteComponents({icon:()=>new Promise((c,n)=>q(["../../chunks/calcite-icon"],c,n)),list:()=>new Promise((c,n)=>q(["../../chunks/calcite-list"],c,n)),"list-item":()=>new Promise((c,n)=>q(["../../chunks/calcite-list-item"],c,n)),notice:()=>new Promise((c,n)=>q(["../../chunks/calcite-notice"],c,n))})};u.destroy=function(){this._unobserveRelatedFeatureObserver();
this._featureElementInfo=B.destroyMaybe(this._featureElementInfo)};u.castVisibleElements=function(c){return{...I,...c}};u.renderStickyLoading=function(){return"querying"===this.viewModel.state?e.tsx("div",{key:"sticky-loader",class:"esri-feature__sticky-loading-container"},this.renderLoadingIcon()):null};u.renderLoadingIcon=function(){return e.tsx("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")})};u.renderLoading=function(){return e.tsx("div",
{key:"loading-container",class:"esri-feature__loading-container"},this.renderLoadingIcon())};u.renderShowAllIconNode=function(){return e.tsx("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})};u.renderChevronIconNode=function(){const c=z.isRTL(this.container)?"chevron-left":"chevron-right";return e.tsx("calcite-icon",{scale:"s",icon:c,slot:"content-end"})};u.renderRelatedFeature=function(c){var {itemDescriptionFieldName:n}=this.viewModel;const A=c.title;c.description=n&&c.formattedAttributes?.global[n];
n="loading"===c.state;return e.tsx("calcite-list-item",{key:c.uid,label:n?`${this.messagesCommon?.loading}\u2026`:A,description:n?"\u2026":c.description??"",onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:c})},this.renderChevronIconNode())};u.renderShowAllListItem=function(){return this.displayShowAllButton?e.tsx("calcite-list-item",{key:"show-all-item",label:this.messages?.showAll,description:this.featureCountDescription,onCalciteListItemSelect:()=>this.emit("show-all-records")},
this.renderShowAllIconNode()):null};u.renderNoRelatedFeaturesMessage=function(){return e.tsx("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,kind:"brand",scale:"s",width:"full"},e.tsx("div",{slot:"message"},this.messages?.noRelatedFeatures))};u.renderFeatureObserver=function(){return e.tsx("div",{key:"feature-observer",class:"esri-feature__feature-observer",bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})};u.renderList=function(){const {relatedFeatureViewModels:c}=
this.viewModel;return e.tsx("calcite-list",null,c.toArray().map(n=>this.renderRelatedFeature(n)),this.renderShowAllListItem())};u.renderRelatedFeatures=function(){const {displayListItems:c}=this,{state:n}=this.viewModel;return e.tsx("div",{key:"list-container",class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===n})},c?this.renderList():"ready"===n?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())};
u.renderRelationshipNotFound=function(){return e.tsx("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,kind:"danger",scale:"s",width:"full"},e.tsx("div",{slot:"message"},this.messages?.relationshipNotFound))};u.render=function(){const {state:c}=this.viewModel;return e.tsx("div",{class:this.classes("esri-feature-relationship","esri-widget")},this._featureElementInfo?.render(),"loading"===c?this.renderLoading():"disabled"===c?this.renderRelationshipNotFound():this.renderRelatedFeatures())};
u._setupRelatedFeatureViewModels=function(){const {relatedFeatureViewModels:c}=this.viewModel;this.removeHandles("related-feature-viewmodels");c?.forEach(n=>{this.addHandles(K.watch(()=>[n.title,n.state],()=>this.scheduleRender(),K.initial),"related-feature-viewmodels")});this.scheduleRender()};u._setupFeatureElementInfo=function(){const {headingLevel:c,visibleElements:n}=this,A=n.description&&this.description,L=n.title&&this.title;this._featureElementInfo?.set({description:A,title:L,headingLevel:c})};
u._handleRelatedFeatureObserverChange=async function(){this._unobserveRelatedFeatureObserver();const {state:c,showAllEnabled:n}=this.viewModel;await D.after(0);this._relatedFeatureIntersectionObserverNode&&"ready"===c&&n&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)};u._relatedFeatureIntersectionObserverCreated=function(c){this._relatedFeatureIntersectionObserverNode=c};u._unobserveRelatedFeatureObserver=function(){this._relatedFeatureIntersectionObserverNode&&
this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)};h._createClass(f,[{key:"displayShowAllButton",get:function(){const {showAllEnabled:c,featureCount:n,displayCount:A}=this.viewModel;return!c&&!!n&&(n>A||0===A)}},{key:"displayListItems",get:function(){return this.displayShowAllButton||0<this.viewModel.relatedFeatureViewModels.length}},{key:"description",get:function(){return this.viewModel.description},set:function(c){this.viewModel.description=c}},{key:"featureCountDescription",
get:function(){const {messages:c}=this,{featureCount:n}=this.viewModel;return v.substitute(1===n?c?.numberRecord:c?.numberRecords,{number:n})}},{key:"title",get:function(){return this.viewModel.title},set:function(c){this.viewModel.title=c}}]);return f}(g);m.__decorate([N.property()],p.prototype,"_relatedFeatureIntersectionObserverNode",void 0);m.__decorate([N.property({readOnly:!0})],p.prototype,"displayShowAllButton",null);m.__decorate([N.property({readOnly:!0})],p.prototype,"displayListItems",
null);m.__decorate([N.property()],p.prototype,"description",null);m.__decorate([N.property({readOnly:!0})],p.prototype,"featureCountDescription",null);m.__decorate([N.property()],p.prototype,"headingLevel",void 0);m.__decorate([N.property()],p.prototype,"title",null);m.__decorate([N.property({type:y})],p.prototype,"viewModel",void 0);m.__decorate([N.property(),t.messageBundle("esri/widgets/Feature/t9n/Feature")],p.prototype,"messages",void 0);m.__decorate([N.property(),t.messageBundle("esri/t9n/common")],
p.prototype,"messagesCommon",void 0);m.__decorate([N.property()],p.prototype,"visibleElements",void 0);m.__decorate([M.cast("visibleElements")],p.prototype,"castVisibleElements",null);return p=m.__decorate([a.subclass("esri.widgets.Feature.FeatureRelationship")],p)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/Clonable ../../../core/Collection ../../../core/HandleOwner ../../../core/Identifiable ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k,l,z,t,e){p=function(v){function I(f){var d=u.call(this,f);d._queryAbortController=null;d._queryPageAbortController=null;d._queryFeatureCountAbortController=null;d.featuresPerPage=10;d.description=null;d.graphic=null;d.layer=null;d.map=null;d.orderByFields=null;d.featureCount=0;d.relationshipId=null;d.showAllEnabled=!1;d.title=null;d._cancelQuery=()=>{const {_queryAbortController:c}=q._assertThisInitialized(d);c&&c.abort();d._queryAbortController=null};d._cancelQueryFeatureCount=
()=>{const {_queryFeatureCountAbortController:c}=q._assertThisInitialized(d);c&&c.abort();d._queryFeatureCountAbortController=null};d._cancelQueryPage=()=>{const {_queryPageAbortController:c}=q._assertThisInitialized(d);c&&c.abort();d._queryPageAbortController=null};d._queryController=async()=>{d._cancelQuery();const c=new AbortController;d._queryAbortController=c;await H.ignoreAbortErrors(d._query());d._queryAbortController===c&&(d._queryAbortController=null)};d._queryFeatureCountController=async()=>
{d._cancelQueryFeatureCount();const c=new AbortController;d._queryFeatureCountAbortController=c;await H.ignoreAbortErrors(d._queryFeatureCount());d._queryFeatureCountAbortController===c&&(d._queryFeatureCountAbortController=null)};d._queryPageController=async()=>{const c=new AbortController;d._queryPageAbortController=c;await H.ignoreAbortErrors(d._queryPage());d._queryPageAbortController===c&&(d._queryPageAbortController=null)};d._queryThrottled=a.throttle(d._queryController,100,q._assertThisInitialized(d));
d._queryFeatureCountThrottled=a.throttle(d._queryFeatureCountController,100,q._assertThisInitialized(d));d._queryPageThrottled=a.throttle(d._queryPageController,100,q._assertThisInitialized(d));d._query=async()=>{const {_queryAbortController:c,relatedFeatures:n}=q._assertThisInitialized(d);d._destroyRelatedFeatureViewModels();d.featurePage=1;n.removeAll();n.addMany(d._sliceFeatures(await d._queryRelatedFeatures({signal:c?.signal})))};d.handles.add([b.watch(()=>[d.displayCount,d.graphic,d.layer,d.map,
d.orderByFieldsFixedCasing,d.relationshipId,d.featuresPerPage,d.showAllEnabled,d.canQuery,d.featureCount],()=>d._queryThrottled(),b.initial),b.watch(()=>[d.featurePage,d.showAllEnabled],()=>d._queryPageThrottled()),b.watch(()=>[d.layer,d.relationshipId,d.objectId,d.canQuery],()=>d._queryFeatureCountThrottled())]);return d}q._inherits(I,v);var u=q._createSuper(I);v=I.prototype;v.destroy=function(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.removeAll();this._cancelQuery();this._cancelQueryFeatureCount();
this._cancelQueryPage()};v._destroyRelatedFeatureViewModels=function(){this.relatedFeatureViewModels?.forEach(f=>!f.destroyed&&f.destroy());this.relatedFeatureViewModels.removeAll()};v._queryFeatureCount=async function(){const {layer:f,relatedLayer:d,relationshipId:c,objectId:n,_queryFeatureCountAbortController:A,canQuery:L,supportsCacheHint:F}=this;await f?.load();await d?.load();if(L&&f&&d){var x=d.createQuery();x=new t({cacheHint:F,relationshipId:c,returnGeometry:!1,objectIds:[n],where:M.unwrapOrValue(x.where,
void 0)});x=await f.queryRelatedFeaturesCount(x,{signal:A?.signal});this._set("featureCount",x[n]||0)}else this._set("featureCount",0)};v._sliceFeatures=function(f){const {showAllEnabled:d,displayCount:c}=this;return d?f:c?f.slice(0,c):[]};v._queryPage=async function(){const {relatedFeatures:f,featurePage:d,showAllEnabled:c,_queryPageAbortController:n}=this;!c||2>d||f.addMany(await this._queryRelatedFeatures({signal:n?.signal}))};v._queryRelatedFeatures=async function(f){const {orderByFieldsFixedCasing:d,
showAllEnabled:c,featuresPerPage:n,displayCount:A,layer:L,relationshipId:F,featurePage:x,featureCount:R,relatedLayer:G,supportsCacheHint:r}=this,{canQuery:C,objectId:O}=this;if(!C||!L||!G)return[];var P=c?((x-1)*n+R)%R:0;const S=c?n:A;var W=G.objectIdField;W=[...d.map(aa=>aa.field),W].filter(M.isSome);const Y=d.map(aa=>`${aa.field} ${aa.order}`),Z=G.createQuery();P=new t({orderByFields:Y,start:P,num:S,outFields:W,cacheHint:r,relationshipId:F,returnGeometry:!1,objectIds:[O],where:M.unwrapOrValue(Z.where,
void 0)});f=(await L.queryRelatedFeatures(P,{signal:f?.signal}))[O]?.features||[];f.forEach(aa=>{aa.sourceLayer=G;aa.layer=G});return f};q._createClass(I,[{key:"featurePage",get:function(){return this._get("featurePage")},set:function(f){const {featuresPerPage:d,featureCount:c}=this;this._set("featurePage",Math.min(Math.max(f,1),Math.ceil(c/d)||1))}},{key:"orderByFieldsFixedCasing",get:function(){const {orderByFields:f,relatedLayer:d}=this;return f&&d?.loaded?f.map(c=>{const n=c.clone();n.field=e.getFixedFieldName(c.field,
d);return n}):f??[]}},{key:"supportsCacheHint",get:function(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}},{key:"canQuery",get:function(){const f=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&"number"===typeof this.relationshipId&&"number"===typeof this.objectId&&!!f?.supportsCount&&!!f?.supportsPagination}},{key:"itemDescriptionFieldName",get:function(){return this.orderByFieldsFixedCasing[0]?.field||null}},{key:"displayCount",get:function(){return this._get("displayCount")},
set:function(f){this._set("displayCount",Math.min(Math.max(f,0),10))}},{key:"objectId",get:function(){return(this.objectIdField&&this.graphic?.attributes?.[this.objectIdField])??null}},{key:"objectIdField",get:function(){return this.layer?.objectIdField||null}},{key:"relatedFeatures",get:function(){return this._get("relatedFeatures")||new D}},{key:"relatedLayer",get:function(){const {layer:f,map:d,relationship:c}=this;return f?.loaded&&d&&c?e.findRelatedLayer(d,f,c)??null:null}},{key:"relationship",
get:function(){const {relationshipId:f,layer:d}=this;return"number"===typeof f?d?.relationships?.find(({id:c})=>c===f)??null:null}},{key:"relatedFeatureViewModels",get:function(){return this._get("relatedFeatureViewModels")||new D}},{key:"state",get:function(){const {_queryAbortController:f,_queryFeatureCountAbortController:d,_queryPageAbortController:c,canQuery:n}=this;return d?"loading":f||c?"querying":n?"ready":"disabled"}}]);return I}(B.ClonableMixin(N.IdentifiableMixin(K.HandleOwnerMixin(p))));
h.__decorate([g.property()],p.prototype,"_queryAbortController",void 0);h.__decorate([g.property()],p.prototype,"_queryPageAbortController",void 0);h.__decorate([g.property()],p.prototype,"_queryFeatureCountAbortController",void 0);h.__decorate([g.property({value:1})],p.prototype,"featurePage",null);h.__decorate([g.property()],p.prototype,"featuresPerPage",void 0);h.__decorate([g.property({readOnly:!0})],p.prototype,"orderByFieldsFixedCasing",null);h.__decorate([g.property({readOnly:!0})],p.prototype,
"supportsCacheHint",null);h.__decorate([g.property({readOnly:!0})],p.prototype,"canQuery",null);h.__decorate([g.property()],p.prototype,"description",void 0);h.__decorate([g.property({readOnly:!0})],p.prototype,"itemDescriptionFieldName",null);h.__decorate([g.property({value:3})],p.prototype,"displayCount",null);h.__decorate([g.property({type:m})],p.prototype,"graphic",void 0);h.__decorate([g.property()],p.prototype,"layer",void 0);h.__decorate([g.property()],p.prototype,"map",void 0);h.__decorate([g.property({readOnly:!0})],
p.prototype,"objectId",null);h.__decorate([g.property({readOnly:!0})],p.prototype,"objectIdField",null);h.__decorate([g.property()],p.prototype,"orderByFields",void 0);h.__decorate([g.property({readOnly:!0})],p.prototype,"relatedFeatures",null);h.__decorate([g.property({readOnly:!0})],p.prototype,"relatedLayer",null);h.__decorate([g.property({readOnly:!0})],p.prototype,"relationship",null);h.__decorate([g.property()],p.prototype,"featureCount",void 0);h.__decorate([g.property({readOnly:!0})],p.prototype,
"relatedFeatureViewModels",null);h.__decorate([g.property()],p.prototype,"relationshipId",void 0);h.__decorate([g.property()],p.prototype,"showAllEnabled",void 0);h.__decorate([g.property()],p.prototype,"state",null);h.__decorate([g.property()],p.prototype,"title",void 0);return p=h.__decorate([z.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],p)})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/Handles ../../core/Identifiable ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureExpression/FeatureExpressionViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./FeatureRelationship/FeatureRelationshipViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils".split(" "),
function(q,h,m,p,B,D,K,N,M,H,b,a,g,y,k,l,z,t,e,v,I,u,f,d,c,n,A){var L;const F={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};B=L=function(x){function R(r){var C=G.call(this,r);C._handles=new D;C._error=null;C._featureAbortController=null;C._graphicChangedThrottled=a.throttle(C._graphicChanged,1,q._assertThisInitialized(C));C._expressionAttributes=null;C._graphicExpressionAttributes=null;C.abilities=
{...F};C.content=null;C.contentViewModels=[];C.description=null;C.defaultPopupTemplateEnabled=!1;C.formattedAttributes=null;C.lastEditInfo=null;C.relatedInfos=new Map;C.title="";C.view=null;C._isAllowedContentType=O=>{const {abilities:P}=q._assertThisInitialized(C);return"attachments"===O.type&&!!P.attachmentsContent||"custom"===O.type&&!!P.customContent||"fields"===O.type&&!!P.fieldsContent||"media"===O.type&&!!P.mediaContent||"text"===O.type&&!!P.textContent||"expression"===O.type&&!!P.expressionContent||
"relationship"===O.type&&!!P.relationshipContent};C._handles.add(b.watch(()=>[C.graphic,C._effectivePopupTemplate,C.abilities],()=>C._graphicChangedThrottled(),b.initial));return C}q._inherits(R,x);var G=q._createSuper(R);x=R.prototype;x.destroy=function(){this._clear();this._cancelFeatureQuery();this._error=null;this._handles.destroy();this.graphic=null;this._destroyContentViewModels();this.relatedInfos.clear()};x.castAbilities=function(r){return{...F,...r}};x.setActiveMedia=function(r,C){r=this.contentViewModels[r];
r instanceof f&&r.setActiveMedia(C)};x.nextMedia=function(r){r=this.contentViewModels[r];r instanceof f&&r.next()};x.previousMedia=function(r){r=this.contentViewModels[r];r instanceof f&&r.previous()};x.updateGeometry=async function(){const {graphic:r,spatialReference:C,_sourceLayer:O}=this;await O?.load();var P=O?.objectIdField;P&&r&&O&&(P=r?.attributes?.[P],null!=P&&(P=[P],!r.geometry&&(P=(await n.querySourceLayer({layer:O,graphic:r,outFields:[],objectIds:P,returnGeometry:!0,spatialReference:C}))?.geometry)))&&
(r.geometry=P)};x._clear=function(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)};x._graphicChanged=async function(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:r}=this;if(r){var C=new AbortController;this._featureAbortController=C;try{await this._queryFeature({signal:C.signal})}catch(O){H.isAbortError(O)||(this._error=O,N.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:O,
graphic:r,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===C&&(this._featureAbortController=null)}};x._cancelFeatureQuery=function(){const {_featureAbortController:r}=this;r&&r.abort();this._featureAbortController=null};x._compileContentElement=function(r,C){if("attachments"===r.type)return this._compileAttachments(r,C);if("custom"===r.type)return this._compileCustom(r,C);if("fields"===r.type)return this._compileFields(r,C);if("media"===r.type)return this._compileMedia(r,
C);if("text"===r.type)return this._compileText(r,C);if("expression"===r.type)return this._compileExpression(r,C);if("relationship"===r.type)return this._compileRelationship(r,C)};x._compileContent=function(r){this._destroyContentViewModels();if(this.graphic)return Array.isArray(r)?r.filter(this._isAllowedContentType).map((C,O)=>this._compileContentElement(C,O)).filter(M.isSome):"string"===typeof r?this._compileText(new t({text:r}),0).text:r};x._destroyContentViewModels=function(){this._handles?.remove("relationship-view-models");
this._handles?.remove("content-view-models");this.contentViewModels.forEach(r=>r&&!r.destroyed&&r.destroy());this._set("contentViewModels",[])};x._matchesFeature=function(r,C){r=r?.graphic?.getObjectId();C=C?.getObjectId();return M.isSome(r)&&M.isSome(C)&&r===C};x._setRelatedFeaturesViewModels=function({relatedFeatureViewModels:r,relatedFeatures:C,map:O}){const {view:P,spatialReference:S}=this;C?.filter(Boolean).forEach(W=>{r.find(Y=>this._matchesFeature(Y,W))||r.add(new L({abilities:{relationshipContent:!1},
map:O,view:P,spatialReference:S,graphic:W}))});r.forEach(W=>{C?.find(Y=>this._matchesFeature(W,Y))||r.remove(W)})};x._setExpressionContentVM=function(r,C){const O=this.formattedAttributes,{contentElement:P,contentElementViewModel:S}=r;r=P?.type;S&&r&&("fields"===r&&(this._createFieldsFormattedAttributes({contentElement:P,contentElementIndex:C,formattedAttributes:O}),S.set(this._createFieldsVMParams(P,C))),"media"===r&&(this._createMediaFormattedAttributes({contentElement:P,contentElementIndex:C,formattedAttributes:O}),
S.set(this._createMediaVMParams(P,C))),"text"===r&&S.set(this._createTextVMParams(P)))};x._compileRelationship=function(r,C){const {displayCount:O,orderByFields:P,relationshipId:S,title:W,description:Y}=r,{_sourceLayer:Z,graphic:aa,map:ba}=this,V=new d({displayCount:O,graphic:aa,orderByFields:P,relationshipId:S,layer:Z,map:ba,...this._compileTitleAndDesc({title:W,description:Y})});this.contentViewModels[C]=V;this._handles.add(b.on(()=>V.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(V)),
"relationship-view-models");return r};x._compileExpression=function(r,C){const {expressionInfo:O}=r,{graphic:P,map:S,spatialReference:W,view:Y}=this,Z=new I({expressionInfo:O,graphic:P,interceptor:L.interceptor,map:S,spatialReference:W,view:Y});this.contentViewModels[C]=Z;this._handles.add(b.watch(()=>Z.contentElementViewModel,()=>this._setExpressionContentVM(Z,C),b.initial),"content-view-models");return r};x._compileAttachments=function(r,C){const {graphic:O}=this,{description:P,title:S}=r;this.contentViewModels[C]=
new e({graphic:O,...this._compileTitleAndDesc({title:S,description:P})});return r};x._compileCustom=function(r,C){const {graphic:O}=this,{creator:P,destroyer:S}=r;this.contentViewModels[C]=new v({graphic:O,creator:P,destroyer:S});return r};x._compileTitleAndDesc=function({title:r,description:C}){const {_fieldInfoMap:O,_sourceLayer:P,graphic:S,formattedAttributes:W}=this,Y=S?.attributes,Z=this._expressionAttributes,aa=W.global;return{title:n.substituteFieldsInLinksAndAttributes({attributes:Y,fieldInfoMap:O,
globalAttributes:aa,expressionAttributes:Z,layer:P,text:r}),description:n.substituteFieldsInLinksAndAttributes({attributes:Y,fieldInfoMap:O,globalAttributes:aa,expressionAttributes:Z,layer:P,text:C})}};x._createFieldsVMParams=function(r,C){const O=this._effectivePopupTemplate,P=this.formattedAttributes,S={...P?.global,...P?.content[C]};C=(r?.fieldInfos||O?.fieldInfos)?.filter(({fieldName:Z})=>n.isExpressionField(Z)||n.isRelatedField(Z)||S.hasOwnProperty(Z));const {description:W,title:Y}=r;return{attributes:S,
expressionInfos:O?.expressionInfos,fieldInfos:C,...this._compileTitleAndDesc({title:Y,description:W})}};x._compileFields=function(r,C){const O=r.clone();r=new u(this._createFieldsVMParams(r,C));this.contentViewModels[C]=r;O.fieldInfos=r.formattedFieldInfos.slice(0);return O};x._createMediaVMParams=function(r,C){const {abilities:O,graphic:P,_fieldInfoMap:S,_effectivePopupTemplate:W,relatedInfos:Y,_sourceLayer:Z,_expressionAttributes:aa}=this,ba=this.formattedAttributes,V=P?.attributes??{},{description:T,
mediaInfos:w,title:E}=r;return{abilities:{chartAnimation:O.chartAnimation},activeMediaInfoIndex:r.activeMediaInfoIndex||0,attributes:V,isAggregate:P?.isAggregate,layer:Z,fieldInfoMap:S,formattedAttributes:{...ba?.global,...ba?.content[C]},expressionAttributes:aa,mediaInfos:w,popupTemplate:W,relatedInfos:Y,...this._compileTitleAndDesc({title:E,description:T})}};x._compileMedia=function(r,C){const O=r.clone();r=new f(this._createMediaVMParams(r,C));O.mediaInfos=r.formattedMediaInfos.slice(0);this.contentViewModels[C]=
r;return O};x._createTextVMParams=function(r){const {graphic:C,_fieldInfoMap:O,_sourceLayer:P,_expressionAttributes:S}=this;r&&r.text&&(r.text=n.substituteFieldsInLinksAndAttributes({attributes:C?.attributes??{},fieldInfoMap:O,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:S,layer:P,text:r.text}));return{graphic:C,creator:r.text}};x._compileText=function(r,C){r=r.clone();this.contentViewModels[C]=new v(this._createTextVMParams(r));return r};x._compileLastEditInfo=function(){const {_effectivePopupTemplate:r,
_sourceLayer:C,graphic:O}=this;if(r){var {lastEditInfoEnabled:P}=r,S=C?.editFieldsInfo;if(P&&S)return n.formatEditInfo(S,O?.attributes)}};x._compileTitle=function(r){const {_fieldInfoMap:C,_sourceLayer:O,graphic:P,_expressionAttributes:S}=this;return n.substituteFieldsInLinksAndAttributes({attributes:P?.attributes??{},fieldInfoMap:C,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:S,layer:O,text:r})};x._getTitle=async function(){const {_effectivePopupTemplate:r,graphic:C}=
this;return C?n.graphicCallback(r?.title,{graphic:C}):null};x._getContent=async function(){const {_effectivePopupTemplate:r,graphic:C}=this;return C?n.graphicCallback(r?.content,{graphic:C}):null};x._queryFeature=async function(r){const {_featureAbortController:C,_sourceLayer:O,graphic:P,_effectivePopupTemplate:S}=this,W=this.map,Y=this.view,Z=this.spatialReference;if(C===this._featureAbortController&&P){await n.queryUpdatedFeature({graphic:P,popupTemplate:S,layer:O,spatialReference:Z},r);var {content:{value:aa},
title:{value:ba}}=await H.eachAlways({content:this._getContent(),title:this._getTitle()});({expressionAttributes:{value:r}}=await H.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(r),expressionAttributes:c.createCompiledExpressions({expressionInfos:S?.expressionInfos,spatialReference:Z,graphic:P,map:W,interceptor:L.interceptor,view:Y})}));C===this._featureAbortController&&P&&(this._expressionAttributes=r,this._graphicExpressionAttributes={...P.attributes,...r},this._set("formattedAttributes",
this._createFormattedAttributes(aa)),this._set("title",this._compileTitle(ba)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(aa)||null))}};x._createMediaFormattedAttributes=function({contentElement:r,contentElementIndex:C,formattedAttributes:O}){const {_effectivePopupTemplate:P,graphic:S,relatedInfos:W,_sourceLayer:Y,_fieldInfoMap:Z,_graphicExpressionAttributes:aa}=this;O.content[C]=n.formatAttributes({fieldInfos:P?.fieldInfos,graphic:S,attributes:{...aa,
...r.attributes},layer:Y,fieldInfoMap:Z,relatedInfos:W})};x._createFieldsFormattedAttributes=function({contentElement:r,contentElementIndex:C,formattedAttributes:O}){if(r.fieldInfos){const {graphic:P,relatedInfos:S,_sourceLayer:W,_fieldInfoMap:Y,_graphicExpressionAttributes:Z}=this;O.content[C]=n.formatAttributes({fieldInfos:r.fieldInfos,graphic:P,attributes:{...Z,...r.attributes},layer:W,fieldInfoMap:Y,relatedInfos:S})}};x._createFormattedAttributes=function(r){const {_effectivePopupTemplate:C,graphic:O,
relatedInfos:P,_sourceLayer:S,_fieldInfoMap:W,_graphicExpressionAttributes:Y}=this,Z={global:n.formatAttributes({fieldInfos:C?.fieldInfos,graphic:O,attributes:Y,layer:S,fieldInfoMap:W,relatedInfos:P}),content:[]};Array.isArray(r)&&r.forEach((aa,ba)=>{"fields"===aa.type&&this._createFieldsFormattedAttributes({contentElement:aa,contentElementIndex:ba,formattedAttributes:Z});"media"===aa.type&&this._createMediaFormattedAttributes({contentElement:aa,contentElementIndex:ba,formattedAttributes:Z})});return Z};
x._checkForRelatedFeatures=function(r){const {graphic:C,_effectivePopupTemplate:O}=this;return this._queryRelatedInfos(C,n.getAllFieldInfos(O),r)};x._queryRelatedInfos=async function(r,C,O){const {relatedInfos:P,_sourceLayer:S}=this;P.clear();const W=M.isSome(S?.associatedLayer)?await S?.associatedLayer.load(O):S;if(W&&r){var Y=C.filter(ba=>ba&&n.isRelatedField(ba.fieldName));if(Y&&Y.length){C.forEach(ba=>this._configureRelatedInfo(ba,W));var Z=await A.queryLayerInfos({relatedInfos:P,layer:W},O);
Object.keys(Z).forEach(ba=>{const V=P.get(ba.toString());ba=Z[ba]?.value;V&&ba&&(V.layerInfo=ba.data)});var aa=await A.queryRelatedFeatures({graphic:r,relatedInfos:P,layer:W},O);Object.keys(aa).forEach(ba=>{A.setRelatedFeatures(aa[ba]?.value,P.get(ba.toString()))})}}};x._configureRelatedInfo=function(r,C){const {relatedInfos:O}=this,P=A.getRelatedFieldInfo(r.fieldName);if(P){var {layerId:S,fieldName:W}=P;S&&(C=O.get(S.toString())||A.createRelatedInfo(S,C))&&(A.updateRelatedInfo({relatedInfo:C,fieldName:W,
fieldInfo:r}),this.relatedInfos.set(S,C))}};q._createClass(R,[{key:"_effectivePopupTemplate",get:function(){return M.isSome(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}},{key:"_fieldInfoMap",get:function(){return n.createfieldInfoMap(n.getAllFieldInfos(this._effectivePopupTemplate),this._sourceLayer)}},{key:"_sourceLayer",get:function(){return n.getSourceLayer(this.graphic)}},{key:"isTable",get:function(){return this._sourceLayer?.isTable||!1}},{key:"state",
get:function(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}},{key:"graphic",set:function(r){this._set("graphic",r?r.clone():null)}},{key:"spatialReference",get:function(){return this.view?.spatialReference??null},set:function(r){this._override("spatialReference",r)}},{key:"map",get:function(){return this.view?.map||null},set:function(r){this._override("map",r)}},{key:"waitingForContent",get:function(){return!!this._featureAbortController}}]);return R}(K.IdentifiableMixin(B));
B.interceptor=new p.FeatureSetQueryInterceptor(n.preLayerQueryCallback,n.preRequestCallback);h.__decorate([g.property()],B.prototype,"_error",void 0);h.__decorate([g.property()],B.prototype,"_featureAbortController",void 0);h.__decorate([g.property({readOnly:!0})],B.prototype,"_effectivePopupTemplate",null);h.__decorate([g.property({readOnly:!0})],B.prototype,"_fieldInfoMap",null);h.__decorate([g.property({readOnly:!0})],B.prototype,"_sourceLayer",null);h.__decorate([g.property()],B.prototype,"abilities",
void 0);h.__decorate([y.cast("abilities")],B.prototype,"castAbilities",null);h.__decorate([g.property({readOnly:!0})],B.prototype,"content",void 0);h.__decorate([g.property({readOnly:!0})],B.prototype,"contentViewModels",void 0);h.__decorate([g.property()],B.prototype,"description",void 0);h.__decorate([g.property({type:Boolean})],B.prototype,"defaultPopupTemplateEnabled",void 0);h.__decorate([g.property({readOnly:!0})],B.prototype,"isTable",null);h.__decorate([g.property({readOnly:!0})],B.prototype,
"state",null);h.__decorate([g.property({readOnly:!0})],B.prototype,"formattedAttributes",void 0);h.__decorate([g.property({type:m,value:null})],B.prototype,"graphic",null);h.__decorate([g.property({readOnly:!0})],B.prototype,"lastEditInfo",void 0);h.__decorate([g.property({readOnly:!0})],B.prototype,"relatedInfos",void 0);h.__decorate([g.property()],B.prototype,"spatialReference",null);h.__decorate([g.property({readOnly:!0})],B.prototype,"title",void 0);h.__decorate([g.property()],B.prototype,"map",
null);h.__decorate([g.property({readOnly:!0})],B.prototype,"waitingForContent",null);h.__decorate([g.property()],B.prototype,"view",void 0);return B=L=h.__decorate([z.subclass("esri.widgets.FeatureViewModel")],B)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers"],function(q,h){h=h._createClass(function(m,p){this.preLayerQueryCallback=m;this.preRequestCallback=p;this.preLayerQueryCallback||(this.preLayerQueryCallback=
B=>{});this.preRequestCallback||(this.preLayerQueryCallback=B=>{})});q.FeatureSetQueryInterceptor=h;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/resources":function(){define(["exports"],function(q){q.CSS={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",
btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};
Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../resources ../../support/widget ../../support/jsxFactory".split(" "),function(q,h,m,p,B,D,K,N,M,H,b,a){q.FeatureContentMixin=
g=>{g=function(y){function k(){var z=l.apply(this,arguments);z.renderNodeContent=t=>b.isWidget(t)&&!t.destroyed?a.tsx("div",{class:H.CSS.contentNode,key:t},t.render()):t instanceof HTMLElement?a.tsx("div",{class:H.CSS.contentNode,key:t,bind:t,afterCreate:z._attachToNode}):b.hasDomNode(t)?a.tsx("div",{class:H.CSS.contentNode,key:t,bind:t.domNode,afterCreate:z._attachToNode}):null;return z}h._inherits(k,y);var l=h._createSuper(k);k.prototype._attachToNode=function(z){z.appendChild(this)};return h._createClass(k)}(g);
return g=m.__decorate([M.subclass("esri.widgets.Feature.ContentMixin")],g)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureExpression ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureRelationship ./Feature/FeatureViewModel ./Feature/resources ./Feature/support/FeatureContentMixin ./support/componentsUtils ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),function(q,
h,m,p,B,D,K,N,M,H,b,a,g,y,k,l,z,t,e,v,I,u,f,d,c,n){var A;const L={title:!0,content:!0,lastEditedInfo:!0};p=A=function(F){function x(G,r){G=R.call(this,G,r);G._contentWidgets=[];G.flowItems=null;G.headingLevel=2;G.messages=null;G.messagesCommon=null;G.messagesURIUtils=null;G.visibleElements={...L};G.viewModel=new t;return G}h._inherits(x,F);var R=h._createSuper(x);F=x.prototype;F.initialize=function(){this.addHandles(B.watch(()=>this.viewModel?.contentViewModels,()=>this._setupContentWidgets(),B.initial))};
F.loadDependencies=function(){return I.loadCalciteComponents({notice:()=>new Promise((G,r)=>q(["../chunks/calcite-notice"],G,r))})};F.destroy=function(){this._destroyContentWidgets()};F.castVisibleElements=function(G){return{...L,...G}};F.render=function(){var {state:G}=this.viewModel;G=c.tsx("div",{class:e.CSS.container,key:"container"},this.renderTitle(),"error"===G?this.renderError():"loading"===G?this.renderLoading():this.renderContentContainer());return c.tsx("div",{class:this.classes(e.CSS.base,
e.CSS.esriWidget)},G)};F.setActiveMedia=function(G,r){return this.viewModel.setActiveMedia(G,r)};F.nextMedia=function(G){return this.viewModel.nextMedia(G)};F.previousMedia=function(G){return this.viewModel.previousMedia(G)};F.renderError=function(){const {messagesCommon:G,messages:r,visibleElements:C}=this;return c.tsx("calcite-notice",{open:!0,kind:"danger",icon:"exclamation-mark-circle",scale:"s"},C.title?c.tsx("div",{key:"error-title",slot:"title"},G.errorMessage):null,c.tsx("div",{key:"error-message",
slot:"message"},r.loadingError))};F.renderLoading=function(){return c.tsx("div",{key:"loading-container",class:e.CSS.loadingSpinnerContainer},c.tsx("span",{class:this.classes(e.CSS.iconLoading,e.CSS.spinner)}))};F.renderContentContainer=function(){const {visibleElements:G}=this;return G.content?c.tsx("div",{class:e.CSS.main},[this.renderContent(),this.renderLastEditInfo()]):null};F.renderTitle=function(){const {visibleElements:G,title:r}=this;return G.title?c.tsx(u.Heading,{level:this.headingLevel,
class:e.CSS.title,innerHTML:r}):null};F.renderContent=function(){var G=this.viewModel.content;return G?Array.isArray(G)?G.length?c.tsx("div",{class:e.CSS.contentNode,key:"content-content-elements"},G.map(this.renderContentElement,this)):null:"string"===typeof G?(G=this._contentWidgets[0],!G||G.destroyed?null:c.tsx("div",{class:e.CSS.contentNode,key:"content-content"},G.render())):this.renderNodeContent(G):null};F.renderContentElement=function(G,r){const {visibleElements:C}=this;if("boolean"!==typeof C.content&&
!C.content?.[G.type])return null;switch(G.type){case "attachments":return this.renderAttachments(r);case "custom":return this.renderCustom(G,r);case "fields":return this.renderFields(r);case "media":return this.renderMedia(r);case "text":return this.renderText(G,r);case "expression":return this.renderExpression(r);case "relationship":return this.renderRelationship(r);default:return null}};F.renderAttachments=function(G){const r=this._contentWidgets[G];if(!r||r.destroyed)return null;const {state:C,
attachmentInfos:O}=r.viewModel;return"loading"===C||0<O.length?c.tsx("div",{key:this._buildKey("attachments-element",G),class:this.classes(e.CSS.contentElement)},r.render()):null};F.renderRelationship=function(G){const r=this._contentWidgets[G];return r&&!r.destroyed&&this.flowItems?c.tsx("div",{key:this._buildKey("relationship-element",G),class:e.CSS.contentElement},r.render()):null};F.renderExpression=function(G){const r=this._contentWidgets[G];return!r||r.destroyed?null:c.tsx("div",{key:this._buildKey("expression-element",
G),class:e.CSS.contentElement},r.render())};F.renderCustom=function(G,r){({creator:G}=G);const C=this._contentWidgets[r];return!C||C.destroyed?null:G?c.tsx("div",{key:this._buildKey("custom-element",r),class:e.CSS.contentElement},C.render()):null};F.renderFields=function(G){const r=this._contentWidgets[G];return!r||r.destroyed?null:c.tsx("div",{key:this._buildKey("fields-element",G),class:e.CSS.contentElement},r.render())};F.renderMedia=function(G){const r=this._contentWidgets[G];return!r||r.destroyed?
null:c.tsx("div",{key:this._buildKey("media-element",G),class:e.CSS.contentElement},r.render())};F.renderLastEditInfo=function(){const {visibleElements:G,messages:r}=this;var {lastEditInfo:C}=this.viewModel;if(!C||!G.lastEditedInfo)return null;const {date:O,user:P}=C;C=n.substitute("edit"===C.type?P?r.lastEditedByUser:r.lastEdited:P?r.lastCreatedByUser:r.lastCreated,{date:O,user:P});return c.tsx("div",{key:"edit-info-element",class:this.classes(e.CSS.lastEditedInfo,e.CSS.contentElement)},C)};F.renderText=
function(G,r){const C=this._contentWidgets[r];return!C||C.destroyed?null:G.text?c.tsx("div",{key:this._buildKey("text-element",r),class:this.classes(e.CSS.contentElement,e.CSS.text)},C.render()):null};F._buildKey=function(G,...r){const C=this.get("viewModel.graphic.uid")||"0";r=r.join("-");return`${G}__${C}-${r}`};F._destroyContentWidget=function(G){G&&(G.viewModel=null,!G.destroyed&&G.destroy())};F._destroyContentWidgets=function(){this.removeHandles("relationship-handles");this._contentWidgets.forEach(G=>
this._destroyContentWidget(G));this._contentWidgets=[]};F._addFeatureRelationshipHandles=function(G){const {flowItems:r,visibleElements:C}=this;this.addHandles([B.on(()=>G,"select-record",({featureViewModel:O})=>{r&&(O.abilities={relationshipContent:!0},r.push(new A({flowItems:r,viewModel:O,visibleElements:C})))}),B.on(()=>G,"show-all-records",()=>{if(r){var {viewModel:O}=G;O.showAllEnabled=!0;O=new z({visibleElements:{title:!1,description:!1},viewModel:O});this._addFeatureRelationshipHandles(O);
r.push(O)}})],"relationship-handles")};F._setupContentWidgets=function(){this._destroyContentWidgets();const {headingLevel:G,visibleElements:r}=this;var C=this.get("viewModel.content");const {contentViewModels:O}=this.viewModel;Array.isArray(C)?C.forEach((P,S)=>{"attachments"===P.type&&(this._contentWidgets[S]=new a({displayType:P.displayType,headingLevel:r.title?G+1:G,viewModel:O[S]}));"fields"===P.type&&(this._contentWidgets[S]=new k({viewModel:O[S]}));"media"===P.type&&(this._contentWidgets[S]=
new l({viewModel:O[S]}));"text"===P.type&&(this._contentWidgets[S]=new g({viewModel:O[S]}));"custom"===P.type&&(this._contentWidgets[S]=new g({viewModel:O[S]}));"expression"===P.type&&(this._contentWidgets[S]=new y({viewModel:O[S]}));"relationship"===P.type&&(P=new z({viewModel:O[S]}),this._addFeatureRelationshipHandles(P),this._contentWidgets[S]=P)},this):(C=O[0])&&!C.destroyed&&(this._contentWidgets[0]=new g({viewModel:C}));this.scheduleRender()};h._createClass(x,[{key:"graphic",get:function(){return this.viewModel.graphic},
set:function(G){this.viewModel.graphic=G}},{key:"defaultPopupTemplateEnabled",get:function(){return this.viewModel.defaultPopupTemplateEnabled},set:function(G){this.viewModel.defaultPopupTemplateEnabled=G}},{key:"isTable",get:function(){return this.viewModel.isTable}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(G){this._overrideIfSome("label",G)}},{key:"spatialReference",get:function(){return this.viewModel.spatialReference},set:function(G){this.viewModel.spatialReference=
G}},{key:"title",get:function(){return this.viewModel.title}},{key:"map",get:function(){return this.viewModel.map},set:function(G){this.viewModel.map=G}},{key:"view",get:function(){return this.viewModel.view},set:function(G){this.viewModel.view=G}}]);return x}(v.FeatureContentMixin(b));m.__decorate([D.property()],p.prototype,"graphic",null);m.__decorate([D.property()],p.prototype,"defaultPopupTemplateEnabled",null);m.__decorate([D.property()],p.prototype,"flowItems",void 0);m.__decorate([D.property()],
p.prototype,"headingLevel",void 0);m.__decorate([D.property({readOnly:!0})],p.prototype,"isTable",null);m.__decorate([D.property()],p.prototype,"label",null);m.__decorate([D.property(),d.messageBundle("esri/widgets/Feature/t9n/Feature")],p.prototype,"messages",void 0);m.__decorate([D.property(),d.messageBundle("esri/t9n/common")],p.prototype,"messagesCommon",void 0);m.__decorate([D.property(),d.messageBundle("esri/widgets/support/t9n/uriUtils")],p.prototype,"messagesURIUtils",void 0);m.__decorate([D.property()],
p.prototype,"spatialReference",null);m.__decorate([D.property({readOnly:!0})],p.prototype,"title",null);m.__decorate([D.property()],p.prototype,"visibleElements",void 0);m.__decorate([K.cast("visibleElements")],p.prototype,"castVisibleElements",null);m.__decorate([D.property()],p.prototype,"map",null);m.__decorate([D.property()],p.prototype,"view",null);m.__decorate([D.property({type:t})],p.prototype,"viewModel",void 0);return p=A=m.__decorate([H.subclass("esri.widgets.Feature")],p)});