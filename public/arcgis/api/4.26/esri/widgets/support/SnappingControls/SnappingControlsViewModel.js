// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/HandleOwner ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),function(k,
e,c,l,m,g,h,v,w,x,n,p,q,r){c=function(d){function f(a){a=t.call(this,a);a.layerListViewModel=new r.SnappingLayerListViewModel;a.snappingOptions=null;a.view=null;return a}k._inherits(f,d);var t=k._createSuper(f);d=f.prototype;d.initialize=function(){this.handles.add([g.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:a,view:b})=>{a.view=b},g.initial),g.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:a,sources:b})=>{a.featureSnappingSources=
b},g.initial)])};d.enableSnappingForLayer=function(a){(this._findSnappingSourceForLayer(a)??this._makeSnappingSourceForLayer(a)).enabled=!0};d.disableSnappingForLayer=function(a){if(a=this._findSnappingSourceForLayer(a))a.enabled=!1};d.updateEnabledFeatureSources=function(a){for(const b of this.snappingOptions.featureSources)q.canDisplayLayer(b.layer)&&(b.enabled=a.includes(b.layer.id))};d._findSnappingSourceForLayer=function(a){return this.snappingOptions.featureSources.find(b=>b.layer.id===a)};
d._makeSnappingSourceForLayer=function(a){var b=this.layerListViewModel.operationalItemsFlat.find(u=>u.layer.id===a)?.layer;if(!b)throw new l("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${a} because no such layer was found in the view`);b=new p({layer:b});this.snappingOptions.featureSources.add(b);return b};k._createClass(f,[{key:"state",get:function(){return this.get("snappingOptions")?"ready":"disabled"}}]);return f}(m.HandleOwnerMixin(c));e.__decorate([h.property({constructOnly:!0})],
c.prototype,"layerListViewModel",void 0);e.__decorate([h.property()],c.prototype,"snappingOptions",void 0);e.__decorate([h.property()],c.prototype,"state",null);e.__decorate([h.property()],c.prototype,"view",void 0);return c=e.__decorate([n.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],c)});