// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(x,M,K,w,u,D,E,F,O,f,d,b,n){const e=u.ofType(b),A="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.SubtypeGroupLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer esri.layers.LinkChartLayer esri.layers.knowledgeGraph.KnowledgeGraphSubLayer".split(" "),
y=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];K=function(h){function G(g){g=l.call(this,g);g._layerViewByLayerId={};g._layerInfosByLayerViewId={};g._activeLayerInfosByLayerViewId={};g._activeLayerInfosWithNoParent=new u;g.activeLayerInfos=new e;g.basemapLegendVisible=!1;g.groundLegendVisible=!1;g.hideLayersNotInCurrentView=!1;g.keepCacheOnDestroy=!1;g.respectLayerVisibility=!0;g.layerInfos=[];g.view=null;return g}x._inherits(G,
h);var l=x._createSuper(G);h=G.prototype;h.initialize=function(){this.addHandles(D.watch(()=>this.view,()=>this._viewHandles(),D.initial),"view");this.addHandles(n.onLocaleChange(()=>this._refresh()))};h.destroy=function(){this._destroyViewActiveLayerInfos();this.view=null};h._viewHandles=function(){this.removeHandles("state");this.view&&this.addHandles(D.watch(()=>this.state,()=>this._stateHandles(),D.initial),"state")};h._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};
h._resetAll=function(){this.removeHandles(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};h._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};h._destroyViewActiveLayerInfo=function(g){this.removeHandles(g);const m=this._activeLayerInfosByLayerViewId[g];delete this._activeLayerInfosByLayerViewId[g];m&&m.parent&&m.parent.children.remove(m)};h._watchPropertiesAndAllLayerViews=
function(){var {view:g}=this;g&&({allLayerViews:g}=g,g.length&&this._refresh(),this.addHandles(g.on("change",m=>this._allLayerViewsChangeHandle(m)),"all-layer-views"),this.addHandles(D.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties"))};h._allLayerViewsChangeHandle=function(g){g.removed.forEach(m=>this._destroyViewActiveLayerInfo(m.uid));this._refresh()};h._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();
this._refresh()};h._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};h._sortActiveLayerInfos=function(g){const m=this.view;if(!(2>g.length)&&m){var P=[];g.forEach(c=>{if(!c.parent){var p=c.layer.parent;(p=(p=p&&"uid"in p&&this._layerViewByLayerId[p.uid])&&
this._activeLayerInfosByLayerViewId[p.uid])&&g.includes(p)&&(P.push(c),c.parent=p,p.children.add(c),this._sortActiveLayerInfos(p.children))}});g.removeMany(P);var L={};m.allLayerViews.forEach((c,p)=>L[c.layer.uid]=p);g.sort((c,p)=>(L[p.layer.uid]||0)-(L[c.layer.uid]||0))}};h._generateLayerViews=function(){const g=[];y.filter(this._filterLayerViews,this).map(this.get,this).filter(m=>null!=m).forEach(this._collectLayerViews("layerViews",g));return g};h._filterLayerViews=function(g){const m=!this.groundLegendVisible&&
"view.groundView.layerViews"===g;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===g||"view.basemapView.referenceLayerViews"===g))&&!m};h._collectLayerViews=function(g,m){const P=L=>{L&&L.forEach(c=>{m.push(c);P(c[g])});return m};return P};h._filterLayerViewsByLayerInfos=function(g){const m=this.layerInfos;return m&&m.length?m.some(P=>this._hasLayerInfo(P,g)):!0};h._hasLayerInfo=function(g,m){const P=this._isLayerUIDMatching(g.layer,m.layer.uid);P&&(this._layerInfosByLayerViewId[m.uid]=
g);return P};h._isLayerUIDMatching=function(g,m){return g&&(g.uid===m||this._hasLayerUID(g.layers,m))};h._hasLayerUID=function(g,m){return g&&g.some(P=>this._isLayerUIDMatching(P,m))};h._isLayerViewSupported=function(g){return A.includes(g.layer.declaredClass)?(this._layerViewByLayerId[g.layer.uid]=g,!0):!1};h._generateActiveLayerInfo=function(g){this._isLayerActive(g)?this._buildActiveLayerInfo(g):(this.removeHandles(g.uid),this.addHandles(D.watch(()=>[g.legendEnabled,g.layer?.legendEnabled],()=>
this._layerActiveHandle(g)),g.uid))};h._layerActiveHandle=function(g){this._isLayerActive(g)&&(this.removeHandles(g.uid),this._buildActiveLayerInfo(g))};h._isLayerActive=function(g){return this.respectLayerVisibility?g.legendEnabled&&g.get("layer.legendEnabled"):!0};h._buildActiveLayerInfo=function(g){const m=g.layer,P=g.uid;var L=this._layerInfosByLayerViewId[P];let c=this._activeLayerInfosByLayerViewId[P];c||(c=new b({layer:m,layerView:g,title:L&&void 0!==L.title&&L.layer.uid===m.uid?L.title:m.title,
view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:L&&L.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[P]=c);c.parent=this._activeLayerInfosByLayerViewId[(m.parent&&"uid"in m.parent?this._layerViewByLayerId[m.parent?.uid]:null)?.uid];if(!this.hasHandles(P)){L=D.watch(()=>m.title,r=>this._titleHandle(r,c));var p=D.watch(()=>[m.opacity,"renderer"in m&&m.renderer,"pointSymbol"in
m&&m.pointSymbol,"lineSymbol"in m&&m.lineSymbol,"polygonSymbol"in m&&m.polygonSymbol],()=>this._constructLegendElements(c)),q=D.when(()=>!0===this.view?.stationary,()=>this._scaleHandle(c),D.initial);const Q=D.watch(()=>g._effectiveRenderer,()=>this._constructLegendElements(c)),J=D.watch(()=>"effect"in m&&m.effect,()=>this._constructLegendElements(c));L=[L,p,q,Q,J];this.respectLayerVisibility&&(p=D.watch(()=>g.legendEnabled,r=>this._legendEnabledHandle(r,c)),q=D.watch(()=>m.legendEnabled,r=>this._legendEnabledHandle(r,
c)),L.push(p,q));this.addHandles(L,P)}c.isScaleDriven||this._constructLegendElements(c);this._addActiveLayerInfo(c)};h._titleHandle=function(g,m){m.title=g;this._constructLegendElements(m)};h._legendEnabledHandle=function(g,m){g?this._addActiveLayerInfo(m):this._removeActiveLayerInfo(m)};h._scaleHandle=function(g){(g.isScaleDriven||g.hideLayersNotInCurrentView)&&this._constructLegendElements(g)};h._addActiveLayerInfo=function(g){const {layerView:m,layer:P}=g;if(this._isLayerActive(m)&&!this.activeLayerInfos.includes(g)){var L=
g.parent;L?(L.children.includes(g)||L.children.push(g),this._sortActiveLayerInfos(L.children)):(L=this.layerInfos?.some(c=>c.layer.uid===P.uid),P.parent&&"uid"in P.parent&&!L?this._activeLayerInfosWithNoParent.add(g):(this.activeLayerInfos.add(g),this._sortActiveLayerInfos(this.activeLayerInfos)));if(this._activeLayerInfosWithNoParent.length){const c=[];this._activeLayerInfosWithNoParent.forEach(p=>{var q=p.layer.parent;if(q=this._activeLayerInfosByLayerViewId[(q&&"uid"in q?this._layerViewByLayerId[q?.uid]:
null)?.uid])c.push(p),p.parent=q});c.length&&(this._activeLayerInfosWithNoParent.removeMany(c),c.forEach(p=>this._addActiveLayerInfo(p)))}}};h._removeActiveLayerInfo=function(g){const m=g.parent;m?m.children.remove(g):this.activeLayerInfos.remove(g)};h._constructLegendElements=function(g){const m=g.layer;"featureCollections"in m&&m.featureCollections?g.buildLegendElementsForFeatureCollections(m.featureCollections):"featureReduction"in m&&m.featureReduction&&"renderer"in m.featureReduction&&("binning"===
m.featureReduction.type||"cluster"===m.featureReduction.type)?g.buildLegendElementsForFeatureReduction(m.featureReduction):"renderer"in m&&m.renderer&&!("sublayers"in m)?g.buildLegendElementsForRenderer(m.renderer):"url"in m&&m.url?g.buildLegendElementsForTools():g.children.forEach(P=>this._constructLegendElements(P))};x._createClass(G,[{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]);return G}(w);M.__decorate([E.property({type:e})],K.prototype,"activeLayerInfos",void 0);
M.__decorate([E.property()],K.prototype,"basemapLegendVisible",void 0);M.__decorate([E.property()],K.prototype,"groundLegendVisible",void 0);M.__decorate([E.property()],K.prototype,"hideLayersNotInCurrentView",void 0);M.__decorate([E.property()],K.prototype,"keepCacheOnDestroy",void 0);M.__decorate([E.property()],K.prototype,"respectLayerVisibility",void 0);M.__decorate([E.property()],K.prototype,"layerInfos",void 0);M.__decorate([E.property({readOnly:!0})],K.prototype,"state",null);M.__decorate([E.property()],
K.prototype,"view",void 0);return K=M.__decorate([d.subclass("esri.widgets.Legend.LegendViewModel")],K)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../Color ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/Collection ../../../core/jsonMap ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../layers/support/rasterFormats/pixelRangeUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol".split(" "),
function(x,M,K,w,u,D,E,F,O,f,d,b,n,e,A,y,h,G,l,g,m,P,L,c,p,q,Q,J,r,H,N,S,Y,W,k,B,C,v,I,U,X,ha,ca,la){function ma(aa){return"esri.renderers.SimpleRenderer"===aa.declaredClass}function fa(aa){return"esri.renderers.ClassBreaksRenderer"===aa.declaredClass}function Z(aa){return"esri.renderers.UniqueValueRenderer"===aa.declaredClass}function ia(aa){return"esri.renderers.HeatmapRenderer"===aa.declaredClass}function na(aa){return"esri.renderers.PointCloudClassBreaksRenderer"===aa.declaredClass}function oa(aa){return"esri.renderers.PointCloudStretchRenderer"===
aa.declaredClass}function qa(aa){return"esri.renderers.PointCloudUniqueValueRenderer"===aa.declaredClass}function ra(aa){return"esri.renderers.DotDensityRenderer"===aa.declaredClass}function va(aa){return"esri.renderers.PieChartRenderer"===aa.declaredClass}function ya(aa){return"esri.layers.SubtypeGroupLayer"===aa.declaredClass}function za(aa){aa="authoringInfo"in aa?aa?.authoringInfo:null;return"univariate-color-size"===aa?.type&&"above-and-below"===aa?.univariateTheme}const Aa=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,
Na=new f.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Ba=new ca({size:6,outline:{color:[128,128,128,.5],width:.5}}),Wa=new la({style:"solid"}),Xa=new ca({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ca={};E=function(aa){function Ga(a){a=Ya.call(this,a);a._hasColorRamp=!1;a._hasOpacityRamp=!1;a._hasSizeRamp=!1;a._webStyleSymbolCache=
new Map;a._dotDensityUrlCache=new Map;a._scaleDrivenSizeVariable=null;a._hasClusterSizeVariable=!1;a.children=new O;a.layerView=null;a.layer=null;a.legendElements=[];a.parent=null;a.hideLayersNotInCurrentView=!1;a.keepCacheOnDestroy=!1;a.respectLayerVisibility=!0;a.sublayerIds=[];a.title=null;a.view=null;return a}M._inherits(Ga,aa);var Ya=M._createSuper(Ga);aa=Ga.prototype;aa.initialize=function(){const a=()=>this.notifyChange("ready");this.addHandles([e.on(()=>this.children,"change",t=>{const {added:z,
removed:R}=t;z.forEach(T=>{const V=`activeLayerInfo-ready-watcher-${T.layer.uid}`;this.addHandles(e.watch(()=>T.ready,a,e.initial),V)});R.forEach(T=>this.removeHandles(T.layer.uid));a()})]);this.keepCacheOnDestroy||(Ca={})};aa.destroy=function(){this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=null;this.keepCacheOnDestroy||(Ca=null)};aa.buildLegendElementsForFeatureCollections=async function(a){if(this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())this.legendElements=
[],this.notifyChange("ready");else{a=Array.from(a,t=>{if("esri.layers.FeatureLayer"===t.declaredClass)return this._getRendererLegendElements(t.renderer,{title:t.title});if(t.featureSet&&t.featureSet.features.length){var z=t.layerDefinition,R=z&&z.drawingInfo;R=R&&J.fromJSON(R.renderer);z=Na.read(z.geometryType);return R?this._getRendererLegendElements(R,{title:t.name,geometryType:z}):(d.getLogger(this.declaredClass).warn("drawingInfo not available!"),null)}return null});try{const t=[];await n.eachAlways(a).then(z=>
{z.forEach(({value:R})=>R&&t.push(...R))});this.legendElements=t;this.notifyChange("ready")}catch(t){d.getLogger(this.declaredClass).warn("error while building legend for layer!",t)}}};aa.buildLegendElementsForRenderer=async function(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(t){d.getLogger(this.declaredClass).warn("error while building legend for layer!",t)}};aa.buildLegendElementsForFeatureReduction=
async function(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getLegendElementsForFeatureReduction(a):[],this.notifyChange("ready")}catch(t){d.getLogger(this.declaredClass).warn("error while building legend for layer!",t)}};aa.buildLegendElementsForTools=async function(){const a=this.layer;if("esri.layers.VoxelLayer"===a.declaredClass)this._constructLegendElementsForVoxellayer();else if("esri.layers.WMTSLayer"===a.declaredClass)this._constructLegendElementsForWMTSlayer();
else if("esri.layers.WMSLayer"===a.declaredClass)await this._constructLegendElementsForWMSSublayers();else if("esri.layers.BuildingSceneLayer"===a.declaredClass)await this._constructLegendElementsForBuildingSceneLayer();else if("esri.layers.MapImageLayer"===a.declaredClass||"esri.layers.TileLayer"===a.declaredClass||ya(a))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");var t="default";if("esri.layers.ImageryLayer"===a.declaredClass){t=a?.renderingRule?.functionName||
"default";const z=a.bandIds?.length?a.bandIds.join(""):"###";t=t+"_"+z}await this._getLegendLayers(`${a.uid}-${t}`).then(async z=>{this.legendElements=[];this.notifyChange("ready");z=z.map(async R=>{if("esri.layers.ImageryLayer"===a.declaredClass||"esri.layers.ImageryTileLayer"===a.declaredClass){const T=e.watch(()=>["renderingRule"in a&&a.renderingRule,a.bandIds],()=>n.debounce(async()=>{Ca["default"]=null;a.renderer?await this.buildLegendElementsForRenderer(a.renderer):await this.buildLegendElementsForTools()})());
this.addHandles(T,"imageryLayers-watcher")}(R=this._generateSymbolTableElementForLegendLayer(R))&&R.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(R.title=a.title),this.legendElements.push(R));this.notifyChange("ready")});await n.eachAlways(z)}).catch(z=>{d.getLogger(this.declaredClass).warn("Request to server for legend has failed!",z)})}};aa._isLayerInCurrentView=async function(){const a=this.layer,t=this.layerView,z=t&&"createQuery"in t&&"queryFeatureCount"in t;if(!(z||t&&"createQuery"in
a&&"queryFeatureCount"in a))return!0;await e.whenOnce(()=>!t.updating);const R=z?"createQuery"in t&&t.createQuery():"createQuery"in a&&a.createQuery();if(!R)return!0;R.geometry=this.view.extent;return 0!==(z?"queryFeatureCount"in t&&await t.queryFeatureCount(R):"queryFeatureCount"in a&&await a.queryFeatureCount(R))};aa._getParentLayerOpacity=function(a){let t=1;const z=a.parent;z&&"uid"in z&&(t=this._getParentLayerOpacity(z));return a.opacity*t};aa._isGroupActive=function(){const a=this.children;
return a.length?a.some(t=>t.ready):!1};aa._isRendererScaleDriven=function(a){return"dot-density"===a.type||Aa.test("valueExpression"in a?a.valueExpression:null)?!0:(a="visualVariables"in a?a.visualVariables:null)?a.some(t=>this._isScaleDrivenSizeVariable(t)):!1};aa._isScaleDrivenSizeVariable=function(a){if(a&&"size"!==a.type)return!1;const t=a.minSize,z=a.maxSize;return"object"===typeof t&&t?this._isScaleDrivenSizeVariable(t):"object"===typeof z&&z?this._isScaleDrivenSizeVariable(z):!!a.expression||
Aa.test(a.valueExpression)};aa._isLayerScaleDriven=function(a){if("minScale"in a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&a.sublayers)return a.sublayers.some(z=>this._isLayerScaleDriven(z));const t=a.parent;if(!1===a.loaded&&t&&"esri.layers.MapImageLayer"===t.declaredClass&&"source"in a&&a.source&&"map-layer"===a.source.type)for(const z of t.sourceJSON.layers??[])if(z.id===a.source.mapLayerId&&(0<z.minScale||0<z.maxScale))return!0;return!1};aa._constructLegendElementsForVoxellayer=
async function(){this.legendElements=[];this.removeHandles("voxel-style-watcher");this.removeHandles("voxel-current-variable");const a=this.layer;this.addHandles(e.watch(()=>a.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-current-variable");this.addHandles(e.watch(()=>a.getVariableStyles(),()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");var t=b.unwrap(a.getVariableStyle(null));const z=[];if(t)if(t.uniqueValues?.length){const T=[];t.uniqueValues.forEach(V=>
{V.enabled&&T.push({label:V.label||`${V.value}`,value:V.value,symbol:new la({color:V.color,outline:null})})});T.length&&z.push({type:"symbol-table",title:t.label,infos:T})}else if(t.transferFunction){const {colorStops:T,stretchRange:V}=t.transferFunction,ba=T.toArray().reverse(),da=V.map((ja,ea)=>`${0===ea?X.SPECIAL_CHARS_LESS_THAN:X.SPECIAL_CHARS_GREATER_THAN} ${ha.formatNumberLabel(ja)}`).reverse(),sa=ba.map(ja=>({color:ja.color,value:null,label:null}));sa[0].label=da[0];sa[sa.length-1].label=da[1];
z.push({type:"color-ramp",title:t.label,infos:sa,preview:W.renderColorRampPreviewHTML(ba.map(ja=>ja.color))})}const R=a.opacity;t=z.reduce((T,V)=>[...T,...this._getAllInfos(V)],[]).filter(T=>!!T?.symbol).map(T=>this._getSymbolPreview(T,R));await n.eachAlways(t);this.legendElements=z;this.notifyChange("ready")};aa._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this.removeHandles("wmts-activeLayer-watcher");const a=this.layer.activeLayer;this.addHandles(e.watch(()=>{const {layer:t}=
this;return t&&"activeLayer"in t&&t.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(a.styleId&&a.styles){let t=null;a.styles.some(z=>a.styleId===z.id?(t=z.legendUrl,!0):!1);t&&(this.legendElements=[{type:"symbol-table",title:a.title,infos:[{src:t,opacity:this.opacity}]}])}this.notifyChange("ready")};aa._constructLegendElementsForWMSSublayers=async function(){this.legendElements=[];this.removeHandles("wms-sublayers-watcher");const a=this.layer;let t=null;
if(a.customParameters||a.customLayerParameters)t={...a.customParameters,...a.customLayerParameters};this.addHandles(e.watch(()=>{const {layer:z}=this;return z&&"sublayers"in z&&z.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=await this._generateLegendElementsForWMSSublayers(a.sublayers,t);this.notifyChange("ready")};aa._generateLegendElementsForWMSSublayers=async function(a,t){const z=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),
"wms-sublayers-watcher");a=a.toArray();for(const R of a)a=e.watch(()=>[R.title,R.visible,R.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),this.addHandles(a,"wms-sublayers-watcher"),(!this.respectLayerVisibility||R.visible&&R.legendEnabled)&&(a=await this._generateSymbolTableElementForWMSSublayer(R,t))&&a.infos.length&&z.unshift(a);return z};aa._generateSymbolTableElementForWMSSublayer=async function(a,t){return!a.legendUrl&&a.sublayers?(t=(await this._generateLegendElementsForWMSSublayers(a.sublayers,
t)).filter(z=>z),{type:"symbol-table",title:a.title,infos:t}):this._generateSymbolTableElementForLegendUrl(a,t)};aa._generateSymbolTableElementForLegendUrl=async function(a,t){let z=a.legendUrl;if(z){var R={type:"symbol-table",title:a.title||a.name||String(a.id??""),infos:[]};t&&(z=y.addQueryParameters(z,t));t=null;a=a.layer?.opacity;try{if(t=(await D(z,{responseType:"image"})).data)t.style.opacity=a}catch{}R.infos.push({src:z,preview:t,opacity:a});return R}};aa._getLegendLayers=function(a,t){const z=
Ca&&Ca[a];return z?Promise.resolve(z):this._legendRequest(t).then(R=>{R=R.layers;return Ca[a]=R})};aa._legendRequest=function(a){var t=this.layer;a={f:"json",dynamicLayers:a};if("esri.layers.ImageryLayer"===t.declaredClass){var z=t.exportImageServiceParameters.renderingRule;z&&(a.renderingRule=JSON.stringify(z.rasterFunctionDefinition||z.toJSON()));t.bandIds&&(a.bandIds=t.bandIds.join());if(t.raster||t.viewId||t.customParameters){const {raster:R,viewId:T,customParameters:V}=t;a={raster:R,viewId:T,
...a,...V}}}z=t.url.replace(/(\/)+$/,"");"version"in t&&10.01<=t.version?(t=z.indexOf("?"),z=-1<t?z.substring(0,t)+"/legend"+z.substring(t):z+"/legend"):(t=z.toLowerCase().indexOf("/rest/"),t=z.substring(0,t)+z.substring(t+5,z.length),z="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(t)+"\x26returnbytes\x3dtrue");return D(z,{query:a}).then(R=>R.data)};aa._constructLegendElementsForBuildingSceneLayer=async function(){this.legendElements=[];this.removeHandles("sublayers-watcher");
const a=this.layer;this.addHandles(e.watch(()=>a.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(t){d.getLogger(this.declaredClass).warn("Request to server for legend has failed!",t)}};aa._generateLegendElementsForBuildingSublayers=async function(a,t){let z=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),
"sublayers-watcher");a=a.toArray();for(const T of a)if(a=e.watch(()=>["renderer"in T&&T.renderer,T.opacity,T.title,T.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||T.visible){a=T&&null!=T.opacity?T.opacity:null;var R=null!=a?a*t:t;"building-group"===T.type?(a={type:"symbol-table",title:T.title,infos:[]},R=await this._generateLegendElementsForBuildingSublayers(T.sublayers,R),a.infos.push(...R),z=[a,...z]):T.renderer&&
(z=[...(await this._getRendererLegendElements(T.renderer,{title:T.title,opacity:R,sublayer:T})),...z])}return z.filter(T=>!!T&&("infos"in T&&T.infos?0<T.infos.length:!0))};aa._constructLegendElementsForSublayers=async function(){this.legendElements=[];this.removeHandles("sublayers-watcher");const a=this.layer;this.addHandles(e.watch(()=>a.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(a.sublayers,
this.opacity),this.notifyChange("ready")}catch(t){d.getLogger(this.declaredClass).warn("Request to server for legend has failed!",t)}};aa._generateLegendElementsForSublayers=async function(a,t,z){const R=this.layer;let T=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!z&&this.sublayerIds&&this.sublayerIds.length&&(a=this.sublayerIds.map(V=>R.findSublayerById(V)).filter(b.isSome));for(const V of a)if(a=e.watch(()=>[V.renderer,V.opacity,
V.title,V.visible,V.legendEnabled],()=>this._constructLegendElementsForSublayers()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||V.visible&&V.legendEnabled&&this._isSublayerInScale(V)){a=V&&null!=V.opacity?V.opacity:null;a=null!=a?a*t:t;const ba=ya(R)?!0:V.originIdOf("renderer")>P.OriginId.SERVICE;V.renderer&&!V.sublayers&&ba?(await V.load(),T=[...(await this._getRendererLegendElements(V.renderer,{title:V.title,opacity:a,sublayer:V})),...T]):(a=await this._generateSymbolTableElementForSublayer(V,
a,z))&&T.unshift(a)}return T.filter(V=>!!V&&("infos"in V&&V.infos?0<V.infos.length:!0))};aa._generateSymbolTableElementForSublayer=async function(a,t,z){if(!z){z=new Map;var R=this.layer,T=a.source;let V=null;if(T&&("map-layer"!==T.type||T.mapLayerId!==a.id||T.gdbVersion&&T.gdbVersion!==("gdbVersion"in R&&R.gdbVersion))||a.originIdOf("renderer")>P.OriginId.SERVICE||a.originIdOf("labelingInfo")>P.OriginId.SERVICE||a.originIdOf("labelsVisible")>P.OriginId.SERVICE)T=new p.ExportImageParameters({layer:this.layer}),
V=T.hasDynamicLayers?T.dynamicLayers:null,T.destroy();(await this._getLegendLayers(V||`${R.uid}-default`,V)).forEach(ba=>z.set(ba.layerId,ba))}R=z.get(a.id);return(!R||R?.subLayerIds&&R.defaultVisibility)&&a.sublayers?(t=await this._generateLegendElementsForSublayers(a.sublayers,t,z),{type:"symbol-table",title:a.title,infos:t}):this._generateSymbolTableElementForLegendLayer(R,a,t)};aa._generateSymbolTableElementForLegendLayer=function(a,t,z){if(!a||!a.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,
t))return null;var R=t?.renderer;let T=t?.title||a.layerName;R&&(!t||t?.originIdOf("renderer")>P.OriginId.SERVICE)&&(R=t?.title||this._getRendererTitle(R,t))&&(T&&"string"!==typeof R&&"title"in R&&(R.title=T),T=R);const V={type:"symbol-table",title:T,legendType:a.legendType||null,infos:[]},ba=t?this._sanitizeLegendForSublayer(a.legend.slice(),t):a.legend;a.legendGroups&&0<a.legendGroups.length?a.legendGroups.forEach(da=>{const sa={type:"symbol-table",title:da.heading,legendType:a.legendType||null,
infos:this._generateSymbolTableElementInfosForLegendLayer(ba.filter(ja=>ja.groupId===da.id),a.layerId,z)};0<sa.infos?.length&&V.infos.push(sa)}):V.infos=this._generateSymbolTableElementInfosForLegendLayer(ba,a.layerId,z);return 0<V.infos.length?V:null};aa._generateSymbolTableElementInfosForLegendLayer=function(a,t,z){return a.map(R=>{let T=R.url;if(R.imageData&&0<R.imageData.length)T=`data:image/png;base64,${R.imageData}`;else if(0!==T.indexOf("http"))T=u.addTokenParameter(`${this.layer.url}/${t}/images/${T}`);
else return null;return{label:R.label,src:T,opacity:null==z?this.opacity:z,width:R.width,height:R.height}}).filter(b.isSome)};aa._isSublayerInScale=function(a){const t=a.minScale||0;a=a.maxScale||0;return 0<t&&t<this.scale||a>this.scale?!1:!0};aa._isLegendLayerInScale=function(a,t){t=t||this.layer;let z=null,R=null,T=!0;!t.minScale&&0!==t.minScale||!t.maxScale&&0!==t.maxScale?(0===a.minScale&&t.tileInfo&&(z=t.tileInfo.lods[0].scale),0===a.maxScale&&t.tileInfo&&(R=t.tileInfo.lods[t.tileInfo.lods.length-
1].scale)):(z=Math.min(t.minScale,a.minScale)||t.minScale||a.minScale,R=Math.max(t.maxScale,a.maxScale));if(0<z&&z<this.scale||R>this.scale)T=!1;return T};aa._sanitizeLegendForSublayer=function(a,t){if("version"in this.layer&&10.1>this.layer.version||0===a.length)return a;t=t.renderer;let z=0,R=null;a.some(T=>T.values)&&a.some((T,V)=>{T.values||(z=V,R=T,R.label||(R.label="others"));return null!=R});t?"unique-value"===t.type?R&&(a.splice(z,1),a.push(R)):"class-breaks"===t.type&&(R&&a.splice(z,1),a.reverse(),
R&&a.push(R)):R&&(a.splice(z,1),a.push(R));return a};aa._getRendererLegendElements=async function(a,t={}){var z=this.view;z=ma(a)||fa(a)||Z(a)||ia(a)||ra(a)||va(a)?"2d"===z.type||r.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===a.type||"raster-shaded-relief"===a.type||na(a)||oa(a)||qa(a)||"vector-field"===a.type||"flow"===a.type;if(!z)return d.getLogger(this.declaredClass).warn(`Renderer of type '${a.type}' not supported!`),[];if(na(a)||oa(a)||qa(a)||"esri.renderers.PointCloudRGBRenderer"===
a.declaredClass)return this._constructPointCloudRendererLegendElements(a,t);if(ra(a))return this._constructDotDensityRendererLegendElements(a);a=await this._loadRenderer(a);return va(a)?this._constructPieChartRendererLegendElements(a):this._constructRendererLegendElements(a,t)};aa._getLegendElementsForFeatureReduction=async function(a){let t=null;"binning"===a.type?t=a.renderer:"cluster"===a.type&&(t=this._getClusterRenderer(a));return t?this._getRendererLegendElements(t):[]};aa._getPointCloudRendererTitle=
function(a){return(a.legendOptions?.title||a.field)??""};aa._constructPointCloudRendererLegendElements=function(a,t={}){t=t.title;const z=[];let R=null;var T=null;if(na(a))R={type:"symbol-table",title:t||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(V=>{R.infos.unshift({label:V.label||V.minValue+" - "+V.maxValue,value:[V.minValue,V.maxValue],symbol:this._getAppliedCloneSymbol(Ba,V.color)})});else if(oa(a)){T=a.stops;let V=null;if(T?.length&&(1===T.length&&(V=T[0].color),
!V)){const ba=T[0].value,da=T[T.length-1].value;null!=ba&&null!=da&&(V=C.getColorFromPointCloudStops(ba+(da-ba)/2,T))}R={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Ba,V||Ba.color)}]};T=C.getRampStopsForPointCloud(a.stops??[])??[];T={type:"color-ramp",title:t||this._getPointCloudRendererTitle(a),infos:T,preview:W.renderColorRampPreviewHTML(T.map(ba=>ba.color))}}else qa(a)&&(R={type:"symbol-table",title:t||this._getPointCloudRendererTitle(a),infos:[]},
a.colorUniqueValueInfos?.forEach(V=>{R.infos.push({label:V.label||V.values.join(", "),value:V.values.join(", "),symbol:this._getAppliedCloneSymbol(Ba,V.color)})}));R&&R.infos.length&&z.push(R);T&&T.infos.length&&z.push(T);t=z.reduce((V,ba)=>[...V,...(ba.infos??[])],[]).filter(V=>!!V.symbol).map(V=>this._getSymbolPreview(V,this.opacity,{symbolConfig:{applyColorModulation:!!a.colorModulation}}));return n.eachAlways(t).then(()=>z)};aa._getElementInfoForDotDensity=function(a,t){const {backgroundColor:z,
outline:R,dotSize:T}=a;var V=this.effectList?.effects.map(da=>da.toJSON());V=c.effectFunctionsFromJSON(V);V=T+"-"+t+"-"+z+"-"+(R&&JSON.stringify(R.toJSON()))+"-"+V;const ba=this._dotDensityUrlCache;a=ba.has(V)?ba.get(V):W.renderDotDensityPreviewHTML(a,t);ba.set(V,a);t=Y.renderSymbol([[{shape:{type:"image",x:0,y:0,width:a.width,height:a.height,src:a.src},fill:null,stroke:null,offset:[0,0]}]],[a.width,a.height],{effectView:this.effectList});return{opacity:1,src:a.src,preview:t,width:a.width,height:a.height}};
aa._constructDotDensityRendererLegendElements=function(a){const t=a.calculateDotValue(this.view.scale),z={type:"symbol-table",title:{value:t&&Math.round(t),unit:a.legendOptions&&a.legendOptions.unit||""},infos:[]};a.attributes.forEach(R=>{const T=this._getElementInfoForDotDensity(a,R.color);T.label=R.label||R.valueExpressionTitle||R.field;z.infos.push(T)});return Promise.resolve([z])};aa._constructPieChartRendererLegendElements=async function(a){const t=this.layer.opacity,z=[];let R=null;const T=
a.outline;a.attributes.forEach(da=>{const sa=new ca({color:da.color,outline:T});z.push({label:da.label||da.valueExpressionTitle||da.field,symbol:sa})});var V=z.length?[...z]:[];if(a.othersCategory?.color&&0!==a.othersCategory?.threshold){var ba=new ca({color:a.othersCategory.color,outline:T});R=a.othersCategory.label||"Other";z.push({label:R,symbol:ba})}a.defaultColor?.a&&(ba=new ca({color:a.defaultColor,outline:T}),z.push({label:a.defaultLabel,symbol:ba}));ba=await this._getVisualVariableLegendElements(a,
this.layer)||[];z.length&&(ba.unshift({type:"symbol-table",title:null,infos:z}),V=V.filter(da=>da.label!==R).map(da=>da.symbol.color).filter(Boolean),V=W.renderPieChartPreviewHTML(V,{holePercentage:a.holePercentage,backgroundColor:a.backgroundFillSymbol?.color,effectList:this.effectList,outline:T}),ba.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(a,this.layer),infos:z,preview:V}));a=ba.reduce((da,sa)=>[...da,...this._getAllInfos(sa)],[]).filter(da=>!!da?.symbol&&!da?.preview).map(da=>
this._getSymbolPreview(da,t,{effectList:this.effectList}));await n.eachAlways(a);return ba};aa._constructRendererLegendElements=async function(a,t={}){const {title:z,sublayer:R}=t,T=R||this.layer;this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const V=await this._getVisualVariableLegendElements(a,T)||[],ba={type:"symbol-table",title:z||this._getRendererTitle(a,T),infos:[]};let da=null,sa=!1;const ja=new Set;if("flow"!==a.type||this._hasSizeRamp)if("univariate-color-size"===
("authoringInfo"in a?a?.authoringInfo:null)?.type){var ea=z,ua=za(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ta=V.findIndex(ka=>"color-ramp"===ka.type);ta=-1!==ta?V.splice(ta,1)[0]:null;var pa=V.findIndex(ka=>"size-ramp"===ka.type);pa=-1!==pa?V.splice(pa,1)[0]:null;var wa=[];ta&&(ea=ta.title,wa.push(ta));pa&&(ea=pa.title,wa.push(pa));0<wa.length&&V.push({type:ua,title:ea,infos:wa})}else if(ia(a))ea=v.getHeatmapRampStops(a),V.push({type:"heatmap-ramp",title:z||this._getRendererTitle(a,
T),infos:ea,preview:W.renderColorRampPreviewHTML(ea.map(ka=>ka.color),{effectList:this.effectList})});else if(Z(a)){if((ua=a&&a.authoringInfo)&&"relationship"===ua.type){const {numClasses:ka,field1:xa,field2:Da}=ua;ua=ua.focus;if(ka&&xa&&Da){pa=[xa,Da];ta=I.getRotationAngleForFocus(ua)||0;for(ea of pa){const {field:Oa,normalizationField:Ha,label:La}=ea;pa=La||{field:this._getFieldAlias(Oa,T),normField:Ha&&this._getFieldAlias(Ha,T)};wa=Xa.clone();wa.angle=ta;ba.infos.push({label:pa,symbol:wa});ja.add(wa);
ta+=90}ea=I.getRelationshipRampElement({focus:ua,numClasses:ka,infos:a.uniqueValueInfos??[]});V.unshift(ea)}}else if("esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass)a.uniqueValueInfos?.forEach(ka=>{ka.symbol&&ba.infos.push({label:ka.label||ka.value,value:ka.value,symbol:ka.symbol})});else{const {field:ka,field2:xa,field3:Da,fieldDelimiter:Oa,valueExpression:Ha,defaultSymbol:La}=a,Za=!(!ka&&!Ha||!xa&&!Da),Ea=[];a.uniqueValueGroups?.forEach(Ra=>
{const Pa={type:"symbol-table",title:Ra.heading,infos:[]};Ra.classes?.forEach(Fa=>{const {symbol:Sa,values:$a}=Fa;if(Sa){var Ia=[],Ja=[];for(const ab of $a??[]){const {value:Ta,value2:Ua,value3:Va}=ab,Ka=[],Ma=[];if(ka||Ha)Ka.push(Ta),Ma.push(this._getDomainName(ka,Ta,T));xa&&(Ka.push(Ua),Ma.push(this._getDomainName(xa,Ua,T)));Da&&(Ka.push(Va),Ma.push(this._getDomainName(Da,Va,T)));Ia.push(Za?Ka.join(Oa||""):Ka[0]);Ja.push(Ma.join(" - "))}Ia=Ia.join(", ");Fa=Fa.label;Fa||(Ja=Ja.filter(Boolean),Fa=
Ja.length?Ja.join(", "):Ia);Pa.infos.push({label:Fa,value:Ia,symbol:Sa})}});Pa.infos.length&&Ea.push(Pa)});Ea.length&&(ea=Ea[0],1===Ea.length&&"title"in ea&&!ea.title?ba.infos.push(...(ea.infos??[])):(La&&(Ea.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:La}]}),sa=!0),ba.infos.push(...Ea)),z||a.legendOptions&&a.legendOptions.title||a.valueExpressionTitle||(ba.title=null))}a.defaultSymbol&&!sa&&(ba.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),sa=!0)}else if(fa(a))da=
this._isUnclassedRenderer(a),da&&this._hasSizeRamp||(a.classBreakInfos.forEach(ka=>{ka.symbol&&ba.infos.unshift({label:ka.label||(da?null:ka.minValue+" - "+ka.maxValue),value:[ka.minValue,ka.maxValue],symbol:ka.symbol})}),da&&(ba.title=null),this._updateInfosforClassedSizeRenderer(a,ba.infos)),a.defaultSymbol&&!da&&(ba.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),sa=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===
this.layer.declaredClass)ea=this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===ea.type?V.push(ea):ba.infos=ea;else{ea=this.layer;a.statistics&&a.statistics.length&&(ua=null!=a.statistics[0].min?a.statistics[0].min:a.statistics[0][0],ta=null!=a.statistics[0].max?a.statistics[0].max:a.statistics[0][1]);pa=[];pa=b.unwrap(ea.renderingRule?await ea.generateRasterInfo(ea.renderingRule):ea.serviceRasterInfo);const ka=pa.keyProperties.BandProperties;wa=Q.getPixelValueRange(pa.pixelType);
1===pa.bandCount?(ea=ea.bandIds?.[0]||0,ua=null!=ua?ua:pa.statistics?pa.statistics[ea].min:wa[0],ta=null!=ta?ta:pa.statistics?pa.statistics[ea].max:wa[1],ua||ta?V.push(this._getStretchLegendElements(a,{min:ua,max:ta})):this._getServerSideLegend()):ea.bandIds&&1===ea.bandIds.length?(ua=null!=ua?ua:pa.statistics?pa.statistics[ea.bandIds[0]].min:wa[0],ta=null!=ta?ta:pa.statistics?pa.statistics[ea.bandIds[0]].max:wa[1],ua||ta?V.push(this._getStretchLegendElements(a,{min:ua,max:ta})):this._getServerSideLegend()):
3<=pa.bandCount?ka&&ka.length>=pa.bandCount?ea.bandIds&&3===ea.bandIds.length?(pa=ea.bandIds.map(xa=>ka[xa].BandName),ba.infos=this._createSymbolTableElementMultiBand(pa)):"lerc"===ea.format?(pa=[0,1,2].map(xa=>ka[xa].BandName),ba.infos=this._createSymbolTableElementMultiBand(pa)):this._getServerSideLegend():"lerc"===ea.format?(pa=["band1","band2","band3"],ba.infos=this._createSymbolTableElementMultiBand(pa)):this._getServerSideLegend():this._getServerSideLegend()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(ka=>
{ba.infos.push({label:ka.label,value:ka.value,symbol:this._getAppliedCloneSymbol(Wa,ka.color)})});else if(ma(a)){ea=a.symbol;switch(t.geometryType){case "point":ea="pointSymbol"in T?T.pointSymbol:null;break;case "polyline":ea="lineSymbol"in T?T.lineSymbol:null;break;case "polygon":ea="polygonSymbol"in T?T.polygonSymbol:null}ua=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;a.symbol&&ua&&ba.infos.push({label:a.label,symbol:ea})}else"vector-field"===a.type?(a.outputUnit&&
(this.title="("+a.toJSON().outputUnit+")"),ba.title=a.attributeField,ea=a.getClassBreakInfos(),ea?.length?ea.forEach(ka=>{ba.infos.push({label:ka.minValue+" - "+ka.maxValue,symbol:ka.symbol})}):ba.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):"raster-shaded-relief"===a.type&&V.push(this._getStretchLegendElements(a,{min:0,max:255}));else ea=await X.getSymbolForFlowRenderer(a),ba.infos.push({label:null,symbol:ea});const Qa=a.defaultSymbol;!Qa||sa||ma(a)||da&&!this._hasColorRamp&&
!this._hasSizeRamp&&!this._hasOpacityRamp||V.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Qa}]});ba.infos.length&&V.unshift(ba);const bb=null==t.opacity?this.opacity:t.opacity,cb=this._isTallSymbol("visualVariables"in a?a.visualVariables:null),db="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;t=V.reduce((ka,xa)=>[...ka,...this._getAllInfos(xa)],[]).filter(ka=>!!ka?.symbol).map(ka=>this._getSymbolPreview(ka,
bb,{isDefault:ka.symbol===Qa,applyScaleDrivenSize:!ja.has(ka.symbol),symbolConfig:{isTall:cb,isSquareFill:db},effectList:ja.has(ka.symbol)?null:this.effectList}));a=null;await n.eachAlways(t);return V};aa._getServerSideLegend=function(){setTimeout(()=>this.buildLegendElementsForTools(),0)};aa._getAllInfos=function(a){const t=a?.infos;return t?t.reduce((z,R)=>z.concat(this._getAllInfos(R)),[]):[a]};aa._constructTileImageryStretchRendererElements=function(a){function t(sa){const ja=(z?.bandIds?.length?
z.bandIds:Array.from(Array(Math.min(R.bandCount,3)).keys())).map(ea=>sa&&sa[ea]&&sa[ea].BandName||"band"+(ea+1));3>ja.length?ja.push(ja[1]):3<ja.length&&ja.splice(3);return ja}const z=this.layer,{rasterInfo:R}=z.raster,T=R.bandCount||a.statistics.length;var V;var ba=[];const da=R.keyProperties&&R.keyProperties.BandProperties;(V=a?.statistics?.length?a.statistics:R?.statistics)?(ba=void 0!==V[0].min?V[0].min:V[0][0],V=V[0].max||V[0][1]):(V=Q.getPixelValueRange(R.pixelType),ba=V[0],V=V[1]);z.hasStandardTime()&&
(ba=z.getStandardTimeValue(ba),V=z.getStandardTimeValue(V));if(1===R.bandCount||1===z.bandIds?.length)return this._getStretchLegendElements(a,{min:ba,max:V});ba=da&&da.length>=T?t(da):t();return this._createSymbolTableElementMultiBand(ba)};aa._getStretchLegendElements=function(a,t){a=C.getStrectchRampStops(a.colorRamp,t);return{type:"stretch-ramp",title:"",infos:a,preview:W.renderColorRampPreviewHTML(a.map(z=>z.color))}};aa._getClusterSymbol=function(){var a=this.layer;const t=(a="featureReduction"in
a&&a.featureReduction)&&"symbol"in a&&a.renderer;return t&&!0!==t?.authoringInfo?.isAutoGenerated?null:a&&"symbol"in a?a.symbol:null};aa._getSizeLegendElement=async function(a,t,z,R){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(t):a,infos:await U.getRampStops(z,t,await X.getMedianColor(z),this.scale,this.view.type,!!R,this._hasClusterSizeVariable?this._getClusterSymbol():null)}};aa._createSymbolTableElementMultiBand=function(a){const t=[],z=["red","green","blue"];
a.forEach((R,T)=>{t.push({label:{colorName:z[T],bandName:R},src:X.RGB_IMG_SOURCE[T],opacity:this.opacity??1})});return t};aa._updateInfosforClassedSizeRenderer=function(a,t){const z=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,R=a.classBreakInfos.some(T=>k.isVolumetricSymbol(T.symbol));if(z&&R){const T=U.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;const V=(T-U.REAL_WORLD_MIN_SIZE)/(1<a?a-1:a);t.forEach((ba,da)=>{ba.size=T-V*da})}};aa._isTallSymbol=function(a){let t=!1,z=!1;if(a)for(let R=
0;R<a.length&&(!t||!z);R++){const T=a[R];"size"===T.type&&("height"===T.axis&&(t=!0),"width-and-depth"===T.axis&&(z=!0))}return t&&z};aa._getSymbolPreview=async function(a,t,z){var R=!z?.isDefault&&null==a.size&&this._hasSizeRamp?A.px2pt(S.SymbolSizeDefaults.size):a.size;this._scaleDrivenSizeVariable&&z?.applyScaleDrivenSize&&({getSize:R}=await new Promise((T,V)=>x(["../../../renderers/visualVariables/support/visualVariableUtils"],T,V)),R=R(this._scaleDrivenSizeVariable,null,{view:this.view.type,
scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return W.renderPreviewHTML(a.symbol,{size:R,opacity:t,scale:!1,symbolConfig:z?.symbolConfig,effectView:z?.effectList}).then(T=>{a.preview=T;return a}).catch(()=>{a.preview=null;return a})};aa._getClusterRenderer=function(a){this._hasClusterSizeVariable=!1;var t="renderer"in this.layer?this.layer.renderer:null;t=a.renderer?.clone()||t?.clone();const z=b.unwrap(B.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view));
if(z&&null!=t&&"visualVariables"in t&&!t.visualVariables?.some(R=>"size"===R.type&&"outline"!==R.target&&!Aa.test(R.valueExpression))){if("clusterMinSize"in a&&"clusterMaxSize"in a){const {clusterMinSize:R,clusterMaxSize:T}=a;z.legendOptions=new H({showLegend:R!==T})}t.visualVariables=(t.visualVariables||[]).concat([z]);this._hasClusterSizeVariable=!0}return t};aa._loadRenderer=async function(a){const t=[],z=a.clone(),R=await X.getMedianColor(z);if(fa(z)||Z(z))a=(z.classBreakInfos||z.uniqueValueInfos).map(T=>
this._fetchSymbol(T.symbol,R).then(V=>{T.symbol=V}).catch(()=>{T.symbol=null})),Array.prototype.push.apply(t,a);t.push(this._fetchSymbol(z.symbol||z.defaultSymbol,z.defaultSymbol?null:R).then(T=>{this._applySymbolToRenderer(z,T,ma(z))}).catch(()=>{this._applySymbolToRenderer(z,null,ma(z))}));return n.eachAlways(t).then(()=>z)};aa._applySymbolToRenderer=function(a,t,z){z?a.symbol=t:a.defaultSymbol=t};aa._fetchSymbol=async function(a,t){if(!a)throw Error();if("web-style"===a.type){const z=this._webStyleSymbolCache;
try{const R=await ("2d"===this.view.type?a.fetchCIMSymbol({cache:z}):a.fetchSymbol({cache:z}));return this._getAppliedCloneSymbol(R,t)}catch{throw d.getLogger(this.declaredClass).warn("Fetching web-style failed!"),Error();}}return this._getAppliedCloneSymbol(a,t)};aa._getAppliedCloneSymbol=function(a,t){if(!a||!t)return a;a=a.clone();const z=t&&t.toRgba();a.type.includes("3d")?this._applyColorTo3dSymbol(a,z):"cim"===a.type?N.applyCIMSymbolColor(a,t):a.color&&(a.color=new w(z||a.color));return a};
aa._applyColorTo3dSymbol=function(a,t){t&&a.symbolLayers.forEach(z=>{z&&(z.material||(z.material={}),z.material.color=new w(t))})};aa._getVisualVariableLegendElements=async function(a,t){if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return null;var z=a.visualVariables,R=[];const T=[],V=[];for(const ja of z)"color"===ja.type?R.push(ja):"size"===ja.type?T.push(ja):"opacity"===ja.type&&V.push(ja);z=[...R,...T,...V];let ba;if(0===R.length&&fa(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var da=
(da=a.classBreakInfos[0])&&da.symbol;0===R.length&&ma(a)&&(da=a.symbol);da&&(da.type.includes("3d")?(R=da.symbolLayers.getItemAt(0),"water"===R.type?b.isSome(R.color)&&(ba=R.color):b.isSome(R.material)&&b.isSome(R.material.color)&&(ba=R.material.color)):da.url||(ba=da.color));const sa=this.effectList;return(await Promise.all(z.map(async ja=>{if(!ja.legendOptions||!1!==ja.legendOptions.showLegend){const ua="flow"===a.type?ja.field:this._getRampTitle(ja,t);let ta=null;var ea="getField"in t?t.getField?.(ja.field):
null;ea=ea&&q.isDateField(ea);"color"===ja.type?(ja=await C.getRampStops(ja,null,ea)??[],ta={type:"color-ramp",title:ua,infos:ja,preview:W.renderColorRampPreviewHTML(ja.map(pa=>pa.color),{effectList:sa})},this._hasColorRamp||(this._hasColorRamp=0<ja.length)):"size"===ja.type&&"outline"!==ja.target?Aa.test(ja.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=ja):(ta=await this._getSizeLegendElement(ua,ja,a,ea),this._hasSizeRamp||(this._hasSizeRamp=!(null==ta.infos||!ta.infos.length))):
"opacity"===ja.type&&(ja=await C.getRampStops(ja,ba,ea)??[],ta={type:"opacity-ramp",title:ua,infos:ja,preview:W.renderColorRampPreviewHTML(ja.map(pa=>pa.color),{effectList:sa})},this._hasOpacityRamp||(this._hasOpacityRamp=0<ja.length));return ta&&ta.infos?ta:null}}))).filter(b.isSome)};aa._getDomainName=function(a,t,z){return a&&"function"!==typeof a?(z=(a="getField"in z&&z.getField&&z.getField(a))&&"getFieldDomain"in z&&z.getFieldDomain?z.getFieldDomain(a.name):null,"coded-value"===z?.type?z.getName(t):
null):null};aa._getClusterTitle=function(a){var t=this.layer;a=a.field;if("featureReduction"in t&&t.featureReduction&&"cluster"===t.featureReduction.type&&(t=t.featureReduction,t=(t="popupTemplate"in t&&t.popupTemplate)&&t.fieldInfos))for(const z of t)if(z.fieldName===a)return"cluster_count"===a?z.label||{showCount:!0}:z.label;return{showCount:!0}};aa._getRampTitle=function(a,t){let z=a.field,R=a.normalizationField,T=!1,V=!1,ba=!1;var da=null;z="function"===typeof z?null:z;R="function"===typeof R?
null:R;da=a.legendOptions&&a.legendOptions.title;if(null==da)if(a.valueExpressionTitle)da=a.valueExpressionTitle;else{if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&t.renderer.authoringInfo&&t.renderer.authoringInfo.visualVariables)for(a=t.renderer.authoringInfo.visualVariables,da=0;da<a.length;da++){const sa=a[da];if("color"===sa.type){if("ratio"===sa.style){T=!0;break}if("percent"===sa.style){V=!0;break}if("percent-of-total"===sa.style){ba=!0;break}}}da={field:z&&this._getFieldAlias(z,
t),normField:R&&this._getFieldAlias(R,t),ratio:T,ratioPercent:V,ratioPercentTotal:ba}}return da};aa._getRendererTitle=function(a,t){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var z=a.field;let R=null,T=null;fa(a)&&(R=a.normalizationField,T="percent-of-total"===a.normalizationType);z="function"===typeof z?null:z;R="function"===typeof R?null:R;if(Z(a)){const {field2:V,field3:ba,fieldDelimiter:da}=a;z=z&&this._getFieldAlias(z,
t);V&&(z=`<${z}>${da}<${this._getFieldAlias(V,t)}>`,ba&&(z=`${z}${da}<${this._getFieldAlias(ba,t)}>`));return z}a=null;if(z||R)a={field:z&&this._getFieldAlias(z,t),normField:R&&this._getFieldAlias(R,t),normByPct:T};return a};aa._getFieldAlias=function(a,t){var z=("popupTemplate"in t?t.popupTemplate:null)?.fieldInfos;let R;z&&z.some(ba=>a===ba.fieldName?(R=ba,!0):!1);z=null;"getField"in t&&t.getField?z=t.getField(a):"fieldsIndex"in t&&t.fieldsIndex&&(z=t.fieldsIndex.get(a));let T=null;if(t="featureReduction"in
t&&t.featureReduction)!R&&"popupTemplate"in t&&t.popupTemplate&&t.popupTemplate.fieldInfos&&t.popupTemplate.fieldInfos.some(ba=>a?.toLowerCase()===ba.fieldName?.toLowerCase()?(R=ba,!0):!1),"fields"in t&&t.fields&&(T=t.fields.find(ba=>ba.name?.toLowerCase()===a?.toLowerCase()));t=R||z||T;let V=null;t&&(V=R?.label||z?.alias||T?.alias||"name"in t&&t.name||"fieldName"in t&&t.fieldName||null);return V};aa._isUnclassedRenderer=function(a){const t=a.visualVariables;let z=!1;fa(a)&&a.classBreakInfos&&1===
a.classBreakInfos.length&&t&&(z=a.field?t.some(R=>!(!R||a.field!==R.field||(a.normalizationField||R.normalizationField)&&a.normalizationField!==R.normalizationField)):!!t.length);return z};M._createClass(Ga,[{key:"effectList",get:function(){const a=this.layer;let t=null;"effect"in a&&a.effect&&(t=new L.EffectView,t.effect=a.effect,t.endTransitions(),t.scale=this.scale);return t}},{key:"opacity",get:function(){const a=this.layer.opacity,t=this.parent?.opacity;var z=this.layer.parent;z=z&&"uid"in z?
this._getParentLayerOpacity(z):null;return null!=t?t*a:null!=z?z*a:a}},{key:"ready",get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},{key:"scale",get:function(){return this.view?.scale??0}},{key:"isScaleDriven",get:function(){const a=this.layer;if(null===a)return!1;if("effect"in a&&a.effect&&Array.isArray(a.effect))return!0;if("featureReduction"in a&&a.featureReduction){if("cluster"===a.featureReduction.type)return!0;if("binning"===
a.featureReduction.type&&"renderer"in a.featureReduction&&a.featureReduction.renderer)return this._isRendererScaleDriven(a.featureReduction.renderer)}return"renderer"in a&&a.renderer?this._isRendererScaleDriven(a.renderer):this._isLayerScaleDriven(this.layer)}},{key:"version",get:function(){return this._get("version")+1}}]);return Ga}(F);K.__decorate([h.property()],E.prototype,"children",void 0);K.__decorate([h.property({readOnly:!0})],E.prototype,"effectList",null);K.__decorate([h.property()],E.prototype,
"layerView",void 0);K.__decorate([h.property()],E.prototype,"layer",void 0);K.__decorate([h.property()],E.prototype,"legendElements",void 0);K.__decorate([h.property({readOnly:!0})],E.prototype,"opacity",null);K.__decorate([h.property()],E.prototype,"parent",void 0);K.__decorate([h.property({readOnly:!0,dependsOn:[]})],E.prototype,"ready",null);K.__decorate([h.property()],E.prototype,"hideLayersNotInCurrentView",void 0);K.__decorate([h.property()],E.prototype,"keepCacheOnDestroy",void 0);K.__decorate([h.property()],
E.prototype,"respectLayerVisibility",void 0);K.__decorate([h.property({readOnly:!0})],E.prototype,"scale",null);K.__decorate([h.property()],E.prototype,"sublayerIds",void 0);K.__decorate([h.property({readOnly:!0})],E.prototype,"isScaleDriven",null);K.__decorate([h.property()],E.prototype,"title",void 0);K.__decorate([h.property({readOnly:!0,dependsOn:["ready"],value:0})],E.prototype,"version",null);K.__decorate([h.property()],E.prototype,"view",void 0);return E=K.__decorate([m.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],
E)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(x,M,K,w,u,D,E,F,O,f,d,b){function n(y){y=d.parse(y)||[];var h=(h=y[0])?"type"in h:!1;return h?[{scale:-1,effects:y}]:y}function e(y,h,
G){return y[0]?.effects&&h[0]?.effects?(-1===y[0]?.scale||-1===h[0]?.scale)&&(1<y.length||1<h.length)&&0>=G?!1:b.canInterpolateEffects(y[0].effects,h[0].effects):!0}function A(y,h,G){const l=y.length>h.length?y:h;y=y.length>h.length?h:y;var g=y[y.length-1];h=g?.scale??G;g=g?.effects??[];for(let m=y.length;m<l.length;m++)y.push({scale:h,effects:[...g]});for(h=0;h<l.length;h++)y[h].scale=-1===y[h].scale?G:y[h].scale,l[h].scale=-1===l[h].scale?G:l[h].scale,b.normalizeEffects(y[h].effects,l[h].effects)}
x.EffectView=function(y){function h(l){l=G.call(this,l);l._from=null;l._to=null;l._final=null;l._current=[];l._time=0;l.duration=u("mapview-transitions-duration");l.effects=[];return l}M._inherits(h,y);var G=M._createSuper(h);y=h.prototype;y.canTransitionTo=function(l){try{return 0<this.scale&&e(this._current,n(l),this.scale)}catch{return!1}};y.transitionStep=function(l,g){this._applyTimeTransition(l);this._updateForScale(g)};y.endTransitions=function(){this._applyTimeTransition(this.duration)};y._transitionTo=
function(l){0<this.scale&&e(this._current,l,this.scale)?(this._final=l,this._to=D.clone(l),A(this._current,this._to,this.scale),this._from=D.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=l);this._set("effects",this._current[0]?D.clone(this._current[0].effects):[])};y._applyTimeTransition=function(l){if(this._to&&this._from&&this._current&&this._final){this._time+=l;l=Math.min(1,this._time/this.duration);for(let m=0;m<this._current.length;m++){const P=this._current[m],
L=this._from[m],c=this._to[m];var g=L.scale;P.scale=g+(c.scale-g)*l;for(g=0;g<P.effects.length;g++)P.effects[g].interpolate(L.effects[g],c.effects[g],l)}1===l&&(this._current=this._final,this._set("effects",this._current[0]?D.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}};y._updateForScale=function(l){this._set("scale",l);if(0!==this._current.length){var g=this._current,m=this._current.length-1,P,L=1;if(1===g.length||l>=g[0].scale)var c=P=g[0].effects;else if(l<=g[m].scale)c=
P=g[m].effects;else for(let p=0;p<m;p++){const q=g[p],Q=g[p+1];if(q.scale>=l&&Q.scale<=l){L=(l-q.scale)/(Q.scale-q.scale);P=q.effects;c=Q.effects;break}}for(l=0;l<this.effects.length;l++)this.effects[l].interpolate(P[l],c[l],L)}};M._createClass(h,[{key:"effect",set:function(l){const g=this._get("effect");l=l||"";if(g!==l){this._set("effect",l);try{this._transitionTo(n(l))}catch(m){this._transitionTo([]),E.getLogger(this.declaredClass).warn("Invalid Effect",{effect:l,error:m})}}}},{key:"hasEffects",
get:function(){return this.transitioning||!!this.effects.length}},{key:"scale",set:function(l){this._updateForScale(l)}},{key:"transitioning",get:function(){return null!==this._to}}]);return h}(w);K.__decorate([F.property()],x.EffectView.prototype,"_to",void 0);K.__decorate([F.property()],x.EffectView.prototype,"duration",void 0);K.__decorate([F.property({value:""})],x.EffectView.prototype,"effect",null);K.__decorate([F.property({readOnly:!0})],x.EffectView.prototype,"effects",void 0);K.__decorate([F.property({readOnly:!0})],
x.EffectView.prototype,"hasEffects",null);K.__decorate([F.property({value:0})],x.EffectView.prototype,"scale",null);K.__decorate([F.property({readOnly:!0})],x.EffectView.prototype,"transitioning",null);x.EffectView=K.__decorate([f.subclass("esri.layers.effects.EffectView")],x.EffectView);x.canInterpolateEffectStops=e;x.convertEffectToStops=n;x.normalizeEffectStops=A;Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/HandleOwner ../../core/maybe ../../core/sql ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(x,M,K,w,u,D,E,F,O,f,d,b,n,e,A){const y={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};x.ExportImageParameters=function(h){function G(g){g=l.call(this,g);g.floors=null;g.scale=0;return g}M._inherits(G,h);var l=M._createSuper(G);h=G.prototype;h.destroy=function(){this.layer=null};
h.toJSON=function(){var g=this.layer;g={dpi:g.dpi,format:g.imageFormat,transparent:g.imageTransparency,gdbVersion:g.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?g.dynamicLayers=this.dynamicLayers:g={...g,layers:this.layers,layerDefs:this.layerDefs};return g};M._createClass(G,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const g=this.visibleSublayers.map(m=>{const P=e.getLayerFloorFilterClause(this.floors,m);return m.toExportImageJSON(P)});return g.length?
JSON.stringify(g):null}},{key:"hasDynamicLayers",get:function(){return this.layer&&A.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}},{key:"layer",set:function(g){this._get("layer")!==g&&(this._set("layer",g),this.handles.remove("layer"),g&&this.handles.add([g.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),g.on("sublayer-update",m=>this.notifyChange(y[m.propertyName]))],"layer"))}},{key:"layers",get:function(){const g=this.visibleSublayers;
return g?g.length?"show:"+g.map(m=>m.id).join(","):"show:-1":null}},{key:"layerDefs",get:function(){const g=!!this.floors?.length,m=this.visibleSublayers.filter(P=>null!=P.definitionExpression||g&&null!=P.floorInfo);return m.length?JSON.stringify(m.reduce((P,L)=>{var c=e.getLayerFloorFilterClause(this.floors,L);c=E.sqlAnd(c,L.definitionExpression);D.isSome(c)&&(P[L.id]=c);return P},{})):null}},{key:"version",get:function(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const g=this.layer;g&&(g.commitProperty("dpi"),g.commitProperty("imageFormat"),g.commitProperty("imageTransparency"),g.commitProperty("gdbVersion"));return(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){const g=[];if(!this.layer)return g;var m=this.layer.sublayers;const P=L=>{const c=this.scale,p=0===L.minScale||c<=L.minScale,q=0===L.maxScale||c>=L.maxScale;L.visible&&(0===c||p&&q)&&(L.sublayers?L.sublayers.forEach(P):g.unshift(L))};m&&m.forEach(P);
m=this._get("visibleSublayers");return!m||m.length!==g.length||m.some((L,c)=>g[c]!==L)?g:m}}]);return G}(u.HandleOwnerMixin(w));K.__decorate([F.property({readOnly:!0})],x.ExportImageParameters.prototype,"dynamicLayers",null);K.__decorate([F.property()],x.ExportImageParameters.prototype,"floors",void 0);K.__decorate([F.property({readOnly:!0})],x.ExportImageParameters.prototype,"hasDynamicLayers",null);K.__decorate([F.property()],x.ExportImageParameters.prototype,"layer",null);K.__decorate([F.property({readOnly:!0})],
x.ExportImageParameters.prototype,"layers",null);K.__decorate([F.property({readOnly:!0})],x.ExportImageParameters.prototype,"layerDefs",null);K.__decorate([F.property({type:Number})],x.ExportImageParameters.prototype,"scale",void 0);K.__decorate([F.property(n.combinedViewLayerTimeExtentProperty)],x.ExportImageParameters.prototype,"timeExtent",void 0);K.__decorate([F.property({readOnly:!0})],x.ExportImageParameters.prototype,"version",null);K.__decorate([F.property({readOnly:!0})],x.ExportImageParameters.prototype,
"visibleSublayers",null);x.ExportImageParameters=K.__decorate([b.subclass("esri.layers.mixins.ExportImageParameters")],x.ExportImageParameters);Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(x){function M(K,w){if(!K?.length)return null;K=K.filter(u=>""!==u).map(u=>`'${u}'`);K.push("''");return`${w} IN (${K.join(",")}) OR ${w} IS NULL`}x.getFloorFilterClause=function(K){const w=K.layer;return"floorInfo"in
w&&w.floorInfo?.floorField&&"floors"in K.view?M(K.view.floors,w.floorInfo.floorField):null};x.getLayerFloorFilterClause=function(K,w){return"floorInfo"in w&&w.floorInfo?.floorField?M(K,w.floorInfo.floorField):null};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/maybe","../../core/accessorSupport/PropertyOrigin"],function(x,M,K){function w(u,D){if(!u||!u.length||M.isNone(D))return!0;D=D.slice().reverse().flatten(({sublayers:O})=>
O&&O.toArray().reverse()).map(O=>O.id).toArray();if(u.length>D.length)return!1;let E=0;const F=D.length;for(const {id:O}of u){for(;E<F&&D[E]!==O;)E++;if(E>=F)return!1}return!0}x.isExportDynamic=function(u,D,E){return u.some(F=>{const O=F.source;return!(!O||"map-layer"===O.type&&O.mapLayerId===F.id&&(M.isNone(O.gdbVersion)||O.gdbVersion===E))||F.originIdOf("renderer")>K.OriginId.SERVICE||F.originIdOf("labelingInfo")>K.OriginId.SERVICE||F.originIdOf("opacity")>K.OriginId.SERVICE||F.originIdOf("labelsVisible")>
K.OriginId.SERVICE})?!0:!w(u,D)};x.isSublayerOverhaul=function(u){return!!u&&u.some(D=>null!=D.minScale||D.layerDefinition&&null!=D.layerDefinition.minScale)};x.shouldWriteSublayerStructure=function(u,D,E){return D.flatten(({sublayers:F})=>F).length!==u.length||u.some(F=>F.originIdOf("minScale")>E||F.originIdOf("maxScale")>E||F.originIdOf("renderer")>E||F.originIdOf("labelingInfo")>E||F.originIdOf("opacity")>E||F.originIdOf("labelsVisible")>E||F.originIdOf("source")>E)?!0:!w(u,D)};Object.defineProperty(x,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(x){function M(w){return K[w]??[-3.4028234663852886E38,3.4028234663852886E38]}const K={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]};x.convertNoDataToMask=function(w,u,D){if(!(w.depthCount&&
1<w.depthCount)){var {pixels:E,statistics:F,pixelType:O}=w,f=E[0].length,d=w.bandMasks??[],b=w.mask??(new Uint8Array(f)).fill(255),n="f32"===O||"f64"===O,e=M(O),A=!1;for(let G=0;G<E.length;G++){const l="number"===typeof u?u:u[G];if(null==l)continue;var y=F?.[G].maxValue??e[1];if((F?.[G].minValue??e[0])>l+Number.EPSILON||y<l-Number.EPSILON)continue;y=d[G]||(new Uint8Array(f)).fill(255);const g=E[G];var h=D?.customFloatTolerance;if(n&&0!==h){h||(h=9.999999E37<=Math.abs(l)?2E-7*Math.abs(l):"f32"===O?
2**-23:Number.EPSILON);for(let m=0;m<g.length;m++)y[m]&&Math.abs(g[m]-l)<h&&(g[m]=0,y[m]=0,b[m]=0,A=!0)}else for(h=0;h<g.length;h++)y[h]&&g[h]===l&&(g[h]=0,y[h]=0,b[h]=0,A=!0);d[G]=y}A&&(w.bandMasks=d,w.mask=b);A&&"updateStatistics"in w&&w.updateStatistics()}};x.getPixelValueRange=M;Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/has","../../core/Error","../../core/maybe","../../symbols/support/symbolConversion"],
function(x,M,K,w,u){function D(f){return w.isNone(f)||"simple"===f.type||"unique-value"===f.type||"class-breaks"===f.type||"dictionary"===f.type||"heatmap"===f.type}function E(f,d){if(!d)return null;d=Array.isArray(d)?d:[d];if(0<d.length){const b=d.map(e=>e.details.symbol.type||e.details.symbol.declaredClass).filter(e=>!!e);b.sort();const n=[];b.forEach((e,A)=>{0!==A&&e===b[A-1]||n.push(e)});return new K("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${n.join(", ")}) which are not supported in 3D`,
{renderer:f,symbolErrors:d})}return null}function F(f,d){const b={...u.defaultTo3DOptions,...d};d=f.uniqueValueInfos?.map(e=>u.to3D(e.symbol,b).error).filter(w.isSome);const n=u.to3D(f.defaultSymbol,b);n.error&&d?.unshift(n.error);return E(f,d)}function O(f){const d=f.classBreakInfos.map(n=>u.to3D(n.symbol).error).filter(w.isSome),b=u.to3D(f.defaultSymbol);b.error&&d.unshift(b.error);return E(f,d)}x.isSupportedRenderer3D=D;x.validateTo3D=function(f,d){if(w.isNone(f))return null;if(!D(f))return new K("renderer-conversion-3d:unsupported-renderer",
`Unsupported renderer of type '${f.type||f.declaredClass}'`,{renderer:f});switch(f.type){case "simple":return E(f,u.to3D(f.symbol).error);case "unique-value":return F(f,d);case "class-breaks":return O(f)}return null};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(x,M,K){function w(b){b=K.toCIMSymbolJSON(b);if("CIMTextSymbol"===b?.type)return b.height??0;let n=0;if(b?.symbolLayers)for(const e of b.symbolLayers)K.isCIMMarker(e)&&
null!=e.size&&e.size>n?n=e.size:K.isCIMStroke(e)&&null!=e.width&&e.width>n?n=e.width:K.isCIMFill(e);return n}function u(b,n,e,A){if(b)if("CIMTextSymbol"===b.type)null!=b.height&&(b.height*=n);else{if(e&&b.effects)for(const y of b.effects)F(y,n);if(b.symbolLayers)for(const y of b.symbolLayers)switch(y.type){case "CIMPictureMarker":case "CIMVectorMarker":D(y,n,A);break;case "CIMPictureStroke":case "CIMSolidStroke":!A?.preserveOutlineWidth&&y.width&&(y.width*=n);break;case "CIMPictureFill":y.height&&
(y.height*=n);y.offsetX&&(y.offsetX*=n);y.offsetY&&(y.offsetY*=n);break;case "CIMHatchFill":u(y.lineSymbol,n,!0,{...A,preserveOutlineWidth:!1}),y.offsetX&&(y.offsetX*=n),y.offsetY&&(y.offsetY*=n),y.separation&&(y.separation*=n)}}}function D(b,n,e){if(b&&(b.markerPlacement&&E(b.markerPlacement,n),b.offsetX&&(b.offsetX*=n),b.offsetY&&(b.offsetY*=n),b.anchorPoint&&"Absolute"===b.anchorPointUnits&&(b.anchorPoint={x:b.anchorPoint.x*n,y:b.anchorPoint.y*n}),b.size=null!=b.size?b.size*n:0,"CIMVectorMarker"===
b.type&&b.markerGraphics))for(const A of b.markerGraphics)b.scaleSymbolsProportionally||u(A.symbol,n,!0,e)}function E(b,n){K.isCIMMarkerStrokePlacement(b)&&b.offset&&(b.offset*=n);switch(b.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":b.customEndingOffset&&(b.customEndingOffset*=n);b.offsetAlongLine&&(b.offsetAlongLine*=n);if(b.placementTemplate&&b.placementTemplate.length){var e=b.placementTemplate.map(A=>A*n);b.placementTemplate=e}break;case "CIMMarkerPlacementAlongLineVariableSize":b.maxRandomOffset&&
(b.maxRandomOffset*=n);b.placementTemplate&&b.placementTemplate.length&&(e=b.placementTemplate.map(A=>A*n),b.placementTemplate=e);break;case "CIMMarkerPlacementOnLine":b.startPointOffset&&(b.startPointOffset*=n);break;case "CIMMarkerPlacementAtExtremities":b.offsetAlongLine&&(b.offsetAlongLine*=n);break;case "CIMMarkerPlacementAtRatioPositions":b.beginPosition&&(b.beginPosition*=n);b.endPosition&&(b.endPosition*=n);break;case "CIMMarkerPlacementPolygonCenter":b.offsetX&&(b.offsetX*=n);b.offsetY&&
(b.offsetY*=n);break;case "CIMMarkerPlacementInsidePolygon":b.offsetX&&(b.offsetX*=n),b.offsetY&&(b.offsetY*=n),b.stepX&&(b.stepX*=n),b.stepY&&(b.stepY*=n)}}function F(b,n){switch(b.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":b.width&&(b.width*=n);break;case "CIMGeometricEffectBuffer":b.size&&(b.size*=n);break;case "CIMGeometricEffectCut":b.beginCut&&(b.beginCut*=n);b.endCut&&(b.endCut*=n);b.middleCut&&(b.middleCut*=n);break;case "CIMGeometricEffectDashes":b.customEndingOffset&&
(b.customEndingOffset*=n);b.offsetAlongLine&&(b.offsetAlongLine*=n);if(b.dashTemplate&&b.dashTemplate.length){const e=b.dashTemplate.map(A=>A*n);b.dashTemplate=e}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":b.length&&(b.length*=n);break;case "CIMGeometricEffectMove":b.offsetX&&(b.offsetX*=n);b.offsetY&&(b.offsetY*=n);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":b.offset&&(b.offset*=n);break;case "CIMGeometricEffectRegularPolygon":b.radius&&
(b.radius*=n);break;case "CIMGeometricEffectTaperedPolygon":b.fromWidth&&(b.fromWidth*=n);b.length&&(b.length*=n);b.toWidth&&(b.toWidth*=n);break;case "CIMGeometricEffectWave":b.amplitude&&(b.amplitude*=n),b.period&&(b.period*=n)}}function O(b,n){if(b){var e="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===b.type;if(e?.symbolLayers)for(const A of e.symbolLayers)if(!(A.colorLocked||b&&(K.isCIMStroke(A)||K.isCIMMarker(A)&&A.markerPlacement&&K.isCIMMarkerStrokePlacement(A.markerPlacement))))switch(A.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":A.tintColor&&
f(n,A.tintColor);break;case "CIMVectorMarker":A.markerGraphics?.forEach(y=>{O(y.symbol,n)});break;case "CIMSolidStroke":case "CIMSolidFill":f(n,A.color);break;case "CIMHatchFill":O(A.lineSymbol,n)}}}function f(b,n){for(const e of b)if(e.join(".")===n.join("."))return;b.push(n)}function d(b,n,e){if(b){var A="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===A?.type;if(A?.symbolLayers)for(const y of A.symbolLayers)if(!y.colorLocked){if(b)if(e){if({layersToColor:A}=e,(K.isCIMStroke(y)||K.isCIMMarker(y)&&
y.markerPlacement&&K.isCIMMarkerStrokePlacement(y.markerPlacement))&&"fill"===A||K.isCIMFill(y)&&"outline"===A)continue}else if(K.isCIMStroke(y)||K.isCIMMarker(y)&&y.markerPlacement&&K.isCIMMarkerStrokePlacement(y.markerPlacement))continue;A=n.toArray();switch(y.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":y.tintColor=A;break;case "CIMVectorMarker":y.markerGraphics?.forEach(h=>{d(h.symbol,n,e)});break;case "CIMSolidStroke":case "CIMSolidFill":y.color=A;break;case "CIMHatchFill":d(y.lineSymbol,
n,e)}}}}x.applyCIMSymbolColor=function(b,n,e){n instanceof M||(n=new M(n));(b=K.toCIMSymbolJSON(b))&&d(b,n,e)};x.applyCIMSymbolRotation=function(b,n,e=!1){b=K.toCIMSymbolJSON(b);e&&0!==n&&(n=360-n);if("CIMTextSymbol"===b?.type)b.angle=n;else if("CIMPointSymbol"===b?.type&&b.symbolLayers){e=n-(b.angle||0);for(const A of b.symbolLayers)if(K.isCIMMarker(A)){let y=A.rotation||0;y=A.rotateClockwise?y-e:y+e;A.rotation=y}b.angle=n}};x.getCIMSymbolColor=function(b){b=K.toCIMSymbolJSON(b);const n=[];O(b,n);
return n.length?new M(K.fromCIMColor(n[0])):null};x.getCIMSymbolRotation=function(b,n=!1){b=K.toCIMSymbolJSON(b);return"CIMTextSymbol"===b?.type||"CIMPointSymbol"===b?.type?(b=b.angle,null!=b&&0!==b&&n?360-b:b??0):0};x.getCIMSymbolSize=w;x.getCIMSymbolType=function(b){b=K.toCIMSymbolJSON(b);if(!b)return null;switch(b.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};x.scaleCIMMarker=D;x.scaleCIMSymbol=u;x.scaleCIMSymbolTo=function(b,n,e){if(b){var A=K.toCIMSymbolJSON(b);b=w(b);if(0===b){if(A)if("CIMTextSymbol"===A.type)A.height=n;else if(A.symbolLayers)for(const y of A.symbolLayers)switch(y.type){case "CIMPictureMarker":case "CIMVectorMarker":y.size=n;break;case "CIMPictureStroke":case "CIMSolidStroke":y.width=n}}else u(A,n/b,!1,e)}};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/cim/utils":function(){define(["require","exports"],function(x,M){function K(d){let b=d.length;for(;b--;)if(!" /-,\n".includes(d.charAt(b)))return!1;return!0}function w(d,b){const n=[];var e=0;let A=-1;do A=d.indexOf("[",e),A>=e&&(A>e&&(e=d.substr(e,A-e),n.push([e,null,K(e)])),e=A+1,A=d.indexOf("]",e),A>=e&&(A>e&&(e=d.substr(e,A-e),(e=b[e])&&n.push([null,e,!1])),e=A+1));while(-1!==A);e<d.length-1&&(d=d.substr(e),n.push([d,null,K(d)]));return n}function u(d,b,n){let e="",A=null;for(const y of b){const [h,
G,l]=y;if(h)l?A=h:(A&&(e+=A,A=null),e+=h);else if(b=d.attributes[G])A&&(e+=A,A=null),e+=b}return D(e,n)}function D(d,b){"string"!==typeof d&&(d=String(d));switch(b){case "LowerCase":return d.toLowerCase();case "Allcaps":return d.toUpperCase();default:return d}}function E(d){return d?{r:d[0],g:d[1],b:d[2],a:d[3]/255}:{r:0,g:0,b:0,a:0}}function F(d){if(!d)return null;switch(d.type){case "CIMPolygonSymbol":if(d.symbolLayers)for(const b of d.symbolLayers)if(d=F(b),null!=d)return d;break;case "CIMTextSymbol":return F(d.symbol);
case "CIMSolidFill":return d.color}}function O(d){if(d)switch(d.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(d=d.symbolLayers)for(const b of d)if(d=O(b),null!=d)return d;break;case "CIMTextSymbol":return O(d.symbol);case "CIMSolidStroke":case "CIMSolidFill":return d.color}}function f(d){if(d)switch(d.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(d.symbolLayers)for(const b of d.symbolLayers)if(d=f(b),void 0!==d)return d;break;case "CIMTextSymbol":return f(d.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return d.width}}
M.adjustTextCase=D;M.analyzeTextParts=w;M.assignTextValuesFromFeature=u;M.attributesToFields=function(d){return(d?Object.keys(d):[]).map(b=>({name:b,alias:b,type:"string"===typeof d[b]?"esriFieldTypeString":"esriFieldTypeDouble"}))};M.colorToArray=function(d){return[d.r,d.g,d.b,d.a]};M.createLabelOverrideFunction=function(d,b,n){const e=w(b,d);return A=>u(A,e,n)};M.evaluateValueOrFunction=function(d,b,n,e){return"function"===typeof d?d(b,n,e):d};M.fromCIMColor=E;M.fromCIMFontDecoration=function(d){return d.underline?
"underline":d.strikethrough?"line-through":"none"};M.fromCIMFontStyle=function(d){let b="",n="";d&&(d=d.toLowerCase(),d.includes("italic")?b="italic":d.includes("oblique")&&(b="oblique"),d.includes("bold")?n="bold":d.includes("light")&&(n="lighter"));return{style:b,weight:n}};M.fromCIMHorizontalAlignment=function(d){switch(d){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};M.fromCIMVerticalAlignment=function(d){switch(d){default:return"top";
case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};M.getFillColor=F;M.getFontStyle=function(d){if(!d)return"normal";switch(d.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};M.getFontWeight=function(d){if(!d)return"normal";switch(d.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};M.getStrokeColor=O;M.getStrokeWidth=f;M.getTintColor=
d=>d.tintColor?E(d.tintColor):{r:255,g:255,b:255,a:1};M.getValue=(d,b=0)=>null==d||isNaN(d)?b:d;M.importGeometryEngine=function(){return new Promise((d,b)=>x(["../../geometry/geometryEngineJSON"],d,b))};M.isCIMFill=function(d){return null!=d&&("CIMGradientFill"===d.type||"CIMHatchFill"===d.type||"CIMPictureFill"===d.type||"CIMSolidFill"===d.type||"CIMWaterFill"===d.type)};M.isCIMMarker=function(d){return"CIMVectorMarker"===d.type||"CIMPictureMarker"===d.type||"CIMBarChartMarker"===d.type||"CIMCharacterMarker"===
d.type||"CIMPieChartMarker"===d.type||"CIMStackedBarChartMarker"===d.type};M.isCIMMarkerStrokePlacement=function(d){return null!=d&&("CIMMarkerPlacementAlongLineRandomSize"===d.type||"CIMMarkerPlacementAlongLineSameSize"===d.type||"CIMMarkerPlacementAlongLineVariableSize"===d.type||"CIMMarkerPlacementAtExtremities"===d.type||"CIMMarkerPlacementAtMeasuredUnits"===d.type||"CIMMarkerPlacementAtRatioPositions"===d.type||"CIMMarkerPlacementOnLine"===d.type||"CIMMarkerPlacementOnVertices"===d.type)};M.isCIMStroke=
function(d){return"CIMGradientStroke"===d.type||"CIMPictureStroke"===d.type||"CIMSolidStroke"===d.type};M.isGeometryEngineRequired=d=>{if(!d)return!1;for(const b of d)switch(b.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};M.isSVGImage=d=>d.includes("data:image/svg+xml");M.mapCIMSymbolToGeometryType=function(d){if(!d)return null;switch(d.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";
case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};M.resampleHermite=function(d,b,n,e,A,y,h=!0){const G=b/A;n/=y;const l=Math.ceil(G/2),g=Math.ceil(n/2);for(let L=0;L<y;L++)for(let c=0;c<A;c++){const p=4*(c+(h?y-L-1:L)*A);var m=0;let q=0,Q=0,J=0,r=0,H=0,N=0;const S=(L+.5)*n;for(let Y=Math.floor(L*n);Y<(L+1)*n;Y++){var P=Math.abs(S-(Y+.5))/g;const W=(c+.5)*G;P*=P;for(let k=Math.floor(c*G);k<(c+1)*G;k++){let B=Math.abs(W-(k+.5))/l;m=Math.sqrt(P+B*B);-1<=m&&1>=m&&(m=2*m*m*m-3*
m*m+1,0<m&&(B=4*(k+Y*b),N+=m*d[B+3],Q+=m,255>d[B+3]&&(m=m*d[B+3]/250),J+=m*d[B],r+=m*d[B+1],H+=m*d[B+2],q+=m))}}e[p]=J/q;e[p+1]=r/q;e[p+2]=H/q;e[p+3]=N/Q}};M.toCIMSymbolJSON=function(d){return d.data?.symbol??null};Object.defineProperty(M,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(x,M){function K(w,u){return Math.round(Math.min(Math.max(w+191.25*u,0),255))}x.SymbolSizeDefaults=void 0;(function(w){w[w.size=22]="size";
w[w.lineWidth=50]="lineWidth";w[w.maxSize=120]="maxSize";w[w.maxOutlineSize=80]="maxOutlineSize";w[w.tallSymbolWidth=20]="tallSymbolWidth"})(x.SymbolSizeDefaults||(x.SymbolSizeDefaults={}));x.adjustColorBrightness=function(w,u){if(null==w)return new M;if("type"in w&&("linear"===w.type||"pattern"===w.type))return w;w=new M(w);return new M([K(w.r,u),K(w.g,u),K(w.b,u),w.a])};x.adjustColorComponentBrightness=K;x.getConeShapes=function(w,u){let D=u?x.SymbolSizeDefaults.tallSymbolWidth:w;u=u?4:6;D=D<=x.SymbolSizeDefaults.size?
D-.5*u:D-u;u=.15*D;const E=D;w-=u;return[{type:"ellipse",cx:.5*D,cy:w,rx:.5*D,ry:u},{type:"path",path:[{command:"M",values:[.5*E,0]},{command:"L",values:[E,w]},{command:"L",values:[0,w]},{command:"Z",values:[]}]}]};x.getCubeShapes=function(w,u){let D=u?x.SymbolSizeDefaults.tallSymbolWidth:w;var E=u?4:6;E=D=D<=x.SymbolSizeDefaults.size?D-.5*E:D-E;u=u?.35*D:.5*D;return[{type:"path",path:[{command:"M",values:[.5*E,0]},{command:"L",values:[E,.5*u]},{command:"L",values:[.5*E,u]},{command:"L",values:[0,
.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*u]},{command:"L",values:[.5*E,u]},{command:"L",values:[.5*E,w]},{command:"L",values:[0,w-.5*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*E,u]},{command:"L",values:[.5*E,w]},{command:"L",values:[E,w-.5*u]},{command:"L",values:[E,.5*u]},{command:"Z",values:[]}]}]};x.getCylinderShapes=function(w,u){var D=u?x.SymbolSizeDefaults.tallSymbolWidth:w;u=u?4:6;D=D<=x.SymbolSizeDefaults.size?D-.5*u:D-u;u=
.5*D;const E=.15*D;w-=E;return[{type:"ellipse",cx:.5*D,cy:w,rx:u,ry:E},{type:"path",path:[{command:"M",values:[0,E]},{command:"L",values:[0,w]},{command:"L",values:[D,w]},{command:"L",values:[D,E]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*D,cy:E,rx:u,ry:E}]};x.getDiamondShapes=function(w){var u=w;u=u<x.SymbolSizeDefaults.size?u-2:u-4;const D=Math.floor(w/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*u,0]},{command:"L",values:[u,.5*w-D]},{command:"L",values:[.45*u-D,.5*w+D]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,0]},{command:"L",values:[.45*u-D,.5*w+D]},{command:"L",values:[0,.5*w-D]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*w-D]},{command:"L",values:[.45*u-D,.5*w+D]},{command:"L",values:[.45*u,w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*u,w]},{command:"L",values:[u,.5*w-D]},{command:"L",values:[.45*u-D,.5*w+D]},{command:"Z",values:[]}]}]};x.getExtrudeSymbolShapes=function(w){const u=x.SymbolSizeDefaults.size;
w*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*u]},{command:"L",values:[.3*u,.7*u]},{command:"L",values:[.3*u,.7*u+w]},{command:"L",values:[0,.7*u+w-.35*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*u,.7*u]},{command:"L",values:[.3*u,.7*u+w]},{command:"L",values:[u,w]},{command:"L",values:[u,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*u,0]},{command:"L",values:[u,0]},{command:"L",values:[.3*u,.7*u]},{command:"L",values:[0,.35*u]},
{command:"Z",values:[]}]}]};x.getInvertedConeShapes=function(w){let u=w;u=u<x.SymbolSizeDefaults.size?u-3:u-6;const D=.15*u,E=u;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[E,0]},{command:"L",values:[.5*E,w-D]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*u,cy:0,rx:.5*u,ry:D}]};x.getPathSymbolShapes=function(w,u,D){var E=x.SymbolSizeDefaults.size;let F=E,O=E;1>w?F*=.75:1<w&&(O*=1.25);w=E;u&&D&&(F=O=w=E=0);return[{type:"path",path:[{command:"M",values:[w,0]},{command:"L",
values:[D?w:.875*w,0]},{command:"L",values:[D?F-.5*w:0,O-.5*E]},{command:"L",values:[F-.5*w,O-.5*E]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[w,0]},{command:"L",values:[w,u?0:.125*E]},{command:"L",values:[F-.5*w,u?O-.5*E:E]},{command:"L",values:[F-.5*w,O-.5*E]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[F-.5*w,O-.5*E]},{command:"L",values:[D?F-.5*w:0,O-.5*E]},{command:"L",values:[D?F-.5*w:0,u?O-.5*E:E]},{command:"L",values:[F-.5*w,u?O-.5*E:E]},{command:"Z",
values:[]}]}]};x.getTetrahedronShapes=function(w){var u=w;u=u<x.SymbolSizeDefaults.size?u-1:u-2;return[{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[w,u]},{command:"L",values:[.45*w,.6*u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[.45*w,.6*u]},{command:"L",values:[0,u]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,u]},{command:"L",values:[.45*w,.6*u]},{command:"L",values:[w,u]},{command:"Z",values:[]}]}]};
x.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
x.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),
function(x,M,K,w,u,D,E,F,O,f){function d(e,A){n.append(e,A);n.detach(A)}function b(e,A,y){return e?K(e,{responseType:"image"}).then(h=>{h=h.data;const G=h.width,l=h.height,g=G/l;let m=A;y&&(m=Math.min(m,Math.max(G,l)));return{image:h,width:1>=g?Math.ceil(m*g):m,height:1>=g?m:Math.ceil(m/g)}}):Promise.reject(new u("renderUtils: imageDataSize","href not provided."))}const n=F.createProjector();x.renderOnce=d;x.renderSymbol=function(e,A,y){const h=Math.ceil(A[0]),G=Math.ceil(A[1]);if(!e.some(l=>!!l.length))return null;
A=y&&y.node||document.createElement("div");null!=y.opacity&&(A.style.opacity=y.opacity.toString());null!=y.effectView&&(A.style.filter=f.getCSSFilterFromEffectList(y.effectView));d(A,()=>O.renderSVG(e,h,G,y));return A};x.tintImageWithColor=function(e,A,y,h,G){return b(e,A,G).then(l=>{const g=l.width??A,m=l.height??A;var P;if(P=l.image)P=y&&"ignore"!==h?"multiply"===h&&255===y.r&&255===y.g&&255===y.b&&1===y.a?!1:!0:!1;if(P){var L=l.image.width,c=l.image.height;D("edge")&&/\.svg$/i.test(e)&&(--L,--c);
P=Math.ceil(g);var p=Math.ceil(m);var q=document.createElement("canvas");q.width=P;q.height=p;q.style.width=P+"px";q.style.height=p+"px";q=q.getContext("2d");q.clearRect(0,0,P,p);P=q;P.drawImage(l.image,0,0,L,c,0,0,g,m);p=P.getImageData(0,0,g,m);q=[y.r/255,y.g/255,y.b/255,y.a];const J=w.toHSV(y);for(let r=0;r<p.data.length;r+=4){l=p.data;L=r;c=q;var Q=J;switch(h){case "multiply":l[L]*=c[0];l[L+1]*=c[1];l[L+2]*=c[2];l[L+3]*=c[3];break;default:const H=w.toHSV({r:l[L],g:l[L+1],b:l[L+2]});H.h=Q.h;H.s=
Q.s;H.v=H.v/100*Q.v;Q=w.toRGB(H);l[L]=Q.r;l[L+1]=Q.g;l[L+2]=Q.b;l[L+3]*=c[3]}}P.putImageData(p,0,0);e=P.canvas.toDataURL("image/png")}else(P=M.id&&M.id.findCredential(e))&&P.token&&(l=e.includes("?")?"\x26":"?",e=`${e}${l}token=${P.token}`);return{url:e,width:g,height:m}}).catch(()=>({url:e,width:A,height:A}))};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(x){function M(f,d){const b=[];let n,e;if(f[0].length!==d.length)throw Error("dimensions do not match");
const A=f.length,y=f[0].length;let h=0;for(n=0;n<A;n++){for(e=h=0;e<y;e++)h+=f[n][e]*d[e];b.push(h)}return b}function K(f){f=[f.r/255,f.g/255,f.b/255].map(d=>.04045>=d?d/12.92:((d+.055)/1.055)**2.4);f=M(F,f);return{x:100*f[0],y:100*f[1],z:100*f[2]}}function w(f){f=M(O,[f.x/100,f.y/100,f.z/100]).map(d=>Math.min(1,Math.max(.0031308>=d?12.92*d:1.055*d**(1/2.4)-.055,0)));return{r:Math.round(255*f[0]),g:Math.round(255*f[1]),b:Math.round(255*f[2])}}function u(f){f=[f.x/95.047,f.y/100,f.z/108.883].map(d=>
d>(6/29)**3?d**(1/3):1/3*(29/6)**2*d+4/29);return{l:116*f[1]-16,a:500*(f[0]-f[1]),b:200*(f[1]-f[2])}}function D(f){const d=f.l;f=[(d+16)/116+f.a/500,(d+16)/116,(d+16)/116-f.b/200].map(b=>b>6/29?b**3:3*(6/29)**2*(b-4/29));return{x:95.047*f[0],y:100*f[1],z:108.883*f[2]}}function E(f){if("r"in f&&"g"in f&&"b"in f)return f;if("l"in f&&"c"in f&&"h"in f){var d=f.c,b=f.h;return w(D({l:f.l,a:d*Math.cos(b),b:d*Math.sin(b)}))}if("l"in f&&"a"in f&&"b"in f)return w(D(f));if("x"in f&&"y"in f&&"z"in f)return w(f);
if("h"in f&&"s"in f&&"v"in f){b=(f.h+360)%360/60;d=f.v/100*255;f=f.s/100*d;const n=f*(1-Math.abs(b%2-1));switch(Math.floor(b)){case 0:b={r:f,g:n,b:0};break;case 1:b={r:n,g:f,b:0};break;case 2:b={r:0,g:f,b:n};break;case 3:b={r:0,g:n,b:f};break;case 4:b={r:n,g:0,b:f};break;case 5:case 6:b={r:f,g:0,b:n};break;default:b={r:0,g:0,b:0}}b.r=Math.round(b.r+d-f);b.g=Math.round(b.g+d-f);b.b=Math.round(b.b+d-f);return b}return f}const F=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],O=[[3.2406,
-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];x.darken=function(f,d){f=u(K(f));f.l*=1-d;return w(D(f))};x.toHSV=function(f){if("h"in f&&"s"in f&&"v"in f)return f;var d=E(f);f=d.r;const b=d.g,n=d.b;d=Math.max(f,b,n);const e=d-Math.min(f,b,n);f=0===e?0:d===f?(b-n)/e%6:d===b?(n-f)/e+2:(f-b)/e+4;0>f&&(f+=6);return{h:60*f,s:100*(0===e?0:e/d),v:100/255*d}};x.toLAB=function(f){return"l"in f&&"a"in f&&"b"in f?f:u(K(E(f)))};x.toLCH=function(f){if(!("l"in f&&"c"in f&&"h"in f)){var d=u(K(E(f)));
f=d.l;var b=d.a;const n=d.b;d=Math.sqrt(b*b+n*n);b=Math.atan2(n,b);b=0<b?b:b+2*Math.PI;f={l:f,c:d,h:b}}return f};x.toRGB=E;x.toXYZ=function(f){return"x"in f&&"y"in f&&"z"in f?f:K(E(f))};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../chunks/mat2df32 ../../chunks/mat2d ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(x,M,K,w,u,D,E,F){function O(k,
B){k*=Y/180;return Math.abs(B*Math.sin(k))+Math.abs(B*Math.cos(k))}function f(k){return k.map(B=>`${B.command} ${B.values.join(" ")}`).join(" ").trim()}function d(k,B,C,v){if(k){if("circle"===k.type)return F.tsx("circle",{fill:B,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-dashoffset":C.dashOffset,"stroke-miterlimit":"4",cx:k.cx,cy:k.cy,r:k.r});if("ellipse"===k.type)return F.tsx("ellipse",{fill:B,
"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-miterlimit":"4",cx:k.cx,cy:k.cy,rx:k.rx,ry:k.ry});if("rect"===k.type)return F.tsx("rect",{fill:B,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-miterlimit":"4",x:k.x,y:k.y,width:k.width,height:k.height});if("image"===k.type)return F.tsx("image",{href:k.src,
x:k.x,y:k.y,width:k.width,height:k.height,preserveAspectRatio:"none"});if("path"===k.type)return k="string"!==typeof k.path?f(k.path):k.path,F.tsx("path",{fill:B,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-miterlimit":"4",d:k});if("text"===k.type)return w.assertIsSome(v),F.tsx("text",{"dominant-baseline":v.dominantBaseline,fill:B,"fill-rule":"evenodd",stroke:C.color,"stroke-width":C.width,"stroke-linecap":C.cap,
"stroke-linejoin":C.join,"stroke-dasharray":C.dashArray,"stroke-miterlimit":"4","text-anchor":v.align,"text-decoration":v.decoration,kerning:v.kerning,rotate:v.rotate,"text-rendering":Q,"font-style":v.font.style,"font-variant":v.font.variant,"font-weight":v.font.weight,"font-size":v.font.size,"font-family":v.font.family,x:k.x,y:k.y},k.text)}return null}function b(k){const B={fill:"none",pattern:null,linearGradient:null};if(k)if("type"in k&&"pattern"===k.type){var C=`patternId-${++p}`;B.fill=`url(#${C})`;
B.pattern={id:C,x:k.x,y:k.y,width:k.width,height:k.height,image:{x:0,y:0,width:k.width,height:k.height,href:k.src}}}else"type"in k&&"linear"===k.type?(C=`linearGradientId-${++q}`,B.fill=`url(#${C})`,B.linearGradient={id:C,x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,stops:k.colors.map(v=>({offset:v.offset,color:v.color&&(new M(v.color)).toString()}))}):k&&(k=new M(k),B.fill=k.toString());return B}function n(k){const B={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(k&&(null!=k.width&&
(B.width=k.width),k.cap&&(B.cap=k.cap),k.join&&(B.join=k.join.toString()),k.color&&(B.color=(new M(k.color)).toString()),k.dashArray&&(B.dashArray=k.dashArray),k.dashArray&&(B.dashOffset=k.dashoffset),k.style)){let C=null;k.style in S&&(C=S[k.style]);if(Array.isArray(C)){C=C.slice(0);const v=k.width??0;for(let I=0;I<C.length;++I)C[I]*=v;if("butt"!==k.cap){for(k=0;k<C.length;k+=2)C[k]-=v,1>C[k]&&(C[k]=1);for(k=1;k<C.length;k+=2)C[k]+=v}C=C.join(",")}B.dashArray=C}return B}function e(k,B){const C={align:null,
decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(k){const v=k.alignBaseline;C.align=k.align;C.dominantBaseline="baseline"===v?"auto":"top"===v?"text-top":"bottom"===v?"hanging":v;C.decoration=k.decoration;C.kerning=k.kerning?"auto":"0";C.rotate=k.rotated?"90":"0";w.assertIsSome(B);C.font.style=B.style||"normal";C.font.variant=B.variant||"normal";C.font.weight=B.weight||"normal";C.font.size=B.size&&B.size.toString()||"10pt";C.font.family=
B.family||"serif"}return C}function A(k){const {pattern:B,linearGradient:C}=k;return B?F.tsx("pattern",{id:B.id,patternUnits:"userSpaceOnUse",x:B.x,y:B.y,width:B.width,height:B.height},F.tsx("image",{x:B.image.x,y:B.image.y,width:B.image.width,height:B.image.height,href:B.image.href})):C?(k=C.stops.map((v,I)=>F.tsx("stop",{key:`${I}-stop`,offset:v.offset,"stop-color":v.color})),F.tsx("linearGradient",{id:C.id,gradientUnits:"userSpaceOnUse",x1:C.x1,y1:C.y1,x2:C.x2,y2:C.y2},k)):null}function y(k,B){if(!k)return null;
const C=[];for(const v of k){const {shape:I,fill:U,stroke:X,font:ha}=v;k=b(U);const ca=n(X),la="text"===I.type?e(I,ha):null;(k=d(I,k.fill,ca,la))&&C.push(k)}return F.tsx("mask",{id:B,maskUnits:"userSpaceOnUse"},F.tsx("g",null,C))}function h(k,B,C,v,I){D.scale(k,D.identity(k),[B,C]);k[4]=k[4]*B-v*B+v;k[5]=k[5]*C-I*C+I;return k}function G(k,B){if(H&&"left"in H){null!=H.left&&H.left>k&&(H.left=k);if(null==H.right||H.right<k)H.right=k;if(null==H.top||H.top>B)H.top=B;if(null==H.bottom||H.bottom<B)H.bottom=
B}else H={left:k,bottom:B,right:k,top:B}}function l(k){const B=k.args,C=B.length;switch(k.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(k=0;k<C;k+=2)G(B[k],B[k+1]);N.x=B[C-2];N.y=B[C-1];break;case "H":for(k=0;k<C;++k)G(B[k],N.y);N.x=B[C-1];break;case "V":for(k=0;k<C;++k)G(N.x,B[k]);N.y=B[C-1];break;case "m":k=0;"x"in N||(G(N.x=B[0],N.y=B[1]),k=2);for(;k<C;k+=2)G(N.x+=B[k],N.y+=B[k+1]);break;case "l":case "t":for(k=0;k<C;k+=2)G(N.x+=B[k],N.y+=B[k+1]);break;case "h":for(k=0;k<C;++k)G(N.x+=
B[k],N.y);break;case "v":for(k=0;k<C;++k)G(N.x,N.y+=B[k]);break;case "c":for(k=0;k<C;k+=6)G(N.x+B[k],N.y+B[k+1]),G(N.x+B[k+2],N.y+B[k+3]),G(N.x+=B[k+4],N.y+=B[k+5]);break;case "s":case "q":for(k=0;k<C;k+=4)G(N.x+B[k],N.y+B[k+1]),G(N.x+=B[k+2],N.y+=B[k+3]);break;case "A":for(k=0;k<C;k+=7)G(B[k+5],B[k+6]);N.x=B[C-2];N.y=B[C-1];break;case "a":for(k=0;k<C;k+=7)G(N.x+=B[k+5],N.y+=B[k+6])}}function g(k,B,C){const v=J[k.toLowerCase()];"number"===typeof v&&(v?B.length>=v&&(k={action:k,args:B.slice(0,B.length-
B.length%v)},C.push(k),l(k)):(k={action:k,args:[]},C.push(k),l(k)))}function m(k){const B={x:0,y:0,width:0,height:0};if("circle"===k.type)B.x=k.cx-k.r,B.y=k.cy-k.r,B.width=2*k.r,B.height=2*k.r;else if("ellipse"===k.type)B.x=k.cx-k.rx,B.y=k.cy-k.ry,B.width=2*k.rx,B.height=2*k.ry;else if("image"===k.type||"rect"===k.type)B.x=k.x,B.y=k.y,B.width=k.width,B.height=k.height;else if("path"===k.type){var C=w.unwrapOrThrow;{const U=("string"!==typeof k.path?f(k.path):k.path).match(r),X=[];H={};N={};if(U){k=
"";var v=[],I=U.length;for(let ha=0;ha<I;++ha){const ca=U[ha],la=parseFloat(ca);isNaN(la)?(k&&g(k,v,X),v=[],k=ca):v.push(la)}g(k,v,X);k={x:0,y:0,width:0,height:0};H&&"left"in H&&(k.x=H.left,k.y=H.top,k.width=H.right-H.left,k.height=H.bottom-H.top)}else k=null}C=C.call(w,k);B.x=C.x;B.y=C.y;B.width=C.width;B.height=C.height}return B}function P(k){const B={x:0,y:0,width:0,height:0};let C=null,v=Number.NEGATIVE_INFINITY,I=Number.NEGATIVE_INFINITY;for(const U of k)C?(C.x=Math.min(C.x,U.x),C.y=Math.min(C.y,
U.y),v=Math.max(v,U.x+U.width),I=Math.max(I,U.y+U.height)):(C=B,C.x=U.x,C.y=U.y,v=U.x+U.width,I=U.y+U.height);C&&(C.width=v-C.x,C.height=I-C.y);return C}function L(k,B,C,v,I,U,X,ha,ca){var la=(X&&U?O(U,B):B)/2,ma=(X&&U?O(U,C):C)/2;if(ca){var fa=ca[0];ca=ca[1];la=(X&&U?O(U,fa):fa)/2;ma=(X&&U?O(U,ca):ca)/2}fa=k.width+v;var Z=k.height+v;ca=u.create();X=u.create();var ia=!1;if(I&&0!==fa&&0!==Z){I=B!==C?B/C:fa/Z;ia=B>C?B:C;let na=1,oa=1;isNaN(ia)||(1<I?(na=ia/fa,oa=ia/I/Z):(oa=ia/Z,na=ia*I/fa));D.multiply(X,
X,h(ca,na,oa,la,ma));ia=!0}I=k.x+(fa-v)/2;k=k.y+(Z-v)/2;v=D.multiply;la-=I;ma-=k;la=D.translate(ca,D.identity(ca),[la,ma]);v.call(D,X,X,la);!ia&&(fa>B||Z>C)&&(la=fa/B>Z/C,B=(la?B:C)/(la?fa:Z),D.multiply(X,X,h(ca,B,B,I,k)));U&&(B=D.multiply,C=U%360*Math.PI/180,D.rotate(ca,D.identity(ca),C),U=Math.cos(C),C=Math.sin(C),fa=ca[4],Z=ca[5],ca[4]=fa*U-Z*C+k*C-I*U+I,ca[5]=Z*U+fa*C-I*C-k*U+k,B.call(D,X,X,ca));ha&&(U=D.multiply,B=ha[0],ha=ha[1],ha=D.translate(ca,D.identity(ca),[B,ha]),U.call(D,X,X,ha));return`matrix(${X[0]},${X[1]},${X[2]},${X[3]},${X[4]},${X[5]})`}
function c(k,B,C){k=k?.effects.find(ha=>"bloom"===ha.type);if(!k)return null;const {strength:v,radius:I}=k;k=0<v?I:0;const U=(v+k)*B,X=4*v+1;return F.tsx("filter",{id:`bloom${C}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},F.tsx("feMorphology",{operator:"dilate",radius:(v+.5*k)*5**(B/100)*(.4+B/100),in:"SourceGraphic",result:"dilate"}),F.tsx("feGaussianBlur",{in:"dilate",stdDeviation:U/25,result:"blur"}),F.tsx("feGaussianBlur",{in:"blur",stdDeviation:U/50,result:"intensityBlur"}),
F.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},F.tsx("feFuncR",{type:"linear",slope:X}),F.tsx("feFuncG",{type:"linear",slope:X}),F.tsx("feFuncB",{type:"linear",slope:X})),F.tsx("feMerge",null,F.tsx("feMergeNode",{in:"intensityBlur"}),F.tsx("feMergeNode",{in:"intensityBrightness"}),F.tsx("feGaussianBlur",{stdDeviation:v/10})))}let p=0,q=0;E=K("android");const Q=K("chrome")||E&&4<=E?"auto":"optimizeLegibility",J={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},r=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;
let H={},N={};const S={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},Y=Math.PI;let W=1;x.computeBBox=P;x.generateFillAttributes=b;x.generateStrokeAttributes=n;x.generateTextAttributes=e;x.getBoundingBox=m;x.getTransformMatrix=L;x.renderDef=A;x.renderSVG=function(k,B,C,v={}){const I=[],U=[],X=++W,ha=c(v.effectView,B,X);var ca=null;ha&&(ca=v.effectView?.effects.find(ia=>
"bloom"===ia.type),ca=(ca.strength?ca.strength+ca.radius/2:0)/3,ca=[Math.max(B+B*ca,10),Math.max(C+C*ca,10)]);for(let ia=0;ia<k.length;ia++){var la=k[ia];const na=[];var ma=[],fa=0,Z=0;let oa=0;for(const qa of la){const {shape:ra,fill:va,stroke:ya,font:za,offset:Aa}=qa;v.ignoreStrokeWidth||(fa+=ya&&ya.width||0);la=b(va);const Na=n(ya),Ba="text"===ra.type?e(ra,za):null;I.push(A(la));na.push(d(ra,la.fill,Na,Ba));ma.push(m(ra));Aa&&(Z+=Aa[0],oa+=Aa[1])}ma=w.unwrapOrThrow(P(ma));fa=L(ma,B,C,fa,v.scale??
!1,v.rotation,v.useRotationSize??!1,[Z,oa],ca);Z=null;v.masking&&(Z=`mask-${ia}`,I.push(y(v.masking[ia],Z)),Z=`url(#${Z})`);U.push(Z?F.tsx("g",{mask:Z},F.tsx("g",{transform:fa},na)):F.tsx("g",{transform:fa},na))}v.useRotationSize&&v.rotation&&(B=O(v.rotation,B),C=O(v.rotation,C));ha&&(w.assertIsSome(ca),B=ca[0],C=ca[1]);return F.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:B,height:C,style:"display: block;"},ha,F.tsx("defs",null,I),ha?F.tsx("g",{filter:`url(#bloom${X})`},U):U)};x.renderShape=
d;Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/mat2df32":function(){define(["exports"],function(x){function M(){const O=new Float32Array(6);O[0]=1;O[3]=1;return O}function K(O){const f=new Float32Array(6);f[0]=O[0];f[1]=O[1];f[2]=O[2];f[3]=O[3];f[4]=O[4];f[5]=O[5];return f}function w(O,f,d,b,n,e){const A=new Float32Array(6);A[0]=O;A[1]=f;A[2]=d;A[3]=b;A[4]=n;A[5]=e;return A}function u(O,f){return new Float32Array(O,f,6)}function D(O,f,d,b){const n=f[b];f=f[b+1];O[b]=
d[0]*n+d[2]*f+d[4];O[b+1]=d[1]*n+d[3]*f+d[5]}function E(O,f,d,b=0,n=0,e=2){for(n=n||f.length/e;b<n;b++)D(O,f,d,b*e)}const F=Object.freeze(Object.defineProperty({__proto__:null,clone:K,create:M,createView:u,fromValues:w,transform:D,transformMany:E},Symbol.toStringTag,{value:"Module"}));x.clone=K;x.create=M;x.createView=u;x.fromValues=w;x.mat2df32=F;x.transform=D;x.transformMany=E})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(x,M){function K(c,p){c[0]=p[0];c[1]=p[1];c[2]=
p[2];c[3]=p[3];c[4]=p[4];c[5]=p[5];return c}function w(c){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=0;c[5]=0;return c}function u(c,p,q,Q,J,r,H){c[0]=p;c[1]=q;c[2]=Q;c[3]=J;c[4]=r;c[5]=H;return c}function D(c,p){const q=p[0],Q=p[1],J=p[2],r=p[3],H=p[4];p=p[5];let N=q*r-Q*J;if(!N)return null;N=1/N;c[0]=r*N;c[1]=-Q*N;c[2]=-J*N;c[3]=q*N;c[4]=(J*p-r*H)*N;c[5]=(Q*H-q*p)*N;return c}function E(c){return c[0]*c[3]-c[1]*c[2]}function F(c,p,q){const Q=p[0],J=p[1],r=p[2],H=p[3],N=p[4];p=p[5];const S=q[0],Y=q[1],W=q[2],
k=q[3],B=q[4];q=q[5];c[0]=Q*S+r*Y;c[1]=J*S+H*Y;c[2]=Q*W+r*k;c[3]=J*W+H*k;c[4]=Q*B+r*q+N;c[5]=J*B+H*q+p;return c}function O(c,p,q){const Q=p[0],J=p[1],r=p[2],H=p[3],N=p[4];p=p[5];const S=Math.sin(q);q=Math.cos(q);c[0]=Q*q+r*S;c[1]=J*q+H*S;c[2]=Q*-S+r*q;c[3]=J*-S+H*q;c[4]=N;c[5]=p;return c}function f(c,p,q){const Q=p[1],J=p[2],r=p[3],H=p[4],N=p[5],S=q[0];q=q[1];c[0]=p[0]*S;c[1]=Q*S;c[2]=J*q;c[3]=r*q;c[4]=H;c[5]=N;return c}function d(c,p,q){const Q=p[0],J=p[1],r=p[2],H=p[3],N=p[4];p=p[5];const S=q[0];
q=q[1];c[0]=Q;c[1]=J;c[2]=r;c[3]=H;c[4]=Q*S+r*q+N;c[5]=J*S+H*q+p;return c}function b(c,p){const q=Math.sin(p);p=Math.cos(p);c[0]=p;c[1]=q;c[2]=-q;c[3]=p;c[4]=0;c[5]=0;return c}function n(c,p){c[0]=p[0];c[1]=0;c[2]=0;c[3]=p[1];c[4]=0;c[5]=0;return c}function e(c,p){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=p[0];c[5]=p[1];return c}function A(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"}function y(c){return Math.sqrt(c[0]**2+c[1]**2+c[2]**2+c[3]**2+c[4]**2+c[5]**2+1)}function h(c,
p,q){c[0]=p[0]+q[0];c[1]=p[1]+q[1];c[2]=p[2]+q[2];c[3]=p[3]+q[3];c[4]=p[4]+q[4];c[5]=p[5]+q[5];return c}function G(c,p,q){c[0]=p[0]-q[0];c[1]=p[1]-q[1];c[2]=p[2]-q[2];c[3]=p[3]-q[3];c[4]=p[4]-q[4];c[5]=p[5]-q[5];return c}function l(c,p,q){c[0]=p[0]*q;c[1]=p[1]*q;c[2]=p[2]*q;c[3]=p[3]*q;c[4]=p[4]*q;c[5]=p[5]*q;return c}function g(c,p,q,Q){c[0]=p[0]+q[0]*Q;c[1]=p[1]+q[1]*Q;c[2]=p[2]+q[2]*Q;c[3]=p[3]+q[3]*Q;c[4]=p[4]+q[4]*Q;c[5]=p[5]+q[5]*Q;return c}function m(c,p){return c[0]===p[0]&&c[1]===p[1]&&c[2]===
p[2]&&c[3]===p[3]&&c[4]===p[4]&&c[5]===p[5]}function P(c,p){const q=c[0],Q=c[1],J=c[2],r=c[3],H=c[4];c=c[5];const N=p[0],S=p[1],Y=p[2],W=p[3],k=p[4];p=p[5];const B=M.getEpsilon();return Math.abs(q-N)<=B*Math.max(1,Math.abs(q),Math.abs(N))&&Math.abs(Q-S)<=B*Math.max(1,Math.abs(Q),Math.abs(S))&&Math.abs(J-Y)<=B*Math.max(1,Math.abs(J),Math.abs(Y))&&Math.abs(r-W)<=B*Math.max(1,Math.abs(r),Math.abs(W))&&Math.abs(H-k)<=B*Math.max(1,Math.abs(H),Math.abs(k))&&Math.abs(c-p)<=B*Math.max(1,Math.abs(c),Math.abs(p))}
const L=Object.freeze(Object.defineProperty({__proto__:null,add:h,copy:K,determinant:E,equals:P,exactEquals:m,frob:y,fromRotation:b,fromScaling:n,fromTranslation:e,identity:w,invert:D,mul:F,multiply:F,multiplyScalar:l,multiplyScalarAndAdd:g,rotate:O,scale:f,set:u,str:A,sub:G,subtract:G,translate:d},Symbol.toStringTag,{value:"Module"}));x.add=h;x.copy=K;x.determinant=E;x.equals=P;x.exactEquals=m;x.frob=y;x.fromRotation=b;x.fromScaling=n;x.fromTranslation=e;x.identity=w;x.invert=D;x.mat2d=L;x.mul=F;
x.multiply=F;x.multiplyScalar=l;x.multiplyScalarAndAdd=g;x.rotate=O;x.scale=f;x.set=u;x.str=A;x.sub=G;x.subtract=G;x.translate=d})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(x,M,K,w,u,D,E,F,O,f,d,b){function n(c){c=c.symbolLayers;if(!c)return null;let p=null;c.forEach(q=>{if("object"!==
q.type||null==q.resource?.href)p="water"===q.type?E.unwrap(q.color):E.isSome(q.material)?E.unwrap(q.material.color):null});return p?new K(p):null}function e(c,p){if(null==p||null==c)return c;c=c.toRgba();c[3]*=p;return new K(c)}function A(c,p,q){if(c=c.symbolLayers){var Q=J=>{J=E.isSome(J)?J:null;p=p??J??(null!=q?L:null);return e(p,q)};c.forEach(J=>{if("object"!==J.type||null==J.resource?.href||p)if("water"===J.type)J.color=Q(J.color);else{var r=E.isSome(J.material)?J.material.color:null;r=Q(r);E.isNone(J.material)?
J.material=new b.Symbol3DMaterial({color:r}):J.material.color=r;null!=q&&"outline"in J&&E.isSome(J.outline)&&E.isSome(J.outline.color)&&(J.outline.color=e(J.outline.color,q))}})}}async function y(c,p){(c=c.symbolLayers)&&await u.forEach(c,async q=>h(q,p))}async function h(c,p){switch(c.type){case "extrude":c.size="number"===typeof p[2]?p[2]:0;break;case "icon":case "line":case "text":p=G(p);E.isSome(p)&&(c.size=p);break;case "path":const q=g(p,O.ONES,[c.width,void 0,c.height]);c.width=P(p[0],c.width,
1,q);c.height=P(p[2],c.height,1,q);break;case "object":await l(c,p)}}function G(c){for(const p of c)if("number"===typeof p)return p;return null}async function l(c,p){const {resourceSize:q,symbolSize:Q}=await m(c),J=g(p,q,Q);c.width=P(p[0],Q[0],q[0],J);c.depth=P(p[1],Q[1],q[1],J);c.height=P(p[2],Q[2],q[2],J)}function g(c,p,q){for(let Q=0;3>Q;Q++){const J=c[Q];switch(J){case "symbol-value":return c=q[Q],null!=c?c/p[Q]:1;case "proportional":break;default:if(J&&p[Q])return J/p[Q]}}return 1}async function m(c){const p=
await (await new Promise((N,S)=>x(["./symbolLayerUtils"],N,S))).computeObjectLayerResourceSize(c,10),{width:q,height:Q,depth:J}=c;c=[q,J,Q];let r=1;for(var H=0;3>H;H++){const N=c[H];if(null!=N){r=N/p[H];break}}for(H=0;3>H;H++)null==c[H]&&(c[H]=p[H]*r);return{resourceSize:p,symbolSize:c}}function P(c,p,q,Q){switch(c){case "proportional":return q*Q;case "symbol-value":return null!=p?p:q;default:return c}}const L=new K("white");M.applyColorToSymbol=function(c,p,q){if(c&&(p||null!=q))if(p&&(p=new K(p)),
w.isSymbol3D(c))A(c,p,q);else if(w.isSymbol2D(c)){if(p=p??c.color)c.color=e(p,q);null!=q&&"outline"in c&&c.outline&&c.outline.color&&(c.outline.color=e(c.outline.color,q))}};M.applyOpacityToColor=e;M.applyRotationToSymbol=function(c,p,q){c&&null!=p&&(w.isSymbol3D(c)?(c=c.symbolLayers)&&c.forEach(Q=>{if(Q&&"object"===Q.type)switch(q){case "tilt":Q.tilt=p;break;case "roll":Q.roll=p;break;default:Q.heading=p}}):!w.isSymbol2D(c)||"simple-marker"!==c.type&&"picture-marker"!==c.type&&"text"!==c.type||(c.angle=
p))};M.applySizesToSymbol=async function(c,p){if(c&&p){if(w.isSymbol3D(c))return y(c,p);if(w.isSymbol2D(c)&&(p=G(p),!E.isNone(p)))switch(c.type){case "simple-marker":c.size=p;break;case "picture-marker":const q=c.width/c.height;1<q?(c.width=p,c.height=p*q):(c.width=p*q,c.height=p);break;case "simple-line":c.width=p;break;case "text":c.font.size=p}}};M.fetchWebStyleSymbol=async function(c,p){const q=await c.fetchSymbol(p);return q?q:c.fetchCIMSymbol(p)};M.getCSSFilterFromEffectList=function(c){if(!c)return null;
c=c.effects.filter(p=>"bloom"!==p.type).map(p=>p.toJSON());return f.effectFunctionsFromJSON(c)};M.getColorFromSymbol=function(c,p){if(!c)return null;let q=null;w.isSymbol3D(c)?q=n(c):w.isSymbol2D(c)&&(q=c.color?new K(c.color):null);return q?e(q,p):null};M.getIconHref=function(c){return E.unwrapOrThrow(c.resource).href};M.getSymbolOutlineSize=function(c){if(!c)return 0;if(w.isSymbol3D(c)){{const p=c.symbolLayers&&c.symbolLayers.length;p?(c=c.symbolLayers.getItemAt(p-1),c="outline"in c?E.get(c,"outline",
"size"):void 0):c=void 0}return E.isSome(c)?c:0}return F.px2pt(d.getStroke(c)?.width)};M.isVolumetricSymbol=function(c){if(E.isNone(c)||!("symbolLayers"in c)||E.isNone(c.symbolLayers))return!1;switch(c.type){case "point-3d":return c.symbolLayers.some(p=>"object"===p.type);case "line-3d":return c.symbolLayers.some(p=>"path"===p.type);case "polygon-3d":return c.symbolLayers.some(p=>"object"===p.type||"extrude"===p.type);default:return!1}};M.symbolHasExtrudeSymbolLayer=function(c){return E.isSome(c)&&
"polygon-3d"===c.type&&c.symbolLayers.some(p=>"extrude"===p.type)};Object.defineProperty(M,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(x,M,K,w,u,D,E){function F(d){if(!d)return null;let b=null;switch(d.type){case "simple-fill":case "picture-fill":case "simple-marker":b=F(d.outline);break;case "simple-line":const n=D.pt2px(d.width);
null!=d.style&&"none"!==d.style&&0!==n&&(b={color:d.color,style:f(d.style),width:n,cap:d.cap,join:"miter"===d.join?D.pt2px(d.miterLimit):d.join});break;default:b=null}return b}const O=new u(1E3),f=(()=>{const d={};return b=>{if(d[b])return d[b];const n=b.replace(/-/g,"");return d[b]=n}})();K=new K([128,128,128]);x.defaultThematicColor=K;x.dekebabifyLineStyle=f;x.getFill=function(d){const b=d.style;let n=null;if(d)switch(d.type){case "simple-marker":"cross"!==b&&"x"!==b&&(n=d.color);break;case "simple-fill":"solid"===
b?n=d.color:"none"!==b&&(n={type:"pattern",x:0,y:0,src:M.getAssetUrl(`esri/symbols/patterns/${b}.png`),width:5,height:5});break;case "picture-fill":n={type:"pattern",src:d.url,width:D.pt2px(d.width)*d.xscale,height:D.pt2px(d.height)*d.yscale,x:D.pt2px(d.xoffset),y:D.pt2px(d.yoffset)};break;case "text":n=d.color;break;case "cim":n=E.getCIMSymbolColor(d)}return n};x.getPatternUrlWithColor=function(d,b){const n=d+"-"+b;return void 0!==O.get(n)?Promise.resolve(O.get(n)):w(d,{responseType:"image"}).then(e=>
{e=e.data;const A=e.naturalWidth,y=e.naturalHeight,h=document.createElement("canvas");h.width=A;h.height=y;const G=h.getContext("2d");G.fillStyle=b;G.fillRect(0,0,A,y);G.globalCompositeOperation="destination-in";G.drawImage(e,0,0);e=h.toDataURL();O.put(n,e);return e})};x.getStroke=F;Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(x,M){return function(){function K(u,D){this._storage=
new M.MemCacheStorage;this._storage.maxSize=u;D&&this._storage.registerRemoveFunc("",D)}var w=K.prototype;w.put=function(u,D){this._storage.put(u,D,1,1)};w.pop=function(u){return this._storage.pop(u)};w.get=function(u){return this._storage.get(u)};w.clear=function(){this._storage.clearAll()};w.destroy=function(){this._storage.destroy()};return x._createClass(K)}()})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(x,M,K,w,u,D,E,F,O,f,d){function b(h,G){if(G&&(h.style.filter=O.getCSSFilterFromEffectList(G),G=G.effects))for(const l of G)if("drop-shadow"===l?.type){0>l.offsetX?h.style.marginLeft=`${Math.abs(l.offsetX)}px`:h.style.marginRight=`${l.offsetX}px`;break}}async function n(h,G){switch(h.type){case "web-style":var {previewWebStyleSymbol:l}=await new Promise((g,m)=>x(["./previewWebStyleSymbol"],g,m));return l(h,n,G);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:l}=
await new Promise((g,m)=>x(["./previewSymbol3D"],g,m)),l(h,G);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:l}=await new Promise((g,m)=>x(["./previewSymbol2D"],g,m)),l(h,G);case "cim":return{previewCIMSymbol:l}=await new Promise((g,m)=>x(["./previewCIMSymbol"],g,m)),l(h,G)}}function e(h){return h&&"opacity"in h?h.opacity*e(h.parent):1}let A=null;const y=[255,255,255];M.getDisplayedColor=async function(h,G){if(h){var l=
e(h.layer||h.sourceLayer);if(w.isSome(h.symbol)&&(!w.isSome(G)||!0!==G.ignoreGraphicSymbol))return h="web-style"===h.symbol.type?await O.fetchWebStyleSymbol(h.symbol,G):h.symbol.clone(),O.getColorFromSymbol(h,l);var g=w.isSome(G)&&G.renderer||h.get("layer.renderer")||h.get("sourceLayer.renderer"),m=await g.getSymbolAsync(h,G);if(m){m="web-style"===m.type?await O.fetchWebStyleSymbol(m,G):m.clone();var P=O.getColorFromSymbol(m,l);if(!("visualVariables"in g)||"visualVariables"in g&&!g.visualVariables||
"visualVariables"in g&&!g.visualVariables?.length)return P;g.arcadeRequiredForVisualVariables&&(w.isNone(G)||w.isNone(G.arcade))&&(G={...w.unwrap(G)},G.arcade=await u.loadArcade());m=await new Promise((p,q)=>x(["../../renderers/visualVariables/support/visualVariableUtils"],p,q));var L=[],c=[];for(const p of g.visualVariables)switch(p.type){case "color":L.push(p);break;case "opacity":c.push(p)}g=(g=0<L.length?L[L.length-1]:null)?m.getColor(g,h,G):P;h=(P=0<c.length?c[c.length-1]:null)?m.getOpacity(P,
h,G):null;null!=l&&(h=null!=h?h*l:l);return g?O.applyOpacityToColor(g,h):null}}};M.getDisplayedSymbol=async function(h,G){if(h){var l=h.sourceLayer,g=(w.isSome(G)&&(G.useSourceLayer??!1)?l:h.layer)??l;l=e(g);if(w.isSome(h.symbol)&&(!w.isSome(G)||!0!==G.ignoreGraphicSymbol))return h="web-style"===h.symbol.type?await O.fetchWebStyleSymbol(h.symbol,{...G,cache:w.isSome(G)?G.webStyleCache:null}):h.symbol.clone(),O.applyColorToSymbol(h,null,l),h;var m=(w.isSome(G)?G.renderer:null)??(g&&"renderer"in g?
g.renderer:null);if(g=m&&"getSymbolAsync"in m?await m.getSymbolAsync(h,G):null){g="web-style"===g.type?await g.fetchSymbol({...G,cache:w.isSome(G)?G.webStyleCache:null}):g.clone();if(!(m&&"visualVariables"in m&&m.visualVariables&&m.visualVariables.length))return O.applyColorToSymbol(g,null,l),g;"arcadeRequiredForVisualVariables"in m&&m.arcadeRequiredForVisualVariables&&(w.isNone(G)||w.isNone(G.arcade))&&(G={...w.unwrap(G)},G.arcade=await u.loadArcade());var P=await new Promise((J,r)=>x(["../../renderers/visualVariables/support/visualVariableUtils"],
J,r)),L=[],c=[],p=[],q=[];for(var Q of m.visualVariables)switch(Q.type){case "color":L.push(Q);break;case "opacity":c.push(Q);break;case "rotation":q.push(Q);break;case "size":Q.target||p.push(Q)}Q=(Q=!!L.length&&L[L.length-1])?P.getColor(Q,h,G):null;c=(c=!!c.length&&c[c.length-1])?P.getOpacity(c,h,G):null;null!=l&&(c=null!=c?c*l:l);O.applyColorToSymbol(g,Q,c);p.length&&(l=P.getAllSizes(p,h,G),await O.applySizesToSymbol(g,l));for(const J of q)O.applyRotationToSymbol(g,P.getRotationAngle(J,h,G),J.axis);
return g}}};M.renderColorRampPreviewHTML=function(h,G={}){var l="horizontal"===G.align;const g=G.width??(l?75:24),m=G.height??(l?24:75);var P=G.gradient??!0,L=window.devicePixelRatio,c=g*L,p=m*L;L=document.createElement("canvas");L.width=c;L.height=p;L.style.width=`${g}px`;L.style.height=`${m}px`;const q=L.getContext("2d");var Q=l?c:0;const J=l?0:p;if(P){const r=q.createLinearGradient(0,0,Q,J);l=h.length;const H=1===l?0:1/(l-1);h.forEach((N,S)=>r.addColorStop(S*H,N.toString()));q.fillStyle=r;q.fillRect(0,
0,c,p)}else{c=l?c/h.length:c;p=l?p:p/h.length;Q=P=0;for(const r of h)q.fillStyle=r.toString(),q.fillRect(P,Q,c,p),P=l?P+c:0,Q=l?0:Q+p}h=document.createElement("div");h.style.width=`${g}px`;h.style.height=`${m}px`;b(h,G?.effectList);h.appendChild(L);return h};M.renderDotDensityPreviewHTML=function(h,G,l){const {backgroundColor:g,outline:m,dotSize:P}=h;l=l&&l.swatchSize||E.SymbolSizeDefaults.size;const L=Math.round(l*l/P**2*.8),c=window.devicePixelRatio;h=document.createElement("canvas");const p=l*
c;h.width=p;h.height=p;h.style.width=`${h.width/c}px`;h.style.height=`${h.height/c}px`;const q=h.getContext("2d");g&&(q.fillStyle=g.toCss(!0),q.fillRect(0,0,p,p),q.fill());q.fillStyle=G.toCss(!0);if(A&&A.length/2===L)for(G=0;G<2*L;G+=2)q.fillRect(A[G],A[G+1],P*c,P*c),q.fill();else for(A=[],G=0;G<2*L;G+=2){const Q=Math.floor(Math.random()*(p-0+1)),J=Math.floor(Math.random()*(p-0+1));A.push(Q,J);q.fillRect(Q,J,P*c,P*c);q.fill()}m&&(m.color&&(q.strokeStyle=m.color.toCss(!0)),q.lineWidth=m.width,q.strokeRect(0,
0,p,p));l=new Image(l,l);l.src=h.toDataURL();return l};M.renderPieChartPreviewHTML=function(h,G={}){const l=G.radius||40;var g=2*Math.PI*l,m=h.length;const P=g/m,L=[],c=D.getStroke(G.outline);null!=c?.width&&(c.width*=2);(c||G.backgroundColor)&&L.push({shape:{type:"circle",cx:l,cy:l,r:l},fill:G.backgroundColor,stroke:c,offset:[0,0]});const p=G.values,q=p&&p.length===m&&100===p.reduce((J,r)=>J+r,0),Q=[0];for(let J=0;J<m;J++){let r=null;q&&(r=p[J]*g/100,Q.push(r+Q[J]));L.push({shape:{type:"circle",
cx:l,cy:l,r:l/2},fill:[0,0,0,0],stroke:{width:l,dashArray:`${(r??P)/2} ${g}`,dashoffset:`-${q?Q[J]/2:P/2*J}`,color:h[J]},offset:[0,0]})}m=null;h=2*l+(c?.width||0);if(g=G.holePercentage)c&&L.push({shape:{type:"circle",cx:l,cy:l,r:l*g},fill:null,stroke:c,offset:[0,0]}),m=h/2,m=[[{shape:{type:"circle",cx:m,cy:m,r:m},fill:y,stroke:c?{...c,color:y}:null,offset:[0,0]},{shape:{type:"circle",cx:m,cy:m,r:l*g},fill:[0,0,0],stroke:null,offset:[0,0]}]];return F.renderSymbol([L],[h,h],{effectView:G.effectList,
ignoreStrokeWidth:!0,masking:m,rotation:-90})};M.renderPreviewHTML=n;M.renderRelationshipRampPreviewHTML=function(h,G={}){const l=h?.authoringInfo;if("relationship"!==l?.type||!l?.numClasses||!h.uniqueValueInfos)return null;const {focus:g,numClasses:m}=l,P=d.getRelationshipRampElement({focus:g,numClasses:m,infos:h.uniqueValueInfos});h=G&&G.node||document.createElement("div");F.renderOnce(h,()=>f.renderRelationshipRamp(P,G.id||"relationship",G.opacity||1,G.effectList));return h};Object.defineProperty(M,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(x,M,K,w,u){function D(O,f,d){const b=`${d}_arrowStart`;d=`${d}_arrowEnd`;O="left"===O;const n={markerStart:null,markerEnd:null};switch(f){case "HL":O?n.markerStart=`url(#${d})`:n.markerEnd=`url(#${b})`;break;case "LL":n.markerStart=
`url(#${d})`;break;case "LH":O?n.markerEnd=`url(#${b})`:n.markerStart=`url(#${d})`;break;default:n.markerEnd=`url(#${b})`}return n}function E(O,f,d,b,n=60){const {focus:e,numClasses:A,colors:y,rotation:h}=O;O=!!e;const G=Math.sqrt(n**2+n**2)+(O?0:5),l=[],g=[];var m=[],P=(n||75)/A;for(var L=0;L<A;L++){var c=L*P;for(var p=0;p<A;p++){var q=p*P,Q=M.generateFillAttributes(y[L][p]);const J=M.generateStrokeAttributes(null);q={type:"rect",x:q,y:c,width:P,height:P};const r=M.renderDef(Q);r&&l.push(r);(Q=M.renderShape(q,
Q.fill,J,null))&&g.push(Q);m.push(M.getBoundingBox(q))}}P=null;O||(P="margin: -15px -15px -18px -15px");L=D("left",e,f);c=D("right",e,f);p=M.computeBBox(m);m=M.getTransformMatrix(p,G,G,0,!1,h,!1);p=M.getTransformMatrix(p,G,G,0,!1,O?-45:null,!1);d={filter:K.getCSSFilterFromEffectList(b)??void 0,opacity:null==d?"":`${d}`};return u.tsx("div",{styles:d,class:O?F.diamondMidColRamp:F.squareTableCell},u.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:G,height:G,style:P},u.tsx("defs",null,u.tsx("marker",
{id:`${f}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},u.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),u.tsx("marker",{id:`${f}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},u.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),l),u.tsx("g",{transform:m},g),u.tsx("g",{transform:p},u.tsx("line",{fill:"none",
stroke:"#555555","stroke-width":"1","marker-start":L.markerStart,"marker-end":L.markerEnd,x1:-10,y1:n-15,x2:-10,y2:15}),u.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":c.markerStart,"marker-end":c.markerEnd,x1:15,y1:n+10,x2:n-15,y2:n+10}))))}const F={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",
diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",
squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};x.renderRelationshipRamp=function(O,f,d,b){const {focus:n,labels:e}=O,A=!!n;O=E(O,f,d,b);f={justifyContent:"center"};d=w.isRTL();return A?u.tsx("div",{class:F.diamondContainer,styles:f},u.tsx("div",{class:F.diamondLeftCol},d?e.right:e.left),u.tsx("div",{class:F.diamondMidCol},u.tsx("div",{class:F.diamondMidColLabel},e.top),O,u.tsx("div",
{class:F.diamondMidColLabel},e.bottom)),u.tsx("div",{class:F.diamondRightCol},d?e.left:e.right)):u.tsx("div",{class:F.squareTable},u.tsx("div",{class:F.squareTableRow},u.tsx("div",{class:w.classes(F.squareTableCell,F.squareTableLabel,F.squareTableLabelRightBottom)},d?e.top:e.left),u.tsx("div",{class:F.squareTableCell}),u.tsx("div",{class:w.classes(F.squareTableCell,F.squareTableLabel,F.squareTableLabelLeftBottom)},d?e.left:e.top)),u.tsx("div",{class:F.squareTableRow},u.tsx("div",{class:F.squareTableCell}),
O,u.tsx("div",{class:F.squareTableCell})),u.tsx("div",{class:F.squareTableRow},u.tsx("div",{class:w.classes(F.squareTableCell,F.squareTableLabel,F.squareTableLabelRightTop)},d?e.right:e.bottom),u.tsx("div",{class:F.squareTableCell}),u.tsx("div",{class:w.classes(F.squareTableCell,F.squareTableLabel,F.squareTableLabelLeftTop)},d?e.bottom:e.right)))};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang",
"../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(x,M,K,w){function u(f){if(f){var {type:d}=f;return d.includes("3d")?w.getSymbolLayerFill(f.symbolLayers.getItemAt(0)):"simple-line"===d||"simple-marker"===f.type&&("x"===f.style||"cross"===f.style)?(f=K.getStroke(f))&&f.color:K.getFill(f)}}function D(f,d){const b=d.HH.label,n=d.LL.label,e=d.HL.label;d=d.LH.label;switch(f){case "HH":return{top:b,bottom:n,left:e,right:d};case "HL":return{top:e,bottom:d,left:n,right:b};
case "LL":return{top:n,bottom:b,left:d,right:e};case "LH":return{top:d,bottom:e,left:b,right:n};default:return{top:b,bottom:n,left:e,right:d}}}function E(f){let d=F[f];f&&null==d&&(d=F.HH);return d||0}const F={HH:315,HL:45,LL:135,LH:225},O={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};x.getRelationshipRampColors2D=function(f,d){const b=[],n=f.length**.5;
f=M.clone(f);var e=(d||"HH").split("");d=e[0];for(e="H"===e[1];f.length;){const A=[];for(;A.length<n;)A.push(f.shift());e&&A.reverse();b.push(A)}"L"===d&&b.reverse();return b};x.getRelationshipRampElement=function(f){const {focus:d,infos:b,numClasses:n}=f;var e=O[n];const A={};b.forEach(y=>{A[y.value]={label:y.label,fill:u(y.symbol)}});f=[];for(let y=0;y<n;y++){const h=[];for(let G=0;G<n;G++)h.push(A[e[y][G]].fill);f.push(h)}e=D(d,A);return{type:"relationship-ramp",numClasses:n,focus:d,colors:f,labels:e,
rotation:E(d)}};x.getRotationAngleForFocus=E;Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),function(x,M,K,w,u,D,E,F,O,f,d,b,n,e,
A,y){function h(v){const I=v.outline;var U=E.isSome(v.material)?v.material.color:null;U=E.isSome(U)?U.toHex():null;if(E.isNone(I)||"pattern"in I&&E.isSome(I.pattern)&&"style"===I.pattern.type&&"none"===I.pattern.style)return"fill"===v.type&&"#ffffff"===U?{color:"#bdc3c7",width:.75}:null;v=O.pt2px(I.size)||0;return{color:"rgba("+(E.isSome(I.color)?I.color.toRgba():"255,255,255,1")+")",width:Math.min(v,k),style:"pattern"in I&&E.isSome(I.pattern)&&"style"===I.pattern.type?f.dekebabifyLineStyle(I.pattern.style):
null,join:"butt",cap:"patternCap"in I?I.patternCap:"butt"}}function G(v,I){var U=I&&I.resource;U=U&&U.href;if(v.thumbnail&&v.thumbnail.url)return Promise.resolve(v.thumbnail.url);if(U&&"object"!==I.type)return Promise.resolve(A.getIconHref(I));const X=M.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return v.styleOrigin&&(v.styleOrigin.styleName||v.styleOrigin.styleUrl)?y.resolveWebStyleSymbol(v.styleOrigin,{portal:v.styleOrigin.portal},"webRef").catch(ha=>ha).then(ha=>ha?.thumbnail?.url||
X):Promise.resolve(X)}function l(v,I=1){const U=v.a;v=K.toHSV(v);const {r:X,g:ha,b:ca}=K.toRGB({h:v.h,s:v.s/I,v:100-(100-v.v)/I});return[X,ha,ca,U]}function g(v){return"water"===v.type?E.isNone(v.color)?null:v.color:E.isNone(v.material)||E.isNone(v.material.color)?null:v.material.color}function m(v,I=0){var U=g(v);if(!U){if("fill"===v.type)return null;I=n.adjustColorComponentBrightness(f.defaultThematicColor.r,I);return[I,I,I,100]}v=U.toRgba();for(U=0;3>U;U++)v[U]=n.adjustColorComponentBrightness(v[U],
I);return v}async function P(v,I){v=v.style;return"none"===v?null:{type:"pattern",x:0,y:0,src:await f.getPatternUrlWithColor(M.getAssetUrl(`esri/symbols/patterns/${v}.png`),I.toCss(!0)),width:5,height:5}}function L(v){return v.outline?h(v):{color:"rgba(0, 0, 0, 1)",width:1.5}}function c(v,I){v=g(v);if(!v)return null;let U;U="rgba("+(n.adjustColorComponentBrightness(v.r,I)+",");U+=n.adjustColorComponentBrightness(v.g,I)+",";U+=n.adjustColorComponentBrightness(v.b,I)+",";return U+v.a+");"}function p(v,
I){I=c(v,I);if(!I)return{};if("pattern"in v&&E.isSome(v.pattern)&&"style"===v.pattern.type&&"none"===v.pattern.style)return null;const U=Math.min(v.size?O.pt2px(v.size):.75,k);return{color:I,width:U,style:"pattern"in v&&E.isSome(v.pattern)&&"style"===v.pattern.type?f.dekebabifyLineStyle(v.pattern.style):null,cap:"cap"in v?v.cap:null,join:"join"in v?"miter"===v.join?O.pt2px(2):v.join:null}}function q(v,I,U){U=null!=U?.75*U:0;return{type:"linear",x1:U?.25*U:0,y1:U?.5*U:0,x2:U||4,y2:U?.5*U:4,colors:[{color:v,
offset:0},{color:I,offset:1}]}}function Q(v){const I=v.depth,U=v.height;v=v.width;return 0!==v&&0!==I&&0!==U&&v===I&&null!=v&&null!=U&&v<U}function J(v,I,U){const X=[];if(!v)return X;switch(v.type){case "icon":switch(v.resource&&v.resource.primitive||d.defaultPrimitive){case "circle":X.push({shape:{type:"circle",cx:0,cy:0,r:.5*I},fill:m(v,0),stroke:h(v)});break;case "square":X.push({shape:{type:"path",path:[{command:"M",values:[0,I]},{command:"L",values:[0,0]},{command:"L",values:[I,0]},{command:"L",
values:[I,I]},{command:"Z",values:[]}]},fill:m(v,0),stroke:h(v)});break;case "triangle":X.push({shape:{type:"path",path:[{command:"M",values:[0,I]},{command:"L",values:[.5*I,0]},{command:"L",values:[I,I]},{command:"Z",values:[]}]},fill:m(v,0),stroke:h(v)});break;case "cross":X.push({shape:{type:"path",path:[{command:"M",values:[.5*I,0]},{command:"L",values:[.5*I,I]},{command:"M",values:[0,.5*I]},{command:"L",values:[I,.5*I]}]},stroke:L(v)});break;case "x":X.push({shape:{type:"path",path:[{command:"M",
values:[0,0]},{command:"L",values:[I,I]},{command:"M",values:[I,0]},{command:"L",values:[0,I]}]},stroke:L(v)});break;case "kite":X.push({shape:{type:"path",path:[{command:"M",values:[0,.5*I]},{command:"L",values:[.5*I,0]},{command:"L",values:[I,.5*I]},{command:"L",values:[.5*I,I]},{command:"Z",values:[]}]},fill:m(v,0),stroke:h(v)})}break;case "object":switch(v.resource&&v.resource.primitive||b.defaultPrimitive){case "cone":var ha=m(v,0);v=m(v,-.6);v=q(ha,v,U?C:I);I=n.getConeShapes(I,U);X.push({shape:I[0],
fill:v});X.push({shape:I[1],fill:v});break;case "inverted-cone":U=m(v,0);v=m(v,-.6);v=q(U,v,I);I=n.getInvertedConeShapes(I);X.push({shape:I[0],fill:v});X.push({shape:I[1],fill:U});break;case "cube":I=n.getCubeShapes(I,U);X.push({shape:I[0],fill:m(v,0)});X.push({shape:I[1],fill:m(v,-.3)});X.push({shape:I[2],fill:m(v,-.5)});break;case "cylinder":ha=m(v,0);const ca=m(v,-.6);ha=q(ha,ca,U?C:I);I=n.getCylinderShapes(I,U);X.push({shape:I[0],fill:ha});X.push({shape:I[1],fill:ha});X.push({shape:I[2],fill:m(v,
0)});break;case "diamond":I=n.getDiamondShapes(I);X.push({shape:I[0],fill:m(v,-.3)});X.push({shape:I[1],fill:m(v,0)});X.push({shape:I[2],fill:m(v,-.3)});X.push({shape:I[3],fill:m(v,-.7)});break;case "sphere":U=m(v,0);v=m(v,-.6);v=q(U,v);v.x1=0;v.y1=0;v.x2=.25*I;v.y2=.25*I;X.push({shape:{type:"circle",cx:0,cy:0,r:.5*I},fill:v});break;case "tetrahedron":I=n.getTetrahedronShapes(I),X.push({shape:I[0],fill:m(v,-.3)}),X.push({shape:I[1],fill:m(v,0)}),X.push({shape:I[2],fill:m(v,-.6)})}}return X}function r(v){return(v=
"number"===typeof v?.size?v?.size:null)?O.pt2px(v):null}function H(v,I){const U=r(I),X=I?.maxSize?O.pt2px(I.maxSize):null,ha=I?.disableUpsampling??!1,ca=v.symbolLayers,la=[];let ma=0,fa=0;const Z=ca.getItemAt(ca.length-1);let ia;Z&&"icon"===Z.type&&(ia=Z.size&&O.pt2px(Z.size));ca.forEach(na=>{if("icon"===na.type||"object"===na.type){var oa="icon"===na.type?na.size&&O.pt2px(na.size):0,qa=U||oa?Math.ceil(Math.min(U||oa,X||W)):Y;if(na&&na.resource&&na.resource.href){var ra=G(v,na).then(va=>{const ya=
na.get("material.color");var za="icon"===na.type?"multiply":"tint";return e.tintImageWithColor(va,qa,ya,za,ha)}).then(va=>{const ya=va.width,za=va.height;ma=Math.max(ma,ya);fa=Math.max(fa,za);return[{shape:{type:"image",x:0,y:0,width:ya,height:za,src:va.url},fill:null,stroke:null}]});la.push(ra)}else ra=qa,"icon"===na.type&&ia&&U&&(ra=oa/ia*qa),oa="tall"===I?.symbolConfig||I?.symbolConfig?.isTall||("object"===na.type?Q(na):!1),ma=Math.max(ma,oa?C:ra),fa=Math.max(fa,ra),la.push(Promise.resolve(J(na,
ra,oa)))}});return F.eachAlways(la).then(na=>{const oa=[];na.forEach(qa=>{qa.value?oa.push(qa.value):qa.error&&D.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",qa.error)});return e.renderSymbol(oa,[ma,fa],{node:I&&I.node,scale:!1,opacity:I&&I.opacity})})}function N(v,I){const U=v.symbolLayers,X=[];v=A.isVolumetricSymbol(v);const ha=r(I),ca=(I&&I.maxSize?O.pt2px(I.maxSize):null)||k;let la=0,ma=0,fa;U.forEach((Z,ia)=>{if(Z&&("line"===Z.type||"path"===Z.type)){var na=
[];switch(Z.type){case "line":var oa=p(Z,0);if(E.isNone(oa))break;var qa=oa&&oa.width||0;0===ia&&(fa=qa);Z=Math.min(ha||qa,ca);ia=0===ia?Z:ha?qa/fa*Z:Z;qa=ia>B/2?2*ia:B;ma=Math.max(ma,ia);la=Math.max(la,qa);oa.width=ia;na.push({shape:{type:"path",path:[{command:"M",values:[0,.5*ma]},{command:"L",values:[la,.5*ma]}]},stroke:oa});break;case "path":oa=Math.min(ha||Y,ca);ia=m(Z,0);qa=m(Z,-.2);var ra=c(Z,-.4);ra=ra?{color:ra,width:1}:{};if("quad"===Z.profile){const va=Z.width;Z=Z.height;Z=n.getPathSymbolShapes(va&&
Z?va/Z:1,0===Z,0===va);ra={...ra,join:"bevel"};na.push({shape:Z[0],fill:qa,stroke:ra});na.push({shape:Z[1],fill:qa,stroke:ra});na.push({shape:Z[2],fill:ia,stroke:ra})}else na.push({shape:n.shapes.pathSymbol3DLayer[0],fill:qa,stroke:ra}),na.push({shape:n.shapes.pathSymbol3DLayer[1],fill:ia,stroke:ra});la=ma=Math.max(ma,oa)}X.push(na)}});return Promise.resolve(e.renderSymbol(X,[la,ma],{node:I&&I.node,scale:v,opacity:I&&I.opacity}))}async function S(v,I){const U="mesh-3d"===v.type;v=v.symbolLayers;var X=
r(I);const ha=I&&I.maxSize?O.pt2px(I.maxSize):null;X=X||Y;const ca=[];let la=0,ma=0;var fa=!1;for(let ra=0;ra<v.length;ra++){var Z=v.getItemAt(ra);const va=[];if(!U||"fill"===Z.type){var ia=n.shapes.fill[0];switch(Z.type){case "fill":var na=h(Z);fa=Math.min(X,ha||W);la=Math.max(la,fa);ma=Math.max(ma,fa);fa=!0;var oa=m(Z,0),qa="pattern"in Z?Z.pattern:null;Z=g(Z);!U&&E.isSome(qa)&&"style"===qa.type&&"solid"!==qa.style&&Z&&(oa=await P(qa,Z));va.push({shape:ia,fill:oa,stroke:na});break;case "line":Z=
p(Z,0);if(E.isNone(Z))break;Z={stroke:Z,shape:ia};la=Math.max(la,Y);ma=Math.max(ma,Y);va.push(Z);break;case "extrude":ia={join:"round",width:1,...p(Z,-.4)};na=m(Z,0);Z=m(Z,-.2);oa=Math.min(X,ha||W);qa=n.getExtrudeSymbolShapes(oa);ia.width=1;va.push({shape:qa[0],fill:Z,stroke:ia});va.push({shape:qa[1],fill:Z,stroke:ia});va.push({shape:qa[2],fill:na,stroke:ia});Z=.7*Y+.5*oa;la=Math.max(la,Y);ma=Math.max(ma,Z);break;case "water":fa=E.unwrapOrThrow(g(Z)),Z=l(fa),ia=l(fa,2),na=l(fa,3),oa=n.getWaterSymbolShapes(),
fa=!0,va.push({shape:oa[0],fill:Z}),va.push({shape:oa[1],fill:ia}),va.push({shape:oa[2],fill:na}),Z=Math.min(X,ha||W),la=Math.max(la,Z),ma=Math.max(ma,Z)}ca.push(va)}}return e.renderSymbol(ca,[la,ma],{node:I&&I.node,scale:fa,opacity:I&&I.opacity})}const Y=n.SymbolSizeDefaults.size,W=n.SymbolSizeDefaults.maxSize,k=n.SymbolSizeDefaults.maxOutlineSize,B=n.SymbolSizeDefaults.lineWidth,C=n.SymbolSizeDefaults.tallSymbolWidth;x.getPatternDescriptor=P;x.getSizeFromOptions=r;x.getSymbolLayerFill=m;x.previewSymbol3D=
function(v,I){if(0===v.symbolLayers.length)return Promise.reject(new u("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(v.type){case "point-3d":return H(v,I);case "line-3d":return N(v,I);case "polygon-3d":case "mesh-3d":return S(v,I)}return Promise.reject(new u("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/maybe ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(x,M,K,w,u,D,E,F,O,f,d,b){function n(A,y,h,G,l){var g=A.data;const m=h&&u.isSome(h.portal)?h.portal:E.getDefault(),P={portal:m,url:D.urlToObject(A.baseUrl),origin:"portal-item"};g=g.items.find(Q=>Q.name===y);if(!g)return Promise.reject(new w("symbolstyleutils:symbol-name-not-found",`The symbol name '${y}' could not be found`,{symbolName:y}));let L=F.fromJSON(d.symbolUrlFromStyleItem(g,G),P),c=g.thumbnail?.href??null;const p=g.thumbnail&&g.thumbnail.imageData;K.isDevEnvironment()&&(L=K.adjustStaticAGOUrl(L)??
"",c=K.adjustStaticAGOUrl(c));const q={portal:m,url:D.urlToObject(D.removeFile(L)),origin:"portal-item"};return d.requestJSON(L,l).then(Q=>{Q="cimRef"===G?d.makeCIMSymbolRef(Q.data):Q.data;if((Q=O.fromJSON(Q,q))&&M.isSymbol3D(Q)){if(c){const J=F.fromJSON(c,P);Q.thumbnail=new b.Thumbnail({url:J})}else p&&(Q.thumbnail=new b.Thumbnail({url:`data:image/png;base64,${p}`}));A.styleUrl?Q.styleOrigin=new f({portal:h.portal,styleUrl:A.styleUrl,name:y}):A.styleName&&(Q.styleOrigin=new f({portal:h.portal,styleName:A.styleName,
name:y}))}return Q})}function e(A,y,h){const G=d.Style2DUrlTemplate.replace(/\{SymbolName\}/gi,A),l=u.isSome(y.portal)?y.portal:E.getDefault();return d.requestJSON(G,h).then(g=>{g=d.makeCIMSymbolRef(g.data);return O.fromJSON(g,{portal:l,url:D.urlToObject(D.removeFile(G)),origin:"portal-item"})})}x.fetchSymbolFromStyle=n;x.resolveWebStyleSymbol=function(A,y,h,G){const l=A.name;return u.isNone(l)?Promise.reject(new w("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
A.styleName&&"Esri2DPointSymbolsStyle"===A.styleName?e(l,y,G):d.fetchStyle(A,y,G).then(g=>n(u.unwrapOrThrow(g),l,y,h,G))};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(x){const M=/^devext.arcgis.com$/,K=/^qaext.arcgis.com$/,w=/^[\w-]*\.mapsdevext.arcgis.com$/,u=/^[\w-]*\.mapsqa.arcgis.com$/,D=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,M,K,/^jsapps.esri.com$/,w,u];x.adjustStaticAGOUrl=function(E,F){return E?
(F=F||globalThis.location.hostname)?null!=F.match(M)||null!=F.match(w)?E.replace("static.arcgis.com","staticdev.arcgis.com"):null!=F.match(K)||null!=F.match(u)?E.replace("static.arcgis.com","staticqa.arcgis.com"):E:E:E};x.isDevEnvironment=function(E){E=E||globalThis.location.hostname;return D.some(F=>null!=E?.match(F))};x.isTelemetryDevEnvironment=function(E){E=E||globalThis.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(D).some(F=>null!=E?.match(F))};Object.defineProperty(x,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(x,M){const K=(w,u)=>{w=w.featuresTilingScheme.getClosestInfoForScale(w.scale).level;return u?.levels?u.levels[w]:null};x.getClusterSizeVariable=function(w,u){if(!(w&&"visualVariables"in w&&w.visualVariables))return null;w=w.visualVariables.find(D=>"size"===D.type);return(u=K(u,w))?new M({field:w.field,minSize:u[2].size,minDataValue:u[2].value,maxSize:u[3].size,
maxDataValue:u[3].value}):null};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(x,M,K,w){function u(f,d){const b=[],n=f.length-1;5===f.length?b.push(0,2,4):b.push(0,n);return f.map((e,A)=>b.includes(A)?w.createStopLabel(e,A,n,d):null)}async function D(f,d,b){b=new K(b??O);f=(await new Promise((n,e)=>x(["../../../renderers/visualVariables/support/visualVariableUtils"],
n,e))).getOpacity(d,f);null!=f&&(b.a=f);return b}function E(f,d){const {startIndex:b,endIndex:n,weight:e}=F(f,d);if(b===n)return d[b].color;f=K.blendColors(d[b].color,d[n].color,e);return new K(f)}function F(f,d){let b=0,n=d.length-1;d.some((e,A)=>{if(f<e.value)return n=A,!0;b=A;return!1});return{startIndex:b,endIndex:n,weight:(f-d[b].value)/(d[n].value-d[b].value)}}const O=new K([64,64,64]);M.getColorFromPointCloudStops=E;M.getRampStops=async function(f,d,b){let n=!1,e=[],A=[];if(f.stops){var y=
f.stops;e=y.map(G=>G.value);(n=y.some(G=>!!G.label))&&(A=y.map(G=>G.label))}y=e[e.length-1];if(null==e[0]&&null==y)return null;const h=n?null:u(e,b??!1);return(await Promise.all(e.map(async(G,l)=>{const g="opacity"===f.type?await D(G,f,d):(await new Promise((m,P)=>x(["../../../renderers/visualVariables/support/visualVariableUtils"],m,P))).getColor(f,G);return{value:G,color:g,label:n?A[l]:h?.[l]??""}}))).reverse()};M.getRampStopsForPointCloud=function(f){let d=!1,b=[],n=[];b=f.map(y=>y.value);(d=f.some(y=>
!!y.label))&&(n=f.map(y=>y.label??""));const e=b[b.length-1];if(null==b[0]&&null==e)return null;const A=d?null:u(b,!1);return b.map((y,h)=>{const G=E(y,f);return{value:y,color:G,label:d?n[h]:A?.[h]??""}}).reverse()};M.getStrectchRampStops=function(f,d){let b=[];if(f&&"multipart"===f.type)f.colorRamps.reverse().forEach((n,e)=>{0===e?b.push({value:d.max,color:new K(n.toColor),label:"high"}):b.push({value:null,color:new K(n.toColor),label:""});e===f.colorRamps.length-1?b.push({value:d.min,color:new K(n.fromColor),
label:"low"}):b.push({value:null,color:new K(n.fromColor),label:""})});else{let n,e;f&&"algorithmic"===f.type?(n=f.fromColor,e=f.toColor):(n=[0,0,0,1],e=[255,255,255,1]);b=[{value:d.max,color:new K(e),label:"high"},{value:d.min,color:new K(n),label:"low"}]}return b};Object.defineProperty(M,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../intl/date ../../../renderers/support/numberUtils ../../../symbols/SimpleLineSymbol".split(" "),
function(x,M,K,w,u,D){async function E(O){if(!("visualVariables"in O&&O.visualVariables))return null;O=O.visualVariables.find(b=>"color"===b.type);if(!O)return null;var f=null,d=null;if(O.stops){if(1===O.stops.length)return O.stops[0].color;f=O.stops[0].value;d=O.stops[O.stops.length-1].value}f=null!=f&&null!=d?f+(d-f)/2:0;({getColor:d}=await new Promise((b,n)=>x(["../../../renderers/visualVariables/support/visualVariableUtils"],b,n)));return d(O,f)??null}const F=w.convertDateFormatToIntlOptions("short-date");
M.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
M.SPECIAL_CHARS_GREATER_THAN="\x3e";M.SPECIAL_CHARS_LESS_THAN="\x3c";M.createStopLabel=function(O,f,d,b){let n="";0===f?n="\x3c ":f===d&&(n="\x3e ");f=null;f=b?w.formatDate(O,F):u.format(O);return n+f};M.getMedianColor=E;M.getSymbolForFlowRenderer=async function(O,f){const d=O.trailCap,b=O.trailWidth||1;O=f||await E(O)||O.color;return new D({cap:d,color:O,width:b})};Object.defineProperty(M,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl",
"../../intl/number"],function(x,M,K){function w(d,b){return d-b}function u(d,b){let n;n=Number(d.toFixed(b));n<d?d=n+1/10**b:(d=n,n-=1/10**b);n=Number(n.toFixed(b));d=Number(d.toFixed(b));return[n,d]}function D(d,b,n,e,A){d=F(d,b,n,e);b=null==d.next||d.next<=A;return(null==d.previous||d.previous<=A)&&b||d.previous+d.next<=2*A}function E(d){d=String(d);var b=d.match(O);if(b&&b[1])return{integer:b[1].split("").length,fractional:b[3]?b[3].split("").length:0};if(d.toLowerCase().includes("e")&&(b=d.split("e"),
d=b[0],b=b[1],d&&b)){d=Number(d);b=Number(b);const n=0<b;n||(b=Math.abs(b));d=E(d);n?(d.integer+=b,d.fractional=b>d.fractional?0:d.fractional-b):(d.fractional+=b,d.integer=b>d.integer?1:d.integer-b);return d}return{integer:0,fractional:0}}function F(d,b,n,e){const A={previous:null,next:null};if(null!=n){const y=d-n;A.previous=Math.floor(Math.abs(100*(b-n-y)/y))}null!=e&&(d=e-d,A.next=Math.floor(Math.abs(100*(e-b-d)/d)));return A}const O=/^-?(\d+)(\.(\d+))?$/i,f={maximumFractionDigits:20};x.format=
function(d){return K.formatNumber(d,f)};x.numDigits=E;x.percentChange=F;x.round=function(d,b={}){d=d.slice(0);const {tolerance:n=2,strictBounds:e=!1,indexes:A=d.map((h,G)=>G)}=b;A.sort(w);for(b=0;b<A.length;b++){const h=A[b],G=d[h],l=0===h?null:d[h-1],g=h===d.length-1?null:d[h+1],m=E(G).fractional;if(m){let P=0,L=!1;for(var y=void 0;P<=m&&!L;)y=u(G,P),y=e&&0===b?y[1]:y[0],L=D(G,y,l,g,n),P++;L&&(d[h]=y)}}return d};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports",
"../../../renderers/support/HeatmapColorStop"],function(x,M){x.getHeatmapRampStops=function(K){if(!K.colorStops)return[];const w=[...K.colorStops].filter(D=>0<D.color?.a);let u=w.length-1;if(w&&w[0]){const D=w[u];D&&1!==D.ratio&&(w.push(new M({ratio:1,color:D.color})),u++)}return w.map((D,E)=>{let F="";0===E?F=K.legendOptions?.minLabel||"low":E===u&&(F=K.legendOptions?.maxLabel||"high");return{color:D.color,label:F,ratio:D.ratio}}).reverse()};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),function(x,M,K,w,u,D,E,F,O,f,d,b){function n(J,r){const H=J.length-1;return J.map((N,S)=>F.createStopLabel(N,S,H,r))}function e(J,r){J=J?.authoringInfo;
const H="univariate-color-size"===J?.type;let N=[12,30];if(H){const S=r[0],Y=r[r.length-1];N=r.map(W=>12+(W-S)/(Y-S)*18)}H&&"below"===J?.univariateTheme&&N.reverse();return N}function A(J,r){const H=J.classBreakInfos,N=H.length;r=2>N||!(2<=r)?H[0].symbol.clone():H[N-1].symbol.clone();J.visualVariables.some(S=>"color"===S.type)&&(r.type.includes("3d")?G(r):l(r));return r}async function y(J,r){if("flow"===J.type)return F.getSymbolForFlowRenderer(J,r);if("pie-chart"===J.type)return new d({color:null,
outline:J.outline?.width?J.outline:new b});let H=null,N=null;"simple"===J.type?H=J.symbol:"class-breaks"===J.type?(H=(J=J.classBreakInfos)&&J[0]&&J[0].symbol,N=1<J.length):"unique-value"===J.type&&(J=J.uniqueValueInfos,H=J?.[0]?.symbol,N=null!=J&&1<J.length);if(!H||h(H))return null;H=H.clone();if(r||N)H.type.includes("3d")?G(H):l(H);return H}function h(J){return J?w.isSymbol3D(J)?J.symbolLayers?J.symbolLayers.some(r=>r&&"fill"===r.type):!1:J.type.includes("fill"):!1}function G(J){"line-3d"===J.type?
J.symbolLayers.forEach(r=>{r.material={color:Q}}):J.symbolLayers.forEach(r=>{"icon"!==r.type||r.resource&&r.resource.href?r.material={color:q}:(r.material={color:p},r.outline={color:Q,size:1.5})})}function l(J){const r=f.isDarkTheme();if("cim"===J.type)D.applyCIMSymbolColor(J,new K(q));else if(J.type.includes("line"))J.color=Q;else if(J.color=r?Q:p,"simple-marker"===J.type)J.outline?"#ffffff"===J.outline?.color?.toHex()&&(J.outline.color=Q):J.outline={color:Q,width:1.5}}async function g(J,r,H,N){const S=
(await new Promise((k,B)=>x(["../../../renderers/visualVariables/support/visualVariableUtils"],k,B))).getSizeRangeAtScale(J,H,N),Y=S&&m(S);if(S&&Y){var W=Y.map(k=>{const B=S.minSize,C=S.maxSize,v=J.minDataValue,I=J.maxDataValue;return k<=B?v:k>=C?I:(k-B)/(C-B)*(I-v)+v});W=u.round(W);for(let k=1;k<W.length-1;k++){const B=await P(J,r,W[k],W[k-1],H,N);B&&(W[k]=B[0],Y[k]=B[1])}return W}}function m(J){const r=J.minSize;J=(J.maxSize-r)/4;const H=[];for(let N=0;5>N;N++)H.push(r+J*N);return H}async function P(J,
r,H,N,S,Y){const W=await L(J,r,H,S,Y);N=await L(J,r,N,S,Y);var k=u.numDigits(H),B=k.fractional,C=k.integer;let v=k=null;0<H&&1>H&&(k=10**B,H*=k,C=u.numDigits(H).integer);for(B=C-1;0<=B;B--){var I=10**B;C=Math.floor(H/I)*I;I*=Math.ceil(H/I);null!=k&&(C/=k,I/=k);let U=(C+I)/2;[,U]=u.round([C,U,I],{indexes:[1]});const X=await L(J,r,C,S,Y),ha=await L(J,r,I,S,Y),ca=await L(J,r,U,S,Y),la=u.percentChange(W,X,N,null),ma=u.percentChange(W,ha,N,null),fa=u.percentChange(W,ca,N,null);let Z=20>=la.previous,ia=
20>=ma.previous;Z&&ia&&(la.previous<=ma.previous?(Z=!0,ia=!1):(ia=!0,Z=!1));Z?v=[C,X]:ia?v=[I,ha]:20>=fa.previous&&(v=[U,ca]);if(v)break}return v}async function L(J,r,H,N,S){const {getSize:Y}=await new Promise((W,k)=>x(["../../../renderers/visualVariables/support/visualVariableUtils"],W,k));return Y(J,H,{scale:N,view:S,shape:"simple-marker"===r.type?r.style:null})}function c(J,r){J=J.clone();if(w.isSymbol3D(J))E.isVolumetricSymbol(J)||J.symbolLayers.forEach(H=>{"fill"!==H.type&&(H.size=r)});else if("esri.symbols.SimpleMarkerSymbol"===
J.declaredClass)J.size=r;else if("esri.symbols.PictureMarkerSymbol"===J.declaredClass){const H=J.width,N=J.height;J.height=r;J.width=H/N*r}else"esri.symbols.SimpleLineSymbol"===J.declaredClass?J.width=r:"esri.symbols.TextSymbol"===J.declaredClass&&J.font&&(J.font.size=r);return J}const p=[255,255,255],q=[200,200,200],Q=[128,128,128];M.REAL_WORLD_MAX_SIZE=30;M.REAL_WORLD_MIN_SIZE=12;M.getRampStops=async function(J,r,H,N,S,Y,W){var k=r.legendOptions;k=k&&k.customValues;const B=W||await y(J,H);H=r.stops;
var C=null!=r.minSize&&null!=r.maxSize;W=H&&1<H.length;var v=!!r.target;if(B&&(k||C||W&&!v)){var I=E.isVolumetricSymbol(B),U=!1,X=C=null;C=I&&!W?u.round([r.minDataValue,r.maxDataValue]):k??await g(r,B,N,S);k=J?.authoringInfo;var ha=(v="univariate-color-size"===k?.type)&&"above-and-below"===k?.univariateTheme;!C&&W&&(C=H.map(fa=>fa.value),U=H.some(fa=>!!fa.label),"flow"===J.type&&(C=u.round(C)),U&&(X=H.map(fa=>fa.label)));I&&null!=C&&2<C?.length&&!ha&&(C=[C[0],C[C.length-1]]);if(!C)return null;v&&
5!==C?.length&&(C=m({minSize:C[0],maxSize:C[C.length-1]}));var ca=I?e(J,C):null,la=E.getSymbolOutlineSize(B),ma=U?null:n(C,Y);return(await Promise.all(C.map(async(fa,Z)=>{const ia=I?ca[Z]:await L(r,B,fa,N,S),na=c(ha&&"class-breaks"===J.type?A(J,Z):B,ia);return{value:fa,symbol:na,label:U?X[Z]:ma[Z],size:ia,outlineSize:la}}))).reverse()}};Object.defineProperty(M,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../core/maybe ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),
function(x,M,K,w,u,D,E){x.formatDateLabel=function(F){return w.formatDate(new Date(F),D.timelineDateFormatOptions)};x.formatNumberLabel=function(F){const O=Math.floor(Math.log10(Math.abs(F)))+1;return u.formatNumber(F,{notation:1E6<=Math.abs(F)?"compact":"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>O||6<O?4:O})};x.getDeviationValues=function(F,O,f){if(K.isNone(O)||K.isNone(F))return[];const d=[];for(let b=-1*f;b<=f;b++)0!==b&&d.push(O+b*F);return d};x.getDynamicPathForSizeStops=
function(F){const {max:O,min:f,padding:d,pathHeight:b,pathWidth:n,stops:e}=F,A=O-f;let y=`M0 0 L${n} 0 `,h;F=3===e.length?[e[0],e[1],e[2]]:[e[0],e[2],e[4]];const G=Math.min.apply(Math,F.map(g=>g.size)),l=Math.max(Math.abs(F[0].size-F[1].size),Math.abs(F[2].size-F[1].size));F.reverse();F.forEach(({size:g,value:m},P)=>{m=Math.round(b-(m-f)/A*b);h=Math.round((g-G)/l*100)/100*n;0===h&&(h=d*n);0===P&&(y+=`L${h} 0 `);y+=`L${h} ${m} `});return y+=`L${h} ${b} L0 ${b} L0 0 Z`};x.getFillFromColor=function(F){return F instanceof
M?F.toCss(!0):M.fromString(F??"").toCss(!0)};x.getPathForSizeStops=function(F){const {bottomValue:O,bottomWidth:f,max:d,min:b,pathHeight:n,pathWidth:e,topValue:A,topWidth:y}=F;F=y*e;const h=f*e,G=d-b;return`M${F} 0 L${F} ${Math.round(n-(A-b)/G*n)} L${h} ${Math.round(n-(O-b)/G*n)} L${h} ${n} L0 ${n} L0 0 Z`};x.getSizesFromVariable=function(F){let O=F.maxSize;F=F.minSize;O instanceof E&&(O=O.stops[0].size);F instanceof E&&(F=F.stops[0].size);return[O,F]};x.getStopChanges=function(F,O,f){const d=f.length-
1;if(0>d)return[];const b=f[0],n=f[d]-b,e=O-F,A=[];for(let y=1;y<d;y++)A.push({index:y,value:(f[y]-b)/n*e+F});A.unshift({index:0,value:F});A.push({index:d,value:O});return A};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../core/maybe ../../intl/date ./numberUtils ../visualVariables/support/ColorStop ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),
function(x,M,K,w,u,D,E,F,O,f,d){async function b(l,g,m){w.getOrCreateMapValue(l,g,()=>[]).push(...m)}function n(l){let g=l.minValue,m=l.maxValue;const P=l.isFirstBreak?"":y.gt+" ";l="percent-of-total"===l.normalizationType?y.pct:"";g=null==g?"":E.format(g);m=null==m?"":E.format(m);return P+g+l+" "+y.ld+" "+m+l}function e(l,g){return"normalizationField"in l&&l.normalizationField?{type:"normalized-field",field:l.field,normalizationField:l.normalizationField}:"field"in l&&l.field?{type:"field",field:l.field}:
"valueExpression"in l&&l.valueExpression?{type:"expression",expression:l.valueExpression,title:l.valueExpressionTitle,returnType:g}:null}const A=K.getLogger("esri.renderers.support.utils"),y={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},h={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},G={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",
month:"long-month-day-year",year:"year"};K=D.convertDateFormatToIntlOptions("short-date");x.calculateDateFormatInterval=function(l){l=l.map(c=>new Date(c));const g=l.length;let m=Infinity,P=null;for(let c=0;c<g-1;c++){const p=l[c];let q=Infinity,Q=null;for(let J=c+1;J<g;J++){var L=l[J];L=p.getFullYear()!==L.getFullYear()&&"year"||p.getMonth()!==L.getMonth()&&"month"||p.getDate()!==L.getDate()&&"day"||p.getHours()!==L.getHours()&&"hour"||p.getMinutes()!==L.getMinutes()&&"minute"||p.getSeconds()!==
L.getSeconds()&&"second"||"millisecond";const r=h[L];r<q&&(q=r,Q=L)}q<m&&(m=q,P=Q)}return P};x.createClassBreakLabel=n;x.createColorStops=function(l){const {values:g,colors:m,labelIndexes:P,isDate:L,dateFormatOptions:c}=l;return g.map((p,q)=>{var Q=null;if(!P||P.includes(q)){let J;if(J=L?D.formatDate(p,c):E.format(p))Q="",0===q?Q=y.lt+" ":q===g.length-1&&(Q=y.gt+" "),Q+=J}return new F({value:p,color:m[q],label:Q})})};x.createUniqueValueLabel=function(l){const {value:g,domain:m,fieldInfo:P,dateFormatInterval:L}=
l;l=String(g);const c=m&&"codedValues"in m&&m.codedValues?m.getName(g):null;c?l=c:"number"===typeof g&&(l=P&&"date"===P.type?D.formatDate(g,L&&D.convertDateFormatToIntlOptions(G[L])):E.format(g));return l};x.getAttribute=e;x.getAttributes=function(l,g){const m=[];if("class-breaks"===l.type||"heatmap"===l.type)m.push(e(l,"number"));else if("unique-value"===l.type){var P=l.authoringInfo;if(P&&"relationship"===P.type){if(P.field1&&P.field2){var L=P.field2.field;const c=P.field2.normalizationField;m.push(e({field:P.field1.field,
normalizationField:P.field1.normalizationField}));m.push(e({field:L,normalizationField:c}))}}else L=l.uniqueValueInfos?.[0],P=null,L&&L.value&&(L=typeof l.uniqueValueInfos[0].value,"string"===L||"number"===L)&&(P=L),m.push(e(l,P)),[l.field2,l.field3].forEach(c=>c&&m.push({type:"field",field:c}))}else"attributes"in l&&l.attributes?.forEach(c=>m.push(e(c,"number")));(l=g?g(l):"visualVariables"in l?l.visualVariables:null)&&l.forEach(c=>m.push(e(c,"number")));return M.unique(m.filter(u.isSome),(c,p)=>
"field"===c.type&&"field"===p.type?c.field===p.field:"normalized-field"===c.type&&"normalized-field"===p.type?c.field===p.field&&c.normalizationField===p.normalizationField:"expression"===c.type&&"expression"===p.type?c.expression===p.expression:!1)};x.getColorsFromRenderer=async function(l){const g=new Map;if(!l)return g;if("visualVariables"in l&&l.visualVariables){var m=l.visualVariables.filter(L=>"color"===L.type);for(var P of m)m=(await f.getRampStops(P)??[]).map(L=>L.color),await b(g,P.field||
P.valueExpression,m)}if("heatmap"===l.type)P=d.getHeatmapRampStops(l).map(L=>L.color),await b(g,l.field||l.valueExpression,P);else if("pie-chart"===l.type){for(const L of l.attributes)await b(g,L.field||L.valueExpression,[L.color]);await b(g,"default",[l?.othersCategory?.color,O.getColorFromSymbol(l.backgroundFillSymbol,null)])}else if("dot-density"===l.type){for(const L of l.attributes)await b(g,L.field||L.valueExpression,[L.color]);await b(g,"default",[l.backgroundColor])}else if("unique-value"===
l.type)if("predominance"===l.authoringInfo?.type)for(const L of l.uniqueValueInfos??[])await b(g,L.value.toString(),[O.getColorFromSymbol(L.symbol,null)]);else{P=(l.uniqueValueInfos??[]).map(Q=>O.getColorFromSymbol(Q.symbol,null));const {field:L,field2:c,field3:p,valueExpression:q}=l;(L||q)&&await b(g,L||q,P);c&&await b(g,c,P);p&&await b(g,p,P)}else if("class-breaks"===l.type){P=l.classBreakInfos.map(p=>O.getColorFromSymbol(p.symbol,null));const {field:L,valueExpression:c}=l;await b(g,L??c,P)}else"simple"===
l.type&&await b(g,"default",[O.getColorFromSymbol(l.symbol,null)]);"defaultSymbol"in l&&l.defaultSymbol&&await b(g,"default",[O.getColorFromSymbol(l.defaultSymbol,null)]);g.forEach((L,c)=>{L=M.unique(L.filter(Boolean),(p,q)=>JSON.stringify(p)===JSON.stringify(q));g.set(c,L)});return g};x.setLabelsForClassBreaks=function(l){const g=l.classBreakInfos,m=l.normalizationType;let P=[];if(g&&g.length)if("standard-deviation"===l.classificationMethod)A.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(l.round){P.push(g[0].minValue);for(const L of g)P.push(L.maxValue);P=E.round(P);g.forEach((L,c)=>{L.label=n({minValue:0===c?P[0]:P[c],maxValue:P[c+1],isFirstBreak:0===c,normalizationType:m})})}else g.forEach((L,c)=>{L.label=n({minValue:L.minValue,maxValue:L.maxValue,isFirstBreak:0===c,normalizationType:m})})};x.timelineDateFormatOptions=K;Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./CardCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(x,M,K,w,u,D,E,F,O,f,d,b,n,e,A,y,h,G,l,g,m,P,L){var c;(function(q){q.Auto="auto";q.Stack="stack";q.SideBySide="side-by-side"})(c||(c={}));const p=window.devicePixelRatio;K=function(q){function Q(r,H){r=J.call(this,r,H);r._hasIndicators=!1;r._selectedSectionName=null;r._sectionNames=[];r._sectionMap=new Map;r.activeLayerInfos=null;r.headingLevel=3;r.layout=c.Stack;r.messages=null;r.messagesCommon=null;r.type="card";r.view=null;return r}x._inherits(Q,q);var J=x._createSuper(Q);q=Q.prototype;
q.initialize=function(){this.addHandles(w.watch(()=>this.activeLayerInfos,r=>{this.removeAllHandles();this._watchForSectionChanges(r)}))};q.render=function(){var {view:r}=this;this._hasIndicators=this.layout===c.Auto&&r&&768>=r.container.clientWidth||this.layout===c.Stack;r=(r=this.activeLayerInfos)&&r.toArray().map(S=>this._renderLegendForLayer(S)).filter(S=>!!S);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&
this._sectionNames[0]):this._selectedSectionName=null;const H=this._sectionNames.length;var N=this._sectionNames.map((S,Y)=>{Y=L.substitute(this.messagesCommon.pagination.pageText,{index:Y+1,total:H});return m.tsx("div",{key:S,role:"tab",id:S,"aria-label":Y,"aria-controls":`${S}-panel`,"aria-selected":(this._selectedSectionName===S).toString(),tabIndex:this._selectedSectionName===S?0:-1,title:Y,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes(e.CSS.indicator,{[e.CSS.activated]:this._selectedSectionName===
S}),"data-section-name":S})});N=this._hasIndicators&&1<H?m.tsx("div",{class:e.CSS.indicatorContainer,key:"carousel-navigation",role:"tablist"},N):null;r=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):r&&r.length?r:null;return m.tsx("div",{class:this.classes(e.CSS.base,{[e.CSS.stacked]:this._hasIndicators})},r||m.tsx("div",{class:e.CSS.message},this.messages.noLegend),N)};q._selectSection=function(r){if(r=r.target.getAttribute("data-section-name"))this._selectedSectionName=r};
q._focusSection=function(r){switch(r.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(r);break;case "Enter":case " ":this._selectSection(r)}};q._switchSectionOnArrowPress=function(r){const H=r.key,N="ArrowLeft"===H?-1:1;r=r.target.getAttribute("data-section-name");r=this._sectionNames.indexOf(r);const S=this._sectionNames;let Y=null;-1!==r&&(S[r+N]?Y=document.getElementById(S[r+N]):"ArrowLeft"===H?Y=document.getElementById(S[S.length-1]):"ArrowRight"===H&&(Y=document.getElementById(S[0])),
Y?.focus())};q._watchForSectionChanges=function(r){this._generateSectionNames();r&&(r.forEach(H=>{const N=`activeLayerInfo-${H.layer.uid}-version-change`;this.removeHandles(N);this._watchForSectionChanges(H.children);this.addHandles(w.watch(()=>H.version,()=>this._generateSectionNames()),N)}),this.removeHandles("activeLayerInfos-collection-change"),this.addHandles(r.on("change",()=>this._watchForSectionChanges(r)),"activeLayerInfos-collection-change"))};q._generateSectionNames=function(){this._sectionNames.length=
0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};q._getSectionName=function(r,H,N){return`${this.id}${r.uid}-type-${H.type}-${N}`};q._generateSectionNamesForActiveLayerInfo=function(r){r.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);r.legendElements&&r.legendElements.forEach((H,N)=>{this._sectionNames.push(this._getSectionName(r.layer,H,N))})};q._renderLegendForLayer=function(r){if(!r.ready)return null;
if(r.children.length){var H=r.children.map(S=>this._renderLegendForLayer(S)).toArray();return m.tsx("div",{key:r.layer.uid,class:this.classes(e.CSS.service,e.CSS.groupLayer)},m.tsx("div",{class:e.CSS.serviceCaptionContainer},r.title),H)}if((H=r.legendElements)&&!H.length)return null;const N=H.some(S=>"relationship-ramp"===S.type);H=H.map((S,Y)=>this._renderLegendForElement(S,r,Y,N)).filter(S=>!!S);return H.length?m.tsx("div",{key:r.layer.uid,class:this.classes(e.CSS.service,{[e.CSS.groupLayerChild]:!!r.parent})},
m.tsx("div",{class:e.CSS.serviceCaptionContainer},m.tsx("div",{class:e.CSS.serviceCaptionText},r.title)),m.tsx("div",{class:e.CSS.serviceContent},H)):null};q._renderLegendForElement=function(r,H,N,S=!1,Y=!1){var W="color-ramp"===r.type,k="opacity-ramp"===r.type,B="size-ramp"===r.type;const C=H.layer;var v=null;"string"===typeof r.title?v=r.title:r.title&&(v=r.title,W=h.getTitle(this.messages,v,W||k),v=v.title?`${v.title} (${W})`:W);N=this._getSectionName(C,r,N);W=this._hasIndicators&&!Y?m.tsx("div",
null,m.tsx(G.Heading,{level:this.headingLevel,class:e.CSS.carouselTitle},H.title),m.tsx(G.Heading,{level:G.incrementHeadingLevel(this.headingLevel),class:e.CSS.layerCaption},v)):v?m.tsx(G.Heading,{level:this.headingLevel,class:e.CSS.layerCaption},v):null;v=H.effectList;k=null;"symbol-table"===r.type?(B=r.infos.map((I,U)=>this._renderLegendForElementInfo(I,H,r.legendType,U)).filter(I=>!!I),B.length&&(k=m.tsx("div",{class:this.classes({[e.CSS.labelContainer]:!(B[0].properties.classes&&B[0].properties.classes[e.CSS.symbolRow])&&
!S,[e.CSS.relationshipLabelContainer]:S})},B))):"color-ramp"===r.type||"opacity-ramp"===r.type||"heatmap-ramp"===r.type?k=this._renderLegendForRamp(r,C.opacity,v):B?k=this._renderSizeRamp(r,C.opacity):"pie-chart-ramp"===r.type?k=this._renderPieChartRamp(r):"relationship-ramp"===r.type?k=A.renderRelationshipRamp(r,this.id,C.opacity,v):"univariate-above-and-below-ramp"===r.type?k=this._renderUnivariateAboveAndBelowRamp(r,C.opacity,v):"univariate-color-size-ramp"===r.type&&(k=this._renderUnivariateColorSizeRamp(r,
C.opacity,v));if(!k)return null;S=m.tsx("div",{key:N,class:e.CSS.section,id:`${N}-panel`,role:"tabpanel","aria-labelledby":N,tabIndex:0},[W,k]);Y||this._sectionMap.set(N,S);return S};q._renderPieChartRamp=function(r){return m.tsx("div",{class:e.CSS.pieChartRampPreview,bind:r.preview,afterCreate:h.attachToNode})};q._renderUnivariateAboveAndBelowRamp=function(r,H,N){const {sizeRampElement:S,colorRampElement:Y}=y.getUnivariateAboveAndBelowRampElements(r,H,"horizontal");if(!S)return null;r=y.getUnivariateSizeRampSize(S,
"full",!0,"horizontal");var W=y.getUnivariateColorRampSize(S,"above",!0,"horizontal"),k=y.getUnivariateColorRampSize(S,"below",!0,"horizontal");W=y.getUnivariateColorRampPreview(Y,{width:W,height:12,rampAlignment:"horizontal",opacity:H,type:"above",effectList:N});H=y.getUnivariateColorRampPreview(Y,{width:k,height:12,rampAlignment:"horizontal",opacity:H,type:"below",effectList:N});N=y.getUnivariateColorRampMargin(S,"card");k=S.infos.map(v=>v.label);const B=k.length-1;k=k.map((v,I)=>0===I||I===B?m.tsx("div",
{key:I},v):null);const C={marginTop:"3px",display:"flex"};P.isRTL(this.container)?C.marginRight=`${N}px`:C.marginLeft=`${N}px`;r={width:`${r}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return m.tsx("div",{class:e.CSS.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},m.tsx("div",{class:this.classes(e.CSS.symbolContainer,e.CSS.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},S.infos.map((v,I)=>m.tsx("div",{key:I,class:e.CSS.symbol,
bind:v.preview,afterCreate:h.attachToNode}))),W?m.tsx("div",{class:e.CSS.univariateAboveAndBelowColorRamp,styles:C,key:"color-ramp-preview"},m.tsx("div",{bind:W,afterCreate:h.attachToNode}),m.tsx("div",{bind:H,afterCreate:h.attachToNode})):null,m.tsx("div",{class:e.CSS.layerInfo},m.tsx("div",{class:e.CSS.rampLabelsContainer,styles:r},k)))};q._renderUnivariateColorSizeRamp=function(r,H,N){const {sizeRampElement:S,colorRampElement:Y}=y.getUnivariateColorSizeRampElements(r,"horizontal");if(!S)return null;
r=y.getUnivariateSizeRampSize(S,"full",!1,"horizontal");var W=y.getUnivariateColorRampSize(S,"full",!1,"horizontal");H=y.getUnivariateColorRampPreview(Y,{width:W,height:12,rampAlignment:"horizontal",opacity:H,type:"full",effectList:N});const k=y.getUnivariateColorRampMargin(S,"card"),B=S.infos.length-1;N=S.infos.map((C,v)=>0===v||v===B?m.tsx("div",{key:v},C.label):null);W={marginTop:"3px",display:"flex"};P.isRTL(this.container)?W.marginRight=`${k}px`:W.marginLeft=`${k}px`;r={width:`${r}px`,display:"flex",
flexDirection:"row",justifyContent:"space-between"};return m.tsx("div",{class:e.CSS.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},m.tsx("div",{class:this.classes(e.CSS.symbolContainer,e.CSS.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},S.infos.map((C,v)=>m.tsx("div",{key:v,class:e.CSS.symbol,bind:C.preview,afterCreate:h.attachToNode}))),m.tsx("div",{class:e.CSS.univariateAboveAndBelowColorRamp,styles:W,key:"color-ramp-preview"},m.tsx("div",{bind:H,
afterCreate:h.attachToNode})),m.tsx("div",{class:e.CSS.layerInfo},m.tsx("div",{class:e.CSS.rampLabelsContainer,styles:r},N)))};q._renderLegendForElementInfo=function(r,H,N,S){var Y=H.layer;if(r.type)return this._renderLegendForElement(r,H,S,!1,!0);N=h.isImageryStretchedLegend(Y,N);if(r.preview){if(!r.symbol||!r.symbol.type.includes("simple-fill")){if(!r.label)return m.tsx("div",{key:S,bind:r.preview,afterCreate:h.attachToNode});H={[e.CSS.symbolCell]:this._hasIndicators};return m.tsx("div",{key:S,
class:this.classes(e.CSS.layerRow,{[e.CSS.symbolRow]:this._hasIndicators})},m.tsx("div",{class:this.classes(H),bind:r.preview,afterCreate:h.attachToNode}),m.tsx("div",{class:this.classes(e.CSS.imageLabel,{[e.CSS.labelCell]:this._hasIndicators})},h.getTitle(this.messages,r.label,!1)||""))}let W=N=255,k=255,B=0,C=255,v=255,I=255,U=0;const X=r.symbol.color&&r.symbol.color.a,ha=r.symbol.outline&&r.symbol.outline.color&&r.symbol.outline.color.a;X&&(N=r.symbol.color.r,W=r.symbol.color.g,k=r.symbol.color.b,
B=r.symbol.color.a*Y.opacity);ha&&(C=r.symbol.outline.color.r,v=r.symbol.outline.color.g,I=r.symbol.outline.color.b,U=r.symbol.outline.color.a*Y.opacity);const ca=(Y=r.symbol.color?.isBright??!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";H={background:X?`rgba(${N}, ${W}, ${k}, ${B})`:"none",color:Y?"black":"white",textShadow:`-1px -1px 0 ${ca},\n                                              1px -1px 0 ${ca},\n                                              -1px 1px 0 ${ca},\n                                              1px 1px 0 ${ca}`,
border:ha?`1px solid rgba(${C}, ${v}, ${I}, ${U})`:"none",filter:b.getCSSFilterFromEffectList(H.effectList)??void 0};return m.tsx("div",{key:S,class:e.CSS.layerRow},m.tsx("div",{class:e.CSS.labelElement,styles:H}," ",r.label," "))}if(r.src)return H=this._renderImage(r,Y,N),m.tsx("div",{key:S,class:e.CSS.layerRow},H,m.tsx("div",{class:e.CSS.imageLabel},r.label||""))};q._renderImage=function(r,H,N){const {label:S,src:Y,opacity:W}=r;N={[e.CSS.imageryLayerStretchedImage]:N,[e.CSS.symbol]:!N};H={opacity:`${null!=
W?W:H.opacity}`};return m.tsx("img",{alt:h.getTitle(this.messages,S,!1),src:Y,border:0,width:r.width,height:r.height,class:this.classes(N),styles:H})};q._renderSizeRampLines=function(r){r=r.infos;var H=r[0],N=r[r.length-1],S=H.symbol;r=this._hasIndicators;H=u.pt2px(H.size+H.outlineSize)*p;N=u.pt2px(N.size+N.outlineSize)*p;const Y=r?H:H+50*p,W=r?H/2+50*p:H;var k;S?S.type.includes("3d")?(k=S.symbolLayers&&S.symbolLayers.length)?(k=S.symbolLayers.getItemAt(k-1).get("resource.primitive"),k="triangle"===
k||"cone"===k||"tetrahedron"===k):k=void 0:k="triangle"===S.style:k=void 0;if(S)if(S.type.includes("3d")){var B=S.symbolLayers&&S.symbolLayers.length;B?(S=S.symbolLayers.getItemAt(B-1),S=S.resource&&S.resource.primitive,S="circle"===S||"cross"===S||"kite"===S||"sphere"===S||"cube"===S||"diamond"===S):S=void 0}else S=S.style,S="circle"===S||"diamond"===S||"cross"===S;else S=void 0;B=document.createElement("canvas");B.width=Y;B.height=W;B.style.width=`${B.width/p}px`;B.style.height=`${B.height/p}px`;
const C=B.getContext("2d");if(r){C.beginPath();var v=Y/2-N/2;C.moveTo(0,0);C.lineTo(v,W);v=Y/2+N/2;C.moveTo(Y,0);C.lineTo(v,W)}else C.beginPath(),C.moveTo(0,W/2-N/2),C.lineTo(Y,0),C.moveTo(0,W/2+N/2),C.lineTo(Y,W);C.strokeStyle="#ddd";C.stroke();return m.tsx("div",{bind:B,afterCreate:h.attachToNode,styles:r?{display:"flex",marginTop:`-${k?0:S?H/2:0}px`,marginBottom:`-${k?N:S?N/2:0}px`}:{display:"flex",marginRight:`-${k?0:S?H/2:0}px`,marginLeft:`-${k?0:S?N/2:0}px`}})};q._renderSizeRamp=function(r,
H){var N=r.infos;const S=N[0].label,Y=N[N.length-1].label;let W=N[0].preview;N=N[N.length-1].preview;const k=this._hasIndicators,B={"flex-direction":k?"column":"row-reverse"};W&&(W=W.cloneNode(!0),W.style.display="flex");N&&(N=N.cloneNode(!0),N.style.display="flex");H={opacity:null!=H?`${H}`:""};return m.tsx("div",{class:this.classes(e.CSS.layerRow,{[e.CSS.sizeRampRow]:k})},m.tsx("div",{class:e.CSS.rampLabel},k?S:Y),m.tsx("div",{class:e.CSS.sizeRampContainer,styles:B},m.tsx("div",{bind:W,afterCreate:h.attachToNode,
class:e.CSS.sizeRampPreview,styles:H}),this._renderSizeRampLines(r),m.tsx("div",{bind:N,afterCreate:h.attachToNode,class:e.CSS.sizeRampContainer,styles:H})),m.tsx("div",{class:e.CSS.rampLabel},k?Y:S))};q._renderLegendForRamp=function(r,H,N){var S=r.infos;const Y="heatmap-ramp"===r.type,W=S.length-1;var k=2<W&&!Y?25*W:100,B=k+20;const C=S.slice(0).reverse();C.forEach((U,X)=>{U.offset=Y?U.ratio:X/W});const v=C.length-1;r=(r=0!==C.length%2&&C[C.length/2|0])&&m.tsx("div",{class:e.CSS.intervalSeparatorsContainer},
m.tsx("div",{class:e.CSS.intervalSeparator},"|"),m.tsx("div",{class:e.CSS.rampLabel},r.label));const I=S[S.length-1].label;S=S[0].label;k=d.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:C[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:k,height:25},fill:{type:"linear",x1:10,y1:0,x2:k+10,y2:0,colors:C},stroke:{width:0}},{shape:{type:"path",path:`M${k+10} 0 L${B} ${12.5} L${k+10} ${25} Z`},fill:C[v].color,stroke:{width:0}}]],B,25);({messages:B}=this);H={filter:b.getCSSFilterFromEffectList(N)??
void 0,opacity:null==H?void 0:`${H}`};return m.tsx("div",{class:e.CSS.layerRow,styles:{justifyContent:"center"}},m.tsx("div",{class:e.CSS.rampLabel},Y?B[I]:I),m.tsx("div",{class:e.CSS.symbolContainer},m.tsx("div",{styles:H},k),r),m.tsx("div",{class:e.CSS.rampLabel},Y?B[S]:S))};return x._createClass(Q)}(n);M.__decorate([D.property()],K.prototype,"activeLayerInfos",void 0);M.__decorate([D.property()],K.prototype,"headingLevel",void 0);M.__decorate([D.property()],K.prototype,"layout",void 0);M.__decorate([D.property(),
g.messageBundle("esri/widgets/Legend/t9n/Legend")],K.prototype,"messages",void 0);M.__decorate([D.property(),g.messageBundle("esri/t9n/common")],K.prototype,"messagesCommon",void 0);M.__decorate([D.property({readOnly:!0})],K.prototype,"type",void 0);M.__decorate([D.property()],K.prototype,"view",void 0);M.__decorate([l.accessibleHandler()],K.prototype,"_selectSection",null);return K=M.__decorate([f.subclass("esri.widgets.Legend.styles.Card")],K)})},"esri/widgets/Legend/styles/CardCSS":function(){define(["exports"],
function(x){x.CSS={activated:"esri-legend--card__carousel-indicator--activated",base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",
layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",
symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",
symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card",
hidden:"esri-hidden"};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),function(x,M,K,w,u,D,E){function F(e="vertical"){return"vertical"===e?E.tsx("svg",{height:"4",width:"10"},E.tsx("line",{x1:"0",
y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):E.tsx("svg",{height:"10",width:"10"},E.tsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function O(e,A="vertical"){const y=document.createElement("div");y.style.height="20px";y.className=n.univariateAboveAndBelowSymbol;null!=e&&(y.style.opacity=e.toString());b.append(y,F.bind(null,A));return y}function f(e,A,y="vertical",h){e.infos.forEach((G,l)=>{if(h&&2===l)G.preview=O(A,y);else{l=
M.pt2px(G.size)+("horizontal"===y?20:10);const g=G.preview,m="div"===g?.tagName.toLowerCase(),P=m?g:document.createElement("div");P.className=n.univariateAboveAndBelowSymbol;"horizontal"===y?P.style.width=`${l}px`:P.style.height=`${l}px`;!m&&g&&P.appendChild(g);G.preview=P}})}function d(e,A,y,h="vertical"){let G=0;e=e.infos;const l=Math.floor(e.length/2);var g="full"===A||"above"===A?0:l;for(A="full"===A||"below"===A?e.length-1:l;g<=A;g++)if(y&&g===l)G+="horizontal"===h?10:20;else{const m=M.pt2px(e[g].size)+
("horizontal"===h?20:10);G+=m}return Math.round(G)}const b=w.createProjector(),n={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};x.getUnivariateAboveAndBelowRampElements=function(e,A,y="vertical"){var h=e.infos;e=h.find(({type:G})=>"size-ramp"===G);h=h.find(({type:G})=>"color-ramp"===G);e&&(e={...e},e.infos=[...e.infos],f(e,A,y,!0));h&&(h={...h},h.infos=[...h.infos]);"horizontal"===y&&(e?.infos.reverse(),h?.infos.reverse());return{sizeRampElement:e,
colorRampElement:h}};x.getUnivariateColorRampMargin=function(e,A="classic"){e=e.infos;return"classic"===A?(M.pt2px(e[0].size)+10)/2:(M.pt2px(e[0].size)-M.pt2px(e[e.length-1].size))/2};x.getUnivariateColorRampPreview=function(e,A){if(!e)return null;e=e.infos.map(y=>y.color);e=u.renderColorRampPreviewHTML("full"===A.type?e:"above"===A.type?e.slice(0,3):e.slice(2,5),{width:A.width,height:A.height,align:A.rampAlignment,effectList:A.effectList});e.className=n.colorRamp;null!=A.opacity&&(e.style.opacity=
A.opacity.toString());return e};x.getUnivariateColorRampSize=function(e,A,y,h="vertical"){const G=d(e,A,y,h);e=e.infos;var l=Math.floor(e.length/2);const g="full"===A||"above"===A?0:l;l="full"===A||"below"===A?e.length-1:l;y=y?"vertical"===h?20:10:0;h="vertical"===h?10*("full"===A?2:1):20*("full"===A?2:1);return Math.round(G-(M.pt2px("full"===A?e[g].size+e[l].size:"above"===A?e[g].size:e[l].size)/2+y/2+h/2))};x.getUnivariateColorSizeRampElements=function(e,A="vertical"){var y=e.infos;e=y.find(({type:h})=>
"size-ramp"===h);y=y.find(({type:h})=>"color-ramp"===h);e&&(e={...e},e.infos=[...e.infos],f(e,null,A,!1));y&&(y={...y},y.infos=[...y.infos]);"horizontal"===A&&(e?.infos.reverse(),y?.infos.reverse());return{sizeRampElement:e,colorRampElement:y}};x.getUnivariateSizeRampSize=d;Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../intl/substitute"],function(x,M,K){x.attachToNode=function(w){w.appendChild(this)};
x.getTitle=function(w,u,D){if(u){if("string"===typeof u||"number"===typeof u)return u;if("value"in u||"unit"in u)return K.substitute(w.dotValue,u);if("colorName"in u&&"bandName"in u)return w[u.colorName]+": "+(w[u.bandName]||u.bandName);if("showCount"in u)return u.showCount?w.clusterCountTitle:void 0;var E=null;D?E=u.ratioPercentTotal?"showRatioPercentTotal":u.ratioPercent?"showRatioPercent":u.ratio?"showRatio":u.normField?"showNormField":u.field?"showField":null:D||(E=u.normField?"showNormField":
u.normByPct?"showNormPct":u.field?"showField":null);return E?K.substitute("showField"===E?"{field}":w[E],{field:u.field,normField:u.normField}):void 0}};x.isImageryStretchedLegend=function(w,u){return!!(u&&"Stretched"===u&&10.3<=w.version&&"esri.layers.ImageryLayer"===w.declaredClass)};x.isRendererTitle=function(w,u){return!u};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./widgetUtils","./jsxFactory"],
function(x,M,K,w){const u={heading:"esri-widget__heading"};x.CSS=u;x.Heading=function({level:D,class:E,...F},O){D=M.clamp(Math.ceil(D),1,6);return w.tsx(`h${D}`,{...F,class:K.classes(u.heading,E),role:"heading","aria-level":String(D)},O)};x.incrementHeadingLevel=function(D,E=1){return M.clamp(Math.ceil(D+E),1,6)};Object.defineProperty(x,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../intl ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory ../../../intl/number".split(" "),
function(x,M,K,w,u,D,E,F,O,f,d,b,n,e,A,y,h,G){const l=`${f.LEGEND}__`,g={display:"flex",alignItems:"flex-start"},m={marginLeft:"3px"},P={display:"table-cell",verticalAlign:"middle"};K=function(L){function c(q,Q){q=p.call(this,q,Q);q.activeLayerInfos=null;q.headingLevel=3;q.messages=null;q.type="classic";return q}x._inherits(c,L);var p=x._createSuper(c);L=c.prototype;L.render=function(){var q=this.activeLayerInfos;q=q&&q.toArray().map(Q=>this._renderLegendForLayer(Q)).filter(Q=>!!Q);return h.tsx("div",
null,q&&q.length?q:h.tsx("div",{class:f.CSS.message},this.messages.noLegend))};L._renderLegendForLayer=function(q){if(!q.ready)return null;var Q=!!q.children.length;const J=`${l}${q.layer.uid}-version-${q.version}`,r=q.title?e.Heading({level:this.headingLevel,class:this.classes(f.CSS.header,f.CSS.label)},q.title):null;if(Q)return Q=q.children.map(H=>this._renderLegendForLayer(H)).toArray(),h.tsx("div",{key:J,class:this.classes(f.CSS.service,f.CSS.groupLayer)},r,Q);if((Q=q.legendElements)&&!Q.length)return null;
Q=Q.map(H=>this._renderLegendForElement(H,q.layer,q.effectList)).filter(H=>!!H);return Q.length?h.tsx("div",{key:J,class:this.classes(f.CSS.service,{[f.CSS.groupLayerChild]:!!q.parent}),tabIndex:0},r,h.tsx("div",{class:f.CSS.layer},Q)):null};L._renderLegendForElement=function(q,Q,J,r){var H="color-ramp"===q.type,N="opacity-ramp"===q.type;const S="size-ramp"===q.type;let Y=null;if("symbol-table"===q.type||S){var W=q.infos.map(B=>this._renderLegendForElementInfo(B,Q,J,S,q.legendType)).filter(B=>!!B);
W.length&&(Y=h.tsx("div",{class:f.CSS.layerBody},W))}else"color-ramp"===q.type||"opacity-ramp"===q.type||"heatmap-ramp"===q.type||"stretch-ramp"===q.type?Y=this._renderLegendForRamp(q,Q.opacity):"relationship-ramp"===q.type?Y=d.renderRelationshipRamp(q,this.id,Q.opacity,J):"pie-chart-ramp"===q.type?Y=this._renderPieChartRamp(q):"univariate-above-and-below-ramp"===q.type?Y=this._renderUnivariateAboveAndBelowRamp(q,Q.opacity,J):"univariate-color-size-ramp"===q.type&&(Y=this._renderUnivariateColorSizeRamp(q,
Q.opacity,J));if(!Y)return null;W=q.title;var k=null;"string"===typeof W?k=W:W&&(k=n.getTitle(this.messages,W,H||N),k=n.isRendererTitle(W,H||N)&&W.title?`${W.title} (${k})`:k);H=r?f.CSS.layerChildTable:f.CSS.layerTable;N=k?h.tsx("div",{class:f.CSS.layerCaption},k):null;return h.tsx("div",{class:this.classes(H,{[f.CSS.layerTableSizeRamp]:S||!r})},N,Y)};L._renderPieChartRamp=function(q){return h.tsx("div",{bind:q.preview,afterCreate:n.attachToNode})};L._renderUnivariateAboveAndBelowRamp=function(q,
Q,J){const {sizeRampElement:r,colorRampElement:H}=b.getUnivariateAboveAndBelowRampElements(q,Q);if(!r)return null;var N=b.getUnivariateColorRampSize(r,"above",!0);q=b.getUnivariateColorRampSize(r,"below",!0);const S=b.getUnivariateColorRampPreview(H,{width:12,height:N,rampAlignment:"vertical",opacity:Q,type:"above",effectList:J});Q=b.getUnivariateColorRampPreview(H,{width:12,height:q,rampAlignment:"vertical",opacity:Q,type:"below",effectList:J});var Y=b.getUnivariateColorRampMargin(r);const W=r.infos.map(I=>
I.label);J=W.map((I,U)=>{const X=2===U;return 0===U?h.tsx("div",{key:U,class:I?S?f.CSS.univariateAboveAndBelowLabel:f.CSS.rampLabel:void 0},I):X?h.tsx("div",null):null});const k=W.length-1,B=Math.floor(W.length/2),C=W.map((I,U)=>{const X=U===k;return U===B||X?h.tsx("div",{key:U,class:I?S?f.CSS.univariateAboveAndBelowLabel:f.CSS.rampLabel:void 0},I):null}),v={display:"table-cell",verticalAlign:"middle"};Y={marginTop:`${Y}px`};N={height:`${N}px`};q={height:`${q}px`};return h.tsx("div",{key:"univariate-above-and-below-ramp-preview",
styles:g},h.tsx("div",{class:f.CSS.layerBody},r.infos.map((I,U)=>h.tsx("div",{class:this.classes(f.CSS.layerRow,f.CSS.sizeRamp)},h.tsx("div",{class:f.CSS.symbol,styles:v,bind:I.preview,afterCreate:n.attachToNode}),S||0!==U%2?null:h.tsx("div",{class:f.CSS.layerInfo},W[U])))),S?h.tsx("div",{styles:Y,key:"color-ramp-preview"},h.tsx("div",{styles:m},h.tsx("div",{styles:P},h.tsx("div",{class:f.CSS.rampContainer,bind:S,afterCreate:n.attachToNode})),h.tsx("div",{styles:P},h.tsx("div",{class:f.CSS.rampLabelsContainer,
styles:N},J))),h.tsx("div",{styles:m},h.tsx("div",{styles:P},h.tsx("div",{class:f.CSS.rampContainer,bind:Q,afterCreate:n.attachToNode})),h.tsx("div",{styles:P},h.tsx("div",{class:f.CSS.rampLabelsContainer,styles:q},C)))):null)};L._renderUnivariateColorSizeRamp=function(q,Q,J){const {sizeRampElement:r,colorRampElement:H}=b.getUnivariateColorSizeRampElements(q);if(!r)return null;var N=b.getUnivariateColorRampMargin(r);q=b.getUnivariateColorRampSize(r,"full",!1);Q=b.getUnivariateColorRampPreview(H,{width:12,
height:q,rampAlignment:"vertical",opacity:Q,type:"full",effectList:J});const S=r.infos.length-1;J=r.infos.map((W,k)=>0===k||k===S?h.tsx("div",{key:k,class:W.label?H?f.CSS.univariateAboveAndBelowLabel:f.CSS.rampLabel:void 0},W.label):null);const Y={display:"table-cell",verticalAlign:"middle"};N={marginTop:`${N}px`};q={height:`${q}px`};return h.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:g},h.tsx("div",{class:f.CSS.layerBody},r.infos.map(W=>h.tsx("div",{class:this.classes(f.CSS.layerRow,
f.CSS.sizeRamp)},h.tsx("div",{class:f.CSS.symbol,styles:Y,bind:W.preview,afterCreate:n.attachToNode})))),h.tsx("div",{styles:N,key:"color-ramp-preview"},h.tsx("div",{styles:m},h.tsx("div",{styles:P},h.tsx("div",{class:f.CSS.rampContainer,bind:Q,afterCreate:n.attachToNode})),h.tsx("div",{styles:P},h.tsx("div",{class:f.CSS.rampLabelsContainer,styles:q},J)))))};L._renderLegendForRamp=function(q,Q){const J=q.infos,r="heatmap-ramp"===q.type,H="stretch-ramp"===q.type,N=q.preview;N.className=`${f.CSS.colorRamp} ${"opacity-ramp"===
q.type?f.CSS.opacityRamp:""}`;null!=Q&&(N.style.opacity=Q.toString());q=J.map(S=>h.tsx("div",{class:S.label?f.CSS.rampLabel:void 0},r?this.messages[S.label]||S.label:H?this._getStretchStopLabel(S):S.label));Q={height:N.style.height};return h.tsx("div",{class:f.CSS.layerRow},h.tsx("div",{class:f.CSS.symbolContainer,styles:{width:"24px"}},h.tsx("div",{class:f.CSS.rampContainer,bind:N,afterCreate:n.attachToNode})),h.tsx("div",{class:f.CSS.layerInfo},h.tsx("div",{class:f.CSS.rampLabelsContainer,styles:Q},
q)))};L._getStretchStopLabel=function(q){return q.label?this.messages[q.label]+": "+("string"===typeof q.value?q.value:G.formatNumber(q.value,{style:"decimal",notation:q.value.toString().includes("e")?"scientific":"standard"})):""};L._renderLegendForElementInfo=function(q,Q,J,r,H){if(q.type)return this._renderLegendForElement(q,Q,J,!0);J=null;H=n.isImageryStretchedLegend(Q,H);q.preview?J=h.tsx("div",{class:f.CSS.symbol,bind:q.preview,afterCreate:n.attachToNode}):q.src&&(J=this._renderImage(q,Q,H));
if(!J)return null;Q={[f.CSS.imageryLayerInfoStretched]:H};return h.tsx("div",{class:f.CSS.layerRow},h.tsx("div",{class:this.classes(f.CSS.symbolContainer,{[f.CSS.imageryLayerInfoStretched]:H,[f.CSS.sizeRamp]:!H&&r})},J),h.tsx("div",{class:this.classes(f.CSS.layerInfo,Q)},n.getTitle(this.messages,q.label,!1)||""))};L._renderImage=function(q,Q,J){const {label:r,src:H,opacity:N}=q;J={[f.CSS.imageryLayerStretchedImage]:J,[f.CSS.symbol]:!J};Q={opacity:`${null!=N?N:Q.opacity}`};return h.tsx("img",{alt:n.getTitle(this.messages,
r,!1),src:H,border:0,width:q.width,height:q.height,class:this.classes(J),styles:Q})};return x._createClass(c)}(O);M.__decorate([w.property()],K.prototype,"activeLayerInfos",void 0);M.__decorate([w.property()],K.prototype,"headingLevel",void 0);M.__decorate([w.property(),y.messageBundle("esri/widgets/Legend/t9n/Legend")],K.prototype,"messages",void 0);M.__decorate([w.property({readOnly:!0})],K.prototype,"type",void 0);return K=M.__decorate([F.subclass("esri.widgets.Legend.styles.Classic")],K)})},"esri/widgets/Legend/styles/ClassicCSS":function(){define(["exports"],
function(x){x.CSS={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",
imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",
rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label",message:"esri-legend__message",header:"esri-widget__heading",hidden:"esri-hidden"};x.LEGEND="esri-legend";Object.defineProperty(x,Symbol.toStringTag,
{value:"Module"})})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(x,M,K,w,u,D,E,F,O,f,d,b,n,e,A){D=function(y){function h(l,g){l=G.call(this,l,g);
l.headingLevel=3;l.iconClass="esri-icon-layer-list";l.messages=null;l.style=new b;l.viewModel=new f;return l}x._inherits(h,y);var G=x._createSuper(h);y=h.prototype;y.initialize=function(){this.addHandles([K.on(()=>this.view,"resize",()=>this.scheduleRender()),K.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),K.watch(()=>this.headingLevel,l=>{const {style:g}=this;g&&(g.headingLevel=l)}),K.watch(()=>this.style,(l,g)=>{g&&l!==g&&g.destroy();l&&(l.activeLayerInfos=
this.activeLayerInfos,"card"===l.type&&(l.view=this.view),l.headingLevel=this.headingLevel)},K.initial)])};y.castStyle=function(l){if(l instanceof d||l instanceof b)return l;if("string"===typeof l)return"card"===l?new d:new b;if(l&&"string"===typeof l.type){const g={...l};delete g.type;return new ("card"===l.type?d:b)(g)}return new b};y.render=function(){return A.tsx("div",{class:this.classes("esri-legend","esri-widget",this.style instanceof b?"esri-widget--panel":null)},this.style.render())};y._refreshActiveLayerInfos=
function(l){this.removeAllHandles();l.forEach(g=>this._renderOnActiveLayerInfoChange(g));this.scheduleRender()};y._renderOnActiveLayerInfoChange=function(l){var g=K.watch(()=>l.version,()=>this.scheduleRender());this.addHandles(g,`version_${l.layer.uid}`);g=K.on(()=>l.children,"change",()=>l.children.forEach(m=>this._renderOnActiveLayerInfoChange(m)),K.initial);this.addHandles(g,`children_${l.layer.uid}`);l.children.forEach(m=>this._renderOnActiveLayerInfoChange(m))};x._createClass(h,[{key:"activeLayerInfos",
get:function(){return this.viewModel.activeLayerInfos},set:function(l){this.viewModel.activeLayerInfos=l}},{key:"basemapLegendVisible",get:function(){return this.viewModel.basemapLegendVisible},set:function(l){this.viewModel.basemapLegendVisible=l}},{key:"groundLegendVisible",get:function(){return this.viewModel.groundLegendVisible},set:function(l){this.viewModel.groundLegendVisible=l}},{key:"hideLayersNotInCurrentView",get:function(){return this.viewModel.hideLayersNotInCurrentView},set:function(l){this.viewModel.hideLayersNotInCurrentView=
l}},{key:"keepCacheOnDestroy",get:function(){return this.viewModel.keepCacheOnDestroy},set:function(l){this.viewModel.keepCacheOnDestroy=l}},{key:"respectLayerVisibility",get:function(){return this.viewModel.respectLayerVisibility},set:function(l){this.viewModel.respectLayerVisibility=l}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(l){this._overrideIfSome("label",l)}},{key:"layerInfos",get:function(){return this.viewModel.layerInfos},set:function(l){this.viewModel.layerInfos=
l}},{key:"view",get:function(){return this.viewModel.view},set:function(l){this.viewModel.view=l}}]);return h}(O);M.__decorate([w.property()],D.prototype,"activeLayerInfos",null);M.__decorate([w.property()],D.prototype,"basemapLegendVisible",null);M.__decorate([w.property()],D.prototype,"groundLegendVisible",null);M.__decorate([w.property()],D.prototype,"headingLevel",void 0);M.__decorate([w.property()],D.prototype,"hideLayersNotInCurrentView",null);M.__decorate([w.property()],D.prototype,"keepCacheOnDestroy",
null);M.__decorate([w.property()],D.prototype,"respectLayerVisibility",null);M.__decorate([w.property()],D.prototype,"iconClass",void 0);M.__decorate([w.property()],D.prototype,"label",null);M.__decorate([w.property()],D.prototype,"layerInfos",null);M.__decorate([w.property(),e.messageBundle("esri/widgets/Legend/t9n/Legend")],D.prototype,"messages",void 0);M.__decorate([w.property()],D.prototype,"style",void 0);M.__decorate([u.cast("style")],D.prototype,"castStyle",null);M.__decorate([w.property()],
D.prototype,"view",null);M.__decorate([w.property()],D.prototype,"viewModel",void 0);return D=M.__decorate([F.subclass("esri.widgets.Legend")],D)});