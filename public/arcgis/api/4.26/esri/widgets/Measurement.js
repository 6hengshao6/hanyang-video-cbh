// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Measurement/MeasurementViewModel ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(q,t,e,w,u,g,c,C,D,x,y,v,E,z,A){const r=b=>Object.freeze(Object.defineProperty({__proto__:null,
default:b},Symbol.toStringTag,{value:"Module"}));c=function(b){function n(a,f){a=B.call(this,a,f);a._widgets=new Map;a.activeWidget=null;a.iconClass="esri-icon-measure";a.messages=null;a.viewModel=new v;return a}t._inherits(n,b);var B=t._createSuper(n);b=n.prototype;b.initialize=function(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel);this.view&&this.activeTool&&this._getActiveWidget().then(a=>{this._set("activeWidget",a)});this.addHandles([u.watch(()=>[this.view,
this.activeTool],async()=>{this._set("activeWidget",await this._getActiveWidget())}),u.watch(()=>this.activeWidget,(a,f)=>{this.viewModel.set("activeViewModel",a?a.viewModel:null);f&&(f.visible=!1)}),u.watch(()=>[this.areaUnit,this.linearUnit,this.uiStrings],()=>this._updateSubWidgetProperties())])};b.destroy=function(){this._destroyWidgets()};b.render=function(){var {activeWidget:a}=this;a=a&&!a.destroyed?a.render():null;return A.tsx("div",{class:"esri-measurement"},a)};b.clear=function(){this.activeTool=
null;this._destroyWidgets()};b.startMeasurement=function(){const {activeViewModel:a}=this.viewModel;a&&w.ignoreAbortErrors(a.start())};b._createWidget=async function(a){const {areaUnit:f,linearUnit:d,view:h}=this;if(!h)return null;switch(a){case "area":var {type:p}=h;switch(p){case "2d":return new (await new Promise((k,l)=>q(["./AreaMeasurement2D"],m=>k(r(m)),l))).default({view:h,unit:f,uiStrings:this._createUIStringsForWidget(a)});case "3d":return new (await new Promise((k,l)=>q(["./AreaMeasurement3D"],
m=>k(r(m)),l))).default({view:h,unit:f,uiStrings:this._createUIStringsForWidget(a)});default:return null}case "distance":switch({type:p}=h,p){case "2d":return new (await new Promise((k,l)=>q(["./DistanceMeasurement2D"],m=>k(r(m)),l))).default({view:h,unit:d,uiStrings:this._createUIStringsForWidget(a)});default:return null}case "direct-line":switch({type:p}=h,p){case "3d":return new (await new Promise((k,l)=>q(["./DirectLineMeasurement3D"],m=>k(r(m)),l))).default({view:h,unit:d,uiStrings:this._createUIStringsForWidget(a)});
default:return null}default:return null}};b._destroyWidgets=function(){this._widgets.forEach(a=>a.destroy());this._widgets.clear()};b._getActiveWidget=async function(){const {activeTool:a,view:f}=this;if(!f||!a)return null;let d=null;if(this._widgets.has(a))d=this._widgets.get(a),d.visible=!0;else{d=await this._createWidget(a);if(!d)return null;await d.viewModel.start();this._widgets.set(a,d)}return d};b._createUIStringsForWidget=function(a){if(this.uiStrings)return this.uiStrings[a+"-"+this.view?.type]};
b._updateSubWidgetProperties=function(){this._widgets.forEach((a,f)=>{const {areaUnit:d,linearUnit:h}=this;a.unit="esri.widgets.AreaMeasurement2D"===a?.declaredClass||"esri.widgets.AreaMeasurement3D"===a?.declaredClass?d:h;a.uiStrings=this._createUIStringsForWidget(f)})};t._createClass(n,[{key:"activeTool",get:function(){return this.viewModel.activeTool},set:function(a){this.viewModel.activeTool=a}},{key:"areaUnit",get:function(){return this.viewModel.areaUnit},set:function(a){this.viewModel.areaUnit=
a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"linearUnit",get:function(){return this.viewModel.linearUnit},set:function(a){this.viewModel.linearUnit=a}},{key:"view",get:function(){return this.viewModel.view},set:function(a){this.viewModel.view=a}}]);return n}(y);e.__decorate([g.property()],c.prototype,"activeTool",null);e.__decorate([g.property({readOnly:!0})],c.prototype,"activeWidget",void 0);e.__decorate([g.property()],
c.prototype,"areaUnit",null);e.__decorate([g.property()],c.prototype,"iconClass",void 0);e.__decorate([g.property()],c.prototype,"label",null);e.__decorate([g.property()],c.prototype,"linearUnit",null);e.__decorate([g.property(),z.messageBundle("esri/widgets/Measurement/t9n/Measurement")],c.prototype,"messages",void 0);e.__decorate([g.property()],c.prototype,"uiStrings",void 0);e.__decorate([g.property()],c.prototype,"view",null);e.__decorate([g.property({type:v})],c.prototype,"viewModel",void 0);
return c=e.__decorate([x.subclass("esri.widgets.Measurement")],c)});