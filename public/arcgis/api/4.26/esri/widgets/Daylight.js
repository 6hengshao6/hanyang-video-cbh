// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("require ../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/Logger ../core/maybe ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Daylight/css ./Daylight/DaylightViewModel ./Daylight/VisibleElements ./Daylight/support/daylightUtils ./Daylight/support/SliderWithDropdown ./support/componentsUtils ./support/DatePicker ./support/Heading ./support/timeWidgetUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(r,n,g,A,u,h,k,f,K,L,B,C,d,v,w,D,E,F,G,H,I,M,x,l){const y=/(.*)\s(.*)/;f=function(e){function p(a,c){var b=J.call(this,a,c);b.headingLevel=3;b.iconClass=d.CSS.widgetIcon;b.viewModel=new v;b.visibleElements=new w;b.dateOrSeason="date";b._timeSlider=new E({viewModel:b.viewModel.timeSliderViewModel,steps:b.timeSliderSteps,labelInputsEnabled:!1,visibleElements:{labels:!0},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:b._onPrimaryTickCreated.bind(n._assertThisInitialized(b))},
{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:b._onSecondaryTickCreated.bind(n._assertThisInitialized(b))}],items:[]});b._datePicker=new G({viewModel:b.viewModel.datePickerViewModel,commitOnMonthChange:!0});b._onPlayDayClick=()=>{b.viewModel.toggleDayPlaying()};b._onYearPlayClick=()=>{b.viewModel.toggleYearPlaying()};b._onSeasonChange=m=>{b.viewModel.currentSeason=m.target.value};b._onSunLightingCheckboxChange=()=>{b.viewModel.toggleSunLightingEnabled()};b._onShadowCheckboxChange=
()=>{b.viewModel.toggleDirectShadowsEnabled()};return b}n._inherits(p,e);var J=n._createSuper(p);e=p.prototype;e.postInitialize=function(){this.viewModel.isSupported&&this.addHandles([h.watch(()=>this.viewModel.datePickerViewModel,a=>this._datePicker.viewModel=a,h.syncAndInitial),h.watch(()=>this.viewModel.timeSliderViewModel,a=>this._timeSlider.viewModel=a,h.syncAndInitial),h.watch(()=>this.timezoneMessages.chooseTimezone,a=>this._timeSlider.buttonTooltip=a,h.syncAndInitial),h.watch(()=>this.visibleElements?.timezone,
a=>this._timeSlider.showDropDown=a,h.syncAndInitial),h.watch(()=>!this.viewModel.sunLightingEnabled,a=>{this._datePicker.disabled=a;this._timeSlider.disabled=a},h.syncAndInitial),h.when(()=>this.gmtOffsets,a=>{this._timeSlider.items=a.map(c=>({utcOffset:c.utcOffset,name:c.short,label:[c.shortWithUTC,c.long]}))},h.syncAndInitial),h.watch(()=>[this.viewModel.utcOffset,this.gmtOffsets],()=>this._onUTCOffsetChange(),h.syncAndInitial),h.when(()=>!this.visible,()=>this._datePicker?.close(!1),h.sync)])};
e.destroy=function(){this._datePicker.destroy();this._timeSlider.destroy()};e.render=function(){const {messages:a,viewModel:c,visibleElements:b}=this,m=c.isSupported;return l.tsx("div",{class:this.classes(d.CSS.base,d.CSS.widget)},m?l.tsx(l.tsxFragment,null,b.header&&l.tsx(H.Heading,{level:this.headingLevel},a.title),this._renderTimeOptions(),b.datePicker&&this._renderDateOrSeason(),b.sunLightingToggle&&this._renderSunLightingToggle(),b.shadowsToggle&&this._renderShadowsToggle()):l.tsx("div",{key:"unsupported",
class:d.CSS.panelError},l.tsx("p",null,a.unsupported)))};e.loadDependencies=function(){return F.loadCalciteComponents({button:()=>new Promise((a,c)=>r(["../chunks/calcite-button"],a,c)),checkbox:()=>new Promise((a,c)=>r(["../chunks/calcite-checkbox"],a,c)),label:()=>new Promise((a,c)=>r(["../chunks/calcite-label"],a,c))})};e._renderTimeOptions=function(){const {viewModel:a,visibleElements:c,messages:b}=this,{directShadowsEnabled:m,dayPlaying:q}=a,z=!a.sunLightingEnabled;return l.tsx("div",{class:this.classes(d.CSS.dayContainer,
this._labelAlignmentClass,{[d.CSS.shadowOn]:m,[d.CSS.shadowOff]:!m,[d.CSS.sliderDateOn]:c.datePicker,[d.CSS.sliderDateOff]:!c.datePicker,[d.CSS.sliderAmPmOn]:this._useAmPm,[d.CSS.containerDisabled]:z}),key:"daylight-time-options"},this._timeSlider.render(),c.playButtons&&this._renderPlayPauseButton({playing:q,disabled:z,label:b.playDay,onClick:this._onPlayDayClick}))};e._renderDateOptions=function(){const {viewModel:a,visibleElements:c,messages:b}=this,{yearPlaying:m}=a,q=!a.sunLightingEnabled;return l.tsx("div",
{key:"daylight-date-options",class:this.classes(d.CSS.dateContainer,q&&d.CSS.containerDisabled)},this._datePicker.render(),c.playButtons&&this._renderPlayPauseButton({playing:m,disabled:q,label:b.playYear,onClick:this._onYearPlayClick}))};e._renderPlayPauseButton=function({playing:a,disabled:c,label:b,onClick:m}){return l.tsx("calcite-button",{appearance:"solid",class:d.CSS.playPauseButton,disabled:c,iconStart:a?"pause-f":"play-f",label:b,round:!0,title:b,type:"button",onclick:m})};e._renderSeasonOptions=
function(){const {messages:a,viewModel:c}=this,b=!c.sunLightingEnabled;return l.tsx("select",{class:this.classes(d.CSS.select,d.CSS.seasonPicker,b&&d.CSS.seasonPickerDisabled),disabled:b,value:c.currentSeason,"aria-label":a.season,onchange:this._onSeasonChange},D.ORDERED_SEASONS.map(m=>l.tsx("option",{value:m},a[m])))};e._renderDateOrSeason=function(){return"date"===this.dateOrSeason?this._renderDateOptions():this._renderSeasonOptions()};e._renderSunLightingToggle=function(){const a=this.messages?.sunLightingToggle;
return l.tsx("calcite-label",{key:"date-time-toggle",layout:"inline",title:a?.tooltip,scale:"s"},l.tsx("calcite-checkbox",{class:d.CSS.sunLightingCheckbox,checked:this.viewModel.sunLightingEnabled,onCalciteCheckboxChange:this._onSunLightingCheckboxChange}),a?.label)};e._renderShadowsToggle=function(){const a=this.messages.shadowsToggle;return l.tsx("calcite-label",{key:"shadow-toggle",layout:"inline",title:a?.tooltip,scale:"s"},l.tsx("calcite-checkbox",{class:d.CSS.shadowsCheckbox,checked:this.viewModel.directShadowsEnabled,
onCalciteCheckboxChange:this._onShadowCheckboxChange}),a.label)};e._onUTCOffsetChange=function(){const a=this.viewModel.utcOffset;var c=this._timeSlider.currentItem?.utcOffset;const b=this.gmtOffsets;u.isNone(b)||c===a||(c=b.findIndex(({utcOffset:m})=>m===a),-1<c&&(this._timeSlider.currentIndex=c))};e._onPrimaryTickCreated=function(a,c,b){c.classList.add(...t,d.CSS.primaryTick);b.classList.add(...t,d.CSS.primaryTickLabel);b.onclick=c.onclick=this._makeGoToTime(a);a=b.textContent;if(a=null!=a&&y.exec(a))b.innerHTML=
`${a[1]}<br><div class=${d.CSS.primaryTickAmPm}>${a[2]}</div>`};e._onSecondaryTickCreated=function(a,c){c.classList.add(...t,d.CSS.secondaryTick);c.onclick=this._makeGoToTime(a)};e._makeGoToTime=function(a){return()=>{this.viewModel.timeSliderPosition=a}};n._createClass(p,[{key:"gmtOffsets",get:function(){return u.applySome(this.timezoneMessages,I.getTimezoneInfos)}},{key:"label",get:function(){return this.messages?.title??""},set:function(a){this._overrideIfSome("label",a)}},{key:"playSpeedMultiplier",
get:function(){return this.viewModel.playSpeedMultiplier},set:function(a){this.viewModel.playSpeedMultiplier=a}},{key:"timeSliderSteps",get:function(){return this._timeSlider?.steps??5},set:function(a){this._timeSlider.steps=a}},{key:"view",get:function(){return this.viewModel.view},set:function(a){this.viewModel.view=a}},{key:"test",get:function(){return{datePicker:this._datePicker}}},{key:"_useAmPm",get:function(){const a=this._timeSlider.viewModel.getLabelForValue(0,"tick");return null!=a&&y.test(a)}},
{key:"_labelAlignmentClass",get:function(){const a=this.viewModel.timeSliderViewModel.values?.[0]??0,c=60*(this._useAmPm?21:21.5);return a<60*(this._useAmPm?4:3)?d.CSS.sliderAlignLeft:a>c?d.CSS.sliderAlignRight:null}}]);return p}(C);g.__decorate([k.property({readOnly:!0})],f.prototype,"gmtOffsets",null);g.__decorate([k.property(),x.messageBundle("esri/widgets/Daylight/t9n/Daylight")],f.prototype,"messages",void 0);g.__decorate([k.property(),x.messageBundle("esri/widgets/support/t9n/timezone")],f.prototype,
"timezoneMessages",void 0);g.__decorate([k.property()],f.prototype,"headingLevel",void 0);g.__decorate([k.property()],f.prototype,"iconClass",void 0);g.__decorate([k.property()],f.prototype,"label",null);g.__decorate([k.property()],f.prototype,"playSpeedMultiplier",null);g.__decorate([k.property()],f.prototype,"timeSliderSteps",null);g.__decorate([k.property()],f.prototype,"view",null);g.__decorate([k.property({type:v})],f.prototype,"viewModel",void 0);g.__decorate([k.property({type:w,nonNullable:!0})],
f.prototype,"visibleElements",void 0);g.__decorate([k.property({cast:e=>{if("season"===e||"date"===e)return e;A.getLogger("esri.widgets.Daylight").warn(`"${e}" is not a valid option. Acceptable values are only "date" or "season". Defaulting to "${"date"}".`);return"date"}})],f.prototype,"dateOrSeason",void 0);g.__decorate([k.property()],f.prototype,"_timeSlider",void 0);g.__decorate([k.property()],f.prototype,"_useAmPm",null);g.__decorate([k.property()],f.prototype,"_labelAlignmentClass",null);g.__decorate([k.property()],
f.prototype,"_datePicker",void 0);f=g.__decorate([B.subclass("esri.widgets.Daylight")],f);const t=["esri-interactive","esri-widget__anchor"];return f});