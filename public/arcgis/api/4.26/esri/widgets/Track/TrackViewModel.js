// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../support/GeolocationPositioning".split(" "),function(k,d,e,c,r,t,n,p){c=function(b){function g(a){a=q.call(this,a);a._watchId=void 0;a._trackStartingTimeoutId=void 0;a._settingPosition=null;return a}k._inherits(g,b);var q=k._createSuper(g);b=g.prototype;b.destroy=
function(){this._stopTracking()};b.start=function(){"disabled"!==this.state&&"feature-unsupported"!==this.state&&this._startTracking()};b.stop=function(){"disabled"!==this.state&&"feature-unsupported"!==this.state&&this._stopTracking()};b._stopWatchingPosition=function(){void 0!==this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=void 0)};b._stopTracking=function(){this._clearWaitingTimer();this._stopWatchingPosition();this._clear()};b._startTracking=function(){this._stopTracking();
const a=async h=>{try{h=await this._setPosition(h);this._clearWaitingTimer();const {view:f,graphic:l}=this;f&&f.graphics.remove(l);if(l){const m=l.clone();this.graphic=m;f&&f.graphics.push(m)}this.emit("track",{position:h})}catch(f){throw this._emitError(f),this._clearWaitingTimer(),f;}};this._watchId=navigator.geolocation.watchPosition(h=>{this._settingPosition=a(h)},this._handleWatchPositionError.bind(this),this.geolocationOptions??void 0);this._trackStartingTimeoutId=setTimeout(()=>{this._trackStartingTimeoutId=
void 0},15E3)};b._handleWatchPositionError=function(a){this._emitError(a);this._stopTracking()};b._clearWaitingTimer=function(){clearTimeout(this._trackStartingTimeoutId);this._trackStartingTimeoutId=void 0;this._settingPosition=null};b._emitError=function(a){this.emit("track-error",{error:a})};k._createClass(g,[{key:"state",get:function(){return this._geolocationUsable?this.view&&!this.view.ready?"disabled":this._settingPosition||void 0!==this._trackStartingTimeoutId?"waiting":this.tracking?"tracking":
"ready":"feature-unsupported"}},{key:"tracking",get:function(){return void 0!==this._watchId}}]);return g}(p);d.__decorate([e.property()],c.prototype,"_watchId",void 0);d.__decorate([e.property()],c.prototype,"_trackStartingTimeoutId",void 0);d.__decorate([e.property()],c.prototype,"_settingPosition",void 0);d.__decorate([e.property({readOnly:!0})],c.prototype,"state",null);d.__decorate([e.property({readOnly:!0})],c.prototype,"tracking",null);d.__decorate([e.property()],c.prototype,"start",null);
d.__decorate([e.property()],c.prototype,"stop",null);return c=d.__decorate([n.subclass("esri.widgets.Track.TrackViewModel")],c)});