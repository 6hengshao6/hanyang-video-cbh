// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/collectionUtils ../../core/Handles ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./support/buildingLayerUtils ./support/LayerTreeNode ./support/layerUtils".split(" "),function(m,l,e,q,u,v,r,w,n,B,C,D,x,y,p,z){e=function(c){function h(a){a=
A.call(this,a);a.root=new p.LayerTreeNode;a.state="disabled";a._handles=new v;a._loadLayers=z.createLoadLayersFunction();a.layers=new q;return a}m._inherits(h,c);var A=m._createSuper(h);c=h.prototype;c.initialize=function(){this._handles.add(this.layers.on("change",()=>this._onLayersChange()));this._onLayersChange()};c.destroy=function(){this._set("state","disabled");this._handles.destroy();this.root.destroy()};c._updateLayerTree=function(){this.root.destroy();this._set("root",new p.LayerTreeNode({collapsed:!1}));
const a=new Map,b=1<this.layers.length?"modelName":"id";this.layers.forEach(d=>{const f=y.findFullModelSublayer(d);this._addNodesForSublayers(r.unwrapOr(f,d),this.root,a,b)});return this};c._addNodeForLayer=function(a,b,d,f){const k=String(a.get(f)).toLowerCase();if(!r.isNone(k)&&!a.isEmpty){var t=`${b.id}/${k}`,g=d.get(t);g||(g=new p.LayerTreeNode({id:k,level:b.level+1}),d.set(t,g));g.layers.push(a);b.children.push(g);this._addNodesForSublayers(a,g,d,f)}};c._addNodesForSublayers=function(a,b,d,f){("building-scene"===
a.type||"building-group"===a.type&&!a.isEmpty)&&a.sublayers.forEach(k=>this._addNodeForLayer(k,b,d,f))};c._onLayersChange=async function(){this._set("state","loading");if(0!==this.layers.length)try{await this._loadLayers(this.layers),this._updateLayerTree(),this._set("state","ready")}catch(a){w.isAbortError(a)||this._set("state","failed")}};m._createClass(h,[{key:"layers",set:function(a){const b=this._get("layers");this._set("layers",u.referenceSetter(a,b))}}]);return h}(e);l.__decorate([n.property({readOnly:!0})],
e.prototype,"root",void 0);l.__decorate([n.property({type:q,nonNullable:!0})],e.prototype,"layers",null);l.__decorate([n.property({readOnly:!0,nonNullable:!0})],e.prototype,"state",void 0);return e=l.__decorate([x.subclass("esri.widgets.BuildingExplorer.BuildingDisciplineViewModel")],e)});