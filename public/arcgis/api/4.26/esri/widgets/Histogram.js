// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../intl ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Histogram/HistogramViewModel ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),function(w,k,g,r,m,K,L,M,z,A,B,C,D,l,E){var x;g=x=function(d){function t(a,b){a=F.call(this,a,b);a._bgFillId=`${a.id}-bg-fill`;
a._containerNode=null;a._containerDimensions={width:0,height:0};a._defaultBarColor="#d8d8d8";a.barCreatedFunction=null;a.dataLines=null;a.dataLineCreatedFunction=null;a.dataLineUpdatedFunction=null;a.messages=null;a.viewModel=new B;return a}w._inherits(t,d);var F=w._createSuper(t);t.fromHistogramResult=function(a){const {bins:b,maxValue:c,minValue:f}=a;return new x({bins:b,max:c,min:f})};d=t.prototype;d.render=function(){const {label:a,layout:b,state:c}=this,f=this.classes("esri-histogram","esri-widget",
"horizontal"===b?"esri-histogram--horizontal":"esri-histogram--vertical","disabled"===c?"esri-disabled":null);return l.tsx("div",{"aria-label":a,class:f,bind:this,afterCreate:this._afterContainerNodeCreate},"ready"===c?this.renderContent():null)};d.renderContent=function(){if(this._containerNode){var a=this._bgFillId,b=`clip-path: url(#${a})`;return l.tsx("div",{class:"esri-histogram__content"},l.tsx("svg",{class:"esri-histogram__svg",xmlns:"http://www.w3.org/2000/svg"},l.tsx("defs",null,this.renderFillDefinition(a)),
l.tsx("g",{style:b},this.renderBarsGroup()),this.renderLinesGroup()))}};d.renderBarsGroup=function(){return l.tsx("g",{class:this.classes("esri-histogram__bars")},this.renderBars())};d.renderBars=function(){const {layout:a,viewModel:{binRange:b,range:c}}=this;if(b&&c){var f=b/c,{width:h,height:e}=this._containerDimensions;if(0!==e||0!==h)if(0===e&&0!==h)this.scheduleRender();else{var [n,q]="vertical"===a?[e*f,h]:[e,h*f];return this._getBarDimensions(n,q).map(([u,v],p)=>this.renderBar(p,u,v))}}};d.renderBar=
function(a,b,c){const {bins:f,layout:h,max:e,messages:n,viewModel:{range:q}}=this;if(f&&!r.isNone(e)){var {width:u,height:v}=this._containerDimensions,p=f.slice()[a],{count:G,maxValue:y,minValue:H}=p;p=e-y;var [I,J]="vertical"===h?[0,v/q*p]:[u-c-u/q*p,v-b];p=E.substitute(n.barLabel,{count:G,maxValue:y,minValue:H});return l.tsx("rect",{"aria-label":p,afterCreate:this._afterBarCreate,bind:this,class:"esri-histogram__bar","data-index":a,fill:this._defaultBarColor,height:b,role:"img","shape-rendering":"crispEdges",
"stroke-width":"0",width:c,x:I,y:J})}};d.renderLinesGroup=function(){return l.tsx("g",{class:this.classes("esri-histogram__data-lines")},this.renderAverageLine(),this.renderCustomLines())};d.renderAverageLine=function(){const {average:a}=this;if(!r.isNone(a)){var b=[l.tsx("tspan",{class:this.classes("esri-histogram__average-symbol")},"x\u0304 "),l.tsx("tspan",{class:this.classes("esri-histogram__average-label")},this.labelFormatFunction?this.labelFormatFunction(a,"average"):a)];return l.tsx("g",{afterCreate:this._afterLinesSubgroupCreate,
afterUpdate:this._afterLinesSubgroupUpdate,bind:this,class:this.classes("esri-histogram__data-lines-subgroup")},l.tsx("title",{key:"title"},a),this.renderLine(a,this.classes("esri-histogram__average-data-line")),this.renderLabel({label:b,value:a}))}};d.renderCustomLines=function(){if(this.dataLines&&this.dataLines.length)return this.dataLines.map((a,b)=>this.renderLineSubgroup(a,b))};d.renderLineSubgroup=function(a,b){const {value:c}=a;return l.tsx("g",{afterCreate:this._afterLinesSubgroupCreate,
afterUpdate:this._afterLinesSubgroupUpdate,bind:this,class:this.classes("esri-histogram__data-lines-subgroup"),"data-index":b},l.tsx("title",{key:"title"},c),this.renderLine(c),this.renderLabel(a))};d.renderLine=function(a,b){const [c,f,h,e]=this._getLinePosition(a);return l.tsx("line",{class:this.classes("esri-histogram__data-line",b),x1:c,x2:f,y1:h,y2:e,"shape-rendering":"crispEdges"})};d.renderLabel=function(a,b){const {label:c,value:f}=a,[h,e]=this._getLabelPosition(f);return l.tsx("text",{class:this.classes("esri-histogram__label",
b),"text-anchor":"end",transform:"horizontal"===this.layout?"rotate(270)":null,x:h,y:e-2},c??"")};d.renderFillDefinition=function(a){const {width:b,height:c}=this._containerDimensions;return l.tsx("clipPath",{id:a},l.tsx("rect",{x:"0",y:"0",width:b,height:c}))};d._afterContainerNodeCreate=function(a){this._containerNode=a;this.addHandles(C.onResize(a,b=>{const {width:c,height:f}=b.contentRect;this._containerDimensions={width:c,height:f}}))};d._getIndexFromElement=function(a){const b=a.dataset?.index;
a=a.getAttribute("data-index");return r.isSome(b)?parseInt(b,10):r.isSome(a)?parseInt(a,10):null};d._afterBarCreate=function(a){if(this.barCreatedFunction){const b=this._getIndexFromElement(a)??-1;this.barCreatedFunction(b,a)}};d._afterLinesSubgroupCreate=function(a){if(this.dataLineCreatedFunction){const b=this._getIndexFromElement(a);this.dataLineCreatedFunction(a.childNodes[0],a.childNodes[1]?a.childNodes[1]:null,b)}};d._afterLinesSubgroupUpdate=function(a){if(this.dataLineUpdatedFunction){const b=
this._getIndexFromElement(a);this.dataLineUpdatedFunction(a.childNodes[0],a.childNodes[1]?a.childNodes[1]:null,b)}};d._getBarDimensions=function(a,b){const {bins:c,layout:f}=this,h=c?c.map(n=>n.count):[],e=Math.max.apply(Math,h);return h.map(n=>"vertical"===f?[a/h.length,0!==e?n/e*b:0]:[0!==e?n/e*a:0,b/h.length])};d._getLinePosition=function(a){const {layout:b,min:c,viewModel:{range:f}}=this;if(r.isNone(c))return[0,0,0,0];a=Math.round((a-c)/f*100)/100;const {width:h,height:e}=this._containerDimensions,
[n,q]=[a*h||1,e-a*e||1];return"vertical"===b?[0,"100%",q,q]:[n,n,"100%",0]};d._getLabelPosition=function(a){const {layout:b,min:c,viewModel:{range:f}}=this;if(r.isNone(c))return[0,0];a=Math.round((a-c)/f*100)/100;const {width:h,height:e}=this._containerDimensions;return"vertical"===b?[h,e-a*e]:[0,a*h]};w._createClass(t,[{key:"average",get:function(){return this.viewModel.average},set:function(a){this.viewModel.average=a}},{key:"bins",get:function(){return this.viewModel.bins},set:function(a){this.viewModel.bins=
a}},{key:"label",get:function(){return this.messages?.widgetLabel??""},set:function(a){this._overrideIfSome("label",a)}},{key:"labelFormatFunction",get:function(){return this.viewModel.labelFormatFunction},set:function(a){this.viewModel.labelFormatFunction=a}},{key:"layout",set:function(a){"vertical"!==a&&(a="horizontal");this._set("layout",a)}},{key:"max",get:function(){return this.viewModel.max},set:function(a){this.viewModel.max=a}},{key:"min",get:function(){return this.viewModel.min},set:function(a){this.viewModel.min=
a}},{key:"state",get:function(){return this.viewModel.state}}]);return t}(A);k.__decorate([m.property()],g.prototype,"_bgFillId",void 0);k.__decorate([m.property()],g.prototype,"_containerNode",void 0);k.__decorate([m.property()],g.prototype,"_containerDimensions",void 0);k.__decorate([m.property()],g.prototype,"_defaultBarColor",void 0);k.__decorate([m.property()],g.prototype,"average",null);k.__decorate([m.property()],g.prototype,"barCreatedFunction",void 0);k.__decorate([m.property()],g.prototype,
"dataLines",void 0);k.__decorate([m.property()],g.prototype,"dataLineCreatedFunction",void 0);k.__decorate([m.property()],g.prototype,"dataLineUpdatedFunction",void 0);k.__decorate([m.property()],g.prototype,"label",null);k.__decorate([m.property()],g.prototype,"labelFormatFunction",null);k.__decorate([m.property({value:"horizontal"})],g.prototype,"layout",null);k.__decorate([m.property()],g.prototype,"max",null);k.__decorate([m.property(),D.messageBundle("esri/widgets/Histogram/t9n/Histogram")],
g.prototype,"messages",void 0);k.__decorate([m.property()],g.prototype,"min",null);k.__decorate([m.property({readOnly:!0})],g.prototype,"state",null);k.__decorate([m.property()],g.prototype,"viewModel",void 0);return g=x=k.__decorate([z.subclass("esri.widgets.Histogram")],g)});