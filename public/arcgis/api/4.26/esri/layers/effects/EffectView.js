// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(e,t,g,z,A,p,B,k,E,C,D,x){function u(b){b=D.parse(b)||[];var c=(c=b[0])?"type"in c:!1;return c?[{scale:-1,effects:b}]:b}function v(b,c,l){return b[0]?.effects&&c[0]?.effects?(-1===b[0]?.scale||
-1===c[0]?.scale)&&(1<b.length||1<c.length)&&0>=l?!1:x.canInterpolateEffects(b[0].effects,c[0].effects):!0}function y(b,c,l){const a=b.length>c.length?b:c;b=b.length>c.length?c:b;var d=b[b.length-1];c=d?.scale??l;d=d?.effects??[];for(let f=b.length;f<a.length;f++)b.push({scale:c,effects:[...d]});for(c=0;c<a.length;c++)b[c].scale=-1===b[c].scale?l:b[c].scale,a[c].scale=-1===a[c].scale?l:a[c].scale,x.normalizeEffects(b[c].effects,a[c].effects)}e.EffectView=function(b){function c(a){a=l.call(this,a);
a._from=null;a._to=null;a._final=null;a._current=[];a._time=0;a.duration=A("mapview-transitions-duration");a.effects=[];return a}t._inherits(c,b);var l=t._createSuper(c);b=c.prototype;b.canTransitionTo=function(a){try{return 0<this.scale&&v(this._current,u(a),this.scale)}catch{return!1}};b.transitionStep=function(a,d){this._applyTimeTransition(a);this._updateForScale(d)};b.endTransitions=function(){this._applyTimeTransition(this.duration)};b._transitionTo=function(a){0<this.scale&&v(this._current,
a,this.scale)?(this._final=a,this._to=p.clone(a),y(this._current,this._to,this.scale),this._from=p.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=a);this._set("effects",this._current[0]?p.clone(this._current[0].effects):[])};b._applyTimeTransition=function(a){if(this._to&&this._from&&this._current&&this._final){this._time+=a;a=Math.min(1,this._time/this.duration);for(let f=0;f<this._current.length;f++){const h=this._current[f],n=this._from[f],m=this._to[f];
var d=n.scale;h.scale=d+(m.scale-d)*a;for(d=0;d<h.effects.length;d++)h.effects[d].interpolate(n.effects[d],m.effects[d],a)}1===a&&(this._current=this._final,this._set("effects",this._current[0]?p.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}};b._updateForScale=function(a){this._set("scale",a);if(0!==this._current.length){var d=this._current,f=this._current.length-1,h,n=1;if(1===d.length||a>=d[0].scale)var m=h=d[0].effects;else if(a<=d[f].scale)m=h=d[f].effects;else for(let q=
0;q<f;q++){const r=d[q],w=d[q+1];if(r.scale>=a&&w.scale<=a){n=(a-r.scale)/(w.scale-r.scale);h=r.effects;m=w.effects;break}}for(a=0;a<this.effects.length;a++)this.effects[a].interpolate(h[a],m[a],n)}};t._createClass(c,[{key:"effect",set:function(a){const d=this._get("effect");a=a||"";if(d!==a){this._set("effect",a);try{this._transitionTo(u(a))}catch(f){this._transitionTo([]),B.getLogger(this.declaredClass).warn("Invalid Effect",{effect:a,error:f})}}}},{key:"hasEffects",get:function(){return this.transitioning||
!!this.effects.length}},{key:"scale",set:function(a){this._updateForScale(a)}},{key:"transitioning",get:function(){return null!==this._to}}]);return c}(z);g.__decorate([k.property()],e.EffectView.prototype,"_to",void 0);g.__decorate([k.property()],e.EffectView.prototype,"duration",void 0);g.__decorate([k.property({value:""})],e.EffectView.prototype,"effect",null);g.__decorate([k.property({readOnly:!0})],e.EffectView.prototype,"effects",void 0);g.__decorate([k.property({readOnly:!0})],e.EffectView.prototype,
"hasEffects",null);g.__decorate([k.property({value:0})],e.EffectView.prototype,"scale",null);g.__decorate([k.property({readOnly:!0})],e.EffectView.prototype,"transitioning",null);e.EffectView=g.__decorate([C.subclass("esri.layers.effects.EffectView")],e.EffectView);e.canInterpolateEffectStops=v;e.convertEffectToStops=u;e.normalizeEffectStops=y;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});