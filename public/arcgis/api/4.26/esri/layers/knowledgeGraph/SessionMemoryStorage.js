// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["../../chunks/_rollupPluginBabelHelpers","../graphics/featureConversionUtils","../graphics/OptimizedFeature"],function(m,n,k){return function(){function d(){this._featureLookup=new Map}d.getInstance=function(){d.instance||(d.instance=new d);return d.instance};var g=d.prototype;g.deleteFromStore=function(e){e.forEach(c=>{this._featureLookup.delete(c)})};g.readFromStoreByList=function(e){const c=[];e.forEach(f=>{(f=this.readFromStoreById(f))&&c.push(f)});return c};g.readFromStoreById=function(e){return this._featureLookup.get(e)??
null};g.writeToStore=function(e,c,f){const l=[];e.forEach(a=>{if(a&&a.id){a.properties||(a.properties=[]);var b=null;f&&(b=a.properties[f]?n.convertFromGeometry(a.properties[f]):null);"originId"in a&&"destinationId"in a&&(a.properties.ESRI__ORIGIN_ID=a.originId,a.properties.ESRI__DESTINATION_ID=a.destinationId);if((a.properties[c]=a.id)&&this._featureLookup.has(a.id)){const h=this._featureLookup.get(a.id);b=new k.OptimizedFeature(b?JSON.parse(JSON.stringify(b)):h?.geometry?JSON.parse(JSON.stringify(h.geometry)):
null,JSON.parse(JSON.stringify(Object.assign(a.properties,h?.attributes))),null,a.properties[c])}else b=new k.OptimizedFeature(b?JSON.parse(JSON.stringify(b)):null,a.properties,null,a.properties[c]);this._featureLookup.set(a.id,b);l.push(b)}});return l};return m._createClass(d)}()});