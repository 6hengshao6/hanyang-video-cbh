// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/has ../../../core/Loadable ../../../core/maybe ../../../core/promiseUtils ../../../core/workers/workers ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ../../../rest/support/FeatureSet ../../../geometry/Extent".split(" "),function(d,l,e,C,n,p,q,r,t,f,D,E,u,v,w){d.CSVSource=
function(c){function h(a){var b=x.call(this,a);b.type="csv";b.refresh=r.debounce(async m=>{await b.load();const {extent:k,timeExtent:g}=await b._connection.invoke("refresh",m);k&&(b.sourceJSON.extent=k);g&&(b.sourceJSON.timeInfo.timeExtent=[g.start,g.end]);return{dataChanged:!0,updates:{extent:b.sourceJSON.extent,timeInfo:b.sourceJSON.timeInfo}}});return b}l._inherits(h,c);var x=l._createSuper(h);c=h.prototype;c.load=function(a){a=q.isSome(a)?a.signal:null;this.addResolvingPromise(this._startWorker(a));
return Promise.resolve(this)};c.destroy=function(){this._connection?.close();this._connection=null};c.openPorts=async function(){await this.load();return this._connection.openPorts()};c.queryFeatures=async function(a,b={}){await this.load(b);a=await this._connection.invoke("queryFeatures",a?a.toJSON():null,b);return v.fromJSON(a)};c.queryFeaturesJSON=async function(a,b={}){await this.load(b);return this._connection.invoke("queryFeatures",a?a.toJSON():null,b)};c.queryFeatureCount=async function(a,
b={}){await this.load(b);return this._connection.invoke("queryFeatureCount",a?a.toJSON():null,b)};c.queryObjectIds=async function(a,b={}){await this.load(b);return this._connection.invoke("queryObjectIds",a?a.toJSON():null,b)};c.queryExtent=async function(a,b={}){await this.load(b);a=await this._connection.invoke("queryExtent",a?a.toJSON():null,b);return{count:a.count,extent:w.fromJSON(a.extent)}};c.querySnapping=async function(a,b={}){await this.load(b);return this._connection.invoke("querySnapping",
a,b)};c._startWorker=async function(a){this._connection=await t.open("CSVSourceWorker",{strategy:n("feature-layers-workers")?"dedicated":"local",signal:a});const {url:b,delimiter:m,fields:k,latitudeField:g,longitudeField:y,spatialReference:z,timeInfo:A}=this.loadOptions;a=await this._connection.invoke("load",{url:b,customParameters:this.customParameters,parsingOptions:{delimiter:m,fields:k?.map(B=>B.toJSON()),latitudeField:g,longitudeField:y,spatialReference:z?.toJSON(),timeInfo:A?.toJSON()}},{signal:a});
this.locationInfo=a.locationInfo;this.sourceJSON=a.layerDefinition;this.delimiter=a.delimiter};return l._createClass(h)}(p);e.__decorate([f.property()],d.CSVSource.prototype,"type",void 0);e.__decorate([f.property()],d.CSVSource.prototype,"loadOptions",void 0);e.__decorate([f.property()],d.CSVSource.prototype,"customParameters",void 0);e.__decorate([f.property()],d.CSVSource.prototype,"locationInfo",void 0);e.__decorate([f.property()],d.CSVSource.prototype,"sourceJSON",void 0);e.__decorate([f.property()],
d.CSVSource.prototype,"delimiter",void 0);d.CSVSource=e.__decorate([u.subclass("esri.layers.graphics.sources.CSVSource")],d.CSVSource);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});