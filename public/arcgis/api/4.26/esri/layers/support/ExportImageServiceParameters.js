// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./imageryRendererUtils ./MosaicRule ./rasterEnums ./RasterFunction".split(" "),function(c,p,d,t,e,x,y,z,u,m,h,v,n,q){c.ExportImageServiceParameters=function(g){function k(){var a=w.apply(this,
arguments);a.layer=null;a.compression=void 0;a.pixelType=void 0;a.lercVersion=2;return a}p._inherits(k,g);var w=p._createSuper(k);g=k.prototype;g.writeAdjustAspectRatio=function(a,b,f){10.3>this.layer.version||(b[f]=a)};g.writeCompressionQuality=function(a,b,f){this.format&&this.format.toLowerCase().includes("jpg")&&null!=a&&(b[f]=a)};g.writeCompressionTolerance=function(a,b,f){"lerc"===this.format&&null!=a&&(b[f]=a)};g.writeLercVersion=function(a,b,f){"lerc"===this.format&&10.5<=this.layer.version&&
(b[f]=a)};g.combineRendererWithRenderingRule=function(a){const b=this.layer,{rasterInfo:f,renderer:l}=b;a=a||b.renderingRule;return l&&h.isSupportedRendererType(l)?h.combineRenderingRules(h.convertRendererToRenderingRule(l,{rasterAttributeTable:f.attributeTable,pixelType:f.pixelType,dataType:f.dataType,bandProperties:f.keyProperties?.BandProperties,convertColorRampToColormap:10.6>b.version,convertToRFT:!!a?.rasterFunctionDefinition,bandCount:f.bandCount}),a):a};g._addResampleRasterFunction=function(a){if("vector-field"!==
this.layer.renderer?.type||"Resample"===a?.functionName)return a;let b=new q({functionName:"Resample",functionArguments:{ResamplingType:"esriImageServiceDataTypeVector-UV"===this.layer.serviceDataType?7:10,InputCellSize:this.layer.serviceRasterInfo.pixelSize}});b=a?.rasterFunctionDefinition?new q({rasterFunctionDefinition:h.convertRenderingRuleToRFT(b)}):b;return h.combineRenderingRules(b,a)};g._addClipFunction=function(a,b){b=new q({functionName:"Clip",functionArguments:{ClippingGeometry:b.toJSON(),
ClippingType:1}});return h.combineRenderingRules(b,a)};p._createClass(k,[{key:"adjustAspectRatio",get:function(){return this.layer.adjustAspectRatio}},{key:"bandIds",get:function(){return this.layer.bandIds}},{key:"compressionQuality",get:function(){return this.layer.compressionQuality}},{key:"compressionTolerance",get:function(){return this.layer.compressionTolerance}},{key:"format",get:function(){return"vector-field"===this.layer.renderer?.type?"lerc":this.layer.format}},{key:"interpolation",get:function(){return this.layer.interpolation}},
{key:"noData",get:function(){return this.layer.noData}},{key:"noDataInterpretation",get:function(){return this.layer.noDataInterpretation}},{key:"version",get:function(){const a=this.layer;a.commitProperty("bandIds");a.commitProperty("format");a.commitProperty("compressionQuality");a.commitProperty("compressionTolerance");a.commitProperty("interpolation");a.commitProperty("noData");a.commitProperty("noDataInterpretation");a.commitProperty("mosaicRule");a.commitProperty("renderingRule");a.commitProperty("adjustAspectRatio");
a.commitProperty("pixelFilter");a.commitProperty("definitionExpression");a.commitProperty("multidimensionalSubset");return(this._get("version")||0)+1},set:function(a){this._set("version",a)}},{key:"mosaicRule",get:function(){var a=this.layer;let b=a.mosaicRule;a=a.definitionExpression;b?a&&a!==b.where&&(b=b.clone(),b.where=a):a&&(b=new v({where:a}));return b}},{key:"renderingRule",get:function(){const a=this.layer;let b=a.renderingRule;const f=a.pixelFilter,l=!a.format||a.format.includes("jpg")||
a.format.includes("png");b=this._addResampleRasterFunction(b);const r=a.multidimensionalSubset?.areaOfInterest;r&&(b=this._addClipFunction(b,r));l&&!f&&"vector-field"!==a.renderer?.type&&(b=this.combineRendererWithRenderingRule(b));return b}}]);return k}(t.JSONSupport);d.__decorate([e.property()],c.ExportImageServiceParameters.prototype,"layer",void 0);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"adjustAspectRatio",null);d.__decorate([m.writer("adjustAspectRatio")],
c.ExportImageServiceParameters.prototype,"writeAdjustAspectRatio",null);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"bandIds",null);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"compression",void 0);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"compressionQuality",null);d.__decorate([m.writer("compressionQuality")],c.ExportImageServiceParameters.prototype,"writeCompressionQuality",
null);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"compressionTolerance",null);d.__decorate([m.writer("compressionTolerance")],c.ExportImageServiceParameters.prototype,"writeCompressionTolerance",null);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"format",null);d.__decorate([e.property({type:String,json:{read:{reader:n.interpolationKebab.read},write:{writer:n.interpolationKebab.write}}})],c.ExportImageServiceParameters.prototype,
"interpolation",null);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"noData",null);d.__decorate([e.property({type:String,json:{read:{reader:n.noDataInterpretationKebab.read},write:{writer:n.noDataInterpretationKebab.write}}})],c.ExportImageServiceParameters.prototype,"noDataInterpretation",null);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"pixelType",void 0);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,
"lercVersion",void 0);d.__decorate([m.writer("lercVersion")],c.ExportImageServiceParameters.prototype,"writeLercVersion",null);d.__decorate([e.property({type:Number})],c.ExportImageServiceParameters.prototype,"version",null);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"mosaicRule",null);d.__decorate([e.property({json:{write:!0}})],c.ExportImageServiceParameters.prototype,"renderingRule",null);c.ExportImageServiceParameters=d.__decorate([u.subclass("esri.layers.mixins.ExportImageServiceParameters")],
c.ExportImageServiceParameters);Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});