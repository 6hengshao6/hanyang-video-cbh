// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/rasterRenderers":function(){define("exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/FlowRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer ./renderers/VectorFieldRenderer".split(" "),function(N,D,I,F,y,O,V,L,P){function B(u,h){if(!u)return null;if("classBreaks"===u.type&&u.classificationMethod){var r=u.authoringInfo||{classificationMethod:""};r.classificationMethod=
u.classificationMethod;u.authoringInfo=r}"vectorField"===u.type&&u.visualVariables&&!Array.isArray(u.visualVariables)&&(u.visualVariables=[u.visualVariables]);r=u?l[u.type]||null:null;if(r)return r=new r,r.read(u,h),r;h&&h.messages&&u&&h.messages.push(new D("renderer:unsupported","Renderers of type '"+(u.type||"unknown")+"' are not supported",{definition:u,context:h}));return null}const p={key:"type",base:null,typeMap:{"unique-value":L,"class-breaks":I,"raster-colormap":y,"raster-stretch":V,"vector-field":P,
"raster-shaded-relief":O,flow:F}},c={...p,typeMap:{...p.typeMap}};delete c.typeMap["vector-field"];delete c.typeMap.flow;const l={uniqueValue:L,classBreaks:I,rasterStretch:V,rasterColormap:y,vectorField:P,rasterShadedRelief:O,flowRenderer:F};N.ClassBreaksRenderer=I;N.FlowRenderer=F;N.RasterColormapRenderer=y;N.RasterShadedReliefRenderer=O;N.RasterStretchRenderer=V;N.UniqueValueRenderer=L;N.VectorFieldRenderer=P;N.fromJSON=function(u,h){return B(u,h)};N.rasterRendererTypes=p;N.read=B;N.websceneRasterRendererTypes=
c;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/FlowRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./mixins/VisualVariablesMixin ./support/AuthoringInfo ./support/LegendOptions".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h){var r;F=new F.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});y=r=function(d){function t(E){E=G.call(this,E);E.density=.8;E.color=new I([255,255,255,1]);E.maxPathLength=200;E.trailWidth=1.5;E.flowSpeed=10;E.trailLength=100;E.smoothing=0;E.flowRepresentation="flow-from";E.type="flow";E.authoringInfo=null;E.legendOptions=null;E.trailCap="butt";E.background="none";return E}N._inherits(t,d);var G=N._createSuper(t);d=t.prototype;d.clone=function(){const {density:E,
maxPathLength:a,trailWidth:n,flowSpeed:m,trailLength:f,smoothing:k,flowRepresentation:g,trailCap:b,background:e}=this,v=this.color.clone(),w=(this.visualVariables||[]).map(K=>K.clone()),C=this.authoringInfo?.clone(),M=this.legendOptions?.clone();return new r({density:E,color:v,maxPathLength:a,trailWidth:n,flowSpeed:m,trailLength:f,trailCap:b,background:e,smoothing:k,flowRepresentation:g,visualVariables:w,authoringInfo:C,legendOptions:M})};d.getSymbol=function(E,a){};d.getSymbolAsync=async function(E,
a){};d.getSymbols=function(){return[]};return N._createClass(t)}(l.VisualVariablesMixin(y.JSONSupport));D.__decorate([V.property({type:Number,json:{write:!0}})],y.prototype,"density",void 0);D.__decorate([V.property({type:I,json:{write:{allowNull:!0}}})],y.prototype,"color",void 0);D.__decorate([V.property({type:Number,cast:O.toPt,json:{write:!0}})],y.prototype,"maxPathLength",void 0);D.__decorate([V.property({type:Number,cast:O.toPt,json:{write:!0}})],y.prototype,"trailWidth",void 0);D.__decorate([V.property({type:Number,
json:{write:!0}})],y.prototype,"flowSpeed",void 0);D.__decorate([V.property({type:Number,json:{write:!0}})],y.prototype,"trailLength",void 0);D.__decorate([V.property({type:Number,cast:O.toPt,json:{write:!1}})],y.prototype,"smoothing",void 0);D.__decorate([V.property({type:F.apiValues,json:{type:F.jsonValues,read:{reader:F.read},write:{writer:F.write}}})],y.prototype,"flowRepresentation",void 0);D.__decorate([p.enumeration({flowRenderer:"flow"})],y.prototype,"type",void 0);D.__decorate([V.property({type:u,
json:{write:!0}})],y.prototype,"authoringInfo",void 0);D.__decorate([V.property({type:h.LegendOptions,json:{write:!0}})],y.prototype,"legendOptions",void 0);D.__decorate([V.property({type:String,json:{write:!0}})],y.prototype,"trailCap",void 0);D.__decorate([V.property({type:String,json:{write:!0}})],y.prototype,"background",void 0);return y=r=D.__decorate([c.subclass("esri.renderers.FlowRenderer")],y)})},"esri/renderers/RasterColormapRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./support/ColormapInfo ./support/colorRampUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p){var c;I=c=function(l){function u(r){r=h.call(this,r);r.colormapInfos=null;r.type="raster-colormap";return r}N._inherits(u,l);var h=N._createSuper(u);u.createFromColormap=function(r,d){if(!r)return null;const t=5===r[0].length;r=[...r].sort(G=>G[0][0]-G[1][0]).map(G=>B.fromJSON({value:G[0],color:t?G.slice(1,5):G.slice(1,4).concat([255]),label:d?d[G[0]]??"":G[0]}));return new c({colormapInfos:r})};u.createFromColorramp=function(r){r=p.convertColorRampToColormap(r);return c.createFromColormap(r)};
l=u.prototype;l.clone=function(){return new c({colormapInfos:this.colormapInfos.map(r=>r.toJSON())})};l.extractColormap=function(){return this.colormapInfos.map(({value:r,color:d})=>[r,d.r,d.g,d.b,1<d.a?d.a:255*d.a&255]).sort((r,d)=>r[0]-d[0])};return N._createClass(u)}(I.JSONSupport);D.__decorate([F.property({type:[B],json:{write:!0}})],I.prototype,"colormapInfos",void 0);D.__decorate([L.enumeration({rasterColormap:"raster-colormap"})],I.prototype,"type",void 0);return I=c=D.__decorate([P.subclass("esri.renderers.RasterColormapRenderer")],
I)})},"esri/renderers/support/ColormapInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(N,D,I,F,y,O,V,L,P){F=function(B){function p(){var l=c.apply(this,arguments);l.value=null;l.label=null;l.color=null;return l}N._inherits(p,B);var c=N._createSuper(p);
return N._createClass(p)}(F.JSONSupport);D.__decorate([y.property({type:Number,json:{write:!0}})],F.prototype,"value",void 0);D.__decorate([y.property({type:String,json:{write:!0}})],F.prototype,"label",void 0);D.__decorate([y.property({type:I,json:{type:[O.Integer],write:!0}})],F.prototype,"color",void 0);return F=D.__decorate([P.subclass("esri.renderers.support.ColormapInfo")],F)})},"esri/renderers/support/colorRampUtils":function(){define(["exports","../../Color","../../core/colorUtils","../../core/jsonMap"],
function(N,D,I,F){function y(d,t){if(!d||!t||d.length!==t.length)return!1;for(let G=0;G<d.length;G++)if(d[G]>t[G]+2||d[G]<t[G]-2)return!1;return!0}function O(d,t){if(d){t=t??u;var G=null;"algorithmic"===d.type?t.some(E=>{if(y(d.fromColor.toRgb(),E.fromColor)&&y(d.toColor.toRgb(),E.toColor))return G=E.id,!0}):"multipart"===d.type&&t.some(E=>{const a=d.colorRamps,n=E.colorRamps;if(a&&n&&a.length===n.length&&!n.some((m,f)=>{if(!y(a[f].fromColor.toRgb(),(new D(m.fromColor)).toRgb())||!y(a[f].toColor.toRgb(),
(new D(m.toColor)).toRgb()))return!0})){if(G)return!0;G=E.id}});return G}}function V(d){return(d=O(d))?h[d]:null}function L(d){d=d||{};const t=d.numColors||256;return{...d,numColors:t,distanceOffset:d.distanceOffset||0,interpolateAlpha:!!d.interpolateAlpha,distanceInterval:d.distanceInterval||1/(t-1),isCustomInterval:null!=d.isCustomInterval?d.isCustomInterval:null!==d.distanceInterval&&d.distanceInterval!==1/(t-1),weights:d.weights}}function P(d,t){let {fromColor:G,toColor:E}=d;3===G.length&&(G=
G.concat([255]));3===E.length&&(E=E.concat([255]));d=d.algorithm||"esriCIELabAlgorithm";var a=L(t);const {numColors:n,distanceOffset:m,isCustomInterval:f,interpolateAlpha:k}=a;if(1===n&&0===m)return[G];if(2===n&&0===m&&!f)return[G,E];var g={r:G[0],g:G[1],b:G[2]};t={r:E[0],g:E[1],b:E[2]};if("esriCIELabAlgorithm"===d){d=I.toLAB(g);t=I.toLAB(t);const {numColors:w,distanceOffset:C,distanceInterval:M,isCustomInterval:K}=a;let {l:x,a:q,b:A}=d;d=(t.l-x)*M;g=(t.a-q)*M;a=(t.b-A)*M;var b=[];if(C){var e=C/M;
x+=e*d;q+=e*g;A+=e*a}for(e=0;e<w-1;e++)b.push({l:x,a:q,b:A}),x+=d,q+=g,A+=a;b.push(K?{l:x,a:q,b:A}:t);t=b}else if("esriHSVAlgorithm"===d){d=I.toHSV(g);t=I.toHSV(t);const {numColors:w,distanceOffset:C,distanceInterval:M,isCustomInterval:K}=a;b=0===d.s;e=0===t.s;g=d.h;a=t.h;b&&!e?g=a:e&&!b&&(t={...t,h:g},a=g);b=Math.abs(a-g);180>b?a=(a-g)*M:(b=360-b,a=g>a?b*M:-b*M);b=(t.s-d.s)*M;e=(t.v-d.v)*M;let {s:x,v:q}=d;d=g;C&&(g=C/M,d=(d+g*a+360)%360,x+=g*b,q+=g*e);g=[];for(var v=0;v<w-1;v++)g.push({h:d,s:x,v:q}),
d=(d+a+360)%360,x+=b,q+=e;g.push(K?{h:d,s:x,v:q}:t);t=g}else{g=I.toLCH(g);t=I.toLCH(t);const {numColors:w,distanceOffset:C,distanceInterval:M,isCustomInterval:K}=a;a=g.h;b=t.h;d=2*Math.PI;a<=b?(e=b-a,a=b-a-d,a=Math.abs(a)<Math.abs(e)?a:e):(e=b+d-a,a=b-a,a=Math.abs(a)<Math.abs(e)?a:e);a*=M;b=(t.l-g.l)*M;e=(t.c-g.c)*M;let {l:x,c:q,h:A}=g;C&&(g=C/M,x+=g*b,q+=g*e,A=(A+g*a+d)%d);g=[];for(v=0;v<w-1;v++)g.push({l:x,c:q,h:A}),x+=b,q+=e,A=(A+a+d)%d;g.push(K?{l:x,c:q,h:A}:t);t=g}d=[];g=G[3]??255;a=((E[3]??
255)-g)/(n-1);for(b=0;b<n;b++){const {r:w,g:C,b:M}=I.toRGB(t[b]);d.push([w,C,M,k?Math.round(g+a*b):255])}return d}function B(d,t){const {numColors:G,interpolateAlpha:E}=L(t);t=t?.weights;({colorRamps:d}=d);if(t){const b=t.reduce((e,v)=>e+v);t=t.map(e=>e/b)}else{t=[];for(var a=0;a<d.length;a++)t[a]=1/d.length}a=[];let n=0,m=0;const f=1/(G-1);let k=!1;for(let b=0;b<d.length;b++){var g=k?0:n*f-m;let e=b===d.length-1?G-1-n:(t[b]-g)/f;k=Math.ceil(e)===e;e=Math.ceil(e);0!==e&&(g/=t[b],g=P(d[b],{numColors:e,
interpolateAlpha:E,distanceOffset:g,distanceInterval:f/t[b]}),n+=g.length,a.push(...g),m+=t[b])}t=[...d[d.length-1].toColor];3===t.length&&t.push(255);a.push(t);return a}function p(d,t){d="toJSON"in d?d.toJSON():d;return"multipart"===d.type?B(d,t):P(d,t)}function c(d){if(d)return{Algorithm:d.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:l(d.fromColor),ToColor:l(d.toColor)}}function l(d){d=I.toHSV(d);return{type:"HsvColor",Hue:d.h,Saturation:d.s,Value:d.v,AlphaValue:255}}
const u=[{id:"aspect_predefined",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"blackToWhite_predefined",fromColor:[0,
0,0],toColor:[255,255,255]},{id:"blueBright_predefined",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blueLightToDark_predefined",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blueGreenBright_predefined",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blueGreenLightToDark_predefined",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brownLightToDark_predefined",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brownToBlueGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[156,
85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brownToBlueGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficientBias_predefined",fromColor:[214,214,255],toColor:[0,57,148]},{id:"coldToHotDiverging_predefined",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"conditionNumber_predefined",
type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyanToPurple_predefined",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyanLightToBlueDark_predefined",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance_predefined",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1_predefined",
type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2_predefined",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,
255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors_predefined",fromColor:[255,235,214],toColor:[196,10,10]},{id:"grayLightToDark_predefined",fromColor:[219,219,219],toColor:[69,69,69]},{id:"greenBright_predefined",fromColor:[204,255,204],toColor:[14,204,14]},{id:"greenLightToDark_predefined",fromColor:[220,245,233],toColor:[34,
102,51]},{id:"greenToBlue_predefined",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orangeBright_predefined",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orangeLightToDark_predefined",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partialSpectrum_predefined",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},
{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partialSpectrum1Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partialSpectrum2Diverging_predefined",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,
63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pinkToYellowGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pinkToYellowGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation_predefined",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},
{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction_predefined",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purpleBright_predefined",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purpleToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[77,32,150],
toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purpleToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purpleBlueBright_predefined",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purpleBlueLightToDark_predefined",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purpleRedBright_predefined",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purpleRedLightToDark_predefined",
fromColor:[250,215,246],toColor:[143,17,57]},{id:"redBright_predefined",fromColor:[255,204,204],toColor:[219,0,0]},{id:"redLightToDark_predefined",fromColor:[255,224,224],toColor:[143,10,10]},{id:"redToBlueDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"redToBlueDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,
53,97]}]},{id:"redToGreen_predefined",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"redToGreenDivergingBright_predefined",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"redToGreenDivergingDark_predefined",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope_predefined",
type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrumFullBright_predefined",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrumFullDark_predefined",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},
{id:"spectrumFullLight_predefined",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface_predefined",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature_predefined",type:"multipart",
colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"whiteToBlack_predefined",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellowToDarkRed_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,
167,46],toColor:[107,0,0]}]},{id:"yellowToGreenToDarkBlue_predefined",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellowToRed_predefined",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellowGreenBright_predefined",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellowGreenLightToDark_predefined",fromColor:[215,240,175],toColor:[96,107,45]}],h={aspect_predefined:"Aspect",
blackToWhite_predefined:"Black to White",blueBright_predefined:"Blue Bright",blueLightToDark_predefined:"Blue Light to Dark",blueGreenBright_predefined:"Blue-Green Bright",blueGreenLightToDark_predefined:"Blue-Green Light to Dark",brownLightToDark_predefined:"Brown Light to Dark",brownToBlueGreenDivergingBright_predefined:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark_predefined:"Brown to Blue Green Diverging, Dark",coefficientBias_predefined:"Coefficient Bias",coldToHotDiverging_predefined:"Cold to Hot Diverging",
conditionNumber_predefined:"Condition Number",cyanToPurple_predefined:"Cyan to Purple",cyanLightToBlueDark_predefined:"Cyan-Light to Blue-Dark",distance_predefined:"Distance",elevation1_predefined:"Elevation #1",elevation2_predefined:"Elevation #2",errors_predefined:"Errors",grayLightToDark_predefined:"Gray Light to Dark",greenBright_predefined:"Green Bright",greenLightToDark_predefined:"Green Light to Dark",greenToBlue_predefined:"Green to Blue",orangeBright_predefined:"Orange Bright",orangeLightToDark_predefined:"Orange Light to Dark",
partialSpectrum_predefined:"Partial Spectrum",partialSpectrum1Diverging_predefined:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging_predefined:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright_predefined:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark_predefined:"Pink to YellowGreen Diverging, Dark",precipitation_predefined:"Precipitation",prediction_predefined:"Prediction",purpleBright_predefined:"Purple Bright",purpleToGreenDivergingBright_predefined:"Purple to Green Diverging, Bright",
purpleToGreenDivergingDark_predefined:"Purple to Green Diverging, Dark",purpleBlueBright_predefined:"Purple-Blue Bright",purpleBlueLightToDark_predefined:"Purple-Blue Light to Dark",purpleRedBright_predefined:"Purple-Red Bright",purpleRedLightToDark_predefined:"Purple-Red Light to Dark",redBright_predefined:"Red Bright",redLightToDark_predefined:"Red Light to Dark",redToBlueDivergingBright_predefined:"Red to Blue Diverging, Bright",redToBlueDivergingDark_predefined:"Red to Blue Diverging, Dark",redToGreen_predefined:"Red to Green",
redToGreenDivergingBright_predefined:"Red to Green Diverging, Bright",redToGreenDivergingDark_predefined:"Red to Green Diverging, Dark",slope_predefined:"Slope",spectrumFullBright_predefined:"Spectrum-Full Bright",spectrumFullDark_predefined:"Spectrum-Full Dark",spectrumFullLight_predefined:"Spectrum-Full Light",surface_predefined:"Surface",temperature_predefined:"Temperature",whiteToBlack_predefined:"White to Black",yellowToDarkRed_predefined:"Yellow to Dark Red",yellowToGreenToDarkBlue_predefined:"Yellow to Green to Dark Blue",
yellowToRed_predefined:"Yellow to Red",yellowGreenBright_predefined:"Yellow-Green Bright",yellowGreenLightToDark_predefined:"Yellow-Green Light to Dark"},r=new F.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right",
"Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue",
"Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","urple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright",
"Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright",
"Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});
N.PREDEFINED_COLOR_RAMP_NAME_MAP=h;N.PREDEFINED_JSON_COLOR_RAMPS=u;N.colorRampDict=r;N.convertColorRampToColormap=function(d,t){d=p(d,t);const G=t?.interpolateAlpha;d.forEach((E,a)=>{E.unshift(a);G||E.pop()});return d};N.convertColorRampToColors=p;N.getColorRampId=O;N.getColorRampJSON=function(d){const t=r.toJSON(d),G=Object.entries(h).find(E=>E[1]===t)?.[0];return(d=u.find(E=>E.id===G))?d.colorRamps?{type:"multipart",colorRamps:d.colorRamps.map(E=>({type:"algorithmic",algorithm:"esriCIELabAlgorithm",
fromColor:E.fromColor,toColor:E.toColor}))}:{type:"algorithmic",algorithm:"esriCIELabAlgorithm",fromColor:d.fromColor,toColor:d.toColor}:null};N.getColorRampName=V;N.getRFxArgColorRampValue=function(d){const t=V(d);if(d){if("algorithmic"===d.type)return{...c(d),Name:t};if(d.colorRamps)return d=d.colorRamps.map(c),{type:"MultiPartColorRamp",NumColorRamps:d.length,ArrayOfColorRamp:d,Name:t}}};N.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");N.rgbaConvertTo32Bit=function(d){d=
d.reverse().map(t=>{t=t.toString(16);return 2>t.length?"0"+t:t});return 4294967295&Number.parseInt(d.join(""),16)};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define(["exports"],function(N){function D(B,p){const c=[];let l,u;if(B[0].length!==p.length)throw Error("dimensions do not match");const h=B.length,r=B[0].length;let d=0;for(l=0;l<h;l++){for(u=d=0;u<r;u++)d+=B[l][u]*p[u];c.push(d)}return c}function I(B){B=[B.r/255,B.g/255,B.b/255].map(p=>
.04045>=p?p/12.92:((p+.055)/1.055)**2.4);B=D(L,B);return{x:100*B[0],y:100*B[1],z:100*B[2]}}function F(B){B=D(P,[B.x/100,B.y/100,B.z/100]).map(p=>Math.min(1,Math.max(.0031308>=p?12.92*p:1.055*p**(1/2.4)-.055,0)));return{r:Math.round(255*B[0]),g:Math.round(255*B[1]),b:Math.round(255*B[2])}}function y(B){B=[B.x/95.047,B.y/100,B.z/108.883].map(p=>p>(6/29)**3?p**(1/3):1/3*(29/6)**2*p+4/29);return{l:116*B[1]-16,a:500*(B[0]-B[1]),b:200*(B[1]-B[2])}}function O(B){const p=B.l;B=[(p+16)/116+B.a/500,(p+16)/
116,(p+16)/116-B.b/200].map(c=>c>6/29?c**3:3*(6/29)**2*(c-4/29));return{x:95.047*B[0],y:100*B[1],z:108.883*B[2]}}function V(B){if("r"in B&&"g"in B&&"b"in B)return B;if("l"in B&&"c"in B&&"h"in B){var p=B.c,c=B.h;return F(O({l:B.l,a:p*Math.cos(c),b:p*Math.sin(c)}))}if("l"in B&&"a"in B&&"b"in B)return F(O(B));if("x"in B&&"y"in B&&"z"in B)return F(B);if("h"in B&&"s"in B&&"v"in B){c=(B.h+360)%360/60;p=B.v/100*255;B=B.s/100*p;const l=B*(1-Math.abs(c%2-1));switch(Math.floor(c)){case 0:c={r:B,g:l,b:0};break;
case 1:c={r:l,g:B,b:0};break;case 2:c={r:0,g:B,b:l};break;case 3:c={r:0,g:l,b:B};break;case 4:c={r:l,g:0,b:B};break;case 5:case 6:c={r:B,g:0,b:l};break;default:c={r:0,g:0,b:0}}c.r=Math.round(c.r+p-B);c.g=Math.round(c.g+p-B);c.b=Math.round(c.b+p-B);return c}return B}const L=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],P=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];N.darken=function(B,p){B=y(I(B));B.l*=1-p;return F(O(B))};N.toHSV=function(B){if("h"in B&&"s"in
B&&"v"in B)return B;var p=V(B);B=p.r;const c=p.g,l=p.b;p=Math.max(B,c,l);const u=p-Math.min(B,c,l);B=0===u?0:p===B?(c-l)/u%6:p===c?(l-B)/u+2:(B-c)/u+4;0>B&&(B+=6);return{h:60*B,s:100*(0===u?0:u/p),v:100/255*p}};N.toLAB=function(B){return"l"in B&&"a"in B&&"b"in B?B:y(I(V(B)))};N.toLCH=function(B){if(!("l"in B&&"c"in B&&"h"in B)){var p=y(I(V(B)));B=p.l;var c=p.a;const l=p.b;p=Math.sqrt(c*c+l*l);c=Math.atan2(l,c);c=0<c?c:c+2*Math.PI;B={l:B,c:p,h:c}}return B};N.toRGB=V;N.toXYZ=function(B){return"x"in
B&&"y"in B&&"z"in B?B:I(V(B))};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/RasterShadedReliefRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../rest/support/colorRamps".split(" "),function(N,
D,I,F,y,O,V,L,P,B){var p;I=p=function(c){function l(h){h=u.call(this,h);h.altitude=45;h.azimuth=315;h.colorRamp=null;h.hillshadeType="traditional";h.pixelSizePower=.664;h.pixelSizeFactor=.024;h.scalingType="none";h.type="raster-shaded-relief";h.zFactor=1;return h}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c.readColorRamp=function(h){return B.fromJSON(h)};c.clone=function(){return new p({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,
pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:F.clone(this.colorRamp)})};return N._createClass(l)}(I.JSONSupport);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"altitude",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"azimuth",void 0);D.__decorate([y.property({types:B.types,json:{write:!0}})],I.prototype,"colorRamp",void 0);D.__decorate([L.reader("colorRamp")],I.prototype,"readColorRamp",null);D.__decorate([y.property({type:["traditional",
"multi-directional"],json:{write:!0}})],I.prototype,"hillshadeType",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"pixelSizePower",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"pixelSizeFactor",void 0);D.__decorate([y.property({type:["none","adjusted"],json:{write:!0}})],I.prototype,"scalingType",void 0);D.__decorate([V.enumeration({rasterShadedRelief:"raster-shaded-relief"})],I.prototype,"type",void 0);D.__decorate([y.property({type:Number,
json:{write:!0}})],I.prototype,"zFactor",void 0);return I=p=D.__decorate([P.subclass("esri.renderers.RasterShadedReliefRenderer")],I)})},"esri/renderers/RasterStretchRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./support/stretchRendererUtils ../rest/support/colorRamps".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c){var l;I=l=function(u){function h(d){d=r.call(this,d);d.colorRamp=null;d.computeGamma=!1;d.dynamicRangeAdjustment=!1;d.gamma=[];d.maxPercent=null;d.minPercent=null;d.numberOfStandardDeviations=null;d.outputMax=null;d.outputMin=null;d.sigmoidStrengthLevel=null;d.statistics=[];d.histograms=null;d.useGamma=!1;d.stretchType="none";d.type="raster-stretch";return d}N._inherits(h,u);var r=N._createSuper(h);u=h.prototype;u.readColorRamp=function(d){if(d)return c.fromJSON(d)};
u.writeStatistics=function(d,t,G){d?.length&&(Array.isArray(d[0])||(d=d.map(E=>[E.min,E.max,E.avg,E.stddev])),t[G]=d)};u.readStretchType=function(d,t){d=t.stretchType;"number"===typeof d&&(d=p.stretchTypeFunctionEnum[d]);return p.stretchTypeJSONDict.read(d)};u.clone=function(){return new l({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:F.clone(this.statistics),gamma:F.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,
numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:F.clone(this.colorRamp),histograms:F.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})};return N._createClass(h)}(I.JSONSupport);D.__decorate([y.property({types:c.types,json:{write:!0}})],I.prototype,"colorRamp",void 0);D.__decorate([L.reader("colorRamp")],I.prototype,"readColorRamp",null);D.__decorate([y.property({type:Boolean,json:{write:!0}})],I.prototype,
"computeGamma",void 0);D.__decorate([y.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],I.prototype,"dynamicRangeAdjustment",void 0);D.__decorate([y.property({type:[Number],json:{write:!0}})],I.prototype,"gamma",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"maxPercent",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"minPercent",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"numberOfStandardDeviations",
void 0);D.__decorate([y.property({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],I.prototype,"outputMax",void 0);D.__decorate([y.property({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],I.prototype,"outputMin",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"sigmoidStrengthLevel",void 0);D.__decorate([y.property({json:{type:[[Number]],write:!0}})],I.prototype,"statistics",void 0);D.__decorate([y.property()],I.prototype,"histograms",void 0);
D.__decorate([B.writer("statistics")],I.prototype,"writeStatistics",null);D.__decorate([y.property({type:Boolean,json:{write:!0}})],I.prototype,"useGamma",void 0);D.__decorate([y.property({type:p.stretchTypeJSONDict.apiValues,json:{type:p.stretchTypeJSONDict.jsonValues,write:p.stretchTypeJSONDict.write}})],I.prototype,"stretchType",void 0);D.__decorate([L.reader("stretchType",["stretchType"])],I.prototype,"readStretchType",null);D.__decorate([V.enumeration({rasterStretch:"raster-stretch"})],I.prototype,
"type",void 0);return I=l=D.__decorate([P.subclass("esri.renderers.RasterStretchRenderer")],I)})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(N,D){D=new D.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});N.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};
N.stretchTypeJSONDict=D;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/VectorFieldRenderer":function(){define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../Color ../geometry ../Graphic ../symbols ../core/jsonMap ../core/JSONSupport ../core/lang ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/support/normalizeUtils ../layers/support/rasterFunctions/vectorFieldUtils ./ClassBreaksRenderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./visualVariables/RotationVariable ./visualVariables/SizeVariable ./visualVariables/support/visualVariableUtils ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../symbols/support/utils ../geometry/Point ../symbols/PictureMarkerSymbol".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a,n,m,f,k,g,b,e){var v;const w=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]);F=new V.JSONMap({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"});
V=new V.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});L=v=function(C){function M(x){x=K.call(this,x);x.attributeField="Magnitude";x.flowRepresentation="flow-from";x.rotationType="arithmetic";x.style="single-arrow";x.symbolTileSize=50;x.type="vector-field";return x}N._inherits(M,C);var K=N._createSuper(M);C=M.prototype;C.readInputUnit=function(x,q){return w.has(x)?d.unitKebabDict.fromJSON(x):null};C.readOutputUnit=function(x,q){return w.has(x)?d.unitKebabDict.fromJSON(x):null};C.clone=function(){return new v({attributeField:this.attributeField,
flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:P.clone(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})};C.getGraphicsFromPixelData=async function(x,q=!1,A=[]){const H=[];var Q=d.getUnitConversionFactor(this.inputUnit,this.outputUnit),S=this.rotationVariables[0]?.rotationType||this.rotationType;q=q?d.convertVectorFieldData(x.pixelBlock,"vector-uv",S,Q):d.convertVectorFieldUnit(x.pixelBlock,
"vector-magdir",Q);if(B.isNone(q))return H;x=x.extent;Q=B.isSome(q.mask)&&0<q.mask.length;S=0;const z=(x.xmax-x.xmin)/q.width,J=(x.ymax-x.ymin)/q.height;for(let W=0;W<q.height;W++)for(let Z=0;Z<q.width;Z++,S++){let Y=new b({x:x.xmin+Z*z+z/2,y:x.ymax-W*J-J/2,spatialReference:x.spatialReference});Y=(await r.normalizeCentralMeridian(Y))[0];var R=A.some(X=>X.intersects(Y));Q&&!q.mask[S]||R||(R=new y({geometry:{type:"point",x:Y.x,y:Y.y,spatialReference:x.spatialReference},attributes:{Magnitude:q.pixels[0][S],
Direction:q.pixels[1][S]}}),R.symbol=this._getVisualVariablesAppliedSymbol(R),H.push(R))}return H};C.getSymbol=function(x,q){};C.getSymbolAsync=async function(x,q){};C.getSymbols=function(){return[]};C.getClassBreakInfos=function(){return this.styleRenderer?.classBreakInfos};C.getDefaultSymbol=function(){return this.styleRenderer?.defaultSymbol};C._getDefaultSymbol=function(x){return new k({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new f({width:0}),size:20,color:x||new I([0,92,230])})};
C._getVisualVariablesAppliedSymbol=function(x){if(x){var q=this.styleRenderer?.getSymbol(x)?.clone(),A=this.sizeVariables,H=this.rotationVariables;A&&A.length&&this.sizeVariables.forEach(Q=>g.applySizesToSymbol(q,m.getAllSizes([Q],x)));H&&H.length&&(x.attributes.Direction+="flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||"ocean-current-m"===this.style)?0:180,this.rotationVariables.forEach(Q=>g.applyRotationToSymbol(q,m.getRotationAngle(Q,x),Q.axis)));return q}};C._createStyleRenderer=
function(x){let q={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(x){case "single-arrow":q=this._createSingleArrowRenderer();break;case "beaufort-kn":q=this._createBeaufortKnotsRenderer();break;case "beaufort-m":q=this._createBeaufortMeterRenderer();break;case "beaufort-ft":q=this._createBeaufortFeetRenderer();break;case "beaufort-mi":q=this._createBeaufortMilesRenderer();break;case "beaufort-km":q=this._createBeaufortKilometersRenderer();break;case "ocean-current-m":q=this._createCurrentMeterRenderer();
break;case "ocean-current-kn":q=this._createCurrentKnotsRenderer();break;case "simple-scalar":q=this._createSimpleScalarRenderer();break;case "wind-barb":q=this._createWindBarbsRenderer();break;case "classified-arrow":q=this._createClassifiedArrowRenderer()}return new t(q)};C._createSingleArrowRenderer=function(){return{defaultSymbol:this._getDefaultSymbol()}};C._createBeaufortKnotsRenderer=function(){const x=this._getDefaultSymbol(new I([214,47,39])),q=this._getClassBreaks([0,1,3,6,10,16,21,27,33,
40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]]);return{defaultSymbol:x,classBreakInfos:q}};C._createBeaufortMeterRenderer=function(){const x=this._getDefaultSymbol(new I([214,47,39])),q=this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],
[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:x,classBreakInfos:q}};C._createBeaufortFeetRenderer=function(){const x=this._getDefaultSymbol(new I([214,47,39]));var q=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q=q.map(A=>3.28084*A);q=this._getClassBreaks(q,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:x,classBreakInfos:q}};
C._createBeaufortMilesRenderer=function(){const x=this._getDefaultSymbol(new I([214,47,39]));var q=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q=q.map(A=>2.23694*A);q=this._getClassBreaks(q,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:x,classBreakInfos:q}};C._createBeaufortKilometersRenderer=function(){const x=this._getDefaultSymbol(new I([214,
47,39]));var q=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];q=q.map(A=>3.6*A);q=this._getClassBreaks(q,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:x,classBreakInfos:q}};C._createCurrentMeterRenderer=function(){const x=this._getDefaultSymbol(new I([177,177,177])),q=this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,
177]]);return{defaultSymbol:x,classBreakInfos:q}};C._createCurrentKnotsRenderer=function(){const x=this._getDefaultSymbol(new I([177,177,177])),q=this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]]);return{defaultSymbol:x,classBreakInfos:q}};C._createClassifiedArrowRenderer=function(){const x=this._getDefaultSymbol(new I([56,168,0]));var q=[0,1E-6,3.5,7,10.5,14];if(this.sizeVariables?.length){const A=
this.sizeVariables[0].minDataValue,H=this.sizeVariables[0].maxDataValue;if(A&&H){const Q=(H-A)/5;q=Array.from(Array(6).keys()).map(S=>A+Q*S)}}q=this._getClassBreaks(q,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]]);return{defaultSymbol:x,classBreakInfos:q}};C._createSimpleScalarRenderer=function(){return{defaultSymbol:e.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII\x3d",
height:20,width:20,type:"esriPMS",angle:0})}};C._createWindBarbsRenderer=function(){const x=Array.from(Array(31).keys()).map(Q=>5*Q),q=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"90-95",
path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"}],A=e.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",
height:20,width:20,type:"esriPMS",angle:0}),H=x.map((Q,S)=>{if(S!==x.length-1)if(0===S)var z={minValue:Q,maxValue:x[S+1],symbol:A};else z=e.fromJSON({type:"esriPMS",imageData:q[S].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0}),z={minValue:Q,maxValue:x[S+1],symbol:z};return new E(z)});return{defaultSymbol:A,classBreakInfos:H}};C._getClassBreaks=function(x,q){return q.map((A,H)=>new E({minValue:x[H],maxValue:x[H+1],symbol:this._getDefaultSymbol(new I(A))}))};N._createClass(M,[{key:"styleRenderer",
get:function(){const x=this.attributeField,q=this._createStyleRenderer(this.style);q.field=x;return q}},{key:"sizeVariables",get:function(){const x=[];if(this.visualVariables)for(var q of this.visualVariables)"size"===q.type&&x.push(q);0===x.length&&(q=new n({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize}),this.visualVariables?this.visualVariables.push(q):this._set("visualVariables",[q]),x.push(q));return x}},{key:"rotationVariables",get:function(){const x=[];if(this.visualVariables)for(var q of this.visualVariables)"rotation"===
q.type&&x.push(q);0===x.length&&(q=new a({field:"Direction",rotationType:this.rotationType}),this.visualVariables?this.visualVariables.push(q):this._set("visualVariables",[q]),x.push(q));return x}}]);return M}(G.VisualVariablesMixin(L.JSONSupport));D.__decorate([p.property({type:String,json:{write:!0}})],L.prototype,"attributeField",void 0);D.__decorate([p.property({type:V.apiValues,json:{type:V.jsonValues,read:{reader:V.read},write:{writer:V.write}}})],L.prototype,"flowRepresentation",void 0);D.__decorate([p.property({type:["geographic",
"arithmetic"],json:{write:!0}})],L.prototype,"rotationType",void 0);D.__decorate([p.property({type:F.apiValues,json:{type:F.jsonValues,read:{reader:F.read},write:{writer:F.write}}})],L.prototype,"style",void 0);D.__decorate([p.property({json:{write:!0}})],L.prototype,"symbolTileSize",void 0);D.__decorate([p.property({type:d.unitKebabDict.apiValues,json:{type:d.unitKebabDict.jsonValues,write:{writer:d.unitKebabDict.write}}})],L.prototype,"inputUnit",void 0);D.__decorate([u.reader("inputUnit")],L.prototype,
"readInputUnit",null);D.__decorate([p.property({type:d.unitKebabDict.apiValues,json:{type:d.unitKebabDict.jsonValues,read:{reader:d.unitKebabDict.read},write:{writer:d.unitKebabDict.write}}})],L.prototype,"outputUnit",void 0);D.__decorate([u.reader("outputUnit")],L.prototype,"readOutputUnit",null);D.__decorate([l.enumeration({vectorField:"vector-field"})],L.prototype,"type",void 0);D.__decorate([p.property({type:t})],L.prototype,"styleRenderer",null);D.__decorate([p.property({type:n})],L.prototype,
"sizeVariables",null);D.__decorate([p.property({type:a})],L.prototype,"rotationVariables",null);return L=v=D.__decorate([h.subclass("esri.renderers.VectorFieldRenderer")],L)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../../../core/maybe","../PixelBlock","./pixelUtils"],function(N,D,I,F,y){function O(k,g){return d.get(k)/d.get(g)||1}function V(k,g="geographic"){const [b,e]=k;k=Math.sqrt(b*b+e*e);let v=Math.atan2(e,b)*t;v=(360+v)%
360;"geographic"===g&&(v=(450-v)%360);return[k,v]}function L(k,g="geographic"){let b=k[1];"geographic"===g&&(b=(450-b)%360);b%=360;k=k[0];return[k*Math.cos(b/t),k*Math.sin(b/t)]}function P(k,g,b="geographic",e=1){if(!y.isValidPixelBlock(k))return k;const {pixels:v,width:w,height:C}=k;var M=w*C;const K=v[0],x=v[1],q=k.pixelType.startsWith("f")?k.pixelType:"f32",A=F.createEmptyBand(q,M);M=F.createEmptyBand(q,M);let H=0;for(let Q=0;Q<C;Q++)for(let S=0;S<w;S++)"vector-uv"===g?([A[H],M[H]]=V([K[H],x[H]],
b),A[H]*=e):([A[H],M[H]]=L([K[H],x[H]],b),A[H]*=e,M[H]*=e),H++;k=new F({pixelType:q,width:k.width,height:k.height,mask:k.mask,validPixelCount:k.validPixelCount,maskIsAlpha:k.maskIsAlpha,pixels:[A,M]});k.updateStatistics();return k}function B(k=0,g=0,b=Math.PI,e=!0){e&&(b=(2*Math.PI-b)%(2*Math.PI));e=e?-1:1;const v=-7*e,w=-2*e,C=-16*e,[M,K]=c(0,g+13*e,b,21.75),[x,q]=c(k-5.5,g+v,b,21.75),[A,H]=c(k+5.5,g+v,b,21.75),[Q,S]=c(k-1.5,g+w,b,21.75),[z,J]=c(k+1.5,g+w,b,21.75),[R,W]=c(k-1.5,g+C,b,21.75),[Z,Y]=
c(k+1.5,g+C,b,21.75);return[M,K,x,q,Q,S,z,J,A,H,R,W,Z,Y]}function p(k=0,g=Math.PI,b=!0){b&&(g=(2*Math.PI-g)%(2*Math.PI));var e=b?-1:1,v=5*e;const w=20*e,C=25*e;e*=2;const M=b?1:-1;b=5*M;let [K,x]=[0+b,0-w],[q,A]=[K+2*M,x],[H,Q]=[q-0*M,A+e],[S,z]=[0-b,0-C],[J,R]=[S+0*M,z-e],W=Math.ceil(k/5),Z=Math.floor(W/10);W-=8*Z;k=[];const Y=[];for(let pa=0;pa<W/2;pa++,Z--){0>=Z&&1===W%2&&pa===(W-1)/2&&(S=0,J=S+0*M,z=(z+x)/2,R=z-e);const [ma,sa]=c(S,z,g,45);if(0<Z){const [oa,wa]=c(q,z,g,45),[ta,ua]=c(K,x,g,45);
k.push(oa);k.push(wa);k.push(ma);k.push(sa);k.push(ta);k.push(ua)}else{const [oa,wa]=c(q,A,g,45),[ta,ua]=c(H,Q,g,45),[va,qa]=c(J,R,g,45);Y.push(ma);Y.push(sa);Y.push(va);Y.push(qa);Y.push(ta);Y.push(ua);Y.push(oa);Y.push(wa)}z+=v;x+=v;A+=v;Q+=v;R+=v}const [X,T]=c(0+b,0+w,g,45);v=7*M;const [U,aa]=c(0+v,0+w,g,45),[ba,fa]=c(0+b,0-C,g,45),[ja,ia]=c(0+v,0-C,g,45);return{pennants:k,barbs:Y,shaft:[X,T,U,aa,ba,fa,ja,ia]}}function c(k,g,b,e=1){return[Math.sqrt(k*k+g*g)/e,(2*Math.PI+(2*Math.PI+Math.atan2(g,
k))%(2*Math.PI)-b)%(2*Math.PI)]}function l(k,g,b,e){b=O(e||"knots",b);for(e=1;e<g.length;e++)if(e===g.length-1){if(k<g[e]*b)break}else if(k<=g[e]*b)break;return Math.min(e-1,g.length-2)}function u(k,g,b,e,v){let w=0;switch(g){case "beaufort_kn":w=l(k,a,"knots",b);break;case "beaufort_km":w=l(k,a,"kilometer-per-hour",b);break;case "beaufort_ft":w=l(k,a,"feet-per-second",b);break;case "beaufort_m":w=l(k,a,"meter-per-second",b);break;case "classified_arrow":w=l(k,v??[],e,b);break;case "ocean_current_m":w=
l(k,n,"meter-per-second",b);break;case "ocean_current_kn":w=l(k,m,"knots",b)}return w}function h(k,g){const {style:b,inputUnit:e,outputUnit:v,breakValues:w}=g,C=G.fromJSON(e),M=G.fromJSON(v);let K=0,x=0;const {width:q,height:A,mask:H}=k,Q=k.pixels[0];k=k.pixels[1];var S=I.isSome(H)?H.filter(R=>0<R).length:q*A;const z=new Float32Array(42*S);S=new Uint32Array(15*S);g=g.invertDirection?B(0,0,0,!1):E;for(let R=0;R<A;R++)for(let W=0;W<q;W++){var J=R*q+W;if(!H||H[R*q+W]){const Z=(k[J]+360)%360/180*Math.PI,
Y=u(Q[J],b,C,M,w);for(let X=0;X<g.length;X+=2)z[K++]=(W+.5)/q,z[K++]=(R+.5)/A,z[K++]=g[X],z[K++]=g[X+1]+Z,z[K++]=Y,z[K++]=Q[J];J=7*(K/42-1);S[x++]=J;S[x++]=J+1;S[x++]=J+2;S[x++]=J+0;S[x++]=J+4;S[x++]=J+3;S[x++]=J+0;S[x++]=J+2;S[x++]=J+3;S[x++]=J+2;S[x++]=J+5;S[x++]=J+3;S[x++]=J+5;S[x++]=J+6;S[x++]=J+3}}return{vertexData:z,indexData:S}}function r(k,g){let b=0,e=0;const {width:v,height:w,mask:C}=k;k=k.pixels[0];const M=[],K=[];var x=G.fromJSON(g.inputUnit);x=O(x,"knots");g="wind_speed"===g.style?5:
Number.MAX_VALUE;for(let A=0;A<w;A++)for(let H=0;H<v;H++){var q=k[A*v+H]*x;if((!C||C[A*v+H])&&q<g){for(let Q=0;4>Q;Q++)M[b++]=(H+.5)/v,M[b++]=(A+.5)/w,M[b++]=2>Q?-.5:.5,M[b++]=0===Q%2?-.5:.5,M[b++]=0,M[b++]=q;q=4*(b/24-1);K[e++]=q;K[e++]=q+1;K[e++]=q+2;K[e++]=q+1;K[e++]=q+2;K[e++]=q+3}}return{vertexData:new Float32Array(M),indexData:new Uint32Array(K)}}const d=new Map;d.set("meter-per-second",1);d.set("kilometer-per-hour",.277778);d.set("knots",.514444);d.set("feet-per-second",.3048);d.set("mile-per-hour",
.44704);const t=180/Math.PI,G=new D.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),E=B(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],n=[0,.5,1,1.5,2],m=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],f=[];N.convertToLocalDirections=function(k,g,b,e="geographic"){if(!y.isValidPixelBlock(k)||I.isNone(b))return k;k="vector-magdir"===g?k.clone():I.unwrap(P(k,g));const v=k.pixels[1];for(let w=
0;w<v.length;w++)v[w]="geographic"===e?(v[w]+b[w]+270)%360:(v[w]+360-b[w])%360;return"vector-magdir"===g?k:P(k,"vector-magdir")};N.convertVectorFieldData=P;N.convertVectorFieldUnit=function(k,g,b=1){if(1===b||!y.isValidPixelBlock(k))return k;k=k.clone();const {pixels:e,width:v,height:w}=k,C=e[0],M=e[1];let K=0;for(let x=0;x<w;x++)for(let q=0;q<v;q++)"vector-uv"===g?(C[K]*=b,M[K]*=b):C[K]*=b,K++;k.updateStatistics();return k};N.createVFMesh=function(k,g){if("simple_scalar"===g.style)g=r(k,g);else if("wind_speed"===
g.style){if(0===f.length)for(var b=0;30>b;b++)f.push(p(5*b,0,!g.invertDirection));g=G.fromJSON(g.inputUnit);g=O(g,"knots");const {width:C,height:M,mask:K}=k;b=k.pixels[0];k=k.pixels[1];const x=[],q=[];let A=0,H=0;for(let Q=0;Q<M;Q++)for(let S=0;S<C;S++){var e=Q*C+S,v=b[e]*g;if((!K||K[Q*C+S])&&5<=v){const z=(k[e]+360)%360/180*Math.PI,{pennants:J,barbs:R,shaft:W}=f[Math.min(Math.floor(v/5),29)];if(0===J.length+R.length)continue;e=x.length/6;const Z=(S+.5)/C,Y=(Q+.5)/M;for(var w=0;w<J.length;w+=2)x[A++]=
Z,x[A++]=Y,x[A++]=J[w],x[A++]=J[w+1]+z,x[A++]=0,x[A++]=v;for(w=0;w<R.length;w+=2)x[A++]=Z,x[A++]=Y,x[A++]=R[w],x[A++]=R[w+1]+z,x[A++]=0,x[A++]=v;for(w=0;w<W.length;w+=2)x[A++]=Z,x[A++]=Y,x[A++]=W[w],x[A++]=W[w+1]+z,x[A++]=0,x[A++]=v;for(v=0;v<J.length/6;v++)q[H++]=e,q[H++]=e+1,q[H++]=e+2,e+=3;for(v=0;v<R.length/8;v++)q[H++]=e,q[H++]=e+1,q[H++]=e+2,q[H++]=e+1,q[H++]=e+2,q[H++]=e+3,e+=4;q[H++]=e+0;q[H++]=e+1;q[H++]=e+2;q[H++]=e+1;q[H++]=e+3;q[H++]=e+2;e+=4}}g={vertexData:new Float32Array(x),indexData:new Uint32Array(q)}}else g=
h(k,g);return g};N.createVFMeshScalar=r;N.getUnitConversionFactor=O;N.sampleVectorField=function(k,g,b,e=[0,0],v=.5){const {width:w,height:C,mask:M}=k,[K,x]=k.pixels,[q,A]=e;k=Math.round((w-q)/b);e=Math.round((C-A)/b);var H=k*e;const Q=new Float32Array(H),S=new Float32Array(H);H=new Uint8Array(H);g="vector-uv"===g;for(let J=0;J<e;J++)for(let R=0;R<k;R++){let W=0;const Z=J*k+R,Y=Math.max(0,J*b+A),X=Math.max(0,R*b+q),T=Math.min(C,Y+b),U=Math.min(w,X+b);for(let aa=Y;aa<T;aa++)for(let ba=X;ba<U;ba++){var z=
aa*w+ba;if(!M||M[z]){W++;z=g?[K[z],x[z]]:[K[z],(360+x[z])%360];const [fa,ja]=g?z:L(z);Q[Z]+=fa;S[Z]+=ja}}if(W>=(T-Y)*(U-X)*(1-v)){H[Z]=1;const [aa,ba]=V([Q[Z]/W,S[Z]/W]);Q[Z]=aa;S[Z]=ba}else H[Z]=0,Q[Z]=0,S[Z]=0}b=new F({width:k,height:e,pixels:[Q,S],mask:H});b.updateStatistics();return b};N.snapImageToSymbolTile=function(k,g,b,e,v){if(I.isNone(v)||!v.spatialReference.equals(k.spatialReference))return{extent:k,width:Math.round(g/e),height:Math.round(b/e),resolution:k.width/g};const w=v.xmin;v=v.ymax;
g=(k.xmax-k.xmin)/g*e;b=(k.ymax-k.ymin)/b*e;k.xmin=w+Math.floor((k.xmin-w)/g)*g;k.xmax=w+Math.ceil((k.xmax-w)/g)*g;k.ymin=v+Math.floor((k.ymin-v)/b)*b;k.ymax=v+Math.ceil((k.ymax-v)/b)*b;return{extent:k,width:Math.round(k.width/g),height:Math.round(k.height/b),resolution:(g+b)/2}};N.unitKebabDict=G;N.uvComponentToVector=V;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c){var l;F=l=function(u){function h(d){d=r.call(this,d);d.width=null;d.height=null;d.pixelType="f32";d.validPixelCount=null;d.mask=null;d.maskIsAlpha=!1;d.premultiplyAlpha=!1;d.statistics=null;d.depthCount=1;return d}N._inherits(h,u);var r=N._createSuper(h);h.createEmptyBand=function(d,t){return new (l.getPixelArrayConstructor(d))(t)};h.getPixelArrayConstructor=function(d){let t;switch(d){case "u1":case "u2":case "u4":case "u8":t=Uint8Array;break;case "u16":t=Uint16Array;
break;case "u32":t=Uint32Array;break;case "s8":t=Int8Array;break;case "s16":t=Int16Array;break;case "s32":t=Int32Array;break;case "f32":t=Float32Array;break;case "f64":t=Float64Array;break;case "c64":case "c128":case "unknown":t=Float32Array}return t};u=h.prototype;u.castPixelType=function(d){if(!d)return"f32";d=d.toLowerCase();["u1","u2","u4"].includes(d)?d="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(d)||(d="f32");return d};u.getPlaneCount=function(){return this.pixels?.length};
u.addData=function(d){if(!d.pixels||d.pixels.length!==this.width*this.height)throw new I("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(d.pixels);this.statistics.push(d.statistics??new p.SimpleBandStatistics)};u.getAsRGBA=function(){const d=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(d);
break;default:this._fillFrom8Bit(d)}return new Uint8ClampedArray(d)};u.getAsRGBAFloat=function(){const d=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(d);return d};u.updateStatistics=function(){if(this.pixels){this.statistics=this.pixels.map(G=>this._calculateBandStatistics(G,this.mask));var d=this.mask,t=0;if(V.isSome(d))for(let G=0;G<d.length;G++)d[G]&&t++;else t=this.width*this.height;this.validPixelCount=t}};u.clamp=function(d){if(d&&"f64"!==d&&"f32"!==d&&this.pixels){var [t,
G]=c.getPixelValueRange(d),E=this.pixels,a=this.width*this.height,n=E.length,m=[];for(let b=0;b<n;b++){var f=l.createEmptyBand(d,a);var k=E[b];for(let e=0;e<a;e++){var g=k[e];f[e]=g>G?G:g<t?t:g}m.push(f)}this.pixels=m;this.pixelType=d}};u.extractBands=function(d){const {pixels:t,statistics:G}=this;if(V.isNone(d)||0===d.length||!t||0===t.length)return this;var E=t.length;const a=d.some(n=>n>=t.length);E=E===d.length&&!d.some((n,m)=>n!==m);return a||E?this:new l({pixelType:this.pixelType,width:this.width,
height:this.height,mask:this.mask,validPixelCount:this.validPixelCount,maskIsAlpha:this.maskIsAlpha,pixels:d.map(n=>t[n]),statistics:G&&d.map(n=>G[n])})};u.clone=function(){const d=new l({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});V.isSome(this.mask)&&(d.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));let t;const G=l.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){d.pixels=
[];const E=!!this.pixels[0].slice;for(t=0;t<this.pixels.length;t++)d.pixels[t]=E?this.pixels[t].slice(0,this.pixels[t].length):new G(this.pixels[t])}if(this.statistics)for(d.statistics=[],t=0;t<this.statistics.length;t++)d.statistics[t]=y.clone(this.statistics[t]);d.premultiplyAlpha=this.premultiplyAlpha;return d};u._fillFrom8Bit=function(d){const {mask:t,maskIsAlpha:G,premultiplyAlpha:E,pixels:a}=this;if(d&&a&&a.length){var n,m;var f=n=m=a[0];3<=a.length?(n=a[1],m=a[2]):2===a.length&&(n=a[1]);var k=
new Uint32Array(d),g=this.width*this.height;if(f.length!==g)O.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(V.isSome(t)&&t.length===g)if(G)for(d=0;d<g;d++){const b=t[d];if(b){const e=b/255;k[d]=E?b<<24|m[d]*e<<16|n[d]*e<<8|f[d]*e:b<<24|m[d]<<16|n[d]<<8|f[d]}}else for(d=0;d<g;d++)t[d]&&(k[d]=-16777216|m[d]<<16|n[d]<<8|f[d]);else for(d=0;d<g;d++)k[d]=-16777216|m[d]<<16|n[d]<<8|f[d]}else O.getLogger(this.declaredClass).error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};u._fillFromNon8Bit=function(d){const {pixels:t,mask:G,statistics:E}=this;if(d&&t&&t.length){var a=this.pixelType,n=1,m=0;n=1;if(E&&0<E.length){for(var f of E)null!=f.minValue&&(m=Math.min(m,f.minValue)),null!=f.maxValue&&null!=f.minValue&&(n=Math.max(n,f.maxValue-f.minValue));n=255/n}else n=255,"s8"===a?(m=-128,n=127):"u16"===a?n=65535:"s16"===a?(m=-32768,n=32767):"u32"===a?n=4294967295:"s32"===a?(m=-2147483648,n=2147483647):"f32"===a?
(m=-3.4*1E39,n=3.4*1E39):"f64"===a&&(m=-Number.MAX_VALUE,n=Number.MAX_VALUE),n=255/(n-m);d=new Uint32Array(d);a=this.width*this.height;var k,g,b;f=k=g=t[0];if(f.length!==a)return O.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=t.length)if(k=t[1],3<=t.length&&(g=t[2]),V.isSome(G)&&G.length===a)for(b=0;b<a;b++)G[b]&&(d[b]=-16777216|(g[b]-m)*n<<16|(k[b]-m)*n<<8|(f[b]-m)*n);else for(b=0;b<a;b++)d[b]=-16777216|(g[b]-m)*n<<16|(k[b]-m)*n<<
8|(f[b]-m)*n;else if(V.isSome(G)&&G.length===a)for(b=0;b<a;b++)k=(f[b]-m)*n,G[b]&&(d[b]=-16777216|k<<16|k<<8|k);else for(b=0;b<a;b++)k=(f[b]-m)*n,d[b]=-16777216|k<<16|k<<8|k}else O.getLogger(this.declaredClass).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};u._fillFrom32Bit=function(d){const {pixels:t,mask:G}=this;if(!d||!t||!t.length)return O.getLogger(this.declaredClass).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let E,
a,n,m;E=a=n=t[0];3<=t.length?(a=t[1],n=t[2]):2===t.length&&(a=t[1]);const f=this.width*this.height;if(E.length!==f)return O.getLogger(this.declaredClass).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let k=0;if(V.isSome(G)&&G.length===f)for(m=0;m<f;m++)d[k++]=E[m],d[k++]=a[m],d[k++]=n[m],d[k++]=G[m]&1;else for(m=0;m<f;m++)d[k++]=E[m],d[k++]=a[m],d[k++]=n[m],d[k++]=1};u._calculateBandStatistics=function(d,t){let G=Infinity,E=-Infinity;const a=d.length;let n,m=0;
if(V.isSome(t))for(n=0;n<a;n++)t[n]&&(m=d[n],G=m<G?m:G,E=m>E?m:E);else for(n=0;n<a;n++)m=d[n],G=m<G?m:G,E=m>E?m:E;return new p.SimpleBandStatistics(G,E)};return N._createClass(h)}(F.JSONSupport);D.__decorate([L.property({json:{write:!0}})],F.prototype,"width",void 0);D.__decorate([L.property({json:{write:!0}})],F.prototype,"height",void 0);D.__decorate([L.property({json:{write:!0}})],F.prototype,"pixelType",void 0);D.__decorate([P.cast("pixelType")],F.prototype,"castPixelType",null);D.__decorate([L.property({json:{write:!0}})],
F.prototype,"validPixelCount",void 0);D.__decorate([L.property({json:{write:!0}})],F.prototype,"mask",void 0);D.__decorate([L.property({json:{write:!0}})],F.prototype,"maskIsAlpha",void 0);D.__decorate([L.property({json:{write:!0}})],F.prototype,"pixels",void 0);D.__decorate([L.property()],F.prototype,"premultiplyAlpha",void 0);D.__decorate([L.property({json:{write:!0}})],F.prototype,"statistics",void 0);D.__decorate([L.property({json:{write:!0}})],F.prototype,"depthCount",void 0);D.__decorate([L.property({json:{write:!0}})],
F.prototype,"noDataValues",void 0);D.__decorate([L.property({json:{write:!0}})],F.prototype,"bandMasks",void 0);return F=l=D.__decorate([B.subclass("esri.layers.support.PixelBlock")],F)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(N,D){D=D._createClass(function(I=null,F=null,y=null){this.minValue=I;this.maxValue=F;this.noDataValue=y});N.SimpleBandStatistics=D;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(N){function D(F){return I[F]??[-3.4028234663852886E38,3.4028234663852886E38]}const I={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]};N.convertNoDataToMask=function(F,y,O){if(!(F.depthCount&&1<F.depthCount)){var {pixels:V,statistics:L,
pixelType:P}=F,B=V[0].length,p=F.bandMasks??[],c=F.mask??(new Uint8Array(B)).fill(255),l="f32"===P||"f64"===P,u=D(P),h=!1;for(let t=0;t<V.length;t++){const G="number"===typeof y?y:y[t];if(null==G)continue;var r=L?.[t].maxValue??u[1];if((L?.[t].minValue??u[0])>G+Number.EPSILON||r<G-Number.EPSILON)continue;r=p[t]||(new Uint8Array(B)).fill(255);const E=V[t];var d=O?.customFloatTolerance;if(l&&0!==d){d||(d=9.999999E37<=Math.abs(G)?2E-7*Math.abs(G):"f32"===P?2**-23:Number.EPSILON);for(let a=0;a<E.length;a++)r[a]&&
Math.abs(E[a]-G)<d&&(E[a]=0,r[a]=0,c[a]=0,h=!0)}else for(d=0;d<E.length;d++)r[d]&&E[d]===G&&(E[d]=0,r[d]=0,c[d]=0,h=!0);p[t]=r}h&&(F.bandMasks=p,F.mask=c);h&&"updateStatistics"in F&&F.updateStatistics()}};N.getPixelValueRange=D;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(N,D,I,F){function y(a){return D.isSome(a)&&"esri.layers.support.PixelBlock"===
a.declaredClass&&a.pixels&&0<a.pixels.length}function O(a,n,m,f,k){const g=a.length;k=I.createEmptyBand(k,g);if(n)for(let b=0;b<g;b++)n[b]&&(k[b]=m[a[b]-f]);else for(n=0;n<g;n++)k[n]=m[a[n]-f];return k}function V(a,n,m,f){const k=null!=m&&2<=m.length?new Set(m):null;m=1===m?.length?m[0]:null;const g=!!n?.length;for(let b=0;b<a.length;b++)if(f[b]){const e=a[b];if(g){let v=!1;for(let w=0;w<n.length;w+=2)if(e>=n[w]&&e<=n[w+1]){v=!0;break}v||(f[b]=0)}f[b]&&(e===m||k?.has(e))&&(f[b]=0)}}function L(a,n){const m=
a[0].length;for(let f=0;f<m;f++)if(n[f]){let k=!1;for(let g=0;g<a.length;g++)if(a[g][f]){k=!0;break}k||(n[f]=0)}}function P(a,n){const m=a[0].length;for(let f=0;f<m;f++)if(n[f]){let k=!1;for(let g=0;g<a.length;g++)if(0===a[g][f]){k=!0;break}k&&(n[f]=0)}}function B(a,n,m,f,k,g,b,e){return{xmin:k<=m*a?0:k<m*a+a?k-m*a:a,ymin:g<=f*n?0:g<f*n+n?g-f*n:n,xmax:k+b<=m*a?0:k+b<m*a+a?k+b-m*a:a,ymax:g+e<=f*n?0:g+e<f*n+n?g+e-f*n:n}}function p(a,n,m,f,k,g){const {width:b,height:e}=m.block,{x:v,y:w}=m.offset,{width:C,
height:M}=m.mosaic;m=B(b,e,f,k,v,w,C,M);let K=0;var x=0;if(g){var q=g.hasGCSSShiftTransform?360:g.halfWorldWidth??0,A=b*g.resolutionX;const H=g.startX+f*A;H<q&&H+A>q?x=g.rightPadding:H>=q&&(K=g.leftMargin-g.rightPadding,x=0)}m.xmax-=x;if("number"===typeof n)for(g=m.ymin;g<m.ymax;g++)for(x=(k*e+g-w)*C+(f*b-v)+K,q=m.xmin;q<m.xmax;q++)a[x+q]=n;else for(g=m.ymin;g<m.ymax;g++)for(x=(k*e+g-w)*C+(f*b-v)+K,q=g*b,A=m.xmin;A<m.xmax;A++)a[x+A]=n[q+A]}function c(a,n,m={}){const {clipOffset:f,clipSize:k,alignmentInfo:g,
blockWidths:b}=m;if(b)return l(a,n,{blockWidths:b});var e=a.find(S=>y(S));if(D.isNone(e))return null;m=k?k.width:n.width;const v=k?k.height:n.height;var w=e.width,C=e.height;const M=n.width/w,K=n.height/C;n={offset:f||{x:0,y:0},mosaic:k||n,block:{width:w,height:C}};w=e.pixelType;C=I.getPixelArrayConstructor(w);var x=e.pixels.length;e=[];for(var q=0;q<x;q++){var A=new C(m*v);for(let S=0;S<K;S++)for(let z=0;z<M;z++){var H=a[S*M+z];y(H)&&(H=H.pixels[q],p(A,H,n,z,S,g))}e.push(A)}let Q;if(a.some(S=>D.isNone(S)||
D.isSome(S.mask)&&0<S.mask.length))for(Q=new Uint8Array(m*v),C=0;C<K;C++)for(x=0;x<M;x++)A=a[C*M+x],q=D.isSome(A)?A.mask:null,D.isSome(q)?p(Q,q,n,x,C,g):A?p(Q,1,n,x,C,g):p(Q,0,n,x,C,g);a=new I({width:m,height:v,pixels:e,pixelType:w,mask:Q});a.updateStatistics();return a}function l(a,n,m){const f=a.find(x=>D.isSome(x));if(D.isNone(f))return null;var k=a.some(x=>D.isSome(x)?!!x.mask:!0);const {width:g,height:b}=n;n=k?new Uint8Array(g*b):null;({blockWidths:m}=m);const e=[],v=f.getPlaneCount(),w=I.getPixelArrayConstructor(f.pixelType);
if(k)for(let x=0,q=0;x<a.length;q+=m[x],x++)if(k=a[x],y(k)){var C=D.unwrap(k.mask);for(var M=0;M<b;M++)for(var K=0;K<m[x];K++)n[M*g+K+q]=null==C?255:C[M*k.width+K]}for(k=0;k<v;k++){C=new w(g*b);for(let x=0,q=0;x<a.length;q+=m[x],x++)if(M=a[x],y(M)&&(K=M.pixels[k],null!=K))for(let A=0;A<b;A++)for(let H=0;H<m[x];H++)C[A*g+H+q]=K[A*M.width+H];e.push(C)}a=new I({width:g,height:b,mask:n,pixels:e,pixelType:f.pixelType});a.updateStatistics();return a}function u(a){if(!y(a))return null;const n=a.clone(),
{width:m,height:f,pixels:k}=a;var g=k[0];const b=n.pixels[0];a=D.unwrap(a.mask);for(let w=2;w<f-1;w++){const C=new Map;for(var e=w-2;e<w+2;e++)for(var v=0;4>v;v++){const M=e*m+v;d(C,g[M],a?a[M]:1)}b[w*m]=h(C);b[w*m+1]=b[w*m+2]=b[w*m];for(e=3;e<m-1;e++)v=(w-2)*m+e+1,d(C,g[v],a?a[v]:1),v=(w-1)*m+e+1,d(C,g[v],a?a[v]:1),v=w*m+e+1,d(C,g[v],a?a[v]:1),v=(w+1)*m+e+1,d(C,g[v],a?a[v]:1),v=(w-2)*m+e-3,r(C,g[v],a?a[v]:1),v=(w-1)*m+e-3,r(C,g[v],a?a[v]:1),v=w*m+e-3,r(C,g[v],a?a[v]:1),v=(w+1)*m+e-3,r(C,g[v],a?a[v]:
1),b[w*m+e]=h(C);b[w*m+e+1]=b[w*m+e]}for(g=0;g<m;g++)b[g]=b[m+g]=b[2*m+g],b[(f-1)*m+g]=b[(f-2)*m+g];n.updateStatistics();return n}function h(a){if(0===a.size)return 0;let n=0,m=-1,f=0;const k=a.keys();let g=k.next();for(;!g.done;)f=a.get(g.value),f>n&&(m=g.value,n=f),g=k.next();return m}function r(a,n,m){0!==m&&(m=a.get(n),1===m?a.delete(n):a.set(n,m-1))}function d(a,n,m){0!==m&&a.set(n,a.has(n)?a.get(n)+1:1)}function t(a,n,m){let {x:f,y:k}=n;const {width:g,height:b}=m;if(0===f&&0===k&&b===a.height&&
g===a.width)return a;const {width:e,height:v}=a;n=Math.max(0,k);const w=Math.max(0,f),C=Math.min(f+g,e),M=Math.min(k+b,v);if(0>C||0>M||!y(a))return null;f=Math.max(0,-f);k=Math.max(0,-k);var {pixels:K}=a,x=g*b,q=K.length;const A=[];for(var H=0;H<q;H++){var Q=K[H],S=I.createEmptyBand(a.pixelType,x);for(let z=n;z<M;z++){const J=z*e;let R=(z+k-n)*g+f;for(let W=w;W<C;W++)S[R++]=Q[J+W]}A.push(S)}K=new Uint8Array(x);x=D.unwrap(a.mask);for(q=n;q<M;q++)for(H=q*e,Q=(q+k-n)*g+f,S=w;S<C;S++)K[Q++]=x?x[H+S]:
1;a=new I({width:m.width,height:m.height,pixelType:a.pixelType,pixels:A,mask:K});a.updateStatistics();return a}function G(a,n=!0){if(!y(a))return null;const {pixels:m,width:f,height:k,mask:g,pixelType:b}=a;a=[];const e=Math.round(f/2),v=Math.round(k/2),w=k-1,C=f-1;for(var M=0;M<m.length;M++){var K=m[M],x=I.createEmptyBand(b,e*v),q=0;for(var A=0;A<k;A+=2)for(var H=0;H<f;H+=2){var Q=K[A*f+H];if(n){var S=H===C?Q:K[A*f+H+1];const z=A===w?Q:K[A*f+H+f],J=H===C?z:A===w?S:K[A*f+H+f+1];x[q++]=(Q+S+z+J)/4}else x[q++]=
Q}a.push(x)}M=null;if(D.isSome(g))for(M=new Uint8Array(e*v),K=0,x=0;x<k;x+=2)for(q=0;q<f;q+=2)A=g[x*f+q],n?(H=q===C?A:g[x*f+q+1],Q=x===w?A:g[x*f+q+f],S=q===C?Q:x===w?H:g[x*f+q+f+1],M[K++]=A*H*Q*S?1:0):M[K++]=A;return new I({width:e,height:v,pixelType:b,pixels:a,mask:M})}function E(a,n,m,f,k=0){const {width:g,height:b}=a,{width:e,height:v}=n;a=f.cols;f=f.rows;n=Math.ceil(e/a-.1/a);const w=Math.ceil(v/f-.1/f);let C,M,K,x,q;const A=n*a;var H=A*w*f;const Q=new Float32Array(H),S=new Float32Array(H),z=
new Uint32Array(H),J=new Uint32Array(H);let R=0,W,Z;for(let T=0;T<w;T++)for(let U=0;U<n;U++){var Y=12*(T*n+U);H=m[Y];C=m[Y+1];M=m[Y+2];K=m[Y+3];x=m[Y+4];q=m[Y+5];for(var X=0;X<f;X++){R=(T*f+X)*A+U*a;Z=(X+.5)/f;for(let aa=0;aa<X;aa++)W=(aa+.5)/a,Q[R+aa]=(H*W+C*Z+M)*g+k,S[R+aa]=(K*W+x*Z+q)*b+k,z[R+aa]=Math.floor(Q[R+aa]),J[R+aa]=Math.floor(S[R+aa])}Y+=6;H=m[Y];C=m[Y+1];M=m[Y+2];K=m[Y+3];x=m[Y+4];q=m[Y+5];for(Y=0;Y<f;Y++)for(R=(T*f+Y)*A+U*a,Z=(Y+.5)/f,X=Y;X<a;X++)W=(X+.5)/a,Q[R+X]=(H*W+C*Z+M)*g+k,S[R+
X]=(K*W+x*Z+q)*b+k,z[R+X]=Math.floor(Q[R+X]),J[R+X]=Math.floor(S[R+X])}return{offsets_x:Q,offsets_y:S,offsets_xi:z,offsets_yi:J,gridWidth:A}}N.NoDataInterpretation=void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(N.NoDataInterpretation||(N.NoDataInterpretation={}));N.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]="fail"})(N.MissingBandAction||(N.MissingBandAction={}));N.MAX_MAP_SIZE_GPU=6;N.approximateTransform=function(a,n,m,f,k="nearest"){if(!y(a))return null;
"majority"===k&&(a=u(a));const {pixels:g,mask:b,pixelType:e}=a,v=a.width;var w=a.height;const C=I.getPixelArrayConstructor(e),M=g.length,{width:K,height:x}=n;a=!1;for(let J=0;J<m.length;J+=3)-1===m[J]&&-1===m[J+1]&&-1===m[J+2]&&(a=!0);const {offsets_x:q,offsets_y:A,offsets_xi:H,offsets_yi:Q,gridWidth:S}=E({width:v,height:w},n,m,f,"majority"===k?.5:0);let z;n=(J,R,W)=>{const Z=J instanceof Float32Array||J instanceof Float64Array?0:.5;for(let Y=0;Y<x;Y++){z=Y*S;for(let X=0;X<K;X++){if(0>q[z]||0>A[z])J[Y*
K+X]=0;else if(W)J[Y*K+X]=R[H[z]+Q[z]*v];else{const T=Math.floor(q[z]),U=Math.floor(A[z]),aa=Math.ceil(q[z]),ba=Math.ceil(A[z]),fa=q[z]-T,ja=A[z]-U;J[Y*K+X]=!b||b[T+U*v]&&b[aa+U*v]&&b[T+ba*v]&&b[aa+ba*v]?(1-ja)*((1-fa)*R[T+U*v]+fa*R[aa+U*v])+ja*((1-fa)*R[T+ba*v]+fa*R[aa+ba*v])+Z:R[H[z]+Q[z]*v]}z++}}};m=[];for(w=0;w<M;w++)f=new C(K*x),n(f,g[w],"nearest"===k||"majority"===k),m.push(f);k=new I({width:K,height:x,pixelType:e,pixels:m});if(D.isSome(b))k.mask=new Uint8Array(K*x),n(k.mask,b,!0);else if(a)for(k.mask=
new Uint8Array(K*x),a=0;a<K*x;a++)k.mask[a]=0>q[a]||0>A[a]?0:1;k.updateStatistics();return k};N.clip=t;N.colorize=function(a,n){if(!y(a)||!n||!n.indexedColormap&&!n.indexed2DColormap)return a;const m=a.clone();var f=m.pixels;let k=m.mask;const g=m.width*m.height;if(1!==f.length)return a;const {indexedColormap:b,indexed2DColormap:e,offset:v,alphaSpecified:w}=n;a=0;f=f[0];n=new Uint8Array(f.length);const C=new Uint8Array(f.length),M=new Uint8Array(f.length);var K=0;if(b){const x=b.length-1;if(D.isSome(k))for(a=
0;a<g;a++)k[a]&&(K=4*(f[a]-v),K<v||K>x?k[a]=0:(n[a]=b[K],C[a]=b[K+1],M[a]=b[K+2],k[a]=b[K+3]));else{k=new Uint8Array(g);for(a=0;a<g;a++)K=4*(f[a]-v),K<v||K>x?k[a]=0:(n[a]=b[K],C[a]=b[K+1],M[a]=b[K+2],k[a]=b[K+3]);m.mask=k}}else if(e)if(D.isSome(k))for(a=0;a<g;a++)k[a]&&(K=e[f[a]],n[a]=K[0],C[a]=K[1],M[a]=K[2],k[a]=K[3]);else{k=new Uint8Array(g);for(a=0;a<g;a++)K=e[f[a]],n[a]=K[0],C[a]=K[1],M[a]=K[2],k[a]=K[3];m.mask=k}m.pixels=[n,C,M];m.statistics=null;m.pixelType="u8";m.maskIsAlpha=w;return m};N.compositeBands=
function(a){if(!a?.length||a.some(v=>!y(v)))return null;if(1===a.length)return D.isSome(a[0])?a[0].clone():null;const {width:n,height:m,pixelType:f}=a[0];if(a.some(v=>v.width!==n||v.height!==m))return null;const k=a.map(({mask:v})=>v).filter(v=>null!=v);let g=null;k.length&&(g=new Uint8Array(n*m),g.set(k[0]),1<k.length&&P(k.slice(1),g));const b=[];a.forEach(({pixels:v})=>b.push(...v));const e=[];a.map(({statistics:v})=>v).filter(v=>v?.length).forEach(v=>e.push(...v));return new I({pixelType:f,width:n,
height:m,mask:g,pixels:b,statistics:e.length?e:null})};N.createColormapLUT=function(a){if(a){var n=a.colormap;if(n&&0!==n.length){n=n.sort((w,C)=>w[0]-C[0]);var m=0;0>n[0][0]&&(m=n[0][0]);var f=Math.max(256,n[n.length-1][0]-m+1),k=new Uint8Array(4*f),g=[],b=0,e=0,v=5===n[0].length;if(65536<f)return n.forEach(w=>{g[w[0]-m]=v?w.slice(1):w.slice(1).concat([255])}),{indexed2DColormap:g,offset:m,alphaSpecified:v};if(a.fillUnspecified)for(a=n[e],b=a[0]-m;b<f;b++)k[4*b]=a[1],k[4*b+1]=a[2],k[4*b+2]=a[3],
k[4*b+3]=v?a[4]:255,b===a[0]-m&&(a=e===n.length-1?a:n[++e]);else for(b=0;b<n.length;b++)a=n[b],e=4*(a[0]-m),k[e]=a[1],k[e+1]=a[2],k[e+2]=a[3],k[e+3]=v?a[4]:255;return{indexedColormap:k,offset:m,alphaSpecified:v}}}};N.createMaskLUT=function(a,n,m){if("u8"!==a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var f=a.includes("16")?65536:256;a=a.includes("s")?-f/2:0;f=new Uint8Array(f);if(n)for(let g=0;g<n.length;g++){var k=Math.ceil(n[2*g]-a);const b=Math.floor(n[2*g+1]-a);for(;k<=b;k++)f[k]=255}else f.fill(255);
if(m)for(n=0;n<m.length;n++)f[m[n]-a]=0;return{lut:f,offset:a}};N.createRemapLUT=function(a){const {srcPixelType:n,inputRanges:m,outputValues:f,allowUnmatched:k,noDataRanges:g,isLastInputRangeInclusive:b,outputPixelType:e}=a;if("u8"!==n&&"s8"!==n&&"u16"!==n&&"s16"!==n)return null;var v=n.includes("16")?65536:256;a=n.includes("s")?-v/2:0;const w=I.createEmptyBand(e,v);v=new Uint8Array(v);k&&v.fill(255);const [C,M]=F.getPixelValueRange(e);if(m?.length&&f?.length){var K=m.map(H=>H-1E-6);K[0]=m[0];b&&
(K[K.length-1]=m[m.length-1]);for(var x=0;x<K.length;x++){var q=f[x]>M?M:f[x]<C?C:f[x],A=Math.ceil(K[2*x]-a);const H=Math.floor(K[2*x+1]-a);for(;A<=H;A++)w[A]=q,v[A]=255}}if(g?.length)for(K=0;K<g.length;K++)for(q=Math.ceil(g[2*K]-a),x=Math.floor(g[2*K+1]-a);q<=x;q++)v[q]=0;return{lut:w,offset:a,mask:v}};N.extractBands=function(a,n){if(!n?.length||!y(a))return a;const m=a.pixels.length;return n&&n.some(f=>f>=m)||1===m&&1===n.length&&0===n[0]||m===n.length&&!n.some((f,k)=>f!==k)?a:new I({pixelType:a.pixelType,
width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:n.map(f=>a.pixels[f]),statistics:a.statistics&&n.map(f=>a.statistics[f])})};N.getClipBounds=B;N.getLocalArithmeticNorthRotations=function(a,n){const {coefficients:m,spacing:f}=n,{offsets_x:k,offsets_y:g,gridWidth:b}=E(a,a,m,{rows:f[0],cols:f[1]}),{width:e,height:v}=a;a=new Float32Array(e*v);n=180/Math.PI;for(let M=0;M<v;M++)for(let K=0;K<e;K++){var w=M*b+K,C=0===M?w:w-b;const x=M===v-1?w:w+
b;w=k[C]-k[x];C=g[x]-g[C];isNaN(w)||isNaN(C)?a[M*e+K]=90:(C=Math.atan2(C,w)*n,C=(360+C)%360,a[M*e+K]=C)}return a};N.interpolateOffsets=E;N.isValidPixelBlock=y;N.lookupBandValues=O;N.lookupPixels=function(a,n){if(!y(a))return null;const {pixels:m,mask:f}=a,k=m.length;let g=n.lut;const {offset:b}=n;g&&1===g[0].length&&(g=m.map(()=>g));const e=[];n=n.outputPixelType||"u8";for(let v=0;v<k;v++){const w=O(m[v],f,g[v],b||0,n);e.push(w)}a=new I({width:a.width,height:a.height,pixels:e,mask:f,pixelType:n});
a.updateStatistics();return a};N.mask=function(a,n){if(!y(a))return null;const {width:m,height:f,pixels:k}=a;var g=m*f;const b=new Uint8Array(g);a.mask?b.set(a.mask):b.fill(255);a=k.length;const {includedRanges:e,noDataValues:v,outputPixelType:w,matchAll:C,lookups:M}=n;if(M){g=[];for(n=0;n<a;n++){var K=M[n];K=O(k[n],b,K.lut,K.offset||0,"u8");g.push(K)}1===g.length?b.set(g[0]):C?L(g,b):P(g,b)}else if(C){n=[];for(K=0;K<a;K++){const x=new Uint8Array(g);x.set(b);V(k[K],e?.slice(2*K,2*K+2),v?.[K],x);n.push(x)}1===
n.length?b.set(n[0]):L(n,b)}else for(g=0;g<a;g++)V(k[g],e?.slice(2*g,2*g+2),v?.[g],b);return new I({width:m,height:f,pixelType:w,pixels:k,mask:b})};N.mosaic=c;N.mosaicPixelData=function(a,n){if(!a||0===a.length)return null;var m=a.find(M=>M.pixelBlock);if(!m||D.isNone(m.pixelBlock))return null;var f=(m.extent.xmax-m.extent.xmin)/m.pixelBlock.width;const k=(m.extent.ymax-m.extent.ymin)/m.pixelBlock.height,g=.01*Math.min(f,k),b=a.sort((M,K)=>Math.abs(M.extent.ymax-K.extent.ymax)>g?K.extent.ymax-M.extent.ymax:
Math.abs(M.extent.xmin-K.extent.xmin)>g?M.extent.xmin-K.extent.xmin:0);var e=Math.min.apply(null,b.map(M=>M.extent.xmin));const v=Math.min.apply(null,b.map(M=>M.extent.ymin)),w=Math.max.apply(null,b.map(M=>M.extent.xmax)),C=Math.max.apply(null,b.map(M=>M.extent.ymax));a={x:Math.round((n.xmin-e)/f),y:Math.round((C-n.ymax)/k)};e={width:Math.round((w-e)/f),height:Math.round((C-v)/k)};f={width:Math.round((n.xmax-n.xmin)/f),height:Math.round((n.ymax-n.ymin)/k)};if(Math.round(e.width/m.pixelBlock.width)*
Math.round(e.height/m.pixelBlock.height)!==b.length||0>a.x||0>a.y||e.width<f.width||e.height<f.height)return null;m=b.map(M=>M.pixelBlock);m=c(m,e,{clipOffset:a,clipSize:f});return{extent:n,pixelBlock:m}};N.remap=function(a,n){if(!y(a))return null;const {width:m,height:f}=a,{inputRanges:k,outputValues:g,outputPixelType:b,noDataRanges:e,allowUnmatched:v,isLastInputRangeInclusive:w}=n;n=a.pixels[0];const C=I.createEmptyBand(b,n.length),M=a.mask,K=new Uint8Array(m*f);M?K.set(M):K.fill(255);const x=a.pixelType.startsWith("f")?
1E-6:0;a=k.map(R=>R-x);a[0]=k[0];a[a.length-1]=k[k.length-1]+(w?1E-6:0);var q=k.length/2;const [A,H]=F.getPixelValueRange(b);for(var Q=0;Q<f;Q++)for(var S=0;S<m;S++){var z=Q*m+S;if(K[z]){var J=n[z];let R=!1;for(let W=q-1;0<=W;W--)if(J===a[2*W]||J>a[2*W]&&J<a[2*W+1]){C[z]=g[W];R=!0;break}R||(v?C[z]=J>H?H:J<A?A:J:K[z]=0)}}if(a=e?.length)for(q=0;q<f;q++)for(Q=0;Q<m;Q++)if(S=q*m+Q,!M||M[S])for(z=n[S],J=0;J<a;J+=2)if(z>=e[J]&&z<=e[J+1]){C[S]=0;K[S]=0;break}return new I({width:m,height:f,pixelType:b,pixels:[C],
mask:K})};N.remapColor=function(a,n){if(!y(a))return null;a=a.clone();var {pixels:m}=a;const f=a.width*a.height,k=n.length,g=Math.floor(k/2),b=n[Math.floor(g)];m=m[0];let e,v,w,C,M,K,x=!1;const q=new Uint8Array(f),A=new Uint8Array(f),H=new Uint8Array(f);let Q=a.mask;const S=4===n[0].mappedColor.length;Q||(Q=new Uint8Array(f),Q.fill(S?255:1),a.mask=Q);for(M=0;M<f;M++)if(Q[M]){e=m[M];x=!1;K=g;v=b;w=0;for(C=k-1;1<C-w;){if(e===v.value){x=!0;break}e>v.value?w=K:C=K;K=Math.floor((w+C)/2);v=n[Math.floor(K)]}x||
(e===n[w].value?(v=n[w],x=!0):e===n[C].value?(v=n[C],x=!0):e<n[w].value?(x=!1,v=null):e>n[w].value&&(e<n[C].value?(v=n[w],x=!0):C===k-1?(x=!1,v=null):(v=n[C],x=!0)));x?(q[M]=v.mappedColor[0],A[M]=v.mappedColor[1],H[M]=v.mappedColor[2],Q[M]=v.mappedColor[3]):q[M]=A[M]=H[M]=Q[M]=0}a.pixels=[q,A,H];a.mask=Q;a.pixelType="u8";a.maskIsAlpha=S;return a};N.resampleByMajority=u;N.setValidBoundary=function(a,n,m){if(!y(a))return null;const {width:f,height:k}=a,g=n.x;n=n.y;const b=m.width+g;m=m.height+n;if(0>
g||0>n||b>f||m>k||0===g&&0===n&&b===f&&m===k)return a;a.mask||(a.mask=new Uint8Array(f*k));const e=a.mask;for(let v=0;v<k;v++){const w=v*f;for(let C=0;C<f;C++)e[w+C]=v<n||v>=m||C<g||C>=b?0:1}a.updateStatistics();return a};N.split=function(a,n,m){if(!y(a))return null;const {width:f,height:k}=n;let {width:g,height:b}=a;const e=new Map,v={x:0,y:0};m=null==m?1:1+m;for(let w=0;w<m;w++){const C=Math.ceil(g/f),M=Math.ceil(b/k);for(let K=0;K<M;K++){v.y=K*k;for(let x=0;x<C;x++){v.x=x*f;const q=t(a,v,n);e.set(`${w}/${K}/${x}`,
q)}}w<m-1&&(a=G(a));g=Math.round(g/2);b=Math.round(b/2)}return e};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/maybe ../../core/screenUtils ../../chunks/vec3f64 ../../layers/effects/jsonUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(N,D,I,F,y,O,V,L,P,B,p,c){function l(f){f=f.symbolLayers;if(!f)return null;let k=null;f.forEach(g=>{if("object"!==
g.type||null==g.resource?.href)k="water"===g.type?V.unwrap(g.color):V.isSome(g.material)?V.unwrap(g.material.color):null});return k?new I(k):null}function u(f,k){if(null==k||null==f)return f;f=f.toRgba();f[3]*=k;return new I(f)}function h(f,k,g){if(f=f.symbolLayers){var b=e=>{e=V.isSome(e)?e:null;k=k??e??(null!=g?m:null);return u(k,g)};f.forEach(e=>{if("object"!==e.type||null==e.resource?.href||k)if("water"===e.type)e.color=b(e.color);else{var v=V.isSome(e.material)?e.material.color:null;v=b(v);V.isNone(e.material)?
e.material=new c.Symbol3DMaterial({color:v}):e.material.color=v;null!=g&&"outline"in e&&V.isSome(e.outline)&&V.isSome(e.outline.color)&&(e.outline.color=u(e.outline.color,g))}})}}async function r(f,k){(f=f.symbolLayers)&&await y.forEach(f,async g=>d(g,k))}async function d(f,k){switch(f.type){case "extrude":f.size="number"===typeof k[2]?k[2]:0;break;case "icon":case "line":case "text":k=t(k);V.isSome(k)&&(f.size=k);break;case "path":const g=E(k,P.ONES,[f.width,void 0,f.height]);f.width=n(k[0],f.width,
1,g);f.height=n(k[2],f.height,1,g);break;case "object":await G(f,k)}}function t(f){for(const k of f)if("number"===typeof k)return k;return null}async function G(f,k){const {resourceSize:g,symbolSize:b}=await a(f),e=E(k,g,b);f.width=n(k[0],b[0],g[0],e);f.depth=n(k[1],b[1],g[1],e);f.height=n(k[2],b[2],g[2],e)}function E(f,k,g){for(let b=0;3>b;b++){const e=f[b];switch(e){case "symbol-value":return f=g[b],null!=f?f/k[b]:1;case "proportional":break;default:if(e&&k[b])return e/k[b]}}return 1}async function a(f){const k=
await (await new Promise((C,M)=>N(["./symbolLayerUtils"],C,M))).computeObjectLayerResourceSize(f,10),{width:g,height:b,depth:e}=f;f=[g,e,b];let v=1;for(var w=0;3>w;w++){const C=f[w];if(null!=C){v=C/k[w];break}}for(w=0;3>w;w++)null==f[w]&&(f[w]=k[w]*v);return{resourceSize:k,symbolSize:f}}function n(f,k,g,b){switch(f){case "proportional":return g*b;case "symbol-value":return null!=k?k:g;default:return f}}const m=new I("white");D.applyColorToSymbol=function(f,k,g){if(f&&(k||null!=g))if(k&&(k=new I(k)),
F.isSymbol3D(f))h(f,k,g);else if(F.isSymbol2D(f)){if(k=k??f.color)f.color=u(k,g);null!=g&&"outline"in f&&f.outline&&f.outline.color&&(f.outline.color=u(f.outline.color,g))}};D.applyOpacityToColor=u;D.applyRotationToSymbol=function(f,k,g){f&&null!=k&&(F.isSymbol3D(f)?(f=f.symbolLayers)&&f.forEach(b=>{if(b&&"object"===b.type)switch(g){case "tilt":b.tilt=k;break;case "roll":b.roll=k;break;default:b.heading=k}}):!F.isSymbol2D(f)||"simple-marker"!==f.type&&"picture-marker"!==f.type&&"text"!==f.type||(f.angle=
k))};D.applySizesToSymbol=async function(f,k){if(f&&k){if(F.isSymbol3D(f))return r(f,k);if(F.isSymbol2D(f)&&(k=t(k),!V.isNone(k)))switch(f.type){case "simple-marker":f.size=k;break;case "picture-marker":const g=f.width/f.height;1<g?(f.width=k,f.height=k*g):(f.width=k*g,f.height=k);break;case "simple-line":f.width=k;break;case "text":f.font.size=k}}};D.fetchWebStyleSymbol=async function(f,k){const g=await f.fetchSymbol(k);return g?g:f.fetchCIMSymbol(k)};D.getCSSFilterFromEffectList=function(f){if(!f)return null;
f=f.effects.filter(k=>"bloom"!==k.type).map(k=>k.toJSON());return B.effectFunctionsFromJSON(f)};D.getColorFromSymbol=function(f,k){if(!f)return null;let g=null;F.isSymbol3D(f)?g=l(f):F.isSymbol2D(f)&&(g=f.color?new I(f.color):null);return g?u(g,k):null};D.getIconHref=function(f){return V.unwrapOrThrow(f.resource).href};D.getSymbolOutlineSize=function(f){if(!f)return 0;if(F.isSymbol3D(f)){{const k=f.symbolLayers&&f.symbolLayers.length;k?(f=f.symbolLayers.getItemAt(k-1),f="outline"in f?V.get(f,"outline",
"size"):void 0):f=void 0}return V.isSome(f)?f:0}return L.px2pt(p.getStroke(f)?.width)};D.isVolumetricSymbol=function(f){if(V.isNone(f)||!("symbolLayers"in f)||V.isNone(f.symbolLayers))return!1;switch(f.type){case "point-3d":return f.symbolLayers.some(k=>"object"===k.type);case "line-3d":return f.symbolLayers.some(k=>"path"===k.type);case "polygon-3d":return f.symbolLayers.some(k=>"object"===k.type||"extrude"===k.type);default:return!1}};D.symbolHasExtrudeSymbolLayer=function(f){return V.isSome(f)&&
"polygon-3d"===f.type&&f.symbolLayers.some(k=>"extrude"===k.type)};Object.defineProperty(D,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/ItemCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(N,D,I,F,y,O,V){function L(p){if(!p)return null;let c=null;switch(p.type){case "simple-fill":case "picture-fill":case "simple-marker":c=L(p.outline);break;case "simple-line":const l=O.pt2px(p.width);
null!=p.style&&"none"!==p.style&&0!==l&&(c={color:p.color,style:B(p.style),width:l,cap:p.cap,join:"miter"===p.join?O.pt2px(p.miterLimit):p.join});break;default:c=null}return c}const P=new y(1E3),B=(()=>{const p={};return c=>{if(p[c])return p[c];const l=c.replace(/-/g,"");return p[c]=l}})();I=new I([128,128,128]);N.defaultThematicColor=I;N.dekebabifyLineStyle=B;N.getFill=function(p){const c=p.style;let l=null;if(p)switch(p.type){case "simple-marker":"cross"!==c&&"x"!==c&&(l=p.color);break;case "simple-fill":"solid"===
c?l=p.color:"none"!==c&&(l={type:"pattern",x:0,y:0,src:D.getAssetUrl(`esri/symbols/patterns/${c}.png`),width:5,height:5});break;case "picture-fill":l={type:"pattern",src:p.url,width:O.pt2px(p.width)*p.xscale,height:O.pt2px(p.height)*p.yscale,x:O.pt2px(p.xoffset),y:O.pt2px(p.yoffset)};break;case "text":l=p.color;break;case "cim":l=V.getCIMSymbolColor(p)}return l};N.getPatternUrlWithColor=function(p,c){const l=p+"-"+c;return void 0!==P.get(l)?Promise.resolve(P.get(l)):F(p,{responseType:"image"}).then(u=>
{u=u.data;const h=u.naturalWidth,r=u.naturalHeight,d=document.createElement("canvas");d.width=h;d.height=r;const t=d.getContext("2d");t.fillStyle=c;t.fillRect(0,0,h,r);t.globalCompositeOperation="destination-in";t.drawImage(u,0,0);u=d.toDataURL();P.put(l,u);return u})};N.getStroke=L;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/core/ItemCache":function(){define(["../chunks/_rollupPluginBabelHelpers","./MemCache"],function(N,D){return function(){function I(y,O){this._storage=
new D.MemCacheStorage;this._storage.maxSize=y;O&&this._storage.registerRemoveFunc("",O)}var F=I.prototype;F.put=function(y,O){this._storage.put(y,O,1,1)};F.pop=function(y){return this._storage.pop(y)};F.get=function(y){return this._storage.get(y)};F.clear=function(){this._storage.clearAll()};F.destroy=function(){this._storage.destroy()};return N._createClass(I)}()})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(N,D,I){function F(c){c=I.toCIMSymbolJSON(c);
if("CIMTextSymbol"===c?.type)return c.height??0;let l=0;if(c?.symbolLayers)for(const u of c.symbolLayers)I.isCIMMarker(u)&&null!=u.size&&u.size>l?l=u.size:I.isCIMStroke(u)&&null!=u.width&&u.width>l?l=u.width:I.isCIMFill(u);return l}function y(c,l,u,h){if(c)if("CIMTextSymbol"===c.type)null!=c.height&&(c.height*=l);else{if(u&&c.effects)for(const r of c.effects)L(r,l);if(c.symbolLayers)for(const r of c.symbolLayers)switch(r.type){case "CIMPictureMarker":case "CIMVectorMarker":O(r,l,h);break;case "CIMPictureStroke":case "CIMSolidStroke":!h?.preserveOutlineWidth&&
r.width&&(r.width*=l);break;case "CIMPictureFill":r.height&&(r.height*=l);r.offsetX&&(r.offsetX*=l);r.offsetY&&(r.offsetY*=l);break;case "CIMHatchFill":y(r.lineSymbol,l,!0,{...h,preserveOutlineWidth:!1}),r.offsetX&&(r.offsetX*=l),r.offsetY&&(r.offsetY*=l),r.separation&&(r.separation*=l)}}}function O(c,l,u){if(c&&(c.markerPlacement&&V(c.markerPlacement,l),c.offsetX&&(c.offsetX*=l),c.offsetY&&(c.offsetY*=l),c.anchorPoint&&"Absolute"===c.anchorPointUnits&&(c.anchorPoint={x:c.anchorPoint.x*l,y:c.anchorPoint.y*
l}),c.size=null!=c.size?c.size*l:0,"CIMVectorMarker"===c.type&&c.markerGraphics))for(const h of c.markerGraphics)c.scaleSymbolsProportionally||y(h.symbol,l,!0,u)}function V(c,l){I.isCIMMarkerStrokePlacement(c)&&c.offset&&(c.offset*=l);switch(c.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":c.customEndingOffset&&(c.customEndingOffset*=l);c.offsetAlongLine&&(c.offsetAlongLine*=l);if(c.placementTemplate&&c.placementTemplate.length){var u=c.placementTemplate.map(h=>
h*l);c.placementTemplate=u}break;case "CIMMarkerPlacementAlongLineVariableSize":c.maxRandomOffset&&(c.maxRandomOffset*=l);c.placementTemplate&&c.placementTemplate.length&&(u=c.placementTemplate.map(h=>h*l),c.placementTemplate=u);break;case "CIMMarkerPlacementOnLine":c.startPointOffset&&(c.startPointOffset*=l);break;case "CIMMarkerPlacementAtExtremities":c.offsetAlongLine&&(c.offsetAlongLine*=l);break;case "CIMMarkerPlacementAtRatioPositions":c.beginPosition&&(c.beginPosition*=l);c.endPosition&&(c.endPosition*=
l);break;case "CIMMarkerPlacementPolygonCenter":c.offsetX&&(c.offsetX*=l);c.offsetY&&(c.offsetY*=l);break;case "CIMMarkerPlacementInsidePolygon":c.offsetX&&(c.offsetX*=l),c.offsetY&&(c.offsetY*=l),c.stepX&&(c.stepX*=l),c.stepY&&(c.stepY*=l)}}function L(c,l){switch(c.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":c.width&&(c.width*=l);break;case "CIMGeometricEffectBuffer":c.size&&(c.size*=l);break;case "CIMGeometricEffectCut":c.beginCut&&(c.beginCut*=l);c.endCut&&(c.endCut*=l);
c.middleCut&&(c.middleCut*=l);break;case "CIMGeometricEffectDashes":c.customEndingOffset&&(c.customEndingOffset*=l);c.offsetAlongLine&&(c.offsetAlongLine*=l);if(c.dashTemplate&&c.dashTemplate.length){const u=c.dashTemplate.map(h=>h*l);c.dashTemplate=u}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":c.length&&(c.length*=l);break;case "CIMGeometricEffectMove":c.offsetX&&(c.offsetX*=l);c.offsetY&&(c.offsetY*=l);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":c.offset&&
(c.offset*=l);break;case "CIMGeometricEffectRegularPolygon":c.radius&&(c.radius*=l);break;case "CIMGeometricEffectTaperedPolygon":c.fromWidth&&(c.fromWidth*=l);c.length&&(c.length*=l);c.toWidth&&(c.toWidth*=l);break;case "CIMGeometricEffectWave":c.amplitude&&(c.amplitude*=l),c.period&&(c.period*=l)}}function P(c,l){if(c){var u="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===c.type;if(u?.symbolLayers)for(const h of u.symbolLayers)if(!(h.colorLocked||c&&(I.isCIMStroke(h)||I.isCIMMarker(h)&&
h.markerPlacement&&I.isCIMMarkerStrokePlacement(h.markerPlacement))))switch(h.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":h.tintColor&&B(l,h.tintColor);break;case "CIMVectorMarker":h.markerGraphics?.forEach(r=>{P(r.symbol,l)});break;case "CIMSolidStroke":case "CIMSolidFill":B(l,h.color);break;case "CIMHatchFill":P(h.lineSymbol,l)}}}function B(c,l){for(const u of c)if(u.join(".")===l.join("."))return;c.push(l)}function p(c,l,u){if(c){var h="CIMTextSymbol"===c.type?c.symbol:
c;c="CIMPolygonSymbol"===h?.type;if(h?.symbolLayers)for(const r of h.symbolLayers)if(!r.colorLocked){if(c)if(u){if({layersToColor:h}=u,(I.isCIMStroke(r)||I.isCIMMarker(r)&&r.markerPlacement&&I.isCIMMarkerStrokePlacement(r.markerPlacement))&&"fill"===h||I.isCIMFill(r)&&"outline"===h)continue}else if(I.isCIMStroke(r)||I.isCIMMarker(r)&&r.markerPlacement&&I.isCIMMarkerStrokePlacement(r.markerPlacement))continue;h=l.toArray();switch(r.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":r.tintColor=
h;break;case "CIMVectorMarker":r.markerGraphics?.forEach(d=>{p(d.symbol,l,u)});break;case "CIMSolidStroke":case "CIMSolidFill":r.color=h;break;case "CIMHatchFill":p(r.lineSymbol,l,u)}}}}N.applyCIMSymbolColor=function(c,l,u){l instanceof D||(l=new D(l));(c=I.toCIMSymbolJSON(c))&&p(c,l,u)};N.applyCIMSymbolRotation=function(c,l,u=!1){c=I.toCIMSymbolJSON(c);u&&0!==l&&(l=360-l);if("CIMTextSymbol"===c?.type)c.angle=l;else if("CIMPointSymbol"===c?.type&&c.symbolLayers){u=l-(c.angle||0);for(const h of c.symbolLayers)if(I.isCIMMarker(h)){let r=
h.rotation||0;r=h.rotateClockwise?r-u:r+u;h.rotation=r}c.angle=l}};N.getCIMSymbolColor=function(c){c=I.toCIMSymbolJSON(c);const l=[];P(c,l);return l.length?new D(I.fromCIMColor(l[0])):null};N.getCIMSymbolRotation=function(c,l=!1){c=I.toCIMSymbolJSON(c);return"CIMTextSymbol"===c?.type||"CIMPointSymbol"===c?.type?(c=c.angle,null!=c&&0!==c&&l?360-c:c??0):0};N.getCIMSymbolSize=F;N.getCIMSymbolType=function(c){c=I.toCIMSymbolJSON(c);if(!c)return null;switch(c.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};N.scaleCIMMarker=O;N.scaleCIMSymbol=y;N.scaleCIMSymbolTo=function(c,l,u){if(c){var h=I.toCIMSymbolJSON(c);c=F(c);if(0===c){if(h)if("CIMTextSymbol"===h.type)h.height=l;else if(h.symbolLayers)for(const r of h.symbolLayers)switch(r.type){case "CIMPictureMarker":case "CIMVectorMarker":r.size=l;break;case "CIMPictureStroke":case "CIMSolidStroke":r.width=
l}}else y(h,l/c,!1,u)}};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/cim/utils":function(){define(["require","exports"],function(N,D){function I(p){let c=p.length;for(;c--;)if(!" /-,\n".includes(p.charAt(c)))return!1;return!0}function F(p,c){const l=[];var u=0;let h=-1;do h=p.indexOf("[",u),h>=u&&(h>u&&(u=p.substr(u,h-u),l.push([u,null,I(u)])),u=h+1,h=p.indexOf("]",u),h>=u&&(h>u&&(u=p.substr(u,h-u),(u=c[u])&&l.push([null,u,!1])),u=h+1));while(-1!==h);u<p.length-1&&
(p=p.substr(u),l.push([p,null,I(p)]));return l}function y(p,c,l){let u="",h=null;for(const r of c){const [d,t,G]=r;if(d)G?h=d:(h&&(u+=h,h=null),u+=d);else if(c=p.attributes[t])h&&(u+=h,h=null),u+=c}return O(u,l)}function O(p,c){"string"!==typeof p&&(p=String(p));switch(c){case "LowerCase":return p.toLowerCase();case "Allcaps":return p.toUpperCase();default:return p}}function V(p){return p?{r:p[0],g:p[1],b:p[2],a:p[3]/255}:{r:0,g:0,b:0,a:0}}function L(p){if(!p)return null;switch(p.type){case "CIMPolygonSymbol":if(p.symbolLayers)for(const c of p.symbolLayers)if(p=
L(c),null!=p)return p;break;case "CIMTextSymbol":return L(p.symbol);case "CIMSolidFill":return p.color}}function P(p){if(p)switch(p.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(p=p.symbolLayers)for(const c of p)if(p=P(c),null!=p)return p;break;case "CIMTextSymbol":return P(p.symbol);case "CIMSolidStroke":case "CIMSolidFill":return p.color}}function B(p){if(p)switch(p.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(p.symbolLayers)for(const c of p.symbolLayers)if(p=B(c),void 0!==p)return p;
break;case "CIMTextSymbol":return B(p.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return p.width}}D.adjustTextCase=O;D.analyzeTextParts=F;D.assignTextValuesFromFeature=y;D.attributesToFields=function(p){return(p?Object.keys(p):[]).map(c=>({name:c,alias:c,type:"string"===typeof p[c]?"esriFieldTypeString":"esriFieldTypeDouble"}))};D.colorToArray=function(p){return[p.r,p.g,p.b,p.a]};D.createLabelOverrideFunction=function(p,c,l){const u=F(c,p);return h=>y(h,u,l)};D.evaluateValueOrFunction=
function(p,c,l,u){return"function"===typeof p?p(c,l,u):p};D.fromCIMColor=V;D.fromCIMFontDecoration=function(p){return p.underline?"underline":p.strikethrough?"line-through":"none"};D.fromCIMFontStyle=function(p){let c="",l="";p&&(p=p.toLowerCase(),p.includes("italic")?c="italic":p.includes("oblique")&&(c="oblique"),p.includes("bold")?l="bold":p.includes("light")&&(l="lighter"));return{style:c,weight:l}};D.fromCIMHorizontalAlignment=function(p){switch(p){default:return"left";case "Right":return"right";
case "Center":return"center";case "Justify":return"center"}};D.fromCIMVerticalAlignment=function(p){switch(p){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}};D.getFillColor=L;D.getFontStyle=function(p){if(!p)return"normal";switch(p.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};D.getFontWeight=function(p){if(!p)return"normal";switch(p.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";
case "lighter":return"lighter";default:return"normal"}};D.getStrokeColor=P;D.getStrokeWidth=B;D.getTintColor=p=>p.tintColor?V(p.tintColor):{r:255,g:255,b:255,a:1};D.getValue=(p,c=0)=>null==p||isNaN(p)?c:p;D.importGeometryEngine=function(){return new Promise((p,c)=>N(["../../geometry/geometryEngineJSON"],p,c))};D.isCIMFill=function(p){return null!=p&&("CIMGradientFill"===p.type||"CIMHatchFill"===p.type||"CIMPictureFill"===p.type||"CIMSolidFill"===p.type||"CIMWaterFill"===p.type)};D.isCIMMarker=function(p){return"CIMVectorMarker"===
p.type||"CIMPictureMarker"===p.type||"CIMBarChartMarker"===p.type||"CIMCharacterMarker"===p.type||"CIMPieChartMarker"===p.type||"CIMStackedBarChartMarker"===p.type};D.isCIMMarkerStrokePlacement=function(p){return null!=p&&("CIMMarkerPlacementAlongLineRandomSize"===p.type||"CIMMarkerPlacementAlongLineSameSize"===p.type||"CIMMarkerPlacementAlongLineVariableSize"===p.type||"CIMMarkerPlacementAtExtremities"===p.type||"CIMMarkerPlacementAtMeasuredUnits"===p.type||"CIMMarkerPlacementAtRatioPositions"===
p.type||"CIMMarkerPlacementOnLine"===p.type||"CIMMarkerPlacementOnVertices"===p.type)};D.isCIMStroke=function(p){return"CIMGradientStroke"===p.type||"CIMPictureStroke"===p.type||"CIMSolidStroke"===p.type};D.isGeometryEngineRequired=p=>{if(!p)return!1;for(const c of p)switch(c.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};D.isSVGImage=p=>p.includes("data:image/svg+xml");D.mapCIMSymbolToGeometryType=function(p){if(!p)return null;
switch(p.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};D.resampleHermite=function(p,c,l,u,h,r,d=!0){const t=c/h;l/=r;const G=Math.ceil(t/2),E=Math.ceil(l/2);for(let m=0;m<r;m++)for(let f=0;f<h;f++){const k=4*(f+(d?r-m-1:m)*h);var a=0;let g=0,b=0,e=0,v=0,w=0,C=0;const M=(m+.5)*l;for(let K=Math.floor(m*l);K<(m+1)*l;K++){var n=Math.abs(M-(K+.5))/E;const x=
(f+.5)*t;n*=n;for(let q=Math.floor(f*t);q<(f+1)*t;q++){let A=Math.abs(x-(q+.5))/G;a=Math.sqrt(n+A*A);-1<=a&&1>=a&&(a=2*a*a*a-3*a*a+1,0<a&&(A=4*(q+K*c),C+=a*p[A+3],b+=a,255>p[A+3]&&(a=a*p[A+3]/250),e+=a*p[A],v+=a*p[A+1],w+=a*p[A+2],g+=a))}}u[k]=e/g;u[k+1]=v/g;u[k+2]=w/g;u[k+3]=C/b}};D.toCIMSymbolJSON=function(p){return p.data?.symbol??null};Object.defineProperty(D,Symbol.toStringTag,{value:"Module"})})},"esri/layers/mixins/ImageryTileMixin":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../rasterRenderers ../../request ../../core/Error ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/support/spatialReferenceUtils ../support/arcgisLayerUrl ../support/commonProperties ../support/DimensionalDefinition ../support/MultidimensionalSubset ../support/RasterFunction ../support/RasterJobHandler ../support/TileInfo ../support/rasterDatasets/FunctionRaster ../support/rasterDatasets/multidimensionalUtils ../support/rasterFunctions/rasterFunctionHelper ../support/rasterFunctions/vectorFieldUtils ../../renderers/support/rasterRendererHelper ../../renderers/support/RasterSymbolizer ../../views/2d/engine/flow/dataUtils ../../geometry/SpatialReference".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a,n,m,f,k,g,b,e,v,w){const C=L.getLogger("esri.layers.mixins.ImageryTileMixin");N.ImageryTileMixin=M=>{function K(x){if(!x.raster||!x.rasterInfo)throw new V("imagery-tile","no raster");}M=function(x){function q(...H){var Q=A.call(this,...H);Q._isConstructedFromFunctionRaster=!1;Q._rasterJobHandler={instance:null,refCount:0,connectionPromise:null};Q.bandIds=null;Q.copyright=null;Q.interpolation="nearest";Q.multidimensionalSubset=null;Q.raster=null;Q.rasterFunction=
null;Q.rasterInfo=null;Q.sourceJSON=null;Q.spatialReference=null;Q.symbolizer=null;Q._isConstructedFromFunctionRaster="Function"===H[0]?.raster?.datasetFormat;return Q}D._inherits(q,x);var A=D._createSuper(q);x=q.prototype;x.convertVectorFieldData=async function(H,Q){if(P.isNone(H)||!this.rasterInfo)return null;const S=this._rasterJobHandler.instance,z=this.rasterInfo.dataType;return S?S.convertVectorFieldData({pixelBlock:H,dataType:z},Q):g.convertVectorFieldData(H,z)};x.createFlowMesh=async function(H,
Q){const S=this._rasterJobHandler.instance;return S?S.createFlowMesh(H,Q):v.createFlowMesh(H.meshType,H.simulationSettings,H.flowData,P.isSome(Q.signal)?Q.signal:(new AbortController).signal)};x.normalizeRasterFetchOptions=function(H){var {multidimensionalInfo:Q}=this.rasterInfo??{};if(P.isNone(Q))return H;let S=H.multidimensionalDefinition||this.multidimensionalDefinition;if(P.isNone(S)||!S.length)S=f.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset});
var z=H.timeExtent||this.timeExtent;if(P.isSome(S)&&P.isSome(z)&&(P.isSome(z.start)||P.isSome(z.end))){S=S.map(T=>T.clone());var J=Q.variables.find(({name:T})=>T===S[0].variableName)?.dimensions?.find(({name:T})=>"StdTime"===T);Q=S.find(({dimensionName:T})=>"StdTime"===T);if(!J||!Q)return{...H,multidimensionalDefinition:null};const {start:R,end:W}=z;z=P.isNone(R)?null:R.getTime();const Z=P.isNone(W)?null:W.getTime(),Y=z??Z,X=Z??z;if(P.isSome(J.values))J=J.values.filter(T=>{if(Array.isArray(T)){if(Y===
X)return T[0]<=Y&&T[1]>=Y;const U=T[0]>=Y&&T[1]<=X||T[0]<Y&&T[1]>X;return T[0]<=Y&&T[1]>Y||T[0]<X&&T[1]>=X||U}return Y===X?T===Y:T>=Y&&T<=X}),J.length?(J=J.sort((T,U)=>Y===X?(T[0]??T)-(U[0]??U):Math.abs((T[1]??T)-X)-Math.abs((U[1]??U)-X))[0],Q.values=[J]):S=null;else if(J.hasRegularIntervals&&J.extent){const [T,U]=J.extent;Y>U||X<T?S=null:Q.values=Y===X?[Y]:[Math.max(T,Y),Math.min(U,X)]}}return P.isSome(S)&&f.hasExcludedVariableOrDimension(S,this.multidimensionalSubset)?{...H,multidimensionalDefinition:null}:
{...H,multidimensionalDefinition:S}};x.updateRasterFunction=async function(){if("imagery-tile"===this.type&&(this.rasterFunction||this._cachedRasterFunctionJson)&&JSON.stringify(this.rasterFunction)!==JSON.stringify(this._cachedRasterFunctionJson))if(this._isConstructedFromFunctionRaster&&"Function"===this.raster.datasetFormat){var H=this.raster.rasterFunction.toJSON();!this.rasterFunction&&H&&this._set("rasterFunction",E.fromJSON(H));this._cachedRasterFunctionJson=this.rasterFunction?.toJSON()}else{var Q=
this.raster;H=!1;if("Function"===Q.datasetFormat){var S=Q.primaryRasters.rasters;Q=S[0];H=!0}else S=[Q];var {rasterFunction:z}=this;if(z){const R={raster:Q};1<S.length&&S.forEach(W=>R[W.url]=W);Q=k.create(z.rasterFunctionDefinition??z.toJSON(),R);Q=new m({rasterFunction:Q});Q.rasterJobHandler=this._rasterJobHandler.instance;await Q.open();this._cachedRasterFunctionJson=this.rasterFunction?.toJSON();this.raster=Q}else this.raster=Q,this._cachedRasterFunctionJson=null;this._cachedRendererJson=null;
if(H||z){({bandIds:H}=this);var {bandCount:J}=this.raster.rasterInfo;z=H?.length?H.some(R=>R>=J):3<=J;H&&(z||"raster-stretch"!==this.renderer.type)&&this._set("bandIds",null);this._configDefaultRenderer("auto")}}};x.updateRenderer=async function(){const {loaded:H,symbolizer:Q}=this;if(H&&Q){var {rasterInfo:S}=this.raster,z=f.getDefaultVariablInfo(S,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,J=b.normalizeRendererJSON({...this.renderer.toJSON(),
variableName:z});if(JSON.stringify(this._cachedRendererJson)!==JSON.stringify(J)){var R=this._rasterJobHandler.instance;R&&(Q.rasterInfo=b.getVariableRasterInfo(S,z),Q.rendererJSON=J,Q.bind(),await R.updateSymbolizer(Q),this._cachedRendererJson=J)}}};x.applyRenderer=async function(H,Q){var S=H&&H.pixelBlock;if(!(P.isSome(S)&&S.pixels&&0<S.pixels.length))return null;await this.updateRenderer();S=this._rasterJobHandler.instance;const z=this.bandIds??[];return S?await S.symbolize({...H,simpleStretchParams:Q,
bandIds:z}):this.symbolizer.symbolize({...H,simpleStretchParams:Q,bandIds:z})};x.getTileUrl=function(H,Q,S){return"RasterTileServer"===this.raster.datasetFormat?`${this.url}/tile/${H}/${Q}/${S}`:""};x.getCompatibleTileInfo=function(H,Q,S=!1){if(!this.loaded||P.isNone(Q))return null;if(S&&H.equals(this.spatialReference))return this.tileInfo;S=h.getInfo(H);return n.create({size:256,spatialReference:H,origin:S?{x:S.origin[0],y:S.origin[1]}:{x:Q.xmin,y:Q.ymax}})};x.getCompatibleFullExtent=function(H){return this.loaded?
this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(H)?this._compatibleFullExtent:this._compatibleFullExtent=this.raster.computeExtent(H):null};x.fetchTile=async function(H,Q,S,z={}){K(this);if(z.requestAsImageElement)return H=this.getTileUrl(H,Q,S),O(H,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:z.signal}).then(R=>R.data);const {rasterInfo:J}=this;if(P.isSome(J.multidimensionalInfo)&&(z=this.normalizeRasterFetchOptions(z),
P.isNone(z.multidimensionalDefinition)))return{extent:this.raster.getTileExtentFromTileInfo(H,Q,S,z.tileInfo||J.storageInfo.tileInfo),pixelBlock:null};await this._initJobHandler();await this.updateRasterFunction();"raster-shaded-relief"===this.renderer.type&&(z={...z,buffer:{cols:1,rows:1}});return this.raster.fetchTile(H,Q,S,z)};x.fetchPixels=async function(H,Q,S,z={}){if(P.isSome(this.rasterInfo.multidimensionalInfo)&&(z=this.normalizeRasterFetchOptions(z),P.isNone(z.multidimensionalDefinition)))return{extent:H,
pixelBlock:null};await this._initJobHandler();await this.updateRasterFunction();return this.raster.fetchPixels(H,Q,S,z)};x.identify=async function(H,Q={}){const {raster:S,rasterInfo:z}=this;if(P.isSome(z.multidimensionalInfo)&&(!z.hasMultidimensionalTranspose||!(f.isMultiSliceOrRangeDefinition(Q.multidimensionalDefinition)||Q.transposedVariableName||Q.timeExtent))&&(Q=this.normalizeRasterFetchOptions(Q),P.isNone(Q.multidimensionalDefinition)))return{location:H,value:null};const J=this.multidimensionalSubset?.areaOfInterest;
if(J&&!J.contains(H))throw new V("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");return S.identify(H,Q)};x.increaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount++};x.decreaseRasterJobHandlerUsage=function(){this._rasterJobHandler.refCount--;0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()};x.hasStandardTime=function(){const H=this.rasterInfo?.multidimensionalInfo;if(P.isNone(H)||"standard-time"!==
this.rasterInfo?.dataType)return!1;const Q=this.multidimensionalDefinition,S=Q?.[0]?.variableName;return H.variables.some(z=>z.name===S&&(!Q?.[0].dimensionName||z.dimensions.some(J=>"StdTime"===J.name)))};x.getStandardTimeValue=function(H){return(new Date(864E5*(H-25569))).toString()};x.getMultidimensionalSubsetVariables=function(H){return f.getSubsetVariablesFromMdInfo(this.multidimensionalSubset,H??this.rasterInfo?.multidimensionalInfo)};x._configDefaultSettings=function(){this._configDefaultInterpolation();
this.multidimensionalDefinition||(this.multidimensionalDefinition=f.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));this._configDefaultRenderer()};x._initJobHandler=function(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const H=new a;this._rasterJobHandler.connectionPromise=H.initialize().then(()=>{K(this);this._rasterJobHandler.instance=H;this.raster.rasterJobHandler=H;this.renderer&&
this.updateRenderer();"Function"===this.raster.datasetFormat&&this.raster.syncJobHandler()}).catch(()=>{});return this._rasterJobHandler.connectionPromise};x._shutdownJobHandler=function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy();this._rasterJobHandler.instance=null;this._rasterJobHandler.connectionPromise=null;this._rasterJobHandler.refCount=0;this._cachedRendererJson=null;this.raster&&(this.raster.rasterJobHandler=null)};x._configDefaultInterpolation=function(){if(null==
this.interpolation){K(this);var {raster:H}=this;H=b.getDefaultInterpolation(H.rasterInfo,H.tileType,this.sourceJSON?.defaultResamplingMethod);this._set("interpolation",H)}};x._configDefaultRenderer=function(H="no"){K(this);var {rasterInfo:Q}=this.raster;!this.bandIds&&1<Q.bandCount&&(this.bandIds=b.getDefaultBandCombination(Q));var S=f.getDefaultVariablInfo(Q,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name;if(!this.renderer||"override"===
H){var z=b.createDefaultRenderer(Q,{bandIds:this.bandIds,variableName:S});"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===z.type&&(1E24<(Q.statistics?.[0].max??0)||-1E24>(Q.statistics?.[0].min??0))&&(z.dynamicRangeAdjustment=!0,z.statistics=null,"none"===z.stretchType&&(z.stretchType="min-max"));this.renderer=z}z=b.normalizeRendererJSON({...this.renderer.toJSON(),variableName:S});Q=b.getVariableRasterInfo(Q,S);this.symbolizer?(this.symbolizer.rendererJSON=z,this.symbolizer.rasterInfo=
Q):this.symbolizer=new e({rendererJSON:z,rasterInfo:Q});Q=this.symbolizer.bind();Q.success?"auto"===H&&({colormap:Q}=this.raster.rasterInfo,H=this.renderer,P.isSome(Q)?"raster-colormap"!==H.type?this._configDefaultRenderer("override"):(Q=b.createDefaultRenderer(this.raster.rasterInfo),JSON.stringify(Q)!==JSON.stringify(H)&&this._configDefaultRenderer("override")):"raster-stretch"===H.type&&(Q=this.bandIds?.length,S=H.statistics?.length,!H.dynamicRangeAdjustment&&S&&Q&&S!==Q&&this._configDefaultRenderer("override"))):
(C.warn("imagery-tile-mixin",Q.error||"The given renderer is not supported by the layer."),"auto"===H&&this._configDefaultRenderer("override"))};D._createClass(q,[{key:"fullExtent",get:function(){return this.rasterInfo?.extent}},{key:"multidimensionalDefinition",set:function(H){this._set("multidimensionalDefinition",H);this.updateRenderer()}},{key:"tileInfo",get:function(){return this.rasterInfo?.storageInfo.tileInfo}},{key:"url",set:function(H){this._set("url",r.sanitizeUrl(H,C))}},{key:"renderer",
set:function(H){this._set("renderer",H);this.updateRenderer()}}]);return q}(M);I.__decorate([B.property()],M.prototype,"_cachedRendererJson",void 0);I.__decorate([B.property()],M.prototype,"_cachedRasterFunctionJson",void 0);I.__decorate([B.property()],M.prototype,"_compatibleFullExtent",void 0);I.__decorate([B.property()],M.prototype,"_isConstructedFromFunctionRaster",void 0);I.__decorate([B.property()],M.prototype,"_rasterJobHandler",void 0);I.__decorate([B.property()],M.prototype,"bandIds",void 0);
I.__decorate([B.property({json:{origins:{service:{read:{source:"copyrightText"}}}}})],M.prototype,"copyright",void 0);I.__decorate([B.property({json:{read:!1}})],M.prototype,"fullExtent",null);I.__decorate([B.property()],M.prototype,"interpolation",void 0);I.__decorate([B.property()],M.prototype,"ioConfig",void 0);I.__decorate([B.property({type:[t],json:{write:!0}})],M.prototype,"multidimensionalDefinition",null);I.__decorate([B.property({type:G,json:{write:!0}})],M.prototype,"multidimensionalSubset",
void 0);I.__decorate([B.property()],M.prototype,"raster",void 0);I.__decorate([B.property({type:E})],M.prototype,"rasterFunction",void 0);I.__decorate([B.property()],M.prototype,"rasterInfo",void 0);I.__decorate([B.property()],M.prototype,"sourceJSON",void 0);I.__decorate([B.property({readOnly:!0,type:w,json:{read:!1}})],M.prototype,"spatialReference",void 0);I.__decorate([B.property({json:{read:!1}})],M.prototype,"tileInfo",null);I.__decorate([B.property(d.url)],M.prototype,"url",null);I.__decorate([B.property({types:y.rasterRendererTypes})],
M.prototype,"renderer",null);I.__decorate([B.property()],M.prototype,"symbolizer",void 0);return M=I.__decorate([u.subclass("esri.layers.ImageryTileMixin")],M)};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/DimensionalDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),
function(N,D,I,F,y,O,V){var L;I=L=function(P){function B(c){c=p.call(this,c);c.variableName=null;c.dimensionName=null;c.values=[];c.isSlice=!1;return c}N._inherits(B,P);var p=N._createSuper(B);B.prototype.clone=function(){return new L({variableName:this.variableName,dimensionName:this.dimensionName,values:F.clone(this.values),isSlice:this.isSlice})};return N._createClass(B)}(I.JSONSupport);D.__decorate([y.property({type:String,json:{write:!0}})],I.prototype,"variableName",void 0);D.__decorate([y.property({type:String,
json:{write:!0}})],I.prototype,"dimensionName",void 0);D.__decorate([y.property({type:O.types.array(O.types.oneOf([O.types.native(Number),O.types.array(O.types.native(Number))])),json:{write:!0}})],I.prototype,"values",void 0);D.__decorate([y.property({type:Boolean,json:{write:!0}})],I.prototype,"isSlice",void 0);return I=L=D.__decorate([V.subclass("esri.layers.support.DimensionalDefinition")],I)})},"esri/layers/support/MultidimensionalSubset":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Polygon ../../geometry/support/jsonUtils ./DimensionalDefinition ../../geometry/Geometry".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u){var h;I={base:u,key:"type",typeMap:{extent:B,polygon:p}};F=h=function(r){function d(G){G=t.call(this,G);G.areaOfInterest=null;G.subsetDefinitions=null;return G}N._inherits(d,r);var t=N._createSuper(d);d.prototype.clone=function(){const G=this.subsetDefinitions?.map(a=>a.clone()),E=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new h({areaOfInterest:E,subsetDefinitions:G})};N._createClass(d,[{key:"dimensions",get:function(){var {subsetDefinitions:G}=
this;if(null==G||0===G.length)return[];const E=new Map;G.forEach(a=>{if(a.dimensionName){if(Array.isArray(a.values[0])){var n=a.values;var m=n[0][0];n=n[a.values.length-1][1]}else n=a.values,m=n[0],n=n[a.values.length-1];E.has(a.dimensionName)?(a=E.get(a.dimensionName),a[0]=Math.min(m,a[0]),a[1]=Math.max(n,a[1])):E.set(a.dimensionName,[m,n])}});G=[];for(const a of E)G.push({name:a[0],extent:a[1]});return G}},{key:"variables",get:function(){const {subsetDefinitions:G}=this;if(null==G||0===G.length)return[];
const E=new Set;G.forEach(a=>{a.variableName&&E.add(a.variableName)});return[...E]}}]);return d}(F.JSONSupport);D.__decorate([y.property({types:I,json:{read:c.fromJSON,write:!0}})],F.prototype,"areaOfInterest",void 0);D.__decorate([y.property({readOnly:!0})],F.prototype,"dimensions",null);D.__decorate([y.property({readOnly:!0})],F.prototype,"variables",null);D.__decorate([y.property({type:[l],json:{write:!0}})],F.prototype,"subsetDefinitions",void 0);return F=h=D.__decorate([P.subclass("esri.layers.support.MultidimensionalSubset")],
F)})},"esri/layers/support/RasterFunction":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(N,D,I,F,y,O,V,L,P,B){var p;const c=new Set(["raster",
"raster2","dem","fillraster"]),l=new Set(["rasters"]),u=t=>t&&t.rasterFunction?d.fromJSON(t):t,h=t=>t&&t instanceof d?t.toJSON():t,r=t=>t?.functionName&&!t.declaredClass?new d(t):t;let d=p=function(t){function G(a){a=E.call(this,a);a.functionName=null;a.outputPixelType="unknown";a.variableName=null;a.rasterFunctionDefinition=null;return a}N._inherits(G,t);var E=N._createSuper(G);t=G.prototype;t.readFunctionArguments=function(a){if(null==a)var n=null;else{a=F.clone(a);var m={};for(n of Object.keys(a))c.has(n.toLowerCase())?
m[n]=u(a[n]):l.has(n.toLowerCase())&&Array.isArray(a[n])?m[n]=a[n].map(u):m[n]=a[n];n=m}return n};t.writeFunctionArguments=function(a,n,m){const f={};for(const k of Object.keys(a))c.has(k.toLowerCase())?f[k]=h(a[k]):l.has(k.toLowerCase())&&Array.isArray(a[k])?f[k]=a[k].map(h):f[k]=h(a[k]);n[m]=f};t.readFunctionName=function(a,n){a=n.rasterFunctionInfos;const m=n.name;return m?m:a&&a.length&&"None"!==a[0].name?a[0].name:n.rasterFunctionDefinition?n.rasterFunctionDefinition.name:n.rasterFunction};t.clone=
function(){return new p({functionName:this.functionName,functionArguments:F.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:F.clone(this.rasterFunctionDefinition)})};N._createClass(G,[{key:"functionArguments",set:function(a){if(a){const n=Object.keys(a);if(n.some(m=>{var f;if(f=c.has(m.toLowerCase()))m=a[m],f=m?.functionName&&!m.declaredClass;return f})||n.some(m=>l.has(m.toLowerCase())&&Array.isArray(a[m])&&a[m].some(f=>f?.functionName&&
!f.declaredClass))){a=F.clone(a);for(const m of n)c.has(m.toLowerCase())?a[m]=r(a[m]):l.has(m.toLowerCase())&&Array.isArray(a[m])&&(a[m]=a[m].map(f=>r(f)))}}this._set("functionArguments",a)}}]);return G}(I.JSONSupport);D.__decorate([y.property({json:{type:Object,name:"rasterFunctionArguments"}})],d.prototype,"functionArguments",null);D.__decorate([L.reader("functionArguments")],d.prototype,"readFunctionArguments",null);D.__decorate([B.writer("functionArguments")],d.prototype,"writeFunctionArguments",
null);D.__decorate([y.property({json:{type:String,write:{target:"rasterFunction"}}})],d.prototype,"functionName",void 0);D.__decorate([L.reader("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],d.prototype,"readFunctionName",null);D.__decorate([V.enumeration({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),y.property({json:{default:"unknown"}})],d.prototype,
"outputPixelType",void 0);D.__decorate([y.property({type:String,json:{read:!0,write:!0}})],d.prototype,"variableName",void 0);D.__decorate([y.property({type:Object,json:{name:"rasterFunctionDefinition"}})],d.prototype,"rasterFunctionDefinition",void 0);return d=p=D.__decorate([P.subclass("esri.layers.support.RasterFunction")],d)})},"esri/layers/support/RasterJobHandler":function(){define(["../../chunks/_rollupPluginBabelHelpers","../../core/Error","../../core/maybe","../../core/workers/workers","./PixelBlock"],
function(N,D,I,F,y){return function(){function O(){this._workerThread=null;this._destroyed=!1}var V=O.prototype;V.initialize=async function(){const L=await F.open("RasterWorker");this._destroyed?L.close():this._workerThread=L};V.destroy=function(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),this._workerThread=null)};V.convertVectorFieldData=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(L=await this._workerThread.invoke("convertVectorFieldData",
{pixelBlock:L.pixelBlock.toJSON(),type:L.dataType},P))?new y(L):null};V.decode=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(L=await this._workerThread.invoke("decode",L,P))?new y(L):null};V.symbolize=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");L={extent:L.extent&&L.extent.toJSON(),pixelBlock:I.isSome(L.pixelBlock)&&L.pixelBlock.toJSON(),
simpleStretchParams:L.simpleStretchParams,bandIds:L.bandIds};return(P=await this._workerThread.invoke("symbolize",L,P))?new y(P):null};V.updateSymbolizer=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");const B=L?.rendererJSON?.histograms;await Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:L.toJSON(),histograms:B},P))};V.updateRasterFunction=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection",
"no available worker connection");await Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:L.toJSON()},P))};V.process=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");return(L=await this._workerThread.invoke("process",{extent:L.extent?.toJSON(),primaryPixelSizes:L.primaryPixelSizes?.map(B=>I.isSome(B)?B.toJSON():null),primaryPixelBlocks:L.primaryPixelBlocks.map(B=>I.isSome(B)?B.toJSON():null),
primaryRasterIds:L.primaryRasterIds},P))?new y(L):null};V.stretch=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!L?.pixelBlock)return null;L={srcPixelBlock:L.pixelBlock.toJSON(),stretchParams:L.stretchParams};return(P=await this._workerThread.invoke("stretch",L,P))?new y(P):null};V.split=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!L?.pixelBlock)return null;
L={srcPixelBlock:L.pixelBlock.toJSON(),tileSize:L.tileSize,maximumPyramidLevel:L.maximumPyramidLevel};const B=await this._workerThread.invoke("split",L,P);B&&B.forEach((p,c)=>{B.set(c,p?y.fromJSON(p):null)});return B};V.estimateStatisticsHistograms=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!L?.pixelBlock)return null;L={srcPixelBlock:L.pixelBlock.toJSON()};return await this._workerThread.invoke("estimateStatisticsHistograms",
L,P)};V.mosaicAndTransform=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection","no available worker connection");if(!L?.srcPixelBlocks?.length)return{pixelBlock:null};L={...L,srcPixelBlocks:L.srcPixelBlocks.map(B=>I.isSome(B)?B.toJSON():null)};P=await this._workerThread.invoke("mosaicAndTransform",L,P);return{pixelBlock:P.pixelBlock?new y(P.pixelBlock):null,localNorthDirections:P.localNorthDirections}};V.createFlowMesh=async function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection",
"no available worker connection");const B={buffer:L.flowData.data.buffer,maskBuffer:L.flowData.mask.buffer,width:L.flowData.width,height:L.flowData.height},{meshType:p,simulationSettings:c}=L;L=await this._workerThread.invoke("createFlowMesh",{meshType:p,flowData:B,simulationSettings:c},{...P,transferList:[B.buffer,B.maskBuffer]});return{vertexData:new Float32Array(L.vertexBuffer),indexData:new Uint32Array(L.indexBuffer)}};V.getProjectionOffsetGrid=function(L,P){if(!this._workerThread)throw new D("raster-jobhandler:no-connection",
"no available worker connection");const B=I.isSome(L.datumTransformation)?L.datumTransformation.steps.map(c=>({wkid:c.wkid,wkt:c.wkt,isInverse:c.isInverse})):null,p=I.isSome(L.rasterTransform)?L.rasterTransform.toJSON():null;L={projectedExtent:L.projectedExtent.toJSON(),srcBufferExtent:L.srcBufferExtent.toJSON(),pixelSize:L.pixelSize,hasWrapAround:L.hasWrapAround,spacing:L.spacing,datumTransformationSteps:B,rasterTransform:p,isAdaptive:L.isAdaptive,includeGCSGrid:L.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",
L,P)};return N._createClass(O)}()})},"esri/layers/support/TileInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E){var a;I=new I.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});F=a=function(n){function m(k){k=f.call(this,k);k.dpi=96;k.format=null;k.origin=null;k.minScale=0;k.maxScale=0;k.size=null;k.spatialReference=null;return k}N._inherits(m,n);var f=N._createSuper(m);m.create=
function(k={}){const {resolutionFactor:g=1,scales:b,size:e=256,spatialReference:v=h.WebMercator,numLODs:w=24}=k;if(!d.isValid(v)){k=[];if(b)for(var C=0;C<b.length;C++){var M=b[C];k.push(new G({level:C,scale:M,resolution:M}))}else for(C=5E-4,M=w-1;0<=M;M--)k.unshift(new G({level:M,scale:C,resolution:C})),C*=2;return new a({dpi:96,lods:k,origin:new u(0,0,v),size:[e,e],spatialReference:v})}C=d.getInfo(v);k=k.origin?new u({x:k.origin.x,y:k.origin.y,spatialReference:v}):C?new u({x:C.origin[0],y:C.origin[1],
spatialReference:v}):new u({x:0,y:0,spatialReference:v});C=1/(39.37*O.getMetersPerUnitForSR(v)*96);M=[];if(b)for(var K=0;K<b.length;K++){var x=b[K];M.push(new G({level:K,scale:x,resolution:x*C}))}else{var q=d.isGeographic(v)?512/e*5.916575275917094E8:256/e*5.91657527591555E8;K=Math.ceil(w/g);M.push(new G({level:0,scale:q,resolution:q*C}));for(x=1;x<K;x++)q/=2**g,M.push(new G({level:x,scale:q,resolution:q*C}))}return new a({dpi:96,lods:M,origin:k,size:[e,e],spatialReference:v})};n=m.prototype;n.readOrigin=
function(k,g){return u.fromJSON({spatialReference:g.spatialReference,...k})};n.readSize=function(k,g){return[g.cols,g.rows]};n.writeSize=function(k,g){g.cols=k[0];g.rows=k[1]};n.zoomToScale=function(k){const g=this.scales;if(0>=k)return g[0];if(k>=g.length-1)return g[g.length-1];const b=Math.floor(k);return g[b]/(g[b]/g[b+1])**(k-b)};n.scaleToZoom=function(k){const g=this.scales,b=g.length-1;let e=0;for(;e<b;e++){const v=g[e],w=g[e+1];if(v<=k)break;if(w===k)return e+1;if(v>k&&w<k)return e+Math.log(v/
k)/Math.log(v/w)}return e};n.snapScale=function(k,g=.95){k=this.scaleToZoom(k);return k%Math.floor(k)>=g?this.zoomToScale(Math.ceil(k)):this.zoomToScale(Math.floor(k))};n.tileAt=function(k,g,b,e){var v=this.lodAt(k);if(!v)return null;let w;if("number"===typeof g)w=g,g=b;else{if(d.equals(g.spatialReference,this.spatialReference))w=g.x,g=g.y;else{e=t.project(g,this.spatialReference);if(y.isNone(e))return null;w=e.x;g=e.y}e=b}b=v.resolution*this.size[0];v=v.resolution*this.size[1];e||(e=new E.TileKey(null,
0,0,0,r.create()));e.level=k;e.row=Math.floor((this.origin.y-g)/v+.001);e.col=Math.floor((w-this.origin.x)/b+.001);this.updateTileInfo(e);return e};n.updateTileInfo=function(k,g=a.ExtrapolateOptions.NONE){var b=this.lodAt(k.level);b||g!==a.ExtrapolateOptions.POWER_OF_TWO||(g=this.lods[this.lods.length-1],g.level<k.level&&(b=g));if(b){var e=k.level-b.level;g=b.resolution*this.size[0]/2**e;b=b.resolution*this.size[1]/2**e;k.id=`${k.level}/${k.row}/${k.col}`;k.extent||(k.extent=r.create());k.extent[0]=
this.origin.x+k.col*g;k.extent[1]=this.origin.y-(k.row+1)*b;k.extent[2]=k.extent[0]+g;k.extent[3]=k.extent[1]+b}};n.upsampleTile=function(k){const g=this._upsampleLevels[k.level];if(!g||-1===g.parentLevel)return!1;k.level=g.parentLevel;k.row=Math.floor(k.row/g.factor+.001);k.col=Math.floor(k.col/g.factor+.001);this.updateTileInfo(k);return!0};n.getTileBounds=function(k,g){var b=this.lodAt(g.level);if(null==b)return null;var {resolution:e}=b;b=e*this.size[0];e*=this.size[1];k[0]=this.origin.x+g.col*
b;k[1]=this.origin.y-(g.row+1)*e;k[2]=k[0]+b;k[3]=k[1]+e;return k};n.lodAt=function(k){return this._levelToLOD?.[k]??null};n.clone=function(){return a.fromJSON(this.write({}))};n.getOrCreateCompatible=function(k,g){if(256===this.size[0]&&256===this.size[1])return 256===k?this:null;const b=[],e=this.lods.length;for(let v=0;v<e;v++){const w=this.lods[v];b.push(new G({level:w.level,scale:w.scale,resolution:w.resolution*g}))}return new a({size:[k,k],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,
origin:this.origin,spatialReference:this.spatialReference,lods:b})};n._initializeUpsampleLevels=function(){const k=this.lods;this._upsampleLevels=[];let g=null;for(let b=0;b<k.length;b++){const e=k[b];this._upsampleLevels[e.level]={parentLevel:g?g.level:-1,factor:g?g.resolution/e.resolution:0};g=e}};N._createClass(m,[{key:"isWrappable",get:function(){const {spatialReference:k,origin:g}=this;if(k&&g){const b=d.getInfo(k);return k.isWrappable&&!!b&&Math.abs(b.origin[0]-g.x)<=b.dx}return!1}},{key:"lods",
set:function(k){let g=0,b=0;const e=[],v=this._levelToLOD={};k&&(g=-Infinity,b=Infinity,k.forEach(w=>{e.push(w.scale);g=w.scale>g?w.scale:g;b=w.scale<b?w.scale:b;v[w.level]=w}));this._set("scales",e);this._set("minScale",g);this._set("maxScale",b);this._set("lods",k);this._initializeUpsampleLevels()}}]);return m}(F.JSONSupport);D.__decorate([V.property({type:Number,json:{write:!0}})],F.prototype,"compressionQuality",void 0);D.__decorate([V.property({type:Number,json:{write:!0}})],F.prototype,"dpi",
void 0);D.__decorate([V.property({type:String,json:{read:I.read,write:I.write,origins:{"web-scene":{read:!1,write:!1}}}})],F.prototype,"format",void 0);D.__decorate([V.property({readOnly:!0})],F.prototype,"isWrappable",null);D.__decorate([V.property({type:u,json:{write:!0}})],F.prototype,"origin",void 0);D.__decorate([p.reader("origin")],F.prototype,"readOrigin",null);D.__decorate([V.property({type:[G],value:null,json:{write:!0}})],F.prototype,"lods",null);D.__decorate([V.property({readOnly:!0})],
F.prototype,"minScale",void 0);D.__decorate([V.property({readOnly:!0})],F.prototype,"maxScale",void 0);D.__decorate([V.property({readOnly:!0})],F.prototype,"scales",void 0);D.__decorate([V.property({cast:n=>Array.isArray(n)?n:"number"===typeof n?[n,n]:[256,256]})],F.prototype,"size",void 0);D.__decorate([p.reader("size",["rows","cols"])],F.prototype,"readSize",null);D.__decorate([l.writer("size",{cols:{type:L.Integer},rows:{type:L.Integer}})],F.prototype,"writeSize",null);D.__decorate([V.property({type:h,
json:{write:!0}})],F.prototype,"spatialReference",void 0);F=a=D.__decorate([c.subclass("esri.layers.support.TileInfo")],F);(function(n){n=n.ExtrapolateOptions||(n.ExtrapolateOptions={});n[n.NONE=0]="NONE";n[n.POWER_OF_TWO=1]="POWER_OF_TWO"})(F||(F={}));return F})},"esri/layers/support/LOD":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(N,D,I,F,y,O,V,L){var P;I=P=function(B){function p(l){l=c.call(this,l);l.cols=null;l.level=0;l.levelValue=null;l.origin=null;l.resolution=0;l.rows=null;l.scale=0;return l}N._inherits(p,B);var c=N._createSuper(p);p.prototype.clone=function(){return new P({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})};return N._createClass(p)}(I.JSONSupport);D.__decorate([F.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},
"portal-item":{read:!1,write:!1}}}})],I.prototype,"cols",void 0);D.__decorate([F.property({type:y.Integer,json:{write:!0}})],I.prototype,"level",void 0);D.__decorate([F.property({type:String,json:{write:!0}})],I.prototype,"levelValue",void 0);D.__decorate([F.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],I.prototype,"origin",void 0);D.__decorate([F.property({type:Number,json:{write:!0}})],I.prototype,"resolution",void 0);D.__decorate([F.property({json:{write:!0,
origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],I.prototype,"rows",void 0);D.__decorate([F.property({type:Number,json:{write:!0}})],I.prototype,"scale",void 0);return I=P=D.__decorate([L.subclass("esri.layers.support.LOD")],I)})},"esri/layers/support/TileKey":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(N,D){D=D._createClass(function(I,F,y,O,V){this.id=I;this.level=F;this.row=y;this.col=O;this.extent=V});N.TileKey=D;Object.defineProperty(N,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/FunctionRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRaster ../rasterFunctions/pixelUtils".split(" "),function(N,D,I,F,y,O,V,L,P,B,p){O=function(c){function l(){var h=
u.apply(this,arguments);h.datasetFormat="Function";h.tileType="Raster";h.rasterFunction=null;return h}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c.open=async function(h){await this.init();const {rasterFunction:r}=this;this.primaryRasters?.rasters?.length?r.sourceRasters=this.primaryRasters.rasters:this.primaryRasters=r.getPrimaryRasters();const {rasters:d,rasterIds:t}=this.primaryRasters;var G=d.map(n=>n.rasterInfo?void 0:n.open(h));await Promise.all(G);G=d.map(({rasterInfo:n})=>n);const E=
r.bind({rasterInfos:G,rasterIds:t});if(!E.success||0===G.length)throw new I("raster-function:open",`cannot bind the function: ${E.error??""}`);await this.syncJobHandler();const a=G[0];this.hasUniqueSourceStorageInfo=1===G.length||G.slice(1).every(n=>this._hasSameStorageInfo(n,a));this.set("sourceJSON",d[0].sourceJSON);this.set("rasterInfo",r.rasterInfo)};c.syncJobHandler=async function(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)};c.fetchPixels=async function(h,r,d,t=
{}){const {rasters:G,rasterIds:E}=this.primaryRasters;var a=!1,{interpolation:n}=t,m=this.rasterFunction.flatWebGLFunctionChain?.hasSurfaceFunction;!t.requestRawData&&"bilinear"!==n&&m&&(a=1===G.length&&!t.skipRasterFunction,t={...t,interpolation:"bilinear",requestRawData:a});m=G.map(b=>b.fetchPixels(h,r,d,t));m=await Promise.all(m);var f=m.map(b=>b.pixelBlock),k=a||t.requestRawData?m.map(b=>b.srcTilePixelSize):null;if(t.skipRasterFunction||f.every(b=>F.isNone(b)))return m[0];const g=m.find(b=>F.isSome(b.pixelBlock))?.extent??
h;f=this.rasterJobHandler?await this.rasterJobHandler.process({extent:g,primaryPixelBlocks:f,primaryPixelSizes:k,primaryRasterIds:E}):this.rasterFunction.process({extent:g,primaryPixelBlocks:f,primaryPixelSizes:k,primaryRasterIds:E});({transformGrid:k}=m[0]);if(!a||F.isNone(f)||F.isNone(k))return{...m[0],pixelBlock:f};a={rows:k.spacing[0],cols:k.spacing[1]};n=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[f],srcMosaicSize:{width:f.width,height:f.height},destDimension:{width:r,
height:d},coefs:k.coefficients,sampleSpacing:a,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:n,alignmentInfo:void 0,blockWidths:null},t)).pixelBlock:p.approximateTransform(f,{width:r,height:d},k.coefficients,a,n);return{extent:h,srcExtent:m[0].srcExtent,pixelBlock:n}};c._hasSameStorageInfo=function(h,r){const {storageInfo:d,pixelSize:t,spatialReference:G,extent:E}=h,{storageInfo:a,pixelSize:n,spatialReference:m,extent:f}=r;return t.x===n.x&&t.y===n.y&&G.equals(m)&&E.equals(f)&&d.blockHeight===
a.blockHeight&&d.blockWidth===a.blockWidth&&d.maximumPyramidLevel===a.maximumPyramidLevel};return N._createClass(l)}(B);D.__decorate([y.property({type:String,json:{write:!0}})],O.prototype,"datasetFormat",void 0);D.__decorate([y.property()],O.prototype,"tileType",void 0);D.__decorate([y.property()],O.prototype,"rasterFunction",void 0);D.__decorate([y.property()],O.prototype,"primaryRasters",void 0);return O=D.__decorate([P.subclass("esri.layers.support.rasterDatasets.FunctionRaster")],O)})},"esri/layers/support/rasterDatasets/BaseRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../request ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/Promise ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../arcgisLayerUrl ../commonProperties ../DimensionalDefinition ../LOD ../RasterStorageInfo ../TileInfo ./multidimensionalUtils ./RawBlockCache ../rasterFormats/pixelRangeUtils ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper ../rasterFunctions/vectorFieldUtils ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a,n,m,f,k,g,b,e,v,w){I=function(C){function M(){var x=K.apply(this,arguments);x.rasterJobHandler=null;x.datasetName=null;x.datasetFormat=null;x.hasUniqueSourceStorageInfo=!0;x.rasterInfo=null;x.ioConfig={sampling:"closest"};return x}N._inherits(M,C);var K=N._createSuper(M);C=M.prototype;C.init=async function(){const x=b.load();this.addResolvingPromise(x);await this.when()};C.normalizeCtorArgs=function(x){x&&x.ioConfig&&(x={...x,ioConfig:{resolution:null,
bandIds:null,sampling:"closest",tileInfo:a.create(),...x.ioConfig}});return x};C.open=async function(x){throw new y("BaseRaster:open-not-implemented","open() is not implemented");};C.fetchTile=async function(x,q,A,H={}){const Q=H.tileInfo||this.rasterInfo.storageInfo.tileInfo;x=this.getTileExtentFromTileInfo(x,q,A,Q);return this.fetchPixels(x,Q.size[0],Q.size[1],H)};C.identify=async function(x,q={}){x=c.ensureClass(w,x).clone().normalize();const {multidimensionalDefinition:A,timeExtent:H}=q;var {rasterInfo:Q}=
this;const {hasMultidimensionalTranspose:S,multidimensionalInfo:z}=Q;var {transposedVariableName:J}=q,R=L.isSome(z)&&S&&(null!=H||n.isMultiSliceOrRangeDefinition(A));R&&!J&&(J=L.isSome(A)&&0<A.length?A[0].variableName??void 0:z.variables[0].name,q={...q,transposedVariableName:J});q=this._getRequestOptionsWithSliceId(q);const {spatialReference:W,extent:Z}=Q;var {datumTransformation:Y}=q;Y=b.projectPoint(x,W,Y);if(!Z.intersects(Y)||L.isSome(Q.transform)&&(Y=Q.transform.inverseTransform(Y),!Q.nativeExtent.intersects(Y)))return{location:Y,
value:null};let X=0;var T=L.isSome(J)&&L.isSome(z)&&Q.hasMultidimensionalTranspose;if("Function"===this.datasetFormat){R=this.primaryRasters.rasters[0];if(T)return R.identify(Y,q);({pixelSize:T}=Q);q=3*T.x/2;T=3*T.y/2;q=new v({xmin:Y.x-q,xmax:Y.x+q,ymin:Y.y-T,ymax:Y.y+T,spatialReference:W});T={interpolation:"nearest"};({pixelBlock:R}=await R.fetchPixels(q,3,3,T));({pixelBlock:q}=await this.fetchPixels(q,3,3,T));if(L.isNone(R))return{location:Y,value:null};R=!R.mask||R.mask[4]?R.pixels.map(pa=>pa[4]):
null;var U;L.isSome(q)&&(U=!q.mask||q.mask[4]?q.pixels.map(pa=>pa[4]):void 0);return{location:Y,value:R,processedValue:U,pyramidLevel:0}}if(!T)if(q.srcResolution)X=b.snapPyramid(q.srcResolution,Q,this.ioConfig.sampling).pyramidLevel;else if(X=await this.computeBestPyramidLevelForLocation(x,q),null==X)return{location:Y,value:null};U=this.identifyPixelLocation(Y,X,null,T);if(null===U)return{location:Y,value:null};const {row:aa,col:ba,rowOffset:fa,colOffset:ja,blockWidth:ia}=U;U=J??L.unwrap(q.sliceId);
U=m.getRasterId(this.url,U);Q=`${X}/${aa}/${ba}`;J=m.getBlock(U,null,Q);L.isNone(J)&&(J=this.fetchRawTile(X,aa,ba,q),m.putBlock(U,null,Q,J));U=await J;return L.isNone(U)||!U.pixels?.length?{location:Y,value:null}:this._processIdentifyResult(U,{srcLocation:Y,position:fa*ia+ja,pyramidLevel:X,useTransposedTile:!!T,requestSomeSlices:R,identifyOptions:q})};C.fetchPixels=async function(x,q,A,H={}){x=b.snapExtent(x);H=this._getRequestOptionsWithSliceId(H);var {_hasNoneOrGCSShiftTransform:Q}=this;if(H.requestRawData&&
Q)return this._fetchPixels(x,q,A,H);var S=b.getWorldWidth(x.spatialReference),z=b.getWorldWrapCount(x);if(L.isNone(S)||0===z||1===z&&this._isGlobalWrappableSource&&Q)return this._fetchPixels(x,q,A,H);if(3<=z)return{extent:x,pixelBlock:null};const J=[],{xmin:R,xmax:W}=x,Z=Math.round(S/(W-R)*q),Y=Z-Math.round((S/2-R)/(W-R)*q);let X=0;Q=[];for(let U=0;U<=z;U++){var T=new v({xmin:0===U?R:-S/2,xmax:U===z?W-S*U:S/2,ymin:x.ymin,ymax:x.ymax,spatialReference:x.spatialReference});const aa=0===U?Z-Y:U===z?q-
X:Z;X+=aa;Q.push(aa);T=H.disableWrapAround&&0<U?null:this._fetchPixels(T,aa,A,H);J.push(T)}S=(await Promise.all(J)).map(U=>U?.pixelBlock);z=null;q={width:q,height:A};z=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:S,srcMosaicSize:q,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:Q},H)).pixelBlock:g.mosaic(S,q,{blockWidths:Q});H=b.projectExtent(x,this.rasterInfo.spatialReference,H.datumTransformation);return{extent:x,
srcExtent:H,pixelBlock:z}};C.fetchRawPixels=async function(x,q,A,H={}){q={x:Math.floor(q.x),y:Math.floor(q.y)};const Q=await this._fetchRawTiles(x,q,A,H),{nativeExtent:S,nativePixelSize:z,storageInfo:J}=this.rasterInfo;var R=2**x,W=z.x*R;R*=z.y;W=new v({xmin:S.xmin+W*q.x,xmax:S.xmin+W*(q.x+A.width-1),ymin:S.ymax-R*(q.y+A.height-1),ymax:S.ymax-R*q.y,spatialReference:S.spatialReference});if(!Q)return{extent:W,srcExtent:W,pixelBlock:null};const {pixelBlocks:Z,mosaicSize:Y}=Q;if(1===Z.length&&L.isSome(Z[0])&&
Z[0].width===A.width&&Z[0].height===A.height)return{extent:W,srcExtent:W,pixelBlock:Q.pixelBlocks[0]};x={x:q.x%(0<x?J.pyramidBlockWidth:J.blockWidth),y:q.y%(0<x?J.pyramidBlockHeight:J.blockHeight)};A=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:Z,srcMosaicSize:Y,destDimension:A,clipOffset:x,clipSize:A,coefs:null,sampleSpacing:null,interpolation:H.interpolation,alignmentInfo:null,blockWidths:null},H)).pixelBlock:g.mosaic(Z,Y,{clipOffset:x,clipSize:A});return{extent:W,
srcExtent:W,pixelBlock:A}};C.fetchRawTile=function(x,q,A,H){throw new y("BaseRaster:read-not-implemented","fetchRawTile() is not implemented");};C.computeExtent=function(x){return b.projectExtent(this.rasterInfo.extent,x)};C.decodePixelBlock=function(x,q){return!this.rasterJobHandler||q.useCanvas?k.decode(x,q):this.rasterJobHandler.decode({data:x,options:q})};C.request=async function(x,q,A=0){const {customFetchParameters:H}=this.ioConfig,{range:Q,query:S,headers:z}=q;A=A??q.retryCount??this.ioConfig.retryCount;
const J=Q?{Range:`bytes=${Q.from}-${Q.to}`}:null;try{return await F(x,{...q,query:{...S,...H},headers:{...z,...J}})}catch(R){if(0<A)return A--,this.request(x,q,A);throw R;}};C.getSliceIndex=function(x){const {multidimensionalInfo:q}=this.rasterInfo;return L.isNone(q)||L.isNone(x)||0===x.length?null:n.getSliceIndex(x,q)};C.getTileExtentFromTileInfo=function(x,q,A,H){x=L.unwrapOrThrow(H.lodAt(x));return this.getTileExtent({x:x.resolution,y:x.resolution},q,A,H.origin,H.spatialReference,H.size)};C.updateTileInfo=
function(){const {storageInfo:x,spatialReference:q,extent:A,pixelSize:H}=this.rasterInfo;if(!x.tileInfo){const S=[];var Q=x.maximumPyramidLevel||0;let z=Math.max(H.x,H.y),J=1/.0254*96*z;for(let R=0;R<=Q;R++)S.push(new G({level:Q-R,resolution:z,scale:J})),z*=2,J*=2;Q=new w({x:A.xmin,y:A.ymax,spatialReference:q});x.tileInfo=new a({origin:Q,size:[x.blockWidth,x.blockHeight],spatialReference:q,lods:S});x.isVirtualTileInfo=!0}};C.createRemoteDatasetStorageInfo=function(x,q=512,A=512,H){const {width:Q,
height:S,nativeExtent:z,pixelSize:J,spatialReference:R}=x,W=new w({x:z.xmin,y:z.ymax,spatialReference:R});null==H&&(H=Math.max(0,Math.round(Math.log(Math.max(Q,S))/Math.LN2-8)));const Z=this.computeBlockBoundary(z,512,512,{x:z.xmin,y:z.ymax},[J],H);x.storageInfo=new E({blockWidth:q,blockHeight:A,pyramidBlockWidth:q,pyramidBlockHeight:A,origin:W,firstPyramidLevel:1,maximumPyramidLevel:H,blockBoundary:Z})};C.computeBestPyramidLevelForLocation=async function(x,q){return 0};C.computeBlockBoundary=function(x,
q,A,H,Q,S=0,z=2){if(1===Q.length&&0<S){Q=[...Q];let {x:W,y:Z}=Q[0];for(let Y=0;Y<S;Y++)W*=z,Z*=z,Q.push({x:W,y:Z})}S=[];const {x:J,y:R}=H;for(H=0;H<Q.length;H++){const {x:W,y:Z}=Q[H];S.push({minCol:Math.floor((x.xmin-J+.1*W)/q/W),maxCol:Math.floor((x.xmax-J-.1*W)/q/W),minRow:Math.floor((R-x.ymax+.1*Z)/A/Z),maxRow:Math.floor((R-x.ymin-.1*Z)/A/Z)})}return S};C.getPyramidPixelSize=function(x){const {nativePixelSize:q}=this.rasterInfo,{pyramidResolutions:A,pyramidScalingFactor:H}=this.rasterInfo.storageInfo;
if(0===x)return q;if(L.isSome(A)&&A.length)return A[x-1];x=H**x;return{x:q.x*x,y:q.y*x}};C.identifyPixelLocation=function(x,q,A,H){const {spatialReference:Q,nativeExtent:S,storageInfo:z}=this.rasterInfo,{maximumPyramidLevel:J,origin:R,transposeInfo:W}=z,Z=H&&L.isSome(W)?W.tileSize[0]:z.blockWidth;H=H&&L.isSome(W)?W.tileSize[1]:z.blockHeight;x=b.projectPoint(x,Q,A);if(!S.intersects(x)||0>q||q>J)return null;A=this.getPyramidPixelSize(q);const {x:Y,y:X}=A;A=(R.y-x.y)/X/H;const T=(x.x-R.x)/Y/Z;return{pyramidLevel:q,
row:Math.floor(A),col:Math.floor(T),rowOffset:Math.min(H-1,Math.floor((A-Math.floor(A))*H)),colOffset:Math.min(Z-1,Math.floor((T-Math.floor(T))*Z)),blockWidth:Z,srcLocation:x}};C.getTileExtent=function(x,q,A,H,Q,S){const [z,J]=S;A=H.x+A*z*x.x;q=H.y-q*J*x.y;return new v({xmin:A,xmax:A+z*x.x,ymin:q-J*x.y,ymax:q,spatialReference:Q})};C.getBlockWidthHeight=function(x){return{blockWidth:0<x?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:0<x?this.rasterInfo.storageInfo.pyramidBlockHeight:
this.rasterInfo.storageInfo.blockHeight}};C.isBlockOutside=function(x,q,A){x=this.rasterInfo.storageInfo.blockBoundary[x];return!x||x.maxRow<q||x.maxCol<A||x.minRow>q||x.minCol>A};C._fetchPixels=async function(x,q,A,H={}){var Q=b.getWorldWrapCount(x);if(2<=Q)return{extent:x,pixelBlock:null};var S=this._getSourceDataInfo(x,q,A,H);const {pyramidLevel:z,srcResolution:J,srcExtent:R,srcWidth:W,srcHeight:Z,ul:Y}=S;if(0===W||0===Z)return{extent:x,srcExtent:R,pixelBlock:null};var {rasterInfo:X}=this,T=L.unwrap(X.transform),
U="gcs-shift"===T?.type,aa=L.isSome(b.getWorldWidth(x.spatialReference));if(U||!aa)Q=b.getWorldWrapCount(S.srcExtent,U);S=await this._fetchRawTiles(z,Y,{width:W,height:Z,wrapCount:Q},H);if(!S)return{extent:x,srcExtent:R,pixelBlock:null};var ba=X.storageInfo;U=0<z?ba.pyramidBlockWidth:ba.blockWidth;var fa=0<z?ba.pyramidBlockHeight:ba.blockHeight;let {x:ja,y:ia}=X.pixelSize;if(0<z){const {pyramidResolutions:ua,pyramidScalingFactor:va}=ba;L.isSome(ua)&&ua[z-1]?{x:ja,y:ia}=ua[z-1]:(ba=va**z,ja*=ba,ia*=
ba)}X=new w({x:ja,y:ia,spatialReference:X.spatialReference});const pa=U===W&&fa===Z&&0===Y.x%U&&0===Y.y%fa;ba=new w({x:(x.xmax-x.xmin)/q,y:(x.ymax-x.ymin)/A,spatialReference:x.spatialReference});const ma=!x.spatialReference.equals(this.rasterInfo.spatialReference),{datumTransformation:sa}=H;if(!ma&&pa&&1===S.pixelBlocks.length&&U===q&&fa===A&&J.x===ba.x&&J.y===ba.y)return{extent:x,srcExtent:R,srcTilePixelSize:X,pixelBlock:S.pixelBlocks[0]};U=aa&&L.isSome(b.getWorldWidth(R.spatialReference))&&this._hasNoneOrGCSShiftTransform;
(aa=H.requestProjectedLocalDirections&&this.rasterInfo.dataType.startsWith("vector"))&&!this.rasterJobHandler&&await b.load();Q=this.rasterJobHandler?await this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:x,srcBufferExtent:S.extent,pixelSize:ba.toJSON(),datumTransformation:sa,rasterTransform:T,hasWrapAround:0<Q||U,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:aa},H):b.getProjectionOffsetGrid({projectedExtent:x,srcBufferExtent:S.extent,pixelSize:ba,datumTransformation:sa,
rasterTransform:T,hasWrapAround:0<Q||U,isAdaptive:!1,includeGCSGrid:aa});T=!H.requestRawData;U={rows:Q.spacing[0],cols:Q.spacing[1]};fa=this._hasNoneOrGCSShiftTransform?L.unwrap(this._getRasterTileAlignmentInfo(z,S.extent.xmin)):void 0;const {pixelBlocks:oa,mosaicSize:wa,isPartiallyFilled:ta}=S;S=null;this.rasterJobHandler?(q=await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:oa,srcMosaicSize:wa,destDimension:T?{width:q,height:A}:null,coefs:T?Q.coefficients:null,sampleSpacing:T?U:null,
projectDirections:aa,gcsGrid:aa?Q.gcsGrid:null,isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:H.interpolation,alignmentInfo:fa,blockWidths:null},H),{pixelBlock:T,localNorthDirections:S}=q):(fa=g.mosaic(oa,wa,{alignmentInfo:fa}),T=T?g.approximateTransform(fa,{width:q,height:A},Q.coefficients,U,H.interpolation):fa,aa&&Q.gcsGrid&&(S=g.getLocalArithmeticNorthRotations({width:q,height:A},Q.gcsGrid),T=e.convertToLocalDirections(T,this.rasterInfo.dataType,S)));return H.requestRawData||aa?{extent:x,
srcExtent:R,srcTilePixelSize:X,pixelBlock:T,transformGrid:Q,localNorthDirections:S,isPartiallyFilled:ta}:{extent:x,srcExtent:R,srcTilePixelSize:X,pixelBlock:T}};C._fetchRawTiles=async function(x,q,A,H){const {origin:Q,blockBoundary:S}=this.rasterInfo.storageInfo,{blockWidth:z,blockHeight:J}=this.getBlockWidthHeight(x);let {x:R,y:W}=q,{width:Z,height:Y,wrapCount:X}=A;var T=this._getRasterTileAlignmentInfo(x,0);H.buffer&&(R-=H.buffer.cols,W-=H.buffer.rows,Z+=2*H.buffer.cols,Y+=2*H.buffer.rows);var U=
0,aa=0;let ba=0;X&&L.isSome(T)&&({worldColumnCountFromOrigin:aa,originColumnOffset:ba,rightPadding:U}=T,aa*T.blockWidth-U>=R+Z&&(U=0));q=Math.floor(R/z);A=Math.floor(W/J);const fa=Math.floor((R+Z+U-1)/z);U=Math.floor((W+Y+U-1)/J);var ja=S[x];if(!ja)return null;const {minRow:ia,minCol:pa,maxCol:ma,maxRow:sa}=ja;if(0===X&&(U<ia||fa<pa||A>sa||q>ma))return null;ja=[];let oa=!1;const wa=null==this.ioConfig.allowPartialFill?H.allowPartialFill:this.ioConfig.allowPartialFill;for(let va=A;va<=U;va++)for(let qa=
q;qa<=fa;qa++){let ya=qa;!H.disableWrapAround&&X&&L.isSome(T)&&aa<=qa&&(ya=qa-aa-ba);if(va>=ia&&ya>=pa&&sa>=va&&ma>=ya){const ca=this._fetchRawTile(x,va,ya,H);wa?ja.push(new Promise(ha=>{ca.then(da=>ha(da)).catch(()=>{oa=!0;ha(null)})})):ja.push(ca)}else ja.push(Promise.resolve(null))}if(0===ja.length)return null;H=await Promise.all(ja);T={height:(U-A+1)*J,width:(fa-q+1)*z};({spatialReference:aa}=this.rasterInfo);x=this.getPyramidPixelSize(x);const {x:ta,y:ua}=x;return{extent:new v({xmin:Q.x+q*z*
ta,xmax:Q.x+(fa+1)*z*ta,ymin:Q.y-(U+1)*J*ua,ymax:Q.y-A*J*ua,spatialReference:aa}),pixelBlocks:H,mosaicSize:T,isPartiallyFilled:oa}};C._fetchRawTile=function(x,q,A,H){var Q=this.rasterInfo.storageInfo.blockBoundary[x];if(!Q)return Promise.resolve(null);const {minRow:S,minCol:z,maxCol:J,maxRow:R}=Q;if(q<S||A<z||q>R||A>J)return Promise.resolve(null);const W=m.getRasterId(this.url,H.sliceId),Z=`${x}/${q}/${A}`;Q=m.getBlock(W,H.registryId,Z);if(L.isNone(Q)){const Y=new AbortController;Q=this.fetchRawTile(x,
q,A,{...H,signal:Y.signal});m.putBlock(W,H.registryId,Z,Q,Y);Q.catch(()=>m.deleteBlock(W,H.registryId,Z))}if(H.signal)B.onAbort(H,()=>{m.decreaseRefCount(W,H.registryId,Z)});return Q};C._computeMagDirValues=function(x){const {bandCount:q,dataType:A}=this.rasterInfo;if((2!==q||"vector-magdir"!==A)&&"vector-uv"!==A||2!==x?.length||!x[0]?.length)return null;var H=x[0].length;if("vector-magdir"===A)return H=x[1].map(J=>(J+360)%360),[x[0],H];const [Q,S]=x;x=[];const z=[];for(let J=0;J<H;J++){const [R,
W]=e.uvComponentToVector([Q[J],S[J]]);x.push(R);z.push(W)}return[x,z]};C._getRasterTileAlignmentInfo=function(x,q){null==this._rasterTileAlighmentInfo&&(this._rasterTileAlighmentInfo=b.getRasterDatasetAlignmentInfo(this.rasterInfo));return L.isNone(this._rasterTileAlighmentInfo.pyramidsInfo)?null:{startX:q,halfWorldWidth:this._rasterTileAlighmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlighmentInfo.hasGCSSShiftTransform,...this._rasterTileAlighmentInfo.pyramidsInfo[x]}};C._getSourceDataInfo=
function(x,q,A,H={}){const Q={datumTransformation:H.datumTransformation,pyramidLevel:0,pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};H.srcResolution&&(Q.srcResolution=H.srcResolution,this._updateSourceDataInfo(x,Q));var S=this.rasterInfo.storageInfo.maximumPyramidLevel||0;const {srcWidth:z,srcHeight:J,pyramidLevel:R}=Q;var W=z/q;const Z=J/A,Y=R<S&&16<=W*Z;var X=R===S&&this._requireTooManySrcTiles(z,J,q,A);if(Y||X||0===z||0===J){X=new w({x:(x.xmax-x.xmin)/
q,y:(x.ymax-x.ymin)/A,spatialReference:x.spatialReference});X=b.projectResolution(X,this.rasterInfo.spatialReference,x,Q.datumTransformation);const T=!X||H.srcResolution&&X.x+X.y<H.srcResolution.x+H.srcResolution.y;Y&&H.srcResolution&&T&&(W=Math.round(Math.log(Math.max(W,Z))/Math.LN2)-1,S-R+3>=W&&(S=2**W,X={x:H.srcResolution.x*S,y:H.srcResolution.y*S}));X&&(Q.srcResolution=X,this._updateSourceDataInfo(x,Q))}this._requireTooManySrcTiles(Q.srcWidth,Q.srcHeight,q,A)&&(Q.srcWidth=0,Q.srcHeight=0);return Q};
C._requireTooManySrcTiles=function(x,q,A,H){const {tileInfo:Q}=this.rasterInfo.storageInfo;return 256<=Math.ceil(x/Q.size[0])*Math.ceil(q/Q.size[1])||8<x/A||8<q/H};C._updateSourceDataInfo=function(x,q){q.srcWidth=0;q.srcHeight=0;var {rasterInfo:A}=this,H=A.spatialReference;const {srcResolution:Q,datumTransformation:S}=q,{pyramidLevel:z,pyramidResolution:J,excessiveReading:R}=b.snapPyramid(Q,A,this.ioConfig.sampling);if(!R&&(x=q.srcExtent||b.projectExtent(x,H,S),null!=x)){(H=L.unwrap(A.transform))&&
(x=H.inverseTransform(x));q.srcExtent=x;var {x:W,y:Z}=A.storageInfo.origin;A=Math.floor((x.xmin-W)/J.x+.1);H=Math.floor((Z-x.ymax)/J.y+.1);var Y=Math.floor((x.xmax-W)/J.x-.1),X=Math.floor((Z-x.ymin)/J.y-.1);Y=x.width<.1*J.x?0:Y-A+1;x=x.height<.1*J.y?0:X-H+1;q.pyramidLevel=z;q.pyramidResolution=J;q.srcWidth=Y;q.srcHeight=x;q.ul={x:A,y:H}}};C._getRequestOptionsWithSliceId=function(x){L.isSome(this.rasterInfo.multidimensionalInfo)&&null==x.sliceId&&(x={...x,sliceId:this.getSliceIndex(x.multidimensionalDefinition)});
return x};C._processIdentifyResult=function(x,q){const {srcLocation:A,position:H,pyramidLevel:Q,useTransposedTile:S}=q,z=x.pixels[0].length/x.width/x.height;if(x.mask&&!x.mask[H])return{location:A,value:null};const {multidimensionalInfo:J}=this.rasterInfo;if(L.isNone(J)||!S)return q=x.pixels.map(U=>U[H]),x={location:A,value:q,pyramidLevel:Q},q=this._computeMagDirValues(q.map(U=>[U])),q?.length&&(x.magdirValue=q.map(U=>U[0])),x;let R=x.pixels.map(U=>U.slice(H*z,H*z+z)),W=this._computeMagDirValues(R);
const {requestSomeSlices:Z,identifyOptions:Y}=q;let X=n.createSlices(J,Y.transposedVariableName);if(Z){const U=n.getSliceIds(X,L.unwrap(Y.multidimensionalDefinition),L.unwrap(Y.timeExtent));R=R.map(aa=>U.map(ba=>aa[ba]));W=W?.map(aa=>U.map(ba=>aa[ba]));X=U.map(aa=>X[aa])}q=x.noDataValues||this.rasterInfo.noDataValue;x={pixels:R,pixelType:x.pixelType};let T;L.isSome(q)&&(f.convertNoDataToMask(x,q),T=x.mask);x=X.map((U,aa)=>{U={value:0===T?.[aa]?null:R.map(ba=>ba[aa]),multidimensionalDefinition:U.multidimensionalDefinition.map(ba=>
new t({...ba,isSlice:!0}))};W?.length&&(U.magdirValue=[W[0][aa],W[1][aa]]);return U});return{location:A,value:null,dataSeries:x,pyramidLevel:Q}};N._createClass(M,[{key:"_isGlobalWrappableSource",get:function(){const {rasterInfo:x}=this,q=b.getWorldWidth(x.spatialReference);return L.isSome(q)&&x.extent.width>=q/2}},{key:"_hasNoneOrGCSShiftTransform",get:function(){const {transform:x}=this.rasterInfo;return L.isNone(x)||"gcs-shift"===x.type}},{key:"url",set:function(x){this._set("url",r.sanitizeUrl(x,
V.getLogger(this.declaredClass)))}}]);return M}(P.EsriPromiseMixin(O.JSONSupport));D.__decorate([p.property()],I.prototype,"_rasterTileAlighmentInfo",void 0);D.__decorate([p.property({readOnly:!0})],I.prototype,"_isGlobalWrappableSource",null);D.__decorate([p.property({readOnly:!0})],I.prototype,"_hasNoneOrGCSShiftTransform",null);D.__decorate([p.property(d.url)],I.prototype,"url",null);D.__decorate([p.property({type:String,json:{write:!0}})],I.prototype,"datasetName",void 0);D.__decorate([p.property({type:String,
json:{write:!0}})],I.prototype,"datasetFormat",void 0);D.__decorate([p.property()],I.prototype,"hasUniqueSourceStorageInfo",void 0);D.__decorate([p.property()],I.prototype,"rasterInfo",void 0);D.__decorate([p.property()],I.prototype,"ioConfig",void 0);D.__decorate([p.property()],I.prototype,"sourceJSON",void 0);return I=D.__decorate([h.subclass("esri.layers.support.rasterDatasets.BaseRaster")],I)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),
function(N,D,I,F,y,O,V,L){var P;I=P=function(B){function p(){var l=c.apply(this,arguments);l.blockWidth=void 0;l.blockHeight=void 0;l.compression=null;l.origin=null;l.firstPyramidLevel=null;l.maximumPyramidLevel=null;l.pyramidScalingFactor=2;l.pyramidBlockWidth=null;l.pyramidBlockHeight=null;l.isVirtualTileInfo=!1;l.tileInfo=null;l.transposeInfo=null;l.blockBoundary=null;return l}N._inherits(p,B);var c=N._createSuper(p);p.prototype.clone=function(){return new P({blockWidth:this.blockWidth,blockHeight:this.blockHeight,
compression:this.compression,origin:F.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:F.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:F.clone(this.tileInfo),transposeInfo:F.clone(this.transposeInfo),blockBoundary:F.clone(this.blockBoundary)})};return N._createClass(p)}(I.JSONSupport);
D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"blockWidth",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"blockHeight",void 0);D.__decorate([y.property({type:String,json:{write:!0}})],I.prototype,"compression",void 0);D.__decorate([y.property({type:L,json:{write:!0}})],I.prototype,"origin",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"firstPyramidLevel",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],
I.prototype,"maximumPyramidLevel",void 0);D.__decorate([y.property({json:{write:!0}})],I.prototype,"pyramidResolutions",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"pyramidScalingFactor",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"pyramidBlockWidth",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],I.prototype,"pyramidBlockHeight",void 0);D.__decorate([y.property({type:Boolean,json:{write:!0}})],I.prototype,"isVirtualTileInfo",
void 0);D.__decorate([y.property({json:{write:!0}})],I.prototype,"tileInfo",void 0);D.__decorate([y.property()],I.prototype,"transposeInfo",void 0);D.__decorate([y.property()],I.prototype,"blockBoundary",void 0);return I=P=D.__decorate([V.subclass("esri.layers.support.RasterStorageInfo")],I)})},"esri/layers/support/rasterDatasets/multidimensionalUtils":function(){define(["exports","../../../core/maybe","../DimensionalDefinition"],function(N,D,I){function F(u,h,r){const d=h.shift();0===r.length&&r.push({sliceId:-1,
multidimensionalDefinition:[]});const t=r.length;for(let G=0;G<t;G++){const E=r.shift().multidimensionalDefinition;d.values?.forEach(a=>{r.push({sliceId:-1,multidimensionalDefinition:[...E,{variableName:u,dimensionName:d.name,values:[a]}]})})}h.length&&F(u,h,r)}function y(u,h){return Array.isArray(u)?h[0]===h[1]?u[0]===h[0]||u[1]===h[0]:u[0]>=h[0]&&u[0]<=h[1]&&u[1]>=h[0]&&u[1]<=h[1]:u>=h[0]&&u<=h[1]}function O(u,h){return u[0]<=h[0]&&u[1]>=h[0]||u[0]<=h[1]&&u[1]>=h[1]||u[0]>=h[0]&&u[1]<=h[1]}function V(u){return 1===
u.length?[u[0],u[0]]:[u[0],u[u.length-1]]}function L(u,h,r){if(!h?.subsetDefinitions?.length)return u;if(r){const {variables:t}=h;if(t.length&&!t.includes(r))return null;h=h.subsetDefinitions.find(G=>G.dimensionName===u.name&&G.variableName===r);if(!h?.values?.length)return u;h=V(h.values)}else h=h.dimensions.find(({name:t})=>t===u.name)?.extent;const d=h;if(!d||!d?.length)return u;h=u.values.filter(t=>y(t,d));return{...u,extent:[...d],values:h}}function P(u,h,r){if(!h?.subsetDefinitions?.length)return!1;
const {variables:d}=h;if(d.length&&u.some(({variableName:t})=>t&&!d.includes(t)))return!0;for(let t=0;t<u.length;t++){const G=u[t],E=h.subsetDefinitions.find(a=>(""===G.variableName||a.variableName===G.variableName)&&a.dimensionName===G.dimensionName);if(E?.values.length){const a=V(E.values);if(!G.isSlice&&2===G.values.length&&!Array.isArray(G.values[0])&&G.values[0]!==G.values[1]&&r){if(!O(G.values,a))return!0}else if(G.values.some(n=>!y(n,a)))return!0}}return!1}function B(u,h){var r=u.dimensions.find(({name:E})=>
"StdTime"===E);if(null==r||D.isNone(h.start)&&D.isNone(h.end))return h;h=h.clone();const {start:d,end:t}=h.toJSON(),G=d===t?[d]:null!=d&&null!=t?[d,t]:[d??t];if(2===G.length&&r?.extent.length&&(G[0]=Math.max(G[0],r.extent[0]),G[1]=Math.min(G[1],r.extent[1]??r.extent[0]),G[1]<G[0]))return null;r=new I({variableName:"",dimensionName:"StdTime",isSlice:1===G.length,values:G});if(P([r],u,!0))return null;h.start=new Date(G[0]);h.end=new Date(G[1]??G[0]);return h}function p(u,h={}){const {multidimensionalInfo:r,
keyProperties:d}=u;if(D.isNone(r))return null;const {variableName:t,multidimensionalSubset:G,multidimensionalDefinition:E}=h;u=D.isSome(E)?E[0]?.variableName:null;const a=t||u||d?.DefaultVariable;({variables:u}=r);G?.variables?.length&&(u=u.filter(({name:n})=>G.variables.includes(n)));return a?u.find(({name:n})=>n===a)??u[0]:u[0]}function c(u,h){var {values:r}=h;if(r?.length)return Array.isArray(r[0])!==Array.isArray(u)?-1:Array.isArray(r[0])?r.findIndex(G=>G[0]===u[0]&&G[1]===u[1]):r.indexOf(u);
var {extent:d}=h;if(Array.isArray(u)||u<d[0]||u>d[1])return-1;r=h.interval||1;if("ISO8601"!==h.unit)return Math.round((u-d[0])/r);d=d[0];let t=-1;switch(h.intervalUnit?.toLowerCase()||"seconds"){case "seconds":t=Math.round((u-d)/1E3/r);break;case "minutes":t=Math.round((u-d)/6E4/r);break;case "hours":t=Math.round((u-d)/36E5/r);break;case "days":t=Math.round((u-d)/864E5/r);break;case "months":h=(new Date(u)).getUTCFullYear()-(new Date(d)).getUTCFullYear();r=(new Date(d)).getUTCMonth();d=(new Date(u)).getUTCMonth();
t=0===h?d-r:d+11-r+12*(h-1);break;case "years":t=Math.round(((new Date(u)).getUTCFullYear()-(new Date(d)).getUTCFullYear())/r);break;case "decades":t=Math.round(((new Date(u)).getUTCFullYear()-(new Date(d)).getUTCFullYear())/10/r)}return t}function l(u){var h=u.values?.length;if(h)return h;const {extent:r,unit:d}=u;h=u.interval||1;var t=r?r[1]-r[0]:0;if("ISO8601"!==d)return Math.round(t/h);switch(u.intervalUnit?.toLowerCase()??"seconds"){case "seconds":h=Math.round(t/1E3/h);break;case "minutes":h=
Math.round(t/6E4/h);break;case "hours":h=Math.round(t/36E5/h);break;case "days":h=Math.round(t/864E5/h);break;case "months":u=(new Date(r[1])).getUTCFullYear()-(new Date(r[0])).getUTCFullYear();h=(new Date(r[1][0])).getUTCMonth();t=(new Date(r[1][1])).getUTCMonth();h=0===u?t-h+1:t+11-h+12*(u-1)+1;break;case "years":h=Math.round(((new Date(r[1])).getUTCFullYear()-(new Date(r[0])).getUTCFullYear())/h);break;case "decades":h=Math.round(((new Date(r[1])).getUTCFullYear()-(new Date(r[0])).getUTCFullYear())/
10/h);break;default:h=0}return h}N.createSlices=function(u,h){const r=[];let d=0;(h?u.variables.filter(t=>t.name.toLowerCase()===h.toLowerCase()):[...u.variables].sort((t,G)=>t.name>G.name?1:-1)).forEach(t=>{const G=[],E=[...t.dimensions].sort((a,n)=>a.name>n.name?-1:1);F(t.name,E,G);G.forEach(a=>{r.push({...a,sliceId:d++})})});return r};N.getDefaultMultidimensionalDefinition=function(u,h={}){var r=p(u,h);if(!r)return null;u=[];const {dimensions:d,name:t}=r;if(0===d.length)return[new I({variableName:t,
dimensionName:"",values:[],isSlice:!0})];for(r=0;r<d.length;r++){const G=L(d[r],h.multidimensionalSubset,t);if(!G)return null;const {values:E,extent:a}=G;let n=E?.[0]??a[0];"stdz"===G.name.toLowerCase()&&!G.hasRanges&&Math.abs(a[1])<=Math.abs(a[0])&&(n=E?.length?E[E.length-1]:a[1]);u.push(new I({variableName:t,dimensionName:G.name,values:[n],isSlice:h.useRangeForRangedDimensionInfo?!!G.hasRanges:!0}))}return u};N.getDefaultVariablInfo=p;N.getSliceIds=function(u,h,r){let d=u;h&&(h=[...h].sort((t,G)=>
t.dimensionName<G.dimensionName?-1:1),h.forEach(({dimensionName:t,values:G,isSlice:E})=>{G.length&&(d=d.filter(a=>{a=a.multidimensionalDefinition.find(m=>m.dimensionName===t);if(null==a)return!1;const n=a.values[0];return"number"===typeof n?"number"===typeof G[0]?G.includes(n):G.some(m=>m[0]<=n&&m[1]>=n):"number"===typeof G[0]?G.some(m=>n[0]<=m&&n[1]>=m):E?G.some(m=>m[0]===n[0]&&m[0]===n[1]):G.some(m=>m[0]>=n[0]&&m[0]<=n[1]||m[1]>=n[0]&&m[1]<=n[1]||m[0]<n[0]&&m[1]>n[1])}))}));if(d.length&&r&&D.isSome(r.start)&&
D.isSome(r.end)){const t=r.start.getTime(),G=r.end.getTime(),E=d[0].multidimensionalDefinition.findIndex(a=>"StdTime"===a.dimensionName);-1<E&&(d=d.filter(a=>{a=a.multidimensionalDefinition[E].values[0];return t<=a&&G>=a}))}return d.map(t=>t.sliceId)};N.getSliceIndex=function(u,h){let r=0;var d=u[0].variableName;h=[...h.variables].sort((G,E)=>G.name>E.name?1:-1);for(var t=0;t<h.length;t++){const G=h[t],E=[...G.dimensions].sort((a,n)=>a.name>n.name?-1:1);if(G.name!==d)r+=E.map(a=>l(a)).reduce((a,n)=>
a*n);else{d=E.map(a=>l(a));h=E.length;for(let a=0;a<h;a++){t=u.find(n=>n.dimensionName===E[a].name);if(null==t)return null;t=c(t.values[0],E[a]);if(-1===t)return null;d.shift();r=a===h-1?r+t:r+t*d.reduce((n,m)=>n*m)}break}}return r};N.getSubsetVariablesFromMdInfo=function(u,h){if(D.isNone(h)||D.isNone(u))return null;h=h.variables.map(r=>({...r}));u?.variables?.length&&(h=h.filter(({name:r})=>u.variables.includes(r)),h.forEach(r=>{r.dimensions=r.dimensions.map(d=>L(d,u,r.name)).filter(D.isSome)}));
return h};N.hasExcludedVariableOrDimension=P;N.intersectMultimensionalSubset=function(u,h){if(D.isNone(u))return{isOutside:!1};const {geometry:r,timeExtent:d,multidimensionalDefinition:t}=h;h=null;if(D.isSome(d)&&(h=B(u,d),D.isNone(h)))return{isOutside:!0};const {areaOfInterest:G}=u;if(G&&r){const E="point"===r.type?r:"extent"===r.type?r.center:"polygon"===r.type?r.centroid:null;if(E&&!G.contains(E))return{isOutside:!0}}return D.isSome(t)&&t.length&&P(t,u,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:r,
timeExtent:h,multidimensionalDefinition:t}}};N.isMultiSliceOrRangeDefinition=function(u){return D.isNone(u)||!u.length?!1:u.some(h=>{if(null==h.values)return!0;const r=h.values.length;return 0===r||1<r||!h.isSlice&&Array.isArray(h.values[0])})};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define("exports ../../../geometry ../../../core/maybe ./EphemeralBlockCache ../rasterFunctions/rasterProjectionHelper ../../../geometry/Point".split(" "),
function(N,D,I,F,y,O){function V(B,p){return(B=L.get(B))?B[p]??null:null}const L=new Map,P=new F;N.decreaseRefCount=function(B,p,c){const l=L.get(B);if(!l)return null==p?P.decreaseRefCount(B,c):0;if(null==p||null==l[p])return P.decreaseRefCount(B,c);p=l[p]?.cache;B=p?.get(c);if(p&&B){B.refCount--;if(0===B.refCount){p.delete(c);for(p=0;p<l.length;p++)l[p]?.cache.delete(c);B.controller&&B.controller.abort()}return B.refCount}return 0};N.deleteBlock=function(B,p,c){const l=L.get(B);l?null==p||null==
l[p]?P.deleteBlock(B,c):l[p]?.cache.delete(c):null==p&&P.deleteBlock(B,c)};N.deleteRaster=function(B){L.delete(B)};N.getBlock=function(B,p,c){const l=L.get(B);if(!l)return null==p?P.getBlock(B,c):null;if(null==p||null==l[p]){for(p=0;p<l.length;p++){var u=l[p]?.cache.get(c);if(u)return u.refCount++,u.block}return P.getBlock(B,c)}if(B=l[p]?.cache.get(c))return B.refCount++,B.block;for(B=0;B<l.length;B++){if(B===p||!l[B])continue;u=l[B]?.cache;const h=u?.get(c);if(u&&h)return h.refCount++,u.set(c,h),
h.block}return null};N.getRasterId=function(B,p){return null==p?B:`${B}?sliceId=${p}`};N.putBlock=function(B,p,c,l,u=null){const h=L.get(B);if(h)if(null==p||null==h[p])P.putBlock(B,c,l,u);else{var r={refCount:1,block:l,isResolved:!1,isRejected:!1,controller:u};l.then(()=>r.isResolved=!0).catch(()=>r.isRejected=!0);h[p]?.cache.set(c,r)}else null==p&&P.putBlock(B,c,l,u)};N.register=function(B,p){p={extent:null,rasterInfo:p,cache:new Map};const c=L.get(B);if(c)return c.push(p),c.length-1;L.set(B,[p]);
return 0};N.unregister=function(B,p){const c=L.get(B);c&&(c[p]=null,c.some(l=>null!=l)||L.delete(B))};N.update=function(B,p,c,l,u,h,r=null){if(B=V(B,p)){p=B.extent;var {cache:d,rasterInfo:t}=B;if(!p||p.xmin!==c.xmin||p.xmax!==c.xmax||p.ymin!==c.ymin||p.ymax!==c.ymax){l=l??0;p=c.clone().normalize();var {spatialReference:G,transform:E}=t,a=new Set;for(let b=0;b<p.length;b++){var n=p[b];if(n.xmax-n.xmin<=l||n.ymax-n.ymin<=l)continue;var m=y.projectExtent(n,G,r);I.isSome(E)&&(m=E.inverseTransform(m));
var f=new O({x:l,y:l,spatialReference:n.spatialReference});if(null==u&&(u=y.projectResolution(f,G,n,r),!u))return;const {pyramidLevel:e,pyramidResolution:v,excessiveReading:w}=y.snapPyramid(u,t,h||"closest");if(w)return;({storageInfo:n}=t);var {origin:k}=n;f=Math.max(0,Math.floor((m.xmin-k.x)/v.x));k=Math.max(0,Math.floor((k.y-m.ymax)/v.y));const C=0<e?n.pyramidBlockWidth:n.blockWidth,M=0<e?n.pyramidBlockHeight:n.blockHeight;n=Math.max(0,Math.floor(f/C)-1);var g=Math.max(0,Math.floor(k/M)-1);f=Math.floor((f+
Math.ceil((m.xmax-m.xmin)/v.x-.1)-1)/C)+1;m=Math.floor((k+Math.ceil((m.ymax-m.ymin)/v.y-.1)-1)/M)+1;for(k=g;k<=m;k++)for(g=n;g<=f;g++)a.add(`${e}/${k}/${g}`)}d.forEach((b,e)=>{a.has(e)||(b=d.get(e),(null==b||b.isResolved||b.isRejected)&&d.delete(e))});B.extent={xmin:c.xmin,ymin:c.ymin,xmax:c.xmax,ymax:c.ymax}}}};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(N){return function(){function D(F=
15E3,y=5E3){this._timer=null;this._cachedBlocks=new Map;this._size=-1;this._duration=F;this._interval=Math.min(F,y)}var I=D.prototype;I.decreaseRefCount=function(F,y){F=F+"/"+y;y=this._cachedBlocks;if(y.has(F)){const O=y.get(F);O.refCount--;0>=O.refCount&&(y.delete(F),O.controller&&O.controller.abort());return O.refCount}return 0};I.getBlock=function(F,y){F=F+"/"+y;y=this._cachedBlocks;if(y.has(F)){const O=y.get(F);O.ts=Date.now();O.refCount++;y.delete(F);y.set(F,O);return O.block}return null};I.putBlock=
function(F,y,O,V){const L=this._cachedBlocks;F=F+"/"+y;L.has(F)?(O=L.get(F),O.ts=Date.now(),O.refCount++):L.set(F,{block:O,ts:Date.now(),refCount:1,controller:V});this._trim();this._updateTimer()};I.deleteBlock=function(F,y){const O=this._cachedBlocks;F=F+"/"+y;O.has(F)&&O.delete(F)};I.updateMaxSize=function(F){this._size=F;this._trim()};I.empty=function(){this._cachedBlocks.clear();this._clearTimer()};I.getCurrentSize=function(){return this._cachedBlocks.size};I._updateTimer=function(){if(null==
this._timer){var F=this._cachedBlocks;this._timer=setInterval(()=>{const y=Array.from(F),O=Date.now();for(let V=0;V<y.length;V++)if(y[V][1].ts<=O-this._duration)F.delete(y[V][0]);else break;0===F.size&&this._clearTimer()},this._interval)}};I._trim=function(){const F=this._cachedBlocks;if(!(-1===this._size||this._size>=F.size)){var y=Array.from(F);for(let O=0;O<y.length-this._size;O++)F.delete(y[O][0])}};I._clearTimer=function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)};return N._createClass(D)}()})},
"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),function(N,D,I,F,y,O,V,L,P,B,p){function c(z,J,R){return!V.canProjectWithoutEngine(z,J,R)}function l(z,J,R){if((z=c(z,J,R))&&!V.isLoaded())throw new I("rasterprojectionhelper-project",
"projection engine is not loaded");return z}function u(z,J,R,W=null){const Z=z.spatialReference;if(Z.equals(J))return z;l(Z,J,W);R=R.center;R=new L({xmin:R.x-z.x/2,xmax:R.x+z.x/2,ymin:R.y-z.y/2,ymax:R.y+z.y/2,spatialReference:Z});W=V.project(R,J,W);R=v(J);F.isNone(W)||F.isSome(R)&&W.width>=R?(J=y.getMetersPerUnitForSR(Z)/y.getMetersPerUnitForSR(J),z={x:z.x*J,y:z.y*J}):z={x:W.width,y:W.height};return z}function h(z,J=.01){return y.getMetersPerUnitForSR(z)?J/y.getMetersPerUnitForSR(z):0}function r(z,
J,R=null,W=!0){const Z=z.spatialReference;if(Z.equals(J))return z;l(Z,J,R);R=V.project(z,J,R);if(!W||!R)return R;d([z],[R],Z,J);return R}function d(z,J,R,W){const Z=w(R,!0),Y=w(W,!0);R=h(R,500);W=h(W,500);if(R&&F.isSome(Z)&&F.isSome(Y))for(let X=0;X<z.length;X++){const T=J[X];if(!T)continue;const {x:U}=z[X],{x:aa}=T;aa>=Y[1]-W&&Math.abs(U-Z[0])<R?T.x-=Y[1]-Y[0]:aa<=Y[0]+W&&Math.abs(U-Z[1])<R&&(T.x+=Y[1]-Y[0])}}function t(z){const {inSR:J,outSR:R,datumTransformation:W,preferPE:Z}=z;if(J.equals(R))return{points:z}=
m(z,null),z;if(J.isWebMercator&&R.isWGS84||J.isWGS84&&R.isWebMercator){const {cols:aa,rows:ba,xres:fa,yres:ja,usePixelCenter:ia,inSR:pa,outSR:ma}=z;let {xmin:sa,ymax:oa}=z;ia&&(sa+=fa/2,oa-=ja/2);z=[];var Y=[],X=Math.max(aa,ba);for(var T=0;T<X;T++){var U=V.project(new P({x:sa+fa*Math.min(aa,T),y:oa-ja*Math.min(ba,T),spatialReference:pa}),ma);T<=aa&&z.push(U.x);T<=ba&&Y.push(U.y)}X=[];for(T=0;T<aa;T++)for(U=0;U<ba;U++)X.push([z[T],Y[U]]);return X}if(l(J,R,W)&&Z){if(J.isGeographic)return E(z);Y=a(J);
if(F.isSome(Y))return E(z)}return G(z)}function G(z){var {points:J}=m(z,null);const {inSR:R,outSR:W,datumTransformation:Z}=z;z=J.map(Y=>new P(Y[0],Y[1],R));J=V.project(z,W,Z);Z&&d(z,J,R,W);return J.map(Y=>Y?[Y.x,Y.y]:[NaN,NaN])}function E(z){const {inSR:J,outSR:R,datumTransformation:W}=z;var Z=a(J);const {points:Y,mask:X}=m(z,Z);J.isGeographic||(z=J.wkid?O.PeFactory.coordsys(J.wkid):O.PeFactory.fromString(J.isGeographic?O.PeDefs.PE_TYPE_GEOGCS:O.PeDefs.PE_TYPE_PROJCS,J.wkt),O.PeCSTransformations.projToGeog(z,
Y.length,Y));if(F.isSome(W)&&W.steps.length){var T;R.isGeographic&&(T=Y.map(([U])=>179.9955<U?1:-179.9955>U?-1:0));W.steps.forEach(U=>{const aa=U.wkid?O.PeFactory.geogtran(U.wkid):O.PeFactory.fromString(O.PeDefs.PE_TYPE_GEOGTRAN,U.wkt);O.PeGTTransformations.geogToGeog(aa,Y.length,Y,null,U.isInverse?O.PeDefs.PE_TRANSFORM_2_TO_1:O.PeDefs.PE_TRANSFORM_1_TO_2)});if(T)for(z=0;z<Y.length;z++){Z=T[z];const U=Y[z][0],aa=179.9955<U?1:-179.9955>U?-1:0;Z&&aa&&Z!==aa&&(Y[z][0]=0<Z?U+360:U-360)}}R.isGeographic||
(T=a(R,!0),T=F.isSome(T)&&T.isEnvelope?[T.bbox[1],T.bbox[3]]:[-90,90],f(Y,T),T=R.wkid?O.PeFactory.coordsys(R.wkid):O.PeFactory.fromString(R.isGeographic?O.PeDefs.PE_TYPE_GEOGCS:O.PeDefs.PE_TYPE_PROJCS,R.wkt),O.PeCSTransformations.geogToProj(T,Y.length,Y));T=Y;if(X&&Y.length!==X.length){T=[];for(let U=0,aa=0;U<X.length;U++)X[U]?T.push(Y[aa++]):T.push([NaN,NaN])}return T}function a(z,J=!1){var R=z.wkid||z.wkt;if(!R||z.isGeographic)return null;R=String(R);if(Q.has(R))return R=Q.get(R),J?R?.gcs:R?.pcs;
var W=z.wkid?O.PeFactory.coordsys(z.wkid):O.PeFactory.fromString(z.isGeographic?O.PeDefs.PE_TYPE_GEOGCS:O.PeDefs.PE_TYPE_PROJCS,z.wkt);z=h(z,1E-4);z=n(W,z);W=n(W,0,!0);Q.set(R,{pcs:z,gcs:W});return J?W:z}function n(z,J=0,R=!1){var W=O.PePCSInfo.generate(z),Z=R?z.horizonGcsGenerate():z.horizonPcsGenerate();if(!W||!Z?.length)return null;z=!1;var Y=Z.find(ba=>1===ba.getInclusive()&&1===ba.getKind());if(!Y){Y=Z.find(ba=>1===ba.getInclusive()&&0===ba.getKind());if(!Y)return null;z=!0}R=R?0:(2===W.getNorthPoleLocation()?
1:0)|(2===W.getSouthPoleLocation()?2:0);W=W.isPannableRectangle();Y=Y.getCoord();if(z)return{isEnvelope:z,isPannable:W,vertices:Y,coef:null,bbox:[Y[0][0]-J,Y[0][1]-J,Y[1][0]+J,Y[1][1]+J],poleLocation:R};J=0;z=[];let [X,T]=Y[0],[U,aa]=Y[0];for(let ba=0,fa=Y.length;ba<fa;ba++){J++;J===fa&&(J=0);const [ja,ia]=Y[ba],[pa,ma]=Y[J];if(ma===ia)z.push([ja,pa,ia,ma,2]);else{Z=(pa-ja)/(ma-ia||1E-4);const sa=ja-Z*ia;ia<ma?z.push([Z,sa,ia,ma,0]):z.push([Z,sa,ma,ia,1])}X=X<ja?X:ja;T=T<ia?T:ia;U=U>ja?U:ja;aa=aa>
ia?aa:ia}return{isEnvelope:!1,isPannable:W,vertices:Y,coef:z,bbox:[X,T,U,aa],poleLocation:R}}function m(z,J){const R=[],{cols:W,rows:Z,xres:Y,yres:X,usePixelCenter:T}=z;let {xmin:U,ymax:aa}=z;T&&(U+=Y/2,aa-=X/2);if(F.isNone(J)){for(z=0;z<W;z++)for(J=0;J<Z;J++)R.push([U+Y*z,aa-X*J]);return{points:R}}z=new Uint8Array(W*Z);if(J.isEnvelope){const {bbox:[sa,oa,wa,ta]}=J;for(let ua=0,va=0;ua<W;ua++){var ba=U+Y*ua,fa=J.isPannable||ba>=sa&&ba<=wa;for(var ja=0;ja<Z;ja++,va++){var ia=aa-X*ja;fa&&ia>=oa&&ia<=
ta&&(R.push([ba,ia]),z[va]=1)}}return{points:R,mask:z}}ba=J.coef;J=[];for(fa=0;fa<Z;fa++){var pa=aa-X*fa;ja=[];ia=[];for(var ma=0;ma<ba.length;ma++){const [sa,oa,wa,ta,ua]=ba[ma];pa===wa&&wa===ta?(ja.push(sa),ja.push(oa),ia.push(2),ia.push(2)):pa>=wa&&pa<=ta&&(ja.push(sa*pa+oa),ia.push(ua))}pa=ja;if(2<ja.length){ma=2===ia[0]?0:ia[0];let sa=ja[0];pa=[];for(let oa=1;oa<ia.length;oa++)if(2!==ia[oa]||oa===ia.length-1)ia[oa]!==ma&&(pa.push(0===ma?Math.min(sa,ja[oa-1]):Math.max(sa,ja[oa-1])),ma=ia[oa],
sa=ja[oa]),oa===ia.length-1&&pa.push(0===ia[oa]?Math.min(sa,ja[oa]):Math.max(sa,ja[oa]));pa.sort((oa,wa)=>oa-wa)}else ja[0]>ja[1]&&(pa=[ja[1],ja[0]]);J.push(pa)}for(let sa=0,oa=0;sa<W;sa++)for(ba=U+Y*sa,fa=0;fa<Z;fa++,oa++)if(ja=aa-X*fa,ia=J[fa],2===ia.length)ba>=ia[0]&&ba<=ia[1]&&(R.push([ba,ja]),z[oa]=1);else if(2<ia.length){pa=!1;for(ma=0;ma<ia.length;ma+=2)if(ba>=ia[ma]&&ba<=ia[ma+1]){pa=!0;break}pa&&(R.push([ba,ja]),z[oa]=1)}return{points:R,mask:z}}function f(z,J){const [R,W]=J;for(J=0;J<z.length;J++){const Z=
z[J][1];if(Z<R||Z>W)z[J]=[NaN,NaN]}}function k(z){const J=v(z[0].spatialReference);if(2>z.length||F.isNone(J))return z[0];const R=h(z[0].spatialReference);z=z.filter(T=>T.width>R);if(1===z.length)return z[0];let {xmin:W,xmax:Z,ymin:Y,ymax:X}=z[0];for(let T=1;T<z.length;T++){const U=z[T];Z=U.xmax+J*T;Y=Math.min(Y,U.ymin);X=Math.max(X,U.ymax)}return new L({xmin:W,xmax:Z,ymin:Y,ymax:X,spatialReference:z[0].spatialReference})}function g(z,J,R=null,W=!0){var Z=z.spatialReference;if(Z.equals(J))return z;
var Y=M(z);const X=v(Z,!0);var T=v(J);if(0===Y||F.isNone(X)||F.isNone(T))return Y=e(z,J,R,W),F.isNone(X)&&F.isSome(T)&&Math.abs(Y.width-T)<h(J)&&V.isLoaded()&&(Z=a(Z),F.isSome(Z)&&Z.poleLocation===q.None&&z.width<(Z.bbox[2]-Z.bbox[0])/2)?b(z,J)||Y:Y;T=z.clone().normalize();if(1===T.length&&z.xmax<X&&z.xmax-X/2>h(Z)){const {xmin:U,xmax:aa}=z;for(let ba=0;ba<=Y;ba++)T[ba]=new L({xmin:0===ba?U:-X/2,xmax:ba===Y?aa-X*ba:X/2,ymin:z.ymin,ymax:z.ymax,spatialReference:Z})}z=T.map(U=>e(U,J,R,W));return k(z.filter(F.isSome))}
function b(z,J){const R=v(J);if(F.isNone(R))return null;let {xmin:W,ymin:Z,xmax:Y,ymax:X}=z;var T=z.spatialReference;z=new B({spatialReference:T,rings:[[[W,Z],[Y,Z],[Y,X],[W,X],[W,Z]]]});z=V.project(z,J);if(2!==z.rings.length||!z.rings[0].length||!z.rings[1].length)return null;({rings:z}=z);T=h(T);J=new L({spatialReference:J});for(let U=0;2>U;U++){W=Y=z[U][0][0];Z=X=z[U][0][1];for(let aa=0;aa<z[U].length;aa++)W=W>z[U][aa][0]?z[U][aa][0]:W,Y=Y<z[U][aa][0]?z[U][aa][0]:Y,Z=Z>z[U][aa][1]?z[U][aa][1]:
Z,X=X<z[U][aa][1]?z[U][aa][1]:X;if(0===U)J.ymin=Z,J.ymax=X,J.xmin=W,J.xmax=Y;else if(J.ymin=Math.min(J.ymin,Z),J.ymax=Math.max(J.ymax,X),Math.abs(Y-R/2)<T)J.xmin=W,J.xmax+=R;else if(Math.abs(W+R/2)<T)J.xmax=Y+R;else return null}return J}function e(z,J,R=null,W=!0,Z=!0){const Y=z.spatialReference;if(Y.equals(J)||!J)return z;l(Y,J,R);const X=V.project(z,J,R);if(Z&&J.isWebMercator&&X&&(X.ymax=Math.min(2.0037508342787E7,X.ymax),X.ymin=Math.max(-2.0037508342787E7,X.ymin),X.ymin>=X.ymax))return null;if(!W||
!X)return X;var T=w(Y,!0);W=w(J,!0);if(F.isNone(T)||F.isNone(W))return X;Z=h(Y,.001);const U=h(Y,500);var aa=h(J,.001);if(Math.abs(X.xmin-W[0])<aa&&Math.abs(X.xmax-W[1])<aa){aa=Math.abs(z.xmin-T[0]);T=Math.abs(T[1]-z.xmax);if(aa<Z&&T>U){X.xmin=W[0];var ba=[];ba.push(new P(z.xmax,z.ymin,Y));ba.push(new P(z.xmax,(z.ymin+z.ymax)/2,Y));ba.push(new P(z.xmax,z.ymax,Y));ba=ba.map(fa=>r(fa,J,R)).filter(fa=>!isNaN(fa?.x)).map(fa=>fa.x);X.xmax=Math.max.apply(null,ba)}T<Z&&aa>U&&(X.xmax=W[1],W=[],W.push(new P(z.xmin,
z.ymin,Y)),W.push(new P(z.xmin,(z.ymin+z.ymax)/2,Y)),W.push(new P(z.xmin,z.ymax,Y)),z=W.map(fa=>r(fa,J,R)).filter(fa=>!isNaN(fa?.x)).map(fa=>fa.x),X.xmin=Math.min.apply(null,z))}else z=h(J,.001),Math.abs(X.xmin-W[0])<z&&(X.xmin=W[0]),Math.abs(X.xmax-W[1])<z&&(X.xmax=W[1]);return X}function v(z,J=!1){return z?z.isWebMercator?2*(J?2.0037508342787E7:2.0037508342788905E7):z.wkid&&z.isGeographic?360:2*H[z.wkid]||null:null}function w(z,J=!1){if(z.isGeographic)return[-180,180];z=v(z,J);return F.isSome(z)?
[-z/2,z/2]:null}function C(z,J,R,W){z=(z-J)/R;0!==z-Math.floor(z)?z=Math.floor(z):W&&--z;return z}function M(z,J=!1){var R=v(z.spatialReference);if(F.isNone(R))return 0;const W=J?0:-(R/2),Z=h(z.spatialReference),Y=!J&&Math.abs(z.xmin+R/2)<Z?-R/2:z.xmin;z=C(!J&&Math.abs(z.xmax-R/2)<Z?R/2:z.xmax,W,R,!0);R=C(Y,W,R,!1);return z-R}function K(z){const {projectedExtent:J,srcBufferExtent:R,pixelSize:W,datumTransformation:Z,rasterTransform:Y}=z;var X=J.spatialReference;const T=R.spatialReference;var U=l(X,
T);const {xmin:aa,ymin:ba,xmax:fa,ymax:ja}=J,ia=v(T),pa=F.isSome(ia)&&(z.hasWrapAround||"gcs-shift"===Y?.type);z=z.spacing||[32,32];var ma=z[0]*W.x,sa=z[1]*W.y;const oa=1===z[0],wa=Math.ceil((fa-aa)/ma-.1/z[0])+(oa?0:1),ta=Math.ceil((ja-ba)/sa-.1/z[1])+(oa?0:1);ma=t({cols:wa,rows:ta,xmin:aa,ymax:ja,xres:ma,yres:sa,inSR:X,outSR:T,datumTransformation:Z,preferPE:4>=z[0],usePixelCenter:oa});sa=[];let ua,va=0;const qa=oa?-1:NaN,{xmin:ya,xmax:ca,ymax:ha,width:da,height:ka}=R,la=h(T,500),ea=F.isSome(ia)&&
0<ya&&ca>ia/2;var na=!1;U&&(na=a(X),na=F.isSome(na)&&0<na.poleLocation);for(X=0;X<wa;X++){U=[];for(let xa=0;xa<ta;xa++){var ra=ma[X*ta+xa];pa&&ra[0]>ca&&ra[0]>ia/2-la?ra[0]-=ia:pa&&0===X&&0>ra[0]&&ea&&!Y&&(ra[0]+=ia);!ra||isNaN(ra[0])||isNaN(ra[1])?(sa.push(qa),sa.push(qa),U.push(null),va++):(Y&&(ra=Y.inverseTransform(new P({x:ra[0],y:ra[1],spatialReference:T})),ra=[ra.x,ra.y]),U.push(ra),0<X&&pa&&ua[xa]&&ra[0]<ua[xa][0]&&(ra[0]+=ia,na&&ra[0]>ca&&ra[0]>ia&&(ra[0]-=ia)),sa.push((ra[0]-ya)/da),sa.push((ha-
ra[1])/ka))}ua=U}return{offsets:sa,error:null,coefficients:null,outofBoundPointCount:va,spacing:z,size:oa?[wa,ta]:[wa-1,ta-1]}}function x(z,J,R){const {cols:W,rows:Z}=J;J=new Float32Array((W-1)*(Z-1)*12);const Y=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),X=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let ja=0;ja<W-1;ja++){for(var T=0;T<Z-1;T++){var U=ja*Z*2+2*T,aa=z[U];const ia=z[U+1];var ba=z[U+2],fa=z[U+3];U+=2*Z;const pa=z[U],ma=z[U+1],sa=z[U+2];U=z[U+3];let oa=0,wa=12*(T*(W-1)+ja);for(let ta=
0;3>ta;ta++)J[wa++]=Y[oa++]*aa+Y[oa++]*ba+Y[oa++]*sa;oa=0;for(ba=0;3>ba;ba++)J[wa++]=Y[oa++]*ia+Y[oa++]*fa+Y[oa++]*U;oa=0;for(fa=0;3>fa;fa++)J[wa++]=X[oa++]*aa+X[oa++]*pa+X[oa++]*sa;oa=0;for(aa=0;3>aa;aa++)J[wa++]=X[oa++]*ia+X[oa++]*ma+X[oa++]*U}if(R)for(T=0;T<J.length;T++)isNaN(J[T])&&(J[T]=-1)}return J}var q;(function(z){z[z.None=0]="None";z[z.North=1]="North";z[z.South=2]="South";z[z.Both=3]="Both"})(q||(q={}));const A=(z,J,R,W=0)=>{if(1===R[0])return[0,0];var Z=1,Y=-1,X=1,T=-1;for(var U=0;U<z.length;U+=
2)isNaN(z[U])||(Z=Z>z[U]?z[U]:Z,Y=Y>z[U]?Y:z[U],X=X>z[U+1]?z[U+1]:X,T=T>z[U+1]?T:z[U+1]);const {cols:aa,rows:ba}=J;J=(Y-Z)/aa/R[0];R=(T-X)/ba/R[1];W*=2;X=0;T=!1;Z=[0,0];for(Y=0;Y<aa-3;Y++){for(U=0;U<ba-3;U++){var fa=Y*ba*2+2*U;const ja=Math.abs(((z[fa]+z[fa+4]+z[fa+4*ba]+z[fa+4*ba+4])/4-z[fa+2*ba+2])/J);fa=Math.abs(((z[fa+1]+z[fa+5]+z[fa+4*ba+1]+z[fa+4*ba+5])/4-z[fa+2*ba+3])/R);ja+fa>X&&(X=ja+fa,Z=[ja,fa]);if(W&&X>W){T=!0;break}}if(T)break}return Z},H={3395:2.0037508342789244E7,3410:1.7334193943686873E7,
3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,
54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},Q=new Map,S=new Map;N.computeProjectedScales=function(z,J,R=512,W=!0){const {extent:Z,spatialReference:Y,pixelSize:X}=z,T=u(new P({x:X.x,y:X.y,spatialReference:Y}),J,Z);if(null==T)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const U=(T.x+T.y)/2,aa=y.getMetersPerUnitForSR(J);
var ba=U*aa*96*39.37,fa=J.isGeographic?256/R*2.958287637958547E8:256/R*5.91657527591555E8,ja="vector-magdir"===z.dataType||"vector-uv"===z.dataType,ia=g(Z,J),pa=Math.min(Math.ceil(Math.log(Math.min(z.width,z.height)/32)/Math.LN2),Math.ceil(Math.log(fa/2/ba)/Math.LN2));!ja&&W&&(J.isGeographic||J.isWebMercator)&&(ja=0>ia.xmin*ia.xmax,!ja&&3>pa&&(W=v(J),F.isSome(W)&&(ja=2**pa*U*R,R=Math.ceil(W/ja),ja=1===R||2===R&&W/2-ia.xmax<ja)));W=ba;z=Math.min(2,Math.max(1.414,z.storageInfo?.pyramidScalingFactor||
2));if(ja)W=fa,fa=J.isGeographic?1.341104507446289E-6:.29858214164761665,pa=96*fa*aa*39.37,J=u(new P({x:fa,y:fa,spatialReference:{wkid:J.isGeographic?4326:3857}}),Y,ia),J.x*=W/pa,J.y*=W/pa;else{J={x:X.x,y:X.y};for(ia=0;W<.5005*fa&&ia<pa;)ia++,W*=z,J.x*=z,J.y*=z;1.001>=Math.max(W,fa)/Math.min(W,fa)&&(W=fa)}fa=[W];ia=[{x:J.x,y:J.y}];for(ba=Math.min(70.5310735,ba)/1.001;W>=ba;)W/=z,J.x/=z,J.y/=z,fa.push(W),ia.push({x:J.x,y:J.y});return{projectedPixelSize:T,scales:fa,srcResolutions:ia,isCustomTilingScheme:!ja}};
N.defaultGridSpacing=32;N.defaultProjectionToleranceInPixels=4;N.getDefaultDatumTransformationForDataset=function(z,J,R){return l(z.spatialReference,J)?R?V.getTransformation(J,z.spatialReference,z):V.getTransformation(z.spatialReference,J,z):null};N.getProjectedGridPoints=t;N.getProjectionOffsetGrid=function(z){var J=z.isAdaptive&&null==z.spacing;let R=z.spacing||[32,32],W=K(z);var Z={cols:W.size[0]+1,rows:W.size[1]+1};const Y=0<W.outofBoundPointCount&&W.outofBoundPointCount<W.offsets.length/2;let X=
W.outofBoundPointCount===W.offsets.length/2||J&&Y?[0,0]:A(W.offsets,Z,R,4);const T=(X[0]+X[1])/2;var U=z.projectedExtent.spatialReference;const aa=z.srcBufferExtent.spatialReference;J&&(Y||4<T)&&(c(U,aa,z.datumTransformation)&&(U.isGeographic||F.isSome(a(U))),R=[4,4],W=K({...z,spacing:R}),Z={cols:W.size[0]+1,rows:W.size[1]+1},X=A(W.offsets,Z,R,4));W.error=X;1<R[0]&&(W.coefficients=x(W.offsets,Z,Y));!z.includeGCSGrid||U.isGeographic||U.isWebMercator||(aa.isGeographic?W.gcsGrid={offsets:W.offsets,coefficients:W.coefficients,
spacing:R}:(J=a(U),F.isSome(J)&&!J.isEnvelope&&(U&&!U.isGeographic&&(J=String(U.wkid||U.wkt),S.has(J)?U=S.get(J):(U=(U.wkid?O.PeFactory.coordsys(U.wkid):O.PeFactory.fromString(O.PeDefs.PE_TYPE_PROJCS,U.wkt)).getGeogcs().getCode(),S.set(J,U)),U=new p({wkid:U})),U=g(z.projectedExtent,U),{offsets:z}=K({...z,srcBufferExtent:U,spacing:R}),Z=x(z,Z,Y),W.gcsGrid={offsets:z,coefficients:Z,spacing:R})));return W};N.getRasterDatasetAlignmentInfo=function(z){const J=z.storageInfo.origin.x;var R=v(z.spatialReference,
!0);if(F.isNone(R))return{originX:J,halfWorldWidth:null,pyramidsInfo:null};const W=R/2,{nativePixelSize:Z,storageInfo:Y,extent:X}=z,{maximumPyramidLevel:T,blockWidth:U,pyramidScalingFactor:aa}=Y;let ba=Z.x;const fa=[];z=F.isSome(z.transform)&&"gcs-shift"===z.transform.type;const ja=J+(z?0:W);R=z?R-J:W-J;for(let ia=0;ia<=T;ia++){const pa=(X.xmax-J)/ba/U,ma=R/ba/U;fa.push({resolutionX:ba,blockWidth:U,datsetColumnCount:0===pa-Math.floor(pa)?pa:Math.ceil(pa),worldColumnCountFromOrigin:0===ma-Math.floor(ma)?
ma:Math.ceil(ma),leftMargin:Math.round(ja/ba)%U,rightPadding:(U-Math.round(R/ba)%U)%U,originColumnOffset:Math.floor(ja/ba/U)});ba*=aa}return{originX:J,halfWorldWidth:W,pyramidsInfo:fa,hasGCSSShiftTransform:z}};N.getWorldWidth=v;N.getWorldWrapCount=M;N.load=async function(){V.isLoaded()||await V.load()};N.minimumGridSpacing=4;N.projectExtent=g;N.projectPoint=r;N.projectResolution=u;N.requirePE=c;N.snapExtent=function(z){z=z.clone().normalize();return 1===z.length?z[0]:k(z)};N.snapPyramid=function(z,
J,R){const {storageInfo:W,pixelSize:Z}=J;var Y=0;let X=!1;var {pyramidResolutions:T}=W;if(F.isSome(T)&&T.length){z=(z.x+z.y)/2;var U=T[T.length-1];U=(U.x+U.y)/2;var aa=(Z.x+Z.y)/2;if(z<=aa)Y=0;else if(z>=U)Y=T.length,X=8<z/U;else{U=aa;for(let ba=1;ba<=T.length;ba++){aa=(T[ba-1].x+T[ba-1].y)/2;if(z<=aa){z===aa?Y=ba:"down"===R?(Y=ba-1,X=8<z/U):Y="up"===R?ba:z-U>aa-z||2<z/U?ba:ba-1;break}U=aa}}R=0===Y?Z:T[Y-1];X&&(T=Math.min(R.x,R.y),z=y.getMetersPerUnitForSR(J.spatialReference),19567<T*z&&(X=!1));return{pyramidLevel:Y,
pyramidResolution:new P({x:R.x,y:R.y,spatialReference:J.spatialReference}),excessiveReading:X}}Y=Math.log(z.x/Z.x)/Math.LN2;z=Math.log(z.y/Z.y)/Math.LN2;T=J.storageInfo.maximumPyramidLevel||0;Y="down"===R?Math.floor(Math.min(Y,z)):"up"===R?Math.ceil(Math.max(Y,z)):Math.round((Y+z)/2);0>Y?Y=0:Y>T&&(X=Y>T+3,Y=T);R=2**Y;J=new P({x:R*J.nativePixelSize.x,y:R*J.nativePixelSize.y,spatialReference:J.spatialReference});return{pyramidLevel:Y,pyramidResolution:J,excessiveReading:X}};Object.defineProperty(N,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),function(N,D,I,F,y,O,V,L,P,B,p,c,l){async function u(e,v){if(!l.isPlatformLittleEndian)throw new D("rasterCoded:decode","lerc decoder is not supported on big endian platform");await V.load();const {offset:w}=v,
{width:C,height:M,pixelType:K,statistics:x,depthCount:q,noDataValues:A,bandMasks:H,pixels:Q,mask:S}=V.decode(e,{inputOffset:w,returnInterleaved:v.returnInterleaved});return new F({width:C,height:M,pixelType:K.toLowerCase(),pixels:Q,mask:S,statistics:x,bandMasks:H,depthCount:q,noDataValues:A})}async function h(e,v){e=await c.decode(e,{...v,noDataValue:null});I.assertIsSome(e);e=new F({width:e.width,height:e.height,pixels:e.pixels,pixelType:e.pixelType.toLowerCase(),mask:e.mask,statistics:null});e.updateStatistics();
return e}async function r(e,v){e=await c.decodeTileOrStrip(e,v.customOptions);e=new F({width:e.width,height:e.height,pixels:e.pixels,pixelType:e.pixelType.toLowerCase(),mask:e.mask,statistics:null});e.updateStatistics();return e}function d(e,v){const w=v.pixelType||"u8",C=F.getPixelArrayConstructor(w),M="u8"===w?e:new C(e.buffer),K=[],x=v.planes||1;if(1===x)K.push(M);else for(let q=0;q<x;q++){const A=(v.width||1)*(v.height||e.length),H=new C(A);for(let Q=0;Q<A;Q++)H[Q]=M[Q*x+q];K.push(H)}e=new F({width:v.width||
1,height:v.height||e.length,pixels:K,pixelType:w,statistics:null});e.updateStatistics();return e}function t(e,v){e=(new B.Zlib(new Uint8Array(e))).getBytes();return d(e,v)}function G(e,v){e=L.decode(e,v.offset,v.eof,!v.isInputBigEndian);return d(e,v)}function E(e,v){e=O.decode(e,v.hasNoZlibMask??void 0);e=new F({width:e.width,height:e.height,pixels:e.pixels,pixelType:"U8",mask:e.mask,statistics:null});e.updateStatistics();return e}function a(e,v){e=new Uint8Array(e);e=new g(e);const {width:w,height:C}=
v;v=w*C;e=e.decode();let M=0;var K=0;let x;K=new Uint8Array(v);for(M=0;M<v;M++)K[M]=e[4*M+3];const q=new F({width:w,height:C,pixels:[],pixelType:"U8",mask:K,statistics:[]});for(M=0;3>M;M++){x=new Uint8Array(v);for(K=0;K<v;K++)x[K]=e[4*K+M];q.addData({pixels:x})}q.updateStatistics();return q}async function n(e,v,w,C){e=await (new y).decode(e,{applyJpegMask:!1,format:v,...w},C);e=new F(e);e.updateStatistics();return e}function m(e){if(null==e)throw new D("rasterCodec:decode","parameter encodeddata is required.");
e=new Uint8Array(e,0,10);let v="";255===e[0]&&216===e[1]?v="jpg":137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]?v="png":67===e[0]&&110===e[1]&&116===e[2]&&90===e[3]&&73===e[4]&&109===e[5]&&97===e[6]&&103===e[7]&&101===e[8]&&32===e[9]?v="lerc":76===e[0]&&101===e[1]&&114===e[2]&&99===e[3]&&50===e[4]&&32===e[5]?v="lerc2":73===e[0]&&73===e[1]&&42===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&42===e[3]||73===e[0]&&73===e[1]&&43===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&43===e[3]?v="tiff":71===
e[0]&&73===e[1]&&70===e[2]?v="gif":66===e[0]&&77===e[1]?v="bmp":String.fromCharCode.apply(null,e).toLowerCase().includes("error")&&(v="error");return v}function f(e){let v=null;switch(e){case "lerc":case "lerc2":v=u;break;case "jpg":v=E;break;case "png":v=a;break;case "bsq":case "bip":v=(w,C)=>{var M=C.pixelType,K=null;let x=null;switch(M?M.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":x=255;K=Uint8Array;break;case "u16":x=x||65535;K=Uint16Array;break;case "u32":x=x||2**32-1;K=Uint32Array;
break;case "s8":x=x||-128;K=Int8Array;break;case "s16":x=x||-32768;K=Int16Array;break;case "s32":x=x||-(2**31);K=Int32Array;break;default:K=Float32Array}({pixelTypeCtor:M}={pixelTypeCtor:K,noDataValue:x});K=p.decode;w=K(w,{width:C.width,height:C.height,pixelType:M,format:e});C=new F({width:C.width,height:C.height,pixels:w.pixels,pixelType:C.pixelType,mask:w.mask,statistics:null});C.updateStatistics();return C};break;case "tiff":v=h;break;case "deflate":v=t;break;case "lzw":v=G;break;case "error":v=
()=>{throw new D("rasterCodec:decode","input data contains error");};break;default:v=()=>{throw new D("rasterCodec:decode","unsupported raster format");}}return v}function k(e,v=1){if(e){var {pixels:w,width:C,height:M,mask:K}=e;if(w&&0!==w.length){var x=w.length,q=C-1,A=M-1,H=[],Q,S,z=null,J=F.getPixelArrayConstructor(e.pixelType);if(0===v){for(v=0;v<x;v++){var R=w[v];var W=new J(q*A);for(Q=0;Q<A;Q++){var Z=Q*C;for(S=0;S<q;S++)W[Q*q+S]=R[Z+S]}H.push(W)}if(I.isSome(K))for(z=new Uint8Array(q*A),Q=0;Q<
A;Q++)for(Z=Q*C,S=0;S<q;S++)z[Q*q+S]=K[Z+S]}else{for(v=0;v<x;v++){R=w[v];W=new J(q*A);for(Q=0;Q<A;Q++)for(Z=Q*C,S=0;S<q;S++)W[Q*q+S]=(R[Z+S]+R[Z+S+1]+R[Z+C+S]+R[Z+C+S+1])/4;H.push(W)}if(K)for(z=new Uint8Array(q*A),Q=0;Q<A;Q++)for(Z=Q*C,S=0;S<q;S++)z[Q*q+S]=Math.min.apply(null,[K[Z+S],K[Z+S+1],K[Z+C+S],K[Z+C+S+1]])}e.width=q;e.height=A;e.mask=z;e.pixels=H}}}var g=function(e){function v(K){var x,q;this.data=K;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text=
{};for(q=null;;){var A=this.readUInt32();var H=K=void 0;K=[];for(H=0;4>H;++H)K.push(String.fromCharCode(this.data[this.pos++]));K=K.join("");switch(K){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||
Infinity,frames:[]};break;case "PLTE":this.palette=this.read(A);break;case "fcTL":q&&this.animation.frames.push(q);this.pos+=4;q={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};K=this.readUInt16();A=this.readUInt16()||100;q.delay=1E3*K/A;q.disposeOp=this.data[this.pos++];q.blendOp=this.data[this.pos++];q.data=[];break;case "IDAT":case "fdAT":"fdAT"===K&&(this.pos+=4,A-=4);K=(null!=q?q.data:void 0)||this.imgData;for(H=0;0<=A?H<A:H>A;0<=A?++H:--H)K.push(this.data[this.pos++]);
break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(A);A=255-this.transparency.indexed.length;if(0<A)for(K=0;0<=A?K<A:K>A;0<=A?++K:--K)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(A)[0];break;case 2:this.transparency.rgb=this.read(A)}break;case "tEXt":H=this.read(A);A=H.indexOf(0);K=String.fromCharCode.apply(String,H.slice(0,A));this.text[K]=String.fromCharCode.apply(String,H.slice(A+1));break;case "IEND":q&&
this.animation.frames.push(q);a:{switch(this.colorType){case 0:case 3:case 4:q=1;break a;case 2:case 6:q=3;break a}q=void 0}this.colors=q;this.hasAlphaChannel=4===(x=this.colorType)||6===x;x=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*x;a:{switch(this.colors){case 1:x="DeviceGray";break a;case 3:x="DeviceRGB";break a}x=void 0}this.colorSpace=x;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=A}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");
}}var w;v.load=function(K,x,q){"function"===typeof x&&(q=x);var A=new XMLHttpRequest;A.open("GET",K,!0);A.responseType="arraybuffer";A.onload=function(){var H=new Uint8Array(A.response||A.mozResponseArrayBuffer);H=new v(H);"function"===typeof(null!=x?x.getContext:void 0)&&H.render(x);return"function"===typeof q?q(H):void 0};return A.send(null)};v.prototype.read=function(K){var x;var q=[];for(x=0;0<=K?x<K:x>K;0<=K?++x:--x)q.push(this.data[this.pos++]);return q};v.prototype.readUInt32=function(){var K=
this.data[this.pos++]<<24;var x=this.data[this.pos++]<<16;var q=this.data[this.pos++]<<8;var A=this.data[this.pos++];return K|x|q|A};v.prototype.readUInt16=function(){var K=this.data[this.pos++]<<8;var x=this.data[this.pos++];return K|x};v.prototype.decodePixels=function(K){var x,q,A,H,Q,S,z,J;null==K&&(K=this.imgData);if(0===K.length)return new Uint8Array(0);K=new B.Zlib(K);K=K.getBytes();var R=this.pixelBitlength/8;var W=R*this.width;var Z=new Uint8Array(W*this.height);var Y=K.length;for(q=H=Q=
0;H<Y;){switch(K[H++]){case 0:for(A=x=0;x<W;A=x+=1)Z[q++]=K[H++];break;case 1:for(A=S=0;S<W;A=S+=1){x=K[H++];var X=A<R?0:Z[q-R];Z[q++]=(x+X)%256}break;case 2:for(A=X=0;X<W;A=X+=1){x=K[H++];var T=(A-A%R)/R;S=Q&&Z[(Q-1)*W+T*R+A%R];Z[q++]=(S+x)%256}break;case 3:for(A=J=0;J<W;A=J+=1)x=K[H++],T=(A-A%R)/R,X=A<R?0:Z[q-R],S=Q&&Z[(Q-1)*W+T*R+A%R],Z[q++]=(x+Math.floor((X+S)/2))%256;break;case 4:for(A=J=0;J<W;A=J+=1){x=K[H++];T=(A-A%R)/R;X=A<R?0:Z[q-R];0===Q?S=z=0:(S=Z[(Q-1)*W+T*R+A%R],z=T&&Z[(Q-1)*W+(T-1)*
R+A%R]);var U=X+S-z;A=Math.abs(U-X);T=Math.abs(U-S);U=Math.abs(U-z);X=A<=T&&A<=U?X:T<=U?S:z;Z[q++]=(x+X)%256}break;default:throw Error("Invalid filter algorithm: "+K[H-1]);}Q++}return Z};v.prototype.decodePalette=function(){var K,x,q,A;var H=this.palette;var Q=this.transparency.indexed||[];var S=new Uint8Array((Q.length||0)+H.length);var z=0;H.length;var J=x=K=0;for(q=H.length;x<q;J=x+=3)S[z++]=H[J],S[z++]=H[J+1],S[z++]=H[J+2],S[z++]=null!=(A=Q[K++])?A:255;return S};v.prototype.copyToImageData=function(K,
x){var q,A;var H=this.colors;var Q=null;var S=this.hasAlphaChannel;this.palette.length&&(Q=null!=(q=this._decodedPalette)?q:this._decodedPalette=this.decodePalette(),H=4,S=!0);K=K.data||K;var z=K.length;var J=Q||x;q=A=0;if(1===H)for(;q<z;)H=Q?4*x[q/4]:A,A=J[H++],K[q++]=A,K[q++]=A,K[q++]=A,K[q++]=S?J[H++]:this.transparency.grayscale&&this.transparency.grayscale===A?0:255,A=H;else for(;q<z;)H=Q?4*x[q/4]:A,K[q++]=J[H++],K[q++]=J[H++],K[q++]=J[H++],K[q++]=S?J[H++]:this.transparency.rgb&&this.transparency.rgb[1]===
J[H-3]&&this.transparency.rgb[3]===J[H-2]&&this.transparency.rgb[5]===J[H-1]?0:255,A=H};v.prototype.decode=function(){var K=new Uint8Array(this.width*this.height*4);this.copyToImageData(K,this.decodePixels());return K};var C=(w=e.document&&e.document.createElement("canvas"))&&w.getContext("2d");var M=function(K){C.width=K.width;C.height=K.height;C.clearRect(0,0,K.width,K.height);C.putImageData(K,0,0);K=new Image;K.src=w.toDataURL();return K};v.prototype.decodeFrames=function(K){var x,q;if(this.animation){var A=
this.animation.frames;var H=[];var Q=x=0;for(q=A.length;x<q;Q=++x){Q=A[Q];var S=K.createImageData(Q.width,Q.height);var z=this.decodePixels(new Uint8Array(Q.data));this.copyToImageData(S,z);Q.imageData=S;H.push(Q.image=M(S))}return H}};v.prototype.renderFrame=function(K,x){var q=this.animation.frames;var A=q[x];q=q[x-1];0===x&&K.clearRect(0,0,this.width,this.height);1===(null!=q?q.disposeOp:void 0)?K.clearRect(q.xOffset,q.yOffset,q.width,q.height):2===(null!=q?q.disposeOp:void 0)&&K.putImageData(q.imageData,
q.xOffset,q.yOffset);0===A.blendOp&&K.clearRect(A.xOffset,A.yOffset,A.width,A.height);return K.drawImage(A.image,A.xOffset,A.yOffset)};v.prototype.animate=function(K){var x,q=this;var A=0;var H=this.animation;var Q=H.numFrames;var S=H.frames;var z=H.numPlays;return(x=function(){var J=A++%Q;var R=S[J];q.renderFrame(K,J);if(1<Q&&A/Q<z)return q.animation._timeout=setTimeout(x,R.delay)})()};v.prototype.stopAnimation=function(){var K;return clearTimeout(null!=(K=this.animation)?K._timeout:void 0)};v.prototype.render=
function(K){K._png&&K._png.stopAnimation();K._png=this;K.width=this.width;K.height=this.height;K=K.getContext("2d");if(this.animation)return this.decodeFrames(K),this.animate(K);var x=K.createImageData(this.width,this.height);this.copyToImageData(x,this.decodePixels());return K.putImageData(x,0,0)};return v}(self);const b=new Set(["jpg","png","bmp","gif"]);N.decode=async function(e,v={},w){if(null==e)throw new D("rasterCodec:decode","missing encodeddata parameter.");let C=v.format&&v.format.toLowerCase();
if(!("bsq"!==C&&"bip"!==C||null!=v.width&&null!=v.height))throw new D("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===C&&v.customOptions)return r(e,v);if(!C||"bsq"!==C&&"bip"!==C&&"deflate"!==C&&"lzw"!==C)C=m(e);if(v.useCanvas&&b.has(C))return n(e,C,v,w);w=f(C);v.isPoint&&(v={...v},null!=v.width&&v.width++,null!=v.height&&v.height++);e=await w(e,v);if(!e)return e;"jpg"!==C&&null!=v.noDataValue&&1===e.depthCount&&P.convertNoDataToMask(e,v.noDataValue,{customFloatTolerance:v.tolerance});
v.isPoint&&k(e);return e};N.getFormat=function(e){e=m(e);"lerc2"===e?e="lerc":"error"===e&&(e="");return e};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],function(N,D,I,F){return function(){function y(O){this._ctx=this._canvas=null;O&&(this._canvas=O.canvas,this._ctx=O.ctx||O.canvas&&O.canvas.getContext("2d"))}
y.prototype.decode=function(O,V,L){if(!O||10>O.byteLength)throw new D("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:P=0,height:B=0,format:p}=V;const {applyJpegMask:c}=V;if(c&&(!P||!B))throw new D("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((l,u)=>{let h=null;"jpg"===p&&c&&(h=y._getMask(O,{width:P,height:B}));const r=new Blob([new Uint8Array(O)],{type:"jpg"==="image/"+p?"jpeg":p}),d=
URL.createObjectURL(r),t=new Image;let G;t.src=d;t.onload=()=>{URL.revokeObjectURL(d);if(I.isAborted(L))u(I.createAbortError());else{P=t.width;B=t.height;if(this._canvas&&this._ctx){if(this._canvas.width!==P||this._canvas.height!==B)this._canvas.width=P,this._canvas.height=B;this._ctx.clearRect(0,0,P,B)}else this._canvas=document.createElement("canvas"),this._canvas.width=P,this._canvas.height=B,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(t,0,0);var E=this._ctx.getImageData(0,0,P,
B);G=E.data;var a;if(V.renderOnCanvas){if(h)for(a=0;a<h.length;a++)G[4*a+3]=h[a]?255:0;this._ctx.putImageData(E,0,0);l(null)}else{E=P*B;var n=new Uint8Array(E),m=new Uint8Array(E),f=new Uint8Array(E);if(h)for(a=0;a<E;a++)n[a]=G[4*a],m[a]=G[4*a+1],f[a]=G[4*a+2];else for(h=new Uint8Array(E),a=0;a<E;a++)n[a]=G[4*a],m[a]=G[4*a+1],f[a]=G[4*a+2],h[a]=G[4*a+3];l({width:P,height:B,pixels:[n,m,f],mask:h,pixelType:"u8"})}}};t.onerror=()=>{URL.revokeObjectURL(d);u("cannot load image")}})};y._getMask=function(O,
V){let L=null;try{var P=new Uint8Array(O);O=0;var B=P.length-2;for(O=Math.ceil(P.length/2);O<B&&(255!==P[O]||217!==P[O+1]);O++);O+=2;if(O<P.length-1){const p=(new F.Zlib(P.subarray(O))).getBytes();L=new Uint8Array(V.width*V.height);V=0;for(P=0;P<p.length;P++)for(B=7;0<=B;B--)L[V++]=p[P]>>B&1}}catch(p){}return L};return N._createClass(y)}()})},"esri/chunks/Zlib":function(){define(["exports"],function(N){var D={};(function(I){(function(F){F=F();void 0!==F&&(I.exports=F)})(function(){var F=function(){function y(){this.bufferLength=
this.pos=0;this.eof=!1;this.buffer=null}y.prototype={ensureBuffer:function(O){var V=this.buffer,L=V?V.byteLength:0;if(O<L)return V;for(var P=512;P<O;)P<<=1;O=new Uint8Array(P);for(P=0;P<L;++P)O[P]=V[P];return this.buffer=O},getByte:function(){for(var O=this.pos;this.bufferLength<=O;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(O){var V=this.pos;if(O){this.ensureBuffer(V+O);for(O=V+O;!this.eof&&this.bufferLength<O;)this.readBlock();var L=this.bufferLength;
O>L&&(O=L)}else{for(;!this.eof;)this.readBlock();O=this.bufferLength}this.pos=O;return this.buffer.subarray(V,O)},lookChar:function(){for(var O=this.pos;this.bufferLength<=O;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var O=this.pos;this.bufferLength<=O;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(O,V,L){for(var P=O+V;this.bufferLength<=P&&!this.eof;)this.readBlock();
return new Stream(this.buffer,O,V,L)},skip:function(O){O||(O=1);this.pos+=O},reset:function(){this.pos=0}};return y}();return function(){function y(c){throw Error(c);}function O(c){var l=0,u=c[l++],h=c[l++];-1!=u&&-1!=h||y("Invalid header in flate stream");8!=(u&15)&&y("Unknown compression method in flate stream");0!=((u<<8)+h)%31&&y("Bad FCHECK in flate stream");h&32&&y("FDICT bit set in flate stream");this.bytes=c;this.bytesPos=l;this.codeBuf=this.codeSize=0;F.call(this)}if(!self||!self.Uint32Array)return null;
var V=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),L=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),P=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),B=[new Uint32Array([459008,524368,
524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,
524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,
524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,
524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,
524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,
524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,
524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,
524335,590015,524303,524431,524367,590079]),9],p=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];O.prototype=Object.create(F.prototype);O.prototype.getBits=function(c){for(var l=this.codeSize,u=this.codeBuf,h=this.bytes,r=this.bytesPos,d;l<c;)"undefined"==typeof(d=h[r++])&&y("Bad encoding in flate stream"),u|=d<<
l,l+=8;this.codeBuf=u>>c;this.codeSize=l-=c;this.bytesPos=r;return u&(1<<c)-1};O.prototype.getCode=function(c){var l=c[0],u=c[1];c=this.codeSize;for(var h=this.codeBuf,r=this.bytes,d=this.bytesPos;c<u;){var t;"undefined"==typeof(t=r[d++])&&y("Bad encoding in flate stream");h|=t<<c;c+=8}u=l[h&(1<<u)-1];l=u>>16;u&=65535;(0==c||c<l||0==l)&&y("Bad encoding in flate stream");this.codeBuf=h>>l;this.codeSize=c-l;this.bytesPos=d;return u};O.prototype.generateHuffmanTable=function(c){for(var l=c.length,u=
0,h=0;h<l;++h)c[h]>u&&(u=c[h]);for(var r=1<<u,d=new Uint32Array(r),t=1,G=0,E=2;t<=u;++t,G<<=1,E<<=1)for(var a=0;a<l;++a)if(c[a]==t){var n=0,m=G;for(h=0;h<t;++h)n=n<<1|m&1,m>>=1;for(h=n;h<r;h+=E)d[h]=t<<16|a;++G}return[d,u]};O.prototype.readBlock=function(){function c(n,m,f,k,g){for(n=n.getBits(f)+k;0<n--;)m[G++]=g}var l=this.getBits(3);l&1&&(this.eof=!0);l>>=1;if(0==l){var u=this.bytes,h=this.bytesPos,r;"undefined"==typeof(r=u[h++])&&y("Bad block header in flate stream");var d=r;"undefined"==typeof(r=
u[h++])&&y("Bad block header in flate stream");d|=r<<8;"undefined"==typeof(r=u[h++])&&y("Bad block header in flate stream");l=r;"undefined"==typeof(r=u[h++])&&y("Bad block header in flate stream");(l|r<<8)!=(~d&65535)&&y("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;r=this.bufferLength;l=this.ensureBuffer(r+d);this.bufferLength=d=r+d;for(var t=r;t<d;++t){if("undefined"==typeof(r=u[h++])){this.eof=!0;break}l[t]=r}this.bytesPos=h}else{if(1==l)h=B,r=p;else if(2==l){l=
this.getBits(5)+257;r=this.getBits(5)+1;u=this.getBits(4)+4;h=Array(V.length);for(var G=0;G<u;)h[V[G++]]=this.getBits(3);h=this.generateHuffmanTable(h);G=u=0;r=l+r;for(d=Array(r);G<r;)t=this.getCode(h),16==t?c(this,d,2,3,u):17==t?c(this,d,3,3,u=0):18==t?c(this,d,7,11,u=0):d[G++]=u=t;h=this.generateHuffmanTable(d.slice(0,l));r=this.generateHuffmanTable(d.slice(l,r))}else y("Unknown block type in flate stream");d=(l=this.buffer)?l.length:0;for(t=this.bufferLength;;){var E=this.getCode(h);if(256>E)t+
1>=d&&(l=this.ensureBuffer(t+1),d=l.length),l[t++]=E;else{if(256==E){this.bufferLength=t;break}E-=257;E=L[E];var a=E>>16;0<a&&(a=this.getBits(a));u=(E&65535)+a;E=this.getCode(r);E=P[E];a=E>>16;0<a&&(a=this.getBits(a));E=(E&65535)+a;t+u>=d&&(l=this.ensureBuffer(t+u),d=l.length);for(a=0;a<u;++a,++t)l[t]=l[t-E]}}}};return O}()})})({get exports(){return D},set exports(I){D=I}});N.Zlib=D})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/_rollupPluginBabelHelpers","../../../chunks/Jpg",
"../../../chunks/Zlib"],function(N,D,I){return function(){function F(){}F.decode=function(y,O=!1){const V=new Uint8Array(y);y=new D.JpegImage;y.parse(V);const {width:L,height:P,numComponents:B,eof:p}=y,c=y.getData(L,P,!0),l=L*P;y=null;let u=0,h=0,r=0;if(!O&&p<V.length-1)try{var d=(new I.Zlib(V.subarray(p))).getBytes();y=new Uint8Array(l);for(u=O=0;u<d.length;u++)for(r=7;0<=r;r--)y[O++]=d[u]>>r&1}catch{}if(1===B&&c.length===L*P)d=new Uint8Array(c.buffer),d=[d,d,d];else{d=[];for(u=0;3>u;u++)d.push(new Uint8Array(l));
for(h=r=0;h<l;h++)for(u=0;3>u;u++)d[u][h]=c[r++]}return{width:L,height:P,pixels:d,mask:y}};return N._createClass(F)}()})},"esri/chunks/Jpg":function(){define(["exports"],function(N){var D={};(function(I){(function(F){F=F();void 0!==F&&(I.exports=F)})(function(){var F=function(){function y(O){this.message="JPEG error: "+O}y.prototype=Error();y.prototype.name="JpegError";return y.constructor=y}();return function(){function y(){this.decodeTransform=null;this.colorTransform=-1}function O(p,c){for(var l=
0,u=[],h,r,d=16;0<d&&!p[d-1];)d--;u.push({children:[],index:0});var t=u[0],G;for(h=0;h<d;h++){for(r=0;r<p[h];r++){t=u.pop();for(t.children[t.index]=c[l];0<t.index;)t=u.pop();t.index++;for(u.push(t);u.length<=h;)u.push(G={children:[],index:0}),t.children[t.index]=G.children,t=G;l++}h+1<d&&(u.push(G={children:[],index:0}),t.children[t.index]=G.children,t=G)}return u[0].children}function V(p,c,l,u,h,r,d,t,G){function E(){if(0<M)return M--,C>>M&1;C=p[c++];if(255===C){var X=p[c++];if(X)throw new F("unexpected marker "+
(C<<8|X).toString(16));}M=7;return C>>>7}function a(X){for(;;){X=X[E()];if("number"===typeof X)return X;if("object"!==typeof X)throw new F("invalid huffman sequence");}}function n(X){for(var T=0;0<X;)T=T<<1|E(),X--;return T}function m(X){if(1===X)return 1===E()?1:-1;var T=n(X);return T>=1<<X-1?T:T+(-1<<X)+1}function f(X,T){var U=a(X.huffmanTableDC);U=0===U?0:m(U);X.blockData[T]=X.pred+=U;for(U=1;64>U;){var aa=a(X.huffmanTableAC),ba=aa&15;aa>>=4;if(0===ba){if(15>aa)break;U+=16}else U+=aa,X.blockData[T+
B[U]]=m(ba),U++}}function k(X,T){var U=a(X.huffmanTableDC);U=0===U?0:m(U)<<G;X.blockData[T]=X.pred+=U}function g(X,T){X.blockData[T]|=E()<<G}function b(X,T){if(0<K)K--;else for(var U=r;U<=d;){var aa=a(X.huffmanTableAC),ba=aa&15;aa>>=4;if(0===ba){if(15>aa){K=n(aa)+(1<<aa)-1;break}U+=16}else U+=aa,X.blockData[T+B[U]]=m(ba)*(1<<G),U++}}function e(X,T){for(var U=r,aa=0,ba;U<=d;){ba=B[U];switch(x){case 0:aa=a(X.huffmanTableAC);ba=aa&15;aa>>=4;if(0===ba)15>aa?(K=n(aa)+(1<<aa),x=4):(aa=16,x=1);else{if(1!==
ba)throw new F("invalid ACn encoding");q=m(ba);x=aa?2:3}continue;case 1:case 2:X.blockData[T+ba]?X.blockData[T+ba]+=E()<<G:(aa--,0===aa&&(x=2===x?3:0));break;case 3:X.blockData[T+ba]?X.blockData[T+ba]+=E()<<G:(X.blockData[T+ba]=q<<G,x=0);break;case 4:X.blockData[T+ba]&&(X.blockData[T+ba]+=E()<<G)}U++}4===x&&(K--,0===K&&(x=0))}var v=l.mcusPerLine,w=c,C=0,M=0,K=0,x=0,q,A=u.length,H,Q,S,z;t=l.progressive?0===r?0===t?k:g:0===t?b:e:f;var J=0;l=1===A?u[0].blocksPerLine*u[0].blocksPerColumn:v*l.mcusPerColumn;
for(var R,W;J<l;){var Z=h?Math.min(l-J,h):l;for(H=0;H<A;H++)u[H].pred=0;K=0;if(1===A){var Y=u[0];for(z=0;z<Z;z++)t(Y,64*((Y.blocksPerLine+1)*(J/Y.blocksPerLine|0)+J%Y.blocksPerLine)),J++}else for(z=0;z<Z;z++){for(H=0;H<A;H++)for(Y=u[H],R=Y.h,W=Y.v,Q=0;Q<W;Q++)for(S=0;S<R;S++)t(Y,64*((Y.blocksPerLine+1)*((J/v|0)*Y.v+Q)+(J%v*Y.h+S)));J++}M=0;(Y=P(p,c))&&Y.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+Y.invalid),c=Y.offset);Y=Y&&Y.marker;if(!Y||65280>=Y)throw new F("marker was not found");
if(65488<=Y&&65495>=Y)c+=2;else break}(Y=P(p,c))&&Y.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+Y.invalid),c=Y.offset);return c-w}function L(p,c){p=c.blocksPerLine;for(var l=c.blocksPerColumn,u=new Int16Array(64),h=0;h<l;h++)for(var r=0;r<p;r++){var d=void 0,t=void 0,G=void 0,E=void 0,a=void 0,n=void 0,m=void 0,f=void 0,k=a=n=E=t=d=void 0,g=void 0,b=void 0,e=void 0,v=64*((c.blocksPerLine+1)*h+r),w=u,C=c.quantizationTable,M=c.blockData;if(!C)throw new F("missing required Quantization Table.");
for(var K=0;64>K;K+=8)d=M[v+K],f=M[v+K+1],m=M[v+K+2],n=M[v+K+3],a=M[v+K+4],E=M[v+K+5],G=M[v+K+6],t=M[v+K+7],d*=C[K],0===(f|m|n|a|E|G|t)?(d=5793*d+512>>10,w[K]=d,w[K+1]=d,w[K+2]=d,w[K+3]=d,w[K+4]=d,w[K+5]=d,w[K+6]=d,w[K+7]=d):(f*=C[K+1],m*=C[K+2],n*=C[K+3],a*=C[K+4],E*=C[K+5],G*=C[K+6],t*=C[K+7],e=5793*d+128>>8,b=5793*a+128>>8,g=m,k=G,a=2896*(f-t)+128>>8,t=2896*(f+t)+128>>8,n<<=4,E<<=4,e=e+b+1>>1,b=e-b,d=3784*g+1567*k+128>>8,g=1567*g-3784*k+128>>8,k=d,a=a+E+1>>1,E=a-E,t=t+n+1>>1,n=t-n,e=e+k+1>>1,k=
e-k,b=b+g+1>>1,g=b-g,d=2276*a+3406*t+2048>>12,a=3406*a-2276*t+2048>>12,t=d,d=799*n+4017*E+2048>>12,n=4017*n-799*E+2048>>12,E=d,w[K]=e+t,w[K+7]=e-t,w[K+1]=b+E,w[K+6]=b-E,w[K+2]=g+n,w[K+5]=g-n,w[K+3]=k+a,w[K+4]=k-a);for(C=0;8>C;++C)d=w[C],f=w[C+8],m=w[C+16],n=w[C+24],a=w[C+32],E=w[C+40],G=w[C+48],t=w[C+56],0===(f|m|n|a|E|G|t)?(d=5793*d+8192>>14,d=-2040>d?0:2024<=d?255:d+2056>>4,M[v+C]=d,M[v+C+8]=d,M[v+C+16]=d,M[v+C+24]=d,M[v+C+32]=d,M[v+C+40]=d,M[v+C+48]=d,M[v+C+56]=d):(e=5793*d+2048>>12,b=5793*a+2048>>
12,g=m,k=G,a=2896*(f-t)+2048>>12,t=2896*(f+t)+2048>>12,e=(e+b+1>>1)+4112,b=e-b,d=3784*g+1567*k+2048>>12,g=1567*g-3784*k+2048>>12,k=d,a=a+E+1>>1,E=a-E,t=t+n+1>>1,n=t-n,e=e+k+1>>1,k=e-k,b=b+g+1>>1,g=b-g,d=2276*a+3406*t+2048>>12,a=3406*a-2276*t+2048>>12,t=d,d=799*n+4017*E+2048>>12,n=4017*n-799*E+2048>>12,E=d,d=e+t,t=e-t,f=b+E,G=b-E,m=g+n,E=g-n,n=k+a,a=k-a,d=16>d?0:4080<=d?255:d>>4,f=16>f?0:4080<=f?255:f>>4,m=16>m?0:4080<=m?255:m>>4,n=16>n?0:4080<=n?255:n>>4,a=16>a?0:4080<=a?255:a>>4,E=16>E?0:4080<=E?
255:E>>4,G=16>G?0:4080<=G?255:G>>4,t=16>t?0:4080<=t?255:t>>4,M[v+C]=d,M[v+C+8]=f,M[v+C+16]=m,M[v+C+24]=n,M[v+C+32]=a,M[v+C+40]=E,M[v+C+48]=G,M[v+C+56]=t)}return c.blockData}function P(p,c,l){var u=p.length-1;l=l<c?l:c;if(c>=u)return null;var h=p[c]<<8|p[c+1];if(65472<=h&&65534>=h)return{invalid:null,marker:h,offset:c};for(c=p[l]<<8|p[l+1];!(65472<=c&&65534>=c);){if(++l>=u)return null;c=p[l]<<8|p[l+1]}return{invalid:h.toString(16),marker:c,offset:l}}if(!self||!self.Uint8ClampedArray)return null;var B=
new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);y.prototype={parse:function(p){function c(){var C=p[h]<<8|p[h+1];h+=2;return C}function l(){var C=c();C=h+C-2;var M=P(p,C,h);M&&M.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+M.invalid),C=M.offset);C=p.subarray(h,C);h+=C.length;return C}function u(C){for(var M=Math.ceil(C.samplesPerLine/
8/C.maxH),K=Math.ceil(C.scanLines/8/C.maxV),x=0;x<C.components.length;x++){w=C.components[x];var q=Math.ceil(Math.ceil(C.samplesPerLine/8)*w.h/C.maxH),A=Math.ceil(Math.ceil(C.scanLines/8)*w.v/C.maxV);w.blockData=new Int16Array(64*K*w.v*(M*w.h+1));w.blocksPerLine=q;w.blocksPerColumn=A}C.mcusPerLine=M;C.mcusPerColumn=K}var h=0,r=null,d=null,t=[],G=[],E=[],a=c();if(65496!==a)throw new F("SOI not found");for(a=c();65497!==a;){switch(a){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var n=
l();65504===a&&74===n[0]&&70===n[1]&&73===n[2]&&70===n[3]&&0===n[4]&&(r={version:{major:n[5],minor:n[6]},densityUnits:n[7],xDensity:n[8]<<8|n[9],yDensity:n[10]<<8|n[11],thumbWidth:n[12],thumbHeight:n[13],thumbData:n.subarray(14,14+3*n[12]*n[13])});65518===a&&65===n[0]&&100===n[1]&&111===n[2]&&98===n[3]&&101===n[4]&&(d={version:n[5]<<8|n[6],flags0:n[7]<<8|n[8],flags1:n[9]<<8|n[10],transformCode:n[11]});break;case 65499:a=c()+h-2;for(var m;h<a;){var f=p[h++],k=new Uint16Array(64);if(0===f>>4)for(n=
0;64>n;n++)m=B[n],k[m]=p[h++];else if(1===f>>4)for(n=0;64>n;n++)m=B[n],k[m]=c();else throw new F("DQT - invalid table spec");t[f&15]=k}break;case 65472:case 65473:case 65474:if(g)throw new F("Only single frame JPEGs supported");c();var g={};g.extended=65473===a;g.progressive=65474===a;g.precision=p[h++];g.scanLines=c();g.samplesPerLine=c();g.components=[];g.componentIds={};n=p[h++];for(a=k=f=0;a<n;a++){m=p[h];var b=p[h+1]>>4;var e=p[h+1]&15;f<b&&(f=b);k<e&&(k=e);b=g.components.push({h:b,v:e,quantizationId:p[h+
2],quantizationTable:null});g.componentIds[m]=b-1;h+=3}g.maxH=f;g.maxV=k;u(g);break;case 65476:m=c();for(a=2;a<m;){f=p[h++];k=new Uint8Array(16);for(n=b=0;16>n;n++,h++)b+=k[n]=p[h];e=new Uint8Array(b);for(n=0;n<b;n++,h++)e[n]=p[h];a+=17+b;(0===f>>4?E:G)[f&15]=O(k,e)}break;case 65501:c();var v=c();break;case 65498:c();m=p[h++];n=[];for(a=0;a<m;a++){f=g.componentIds[p[h++]];var w=g.components[f];f=p[h++];w.huffmanTableDC=E[f>>4];w.huffmanTableAC=G[f&15];n.push(w)}a=p[h++];m=p[h++];f=p[h++];a=V(p,h,
g,n,v,a,m,f>>4,f&15);h+=a;break;case 65535:255!==p[h]&&h--;break;default:if(255===p[h-3]&&192<=p[h-2]&&254>=p[h-2])h-=3;else throw new F("unknown marker "+a.toString(16));}a=c()}this.width=g.samplesPerLine;this.height=g.scanLines;this.jfif=r;this.eof=h;this.adobe=d;this.components=[];for(a=0;a<g.components.length;a++){w=g.components[a];if(r=t[w.quantizationId])w.quantizationTable=r;this.components.push({output:L(g,w),scaleX:w.h/g.maxH,scaleY:w.v/g.maxV,blocksPerLine:w.blocksPerLine,blocksPerColumn:w.blocksPerColumn})}this.numComponents=
this.components.length},_getLinearizedBlockData:function(p,c){var l=this.width/p,u=this.height/c,h,r,d=0,t=this.components.length,G=p*c*t,E=new Uint8ClampedArray(G),a=new Uint32Array(p);for(r=0;r<t;r++){var n=this.components[r];var m=n.scaleX*l;var f=n.scaleY*u;d=r;var k=n.output;var g=n.blocksPerLine+1<<3;for(h=0;h<p;h++)n=0|h*m,a[h]=(n&4294967288)<<3|n&7;for(m=0;m<c;m++)for(n=0|m*f,n=g*(n&4294967288)|(n&7)<<3,h=0;h<p;h++)E[d]=k[n+a[h]],d+=t}if(c=this.decodeTransform)for(r=0;r<G;)for(p=n=0;n<t;n++,
r++,p+=2)E[r]=(E[r]*c[p]>>8)+c[p+1];return E},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(p){for(var c,l,u,h=0,r=p.length;h<r;h+=3)c=p[h],l=p[h+1],u=p[h+2],p[h]=c-179.456+1.402*u,p[h+1]=c+135.459-.344*l-.714*u,p[h+2]=c-226.816+1.772*l;return p},_convertYcckToRgb:function(p){for(var c,l,u,h,r=0,d=0,t=p.length;d<t;d+=4)c=p[d],l=p[d+1],u=p[d+2],h=p[d+3],p[r++]=
-122.67195406894+l*(-6.60635669420364E-5*l+4.37130475926232E-4*u-5.4080610064599E-5*c+4.8449797120281E-4*h-.154362151871126)+u*(-9.57964378445773E-4*u+8.17076911346625E-4*c-.00477271405408747*h+1.53380253221734)+c*(9.61250184130688E-4*c-.00266257332283933*h+.48357088451265)+h*(-3.36197177618394E-4*h+.484791561490776),p[r++]=107.268039397724+l*(2.19927104525741E-5*l-6.40992018297945E-4*u+6.59397001245577E-4*c+4.26105652938837E-4*h-.176491792462875)+u*(-7.78269941513683E-4*u+.00130872261408275*c+7.70482631801132E-4*
h-.151051492775562)+c*(.00126935368114843*c-.00265090189010898*h+.25802910206845)+h*(-3.18913117588328E-4*h-.213742400323665),p[r++]=-20.810012546947+l*(-5.70115196973677E-4*l-2.63409051004589E-5*u+.0020741088115012*c-.00288260236853442*h+.814272968359295)+u*(-1.53496057440975E-5*u-1.32689043961446E-4*c+5.60833691242812E-4*h-.195152027534049)+c*(.00174418132927582*c-.00255243321439347*h+.116935020465145)+h*(-3.43531996510555E-4*h+.24165260232407);return p},_convertYcckToCmyk:function(p){for(var c,
l,u,h=0,r=p.length;h<r;h+=4)c=p[h],l=p[h+1],u=p[h+2],p[h]=434.456-c-1.402*u,p[h+1]=119.541-c+.344*l+.714*u,p[h+2]=481.816-c-1.772*l;return p},_convertCmykToRgb:function(p){for(var c,l,u,h,r=0,d=1/255,t=0,G=p.length;t<G;t+=4)c=p[t]*d,l=p[t+1]*d,u=p[t+2]*d,h=p[t+3]*d,p[r++]=255+c*(-4.387332384609988*c+54.48615194189176*l+18.82290502165302*u+212.25662451639585*h-285.2331026137004)+l*(1.7149763477362134*l-5.6096736904047315*u-17.873870861415444*h-5.497006427196366)+u*(-2.5217340131683033*u-21.248923337353073*
h+17.5119270841813)-h*(21.86122147463605*h+189.48180835922747),p[r++]=255+c*(8.841041422036149*c+60.118027045597366*l+6.871425592049007*u+31.159100130055922*h-79.2970844816548)+l*(-15.310361306967817*l+17.575251261109482*u+131.35250912493976*h-190.9453302588951)+u*(4.444339102852739*u+9.8632861493405*h-24.86741582555878)-h*(20.737325471181034*h+187.80453709719578),p[r++]=255+c*(.8842522430003296*c+8.078677503112928*l+30.89978309703729*u-.23883238689178934*h-14.183576799673286)+l*(10.49593273432072*
l+63.02378494754052*u+50.606957656360734*h-112.23884253719248)+u*(.03296041114873217*u+115.60384449646641*h-193.58209356861505)-h*(22.33816807309886*h+180.12613974708367);return p},getData:function(p,c,l){if(4<this.numComponents)throw new F("Unsupported color mode");p=this._getLinearizedBlockData(p,c);if(1===this.numComponents&&l){l=p.length;c=new Uint8ClampedArray(3*l);for(var u=0,h=0;h<l;h++){var r=p[h];c[u++]=r;c[u++]=r;c[u++]=r}return c}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(p);
if(4===this.numComponents){if(this._isColorConversionNeeded())return l?this._convertYcckToRgb(p):this._convertYcckToCmyk(p);if(l)return this._convertCmykToRgb(p)}return p}};return y}()})})({get exports(){return D},set exports(I){D=I}});N.JpegImage=D})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(N,D,I){function F(B,p,c){c.set(B.slice(p,p+c.length))}function y(B){const {_malloc:p,_free:c,_lerc_getBlobInfo:l,_lerc_getDataRanges:u,_lerc_decode_4D:h,
asm:r}=B;let d;const t=Object.values(r).find(E=>E&&"buffer"in E&&E.buffer===B.HEAPU8.buffer),G=E=>{E=E.map(m=>(m>>3<<3)+16);var a=E.reduce((m,f)=>m+f),n=p(a);d=new Uint8Array(t.buffer);a=E[0];E[0]=n;for(n=1;n<E.length;n++){const m=E[n];E[n]=E[n-1]+a;a=m}return E};P.getBlobInfo=E=>{var a=new Uint8Array(48),n=new Uint8Array(24);const [m,f,k]=G([E.length,a.length,n.length]);d.set(E,m);d.set(a,f);d.set(n,k);var g=l(m,E.length,f,k,12,3);if(g)throw c(m),Error(`lerc-getBlobInfo: error code is ${g}`);d=new Uint8Array(t.buffer);
F(d,f,a);F(d,k,n);a=new Uint32Array(a.buffer);var b=new Float64Array(n.buffer);const [e,v,,w,C,M,K,x,q,A,H]=a;n={version:e,depthCount:A,width:w,height:C,validPixelCount:K,bandCount:M,blobSize:x,maskCount:q,dataType:v,minValue:b[0],maxValue:b[1],maxZerror:b[2],statistics:[],bandCountWithNoData:H};if(H)return n;if(1===A&&1===M)return c(m),n.statistics.push({minValue:b[0],maxValue:b[1]}),n;g=A*M*8;var Q=new Uint8Array(g),S=new Uint8Array(g);a=m;var z=b=0;let J=!1;d.byteLength<m+2*g?(c(m),J=!0,[a,b,z]=
G([E.length,g,g]),d.set(E,a)):[b,z]=G([g,g]);d.set(Q,b);d.set(S,z);if(g=u(a,E.length,A,M,b,z))throw c(a),J||c(b),Error(`lerc-getDataRanges: error code is ${g}`);d=new Uint8Array(t.buffer);F(d,b,Q);F(d,z,S);E=new Float64Array(Q.buffer);g=new Float64Array(S.buffer);S=n.statistics;for(Q=0;Q<M;Q++)if(1<A){z=E.slice(Q*A,(Q+1)*A);const R=g.slice(Q*A,(Q+1)*A),W=Math.min.apply(null,z),Z=Math.max.apply(null,R);S.push({minValue:W,maxValue:Z,depthStats:{minValues:z,maxValues:R}})}else S.push({minValue:E[Q],
maxValue:g[Q]});c(a);J||c(b);return n};P.decode=(E,a)=>{const {maskCount:n,depthCount:m,bandCount:f,width:k,height:g,dataType:b,bandCountWithNoData:e}=a;var v=O[b],w=k*g;a=new Uint8Array(w*f);v=new Uint8Array(w*m*f*v.size);w=new Uint8Array(f);var C=new Uint8Array(8*f);const [M,K,x,q,A]=G([E.length,a.length,v.length,w.length,C.length]);d.set(E,M);d.set(a,K);d.set(v,x);d.set(w,q);d.set(C,A);if(E=h(M,E.length,n,K,m,k,g,f,b,x,q,A))throw c(M),Error(`lerc-decode: error code is ${E}`);d=new Uint8Array(t.buffer);
F(d,x,v);F(d,K,a);E=null;if(e){F(d,q,w);F(d,A,C);E=[];C=new Float64Array(C.buffer);for(let H=0;H<w.length;H++)E.push(w[H]?C[H]:null)}c(M);return{data:v,maskData:a,noDataValues:E}}}const O=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",
size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let V=null,L=!1;const P={getBlobInfo:null,decode:null};D.decode=function(B,p={}){var c=p.inputOffset??0;B=B instanceof Uint8Array?B.subarray(c):new Uint8Array(B,c);c=P.getBlobInfo(B);const {data:l,maskData:u,noDataValues:h}=P.decode(B,c),{width:r,height:d,bandCount:t,
depthCount:G,dataType:E,maskCount:a,statistics:n}=c;var m=O[E],f=new m.ctor(l.buffer);B=[];c=[];const k=r*d;var g=k*G;for(var b=0;b<t;b++){var e=f.subarray(b*g,(b+1)*g);if(p.returnInterleaved)B.push(e);else{a:{var v=k,w=G;if(2>w)break a;const C=new m.ctor(v*w);for(let M=0,K=0;M<v;M++)for(let x=0,q=M;x<w;x++,q+=v)C[q]=e[K++];e=C}B.push(e)}c.push(u.subarray(b*g,(b+1)*g))}f=0===a?null:1===a?c[0]:new Uint8Array(k);if(1<a)for(f.set(c[0]),g=1;g<c.length;g++)for(b=c[g],e=0;e<k;e++)f[e]&=b[e];({noDataValue:p}=
p);g=null!=p&&m.range[0]<=p&&m.range[1]>=p;if(0<a&&g)for(g=0;g<t;g++)for(b=B[g],e=c[g]||f,v=0;v<k;v++)0===e[v]&&(b[v]=p);({pixelType:m}=m);return{width:r,height:d,bandCount:t,pixelType:m,depthCount:G,statistics:n,pixels:B,mask:f,bandMasks:a===t&&1<t?c:null,noDataValues:h}};D.getBlobInfo=function(B,p={}){B=B instanceof Uint8Array?B.subarray(p.inputOffset??0):new Uint8Array(B,p.inputOffset??0);return P.getBlobInfo(B)};D.isLoaded=function(){return L};D.load=function(){return V?V:V=(new Promise((B,p)=>
N(["../../../chunks/lerc-wasm"],B,p))).then(B=>B.lercWasm).then(({default:B})=>B({locateFile:p=>I.getAssetUrl(`esri/layers/support/rasterFormats/${p}`)})).then(B=>{y(B);L=!0})};D.pixelTypeInfoMap=O;Object.defineProperty(D,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(N){function D(O,V,L,P=!0){if(0!==V%4||0!==L%4){var B=new ArrayBuffer(4*Math.ceil(L/4));B=new Uint8Array(B);O=new Uint8Array(O,V,L);if(P)for(P=0;P<B.length;P+=4)B[P]=
O[P+3],B[P+1]=O[P+2],B[P+2]=O[P+1],B[P+3]=O[P];else B.set(O);return new Uint32Array(B.buffer)}if(P){P=new Uint8Array(O,V,L);B=new Uint8Array(P.length);for(O=0;O<B.length;O+=4)B[O]=P[O+3],B[O+1]=P[O+2],B[O+2]=P[O+1],B[O+3]=P[O];return new Uint32Array(B.buffer)}return new Uint32Array(O,V,L/4)}function I(){const O=[];for(let V=0;257>=V;V++)O[V]=[V];return O}function F(O,V){for(let L=0;L<V.length;L++)O.push(V[L])}const y=new Set;y.add(511);y.add(1023);y.add(2047);y.add(4095);y.add(8191);N.decode=function(O,
V,L,P=!0){O=D(O,V,L,P);V=9;P=I();let B=32,p=P.length,c=[],l=1,u=O[0],h=0;const r=O.length;L=8*(4*r-L);const d=[];for(;null!=u;){if(B>=V)B-=V,h=u>>>32-V,u<<=V;else{h=u>>>32-B;u=O[l++];var t=V-B;B=32-t;h=(h<<t)+(u>>>B);u<<=t}if(257===h)break;if(256===h)V=9,P=I(),p=P.length,c=[];else{t=P[h];if(null==t){if(h>P.length)throw Error("data integrity issue: code does not exist on code page");c.push(c[0]);P[p++]=c.slice();F(d,c)}else F(d,t),c.push(t[0]),1<c.length&&(P[p++]=c.slice()),c=t.slice();y.has(p)&&V++;
0===B&&(u=O[l++],B=32);if(l>r||l===r&&B<=L)break}}return new Uint8Array(d)};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(N){const D=I=>{let F=1;switch(I){case Uint8Array:case Int8Array:F=1;break;case Uint16Array:case Int16Array:F=2;break;case Uint32Array:case Int32Array:case Float32Array:F=4;break;case Float64Array:F=8}return F};return function(){function I(){}I.decode=
function(F,y){var O=y.pixelType;const V=[],L=y.width*y.height;var P=Math.floor(F.byteLength/(y.width*y.height*D(y.pixelType)));const {bandIds:B,format:p}=y;y=B&&B.length||Math.floor(F.byteLength/(y.width*y.height*D(y.pixelType)));var c=F.byteLength-F.byteLength%(L*D(O)),l=new O(F,0,L*P);let u,h,r,d,t=null;if("bip"===p)for(u=0;u<y;u++){r=new O(L);d=B?B[u]:u;for(h=0;h<L;h++)r[h]=l[h*P+d];V.push(r)}else if("bsq"===p)for(u=0;u<y;u++)d=B?B[u]:u,V.push(l.subarray(d*L,(d+1)*L));if(c<F.byteLength-1)if(F=
F.slice(c),8*F.byteLength<L)t=null;else{F=new Uint8Array(F,0,Math.ceil(L/8));O=new Uint8Array(L);for(c=l=c=y=P=0;c<F.length-1;c++)for(y=F[c],l=7;0<=l;l--)O[P++]=y>>l&1;for(l=7;P<L-1;)y=F[F.length-1],O[P++]=y>>l&1,l--;t=O}return{pixels:V,mask:t}};return N._createClass(I)}()})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(N,D,
I,F,y,O,V,L,P){function B(q,A){let H="unknown";3===q?H=64===A?"f64":"f32":1===q?1===A?H="u1":2===A?H="u2":4===A?H="u4":8>=A?H="u8":16>=A?H="u16":32>=A&&(H="u32"):2===q&&(8>=A?H="s8":16>=A?H="s16":32>=A&&(H="s32"));return H}function p(q){let A=null;switch(q?q.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":A=Uint8Array;break;case "u16":A=Uint16Array;break;case "u32":A=Uint32Array;break;case "s8":A=Int8Array;break;case "s16":A=Int16Array;break;case "s32":A=Int32Array;break;case "f64":A=
Float64Array;break;default:A=Float32Array}return A}function c(q,A){return{x:A[0]*q.x+A[1]*q.y+A[2],y:A[3]*q.x+A[4]*q.y+A[5]}}function l(q,A){return q.get(A)?.values?.[0]}function u(q,A,H,Q=0,S=V.TIFF_TAGS,z=4){var J=8===z;const R=J?g(new DataView(q,H,8),0,A):(new DataView(q,H,2)).getUint16(0,A),W=4+2*z;var Z=J?8:2;J=Z+R*W;if(H+J>q.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:J};const Y=H+J+4<=q.byteLength?b(new DataView(q,H+J,8===z?8:4),0,A,8===z):null;H+=Z;Z=new Map;let X,
T,U,aa=0,ba=0;for(let ja=0;ja<R;ja++){var fa=new DataView(q,H+W*ja,W);X=fa.getUint16(0,A);U=fa.getUint16(2,A);T=V.getTagName(X,S);const ia=[];2===z?(aa=fa.getUint16(4,A),ba=fa.getUint16(6,A)):4===z?(aa=fa.getUint32(4,A),ba=fa.getUint32(8,A)):8===z&&(aa=b(fa,4,A,!0),ba=b(fa,12,A,!0),ia.push(fa.getUint32(12,A)),ia.push(fa.getUint32(16,A)));fa={id:X,type:U,valueCount:aa,valueOffset:ba,valueOffsets:ia,values:null};E(q,A,fa,Q,!1,z);Z.set(T,fa)}return{success:!0,ifd:Z,nextIFD:Y,requiredBufferSize:J}}function h(q,
A){if(1!==A&&2!==A&&4!==A)return q;const H=new Uint8Array(q),Q=8/A;q=new Uint8Array(q.byteLength*Q);let S=0;const z=2**A-1;for(let J=0;J<H.length;J++){const R=H[J];for(let W=0;W<Q;W++)q[S++]=R<<A*W>>>8-A&z}return q.buffer}function r(q,A,H){const Q=new I.JpegImage;Q.parse(q);Q.colorTransform=6===H?-1:0;q=Q.getData(Q.width,Q.height,1!==A);return new Uint8Array(q.buffer)}function d(q){q=(new P.Zlib(q)).getBytes();var A=new ArrayBuffer(q.length);A=new Uint8Array(A);A.set(q);return A}async function t(q,
A,H,Q,S){var z=L.isPlatformLittleEndian===A,J=l(H,"BITSPERSAMPLE"),R=l(H,"SAMPLESPERPIXEL");const W=l(H,"PHOTOMETRICINTERPRETATION");var Z=l(H,"SAMPLEFORMAT")??1;const Y=B(Z,J);var X=l(H,"COMPRESSION")??1;Z=p(Y);if(34887===X)return await F.load(),F.decode(q,{inputOffset:Q}).pixels[0];if(1===X)R=q.slice(Q,Q+S),A=new Uint8Array(R);else if(8===X||32946===X)A=new Uint8Array(q,Q,S),A=d(A),R=A.buffer;else if(6===X)A=new Uint8Array(q,Q,S),A=r(A,R,W),R=A.buffer;else if(7===X){X=H.get("JPEGTABLES").values;
H=X.length-2;A=new Uint8Array(H+S-2);for(let T=0;T<H;T++)A[T]=X[T];q=new Uint8Array(q,Q+2,S-2);for(Q=0;Q<q.length;Q++)A[H+Q]=q[Q];A=r(A,R,W);R=A.buffer}else if(5===X)A=y.decode(q,Q,S,A),R=A.buffer;else throw Error("tiff-decode: unsupport compression "+X);R=h(R,J);if("u8"!==Y&&"s8"!==Y&&!z)switch(R=new ArrayBuffer(A.length),z=new Uint8Array(R),Y){case "u16":case "s16":for(J=0;J<A.length;J+=2)z[J]=A[J+1],z[J+1]=A[J];break;case "u32":case "s32":case "f32":for(J=0;J<A.length;J+=4)z[J]=A[J+3],z[J+1]=A[J+
2],z[J+2]=A[J+1],z[J+3]=A[J]}return new Z(R)}async function G(q,A,H){const Q=H.get("TILEOFFSETS")?.values;if(void 0===Q)return null;const S=H.get("TILEBYTECOUNTS")?.values,{width:z,height:J,pixelType:R,tileWidth:W,tileHeight:Z}=a([H]);var Y=n(H,A);const X=l(H,"SAMPLESPERPIXEL")||A.planes;var T=z*J,U=l(H,"BITSPERSAMPLE"),aa=34887===(l(H,"COMPRESSION")??1),ba=p(R);const fa=[];for(var ja=0;ja<X;ja++)fa.push(new ba(T));let ia,pa,ma,sa,oa,wa,ta,ua;T=Math.ceil(z/W);if(0===U%8)if(aa&&Y&&1<X)for(Y=Math.round(Q.length/
X),U=0;U<Y;U++){var va=Math.floor(U/T)*Z;ma=U%T*W;ba=va*z+ma;for(aa=0;aa<X;aa++)if(ja=U*X+aa,0!==S[ja])for(ja=await t(q,A.littleEndian,H,Q[ja],S[ja]),oa=0,sa=ba,ta=Math.min(W,z-ma),wa=Math.min(Z,J-va),ua=fa[aa],ia=0;ia<wa;ia++)for(sa=ba+ia*z,oa=ia*W,pa=0;pa<ta;pa++,sa++,oa++)ua[sa]=ja[oa]}else for(U=0;U<Q.length;U++)if(0!==S[U])for(va=Math.floor(U/T)*Z,ma=U%T*W,ba=va*z+ma,ja=await t(q,A.littleEndian,H,Q[U],S[U]),oa=0,sa=ba,ta=Math.min(W,z-ma),wa=Math.min(Z,J-va),va=0;va<X;va++)if(ua=fa[va],Y||aa)for(ia=
0;ia<wa;ia++)for(sa=ba+ia*z,oa=W*Z*va+ia*W,pa=0;pa<ta;pa++,sa++,oa++)ua[sa]=ja[oa];else for(ia=0;ia<wa;ia++)for(sa=ba+ia*z,oa=ia*W*X+va,pa=0;pa<ta;pa++,sa++,oa+=X)ua[sa]=ja[oa];return{width:z,height:J,pixelType:R,pixels:fa}}function E(q,A,H,Q=0,S=!1,z=4){if(H.values)return!0;var J=H.type,R=H.valueCount,W=H.valueOffset;let Z=[];var Y=C[J],X=8*Y,T=R*Y,U=R*C[J]*8,aa=8===z?64:32;z=H.valueOffsets;if(U>aa&&T>(S?q.byteLength:q?q.byteLength-W+Q:0))return H.offlineOffsetSize=[W,T],H.values=null,!1;if(U<=aa)if(A||
(32>=aa?W>>>=32-U:(q=z?.length?z[0]:W>>>0,A=z?.length?z[1]:Math.round((W-q)/4294967296),32>=U?(W=q>>>32-U,z[0]=W):(W=q*2**(32-U)+(A>>>32-U),z[0]=q,z[1]=A>>>32-U))),1===R&&X===aa)Z=[W];else if(64===aa)for(q=z?.length?z[0]:W>>>0,W=z?.length?z[1]:Math.round((W-q)/4294967296),A=q,Y=32,q=1;q<=R;q++)T=32-X*q%32,Y<X?(T=A<<T>>>32-Y,U=W<<32-Y>>>32-Y,A=W,Z.push(T+U*2**(X-Y)),Y-=32-(X-Y)):(Z.push(A<<T>>>32-X),Y-=X),0===Y&&(Y=32,A=W);else for(q=1;q<=R;q++)Z.push(W<<32-X*q>>>32-X);else for(W-=Q,S&&(W=0),R=W;R<
W+T;R+=Y){switch(J){case 1:X=(new DataView(q,R,1)).getUint8(0);break;case 2:X=(new DataView(q,R,1)).getUint8(0);break;case 3:X=(new DataView(q,R,2)).getUint16(0,A);break;case 4:case 13:X=(new DataView(q,R,4)).getUint32(0,A);break;case 5:X=(new DataView(q,R,4)).getUint32(0,A)/(new DataView(q,R+4,4)).getUint32(0,A);break;case 6:X=(new DataView(q,R,1)).getInt8(0);break;case 7:X=(new DataView(q,R,1)).getUint8(0);break;case 8:X=(new DataView(q,R,2)).getInt16(0,A);break;case 9:X=(new DataView(q,R,4)).getInt32(0,
A);break;case 10:X=(new DataView(q,R,4)).getInt32(0,A)/(new DataView(q,R+4,4)).getInt32(0,A);break;case 11:X=(new DataView(q,R,4)).getFloat32(0,A);break;case 12:X=(new DataView(q,R,8)).getFloat64(0,A);break;case 16:case 18:X=g(new DataView(q,R,8),0,A);break;case 17:z=new DataView(q,R,8);U=(X=A)?z.getInt32(0,X):z.getUint32(0,X);z=X?z.getUint32(4,X):z.getInt32(4,X);aa=0<=(X?U:z)?1:-1;X?U*=aa:z*=aa;X=aa*(X?4294967296*z+U:4294967296*U+z);break;default:X=null}Z.push(X)}if(2===J){J="";W=Z;Z=[];for(q=0;q<
W.length;q++)0===W[q]&&""!==J?(Z.push(J),J=""):J+=String.fromCharCode(W[q]);""===J&&0!==Z.length||Z.push(J)}H.values=Z;return!0}function a(q){var A=q[0];const H=l(A,"TILEWIDTH"),Q=l(A,"TILELENGTH"),S=l(A,"IMAGEWIDTH"),z=l(A,"IMAGELENGTH");var J=l(A,"BITSPERSAMPLE");const R=l(A,"SAMPLESPERPIXEL");var W=l(A,"SAMPLEFORMAT")??1;const Z=B(W,J),Y=n(A);var X=A.get("GDAL_NODATA")?.values;let T=null;X?.length&&(T=X.map(va=>parseFloat(va)),T.some(va=>isNaN(va))&&(T=null));var U=l(A,"COMPRESSION")??1;switch(U){case 1:X=
"NONE";break;case 2:case 3:case 4:case 32771:X="CCITT";break;case 5:X="LZW";break;case 6:case 7:X="JPEG";break;case 32773:X="PACKBITS";break;case 8:case 32946:X="DEFLATE";break;case 34712:X="JPEG2000";break;case 34887:X="LERC";break;default:X=String(U)}let aa=!0,ba="";M.has(U)||(aa=!1,ba+="unsupported tag compression "+U);3<W&&(aa=!1,ba+="unsupported tag sampleFormat "+W);1!==J&&2!==J&&4!==J&&0!==J%8&&(aa=!1,ba+="unsupported tag bitsPerSample "+J);J=A.get("GEOASCIIPARAMS")?.values?.[0];if(J){var fa=
(fa=J.split("|").find(va=>va.includes("ESRI PE String \x3d ")))?fa.replace("ESRI PE String \x3d ",""):"";fa=fa.startsWith("COMPD_CS")||fa.startsWith("PROJCS")||fa.startsWith("GEOGCS")?{wkid:null,wkt:fa}:null}W=A.get("GEOTIEPOINTS")?.values;J=A.get("GEOPIXELSCALE")?.values;U=A.get("GEOTRANSMATRIX")?.values;var ja=A.has("GEOKEYDIRECTORY")?A.get("GEOKEYDIRECTORY").data:null,ia=!1;A=!1;if(ja){ia=2===l(ja,"GTRasterTypeGeoKey");var pa=l(ja,"GTModelTypeGeoKey");2===pa?(ja=l(ja,"GeographicTypeGeoKey"),1024<=
ja&&32766>=ja&&(fa={wkid:ja}),fa||32767!==ja||(A=!0,fa={wkid:4326})):1===pa&&(ja=l(ja,"ProjectedCSTypeGeoKey"),1024<=ja&&32766>=ja&&(fa={wkid:ja}))}let ma;J&&W&&6<=W.length?(ma=[J[0],0,W[3]-W[0]*J[0],0,-Math.abs(J[1]),W[4]-W[1]*J[1]],ia&&(ma[2]-=.5*ma[0]+.5*ma[1],ma[5]-=.5*ma[3]+.5*ma[4])):U&&16===U.length&&(ma=ia?[U[0],U[1],U[3]-.5*U[0],U[4],U[5],U[7]-.5*U[5]]:[U[0],U[1],U[3],U[4],U[5],U[7]]);if(ma){W=[{x:0,y:z},{x:0,y:0},{x:S,y:z},{x:S,y:0}];ja=ia=Number.POSITIVE_INFINITY;let va=pa=Number.NEGATIVE_INFINITY;
for(let qa=0;qa<W.length;qa++)U=c(W[qa],ma),ia=U.x>ia?ia:U.x,pa=U.x<pa?pa:U.x,ja=U.y>ja?ja:U.y,va=U.y<va?va:U.y;W={xmin:ia,xmax:pa,ymin:ja,ymax:va,spatialReference:fa}}else W={xmin:-.5,ymin:.5-z,xmax:S-.5,ymax:.5,spatialReference:fa};A&&(400<W.xmax-W.xmin||361<Math.max(Math.abs(W.xmin),Math.abs(W.xmax)))&&(fa=null,W.spatialReference=null);fa=m(q);let sa;let oa,wa;if(0<fa.length){oa=Math.round(Math.log(S/l(fa[0],"IMAGEWIDTH"))/Math.LN2);var ta=fa[fa.length-1];wa=Math.round(Math.log(S/l(ta,"IMAGEWIDTH"))/
Math.LN2);sa=l(ta,"TILEWIDTH");ta=l(ta,"TILELENGTH")}sa=null!=wa&&0<wa?sa||H:null;ta=null!=wa&&0<wa?ta||Q:null;let ua;H&&(ua=[{maxCol:Math.ceil(S/H)-1,maxRow:Math.ceil(z/Q)-1,minRow:0,minCol:0}],fa.forEach(va=>{ua.push({maxCol:Math.ceil(l(va,"IMAGEWIDTH")/l(va,"TILEWIDTH"))-1,maxRow:Math.ceil(l(va,"IMAGELENGTH")/l(va,"TILELENGTH"))-1,minRow:0,minCol:0})}));U=q[0].get("GDAL_METADATA")?.values?.[0];U=x(U);ba+=" "+w({width:S,height:z,tileWidth:H,tileHeight:Q,planes:R,ifds:q});q=f(q).length===fa.length+
1;return{width:S,height:z,tileWidth:H,tileHeight:Q,planes:R,isBSQ:Y,pixelType:Z,compression:X,noData:T,hasMaskBand:q,isSupported:aa,message:ba,extent:W,isPseudoGeographic:A,affine:J?null:ma,firstPyramidLevel:oa,maximumPyramidLevel:wa,pyramidBlockWidth:sa,pyramidBlockHeight:ta,tileBoundary:ua,metadata:U}}function n(q,A){return(q=q.get("PLANARCONFIGURATION")?.values)?2===q[0]:A?A.isBSQ:!1}function m(q){return q.filter(A=>1===l(A,"NEWSUBFILETYPE"))}function f(q){return q.filter(A=>{const H=4===((l(A,
"NEWSUBFILETYPE")??0)&4);A=4===l(A,"PHOTOMETRICINTERPRETATION");return H&&A})}function k(q){const {littleEndian:A,isBigTiff:H,firstIFDPos:Q}=e(q);var S=Q;const z=[];do if(S=v(q,A,S,0,V.TIFF_TAGS,H?8:4),S.success)z.push(S.ifd),S=S.nextIFD;else break;while(0<S);q=a(z);S=m(z);const J=f(z);return{...q,littleEndian:A,isBigTiff:H,ifds:z,pyramidIFDs:S,maskIFDs:J}}function g(q,A,H){const Q=q.getUint32(A,H);q=q.getUint32(A+4,H);return H?4294967296*q+Q:4294967296*Q+q}function b(q,A,H,Q){return Q?g(q,A,H):q.getUint32(A,
H)}function e(q){var A=new DataView(q,0,16),H=A.getUint16(0,!1);q=null;if(18761===H)q=!0;else if(19789===H)q=!1;else throw Error("unexpected endianess byte");var Q=A.getUint16(2,q);if(42!==Q&&43!==Q)throw Error("unexpected tiff identifier");H=4;if(Q=43===Q){const S=A.getUint16(H,q);H+=2;if(8!==S)throw Error("unsupported bigtiff version");if(0!==A.getUint16(H,q))throw Error("unsupported bigtiff version");H+=2}A=b(A,H,q,Q);return{littleEndian:q,isBigTiff:Q,firstIFDPos:A}}function v(q,A,H,Q=0,S=V.TIFF_TAGS,
z=4){H=u(q,A,H,Q,S,z);let J;const R=H.ifd;R&&(V.ifdTags.forEach((W,Z)=>{R.has(Z)&&(J=R.get(Z),J.data=u(q,A,J.valueOffset-Q,Q,W).ifd)}),R.has("GEOKEYDIRECTORY")&&(J=R.get("GEOKEYDIRECTORY"),(S=J.values)&&4<S.length&&(S=S[0]+"."+S[1]+"."+S[2],J.data=u(q,A,J.valueOffset+6-Q,Q,V.GEO_KEYS,2).ifd,J.data&&J.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[S]}))),R.has("XMP")&&(J=R.get("XMP"),S=J.values,"number"===typeof S[0]&&7===J.type&&(J.values=[D.bytesToUTF8(new Uint8Array(S))])));
return H}function w(q){const {width:A,height:H,tileHeight:Q,tileWidth:S}=q,z=q.planes,J=S?S*Q:A*H;q=l(q.ifds[0],"BITSPERSAMPLE");let R="";J*z>2**30/(8<q?q/8:1)&&(R=S?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return R}const C=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],M=new Set([1,5,6,7,8,34712,34887]),K=(q,A,H)=>{if(!(q&&0<q.length&&A&&H))return null;let Q,S,z;const J=q[0].length,R=q.length,W=new Uint8Array(J);for(let Y=0;Y<
R;Y++)if(Q=q[Y],S=A[Y],z=H[Y],0===Y)for(var Z=0;Z<J;Z++)W[Z]=Q[Z]<S||Q[Z]>z?0:1;else for(Z=0;Z<J;Z++)W[Z]&&(W[Z]=Q[Z]<S||Q[Z]>z?0:1);return W},x=q=>{if(!q)return null;var A=q.match(/<Item(.*?)Item>/gi);if(!A||0===A.length)return null;q=new Map;var H;for(var Q=0;Q<A.length;Q++){var S=A[Q];var z=S.slice(6,S.indexOf("\x3e"));var J=S.indexOf("sample\x3d");-1<J&&(H=S.slice(J+8,S.indexOf('"',J+8)));J=S.indexOf("name\x3d");-1<J&&(z=S.slice(J+6,S.indexOf('"',J+6)));z&&(S=S.slice(S.indexOf("\x3e")+1,S.indexOf("\x3c/Item\x3e")).trim(),
null!=H?q.has(z)?q.get(z)[H]=S:q.set(z,[S]):q.set(z,S));H=null}A=q.get("STATISTICS_MINIMUM");z=q.get("STATISTICS_MAXIMUM");Q=q.get("STATISTICS_MEAN");S=q.get("STATISTICS_STDDEV");H=null;if(A&&z)for(H=[],J=0;J<A.length;J++)H.push({min:parseFloat(A[J]),max:parseFloat(z[J]),avg:Q&&parseFloat(Q[J]),stddev:S&&parseFloat(S[J])});z=q.get("BandName");Q=q.get("WavelengthMin");S=q.get("WavelengthMax");A=null;if(z)for(A=[],J=0;J<z.length;J++)A.push({BandName:z[J],WavelengthMin:Q&&parseFloat(Q[J]),WavelengthMax:S&&
parseFloat(S[J])});z=q.get("DataType");return{statistics:H,bandProperties:A,dataType:z,rawMetadata:q}};N.decode=async function(q,A={}){var H=A.pyramidLevel||0,Q=A.headerInfo||k(q);const {ifds:S,noData:z}=Q;if(0===S.length)throw Error("no valid image file directory");var J=w(Q);if(J)throw J;J=null;var R=-1===H?S[S.length-1]:S[H];A=z??A.noDataValue;if(Q.tileWidth)J=await G(q,Q,R);else{{const wa=L.isPlatformLittleEndian===Q.littleEndian,ta=R.get("STRIPOFFSETS")?.values;if(void 0===ta)q=null;else{var {width:W,
height:Z,pixelType:Y}=a([R]);H=l(R,"SAMPLESPERPIXEL")||Q.planes;var X=l(R,"PHOTOMETRICINTERPRETATION");J=W*Z;var T=l(R,"BITSPERSAMPLE"),U=p(Y),aa=new U(J*H),ba=R.get("STRIPBYTECOUNTS")?.values,fa=l(R,"ROWSPERSTRIP"),ja=l(R,"COMPRESSION")??1;var ia=fa;if(0===T%8)for(R=0;R<ta.length;R++){var pa=R*fa*W*H;ia=(R+1)*fa>Z?Z-R*fa:fa;if("u8"===Y||"s8"===Y||wa)if(8===ja||32946===ja){var ma=new Uint8Array(q,ta[R],ba[R]);ma=d(ma);var sa=ma.buffer}else 6===ja?(ma=new Uint8Array(q,ta[R],ba[R]),ma=r(ma,H,X),sa=
ma.buffer):5===ja?(ma=y.decode(q,ta[R],ba[R],Q.littleEndian),sa=ma.buffer):(ba[R]!==ia*W*H*T/8&&console.log("strip byte counts is different than expected"),sa=q.slice(ta[R],ta[R]+ba[R]));else{if(6===ja||8===ja||32946===ja){ma=new Uint8Array(q,ta[R],ba[R]);var oa=d(ma);sa=oa.buffer}else ba[R]!==ia*W*H*T/8&&console.log("strip byte counts is different than expected"),sa=new ArrayBuffer(ba[R]),ma=new Uint8Array(q,ta[R],ba[R]),oa=new Uint8Array(sa);switch(Y){case "u16":case "s16":for(ia=0;ia<ma.length;ia+=
2)oa[ia]=ma[ia+1],oa[ia+1]=ma[ia];break;case "u32":case "s32":case "f32":for(ia=0;ia<ma.length;ia+=4)oa[ia]=ma[ia+3],oa[ia+1]=ma[ia+2],oa[ia+2]=ma[ia+1],oa[ia+3]=ma[ia]}}sa=h(sa,T);ia=new U(sa);aa.set(ia,pa)}X=[];if(1===H)X.push(aa);else for(R=0;R<H;R++){Q=new U(J);for(q=0;q<J;q++)Q[q]=aa[q*H+R];X.push(Q)}q={width:W,height:Z,pixelType:Y,pixels:X}}}J=await q}if(!J)return J;null!=A&&O.convertNoDataToMask(J,A);return J};N.decodeTileOrStrip=async function(q,A){const {headerInfo:H,ifd:Q,offsets:S,sizes:z}=
A;var J=[];for(var R=0;R<S.length;R++){var W=await t(q,H.littleEndian,Q,S[R],z[R]||q.byteLength);J.push(W)}var Z=n(Q,H);q=l(Q,"BITSPERSAMPLE");R=l(Q,"SAMPLEFORMAT")??1;R=B(R,q);var Y=l(Q,"SAMPLESPERPIXEL")||H.planes;const X=p(R);W=l(Q,"TILEWIDTH");const T=l(Q,"TILELENGTH");var U=l(Q,"COMPRESSION")??1;const aa=W*T;q=[];let ba=J[0];const fa=34887===U;for(let ia=0;ia<Y;ia++){U=new X(aa);if(Z&&fa){if(ba=J[ia],ba.length)for(var ja=0;ja<aa;ja++)U[ja]=ba[ia][ja+ia]}else if(ba.length)if(Z||fa&&!Z)U=ba.slice(aa*
ia,aa*(ia+1));else for(ja=0;ja<aa;ja++)U[ja]=ba[ja*Y+ia];q.push(U)}J=H.noData?H.noData[0]:A.noDataValue;Z=(Y=H.metadata?H.metadata.statistics:null)?Y.map(ia=>ia.min):null;Y=Y?Y.map(ia=>ia.max):null;R={pixelType:R,width:W,height:T,pixels:q,noDataValue:J};null!=J?O.convertNoDataToMask(R,J):Z&&Y&&A.applyMinMaxConstraint&&(R.mask=K(q,Z,Y));return R};N.getImageInfo=a;N.getMaskIFDs=f;N.getPyramidIFDs=m;N.isBSQConfig=n;N.parseFieldValues=E;N.parseHeader=k;N.parseIFD=v;N.parseSignature=e;Object.defineProperty(N,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],function(N){N.bytesToUTF8=function(D,I){let F=0,y="",O=0,V=0;const L=D.length;for(;F<L;)if(V=D[F++],O=V>>4,8>O?O=1:15===O?(O=4,V=(V&7)<<18|(D[F++]&63)<<12|(D[F++]&63)<<6|D[F++]&63):14===O?(O=3,V=(V&15)<<12|(D[F++]&63)<<6|D[F++]&63):(O=2,V=(V&31)<<6|D[F++]&63),0!==V||I)y+=String.fromCharCode(V);return y};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const N=
(()=>{const y=[];y[254]="NEWSUBFILETYPE";y[255]="SUBFILETYPE";y[256]="IMAGEWIDTH";y[257]="IMAGELENGTH";y[258]="BITSPERSAMPLE";y[259]="COMPRESSION";y[262]="PHOTOMETRICINTERPRETATION";y[263]="THRESHHOLDING";y[264]="CELLWIDTH";y[265]="CELLLENGTH";y[266]="FILLORDER";y[269]="DOCUMENTNAME";y[270]="IMAGEDESCRIPTION";y[271]="MAKE";y[272]="MODEL";y[273]="STRIPOFFSETS";y[274]="ORIENTATION";y[277]="SAMPLESPERPIXEL";y[278]="ROWSPERSTRIP";y[279]="STRIPBYTECOUNTS";y[280]="MINSAMPLEVALUE";y[281]="MAXSAMPLEVALUE";
y[282]="XRESOLUTION";y[283]="YRESOLUTION";y[284]="PLANARCONFIGURATION";y[285]="PAGENAME";y[286]="XPOSITION";y[287]="YPOSITION";y[288]="FREEOFFSETS";y[289]="FREEBYTECOUNTS";y[290]="GRAYRESPONSEUNIT";y[291]="GRAYRESPONSECURVE";y[292]="T4OPTIONS";y[293]="T6OPTIONS";y[296]="RESOLUTIONUNIT";y[297]="PAGENUMBER";y[300]="COLORRESPONSEUNIT";y[301]="TRANSFERFUNCTION";y[305]="SOFTWARE";y[306]="DATETIME";y[315]="ARTIST";y[316]="HOSTCOMPUTER";y[317]="PREDICTOR";y[318]="WHITEPOINT";y[319]="PRIMARYCHROMATICITIES";
y[320]="COLORMAP";y[321]="HALFTONEHINTS";y[322]="TILEWIDTH";y[323]="TILELENGTH";y[324]="TILEOFFSETS";y[325]="TILEBYTECOUNTS";y[326]="BADFAXLINES";y[327]="CLEANFAXDATA";y[328]="CONSECUTIVEBADFAXLINES";y[330]="SUBIFD";y[332]="INKSET";y[333]="INKNAMES";y[334]="NUMBEROFINKS";y[336]="DOTRANGE";y[337]="TARGETPRINTER";y[338]="EXTRASAMPLES";y[339]="SAMPLEFORMAT";y[340]="SMINSAMPLEVALUE";y[341]="SMAXSAMPLEVALUE";y[342]="TRANSFERRANGE";y[347]="JPEGTABLES";y[512]="JPEGPROC";y[513]="JPEGIFOFFSET";y[514]="JPEGIFBYTECOUNT";
y[515]="JPEGRESTARTINTERVAL";y[517]="JPEGLOSSLESSPREDICTORS";y[518]="JPEGPOINTTRANSFORM";y[519]="JPEGQTABLES";y[520]="JPEGDCTABLES";y[521]="JPEGACTABLES";y[529]="YCBCRCOEFFICIENTS";y[530]="YCBCRSUBSAMPLING";y[531]="YCBCRPOSITIONING";y[532]="REFERENCEBLACKWHITE";y[700]="XMP";y[33550]="GEOPIXELSCALE";y[33922]="GEOTIEPOINTS";y[33432]="COPYRIGHT";y[42112]="GDAL_METADATA";y[42113]="GDAL_NODATA";y[50844]="RPCCOEFFICIENT";y[34264]="GEOTRANSMATRIX";y[34735]="GEOKEYDIRECTORY";y[34736]="GEODOUBLEPARAMS";y[34737]=
"GEOASCIIPARAMS";y[34665]="EXIFIFD";y[34853]="GPSIFD";y[40965]="INTEROPERABILITYIFD";return y})(),D=(()=>{const y=N.slice();y[36864]="ExifVersion";y[40960]="FlashpixVersion";y[40961]="ColorSpace";y[42240]="Gamma";y[37121]="ComponentsConfiguration";y[37122]="CompressedBitsPerPixel";y[40962]="PixelXDimension";y[40963]="PixelYDimension";y[37500]="MakerNote";y[37510]="UserComment";y[40964]="RelatedSoundFile";y[36867]="DateTimeOriginal";y[36868]="DateTimeDigitized";y[36880]="OffsetTime";y[36881]="OffsetTimeOriginal";
y[36882]="OffsetTimeDigitized";y[37520]="SubSecTime";y[37521]="SubSecTimeOriginal";y[37522]="SubSecTimeDigitized";y[37888]="Temperature";y[37889]="Humidity";y[37890]="Pressure";y[37891]="WaterDepth";y[37892]="Acceleration";y[37893]="CameraElevationAngle";y[42016]="ImageUniqueID";y[42032]="CameraOwnerName";y[42033]="BodySerialNumber";y[42034]="LensSpecification";y[42035]="LensMake";y[42036]="LensModel";y[42037]="LensSerialNumber";y[33434]="ExposureTime";y[33437]="FNumber";y[34850]="ExposureProgram";
y[34852]="SpectralSensitivity";y[34855]="PhotographicSensitivity";y[34856]="OECF";y[34864]="SensitivityType";y[34865]="StandardOutputSensitivity";y[34866]="RecommendedExposureIndex";y[34867]="ISOSpeed";y[34868]="ISOSpeedLatitudeyyy";y[34869]="ISOSpeedLatitudezzz";y[37377]="ShutterSpeedValue";y[37378]="ApertureValue";y[37379]="BrightnessValue";y[37380]="ExposureBiasValue";y[37381]="MaxApertureValue";y[37382]="SubjectDistance";y[37383]="MeteringMode";y[37384]="LightSource";y[37385]="Flash";y[37386]=
"FocalLength";y[37396]="SubjectArea";y[41483]="FlashEnergy";y[41484]="SpatialFrequencyResponse";y[41486]="FocalPlaneXResolution";y[41487]="FocalPlaneYResolution";y[41488]="FocalPlaneResolutionUnit";y[41492]="SubjectLocation";y[41493]="ExposureIndex";y[41495]="SensingMethod";y[41728]="FileSource";y[41729]="SceneType";y[41730]="CFAPattern";y[41985]="CustomRendered";y[41986]="ExposureMode";y[41987]="WhiteBalance";y[41988]="DigitalZoomRatio";y[41989]="FocalLengthIn35mmFilm";y[41990]="SceneCaptureType";
y[41991]="GainControl";y[41992]="Contrast";y[41993]="Saturation";y[41994]="Sharpness";y[41995]="DeviceSettingDescription";y[41996]="SubjectDistanceRange";return y})(),I=(()=>{const y=[];y[1024]="GTModelTypeGeoKey";y[1025]="GTRasterTypeGeoKey";y[1026]="GTCitationGeoKey";y[2048]="GeographicTypeGeoKey";y[2049]="GeogCitationGeoKey";y[2050]="GeogGeodeticDatumGeoKey";y[2051]="GeogPrimeMeridianGeoKey";y[2052]="GeogLinearUnitsGeoKey";y[2053]="GeogLinearUnitSizeGeoKey";y[2054]="GeogAngularUnitsGeoKey";y[2055]=
"GeogAngularUnitSizeGeoKey";y[2056]="GeogEllipsoidGeoKey";y[2057]="GeogSemiMajorAxisGeoKey";y[2058]="GeogSemiMinorAxisGeoKey";y[2059]="GeogInvFlatteningGeoKey";y[2061]="GeogPrimeMeridianLongGeoKey";y[2060]="GeogAzimuthUnitsGeoKey";y[3072]="ProjectedCSTypeGeoKey";y[3073]="PCSCitationGeoKey";y[3074]="ProjectionGeoKey";y[3075]="ProjCoordTransGeoKey";y[3076]="ProjLinearUnitsGeoKey";y[3077]="ProjLinearUnitSizeGeoKey";y[3078]="ProjStdParallel1GeoKey";y[3079]="ProjStdParallel2GeoKey";y[3080]="ProjNatOriginLongGeoKey";
y[3081]="ProjNatOriginLatGeoKey";y[3082]="ProjFalseEastingGeoKey";y[3083]="ProjFalseNorthingGeoKey";y[3084]="ProjFalseOriginLongGeoKey";y[3085]="ProjFalseOriginLatGeoKey";y[3086]="ProjFalseOriginEastingGeoKey";y[3087]="ProjFalseOriginNorthingGeoKey";y[3088]="ProjCenterLongGeoKey";y[3090]="ProjCenterEastingGeoKey";y[3091]="ProjCenterNorthingGeoKey";y[3092]="ProjScaleAtNatOriginGeoKey";y[3093]="ProjScaleAtCenterGeoKey";y[3094]="ProjAzimuthAngleGeoKey";y[3095]="ProjStraightVertPoleLongGeoKey";y[4096]=
"VerticalCSTypeGeoKey";y[4097]="VerticalCitationGeoKey";y[4098]="VerticalDatumGeoKey";y[4099]="VerticalUnitsGeoKey";return y})(),F=new Map;F.set("EXIFIFD",D);F.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{TIFF_TAGS:N,ifdTags:F,GEO_KEYS:I,getTagName:(y,O)=>{O=(O||N)[y];void 0===O&&(O="unknown"+String(y));return O}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(N){const D=new ArrayBuffer(4),I=new Uint8Array(D);(new Uint32Array(D))[0]=1;N.isPlatformLittleEndian=1===I[0];Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./AspectFunction ./BandArithmeticFunction ./ColormapFunction ./CompositeBandFunction ./ConvolutionFunction ./ExtractBandFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./SlopeFunction ./StatisticsHistogramFunction ./StretchFunction".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d){function t(w,C){({rasterFunctionArguments:w}=w);w&&(w.rasters||[w.raster]).forEach(M=>{M&&"number"!==typeof M&&("string"===typeof M?M.startsWith("http")&&(C.includes(M)||C.push(M)):"rasterFunctionArguments"in M&&t(M,C))})}function G(w,C){return"rasters"===C[0]&&Array.isArray(w.rasters)?w.rasters:C.map(M=>w[M])}function E(w){return!!(w&&"object"===typeof w&&w.rasterFunction&&w.rasterFunctionArguments)}function a(w){const {rasterFunction:C,rasterFunctionArguments:M}=
w,K={};for(const q in M){let A=M[q];var x=q.toLowerCase();if("rasters"===x&&Array.isArray(A))K.rasters=A.map(H=>E(H)?a(H):H);else switch(E(A)&&(A=a(A)),x){case "dra":K.dra=A;break;case "pspower":K.psPower=A;break;case "pszfactor":K.psZFactor=A;break;case "bandids":K.bandIds=A;break;default:x=q[0].toLowerCase()+q.slice(1),K[x]=A}}"Local"!==C||K.rasters?.length||(K.rasters=["$$"]);return{...w,rasterFunctionArguments:K}}function n(w,C){const {rasterFunction:M,rasterFunctionArguments:K}=w;var x=w.outputPixelType?.toLowerCase();
if(null==M||!v.has(M))throw new I("raster-function-helper",`unsupported raster function: ${M}`);var q=v.get(M);w=("function"===typeof q.ctor?q.ctor:q.ctor["default"]).fromJSON({...w,outputPixelType:x});({rasterArgumentNames:x}=w);q=[];const A=G(K,x),H="rasters"===x[0],Q=[];for(let S=0;S<A.length;S++){const z=A[S];let J;null==z||"string"===typeof z&&z.startsWith("$")?q.push(C?.raster):"string"===typeof z?C[z]&&q.push(C[z]):"number"!==typeof z&&"rasterFunction"in z&&(J=n(z,C),H||(w.functionArguments[x[S]]=
J),q.push(J));H&&Q.push(J??z)}H&&(w.functionArguments.rasters=Q);C&&(w.sourceRasters=q,C=C.raster?.url)&&(w.mainPrimaryRasterId=C);return w}function m(w,C){if(w&&C)for(const M in w){const K=w[M];K&&"object"===typeof K&&(K.function&&K.arguments?m(K.arguments,C):"RasterFunctionVariable"===K.type&&null!=C[K.name]&&(K.value=C[K.name]))}}function f(w){if(!w||"object"!==typeof w)return w;if(Array.isArray(w)&&0===w.length)return 0===w.length?null:["number","string"].includes(typeof w[0])?w:w.map(C=>f(C));
if("value"in w&&["number","string","boolean"].includes(typeof w.value))return w.value;if(!("type"in w))return w;switch(w.type){case "Scalar":return w.value;case "AlgorithmicColorRamp":return k(w);case "MultiPartColorRamp":return{type:"multipart",colorRamps:w.ArrayOfColorRamp.map(k)};case "ArgumentArray":return w.elements?.length&&"RasterStatistics"!==w.elements[0].type?"RasterFunctionVariable"===w.elements[0].type?w.elements.map(C=>null!=C.value?f(C.value):C.name.toLowerCase().includes("raster")?
"$$":null):w:w.elements;default:return w}}function k(w){const C=w.algorithm??"esriHSVAlgorithm";let {FromColor:M,ToColor:K}=w;if(!Array.isArray(M)){const {r:x,g:q,b:A}=D.toRGB({h:M.Hue,s:M.Saturation,v:M.Value});M=[x,q,A,M.AlphaValue]}if(!Array.isArray(K)){const {r:x,g:q,b:A}=D.toRGB({h:K.Hue,s:K.Saturation,v:K.Value});K=[x,q,A,K.AlphaValue]}return{type:"algorithmic",algorithm:C,fromColor:M,toColor:K}}function g(w,C){if(w&&C){var {function:M,arguments:K}=w;if(M&&K){C.rasterFunction=M.type.replace("Function",
"");C.outputPixelType=M.pixelType;w={};C.rasterFunctionArguments=w;for(const x in K){const q=K[x];"object"===typeof q&&("function"in q&&q.function&&q.arguments?(C.rasterFunctionArguments[x]={},g(q,C.rasterFunctionArguments[x])):"value"in q&&(w[x]=f(q.value)))}w.DEM&&!w.Raster&&(w.Raster=w.DEM,delete w.DEM);switch(C.rasterFunction){case "Stretch":b(w);break;case "Colormap":"randomcolorramp"===w.ColorRamp?.type?.toLowerCase()&&(delete w.ColorRamp,w.ColormapName="Random");0===w.ColorSchemeType&&delete w.ColorRamp;
break;case "Convolution":null!=w.ConvolutionType&&(w.Type=w.ConvolutionType,delete w.ConvolutionType);break;case "Mask":e(w)}}}}function b(w){w.Statistics?.length&&"object"===typeof w.Statistics&&(w.Statistics=w.Statistics.map(C=>[C.min,C.max,C.mean,C.standardDeviation]));null!=w.NumberOfStandardDeviation&&(w.NumberOfStandardDeviations=w.NumberOfStandardDeviation,delete w.NumberOfStandardDeviation)}function e(w){w.NoDataValues?.length&&"string"===typeof w.NoDataValues[0]&&(w.NoDataValues=w.NoDataValues.filter(C=>
""!==C).map(C=>Number(C)))}const v=new Map;v.set("Aspect",{desc:"Aspect Function",ctor:y,rasterArgumentNames:["raster"]});v.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:O,rasterArgumentNames:["raster"]});v.set("Colormap",{desc:"Colormap Function",ctor:V,rasterArgumentNames:["raster"]});v.set("CompositeBand",{desc:"CompositeBand Function",ctor:L,rasterArgumentNames:["rasters"]});v.set("Convolution",{desc:"Convolution Function",ctor:P,rasterArgumentNames:["raster"]});v.set("ExtractBand",
{desc:"ExtractBand Function",ctor:B,rasterArgumentNames:["raster"]});v.set("Local",{desc:"Local Function",ctor:p,rasterArgumentNames:["rasters"]});v.set("Mask",{desc:"Mask Function",ctor:c,rasterArgumentNames:["raster"]});v.set("NDVI",{desc:"NDVI Function",ctor:l,rasterArgumentNames:["raster"]});v.set("Remap",{desc:"Remap Function",ctor:u,rasterArgumentNames:["raster"]});v.set("Slope",{desc:"Slope Function",ctor:h,rasterArgumentNames:["raster"]});v.set("StatisticsHistogram",{desc:"Statistics Histogram Function",
ctor:r,rasterArgumentNames:["raster"]});v.set("Stretch",{desc:"Stretch Function",ctor:d,rasterArgumentNames:["raster"]});N.create=function(w,C){C=C??{};w=F.clone(w);if("function"in w&&"arguments"in w&&w.arguments){C&&m(w,C);const M={};g(w,M);w=M}if("rasterFunction"in w)return w=a(w),n(w,C);throw new I("raster-function-helper","unsupported raster function json.");};N.getPrimaryRasterUrls=t;N.getRasterValues=G;N.getSupportedFunctions=function(){const w=new Set;v.forEach((C,M)=>w.add(M));return w};N.register=
function(w,C,M=["raster"],K=""){v.set(w,{desc:K,ctor:C,rasterArgumentNames:M})};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p){y=function(c){function l(){var h=u.apply(this,arguments);h.functionName="Aspect";h.functionArguments=null;h.rasterArgumentNames=["raster"];h.isGCS=!1;return h}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c._bindSourceRasters=function(){var h=this.sourceRasterInfos[0];this.isGCS=h.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");h=h.clone();h.pixelType=this.outputPixelType;h.statistics=[{min:-1,max:360,avg:180,stddev:30}];
h.histograms=null;h.colormap=null;h.attributeTable=null;h.bandCount=1;this.rasterInfo=h;return{success:!0,supportsGPU:!0}};c._processPixels=function(h){const r=h.pixelBlocks?.[0];if(I.isNone(r))return null;const {extent:d,primaryPixelSizes:t}=h;h=t?.[0];h=I.isNone(h)?d?{x:d.width/r.width,y:d.height/r.height}:{x:1,y:1}:h;return p.aspect(r,{resolution:h})};return N._createClass(l)}(B);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:P,
json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",void 0);D.__decorate([F.property({json:{write:!0}})],y.prototype,"isGCS",void 0);return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.AspectFunction")],y)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L,P){var B;I=B=function(p){function c(){return l.apply(this,arguments)}N._inherits(c,p);var l=N._createSuper(c);c.prototype.clone=function(){return new B({raster:this.raster})};return N._createClass(c)}(P);return I=B=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],I)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(N,D,I,F,y,O,V,L){I=function(P){function B(){var c=p.apply(this,arguments);c.raster=void 0;return c}N._inherits(B,P);var p=N._createSuper(B);return N._createClass(B)}(I.JSONSupport);D.__decorate([F.property({json:{write:!0}})],I.prototype,"raster",void 0);return I=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],I)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p){I=function(c){function l(){var h=u.apply(this,arguments);h.functionArguments=null;h.readingBufferSize=0;h.id=-1;h.isNoopProcess=!1;h.rawInputBandIds=[];h.isInputBandIdsSwizzled=!1;h.swizzledBandSelection=[];h.isBranch=!1;h._bindingResult=null;return h}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c.bind=function(h,r=!1,d=-1){this.id=d+1;d=this._getRasterValues();let t=!0;for(let E=0;E<d.length;E++){var G=d[E];if(F.isSome(G)&&this._isRasterFunctionValue(G)){G=
G.bind(h,r,this.id+E);if(!G.success)return this._bindingResult=G;t=t&&G.supportsGPU}}if(!this.rasterInfo||r)return this.sourceRasterInfos=this._getSourceRasterInfos(h),this._bindingResult=this._bindSourceRasters(),this._bindingResult.supportsGPU=t&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();return this._bindingResult};c.process=function(h){var r=this._getRasterValues();r=0===r.length?h.pixelBlocks??
h.primaryPixelBlocks:r.map(d=>this._readRasterValue(d,h));return this._processPixels({...h,pixelBlocks:r})};c.processInputBandIds=function(){var h=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<h.length)return this.rawInputBandIds=h.map(d=>d.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((d,t)=>d!==t),h=h.filter(d=>"ExtractBand"===d.functionName),h.length&&h.forEach((d,t)=>{d.isInputBandIdsSwizzled=!0;d.swizzledBandSelection=[t,t,t]}),this.rawInputBandIds;
var r=h[0];if(r){if(h=r.processInputBandIds(),r.isInputBandIdsSwizzled)return this.rawInputBandIds=h}else{h=[];({bandCount:r}=this.sourceRasterInfos[0]);for(let d=0;d<r;d++)h.push(d)}h=this._getInputBandIds(h);this.isInputBandIdsSwizzled=h.some((d,t)=>d!==t);return this.rawInputBandIds=h};c.getPrimaryRasters=function(){const h=[],r=[];this._getPrimaryRasters(this,h,r);return{rasters:h,rasterIds:r}};c.getWebGLProcessorDefinition=function(){const h=this._getWebGLParameters(),{raster:r,rasters:d}=this.functionArguments;
d&&Array.isArray(d)&&d.length?(h.rasters=d.map(t=>this._isRasterFunctionValue(t)?t.getWebGLProcessorDefinition():"number"===typeof t?{name:"Constant",parameters:{value:t},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:t},pixelType:"f32",id:-1,isNoopProcess:!1}),h.rasters.some(t=>null!=t)||(h.rasters=null)):this._isRasterFunctionValue(r)&&(h.raster=r.getWebGLProcessorDefinition());return{name:this.functionName,parameters:h,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}};
c._getOutputPixelType=function(h){return"unknown"===this.outputPixelType?h:this.outputPixelType??h};c._getWebGLParameters=function(){return{}};c._getInputBandIds=function(h){return h};c._isOutputRoundingNeeded=function(){const {outputPixelType:h}=this;return(h?.startsWith("u")||h?.startsWith("s"))??!1};c._getRasterValues=function(){const {rasterArgumentNames:h}=this;return"rasters"===h[0]?this.functionArguments.rasters??[]:h.map(r=>this.functionArguments[r])};c._getSourceRasterInfos=function(h){const r=
this._getRasterValues(),{rasterInfos:d,rasterIds:t}=h;if(0===r.length)return d;const G=r.map(a=>{if(a&&"object"===typeof a&&"bind"in a&&a.rasterInfo)return a.rasterInfo;if("string"===typeof a&&t.includes(a))return d[t.indexOf(a)];if("number"!==typeof a)return d[0]}),E=G.find(a=>a)??d[0];G.forEach((a,n)=>{void 0===a&&(G[n]=E)});return G};c._getPrimaryRasterId=function(h){return h?.url};c._getPrimaryRasters=function(h,r=[],d=[]){for(let G=0;G<h.sourceRasters.length;G++){var t=h.sourceRasters[G];if("number"!==
typeof t)if("bind"in t)this._getPrimaryRasters(t,r,d);else{const E=this._getPrimaryRasterId(t);null==E||d.includes(E)||(this.mainPrimaryRasterId===E?(r.unshift(t),d.unshift(E)):(r.push(t),d.push(E)))}}};c._isRasterFunctionValue=function(h){return null!=h&&"object"===typeof h&&"getWebGLProcessorDefinition"in h};c._readRasterValue=function(h,r){var {primaryPixelBlocks:d}=r;if(F.isNone(h)||"$$"===h)return h=d[0],F.isNone(h)?null:h.clone();if("string"===typeof h)return h=r.primaryRasterIds.indexOf(h),
-1===h?null:d[h];if("number"===typeof h){d=d[0];if(F.isNone(d))return null;const {width:t,height:G,pixelType:E,mask:a}=d;d=a?new Uint8Array(a):null;r=new Float32Array(t*G);r.fill(h);h=Array(this.sourceRasterInfos[0].bandCount).fill(r);return new B({width:t,height:G,pixelType:E,pixels:h,mask:d})}return h.process(r)};N._createClass(l,[{key:"supportsGPU",get:function(){return this._bindingResult.supportsGPU}},{key:"flatWebGLFunctionChain",get:function(){var h=this.getWebGLProcessorDefinition();if(!h)return null;
const r=[h];({parameters:h}=h);for(h=h.rasters||h.raster&&[h.raster];h?.length;){r.unshift(...h);var d=[];for(var t=0;t<h.length;t++){var {parameters:G}=h[t];G=G.rasters||G.raster&&[G.raster];G?.length&&d.push(...G)}h=d}for(h=r.length-1;0<=h;h--)r[h].isNoopProcess&&r.splice(h,1);h=!1;for(d=0;d<r.length;d++)t=r[d],t.id=r.length-d-1,{rasters:t}=t.parameters,h=h||null!=t&&1<t.length;d=r.some(({name:E})=>"Slope"===E||"Aspect"===E);return{functions:r,hasBranches:h,hasSurfaceFunction:d}}}]);return l}(I.JSONSupport);
D.__decorate([y.property({json:{write:!0}})],I.prototype,"functionName",void 0);D.__decorate([y.property({json:{write:!0}})],I.prototype,"functionArguments",void 0);D.__decorate([y.property()],I.prototype,"rasterArgumentNames",void 0);D.__decorate([y.property({json:{write:!0}}),O.cast(c=>c?.toLowerCase())],I.prototype,"outputPixelType",void 0);D.__decorate([y.property({json:{write:!0}})],I.prototype,"mainPrimaryRasterId",void 0);D.__decorate([y.property()],I.prototype,"sourceRasters",void 0);D.__decorate([y.property({type:[p],
json:{write:!0}})],I.prototype,"sourceRasterInfos",void 0);D.__decorate([y.property({json:{write:!0}})],I.prototype,"rasterInfo",void 0);D.__decorate([y.property({json:{write:!0}})],I.prototype,"readingBufferSize",void 0);D.__decorate([y.property({json:{write:!0}})],I.prototype,"id",void 0);D.__decorate([y.property()],I.prototype,"isNoopProcess",void 0);D.__decorate([y.property()],I.prototype,"supportsGPU",null);D.__decorate([y.property()],I.prototype,"rawInputBandIds",void 0);D.__decorate([y.property()],
I.prototype,"isInputBandIdsSwizzled",void 0);D.__decorate([y.property()],I.prototype,"swizzledBandSelection",void 0);D.__decorate([y.property()],I.prototype,"isBranch",void 0);D.__decorate([y.property()],I.prototype,"flatWebGLFunctionChain",null);D.__decorate([y.property()],I.prototype,"_bindingResult",void 0);return I=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],I)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterStorageInfo".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p){var c;I=c=function(l){function u(r){r=h.call(this,r);r.attributeTable=null;r.bandCount=null;r.colormap=null;r.extent=null;r.format=void 0;r.height=null;r.width=null;r.histograms=null;r.keyProperties={};r.multidimensionalInfo=null;r.noDataValue=null;r.pixelSize=null;r.pixelType=null;r.isPseudoSpatialReference=!1;r.spatialReference=null;r.statistics=null;r.storageInfo=null;r.transform=null;return r}N._inherits(u,l);var h=N._createSuper(u);u.prototype.clone=function(){return new c({attributeTable:F.clone(this.attributeTable),
bandCount:this.bandCount,colormap:F.clone(this.colormap),extent:F.clone(this.extent),nativePixelSize:F.clone(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:F.clone(this.histograms),keyProperties:F.clone(this.keyProperties),multidimensionalInfo:F.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:F.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:F.clone(this.spatialReference),
statistics:F.clone(this.statistics),storageInfo:F.clone(this.storageInfo),transform:F.clone(this.transform)})};N._createClass(u,[{key:"dataType",get:function(){const r=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===r?"standard-time":r}},{key:"nativeExtent",get:function(){return this._get("nativeExtent")||this.extent},set:function(r){r&&this._set("nativeExtent",r)}},{key:"nativePixelSize",get:function(){if(y.isNone(this.transform)||!this.transform.affectsPixelSize)return this.pixelSize;
const r=this.nativeExtent;return{x:r.width/this.width,y:r.height/this.height}}},{key:"hasMultidimensionalTranspose",get:function(){return!!this.storageInfo?.transposeInfo}}]);return u}(I.JSONSupport);D.__decorate([O.property({json:{write:!0}})],I.prototype,"attributeTable",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"bandCount",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"colormap",void 0);D.__decorate([O.property({type:String,readOnly:!0})],I.prototype,"dataType",
null);D.__decorate([O.property({type:P,json:{write:!0}})],I.prototype,"extent",void 0);D.__decorate([O.property({type:P,json:{write:!0}})],I.prototype,"nativeExtent",null);D.__decorate([O.property({json:{write:!0}})],I.prototype,"nativePixelSize",null);D.__decorate([O.property({json:{write:!0}})],I.prototype,"format",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"height",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"width",void 0);D.__decorate([O.property({json:{write:!0}})],
I.prototype,"hasMultidimensionalTranspose",null);D.__decorate([O.property({json:{write:!0}})],I.prototype,"histograms",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"keyProperties",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"multidimensionalInfo",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"noDataValue",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"pixelSize",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,
"pixelType",void 0);D.__decorate([O.property()],I.prototype,"isPseudoSpatialReference",void 0);D.__decorate([O.property({type:B,json:{write:!0}})],I.prototype,"spatialReference",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"statistics",void 0);D.__decorate([O.property({type:p,json:{write:!0}})],I.prototype,"storageInfo",void 0);D.__decorate([O.property({json:{write:!0}})],I.prototype,"transform",void 0);return I=c=D.__decorate([L.subclass("esri.layers.support.RasterInfo")],I)})},
"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","./pixelUtils"],function(N,D,I,F){function y(O){let {altitude:V,azimuth:L}=O;const {hillshadeType:P,pixelSizePower:B=1,pixelSizeFactor:p=1,scalingType:c,isGCS:l,resolution:u}=O;var h="multi-directional"===P?2*O.zFactor:O.zFactor;const {x:r,y:d}=u;O=h/(8*r);var t=h/(8*d);l&&.001<h&&(O/=111E3,t/=111E3);"adjusted"===c&&(l?(O=111E3*r,t=111E3*d,O=(h+O**B*p)/(8*O),t=(h+t**B*p)/(8*t)):(O=
(h+r**B*p)/(8*r),t=(h+d**B*p)/(8*d)));var G=(90-V)*Math.PI/180;h=Math.cos(G);let E=(360-L+90)*Math.PI/180,a=Math.sin(G)*Math.cos(E);G=Math.sin(G)*Math.sin(E);const n=[315,270,225,360,180,0],m=[60,60,60,60,60,90];var f=new Float32Array([3,5,3,2,1,4]);const k=f.reduce((w,C)=>w+C);f=f.map(w=>w/k);const g="multi-directional"===P?n.length:1,b=new Float32Array(6),e=new Float32Array(6),v=new Float32Array(6);if("multi-directional"===P)for(let w=0;w<g;w++)V=m[w],L=n[w],G=(90-V)*Math.PI/180,h=Math.cos(G),E=
(360-L+90)*Math.PI/180,a=Math.sin(G)*Math.cos(E),G=Math.sin(G)*Math.sin(E),b[w]=h,e[w]=a,v[w]=G;else b.fill(h),e.fill(a),v.fill(G);return{resolution:u,factor:[O,t],sinZcosA:a,sinZsinA:G,cosZ:h,sinZcosAs:e,sinZsinAs:v,cosZs:b,weights:f,hillshadeType:["traditional","multi-directional"].indexOf(P)}}N.aspect=function(O,V={}){if(!F.isValidPixelBlock(O))return O;const {width:L,height:P,mask:B}=O;var p=O.pixels[0];const c=new Uint8Array(L*P);D.isSome(B)&&c.set(B);const l=new Float32Array(L*P);var {resolution:u}=
V;V=u?1/u.x:1;u=u?1/u.y:1;let h;let r,d,t,G;const E=D.isSome(B);for(let f=1;f<P-1;f++){const k=f*L;for(let g=1;g<L-1;g++)if(B&&!B[k+g])l[k+g]=0;else{var a=0;if(E&&(a=B[k-L+g-1]+B[k-L+g]+B[k-L+g+1]+B[k+g-1]+B[k+g+1]+B[k+L+g-1]+B[k+L+g]+B[k+L+g+1],7>a)){l[k+g]=0;c[k+g]=0;continue}if(B&&7===a){a=B[k-L+g-1]?p[k-L+g-1]:p[k+g];var n=B[k-L+g]?p[k-L+g]:p[k+g];h=B[k-L+g+1]?p[k-L+g+1]:p[k+g];var m=B[k+g-1]?p[k+g-1]:p[k+g];r=B[k+g+1]?p[k+g+1]:p[k+g];d=B[k+L+g-1]?p[k+L+g-1]:p[k+g];t=B[k+L+g]?p[k+L+g]:p[k+g];
G=B[k+L+g+1]?p[k+L+g+1]:p[k+g]}else a=p[k-L+g-1],n=p[k-L+g],h=p[k-L+g+1],m=p[k+g-1],r=p[k+g+1],d=p[k+L+g-1],t=p[k+L+g],G=p[k+L+g+1];m=(h+r+r+G-(a+m+m+d))*V;a=(d+t+t+G-(a+n+n+h))*u;n=-1;if(0!==m||0!==a)n=90-57.29578*Math.atan2(a,-m),0>n&&(n+=360),360===n?n=0:360<n&&(n%=360);l[k+g]=n}}for(p=0;p<P;p++)l[p*L]=l[p*L+1],l[(p+1)*L-1]=l[(p+1)*L-2];for(p=1;p<L-1;p++)l[p]=l[p+L],l[p+(P-1)*L]=l[p+(P-2)*L];return new I({width:L,height:P,pixels:[l],mask:B?c:null,pixelType:"f32",validPixelCount:O.validPixelCount,
statistics:[{minValue:0,maxValue:360}]})};N.calculateHillshadeParams=y;N.hillshade=function(O,V){if(!F.isValidPixelBlock(O))return O;const {width:L,height:P,mask:B}=O,p=new Uint8Array(L*P);var c=1;if(D.isSome(B)){for(var l=0;l<B.length;l++)if(B[l]){c=B[l];break}p.set(B)}const {factor:u,sinZcosA:h,sinZsinA:r,cosZ:d,sinZcosAs:t,sinZsinAs:G,cosZs:E,weights:a}=y(V),[n,m]=u;({hillshadeType:l}=V);const f=O.pixels[0];V=new Uint8Array(L*P);let k;const g=D.isSome(B);for(let x=1;x<P-1;x++){const q=x*L;for(let A=
1;A<L-1;A++)if(B&&!B[q+A])V[q+A]=0;else{var b=8;if(g&&(b=(B[q-L+A-1]+B[q-L+A]+B[q-L+A+1]+B[q+A-1]+B[q+A+1]+B[q+L+A-1]+B[q+L+A]+B[q+L+A+1])/c,7>b)){V[q+A]=0;p[q+A]=0;continue}if(B&&7===b){var e=B[q-L+A-1]?f[q-L+A-1]:f[q+A];var v=B[q-L+A]?f[q-L+A]:f[q+A];var w=B[q-L+A+1]?f[q-L+A+1]:f[q+A];b=B[q+A-1]?f[q+A-1]:f[q+A];k=B[q+A+1]?f[q+A+1]:f[q+A];var C=B[q+L+A-1]?f[q+L+A-1]:f[q+A];var M=B[q+L+A]?f[q+L+A]:f[q+A];var K=B[q+L+A+1]?f[q+L+A+1]:f[q+A]}else e=f[q-L+A-1],v=f[q-L+A],w=f[q-L+A+1],b=f[q+A-1],k=f[q+
A+1],C=f[q+L+A-1],M=f[q+L+A],K=f[q+L+A+1];b=(w+k+k+K-(e+b+b+C))*n;e=(C+M+M+K-(e+v+v+w))*m;v=Math.sqrt(1+b*b+e*e);w=0;if("traditional"===l)b=255*(d+r*e-h*b)/v,0>b&&(b=0),w=b;else for(C=G.length,M=0;M<C;M++)K=255*(E[M]+G[M]*e-t[M]*b)/v,0>K&&(K=0),w+=K*a[M];V[q+A]=w&255}}for(c=0;c<P;c++)V[c*L]=V[c*L+1],V[(c+1)*L-1]=V[(c+1)*L-2];for(c=1;c<L-1;c++)V[c]=V[c+L],V[c+(P-1)*L]=V[c+(P-2)*L];return new I({width:L,height:P,pixels:[V],mask:B?p:null,pixelType:"u8",validPixelCount:O.validPixelCount,statistics:[{minValue:0,
maxValue:255}]})};N.slope=function(O,V){if(!F.isValidPixelBlock(O))return O;var L=V.zFactor,P=V.pixelSizePower??1,B=V.pixelSizeFactor??1,p=V.slopeType,c=V.isGCS;const {width:l,height:u,mask:h}=O,r=O.pixels[0],d=new Uint8Array(l*u);let t=1;if(D.isSome(h)){for(var G=0;G<h.length;G++)if(h[G]){t=h[G];break}d.set(h)}G=new Float32Array(l*u);const {x:E,y:a}=V.resolution;V=L/(8*E);let n=L/(8*a);c&&1E-4>Math.abs(L-1)&&(V/=111E3,n/=111E3);"adjusted"===p&&(V=(L+E**P*B)/(8*E),n=(L+a**P*B)/(8*a));let m,f;let k,
g,b,e;L=D.isSome(h);for(P=1;P<u-1;P++)for(B=P*l,c=1;c<l-1;c++)if(h&&!h[B+c])G[B+c]=0;else{var v=0;if(L&&(v=(h[B-l+c-1]+h[B-l+c]+h[B-l+c+1]+h[B+c-1]+h[B+c+1]+h[B+l+c-1]+h[B+l+c]+h[B+l+c+1])/t,7>v)){G[B+c]=0;d[B+c]=0;continue}if(h&&7===v){v=h[B-l+c-1]?r[B-l+c-1]:r[B+c];m=h[B-l+c]?r[B-l+c]:r[B+c];f=h[B-l+c+1]?r[B-l+c+1]:r[B+c];var w=h[B+c-1]?r[B+c-1]:r[B+c];k=h[B+c+1]?r[B+c+1]:r[B+c];g=h[B+l+c-1]?r[B+l+c-1]:r[B+c];b=h[B+l+c]?r[B+l+c]:r[B+c];e=h[B+l+c+1]?r[B+l+c+1]:r[B+c]}else v=r[B-l+c-1],m=r[B-l+c],
f=r[B-l+c+1],w=r[B+c-1],k=r[B+c+1],g=r[B+l+c-1],b=r[B+l+c],e=r[B+l+c+1];w=(f+k+k+e-(v+w+w+g))*V;v=(g+b+b+e-(v+m+m+f))*n;v=Math.sqrt(w*w+v*v);G[B+c]="percent-rise"===p?100*v:57.2957795*Math.atan(v)}for(p=0;p<u;p++)G[p*l]=G[p*l+1],G[(p+1)*l-1]=G[(p+1)*l-2];for(p=1;p<l-1;p++)G[p]=G[p+l],G[p+(u-1)*l]=G[p+(u-2)*l];O=new I({width:l,height:u,pixels:[G],mask:h?d:null,pixelType:"f32",validPixelCount:O.validPixelCount});O.updateStatistics();return O};N.tintHillshade=function(O,V,L,P){if(F.isValidPixelBlock(O)&&
F.isValidPixelBlock(V)){var {min:B,max:p}=P;P=O.pixels[0];var {pixels:c,mask:l}=V;V=c[0];var u=255.00001/(p-B),h=new Uint8ClampedArray(V.length),r=new Uint8ClampedArray(V.length),d=new Uint8ClampedArray(V.length),t=L.length-1;for(let a=0;a<V.length;a++){if(l&&0===l[a])continue;var G=Math.floor((V[a]-B)*u);const [n,m]=L[0>G?0:G>t?t:G];var E=P[a];G=E*m;const f=G*(1-Math.abs(n%2-1));E-=G;switch(Math.floor(n)){case 0:h[a]=G+E;r[a]=f+E;d[a]=E;break;case 1:h[a]=f+E;r[a]=G+E;d[a]=E;break;case 2:h[a]=E;r[a]=
G+E;d[a]=f+E;break;case 3:h[a]=E;r[a]=f+E;d[a]=G+E;break;case 4:h[a]=f+E;r[a]=E;d[a]=G+E;break;case 5:case 6:h[a]=G+E,r[a]=E,d[a]=f+E}}O.pixels=[h,r,d];O.updateStatistics()}};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p){const c=new Set(["vari","mtvi2","rtvi-core","evi"]);y=function(l){function u(){var r=h.apply(this,arguments);r.functionName="BandArithmetic";r.functionArguments=null;r.rasterArgumentNames=["raster"];return r}N._inherits(u,l);var h=N._createSuper(u);l=u.prototype;l._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");const r=this.sourceRasterInfos[0],d=r.clone();d.pixelType=this.outputPixelType;d.statistics=null;d.histograms=null;d.bandCount=
"sultan"===this.functionArguments.method?r.bandCount:1;this.rasterInfo=d;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}};l._processPixels=function(r){r=r.pixelBlocks?.[0];if(I.isNone(r))return r;const {method:d,bandIndexes:t}=this.functionArguments,G=t.split(" ").map(E=>parseFloat(E));return B.calculateBandIndex(r,{method:d,bandIndexes:G,equation:t})};l._getWebGLParameters=function(){const r=this.functionArguments.bandIndexes.split(" ").map(E=>
parseFloat(E)-1);2===r.length&&r.push(0);var d=this.isInputBandIdsSwizzled?[0,1,2]:r;const t=new Float32Array(3);({method:G}=this.functionArguments);switch(G){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":d=B.getBandMatrix3([d[0],d[1],0]);var G="ndxi";break;case "ndwi":d=B.getBandMatrix3([d[1],d[0],0]);G="ndxi";break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":d=B.getBandMatrix3([d[0],d[1],0]);G="sr";break;
case "ci-g":case "ci-re":d=B.getBandMatrix3([d[0],d[1],0]);G="ci";break;case "savi":d=B.getBandMatrix3([d[0],d[1],0]);G="savi";t[0]=r[2]+1;break;case "tsavi":d=B.getBandMatrix3([d[0],d[1],0]);G="tsavi";t[0]=r[2]+1;t[1]=r[3]+1;t[2]=r[4]+1;break;case "msavi":d=B.getBandMatrix3([d[0],d[1],0]);G="msavi";break;case "gemi":d=B.getBandMatrix3([d[0],d[1],0]);G="gemi";break;case "pvi":d=B.getBandMatrix3([d[0],d[1],0]);G="tsavi";t[0]=r[2]+1;t[1]=r[3]+1;break;case "vari":d=B.getBandMatrix3([d[0],d[1],d[2]]);
G="vari";break;case "mtvi2":d=B.getBandMatrix3([d[0],d[1],d[2]]);G="mtvi2";break;case "rtvi-core":d=B.getBandMatrix3([d[0],d[1],d[2]]);G="rtvicore";break;case "evi":d=B.getBandMatrix3([d[0],d[1],d[2]]);G="evi";break;case "wndwi":d=B.getBandMatrix3([d[0],d[1],0]);G="wndwi";t[0]=r[3]?r[3]+1:.5;break;case "bai":d=B.getBandMatrix3([d[1],d[0],0]);G="bai";break;default:d=B.getBandMatrix3([0,1,2]),G="custom"}return{bandIndexMat3:d,indexType:G,adjustments:t}};l._getInputBandIds=function(r){if("custom"===
this.functionArguments.method)return r;var d=this.functionArguments.bandIndexes.split(" ").map(E=>parseFloat(E)-1);const t=r.length;d=d.map(E=>E>=t?t-1:E);const G=c.has(this.functionArguments.method)?3:2;d=d.slice(0,G).map(E=>r[E]);2===d.length&&d.push(0);return d};return N._createClass(u)}(p);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",
void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",void 0);return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],y)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L,P){var B;y=B=function(p){function c(){var u=l.apply(this,arguments);u.method="custom";return u}N._inherits(c,p);var l=N._createSuper(c);c.prototype.clone=function(){return new B({method:this.method,bandIndexes:this.bandIndexes,raster:I.clone(this.raster)})};return N._createClass(c)}(P);D.__decorate([F.property({json:{type:String,write:!0}})],y.prototype,"bandIndexes",void 0);D.__decorate([O.enumeration(L.bandIndexMethodMap)],y.prototype,"method",void 0);return y=B=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],
y)})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define("exports ../../../core/jsonMap ../../../core/maybe ../PixelBlock ./customBandIndexUtils ./pixelUtils".split(" "),function(N,D,I,F,y,O){function V(m,f,k){const g=k.length,b=new Float32Array(g);for(let e=0;e<g;e++)if(null==m||m[e]){const v=f[e],w=k[e],C=v+w;C&&(b[e]=(v-w)/C)}return[b]}function L(m,f,k){const g=k.length,b=new Float32Array(g);for(let e=0;e<g;e++)if(null==m||m[e]){const v=f[e],w=k[e];w&&(b[e]=v/w)}return[b]}function P(m,
f,k){const g=f.length,b=new Float32Array(g);for(let e=0;e<g;e++)if(null==m||m[e]){const v=f[e],w=k[e];w&&(b[e]=v/w-1)}return[b]}function B(m,f,k,g){const b=k.length,e=new Float32Array(b);for(let v=0;v<b;v++)if(null==m||m[v]){const w=k[v],C=f[v],M=C+w+g;M&&(e[v]=(C-w)/M*(1+g))}return[e]}function p(m,f,k,g,b,e){const v=k.length,w=new Float32Array(v);e=-b*g+e*(1+g*g);for(let C=0;C<v;C++)if(null==m||m[C]){const M=k[C],K=f[C],x=b*K+M+e;x&&(w[C]=g*(K-g*M-b)/x)}return[w]}function c(m,f,k){const g=k.length,
b=new Float32Array(g);for(let e=0;e<g;e++)if(null==m||m[e]){const v=f[e];b[e]=.5*(2*(v+1)-Math.sqrt((2*v+1)**2-8*(v-k[e])))}return[b]}function l(m,f,k){const g=k.length,b=new Float32Array(g);for(let v=0;v<g;v++)if(null==m||m[v]){const w=k[v];var e=f[v];1!==w&&(e=(2*(e*e-w*w)+1.5*e+.5*w)/(e+w+.5),b[v]=e*(1-.25*e)-(w-.125)/(1-w))}return[b]}function u(m,f,k,g,b){const e=k.length,v=new Float32Array(e),w=Math.sqrt(1+g*g);for(let C=0;C<e;C++)if(null==m||m[C])v[C]=(f[C]-g*k[C]-b)/w;return[v]}function h(m,
f){const [k,g,b,e,v,w]=f;f=k.length;const C=new Float32Array(f);for(let M=0;M<f;M++)if(null==m||m[M])C[M]=-.2848*k[M]-.2435*g[M]-.5436*b[M]+.7243*e[M]+.084*v[M]-1.18*w[M];return[C]}function r(m,f){const [k,,g,b,e,v]=f;f=k.length;const w=new Float32Array(f),C=new Float32Array(f),M=new Float32Array(f);for(let K=0;K<f;K++)if(null==m||m[K])w[K]=v[K]?e[K]/v[K]*100:0,C[K]=k[K]?e[K]/k[K]*100:0,M[K]=b[K]?g[K]/b[K]*(e[K]/b[K])*100:0;return[w,C,M]}function d(m,f){const [k,g,b]=f;f=k.length;const e=new Float32Array(f);
for(let v=0;v<f;v++)if(null==m||m[v])for(v=0;v<f;v++){const w=k[v],C=g[v],M=C+w-b[v];M&&(e[v]=(C-w)/M)}return[e]}function t(m,f){const [k,g,b]=f;f=k.length;const e=new Float32Array(f);for(let v=0;v<f;v++)if(null==m||m[v])for(v=0;v<f;v++){const w=k[v],C=g[v],M=b[v];e[v]=1.5*(1.2*(w-M)-2.5*(C-M))*Math.sqrt((2*w+1)**2-6*w-5*Math.sqrt(C)-.5)}return[e]}function G(m,f){const [k,g,b]=f;f=k.length;const e=new Float32Array(f);for(let v=0;v<f;v++)if(null==m||m[v])for(v=0;v<f;v++){const w=k[v];e[v]=100*(w-g[v])-
10*(w-b[v])}return[e]}function E(m,f){const [k,g,b]=f;f=k.length;const e=new Float32Array(f);for(let v=0;v<f;v++)if(null==m||m[v])for(v=0;v<f;v++){const w=k[v],C=g[v],M=w+6*C-7.5*b[v]+1;M&&(e[v]=2.5*(w-C)/M)}return[e]}function a(m,f,k=.5){const [g,b,e]=f;f=b.length;const v=new Float32Array(f);for(let w=0;w<f;w++)if(null==m||m[w])for(w=0;w<f;w++){const C=g[w],M=b[w],K=e[w],x=C+k*M+(1-k)*K;x&&(v[w]=(C-k*M-(1-k)*K)/x)}return[v]}function n(m,f,k){const g=k.length,b=new Float32Array(g);for(let e=0;e<g;e++)if(null==
m||m[e])for(e=0;e<g;e++){const v=(.1-f[e])**2+(.06-k[e])**2;v&&(b[e]=1/v)}return[b]}D=new D.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});N.bandIndexMethodMap=D;N.calculateBandIndex=function(m,
f){if(!O.isValidPixelBlock(m))return m;const {equation:k,method:g}=f;f=f.bandIndexes.map(w=>w-1);const {pixels:b,mask:e}=m;switch(g){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":f=V(e,b[f[0]],b[f[1]]);break;case "ndwi":f=V(e,b[f[1]],b[f[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":f=L(e,b[f[0]],b[f[1]]);break;case "ci-g":case "ci-re":f=P(e,b[f[0]],b[f[1]]);break;case "savi":f=B(e,b[f[0]],b[f[1]],
f[2]+1);break;case "tsavi":f=p(e,b[f[0]],b[f[1]],f[2]+1,f[3]+1,f[4]+1);break;case "msavi":f=c(e,b[f[0]],b[f[1]]);break;case "gemi":f=l(e,b[f[0]],b[f[1]]);break;case "pvi":f=u(e,b[f[0]],b[f[1]],f[2]+1,f[3]+1);break;case "gvitm":f=h(e,[b[f[0]],b[f[1]],b[f[2]],b[f[3]],b[f[4]],b[f[5]]]);break;case "sultan":f=r(e,[b[f[0]],b[f[1]],b[f[2]],b[f[3]],b[f[4]],b[f[5]]]);break;case "vari":f=d(e,[b[f[0]],b[f[1]],b[f[2]]]);break;case "mtvi2":f=t(e,[b[f[0]],b[f[1]],b[f[2]]]);break;case "rtvi-core":f=G(e,[b[f[0]],
b[f[1]],b[f[2]]]);break;case "evi":f=E(e,[b[f[0]],b[f[1]],b[f[2]]]);break;case "wndwi":f=a(e,[b[f[0]],b[f[1]],b[f[2]]],f[3]?f[3]+1:.5);break;case "bai":f=n(e,b[f[0]],b[f[1]]);break;case "custom":f=y.calculateCustomBandIndex(e,b,k);break;default:return m}const v=I.isSome(e)?new Uint8Array(e.length):null;I.isSome(e)&&I.isSome(v)&&v.set(e);m=new F({width:m.width,height:m.height,pixelType:"f32",pixels:f,mask:v});m.updateStatistics();return m};N.calculateNDVI=function(m,f,k,g){const {mask:b,pixels:e,width:v,
height:w}=m;m=e[k];f=e[f];k=f.length;const C=g?new Uint8Array(k):new Float32Array(k),M=g?100:1,K=g?100.5:0;for(let x=0;x<k;x++)if(null==b||b[x]){const q=m[x],A=f[x],H=q+A;H&&(C[x]=(q-A)/H*M+K)}g=new F({width:v,height:w,mask:b,pixelType:g?"u8":"f32",pixels:[C]});g.updateStatistics();return g};N.getBandMatrix3=function(m){const f=new Float32Array(9);f[3*m[0]]=1;f[3*m[1]+1]=1;f[3*m[2]+2]=1;return f};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports",
"../../../core/has"],function(N,D){const I=new Set("+-*/()".split(""));N.calculateCustomBandIndex=function(F,y,O){O=O.replace(/ /g,"");O.startsWith("-")&&(O="0"+O);O.startsWith("+")&&(O=O.slice(1,O.length));O=O.split("");var V=[],L=[],P="";for(let l=0;l<O.length;l++){const u=O[l];I.has(u)?(""!==P&&L.push(parseFloat(P)),V.push(u),P=""):"b"===u.toLowerCase()?(l++,P=u.concat(O[l]),L.push(y[parseInt(P[1],10)-1]),P=""):(P=P.concat(u),l===O.length-1&&L.push(parseFloat(P)))}let {ops:B,nums:p}={ops:V,nums:L};
if(0===B.length){F=1===p.length?p[0]:y[0];if(F instanceof Float32Array)return[F];var c=new Float32Array(y[0].length);"number"===typeof F?c.fill(F):c.set(F);return[c]}for(;0<B.length;){c=B;if(1===c.length)c={opIndex:0,numIndex:0};else{V=O=0;for(y=0;y<c.length;y++)if("("===c[y])O=y;else if(")"===c[y]){V=y;break}L=0===V?c:c.slice(O+1,V);y=-1;for(P=0;P<L.length;P++)if("*"===L[P]||"/"===L[P]){y=P;break}if(!(-1<y))for(P=0;P<L.length;P++)if("+"===L[P]||"-"===L[P]){y=P;break}0<V&&(y+=O+1);O=0;for(V=0;V<y;V++)"("===
c[V]&&O++;c={opIndex:y,numIndex:y-O}}const {numIndex:l,opIndex:u}=c;V=void 0;c=F;P=B[u];y=p[l];O=p[l+1];if("number"===typeof y&&"number"===typeof O)c=y+O;else{"number"===typeof y?(V=O.length,L=y,y=new Float32Array(V),y.fill(L)):(V=y.length,O.constructor===Number&&(L=O,O=new Float32Array(V),O.fill(L)));L=new Float32Array(V);switch(P){case "+":for(P=0;P<V;P++)if(null==c||c[P])L[P]=y[P]+O[P];break;case "-":for(P=0;P<V;P++)if(null==c||c[P])L[P]=y[P]-O[P];break;case "*":for(P=0;P<V;P++)if(null==c||c[P])L[P]=
y[P]*O[P];break;case "/":for(P=0;P<V;P++)(null==c||c[P])&&O[P]&&(L[P]=y[P]/O[P]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}c=L}if(1===B.length)break;else{y=B;y.splice(u,1);V=O=0;do{V=O=0;for(L=0;L<y.length;L++)if("("===y[L])O=L;else if(")"===y[L]){V=L;break}V===O+1&&y.splice(O,2)}while(V===O+1);B=y;p.splice(l,2,c)}}return[c]};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p){F=function(c){function l(){var h=u.apply(this,arguments);h.functionName="Colormap";h.functionArguments=null;h.rasterArgumentNames=["raster"];h.isNoopProcess=!0;return h}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c._bindSourceRasters=function(){var h=this.sourceRasterInfos[0];if(1<h.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:r,colormapName:d,colorRamp:t,colorRampName:G}=this.functionArguments;
if(!r?.length)if(t)r=p.convertColorRampToColormap(t,{interpolateAlpha:!0});else if(G){const E=p.getColorRampJSON(G);E&&(r=p.convertColorRampToColormap(E))}else d&&(r=B.getColormapByName(d));if(!r?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");h=h.clone();h.pixelType=this.outputPixelType;h.colormap=r;h.bandCount=1;this.rasterInfo=h;return{success:!0,supportsGPU:!0}};c._processPixels=function(h){return h.pixelBlocks?.[0]};
return N._createClass(l)}(L);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],F.prototype,"functionName",void 0);D.__decorate([I.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],F.prototype,"functionArguments",void 0);D.__decorate([I.property()],F.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property()],F.prototype,"isNoopProcess",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"indexedColormap",void 0);return F=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],
F)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),function(N,D,I,F,y,O,
V,L,P,B){var p;L=p=function(c){function l(){return u.apply(this,arguments)}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c.castColormapName=function(h){if(!h)return null;h=h.toLowerCase();return P.rasterColormapNames.includes(h)?h:null};c.readColorRamp=function(h){return B.fromJSON(h)};c.readColorRampName=function(h,r){return h?(r=P.colorRampDict.jsonValues.find(d=>d.toLowerCase()===h.toLowerCase()))?P.colorRampDict.fromJSON(r):null:null};c.clone=function(){return new p({colormap:I.clone(this.colormap),
colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})};return N._createClass(l)}(L);D.__decorate([F.property({type:[[Number]],json:{write:!0}})],L.prototype,"colormap",void 0);D.__decorate([F.property({type:String,json:{write:!0}})],L.prototype,"colormapName",void 0);D.__decorate([y.cast("colormapName")],L.prototype,"castColormapName",null);D.__decorate([F.property({types:B.types,json:{write:!0}})],L.prototype,"colorRamp",void 0);D.__decorate([O.reader("colorRamp")],
L.prototype,"readColorRamp",null);D.__decorate([F.property({type:P.colorRampDict.apiValues,json:{type:P.colorRampDict.jsonValues,write:P.colorRampDict.write}})],L.prototype,"colorRampName",void 0);D.__decorate([O.reader("colorRampName")],L.prototype,"readColorRampName",null);return L=p=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],L)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports","../../../renderers/support/colorRampUtils"],
function(N,D){function I(L,P){const B=[],p=[];for(let c=0;c<L.length-1;c++)B.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:L[c].slice(1),toColor:L[c+1].slice(1)}),p.push(L[c+1][0]-L[c][0]);L=L[L.length-1][0];P=P??p;return D.convertColorRampToColors({type:"multipart",colorRamps:B},{numColors:L,weights:P})}function F(){const L=I([[0,255,255,255],[70,0,0,255],[80,205,193,173],[100,150,150,150],[110,120,100,51],[130,120,200,100],[140,28,144,3],[160,6,55,0],[180,10,30,25],[201,6,27,7]]);
for(let P=L.length;256>P;P++)L.push([6,27,7]);return L}function y(){const L=[];for(let P=0;256>P;P++){const B=[];for(let p=0;3>p;p++)B.push(Math.round(255*Math.random()));L.push(B)}return L}const O=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,
91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],
[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],
[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,
4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],
[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,
57,8],[40,57,8]],V=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,
0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,
197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,
204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,
138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,
0],[38,115,0]];N.getColormapByName=function(L){let P;switch(L){case "elevation":P=I([[0,0,191,191],[51,0,255,0],[102,255,255,0],[153,255,127,0],[204,191,127,63],[256,20,20,20]]);break;case "gray":P=D.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":P=I([[0,38,54,41],[69,79,90,82],[131,156,156,156],[256,253,241,253]],[.268,.238,.495]);break;case "ndvi":P=O;break;case "ndvi2":P=F();break;case "ndvi3":P=V;break;
case "random":P=y()}return P?P=P.map((B,p)=>[p,...B]):null};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p){y=function(c){function l(){var h=u.apply(this,arguments);h.functionName="CompositeBand";h.functionArguments=null;h.rasterArgumentNames=["rasters"];return h}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c._bindSourceRasters=function(){const {sourceRasterInfos:h}=this;var r=h[0];this.outputPixelType=this._getOutputPixelType(r.pixelType);r=r.clone();r.attributeTable=null;r.colormap=null;r.pixelType=this.outputPixelType;r.bandCount=h.map(({bandCount:d})=>d).reduce((d,
t)=>d+t);if(h.every(({statistics:d})=>I.isSome(d)&&d.length)){const d=[];h.forEach(({statistics:t})=>I.isSome(t)&&d.push(...t));r.statistics=d}if(h.every(({histograms:d})=>I.isSome(d)&&d.length)){const d=[];h.forEach(({histograms:t})=>I.isSome(t)&&d.push(...t));r.histograms=d}1<r.bandCount&&(r.colormap=null,r.attributeTable=null);this.rasterInfo=r;return{success:!0,supportsGPU:3>=r.bandCount}};c._processPixels=function(h){({pixelBlocks:h}=h);return!h||I.isNone(h?.[0])?null:p.compositeBands(h)};c._getWebGLParameters=
function(){return{bandCount:this.rasterInfo.bandCount}};return N._createClass(l)}(P);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",void 0);return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],y)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L){var P;y=P=function(B){function p(){var l=c.apply(this,arguments);l.rasters=[];return l}N._inherits(p,B);var c=N._createSuper(p);B=p.prototype;B.writeRasters=function(l,u){u.rasters=l.map(h=>"number"===typeof h||"string"===typeof h?h:h.toJSON())};B.clone=function(){return new P({rasters:I.clone(this.rasters)})};return N._createClass(p)}(L);D.__decorate([F.property({json:{write:!0}})],y.prototype,"rasters",void 0);D.__decorate([V.writer("rasters")],y.prototype,"writeRasters",
null);return y=P=D.__decorate([O.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],y)})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l){y=function(u){function h(){var d=r.apply(this,arguments);d.functionName="Convolution";d.rasterArgumentNames=["raster"];return d}N._inherits(h,u);var r=N._createSuper(h);u=h.prototype;u._bindSourceRasters=function(){const {convolutionType:d,rows:t,cols:G,kernel:E}=this.functionArguments;if(!Object.values(P.convolutionKernel).includes(d))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${d}`};if(d!==P.convolutionKernel.none&&
t*G!==E.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var a=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(a.pixelType);a=a.clone();a.pixelType=this.outputPixelType;const n=[P.convolutionKernel.none,P.convolutionKernel.sharpen,P.convolutionKernel.sharpen2,P.convolutionKernel.sharpening3x3,P.convolutionKernel.sharpening5x5];"u8"===this.outputPixelType||n.includes(d)||(a.statistics=null,
a.histograms=null);a.colormap=null;a.attributeTable=null;this.rasterInfo=a;return{success:!0,supportsGPU:25>=E.length}};u._processPixels=function(d){d=d.pixelBlocks?.[0];if(I.isNone(d)||this.functionArguments.convolutionType===P.convolutionKernel.none)return d;let {kernel:t,rows:G,cols:E}=this.functionArguments;const a=t.reduce((n,m)=>n+m);0!==a&&1!==a&&(t=t.map(n=>n/a));return l.convolute(d,{kernel:t,rows:G,cols:E,outputPixelType:this.outputPixelType})};u._getWebGLParameters=function(){let {kernel:d}=
this.functionArguments;const t=d.reduce((E,a)=>E+a);0!==t&&1!==t&&(d=d.map(E=>E/t));const G=new Float32Array(25);G.set(d);return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:G,clampRange:B.getPixelValueRange(this.outputPixelType)}};return N._createClass(h)}(p);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:c,json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",
void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",void 0);return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],y)})},"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],function(N){const D={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},I={bitwiseAnd:11,bitwiseLeftShift:12,
bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},F={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},y={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,
minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},O={setNull:50,conditional:78},V={...D,...I,...F,...y,...O};N.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,PVI:6,GVITM:7,Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};N.cellStatisticalOperation=y;N.colorRampName=
{aspect:"Aspect",blackToWhite:"Black to White",blueBright:"Blue Bright",blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",brownToBlueGreenDivergingRight:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDiverging:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",
cyanLightToBlueDark:"Cyan-Light to Blue-Dark",distance:"Distance",elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",greenToBlue:"Green to Blue",orangeBright:"Orange Bright",orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",
pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",
redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",
yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",yellowGreenLightToDark:"Yellow-Green Light to Dark"};N.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",gray:"Gray",hillshade:"Hillshade"};N.convolutionKernel={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,
smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};N.localArithmeticOperation=D;N.localConditionalOperation=O;N.localLogicalOperation=I;N.localOperators=V;N.localTrigonometricOperation=F;N.missingBandAction={bestMatch:0,fail:1};N.noDataInterpretation={matchAny:0,matchAll:1};N.slopeType={degree:1,percentRise:2,adjusted:3};N.stretchType={none:0,standardDeviation:3,histogramEqualization:4,
minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),function(N,
D,I,F,y,O,V,L,P){var B;y=B=function(p){function c(){var u=l.apply(this,arguments);u.rows=3;u.cols=3;u.kernel=[0,0,0,0,1,0,0,0,0];return u}N._inherits(c,p);var l=N._createSuper(c);c.prototype.clone=function(){return new B({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:I.clone(this.raster)})};N._createClass(c,[{key:"convolutionType",set:function(u){this._set("convolutionType",u);const h=P.convolutionKernels.get(u);h&&u!==V.convolutionKernel.userDefined&&
u!==V.convolutionKernel.none&&(u=Math.sqrt(h.length),this._set("kernel",h),this._set("cols",u),this._set("rows",u))}}]);return c}(L);D.__decorate([F.property({json:{type:Number,write:!0}})],y.prototype,"rows",void 0);D.__decorate([F.property({json:{type:Number,write:!0}})],y.prototype,"cols",void 0);D.__decorate([F.property({json:{name:"type",type:Number,write:!0}})],y.prototype,"convolutionType",null);D.__decorate([F.property({json:{type:[Number],write:!0}})],y.prototype,"kernel",void 0);return y=
B=D.__decorate([O.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],y)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants"],function(N,D,I){function F(B){const p=Math.sqrt(B.length),c=B.slice(0,p),l=[1];for(let u=1;u<p;u++){let h=null;for(let r=0;r<p;r++){const d=B[r+u*p],t=B[r];if(null==h)if(0===t){if(d)return{separable:!1,row:null,col:null}}else h=d/t;else if(d/t!==h)return{separable:!1,row:null,
col:null}}if(null==h)return{separable:!1,row:null,col:null};l.push(h)}return{separable:!0,row:c,col:l}}function y(B,p,c,l,u,h,r){const d=new Float32Array(p*c),t=h.length,G=r?0:l,E=r?l:0;r=r?1:p;for(let a=G;a<c-G;a++){const n=a*p;for(let m=E;m<p-E;m++){if(u&&!u[n+m])continue;let f=0;for(let k=0;k<t;k++)f+=B[n+m+(k-l)*r]*h[k];d[n+m]=f}}return d}function O(B,p,c=!0){const {pixels:l,width:u,height:h,pixelType:r,mask:d}=B;B=l.length;const t=[],{kernel:G,rows:E,cols:a}=p;for(p=0;p<B;p++){var n=l[p],m=u,
f=h,k=E,g=a,b=d,e=G;const v=new Float32Array(m*f),w=Math.floor(k/2),C=Math.floor(g/2);for(let M=w;M<f-w;M++){const K=M*m;for(let x=C;x<m-C;x++){if(b&&!b[K+x])continue;let q=0;for(let A=0;A<k;A++)for(let H=0;H<g;H++)q+=n[K+x+(A-w)*m+H-C]*e[A*g+H];v[K+x]=q}}n=v;c&&V(n,u,h,E,a);t.push(n)}return new D({width:u,height:h,pixelType:r,pixels:t,mask:d})}function V(B,p,c,l,u){l=Math.floor(l/2);for(var h=0;h<l;h++)for(var r=0;r<p;r++)B[h*p+r]=B[(u-1-h)*p+r],B[(c-1-h)*p+r]=B[(c-u+h)*p+r];l=Math.floor(u/2);for(h=
0;h<c;h++){r=h*p;for(let d=0;d<l;d++)B[r+d]=B[r+u-1-d],B[r+p-d-1]=B[r+p+d-u]}}function L(B,p,c,l=!0){const {pixels:u,width:h,height:r,pixelType:d,mask:t}=B;B=u.length;const G=[],E=p.length,a=c.length,n=Math.floor(E/2),m=Math.floor(a/2);for(let f=0;f<B;f++){let k=y(u[f],h,r,n,t,p,!0);k=y(k,h,r,m,t,c,!1);l&&V(k,h,r,E,a);G.push(k)}return new D({width:h,height:r,pixelType:d,pixels:G,mask:t})}const P=new Map;P.set(I.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);P.set(I.convolutionKernel.lineDetectionHorizontal,
[-1,-1,-1,2,2,2,-1,-1,-1]);P.set(I.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]);P.set(I.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);P.set(I.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);P.set(I.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);P.set(I.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,1]);P.set(I.convolutionKernel.gradientEast,[1,0,-1,2,0,-2,1,0,-1]);P.set(I.convolutionKernel.gradientSouth,[1,2,1,0,0,
0,-1,-2,-1]);P.set(I.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);P.set(I.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]);P.set(I.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);P.set(I.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]);P.set(I.convolutionKernel.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,
1,1]);P.set(I.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);P.set(I.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);P.set(I.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);P.set(I.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);P.set(I.convolutionKernel.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]);P.set(I.convolutionKernel.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]);P.set(I.convolutionKernel.sharpen,
[0,-.25,0,-.25,2,-.25,0,-.25,0]);P.set(I.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);P.set(I.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);N.convolute=function(B,p){const c=F(p.kernel),l=!1!==p.mirrorEdges;B=c.separable?L(B,c.row,c.col,l):O(B,p,l);({outputPixelType:p}=p);p&&B.clamp(p);return B};N.convoluteSeparable=L;N.convolutionKernels=P;N.separateKernels=F;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c){y=function(l){function u(){var r=h.apply(this,arguments);r.functionName="ExtractBand";r.functionArguments=null;r.rasterArgumentNames=["raster"];return r}N._inherits(u,l);var h=N._createSuper(u);l=u.prototype;l._bindSourceRasters=function(){var {sourceRasterInfos:r}=this;r=r[0];const {bandCount:d}=r,{bandIds:t,missingBandAction:G}=this.functionArguments;if(G===c.MissingBandAction.fail&&t.some(n=>0>n||n>=d))return{success:!1,supportsGPU:!1,error:"extract-band-function: invalid bandIds"};
this.outputPixelType=this._getOutputPixelType("f32");r=r.clone();r.pixelType=this.outputPixelType;r.bandCount=t.length;const {statistics:E,histograms:a}=r;I.isSome(E)&&E.length&&(r.statistics=t.map(n=>E[n]||E[E.length-1]));I.isSome(a)&&a.length&&(r.histograms=t.map(n=>a[n]||a[a.length-1]));this.rasterInfo=r;return{success:!0,supportsGPU:3>=r.bandCount}};l._processPixels=function(r){r=r.pixelBlocks?.[0];if(I.isNone(r))return null;const d=r.pixels.length,t=this.functionArguments.bandIds.map(G=>G>=d?
d-1:G);return r.extractBands(t)};l._getWebGLParameters=function(){let r;if(this.isInputBandIdsSwizzled)r=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{r=[...this.functionArguments.bandIds];0===r.length?r=[0,1,2]:3>r.length&&(r[1]=r[1]??r[0],r[2]=r[2]??r[1]);for(let d=0;3>d;d++)r[d]=Math.min(r[d],2)}return{bandIndexMat3:P.getBandMatrix3(r)}};l._getInputBandIds=function(r){const d=r.length;return this.functionArguments.bandIds.map(t=>t>=d?d-1:t).map(t=>r[t])};return N._createClass(u)}(B);
D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:p,json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",void 0);return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],y)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(N,D,I,F,y,O,V,L,P){var B;F=B=function(p){function c(){var u=l.apply(this,arguments);u.bandIds=[];u.missingBandAction=P.MissingBandAction.bestMatch;return u}N._inherits(c,p);var l=N._createSuper(c);c.prototype.clone=function(){return new B({bandIds:[...this.bandIds],missingBandAction:this.missingBandAction})};return N._createClass(c)}(L);D.__decorate([I.property({json:{write:!0}})],F.prototype,"bandIds",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"missingBandAction",void 0);
return F=B=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],F)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l){y=function(u){function h(){var d=r.apply(this,arguments);d.functionName="Local";d.functionArguments=null;d.rasterArgumentNames=["rasters"];return d}N._inherits(h,u);var r=N._createSuper(h);u=h.prototype;u._bindSourceRasters=function(){var {sourceRasterInfos:d}=this,t=d[0];const {bandCount:G}=t;var {processAsMultiband:E}=this.functionArguments;if(d.some(m=>m.bandCount!==G))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};
const {operation:a,rasters:n}=this.functionArguments;d=l.operandsCount[a];if(!(999===d||n.length===d||1>=n.length&&1===d))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${d}`};this.outputPixelType=this._getOutputPixelType("f32");t=t.clone();t.pixelType=this.outputPixelType;t.statistics=null;t.histograms=null;t.colormap=null;t.attributeTable=null;t.bandCount=999!==d||E?G:1;if(E=l.getOutputDomain(a)){t.statistics=
[];for(let m=0;m<t.bandCount;m++)t.statistics[m]={min:E[0],max:E[1],avg:(E[0]+E[1])/2,stddev:(E[0]+E[1])/10}}this.rasterInfo=t;return{success:!0,supportsGPU:1===t.bandCount&&3>=d&&(11>a||16<a)}};u._processPixels=function(d){({pixelBlocks:d}=d);return I.isNone(d)||d.some(t=>I.isNone(t))?null:l.local(d,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})};u._getWebGLParameters=function(){const {operation:d}=this.functionArguments,
t=l.operandsCount[d],G=Object.keys(P.localOperators).find(m=>P.localOperators[m]===d)?.toLowerCase()??"undefined";var E=this.outputPixelType??"f32";let [a,n]=B.getPixelValueRange(E);if(E=E.startsWith("u")||E.startsWith("s"))a-=1E-4,n+=1E-4;return{imageCount:t,operationName:G,domainRange:[a,n],isOutputRounded:E}};return N._createClass(h)}(p);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:c,json:{write:!0,name:"rasterFunctionArguments"}})],
y.prototype,"functionArguments",void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",void 0);return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.LocalFunction")],y)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L){var P;y=P=function(B){function p(){var l=c.apply(this,arguments);l.rasters=[];l.processAsMultiband=!0;return l}N._inherits(p,B);var c=N._createSuper(p);B=p.prototype;B.writeRasters=function(l,u){u.rasters=l.map(h=>"number"===typeof h||"string"===typeof h?h:h.toJSON())};B.clone=function(){return new P({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:I.clone(this.rasters)})};return N._createClass(p)}(L);D.__decorate([F.property({json:{write:!0}})],
y.prototype,"operation",void 0);D.__decorate([F.property({json:{write:!0}})],y.prototype,"rasters",void 0);D.__decorate([V.writer("rasters")],y.prototype,"writeRasters",null);D.__decorate([F.property({json:{write:!0}})],y.prototype,"processAsMultiband",void 0);return y=P=D.__decorate([O.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],y)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFunctionConstants",
"../rasterFormats/pixelRangeUtils"],function(N,D,I,F,y){function O(ca,ha=!1){var da=ca.map(ea=>ea.mask);const ka=da.filter(ea=>D.isSome(ea));var la=ca[0].pixels[0].length;if(0===ka.length)return(new Uint8Array(la)).fill(255);ca=new Uint8Array(ka[0]);if(1===ka.length)return ca;if(!ha){for(ha=1;ha<ka.length;ha++)for(da=ka[ha],la=0;la<ca.length;la++)ca[la]&&(ca[la]=da[la]?255:0);return ca}if(ka.length!==da.length)return(new Uint8Array(la)).fill(255);for(ha=1;ha<ka.length;ha++)for(da=ka[ha],la=0;la<ca.length;la++)0===
ca[la]&&(ca[la]=da[la]?255:0);return ca}function V(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]+la[ea];return da}function L(ca,ha,da){[ca]=ca;ha=I.createEmptyBand("f32",ca.length);ha.set(ca);return ha}function P(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]-la[ea];return da}function B(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,
ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]*la[ea];return da}function p(ca,ha,da){[ca]=ca;const ka=ca.length;da=I.createEmptyBand(da,ka);for(let la=0;la<ka;la++)if(!ha||ha[la])da[la]=Math.sign(ca[la])*Math.floor(Math.abs(ca[la]));return da}function c(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]/la[ea];return da}function l(ca,ha,da){return c(ca,ha,"f32")}function u(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,
ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=Math.floor(ka[ea]/la[ea]);return da}function h(ca,ha,da,ka){ca=ca[0];const la=ca.length;da=I.createEmptyBand(da,la);if(ka===F.localTrigonometricOperation.atanh){for(ka=0;ka<la;ka++)if(ha[ka]){var ea=ca[ka];1<=Math.abs(ea)?ha[ka]=0:da[ka]=Math.atanh(ea)}return da}ka=ka===F.localTrigonometricOperation.asin?Math.asin:Math.acos;for(ea=0;ea<la;ea++)if(ha[ea]){const na=ca[ea];1<Math.abs(na)?ha[ea]=0:da[ea]=ka(na)}return da}function r(ca,ha,da,ka){[ca]=ca;
const la=ca.length;da=I.createEmptyBand(da,la);for(let ea=0;ea<la;ea++)if(!ha||ha[ea])da[ea]=ka(ca[ea]);return da}function d(ca,ha,da,ka){const [la,ea]=ca;ca=la.length;da=I.createEmptyBand(da,ca);for(let na=0;na<ca;na++)if(!ha||ha[na])da[na]=ka(la[na],ea[na]);return da}function t(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]&la[ea];return da}function G(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=
0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]<<la[ea];return da}function E(ca,ha,da){[ca]=ca;const ka=ca.length;da=I.createEmptyBand(da,ka);for(let la=0;la<ka;la++)if(!ha||ha[la])da[la]=~ca[la];return da}function a(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]|la[ea];return da}function n(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]>>la[ea];return da}function m(ca,
ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]^la[ea];return da}function f(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]&&la[ea]?1:0;return da}function k(ca,ha,da){[ca]=ca;const ka=ca.length;da=I.createEmptyBand(da,ka);for(let la=0;la<ka;la++)if(!ha||ha[la])da[la]=ca[la]?0:1;return da}function g(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,
ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]||la[ea]?1:0;return da}function b(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=(ka[ea]?1:0)^(la[ea]?1:0);return da}function e(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]===la[ea]?1:0;return da}function v(ca,ha,da,ka){[ca]=ca;const la=ca.length;da=I.createEmptyBand(da,la);const ea=ka===Math.E;for(let na=
0;na<la;na++)if(!ha||ha[na])da[na]=ea?Math.exp(ca[na]):ka**ca[na];return da}function w(ca,ha,da){return v(ca,ha,da,10)}function C(ca,ha,da){return v(ca,ha,da,2)}function M(ca,ha,da){return v(ca,ha,da,Math.E)}function K(ca,ha,da,ka){[ca]=ca;const la=ca.length;da=I.createEmptyBand(da,la);for(let ea=0;ea<la;ea++)if(!ha||ha[ea])0>=ca[ea]?ha[ea]=0:da[ea]=ka(ca[ea]);return da}function x(ca,ha,da){return K(ca,ha,da,Math.log10)}function q(ca,ha,da){return K(ca,ha,da,Math.log2)}function A(ca,ha,da){return K(ca,
ha,da,Math.log)}function H(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]>la[ea]?1:0;return da}function Q(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]>=la[ea]?1:0;return da}function S(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]<la[ea]?1:0;return da}function z(ca,ha,da){const [ka,
la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]<=la[ea]?1:0;return da}function J(ca,ha,da){[ca]=ca;ca=ca.length;da=I.createEmptyBand(da,ca);if(!ha)return da;for(let ka=0;ka<ca;ka++)da[ka]=ha[ka]?0:1;return da}function R(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]%la[ea];return da}function W(ca,ha,da){[ca]=ca;const ka=ca.length;da=I.createEmptyBand(da,ka);for(let la=0;la<
ka;la++)if(!ha||ha[la])da[la]=-ca[la];return da}function Z(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let ea=0;ea<ca;ea++)if(!ha||ha[ea])da[ea]=ka[ea]===la[ea]?0:1;return da}function Y(ca,ha,da){const [ka,la]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);const ea=new Uint8Array(ca);for(let na=0;na<ca;na++)null!=ha&&!ha[na]||0!==ka[na]||(da[na]=la[na],ea[na]=255);return{band:da,mask:ea}}function X(ca,ha,da){const [ka,la,ea]=ca;ca=ka.length;da=I.createEmptyBand(da,ca);for(let na=
0;na<ca;na++)if(!ha||ha[na])da[na]=ka[na]?la[na]:ea[na];return da}function T(ca,ha,da){const ka=ca.length;if(2>ka)return ca[0];const [la]=ca,ea=la.length;da=I.createEmptyBand(da,ea);for(let na=0;na<ea;na++)if(!ha||ha[na]){let ra=la[na];for(let xa=1;xa<ka;xa++){const za=ca[xa][na];ra<za&&(ra=za)}da[na]=ra}return da}function U(ca,ha,da){const ka=ca.length;if(2>ka)return ca[0];const [la]=ca,ea=la.length;da=I.createEmptyBand(da,ea);for(let na=0;na<ea;na++)if(!ha||ha[na]){let ra=la[na];for(let xa=1;xa<
ka;xa++){const za=ca[xa][na];ra>za&&(ra=za)}da[na]=ra}return da}function aa(ca,ha,da){const ka=ca.length;if(2>ka)return ca[0];const [la]=ca,ea=la.length;da=I.createEmptyBand(da,ea);for(let na=0;na<ea;na++)if(!ha||ha[na]){let ra=la[na],xa=ra;for(let za=1;za<ka;za++){const Aa=ca[za][na];xa<Aa?xa=Aa:ra>Aa&&(ra=Aa)}da[na]=xa-ra}return da}function ba(ca,ha,da){const ka=ca.length;if(2>ka)return ca[0];var [la]=ca;la=la.length;da=I.createEmptyBand(da,la);for(let ea=0;ea<la;ea++)if(!ha||ha[ea]){let na=0;for(let ra=
0;ra<ka;ra++)na+=ca[ra][ea];da[ea]=na/ka}return da}function fa(ca,ha,da){const ka=ca.length;if(2>ka)return ca[0];var [la]=ca;la=la.length;da=I.createEmptyBand(da,la);for(let ea=0;ea<la;ea++)if(!ha||ha[ea])for(let na=0;na<ka;na++)da[ea]+=ca[na][ea];return da}function ja(ca,ha,da){const ka=ca.length;if(2>ka)return ca[0];var [la]=ca;la=la.length;da=I.createEmptyBand(da,la);for(let ra=0;ra<la;ra++)if(!ha||ha[ra]){const xa=new Float32Array(ka);let za=0;for(var ea=0;ea<ka;ea++){var na=ca[ea];za+=na[ra];
xa[ea]=na[ra]}za/=ka;ea=0;for(na=0;na<ka;na++)ea+=(xa[na]-za)**2;da[ra]=Math.sqrt(ea/ka)}return da}function ia(ca,ha,da){const ka=ca.length;if(2>ka)return ca[0];const la=Math.floor(ka/2);var [ea]=ca;ea=ea.length;da=I.createEmptyBand(da,ea);const na=new Float32Array(ka),ra=1===ka%2;for(let xa=0;xa<ea;xa++)if(!ha||ha[xa]){for(let za=0;za<ka;za++)na[za]=ca[za][xa];na.sort();da[xa]=ra?na[la]:(na[la]+na[la-1])/2}return da}function pa(ca,ha,da){const [ka,la]=ca;if(null==la)return ka;ca=ka.length;da=I.createEmptyBand(da,
ca);for(let ea=0;ea<ca;ea++)ha[ea]&&(ka[ea]===la[ea]?da[ea]=ka[ea]:ha[ea]=0);return da}function ma(ca,ha,da){const ka=ca.length;if(2>=ka)return pa(ca,ha,da);const la=ca[0].length;da=I.createEmptyBand(da,la);const ea=new Map;for(let ra=0;ra<la;ra++)if(!ha||ha[ra]){ea.clear();let xa;for(var na=0;na<ka;na++)xa=ca[na][ra],ea.set(xa,ea.has(xa)?ea.get(xa)+1:1);let za=na=0;for(const Aa of ea.keys())na=ea.get(Aa),na>za&&(za=na,xa=Aa);da[ra]=xa}return da}function sa(ca,ha,da){const ka=ca.length;if(2>=ka)return pa(ca,
ha,da);const la=ca[0].length;da=I.createEmptyBand(da,la);const ea=new Map;for(let ra=0;ra<la;ra++)if(!ha||ha[ra]){ea.clear();let xa;for(var na=0;na<ka;na++)xa=ca[na][ra],ea.set(xa,ea.has(xa)?ea.get(xa)+1:1);na=0;let za=ca.length;for(const Aa of ea.keys())na=ea.get(Aa),na<za&&(za=na,xa=Aa);da[ra]=xa}return da}function oa(ca,ha,da){const ka=ca.length;if(2>ka)return ca[0];var [la]=ca;la=la.length;da=I.createEmptyBand(da,la);const ea=new Set;for(let na=0;na<la;na++)if(!ha||ha[na]){ea.clear();let ra;for(let xa=
0;xa<ka;xa++)ra=ca[xa][na],ea.add(ra);da[na]=ea.size}return da}function wa(ca,ha,da,ka){let [la,ea]=y.getPixelValueRange(da);if(da=da.startsWith("u")||da.startsWith("s"))la-=1E-5,ea+=1E-5;for(let na=0;na<ha.length;na++)if(ha[na]){const ra=ca[na];isNaN(ra)||ra<la||ra>ea?ha[na]=0:ka[na]=da?Math.round(ra):ra}}const ta=new Map;ta.set(F.localTrigonometricOperation.acos,[0,Math.PI]);ta.set(F.localTrigonometricOperation.asin,[-Math.PI/2,Math.PI/2]);ta.set(F.localTrigonometricOperation.atan,[-Math.PI/2,Math.PI/
2]);ta.set(F.localTrigonometricOperation.cos,[-1,1]);ta.set(F.localTrigonometricOperation.sin,[-1,1]);ta.set(F.localLogicalOperation.booleanAnd,[0,1]);ta.set(F.localLogicalOperation.booleanNot,[0,1]);ta.set(F.localLogicalOperation.booleanOr,[0,1]);ta.set(F.localLogicalOperation.booleanXOr,[0,1]);ta.set(F.localLogicalOperation.equalTo,[0,1]);ta.set(F.localLogicalOperation.notEqual,[0,1]);ta.set(F.localLogicalOperation.greaterThan,[0,1]);ta.set(F.localLogicalOperation.greaterThanEqual,[0,1]);ta.set(F.localLogicalOperation.lessThan,
[0,1]);ta.set(F.localLogicalOperation.lessThanEqual,[0,1]);ta.set(F.localLogicalOperation.isNull,[0,1]);const ua=new Map,va=new Map,qa=new Map,ya=new Map;N.getOutputDomain=function(ca){return ta.get(ca)};N.local=function(ca,ha,da={}){ua.size||(ua.set(4,Math.sqrt),ua.set(6,Math.acos),ua.set(7,Math.asin),ua.set(8,Math.atan),ua.set(9,Math.atanh),ua.set(10,Math.abs),ua.set(21,Math.cos),ua.set(22,Math.cosh),ua.set(48,Math.floor),ua.set(49,Math.ceil),ua.set(51,Math.sin),ua.set(52,Math.sinh),ua.set(56,Math.tan),
ua.set(57,Math.tanh),ua.set(59,Math.acosh),ua.set(60,Math.asinh),ua.set(65,Math.floor),va.set(5,Math.pow),va.set(61,Math.atan2),qa.set(1,V),qa.set(2,P),qa.set(3,B),qa.set(11,t),qa.set(12,G),qa.set(12,G),qa.set(13,E),qa.set(14,a),qa.set(15,n),qa.set(16,m),qa.set(17,f),qa.set(18,k),qa.set(19,g),qa.set(20,b),qa.set(23,c),qa.set(24,e),qa.set(25,M),qa.set(26,w),qa.set(27,C),qa.set(28,H),qa.set(29,Q),qa.set(30,p),qa.set(31,J),qa.set(32,L),qa.set(33,S),qa.set(34,z),qa.set(35,A),qa.set(36,x),qa.set(37,q),
qa.set(44,R),qa.set(45,W),qa.set(46,Z),qa.set(64,l),qa.set(65,u),qa.set(76,X),qa.set(78,X),ya.set(38,ma),ya.set(39,T),ya.set(40,ba),ya.set(41,ia),ya.set(42,U),ya.set(43,sa),ya.set(47,aa),ya.set(54,ja),ya.set(55,fa),ya.set(58,oa),ya.set(66,ma),ya.set(67,T),ya.set(68,ba),ya.set(69,ia),ya.set(70,U),ya.set(71,sa),ya.set(72,aa),ya.set(73,ja),ya.set(74,fa),ya.set(75,oa));var ka=O(ca,66<=ha&&75>=ha);const {outputPixelType:la="f32"}=da,ea=!ya.has(ha)||da.processAsMultiband,na=ea?ca[0].pixels.length:1;da=
[];for(let za=0;za<na;za++){var ra=ya.has(ha)&&!ea?ca.flatMap(Aa=>Aa.pixels):ca.map(Aa=>Aa.pixels[za]),xa=!0;ha===F.localConditionalOperation.setNull?(ka=Y(ra,ka,la),ra=ka.band,ka=ka.mask,xa=!1):qa.has(ha)?ra=qa.get(ha)(ra,ka,"f64"):ua.has(ha)?ra=ha===F.localTrigonometricOperation.asin||ha===F.localTrigonometricOperation.acos||ha===F.localTrigonometricOperation.atanh?h(ra,ka,"f64",ha):r(ra,ka,"f64",ua.get(ha)):va.has(ha)?ra=d(ra,ka,"f64",va.get(ha)):ya.has(ha)?ra=ya.get(ha)(ra,ka,"f64"):(ra=ra[0],
xa=!1);xa&&ha!==F.localLogicalOperation.isNull&&!ta.has(ha)&&(xa=I.createEmptyBand(la,ra.length),ka||(ka=(new Uint8Array(ra.length)).fill(255)),wa(ra,ka,la,xa),ra=xa);da.push(ra)}ca=ca[0];return new I({width:ca.width,height:ca.height,pixelType:la,mask:ha===F.localLogicalOperation.isNull?null:ka,pixels:da})};N.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,
999,999,999,999,999,3,999,3];Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c){O=function(l){function u(){var r=h.apply(this,arguments);r.functionName="Mask";r.functionArguments=null;r.rasterArgumentNames=["raster"];return r}N._inherits(u,l);var h=N._createSuper(u);l=u.prototype;l._bindSourceRasters=function(){var r=this.sourceRasterInfos[0].clone();const {pixelType:d}=r;this.outputPixelType=this._getOutputPixelType(d);r.pixelType=this.outputPixelType;this.rasterInfo=r;const {includedRanges:t,normalizedNoDataValues:G}=this.functionArguments;
if(!t?.length&&!G?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};let E=[];for(let a=0;a<r.bandCount;a++){const n=c.createMaskLUT(d,t?.slice(2*a,2*a+2),G?.[a]);if(null==n){E=null;break}E.push(n)}this.lookups=E;r=null!=G&&G.every(a=>a?.length===G[0]?.length);return{success:!0,supportsGPU:(!t||t.length<=2*c.MAX_MAP_SIZE_GPU)&&(!G||r&&G[0].length<=c.MAX_MAP_SIZE_GPU)}};l._processPixels=function(r){r=r.pixelBlocks?.[0];if(F.isNone(r))return null;const {outputPixelType:d,
lookups:t}=this,{includedRanges:G,noDataInterpretation:E,normalizedNoDataValues:a}=this.functionArguments;return c.mask(r,{includedRanges:G,noDataValues:a,outputPixelType:d,matchAll:E===c.NoDataInterpretation.matchAll,lookups:t})};l._getWebGLParameters=function(){const {includedRanges:r,normalizedNoDataValues:d}=this.functionArguments,t=new Float32Array(c.MAX_MAP_SIZE_GPU);t.fill(I.NUMBER_MAX_FLOAT32);d?.[0]?.length&&t.set(d[0]);const G=new Float32Array(c.MAX_MAP_SIZE_GPU);for(let E=0;E<G.length;E+=
2)G[E]=r?.[E]??-I.NUMBER_MAX_FLOAT32,G[E+1]=r?.[E+1]??I.NUMBER_MAX_FLOAT32;r&&r.length&&G.set(r);return{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:t,includedRanges:G}};return N._createClass(u)}(B);D.__decorate([y.property({json:{write:!0,name:"rasterFunction"}})],O.prototype,"functionName",void 0);D.__decorate([y.property({type:p,json:{write:!0,name:"rasterFunctionArguments"}})],O.prototype,"functionArguments",void 0);D.__decorate([y.property()],O.prototype,"rasterArgumentNames",void 0);
D.__decorate([y.property({json:{write:!0}})],O.prototype,"lookups",void 0);return O=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.MaskFunction")],O)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(N,D,I,F,y,O,V,L,P){var B;F=B=function(p){function c(){var u=l.apply(this,arguments);u.includedRanges=null;u.noDataValues=null;u.noDataInterpretation=P.NoDataInterpretation.matchAny;return u}N._inherits(c,p);var l=N._createSuper(c);c.prototype.clone=function(){return new B({includedRanges:this.includedRanges?.slice()??[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})};N._createClass(c,[{key:"normalizedNoDataValues",get:function(){var {noDataValues:u}=
this;if(!u?.length)return null;let h=!1;u=u.map(r=>"number"===typeof r?(h=!0,[r]):"string"===typeof r?(r=r.trim().split(" ").filter(d=>""!==d.trim()).map(d=>Number(d)),h=h||0<r.length,0===r.length?null:r):null);return h?u:null}}]);return c}(L);D.__decorate([I.property({json:{write:!0}})],F.prototype,"includedRanges",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"noDataValues",void 0);D.__decorate([I.property()],F.prototype,"normalizedNoDataValues",null);D.__decorate([I.property({json:{write:!0}})],
F.prototype,"noDataInterpretation",void 0);return F=B=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],F)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p){y=function(c){function l(){var h=u.apply(this,arguments);h.functionName="NDVI";h.functionArguments=null;h.rasterArgumentNames=["raster"];return h}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c._bindSourceRasters=function(){const {scientificOutput:h}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(h?"f32":"u8");const r=this.sourceRasterInfos[0].clone();r.pixelType=this.outputPixelType;r.colormap=null;r.histograms=null;r.bandCount=1;const [d,
t,G,E]=h?[-1,1,0,.1]:[0,200,100,10];r.statistics=[{min:d,max:t,avg:G,stddev:E}];this.rasterInfo=r;return{success:!0,supportsGPU:!0}};c._processPixels=function(h){h=h.pixelBlocks?.[0];if(I.isNone(h))return null;const {visibleBandID:r,infraredBandID:d,scientificOutput:t}=this.functionArguments;return P.calculateNDVI(h,r,d,!t)};c._getWebGLParameters=function(){const {visibleBandID:h,infraredBandID:r,scientificOutput:d}=this.functionArguments;return{bandIndexMat3:P.getBandMatrix3(this.isInputBandIdsSwizzled?
[0,1,2]:[r,h,0]),scaled:!d}};c._getInputBandIds=function(h){const {visibleBandID:r,infraredBandID:d}=this.functionArguments;return[d,r,0].map(t=>h[t])};return N._createClass(l)}(B);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:p,json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",void 0);return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],
y)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(N,D,I,F,y,O,V,L){var P;F=P=function(B){function p(){var l=c.apply(this,arguments);l.visibleBandID=0;l.infraredBandID=1;
l.scientificOutput=!1;return l}N._inherits(p,B);var c=N._createSuper(p);p.prototype.clone=function(){const {visibleBandID:l,infraredBandID:u,scientificOutput:h}=this;return new P({visibleBandID:l,infraredBandID:u,scientificOutput:h})};return N._createClass(p)}(L);D.__decorate([I.property({json:{write:!0}})],F.prototype,"visibleBandID",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"infraredBandID",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"scientificOutput",
void 0);return F=P=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],F)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l){O=function(u){function h(){var d=r.apply(this,arguments);d.functionName="Remap";d.functionArguments=null;d.rasterArgumentNames=["raster"];d.lookup=null;return d}N._inherits(h,u);var r=N._createSuper(h);u=h.prototype;u._bindSourceRasters=function(){const d=this.sourceRasterInfos[0].clone(),{pixelType:t}=d;this.outputPixelType=this._getOutputPixelType(t);d.pixelType=this.outputPixelType;d.colormap=null;d.histograms=null;d.bandCount=1;d.attributeTable=null;const {statistics:G}=
d,{allowUnmatched:E,outputValues:a,inputRanges:n,noDataRanges:m,isLastInputRangeInclusive:f}=this.functionArguments;if(F.isSome(G)&&G.length&&a?.length)if(E){var k=Math.min.apply(null,[...a,G[0].min]),g=Math.max.apply(null,[...a,G[0].max]);d.statistics=[{...G[0],min:k,max:g}]}else{g=k=a[0];for(let b=0;b<a.length;b++)k=k>a[b]?a[b]:k,g=g>a[b]?g:a[b];d.statistics=[{...G[0],min:k,max:g}]}this.rasterInfo=d;this.lookup=E?null:c.createRemapLUT({srcPixelType:t,inputRanges:n,outputValues:a,noDataRanges:m,
allowUnmatched:E,isLastInputRangeInclusive:f,outputPixelType:this.outputPixelType});return{success:!0,supportsGPU:(!a||a.length<=c.MAX_MAP_SIZE_GPU)&&(!m||m.length<=c.MAX_MAP_SIZE_GPU)}};u._processPixels=function(d){d=d.pixelBlocks?.[0];if(F.isNone(d))return null;const {lookup:t,outputPixelType:G}=this;if(t){const k=c.lookupPixels(d,{lut:[t.lut],offset:t.offset,outputPixelType:G});F.isSome(k)&&t.mask&&(k.mask=c.lookupBandValues(d.pixels[0],d.mask,t.mask,t.offset,"u8"));return k}const {inputRanges:E,
outputValues:a,noDataRanges:n,allowUnmatched:m,isLastInputRangeInclusive:f}=this.functionArguments;return c.remap(d,{inputRanges:E,outputValues:a,noDataRanges:n,outputPixelType:G,allowUnmatched:m,isLastInputRangeInclusive:f})};u._getWebGLParameters=function(){const {allowUnmatched:d,noDataRanges:t,isLastInputRangeInclusive:G}=this.functionArguments,E=new Float32Array(3*c.MAX_MAP_SIZE_GPU);var a=this.functionArguments.inputRanges??[],n=this.functionArguments.outputValues??[];const m=n.length;for(let f=
0;f<c.MAX_MAP_SIZE_GPU;f++)if(E[3*f]=a[2*f]??I.NUMBER_MAX_FLOAT32-1,E[3*f+1]=a[2*f+1]??I.NUMBER_MAX_FLOAT32,E[3*f+2]=n[f]??0,f<m&&(0<f&&(E[3*f]-=1E-5),f<m-1||!G))E[3*f+1]-=1E-5;a=new Float32Array(2*c.MAX_MAP_SIZE_GPU);a.fill(I.NUMBER_MAX_FLOAT32);t?.length&&a.set(t);n=B.getPixelValueRange(this.outputPixelType);return{allowUnmatched:d,rangeMaps:E,noDataRanges:a,clampRange:n}};return N._createClass(h)}(p);D.__decorate([y.property({json:{write:!0,name:"rasterFunction"}})],O.prototype,"functionName",
void 0);D.__decorate([y.property({type:l,json:{write:!0,name:"rasterFunctionArguments"}})],O.prototype,"functionArguments",void 0);D.__decorate([y.property()],O.prototype,"rasterArgumentNames",void 0);D.__decorate([y.property({json:{write:!0}})],O.prototype,"lookup",void 0);return O=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.RemapFunction")],O)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L){var P;F=P=function(B){function p(){var l=c.apply(this,arguments);l.inputRanges=null;l.outputValues=null;l.noDataRanges=null;l.allowUnmatched=!1;l.isLastInputRangeInclusive=!1;return l}N._inherits(p,B);var c=N._createSuper(p);p.prototype.clone=function(){return new P({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})};return N._createClass(p)}(L);
D.__decorate([I.property({json:{write:!0}})],F.prototype,"inputRanges",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"outputValues",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"noDataRanges",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"allowUnmatched",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"isLastInputRangeInclusive",void 0);return F=P=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],
F)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),function(N,D,I,F,y,O,V,L,P,B,p){const c=1/111E3;y=function(l){function u(){var r=
h.apply(this,arguments);r.functionName="Slope";r.functionArguments=null;r.rasterArgumentNames=["raster"];r.isGCS=!1;return r}N._inherits(u,l);var h=N._createSuper(u);l=u.prototype;l._bindSourceRasters=function(){this.outputPixelType=this._getOutputPixelType("f32");const r=this.sourceRasterInfos[0].clone();r.pixelType=this.outputPixelType;r.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null;r.histograms=null;r.colormap=null;r.attributeTable=null;r.bandCount=
1;this.rasterInfo=r;this.isGCS=r.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}};l._processPixels=function(r){const d=r.pixelBlocks?.[0];if(I.isNone(d))return null;const {zFactor:t,slopeType:G,pixelSizePower:E,pixelSizeFactor:a}=this.functionArguments,{isGCS:n}=this,{extent:m,primaryPixelSizes:f}=r;r=f?.[0];r=I.isNone(r)?m?{x:m.width/d.width,y:m.height/d.height}:{x:1,y:1}:r;return p.slope(d,{zFactor:t,slopeType:G,pixelSizePower:E,pixelSizeFactor:a,isGCS:n,resolution:r})};l._getWebGLParameters=
function(){const {zFactor:r,slopeType:d,pixelSizeFactor:t,pixelSizePower:G}=this.functionArguments;return{zFactor:this.isGCS&&1<=r?r*c:r,slopeType:d,pixelSizeFactor:t??0,pixelSizePower:G??0}};return N._createClass(u)}(P);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",
void 0);D.__decorate([F.property({json:{write:!0}})],y.prototype,"isGCS",void 0);return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],y)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L,P,B){var p;I=new I.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});B=p=function(c){function l(){var h=u.apply(this,arguments);h.slopeType="degree";h.zFactor=1;h.pixelSizePower=.664;h.pixelSizeFactor=.024;h.removeEdgeEffect=!1;return h}N._inherits(l,c);var u=N._createSuper(l);l.prototype.clone=function(){return new p({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,
raster:this.raster})};return N._createClass(l)}(B);D.__decorate([L.enumeration(I)],B.prototype,"slopeType",void 0);D.__decorate([F.property({type:Number,json:{write:!0}})],B.prototype,"zFactor",void 0);D.__decorate([F.property({type:Number,json:{name:"psPower",write:!0}})],B.prototype,"pixelSizePower",void 0);D.__decorate([F.property({type:Number,json:{name:"psZFactor",write:!0}})],B.prototype,"pixelSizeFactor",void 0);D.__decorate([F.property({type:Boolean,json:{write:!0}})],B.prototype,"removeEdgeEffect",
void 0);return B=p=D.__decorate([P.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],B)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L,P){F=function(B){function p(){var l=c.apply(this,arguments);l.functionName="StatisticsHistogram";l.functionArguments=null;l.rasterArgumentNames=["raster"];l.isNoopProcess=!0;return l}N._inherits(p,B);var c=N._createSuper(p);B=p.prototype;B._bindSourceRasters=function(){var l=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");l=l.clone();const {statistics:u,histograms:h}=this.functionArguments;h&&(l.histograms=h);u&&(l.statistics=u);this.rasterInfo=
l;return{success:!0,supportsGPU:!0}};B._processPixels=function(l){return l.pixelBlocks?.[0]};return N._createClass(p)}(L);D.__decorate([I.property({json:{write:!0,name:"rasterFunction"}})],F.prototype,"functionName",void 0);D.__decorate([I.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],F.prototype,"functionArguments",void 0);D.__decorate([I.property()],F.prototype,"rasterArgumentNames",void 0);D.__decorate([I.property({json:{write:!0}})],F.prototype,"indexedColormap",void 0);D.__decorate([I.property()],
F.prototype,"isNoopProcess",void 0);return F=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],F)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L,P){var B;y=B=function(p){function c(){var u=l.apply(this,arguments);u.statistics=null;u.histograms=null;return u}N._inherits(c,p);var l=N._createSuper(c);p=c.prototype;p.readStatistics=function(u,h){if(!u?.length)return null;const r=[];u.forEach(d=>{r.push({min:d.min,max:d.max,avg:d.avg??d.mean,stddev:d.stddev??d.standardDeviation})});return r};p.writeStatistics=function(u,h,r){if(u?.length){var d=[];u.forEach(t=>{t={...t,mean:t.avg,standardDeviation:t.stddev};delete t.avg;
delete t.stddev;d.push(t)});h[r]=d}};p.clone=function(){return new B({statistics:I.clone(this.statistics),histograms:I.clone(this.histograms)})};return N._createClass(c)}(P);D.__decorate([F.property({json:{write:!0}})],y.prototype,"statistics",void 0);D.__decorate([O.reader("statistics")],y.prototype,"readStatistics",null);D.__decorate([L.writer("statistics")],y.prototype,"writeStatistics",null);D.__decorate([F.property({json:{write:!0}})],y.prototype,"histograms",void 0);return y=B=D.__decorate([V.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],
y)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),function(N,D,I,F,y,O,V,L,P,B,p,c){y=function(l){function u(){var r=
h.apply(this,arguments);r.functionName="Stretch";r.functionArguments=null;r.rasterArgumentNames=["raster"];r.lookup=null;r.cutOffs=null;return r}N._inherits(u,l);var h=N._createSuper(u);l=u.prototype;l._bindSourceRasters=function(){this.cutOffs=this.lookup=null;var r=this.sourceRasterInfos[0];const {pixelType:d}=r;var {functionArguments:t}=this;const {dynamicRangeAdjustment:G,gamma:E,useGamma:a}=t;if(!G&&["u8","u16","s8","s16"].includes(d)){t=c.getStretchCutoff(t.toJSON(),{rasterInfo:r});const n=
this._isOutputRoundingNeeded()?"round":"float";this.lookup=c.createStretchLUT({pixelType:d,...t,gamma:a?E:null,rounding:n});this.cutOffs=t}else G||(this.cutOffs=c.getStretchCutoff(t.toJSON(),{rasterInfo:r}));this.outputPixelType=this._getOutputPixelType(d);r=r.clone();r.pixelType=this.outputPixelType;r.statistics=null;r.histograms=null;r.colormap=null;r.attributeTable=null;"u8"===this.outputPixelType&&(r.keyProperties.DataType="processed");this.rasterInfo=r;return{success:!0,supportsGPU:!G}};l._processPixels=
function(r){r=r.pixelBlocks?.[0];if(I.isNone(r))return r;var {lookup:d}=this;if(d)return B.lookupPixels(r,{...d,outputPixelType:this.rasterInfo.pixelType});({functionArguments:d}=this);const t=this.cutOffs||c.getStretchCutoff(d.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:r});return c.stretch(r,{...t,gamma:d.useGamma?d.gamma:null,outputPixelType:this.outputPixelType})};l._getWebGLParameters=function(){const {outputMin:r=0,outputMax:d=255,gamma:t,useGamma:G}=this.functionArguments,E=2<=
this.rasterInfo.bandCount?3:1,a=G&&t&&t.length?c.computeGammaCorrection(E,t):[1,1,1],{minCutOff:n,maxCutOff:m}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===n.length&&(n[1]=n[2]=n[0],m[1]=m[2]=m[0]);const f=new Float32Array(E);var k;for(k=0;k<E;k++)f[k]=(d-r)/(m[k]-n[k]);k=this._isOutputRoundingNeeded();return{bandCount:E,outMin:r,outMax:d,minCutOff:n,maxCutOff:m,factor:f,useGamma:G,gamma:G&&t?t:[1,1,1],gammaCorrection:G&&a?a:[1,1,1],stretchType:this.functionArguments.stretchType,
isOutputRounded:k,type:"stretch"}};return N._createClass(u)}(P);D.__decorate([F.property({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0);D.__decorate([F.property({type:p,json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",void 0);D.__decorate([F.property()],y.prototype,"rasterArgumentNames",void 0);D.__decorate([F.property({json:{write:!0}})],y.prototype,"lookup",void 0);D.__decorate([F.property({json:{write:!0}})],y.prototype,"cutOffs",void 0);
return y=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.StretchFunction")],y)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(N,D,I,F,y,O,V,L,P,B){var p;I=new I.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});B=p=function(c){function l(){var h=u.apply(this,arguments);h.computeGamma=!1;h.dynamicRangeAdjustment=!1;h.gamma=[];h.histograms=null;h.statistics=null;h.stretchType="none";h.useGamma=!1;return h}N._inherits(l,c);var u=N._createSuper(l);c=l.prototype;c.writeStatistics=function(h,r,d){h?.length&&(Array.isArray(h[0])||(h=h.map(t=>
[t.min,t.max,t.avg,t.stddev])),r[d]=h)};c.clone=function(){return new p({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:F.clone(this.statistics),gamma:F.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:F.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,
raster:this.raster})};return N._createClass(l)}(B);D.__decorate([y.property({type:Boolean,json:{write:!0}})],B.prototype,"computeGamma",void 0);D.__decorate([y.property({type:Boolean,json:{name:"dra",write:!0}})],B.prototype,"dynamicRangeAdjustment",void 0);D.__decorate([y.property({type:[Number],json:{write:!0}})],B.prototype,"gamma",void 0);D.__decorate([y.property()],B.prototype,"histograms",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],B.prototype,"maxPercent",void 0);D.__decorate([y.property({type:Number,
json:{write:!0}})],B.prototype,"minPercent",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],B.prototype,"numberOfStandardDeviations",void 0);D.__decorate([y.property({type:Number,json:{name:"max",write:!0}})],B.prototype,"outputMax",void 0);D.__decorate([y.property({type:Number,json:{name:"min",write:!0}})],B.prototype,"outputMin",void 0);D.__decorate([y.property({type:Number,json:{write:!0}})],B.prototype,"sigmoidStrengthLevel",void 0);D.__decorate([y.property({json:{type:[[Number]],
write:!0}})],B.prototype,"statistics",void 0);D.__decorate([P.writer("statistics")],B.prototype,"writeStatistics",null);D.__decorate([V.enumeration(I)],B.prototype,"stretchType",void 0);D.__decorate([y.property({type:Boolean,json:{write:!0}})],B.prototype,"useGamma",void 0);return B=p=D.__decorate([L.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],B)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils",
"../../../renderers/support/stretchRendererUtils"],function(N,D,I,F,y){function O(c,l=256){l=Math.min(l,256);const {size:u,counts:h}=c;c=new Uint8Array(u);var r=h.reduce((a,n)=>a+n/l,0);let d=0;var t=0;let G=0,E=r;for(let a=0;a<u;a++)if(G+=h[a],!(a<u-1&&G+h[a+1]<E)){for(;d<l-1&&E<G;)d++,E+=r;for(;t<=a;t++)c[t]=d;t=a+1}for(r=t;r<u;r++)c[r]=l-1;return c}function V(c,l){c=Math.min(Math.max(c,-100),100);l=Math.min(Math.max(l??0,-100),100);let u=0,h=0;const r=new Uint8Array(256);for(u=0;256>u;u++)0<c&&
100>c?h=(200*u-25500+510*l)/(2*(100-c))+128:0>=c&&-100<c?h=(200*u-25500+510*l)*(100+c)/2E4+128:100===c?(h=200*u-25500+256*(100-c)+510*l,h=0<h?255:0):-100===c&&(h=128),r[u]=255<h?255:0>h?0:h;return r}function L(c){if(D.isNone(c)||!c.pixels?.length)return null;const {pixels:l,mask:u,pixelType:h}=c,r=c.width*c.height,d=l.length;let t,G;let E;var a;const n=[],m=[];for(E=0;E<d;E++){var f=new Uint32Array(256);var k=l[E];if("u8"===h)if(t=-.5,G=255.5,u)for(a=0;a<r;a++)u[a]&&f[k[a]]++;else for(a=0;a<r;a++)f[k[a]]++;
else{a=!1;c.statistics||(c.updateStatistics(),a=!0);var g=c.statistics;t=g[E].minValue;G=g[E].maxValue;var b=(G-t)/256;if(0===b)for(!g||c.validPixelCount||a||c.updateStatistics(),b=(c.validPixelCount||c.width*c.height)/256,a=0;256>a;a++)f[a]=Math.round(b*(a+1))-Math.round(b*a);else{g=new Uint32Array(257);for(a=0;a<r;a++)u&&!u[a]||g[Math.floor((k[a]-t)/b)]++;for(a=0;255>a;a++)f[a]=g[a];f[255]=g[255]+g[256]}}n.push({min:t,max:G,size:256,counts:f});for(a=g=k=b=0;256>a;a++)b+=f[a],k+=a*f[a];k/=b;for(a=
0;256>a;a++)g+=f[a]*(a-k)**2;a=Math.sqrt(g/(b-1));b=(G-t)/256;f=(k+.5)*b+t;b*=a;m.push({min:t,max:G,avg:f,stddev:b})}return{statistics:m,histograms:n}}function P(c,l){if(null==l||0===l.length)return c;const u=Math.max.apply(null,l),{minCutOff:h,maxCutOff:r,outMin:d,outMax:t,histogramLut:G}=c;return h.length===l.length||h.length<=u?c:{minCutOff:l.map(E=>h[E]),maxCutOff:l.map(E=>r[E]),histogramLut:G?l.map(E=>G[E]):null,outMin:d,outMax:t}}function B(c,l){const u=new Float32Array(c);for(let h=0;h<c;h++)u[h]=
1<l[h]?2<l[h]?6.5+(l[h]-2)**2.5:6.5+100*(2-l[h])**4:1;return u}const p=[.299,.587,.114];N.computeGammaCorrection=B;N.computeGammaValues=function(c,l,u){const h=[];for(let E=0;E<l.length;E++){var r=0,d=0,t=0;"min"in l[E]?{min:r,max:d,avg:t}=l[E]:[r,d,t]=l[E];t=t??0;"u8"!==c&&(t=255*(t-r)/(d-r));u&&(t*=p[E]);r=h;d=r.push;if(0>=t||255<=t)t=1;else{var G=0;150!==t&&(G=150>=t?45*Math.cos(.01047*t):17*Math.sin(.021*t));G=Math.log((t+G)/255);0===G?t=1:(t=Math.log(t/255)/G,t=isNaN(t)?1:Math.min(9.9,Math.max(.01,
t)))}d.call(r,t)}return h};N.createContrastBrightnessLUT=V;N.createHistogramEqualizationLUT=O;N.createStretchLUT=function(c){const {minCutOff:l,maxCutOff:u,gamma:h,pixelType:r,rounding:d}=c,t=c.outMin||0,G=c.outMax||255;if(!["u8","u16","s8","s16"].includes(r))return null;const E=l.length;let a,n,m=0;"s8"===r?m=-127:"s16"===r&&(m=-32767);let f=256;["u16","s16"].includes(r)&&(f=65536);var k=[],g=[];const b=G-t;for(a=0;a<E;a++)g[a]=u[a]-l[a],k[a]=0===g[a]?0:b/g[a];let e;const v=[];let w,C;if(h&&h.length>=
E)for(k=B(E,h),a=0;a<E;a++){C=[];for(n=0;n<f;n++)if(0===g[a])C[n]=t;else{var M=n+m;e=(M-l[a])/g[a];w=1;1<h[a]&&(w-=(1/b)**(e*k[a]));M<u[a]&&M>l[a]?(M=w*b*e**(1/h[a])+t,C[n]="floor"===d?Math.floor(M):"round"===d?Math.round(M):M):C[n]=M>=u[a]?G:t}v[a]=C}else for(a=0;a<E;a++){C=[];for(n=0;n<f;n++)M=n+m,M<=l[a]?C[n]=t:M>=u[a]?C[n]=G:(g=(M-l[a])*k[a]+t,C[n]="floor"===d?Math.floor(g):"round"===d?Math.round(g):g);v[a]=C}if(null!=c.contrastOffset)for(c=V(c.contrastOffset,c.brightnessOffset),a=0;a<E;a++)for(C=
v[a],n=0;n<f;n++)C[n]=c[C[n]];return{lut:v,offset:m}};N.estimateStatisticsFromHistograms=function(c){const l=[];for(let d=0;d<c.length;d++){const {min:t,max:G,size:E,counts:a}=c[d];let n=0;var u=0;for(var h=0;h<E;h++)n+=a[h],u+=h*a[h];u/=n;h=0;for(var r=0;r<E;r++)h+=a[r]*(r-u)**2;r=(G-t)/E;l.push({min:t,max:G,avg:(u+.5)*r+t,stddev:Math.sqrt(h/(n-1))*r})}return l};N.estimateStatisticsHistograms=L;N.getStretchCutoff=function(c,l){const {pixelBlock:u,bandIds:h,returnHistogramLut:r,rasterInfo:d}=l;var t=
null;l=null;var G=c.stretchType;"number"===typeof G&&(G=y.stretchTypeFunctionEnum[G]);c.dra?"minMax"===G&&D.isSome(u)&&u.statistics?t=u.statistics.map(M=>[M.minValue,M.maxValue,0,0]):(l=L(u),t=D.isSome(l)?l.statistics:null,l=D.isSome(l)?l.histograms:null):(t=0<c.statistics?.length?c.statistics:D.unwrap(d.statistics),l=c.histograms||D.unwrap(d.histograms));"percentClip"!==G&&"histogramEqualization"!==G||l?.length||(G="minMax");var E=t?.length||l?.length||d.bandCount;const a=[],n=[];let m;let f,k,g,
b;t&&!Array.isArray(t[0])&&(t=t.map(M=>[M.min,M.max,M.avg,M.stddev]));const [e,v]=F.getPixelValueRange(d.pixelType);if(!t?.length){t=[];for(g=0;g<E;g++)t.push([e,v,1,1]);"standardDeviation"===G&&(G="minMax")}switch(G){case "none":for(g=0;g<E;g++)a[g]=e,n[g]=v;break;case "minMax":for(g=0;g<E;g++)a[g]=t[g][0],n[g]=t[g][1];break;case "standardDeviation":for(g=0;g<E;g++)a[g]=t[g][2]-c.numberOfStandardDeviations*t[g][3],n[g]=t[g][2]+c.numberOfStandardDeviations*t[g][3],a[g]<t[g][0]&&(a[g]=t[g][0]),n[g]>
t[g][1]&&(n[g]=t[g][1]);break;case "histogramEqualization":D.assertIsSome(l);for(g=0;g<E;g++)a[g]=l[g].min,n[g]=l[g].max;break;case "percentClip":D.assertIsSome(l);for(g=0;g<l.length;g++){t=l[g];f=new Uint32Array(t.size);var w=[...t.counts];20<=w.length&&(w[0]=w[1]=w[2]=w[w.length-1]=w[w.length-2]=0);m=0;E=(t.max-t.min)/t.size;k=-.5===t.min&&1===E?.5:0;for(b=0;b<t.size;b++)m+=w[b],f[b]=m;w=(c.minPercent||0)*m/100;a[g]=t.min+k;for(b=0;b<t.size;b++)if(f[b]>w){a[g]=t.min+E*(b+k);break}w=(1-(c.maxPercent||
0)/100)*m;n[g]=t.max+k;for(b=t.size-2;0<=b;b--)if(f[b]<w){n[g]=t.min+E*(b+2-k);break}n[g]<a[g]&&(t=a[g],a[g]=n[g],n[g]=t)}break;default:for(g=0;g<E;g++)a[g]=t[g][0],n[g]=t[g][1]}let C;"histogramEqualization"===G?(D.assertIsSome(l),G=l[0].size||256,c=0,r&&(C=l.map(M=>O(M)))):(G=c.max||255,c=c.min||0);return P({minCutOff:a,maxCutOff:n,outMax:G,outMin:c,histogramLut:C},h)};N.stretch=function(c,l){if(D.isNone(c)||!c.pixels?.length)return c;const {mask:u,width:h,height:r,pixels:d}=c,{minCutOff:t,maxCutOff:G,
gamma:E}=l;var a=l.outMin||0;const n=l.outMax||255,m=h*r,f=l.outputPixelType||"u8";c=c.pixels.map(()=>I.createEmptyBand(f,m));const k=c.length;let g;let b,e;var v=n-a,w=[];const C=[];for(g=0;g<k;g++)C[g]=G[g]-t[g],w[g]=0===C[g]?0:v/C[g];const M=f.startsWith("u")||f.startsWith("s"),K=!!l.isRenderer;if(E&&E.length>=k)for(w=B(k,E),l=0;l<m;l++){if(null==u||u[l])for(g=0;g<k;g++)if(0===C[g])c[g][l]=a;else{var x=d[g][l];e=(x-t[g])/C[g];b=1;1<E[g]&&(b-=(1/v)**(e*w[g]));x<G[g]&&x>t[g]?(x=b*v*e**(1/E[g])+a,
c[g][l]=K?Math.floor(x):M?Math.round(x):x):c[g][l]=x>=G[g]?n:a}}else for(l=0;l<m;l++)if(null==u||u[l])for(g=0;g<k;g++)x=d[g][l],x<G[g]&&x>t[g]?(v=(x-t[g])*w[g]+a,c[g][l]=K?Math.floor(v):M?Math.round(v):v):c[g][l]=x>=G[g]?n:a;a=new I({width:h,height:r,mask:u,pixels:c,pixelType:f});a.updateStatistics();return a};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rasterRendererHelper":function(){define("exports ../../Color ../../rasterRenderers ../../core/maybe ../../core/unitUtils ../../layers/support/Field ../../layers/support/RasterInfo ../FlowRenderer ./AuthoringInfo ./ClassBreakInfo ./colorRampUtils ./UniqueValueInfo ../../rest/support/ClassBreaksDefinition ../../rest/support/generateRendererUtils ../../rest/support/MultipartColorRamp ../RasterStretchRenderer ../UniqueValueRenderer ../RasterColormapRenderer ../RasterShadedReliefRenderer ../ClassBreaksRenderer ../VectorFieldRenderer".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a){function n(T,U){T=m(T,U?.variableName);const {bandCount:aa}=T;let {bandIds:ba,stretchType:fa}=U||{};ba?.some(sa=>sa>=aa)&&(ba=null);let ja=F.unwrap(T.statistics),ia=F.unwrap(T.histograms);1<aa?(ba=ba?.length?ba:f(T),ja=null==ja?null:ba?.map(sa=>ja[sa]),ia=null==ia?null:ba?.map(sa=>ia[sa])):ba=[0];null==fa&&(fa=g(T));let pa=!1;switch(fa){case "none":pa=!1;break;case "percent-clip":pa=!ia?.length;break;default:pa=!ja?.length}var {dataType:ma}=T;ma=
1===ba?.length&&Y.has(ma)?W:null;ma=new r({stretchType:fa,dynamicRangeAdjustment:pa,colorRamp:ma,outputMin:0,outputMax:255,gamma:1===ba?.length?[1]:[1,1,1],useGamma:!1});"percent-clip"===fa?ma.maxPercent=ma.minPercent=.25:"standard-deviation"===fa&&(ma.numberOfStandardDeviations=2);if(!pa&&(F.isSome(T.multidimensionalInfo)||U?.includeStatisticsInStretch))if("percent-clip"===fa)ma.histograms=ia;else if("min-max"===fa||"standard-deviation"===fa)ma.statistics=ja;return ma}function m(T,U){if(!U)return T;
let aa=F.unwrap(T.statistics),ba=F.unwrap(T.histograms);var {multidimensionalInfo:fa}=T;if(U&&F.isSome(fa)&&(fa=fa.variables.find(ja=>ja.name===U))){const {statistics:ja,histograms:ia}=fa;ja?.length&&(aa=ja);ia?.length&&(ba=ia)}return V.fromJSON({...T.toJSON(),statistics:aa,histograms:ba})}function f(T){const U=T.bandCount;if(1===U)return null;if(2===U)return[0];T=T.keyProperties&&T.keyProperties.BandProperties;let aa;if(T&&T.length===U){const {red:ba,green:fa,blue:ja,nir:ia}=k(T);null!=ba&&null!=
fa&&null!=ja?aa=[ba,fa,ja]:null!=ia&&null!=ba&&null!=fa&&(aa=[ia,ba,fa])}!aa&&3<=U&&(aa=[0,1,2]);return aa}function k(T){const U={};for(let fa=0;fa<T.length;fa++){var aa=T[fa],ba=aa.BandName?.toLowerCase();"red"===ba?U.red=fa:"green"===ba?U.green=fa:"blue"===ba?U.blue=fa:"nearinfrared"===ba||"nearinfrared_1"===ba||"nir"===ba?U.nir=fa:aa.WavelengthMax&&aa.WavelengthMin&&(ba=aa.WavelengthMin,aa=aa.WavelengthMax,null==U.blue&&410<=ba&&480>=ba&&480<=aa&&540>=aa?U.blue=fa:null==U.green&&490<=ba&&560>=
ba&&560<=aa&&610>=aa?U.green=fa:null==U.red&&595<=ba&&670>=ba&&660<=aa&&730>=aa?U.red=fa:null==U.nir&&700<=ba&&860>=ba&&800<=aa&&950>=aa&&(U.nir=fa))}return U}function g(T){let U="percent-clip";const {pixelType:aa,dataType:ba,histograms:fa,statistics:ja,multidimensionalInfo:ia}=T;T=Y.has(ba)||"generic"===ba&&F.isSome(ia);"u8"!==aa||"processed"!==ba&&F.isSome(fa)&&F.isSome(ja)?"u8"===aa||"elevation"===ba||T?U="min-max":F.isSome(fa)?U="percent-clip":F.isSome(ja)&&(U="min-max"):U="none";return U}function b(T,
U,aa,ba){if(!C(T,U))return null;const {attributeTable:fa,statistics:ja}=T,ia=e(fa,U),pa=w(fa,"red"),ma=w(fa,"green"),sa=w(fa,"blue");T=new P;const oa=[],wa=new Set,ta=!!(pa&&ma&&sa);if(F.isSome(fa))fa.features.forEach(ua=>{var va=ua.attributes[ia.name];wa.has(ua.attributes[ia.name])||null==va||(wa.add(va),va=!ta||"single"!==pa.type&&"double"!==pa.type||"single"!==ma.type&&"double"!==ma.type||"single"!==sa.type&&"double"!==sa.type||fa.features.some(qa=>1<qa.attributes[pa.name]||1<qa.attributes[ma.name]||
1<qa.attributes[sa.name])?1:255,oa.push(new c({value:ua.attributes[ia.name],label:ua.attributes[ia.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:ta?new D([ua.attributes[pa.name]*va,ua.attributes[ma.name]*va,ua.attributes[sa.name]*va,1]):new D([0,0,0,0])}})))});else if(ja?.[0])for(U=ja[0].min;U<=ja[0].max;U++)oa.push(new c({value:U,label:U.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new D([0,0,0,0])}}));oa.sort((ua,va)=>ua.value&&"string"===typeof ua.value.valueOf()?
0:ua.value>va.value?1:-1);if(!ta){const ua=p.convertColorRampToColormap(Z,{numColors:oa.length});oa.forEach((va,qa)=>va.symbol.color=new D(ua[qa].slice(1,4)));T.colorRamp=Z}if(aa||ba){const ua=aa||p.convertColorRampToColormap(ba,{numColors:oa.length}).map(va=>va.slice(1));oa.forEach((va,qa)=>va.symbol.color=new D(ua[qa]));T.colorRamp=ba}return new d({field:ia.name,uniqueValueInfos:oa,authoringInfo:T})}function e(T,U,aa){let ba;F.isSome(T)?(ba=U?T.fields.find(fa=>U.toLowerCase()===fa.name.toLowerCase()):
v(T.fields),ba||(aa||(ba=T.fields.find(fa=>"string"===fa.type)),ba||(ba=w(T,"value")))):ba=new O({name:"value"});return ba}function v(T){let U;for(let aa=0;aa<T.length;aa++){const ba=T[aa].name.toLowerCase();if("string"===T[aa].type){if(ba.startsWith("class")){U=T[aa];break}null==U&&(ba.endsWith("name")||ba.endsWith("type"))&&(U=T[aa])}}return U}function w(T,U){return F.isNone(T)?null:T.fields.find(aa=>aa.name.toLowerCase()===U)}function C(T,U){const {attributeTable:aa,bandCount:ba}=T;return F.isNone(aa)&&
H(T)?!0:F.isNone(aa)||1<ba||U&&null==aa.fields.find(fa=>fa.name.toLowerCase()===U.toLowerCase())?!1:!0}function M(T){const {bandCount:U,colormap:aa}=T;return F.isSome(aa)&&0<aa.length&&1===U}function K(T){if(!M(T))return null;let U;const {attributeTable:aa,colormap:ba}=T;if(F.isSome(aa)){const fa=w(aa,"value"),ja=e(aa,null,!0);"string"===ja.type&&(U={},aa.features.forEach(ia=>{ia=ia.attributes;U[ia[fa.name]]=ja?ia[ja.name]:ia[fa.name]}))}return t.createFromColormap(F.unwrap(ba),U)}function x(T){const {bandCount:U,
dataType:aa,pixelType:ba}=T;return"elevation"===aa||"generic"===aa&&1===U&&("s16"===ba||"s32"===ba||"f32"===ba||"f64"===ba)}function q(T,U=!1){const {attributeTable:aa,bandCount:ba}=T;return 1===ba&&(!U||F.isSome(aa)||F.isSome(T.histograms))}function A(T,U,aa){let ba=0,fa=0;F.isSome(T.attributeTable)?(T=T.attributeTable,ba=fa=T.features[0].attributes[U.name],T.features.forEach(ja=>{ja=ja.attributes[U.name];ja<ba&&(ba=ja);ja>fa&&(fa=ja)})):F.isSome(T.histograms)&&(T=T.histograms,ba=T[0].min,fa=T[0].max);
return(fa-ba)/aa}function H(T){return["u8","s8"].includes(T.pixelType)&&null!=T.statistics?.[0]?.min&&null!=T.statistics[0]?.max&&1===T.bandCount}function Q(T){({dataType:T}=T);return"vector-uv"===T||"vector-magdir"===T}function S(T){({dataType:T}=T);return"vector-uv"===T||"vector-magdir"===T}function z(T){if(!Q(T))return null;if(F.isSome(T.statistics)&&T.statistics.length&&("vector-magdir"===T.dataType||"vector-uv"===T.dataType)){const {minMagnitude:aa,maxMagnitude:ba}=R(T.dataType,T.statistics);
var U=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:aa,maxDataValue:ba}]}T=F.isSome(T.multidimensionalInfo)?X.get(T.multidimensionalInfo.variables[0].unit):null;U=new a({visualVariables:U,inputUnit:T,rotationType:"geographic"});U.visualVariables=[...U.sizeVariables,...U.rotationVariables];return U}function J(T){return{color:T.symbolLayers[0].material?.color,type:"esriSFS",style:"esriSFSSolid"}}function R(T,U){if("vector-magdir"===T)T=U[0].min,U=U[0].max;else{const aa=U[0].min,
ba=U[0].max,fa=U[1].min;U=U[1].max;T=0;U=Math.max(Math.abs(aa),Math.abs(fa),Math.abs(ba),Math.abs(U))}return{minMagnitude:T,maxMagnitude:U}}const W=h.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),Z=h.fromJSON(p.PREDEFINED_JSON_COLOR_RAMPS[0]),Y=new Set("scientific standard-time vector-uv vector-magdir vector-u vector-v vector-magnitude vector-direction".split(" ")),X=new Map([["m/s",
"meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);N.createClassBreaksRenderer=function(T,U){T=m(T,U?.variableName);const {attributeTable:aa}=T;if(!q(T))return null;const ba=F.isSome(T.histograms)?T.histograms[0]:null,fa=null!=U?.numClasses&&isFinite(U?.numClasses)?U.numClasses:5,ja=new P({classificationMethod:U?.classificationMethod,colorRamp:U?.colorRamp});let ia=U?.field||"value";const pa=[],ma=[],sa=F.isSome(aa),oa=sa&&aa.fields.find(qa=>
"count"===qa.name.toLowerCase()),wa=sa?aa.fields.find(qa=>qa.name.toLowerCase()===ia.toLowerCase()):void 0;if(wa&&sa){ia=wa.name;const qa=aa.features.length;let ya=0;aa.features.forEach(ca=>ya+=(oa?ca.attributes[oa.name]:50)/qa);aa.features.forEach(ca=>{const ha=ca.attributes[wa.name];ca=oa?ca.attributes[oa.name]:50;if(0<ca){ma.push(ca);ca=Math.max(1,Math.round(ca/qa/ya*1E3));for(let da=0;da<ca;da++)pa.push(ha)}})}else{var {pixelType:ta}=T;const qa=(ba.max-ba.min)/ba.size,ya=(ta=ta.includes("s")||
ta.includes("u"))&&1===qa?Math.floor(ba.min+.5):ba.min,ca=ta&&1===qa?Math.floor(ba.max-.5):ba.max,ha=ba.size;let da=0,ka;ba.counts.forEach(la=>da+=la/ha);ba.counts.forEach((la,ea)=>{if(0<la)for(ma.push(la),la=Math.max(1,Math.round(la/ha/da*1E3)),ka=sa?aa.features[ea].attributes[wa.name]:0===ea?ya:ea===ha-1?ca:ba.min+qa*(ea+.5),ea=0;ea<la;ea++)pa.push(ka)})}ta=U?.classificationMethod||"natural-breaks";let ua=U?.definedInterval;"defined-interval"!==ta||ua||(ua=A(T,wa,fa));T=u.createGenerateRendererClassBreaks({values:pa,
valueFrequency:ma,normalizationTotal:null,definition:new l({classificationMethod:ta,breakCount:fa,definedInterval:ua})});let va=U?.colors;va||(U=U?.colorRamp||W,ja.colorRamp=U,va=p.convertColorRampToColormap(U,{numColors:T.classBreaks.length,interpolateAlpha:!0}).map(qa=>qa.slice(1)));U=T.classBreaks.map((qa,ya)=>new B({minValue:qa.minValue,maxValue:qa.maxValue,label:qa.label,symbol:{type:"simple-fill",color:va[ya]}}));return new E({field:ia,classBreakInfos:U,authoringInfo:ja})};N.createColormapRenderer=
K;N.createDefaultRenderer=function(T,U){const {attributeTable:aa,colormap:ba}=T;if(Q(T)){var fa=z(T);if(F.isSome(fa))return fa}return F.isSome(ba)&&(fa=K(T),F.isSome(fa))||F.isSome(aa)&&(fa=b(T),F.isSome(fa))?fa:n(T,U)};N.createFlowRenderer=function(T){if(!S(T))return null;let U;if(F.isSome(T.statistics)&&0<T.statistics.length&&("vector-magdir"===T.dataType||"vector-uv"===T.dataType)){const {minMagnitude:aa,maxMagnitude:ba}=R(T.dataType,T.statistics);U=[{type:"color",field:"Magnitude",stops:[{value:aa,
color:"#1020C0"},{value:ba,color:"#C02010"}]}]}return new L({visualVariables:U})};N.createShadedReliefRenderer=function(T,U="traditional"){if(!x(T))return null;({extent:T}=T);T=T.width*y.getMetersPerUnitForSR(T.spatialReference);return new G({hillshadeType:U,scalingType:5E6<T?"adjusted":"none"})};N.createStretchRenderer=n;N.createUVRenderer=b;N.createVectorFieldRenderer=z;N.estimateMagnitudeRange=R;N.getBandNames=function(T,U){const aa=T.keyProperties&&T.keyProperties.BandProperties;U=U?.length?U:
Array.from(Array(T.bandCount).keys());return U.map(ba=>aa&&aa.length===T.bandCount?aa[ba]&&aa[ba].BandName||"band_"+(ba+1):"band_"+(ba+1))};N.getClassField=e;N.getDefaultBandCombination=f;N.getDefaultInterpolation=function(T,U,aa){const ba=["nearest","bilinear","cubic","majority"].find(fa=>fa===aa?.toLowerCase());return"Map"===U?ba??"bilinear":"standard-time"===T.dataType?ba??"nearest":"thematic"===T.dataType||T.attributeTable||T.colormap?"nearest"===ba||"majority"===ba?ba:"nearest":ba??"bilinear"};
N.getDefinedInterval=A;N.getField=w;N.getSupportedRendererTypes=function(T,U=!1){const aa=["raster-stretch"];M(T)&&aa.push("raster-colormap");C(T)&&aa.push("unique-value");q(T,U)&&aa.push("class-breaks");x(T)&&aa.push("raster-shaded-relief");Q(T)&&aa.push("vector-field");S(T)&&aa.push("flow");return aa};N.getVariableRasterInfo=m;N.getWellKnownBandIndexes=k;N.isClassBreaksSupported=q;N.isColormapRendererSupported=M;N.isFlowRendererSupported=S;N.isShadedReliefRendererSupported=x;N.isSingleBand8BitRasterWithStats=
H;N.isUVRendererSupported=C;N.isVectorFieldRendererSupported=Q;N.normalizeRendererJSON=function(T){if("uniqueValue"===T.type){var U=T.uniqueValueInfos;U?.[0].symbol?.symbolLayers?.length&&(T.uniqueValueInfos=U?.map(aa=>({value:aa.value,label:aa.label,symbol:aa.symbol?J(aa.symbol):null})));return T}"classBreaks"===T.type&&(U=T.classBreakInfos,U[0].symbol?.symbolLayers?.length&&(T.classBreakInfos=U.map(aa=>({classMinValue:aa.classMinValue,classMaxValue:aa.classMaxValue,label:aa.label,symbol:aa.symbol?
J(aa.symbol):null}))));return T};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(N,
D,I,F,y,O,V,L,P,B){O=new I.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});I=new I.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});F=function(p){function c(u){u=l.call(this,u);u.type="class-breaks-definition";u.breakCount=null;u.classificationField=
null;u.classificationMethod=null;u.normalizationField=null;u.normalizationType=null;return u}N._inherits(c,p);var l=N._createSuper(c);N._createClass(c,[{key:"standardDeviationInterval",set:function(u){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",u)}},{key:"definedInterval",set:function(u){"defined-interval"===this.classificationMethod&&this._set("definedInterval",u)}}]);return c}(F.JSONSupport);D.__decorate([P.enumeration({classBreaksDef:"class-breaks-definition"})],
F.prototype,"type",void 0);D.__decorate([y.property({json:{write:!0}})],F.prototype,"breakCount",void 0);D.__decorate([y.property({json:{write:!0}})],F.prototype,"classificationField",void 0);D.__decorate([y.property({type:String,json:{read:O.read,write:O.write}})],F.prototype,"classificationMethod",void 0);D.__decorate([y.property({json:{write:!0}})],F.prototype,"normalizationField",void 0);D.__decorate([y.property({json:{read:I.read,write:I.write}})],F.prototype,"normalizationType",void 0);D.__decorate([y.property({value:null,
json:{write:!0}})],F.prototype,"standardDeviationInterval",null);D.__decorate([y.property({value:null,json:{write:!0}})],F.prototype,"definedInterval",null);return F=D.__decorate([B.subclass("esri.rest.support.ClassBreaksDefinition")],F)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(N,D){function I(l){var u=l.definition;const {classificationMethod:h,normalizationType:r,definedInterval:d}=u;u=u.breakCount??1;const t=[];var G=l.values;if(0===
G.length)return[];G=G.sort((k,g)=>k-g);var E=G[0],a=G[G.length-1];if("equal-interval"===h)if(G.length>=u){G=(a-E)/u;l=E;for(var n=1;n<u;n++){var m=Number((E+n*G).toFixed(6));t.push({minValue:l,maxValue:m,label:F(l,m,r)});l=m}t.push({minValue:l,maxValue:a,label:F(l,a,r)})}else G.forEach(k=>{t.push({minValue:k,maxValue:k,label:F(k,k,r)})});else if("natural-breaks"===h){G=y(G);l=O(G.uniqueValues,l.valueFrequency||G.valueFrequency,u);for(n=1;n<u;n++)G.uniqueValues.length>n&&(m=Number(G.uniqueValues[l[n]].toFixed(6)),
t.push({minValue:E,maxValue:m,label:F(E,m,r)}),E=m);t.push({minValue:E,maxValue:a,label:F(E,a,r)})}else if("quantile"===h)if(G.length>=u&&E!==a){l=Math.ceil(G.length/u);n=0;for(m=1;m<u;m++){var f=l+n-1;f>G.length&&(f=G.length-1);0>f&&(f=0);t.push({minValue:E,maxValue:G[f],label:F(E,G[f],r)});E=G[f];n+=l;l=Math.ceil((G.length-n)/(u-m))}t.push({minValue:E,maxValue:a,label:F(E,a,r)})}else for(u=-1,a=0;a<G.length;a++)E=G[a],E!==u&&(u=E,t.push({minValue:u,maxValue:E,label:F(u,E,r)}),u=E);else if("standard-deviation"===
h)if(l=P(G),n=B(G,l),0===n)t.push({minValue:G[0],maxValue:G[0],label:F(G[0],G[0],r)});else{G=L(E,a,u,l,n)*n;n=0;for(m=u;1<=m;m--)f=Number((l-(m-.5)*G).toFixed(6)),t.push({minValue:E,maxValue:f,label:F(E,f,r)}),E=f,n++;m=Number((l+.5*G).toFixed(6));t.push({minValue:E,maxValue:m,label:F(E,m,r)});E=m;n++;for(f=1;f<=u;f++)m=n===2*u?a:Number((l+(f+.5)*G).toFixed(6)),t.push({minValue:E,maxValue:m,label:F(E,m,r)}),E=m,n++}else if("defined-interval"===h){if(!d)return t;u=G[0];a=G[G.length-1];G=Math.ceil((a-
u)/d);E=u;for(l=1;l<G;l++)n=Number((u+l*d).toFixed(6)),t.push({minValue:E,maxValue:n,label:F(E,n,r)}),E=n;t.push({minValue:E,maxValue:a,label:F(E,a,r)})}return t}function F(l,u,h){let r=null;return r=l===u?h&&"percent-of-total"===h?l+"%":l.toString():h&&"percent-of-total"===h?l+"% - "+u+"%":l+" - "+u}function y(l){const u=[],h=[];let r=Number.MIN_VALUE,d=1,t=-1;for(let G=0;G<l.length;G++){const E=l[G];E===r?(d++,h[t]=d):null!==E&&(u.push(E),r=E,d=1,h.push(d),t++)}return{uniqueValues:u,valueFrequency:h}}
function O(l,u,h){var r=l.length;const d=[];h>r&&(h=r);for(var t=0;t<h;t++)d.push(Math.round(t*r/h-1));d.push(r-1);t=V(d,l,u,h);r=t.mean;t=t.sdcm;var G=h,E=0,a=0;let n=0,m=0,f=!0;for(let g=0;2>g&&f;g++){0===g&&(f=!1);for(var k=0;k<G-1;k++)for(;d[k+1]+1!==d[k+2];)if(d[k+1]+=1,E=p(k,d,l,u),n=E.sbMean,E=E.sbSdcm,a=p(k+1,d,l,u),m=a.sbMean,a=a.sbSdcm,E+a<t[k]+t[k+1])t[k]=E,t[k+1]=a,r[k]=n,r[k+1]=m,f=!0;else{--d[k+1];break}for(k=G-1;0<k;k--)for(;d[k]!==d[k-1]+1;)if(--d[k],E=p(k-1,d,l,u),n=E.sbMean,E=E.sbSdcm,
a=p(k,d,l,u),m=a.sbMean,a=a.sbSdcm,E+a<t[k-1]+t[k])t[k-1]=E,t[k]=a,r[k-1]=n,r[k]=m,f=!0;else{d[k]+=1;break}}f&&(t=V(d,l,u,h));return d}function V(l,u,h,r){let d=[];var t=[],G=[];let E=0;const a=[],n=[];for(var m=0;m<r;m++){var f=p(m,l,u,h);a.push(f.sbMean);n.push(f.sbSdcm);E+=n[m]}f=E;for(m=!0;m||E<f;){m=!1;d=[];for(t=0;t<r;t++)d.push(l[t]);for(G=0;G<r;G++)for(f=l[G]+1;f<=l[G+1];f++)if(t=u[f],0<G&&f!==l[G+1]&&Math.abs(t-a[G])>Math.abs(t-a[G-1]))l[G]=f;else if(G<r-1&&l[G]!==f-1&&Math.abs(t-a[G])>Math.abs(t-
a[G+1])){l[G+1]=f-1;break}f=E;E=0;t=[];G=[];for(let k=0;k<r;k++){t.push(a[k]);G.push(n[k]);const g=p(k,l,u,h);a[k]=g.sbMean;n[k]=g.sbSdcm;E+=n[k]}}if(E>f){for(u=0;u<r;u++)l[u]=d[u],a[u]=t[u],n[u]=G[u];E=f}return{mean:a,sdcm:n}}function L(l,u,h,r,d){l=Math.max(r-l,u-r)/d/h;return 1<=l?1:.5<=l?.5:.25}function P(l){let u=0;for(let h=0;h<l.length;h++)u+=l[h];return u/=l.length}function B(l,u){let h=0;for(let r=0;r<l.length;r++){const d=l[r];h+=(d-u)*(d-u)}h/=l.length;return Math.sqrt(h)}function p(l,
u,h,r){var d=0,t=0;for(var G=u[l]+1;G<=u[l+1];G++){const E=r[G];d+=h[G]*E;t+=E}0>=t&&c.warn("Exception in Natural Breaks calculation");d/=t;t=0;for(G=u[l]+1;G<=u[l+1];G++)t+=r[G]*(h[G]-d)**2;return{sbMean:d,sbSdcm:t}}const c=D.getLogger("esri.rest.support.generateRendererUtils");N.createGenerateRendererClassBreaks=function(l){const {normalizationTotal:u}=l;return{classBreaks:I(l),normalizationTotal:u}};N.createGenerateRendererUniqueValues=function(l){l=y(l);const u=[],h=l.uniqueValues.length;for(let r=
0;r<h;r++){const d=l.uniqueValues[r];u.push({value:d,count:l.valueFrequency[r],label:d.toString()})}return{uniqueValues:u}};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r){function d(E,a){const {attributeTable:n,bandCount:m}=E;return O.isNone(n)||1<m||a&&null==n.fields.find(f=>f.name.toLowerCase()===a.toLowerCase())?!1:!0}function t(E){const {bandCount:a,colormap:n}=E;return O.isSome(n)&&0<n.length&&1===a}function G(E){return l.isValidPixelBlock(E)&&0!==E.validPixelCount}F=function(E){function a(m){return n.call(this,m)}N._inherits(a,E);var n=N._createSuper(a);E=a.prototype;E.bind=function(){const {rendererJSON:m}=this;if(!m)return{success:!1};
this.lookup={rendererJSON:{}};let f;switch(m.type){case "uniqueValue":f=this._updateUVRenderer(m);break;case "rasterColormap":f=this._updateColormapRenderer(m);break;case "rasterStretch":f=this._updateStretchRenderer(m);break;case "classBreaks":f=this._updateClassBreaksRenderer(m);break;case "rasterShadedRelief":f=this._updateShadedReliefRenderer(m);break;case "vectorField":f=this._updateVectorFieldRenderer();break;case "flowRenderer":f=this._updateFlowRenderer()}return f};E.symbolize=function(m){let f=
m&&m.pixelBlock;if(!G(f))return f;if(m.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(f,m.simpleStretchParams);try{3<f.pixels.length&&(f=l.extractBands(f,[0,1,2]));let k;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":k=this._symbolizeColormap(f);break;case "classBreaks":k=this._symbolizeClassBreaks(f);break;case "rasterStretch":k=this._symbolizeStretch(f,m.bandIds);break;case "rasterShadedRelief":const g=m.extent;k=this._symbolizeShadedRelief(f,
{isGCS:g.spatialReference.isGeographic,resolution:{x:(g.xmax-g.xmin)/f.width,y:(g.ymax-g.ymin)/f.height}})}return k}catch(k){return y.getLogger(this.declaredClass).error("symbolize",k.message),f}};E.simpleStretch=function(m,f){if(!G(m))return m;try{return 3<m.pixels.length&&(m=l.extractBands(m,[0,1,2])),u.stretch(m,{...f,isRenderer:!0})}catch(k){return y.getLogger(this.declaredClass).error("symbolize",k.message),m}};E.generateWebGLParameters=function(m){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:e,
offset:v}=this.lookup.colormapLut||{};return{colormap:e,colormapOffset:v,type:"lut"}}const {pixelBlock:f,isGCS:k,resolution:g,bandIds:b}=m;({rendererJSON:m}=this);return"rasterStretch"===m.type?this._generateStretchWebGLParams(f,m,b):"rasterShadedRelief"===m.type?this._generateShadedReliefWebGLParams(m,k,g??void 0):"vectorField"===m.type?this._generateVectorFieldWebGLParams(m):null};E._isLUTChanged=function(m){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const f=
this.rendererJSON.colorRamp;if(m)return JSON.stringify(f)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)};E._symbolizeColormap=function(m){return this._isLUTChanged()&&!this.bind().success?m:l.colorize(m,this.lookup.colormapLut)};E._symbolizeClassBreaks=function(m){const {canUseIndexedLUT:f}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&
!this.bind().success?m:f?l.colorize(m,this.lookup.colormapLut):l.remapColor(m,this.lookup.remapLut??[])};E._symbolizeStretch=function(m,f){const {rasterInfo:k}=this,{pixelType:g,bandCount:b}=k,e=this.rendererJSON;var v=["u8","u16","s8","s16"].includes(g);let w;var {dra:C}=e;({gamma:M}=this.lookup);if("histogramEqualization"===e.stretchType){v=C?null:this.lookup?.histogramLut;f=u.getStretchCutoff(e,{rasterInfo:k,pixelBlock:m,bandIds:f,returnHistogramLut:!v});var M=u.stretch(m,{...f,gamma:M,isRenderer:!0});
M=l.lookupPixels(M,{lut:C?f.histogramLut:v,offset:0})}else if(v){if(C)C=u.getStretchCutoff(e,{rasterInfo:k,pixelBlock:m,bandIds:f}),w=u.createStretchLUT({pixelType:g,...C,gamma:M,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return m;w=this.lookup?this.lookup.stretchLut:null}if(!w)return m;1<b&&f?.length===O.unwrap(m)?.pixels.length&&w?.lut.length===b&&(w={lut:f.map(K=>w.lut[K]),offset:w.offset});M=l.lookupPixels(m,w)}else C=u.getStretchCutoff(e,{rasterInfo:k,pixelBlock:m,
bandIds:f}),M=u.stretch(m,{...C,gamma:M,isRenderer:!0});if(e.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return m;M=l.colorize(M,this.lookup?.colormapLut)}return M};E._symbolizeShadedRelief=function(m,f){var k=this.rendererJSON;f=h.hillshade(m,{...k,...f});if(!k.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return f;k=this.lookup?this.lookup.hsvMap:null;if(!k)return f;const g=O.unwrap(this.rasterInfo.statistics)?.[0]??{min:0,max:8E3};h.tintHillshade(f,m,k,g);return f};E._isVectorFieldData=
function(){const {bandCount:m,dataType:f}=this.rasterInfo;return 2===m&&("vector-magdir"===f||"vector-uv"===f)};E._updateVectorFieldRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}};E._updateFlowRenderer=function(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}};
E._updateUVRenderer=function(m){const {bandCount:f,attributeTable:k,pixelType:g}=this.rasterInfo,b=m.field1;if(!b)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const e=m.defaultSymbol;var v=1===f&&["u8","s8"].includes(g);if(!d(this.rasterInfo,b)&&!v)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const w=[];if(O.isSome(k)){const C=k.fields.find(M=>"value"===M.name.toLowerCase());
if(!C)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};k.features.forEach(M=>{const K=m.uniqueValueInfos?.find(x=>String(x.value)===String(M.attributes[b]))?.symbol?.color;K?w.push([M.attributes[C.name]].concat(K)):e&&w.push([M.attributes[C.name]].concat(e.color))})}else{if("value"!==b.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};m.uniqueValueInfos?.forEach(C=>
{const M=C?.symbol?.color;M?w.push([parseInt(""+C.value,10)].concat(M)):e&&w.push([parseInt(""+C.value,10)].concat(e?.color))})}if(0===w.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};v=l.createColormapLUT({colormap:w});this.lookup={rendererJSON:m,colormapLut:v};this.canRenderInWebGL=!0;return{success:!0}};E._updateColormapRenderer=function(m){if(!t(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};
var f=m.colormapInfos.map(k=>[k.value].concat(k.color)).sort((k,g)=>k[0]-g[0]);if(!f||0===f.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};f=l.createColormapLUT({colormap:f});this.lookup={rendererJSON:m,colormapLut:f};this.canRenderInWebGL=!0;return{success:!0}};E._updateShadedReliefRenderer=function(m){const {bandCount:f,dataType:k,pixelType:g}=this.rasterInfo;if("elevation"!==k&&("generic"!==k||1!==f||"s16"!==g&&"f32"!==g&&"f64"!==g))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(m.colorRamp){var b=r.convertColorRampToColormap(m.colorRamp,{interpolateAlpha:!0});b=l.createColormapLUT({colormap:b});const e=[],v=b.indexedColormap;for(let w=0;w<v.length;w+=4){const C=I.toHSV({r:v[w],g:v[w+1],b:v[w+2]});e.push([C.h/60,C.s/100,255*C.v/100])}this.lookup={rendererJSON:m,colormapLut:b,hsvMap:e}}else this.lookup=null;this.canRenderInWebGL=!0;
return{success:!0}};E._analyzeClassBreaks=function(m){const {attributeTable:f,pixelType:k}=this.rasterInfo,g=O.isSome(f)?f.fields.find(v=>"value"===v.name.toLowerCase()):null,b=O.isSome(f)?f.fields.find(v=>v.name.toLowerCase()===m.field.toLowerCase()):null,e=null!=g&&null!==b;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(k)||e,tableValueField:g,tableBreakField:b}};E._updateClassBreaksRenderer=function(m){var {attributeTable:f}=this.rasterInfo;const {canUseIndexedLUT:k,tableValueField:g,
tableBreakField:b}=this._analyzeClassBreaks(m);var e=m.classBreakInfos;if(!e?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};e=e.sort((K,x)=>K.classMaxValue-x.classMaxValue);var v=e[e.length-1],w=m.minValue;if(!k){var C=[];for(var M=0;M<e.length;M++)C.push({value:e[M].classMinValue??w,mappedColor:e[M].symbol.color}),w=e[M].classMaxValue;C.push({value:v.classMaxValue,mappedColor:v.symbol.color});this.lookup={rendererJSON:m,remapLut:C};
this.canRenderInWebGL=!1;return{success:!0}}C=[];if(O.isSome(f)&&null!=g&&null!==b&&g!==b){v=g.name;const K=b.name,x=e[e.length-1],{classMaxValue:q}=x;w=m.minValue;for(M of f.features){f=M.attributes[v];const A=M.attributes[K],H=A===q?x:A<w?null:e.find(({classMaxValue:Q})=>Q>A);H&&C.push([f].concat(H.symbol.color))}}else{w=Math.floor(m.minValue);for(M=0;M<e.length;M++){for(f=e[M];w<f.classMaxValue;w++)C.push([w].concat(f.symbol.color));w=Math.ceil(f.classMaxValue)}v.classMaxValue===w&&C.push([v.classMaxValue].concat(v.symbol.color))}e=
l.createColormapLUT({colormap:C,fillUnspecified:!1});this.lookup={rendererJSON:m,colormapLut:e};this.canRenderInWebGL=!0;return{success:!0}};E._isHistogramRequired=function(m){return"percentClip"===m||"histogramEqualization"===m};E._isValidRasterStatistics=function(m){return O.isSome(m)&&0<m.length&&null!=m[0].min&&null!=m[0].max};E._updateStretchRenderer=function(m){let {stretchType:f,dra:k}=m;if(!("none"===f||m.statistics?.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||k))return{success:!1,
error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var g=O.unwrap(m.histograms||this.rasterInfo.histograms);!this._isHistogramRequired(m.stretchType)||g?.length||k||(f="minMax");const {computeGamma:b,useGamma:e,colorRamp:v}=m;var {gamma:w}=m;e&&b&&!w?.length&&(w=m.statistics?.length?m.statistics:O.unwrap(this.rasterInfo.statistics),w=u.computeGammaValues(this.rasterInfo.pixelType,w));const C=this.rasterInfo.pixelType,M=!k&&["u8","u16",
"s8","s16"].includes(C);"histogramEqualization"===f?(g=g.map(K=>u.createHistogramEqualizationLUT(K)),this.lookup={rendererJSON:m,histogramLut:g}):M&&(g=u.getStretchCutoff(m,{rasterInfo:this.rasterInfo}),g=u.createStretchLUT({pixelType:C,...g,gamma:e?w:null,rounding:"floor"}),this.lookup={rendererJSON:m,stretchLut:g});v&&(g=r.convertColorRampToColormap(v,{interpolateAlpha:!0}),this.lookup||(this.lookup={rendererJSON:m}),this.lookup.colormapLut=l.createColormapLUT({colormap:g}),this.lookup.rendererJSON=
m);this.lookup.gamma=e&&w?.length?w:null;this.canRenderInWebGL=!0;return{success:!0}};E._generateStretchWebGLParams=function(m,f,k){let g=null,b=null;var e=this.lookup&&this.lookup.colormapLut;f.colorRamp&&e&&(g=e.indexedColormap,b=e.offset);"histogramEqualization"===f.stretchType&&(f={...f,stretchType:"minMax"});({gamma:e}=this.lookup);const v=!!(f.useGamma&&e&&e.some(H=>1!==H)),{minCutOff:w,maxCutOff:C,outMin:M,outMax:K}=u.getStretchCutoff(f,{rasterInfo:this.rasterInfo,pixelBlock:m,bandIds:k});
var x=0;O.isSome(m)&&(x=m.getPlaneCount(),2===x&&(m=m.clone(),m.statistics=[m.statistics[0]],m.pixels=[m.pixels[0]]));({bandCount:m}=this.rasterInfo);k=Math.min(3,k?.length||x||m,m);m=new Float32Array(k);x=g||v?1:255;let q;for(q=0;q<w.length;q++)m[q]=C[q]===w[q]?0:(K-M)/(C[q]-w[q])/x;const A=new Float32Array(k);if(v&&e)for(q=0;q<k;q++)A[q]=1<e[q]?2<e[q]?6.5+(e[q]-2)**2.5:6.5+100*(2-e[q])**4:1;return{bandCount:k,outMin:M/x,outMax:K/x,minCutOff:w,maxCutOff:C,factor:m,useGamma:v,gamma:v?e:[1,1,1],gammaCorrection:v?
A:[1,1,1],colormap:g,colormapOffset:b,stretchType:f.stretchType,type:"stretch"}};E._generateShadedReliefWebGLParams=function(m,f=!1,k={x:0,y:0}){let g=null,b=null;const e=this.lookup&&this.lookup.colormapLut;m.colorRamp&&e&&(g=e.indexedColormap,b=e.offset);f=h.calculateHillshadeParams({...m,isGCS:f,resolution:k});k=O.unwrap(this.rasterInfo.statistics)?.[0];return{...f,minValue:k?.min??0,maxValue:k?.max??8E3,hillshadeType:"traditional"===m.hillshadeType?0:1,type:"hillshade",colormap:g,colormapOffset:b}};
E._generateVectorFieldWebGLParams=function(m){const {style:f,inputUnit:k,outputUnit:g,visualVariables:b,symbolTileSize:e,flowRepresentation:v}=m;let w;var C=this.rasterInfo.statistics?.[0].min??0,M=this.rasterInfo.statistics?.[0].max??50,K=b?.find(A=>"sizeInfo"===A.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:M,maxSize:.8*e,minDataValue:C,minSize:.2*e},x=K.minDataValue??C,q=K.maxDataValue??M;M=O.isSome(K.maxSize)&&O.isSome(K.minSize)?[K.minSize/e,K.maxSize/e]:[.2,.8];"wind_speed"===f&&(M[0]=
M[1]=(M[0]+M[1])/2);C=O.isSome(x)&&O.isSome(q)?[x,q]:null;if("classified_arrow"===f)if(O.isSome(x)&&O.isSome(q)&&O.isSome(K))for(w=[],x=(K.maxDataValue-K.minDataValue)/5,q=0;6>q;q++)w.push(K.minDataValue+x*q);else w=[0,1E-6,3.5,7,10.5,14];K="flow_to"===v===("ocean_current_kn"===f||"ocean_current_m"===f)?0:Math.PI;x=b?.find(A=>"rotationInfo"===A.type);return{breakValues:w,dataRange:C,inputUnit:k,outputUnit:g,symbolTileSize:e,symbolPercentRange:M,style:f||"single_arrow",rotation:K,rotationType:this.rasterInfo.storageInfo?.tileInfo&&
"vector-uv"===this.rasterInfo.dataType?"geographic":x?.rotationType||m.rotationType,type:"vectorField"}};return N._createClass(a)}(F.JSONSupport);D.__decorate([V.property({json:{write:!0}})],F.prototype,"rendererJSON",void 0);D.__decorate([V.property({type:c,json:{write:!0}})],F.prototype,"rasterInfo",void 0);D.__decorate([V.property({json:{write:!0}})],F.prototype,"lookup",void 0);D.__decorate([V.property()],F.prototype,"canRenderInWebGL",void 0);return F=D.__decorate([p.subclass("esri.renderers.support.RasterSymbolizer")],
F)})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/maybe ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),function(N,D,I,F,y,O,V,L,P,B){function p(a,n){const m=u(n.data,n.width,n.height,a.smoothing);return a.interpolate?(f,k)=>{const g=Math.floor(f),b=Math.floor(k);if(0>g||
g>=n.width||0>b||b>=n.height)return[0,0];f-=g;k-=b;const e=g<n.width-1?g+1:g,v=b<n.height-1?b+1:b;return[(m[2*(b*n.width+g)]*(1-k)+m[2*(v*n.width+g)]*k)*(1-f)+(m[2*(b*n.width+e)]*(1-k)+m[2*(v*n.width+e)]*k)*f,(m[2*(b*n.width+g)+1]*(1-k)+m[2*(v*n.width+g)+1]*k)*(1-f)+(m[2*(b*n.width+e)+1]*(1-k)+m[2*(v*n.width+e)+1]*k)*f]}:(f,k)=>{f=Math.round(f);k=Math.round(k);return 0>f||f>=n.width||0>k||k>=n.height?[0,0]:[m[2*(k*n.width+f)],m[2*(k*n.width+f)+1]]}}function c(a,n,m,f,k,g,b,e,v){const w=[];let C=0,
[M,K]=n(m,f);M*=a.velocityScale;K*=a.velocityScale;w.push({x:m,y:f,t:C,speed:Math.sqrt(M*M+K*K)});for(let A=0;A<a.verticesPerLine;A++){let [H,Q]=n(m,f);H*=a.velocityScale;Q*=a.velocityScale;const S=Math.sqrt(H*H+Q*Q);if(S<a.minSpeedThreshold)break;const z=H/S,J=Q/S;m+=z*a.segmentLength;f+=J*a.segmentLength;C+=a.segmentLength/S;if(Math.acos(z*x+J*q)>a.maxTurnAngle)break;if(a.collisions){var x=Math.round(m*v);var q=Math.round(f*v);if(0>x||x>b-1||0>q||q>e-1)break;const R=g[q*b+x];if(-1!==R&&R!==k)break;
g[q*b+x]=k}w.push({x:m,y:f,t:C,speed:S});x=z;q=J}return w}function l(a,n,m,f){const k=[],g=new L,b=1/Math.max(a.lineCollisionWidth,1),e=Math.round(m*b),v=Math.round(f*b),w=new Int32Array(e*v);for(var C=0;C<w.length;C++)w[C]=-1;C=[];for(let M=0;M<f;M+=a.lineSpacing)for(let K=0;K<m;K+=a.lineSpacing)C.push({x:K,y:M,sort:g.getFloat()});C.sort((M,K)=>M.sort-K.sort);for(const {x:M,y:K}of C)g.getFloat()<a.density&&(m=c(a,n,M,K,k.length,w,e,v,b),2>m.length||k.push(m));return k}function u(a,n,m,f){if(0===
f)return a;const k=Math.round(3*f),g=Array(2*k+1);var b=0;for(var e=-k;e<=k;e++){var v=Math.exp(-e*e/(f*f));g[e+k]=v;b+=v}for(f=-k;f<=k;f++)g[f+k]/=b;b=new Float32Array(a.length);for(f=0;f<m;f++)for(e=0;e<n;e++){var w=v=0;for(var C=-k;C<=k;C++)if(!(0>e+C||e+C>=n)){var M=g[C+k];v+=M*a[2*(f*n+(e+C))];w+=M*a[2*(f*n+(e+C))+1]}b[2*(f*n+e)]=v;b[2*(f*n+e)+1]=w}a=new Float32Array(a.length);for(f=0;f<n;f++)for(e=0;e<m;e++){w=v=0;for(C=-k;C<=k;C++)0>e+C||e+C>=m||(M=g[C+k],v+=M*b[2*((e+C)*n+f)],w+=M*b[2*((e+
C)*n+f)+1]);a[2*(e*n+f)]=v;a[2*(e*n+f)+1]=w}return a}function h(a,n){const m=new L;var f=a.reduce((e,v)=>e+v.length,0);f=new Float32Array(4*f);const k=Array(a.length);let g=0,b=0;for(const e of a){a=g;for(const v of e)f[4*g]=v.x,f[4*g+1]=v.y,f[4*g+2]=v.t,f[4*g+3]=v.speed,g++;k[b++]={startVertex:a,numberOfVertices:e.length,totalTime:e[e.length-1].t,timeSeed:n?m.getFloat():0}}return{lineVertices:f,lineDescriptors:k}}function r(a,n){function m(x,q,A,H,Q,S,z,J){const R=9*v;let W=0;e[R+W++]=x;e[R+W++]=
q;e[R+W++]=1;e[R+W++]=A;e[R+W++]=S;e[R+W++]=z;e[R+W++]=H/2;e[R+W++]=Q/2;e[R+W++]=J;v++;e[R+W++]=x;e[R+W++]=q;e[R+W++]=-1;e[R+W++]=A;e[R+W++]=S;e[R+W++]=z;e[R+W++]=-H/2;e[R+W++]=-Q/2;e[R+W++]=J;v++}const {lineVertices:f,lineDescriptors:k}=a;var g=a=0;for(var b of k)a+=2*b.numberOfVertices,g+=6*(b.numberOfVertices-1);const e=new Float32Array(9*a);b=new Uint32Array(g);let v=0;a=0;for(const x of k){const {totalTime:q,timeSeed:A}=x;let H=g=null,Q=null;var w=null,C=null,M=null;for(let S=0;S<x.numberOfVertices;S++){w=
f[4*(x.startVertex+S)];const z=f[4*(x.startVertex+S)+1],J=f[4*(x.startVertex+S)+2],R=f[4*(x.startVertex+S)+3];let W=null,Z=null;var K=null;let Y=null;0<S&&(W=w-g,Z=z-H,K=Math.sqrt(W*W+Z*Z),W/=K,Z/=K,1<S?(C=W+C,M=Z+M,K=Math.sqrt(C*C+M*M),C/=K,M/=K,K=Math.min(1/(C*W+M*Z),n),C*=K,M*=K,K=-M,Y=C):(K=-Z,Y=W),null!==K&&null!==Y&&(m(g,H,Q,K,Y,q,A,R),b[a++]=v-2,b[a++]=v,b[a++]=v-1,b[a++]=v,b[a++]=v+1,b[a++]=v-1));g=w;H=z;Q=J;C=W;M=Z;w=R}m(g,H,Q,-M,C,q,A,w)}return{vertexData:e,indexData:b}}function d(a){function n(T,
U){var aa=J+W,ba=R+Z,fa=Math.sqrt(aa*aa+ba*ba);aa/=fa;ba/=fa;var ja=J*aa+R*ba,ia=W+Y,pa=Z+X;fa=Math.sqrt(ia*ia+pa*pa);ia/=fa;pa/=fa;var ma=W*ia+Z*pa;fa=K;var sa=x,oa=q,wa=A;ba=-(ba/ja);aa/=ja;ja=H;var ta=Q,ua=S,va=z;pa=-(pa/ma);ia/=ma;ma=16*C;let qa=0;for(const ya of[1,2])for(const ca of[1,2,3,4])v[ma+qa++]=fa,v[ma+qa++]=sa,v[ma+qa++]=oa,v[ma+qa++]=wa,v[ma+qa++]=ja,v[ma+qa++]=ta,v[ma+qa++]=ua,v[ma+qa++]=va,v[ma+qa++]=ya,v[ma+qa++]=ca,v[ma+qa++]=T,v[ma+qa++]=U,v[ma+qa++]=ba/2,v[ma+qa++]=aa/2,v[ma+
qa++]=pa/2,v[ma+qa++]=ia/2,C++;w[M++]=C-8;w[M++]=C-7;w[M++]=C-6;w[M++]=C-7;w[M++]=C-5;w[M++]=C-6;w[M++]=C-4;w[M++]=C-3;w[M++]=C-2;w[M++]=C-3;w[M++]=C-1;w[M++]=C-2}function m(T,U,aa,ba,fa,ja){J=W;R=Z;W=Y;Z=X;null==J&&null==R&&(J=W,R=Z);if(null!=H&&null!=Q){Y=T-H;X=U-Q;const ia=Math.sqrt(Y*Y+X*X);Y/=ia;X/=ia}null!=J&&null!=R&&n(fa,ja);K=H;x=Q;q=S;A=z;H=T;Q=U;S=aa;z=ba}function f(T,U){J=W;R=Z;W=Y;Z=X;null==J&&null==R&&(J=W,R=Z);null!=J&&null!=R&&n(T,U)}const {lineVertices:k,lineDescriptors:g}=a;let b=
a=0;for(var e of g){const T=e.numberOfVertices-1;a+=8*T;b+=12*T}const v=new Float32Array(16*a),w=new Uint32Array(b);let C=0,M=0,K,x,q,A,H,Q,S,z,J,R,W,Z,Y,X;for(const T of g){X=Y=Z=W=R=J=z=S=Q=H=A=q=x=K=null;const {totalTime:U,timeSeed:aa}=T;for(e=0;e<T.numberOfVertices;e++)m(k[4*(T.startVertex+e)],k[4*(T.startVertex+e)+1],k[4*(T.startVertex+e)+2],k[4*(T.startVertex+e)+3],U,aa);f(U,aa)}return{vertexData:v,indexData:w}}function t(a,n){const m=n.pixels,{width:f,height:k}=n,g=new Float32Array(f*k*2),
b=n.mask||new Uint8Array(f*k*2);n.mask||b.fill(255);if("vector-uv"===a)for(a=0;a<f*k;a++)g[2*a]=m[0][a],g[2*a+1]=-m[1][a];else if("vector-magdir"===a)for(a=0;a<f*k;a++){n=m[0][a];const e=y.deg2rad(m[1][a]),v=Math.sin(e-Math.PI/2);g[2*a]=Math.cos(e-Math.PI/2)*n;g[2*a+1]=v*n}return{data:g,mask:b,width:f,height:k}}async function G(a,n,m,f,k,g){const b={requestProjectedLocalDirections:!0,signal:g};O.isSome(k)&&(b.timeExtent=k);if("imagery"===a.type)return await a.load({signal:g}),k=a.rasterInfo.dataType,
a=await a.fetchImage(n,m,f,b),!a||O.isNone(a.pixelData)||O.isNone(a.pixelData.pixelBlock)?{data:new Float32Array(m*f*2),mask:new Uint8Array(m*f),width:m,height:f}:t(k,a.pixelData.pixelBlock);await a.load({signal:g});k=a.rasterInfo.dataType;a=await a.fetchPixels(n,m,f,b);return!a||O.isNone(a.pixelBlock)?{data:new Float32Array(m*f*2),mask:new Uint8Array(m*f),width:m,height:f}:t(k,a.pixelBlock)}const E=F.getLogger("esri.views.2d.engine.flow.dataUtils");N.createAnimatedLinesData=h;N.createFlowMesh=async function(a,
n,m,f){const k=performance.now();var g=p(n,m);const b=performance.now();m=l(n,g,m.width,m.height);n=performance.now();g=h(m,!0);m=performance.now();a="Streamlines"===a?r(g,10):d(g);g=performance.now();I("esri-2d-profiler")&&(E.info("I.1","_createFlowFieldFromData (ms)",Math.round(b-k)),E.info("I.2","_getStreamlines (ms)",Math.round(n-b)),E.info("I.3","createAnimatedLinesData (ms)",Math.round(m-n)),E.info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(g-m)),E.info("I.5","createFlowMesh (ms)",
Math.round(g-k)),E.info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();V.throwIfAborted(f);return a};N.createParticlesMesh=d;N.createStreamlinesMesh=r;N.loadImagery=async function(a,n,m,f,k,g){const b=performance.now();var e=P.getInfo(n.spatialReference);if(!e)return m=await G(a,n,m,f,k,g),I("esri-2d-profiler")&&E.info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-b)),I("esri-2d-profiler")&&E.info("I.9","Number of parts",
1),m;const [v,w]=e.valid,C=Math.ceil(n.width/(w-v)),M=n.width/C,K=Math.round(m/C);let x=n.xmin;const q=[];e=performance.now();for(let A=0;A<C;A++){const H=new B({xmin:x,xmax:x+M,ymin:n.ymin,ymax:n.ymax,spatialReference:n.spatialReference});q.push(G(a,H,K,f,k,g));x+=M}a=await Promise.all(q);I("esri-2d-profiler")&&E.info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-e));I("esri-2d-profiler")&&E.info("I.9","Number of parts",a.length);f={data:new Float32Array(m*f*2),mask:new Uint8Array(m*
f),width:m,height:f};n=0;for(const A of a){for(a=0;a<A.height;a++)for(k=0;k<A.width;k++)n+k>=m||(f.data[2*(a*m+n+k)]=A.data[2*(a*A.width+k)],f.data[2*(a*m+n+k)+1]=A.data[2*(a*A.width+k)+1],f.mask[a*m+n+k]=A.mask[a*A.width+k]);n+=A.width}I("esri-2d-profiler")&&E.info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-b));return f};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterEnums":function(){define(["exports","../../core/jsonMap"],function(N,
D){const I=D.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"});D=D.strict()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"});N.interpolationKebab=I;N.noDataInterpretationKebab=D;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RasterFactory":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../core/Error ./CloudRaster ./ImageAuxRaster ./ImageServerRaster ./MRFRaster ./TIFFRaster".split(" "),
function(N,D,I,F,y,O,V){const L=new Map;L.set("CRF",{desc:"Cloud Raster Format",constructor:I});L.set("MRF",{desc:"Meta Raster Format",constructor:O});L.set("TIFF",{desc:"GeoTIFF",constructor:V});L.set("RasterTileServer",{desc:"Raster Tile Server",constructor:y});L.set("JPG",{desc:"JPG Raster Format",constructor:F});L.set("PNG",{desc:"PNG Raster Format",constructor:F});L.set("GIF",{desc:"GIF Raster Format",constructor:F});L.set("BMP",{desc:"BMP Raster Format",constructor:F});return function(){function P(){}
P.open=async function(B){const {url:p,ioConfig:c,sourceJSON:l}=B;let u=B.datasetFormat;null==u&&p.lastIndexOf(".")&&(u=p.slice(p.lastIndexOf(".")+1).toUpperCase());if("OVR"===u||"TIF"===u)u="TIFF";else if("JPG"===u||"JPEG"===u||"JFIF"===u)u="JPG";p.toLowerCase().includes("/imageserver")&&!p.toLowerCase().includes("/wcsserver")&&(u="RasterTileServer");const h={bandIds:null,sampling:null},r={url:p,sourceJSON:l,datasetFormat:u,ioConfig:c??h};let d,t;if(u&&this.supportedFormats.has(u)){if("CRF"===u&&
!c?.enableCRF)throw new D("rasterfactory:open",`cannot open raster: ${p}`);d=L.get(u).constructor;t=new d(r);await t.open({signal:B.signal});return t}if(u)throw new D("rasterfactory:open","not a supported format "+u);const G=Array.from(L.keys());let E=0;const a=()=>{u=G[E++];if(!u||"CRF"===u&&!c?.enableCRF)return null;d=L.get(u).constructor;t=new d(r);return t.open({signal:B.signal}).then(()=>t).catch(()=>a())};return a()};P.register=function(B,p,c){L.has(B.toUpperCase())||L.set(B.toUpperCase(),{desc:p,
constructor:c})};N._createClass(P,null,[{key:"supportedFormats",get:function(){const B=new Set;L.forEach((p,c)=>B.add(c));return B}}]);return P}()})},"esri/layers/support/rasterDatasets/CloudRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../LOD ../RasterInfo ../RasterStorageInfo ../TileInfo ./BaseRaster ./DBFParser ../rasterTransforms/utils ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a){const n=new Map;n.set("int16","esriFieldTypeSmallInteger");n.set("int32","esriFieldTypeInteger");n.set("int64","esriFieldTypeInteger");n.set("float32","esriFieldTypeSingle");n.set("float64","esriFieldTypeDouble");n.set("text","esriFieldTypeString");I=function(m){function f(){var g=k.apply(this,arguments);g.storageInfo=null;g.datasetFormat="CRF";return g}N._inherits(f,m);var k=N._createSuper(f);m=f.prototype;m.open=async function(g){await this.init();
({data:g}=await this.request(this.url+"/conf.json",{signal:g?.signal}));if(!this._validateHeader(g))throw new F("cloudraster:open","Invalid or unsupported conf.json.");this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);const {storageInfo:b,rasterInfo:e}=this._parseHeader(g);"thematic"===e.dataType&&(g=await this._fetchAuxiliaryInformation(),e.attributeTable=g);this._set("storageInfo",b);this._set("rasterInfo",e);this.ioConfig.retryCount=this.ioConfig.retryCount||0};m.fetchRawTile=async function(g,
b,e,v={}){var {transposeInfo:w}=this.rasterInfo.storageInfo,{transposedVariableName:C}=v;g=(w=!(!w||!C))?0:this.rasterInfo.storageInfo.maximumPyramidLevel-g;if(0>g)return null;C=this._buildCacheFilePath(g,b,e,v.multidimensionalDefinition,C);b=this._getIndexRecordFromBundle(b,e,w);e=await this.request(C,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:v.signal});if(!e)return null;e=new Uint8Array(e.data);b=this._getTileEndAndContentType(e,b);if(0===b.recordSize)return null;
v=await this.request(C,{range:{from:b.position,to:b.position+b.recordSize},responseType:"array-buffer",signal:v.signal});if(!v)return null;const [M,K]=this._getTileSize(w);return this.decodePixelBlock(v.data,{width:M,height:K,planes:null,pixelType:null,returnInterleaved:w})};m._validateHeader=function(g){const b="origin extent geodataXform LODInfos blockWidth blockHeight bandCount pixelType pixelSizeX pixelSizeY format packetSize".split(" ");return g&&"RasterInfo"===g.type&&!b.some(e=>!g[e])};m._parseHeader=
function(g){var b="u1 u2 u4 u8 s8 u16 s16 u32 s32 f32 f64".split(" ")[g.pixelType];const {bandCount:e,histograms:v,colormap:w,blockWidth:C,blockHeight:M,firstPyramidLevel:K,maximumPyramidLevel:x}=g,q=g.statistics&&g.statistics.map(fa=>({min:fa.min,max:fa.max,avg:fa.mean,stddev:fa.standardDeviation,median:fa.median,mode:fa.mode}));var A=g.extent.spatialReference,H=g.geodataXform?.spatialReference;A=new G(A?.wkid||A?.wkt?A:H);H=new E({xmin:g.extent.xmin,ymin:g.extent.ymin,xmax:g.extent.xmax,ymax:g.extent.ymax,
spatialReference:A});const Q=new a({x:g.pixelSizeX,y:g.pixelSizeY,spatialReference:A}),S=Math.round((H.xmax-H.xmin)/Q.x),z=Math.round((H.ymax-H.ymin)/Q.y),J=this._parseTransform(g.geodataXform),R=J?H:null;J&&(H=J.forwardTransform(H),Q.x=(H.xmax-H.xmin)/S,Q.y=(H.ymax-H.ymin)/z);const W=g.properties??{};var Z=g.format.toLowerCase().replace("cache/","");const Y=new a(g.origin.x,g.origin.y,A);let X;var T;if(w&&w.colors)for(X=[],T=0;T<w.colors.length;T++){var U=w.colors[T];var aa=w.values?w.values[T]:
T;X.push([aa,U&255,U<<16>>>24,U<<8>>>24,U>>>24])}U=g.LODInfos;aa=[];for(T=0;T<U.levels.length;T++)aa.push(new p({level:U.levels[T],resolution:U.resolutions[T],scale:96/.0254*U.resolutions[T]}));U=new u({dpi:96,lods:aa,format:Z,origin:Y,size:[C,M],spatialReference:A});Z={recordSize:8,packetSize:g.packetSize,headerSize:g.packetSize*g.packetSize*8+64};aa=[{maxCol:Math.ceil(S/C)-1,maxRow:Math.ceil(z/M)-1,minCol:0,minRow:0}];let ba=2;if(0<x)for(T=0;T<x;T++)aa.push({maxCol:Math.ceil(S/ba/C)-1,maxRow:Math.ceil(z/
ba/M)-1,minCol:0,minRow:0}),ba*=2;g=g.mdInfo;T=null;g&&W._yxs&&(T=W._yxs,T={packetSize:T.PacketSize,tileSize:[T.TileXSize,T.TileYSize]});b=new c({width:S,height:z,pixelType:b,bandCount:e,extent:H,nativeExtent:R,transform:J,spatialReference:A,pixelSize:Q,keyProperties:W,statistics:q,histograms:v,multidimensionalInfo:g,colormap:X,storageInfo:new l({blockWidth:C,blockHeight:M,pyramidBlockWidth:C,pyramidBlockHeight:M,origin:Y,tileInfo:U,transposeInfo:T,firstPyramidLevel:K,maximumPyramidLevel:x,blockBoundary:aa})});
return{storageInfo:Z,rasterInfo:b}};m._parseTransform=function(g){if(!d.isTransformSupported(g))throw new F("cloudraster:open","the data contains unsupported geodata transform types");g=d.readTransform(g);if("identity"===g.type)return null;if("polynomial"!==g.type||!g.forwardCoefficients?.length||!g.inverseCoefficients?.length)throw new F("cloudraster:open","the data contains unsupported geodata transforms - both forward and inverse coefficients are required currently");return g};m._fetchAuxiliaryInformation=
async function(g){var b=this.request(this.url+"/conf.vat.json",{signal:g}).then(v=>v.data).catch(()=>null);g=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:g}).then(v=>v.data).catch(()=>null);b=await Promise.all([b,g]);let e;if(b[0]){g=b[0].fields;const v=b[0].values;if(g&&v){g=g.map(C=>({type:"OID"===C.name?"esriFieldTypeOID":n.get(C.type),name:C.name,alias:C.alias||C.name}));const w=v.map(C=>({attributes:C}));g&&v&&(e={fields:g,features:w})}}!e&&b[1]&&(e=r.parse(b[1]).recordSet);
return t.fromJSON(e)};m._buildCacheFilePath=function(g,b,e,v,w){var C=this._getPackageSize(!!w);e=Math.floor(e/C)*C;b="R"+this._toHexString4(Math.floor(b/C)*C)+"C"+this._toHexString4(e);C="L";C=10<=g?C+g.toString():C+("0"+g.toString());({multidimensionalInfo:g}=this.rasterInfo);const M=v?.[0];if(y.isNone(g)||!M)return`${this.url}/_alllayers/${C}/${b}.bundle`;v="_yxs";if(!w){v=g.variables.find(K=>K.name===M.variableName).dimensions[0].values.indexOf(M.values[0]).toString(16);g=4-v.length;for(e=0;e<
g;e++)v="0"+v;v="S"+v}w=this._getVariableFolderName(w||M.variableName);return`${this.url}/_alllayers/${w}/${v}/${C}/${b}.bundle`};m._getPackageSize=function(g=!1){const {transposeInfo:b}=this.rasterInfo.storageInfo;return g&&y.isSome(b)?b.packetSize??0:this.storageInfo.packetSize};m._getTileSize=function(g=!1){const {storageInfo:b}=this.rasterInfo,{transposeInfo:e}=b;return g&&y.isSome(e)?e.tileSize:b.tileInfo.size};m._getVariableFolderName=function(g){g=g.trim();return""===g?"_v":g.replace(/[\{|\}\-]/g,
"_").replace("\\*","_v")};m._getIndexRecordFromBundle=function(g,b,e=!1){e=this._getPackageSize(e);g=g%e*e+b%e;if(0>g)throw Error("Invalid level / row / col");return g*this.storageInfo.recordSize+64};m._getTileEndAndContentType=function(g,b){g=g.subarray(b,b+8);b=0;let e;for(e=0;5>e;e++)b|=(g[e]&255)<<8*e;const v=b&0xffffffffff;b=0;for(e=5;8>e;e++)b|=(g[e]&255)<<8*(e-5);return{position:v,recordSize:b&0xffffffffff}};m._toHexString4=function(g){g=g.toString(16);if(4!==g.length){let b=4-g.length;for(;0<
b--;)g="0"+g}return g};return N._createClass(f)}(h);D.__decorate([O.property({readOnly:!0})],I.prototype,"storageInfo",void 0);D.__decorate([O.property({type:String,json:{write:!0}})],I.prototype,"datasetFormat",void 0);return I=D.__decorate([B.subclass("esri.layers.support.rasterDatasets.CloudRaster")],I)})},"esri/layers/support/rasterDatasets/DBFParser":function(){define(["../../../chunks/_rollupPluginBabelHelpers","./byteStreamUtils"],function(N,D){function I(F){var y=F.fields;F=F.records;const O=
y.some(p=>"oid"===p.name.toLowerCase())?"OBJECTID":"OID";y=[{name:O,type:"esriFieldTypeOID",alias:"OID"}].concat(y.map(p=>({name:p.name,type:"esriFieldType"+p.typeName,alias:p.name})));const V=y.map(p=>p.name),L=[];let P=0,B=0;F.forEach(p=>{const c={};c[O]=P++;for(B=1;B<V.length;B++)c[V[B]]=p[B-1];L.push({attributes:c})});return{displayFieldName:"",fields:y,features:L}}return function(){function F(){}F.parse=function(y){var O=new DataView(y),V=O.getUint8(0)&3;if(3!==V)return{header:{version:V},recordSet:null};
const L=O.getUint32(4,!0);var P=O.getUint16(8,!0);const B=O.getUint16(10,!0);P={version:V,recordCount:L,headerByteCount:P,recordByteCount:B};let p=32;const c=[],l=[];if(3===V){for(;13!==O.getUint8(p);)V=String.fromCharCode(O.getUint8(p+11)).trim(),c.push({name:D.bytesToUTF8(new Uint8Array(y,p,11)),type:V,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(V)],length:O.getUint8(p+16)}),p+=32;p+=1;if(0<c.length)for(;l.length<L&&y.byteLength-p>B;){const u=[];32===
O.getUint8(p)?(p+=1,c.forEach(h=>{if("C"===h.type)u.push(D.bytesToUTF8(new Uint8Array(y,p,h.length)).trim());else if("N"===h.type)u.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(y,p,h.length)).trim(),10));else if("F"===h.type)u.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(y,p,h.length)).trim()));else if("D"===h.type){const r=String.fromCharCode.apply(null,new Uint8Array(y,p,h.length)).trim();u.push(new Date(parseInt(r.substring(0,4),10),parseInt(r.substring(4,6),10)-
1,parseInt(r.substring(6,8),10)))}p+=h.length}),l.push(u)):p+=B}}O=I({fields:c,records:l});return{header:P,fields:c,records:l,recordSet:O}};N._createClass(F,null,[{key:"supportedVersions",get:function(){return[5]}}]);return F}()})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports","./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(N,D,I,F){const y={GCSShiftXform:D,IdentityXform:I,PolynomialXform:F},O=Object.keys(y);N.isTransformSupported=function(V){return!V||
O.includes(V?.type)};N.readTransform=function(V){if(!V?.type)return null;var L=y[V?.type];return L?(L=new L,L.read(V),L):null};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(N,D,I,F,y,O,V,L,P){F=function(B){function p(){var l=c.apply(this,arguments);l.type="gcs-shift";l.tolerance=1E-8;return l}N._inherits(p,B);var c=N._createSuper(p);B=p.prototype;B.forwardTransform=function(l){l=l.clone();if("point"===l.type)return l.x>180+this.tolerance&&(l.x-=360),l;l.xmin>=180-this.tolerance?(l.xmax-=360,l.xmin-=360):l.xmax>180+this.tolerance&&(l.xmin=-180,l.xmax=180);return l};B.inverseTransform=function(l){l=l.clone();if("point"===l.type)return l.x<-this.tolerance&&(l.x+=
360),l;l.xmin<-this.tolerance&&(l.xmin+=360,l.xmax+=360);return l};return N._createClass(p)}(P);D.__decorate([V.enumeration({GCSShiftXform:"gcs-shift"})],F.prototype,"type",void 0);D.__decorate([I.property()],F.prototype,"tolerance",void 0);return F=D.__decorate([L.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],F)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass".split(" "),
function(N,D,I,F,y,O,V,L){I=function(P){function B(){return p.apply(this,arguments)}N._inherits(B,P);var p=N._createSuper(B);P=B.prototype;P.forwardTransform=function(c){return c};P.inverseTransform=function(c){return c};N._createClass(B,[{key:"affectsPixelSize",get:function(){return!1}}]);return B}(I.JSONSupport);D.__decorate([F.property()],I.prototype,"affectsPixelSize",null);D.__decorate([F.property({json:{write:!0}})],I.prototype,"spatialReference",void 0);return I=D.__decorate([L.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],
I)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/Error ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),function(N,D,I,F,y,O,V,L,P,B){I=function(p){function c(){var u=l.apply(this,arguments);u.type=
"identity";return u}N._inherits(c,p);var l=N._createSuper(c);return N._createClass(c)}(B);D.__decorate([L.enumeration({IdentityXform:"identity"})],I.prototype,"type",void 0);return I=D.__decorate([P.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],I)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u){function h(d,t,G){const {x:E,y:a}=t;if(2>G)return{x:d[0]+E*d[2]+a*d[4],y:d[1]+E*d[3]+a*d[5]};if(2===G){t=E*E;G=a*a;var n=E*a;return{x:d[0]+E*d[2]+a*d[4]+t*d[6]+n*d[8]+G*d[10],y:d[1]+E*d[3]+a*d[5]+t*d[7]+n*d[9]+G*d[11]}}t=E*E;G=a*a;n=E*a;const m=t*E,f=t*a,k=E*G,g=a*G;return{x:d[0]+E*d[2]+a*d[4]+t*d[6]+n*d[8]+G*d[10]+m*d[12]+f*d[14]+k*d[16]+g*d[18],y:d[1]+E*d[3]+a*d[5]+t*d[7]+n*d[9]+G*d[11]+m*d[13]+f*d[15]+k*d[17]+g*d[19]}}function r(d,t,G){const {xmin:E,ymin:a,
xmax:n,ymax:m,spatialReference:f}=t;t=[];if(2>G)t.push({x:E,y:m}),t.push({x:n,y:m}),t.push({x:E,y:a}),t.push({x:n,y:a});else{var k=10;for(var g=0;g<k;g++)t.push({x:E,y:a+(m-a)*g/(k-1)}),t.push({x:n,y:a+(m-a)*g/(k-1)});k=8;for(g=1;g<=k;g++)t.push({x:E+(n-E)*g/k,y:a}),t.push({x:E+(n-E)*g/k,y:m})}t=t.map(b=>h(d,b,G));k=t.map(b=>b.x);t=t.map(b=>b.y);return new u({xmin:Math.min.apply(null,k),xmax:Math.max.apply(null,k),ymin:Math.min.apply(null,t),ymax:Math.max.apply(null,t),spatialReference:f})}I=function(d){function t(){var E=
G.apply(this,arguments);E.polynomialOrder=1;E.type="polynomial";return E}N._inherits(t,d);var G=N._createSuper(t);d=t.prototype;d.readForwardCoefficients=function(E,a){const {coeffX:n,coeffY:m}=a;if(!n?.length||!m?.length||n.length!==m.length)return null;E=[];for(a=0;a<n.length;a++)E.push(n[a]),E.push(m[a]);return E};d.writeForwardCoefficients=function(E,a,n){n=[];const m=[];for(let f=0;f<E?.length;f++)0===f%2?n.push(E[f]):m.push(E[f]);a.coeffX=n;a.coeffY=m};d.readInverseCoefficients=function(E,a){const {inverseCoeffX:n,
inverseCoeffY:m}=a;if(!n?.length||!m?.length||n.length!==m.length)return null;E=[];for(a=0;a<n.length;a++)E.push(n[a]),E.push(m[a]);return E};d.writeInverseCoefficients=function(E,a,n){n=[];const m=[];for(let f=0;f<E?.length;f++)0===f%2?n.push(E[f]):m.push(E[f]);a.inverseCoeffX=n;a.inverseCoeffY=m};d.forwardTransform=function(E){if("point"===E.type){const a=h(this.forwardCoefficients,E,this.polynomialOrder);return new l({x:a.x,y:a.y,spatialReference:E.spatialReference})}return r(this.forwardCoefficients,
E,this.polynomialOrder)};d.inverseTransform=function(E){if("point"===E.type){const a=h(this.inverseCoefficients,E,this.polynomialOrder);return new l({x:a.x,y:a.y,spatialReference:E.spatialReference})}return r(this.inverseCoefficients,E,this.polynomialOrder)};N._createClass(t,[{key:"inverseCoefficients",get:function(){var E=this._get("inverseCoefficients"),a=this._get("forwardCoefficients");if(!E&&a&&2>this.polynomialOrder){const [n,m,f,k,g,b]=a;E=f*b-g*k;a=g*k-f*b;E=[(g*m-n*b)/E,(f*m-n*k)/a,b/E,k/
a,-g/E,-f/a]}return E},set:function(E){this._set("inverseCoefficients",E)}},{key:"affectsPixelSize",get:function(){return 0<this.polynomialOrder}}]);return t}(c);D.__decorate([F.property({json:{write:!0}})],I.prototype,"polynomialOrder",void 0);D.__decorate([F.property()],I.prototype,"forwardCoefficients",void 0);D.__decorate([P.reader("forwardCoefficients",["coeffX","coeffY"])],I.prototype,"readForwardCoefficients",null);D.__decorate([p.writer("forwardCoefficients")],I.prototype,"writeForwardCoefficients",
null);D.__decorate([F.property({json:{write:!0}})],I.prototype,"inverseCoefficients",null);D.__decorate([P.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],I.prototype,"readInverseCoefficients",null);D.__decorate([p.writer("inverseCoefficients")],I.prototype,"writeInverseCoefficients",null);D.__decorate([F.property()],I.prototype,"affectsPixelSize",null);D.__decorate([L.enumeration({PolynomialXform:"polynomial"})],I.prototype,"type",void 0);return I=D.__decorate([B.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
I)})},"esri/layers/support/rasterDatasets/ImageAuxRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/has ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/accessorSupport/decorators/subclass ./BaseRaster ./InMemoryRaster ./pamParser ../rasterFormats/RasterCodec ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference ../../../geometry/Extent".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G){I=function(E){function a(){return n.apply(this,arguments)}N._inherits(a,E);var n=N._createSuper(a);E=a.prototype;E.open=async function(m){await this.init();var f=await this._fetchData(m);let {spatialReference:k,statistics:g,histograms:b,transform:e}=await this._fetchAuxiliaryData(m);(m=!k)&&(k=new t({wkid:3857}));b?.length&&null==g&&(g=r.estimateStatisticsFromHistograms(b));const {width:v,height:w}=f;let C=new G({xmin:-.5,ymin:.5-w,xmax:v-.5,ymax:.5,
spatialReference:k});const M=e?e.forwardTransform(C):C;var K=!0;e&&(K=(K=e.forwardCoefficients)&&0===K[1]&&0===K[2])&&(e=null,C=M);f=new l({data:{extent:M,nativeExtent:C,transform:e,pixelBlock:f,statistics:g,histograms:b,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:m}});await f.open();f.data=null;this._set("rasterInfo",f.rasterInfo);this._inMemoryRaster=f};E.fetchRawTile=function(m,f,k,g={}){return this._inMemoryRaster.fetchRawTile(m,f,k,g)};E._fetchData=async function(m){({data:m}=
await this.request(this.url,{responseType:"array-buffer",signal:m?.signal}));var f=h.getFormat(m).toUpperCase();if("JPG"===f||"PNG"===f||"GIF"===f||"BMP"===f)this._set("datasetFormat",f);else throw new F("image-aux-raster:open","the data is not a supported format");f=f.toLowerCase();const k="gif"===f||"bmp"===f||!y("ios");m=await this.decodePixelBlock(m,{format:f,useCanvas:k,hasNoZlibMask:!0});if(null==m)throw new F("image-aux-raster:open","the data cannot be decoded");return m};E._fetchAuxiliaryData=
async function(m){m=O.unwrap(m?.signal);var f=this.ioConfig.skipExtensions??[],k=f.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:m}),g=this.datasetFormat;f=(g="JPG"===g?"jgw":"PNG"===g?"pgw":"BMP"===g?"bpw":null)&&f.includes(g)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+g,{responseType:"text",signal:m});k=await V.eachAlways([k,f]);if(m?.aborted)throw V.createAbortError();m=u.parsePAMInfo(k[0].value?.data);m.transform||(k=k[1].value?k[1].value.data.split("\n").slice(0,
6).map(b=>Number(b)):null,m.transform=6===k?.length?new d({forwardCoefficients:[k[4],k[5],k[0],-k[1],k[2],-k[3]]}):null);return m};return N._createClass(a)}(c);D.__decorate([L.property({type:String,json:{write:!0}})],I.prototype,"datasetFormat",void 0);return I=D.__decorate([p.subclass("esri.layers.support.rasterDatasets.ImageAuxRaster")],I)})},"esri/layers/support/rasterDatasets/InMemoryRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ./BaseRaster ../rasterFunctions/pixelUtils ../rasterFunctions/stretchUtils ../../../geometry/Extent ../../../geometry/SpatialReference".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d){I=function(t){function G(){var a=E.apply(this,arguments);a.datasetFormat="MEMORY";a.data=null;return a}N._inherits(G,t);var E=N._createSuper(G);t=G.prototype;t.open=async function(a){await this.init();var n=this.data;const {pixelBlock:m,statistics:f,histograms:k,name:g,keyProperties:b,nativeExtent:e,transform:v}=this.data,{width:w,height:C,pixelType:M}=m,K=n.extent??new r({xmin:-.5,ymin:.5,xmax:w-.5,ymax:C-.5,spatialReference:new d({wkid:3857})});n=new c({width:w,
height:C,pixelType:M,extent:K,nativeExtent:e,transform:v,pixelSize:{x:K.width/w,y:K.height/C},spatialReference:K.spatialReference,bandCount:m.pixels.length,keyProperties:b||{},statistics:f,isPseudoSpatialReference:n.isPseudoSpatialReference??!n.extent,histograms:k});this.createRemoteDatasetStorageInfo(n,512,512);this._set("rasterInfo",n);this.updateTileInfo();await this._buildInMemoryRaster(m,{width:512,height:512},a);this.datasetName=g;this.url="/InMemory/"+g};t.fetchRawTile=function(a,n,m,f){a=
this._pixelBlockTiles.get(`${a}/${n}/${m}`);return Promise.resolve(a)};t._buildInMemoryRaster=async function(a,n,m){var f=this.rasterInfo.storageInfo.maximumPyramidLevel;const k=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:a,tileSize:n,maximumPyramidLevel:f},m):Promise.resolve(u.split(a,n,f));n=y.isSome(this.rasterInfo.statistics);f=y.isSome(this.rasterInfo.histograms);a=n?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:a},
m):Promise.resolve(h.estimateStatisticsHistograms(a));a=await O.eachAlways([k,a]);if(!a[0].value&&a[1].value)throw new F("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=a[0].value;n||(this.rasterInfo.statistics=a[1].value?.statistics);f||(this.rasterInfo.histograms=a[1].value?.histograms)};return N._createClass(G)}(l);D.__decorate([V.property({type:String,json:{write:!0}})],I.prototype,"datasetFormat",void 0);D.__decorate([V.property()],I.prototype,"data",void 0);
return I=D.__decorate([p.subclass("esri.layers.support.rasterDatasets.InMemoryRaster")],I)})},"esri/layers/support/rasterDatasets/pamParser":function(){define("exports ../../../geometry ../../../core/maybe ./xmlUtilities ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference".split(" "),function(N,D,I,F,y,O){function V(c,l){if(!c||!l)return null;const u=[];for(let h=0;h<c.length;h++)u.push(c[h]),u.push(l[h]);return u}function L(c){var l=F.getElement(c,"GeodataXform");c=F.getElementNumericValue(l,
"SpatialReference/WKID")||F.getElementValue(l,"SpatialReference/WKT");c=B(c);if("typens:PolynomialXform"!==l.getAttribute("xsi:type"))return{spatialReference:c,transform:null};var u=F.getElementNumericValue(l,"PolynomialOrder")??1,h=F.getElementNumericValues(l,"CoeffX/Double");const r=F.getElementNumericValues(l,"CoeffY/Double");var d=F.getElementNumericValues(l,"InverseCoeffX/Double");l=F.getElementNumericValues(l,"InverseCoeffY/Double");h=V(h,r);d=V(d,l);u=h&&d&&h.length&&d.length?new y({spatialReference:c,
polynomialOrder:u,forwardCoefficients:h,inverseCoefficients:d}):null;return{spatialReference:c,transform:u}}function P(c){const l=F.getElementNumericValue(c,"NoDataValue");var u=F.getElement(c,"Histograms/HistItem");const h=F.getElementNumericValue(u,"HistMin"),r=F.getElementNumericValue(u,"HistMax"),d=F.getElementNumericValue(u,"BucketCount");u=F.getElementValue(u,"HistCounts")?.split("|").map(n=>Number(n));let t,G,E,a;F.getElements(c,"Metadata/MDI").forEach(n=>{const m=Number(n.textContent??n.nodeValue);
switch(n.getAttribute("key").toUpperCase()){case "STATISTICS_MINIMUM":t=m;break;case "STATISTICS_MAXIMUM":G=m;break;case "STATISTICS_MEAN":E=m;break;case "STATISTICS_STDDEV":a=m}});c=F.getElementNumericValue(c,"Metadata/SourceBandIndex");return{noDataValue:l,histogram:u?.length&&null!=h&&null!=r?{min:h,max:r,size:d||u.length,counts:u}:null,sourceBandIndex:c,statistics:null!=t&&null!=G?{min:t,max:G,avg:E,stddev:a}:null}}function B(c){if(!c)return null;var l=Number(c);if(!isNaN(l)&&0!==l)return new O({wkid:l});
c=String(c);if(c.startsWith("COMPD_CS")){if(!c.includes("VERTCS")||!c.includes("GEOGCS")&&!c.startsWith("PROJCS"))return null;l=c.indexOf("VERTCS");var u=c.indexOf("PROJCS");u=-1<u?u:c.indexOf("GEOGCS");if(-1===u)return null;u=c.slice(u,c.lastIndexOf("]",l)+1).trim();c=c.slice(l,c.lastIndexOf("]")).trim();l=(l=p(u))?new O({wkid:l}):new O({wkt:u});if(c=p(c))l.vcsWkid=c;return l}if(!c.startsWith("GEOGCS")&&!c.startsWith("PROJCS"))return null;l=p(c);return 0!==l?new O({wkid:l}):new O({wkt:c})}function p(c){var l=
c.replace(/\]/g,"[").replace(/"/g,"").split("[").map(h=>h.trim()).filter(h=>""!==h);l=l[l.length-1].split(",");const u=l[0]?.toLowerCase();return"epsg"!==u&&"esri"!==u||!c.endsWith('"]]')||(c=Number(l[1]),isNaN(c)||0===c)?0:c}N.parsePAMInfo=function(c){if("pamdataset"!==c?.documentElement.tagName?.toLowerCase())return{};const l={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};c.documentElement.childNodes.forEach(u=>{if(1===u.nodeType)if(F.isSameTagIgnoreNS(u,
"SRS"))l.spatialReference||(u=F.getElementValue(u),l.spatialReference=B(u));else if(F.isSameTagIgnoreNS(u,"Metadata"))if("xml:ESRI"===u.getAttribute("domain")){const {spatialReference:h,transform:r}=L(u);l.transform=r;l.spatialReference||(l.spatialReference=h)}else F.getElements(u,"MDI").forEach(h=>l.metadata[h.getAttribute("key")]=F.getElementValue(h));else F.isSameTagIgnoreNS(u,"PAMRasterBand")&&(u=P(u),null!=u.sourceBandIndex&&null==l.rasterBands[u.sourceBandIndex]?l.rasterBands[u.sourceBandIndex]=
u:l.rasterBands.push(u))});c=l.rasterBands;c.length&&(l.statistics=c[0].statistics?c.map(u=>u.statistics).filter(I.isSome):null,l.histograms=c[0].histogram?c.map(u=>u.histogram).filter(I.isSome):null);return l};N.parseSpatialReference=B;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/xmlUtilities":function(){define(["exports"],function(N){function D(O,V){if(!O||!V)return[];var L=V;V.includes("/")?(L=V.slice(0,V.indexOf("/")),V=V.slice(V.indexOf("/")+
1)):V="";const P=[];if(V){O=D(O,L);for(L=0;L<O.length;L++)D(O[L],V).forEach(B=>P.push(B));return P}V=O.getElementsByTagNameNS("*",L);if(!V||0===V.length)return[];for(O=0;O<V.length;O++)P.push(V[O]||V.item[O]);return P}function I(O,V){if(!O||!V)return null;let L=V;V.includes("/")?(L=V.slice(0,V.indexOf("/")),V=V.slice(V.indexOf("/")+1)):V="";O=D(O,L);return 0<O.length?V?I(O[0],V):O[0]:null}function F(O,V=null){if(O=V?I(O,V):O)if(O=O.textContent||O.nodeValue)return O.trim();return null}function y(O,
V){O=D(O,V);V=[];let L;for(let P=0;P<O.length;P++)if(L=O[P].textContent||O[P].nodeValue)L=L.trim(),""!==L&&V.push(L);return V}N.getElement=I;N.getElementNumericValue=function(O,V){O=F(O,V);return Number(O)};N.getElementNumericValues=function(O,V){return y(O,V).map(L=>Number(L))};N.getElementValue=F;N.getElementValues=y;N.getElements=D;N.getNodeNameIgnoreNS=function(O){return O.nodeName.slice(O.nodeName.lastIndexOf(":")+1)};N.getSpaceDelimitedNumericValues=function(O,V=null){return F(O,V)?.split(" ").map(L=>
Number(L))??[]};N.isSameTagIgnoreNS=function(O,V){O=O?.nodeName?.toLowerCase();V=V.toLowerCase();return O.slice(O.lastIndexOf(":")+1)===V};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/ImageServerRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../serviceTileInfoProperty ../TileInfo ../TilemapCache ./BaseRaster ../rasterFunctions/pixelUtils ../rasterTransforms/GCSShiftTransform ../../../rest/imageService/fetchRasterInfo ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a,n,m){I=function(f){function k(){var b=g.apply(this,arguments);b._levelOffset=0;b._tilemapCache=null;b._slices=null;b.datasetFormat="RasterTileServer";b.tileType=null;return b}N._inherits(k,f);var g=N._createSuper(k);f=k.prototype;f.open=async function(b){await this.init();var e=b&&b.signal;b=this.sourceJSON?{data:this.sourceJSON}:await this.request(this.url,{query:{f:"json"},signal:e});b.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));this.sourceJSON=
b=b.data;if(!b)throw new F("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!b.tileInfo)throw new F("imageserverraster:open","use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();var v="jpg jpeg png png8 png24 png32 mixed".split(" ");this.tileType=b.cacheType;null==this.tileType&&(v.includes(b.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===b.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster");
this.datasetName=b.name?.slice(b.name.indexOf("/")+1)??"";e=await this._fetchRasterInfo({signal:e});if(y.isNone(e))throw new F("image-server-raster:open","cannot initialize image service");v="Map"===this.tileType?u.readServiceTileInfo(b.tileInfo,b):h.fromJSON(b.tileInfo);y.assertIsSome(v);const [w,C]=this._computeMinMaxLOD(e,v),{extent:M,pixelSize:K}=e,x=.5/e.width*K.x,q=Math.max(K.x,K.y),{lods:A}=v;if("Map"!==this.tileType&&0!==b.maxScale||Math.abs(K.x-K.y)>x||!A.some(X=>Math.abs(X.resolution-q)<
x))K.x=K.y=w.resolution,e.width=Math.ceil((M.xmax-M.xmin)/K.x-.1),e.height=Math.ceil((M.ymax-M.ymin)/K.y-.1);const H=w.level-C.level,[Q,S]=v.size,z=[],J=[];A.forEach((X,T)=>{X.level>=C.level&&X.level<=w.level&&z.push({x:X.resolution,y:X.resolution});T<A.length-1&&J.push(Math.round(10*X.resolution/A[T+1].resolution)/10)});z.sort((X,T)=>X.x-T.x);const R=this.computeBlockBoundary(M,Q,S,v.origin,z,H),W=1<z.length?z.slice(1):null;var Z;b.transposeInfo&&(Z={tileSize:[b.transposeInfo.rows,b.transposeInfo.cols],
packetSize:e.keyProperties?._yxs.PacketSize??0});const Y=1>=J.length||3<=J.length&&J.slice(0,J.length-1).every(X=>X===J[0])?J[0]??2:Math.round(10/(C.resolution/w.resolution)**(-1/H))/10;e.storageInfo=new l({blockWidth:v.size[0],blockHeight:v.size[1],pyramidBlockWidth:v.size[0],pyramidBlockHeight:v.size[1],pyramidResolutions:W,pyramidScalingFactor:Y,compression:v.format,origin:v.origin,firstPyramidLevel:1,maximumPyramidLevel:H,tileInfo:v,transposeInfo:Z,blockBoundary:R});this._fixGCSShift(e);this._set("rasterInfo",
e);b.capabilities.toLowerCase().includes("tilemap")&&(Z={tileInfo:e.storageInfo.tileInfo,parsedUrl:O.urlToObject(this.url),url:this.url,tileServers:[],type:"tile"},this._tilemapCache=new r.TilemapCache({layer:Z}))};f.fetchRawTile=async function(b,e,v,w={}){const {storageInfo:C,extent:M}=this.rasterInfo;var {transposeInfo:K}=C,x=y.isSome(K)&&!!w.transposedVariableName;if(this._slices&&!x&&null==w.sliceId)return null;({data:w}=await this.request(`${this.url}/tile/${x?0:C.maximumPyramidLevel-b+this._levelOffset}/${e}/${v}`,
{query:this._slices?x?{variable:w.transposedVariableName}:{sliceId:w.sliceId||0}:null,responseType:"array-buffer",signal:w.signal}));if(!w)return null;K=x?K.tileSize:C.tileInfo.size;x=await this.decodePixelBlock(w,{width:K[0],height:K[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType,returnInterleaved:x,noDataValue:y.unwrap(this.rasterInfo.noDataValue)});if(null==x)return null;K=C.blockBoundary[b];if("jpg"!==C.compression||v>K.minCol&&v<K.maxCol&&e>K.minRow&&e<K.maxRow)return x;const {origin:q,
blockWidth:A,blockHeight:H}=C,{x:Q,y:S}=this.getPyramidPixelSize(b);var z=Math.round((M.xmin-q.x)/Q)%A;b=Math.round((M.xmax-q.x)/Q)%A||A;var J=Math.round((q.y-M.ymax)/S)%H;w=Math.round((q.y-M.ymin)/S)%H||H;z=v===K.minCol?z:0;J=e===K.minRow?J:0;t.setValidBoundary(x,{x:z,y:J},{width:(v===K.maxCol?b:A)-z,height:(e===K.maxRow?w:H)-J});return x};f.getSliceIndex=function(b){if(!this._slices||y.isNone(b)||0===b.length)return null;for(let e=0;e<this._slices.length;e++){const v=this._slices[e].multidimensionalDefinition;
if(v.length===b.length&&!v.some(w=>{var C=b.find(K=>w.variableName===K.variableName&&K.dimensionName===w.dimensionName);if(!C)return!0;const M=Array.isArray(w.values[0])?`${w.values[0][0]}-${w.values[0][1]}`:w.values[0];C=Array.isArray(C.values[0])?`${C.values[0][0]}-${C.values[0][1]}`:C.values[0];return M!==C}))return e}return null};f.fetchVariableStatisticsHistograms=async function(b,e){var v=this.request(this.url+"/statistics",{query:{variable:b,f:"json"},signal:e}).then(w=>w.data?.statistics);
b=this.request(this.url+"/histograms",{query:{variable:b,f:"json"},signal:e}).then(w=>w.data?.histograms);v=await Promise.all([v,b]);v[0]&&v[0].forEach(w=>{w.avg=w.mean;w.stddev=w.standardDeviation});return{statistics:v[0]||null,histograms:v[1]||null}};f.computeBestPyramidLevelForLocation=async function(b,e={}){if(!this._tilemapCache)return 0;b=this.identifyPixelLocation(b,0,y.unwrap(e.datumTransformation));if(null===b)return null;let v=0;var {maximumPyramidLevel:w}=this.rasterInfo.storageInfo;w=
w-v+this._levelOffset;const C=b.srcLocation;for(;0<=w;){try{if("available"===await this._tilemapCache.fetchAvailability(w,b.row,b.col,e))break}catch{}w--;v++;b=this.identifyPixelLocation(C,v,y.unwrap(e.datumTransformation));if(null===b)return null}return-1===w||null==b?null:v};f._fetchRasterInfo=async function(b){var e=this.sourceJSON;if("Map"===this.tileType){b=e.fullExtent||e.extent;var v=Math.ceil((b.xmax-b.xmin)/e.pixelSizeX-.1);const w=Math.ceil((b.ymax-b.ymin)/e.pixelSizeY-.1),C=a.fromJSON(e.spatialReference||
b.spatialReference);e=new n({x:e.pixelSizeX,y:e.pixelSizeY,spatialReference:C});return new c({width:v,height:w,bandCount:3,extent:m.fromJSON(b),spatialReference:C,pixelSize:e,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}({signal:v}=b);b=E.fetchServiceRasterInfo(this.url,this.sourceJSON,{signal:v,query:this.ioConfig.customFetchParameters});e=e.hasMultidimensions?this.request(`${this.url}/slices`,{query:{f:"json"},signal:v}).then(w=>w.data&&w.data.slices).catch(()=>null):null;
e=await Promise.all([b,e]);this._slices=e[1];return e[0]};f._fixScaleInServiceInfo=function(){const {sourceJSON:b}=this;b.minScale&&0>b.minScale&&(b.minScale=0);b.maxScale&&0>b.maxScale&&(b.maxScale=0)};f._fixGCSShift=function(b){const {extent:e,spatialReference:v}=b;-1<e.xmin&&181<e.xmax&&v?.wkid&&v.isGeographic&&(b.nativeExtent=b.extent,b.transform=new G,b.extent=b.transform.forwardTransform(e))};f._computeMinMaxLOD=function(b,e){const {pixelSize:v}=b,w=.5/b.width*v.x;({lods:b}=e);var C=e.lodAt(Math.max.apply(null,
b.map(q=>q.level)));e=e.lodAt(Math.min.apply(null,b.map(q=>q.level)));var {tileType:M}=this;if("Map"===M)return this._levelOffset=b[0].level,[C,e];if("Raster"===M)return[b.find(q=>q.resolution===v.x)??C,e];const {minScale:K,maxScale:x}=this.sourceJSON;M=C;0<x&&((M=b.find(q=>Math.abs(q.scale-x)<w))||(M=b.filter(q=>q.scale>x).sort((q,A)=>q.scale>A.scale?1:-1)[0]??C));C=e;0<K&&(C=b.find(q=>Math.abs(q.scale-K)<w)??e,this._levelOffset=C.level-e.level);return[M,C]};return N._createClass(k)}(d);D.__decorate([V.property({type:String,
json:{write:!0}})],I.prototype,"datasetFormat",void 0);D.__decorate([V.property()],I.prototype,"tileType",void 0);return I=D.__decorate([p.subclass("esri.layers.support.rasterDatasets.ImageServerRaster")],I)})},"esri/layers/support/serviceTileInfoProperty":function(){define(["exports","./TileInfo"],function(N,D){function I(y,O,V,L){if(!y)return null;const {minScale:P,maxScale:B,minLOD:p,maxLOD:c}=O;if(null!=p&&null!=c)return L&&L.ignoreMinMaxLOD?D.fromJSON(y):D.fromJSON({...y,lods:y.lods.filter(({level:l})=>
null!=l&&l>=p&&l<=c)});if(0!==P&&0!==B){const l=P?Math.round(1E4*P)/1E4:Infinity,u=B?Math.round(1E4*B)/1E4:-Infinity;return D.fromJSON({...y,lods:y.lods.filter(h=>{h=Math.round(1E4*h.scale)/1E4;return h<=l&&h>=u})})}return D.fromJSON(y)}const F={type:D,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:I}}}}};N.readServiceTileInfo=I;N.serviceTileInfoProperty=F;Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/byteSizeEstimations ../../core/Error ../../core/HandleOwner ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/subclass ./TileKey ./Tilemap".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a,n){var m;N.TilemapCache=m=function(f){function k(b){b=g.call(this,b);b._pendingTilemapRequests={};b._availableLevels={};b.levels=5;b.cacheByteSize=2*O.ByteSizeUnit.MEGABYTES;b.request=F;b._prefetchingEnabled=!0;return b}D._inherits(k,f);var g=D._createSuper(k);f=k.prototype;f.initialize=function(){this._tilemapCache=new B(this.cacheByteSize);this.addHandles([l.watch(()=>{const {layer:b}=this;return[b?.parsedUrl,b?.tileServers,b?.apiKey,b?.customParameters]},
()=>this._initializeTilemapDefinition()),l.watch(()=>this.layer?.tileInfo?.lods,b=>this._initializeAvailableLevels(b),l.syncAndInitial)]);this._initializeTilemapDefinition()};f.castLevels=function(b){return 2>=b?(P.getLogger(this.declaredClass).error("Minimum levels for Tilemap is 3, but got ",b),3):b};f.fetchTilemap=function(b,e,v,w){if(!this._availableLevels[b])return Promise.reject(new V("tilemap-cache:level-unavailable",`Level ${b} is unavailable in the service`));const C=this._tmpTilemapDefinition;
if(b=this._tilemapFromCache(b,e,v,C))return Promise.resolve(b);const M=w&&w.signal;w={...w,signal:null};return new Promise((K,x)=>{c.onAbort(M,()=>x(c.createAbortError()));const q=n.tilemapDefinitionId(C);let A=this._pendingTilemapRequests[q];if(!A){A=n.Tilemap.fromDefinition(C,w).then(Q=>{this._tilemapCache.put(q,Q,Q.byteSize);return Q});const H=()=>delete this._pendingTilemapRequests[q];this._pendingTilemapRequests[q]=A;A.then(H,H)}A.then(K,x)})};f.getAvailability=function(b,e,v){return this._availableLevels[b]?
(b=this._tilemapFromCache(b,e,v,this._tmpTilemapDefinition))?b.getAvailability(e,v):"unknown":"unavailable"};f.fetchAvailability=function(b,e,v,w){return this._availableLevels[b]?this.fetchTilemap(b,e,v,w).catch(C=>C).then(C=>{if(C instanceof n.Tilemap){C=C.getAvailability(e,v);if("unavailable"===C)throw new V("tile-map:tile-unavailable","Tile is not available",{level:b,row:e,col:v});return C}if(c.isAbortError(C))throw C;return"unknown"}):Promise.reject(new V("tilemap-cache:level-unavailable",`Level ${b} is unavailable in the service`))};
f.fetchAvailabilityUpsample=function(b,e,v,w,C){w.level=b;w.row=e;w.col=v;const M=this.layer.tileInfo;M.updateTileInfo(w);const K=this.fetchAvailability(b,e,v,C).catch(x=>{if(c.isAbortError(x))throw x;if(M.upsampleTile(w))return this.fetchAvailabilityUpsample(w.level,w.row,w.col,w);throw x;});this._fetchAvailabilityUpsamplePrefetch(w.id,b,e,v,C,K);return K};f._fetchAvailabilityUpsamplePrefetch=async function(b,e,v,w,C,M){if(this._prefetchingEnabled&&null!=b){var K=`prefetch-${b}`;if(!this.handles.has(K)){var x=
new AbortController;M.then(()=>x.abort(),()=>x.abort());var q=!1;this.handles.add({remove(){q||(q=!0,x.abort())}},K);await u.waitTicks(10,x.signal).catch(()=>{});q||(q=!0,this.handles.remove(K));if(!c.isAborted(x))for(b=new a.TileKey(b,e,v,w),C={...C,signal:x.signal},e=this.layer.tileInfo,v=0;m._prefetches.length<m._maxPrefetch&&e.upsampleTile(b);++v){const A=this.fetchAvailability(b.level,b.row,b.col,C);m._prefetches.push(A);w=()=>{m._prefetches.removeUnordered(A)};A.then(w,w)}}}};f._initializeTilemapDefinition=
function(){if(this.layer.parsedUrl){var {parsedUrl:b,apiKey:e,customParameters:v}=this.layer;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:b.path,query:h.objectToQuery({...b.query,...v,token:e??b.query?.token}),tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};f._tilemapFromCache=function(b,e,v,w){w.level=b;w.row=e-e%this.size;w.col=v-v%this.size;b=n.tilemapDefinitionId(w);return this._tilemapCache.get(b)};
f._initializeAvailableLevels=function(b){this._availableLevels={};b&&b.forEach(e=>this._availableLevels[e.level]=!0)};D._createClass(k,[{key:"size",get:function(){return 1<<this.levels}},{key:"test",get:function(){const b=this;return{get prefetchingEnabled(){return b._prefetchingEnabled},set prefetchingEnabled(e){b._prefetchingEnabled=e},hasTilemap(e,v,w){return!!b._tilemapFromCache(e,v,w,b._tmpTilemapDefinition)}}}}]);return k}(L.HandleOwnerMixin(y));N.TilemapCache._maxPrefetch=4;N.TilemapCache._prefetches=
new p({initialSize:m._maxPrefetch});I.__decorate([r.property({constructOnly:!0,type:Number})],N.TilemapCache.prototype,"levels",void 0);I.__decorate([d.cast("levels")],N.TilemapCache.prototype,"castLevels",null);I.__decorate([r.property({readOnly:!0,type:Number})],N.TilemapCache.prototype,"size",null);I.__decorate([r.property({constructOnly:!0,type:Number})],N.TilemapCache.prototype,"cacheByteSize",void 0);I.__decorate([r.property({constructOnly:!0})],N.TilemapCache.prototype,"layer",void 0);I.__decorate([r.property({constructOnly:!0})],
N.TilemapCache.prototype,"request",void 0);N.TilemapCache=m=I.__decorate([E.subclass("esri.layers.support.TilemapCache")],N.TilemapCache);Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Tilemap":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../request ../../core/arrayUtils ../../core/Error ../../core/lang".split(" "),function(N,D,I,F,y,O){function V(P){if("vector-tile"===P.service.type)var B=`${P.service.url}/tilemap/${P.level}/${P.row}/${P.col}/${P.width}/${P.height}`;
else B=P.service.tileServers,B=`${B&&B.length?B[P.row%B.length]:P.service.url}/tilemap/${P.level}/${P.row}/${P.col}/${P.width}/${P.height}`;(P=P.service.query)&&(B=`${B}?${P}`);return B}let L=function(){function P(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=40}var B=P.prototype;B.getAvailability=function(p,c){if("unknown"!==this._allAvailability)return this._allAvailability;p=(p-this.location.top)*this.location.width+(c-this.location.left);c=p>>3;
const l=this._tileAvailabilityBitSet;return 0>c||c>l.length?"unknown":l[c]&1<<p%8?"available":"unavailable"};B._updateFromData=function(p){let c=!0,l=!0;const u=new Uint8Array(Math.ceil(this.location.width*this.location.height/8));let h=0;for(let r=0;r<p.length;r++){const d=r%8;p[r]?(l=!1,u[h]|=1<<d):c=!1;7===d&&++h}l?this._allAvailability="unavailable":c?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=u,this.byteSize+=u.length)};P.fromDefinition=function(p,
c){const l=p.service.request||I,{row:u,col:h,width:r,height:d}=p,t={query:{f:"json"}};c=c?{...t,...c}:t;return l(V(p),c).then(G=>G.data).catch(G=>{if(G&&G.details&&422===G.details.httpStatus)return{location:{top:u,left:h,width:r,height:d},valid:!0,data:F.constant(r*d,0)};throw G;}).then(G=>{if(G.location&&(G.location.top!==u||G.location.left!==h||G.location.width!==r||G.location.height!==d))throw new y("tilemap:location-mismatch","Tilemap response for different location than requested",{response:G,
definition:{top:u,left:h,width:r,height:d}});return P.fromJSON(G)})};P.fromJSON=function(p){P._validateJSON(p);const c=new P;c.location=Object.freeze(O.clone(p.location));c._updateFromData(p.data);return Object.freeze(c)};P._validateJSON=function(p){if(!p||!p.location)throw new y("tilemap:missing-location","Location missing from tilemap response");if(!1===p.valid)throw new y("tilemap:invalid","Tilemap response was marked as invalid");if(!p.data)throw new y("tilemap:missing-data","Data missing from tilemap response");
if(!Array.isArray(p.data))throw new y("tilemap:data-mismatch","Data must be an array of numbers");if(p.data.length!==p.location.width*p.location.height)throw new y("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");};return D._createClass(P)}();N.Tilemap=L;N.tilemapDefinitionId=function(P){return`${P.level}/${P.row}/${P.col}/${P.width}/${P.height}`};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/rest/imageService/fetchRasterInfo":function(){define("exports ../../request ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../layers/support/RasterInfo ../utils ../support/FeatureSet".split(" "),
function(N,D,I,F,y,O,V,L){async function P(B,p,c){B=V.parseUrl(B);const {renderingRule:l,sourceJSON:u}=p||{};p=l?JSON.stringify(l.rasterFunctionDefinition||l):null;p=V.encode({...B.query,renderingRule:p,f:"json"});p=V.asValidOptions(p,c);B=B.path;c=u||await D(B,p).then(k=>k.data);var h=c.hasRasterAttributeTable?D(`${B}/rasterAttributeTable`,p):null,r=c.hasColormap?D(`${B}/colormap`,p):null,d=c.hasHistograms?D(`${B}/histograms`,p):null,t=10.3<=c.currentVersion?D(`${B}/keyProperties`,p):null;B=c.hasMultidimensions?
D(`${B}/multidimensionalInfo`,p):null;p=await Promise.allSettled([h,r,d,t,B]);B=null;if(c.minValues&&c.minValues.length===c.bandCount)for(B=[],h=0;h<c.minValues.length;h++)B.push({min:c.minValues[h],max:c.maxValues[h],avg:c.meanValues[h],stddev:c.stdvValues[h]});r=I.fromJSON(c.extent);h=Math.ceil(r.width/c.pixelSizeX-.1);r=Math.ceil(r.height/c.pixelSizeY-.1);d=y.fromJSON(c.spatialReference||c.extent.spatialReference);t="fulfilled"===p[0].status?p[0].value?L.fromJSON(p[0].value.data):null:null;const G=
"fulfilled"===p[1].status?p[1].value?.data.colormap:null,E="fulfilled"===p[2].status?p[2].value?.data.histograms:null,a="fulfilled"===p[3].status?p[3].value?.data??{}:{};p="fulfilled"===p[4].status?p[4].value?.data.multidimensionalInfo:null;p?.variables?.length&&p.variables.forEach(k=>{k.statistics?.length&&k.statistics.forEach(g=>{g.avg=g.mean;g.stddev=g.standardDeviation})});const {defaultVariable:n,serviceDataType:m}=c;n&&n!==a.DefaultVariable&&(a.DefaultVariable=n);m&&m.includes("esriImageServiceDataTypeVector")&&
!m.includes(a.DataType)&&(a.DataType=m.replace("esriImageServiceDataType",""));let f=c.noDataValue;c.noDataValues?.length&&c.noDataValues.some(k=>k!==f)&&(f=c.noDataValues);return new O({width:h,height:r,bandCount:c.bandCount,extent:I.fromJSON(c.extent),spatialReference:d,pixelSize:new F({x:c.pixelSizeX,y:c.pixelSizeY,spatialReference:d}),pixelType:c.pixelType.toLowerCase(),statistics:B,attributeTable:t,colormap:G,histograms:E,keyProperties:a,noDataValue:f,multidimensionalInfo:p})}N.fetchServiceRasterInfo=
function(B,p,c){return P(B,{sourceJSON:p},c)};N.generateRasterInfo=function(B,p,c){return P(B,{renderingRule:p},c)};Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/MRFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo ../RasterStorageInfo ./BaseRaster ./pamParser ./xmlUtilities ../rasterFormats/utils ../rasterFunctions/stretchUtils ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a){const n=new Map;n.set("Int8","s8");n.set("UInt8","u8");n.set("Int16","s16");n.set("UInt16","u16");n.set("Int32","s32");n.set("UInt32","u32");n.set("Float32","f32");n.set("Float64","f32");n.set("Double64","f32");const m=new Map;m.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"});m.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"});m.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"});
m.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});I=function(f){function k(){var b=g.apply(this,arguments);b._files=null;b._storageIndex=null;b.datasetFormat="MRF";return b}N._inherits(k,f);var g=N._createSuper(k);f=k.prototype;f.open=async function(b){await this.init();this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);var e=b?y.unwrap(b.signal):null,v=await this.request(this.url,{responseType:"xml",signal:e});const {rasterInfo:w,files:C}=this._parseHeader(v.data);
-1===this.ioConfig.skipExtensions?.indexOf("aux.xml")&&(b=await this._fetchAuxiliaryData(b),null!=b&&(w.statistics=b.statistics??w.statistics,(w.histograms=b.histograms)&&y.isNone(w.statistics)&&(w.statistics=t.estimateStatisticsFromHistograms(b.histograms))));this._set("rasterInfo",w);this._files=C;e=await this.request(C.index,{responseType:"array-buffer",signal:e});this._storageIndex=this._parseIndex(e.data);const {blockWidth:M,blockHeight:K}=this.rasterInfo.storageInfo;e=this.rasterInfo.storageInfo.pyramidScalingFactor;
const {width:x,height:q}=this.rasterInfo;b=[];v=this._getBandSegmentCount();let A=0,H=-1;for(;A<this._storageIndex.length;){H++;const Q=Math.ceil(x/M/e**H)-1,S=Math.ceil(q/K/e**H)-1;A+=(Q+1)*(S+1)*v*4;b.push({maxRow:S,maxCol:Q,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=b;0<H&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=H);this.updateTileInfo()};f.fetchRawTile=async function(b,e,v,w={}){const {blockWidth:C,blockHeight:M,blockBoundary:K}=
this.rasterInfo.storageInfo;var x=K[b];if(!x||x.maxRow<e||x.maxCol<v||x.minRow>e||x.minCol>v)return null;const {bandCount:q,pixelType:A}=this.rasterInfo,{ranges:H,actualTileWidth:Q,actualTileHeight:S}=this._getTileLocation(b,e,v);if(!H||0===H.length)return null;if(0===H[0].from&&0===H[0].to)return b=new Uint8Array(C*M),new p({width:C,height:M,pixels:null,mask:b,validPixelCount:0});({bandIds:e}=this.ioConfig);v=this._getBandSegmentCount();x=[];for(b=b=0;b<v;b++)(!e||-1<e.indexOf[b])&&x.push(this.request(this._files.data,
{range:{from:H[b].from,to:H[b].to},responseType:"array-buffer",signal:w.signal}));w=await Promise.all(x);b=w.map(J=>J.data.byteLength).reduce((J,R)=>J+R);x=new Uint8Array(b);let z=0;for(b=0;b<v;b++)x.set(new Uint8Array(w[b].data),z),z+=w[b].data.byteLength;b=m.get(this.rasterInfo.storageInfo.compression).decoderFormat;e=await this.decodePixelBlock(x.buffer,{width:C,height:M,format:b,planes:e?.length||q,pixelType:A});if(null==e)return null;if(y.isSome(this.rasterInfo.noDataValue)&&"lerc"!==b&&!e.mask&&
(w=this.rasterInfo.noDataValue[0],null!=w)){v=e.width*e.height;x=new Uint8Array(v);if(1E24<Math.abs(w))for(b=0;b<v;b++)1E-6<Math.abs((e.pixels[0][b]-w)/w)&&(x[b]=1);else for(b=0;b<v;b++)e.pixels[0][b]!==w&&(x[b]=1);e.mask=x}v=w=0;if(Q!==C||S!==M)if(x=e.mask)for(b=0;b<M;b++)for(v=b*C,w=b<S?Q:0;w<C;w++)x[v+w]=0;else for(x=new Uint8Array(C*M),e.mask=x,b=0;b<S;b++)for(v=b*C,w=0;w<Q;w++)x[v+w]=1;return e};f._parseIndex=function(b){if(0<b.byteLength%16)throw Error("invalid array buffer must be multiples of 16");
let e,v,w,C,M;if(d.isPlatformLittleEndian){e=new Uint8Array(b);w=new ArrayBuffer(b.byteLength);v=new Uint8Array(w);for(C=0;C<b.byteLength/4;C++)for(M=0;4>M;M++)v[4*C+M]=e[4*C+3-M];b=new Uint32Array(w)}else b=new Uint32Array(b);return b};f._getBandSegmentCount=function(){return m.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount};f._getTileLocation=function(b,e,v){const {blockWidth:w,blockHeight:C,pyramidScalingFactor:M}=this.rasterInfo.storageInfo,{width:K,height:x}=
this.rasterInfo,q=this._getBandSegmentCount();let A,H;var Q,S=0;let z=0;for(Q=0;Q<b;Q++)z=M**Q,A=Math.ceil(K/w/z),H=Math.ceil(x/C/z),S+=A*H;z=M**b;A=Math.ceil(K/w/z);H=Math.ceil(x/C/z);S=4*(S+(e*A+v))*q;b=this._storageIndex.subarray(S,S+4*q);S=Q=0;const J=[];for(let R=0;R<q;R++)Q=b[4*R]*2**32+b[4*R+1],S=Q+b[4*R+2]*2**32+b[4*R+3],J.push({from:Q,to:S});return{ranges:J,actualTileWidth:v<A-1?w:Math.ceil(K/z)-w*(A-1),actualTileHeight:e<H-1?C:Math.ceil(x/z)-C*(H-1)}};f._parseHeader=function(b){var e=r.getElement(b,
"MRF_META/Raster");if(!e)throw new F("mrf:open","not a valid MRF format");var v=r.getElement(e,"Size"),w=parseInt(v.getAttribute("x"),10),C=parseInt(v.getAttribute("y"),10);const M=parseInt(v.getAttribute("c"),10);v=(r.getElementValue(e,"Compression")||"none").toLowerCase();if(!m.has(v))throw new F("mrf:open","currently does not support compression "+v);var K=r.getElementValue(e,"DataType")||"UInt8";const x=n.get(K);if(null==x)throw new F("mrf:open","currently does not support pixel type "+K);var q=
r.getElement(e,"PageSize");K=parseInt(q.getAttribute("x"),10);q=parseInt(q.getAttribute("y"),10);e=r.getElement(e,"DataValues");let A;e&&(e=e.getAttribute("NoData"),null!=e&&(A=e.trim().split(" ").map(W=>parseFloat(W))));if(r.getElement(b,"MRF_META/CachedSource"))throw new F("mrf:open","currently does not support MRF referencing other data files");var H=r.getElement(b,"MRF_META/GeoTags"),Q=r.getElement(H,"BoundingBox");e=!1;if(null!=Q){var S=parseFloat(Q.getAttribute("minx"));var z=parseFloat(Q.getAttribute("miny")),
J=parseFloat(Q.getAttribute("maxx"));Q=parseFloat(Q.getAttribute("maxy"));var R=r.getElementValue(H,"Projection")||"";H=G.WGS84;"LOCAL_CS[]"!==R?R.toLowerCase().startsWith("epsg:")?(R=Number(R.slice(5)),isNaN(R)||0===R||(H=new G({wkid:R}))):H=h.parseSpatialReference(R)??G.WGS84:(e=!0,H=new G({wkid:3857}));S=new E(S,z,J,Q);S.spatialReference=H}else e=!0,S=new E({xmin:-.5,ymin:.5-C,xmax:w-.5,ymax:.5,spatialReference:new G({wkid:3857})});z=r.getElement(b,"MRF_META/Rsets");J=parseInt(z&&z.getAttribute("scale")||
"2",10);z=S.spatialReference;K=new l({origin:new a({x:S.xmin,y:S.ymax,spatialReference:z}),blockWidth:K,blockHeight:q,pyramidBlockWidth:K,pyramidBlockHeight:q,compression:v,pyramidScalingFactor:J});q=new a({x:S.width/w,y:S.height/C,spatialReference:z});w=new c({width:w,height:C,extent:S,isPseudoSpatialReference:e,spatialReference:z,bandCount:M,pixelType:x,pixelSize:q,noDataValue:A,storageInfo:K});C=r.getElementValue(b,"datafile");b=r.getElementValue(b,"IndexFile");b={mrf:this.url,index:b||this.url.replace(".mrf",
".idx"),data:C||this.url.replace(".mrf",m.get(v).blobExtension)};return{rasterInfo:w,files:b}};f._fetchAuxiliaryData=async function(b){try{const {data:e}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:b?.signal});return h.parsePAMInfo(e)}catch{return null}};return N._createClass(k)}(u);D.__decorate([O.property()],I.prototype,"_files",void 0);D.__decorate([O.property()],I.prototype,"_storageIndex",void 0);D.__decorate([O.property({type:String,json:{write:!0}})],I.prototype,"datasetFormat",
void 0);return I=D.__decorate([B.subclass("esri.layers.support.rasterIO.MRFRaster")],I)})},"esri/layers/support/rasterDatasets/TIFFRaster":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/arrayUtils ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ./BaseRaster ./DBFParser ./pamParser ../rasterFormats/TiffDecoder ../rasterFormats/TiffTags ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(N,D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a,n,m){I=function(f){function k(){var b=g.apply(this,arguments);b._files=null;b._headerInfo=null;b._bufferSize=1048576;b.datasetFormat="TIFF";return b}N._inherits(k,f);var g=N._createSuper(k);f=k.prototype;f.open=async function(b){await this.init();var e=b?y.unwrap(b.signal):null,{data:v}=await this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:e});if(!v)throw new F("tiffraster:open","failed to open url "+this.url);
this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf("."));const {littleEndian:w,firstIFDPos:C,isBigTiff:M}=r.parseSignature(v);var K=[];await this._readIFDs(K,v,w,C,0,M?8:4,e);const {imageInfo:x,rasterInfo:q}=this._parseIFDs(K);e=r.getPyramidIFDs(K);v=r.getMaskIFDs(K);this._headerInfo={littleEndian:w,isBigTiff:M,ifds:K,pyramidIFDs:e,maskIFDs:v,...x};this._set("rasterInfo",q);if(!x.isSupported)throw new F("tiffraster:open","this tiff is not supported: "+x.message);if(!x.tileWidth)throw new F("tiffraster:open",
"none-tiled tiff is not optimized for access, convert to COG and retry.");({skipExtensions:K=[]}=this.ioConfig);K.includes("aux.xml")||(e=await this._fetchAuxiliaryMetaData(b),null!=e&&this._processPAMInfo(e,q));K.includes("vat.dbf")||1!==q.bandCount||"u8"!==q.pixelType||(q.attributeTable=await this._fetchAuxiliaryTable(b),y.isSome(q.attributeTable)&&(q.keyProperties.DataType="thematic"));this.updateTileInfo()};f.fetchRawTile=async function(b,e,v,w={}){if(!this._headerInfo?.isSupported||this.isBlockOutside(b,
e,v))return null;const C=await this._fetchRawTiffTile(b,e,v,!1,w);y.isSome(C)&&this._headerInfo.hasMaskBand&&(b=await this._fetchRawTiffTile(b,e,v,!0,w),y.isSome(b)&&b.pixels[0]instanceof Uint8Array&&(C.mask=b.pixels[0]));return C};f._parseIFDs=function(b){const e=r.getImageInfo(b),{width:v,height:w,tileWidth:C,tileHeight:M,planes:K,pixelType:x,compression:q,firstPyramidLevel:A,maximumPyramidLevel:H,pyramidBlockWidth:Q,pyramidBlockHeight:S,tileBoundary:z,affine:J,metadata:R}=e;let W=h.parseSpatialReference(e.extent.spatialReference?.wkt||
e.extent.spatialReference?.wkid);var Z=!!e.isPseudoGeographic;null==W&&(Z=!0,W=new a({wkid:3857}));const Y=new n({...e.extent,spatialReference:W});var X=Y?new m({x:Y.xmin,y:Y.ymax,spatialReference:W}):new m({x:0,y:0});X=new c({blockWidth:C,blockHeight:M,pyramidBlockWidth:Q,pyramidBlockHeight:S,compression:q,origin:X,firstPyramidLevel:A,maximumPyramidLevel:H,blockBoundary:z});const T=new m({x:(Y.xmax-Y.xmin)/v,y:(Y.ymax-Y.ymin)/w,spatialReference:W}),U=R?{BandProperties:R.bandProperties,DataType:R.dataType}:
{};let aa=null;var ba=b[0].get("PHOTOMETRICINTERPRETATION")?.values?.[0];b=b[0].get("COLORMAP")?.values;if(3>=ba&&3<b?.length&&0===b.length%3){aa=[];ba=b.length/3;for(let fa=0;fa<ba;fa++)aa.push([fa,b[fa]>>>8,b[fa+ba]>>>8,b[fa+2*ba]>>>8])}Z=new p({width:v,height:w,bandCount:K,pixelType:x,pixelSize:T,storageInfo:X,spatialReference:W,isPseudoSpatialReference:Z,keyProperties:U,extent:Y,colormap:aa,statistics:R?R.statistics:null});J?.length&&(Z.nativeExtent=new n({xmin:-.5,ymin:.5-w,xmax:v-.5,ymax:.5,
spatialReference:W}),Z.transform=new G({polynomialOrder:1,forwardCoefficients:[J[2]+J[0]/2,J[5]-J[3]/2,J[0],J[3],-J[1],-J[4]]}),Z.extent=Z.transform.forwardTransform(Z.nativeExtent),Z.pixelSize=new m({x:(Y.xmax-Y.xmin)/v,y:(Y.ymax-Y.ymin)/w,spatialReference:W}),X.origin.x=-.5,X.origin.y=.5);return{imageInfo:e,rasterInfo:Z}};f._processPAMInfo=function(b,e){e.statistics=b.statistics??e.statistics;(e.histograms=b.histograms)&&y.isNone(e.statistics)&&(e.statistics=t.estimateStatisticsFromHistograms(b.histograms));
if(b.transform&&y.isNone(e.transform)){e.transform=b.transform;e.nativeExtent=e.extent;const v=e.transform.forwardTransform(e.nativeExtent);e.pixelSize=new m({x:(v.xmax-v.xmin)/e.width,y:(v.ymax-v.ymin)/e.height,spatialReference:e.spatialReference});e.extent=v}e.isPseudoSpatialReference&&b.spatialReference&&(e.spatialReference=b.spatialReference,e.extent.spatialReference=e.nativeExtent.spatialReference=e.storageInfo.origin.spatialReference=e.spatialReference)};f._readIFDs=async function(b,e,v,w,C,
M=4,K){if(!w)return null;if(w>=e.byteLength||0>w)e=(await this.request(this.url,{range:{from:w+C,to:w+C+this._bufferSize},responseType:"array-buffer",signal:K})).data,C=w+C,w=0;w=await this._readIFD(e,v,w,C,d.TIFF_TAGS,M,K);b.push(w.ifd);if(!w.nextIFD)return null;await this._readIFDs(b,e,v,w.nextIFD-C,C,M,K)};f._readIFD=async function(b,e,v,w,C=d.TIFF_TAGS,M=4,K){if(!b)return null;v=r.parseIFD(b,e,v,w,C,M);if(v.success){const x=[];v.ifd?.forEach(q=>{q.values||x.push(q)});0<x.length&&(M=x.map(q=>q.offlineOffsetSize).filter(y.isSome),
C=Math.min.apply(null,M.map(q=>q[0])),Math.min.apply(null,M.map(q=>q[0]+q[1]))-C<=this._bufferSize&&({data:M}=await this.request(this.url,{range:{from:C,to:C+this._bufferSize},responseType:"array-buffer",signal:K}),b=M,w=C,x.forEach(q=>r.parseFieldValues(b,e,q,w))));v.ifd?.has("GEOKEYDIRECTORY")&&(C=v.ifd.get("GEOKEYDIRECTORY"),(M=C?.values)&&4<M.length&&(M=M[0]+"."+M[1]+"."+M[2],K=await this._readIFD(b,e,C.valueOffset+6-w,w,d.GEO_KEYS,2,K),C.data=K.ifd,C.data&&C.data.set("GEOTIFFVersion",{id:0,type:2,
valueCount:1,valueOffset:null,values:[M]})));return v}if(v.requiredBufferSize&&v.requiredBufferSize!==b.byteLength)return b=(await this.request(this.url,{range:{from:w,to:w+v.requiredBufferSize+4},responseType:"array-buffer",signal:K})).data,b.byteLength<v.requiredBufferSize?null:this._readIFD(b,e,0,w,d.TIFF_TAGS,4,K)};f._fetchRawTiffTile=async function(b,e,v,w,C={}){e=this._getTileLocation(b,e,v,w);if(!e)return null;const {ranges:M,actualTileWidth:K,actualTileHeight:x,ifd:q}=e;e=M.map(S=>this.request(this.url,
{range:S,responseType:"array-buffer",signal:C.signal}));e=await Promise.all(e);v=e.map(S=>S.data.byteLength).reduce((S,z)=>S+z);v=1===e.length?e[0].data:new ArrayBuffer(v);w=[0];var A=[0];if(1<e.length){const S=new Uint8Array(v);for(let z=0,J=0;z<e.length;z++){const R=e[z].data;S.set(new Uint8Array(R),J);w[z]=J;J+=R.byteLength;A[z]=R.byteLength}}const {blockWidth:H,blockHeight:Q}=this.getBlockWidthHeight(b);b=await this.decodePixelBlock(v,{format:"tiff",customOptions:{headerInfo:this._headerInfo,
ifd:q,offsets:w,sizes:A},width:H,height:Q,planes:null,pixelType:null});if(null==b)return null;if(K!==H||x!==Q)if(A=b.mask)for(e=0;e<Q;e++)for(w=e*H,v=e<x?K:0;v<H;v++)A[w+v]=0;else for(A=new Uint8Array(H*Q),b.mask=A,e=0;e<x;e++)for(w=e*H,v=0;v<K;v++)A[w+v]=1;return b};f._getTileLocation=function(b,e,v,w=!1){const {firstPyramidLevel:C,blockBoundary:M}=this.rasterInfo.storageInfo;var K=0===b?0:b-(C-1);({_headerInfo:b}=this);if(!b)return null;w=w?b.maskIFDs[K]:0===K?b?.ifds[0]:b?.pyramidIFDs[K-1];if(!w)return null;
var x=r.isBSQConfig(w,b);b=w.get("TILEOFFSETS")?.values;if(void 0===b)return null;var q=w.get("TILEBYTECOUNTS")?.values;const {minRow:A,minCol:H,maxRow:Q,maxCol:S}=M[K];if(e>Q||v>S||e<A||v<H)return null;K=w.get("IMAGEWIDTH")?.values?.[0];const z=w.get("IMAGELENGTH")?.values?.[0],J=w.get("TILEWIDTH")?.values?.[0],R=w.get("TILELENGTH")?.values?.[0],W=x?this.rasterInfo.bandCount:1,Z=W*e*(S+1)+v,Y=[{from:b[Z],to:b[Z+W-1]+q[Z+W-1]-1}];if(x){x=!0;for(let X=0;X<W;X++)if(b[Z+X]+q[Z+X]!==b[Z+X+1]){x=!1;break}if(!x)for(x=
0;x<W;x++)Y[x]={from:b[Z+x],to:b[Z+x]+q[Z+x]-1}}q=q[Z];return null==b[Z]||null==q?null:{ranges:Y,ifd:w,actualTileWidth:v===S?K%J||J:J,actualTileHeight:e===Q?z%R||R:R}};f._fetchAuxiliaryMetaData=async function(b){try{const {data:e}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:b?.signal});return h.parsePAMInfo(e)}catch{return null}};f._fetchAuxiliaryTable=async function(b){try{const {data:e}=await this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:b?.signal}),
v=u.parse(e);return v?.recordSet?E.fromJSON(v.recordSet):null}catch{return null}};return N._createClass(k)}(l);D.__decorate([O.property()],I.prototype,"_files",void 0);D.__decorate([O.property()],I.prototype,"_headerInfo",void 0);D.__decorate([O.property()],I.prototype,"_bufferSize",void 0);D.__decorate([O.property({type:String,json:{write:!0}})],I.prototype,"datasetFormat",void 0);return I=D.__decorate([B.subclass("esri.layers.support.rasterDatasets.TIFFRaster")],I)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../PopupTemplate ../rasterRenderers ../core/Error ../core/Logger ../core/maybe ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/arrayUtils ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ./Layer ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/ImageryTileMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/Field ./support/rasterEnums ./support/RasterFunction ./support/rasterDatasets/FunctionRaster ./support/rasterDatasets/RasterFactory ./support/rasterFunctions/rasterFunctionHelper ../support/popupUtils".split(" "),function(N,
D,I,F,y,O,V,L,P,B,p,c,l,u,h,r,d,t,G,E,a,n,m,f,k,g,b,e,v,w,C,M,K,x,q){L=function(A){function H(...S){S=Q.call(this,...S);S._primaryRasters=null;S.bandIds=null;S.interpolation=null;S.legendEnabled=!0;S.isReference=null;S.listMode="show";S.sourceJSON=null;S.version=null;S.type="imagery-tile";S.operationalLayerType="ArcGISTiledImageServiceLayer";S.popupEnabled=!0;S.popupTemplate=null;S.fields=null;return S}N._inherits(H,A);var Q=N._createSuper(H);A=H.prototype;A.normalizeCtorArgs=function(S,z){return"string"===
typeof S?{url:S,...z}:S};A.load=function(S){const z=V.isSome(S)?S.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},S).catch(P.throwIfAbortError).then(()=>this._openRaster(z)));return Promise.resolve(this)};A.readRenderer=function(S,z,J){S=F.read(z&&z.layerDefinition&&z.layerDefinition.drawingInfo&&z.layerDefinition.drawingInfo.renderer,J)||void 0;if(null!=S)return S};A.createPopupTemplate=function(S){return q.createPopupTemplate({fields:this.rasterFields,
title:this.title},S)};A.generateRasterInfo=async function(S,z){S=c.ensureClass(C,S);if(!S)return this._primaryRasters[0].rasterInfo;try{const J={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(Z=>J[Z.url]=Z);const R=x.create(S.toJSON(),J),W=new M({rasterFunction:R});await W.open(z);return W.rasterInfo}catch{return null}};A.write=function(S,z){const {raster:J}=this;if(this.loaded?"RasterTileServer"===J.datasetFormat&&("Raster"===J.tileType||"Map"===J.tileType):
this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return N._get(N._getPrototypeOf(H.prototype),"write",this).call(this,S,z);z&&z.messages&&z.messages.push(new y("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${`${z.origin}/${z.layerContainerType||"operational-layers"}`}'`,{layer:this}));return null};A._openRaster=async function(S){let z=!1;if(this.raster)this.raster.rasterInfo||await this.raster.open(),"Function"===this.raster.datasetFormat?
(z=!0,this._primaryRasters=this.raster.primaryRasters.rasters):this._primaryRasters=[this.raster],this.url=this.raster.url;else{var {rasterFunction:J}=this;const W=[this.url];J&&x.getPrimaryRasterUrls(J.toJSON(),W);var R=await Promise.all(W.map(Y=>K.open({url:Y,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:S})));const Z=R.findIndex(Y=>null==Y);if(-1<Z)throw new y("imagery-tile-layer:open",`cannot open raster: ${W[Z]}`);
this._primaryRasters=R;if(J){const Y={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(X=>Y[X.url]=X);J=x.create(J.rasterFunctionDefinition??J.toJSON(),Y);J=new M({rasterFunction:J});try{await J.open(),this.raster=J}catch(X){J=O.getLogger(this.declaredClass),X instanceof y&&J.error("imagery-tile-layer:open",X.message),J.warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),this._set("rasterFunction",null),this.raster=R[0]}}else this.raster=
R[0]}R=this.raster.rasterInfo;if(!R)throw new y("imagery-tile-layer:load","cannot load resources on "+this.url);this._set("rasterInfo",z?R:this._primaryRasters[0].rasterInfo);this._set("spatialReference",R.spatialReference);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON;null!=this.sourceJSON&&this.read("Map"===this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0},{origin:"service"});this.title||(this.title=
this.raster.datasetName);"Map"===this.raster.tileType&&(this.popupEnabled=!1);this._configDefaultSettings();this.addHandles(B.watch(()=>this.customParameters,W=>{this.raster&&(this.raster.ioConfig.customFetchParameters=W)}))};N._createClass(H,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"rasterFields",get:function(){let S=[new v({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"})];var {rasterInfo:z}=this,J=
z?.attributeTable;if(J=V.isSome(J)?J.fields:null)J=J.filter(R=>"oid"!==R.type&&"value"!==R.name.toLowerCase()).map(R=>{const W=R.clone();W.name="Raster."+R.name;return W}),S=S.concat(J);J=z?.dataType;z=z?.multidimensionalInfo;"vector-magdir"!==J&&"vector-uv"!==J||!V.isSome(z)||(z=z.variables[0].unit?.trim(),S.push(new v({name:"Raster.Magnitude",alias:"Magnitude"+(z?` (${z})`:""),domain:null,editable:!1,type:"double"})),S.push(new v({name:"Raster.Direction",alias:"Direction (\u00b0)",domain:null,editable:!1,
type:"double"})));return S}},{key:"renderer",set:function(S){this._set("renderer",S);this.updateRenderer()}}]);return H}(E.BlendLayer(g.ScaleRangeLayer(m.OperationalLayer(f.PortalLayer(a.CustomParametersMixin(n.ImageryTileMixin(b.TemporalLayer(G.ArcGISService(k.RefreshableLayer(L.MultiOriginJSONMixin(t)))))))))));D.__decorate([p.property()],L.prototype,"_primaryRasters",void 0);D.__decorate([p.property({type:[c.Integer],json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||
"0,1,2"!==this.bandIds?.join(",")}}}}})],L.prototype,"bandIds",void 0);D.__decorate([p.property({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),h.enumeration(w.interpolationKebab)],L.prototype,"interpolation",void 0);D.__decorate([p.property(e.legendEnabled)],L.prototype,"legendEnabled",void 0);D.__decorate([p.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],L.prototype,
"isReference",void 0);D.__decorate([p.property({type:["show","hide"]})],L.prototype,"listMode",void 0);D.__decorate([p.property({json:{read:!0,write:!0}})],L.prototype,"blendMode",void 0);D.__decorate([p.property()],L.prototype,"sourceJSON",void 0);D.__decorate([p.property({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],L.prototype,"version",void 0);D.__decorate([p.property({readOnly:!0,json:{read:!1}})],L.prototype,"type",void 0);D.__decorate([p.property({type:["ArcGISTiledImageServiceLayer"]})],
L.prototype,"operationalLayerType",void 0);D.__decorate([p.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(A,H){return!H.disablePopup}},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},writer(A,H,Q){H[Q]=!A}}}})],L.prototype,"popupEnabled",void 0);D.__decorate([p.property({type:I,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],
L.prototype,"popupTemplate",void 0);D.__decorate([p.property({readOnly:!0})],L.prototype,"defaultPopupTemplate",null);D.__decorate([p.property({readOnly:!0,type:[v]})],L.prototype,"fields",void 0);D.__decorate([p.property({readOnly:!0,type:[v]})],L.prototype,"rasterFields",null);D.__decorate([p.property({types:F.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){const A="raster-stretch"===this.renderer?.type&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;
return{enabled:!this.loaded||"Raster"===this.raster.tileType||!A}}},origins:{"web-scene":{types:F.websceneRasterRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(A){return{enabled:A&&"vector-field"!==A.type&&"flow"!==A.type}}}}}}})],L.prototype,"renderer",null);D.__decorate([r.reader("renderer")],L.prototype,"readRenderer",null);return L=D.__decorate([d.subclass("esri.layers.ImageryTileLayer")],L)});