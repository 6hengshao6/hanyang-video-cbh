// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("exports ./clock ./deprecate ./Error ./events ./Logger ./maybe".split(" "),function(g,G,H,v,C,D,k){function m(a="Aborted"){return new v("AbortError",a)}function w(a,b="Aborted"){if(E(a))throw m(b);}function r(a){return k.isSome(a)?"aborted"in a?a:a.signal:a}function E(a){a=r(a);return k.isSome(a)&&a.aborted}function t(a,b){a=r(a);if(!k.isNone(a))if(a.aborted)b();else return C.once(a,"abort",()=>b())}function q(a){return"AbortError"===a?.name}function x(){let a=null;const b=new Promise((c,e)=>
{a={promise:void 0,resolve:c,reject:e}});a.promise=b;return a}async function y(a){if(a){if("function"!==typeof a.forEach){const b=Object.keys(a),c=b.map(d=>a[d]),e=await y(c),f={};b.map((d,h)=>f[d]=e[h]);return f}return new Promise(b=>{const c=[];let e=a.length;0===e&&b(c);a.forEach(f=>{const d={promise:f||Promise.resolve(f)};c.push(d);d.promise.then(h=>{d.value=h}).catch(h=>{d.error=h}).then(()=>{--e;0===e&&b(c)})})})}}function z(a,b,c){const e=new AbortController;t(c,()=>e.abort());return new Promise((f,
d)=>{let h=setTimeout(()=>{h=0;f(b)},a);t(e,()=>{h&&(clearTimeout(h),d(m()))})})}function F(a){return a&&"function"===typeof a.then}function A(a){return F(a)?a:Promise.resolve(a)}g.after=z;g.always=function(a,b){return a.then(b,b)};g.create=function(a){H.deprecatedFunction(D.getLogger("esri.core.promiseUtils"),"create",{moduleName:"esri.core.promiseUtils",replacement:"new Promise()",version:"4.24"});return new Promise((b,c)=>{try{a(b,c)}catch(e){Promise.resolve().then(()=>c(e))}})};g.createAbortError=
m;g.createDeferred=x;g.createResolver=function(){let a,b;const c=new Promise((f,d)=>{a=f;b=d}),e=f=>{a(f)};e.resolve=f=>a(f);e.reject=f=>b(f);e.timeout=(f,d)=>G.clock.setTimeout(()=>e.reject(d),f);e.promise=c;return e};g.debounce=function(a,b=-1){let c,e,f,d,h=null;const p=(...l)=>{if(c){e=l;d&&d.reject(m());d=x();l=k.assumeNonNull(d.promise);if(h){var u=h;h=null;u.abort()}return l}f=d||x();d=null;if(0<b){const n=new AbortController,I=c=A(a(...l,n.signal));z(b).then(()=>{c===I&&(d?n.abort():h=n)})}else c=
1,c=A(a(...l));l=()=>{const n=e;e=f=c=h=null;null!=n&&p(...n)};u=c;const B=f;u.then(l,l);u.then(B.resolve,B.reject);return k.assumeNonNull(B.promise)};return p};g.eachAlways=y;g.eachAlwaysValues=async function(a){return(await y(a)).filter(b=>!!b.value).map(b=>b.value)};g.filter=async function(a,b){const c=a.slice(),e=await Promise.all(a.map((f,d)=>b(f,d)));return c.filter((f,d)=>e[d])};g.ignoreAbortErrors=async function(a){try{return await a}catch(b){if(!q(b))throw b;}};g.isAbortError=q;g.isAborted=
E;g.isPromiseLike=F;g.logOnError=async function(a,b=D.getLogger("esri")){try{return await a}catch(c){q(c)||b.error(c)}};g.onAbort=t;g.onAbortOrThrow=function(a,b){a=r(a);if(!k.isNone(a))return w(a),C.once(a,"abort",()=>b(m()))};g.throwIfAbortError=function(a){if(q(a))throw a;};g.throwIfAborted=w;g.throwIfNotAbortError=function(a){if(!q(a))throw a;};g.timeout=function(a,b,c,e){const f=c&&"abort"in c?c:null;null!=e||f||(e=c);let d=setTimeout(()=>{d=0;f&&f.abort()},b);const h=()=>e||new v("promiseUtils:timeout",
"The wrapped promise did not resolve within "+b+" ms");return a.then(p=>{if(0===d)throw h();clearTimeout(d);return p},p=>{clearTimeout(d);throw 0===d?h():p;})};g.waitTick=async function(a){await Promise.resolve();w(a)};g.when=A;g.whenOrAbort=function(a,b){const c=r(b);return k.isNone(c)?a:new Promise((e,f)=>{let d=t(b,()=>f(m()));const h=()=>d=k.removeMaybe(d);a.then(h,h);a.then(e,f)})};g.whenOrTimeout=function(a,b,c){return Promise.race([a,z(b).then(()=>{throw new v("timeout",`Did not resolve within ${b} milliseconds (${c??
"timeout"})`);})])};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});