// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["exports","../TimeExtent","../core/maybe","../core/promiseUtils","../core/timeUtils"],function(k,g,f,n,l){function p(a){return void 0!==a.timeInfo}k.getTimeExtentFromLayers=async function(a,c){if(0===a.length)return g.allTime;const d=a.filter(p);await Promise.all(d.map(b=>b.load({signal:c})));a=[];var h=[];for(var e of d)"feature"!==e?.type&&"map-image"!==e?.type||!e.timeInfo?.hasLiveData?h.push(e):a.push(e);e=b=>f.isNone(b)||b.isAllTime;h=h.map(b=>b.timeInfo?.fullTimeExtent);if(h.some(e))return g.allTime;
a=a.map(async b=>{const {timeExtent:m}=await b.fetchRecomputedExtents({signal:c});return m?m:f.unwrap(b.timeInfo?.fullTimeExtent)});a=(await n.eachAlways(a)).map(b=>b.value);return a.some(e)?g.allTime:[...a,...h].filter(f.isSome).reduce((b,m)=>b.union(m))};k.toLocalTimeExtent=function(a){if(!a)return a;const {start:c,end:d}=a;return new g({start:f.isSome(c)?l.offsetDate(c,c.getTimezoneOffset(),"minutes"):c,end:f.isSome(d)?l.offsetDate(d,d.getTimezoneOffset(),"minutes"):d})};k.toUTCTimeExtent=function(a){if(!a)return a;
const {start:c,end:d}=a;return new g({start:f.isSome(c)?l.offsetDate(c,-c.getTimezoneOffset(),"minutes"):c,end:f.isSome(d)?l.offsetDate(d,-d.getTimezoneOffset(),"minutes"):d})};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});