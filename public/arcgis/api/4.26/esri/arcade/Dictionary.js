// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ./ArcadeDate ./executionError ./ImmutableArray ../chunks/languageUtils ../geometry/Geometry".split(" "),function(r,n,l,t,f,p){function m(e,g,b=!1){if(null===e||void 0===e)return null;if(f.isNumber(e))return f.toNumber(e);if(f.isBoolean(e))return f.toBoolean(e);if(f.isString(e))return f.toString(e);if(f.isDate(e))return f.toDate(e,g);if(f.isArray(e)){var a=[];for(var d of e)a.push(m(d,g,b));return a}d=new q;d.immutable=!1;for(a of Object.keys(e)){const c=
e[a];void 0!==c&&d.setField(a,m(c,g,b))}d.immutable=b;return d}let q=function(){function e(b){this.declaredClass="esri.arcade.Dictionary";this.attributes=null;this.plain=!1;this.immutable=!0;this.attributes=b instanceof e?b.attributes:void 0===b?{}:null===b?{}:b}var g=e.prototype;g.field=function(b){const a=b.toLowerCase(),d=this.attributes[b];if(void 0!==d)return d;for(const c in this.attributes)if(c.toLowerCase()===a)return this.attributes[c];throw new l.ArcadeExecutionError(null,l.ExecutionErrorCodes.FieldNotFound,
null,{key:b});};g.setField=function(b,a){if(this.immutable)throw new l.ArcadeExecutionError(null,l.ExecutionErrorCodes.Immutable,null);if(f.isFunctionParameter(a))throw new l.ArcadeExecutionError(null,l.ExecutionErrorCodes.NoFunctionInDictionary,null);const d=b.toLowerCase();a instanceof Date&&(a=n.ArcadeDate.dateJSToArcadeDate(a));if(void 0===this.attributes[b])for(const c in this.attributes)if(c.toLowerCase()===d){this.attributes[c]=a;return}this.attributes[b]=a};g.hasField=function(b){const a=
b.toLowerCase();if(void 0!==this.attributes[b])return!0;for(const d in this.attributes)if(d.toLowerCase()===a)return!0;return!1};g.keys=function(){let b=[];for(const a in this.attributes)b.push(a);return b=b.sort()};g.castToText=function(b=!1){let a="";for(const d in this.attributes){""!==a&&(a+=",");const c=this.attributes[d];null==c?a+=JSON.stringify(d)+":null":f.isBoolean(c)||f.isNumber(c)||f.isString(c)?a+=JSON.stringify(d)+":"+JSON.stringify(c):c instanceof p?a+=JSON.stringify(d)+":"+f.toStringExplicit(c):
c instanceof t?a+=JSON.stringify(d)+":"+f.toStringExplicit(c,null,b):c instanceof Array?a+=JSON.stringify(d)+":"+f.toStringExplicit(c,null,b):c instanceof n.ArcadeDate?a=b?a+(JSON.stringify(d)+":"+JSON.stringify(c.getTime())):a+(JSON.stringify(d)+":"+c.stringify()):null!==c&&"object"===typeof c&&void 0!==c.castToText&&(a+=JSON.stringify(d)+":"+c.castToText(b))}return"{"+a+"}"};e.convertObjectToArcadeDictionary=function(b,a,d=!0){const c=new e;c.immutable=!1;for(const h in b){const k=b[h];void 0!==
k&&c.setField(h.toString(),m(k,a))}c.immutable=d;return c};e.convertJsonToArcade=function(b,a,d=!1){return m(b,a,d)};g.castAsJson=function(b=null){const a={};for(let d in this.attributes){const c=this.attributes[d];void 0!==c&&(b?.keyTranslate&&(d=b.keyTranslate(d)),a[d]=f.castAsJson(c,b))}return a};g.castDictionaryValueAsJsonAsync=async function(b,a,d,c=null,h){d=await f.castAsJsonAsync(d,c,h);return b[a]=d};g.castAsJsonAsync=async function(b=null,a=null){const d={},c=[];for(let h in this.attributes){const k=
this.attributes[h];a?.keyTranslate&&(h=a.keyTranslate(h));void 0!==k&&(f.isSimpleType(k)||k instanceof p||k instanceof n.ArcadeDate?d[h]=f.castAsJson(k,a):c.push(this.castDictionaryValueAsJsonAsync(d,h,k,b,a)))}0<c.length&&await Promise.all(c);return d};return r._createClass(e)}();return q});