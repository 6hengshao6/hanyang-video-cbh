// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
require({cache:{"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/screenUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),function(n,q,H,k,u,K,P,Q,L,C,D,G,
r){function t(m,l){m=k.isSome(m)?m:"";k.isSome(l)&&l&&(m=m?"("+m+") AND ("+l+")":l);return m}function B(m){const l=m.layer;return m.fields.filter(p=>!l.getField(p))}function A(m){const l=m.layer;return m.fields.filter(p=>{p=l.getFieldUsageInfo(p);return!p||!p.supportsStatistics})}let E=null;n.calculateHeatmapStats=function(m,l=18,p,w,F,d){const g=new Float64Array(F*d);l=Math.round(u.pt2px(l));let f=Number.POSITIVE_INFINITY,z=Number.NEGATIVE_INFINITY;var b=0;let a=0,c=0,v=0;p=C.createValueFunction(w,
p);for(const {geometry:I,attributes:M}of m){const {x:N,y:O}=I;m=Math.max(0,N-l);b=Math.max(0,O-l);w=Math.min(d,O+l);const R=Math.min(F,N+l),T=+p(M);for(let V=b;V<w;V++)for(let U=m;U<R;U++){b=V*F+U;const W=C.evaluateDensityKernel(U-N,V-O,l);var x=g[b];b=g[b]+=W*T;x=b-x;a+=x;c+=x*x;b<f&&(f=b);b>z&&(z=b);v++}}return v?{mean:a/v,stdDev:Math.sqrt((c-a*a/v)/v),min:f,max:z,mid:(z-f)/2,count:v}:{mean:0,stddev:0,min:0,max:0,mid:0,count:0}};n.getDataValues=async function(m,l){if(!l)return[];const {field:p,
field2:w,field3:F,fieldDelimiter:d}=m,g=m.valueExpression,f=m.normalizationType,z=m.normalizationField,b=m.normalizationTotal,a=[],c=m.viewInfoParams;let v=null,x=null;if(g){if(!E){const {arcadeUtils:M}=await G.loadArcade();E=M}v=E.createFunction(g);x=c&&E.getViewInfo({viewingMode:c.viewingMode,scale:c.scale,spatialReference:new K(c.spatialReference)})}m=m.fieldInfos;const I=l[0]&&"declaredClass"in l[0]&&"esri.Graphic"===l[0].declaredClass||!m?null:{fields:m};l.forEach(M=>{var N=M.attributes;if(g){var O=
E.createExecContext(I?{...M,layer:I}:M,x);O=E.executeFunction(v,O)}else N&&(O=N[p],w&&(O=`${D.processNullValue(O)}${d}${D.processNullValue(N[w])}`,F&&(O=`${O}${d}${D.processNullValue(N[F])}`)));f&&"number"===typeof O&&isFinite(O)&&(N=N&&parseFloat(N[z]),O=D.getNormalizedValue(O,f,N,b));a.push(O)});return a};n.getRangeExpr=function(m,l,p){l=null!=l?m+" \x3e\x3d "+l:"";m=null!=p?m+" \x3c\x3d "+p:"";p="";return(p=l&&m?t(l,m):l||m)?"("+p+")":""};n.getSQLFilterForNormalization=function(m){const l=m.field,
p=m.normalizationType;m=m.normalizationField;let w;if("field"===p)w="(NOT "+m+" \x3d 0)";else if("log"===p||"natural-log"===p||"square-root"===p)w=`(${l} > 0)`;return w};n.getSumOfAttributesExpr=function(m,l,p){const w=[],F=[],d=[],g=[],f=[];m.forEach((a,c)=>{const v=a.field?"field":"expression",x=a.field||a.valueExpression;a.field?(f.push(x),F.push(`var ${v}${c} = Number($feature["${x}"]);`)):(w.push(`function getValueForExpr${c}() {\n  ${x} \n}`),F.push(`var ${v}${c} = Number(getValueForExpr${c}());`));
p||d.push(`${v}${c} = IIf(${v}${c} < 0, 0, ${v}${c});`);g.push(`${v}${c}`)});m="return sum;";const z=w.length?null:f.reduce((a,c)=>`${a} + ${c}`);let b=null;l||p?l?p||(m="return IIf(sum \x3e\x3d 0, sum, null);",z&&(b=`(( ${z} ) >= 0)`)):(m="return IIf(sum !\x3d 0, sum, null);",z&&(b=`(( ${z} ) <> 0)`)):(m="return IIf(sum \x3e 0, sum, null);",z&&(b=`(( ${z} ) > 0)`));return{valueExpression:[w.length?w.join("\n"):"",F.join("\n"),d.join("\n"),`var sum = ${g.join(" + ")};`,m].filter(Boolean).join("\n\n"),
sqlExpression:z,sqlWhere:b}};n.mergeWhereClauses=t;n.quantizeFeatures=function(m,l,p,w){const F=Q.isWrappable(p)?Q.getInfo(p):null,d=F?Math.round((F.valid[1]-F.valid[0])/l.scale[0]):null;return m.map(g=>{const f=new r(k.unwrap(g.geometry));P.quantizePoint(l,f,f,f.hasZ,f.hasM);if(F){var z=d??0,b=w[0];0>f.x?f.x+=z:f.x>b&&(f.x-=z)}g.geometry=f;return g})};n.verifyBasicFieldValidity=function(m,l,p){const w=B({layer:m,fields:l});if(w.length)return new H(p,"Unknown fields: "+w.join(", ")+". You can only use fields defined in the layer schema");
m=A({layer:m,fields:l});if(m.length)return new H(p,"Unsupported fields: "+m.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};n.verifyFieldType=function(m,l,p,w){let F;l?l.name!==m.objectIdField&&w.includes(l.type)||(F=new H(p,"'field' should be one of these types: "+w.join(","))):F=new H(p,"'field' is not defined in the layer schema");return F};n.verifyFilterValidty=function(m,l){if(m&&"intersects"!==m.spatialRelationship)return new H(l,
"Only 'intersects' spatialRelationship is supported for featureFilter")};n.verifyNumericField=function(m,l,p){let w;l?l.name!==m.objectIdField&&L.isNumericField(l)||(w=new H(p,"'field' should be one of these numeric types: "+L.numericTypes.join(","))):w=new H(p,"'field' is not defined in the layer schema");return w};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(n){function q(k){return k?72*k/96:0}const H=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;
n.castRenderScreenPointArray=function(k){return k};n.castRenderScreenPointArray3=function(k){return k};n.castScreenPointArray=function(k){return k};n.createRenderScreenPoint=function(k=0,u=0){return{x:k,y:u}};n.createRenderScreenPointArray=function(k=0,u=0){return[k,u]};n.createRenderScreenPointArray3=function(k=0,u=0,K=0){return[k,u,K]};n.createScreenPoint=function(k=0,u=0){return{x:k,y:u}};n.createScreenPointArray=function(k=0,u=0){return[k,u]};n.pt2px=function(k){return k?k/72*96:0};n.px2pt=q;
n.screenPointArrayToObject=function(k,u){return u?(u.x=k[0],u.y=k[1],u):{x:k[0],y:k[1]}};n.screenPointObjectToArray=function(k,u){return u?(u[0]=k.x,u[1]=k.y,2<u.length&&(u[2]=0),u):[k.x,k.y]};n.toPt=function(k){if("string"===typeof k){var u=k.match(H);if(u){var K=Number(u[1]);u=u[3]&&u[3].toLowerCase();k="-"===k.charAt(0);K="px"===u?q(K):K;return k?-K:K}console.warn("screenUtils.toPt: input not recognized!");return null}return k};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports",
"../../core/maybe","./jsonUtils"],function(n,q,H){function k({scale:b,translate:a},c){return Math.round((c-a[0])/b[0])}function u({scale:b,translate:a},c){return Math.round((a[1]-c)/b[1])}function K(b,a,c){const v=[];let x,I,M,N;for(let O=0;O<c.length;O++){const R=c[O];if(0<O){if(M=k(b,R[0]),N=u(b,R[1]),M!==x||N!==I)v.push(a(R,M-x,N-I)),x=M,I=N}else x=k(b,R[0]),I=u(b,R[1]),v.push(a(R,x,I))}return 0<v.length?v:null}function P(b,a,c,v){return K(b,c?v?z:f:v?f:g,a)}function Q(b,a,c,v){const x=[];c=c?
v?z:f:v?f:g;for(v=0;v<a.length;v++){const I=K(b,c,a[v]);I&&3<=I.length&&x.push(I)}return x.length?x:null}function L(b,a,c,v){const x=[];c=c?v?z:f:v?f:g;for(v=0;v<a.length;v++){const I=K(b,c,a[v]);I&&2<=I.length&&x.push(I)}return x.length?x:null}function C({scale:b,translate:a},c){return c*b[0]+a[0]}function D({scale:b,translate:a},c){return a[1]-c*b[1]}function G(b,a,c){const v=Array(c.length);if(!c.length)return v;const [x,I]=b.scale;let M=C(b,c[0][0]);b=D(b,c[0][1]);v[0]=a(c[0],M,b);for(let N=1;N<
c.length;N++){const O=c[N];M+=O[0]*x;b-=O[1]*I;v[N]=a(O,M,b)}return v}function r(b,a,c){const v=Array(c.length);for(let x=0;x<c.length;x++)v[x]=G(b,a,c[x]);return v}function t(b,a,c,v){return G(b,c?v?z:f:v?f:g,a)}function B(b,a,c,v){return r(b,c?v?z:f:v?f:g,a)}function A(b,a,c,v){return r(b,c?v?z:f:v?f:g,a)}function E(b,a,c){let [v,x]=c[0],I=Math.min(v,a[0]),M=Math.min(x,a[1]),N=Math.max(v,a[2]);a=Math.max(x,a[3]);for(let O=1;O<c.length;O++){const [R,T]=c[O];v+=R;x+=T;0>R&&(I=Math.min(I,v));0<R&&
(N=Math.max(N,v));0>T?M=Math.min(M,x):0<T&&(a=Math.max(a,x))}b[0]=I;b[1]=M;b[2]=N;b[3]=a;return b}function m(b,a){if(!a.length)return null;b[0]=b[1]=Number.POSITIVE_INFINITY;b[2]=b[3]=Number.NEGATIVE_INFINITY;for(let c=0;c<a.length;c++)E(b,b,a[c]);return b}function l(b,a,c,v,x){a.xmin=k(b,c.xmin);a.ymin=u(b,c.ymin);a.xmax=k(b,c.xmax);a.ymax=u(b,c.ymax);a!==c&&(v&&(a.zmin=c.zmin,a.zmax=c.zmax),x&&(a.mmin=c.mmin,a.mmax=c.mmax));return a}function p(b,a,c,v,x){a.points=P(b,c.points,v,x)??[];return a}
function w(b,a,c,v,x){a.x=k(b,c.x);a.y=u(b,c.y);a!==c&&(v&&(a.z=c.z),x&&(a.m=c.m));return a}function F(b,a,c,v,x){b=Q(b,c.rings,v,x);if(!b)return null;a.rings=b;return a}function d(b,a,c,v,x){b=L(b,c.paths,v,x);if(!b)return null;a.paths=b;return a}const g=(b,a,c)=>[a,c],f=(b,a,c)=>[a,c,b[2]],z=(b,a,c)=>[a,c,b[2],b[3]];n.equals=function(b,a){if(b===a||null==b&&null==a)return!0;if(null==b||null==a)return!1;let c,v,x,I;b&&"upperLeft"===b.originPosition?(c=b.translate[0],v=b.translate[1],b=b.scale[0]):
(c=q.isSome(b.extent)?b.extent.xmin:0,v=q.isSome(b.extent)?b.extent.ymax:0,b=b.tolerance);a&&"upperLeft"===a.originPosition?(x=a.translate[0],I=a.translate[1],a=a.scale[0]):(x=q.isSome(a.extent)?a.extent.xmin:0,I=q.isSome(a.extent)?a.extent.ymax:0,a=a.tolerance);return c===x&&v===I&&b===a};n.getQuantizedBoundsCoordsArray=E;n.getQuantizedBoundsCoordsArrayArray=m;n.getQuantizedBoundsPaths=function(b){return m([0,0,0,0],b)};n.getQuantizedBoundsPoints=function(b){const a=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return E(a,a,b)};n.getQuantizedBoundsRings=function(b){return m([0,0,0,0],b)};n.quantizeBounds=function(b,a,c){a[0]=k(b,c[0]);a[3]=u(b,c[1]);a[2]=k(b,c[2]);a[1]=u(b,c[3]);return a};n.quantizeExtent=l;n.quantizeGeometry=function(b,a){return b&&a?H.isPoint(a)?w(b,{},a,!1,!1):H.isPolyline(a)?d(b,{},a,!1,!1):H.isPolygon(a)?F(b,{},a,!1,!1):H.isMultipoint(a)?p(b,{},a,!1,!1):H.isExtent(a)?l(b,{},a,!1,!1):null:null};n.quantizeMultipoint=p;n.quantizePaths=
L;n.quantizePoint=w;n.quantizePoints=P;n.quantizePolygon=F;n.quantizePolyline=d;n.quantizeRings=Q;n.quantizeX=k;n.quantizeY=u;n.toQuantizationTransform=function(b){return b?{originPosition:"upper-left"===b.originPosition?"upperLeft":"lower-left"===b.originPosition?"lowerLeft":b.originPosition,scale:b.tolerance?[b.tolerance,b.tolerance]:[1,1],translate:q.isSome(b.extent)?[b.extent.xmin,b.extent.ymax]:[0,0]}:null};n.unquantizeBounds=function(b,a,c){return c?(a[0]=C(b,c[0]),a[1]=D(b,c[3]),a[2]=C(b,c[2]),
a[3]=D(b,c[1]),a):[C(b,a[0]),D(b,a[3]),C(b,a[2]),D(b,a[1])]};n.unquantizeCoordsArray=G;n.unquantizeCoordsArrayArray=r;n.unquantizeExtent=function(b,a,c,v,x){a.xmin=C(b,c.xmin);a.ymin=D(b,c.ymin);a.xmax=C(b,c.xmax);a.ymax=D(b,c.ymax);a!==c&&(v&&(a.zmin=c.zmin,a.zmax=c.zmax),x&&(a.mmin=c.mmin,a.mmax=c.mmax));return a};n.unquantizeMultipoint=function(b,a,c,v,x){q.isSome(c)&&(a.points=t(b,c.points,v,x));return a};n.unquantizePaths=B;n.unquantizePoint=function(b,a,c,v,x){if(q.isNone(c))return a;a.x=C(b,
c.x);a.y=D(b,c.y);a!==c&&(v&&(a.z=c.z),x&&(a.m=c.m));return a};n.unquantizePoints=t;n.unquantizePolygon=function(b,a,c,v,x){q.isSome(c)&&(a.rings=A(b,c.rings,v,x));return a};n.unquantizePolyline=function(b,a,c,v,x){q.isSome(c)&&(a.paths=B(b,c.paths,v,x));return a};n.unquantizeRings=A;n.unquantizeX=C;n.unquantizeY=D;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldUtils":function(){define("require exports ../../core/Error ../../core/maybe ../../core/object ./domainUtils ../../support/arcadeOnDemand".split(" "),
function(n,q,H,k,u,K,P){function Q(e,h,y){if(e)for(const J of e)(e=(e=u.getDeepValue(J,h))&&"function"!==typeof e&&y.get(e))&&u.setDeepValue(J,e.name,h)}function L(e,h){if(!e||!h)return[];U.clear();C(U,e,h);return Array.from(U).sort()}function C(e,h,y){if(y)if(h?.fields?.length)if(y.includes("*"))for(const {name:J}of h.fields)e.add(J);else for(const J of y)D(e,h,J);else if(y.includes("*"))e.clear(),e.add("*");else for(const J of y)null!=J&&e.add(J)}function D(e,h,y){"string"===typeof y&&(h?(h=h.get(y))&&
e.add(h.name):e.add(y))}async function G(e,h,y){if(y){var {arcadeUtils:J}=await P.loadArcade();y=J.extractFieldNames(y,h?.fields?.map(S=>S.name));for(const S of y)D(e,h,S)}}async function r(e,h,y){if(y&&"1\x3d1"!==y){const J=(await new Promise((S,ca)=>n(["../../core/sql/WhereClause"],S,ca))).WhereClause.create(y,h);if(!J.isStandardized)throw new H("fieldUtils:collectFilterFields","Where clause is not standardized",{where:y});C(e,h,J.fieldNames)}}function t(e,h){for(const y of e)if(y&&y.valueType&&
y.valueType===h)return y.name;return null}async function B(e,h){if(h){var y=h.elevationInfo?.featureExpressionInfo;if(y)return y.collectRequiredFields(e,h.fieldsIndex)}}async function A(e,h,y){const J=[];y?.expressionInfos&&J.push(...y.expressionInfos.map(S=>G(e,h.fieldsIndex,S.expression)));y=y?.content;if(Array.isArray(y))for(const S of y)"expression"===S.type&&S.expressionInfo&&J.push(G(e,h.fieldsIndex,S.expressionInfo.expression));await Promise.all(J)}async function E(e,h,y){h&&y&&(y.valueExpression?
await G(e,h.fieldsIndex,y.valueExpression):y.field&&D(e,h.fieldsIndex,y.field))}async function m(e,h){const {labelingInfo:y,fieldsIndex:J}=h;y&&y.length&&await Promise.all(y.map(S=>l(e,J,S)))}async function l(e,h,y){if(y){var J=y.getLabelExpression();y=y.where;"arcade"===J.type?await G(e,h,J.expression):(J=J.expression.match(/{[^}]*}/g))&&J.forEach(S=>{D(e,h,S.slice(1,-1))});await r(e,h,y)}}function p(e){return"number"===typeof e&&!isNaN(e)&&isFinite(e)}function w(e){return null===e||p(e)}function F(e){return null===
e||W(e)}function d(e){return null!=e&&"string"===typeof e}function g(e){return null===e||d(e)}function f(){return!0}function z(e,h){let y;switch(e.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":y=e.nullable?F:W;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":y=e.nullable?w:p;break;case "string":case "esriFieldTypeString":y=e.nullable?
g:d;break;default:y=f}return 1===arguments.length?y:y(h)}function b(e){return null!=e&&da.has(e.type)}function a(e,h){return null==e||e.nullable&&null===h?null:b(e)&&!c(e.type,Number(h))?q.NumericRangeValidationError.OUT_OF_RANGE:z(e,h)?e.domain?K.validateDomainValue(e.domain,h):null:q.TypeValidationError.INVALID_TYPE}function c(e,h){e="string"===typeof e?v(e):e;if(!e)return!1;const y=e.min,J=e.max;return e.isInteger?W(h)&&h>=y&&h<=J:h>=y&&h<=J}function v(e){switch(e){case "esriFieldTypeSmallInteger":case "small-integer":return X;
case "esriFieldTypeInteger":case "integer":return Y;case "esriFieldTypeSingle":case "single":return Z;case "esriFieldTypeDouble":case "double":return aa}}function x(e,h,y){if(!h||!h.attributes||!e){if(k.isSome(y))for(var J of e??[])y.add(J);return!0}h=h.attributes;J=!1;for(const S of e)if(!(S in h))if(J=!0,k.isSome(y))y.add(S);else break;return J}const I=/^([0-9])/,M=/[^a-z0-9_\u0080-\uffff]/gi,N=/_{2,}/g,O=/^_/,R=/_$/,T="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" "),
V=["field","normalizationField"],U=new Set,W=(()=>"isInteger"in Number?Number.isInteger:e=>"number"===typeof e&&isFinite(e)&&Math.floor(e)===e)(),ba=["integer","small-integer","single","double"],da=new Set([...ba,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);q.NumericRangeValidationError=void 0;(q.NumericRangeValidationError||(q.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";q.TypeValidationError=void 0;
(q.TypeValidationError||(q.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";const X={min:-32768,max:32767,isInteger:!0},Y={min:-2147483648,max:2147483647,isInteger:!0},Z={min:-3.4E38,max:1.2E38,isInteger:!1},aa={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};q.collectArcadeFieldNames=G;q.collectElevationFields=B;q.collectFeatureReductionFields=async function(e,h,y){if(h&&y&&"fields"in y){var J=[];J.push(A(e,h,y.popupTemplate));y.fields&&J.push(...y.fields.map(async S=>
{S.onStatisticExpression?G(e,h.fieldsIndex,S.onStatisticExpression.expression):e.add(S.onStatisticField)}));await Promise.all(J)}};q.collectField=D;q.collectFields=C;q.collectFilterFields=async function(e,h,y){h&&(h.timeInfo&&k.isSome(y)&&y.timeExtent&&C(e,h.fieldsIndex,[h.timeInfo.startField,h.timeInfo.endField]),h.floorInfo&&C(e,h.fieldsIndex,[h.floorInfo.floorField]),k.isSome(y)&&k.isSome(y.where)&&await r(e,h.fieldsIndex,y.where))};q.collectLabelingFields=m;q.collectOrderByInfos=async function(e,
h,y){h&&y&&await Promise.all(y.map(J=>E(e,h,J)))};q.collectPopupTemplateFields=A;q.doubleRange=aa;q.featureHasFields=function(e,h){return!x(e,h,null)};q.fixFields=L;q.fixRendererFields=function(e,h){if(null!=e&&null!=h)for(const y of Array.isArray(e)?e:[e])if(Q(T,y,h),"visualVariables"in y&&y.visualVariables)for(const J of y.visualVariables)Q(V,J,h)};q.fixTimeInfoFields=function(e,h){if(null!=e&&h?.fields?.length)if("startField"in e){var y=h.get(e.startField);h=h.get(e.endField);e.startField=y?.name??
null;e.endField=h?.name??null}else y=h.get(e.startTimeField),h=h.get(e.endTimeField),e.startTimeField=y?.name??null,e.endTimeField=h?.name??null};q.getDisplayFieldName=function({displayField:e,fields:h}){if(e)return e;if(!h||!h.length)return null;if(!(e=t(h,"name-or-title")||t(h,"unique-identifier")||t(h,"type-or-category")))a:{for(const y of h)if(y&&y.name&&(h=y.name.toLowerCase(),h.includes("name")||h.includes("title"))){e=y.name;break a}e=null}return e};q.getElevationFields=async function(e){if(!e)return[];
const h=new Set;await B(h,e);return Array.from(h).sort()};q.getExpressionFields=async function(e,h){const y=new Set;for(const J of h)await G(y,e.fieldsIndex,J);return Array.from(y).sort()};q.getFeatureEditFields=function(e){if(!e)return[];const h="editFieldsInfo"in e&&e.editFieldsInfo;return h?L(e.fieldsIndex,[h&&h.creatorField,h&&h.creationDateField,h&&h.editorField,h&&h.editDateField]):[]};q.getFeatureGeometryFields=function(e){if(!e)return[];const h=e.geometryFieldsInfo;return h?L(e.fieldsIndex,
[h.shapeAreaField,h.shapeLengthField]):[]};q.getFieldDefaultValue=function(e){const h=e.defaultValue;if(void 0!==h&&z(e,h))return h;if(e.nullable)return null};q.getFieldRange=function(e){const h=K.getDomainRange(e.domain);if(h)return h;if(b(e))return v(e.type)};q.getLabelingFields=async function(e){if(!e)return[];const h=new Set;await m(h,e);return Array.from(h).sort()};q.getNumericTypeForValue=function(e){if(!p(e))return null;if(W(e)){if(e>=X.min&&e<=X.max)return"esriFieldTypeSmallInteger";if(e>=
Y.min&&e<=Y.max)return"esriFieldTypeInteger"}return e>=Z.min&&e<=Z.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};q.getTimeFields=async function(e){if(!e)return[];const h="timeInfo"in e&&e.timeInfo;return h?L(e.fieldsIndex,[e.trackIdField,h.startField,h.endField]):[]};q.integerRange=Y;q.isDateField=function(e){return null!=e&&("date"===e.type||"esriFieldTypeDate"===e.type)};q.isNumberInRange=c;q.isNumericField=b;q.isRasterPixelValueField=function(e){return e?["raster.itempixelvalue","raster.servicepixelvalue"].some(h=>
e.toLowerCase().startsWith(h)):!1};q.isStringField=function(e){return null!=e&&("string"===e.type||"esriFieldTypeString"===e.type)};q.isValidFieldValue=function(e,h){return null===a(e,h)};q.isValueMatchingFieldType=z;q.normalizeFieldName=function(e){return null==e?null:e.trim().replace(M,"_").replace(N,"_").replace(O,"").replace(R,"").replace(I,"F$1")||null};q.numericTypes=ba;q.packFields=function(e,h,y=1){if(!h||!e)return[];if(h.includes("*"))return["*"];h=L(e,h);return h.length/e.fields.length>=
y?["*"]:h};q.populateMissingFields=x;q.rendererFields=T;q.sanitizeNullFieldValue=function(e){return null==e||"number"===typeof e&&isNaN(e)?null:e};q.singleRange=Z;q.smallIntegerRange=X;q.unpackFieldNames=function(e,h){return k.isNone(h)||k.isNone(e)?[]:h.includes("*")?(e.fields??[]).map(y=>y.name):h};q.validateFieldValue=a;q.validationErrorToString=function(e,h,y){switch(e){case K.DomainValidationError.INVALID_CODED_VALUE:return`Value ${y} is not in the coded domain - field: ${h.name}, domain: ${JSON.stringify(h.domain)}`;
case K.DomainValidationError.VALUE_OUT_OF_RANGE:return`Value ${y} is out of the range of valid values - field: ${h.name}, domain: ${JSON.stringify(h.domain)}`;case q.TypeValidationError.INVALID_TYPE:return`Value ${y} is not a valid value for the field type - field: ${h.name}, type: ${h.type}, nullable: ${h.nullable}`;case q.NumericRangeValidationError.OUT_OF_RANGE:const {min:J,max:S}=v(h.type);return`Value ${y} is out of range for the number type - field: ${h.name}, type: ${h.type}, value range is ${J} to ${S}`}};
q.visualVariableFields=V;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/domainUtils":function(){define(["exports"],function(n){n.DomainValidationError=void 0;(function(q){q.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";q.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(n.DomainValidationError||(n.DomainValidationError={}));n.getDomainRange=function(q){if(q&&"range"===q.type)return{min:"range"in q?q.range[0]:q.minValue,max:"range"in
q?q.range[1]:q.maxValue}};n.validateDomainValue=function(q,H){switch(q.type){case "range":const k="range"in q?q.range[0]:q.minValue;q="range"in q?q.range[1]:q.maxValue;if(null!=k&&+H<k||null!=q&&+H>q)return n.DomainValidationError.VALUE_OUT_OF_RANGE;break;case "coded-value":if(null==q.codedValues||q.codedValues.every(u=>null==u||u.code!==H))return n.DomainValidationError.INVALID_CODED_VALUE;break;case "codedValue":if(null==q.codedValues||q.codedValues.every(u=>null==u||u.code!==H))return n.DomainValidationError.INVALID_CODED_VALUE}return null};
Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/support/arcadeOnDemand":function(){define("require exports ../chunks/_rollupPluginBabelHelpers ../geometry ../core/Error ../core/Logger ../core/maybe ../geometry/SpatialReference".split(" "),function(n,q,H,k,u,K,P,Q){function L(){D||(D=(async()=>{const r=await new Promise((t,B)=>n(["./arcadeUtils"],t,B));return{arcade:r.arcade,arcadeUtils:r,Dictionary:r.Dictionary,Feature:r.arcadeFeature}})());return D}const C=K.getLogger("esri.support.arcadeOnDemand");
let D;k=(r,t,B)=>G.create(r,t,B,null,["$feature","$view"]);let G=function(){function r(B,A,E,m,l,p,w){this.script=B;this.evaluate=m;this.fields=Array.isArray(p)?p:p.fields;this._syntaxTree=E;this._arcade=A;this._arcadeFeature=l;this._spatialReference=w;this._referencesGeometry=A.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}r.create=async function(B,A,E,m,l,p){const {arcade:w,Feature:F,Dictionary:d}=await L(),g=Q.fromJSON(A);
let f;try{f=w.parseScript(B,p)}catch(x){return C.error(new u("arcade-bad-expression","Failed to parse arcade script",{script:B,error:x})),null}l=l.reduce((x,I)=>({...x,[I]:null}),{});let z=null;P.isSome(m)&&(z=new d(m),z.immutable=!0,l.$config=null);p=(m=w.scriptUsesGeometryEngine(f))&&w.enableGeometrySupport();const b=w.scriptUsesFeatureSet(f)&&w.enableFeatureSetSupport(),a=(A=w.scriptIsAsync(f))&&w.enableAsyncSupport();l={vars:l,spatialReference:g,useAsync:!!a};await Promise.all([p,b,a]);p=new Set;
await w.loadDependentModules(p,f,null,A,m);const c=new d;c.immutable=!1;c.setField("scale",0);const v=w.compileScript(f,l);return new r(B,w,f,x=>{"$view"in x&&x.$view&&(c.setField("scale","object"===typeof x.$view?x.$view.scale:void 0),x.$view=c);z&&(x.$config=z);return v({vars:x,spatialReference:g})},new F,E,g)};var t=r.prototype;t.repurposeFeature=function(B){B.geometry&&!B.geometry.spatialReference&&(B.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(B.geometry,
B.attributes,{fields:this.fields});return this._arcadeFeature};t.referencesGeometry=function(){return this._referencesGeometry};t.referencesScale=function(){return this._referencesScale};return H._createClass(r)}();q.ArcadeExpression=G;q.createDictionaryExpression=(r,t,B,A)=>G.create(r,t,B,A,["$feature","$view"]);q.createLabelExpression=(r,t,B)=>G.create(r,t,B,null,["$feature"]);q.createRendererExpression=k;q.createVVExpression=k;q.loadArcade=L;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},
"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils","../../core/screenUtils","../../chunks/vec4","../../chunks/vec4f64"],function(n,q,H,k,u){function K(C,D,G,r){let {color:t,ratio:B}=D,{color:A,ratio:E}=G;E===B&&(1===E?B-=1E-6:E+=1E-6);D=q.clamp((r-B)/(E-B),0,1);k.lerp(C,t.toArray(),A.toArray(),D)}function P(C,D,G,r,t){C=new Uint32Array(C*C);D="buffer"in D?D:new Float64Array(D);G="buffer"in G?new Uint32Array(G.buffer):new Uint32Array((new Uint8Array(G)).buffer);
t=G.length/(t-r);for(let B=0;B<D.length;B++)C[B]=G[q.clamp(Math.floor((D[B]-r)*t),0,G.length-1)];return C.buffer}function Q(C,D,G){C=Math.sqrt(C**2+D**2)/G;return 1<C?0:3/(Math.PI*G**2)*(1-C**2)**2}function L(C,D){return null!=C?"string"===typeof D?G=>-1*+G.readAttribute(C):G=>+G.readAttribute(C)+D:G=>1}n.MAGIC_KERNEL_DENSITY_RADIUS_INFLATION_FACTOR=2.4;n.calculateHeatmapIntensityInfoReaders=function(C,D,G,r){const {radius:t,fieldOffset:B,field:A}=D;D=Math.round(H.pt2px(t));const E=new Float64Array(G*
r);let m=Number.NEGATIVE_INFINITY;const l=L(A,B),p=new Set;for(const g of C)for(C=g.getCursor();C.next();){var w=C.getObjectId();if(p.has(w))continue;p.add(w);w=C.readLegacyPointGeometry();if(-128>w.x||w.x>=G+128||-128>w.y||w.y>r+128)continue;const f=+l(C),z=Math.max(0,Math.round(w.x)-D);var F=Math.max(0,Math.round(w.y)-D);const b=Math.min(r,Math.round(w.y)+D),a=Math.min(G,Math.round(w.x)+D);for(;F<b;F++)for(let c=z;c<a;c++){var d=F*G+c;const v=Q(w.x-c,w.y-F,D);d=E[d]+=v*f;d>m&&(m=d)}}return{matrix:E.buffer,
max:m}};n.createHeatmapImageData=P;n.createValueFunction=function(C,D){return"function"===typeof C?C:C?"string"===typeof D?G=>-1*+G[C]:G=>+G[C]+D:()=>1};n.createValueFunctionCursor=L;n.drawHeatmap=function(C,D,G,r,t,B){C.canvas.width=C.canvas.height=D;C.clearRect(0,0,D,D);const A=C.getImageData(0,0,D,D);G&&r&&A.data.set(new Uint8ClampedArray(P(D,G,r,t,B)));C.putImageData(A,0,0)};n.evaluateDensityKernel=Q;n.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(C){return H.px2pt(2.4*C)};n.generateGradient=
function(C){const D=new Uint8ClampedArray(2048);C=C.filter(({ratio:A})=>0<=A&&1>=A).sort((A,E)=>A.ratio-E.ratio).map(({color:A,ratio:E})=>({color:A,ratio:Math.max(E,.001)}));if(1>C.length)return D;let G=C[0],r=C[0],t=1;const B=u.create();for(let A=0;512>A;A++){const E=(A+.5)/512;for(;E>r.ratio&&t<C.length;)G=r,r=C[t++];K(B,G,r,E);D.set(B,4*A)}return D};n.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(C){return H.pt2px(C)/2.4};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/vec4f64":function(){define(["exports"],
function(n){function q(){return[0,0,0,0]}function H(p){return[p[0],p[1],p[2],p[3]]}function k(p,w,F,d){return[p,w,F,d]}function u(p){const w=q(),F=Math.min(4,p.length);for(let d=0;d<F;++d)w[d]=p[d];return w}function K(p,w){return new Float64Array(p,w,4)}function P(){return q()}function Q(){return[1,1,1,1]}function L(){return[1,0,0,0]}function C(){return[0,1,0,0]}function D(){return[0,0,1,0]}function G(){return[0,0,0,1]}const r=q(),t=Q(),B=L(),A=C(),E=D(),m=G(),l=Object.freeze(Object.defineProperty({__proto__:null,
ONES:t,UNIT_W:m,UNIT_X:B,UNIT_Y:A,UNIT_Z:E,ZEROS:r,clone:H,create:q,createView:K,fromArray:u,fromValues:k,ones:Q,unitW:G,unitX:L,unitY:C,unitZ:D,zeros:P},Symbol.toStringTag,{value:"Module"}));n.ONES=t;n.UNIT_W=m;n.UNIT_X=B;n.UNIT_Y=A;n.UNIT_Z=E;n.ZEROS=r;n.clone=H;n.create=q;n.createView=K;n.fromArray=u;n.fromValues=k;n.ones=Q;n.unitW=G;n.unitX=L;n.unitY=C;n.unitZ=D;n.vec4f64=l;n.zeros=P})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],
function(n,q,H){function k(d){return null==d||"string"===typeof d&&!d?"\x3cNull\x3e":d}function u(d){const g=null!=d.minValue||null!=d.maxValue,f=!!d.sqlExpression&&d.supportsSQLExpression;return!(null!=d.normalizationField||null!=d.normalizationType)&&!g&&!f}function K(d){const {values:g,useSampleStdDev:f,supportsNullCount:z}=d;var b=Number.POSITIVE_INFINITY;let a=Number.NEGATIVE_INFINITY,c=null,v=null;var x=null;let I=null,M=0;const N=null==d.minValue?-Infinity:d.minValue,O=null==d.maxValue?Infinity:
d.maxValue;for(const R of g)Number.isFinite(R)?R>=N&&R<=O&&(c=null===c?R:c+R,b=Math.min(b,R),a=Math.max(a,R),M++):"string"===typeof R&&M++;if(M&&null!=c){v=c/M;x=0;for(const R of g)Number.isFinite(R)&&R>=N&&R<=O&&(x+=(R-v)**2);I=f?1<M?x/(M-1):0:0<M?x/M:0;x=Math.sqrt(I)}else a=b=null;b={avg:v,count:M,max:a,min:b,stddev:x,sum:c,variance:I};z&&(b.nullcount=g.length-M);d.percentileParams&&(b.median=P(g,d.percentileParams));return b}function P(d,g){const {fieldType:f,value:z,orderBy:b,isDiscrete:a}=g,
c=Q(f,"desc"===b);d=[...d].filter(M=>null!=M).sort((M,N)=>c(M,N));if(0===d.length)return null;if(0>=z)return d[0];if(1<=z)return d[d.length-1];var v=(d.length-1)*z,x=Math.floor(v);g=x+1;v%=1;x=d[x];const I=d[g];return g>=d.length||a||"string"===typeof x||"string"===typeof I?x:x*(1-v)+I*v}function Q(d,g){const f=g?1:-1,z=D(g),b=C(g);if(!d||!["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...w].includes(d))return(a,c)=>"number"===typeof a&&"number"===typeof c?
z(a,c):"string"===typeof a&&"string"===typeof c?b(a,c):f;if("esriFieldTypeDate"===d)return(a,c)=>{a=(new Date(a)).getTime();c=(new Date(c)).getTime();return isNaN(a)||isNaN(c)?f:z(a,c)};if(w.has(d))return(a,c)=>z(a,c);if("esriFieldTypeString"===d)return(a,c)=>b(a,c);if("esriFieldTypeGUID"===d||"esriFieldTypeGlobalID"===d){const a=C(g);return(c,v)=>a(G(c),G(v))}return g?(a,c)=>1:(a,c)=>-1}function L(d,g,f){if(f){if(null==d)return null==g?0:1;if(null==g)return-1}else{if(null==d)return null==g?0:-1;
if(null==g)return 1}return null}function C(d){return d?(g,f)=>{const z=L(g,f,!0);if(null!=z)return z;g=g.toUpperCase();f=f.toUpperCase();return g>f?-1:g<f?1:0}:(g,f)=>{const z=L(g,f,!1);if(null!=z)return z;g=g.toUpperCase();f=f.toUpperCase();return g<f?-1:g>f?1:0}}function D(d){return d?(g,f)=>{const z=L(g,f,!0);return null!=z?z:f-g}:(g,f)=>{const z=L(g,f,!1);return null!=z?z:g-f}}function G(d){return d.substr(24,12)+d.substr(19,4)+d.substr(16,2)+d.substr(14,2)+d.substr(11,2)+d.substr(9,2)+d.substr(6,
2)+d.substr(4,2)+d.substr(2,2)+d.substr(0,2)}function r(d){return"coded-value"!==d?.type?[]:d.codedValues.map(g=>g.code)}function t(d,g){const f=A({field:g.field,normalizationType:g.normalizationType,normalizationField:g.normalizationField,classificationMethod:g.classificationMethod,standardDeviationInterval:g.standardDeviationInterval,breakCount:g.numClasses||5});d=B(d,g.minValue,g.maxValue);return H.createGenerateRendererClassBreaks({definition:f,values:d,normalizationTotal:g.normalizationTotal})}
function B(d,g,f){const z=null==g?-Infinity:g,b=null==f?Infinity:f;return d.filter(a=>Number.isFinite(a)&&a>=z&&a<=b)}function A(d){const {breakCount:g,field:f,normalizationField:z,normalizationType:b}=d,a=d.classificationMethod||"equal-interval";return new q({breakCount:g,classificationField:f,classificationMethod:a,normalizationField:"field"===b?z:void 0,normalizationType:b,standardDeviationInterval:"standard-deviation"===a?d.standardDeviationInterval||1:void 0})}function E(d,g){const {field:f,
classificationMethod:z,standardDeviationInterval:b,normalizationType:a,normalizationField:c,normalizationTotal:v,minValue:x,maxValue:I}=g,M=g.numBins||10;let N=g=null,O=null;z&&"equal-interval"!==z||a?({classBreaks:d}=t(d,{field:f,normalizationType:a,normalizationField:c,normalizationTotal:v,classificationMethod:z,standardDeviationInterval:b,minValue:x,maxValue:I,numClasses:M}),g=d[0].minValue,N=d[d.length-1].maxValue,O=d.map(R=>[R.minValue,R.maxValue])):(null!=x&&null!=I?(g=x,N=I):(d=K({values:d,
minValue:x,maxValue:I,useSampleStdDev:!a,supportsNullCount:u({normalizationType:a,normalizationField:c,minValue:x,maxValue:I})}),g=d.min??null,N=d.max??null),O=l(g??0,N??0,M));return{min:g,max:N,intervals:O}}function m(d,g){let f=-1;for(let z=d.length-1;0<=z;z--)if(g>=d[z][0]){f=z;break}return f}function l(d,g,f){const z=(g-d)/f,b=[];let a;for(let c=1;c<=f;c++)a=d+z,a=Number(a.toFixed(16)),b.push([d,c===f?g:a]),d=a;return b}const p=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,w=new Set(["esriFieldTypeInteger",
"esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),F="min max avg stddev count sum variance nullcount median".split(" ");n.calculateClassBreaks=t;n.calculateHistogram=function(d,g){var f=E(d,g);const z=f.intervals,b=f.min??0;f=f.max??0;const a=z.map((c,v)=>({minValue:z[v][0],maxValue:z[v][1],count:0}));for(const c of d)null!=c&&c>=b&&c<=f&&(d=m(z,c),-1<d&&a[d].count++);return{bins:a,minValue:b,maxValue:f,normalizationTotal:g.normalizationTotal}};n.calculatePercentile=P;n.calculateStatistics=
K;n.calculateStringStatistics=function(d){const g=d.returnDistinct?[...(new Set(d.values))]:d.values,f=g.filter(b=>null!=b).length,z={count:f};d.supportsNullCount&&(z.nullcount=g.length-f);d.percentileParams&&(z.median=P(g,d.percentileParams));return z};n.calculateUniqueValuesCount=function(d){const g={};for(let f of d){if(null==f||"string"===typeof f&&""===f.trim())f=null;null==g[f]?g[f]={count:1,data:f}:g[f].count++}return{count:g}};n.createClassBreaksDefinition=A;n.createUVResult=function(d,g,
f,z){d=d.count;const b=[];if(f&&g){f=[];var a=r(g[0]);for(const c of a)if(g[1]){a=r(g[1]);for(const v of a)if(g[2]){a=r(g[2]);for(const x of a)f.push(`${k(c)}${z}${k(v)}${z}${k(x)}`)}else f.push(`${k(c)}${z}${k(v)}`)}else f.push(c);for(const c of f)d.hasOwnProperty(c)||(d[c]={data:c,count:0})}for(const c in d)g=d[c],b.push({value:g.data,count:g.count,label:g.label});return{uniqueValueInfos:b}};n.getAttributeComparator=Q;n.getEqualIntervalBins=l;n.getNormalizedValue=function(d,g,f,z){let b=null;switch(g){case "log":0!==
d&&(b=Math.log(d)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(z)&&0!==z&&(b=d/z*100);break;case "field":Number.isFinite(f)&&0!==f&&(b=d/f);break;case "natural-log":0<d&&(b=Math.log(d));break;case "square-root":0<d&&(b=d**.5)}return b};n.isNullCountSupported=u;n.processNullValue=k;n.processSummaryStatisticsResult=function(d,g){let f;for(f in d)F.includes(f)&&(Number.isFinite(d[f])||(d[f]=null));if(!g)return d;["avg","stddev","variance"].forEach(z=>{null!=d[z]&&(d[z]=Math.ceil(d[z]))});
return d};n.resolveCBResult=function(d,g){let f=d.classBreaks;const z=f[0].minValue,b=f[f.length-1].maxValue,a="standard-deviation"===g;f=f.map(c=>{const v=c.label;c={minValue:c.minValue,maxValue:c.maxValue,label:v};if(a&&v){const x=v.match(p)?.map(I=>+I.trim())??[];2===x.length?(c.minStdDev=x[0],c.maxStdDev=x[1],0>x[0]&&0<x[1]&&(c.hasAvg=!0)):1===x.length&&(v.includes("\x3c")?(c.minStdDev=null,c.maxStdDev=x[0]):v.includes("\x3e")&&(c.minStdDev=x[0],c.maxStdDev=null))}return c});return{minValue:z,
maxValue:b,classBreakInfos:f,normalizationTotal:d.normalizationTotal}};n.statisticTypes=F;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/arrayUtils ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(n,q,H,k,u,K,P,Q,L,C){K=new H.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});H=new H.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});k=function(D){function G(t){t=r.call(this,t);t.type="class-breaks-definition";t.breakCount=
null;t.classificationField=null;t.classificationMethod=null;t.normalizationField=null;t.normalizationType=null;return t}n._inherits(G,D);var r=n._createSuper(G);n._createClass(G,[{key:"standardDeviationInterval",set:function(t){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",t)}},{key:"definedInterval",set:function(t){"defined-interval"===this.classificationMethod&&this._set("definedInterval",t)}}]);return G}(k.JSONSupport);q.__decorate([L.enumeration({classBreaksDef:"class-breaks-definition"})],
k.prototype,"type",void 0);q.__decorate([u.property({json:{write:!0}})],k.prototype,"breakCount",void 0);q.__decorate([u.property({json:{write:!0}})],k.prototype,"classificationField",void 0);q.__decorate([u.property({type:String,json:{read:K.read,write:K.write}})],k.prototype,"classificationMethod",void 0);q.__decorate([u.property({json:{write:!0}})],k.prototype,"normalizationField",void 0);q.__decorate([u.property({json:{read:H.read,write:H.write}})],k.prototype,"normalizationType",void 0);q.__decorate([u.property({value:null,
json:{write:!0}})],k.prototype,"standardDeviationInterval",null);q.__decorate([u.property({value:null,json:{write:!0}})],k.prototype,"definedInterval",null);return k=q.__decorate([C.subclass("esri.rest.support.ClassBreaksDefinition")],k)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(n,q,H){n.enumeration=function(k,u={}){k=k instanceof q.JSONMap?k:new q.JSONMap(k,u);k={type:u?.ignoreUnknown??!0?k.apiValues:String,json:{type:k.jsonValues,
read:u?.readOnly?!1:{reader:k.read},write:{writer:k.write}}};void 0!==u?.readOnly&&(k.readOnly=!!u.readOnly);void 0!==u?.default&&(k.json.default=u.default);void 0!==u?.name&&(k.json.name=u.name);void 0!==u?.nonNullable&&(k.nonNullable=u.nonNullable);return H.property(k)};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(n,q){function H(r){var t=r.definition;const {classificationMethod:B,
normalizationType:A,definedInterval:E}=t;t=t.breakCount??1;const m=[];var l=r.values;if(0===l.length)return[];l=l.sort((f,z)=>f-z);var p=l[0],w=l[l.length-1];if("equal-interval"===B)if(l.length>=t){l=(w-p)/t;r=p;for(var F=1;F<t;F++){var d=Number((p+F*l).toFixed(6));m.push({minValue:r,maxValue:d,label:k(r,d,A)});r=d}m.push({minValue:r,maxValue:w,label:k(r,w,A)})}else l.forEach(f=>{m.push({minValue:f,maxValue:f,label:k(f,f,A)})});else if("natural-breaks"===B){l=u(l);r=K(l.uniqueValues,r.valueFrequency||
l.valueFrequency,t);for(F=1;F<t;F++)l.uniqueValues.length>F&&(d=Number(l.uniqueValues[r[F]].toFixed(6)),m.push({minValue:p,maxValue:d,label:k(p,d,A)}),p=d);m.push({minValue:p,maxValue:w,label:k(p,w,A)})}else if("quantile"===B)if(l.length>=t&&p!==w){r=Math.ceil(l.length/t);F=0;for(d=1;d<t;d++){var g=r+F-1;g>l.length&&(g=l.length-1);0>g&&(g=0);m.push({minValue:p,maxValue:l[g],label:k(p,l[g],A)});p=l[g];F+=r;r=Math.ceil((l.length-F)/(t-d))}m.push({minValue:p,maxValue:w,label:k(p,w,A)})}else for(t=-1,
w=0;w<l.length;w++)p=l[w],p!==t&&(t=p,m.push({minValue:t,maxValue:p,label:k(t,p,A)}),t=p);else if("standard-deviation"===B)if(r=L(l),F=C(l,r),0===F)m.push({minValue:l[0],maxValue:l[0],label:k(l[0],l[0],A)});else{l=Q(p,w,t,r,F)*F;F=0;for(d=t;1<=d;d--)g=Number((r-(d-.5)*l).toFixed(6)),m.push({minValue:p,maxValue:g,label:k(p,g,A)}),p=g,F++;d=Number((r+.5*l).toFixed(6));m.push({minValue:p,maxValue:d,label:k(p,d,A)});p=d;F++;for(g=1;g<=t;g++)d=F===2*t?w:Number((r+(g+.5)*l).toFixed(6)),m.push({minValue:p,
maxValue:d,label:k(p,d,A)}),p=d,F++}else if("defined-interval"===B){if(!E)return m;t=l[0];w=l[l.length-1];l=Math.ceil((w-t)/E);p=t;for(r=1;r<l;r++)F=Number((t+r*E).toFixed(6)),m.push({minValue:p,maxValue:F,label:k(p,F,A)}),p=F;m.push({minValue:p,maxValue:w,label:k(p,w,A)})}return m}function k(r,t,B){let A=null;return A=r===t?B&&"percent-of-total"===B?r+"%":r.toString():B&&"percent-of-total"===B?r+"% - "+t+"%":r+" - "+t}function u(r){const t=[],B=[];let A=Number.MIN_VALUE,E=1,m=-1;for(let l=0;l<r.length;l++){const p=
r[l];p===A?(E++,B[m]=E):null!==p&&(t.push(p),A=p,E=1,B.push(E),m++)}return{uniqueValues:t,valueFrequency:B}}function K(r,t,B){var A=r.length;const E=[];B>A&&(B=A);for(var m=0;m<B;m++)E.push(Math.round(m*A/B-1));E.push(A-1);m=P(E,r,t,B);A=m.mean;m=m.sdcm;var l=B,p=0,w=0;let F=0,d=0,g=!0;for(let z=0;2>z&&g;z++){0===z&&(g=!1);for(var f=0;f<l-1;f++)for(;E[f+1]+1!==E[f+2];)if(E[f+1]+=1,p=D(f,E,r,t),F=p.sbMean,p=p.sbSdcm,w=D(f+1,E,r,t),d=w.sbMean,w=w.sbSdcm,p+w<m[f]+m[f+1])m[f]=p,m[f+1]=w,A[f]=F,A[f+1]=
d,g=!0;else{--E[f+1];break}for(f=l-1;0<f;f--)for(;E[f]!==E[f-1]+1;)if(--E[f],p=D(f-1,E,r,t),F=p.sbMean,p=p.sbSdcm,w=D(f,E,r,t),d=w.sbMean,w=w.sbSdcm,p+w<m[f-1]+m[f])m[f-1]=p,m[f]=w,A[f-1]=F,A[f]=d,g=!0;else{E[f]+=1;break}}g&&(m=P(E,r,t,B));return E}function P(r,t,B,A){let E=[];var m=[],l=[];let p=0;const w=[],F=[];for(var d=0;d<A;d++){var g=D(d,r,t,B);w.push(g.sbMean);F.push(g.sbSdcm);p+=F[d]}g=p;for(d=!0;d||p<g;){d=!1;E=[];for(m=0;m<A;m++)E.push(r[m]);for(l=0;l<A;l++)for(g=r[l]+1;g<=r[l+1];g++)if(m=
t[g],0<l&&g!==r[l+1]&&Math.abs(m-w[l])>Math.abs(m-w[l-1]))r[l]=g;else if(l<A-1&&r[l]!==g-1&&Math.abs(m-w[l])>Math.abs(m-w[l+1])){r[l+1]=g-1;break}g=p;p=0;m=[];l=[];for(let f=0;f<A;f++){m.push(w[f]);l.push(F[f]);const z=D(f,r,t,B);w[f]=z.sbMean;F[f]=z.sbSdcm;p+=F[f]}}if(p>g){for(t=0;t<A;t++)r[t]=E[t],w[t]=m[t],F[t]=l[t];p=g}return{mean:w,sdcm:F}}function Q(r,t,B,A,E){r=Math.max(A-r,t-A)/E/B;return 1<=r?1:.5<=r?.5:.25}function L(r){let t=0;for(let B=0;B<r.length;B++)t+=r[B];return t/=r.length}function C(r,
t){let B=0;for(let A=0;A<r.length;A++){const E=r[A];B+=(E-t)*(E-t)}B/=r.length;return Math.sqrt(B)}function D(r,t,B,A){var E=0,m=0;for(var l=t[r]+1;l<=t[r+1];l++){const p=A[l];E+=B[l]*p;m+=p}0>=m&&G.warn("Exception in Natural Breaks calculation");E/=m;m=0;for(l=t[r]+1;l<=t[r+1];l++)m+=A[l]*(B[l]-E)**2;return{sbMean:E,sbSdcm:m}}const G=q.getLogger("esri.rest.support.generateRendererUtils");n.createGenerateRendererClassBreaks=function(r){const {normalizationTotal:t}=r;return{classBreaks:H(r),normalizationTotal:t}};
n.createGenerateRendererUniqueValues=function(r){r=u(r);const t=[],B=r.uniqueValues.length;for(let A=0;A<B;A++){const E=r.uniqueValues[A];t.push({value:E,count:r.valueFrequency[A],label:E.toString()})}return{uniqueValues:t}};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define(["exports","./utils","../../../statistics/utils"],function(n,q,H){n.classBreaks=async function(k){const {attribute:u,features:K}=k,{field:P,normalizationType:Q,normalizationField:L,normalizationTotal:C,classificationMethod:D}=u;k=await q.getDataValues({field:P,valueExpression:u.valueExpression,normalizationType:Q,normalizationField:L,normalizationTotal:C,viewInfoParams:u.viewInfoParams,fieldInfos:u.fieldInfos},K);k=H.calculateClassBreaks(k,{field:P,normalizationType:Q,normalizationField:L,
normalizationTotal:C,classificationMethod:D,standardDeviationInterval:u.standardDeviationInterval,numClasses:u.numClasses,minValue:u.minValue,maxValue:u.maxValue});return H.resolveCBResult(k,D)};n.heatmapStatistics=async function(k){const {attribute:u,features:K}=k,{field:P,radius:Q,fieldOffset:L,transform:C,spatialReference:D}=u;k=u.size??[0,0];const G=q.quantizeFeatures(K??[],C,D,k),{count:r,min:t,max:B,mean:A,stdDev:E}=q.calculateHeatmapStats(G,Q??void 0,L,P,k[0],k[1]);return{count:r,min:t,max:B,
avg:A,stddev:E}};n.histogram=async function(k){const {attribute:u,features:K}=k,{field:P,normalizationType:Q,normalizationField:L,normalizationTotal:C,classificationMethod:D}=u;k=await q.getDataValues({field:P,valueExpression:u.valueExpression,normalizationType:Q,normalizationField:L,normalizationTotal:C,viewInfoParams:u.viewInfoParams,fieldInfos:u.fieldInfos},K);return H.calculateHistogram(k,{field:P,normalizationType:Q,normalizationField:L,normalizationTotal:C,classificationMethod:D,standardDeviationInterval:u.standardDeviationInterval,
numBins:u.numBins,minValue:u.minValue,maxValue:u.maxValue})};n.summaryStatistics=async function(k){const {attribute:u,features:K}=k,{normalizationType:P,normalizationField:Q,minValue:L,maxValue:C,fieldType:D}=u;k=await q.getDataValues({field:u.field,valueExpression:u.valueExpression,normalizationType:P,normalizationField:Q,normalizationTotal:u.normalizationTotal,viewInfoParams:u.viewInfoParams,fieldInfos:u.fieldInfos},K);const G=H.isNullCountSupported({normalizationType:P,normalizationField:Q,minValue:L,
maxValue:C}),r={value:.5,fieldType:D};k="esriFieldTypeString"===D?H.calculateStringStatistics({values:k,supportsNullCount:G,percentileParams:r}):H.calculateStatistics({values:k,minValue:L,maxValue:C,useSampleStdDev:!P,supportsNullCount:G,percentileParams:r});return H.processSummaryStatisticsResult(k,"esriFieldTypeDate"===D)};n.uniqueValues=async function(k){const {attribute:u,features:K}=k;k=await q.getDataValues({field:u.field,field2:u.field2,field3:u.field3,fieldDelimiter:u.fieldDelimiter,valueExpression:u.valueExpression,
viewInfoParams:u.viewInfoParams,fieldInfos:u.fieldInfos},K);k=H.calculateUniqueValuesCount(k);return H.createUVResult(k,u.domains,u.returnAllCodedValues,u.fieldDelimiter)};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});