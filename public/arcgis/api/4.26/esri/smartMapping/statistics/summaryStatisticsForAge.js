// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.27/esri/copyright.txt for details.
//>>built
define(["../../core/Error","../../core/maybe","./summaryStatistics","./support/ageUtils","../support/adapters/support/layerUtils"],function(g,l,m,c,d){async function n(a){if(!(a&&a.layer&&a.startTime&&a.endTime&&a.unit))throw new g("summary-statistics-for-age:missing-parameters","'layer', 'startTime', 'endTime' and 'unit' parameters are required");const {layer:e,...h}=a;var b=d.createLayerAdapter(e,d.featureCapableLayerTypes);if(!b)throw new g("summary-statistics-for-age:invalid-parameters","'layer' must be one of these types: "+
d.getLayerTypeLabels(d.featureCapableLayerTypes).join(", "));a={layerAdapter:b,...h};const f=a.view,k=l.isSome(a.signal)?{signal:a.signal}:null;await Promise.all([f&&f.when(),b.load(k)]);if(b=c.verifyDates(b,a.startTime,a.endTime,"summary-statistics-for-age:invalid-parameters"))throw b;if(!a.unit||!c.supportedAgeUnits.includes(a.unit))throw new g("summary-statistics-for-age:invalid-parameters",`Supported units are: ${c.supportedAgeUnits.join(", ")}`);return a}return async function(a){const {layerAdapter:e,
...h}=await n(a),{view:b,startTime:f,endTime:k,unit:p,minValue:q,maxValue:r,signal:t}=h,{valueExpression:u,statisticsQuery:v}=c.getAgeExpressions({layer:e,startTime:f,endTime:k,unit:p});return m({layer:e,valueExpression:u,...v,minValue:q,maxValue:r,view:b,signal:t})}});